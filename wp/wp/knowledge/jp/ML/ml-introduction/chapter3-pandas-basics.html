<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬3ç« ï¼šPandasåŸºç¤ - æ©Ÿæ¢°å­¦ç¿’å…¥é–€ã‚·ãƒªãƒ¼ã‚º">
    <title>ç¬¬3ç« ï¼šPandasåŸºç¤ - æ©Ÿæ¢°å­¦ç¿’å…¥é–€ - AI Terakoya</title>

    <!-- CSS Styling -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --bg-color: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --code-bg: #f5f5f5;
            --link-color: #3498db;
            --link-hover: #2980b9;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
            line-height: 1.8;
            color: var(--text-color);
            background: var(--bg-color);
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        header .container {
            padding: 0 1.5rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .meta {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            font-size: 0.9rem;
            opacity: 0.95;
            margin-top: 1rem;
        }

        .meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }

        /* Typography */
        h2 {
            font-size: 1.75rem;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--secondary-color);
            color: var(--primary-color);
        }

        h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
            margin-bottom: 0.8rem;
            color: var(--primary-color);
        }

        h4 {
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
        }

        p {
            margin-bottom: 1.2rem;
        }

        a {
            color: var(--link-color);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--link-hover);
            text-decoration: underline;
        }

        /* Lists */
        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1.2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        /* Code blocks */
        code {
            background: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        pre code {
            background: none;
            padding: 0;
            font-size: 0.9rem;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            display: block;
        }

        thead {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        th, td {
            padding: 0.8rem;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: #f9f9f9;
        }

        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--secondary-color);
            padding-left: 1.5rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #666;
        }

        /* Mermaid diagrams */
        .mermaid {
            text-align: center;
            margin: 2rem 0;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        /* Details/Summary */
        details {
            margin: 1rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--primary-color);
            padding: 0.5rem;
        }

        summary:hover {
            color: var(--secondary-color);
        }

        /* Footer */
        footer {
            margin-top: 4rem;
            padding: 2rem 0;
            border-top: 2px solid var(--border-color);
            text-align: center;
            color: #666;
            font-size: 0.9rem;
        }

        /* Navigation buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin: 3rem 0;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-button {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background: var(--secondary-color);
            color: white;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 600;
        }

        .nav-button:hover {
            background: var(--link-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 1.6rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }

            table {
                font-size: 0.9rem;
            }
        }
    </style>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({ startOnLoad: true, theme: 'default' });
            }
        });
    </script>
</head>
<body>
    <header>
        <div class="container">
            <h1>ç¬¬3ç« ï¼šPandasåŸºç¤</h1>
            <div class="meta">
                <span>ğŸ“– èª­äº†æ™‚é–“: 20-25åˆ†</span>
                <span>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 10å€‹</span>
                <span>ğŸ“ æ¼”ç¿’: 5å•</span>
                <span>ğŸ“Š é›£æ˜“åº¦: å…¥é–€</span>
            </div>
        </div>
    </header>

    <main class="container">
        <p><strong>ãƒ‡ãƒ¼ã‚¿åˆ†æã®å¿…é ˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªPandasã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã‚ˆã†</strong></p>

        <h2 id="introduction">ã¯ã˜ã‚ã«</h2>
        <p><strong>Pandas</strong>ã¯ã€Pythonã§ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’è¡Œã†ãŸã‚ã®æœ€ã‚‚é‡è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚è¡¨å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¨ã‚¯ã‚»ãƒ«ã‚„CSVãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚ˆã†ãªãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’ç°¡å˜ã«æ‰±ã†ã“ã¨ãŒã§ãã€æ©Ÿæ¢°å­¦ç¿’ã®ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ã«ã¯æ¬ ã‹ã›ã¾ã›ã‚“ã€‚</p>

        <p>ã“ã®ç« ã§ã¯ã€ä»¥ä¸‹ã®å†…å®¹ã‚’å­¦ã³ã¾ã™ï¼š</p>
        <ul>
            <li>Seriesã¨DataFrameã®åŸºæœ¬</li>
            <li>CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¨ä¿å­˜</li>
            <li>ãƒ‡ãƒ¼ã‚¿ã®é¸æŠã¨æŠ½å‡º</li>
            <li>ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆæ¬ æå€¤å‡¦ç†ï¼‰</li>
            <li>ãƒ‡ãƒ¼ã‚¿å¤‰æ›ã¨é›†è¨ˆ</li>
            <li>ãƒ‡ãƒ¼ã‚¿çµåˆã¨å¯è¦–åŒ–</li>
        </ul>

        <blockquote>
            <strong>Pandasã¨NumPyã®é•ã„</strong><br>
            NumPyã¯æ•°å€¤è¨ˆç®—ã«ç‰¹åŒ–ã—ã¦ã„ã¾ã™ãŒã€Pandasã¯è¡¨å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆè¡Œã¨åˆ—ã‚’æŒã¤ãƒ‡ãƒ¼ã‚¿ï¼‰ã‚’æ‰±ã†ã®ã«ç‰¹åŒ–ã—ã¦ã„ã¾ã™ã€‚Pandasã¯NumPyã®ä¸Šã«æ§‹ç¯‰ã•ã‚Œã¦ãŠã‚Šã€å†…éƒ¨ã§NumPyé…åˆ—ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚
        </blockquote>

        <h2 id="series">1. Seriesã®åŸºæœ¬</h2>
        <p><strong>Series</strong>ã¯ã€1æ¬¡å…ƒã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆãƒ©ãƒ™ãƒ«ï¼‰ä»˜ãã®é…åˆ—ã¨è€ƒãˆã¦ãã ã•ã„ã€‚</p>

        <h4>ä¾‹1ï¼šSeriesã®ä½œæˆã¨æ“ä½œ</h4>
        <pre><code class="language-python">import pandas as pd
import numpy as np

# ãƒªã‚¹ãƒˆã‹ã‚‰Seriesã‚’ä½œæˆ
s1 = pd.Series([10, 20, 30, 40, 50])
print("Series 1:")
print(s1)
# å‡ºåŠ›:
# 0    10
# 1    20
# 2    30
# 3    40
# 4    50
# dtype: int64

# ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æŒ‡å®š
s2 = pd.Series([10, 20, 30], index=['a', 'b', 'c'])
print("\nSeries 2:")
print(s2)
# å‡ºåŠ›:
# a    10
# b    20
# c    30
# dtype: int64

# è¾æ›¸ã‹ã‚‰Seriesã‚’ä½œæˆ
data_dict = {'æ±äº¬': 1400, 'å¤§é˜ª': 880, 'åå¤å±‹': 230, 'ç¦å²¡': 155}
population = pd.Series(data_dict)
print("\näººå£ï¼ˆä¸‡äººï¼‰:")
print(population)

# è¦ç´ ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹
print("\nå¤§é˜ªã®äººå£:", population['å¤§é˜ª'])  # 880
print("æœ€åˆã®2ã¤:")
print(population[:2])

# çµ±è¨ˆé‡
print("\nçµ±è¨ˆé‡:")
print("å¹³å‡:", population.mean())
print("æœ€å¤§:", population.max())
print("æœ€å°:", population.min())
print("åˆè¨ˆ:", population.sum())

# ãƒ–ãƒ¼ãƒ«æ¼”ç®—
print("\näººå£500ä¸‡äººä»¥ä¸Šã®éƒ½å¸‚:")
print(population[population >= 500])
</code></pre>

        <h2 id="dataframe">2. DataFrameã®åŸºæœ¬</h2>
        <p><strong>DataFrame</strong>ã¯ã€2æ¬¡å…ƒã®è¡¨å½¢å¼ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚ã‚¨ã‚¯ã‚»ãƒ«ã®ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã«ä¼¼ã¦ã„ã¾ã™ã€‚</p>

        <h4>ä¾‹2ï¼šDataFrameã®ä½œæˆ</h4>
        <pre><code class="language-python">import pandas as pd

# è¾æ›¸ã‹ã‚‰DataFrameã‚’ä½œæˆ
data = {
    'åå‰': ['å¤ªéƒ', 'èŠ±å­', 'æ¬¡éƒ', 'æ¡ƒå­'],
    'å¹´é½¢': [25, 30, 22, 28],
    'éƒ½å¸‚': ['æ±äº¬', 'å¤§é˜ª', 'åå¤å±‹', 'ç¦å²¡'],
    'å¹´å': [450, 520, 380, 490]
}
df = pd.DataFrame(data)
print("DataFrame:")
print(df)
# å‡ºåŠ›:
#    åå‰  å¹´é½¢   éƒ½å¸‚  å¹´å
# 0  å¤ªéƒ  25   æ±äº¬  450
# 1  èŠ±å­  30   å¤§é˜ª  520
# 2  æ¬¡éƒ  22  åå¤å±‹  380
# 3  æ¡ƒå­  28   ç¦å²¡  490

# DataFrameã®æƒ…å ±
print("\nå½¢çŠ¶:", df.shape)  # (4, 4) = 4è¡Œ4åˆ—
print("åˆ—å:", df.columns.tolist())
print("ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹:", df.index.tolist())
print("ãƒ‡ãƒ¼ã‚¿å‹:")
print(df.dtypes)

# åŸºæœ¬çµ±è¨ˆé‡
print("\nçµ±è¨ˆé‡:")
print(df.describe())

# æœ€åˆã¨æœ€å¾Œã®æ•°è¡Œã‚’è¡¨ç¤º
print("\næœ€åˆã®2è¡Œ:")
print(df.head(2))

print("\næœ€å¾Œã®2è¡Œ:")
print(df.tail(2))

# æƒ…å ±ã®æ¦‚è¦
print("\nDataFrameæƒ…å ±:")
print(df.info())
</code></pre>

        <div class="mermaid">
graph LR
    A[Pandas] --> B[Series]
    A --> C[DataFrame]

    B --> D[1æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿]
    C --> E[2æ¬¡å…ƒè¡¨å½¢å¼]

    D --> F[ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä»˜ãé…åˆ—]
    E --> G[è¡Œã¨åˆ—ã‚’æŒã¤ãƒ†ãƒ¼ãƒ–ãƒ«]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5
        </div>

        <h2 id="csv">3. CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¨ä¿å­˜</h2>

        <h4>ä¾‹3ï¼šCSVæ“ä½œ</h4>
        <pre><code class="language-python">import pandas as pd

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
data = {
    'æ—¥ä»˜': ['2025-01-01', '2025-01-02', '2025-01-03', '2025-01-04'],
    'å•†å“': ['ã‚Šã‚“ã”', 'ãƒãƒŠãƒŠ', 'ã‚ªãƒ¬ãƒ³ã‚¸', 'ã‚Šã‚“ã”'],
    'æ•°é‡': [10, 15, 8, 12],
    'ä¾¡æ ¼': [100, 80, 120, 100]
}
df = pd.DataFrame(data)

# CSVãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
df.to_csv('sales.csv', index=False, encoding='utf-8')
print("CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚")

# CSVãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
df_loaded = pd.read_csv('sales.csv')
print("\nèª­ã¿è¾¼ã‚“ã ãƒ‡ãƒ¼ã‚¿:")
print(df_loaded)

# æ—¥ä»˜å‹ã«å¤‰æ›
df_loaded['æ—¥ä»˜'] = pd.to_datetime(df_loaded['æ—¥ä»˜'])
print("\næ—¥ä»˜å‹å¤‰æ›å¾Œ:")
print(df_loaded.dtypes)

# ç‰¹å®šã®åˆ—ã ã‘èª­ã¿è¾¼ã¿
df_partial = pd.read_csv('sales.csv', usecols=['å•†å“', 'æ•°é‡'])
print("\nç‰¹å®šåˆ—ã®ã¿:")
print(df_partial)

# ãƒ˜ãƒƒãƒ€ãƒ¼ãŒãªã„CSVã®èª­ã¿è¾¼ã¿
# pd.read_csv('data.csv', header=None, names=['col1', 'col2'])

# åŒºåˆ‡ã‚Šæ–‡å­—ãŒç•°ãªã‚‹å ´åˆ
# pd.read_csv('data.tsv', sep='\t')  # TSVãƒ•ã‚¡ã‚¤ãƒ«

# å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã‚’åˆ†å‰²ã—ã¦èª­ã¿è¾¼ã¿
# for chunk in pd.read_csv('large_file.csv', chunksize=1000):
#     process(chunk)
</code></pre>

        <h2 id="selection">4. ãƒ‡ãƒ¼ã‚¿ã®é¸æŠã¨æŠ½å‡º</h2>

        <h4>ä¾‹4ï¼šloc, iloc, boolean indexing</h4>
        <pre><code class="language-python">import pandas as pd

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
data = {
    'åå‰': ['å¤ªéƒ', 'èŠ±å­', 'æ¬¡éƒ', 'æ¡ƒå­', 'äº”éƒ'],
    'å¹´é½¢': [25, 30, 22, 28, 35],
    'éƒ½å¸‚': ['æ±äº¬', 'å¤§é˜ª', 'åå¤å±‹', 'ç¦å²¡', 'æ±äº¬'],
    'å¹´å': [450, 520, 380, 490, 600]
}
df = pd.DataFrame(data)
print("å…ƒãƒ‡ãƒ¼ã‚¿:")
print(df)

# åˆ—ã®é¸æŠ
print("\nå¹´é½¢åˆ—:")
print(df['å¹´é½¢'])

# è¤‡æ•°åˆ—ã®é¸æŠ
print("\nåå‰ã¨å¹´å:")
print(df[['åå‰', 'å¹´å']])

# loc: ãƒ©ãƒ™ãƒ«ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
print("\nã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0ã®è¡Œ:")
print(df.loc[0])

print("\nã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹0-2ã®åå‰ã¨å¹´é½¢:")
print(df.loc[0:2, ['åå‰', 'å¹´é½¢']])

# iloc: ä½ç½®ãƒ™ãƒ¼ã‚¹ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
print("\næœ€åˆã®2è¡Œã€æœ€åˆã®2åˆ—:")
print(df.iloc[0:2, 0:2])

# ãƒ–ãƒ¼ãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
print("\nå¹´é½¢30æ­³ä»¥ä¸Š:")
print(df[df['å¹´é½¢'] >= 30])

print("\næ±äº¬åœ¨ä½:")
print(df[df['éƒ½å¸‚'] == 'æ±äº¬'])

# è¤‡æ•°æ¡ä»¶ï¼ˆ&: ANDã€|: ORï¼‰
print("\næ±äº¬åœ¨ä½ã‹ã¤å¹´å500ä¸‡ä»¥ä¸Š:")
print(df[(df['éƒ½å¸‚'] == 'æ±äº¬') & (df['å¹´å'] >= 500)])

# isin(): è¤‡æ•°ã®å€¤ã®ã„ãšã‚Œã‹ã«ä¸€è‡´
cities = ['æ±äº¬', 'å¤§é˜ª']
print("\næ±äº¬ã¾ãŸã¯å¤§é˜ªåœ¨ä½:")
print(df[df['éƒ½å¸‚'].isin(cities)])

# æ–‡å­—åˆ—æ“ä½œ
print("\nåå‰ã«ã€Œå­ã€ãŒå«ã¾ã‚Œã‚‹:")
print(df[df['åå‰'].str.contains('å­')])
</code></pre>

        <h2 id="cleaning">5. ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆæ¬ æå€¤å‡¦ç†ï¼‰</h2>

        <h4>ä¾‹5ï¼šæ¬ æå€¤ã®å‡¦ç†</h4>
        <pre><code class="language-python">import pandas as pd
import numpy as np

# æ¬ æå€¤ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿
data = {
    'åå‰': ['å¤ªéƒ', 'èŠ±å­', None, 'æ¡ƒå­', 'äº”éƒ'],
    'å¹´é½¢': [25, 30, 22, np.nan, 35],
    'å¹´å': [450, np.nan, 380, 490, 600]
}
df = pd.DataFrame(data)
print("æ¬ æå€¤ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿:")
print(df)

# æ¬ æå€¤ã®ç¢ºèª
print("\næ¬ æå€¤ã®æ•°:")
print(df.isnull().sum())

print("\næ¬ æå€¤ãŒã‚ã‚‹ã‹ï¼ˆè¡Œã”ã¨ï¼‰:")
print(df.isnull().any(axis=1))

# æ¬ æå€¤ã‚’å«ã‚€è¡Œã‚’å‰Šé™¤
df_dropped = df.dropna()
print("\næ¬ æå€¤ã‚’å«ã‚€è¡Œã‚’å‰Šé™¤:")
print(df_dropped)

# æ¬ æå€¤ã‚’å«ã‚€åˆ—ã‚’å‰Šé™¤
df_dropped_col = df.dropna(axis=1)
print("\næ¬ æå€¤ã‚’å«ã‚€åˆ—ã‚’å‰Šé™¤:")
print(df_dropped_col)

# æ¬ æå€¤ã‚’ç‰¹å®šã®å€¤ã§åŸ‹ã‚ã‚‹
df_filled = df.fillna(0)
print("\næ¬ æå€¤ã‚’0ã§åŸ‹ã‚ã‚‹:")
print(df_filled)

# åˆ—ã”ã¨ã«ç•°ãªã‚‹å€¤ã§åŸ‹ã‚ã‚‹
df_filled2 = df.fillna({'åå‰': 'æœªè¨˜å…¥', 'å¹´é½¢': df['å¹´é½¢'].mean(), 'å¹´å': df['å¹´å'].median()})
print("\nåˆ—ã”ã¨ã«ç•°ãªã‚‹å€¤ã§åŸ‹ã‚ã‚‹:")
print(df_filled2)

# å‰æ–¹åŸ‹ã‚ãƒ»å¾Œæ–¹åŸ‹ã‚
df_ffill = df.fillna(method='ffill')  # å‰ã®å€¤ã§åŸ‹ã‚ã‚‹
df_bfill = df.fillna(method='bfill')  # æ¬¡ã®å€¤ã§åŸ‹ã‚ã‚‹

# é‡è¤‡ã®å‡¦ç†
data_dup = {
    'åå‰': ['å¤ªéƒ', 'èŠ±å­', 'å¤ªéƒ', 'æ¬¡éƒ'],
    'å¹´é½¢': [25, 30, 25, 22]
}
df_dup = pd.DataFrame(data_dup)
print("\né‡è¤‡ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿:")
print(df_dup)

print("\né‡è¤‡ã®ç¢ºèª:")
print(df_dup.duplicated())

print("\né‡è¤‡ã‚’å‰Šé™¤:")
print(df_dup.drop_duplicates())
</code></pre>

        <div class="mermaid">
graph TD
    A[æ¬ æå€¤å‡¦ç†] --> B[å‰Šé™¤]
    A --> C[è£œå®Œ]

    B --> D[dropna è¡Œå‰Šé™¤]
    B --> E[dropna åˆ—å‰Šé™¤]

    C --> F[å›ºå®šå€¤ã§åŸ‹ã‚ã‚‹]
    C --> G[çµ±è¨ˆé‡ã§åŸ‹ã‚ã‚‹]
    C --> H[å‰å¾Œã®å€¤ã§åŸ‹ã‚ã‚‹]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5
        </div>

        <h2 id="transformation">6. ãƒ‡ãƒ¼ã‚¿å¤‰æ›</h2>

        <h4>ä¾‹6ï¼šapply, map, replace</h4>
        <pre><code class="language-python">import pandas as pd

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
data = {
    'åå‰': ['å¤ªéƒ', 'èŠ±å­', 'æ¬¡éƒ', 'æ¡ƒå­'],
    'å¹´é½¢': [25, 30, 22, 28],
    'å¹´å': [450, 520, 380, 490]
}
df = pd.DataFrame(data)
print("å…ƒãƒ‡ãƒ¼ã‚¿:")
print(df)

# apply: é–¢æ•°ã‚’é©ç”¨
df['å¹´åï¼ˆåƒå††ï¼‰'] = df['å¹´å'].apply(lambda x: x * 1000)
print("\nå¹´åã‚’åƒå††å˜ä½ã«å¤‰æ›:")
print(df)

# å¹´é½¢ã‚«ãƒ†ã‚´ãƒªã‚’è¿½åŠ 
def age_category(age):
    if age < 25:
        return 'è‹¥æ‰‹'
    elif age < 30:
        return 'ä¸­å …'
    else:
        return 'ãƒ™ãƒ†ãƒ©ãƒ³'

df['ã‚«ãƒ†ã‚´ãƒª'] = df['å¹´é½¢'].apply(age_category)
print("\nå¹´é½¢ã‚«ãƒ†ã‚´ãƒªã‚’è¿½åŠ :")
print(df)

# map: è¾æ›¸ã§ãƒãƒƒãƒ”ãƒ³ã‚°
name_english = {'å¤ªéƒ': 'Taro', 'èŠ±å­': 'Hanako', 'æ¬¡éƒ': 'Jiro', 'æ¡ƒå­': 'Momoko'}
df['è‹±å'] = df['åå‰'].map(name_english)
print("\nè‹±åã‚’è¿½åŠ :")
print(df)

# replace: å€¤ã®ç½®æ›
df_replaced = df.replace({'ã‚«ãƒ†ã‚´ãƒª': {'è‹¥æ‰‹': 'Junior', 'ä¸­å …': 'Mid', 'ãƒ™ãƒ†ãƒ©ãƒ³': 'Senior'}})
print("\nã‚«ãƒ†ã‚´ãƒªã‚’è‹±èªã«:")
print(df_replaced)

# æ–°ã—ã„åˆ—ã‚’è¿½åŠ ï¼ˆè¨ˆç®—ï¼‰
df['ç¨å¼•å¾Œå¹´å'] = df['å¹´å'] * 0.8
print("\nç¨å¼•å¾Œå¹´åã‚’è¿½åŠ :")
print(df[['åå‰', 'å¹´å', 'ç¨å¼•å¾Œå¹´å']])

# åˆ—ã®å‰Šé™¤
df_dropped = df.drop(['å¹´åï¼ˆåƒå††ï¼‰', 'è‹±å'], axis=1)
print("\nä¸è¦ãªåˆ—ã‚’å‰Šé™¤:")
print(df_dropped)

# åˆ—åã®å¤‰æ›´
df_renamed = df.rename(columns={'å¹´é½¢': 'Age', 'å¹´å': 'Salary'})
print("\nåˆ—åã‚’å¤‰æ›´:")
print(df_renamed)
</code></pre>

        <h2 id="groupby">7. ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã¨é›†è¨ˆ</h2>

        <h4>ä¾‹7ï¼šgroupbyã¨agg</h4>
        <pre><code class="language-python">import pandas as pd

# å£²ä¸Šãƒ‡ãƒ¼ã‚¿
data = {
    'æ—¥ä»˜': ['2025-01-01', '2025-01-01', '2025-01-02', '2025-01-02', '2025-01-03'],
    'å•†å“': ['ã‚Šã‚“ã”', 'ãƒãƒŠãƒŠ', 'ã‚Šã‚“ã”', 'ã‚ªãƒ¬ãƒ³ã‚¸', 'ãƒãƒŠãƒŠ'],
    'åº—èˆ—': ['æ±äº¬', 'æ±äº¬', 'å¤§é˜ª', 'æ±äº¬', 'å¤§é˜ª'],
    'æ•°é‡': [10, 15, 12, 8, 20],
    'å£²ä¸Š': [1000, 1200, 1200, 960, 1600]
}
df = pd.DataFrame(data)
print("å£²ä¸Šãƒ‡ãƒ¼ã‚¿:")
print(df)

# å•†å“ã”ã¨ã®é›†è¨ˆ
print("\nå•†å“ã”ã¨ã®å£²ä¸Šåˆè¨ˆ:")
print(df.groupby('å•†å“')['å£²ä¸Š'].sum())

# è¤‡æ•°ã®çµ±è¨ˆé‡
print("\nå•†å“ã”ã¨ã®çµ±è¨ˆ:")
print(df.groupby('å•†å“').agg({
    'æ•°é‡': 'sum',
    'å£²ä¸Š': ['sum', 'mean', 'count']
}))

# è¤‡æ•°åˆ—ã§ã‚°ãƒ«ãƒ¼ãƒ—åŒ–
print("\nå•†å“Ã—åº—èˆ—ã”ã¨ã®é›†è¨ˆ:")
grouped = df.groupby(['å•†å“', 'åº—èˆ—'])['å£²ä¸Š'].sum()
print(grouped)

# ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«
print("\nãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«:")
pivot = df.pivot_table(
    values='å£²ä¸Š',
    index='å•†å“',
    columns='åº—èˆ—',
    aggfunc='sum',
    fill_value=0
)
print(pivot)

# ã‚«ã‚¹ã‚¿ãƒ é›†è¨ˆé–¢æ•°
print("\nå•†å“ã”ã¨ã®å£²ä¸Šç¯„å›²:")
print(df.groupby('å•†å“')['å£²ä¸Š'].agg(lambda x: x.max() - x.min()))

# é›†è¨ˆå¾Œã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
print("\nåˆè¨ˆå£²ä¸ŠãŒ2000ä»¥ä¸Šã®å•†å“:")
grouped_filtered = df.groupby('å•†å“')['å£²ä¸Š'].sum()
print(grouped_filtered[grouped_filtered >= 2000])
</code></pre>

        <h2 id="merge">8. ãƒ‡ãƒ¼ã‚¿ã®çµåˆ</h2>

        <h4>ä¾‹8ï¼šmerge, concat</h4>
        <pre><code class="language-python">import pandas as pd

# é¡§å®¢ãƒ‡ãƒ¼ã‚¿
customers = pd.DataFrame({
    'é¡§å®¢ID': [1, 2, 3, 4],
    'åå‰': ['å¤ªéƒ', 'èŠ±å­', 'æ¬¡éƒ', 'æ¡ƒå­']
})

# æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿
orders = pd.DataFrame({
    'æ³¨æ–‡ID': [101, 102, 103, 104],
    'é¡§å®¢ID': [1, 2, 1, 3],
    'é‡‘é¡': [5000, 3000, 7000, 4500]
})

print("é¡§å®¢ãƒ‡ãƒ¼ã‚¿:")
print(customers)
print("\næ³¨æ–‡ãƒ‡ãƒ¼ã‚¿:")
print(orders)

# merge: çµåˆ
merged = pd.merge(customers, orders, on='é¡§å®¢ID', how='inner')
print("\nå†…éƒ¨çµåˆ (inner join):")
print(merged)

# å·¦å¤–éƒ¨çµåˆ
merged_left = pd.merge(customers, orders, on='é¡§å®¢ID', how='left')
print("\nå·¦å¤–éƒ¨çµåˆ (left join):")
print(merged_left)

# å³å¤–éƒ¨çµåˆ
merged_right = pd.merge(customers, orders, on='é¡§å®¢ID', how='right')
print("\nå³å¤–éƒ¨çµåˆ (right join):")
print(merged_right)

# å®Œå…¨å¤–éƒ¨çµåˆ
merged_outer = pd.merge(customers, orders, on='é¡§å®¢ID', how='outer')
print("\nå®Œå…¨å¤–éƒ¨çµåˆ (outer join):")
print(merged_outer)

# concat: ç¸¦æ–¹å‘ã®é€£çµ
df1 = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})
df2 = pd.DataFrame({'A': [5, 6], 'B': [7, 8]})

concatenated = pd.concat([df1, df2], ignore_index=True)
print("\nç¸¦æ–¹å‘ã®é€£çµ:")
print(concatenated)

# æ¨ªæ–¹å‘ã®é€£çµ
concatenated_h = pd.concat([df1, df2], axis=1)
print("\næ¨ªæ–¹å‘ã®é€£çµ:")
print(concatenated_h)
</code></pre>

        <div class="mermaid">
graph LR
    A[ãƒ‡ãƒ¼ã‚¿çµåˆ] --> B[merge]
    A --> C[concat]

    B --> D[inner join]
    B --> E[left join]
    B --> F[right join]
    B --> G[outer join]

    C --> H[ç¸¦æ–¹å‘ axis=0]
    C --> I[æ¨ªæ–¹å‘ axis=1]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5
        </div>

        <h2 id="visualization">9. ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ã®åŸºç¤</h2>

        <h4>ä¾‹9ï¼šmatplotlibã¨ã®é€£æº</h4>
        <pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

# æœˆåˆ¥å£²ä¸Šãƒ‡ãƒ¼ã‚¿
data = {
    'æœˆ': ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ'],
    'å£²ä¸Š': [120, 135, 150, 142, 168, 175],
    'åˆ©ç›Š': [30, 35, 42, 38, 48, 52]
}
df = pd.DataFrame(data)

# æŠ˜ã‚Œç·šã‚°ãƒ©ãƒ•
df.plot(x='æœˆ', y='å£²ä¸Š', kind='line', marker='o', title='æœˆåˆ¥å£²ä¸Šæ¨ç§»')
plt.xlabel('æœˆ')
plt.ylabel('å£²ä¸Šï¼ˆä¸‡å††ï¼‰')
# plt.savefig('sales_trend.png')
# plt.show()

# è¤‡æ•°ç³»åˆ—
df.plot(x='æœˆ', y=['å£²ä¸Š', 'åˆ©ç›Š'], kind='line', marker='o', title='æœˆåˆ¥å£²ä¸Šã¨åˆ©ç›Š')
# plt.show()

# æ£’ã‚°ãƒ©ãƒ•
df.plot(x='æœˆ', y='å£²ä¸Š', kind='bar', title='æœˆåˆ¥å£²ä¸Šï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰')
# plt.show()

# ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ 
np.random.seed(42)
scores = pd.DataFrame({'ç‚¹æ•°': np.random.normal(70, 10, 100)})
scores.plot(kind='hist', bins=20, title='ç‚¹æ•°åˆ†å¸ƒ', edgecolor='black')
plt.xlabel('ç‚¹æ•°')
plt.ylabel('äººæ•°')
# plt.show()

# æ•£å¸ƒå›³
data_scatter = {
    'å‹‰å¼·æ™‚é–“': [1, 2, 3, 4, 5, 6, 7, 8],
    'ç‚¹æ•°': [50, 55, 65, 70, 75, 80, 85, 90]
}
df_scatter = pd.DataFrame(data_scatter)
df_scatter.plot(kind='scatter', x='å‹‰å¼·æ™‚é–“', y='ç‚¹æ•°', title='å‹‰å¼·æ™‚é–“ã¨ç‚¹æ•°ã®é–¢ä¿‚')
# plt.show()

# ãƒœãƒƒã‚¯ã‚¹ãƒ—ãƒ­ãƒƒãƒˆ
data_box = {
    'ã‚¯ãƒ©ã‚¹A': np.random.normal(75, 10, 30),
    'ã‚¯ãƒ©ã‚¹B': np.random.normal(70, 15, 30),
    'ã‚¯ãƒ©ã‚¹C': np.random.normal(80, 8, 30)
}
df_box = pd.DataFrame(data_box)
df_box.plot(kind='box', title='ã‚¯ãƒ©ã‚¹åˆ¥ç‚¹æ•°åˆ†å¸ƒ')
# plt.show()

print("ã‚°ãƒ©ãƒ•ã‚’ç”Ÿæˆã—ã¾ã—ãŸã€‚")
</code></pre>

        <h2 id="practical">10. å®Ÿè·µä¾‹ï¼šãƒ‡ãƒ¼ã‚¿åˆ†æãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h2>

        <h4>ä¾‹10ï¼šç·åˆçš„ãªãƒ‡ãƒ¼ã‚¿åˆ†æ</h4>
        <pre><code class="language-python">import pandas as pd
import numpy as np

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆï¼ˆå¾“æ¥­å“¡ãƒ‡ãƒ¼ã‚¿ï¼‰
np.random.seed(42)
n = 100

data = {
    'å¾“æ¥­å“¡ID': range(1, n + 1),
    'åå‰': [f'ç¤¾å“¡{i}' for i in range(1, n + 1)],
    'éƒ¨ç½²': np.random.choice(['å–¶æ¥­', 'é–‹ç™º', 'äººäº‹', 'è²¡å‹™'], n),
    'å¹´é½¢': np.random.randint(22, 60, n),
    'å‹¤ç¶šå¹´æ•°': np.random.randint(1, 30, n),
    'å¹´å': np.random.randint(300, 1000, n),
    'è©•ä¾¡': np.random.choice(['A', 'B', 'C', 'D'], n, p=[0.1, 0.3, 0.4, 0.2])
}
df = pd.DataFrame(data)

# æ¬ æå€¤ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«è¿½åŠ 
df.loc[np.random.choice(df.index, 5), 'å¹´å'] = np.nan

print("=== 1. ãƒ‡ãƒ¼ã‚¿ã®æ¦‚è¦ ===")
print(f"ãƒ‡ãƒ¼ã‚¿å½¢çŠ¶: {df.shape}")
print(f"\næœ€åˆã®5è¡Œ:")
print(df.head())

print("\n=== 2. ãƒ‡ãƒ¼ã‚¿å‹ã¨æ¬ æå€¤ ===")
print(df.info())

print("\n=== 3. æ¬ æå€¤å‡¦ç† ===")
print(f"æ¬ æå€¤ã®æ•°: {df.isnull().sum().sum()}")
df['å¹´å'] = df['å¹´å'].fillna(df['å¹´å'].median())
print(f"è£œå®Œå¾Œã®æ¬ æå€¤: {df.isnull().sum().sum()}")

print("\n=== 4. åŸºæœ¬çµ±è¨ˆé‡ ===")
print(df.describe())

print("\n=== 5. éƒ¨ç½²åˆ¥åˆ†æ ===")
dept_analysis = df.groupby('éƒ¨ç½²').agg({
    'å¹´é½¢': 'mean',
    'å‹¤ç¶šå¹´æ•°': 'mean',
    'å¹´å': ['mean', 'median', 'count']
})
print(dept_analysis)

print("\n=== 6. è©•ä¾¡åˆ¥åˆ†æ ===")
rating_analysis = df.groupby('è©•ä¾¡')['å¹´å'].describe()
print(rating_analysis)

print("\n=== 7. ç›¸é–¢åˆ†æ ===")
correlation = df[['å¹´é½¢', 'å‹¤ç¶šå¹´æ•°', 'å¹´å']].corr()
print(correlation)

print("\n=== 8. é«˜å¹´åè€…ã®æŠ½å‡º ===")
high_earners = df[df['å¹´å'] >= 800]
print(f"å¹´å800ä¸‡ä»¥ä¸Š: {len(high_earners)}å")
print(high_earners[['åå‰', 'éƒ¨ç½²', 'å¹´å', 'è©•ä¾¡']])

print("\n=== 9. éƒ¨ç½²Ã—è©•ä¾¡ã®ã‚¯ãƒ­ã‚¹é›†è¨ˆ ===")
crosstab = pd.crosstab(df['éƒ¨ç½²'], df['è©•ä¾¡'])
print(crosstab)

print("\n=== 10. ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ ===")
# åˆ†æçµæœã‚’CSVã«ä¿å­˜
df.to_csv('employee_data.csv', index=False, encoding='utf-8')
dept_analysis.to_csv('dept_analysis.csv', encoding='utf-8')
print("åˆ†æçµæœã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚")
</code></pre>

        <h2 id="summary">ã¾ã¨ã‚</h2>
        <p>ã“ã®ç« ã§ã¯ã€Pandasã®åŸºç¤ã‚’å­¦ã³ã¾ã—ãŸï¼š</p>

        <ul>
            <li>âœ… <strong>Series/DataFrame</strong>: åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ </li>
            <li>âœ… <strong>CSVæ“ä½œ</strong>: read_csv, to_csv</li>
            <li>âœ… <strong>ãƒ‡ãƒ¼ã‚¿é¸æŠ</strong>: loc, iloc, boolean indexing</li>
            <li>âœ… <strong>æ¬ æå€¤å‡¦ç†</strong>: dropna, fillna</li>
            <li>âœ… <strong>ãƒ‡ãƒ¼ã‚¿å¤‰æ›</strong>: apply, map, replace</li>
            <li>âœ… <strong>é›†è¨ˆ</strong>: groupby, agg, pivot_table</li>
            <li>âœ… <strong>çµåˆ</strong>: merge, concat</li>
            <li>âœ… <strong>å¯è¦–åŒ–</strong>: plotï¼ˆmatplotlibé€£æºï¼‰</li>
        </ul>

        <p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</strong>: ç¬¬4ç« ã§ã¯ã€ã“ã‚Œã¾ã§å­¦ã‚“ã Pythonã€NumPyã€Pandasã®çŸ¥è­˜ã‚’ä½¿ã£ã¦ã€æ©Ÿæ¢°å­¦ç¿’ã®æ¦‚è¦ã‚’å­¦ã³ã¾ã™ã€‚</p>

        <h2 id="exercises">æ¼”ç¿’å•é¡Œ</h2>

        <details>
            <summary>æ¼”ç¿’1ï¼šDataFrameæ“ä½œ</summary>
            <p><strong>å•é¡Œ</strong>: ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰DataFrameã‚’ä½œæˆã—ã€(1) å¹³å‡ç‚¹ãŒ80ç‚¹ä»¥ä¸Šã®å­¦ç”Ÿã‚’æŠ½å‡ºã€(2) å„ç§‘ç›®ã®å¹³å‡ç‚¹ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>
            <pre><code class="language-python"># ãƒ‡ãƒ¼ã‚¿
data = {
    'åå‰': ['å¤ªéƒ', 'èŠ±å­', 'æ¬¡éƒ', 'æ¡ƒå­', 'äº”éƒ'],
    'æ•°å­¦': [85, 92, 78, 88, 95],
    'è‹±èª': [78, 88, 82, 90, 85],
    'å›½èª': [82, 85, 75, 92, 88]
}

# è§£ç­”ä¾‹
import pandas as pd

df = pd.DataFrame(data)
print("å­¦ç”Ÿãƒ‡ãƒ¼ã‚¿:")
print(df)

# (1) å¹³å‡ç‚¹ã‚’è¨ˆç®—
df['å¹³å‡'] = df[['æ•°å­¦', 'è‹±èª', 'å›½èª']].mean(axis=1)
print("\nå¹³å‡ç‚¹è¿½åŠ :")
print(df)

# å¹³å‡80ç‚¹ä»¥ä¸Š
high_scorers = df[df['å¹³å‡'] >= 80]
print("\nå¹³å‡80ç‚¹ä»¥ä¸Šã®å­¦ç”Ÿ:")
print(high_scorers)

# (2) å„ç§‘ç›®ã®å¹³å‡
subject_avg = df[['æ•°å­¦', 'è‹±èª', 'å›½èª']].mean()
print("\nå„ç§‘ç›®ã®å¹³å‡ç‚¹:")
print(subject_avg)
</code></pre>
        </details>

        <details>
            <summary>æ¼”ç¿’2ï¼šæ¬ æå€¤å‡¦ç†</summary>
            <p><strong>å•é¡Œ</strong>: ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã§ã€æ¬ æå€¤ã‚’(1) å„åˆ—ã®å¹³å‡å€¤ã§è£œå®Œã—ã€(2) è£œå®Œå‰å¾Œã®çµ±è¨ˆé‡ã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚</p>
            <pre><code class="language-python">import pandas as pd
import numpy as np

# æ¬ æå€¤ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿
data = {
    'A': [1, 2, np.nan, 4, 5],
    'B': [10, np.nan, 30, 40, 50],
    'C': [100, 200, 300, np.nan, 500]
}
df = pd.DataFrame(data)

# è§£ç­”ä¾‹
print("å…ƒãƒ‡ãƒ¼ã‚¿:")
print(df)

print("\nè£œå®Œå‰ã®çµ±è¨ˆé‡:")
print(df.describe())

# å¹³å‡å€¤ã§è£œå®Œ
df_filled = df.fillna(df.mean())
print("\nè£œå®Œå¾Œã®ãƒ‡ãƒ¼ã‚¿:")
print(df_filled)

print("\nè£œå®Œå¾Œã®çµ±è¨ˆé‡:")
print(df_filled.describe())

print("\nå¤‰åŒ–:")
for col in df.columns:
    before = df[col].mean()
    after = df_filled[col].mean()
    print(f"{col}åˆ—ã®å¹³å‡: {before:.2f} â†’ {after:.2f}")
</code></pre>
        </details>

        <details>
            <summary>æ¼”ç¿’3ï¼šã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã¨é›†è¨ˆ</summary>
            <p><strong>å•é¡Œ</strong>: ä»¥ä¸‹ã®å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’(1) åº—èˆ—ã”ã¨ã«é›†è¨ˆã—ã€(2) å•†å“ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®å£²ä¸Šä¸Šä½3åº—èˆ—ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ã€‚</p>
            <pre><code class="language-python">import pandas as pd

data = {
    'åº—èˆ—': ['A', 'B', 'A', 'C', 'B', 'C', 'A', 'B'],
    'ã‚«ãƒ†ã‚´ãƒª': ['é£Ÿå“', 'é£Ÿå“', 'è¡£æ–™', 'é£Ÿå“', 'è¡£æ–™', 'è¡£æ–™', 'é£Ÿå“', 'é£Ÿå“'],
    'å£²ä¸Š': [100, 150, 200, 120, 180, 220, 110, 160]
}
df = pd.DataFrame(data)

# è§£ç­”ä¾‹
print("å£²ä¸Šãƒ‡ãƒ¼ã‚¿:")
print(df)

# (1) åº—èˆ—ã”ã¨ã®é›†è¨ˆ
store_summary = df.groupby('åº—èˆ—')['å£²ä¸Š'].agg(['sum', 'mean', 'count'])
print("\nåº—èˆ—ã”ã¨ã®é›†è¨ˆ:")
print(store_summary)

# (2) ã‚«ãƒ†ã‚´ãƒªÃ—åº—èˆ—ã®ãƒ”ãƒœãƒƒãƒˆ
pivot = df.pivot_table(values='å£²ä¸Š', index='ã‚«ãƒ†ã‚´ãƒª', columns='åº—èˆ—', aggfunc='sum', fill_value=0)
print("\nã‚«ãƒ†ã‚´ãƒªÃ—åº—èˆ—ãƒ”ãƒœãƒƒãƒˆ:")
print(pivot)

# å„ã‚«ãƒ†ã‚´ãƒªã®ä¸Šä½3åº—èˆ—
print("\nã‚«ãƒ†ã‚´ãƒªåˆ¥ä¸Šä½åº—èˆ—:")
for category in df['ã‚«ãƒ†ã‚´ãƒª'].unique():
    cat_data = df[df['ã‚«ãƒ†ã‚´ãƒª'] == category]
    top3 = cat_data.groupby('åº—èˆ—')['å£²ä¸Š'].sum().nlargest(3)
    print(f"\n{category}:")
    print(top3)
</code></pre>
        </details>

        <details>
            <summary>æ¼”ç¿’4ï¼šãƒ‡ãƒ¼ã‚¿çµåˆ</summary>
            <p><strong>å•é¡Œ</strong>: é¡§å®¢ãƒã‚¹ã‚¿ã¨æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‚’çµåˆã—ã€å„é¡§å®¢ã®æ³¨æ–‡å›æ•°ã¨åˆè¨ˆé‡‘é¡ã‚’é›†è¨ˆã—ã¦ãã ã•ã„ã€‚</p>
            <pre><code class="language-python">import pandas as pd

# é¡§å®¢ãƒã‚¹ã‚¿
customers = pd.DataFrame({
    'é¡§å®¢ID': [1, 2, 3, 4, 5],
    'åå‰': ['å¤ªéƒ', 'èŠ±å­', 'æ¬¡éƒ', 'æ¡ƒå­', 'äº”éƒ'],
    'ä¼šå“¡ãƒ©ãƒ³ã‚¯': ['Gold', 'Silver', 'Gold', 'Bronze', 'Silver']
})

# æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿
orders = pd.DataFrame({
    'æ³¨æ–‡ID': [101, 102, 103, 104, 105, 106],
    'é¡§å®¢ID': [1, 2, 1, 3, 2, 1],
    'é‡‘é¡': [5000, 3000, 7000, 4500, 2000, 6000]
})

# è§£ç­”ä¾‹
print("é¡§å®¢ãƒã‚¹ã‚¿:")
print(customers)
print("\næ³¨æ–‡ãƒ‡ãƒ¼ã‚¿:")
print(orders)

# çµåˆ
merged = pd.merge(customers, orders, on='é¡§å®¢ID', how='left')
print("\nçµåˆå¾Œ:")
print(merged)

# é¡§å®¢ã”ã¨ã®é›†è¨ˆ
customer_summary = merged.groupby(['é¡§å®¢ID', 'åå‰', 'ä¼šå“¡ãƒ©ãƒ³ã‚¯'])['é‡‘é¡'].agg(['count', 'sum'])
customer_summary.columns = ['æ³¨æ–‡å›æ•°', 'åˆè¨ˆé‡‘é¡']
customer_summary = customer_summary.reset_index()
print("\né¡§å®¢åˆ¥é›†è¨ˆ:")
print(customer_summary)

# ä¼šå“¡ãƒ©ãƒ³ã‚¯åˆ¥ã®é›†è¨ˆ
rank_summary = customer_summary.groupby('ä¼šå“¡ãƒ©ãƒ³ã‚¯')['åˆè¨ˆé‡‘é¡'].mean()
print("\nä¼šå“¡ãƒ©ãƒ³ã‚¯åˆ¥å¹³å‡è³¼å…¥é¡:")
print(rank_summary)
</code></pre>
        </details>

        <details>
            <summary>æ¼”ç¿’5ï¼šç·åˆå•é¡Œ</summary>
            <p><strong>å•é¡Œ</strong>: æœˆåˆ¥å£²ä¸Šãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€(1) å‰æœˆæ¯”æˆé•·ç‡ã‚’è¨ˆç®—ã€(2) 3ãƒ¶æœˆç§»å‹•å¹³å‡ã‚’è¨ˆç®—ã€(3) ã‚°ãƒ©ãƒ•ã§å¯è¦–åŒ–ã—ã¦ãã ã•ã„ã€‚</p>
            <pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt

data = {
    'æœˆ': ['2024-01', '2024-02', '2024-03', '2024-04', '2024-05', '2024-06'],
    'å£²ä¸Š': [120, 135, 150, 142, 168, 175]
}
df = pd.DataFrame(data)

# è§£ç­”ä¾‹
print("æœˆåˆ¥å£²ä¸Š:")
print(df)

# (1) å‰æœˆæ¯”æˆé•·ç‡
df['å‰æœˆæ¯”'] = df['å£²ä¸Š'].pct_change() * 100
print("\nå‰æœˆæ¯”æˆé•·ç‡:")
print(df)

# (2) 3ãƒ¶æœˆç§»å‹•å¹³å‡
df['3ãƒ¶æœˆç§»å‹•å¹³å‡'] = df['å£²ä¸Š'].rolling(window=3).mean()
print("\nç§»å‹•å¹³å‡è¿½åŠ :")
print(df)

# (3) å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
plt.plot(df['æœˆ'], df['å£²ä¸Š'], marker='o', label='å£²ä¸Š')
plt.plot(df['æœˆ'], df['3ãƒ¶æœˆç§»å‹•å¹³å‡'], marker='s', linestyle='--', label='3ãƒ¶æœˆç§»å‹•å¹³å‡')
plt.xlabel('æœˆ')
plt.ylabel('å£²ä¸Šï¼ˆä¸‡å††ï¼‰')
plt.title('æœˆåˆ¥å£²ä¸Šæ¨ç§»')
plt.legend()
plt.xticks(rotation=45)
plt.grid(True, alpha=0.3)
plt.tight_layout()
# plt.savefig('sales_analysis.png')
# plt.show()

print("\nã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¾ã—ãŸã€‚")
</code></pre>
        </details>

        <div class="nav-buttons">
            <a href="./chapter2-numpy-basics.html" class="nav-button">â† ç¬¬2ç« : NumPyåŸºç¤</a>
            <a href="./chapter4-ml-overview.html" class="nav-button">ç¬¬4ç« : æ©Ÿæ¢°å­¦ç¿’ã®æ¦‚è¦ â†’</a>
        </div>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 AI Terakoya - Dr. Yusuke Hashimoto, Tohoku University</p>
            <p>Licensed under CC BY 4.0</p>
        </div>
    </footer>
</body>
</html>
