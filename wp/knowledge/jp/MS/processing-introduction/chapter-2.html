<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« ï¼šç†±å‡¦ç†ãƒ—ãƒ­ã‚»ã‚¹ - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .exercise-box {
            background-color: #fff7ed;
            border-left: 4px solid #fb923c;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .exercise-box h4 {
            color: #c2410c;
            margin-top: 0;
        }

        .solution-box {
            background-color: #f0fdf4;
            border-left: 4px solid #22c55e;
            padding: var(--spacing-md);
            margin-top: var(--spacing-sm);
            border-radius: var(--border-radius);
        }

        .solution-box summary {
            cursor: pointer;
            font-weight: 600;
            color: #15803d;
            margin-bottom: var(--spacing-sm);
        }

        .breadcrumb {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .breadcrumb a {
            color: var(--color-link);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬2ç« ï¼šç†±å‡¦ç†ãƒ—ãƒ­ã‚»ã‚¹</h1>
            <p class="subtitle">Annealing, Quenching & Tempering, Age Hardening, TTT/CCT Diagrams</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 40-50åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 7å€‹</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">ãƒ—ãƒ­ã‚»ã‚¹æŠ€è¡“å…¥é–€</a> &gt;
        ç¬¬2ç« 
    </div>

    <main class="container">
        <p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); border-left: 4px solid #f093fb; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">
            ç†±å‡¦ç†ãƒ—ãƒ­ã‚»ã‚¹ã¯ã€ææ–™ã®æ©Ÿæ¢°çš„æ€§è³ªï¼ˆå¼·åº¦ã€ç¡¬åº¦ã€é±æ€§ï¼‰ã‚’åˆ¶å¾¡ã™ã‚‹ä¸­æ ¸æŠ€è¡“ã§ã™ã€‚åŠ ç†±ãƒ»ä¿æŒãƒ»å†·å´ã®æ¸©åº¦å±¥æ­´ã«ã‚ˆã‚Šã€ç›¸å¤‰æ…‹ã€æ‹¡æ•£ã€æå‡ºã‚’åˆ¶å¾¡ã—ã€ç›®æ¨™ç‰¹æ€§ã‚’å®Ÿç¾ã—ã¾ã™ã€‚ã“ã®ç« ã§ã¯ã€ç„¼éˆã€ç„¼å…¥ã‚Œãƒ»ç„¼æˆ»ã—ã€æ™‚åŠ¹ç¡¬åŒ–ã®åŸç†ã‚’Pythonã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§å­¦ã³ã€TTT/CCTå›³ã‚’æ´»ç”¨ã—ãŸå®Ÿè·µçš„ãªç†±å‡¦ç†è¨­è¨ˆã‚’ç¿’å¾—ã—ã¾ã™ã€‚
        </p>

        <div class="learning-objectives">
            <h2>å­¦ç¿’ç›®æ¨™</h2>
            <p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
            <ul>
                <li>âœ… ç„¼éˆï¼ˆAnnealingï¼‰ã®ç¨®é¡ï¼ˆå®Œå…¨ç„¼éˆã€å¿œåŠ›é™¤å»ç„¼éˆã€å†çµæ™¶ï¼‰ã¨åŠ¹æœã‚’ç†è§£ã™ã‚‹</li>
                <li>âœ… ç„¼å…¥ã‚Œï¼ˆQuenchingï¼‰ã®å†·å´é€Ÿåº¦ã¨çµ„ç¹”ï¼ˆãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆã€ãƒ™ã‚¤ãƒŠã‚¤ãƒˆï¼‰ã®é–¢ä¿‚ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… Jominyè©¦é¨“ã«ã‚ˆã‚‹ç„¼å…¥æ€§ï¼ˆHardenabilityï¼‰è©•ä¾¡ã‚’å®Ÿæ–½ã§ãã‚‹</li>
                <li>âœ… ç„¼æˆ»ã—ï¼ˆTemperingï¼‰ã«ã‚ˆã‚‹ç¡¬åº¦ã¨é±æ€§ã®ãƒãƒ©ãƒ³ã‚¹è¨­è¨ˆã‚’ç†è§£ã™ã‚‹</li>
                <li>âœ… æ™‚åŠ¹ç¡¬åŒ–ï¼ˆAge Hardeningï¼‰ã«ãŠã‘ã‚‹æå‡ºå¼·åŒ–ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’ç†è§£ã™ã‚‹</li>
                <li>âœ… TTTå›³ï¼ˆTime-Temperature-Transformationï¼‰ã¨CCTå›³ã‚’æ´»ç”¨ã—ãŸç†±å‡¦ç†è¨­è¨ˆãŒã§ãã‚‹</li>
                <li>âœ… Pythonã§æ‹¡æ•£æ–¹ç¨‹å¼ã€ç²’æˆé•·ã€æå‡ºå¼·åŒ–ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã§ãã‚‹</li>
            </ul>
        </div>

        <h2>2.1 ç„¼éˆï¼ˆAnnealingï¼‰ãƒ—ãƒ­ã‚»ã‚¹</h2>

        <h3>2.1.1 ç„¼éˆã®ç¨®é¡ã¨ç›®çš„</h3>
        <p>ç„¼éˆï¼ˆAnnealingï¼‰ã¯ã€ææ–™ã‚’é«˜æ¸©ã«åŠ ç†±ãƒ»ä¿æŒã—ã€å¾å†·ã™ã‚‹ã“ã¨ã§ä»¥ä¸‹ã®åŠ¹æœã‚’å¾—ã¾ã™ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>ç„¼éˆã®ç¨®é¡</th>
                    <th>ç›®çš„</th>
                    <th>æ¸©åº¦ç¯„å›²</th>
                    <th>çµ„ç¹”å¤‰åŒ–</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>å®Œå…¨ç„¼éˆ</strong><br/>(Full Annealing)</td>
                    <td>è»ŸåŒ–ã€åŠ å·¥æ€§å‘ä¸Š</td>
                    <td>Acâ‚ƒ + 30-50â„ƒ</td>
                    <td>ãƒ•ã‚§ãƒ©ã‚¤ãƒˆ+ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆ</td>
                </tr>
                <tr>
                    <td><strong>å¿œåŠ›é™¤å»ç„¼éˆ</strong><br/>(Stress Relief)</td>
                    <td>æ®‹ç•™å¿œåŠ›é™¤å»</td>
                    <td>500-650â„ƒ</td>
                    <td>çµ„ç¹”å¤‰åŒ–ãªã—</td>
                </tr>
                <tr>
                    <td><strong>å†çµæ™¶ç„¼éˆ</strong><br/>(Recrystallization)</td>
                    <td>åŠ å·¥ç¡¬åŒ–é™¤å»ã€çµæ™¶ç²’å¾®ç´°åŒ–</td>
                    <td>500-700â„ƒ</td>
                    <td>æ–°çµæ™¶ç²’å½¢æˆ</td>
                </tr>
                <tr>
                    <td><strong>çƒçŠ¶åŒ–ç„¼éˆ</strong><br/>(Spheroidizing)</td>
                    <td>ç‚­åŒ–ç‰©çƒçŠ¶åŒ–ã€åˆ‡å‰Šæ€§å‘ä¸Š</td>
                    <td>Acâ‚è¿‘å‚ã€é•·æ™‚é–“</td>
                    <td>çƒçŠ¶ã‚»ãƒ¡ãƒ³ã‚¿ã‚¤ãƒˆ</td>
                </tr>
            </tbody>
        </table>

        <h3>2.1.2 æ‹¡æ•£å¾‹é€Ÿãƒ—ãƒ­ã‚»ã‚¹ã¨ä¿æŒæ™‚é–“</h3>
        <p>ç„¼éˆã§ã¯ã€åŸå­æ‹¡æ•£ãŒçµ„ç¹”å‡è³ªåŒ–ã®éµã§ã™ã€‚<strong>Fickã®ç¬¬2æ³•å‰‡</strong>ã«ã‚ˆã‚Šã€æ‹¡æ•£è·é›¢ã¯æ™‚é–“ã®å¹³æ–¹æ ¹ã«æ¯”ä¾‹ï¼š</p>

        $$
        x = \sqrt{D t}
        $$

        <ul>
            <li>$x$ï¼šæ‹¡æ•£è·é›¢ï¼ˆmï¼‰</li>
            <li>$D$ï¼šæ‹¡æ•£ä¿‚æ•°ï¼ˆmÂ²/sï¼‰</li>
            <li>$t$ï¼šæ™‚é–“ï¼ˆsï¼‰</li>
        </ul>

        <p><strong>Arrheniusã®å¼</strong>ï¼ˆæ¸©åº¦ä¾å­˜æ€§ï¼‰ï¼š</p>
        $$
        D = D_0 \exp\left(-\frac{Q}{RT}\right)
        $$

        <ul>
            <li>$D_0$ï¼šé »åº¦å› å­ï¼ˆmÂ²/sï¼‰</li>
            <li>$Q$ï¼šæ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆJ/molï¼‰</li>
            <li>$R$ï¼šæ°—ä½“å®šæ•°ï¼ˆ8.314 J/molÂ·Kï¼‰</li>
            <li>$T$ï¼šçµ¶å¯¾æ¸©åº¦ï¼ˆKï¼‰</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2-1: æ‹¡æ•£è·é›¢ã¨ä¿æŒæ™‚é–“ã®è¨ˆç®—</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def arrhenius_diffusion_coefficient(T_celsius, Q, D0):
    """
    Arrheniusã®å¼ã«ã‚ˆã‚‹æ‹¡æ•£ä¿‚æ•°è¨ˆç®—

    Parameters
    ----------
    T_celsius : float
        æ¸©åº¦ï¼ˆâ„ƒï¼‰
    Q : float
        æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆJ/molï¼‰
    D0 : float
        é »åº¦å› å­ï¼ˆmÂ²/sï¼‰

    Returns
    -------
    D : float
        æ‹¡æ•£ä¿‚æ•°ï¼ˆmÂ²/sï¼‰
    """
    R = 8.314  # J/molÂ·K
    T_kelvin = T_celsius + 273.15

    D = D0 * np.exp(-Q / (R * T_kelvin))

    return D


def diffusion_distance(D, time):
    """
    æ‹¡æ•£è·é›¢ã®è¨ˆç®—

    Parameters
    ----------
    D : float
        æ‹¡æ•£ä¿‚æ•°ï¼ˆmÂ²/sï¼‰
    time : float
        æ™‚é–“ï¼ˆç§’ï¼‰

    Returns
    -------
    x : float
        æ‹¡æ•£è·é›¢ï¼ˆmï¼‰
    """
    x = np.sqrt(D * time)
    return x


# é‰„ä¸­ã®ç‚­ç´ æ‹¡æ•£ï¼ˆå…¸å‹å€¤ï¼‰
Q_C_in_Fe = 142000  # J/mol
D0_C_in_Fe = 2.0e-5  # mÂ²/s

# æ¸©åº¦ç¯„å›²ã§ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
temperatures = np.array([700, 800, 900, 1000])  # â„ƒ
time_hours = np.linspace(0, 10, 100)  # æ™‚é–“ï¼ˆæ™‚é–“ï¼‰
time_seconds = time_hours * 3600

plt.figure(figsize=(12, 6))

for T in temperatures:
    D = arrhenius_diffusion_coefficient(T, Q_C_in_Fe, D0_C_in_Fe)
    distances = [diffusion_distance(D, t) * 1e6 for t in time_seconds]  # Î¼m

    plt.plot(time_hours, distances, linewidth=2, label=f'{T}Â°C')

    # ä¿æŒæ™‚é–“ã®æ¨å®šï¼ˆæ‹¡æ•£è·é›¢100Î¼mã«åˆ°é”ï¼‰
    target_distance = 100e-6  # m
    required_time = (target_distance ** 2) / D / 3600  # æ™‚é–“
    print(f"Temperature: {T}Â°C")
    print(f"  Diffusion Coefficient: {D:.2e} mÂ²/s")
    print(f"  Time to diffuse 100 Î¼m: {required_time:.2f} hours\n")

plt.xlabel('Time (hours)')
plt.ylabel('Diffusion Distance (Î¼m)')
plt.title('Carbon Diffusion in Iron (Annealing Process)')
plt.legend()
plt.grid(True, alpha=0.3)
plt.savefig('diffusion_annealing.png', dpi=150, bbox_inches='tight')
plt.show()

# çµæœï¼š
# 700â„ƒã§100Î¼mæ‹¡æ•£ â†’ ç´„10æ™‚é–“å¿…è¦
# 1000â„ƒã§100Î¼mæ‹¡æ•£ â†’ ç´„0.5æ™‚é–“ï¼ˆ30åˆ†ï¼‰
# â†’ é«˜æ¸©ã»ã©çŸ­æ™‚é–“ã§å‡è³ªåŒ–å¯èƒ½</code></pre>

        <h3>2.1.3 å†çµæ™¶ã¨ç²’æˆé•·</h3>
        <p>å†·é–“åŠ å·¥å¾Œã®ç„¼éˆã§ã¯ã€<strong>å†çµæ™¶</strong>ï¼ˆæ–°çµæ™¶ç²’ã®æ ¸ç”Ÿæˆãƒ»æˆé•·ï¼‰ã¨<strong>ç²’æˆé•·</strong>ï¼ˆç²’ç•Œç§»å‹•ï¼‰ãŒé€²è¡Œã—ã¾ã™ã€‚</p>

        <p><strong>Beck-Spaepenç²’æˆé•·å‰‡</strong>ï¼š</p>
        $$
        d^n - d_0^n = K t
        $$

        <ul>
            <li>$d$ï¼šå¹³å‡ç²’å¾„ï¼ˆæ™‚åˆ» $t$ï¼‰</li>
            <li>$d_0$ï¼šåˆæœŸç²’å¾„</li>
            <li>$n$ï¼šæˆé•·æŒ‡æ•°ï¼ˆé€šå¸¸2-3ï¼‰</li>
            <li>$K$ï¼šæ¸©åº¦ä¾å­˜å®šæ•°</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2-2: ç²’æˆé•·ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def grain_growth(d0, K, time, n=2):
    """
    Beck-Spaepenç²’æˆé•·ãƒ¢ãƒ‡ãƒ«

    Parameters
    ----------
    d0 : float
        åˆæœŸç²’å¾„ï¼ˆÎ¼mï¼‰
    K : float
        æˆé•·å®šæ•°ï¼ˆÎ¼m^n / sï¼‰
    time : ndarray
        æ™‚é–“ï¼ˆç§’ï¼‰
    n : int
        æˆé•·æŒ‡æ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ2ï¼‰

    Returns
    -------
    d : ndarray
        ç²’å¾„å±¥æ­´ï¼ˆÎ¼mï¼‰
    """
    d = (d0 ** n + K * time) ** (1 / n)
    return d


# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
d0 = 10  # Î¼mï¼ˆåˆæœŸç²’å¾„ï¼‰
K = 0.5  # Î¼mÂ²/sï¼ˆ800â„ƒã§ã®æˆé•·å®šæ•°ï¼‰
time_hours = np.linspace(0, 10, 100)
time_seconds = time_hours * 3600

# ç²’æˆé•·è¨ˆç®—
grain_size = grain_growth(d0, K, time_seconds, n=2)

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 6))
plt.plot(time_hours, grain_size, 'b-', linewidth=2)
plt.xlabel('Annealing Time (hours)')
plt.ylabel('Average Grain Size (Î¼m)')
plt.title('Grain Growth during Annealing (800Â°C)')
plt.grid(True, alpha=0.3)
plt.axhline(y=50, color='r', linestyle='--', label='Target: 50 Î¼m')
plt.legend()
plt.savefig('grain_growth.png', dpi=150, bbox_inches='tight')
plt.show()

# ç›®æ¨™ç²’å¾„ï¼ˆ50Î¼mï¼‰åˆ°é”æ™‚é–“ã®è¨ˆç®—
target_size = 50  # Î¼m
required_time = ((target_size ** 2) - (d0 ** 2)) / K
required_hours = required_time / 3600

print(f"Grain Growth Analysis:")
print(f"  Initial Grain Size: {d0} Î¼m")
print(f"  Target Grain Size: {target_size} Î¼m")
print(f"  Required Annealing Time: {required_hours:.2f} hours")
print(f"  Final Grain Size after 10h: {grain_size[-1]:.1f} Î¼m")</code></pre>

        <h2>2.2 ç„¼å…¥ã‚Œï¼ˆQuenchingï¼‰ã¨ç„¼æˆ»ã—ï¼ˆTemperingï¼‰</h2>

        <h3>2.2.1 ç„¼å…¥ã‚Œã¨ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹</h3>
        <p>ç„¼å…¥ã‚Œï¼ˆQuenchingï¼‰ã¯ã€ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆï¼ˆÎ³ç›¸ï¼‰ã‹ã‚‰æ€¥å†·ã—ã€<strong>ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆ</strong>ï¼ˆéé£½å’Œå›ºæº¶ä½“ï¼‰ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆã¯é«˜ç¡¬åº¦ã§ã™ãŒã€è„†æ€§ãŒå¤§ãã„ãŸã‚ã€ç„¼æˆ»ã—ã§èª¿æ•´ã—ã¾ã™ã€‚</p>

        <table>
            <thead>
                <tr>
                    <th>å†·å´é€Ÿåº¦</th>
                    <th>å†·å´åª’ä½“</th>
                    <th>ç”Ÿæˆçµ„ç¹”</th>
                    <th>ç¡¬åº¦ï¼ˆHVï¼‰</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>>200 â„ƒ/s</td>
                    <td>æ°´ã€ãƒ–ãƒ©ã‚¤ãƒ³</td>
                    <td>ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆ</td>
                    <td>600-800</td>
                </tr>
                <tr>
                    <td>50-200 â„ƒ/s</td>
                    <td>æ²¹</td>
                    <td>ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆ+ãƒ™ã‚¤ãƒŠã‚¤ãƒˆ</td>
                    <td>500-700</td>
                </tr>
                <tr>
                    <td>10-50 â„ƒ/s</td>
                    <td>ç©ºå†·ï¼ˆé¢¨å†·ï¼‰</td>
                    <td>ãƒ™ã‚¤ãƒŠã‚¤ãƒˆ</td>
                    <td>400-600</td>
                </tr>
                <tr>
                    <td><10 â„ƒ/s</td>
                    <td>ç‚‰å†·</td>
                    <td>ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆ</td>
                    <td>200-400</td>
                </tr>
            </tbody>
        </table>

        <p><strong>Newtonå†·å´å‰‡</strong>ï¼ˆç°¡æ˜“ãƒ¢ãƒ‡ãƒ«ï¼‰ï¼š</p>
        $$
        \frac{dT}{dt} = -h (T - T_{\text{medium}})
        $$

        <ul>
            <li>$h$ï¼šå†·å´ä¿‚æ•°ï¼ˆ1/sï¼‰</li>
            <li>$T_{\text{medium}}$ï¼šå†·å´åª’ä½“æ¸©åº¦</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2-3: ç„¼å…¥ã‚Œå†·å´ã‚«ãƒ¼ãƒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def quenching_cooling_curve(T0, T_medium, h, time):
    """
    Newtonå†·å´å‰‡ã«ã‚ˆã‚‹å†·å´ã‚«ãƒ¼ãƒ–

    Parameters
    ----------
    T0 : float
        åˆæœŸæ¸©åº¦ï¼ˆâ„ƒï¼‰
    T_medium : float
        å†·å´åª’ä½“æ¸©åº¦ï¼ˆâ„ƒï¼‰
    h : float
        å†·å´ä¿‚æ•°ï¼ˆ1/sï¼‰
    time : ndarray
        æ™‚é–“ï¼ˆç§’ï¼‰

    Returns
    -------
    T : ndarray
        æ¸©åº¦å±¥æ­´ï¼ˆâ„ƒï¼‰
    """
    T = T_medium + (T0 - T_medium) * np.exp(-h * time)
    return T


# å†·å´æ¡ä»¶è¨­å®š
T_austenitize = 850  # â„ƒï¼ˆã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆåŒ–æ¸©åº¦ï¼‰
time = np.linspace(0, 60, 500)  # ç§’

quenching_conditions = [
    {'name': 'Water Quench', 'T_med': 25, 'h': 0.3, 'color': 'blue'},
    {'name': 'Oil Quench', 'T_med': 60, 'h': 0.1, 'color': 'orange'},
    {'name': 'Air Cool', 'T_med': 25, 'h': 0.02, 'color': 'green'},
    {'name': 'Furnace Cool', 'T_med': 25, 'h': 0.005, 'color': 'red'}
]

plt.figure(figsize=(12, 8))

# ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆé–‹å§‹æ¸©åº¦ï¼ˆMsï¼‰ã¨ãƒ™ã‚¤ãƒŠã‚¤ãƒˆç¯„å›²
Ms_temp = 350  # â„ƒ
Bs_temp = 550  # â„ƒ

plt.axhline(y=Ms_temp, color='purple', linestyle='--', linewidth=2,
            label=f'Ms (Martensite Start): {Ms_temp}Â°C')
plt.axhspan(Bs_temp, Ms_temp, alpha=0.2, color='cyan',
            label='Bainite Range')

for cond in quenching_conditions:
    T_curve = quenching_cooling_curve(
        T_austenitize, cond['T_med'], cond['h'], time
    )
    plt.plot(time, T_curve, linewidth=2.5,
             color=cond['color'], label=cond['name'])

    # å†·å´é€Ÿåº¦è¨ˆç®—ï¼ˆ800â„ƒâ†’500â„ƒã®å¹³å‡ï¼‰
    idx_800 = np.argmin(np.abs(T_curve - 800))
    idx_500 = np.argmin(np.abs(T_curve - 500))
    cooling_rate = (T_curve[idx_800] - T_curve[idx_500]) / (time[idx_500] - time[idx_800])

    print(f"{cond['name']}:")
    print(f"  Cooling Rate (800â†’500â„ƒ): {cooling_rate:.1f} â„ƒ/s")
    print(f"  Time to Ms ({Ms_temp}â„ƒ): {time[np.argmin(np.abs(T_curve - Ms_temp))]:.1f} s\n")

plt.xlabel('Time (s)')
plt.ylabel('Temperature (Â°C)')
plt.title('Quenching Cooling Curves and Microstructure Formation')
plt.legend(loc='upper right')
plt.grid(True, alpha=0.3)
plt.xlim(0, 60)
plt.ylim(0, 900)
plt.savefig('quenching_curves.png', dpi=150, bbox_inches='tight')
plt.show()</code></pre>

        <h3>2.2.2 Jominyç„¼å…¥æ€§è©¦é¨“</h3>
        <p><strong>Jominyè©¦é¨“</strong>ã¯ã€é‹¼æã®ç„¼å…¥æ€§ï¼ˆHardenabilityï¼‰ã‚’è©•ä¾¡ã™ã‚‹æ¨™æº–è©¦é¨“æ³•ã§ã™ã€‚ä¸€ç«¯ã‚’æ°´å†·ã—ã€å†·å´é€Ÿåº¦å‹¾é…ã«ã‚ˆã‚Šç¡¬åº¦åˆ†å¸ƒã‚’æ¸¬å®šã—ã¾ã™ã€‚</p>

        <div class="mermaid">
flowchart LR
    A[ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆåŒ–<br/>850â„ƒ, 30åˆ†] --> B[è©¦é¨“ç‰‡ã‚’ä¿æŒ<br/>ä¸€ç«¯ã®ã¿æ°´å†·]
    B --> C[å†·å´é€Ÿåº¦å‹¾é…<br/>ç«¯éƒ¨: é€Ÿã„<br/>å†…éƒ¨: é…ã„]
    C --> D[ç¡¬åº¦æ¸¬å®š<br/>ç«¯é¢ã‹ã‚‰ã®è·é›¢ vs HRC]
    D --> E[ç„¼å…¥æ€§è©•ä¾¡<br/>ç¡¬åº¦ä½ä¸‹ãŒç·©ã‚„ã‹=é«˜]

    style A fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style E fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
        </div>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2-4: Jominyç„¼å…¥æ€§ã‚«ãƒ¼ãƒ–ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def jominy_hardness_profile(distance_mm, HRC_max, DI, steel_type='Low Alloy'):
    """
    Jominyç„¼å…¥æ€§ã‚«ãƒ¼ãƒ–ã®ãƒ¢ãƒ‡ãƒ«

    Parameters
    ----------
    distance_mm : ndarray
        ç«¯é¢ã‹ã‚‰ã®è·é›¢ï¼ˆmmï¼‰
    HRC_max : float
        æœ€å¤§ç¡¬åº¦ï¼ˆHRCï¼‰
    DI : float
        Ideal Diameterï¼ˆç†æƒ³è‡¨ç•Œç›´å¾„ã€ç„¼å…¥æ€§æŒ‡æ¨™ï¼‰
    steel_type : str
        é‹¼ç¨®

    Returns
    -------
    hardness : ndarray
        ç¡¬åº¦åˆ†å¸ƒï¼ˆHRCï¼‰
    """
    # Grossmannã®ç„¼å…¥æ€§ãƒ¢ãƒ‡ãƒ«ï¼ˆç°¡æ˜“ç‰ˆï¼‰
    # HRC = HRC_max * exp(-k * distance)
    k = 0.1 / DI  # æ¸›è¡°å®šæ•°

    hardness = HRC_max * np.exp(-k * distance_mm)

    # æœ€å°ç¡¬åº¦ï¼ˆãƒ•ã‚§ãƒ©ã‚¤ãƒˆ+ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆçµ„ç¹”ï¼‰
    HRC_min = 20
    hardness = np.maximum(hardness, HRC_min)

    return hardness


# 3ç¨®é¡ã®é‹¼æã®æ¯”è¼ƒ
distance = np.linspace(0, 50, 100)  # mm

steels = [
    {'name': 'S45C (Plain Carbon)', 'HRC_max': 62, 'DI': 10},
    {'name': 'SCM440 (Cr-Mo)', 'HRC_max': 60, 'DI': 30},
    {'name': 'SNC815 (Ni-Cr)', 'HRC_max': 58, 'DI': 50}
]

plt.figure(figsize=(12, 7))

for steel in steels:
    hardness = jominy_hardness_profile(distance, steel['HRC_max'], steel['DI'])
    plt.plot(distance, hardness, linewidth=2.5, label=steel['name'])

    # ç„¼å…¥æ€§è©•ä¾¡ï¼ˆç¡¬åº¦ãŒHRC 50ã«ä½ä¸‹ã™ã‚‹è·é›¢ï¼‰
    idx_hrc50 = np.argmin(np.abs(hardness - 50))
    distance_hrc50 = distance[idx_hrc50]

    print(f"{steel['name']}:")
    print(f"  Maximum Hardness: {steel['HRC_max']} HRC")
    print(f"  Ideal Diameter (DI): {steel['DI']} mm")
    print(f"  Distance to HRC 50: {distance_hrc50:.1f} mm\n")

plt.axhline(y=50, color='k', linestyle='--', alpha=0.5, label='Target: HRC 50')
plt.xlabel('Distance from Quenched End (mm)')
plt.ylabel('Hardness (HRC)')
plt.title('Jominy Hardenability Test: Steel Comparison')
plt.legend()
plt.grid(True, alpha=0.3)
plt.savefig('jominy_hardenability.png', dpi=150, bbox_inches='tight')
plt.show()

# çµæœè§£é‡ˆï¼š
# - Plain Carbonï¼ˆS45Cï¼‰ï¼šç„¼å…¥æ€§ä½ã„ã€è¡¨é¢ã®ã¿ç¡¬åŒ–
# - Cr-Moï¼ˆSCM440ï¼‰ï¼šä¸­ç¨‹åº¦ã®ç„¼å…¥æ€§
# - Ni-Crï¼ˆSNC815ï¼‰ï¼šé«˜ç„¼å…¥æ€§ã€æ·±éƒ¨ã¾ã§ç¡¬åŒ–</code></pre>

        <h3>2.2.3 ç„¼æˆ»ã—ã¨ç¡¬åº¦åˆ¶å¾¡</h3>
        <p><strong>ç„¼æˆ»ã—</strong>ï¼ˆTemperingï¼‰ã¯ã€ç„¼å…¥ã‚Œãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆã‚’é©åˆ‡ãªæ¸©åº¦ã§å†åŠ ç†±ã—ã€ç¡¬åº¦ã¨é±æ€§ã®ãƒãƒ©ãƒ³ã‚¹ã‚’èª¿æ•´ã—ã¾ã™ã€‚</p>

        <p><strong>Hollomon-Jaffeå¼</strong>ï¼ˆç„¼æˆ»ã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰ï¼š</p>
        $$
        P = T (C + \log_{10} t) \times 10^{-3}
        $$

        <ul>
            <li>$P$ï¼šç„¼æˆ»ã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆç„¡æ¬¡å…ƒï¼‰</li>
            <li>$T$ï¼šç„¼æˆ»ã—æ¸©åº¦ï¼ˆKï¼‰</li>
            <li>$t$ï¼šç„¼æˆ»ã—æ™‚é–“ï¼ˆæ™‚é–“ï¼‰</li>
            <li>$C$ï¼šå®šæ•°ï¼ˆé€šå¸¸20ï¼‰</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2-5: ç„¼æˆ»ã—ç¡¬åº¦äºˆæ¸¬</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def hollomon_jaffe_parameter(temp_celsius, time_hours, C=20):
    """
    Hollomon-Jaffeç„¼æˆ»ã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

    Parameters
    ----------
    temp_celsius : float
        ç„¼æˆ»ã—æ¸©åº¦ï¼ˆâ„ƒï¼‰
    time_hours : float
        ç„¼æˆ»ã—æ™‚é–“ï¼ˆæ™‚é–“ï¼‰
    C : float
        å®šæ•°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ20ï¼‰

    Returns
    -------
    P : float
        ç„¼æˆ»ã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    """
    T_kelvin = temp_celsius + 273.15
    P = T_kelvin * (C + np.log10(time_hours)) * 1e-3

    return P


def tempered_hardness(P, HRC_initial=65):
    """
    ç„¼æˆ»ã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ç¡¬åº¦äºˆæ¸¬

    Parameters
    ----------
    P : float
        ç„¼æˆ»ã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    HRC_initial : float
        ç„¼å…¥ã‚Œå¾Œã®åˆæœŸç¡¬åº¦ï¼ˆHRCï¼‰

    Returns
    -------
    HRC : float
        ç„¼æˆ»ã—å¾Œã®ç¡¬åº¦ï¼ˆHRCï¼‰
    """
    # çµŒé¨“å¼ï¼ˆé‹¼ç¨®ã«ã‚ˆã‚Šç•°ãªã‚‹ï¼‰
    HRC = HRC_initial - 0.15 * (P - 10) ** 1.5

    # æœ€å°ç¡¬åº¦åˆ¶ç´„
    HRC = np.maximum(HRC, 20)

    return HRC


# æ¸©åº¦ã¨æ™‚é–“ã®å½±éŸ¿è©•ä¾¡
temperatures = [200, 300, 400, 500, 600]  # â„ƒ
time_hours = np.logspace(-1, 2, 100)  # 0.1ã€œ100æ™‚é–“

plt.figure(figsize=(12, 8))

for temp in temperatures:
    P_values = [hollomon_jaffe_parameter(temp, t) for t in time_hours]
    hardness = [tempered_hardness(P) for P in P_values]

    plt.plot(time_hours, hardness, linewidth=2.5, label=f'{temp}Â°C')

    # ç›®æ¨™ç¡¬åº¦ï¼ˆHRC 45ï¼‰åˆ°é”æ™‚é–“
    idx_target = np.argmin(np.abs(np.array(hardness) - 45))
    time_target = time_hours[idx_target]

    print(f"Tempering at {temp}Â°C:")
    print(f"  Time to reach HRC 45: {time_target:.2f} hours\n")

plt.axhline(y=45, color='k', linestyle='--', alpha=0.5, label='Target: HRC 45')
plt.xscale('log')
plt.xlabel('Tempering Time (hours)')
plt.ylabel('Hardness (HRC)')
plt.title('Tempering: Hardness vs Time and Temperature')
plt.legend()
plt.grid(True, alpha=0.3, which='both')
plt.savefig('tempering_hardness.png', dpi=150, bbox_inches='tight')
plt.show()

# ç­‰ç¡¬åº¦ç·šãƒ—ãƒ­ãƒƒãƒˆï¼ˆ2Dãƒãƒƒãƒ—ï¼‰
fig, ax = plt.subplots(figsize=(12, 8))

temp_range = np.linspace(150, 650, 50)
time_range = np.logspace(-1, 2, 50)
T_mesh, Time_mesh = np.meshgrid(temp_range, time_range)

Hardness_mesh = np.zeros_like(T_mesh)
for i in range(T_mesh.shape[0]):
    for j in range(T_mesh.shape[1]):
        P = hollomon_jaffe_parameter(T_mesh[i, j], Time_mesh[i, j])
        Hardness_mesh[i, j] = tempered_hardness(P)

contour = ax.contourf(T_mesh, Time_mesh, Hardness_mesh, levels=15, cmap='viridis')
contour_lines = ax.contour(T_mesh, Time_mesh, Hardness_mesh, levels=[40, 45, 50, 55, 60],
                             colors='white', linewidths=2)
ax.clabel(contour_lines, inline=True, fontsize=10, fmt='%d HRC')

ax.set_xlabel('Tempering Temperature (Â°C)')
ax.set_ylabel('Tempering Time (hours)')
ax.set_yscale('log')
ax.set_title('Tempering Map: Hardness Contours')
plt.colorbar(contour, label='Hardness (HRC)')
plt.savefig('tempering_map.png', dpi=150, bbox_inches='tight')
plt.show()</code></pre>

        <h2>2.3 æ™‚åŠ¹ç¡¬åŒ–ï¼ˆAge Hardeningï¼‰</h2>

        <h3>2.3.1 æ™‚åŠ¹ç¡¬åŒ–ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ </h3>
        <p><strong>æ™‚åŠ¹ç¡¬åŒ–</strong>ï¼ˆAge Hardening, Precipitation Hardeningï¼‰ã¯ã€éé£½å’Œå›ºæº¶ä½“ã‹ã‚‰å¾®ç´°æå‡ºç‰©ã‚’ç”Ÿæˆã•ã›ã€è»¢ä½é‹å‹•ã‚’é˜»å®³ã—ã¦å¼·åº¦ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚</p>

        <p><strong>æ™‚åŠ¹ç¡¬åŒ–ãƒ—ãƒ­ã‚»ã‚¹</strong>ï¼ˆAlåˆé‡‘ã®ä¾‹ï¼‰ï¼š</p>
        <ol>
            <li><strong>æº¶ä½“åŒ–å‡¦ç†</strong>ï¼ˆSolution Treatmentï¼‰ï¼šé«˜æ¸©ï¼ˆ500-550â„ƒï¼‰ã§åˆé‡‘å…ƒç´ ã‚’å›ºæº¶</li>
            <li><strong>æ€¥å†·</strong>ï¼ˆQuenchingï¼‰ï¼šå®¤æ¸©ã¾ã§æ€¥å†·ã—ã€éé£½å’Œå›ºæº¶ä½“ï¼ˆSSSSï¼‰ã‚’ä¿æŒ</li>
            <li><strong>æ™‚åŠ¹å‡¦ç†</strong>ï¼ˆAgingï¼‰ï¼šä¸­æ¸©ï¼ˆ100-200â„ƒï¼‰ã§æå‡ºç‰©ã‚’ç”Ÿæˆ
                <ul>
                    <li>GP zoneï¼ˆGuinier-Preston zoneï¼‰å½¢æˆ</li>
                    <li>ä¸­é–“ç›¸ï¼ˆÎ¸''ã€Î¸'ï¼‰æå‡º</li>
                    <li>å®‰å®šç›¸ï¼ˆÎ¸ã€Mgâ‚‚Siï¼‰ç²—å¤§åŒ–</li>
                </ul>
            </li>
        </ol>

        <div class="mermaid">
flowchart LR
    A[éé£½å’Œå›ºæº¶ä½“<br/>SSSS] --> B[GP zoneå½¢æˆ<br/>æ•°nm]
    B --> C[ä¸­é–“ç›¸Î¸''<br/>æº–å®‰å®š]
    C --> D[Î¸'ç›¸<br/>æ•°10nm]
    D --> E[å®‰å®šç›¸Î¸<br/>ç²—å¤§åŒ–]

    B -.-> F[ãƒ”ãƒ¼ã‚¯å¼·åº¦<br/>æœ€é©æå‡º]
    D -.-> G[éæ™‚åŠ¹<br/>å¼·åº¦ä½ä¸‹]

    style A fill:#fce7f3,stroke:#f093fb,stroke-width:2px
    style F fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style G fill:#fee2e2,stroke:#ef4444,stroke-width:2px
        </div>

        <p><strong>Orowanæ©Ÿæ§‹</strong>ï¼ˆæå‡ºå¼·åŒ–ï¼‰ï¼š</p>
        $$
        \Delta \sigma = \frac{M G b}{\lambda}
        $$

        <ul>
            <li>$\Delta \sigma$ï¼šå¼·åº¦å¢—åŠ ï¼ˆMPaï¼‰</li>
            <li>$M$ï¼šTaylorå› å­ï¼ˆ~3ï¼‰</li>
            <li>$G$ï¼šå‰ªæ–­å¼¾æ€§ç‡ï¼ˆGPaï¼‰</li>
            <li>$b$ï¼šBurgersãƒ™ã‚¯ãƒˆãƒ«ï¼ˆnmï¼‰</li>
            <li>$\lambda$ï¼šæå‡ºç‰©é–“éš”ï¼ˆnmï¼‰</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2-6: æ™‚åŠ¹ç¡¬åŒ–ã‚«ãƒ¼ãƒ–ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def age_hardening_strength(time_hours, temp_celsius, k=0.5, n=0.3):
    """
    æ™‚åŠ¹ç¡¬åŒ–ã®å¼·åº¦å¤‰åŒ–ãƒ¢ãƒ‡ãƒ«ï¼ˆJMAæ–¹ç¨‹å¼ãƒ™ãƒ¼ã‚¹ï¼‰

    Parameters
    ----------
    time_hours : ndarray
        æ™‚åŠ¹æ™‚é–“ï¼ˆæ™‚é–“ï¼‰
    temp_celsius : float
        æ™‚åŠ¹æ¸©åº¦ï¼ˆâ„ƒï¼‰
    k : float
        é€Ÿåº¦å®šæ•°
    n : float
        AvramiæŒ‡æ•°

    Returns
    -------
    strength : ndarray
        å¼•å¼µå¼·åº¦ï¼ˆMPaï¼‰
    """
    # æ¸©åº¦ä¾å­˜æ€§ï¼ˆArrheniuså‹ï¼‰
    k_eff = k * np.exp(-(5000 / (temp_celsius + 273.15)))

    # JMAæ–¹ç¨‹å¼ï¼ˆç›¸å¤‰æ…‹åˆ†ç‡ï¼‰
    f = 1 - np.exp(-(k_eff * time_hours) ** n)

    # å¼·åº¦ãƒ¢ãƒ‡ãƒ«
    sigma_0 = 100  # å›ºæº¶ä½“å¼·åº¦ï¼ˆMPaï¼‰
    delta_sigma_max = 300  # æœ€å¤§æå‡ºå¼·åŒ–ï¼ˆMPaï¼‰

    # ãƒ”ãƒ¼ã‚¯æ™‚åŠ¹å¾Œã¯éæ™‚åŠ¹ã§ä½ä¸‹
    peak_fraction = 0.6
    strength = sigma_0 + delta_sigma_max * f * np.exp(-2 * (f - peak_fraction) ** 2)

    return strength


# æ¸©åº¦ä¾å­˜æ€§ã®è©•ä¾¡
temperatures = [150, 180, 200, 220]
time_hours = np.logspace(-1, 3, 200)  # 0.1ã€œ1000æ™‚é–“

plt.figure(figsize=(12, 8))

for temp in temperatures:
    strength = age_hardening_strength(time_hours, temp)
    plt.plot(time_hours, strength, linewidth=2.5, label=f'{temp}Â°C')

    # ãƒ”ãƒ¼ã‚¯å¼·åº¦ã¨åˆ°é”æ™‚é–“
    peak_strength = np.max(strength)
    peak_time = time_hours[np.argmax(strength)]

    print(f"Age Hardening at {temp}Â°C:")
    print(f"  Peak Strength: {peak_strength:.1f} MPa")
    print(f"  Time to Peak: {peak_time:.2f} hours\n")

plt.xscale('log')
plt.xlabel('Aging Time (hours)')
plt.ylabel('Tensile Strength (MPa)')
plt.title('Age Hardening: Strength vs Time and Temperature')
plt.legend()
plt.grid(True, alpha=0.3, which='both')
plt.savefig('age_hardening_curve.png', dpi=150, bbox_inches='tight')
plt.show()

# ç­‰å¼·åº¦ç·šï¼ˆ2Dãƒãƒƒãƒ—ï¼‰
fig, ax = plt.subplots(figsize=(12, 8))

temp_range = np.linspace(130, 250, 50)
time_range = np.logspace(-1, 3, 50)
T_mesh, Time_mesh = np.meshgrid(temp_range, time_range)

Strength_mesh = np.zeros_like(T_mesh)
for i in range(T_mesh.shape[0]):
    for j in range(T_mesh.shape[1]):
        strength_val = age_hardening_strength(np.array([Time_mesh[i, j]]), T_mesh[i, j])
        Strength_mesh[i, j] = strength_val[0]

contour = ax.contourf(T_mesh, Time_mesh, Strength_mesh, levels=15, cmap='plasma')
contour_lines = ax.contour(T_mesh, Time_mesh, Strength_mesh,
                             levels=[250, 300, 350, 380], colors='white', linewidths=2)
ax.clabel(contour_lines, inline=True, fontsize=10, fmt='%d MPa')

ax.set_xlabel('Aging Temperature (Â°C)')
ax.set_ylabel('Aging Time (hours)')
ax.set_yscale('log')
ax.set_title('Age Hardening Map: Strength Contours')
plt.colorbar(contour, label='Tensile Strength (MPa)')
plt.savefig('age_hardening_map.png', dpi=150, bbox_inches='tight')
plt.show()</code></pre>

        <h2>2.4 TTTå›³ã¨CCTå›³ã®æ´»ç”¨</h2>

        <h3>2.4.1 TTTå›³ï¼ˆTime-Temperature-Transformationï¼‰</h3>
        <p><strong>TTTå›³</strong>ï¼ˆç­‰æ¸©å¤‰æ…‹å›³ï¼‰ã¯ã€ä¸€å®šæ¸©åº¦ä¿æŒæ™‚ã®çµ„ç¹”å¤‰æ…‹ã‚’è¡¨ã—ã¾ã™ã€‚é‹¼ã®ç†±å‡¦ç†è¨­è¨ˆã«ä¸å¯æ¬ ã§ã™ã€‚</p>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2-7: TTT/CCTå›³ã®ç”Ÿæˆã¨ç†±å‡¦ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def generate_TTT_diagram():
    """
    ç°¡æ˜“TTTå›³ã®ç”Ÿæˆï¼ˆå…±æé‹¼0.8%Cï¼‰
    """
    # ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆå¤‰æ…‹é–‹å§‹ãƒ»çµ‚äº†æ›²ç·šï¼ˆCæ›²ç·šï¼‰
    time = np.logspace(-1, 5, 200)  # ç§’

    # ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆãƒãƒ¼ã‚ºï¼ˆç´„550â„ƒã§æœ€é€Ÿå¤‰æ…‹ï¼‰
    T_pearlite_start = 700 - 150 * np.exp(-((np.log10(time) - 1.5) / 1.5) ** 2)
    T_pearlite_finish = T_pearlite_start - 50

    # ãƒ™ã‚¤ãƒŠã‚¤ãƒˆå¤‰æ…‹ï¼ˆ350-550â„ƒï¼‰
    T_bainite_start = 500 - 150 * np.exp(-((np.log10(time) - 2.5) / 1.2) ** 2)
    T_bainite_finish = T_bainite_start - 50

    # ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆé–‹å§‹æ¸©åº¦ï¼ˆæ™‚é–“ç„¡ä¾å­˜ï¼‰
    Ms_temp = 250

    return time, T_pearlite_start, T_pearlite_finish, T_bainite_start, T_bainite_finish, Ms_temp


def simulate_cooling_path(cooling_rate, T_initial=850, time_max=1000):
    """
    å†·å´ãƒ‘ã‚¹ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters
    ----------
    cooling_rate : float
        å†·å´é€Ÿåº¦ï¼ˆâ„ƒ/sï¼‰
    T_initial : float
        åˆæœŸæ¸©åº¦ï¼ˆâ„ƒï¼‰
    time_max : float
        æœ€å¤§æ™‚é–“ï¼ˆç§’ï¼‰

    Returns
    -------
    time, temperature : ndarray
        å†·å´ãƒ‘ã‚¹
    """
    time = np.linspace(0, time_max, 500)
    temperature = T_initial - cooling_rate * time
    temperature = np.maximum(temperature, 25)  # å®¤æ¸©ä¸‹é™

    return time, temperature


# TTTå›³ã®ç”Ÿæˆ
time_ttt, T_p_start, T_p_finish, T_b_start, T_b_finish, Ms = generate_TTT_diagram()

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, ax = plt.subplots(figsize=(14, 10))

# TTTæ›²ç·š
ax.plot(time_ttt, T_p_start, 'r-', linewidth=2.5, label='Pearlite Start')
ax.plot(time_ttt, T_p_finish, 'r--', linewidth=2.5, label='Pearlite Finish')
ax.plot(time_ttt, T_b_start, 'b-', linewidth=2.5, label='Bainite Start')
ax.plot(time_ttt, T_b_finish, 'b--', linewidth=2.5, label='Bainite Finish')
ax.axhline(y=Ms, color='purple', linestyle='-', linewidth=2.5, label=f'Ms (Martensite): {Ms}Â°C')

# é ˜åŸŸå¡—ã‚Šã¤ã¶ã—
ax.fill_between(time_ttt, T_p_start, T_p_finish, alpha=0.3, color='red', label='Pearlite Region')
ax.fill_between(time_ttt, T_b_start, T_b_finish, alpha=0.3, color='blue', label='Bainite Region')
ax.fill_between(time_ttt, 0, Ms, alpha=0.2, color='purple', label='Martensite Region')

# å†·å´ãƒ‘ã‚¹ã®é‡ã­åˆã‚ã›
cooling_cases = [
    {'rate': 500, 'name': 'Water Quench (500Â°C/s)', 'color': 'green', 'linestyle': '-'},
    {'rate': 50, 'name': 'Oil Quench (50Â°C/s)', 'color': 'orange', 'linestyle': '-'},
    {'rate': 5, 'name': 'Air Cool (5Â°C/s)', 'color': 'brown', 'linestyle': '-'},
]

for case in cooling_cases:
    time_cool, temp_cool = simulate_cooling_path(case['rate'])
    ax.plot(time_cool, temp_cool, color=case['color'],
            linestyle=case['linestyle'], linewidth=3, label=case['name'])

ax.set_xscale('log')
ax.set_xlabel('Time (s)')
ax.set_ylabel('Temperature (Â°C)')
ax.set_title('TTT Diagram with Cooling Paths (Eutectoid Steel 0.8% C)')
ax.set_xlim(0.1, 1e4)
ax.set_ylim(0, 900)
ax.legend(loc='upper right', fontsize=9)
ax.grid(True, alpha=0.3, which='both')
plt.savefig('ttt_diagram_with_cooling.png', dpi=150, bbox_inches='tight')
plt.show()

# çµ„ç¹”äºˆæ¸¬
print("Microstructure Prediction:")
for case in cooling_cases:
    time_cool, temp_cool = simulate_cooling_path(case['rate'])

    # ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆãƒãƒ¼ã‚ºé€šéåˆ¤å®š
    pearlite_time_min = time_ttt[np.argmin(T_p_start)]
    pearlite_temp_min = np.min(T_p_start)

    if case['rate'] > 100:
        microstructure = "100% Martensite (avoided pearlite nose)"
    elif case['rate'] > 20:
        microstructure = "Martensite + Bainite (partial transformation)"
    else:
        microstructure = "Pearlite + Ferrite (slow cooling)"

    print(f"{case['name']}: {microstructure}")</code></pre>

        <h2>æ¼”ç¿’å•é¡Œ</h2>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-1: ç„¼éˆä¿æŒæ™‚é–“ã®è¨­è¨ˆï¼ˆEasyï¼‰</h4>
            <p>ç‚­ç´ é‹¼ï¼ˆ0.5% Cï¼‰ã®å®Œå…¨ç„¼éˆã«ãŠã„ã¦ã€åšã•20 mmã®æ¿æã‚’å‡è³ªåŒ–ã—ãŸã„ã€‚æ‹¡æ•£è·é›¢ãŒå°‘ãªãã¨ã‚‚10 mmã«é”ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚800â„ƒã§ç„¼éˆã™ã‚‹å ´åˆã€å¿…è¦ãªä¿æŒæ™‚é–“ã‚’è¨ˆç®—ã›ã‚ˆã€‚ï¼ˆç‚­ç´ ã®æ‹¡æ•£ä¿‚æ•°ï¼š$D = 2.0 \times 10^{-5} \exp(-142000 / (8.314 \times T))$ mÂ²/sã€$T$ã¯Kï¼‰</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <pre><code class="language-python"># ä¸ãˆã‚‰ã‚ŒãŸæ¡ä»¶
target_distance = 10e-3  # mï¼ˆ10 mmï¼‰
T_celsius = 800
T_kelvin = T_celsius + 273.15

# æ‹¡æ•£ä¿‚æ•°è¨ˆç®—
Q = 142000  # J/mol
D0 = 2.0e-5  # mÂ²/s
R = 8.314    # J/molÂ·K

D = D0 * np.exp(-Q / (R * T_kelvin))

# ä¿æŒæ™‚é–“è¨ˆç®—ï¼ˆxÂ² = D * tï¼‰
t_required = (target_distance ** 2) / D
t_hours = t_required / 3600

print(f"Complete Annealing Time Calculation:")
print(f"  Temperature: {T_celsius} Â°C")
print(f"  Target Diffusion Distance: {target_distance*1000} mm")
print(f"  Diffusion Coefficient: {D:.2e} mÂ²/s")
print(f"  Required Holding Time: {t_hours:.2f} hours ({t_required/60:.1f} min)")

# çµæœï¼šç´„8æ™‚é–“å¿…è¦
# å®Ÿå‹™ã§ã¯å®‰å…¨ç‡ã‚’è€ƒæ…®ã—ã€10-12æ™‚é–“ä¿æŒãŒæ¨å¥¨ã•ã‚Œã‚‹</code></pre>
            </details>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-2: ç„¼å…¥ã‚Œå¾Œã®çµ„ç¹”äºˆæ¸¬ï¼ˆEasyï¼‰</h4>
            <p>å…±æé‹¼ï¼ˆ0.8% Cï¼‰ã‚’850â„ƒã§ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆåŒ–å¾Œã€ä»¥ä¸‹ã®å†·å´é€Ÿåº¦ã§ç„¼å…¥ã‚Œã—ãŸå ´åˆã®çµ„ç¹”ã‚’äºˆæ¸¬ã›ã‚ˆï¼š(a) 200â„ƒ/sã€(b) 30â„ƒ/sã€(c) 3â„ƒ/sã€‚TTTå›³ã‚’å‚ç…§ã—ã€ç”Ÿæˆçµ„ç¹”ã¨äºˆæƒ³ç¡¬åº¦ç¯„å›²ã‚’ç­”ãˆã‚ˆã€‚</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <p><strong>TTTå›³è§£æ</strong>ï¼š</p>
                <ul>
                    <li><strong>(a) 200â„ƒ/sï¼ˆæ°´ç„¼å…¥ã‚Œï¼‰</strong>ï¼šãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆãƒãƒ¼ã‚ºï¼ˆç´„550â„ƒã€1ç§’ï¼‰ã‚’å›é¿ â†’ <strong>100%ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆ</strong>ã€ç¡¬åº¦ HRC 64-66</li>
                    <li><strong>(b) 30â„ƒ/sï¼ˆæ²¹ç„¼å…¥ã‚Œï¼‰</strong>ï¼šãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆãƒãƒ¼ã‚ºã‚’é€šéã™ã‚‹ãŒçŸ­æ™‚é–“ â†’ <strong>ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆ + ä¸Šéƒ¨ãƒ™ã‚¤ãƒŠã‚¤ãƒˆ</strong>ã€ç¡¬åº¦ HRC 55-60</li>
                    <li><strong>(c) 3â„ƒ/sï¼ˆç©ºå†·ï¼‰</strong>ï¼šãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆå¤‰æ…‹åŸŸã«é•·æ™‚é–“æ»åœ¨ â†’ <strong>å¾®ç´°ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆ</strong>ã€ç¡¬åº¦ HRC 35-40</li>
                </ul>
                <p><strong>å®Ÿé¨“çš„æ¤œè¨¼</strong>ï¼šJominyè©¦é¨“ã§å®Ÿæ¸¬ã—ã€äºˆæ¸¬ã¨æ¯”è¼ƒã™ã‚‹ã®ãŒç†æƒ³çš„</p>
            </details>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-3: ç„¼æˆ»ã—æ¡ä»¶ã®è¨­è¨ˆï¼ˆMediumï¼‰</h4>
            <p>ç„¼å…¥ã‚Œå¾Œã®å·¥å…·é‹¼ï¼ˆHRC 65ï¼‰ã‚’ã€ç›®æ¨™ç¡¬åº¦ HRC 55 ã«ç„¼æˆ»ã—ã—ãŸã„ã€‚400â„ƒã¨500â„ƒã®2ã¤ã®æ¸©åº¦ã§ç„¼æˆ»ã—ã‚’è¡Œã†å ´åˆã€ãã‚Œãã‚Œã®å¿…è¦æ™‚é–“ã‚’è¨ˆç®—ã›ã‚ˆã€‚ï¼ˆHollomon-Jaffeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <pre><code class="language-python"># é€†ç®—ï¼šç›®æ¨™ç¡¬åº¦ã‹ã‚‰Pã‚’æ±‚ã‚ã€æ™‚é–“ã‚’è¨ˆç®—
def inverse_tempered_hardness(HRC_target, HRC_initial=65):
    """ç›®æ¨™ç¡¬åº¦ã‹ã‚‰Hollomon-Jaffeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é€†ç®—"""
    # HRC = HRC_initial - 0.15 * (P - 10)^1.5
    # â†’ P = 10 + ((HRC_initial - HRC) / 0.15)^(2/3)
    P_target = 10 + ((HRC_initial - HRC_target) / 0.15) ** (2/3)
    return P_target

HRC_target = 55
P_target = inverse_tempered_hardness(HRC_target)

print(f"Target Hollomon-Jaffe Parameter: P = {P_target:.2f}\n")

# 2ã¤ã®æ¸©åº¦ã§æ™‚é–“è¨ˆç®—
temperatures = [400, 500]  # â„ƒ

for temp in temperatures:
    T_kelvin = temp + 273.15
    C = 20

    # P = T * (C + log10(t)) * 1e-3
    # â†’ log10(t) = (P / (T * 1e-3)) - C
    log10_t = (P_target / (T_kelvin * 1e-3)) - C
    t_hours = 10 ** log10_t

    print(f"Tempering at {temp}Â°C:")
    print(f"  Required Time: {t_hours:.2f} hours")
    print(f"  Practical Recommendation: {t_hours*1.2:.2f} hours (with safety margin)\n")

# çµæœï¼š
# 400â„ƒ â†’ ç´„10æ™‚é–“
# 500â„ƒ â†’ ç´„2æ™‚é–“
# â†’ é«˜æ¸©ã»ã©çŸ­æ™‚é–“ã§ç›®æ¨™ç¡¬åº¦ã«åˆ°é”</code></pre>
            </details>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-4: æ™‚åŠ¹ç¡¬åŒ–ã®æœ€é©æ¡ä»¶æ±ºå®šï¼ˆMediumï¼‰</h4>
            <p>Al-Cuåˆé‡‘ï¼ˆAl-4%Cuï¼‰ã®æ™‚åŠ¹ç¡¬åŒ–ã«ãŠã„ã¦ã€å¼•å¼µå¼·åº¦400 MPaã‚’ç›®æ¨™ã¨ã™ã‚‹ã€‚180â„ƒã¨200â„ƒã®2ã¤ã®æ¸©åº¦ã§æ™‚åŠ¹å‡¦ç†å¯èƒ½ãªå ´åˆã€ãã‚Œãã‚Œã®æœ€é©æ™‚åŠ¹æ™‚é–“ã¨ç”Ÿç”£æ€§ï¼ˆthroughputï¼‰ã‚’æ¯”è¼ƒã›ã‚ˆã€‚</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <pre><code class="language-python"># æ™‚åŠ¹ç¡¬åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå¼·åº¦400 MPaåˆ°é”æ™‚é–“ï¼‰
target_strength = 400  # MPa
temperatures = [180, 200]

time_hours_range = np.logspace(-1, 3, 500)

for temp in temperatures:
    strength_curve = age_hardening_strength(time_hours_range, temp)

    # ç›®æ¨™å¼·åº¦åˆ°é”æ™‚é–“
    idx_target = np.argmin(np.abs(strength_curve - target_strength))
    time_target = time_hours_range[idx_target]
    strength_achieved = strength_curve[idx_target]

    # ãƒ”ãƒ¼ã‚¯å¼·åº¦
    peak_strength = np.max(strength_curve)
    peak_time = time_hours_range[np.argmax(strength_curve)]

    print(f"Aging at {temp}Â°C:")
    print(f"  Time to reach {target_strength} MPa: {time_target:.2f} hours")
    print(f"  Achieved Strength: {strength_achieved:.1f} MPa")
    print(f"  Peak Strength: {peak_strength:.1f} MPa (at {peak_time:.2f} hours)")

    # ç”Ÿç”£æ€§è©•ä¾¡ï¼ˆãƒãƒƒãƒå‡¦ç†ï¼‰
    batch_capacity = 100  # éƒ¨å“æ•°/ãƒãƒƒãƒ
    throughput = batch_capacity / time_target  # éƒ¨å“æ•°/æ™‚é–“

    print(f"  Production Throughput: {throughput:.2f} parts/hour")
    print(f"  Daily Production (24h): {throughput*24:.0f} parts\n")

# çµæœï¼š
# 180â„ƒ â†’ æ™‚é–“é•·ã„ãŒã€ãƒ”ãƒ¼ã‚¯å¼·åº¦é«˜ã„ï¼ˆå®‰å®šï¼‰
# 200â„ƒ â†’ æ™‚é–“çŸ­ãã€ç”Ÿç”£æ€§é«˜ã„ãŒã€éæ™‚åŠ¹ãƒªã‚¹ã‚¯
# â†’ ç”Ÿç”£æ€§é‡è¦–ãªã‚‰200â„ƒã€å“è³ªå®‰å®šæ€§é‡è¦–ãªã‚‰180â„ƒ</code></pre>
            </details>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-5: Jominyè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã®ç„¼å…¥æ€§è©•ä¾¡ï¼ˆMediumï¼‰</h4>
            <p>Jominyè©¦é¨“ã§ä»¥ä¸‹ã®ç¡¬åº¦ãƒ‡ãƒ¼ã‚¿ãŒå¾—ã‚‰ã‚ŒãŸï¼šç«¯é¢ï¼ˆ0 mmï¼‰: HRC 62ã€5 mm: HRC 58ã€10 mm: HRC 52ã€15 mm: HRC 45ã€‚ã“ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ç›´å¾„30 mmã®ä¸¸æ£’ã‚’ç„¼å…¥ã‚Œã—ãŸå ´åˆã®ä¸­å¿ƒç¡¬åº¦ã‚’äºˆæ¸¬ã›ã‚ˆã€‚</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <pre><code class="language-python">import numpy as np
from scipy.interpolate import interp1d

# Jominyè©¦é¨“ãƒ‡ãƒ¼ã‚¿
jominy_distance = np.array([0, 5, 10, 15])  # mm
jominy_hardness = np.array([62, 58, 52, 45])  # HRC

# è£œé–“é–¢æ•°ã®ä½œæˆ
interp_func = interp1d(jominy_distance, jominy_hardness,
                        kind='cubic', fill_value='extrapolate')

# Grossmannæ›ç®—è¡¨ï¼ˆç°¡æ˜“ç‰ˆï¼‰ï¼šä¸¸æ£’ç›´å¾„ â†’ Jominyç­‰ä¾¡è·é›¢
# ç›´å¾„30 mmã®ä¸­å¿ƒã¯ã€å†·å´é€Ÿåº¦çš„ã«Jominyè©¦é¨“ã®ç´„12-13 mmç›¸å½“
# ï¼ˆå®Ÿéš›ã®æ›ç®—è¡¨ã‚„H-bandæ³•ã‚’ä½¿ç”¨ã™ã¹ãã ãŒã€ã“ã“ã§ã¯ç°¡æ˜“è¨ˆç®—ï¼‰

diameter = 30  # mm
equivalent_jominy_distance = 0.4 * diameter  # ç°¡æ˜“æ›ç®—ï¼ˆä¸­å¿ƒéƒ¨ï¼‰

predicted_hardness = interp_func(equivalent_jominy_distance)

print(f"Jominy Hardenability Analysis:")
print(f"  Bar Diameter: {diameter} mm")
print(f"  Equivalent Jominy Distance (center): {equivalent_jominy_distance:.1f} mm")
print(f"  Predicted Center Hardness: {predicted_hardness:.1f} HRC")

# è¡¨é¢ç¡¬åº¦ï¼ˆJominy 0 mmç›¸å½“ï¼‰
surface_hardness = interp_func(0)
print(f"  Predicted Surface Hardness: {surface_hardness:.1f} HRC")

# ç¡¬åŒ–æ·±ã•ï¼ˆHRC 50ä»¥ä¸Šã®æ·±ã•ï¼‰
hardness_threshold = 50
try:
    depth_threshold = np.interp(hardness_threshold, jominy_hardness[::-1], jominy_distance[::-1])
    # ä¸¸æ£’ã§ã®ç¡¬åŒ–æ·±ã•ï¼ˆç°¡æ˜“æ›ç®—ï¼‰
    effective_depth = depth_threshold / 0.4
    print(f"\nCase Depth (HRC â‰¥ 50): {effective_depth:.1f} mm from surface")
except:
    print(f"\nCase Depth: Exceeds measurement range")

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 6))
jominy_fine = np.linspace(0, 20, 100)
hardness_fine = interp_func(jominy_fine)
plt.plot(jominy_fine, hardness_fine, 'b-', linewidth=2, label='Interpolated Curve')
plt.scatter(jominy_distance, jominy_hardness, color='red', s=100,
            zorder=5, label='Measured Data')
plt.axvline(x=equivalent_jominy_distance, color='green', linestyle='--',
            linewidth=2, label=f'Equivalent Position (30mm bar center)')
plt.axhline(y=predicted_hardness, color='green', linestyle='--', alpha=0.5)
plt.xlabel('Distance from Quenched End (mm)')
plt.ylabel('Hardness (HRC)')
plt.title('Jominy Hardenability and Center Hardness Prediction')
plt.legend()
plt.grid(True, alpha=0.3)
plt.savefig('jominy_prediction.png', dpi=150, bbox_inches='tight')
plt.show()</code></pre>
            </details>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-6: TTTå›³ã‚’ç”¨ã„ãŸç†±å‡¦ç†ãƒ—ãƒ­ã‚»ã‚¹è¨­è¨ˆï¼ˆHardï¼‰</h4>
            <p>å…±æé‹¼ï¼ˆ0.8% Cï¼‰ã§ã€50%ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆ + 50%ãƒ™ã‚¤ãƒŠã‚¤ãƒˆã®æ··åˆçµ„ç¹”ã‚’å¾—ãŸã„ã€‚TTTå›³ã‚’å‚è€ƒã«ã€æœ€é©ãªå†·å´é€Ÿåº¦ã¨ç­‰æ¸©ä¿æŒæ¡ä»¶ã‚’è¨­è¨ˆã›ã‚ˆã€‚ç›®æ¨™ç¡¬åº¦ã¯HRC 55-58ã€‚</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <pre><code class="language-python"># æˆ¦ç•¥ï¼šã‚ªãƒ¼ã‚¹ãƒ†ãƒ³ãƒ‘ãƒªãƒ³ã‚°ï¼ˆAustemperingï¼‰
# 1. 850â„ƒã§ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆåŒ–
# 2. Msæ¸©åº¦ï¼ˆ250â„ƒï¼‰ä»¥ä¸‹ã®ãƒ™ã‚¤ãƒŠã‚¤ãƒˆåŸŸï¼ˆä¾‹ï¼š300â„ƒï¼‰ã¾ã§æ€¥å†·
# 3. ç­‰æ¸©ä¿æŒã§ãƒ™ã‚¤ãƒŠã‚¤ãƒˆå¤‰æ…‹ï¼ˆ50%ç¨‹åº¦ï¼‰
# 4. å®¤æ¸©ã¾ã§å†·å´ â†’ æ®‹ç•™ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆãŒãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆåŒ–

T_austenitize = 850  # â„ƒ
T_austempering = 300  # â„ƒï¼ˆä¸‹éƒ¨ãƒ™ã‚¤ãƒŠã‚¤ãƒˆåŸŸï¼‰
Ms = 250  # â„ƒ

# å†·å´é€Ÿåº¦è¨ˆç®—ï¼ˆMsä»¥ä¸‹ã«å…¥ã‚‹å‰ã«ãƒ™ã‚¤ãƒŠã‚¤ãƒˆåŸŸåˆ°é”ï¼‰
# ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆãƒãƒ¼ã‚ºï¼ˆ550â„ƒã€1ç§’ï¼‰ã‚’å›é¿ã™ã‚‹å¿…è¦
required_cooling_rate = (T_austenitize - T_austempering) / 5  # 5ç§’ä»¥å†…

print(f"Austempering Process Design:")
print(f"  Step 1: Austenitizing at {T_austenitize}Â°C")
print(f"  Step 2: Rapid quench to {T_austempering}Â°C")
print(f"    Required Cooling Rate: >{required_cooling_rate:.1f} Â°C/s")
print(f"    (Use oil or salt bath quench)")

# ãƒ™ã‚¤ãƒŠã‚¤ãƒˆå¤‰æ…‹æ™‚é–“ï¼ˆTTTå›³ã‹ã‚‰èª­ã¿å–ã‚Šï¼‰
# 300â„ƒã§ã®å¤‰æ…‹é–‹å§‹ï¼šç´„10ç§’ã€50%å¤‰æ…‹ï¼šç´„60ç§’
t_bainite_start = 10  # ç§’
t_bainite_50pct = 60  # ç§’

print(f"\n  Step 3: Isothermal hold at {T_austempering}Â°C")
print(f"    Bainite transformation starts: {t_bainite_start} s")
print(f"    Hold time for 50% bainite: {t_bainite_50pct} s")

# æ®‹ç•™ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆ â†’ ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹
print(f"\n  Step 4: Cool to room temperature")
print(f"    Remaining austenite (50%) transforms to martensite below {Ms}Â°C")

# çµ„ç¹”ã¨ç¡¬åº¦äºˆæ¸¬
print(f"\nExpected Microstructure:")
print(f"  50% Lower Bainite (HRC 50-55)")
print(f"  50% Martensite (HRC 60-65)")
print(f"  Composite Hardness: HRC 55-58 âœ“")

# å®Ÿé¨“çš„æ¤œè¨¼ã®æ¨å¥¨
print(f"\nExperimental Verification:")
print(f"  1. Conduct dilatometry to confirm transformation kinetics")
print(f"  2. Metallographic examination (SEM, optical microscopy)")
print(f"  3. Hardness testing (Rockwell C scale)")
print(f"  4. Impact toughness testing (Charpy) for quality assurance")</code></pre>
            </details>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-7: å¤šæ®µæ™‚åŠ¹å‡¦ç†ã®æœ€é©åŒ–ï¼ˆHardï¼‰</h4>
            <p>Al-Mg-Siåˆé‡‘ã§ã€2æ®µæ™‚åŠ¹å‡¦ç†ï¼ˆTwo-Step Agingï¼‰ã‚’è¡Œã†ã€‚ç¬¬1æ®µï¼ˆä½æ¸©ã€GP zoneå½¢æˆï¼‰ã¨ç¬¬2æ®µï¼ˆé«˜æ¸©ã€ä¸­é–“ç›¸æå‡ºï¼‰ã®æœ€é©æ¡ä»¶ã‚’ã€å¼•å¼µå¼·åº¦ã¨ã‚³ã‚¹ãƒˆï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã€æ™‚é–“ï¼‰ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã§æ±ºå®šã›ã‚ˆã€‚</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import differential_evolution

def two_step_aging_strength(t1_hours, T1_celsius, t2_hours, T2_celsius):
    """
    2æ®µæ™‚åŠ¹å‡¦ç†ã®å¼·åº¦äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«

    Parameters
    ----------
    t1_hours, T1_celsius : float
        ç¬¬1æ®µæ™‚åŠ¹ï¼ˆæ™‚é–“ã€æ¸©åº¦ï¼‰
    t2_hours, T2_celsius : float
        ç¬¬2æ®µæ™‚åŠ¹ï¼ˆæ™‚é–“ã€æ¸©åº¦ï¼‰

    Returns
    -------
    strength : float
        å¼•å¼µå¼·åº¦ï¼ˆMPaï¼‰
    """
    # ç¬¬1æ®µï¼šGP zoneå½¢æˆï¼ˆä½æ¸©ã€é•·æ™‚é–“ï¼‰
    strength_step1 = 200 + 100 * (1 - np.exp(-0.5 * t1_hours)) * np.exp(-T1_celsius / 200)

    # ç¬¬2æ®µï¼šä¸­é–“ç›¸æå‡ºï¼ˆé«˜æ¸©ã€çŸ­æ™‚é–“ï¼‰
    strength_step2 = 150 * (1 - np.exp(-0.2 * t2_hours)) * (1 - np.exp(-(T2_celsius - 150) / 50))

    # åˆæˆå¼·åº¦
    total_strength = strength_step1 + strength_step2

    return total_strength


def calculate_cost(t1_hours, T1_celsius, t2_hours, T2_celsius):
    """
    ãƒ—ãƒ­ã‚»ã‚¹ã‚³ã‚¹ãƒˆã®è¨ˆç®—

    Returns
    -------
    cost : float
        æ­£è¦åŒ–ã‚³ã‚¹ãƒˆï¼ˆæ™‚é–“+ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰
    """
    # æ™‚é–“ã‚³ã‚¹ãƒˆï¼ˆç”Ÿç”£æ€§ï¼‰
    time_cost = t1_hours + t2_hours

    # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆï¼ˆæ¸©åº¦Ã—æ™‚é–“ï¼‰
    energy_cost = (T1_celsius * t1_hours + T2_celsius * t2_hours) / 1000

    # åˆè¨ˆã‚³ã‚¹ãƒˆï¼ˆé‡ã¿ä»˜ã‘ï¼‰
    total_cost = time_cost + 0.5 * energy_cost

    return total_cost


def objective_function(params):
    """
    å¤šç›®çš„æœ€é©åŒ–ç›®çš„é–¢æ•°

    å¼·åº¦ã‚’æœ€å¤§åŒ–ã€ã‚³ã‚¹ãƒˆã‚’æœ€å°åŒ–

    Returns
    -------
    -performance : float
        è² ã®æ€§èƒ½æŒ‡æ¨™ï¼ˆæœ€å°åŒ–å•é¡Œï¼‰
    """
    t1, T1, t2, T2 = params

    strength = two_step_aging_strength(t1, T1, t2, T2)
    cost = calculate_cost(t1, T1, t2, T2)

    # æ€§èƒ½æŒ‡æ¨™ï¼šå¼·åº¦ / ã‚³ã‚¹ãƒˆï¼ˆå¤§ãã„ã»ã©è‰¯ã„ï¼‰
    performance = strength / cost

    return -performance  # æœ€å°åŒ–å•é¡Œã«å¤‰æ›


# æœ€é©åŒ–å®Ÿè¡Œ
bounds = [
    (1, 24),    # t1: 1-24æ™‚é–“
    (100, 150), # T1: 100-150â„ƒ
    (1, 12),    # t2: 1-12æ™‚é–“
    (170, 220)  # T2: 170-220â„ƒ
]

result = differential_evolution(
    objective_function,
    bounds,
    maxiter=100,
    seed=42,
    disp=True
)

t1_opt, T1_opt, t2_opt, T2_opt = result.x
strength_opt = two_step_aging_strength(t1_opt, T1_opt, t2_opt, T2_opt)
cost_opt = calculate_cost(t1_opt, T1_opt, t2_opt, T2_opt)

print(f"Two-Step Aging Optimization Results:")
print(f"\nStep 1 (GP Zone Formation):")
print(f"  Temperature: {T1_opt:.1f} Â°C")
print(f"  Time: {t1_opt:.2f} hours")
print(f"\nStep 2 (Intermediate Phase Precipitation):")
print(f"  Temperature: {T2_opt:.1f} Â°C")
print(f"  Time: {t2_opt:.2f} hours")
print(f"\nPerformance:")
print(f"  Tensile Strength: {strength_opt:.1f} MPa")
print(f"  Total Process Cost: {cost_opt:.2f} (normalized)")
print(f"  Performance Index: {strength_opt/cost_opt:.2f} MPa/cost")

# æ¯”è¼ƒï¼šã‚·ãƒ³ã‚°ãƒ«ã‚¹ãƒ†ãƒƒãƒ—æ™‚åŠ¹
T_single = 180
t_single = 10
strength_single = two_step_aging_strength(0, 100, t_single, T_single)
cost_single = calculate_cost(0, 100, t_single, T_single)

print(f"\nComparison with Single-Step Aging ({T_single}Â°C, {t_single}h):")
print(f"  Strength: {strength_single:.1f} MPa")
print(f"  Cost: {cost_single:.2f}")
print(f"  Performance Index: {strength_single/cost_single:.2f} MPa/cost")
print(f"\nImprovement:")
print(f"  Strength: +{strength_opt - strength_single:.1f} MPa ({(strength_opt/strength_single-1)*100:.1f}%)")
print(f"  Performance Index: +{(strength_opt/cost_opt) - (strength_single/cost_single):.2f} ({((strength_opt/cost_opt)/(strength_single/cost_single)-1)*100:.1f}%)")</code></pre>
            </details>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-8: ç†±å‡¦ç†ãƒ—ãƒ­ã‚»ã‚¹ã®çµ±è¨ˆçš„å“è³ªç®¡ç†ï¼ˆHardï¼‰</h4>
            <p>å·¥å ´ã§ã®ç„¼æˆ»ã—å‡¦ç†ã«ãŠã„ã¦ã€æ¸©åº¦Â±5â„ƒã€æ™‚é–“Â±10%ã®å¤‰å‹•ãŒã‚ã‚‹ã€‚ç›®æ¨™ç¡¬åº¦HRC 50Â±2ã‚’é”æˆã™ã‚‹ç¢ºç‡ã‚’è¨ˆç®—ã—ã€ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ï¼ˆCp, Cpkï¼‰ã‚’è©•ä¾¡ã›ã‚ˆã€‚è¨±å®¹ç¯„å›²å¤–ã®ä¸è‰¯ç‡ã‚’1%ä»¥ä¸‹ã«æŠ‘ãˆã‚‹ãŸã‚ã®æ”¹å–„ç­–ã‚’ææ¡ˆã›ã‚ˆã€‚</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import norm

# ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ï¼ˆå…¬ç§°å€¤ï¼‰
T_nominal = 450  # â„ƒ
t_nominal = 2.0  # æ™‚é–“
HRC_target = 50

# ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•
T_std = 5 / 3  # â„ƒï¼ˆÂ±5â„ƒã‚’3Ïƒã¨ã™ã‚‹ï¼‰
t_std = t_nominal * 0.1 / 3  # æ™‚é–“ï¼ˆÂ±10%ã‚’3Ïƒã¨ã™ã‚‹ï¼‰

# ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
n_samples = 10000
np.random.seed(42)

T_samples = np.random.normal(T_nominal, T_std, n_samples)
t_samples = np.random.normal(t_nominal, t_std, n_samples)

# ç¡¬åº¦è¨ˆç®—ï¼ˆå„ã‚µãƒ³ãƒ—ãƒ«ï¼‰
hardness_samples = np.array([
    tempered_hardness(hollomon_jaffe_parameter(T, t))
    for T, t in zip(T_samples, t_samples)
])

# çµ±è¨ˆè§£æ
HRC_mean = np.mean(hardness_samples)
HRC_std = np.std(hardness_samples)

print(f"Process Capability Analysis:")
print(f"  Target Hardness: {HRC_target} Â± 2 HRC")
print(f"  Actual Mean: {HRC_mean:.2f} HRC")
print(f"  Actual Std Dev: {HRC_std:.2f} HRC")

# ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°
USL = HRC_target + 2  # Upper Specification Limit
LSL = HRC_target - 2  # Lower Specification Limit

Cp = (USL - LSL) / (6 * HRC_std)
Cpk = min((USL - HRC_mean) / (3 * HRC_std),
          (HRC_mean - LSL) / (3 * HRC_std))

print(f"\nProcess Capability Indices:")
print(f"  Cp = {Cp:.3f}")
print(f"  Cpk = {Cpk:.3f}")

if Cp >= 1.33:
    print(f"  â†’ Cp assessment: CAPABLE (â‰¥1.33)")
else:
    print(f"  â†’ Cp assessment: MARGINAL (<1.33)")

if Cpk >= 1.33:
    print(f"  â†’ Cpk assessment: CAPABLE and CENTERED (â‰¥1.33)")
else:
    print(f"  â†’ Cpk assessment: NEEDS IMPROVEMENT (<1.33)")

# ä¸è‰¯ç‡è¨ˆç®—
out_of_spec = np.sum((hardness_samples < LSL) | (hardness_samples > USL))
defect_rate = out_of_spec / n_samples * 100

print(f"\nDefect Rate:")
print(f"  Out of Specification: {out_of_spec} / {n_samples}")
print(f"  Defect Rate: {defect_rate:.2f}%")

if defect_rate < 1.0:
    print(f"  â†’ Target (<1%) ACHIEVED âœ“")
else:
    print(f"  â†’ Target (<1%) NOT MET âœ—")

# ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¨ãƒ—ãƒ­ã‚»ã‚¹åˆ†å¸ƒ
plt.figure(figsize=(12, 6))
plt.hist(hardness_samples, bins=50, density=True, alpha=0.7,
         color='blue', edgecolor='black', label='Actual Distribution')

# æ­£è¦åˆ†å¸ƒãƒ•ã‚£ãƒƒãƒˆ
x_fit = np.linspace(HRC_mean - 4*HRC_std, HRC_mean + 4*HRC_std, 200)
y_fit = norm.pdf(x_fit, HRC_mean, HRC_std)
plt.plot(x_fit, y_fit, 'r-', linewidth=2, label='Normal Fit')

# è¦æ ¼é™ç•Œ
plt.axvline(x=LSL, color='green', linestyle='--', linewidth=2, label='LSL/USL')
plt.axvline(x=USL, color='green', linestyle='--', linewidth=2)
plt.axvline(x=HRC_target, color='black', linestyle='-', linewidth=2, label='Target')

# è¦æ ¼å¤–é ˜åŸŸã‚’å¡—ã‚Šã¤ã¶ã—
x_below = x_fit[x_fit < LSL]
y_below = norm.pdf(x_below, HRC_mean, HRC_std)
plt.fill_between(x_below, 0, y_below, color='red', alpha=0.3, label='Out of Spec')

x_above = x_fit[x_fit > USL]
y_above = norm.pdf(x_above, HRC_mean, HRC_std)
plt.fill_between(x_above, 0, y_above, color='red', alpha=0.3)

plt.xlabel('Hardness (HRC)')
plt.ylabel('Probability Density')
plt.title(f'Tempering Process Capability (Cp={Cp:.2f}, Cpk={Cpk:.2f})')
plt.legend()
plt.grid(True, alpha=0.3)
plt.savefig('process_capability.png', dpi=150, bbox_inches='tight')
plt.show()

# æ”¹å–„ç­–ã®ææ¡ˆ
print(f"\nImprovement Recommendations:")

if Cpk < 1.33:
    print(f"  Priority 1: Reduce process variation")
    print(f"    - Improve temperature control (Â±3Â°C target)")
    print(f"    - Calibrate furnace thermocouples")
    print(f"    - Implement SPC charts for real-time monitoring")

if abs(HRC_mean - HRC_target) > 0.5:
    print(f"  Priority 2: Center the process")
    print(f"    - Adjust nominal temperature to {T_nominal + (HRC_target - HRC_mean)*2:.1f}Â°C")

print(f"  Priority 3: Implement closed-loop control")
print(f"    - Measure hardness in-line (non-destructive testing)")
print(f"    - Adaptive control based on feedback")

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šæ”¹å–„å¾Œã®äºˆæ¸¬
T_std_improved = 3 / 3  # Â±3â„ƒ
t_std_improved = t_nominal * 0.05 / 3  # Â±5%

T_samples_improved = np.random.normal(T_nominal, T_std_improved, n_samples)
t_samples_improved = np.random.normal(t_nominal, t_std_improved, n_samples)

hardness_improved = np.array([
    tempered_hardness(hollomon_jaffe_parameter(T, t))
    for T, t in zip(T_samples_improved, t_samples_improved)
])

HRC_std_improved = np.std(hardness_improved)
Cp_improved = (USL - LSL) / (6 * HRC_std_improved)
defect_rate_improved = np.sum((hardness_improved < LSL) | (hardness_improved > USL)) / n_samples * 100

print(f"\nProjected Improvement (Â±3Â°C, Â±5% time):")
print(f"  New Cp: {Cp_improved:.3f} (from {Cp:.3f})")
print(f"  New Defect Rate: {defect_rate_improved:.2f}% (from {defect_rate:.2f}%)")
print(f"  â†’ Improvement: {defect_rate - defect_rate_improved:.2f}% reduction")</code></pre>
            </details>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2-9: ç†±å‡¦ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ç·åˆèª²é¡Œï¼ˆHardï¼‰</h4>
            <p>è‡ªå‹•è»Šç”¨ã‚®ã‚¢ï¼ˆSCM440ï¼‰ã®è£½é€ ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ï¼ˆæµ¸ç‚­ç„¼å…¥ã‚Œ â†’ ç„¼æˆ»ã— â†’ è¡¨é¢ç¡¬åº¦HRC 58-62ã€èŠ¯éƒ¨ç¡¬åº¦HRC 35-40ï¼‰ã‚’è¨­è¨ˆã›ã‚ˆã€‚ãƒ—ãƒ­ã‚»ã‚¹æ™‚é–“ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã€ææ–™ç‰¹æ€§ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®ã—ã€Pythonã§æœ€é©ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ±ºå®šã›ã‚ˆã€‚</p>

            <details class="solution-box">
                <summary>è§£ç­”ä¾‹</summary>
                <pre><code class="language-python"># ç·åˆãƒ—ãƒ­ã‚»ã‚¹è¨­è¨ˆã®æ çµ„ã¿
print("Comprehensive Heat Treatment Process Design for Automotive Gear (SCM440)")
print("="*70)

# ã‚¹ãƒ†ãƒƒãƒ—1: æµ¸ç‚­ï¼ˆCarburizingï¼‰
print("\nStep 1: Carburizing Process")
T_carburizing = 930  # â„ƒ
t_carburizing = 8    # æ™‚é–“ï¼ˆåšã•3mmæµ¸ç‚­å±¤ï¼‰
case_depth = 3       # mm

print(f"  Temperature: {T_carburizing}Â°C")
print(f"  Time: {t_carburizing} hours")
print(f"  Target Case Depth: {case_depth} mm")
print(f"  Carbon Potential: 1.0-1.2%")

# ã‚¹ãƒ†ãƒƒãƒ—2: æ‹¡æ•£ï¼ˆDiffusion Holdï¼‰
print("\nStep 2: Diffusion Hold")
T_diffusion = 850  # â„ƒ
t_diffusion = 2    # æ™‚é–“
print(f"  Temperature: {T_diffusion}Â°C")
print(f"  Time: {t_diffusion} hours")
print(f"  Purpose: Uniform carbon distribution")

# ã‚¹ãƒ†ãƒƒãƒ—3: ç„¼å…¥ã‚Œï¼ˆQuenchingï¼‰
print("\nStep 3: Quenching")
T_quench_start = 850
T_quench_medium = 60  # æ²¹æ¸©
cooling_rate = 50      # â„ƒ/s

print(f"  Quench Medium: Oil at {T_quench_medium}Â°C")
print(f"  Cooling Rate: ~{cooling_rate}Â°C/s")
print(f"  Expected Surface Microstructure: Martensite (HRC 60-64)")
print(f"  Expected Core Microstructure: Martensite + Bainite (HRC 45-50)")

# ã‚¹ãƒ†ãƒƒãƒ—4: ç„¼æˆ»ã—ï¼ˆTemperingï¼‰
print("\nStep 4: Tempering")
T_tempering = 180  # â„ƒï¼ˆä½æ¸©ç„¼æˆ»ã—ï¼‰
t_tempering = 2    # æ™‚é–“

# ç¡¬åº¦äºˆæ¸¬ï¼ˆç°¡æ˜“ï¼‰
P_surface = hollomon_jaffe_parameter(T_tempering, t_tempering)
HRC_surface_tempered = tempered_hardness(P_surface, HRC_initial=62)

print(f"  Temperature: {T_tempering}Â°C")
print(f"  Time: {t_tempering} hours")
print(f"  Expected Surface Hardness: HRC {HRC_surface_tempered:.0f}")
print(f"  Expected Core Hardness: HRC 35-40 (minimal change)")

# ãƒ—ãƒ­ã‚»ã‚¹è©•ä¾¡
print("\n" + "="*70)
print("Process Performance Evaluation:")

# ç·ãƒ—ãƒ­ã‚»ã‚¹æ™‚é–“
total_time = t_carburizing + t_diffusion + 0.5 + t_tempering  # ç„¼å…¥ã‚Œ0.5h
print(f"  Total Process Time: {total_time:.1f} hours")

# ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆï¼ˆç°¡æ˜“è¨ˆç®—ï¼‰
# ç‚‰å®¹ç©1mÂ³ã€ãƒ’ãƒ¼ã‚¿ãƒ¼åŠ¹ç‡70%ã€é›»åŠ›å˜ä¾¡0.15 USD/kWh
furnace_volume = 1.0  # mÂ³
heat_capacity = 1200  # kJ/mÂ³/â„ƒ
efficiency = 0.7

energy_carb = furnace_volume * heat_capacity * T_carburizing * t_carburizing / efficiency
energy_diff = furnace_volume * heat_capacity * T_diffusion * t_diffusion / efficiency
energy_temp = furnace_volume * heat_capacity * T_tempering * t_tempering / efficiency

total_energy = (energy_carb + energy_diff + energy_temp) / 3600  # kWh
energy_cost = total_energy * 0.15  # USD/ãƒãƒƒãƒ

print(f"  Total Energy Consumption: {total_energy:.1f} kWh/batch")
print(f"  Energy Cost: ${energy_cost:.2f}/batch (100 gears)")
print(f"  Per-Gear Cost: ${energy_cost/100:.4f}")

# ææ–™ç‰¹æ€§è©•ä¾¡
print(f"\nTarget Material Properties:")
print(f"  Surface Hardness: HRC 58-62 (Target: {HRC_surface_tempered:.0f} âœ“)")
print(f"  Core Hardness: HRC 35-40 âœ“")
print(f"  Case Depth: {case_depth} mm âœ“")
print(f"  Core Toughness: Maintained by lower hardness")

# æœ€é©åŒ–ã®ä½™åœ°
print(f"\nOptimization Opportunities:")
print(f"  1. Use vacuum carburizing â†’ Reduce time by 30%")
print(f"  2. Implement press quenching â†’ Reduce distortion")
print(f"  3. Online hardness monitoring â†’ Quality assurance")
print(f"  4. Energy recovery system â†’ Reduce energy cost by 20%")

# çµè«–
print(f"\n" + "="*70)
print("Conclusion:")
print(f"  This process meets all specifications for automotive gears.")
print(f"  Total cycle time: {total_time:.1f} hours (competitive)")
print(f"  Energy efficiency: Moderate (improvement possible)")
print(f"  Quality assurance: Jominy testing + statistical process control recommended")</code></pre>
            </details>
        </div>

        <h2>å­¦ç¿’é”æˆåº¦ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ</h2>

        <h3>åŸºæœ¬ç†è§£ãƒ¬ãƒ™ãƒ«</h3>
        <ul>
            <li>â˜ ç„¼éˆã®4ã¤ã®ç¨®é¡ï¼ˆå®Œå…¨ç„¼éˆã€å¿œåŠ›é™¤å»ã€å†çµæ™¶ã€çƒçŠ¶åŒ–ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>â˜ Fickã®æ‹¡æ•£æ–¹ç¨‹å¼ã¨Arrheniusã®å¼ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            <li>â˜ ç„¼å…¥ã‚Œå†·å´é€Ÿåº¦ã¨çµ„ç¹”ï¼ˆãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆã€ãƒ™ã‚¤ãƒŠã‚¤ãƒˆã€ãƒ‘ãƒ¼ãƒ©ã‚¤ãƒˆï¼‰ã®é–¢ä¿‚ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>â˜ ç„¼æˆ»ã—ã«ã‚ˆã‚‹ç¡¬åº¦ã¨é±æ€§ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            <li>â˜ æ™‚åŠ¹ç¡¬åŒ–ã®3æ®µéšï¼ˆæº¶ä½“åŒ–â†’æ€¥å†·â†’æ™‚åŠ¹ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
        </ul>

        <h3>å®Ÿè·µã‚¹ã‚­ãƒ«ãƒ¬ãƒ™ãƒ«</h3>
        <ul>
            <li>â˜ æ‹¡æ•£è·é›¢ã¨ä¿æŒæ™‚é–“ã‚’è¨ˆç®—ã—ã€ç„¼éˆãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¨­è¨ˆã§ãã‚‹</li>
            <li>â˜ Jominyè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ç„¼å…¥æ€§ã‚’è©•ä¾¡ã§ãã‚‹</li>
            <li>â˜ Hollomon-Jaffeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ç„¼æˆ»ã—æ¡ä»¶ã‚’æ±ºå®šã§ãã‚‹</li>
            <li>â˜ TTT/CCTå›³ã‚’èª­ã¿å–ã‚Šã€å†·å´é€Ÿåº¦ã‹ã‚‰çµ„ç¹”ã‚’äºˆæ¸¬ã§ãã‚‹</li>
            <li>â˜ æ™‚åŠ¹ç¡¬åŒ–ã‚«ãƒ¼ãƒ–ã‹ã‚‰æœ€é©æ™‚åŠ¹æ™‚é–“ã‚’æ±ºå®šã§ãã‚‹</li>
        </ul>

        <h3>å¿œç”¨åŠ›ãƒ¬ãƒ™ãƒ«</h3>
        <ul>
            <li>â˜ TTTå›³ã‚’ç”¨ã„ãŸè¤‡é›‘ãªç†±å‡¦ç†ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆã‚ªãƒ¼ã‚¹ãƒ†ãƒ³ãƒ‘ãƒªãƒ³ã‚°ãªã©ï¼‰ã‚’è¨­è¨ˆã§ãã‚‹</li>
            <li>â˜ 2æ®µæ™‚åŠ¹å‡¦ç†ã®æœ€é©åŒ–ï¼ˆå¼·åº¦ãƒ»ã‚³ã‚¹ãƒˆã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ï¼‰ãŒã§ãã‚‹</li>
            <li>â˜ ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ï¼ˆCp, Cpkï¼‰ã§ç†±å‡¦ç†å“è³ªã‚’çµ±è¨ˆçš„ã«è©•ä¾¡ã§ãã‚‹</li>
            <li>â˜ æµ¸ç‚­ç„¼å…¥ã‚Œãªã©ã®è¤‡åˆãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã‚’è¨­è¨ˆãƒ»æœ€é©åŒ–ã§ãã‚‹</li>
            <li>â˜ ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ã®å½±éŸ¿ã‚’å®šé‡è©•ä¾¡ã§ãã‚‹</li>
            <li>â˜ ç†±å‡¦ç†ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã¨ç”Ÿç”£æ€§ã‚’ç·åˆçš„ã«è©•ä¾¡ã§ãã‚‹</li>
        </ul>

        <h2>å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Porter, D.A., Easterling, K.E., Sherif, M.Y. (2009). <em>Phase Transformations in Metals and Alloys</em> (3rd ed.). CRC Press, pp. 234-278, 345-389.</li>
            <li>Krauss, G. (2015). <em>Steels: Processing, Structure, and Performance</em> (2nd ed.). ASM International, pp. 145-189, 267-312.</li>
            <li>Honeycombe, R.W.K., Bhadeshia, H.K.D.H. (2017). <em>Steels: Microstructure and Properties</em> (4th ed.). Butterworth-Heinemann, pp. 89-124, 201-245.</li>
            <li>ASM International. (1991). <em>ASM Handbook Volume 4: Heat Treating</em>. ASM International, pp. 456-489, 567-602.</li>
            <li>Callister, W.D., Rethwisch, D.G. (2020). <em>Materials Science and Engineering: An Introduction</em> (10th ed.). Wiley, pp. 345-378, 412-456.</li>
            <li>Totten, G.E. (Ed.). (2006). <em>Steel Heat Treatment: Metallurgy and Technologies</em> (2nd ed.). CRC Press, pp. 123-167, 289-334.</li>
            <li>Polmear, I.J., StJohn, D., Nie, J.F., Qian, M. (2017). <em>Light Alloys: Metallurgy of the Light Metals</em> (5th ed.). Butterworth-Heinemann, pp. 178-223, 267-301.</li>
            <li>Brooks, C.R. (1996). <em>Principles of the Heat Treatment of Plain Carbon and Low Alloy Steels</em>. ASM International, pp. 56-89, 134-178.</li>
        </ol>

        <div class="navigation">
            <a href="chapter-1.html" class="nav-button">â† ç¬¬1ç« ï¼šãƒ—ãƒ­ã‚»ã‚¹åˆ¶å¾¡ã®åŸºç¤</a>
            <a href="chapter-3.html" class="nav-button">ç¬¬3ç« ï¼šè¡¨é¢å‡¦ç†æŠ€è¡“ â†’</a>
        </div>
    </main>

    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€ï¼ˆæ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©ï¼‰ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿ï¼ˆAS ISï¼‰ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶ï¼ˆä¾‹: CC BY 4.0ï¼‰ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: MS Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-28</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>