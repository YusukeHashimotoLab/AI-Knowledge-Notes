<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« ï¼šç¬¬ä¸€åŸç†è¨ˆç®—å…¥é–€ï¼ˆDFTåŸºç¤ï¼‰ | MS Terakoya - ææ–™ç‰©æ€§è«–å…¥é–€</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        @media (hover: hover) and (pointer: fine) {
            a:hover {
                color: var(--color-link-hover);
                text-decoration: underline;
            }
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .info-box {
            background-color: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .warning-box {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .success-box {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .exercise-box {
            background-color: var(--color-bg-alt);
            border: 2px solid var(--color-accent);
            padding: var(--spacing-md);
            margin: var(--spacing-lg) 0;
            border-radius: var(--border-radius);
        }

        .exercise-box h4 {
            color: var(--color-accent-light);
            margin-top: 0;
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
            gap: var(--spacing-md);
        }

        .nav-button {
            padding: var(--spacing-md) var(--spacing-lg);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
            flex: 1;
            max-width: 250px;
        }

        @media (hover: hover) and (pointer: fine) {
            .nav-button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                text-decoration: none;
            }
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .navigation {
                flex-direction: column;
            }

            .nav-button {
                max-width: 100%;
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'strict'
        });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                ignoreHtmlClass: 'mermaid'
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/MS/materials-properties-introduction/index.html">Materials Properties</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 3</span>
        </div>
    </nav>

        <header>
        <div class="header-content">
            <h1>ç¬¬3ç« ï¼šç¬¬ä¸€åŸç†è¨ˆç®—å…¥é–€ï¼ˆDFTåŸºç¤ï¼‰</h1>
            <p class="subtitle">å¯†åº¦æ±é–¢æ•°ç†è«–ã§ææ–™ã®é›»å­çŠ¶æ…‹ã‚’è§£ã</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– 35-40åˆ†</span>
                <span class="meta-item">ğŸ’» 12ã‚³ãƒ¼ãƒ‰ä¾‹</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸Šç´š</span>
                <span class="meta-item">ğŸ¯ å­¦ç¿’ç›®æ¨™: 3ã¤</span>
            </div>
        </div>
    </header>

    <main class="container">
        <h2>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h2>
        <div class="info-box">
            <h3>å­¦ç¿’ç›®æ¨™ï¼ˆ3ãƒ¬ãƒ™ãƒ«ï¼‰</h3>
            <h4>åŸºæœ¬ãƒ¬ãƒ™ãƒ«</h4>
            <ul>
                <li>DFTã®åŸºæœ¬åŸç†ï¼ˆHohenberg-Kohnå®šç†ã€Kohn-Shamæ–¹ç¨‹å¼ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>äº¤æ›ç›¸é–¢æ±é–¢æ•°ï¼ˆLDA, GGA, hybridï¼‰ã®é•ã„ã‚’ç†è§£ã§ãã‚‹</li>
                <li>DFTè¨ˆç®—ã®åŸºæœ¬çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’èª¬æ˜ã§ãã‚‹</li>
            </ul>
            <h4>ä¸­ç´šãƒ¬ãƒ™ãƒ«</h4>
            <ul>
                <li>ASE/Pymatgenã‚’ä½¿ã£ã¦çµæ™¶æ§‹é€ ã‚’ä½œæˆã—ã€DFTè¨ˆç®—ã®å…¥åŠ›ã‚’æº–å‚™ã§ãã‚‹</li>
                <li>VASPå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆINCAR, POSCAR, KPOINTS, POTCARï¼‰ã®å½¹å‰²ã‚’ç†è§£ã§ãã‚‹</li>
                <li>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã¨ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åæŸãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã§ãã‚‹</li>
            </ul>
            <h4>ä¸Šç´šãƒ¬ãƒ™ãƒ«</h4>
            <ul>
                <li>ææ–™ã®ç‰¹æ€§ã«å¿œã˜ã¦é©åˆ‡ãªæ±é–¢æ•°ã‚’é¸æŠã§ãã‚‹</li>
                <li>ç–‘æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¨PAWæ³•ã®é•ã„ã‚’ç†è§£ã—ã€é©åˆ‡ã«ä½¿ã„åˆ†ã‘ã‚‰ã‚Œã‚‹</li>
                <li>å®Ÿéš›ã®ç ”ç©¶ã§ä½¿ãˆã‚‹DFTè¨ˆç®—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
            </ul>
        </div>

        <h2>ç¬¬ä¸€åŸç†è¨ˆç®—ã¨ã¯</h2>
        <p>ç¬¬ä¸€åŸç†è¨ˆç®—ï¼ˆFirst-principles calculationï¼‰ã¯ã€çµŒé¨“çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”¨ã„ãšã€é‡å­åŠ›å­¦ã®åŸºæœ¬åŸç†ã‹ã‚‰å‡ºç™ºã—ã¦ææ–™ã®æ€§è³ªã‚’äºˆæ¸¬ã™ã‚‹è¨ˆç®—æ‰‹æ³•ã§ã™ã€‚å®Ÿé¨“çš„ã«æœªçŸ¥ã®ææ–™ã®ç‰©æ€§ã‚’ç†è«–çš„ã«äºˆæ¸¬ã§ãã‚‹ãŸã‚ã€ææ–™é–‹ç™ºã®å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã¨ãªã£ã¦ã„ã¾ã™ã€‚</p>

        <h3>å¤šä½“SchrÃ¶dingeræ–¹ç¨‹å¼ã®å›°é›£</h3>
        <p>ç†æƒ³çš„ã«ã¯ã€$N$å€‹ã®é›»å­ã¨$M$å€‹ã®åŸå­æ ¸ã‹ã‚‰ãªã‚‹ç³»ã®å…¨æ³¢å‹•é–¢æ•°$\Psi(\mathbf{r}_1, \ldots, \mathbf{r}_N, \mathbf{R}_1, \ldots, \mathbf{R}_M)$ã‚’è§£ãã¹ãã§ã™ï¼š</p>

        $$
        \hat{H}\Psi = E\Psi
        $$

        <p>ã—ã‹ã—ã€å¤šä½“ç³»ã®SchrÃ¶dingeræ–¹ç¨‹å¼ã‚’å³å¯†ã«è§£ãã“ã¨ã¯ã€è¨ˆç®—é‡ã®è¦³ç‚¹ã‹ã‚‰ä¸å¯èƒ½ã§ã™ã€‚ä¾‹ãˆã°ã€100å€‹ã®é›»å­ã‚’æŒã¤ç³»ã§ã¯ã€$3N = 300$æ¬¡å…ƒã®åå¾®åˆ†æ–¹ç¨‹å¼ã‚’è§£ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

        <h3>Born-Oppenheimerè¿‘ä¼¼</h3>
        <p>åŸå­æ ¸ã®è³ªé‡ã¯é›»å­ã®ç´„1,000å€ä»¥ä¸Šé‡ã„ãŸã‚ã€é›»å­ã¯åŸå­æ ¸ã®é‹å‹•ã«ç¬æ™‚ã«è¿½éšã™ã‚‹ã¨ä»®å®šã§ãã¾ã™ï¼ˆæ–­ç†±è¿‘ä¼¼ï¼‰ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€é›»å­ã¨åŸå­æ ¸ã®é‹å‹•ã‚’åˆ†é›¢ã§ãã¾ã™ï¼š</p>

        $$
        \Psi(\mathbf{r}_i, \mathbf{R}_\alpha) = \psi(\mathbf{r}_i; \mathbf{R}_\alpha) \chi(\mathbf{R}_\alpha)
        $$

        <p>åŸå­æ ¸ä½ç½®$\{\mathbf{R}_\alpha\}$ã‚’å›ºå®šã—ã¦ã€é›»å­ç³»ã®SchrÃ¶dingeræ–¹ç¨‹å¼ã‚’è§£ã‘ã°è‰¯ã„ã“ã¨ã«ãªã‚Šã¾ã™ã€‚</p>

        <h2>å¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰ã®åŸºç¤</h2>

        <h3>Hohenberg-Kohnå®šç†ï¼ˆ1964å¹´ï¼‰</h3>
        <p>DFTã®åŸºç¤ã¯ã€Hohenberg ã¨ Kohn ã«ã‚ˆã‚‹2ã¤ã®å®šç†ã§ã™ï¼š</p>

        <div class="info-box">
            <h4>ç¬¬1å®šç†ï¼šä¸€æ„æ€§å®šç†</h4>
            <p>å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«$V_{\text{ext}}(\mathbf{r})$ï¼ˆåŸå­æ ¸ã‹ã‚‰ã®ã‚¯ãƒ¼ãƒ­ãƒ³ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼‰ã¯ã€é›»å­å¯†åº¦$n(\mathbf{r})$ã«ã‚ˆã£ã¦ä¸€æ„ã«æ±ºã¾ã‚‹ï¼ˆå®šæ•°ã®å·®ã‚’é™¤ãï¼‰ã€‚</p>
            <p><strong>ç‰©ç†çš„æ„å‘³</strong>ï¼šé›»å­å¯†åº¦ãŒã‚ã‹ã‚Œã°ã€ç³»ã®å…¨ã¦ã®ç‰©ç†é‡ãŒæ±ºã¾ã‚‹ã€‚</p>
        </div>

        <div class="info-box">
            <h4>ç¬¬2å®šç†ï¼šå¤‰åˆ†åŸç†</h4>
            <p>åŸºåº•çŠ¶æ…‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€é›»å­å¯†åº¦ã®æ±é–¢æ•°$E[n]$ã§ã‚ã‚Šã€çœŸã®åŸºåº•çŠ¶æ…‹å¯†åº¦ã§æœ€å°å€¤ã‚’å–ã‚‹ï¼š</p>
            $$
            E_0 = \min_{n} E[n]
            $$
            <p><strong>ç‰©ç†çš„æ„å‘³</strong>ï¼šé›»å­å¯†åº¦ã‚’å¤‰åˆ†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æœ€å°åŒ–ã§ãã‚‹ã€‚</p>
        </div>

        <p>ã“ã®å®šç†ã«ã‚ˆã‚Šã€å¤šä½“æ³¢å‹•é–¢æ•°$\Psi(\mathbf{r}_1, \ldots, \mathbf{r}_N)$ï¼ˆ$3N$æ¬¡å…ƒï¼‰ã®ä»£ã‚ã‚Šã«ã€é›»å­å¯†åº¦$n(\mathbf{r})$ï¼ˆ3æ¬¡å…ƒï¼‰ã‚’æ‰±ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚è¨ˆç®—é‡ã®åŠ‡çš„ãªå‰Šæ¸›ã§ã™ã€‚</p>

        <h3>Kohn-Shamæ–¹ç¨‹å¼ï¼ˆ1965å¹´ï¼‰</h3>
        <p>Hohenberg-Kohnå®šç†ã¯å­˜åœ¨å®šç†ã§ã™ãŒã€å®Ÿéš›ã«ã©ã†ã‚„ã£ã¦$E[n]$ã‚’æ±‚ã‚ã‚‹ã‹ã¯ç¤ºã—ã¦ã„ã¾ã›ã‚“ã€‚Kohn ã¨ Sham ã¯ã€ç›¸äº’ä½œç”¨ã™ã‚‹å¤šé›»å­ç³»ã‚’ã€åŒã˜å¯†åº¦ã‚’æŒã¤ã€Œéç›¸äº’ä½œç”¨ç³»ã€ã«å†™åƒã™ã‚‹ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’ææ¡ˆã—ã¾ã—ãŸã€‚</p>

        <p>é›»å­å¯†åº¦$n(\mathbf{r})$ã¯ã€$N$å€‹ã®Kohn-Shamè»Œé“$\{\phi_i(\mathbf{r})\}$ã‚’ä½¿ã£ã¦è¡¨ã•ã‚Œã¾ã™ï¼š</p>

        $$
        n(\mathbf{r}) = \sum_{i=1}^N |\phi_i(\mathbf{r})|^2
        $$

        <p>å„è»Œé“ã¯ã€Kohn-Shamæ–¹ç¨‹å¼ã‚’æº€ãŸã—ã¾ã™ï¼š</p>

        $$
        \left[ -\frac{\hbar^2}{2m}\nabla^2 + V_{\text{eff}}(\mathbf{r}) \right] \phi_i(\mathbf{r}) = \varepsilon_i \phi_i(\mathbf{r})
        $$

        <p>ã“ã“ã§ã€æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«$V_{\text{eff}}$ã¯ï¼š</p>

        $$
        V_{\text{eff}}(\mathbf{r}) = V_{\text{ext}}(\mathbf{r}) + V_{\text{H}}(\mathbf{r}) + V_{\text{xc}}(\mathbf{r})
        $$

        <ul>
            <li><strong>$V_{\text{ext}}$</strong>: å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆåŸå­æ ¸ã‹ã‚‰ã®ã‚¯ãƒ¼ãƒ­ãƒ³ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼‰</li>
            <li><strong>$V_{\text{H}}$</strong>: Hartreeãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆé›»å­é–“ã®å¤å…¸çš„ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨ï¼‰</li>
            <li><strong>$V_{\text{xc}}$</strong>: äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆé‡å­åŠ›å­¦çš„åŠ¹æœã‚’å…¨ã¦å«ã‚€ï¼‰</li>
        </ul>

        <h3>äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼šDFTã®å¿ƒè‡“éƒ¨</h3>
        <p>äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼$E_{\text{xc}}[n]$ã¯ã€DFTã«ãŠã‘ã‚‹å”¯ä¸€ã®è¿‘ä¼¼éƒ¨åˆ†ã§ã™ã€‚äº¤æ›ï¼ˆexchangeï¼‰ã¨ç›¸é–¢ï¼ˆcorrelationï¼‰ã®åŠ¹æœã‚’å«ã¿ã¾ã™ï¼š</p>

        <ul>
            <li><strong>äº¤æ›ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong>ï¼šPauliæ’ä»–å¾‹ã«ã‚ˆã‚‹åŒç¨®ã‚¹ãƒ”ãƒ³ã®é›»å­é–“åç™ºã®ä½æ¸›</li>
            <li><strong>ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong>ï¼šé›»å­é–“ç›¸äº’ä½œç”¨ã«ã‚ˆã‚‹é‹å‹•ã®ç›¸é–¢</li>
        </ul>

        <p>äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¯ã€$E_{\text{xc}}[n]$ã®æ±é–¢æ•°å¾®åˆ†ã§å¾—ã‚‰ã‚Œã¾ã™ï¼š</p>

        $$
        V_{\text{xc}}(\mathbf{r}) = \frac{\delta E_{\text{xc}}[n]}{\delta n(\mathbf{r})}
        $$

        <h2>äº¤æ›ç›¸é–¢æ±é–¢æ•°ã®ç¨®é¡</h2>

        <h3>LDAï¼ˆLocal Density Approximationï¼‰</h3>
        <p>æœ€ã‚‚å˜ç´”ãªè¿‘ä¼¼ã€‚å„ç‚¹$\mathbf{r}$ã§ã®äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼å¯†åº¦ãŒã€å¯†åº¦$n(\mathbf{r})$ã®ä¸€æ§˜é›»å­ã‚¬ã‚¹ã®ãã‚Œã«ç­‰ã—ã„ã¨ä»®å®šã—ã¾ã™ï¼š</p>

        $$
        E_{\text{xc}}^{\text{LDA}}[n] = \int n(\mathbf{r}) \varepsilon_{\text{xc}}(n(\mathbf{r})) d\mathbf{r}
        $$

        <p><strong>ç‰¹å¾´</strong>ï¼š</p>
        <ul>
            <li>è¨ˆç®—ã‚³ã‚¹ãƒˆãŒä½ã„</li>
            <li>å¯†åº¦ãŒã‚†ã£ãã‚Šå¤‰åŒ–ã™ã‚‹ç³»ï¼ˆé‡‘å±ï¼‰ã§è‰¯ã„ç²¾åº¦</li>
            <li>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’éå°è©•ä¾¡ã™ã‚‹å‚¾å‘</li>
            <li>å¼±ã„ç›¸äº’ä½œç”¨ï¼ˆvan der WaalsåŠ›ï¼‰ã‚’è¨˜è¿°ã§ããªã„</li>
        </ul>

        <h3>GGAï¼ˆGeneralized Gradient Approximationï¼‰</h3>
        <p>å¯†åº¦$n(\mathbf{r})$ã ã‘ã§ãªãã€ãã®å‹¾é…$\nabla n(\mathbf{r})$ã‚‚è€ƒæ…®ã—ã¾ã™ï¼š</p>

        $$
        E_{\text{xc}}^{\text{GGA}}[n] = \int n(\mathbf{r}) \varepsilon_{\text{xc}}(n(\mathbf{r}), |\nabla n(\mathbf{r})|) d\mathbf{r}
        $$

        <p><strong>ä»£è¡¨çš„ãªGGAæ±é–¢æ•°</strong>ï¼š</p>
        <ul>
            <li><strong>PBE</strong>ï¼ˆPerdew-Burke-Ernzerhofï¼‰: å›ºä½“ç‰©æ€§è¨ˆç®—ã§æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹</li>
            <li><strong>PW91</strong>: PBEã®å‰èº«</li>
            <li><strong>BLYP</strong>: åˆ†å­ç³»ã§ã‚ˆãä½¿ã‚ã‚Œã‚‹</li>
        </ul>

        <p><strong>ç‰¹å¾´</strong>ï¼š</p>
        <ul>
            <li>LDAã‚ˆã‚ŠåŸå­é–“çµåˆè·é›¢ã‚„çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæ”¹å–„</li>
            <li>åˆ†å­ç³»ãƒ»è¡¨é¢ç³»ã§é«˜ç²¾åº¦</li>
            <li>è¨ˆç®—ã‚³ã‚¹ãƒˆã¯LDAã¨ã»ã¼åŒç­‰</li>
            <li>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®éå°è©•ä¾¡ã¯ä¾ç„¶ã¨ã—ã¦å­˜åœ¨</li>
        </ul>

        <h3>Hybridæ±é–¢æ•°</h3>
        <p>Hartree-Fockäº¤æ›ï¼ˆå³å¯†äº¤æ›ï¼‰ã‚’ä¸€éƒ¨æ··ãœã‚‹æ–¹æ³•ã€‚ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®ç²¾åº¦ã‚’æ”¹å–„ã—ã¾ã™ï¼š</p>

        $$
        E_{\text{xc}}^{\text{hybrid}} = aE_{\text{x}}^{\text{HF}} + (1-a)E_{\text{x}}^{\text{DFT}} + E_{\text{c}}^{\text{DFT}}
        $$

        <p><strong>ä»£è¡¨çš„ãªhybridæ±é–¢æ•°</strong>ï¼š</p>
        <ul>
            <li><strong>PBE0</strong>: HFäº¤æ›ã‚’25%æ··åˆï¼ˆ$a=0.25$ï¼‰</li>
            <li><strong>HSE06</strong>: çŸ­è·é›¢ã®ã¿HFäº¤æ›ã‚’ä½¿ç”¨ï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼‰</li>
            <li><strong>B3LYP</strong>: åˆ†å­ç³»ã§åºƒãä½¿ç”¨</li>
        </ul>

        <p><strong>ç‰¹å¾´</strong>ï¼š</p>
        <ul>
            <li>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’æ­£ç¢ºã«äºˆæ¸¬</li>
            <li>åŠå°ä½“ãƒ»çµ¶ç¸ä½“ã«æœ‰åŠ¹</li>
            <li>è¨ˆç®—ã‚³ã‚¹ãƒˆãŒé«˜ã„ï¼ˆGGAã®5-10å€ï¼‰</li>
        </ul>

        <div class="mermaid">
graph TD
    A[äº¤æ›ç›¸é–¢æ±é–¢æ•°] --> B[LDA]
    A --> C[GGA]
    A --> D[Hybrid]
    A --> E[ãƒ¡ã‚¿GGA]

    B --> B1[æœ€é€Ÿ/ä½ç²¾åº¦]
    C --> C1[æ¨™æº–/é«˜ç²¾åº¦]
    D --> D1[é«˜ç²¾åº¦/é«˜ã‚³ã‚¹ãƒˆ]
    E --> E1[ç ”ç©¶ç”¨/æœ€é«˜ç²¾åº¦]

    style A fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style C fill:#d4edda,stroke:#28a745,stroke-width:2px
    style D fill:#fff3cd,stroke:#ffc107,stroke-width:2px
</div>

        <h2>ç–‘æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¨PAWæ³•</h2>

        <h3>å…¨é›»å­è¨ˆç®—ã®å›°é›£</h3>
        <p>åŸå­ã®å†…æ®»é›»å­ï¼ˆ1s, 2s, 2pãªã©ï¼‰ã¯ï¼š</p>
        <ul>
            <li>åŒ–å­¦çµåˆã«ã»ã¨ã‚“ã©å¯„ä¸ã—ãªã„</li>
            <li>åŸå­æ ¸è¿‘å‚ã§æ€¥æ¿€ã«æŒ¯å‹•ã™ã‚‹æ³¢å‹•é–¢æ•°ã‚’æŒã¤</li>
            <li>è¨˜è¿°ã«å¤šæ•°ã®å¹³é¢æ³¢åŸºåº•ãŒå¿…è¦ï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆå¤§ï¼‰</li>
        </ul>

        <h3>ç–‘æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆPseudopotentialï¼‰</h3>
        <p>å†…æ®»é›»å­ã®åŠ¹æœã‚’ã€Œç–‘æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã€ã§ç½®ãæ›ãˆã€ä¾¡é›»å­ã®ã¿ã‚’æ˜ç¤ºçš„ã«æ‰±ã†æ–¹æ³•ã§ã™ã€‚</p>

        <div class="info-box">
            <h4>ç–‘æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ¡ä»¶</h4>
            <ul>
                <li>ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„$r_c$ã®å¤–å´ã§ã€å…¨é›»å­æ³¢å‹•é–¢æ•°ã¨ä¸€è‡´</li>
                <li>å…¨é›»å­ç³»ã¨åŒã˜æ•£ä¹±ç‰¹æ€§ã‚’æŒã¤</li>
                <li>ãƒãƒ«ãƒ ä¿å­˜æ€§ï¼šé›»è·ãŒä¿å­˜ã•ã‚Œã‚‹</li>
            </ul>
        </div>

        <p><strong>ç¨®é¡</strong>ï¼š</p>
        <ul>
            <li><strong>ãƒãƒ«ãƒ ä¿å­˜å‹</strong>ï¼ˆNorm-conservingï¼‰ï¼šç²¾åº¦ãŒé«˜ã„ãŒè»¢é€æ€§ã«èª²é¡Œ</li>
            <li><strong>ã‚¦ãƒ«ãƒˆãƒ©ã‚½ãƒ•ãƒˆå‹</strong>ï¼ˆUltrasoftï¼‰ï¼šè»¢é€æ€§ãŒè‰¯ã„ãŒè¤‡é›‘</li>
            <li><strong>PAWæ³•</strong>ï¼ˆProjector Augmented Waveï¼‰ï¼šç¾åœ¨ã®æ¨™æº–</li>
        </ul>

        <h3>PAWï¼ˆProjector Augmented Waveï¼‰æ³•</h3>
        <p>PAWæ³•ã¯ã€å…¨é›»å­æ³¢å‹•é–¢æ•°ã¨ç–‘æ“¬æ³¢å‹•é–¢æ•°ã‚’å³å¯†ã«é–¢ä¿‚ã¥ã‘ã‚‹å¤‰æ›ã‚’å°å…¥ã—ã¾ã™ï¼š</p>

        $$
        |\psi\rangle = |\tilde{\psi}\rangle + \sum_i (|\phi_i\rangle - |\tilde{\phi}_i\rangle) \langle\tilde{p}_i|\tilde{\psi}\rangle
        $$

        <ul>
            <li>$|\tilde{\psi}\rangle$ï¼šç–‘æ“¬æ³¢å‹•é–¢æ•°ï¼ˆè¨ˆç®—ã§æ‰±ã†ï¼‰</li>
            <li>$|\psi\rangle$ï¼šå…¨é›»å­æ³¢å‹•é–¢æ•°ï¼ˆç‰©ç†é‡è¨ˆç®—ã§ä½¿ç”¨ï¼‰</li>
        </ul>

        <p><strong>PAWã®åˆ©ç‚¹</strong>ï¼š</p>
        <ul>
            <li>å…¨é›»å­è¨ˆç®—ã«è¿‘ã„ç²¾åº¦</li>
            <li>è¨ˆç®—ã‚³ã‚¹ãƒˆã¯ç–‘æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ä¸¦ã¿</li>
            <li>VASPã®æ¨™æº–æ‰‹æ³•</li>
        </ul>

        <h2>kç‚¹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</h2>

        <h3>Blochã®å®šç†ã¨å‘¨æœŸå¢ƒç•Œæ¡ä»¶</h3>
        <p>çµæ™¶ã¯å‘¨æœŸæ§‹é€ ã‚’æŒã¤ãŸã‚ã€Blochã®å®šç†ãŒæˆã‚Šç«‹ã¡ã¾ã™ï¼š</p>

        $$
        \psi_{n\mathbf{k}}(\mathbf{r}) = e^{i\mathbf{k}\cdot\mathbf{r}} u_{n\mathbf{k}}(\mathbf{r})
        $$

        <p>ã“ã“ã§ã€$u_{n\mathbf{k}}(\mathbf{r})$ã¯æ ¼å­å‘¨æœŸé–¢æ•°ã§ã™ã€‚æ³¢å‹•é–¢æ•°ã¯æ³¢æ•°ãƒ™ã‚¯ãƒˆãƒ«$\mathbf{k}$ã§ãƒ©ãƒ™ãƒ«ä»˜ã‘ã•ã‚Œã¾ã™ã€‚</p>

        <h3>Brillouinã‚¾ãƒ¼ãƒ³ã¨kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥</h3>
        <p>ç¬¬ä¸€Brillouinã‚¾ãƒ¼ãƒ³å†…ã®$\mathbf{k}$ç‚¹ã§ã€Kohn-Shamæ–¹ç¨‹å¼ã‚’è§£ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚å®Ÿéš›ã«ã¯ã€æœ‰é™å€‹ã®kç‚¹ã§ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¾ã™ã€‚</p>

        <p><strong>Monkhorst-Packãƒ¡ãƒƒã‚·ãƒ¥</strong>ï¼š</p>
        <p>Brillouinã‚¾ãƒ¼ãƒ³ã‚’ç­‰é–“éš”ã§åˆ†å‰²ï¼š</p>

        $$
        \mathbf{k} = \frac{n_1}{N_1}\mathbf{b}_1 + \frac{n_2}{N_2}\mathbf{b}_2 + \frac{n_3}{N_3}\mathbf{b}_3
        $$

        <p>$N_1 \times N_2 \times N_3$ã®ãƒ¡ãƒƒã‚·ãƒ¥å¯†åº¦ã‚’æŒ‡å®šã—ã¾ã™ã€‚</p>

        <div class="warning-box">
            <h4>kç‚¹åæŸãƒ†ã‚¹ãƒˆã®é‡è¦æ€§</h4>
            <p>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ãŒç²—ã„ã¨ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚„ç‰©æ€§å€¤ãŒåæŸã—ã¾ã›ã‚“ã€‚ç‰¹ã«é‡‘å±ã¯å¯†ãªãƒ¡ãƒƒã‚·ãƒ¥ãŒå¿…è¦ã§ã™ï¼ˆåŠå°ä½“ã‚ˆã‚Š3-4å€å¯†ï¼‰ã€‚ç›®å®‰ï¼š</p>
            <ul>
                <li>åŠå°ä½“ï¼š4Ã—4Ã—4 ã€œ 8Ã—8Ã—8</li>
                <li>é‡‘å±ï¼š12Ã—12Ã—12 ã€œ 16Ã—16Ã—16</li>
                <li>è¡¨é¢ãƒ»2æ¬¡å…ƒç³»ï¼šk_zæ–¹å‘ã¯ç²—ãã¦è‰¯ã„ï¼ˆä¾‹ï¼š8Ã—8Ã—1ï¼‰</li>
            </ul>
        </div>

        <h2>å¹³é¢æ³¢åŸºåº•ã¨ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼</h2>

        <h3>å¹³é¢æ³¢å±•é–‹</h3>
        <p>å‘¨æœŸç³»ã§ã¯ã€Kohn-Shamè»Œé“ã‚’å¹³é¢æ³¢ã§å±•é–‹ã§ãã¾ã™ï¼š</p>

        $$
        \phi_{n\mathbf{k}}(\mathbf{r}) = \sum_{\mathbf{G}} c_{n\mathbf{k}}(\mathbf{G}) e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}}
        $$

        <p>$\mathbf{G}$ã¯é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚åŸç†çš„ã«ã¯ç„¡é™å’Œã§ã™ãŒã€å®Ÿéš›ã«ã¯æœ‰é™é …ã§æ‰“ã¡åˆ‡ã‚Šã¾ã™ã€‚</p>

        <h3>ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼$E_{\text{cut}}$</h3>
        <p>æ³¢æ•°$|\mathbf{k}+\mathbf{G}|$ã«å¯¾å¿œã™ã‚‹é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼š</p>

        $$
        E = \frac{\hbar^2}{2m}|\mathbf{k}+\mathbf{G}|^2
        $$

        <p>ãŒ$E_{\text{cut}}$ä»¥ä¸‹ã®å¹³é¢æ³¢ã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š</p>

        $$
        \frac{\hbar^2}{2m}|\mathbf{k}+\mathbf{G}|^2 < E_{\text{cut}}
        $$

        <p><strong>å…¸å‹çš„ãªå€¤</strong>ï¼š</p>
        <ul>
            <li>PAWï¼š400-600 eVï¼ˆå…ƒç´ ã«ã‚ˆã‚‹ï¼‰</li>
            <li>Ultrasoft PPï¼š30-50 Ryï¼ˆç´„400-680 eVï¼‰</li>
        </ul>

        <div class="warning-box">
            <h4>ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸãƒ†ã‚¹ãƒˆ</h4>
            <p>ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒã‚«ãƒƒãƒˆã‚ªãƒ•ã®å¢—åŠ ã«å¯¾ã—ã¦åæŸã™ã‚‹ã¾ã§ãƒ†ã‚¹ãƒˆã—ã¾ã™ã€‚ç›®æ¨™ï¼š</p>
            <ul>
                <li>å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼š1 meV/atom ä»¥ä¸‹ã®å¤‰åŒ–</li>
                <li>æ ¼å­å®šæ•°ï¼š0.01 Ã… ä»¥ä¸‹ã®å¤‰åŒ–</li>
            </ul>
        </div>

        <h2>Pythonã§å­¦ã¶DFTï¼šASE/Pymatgenå…¥é–€</h2>

        <h3>ASEï¼ˆAtomic Simulation Environmentï¼‰ã®åŸºç¤</h3>
        <p>ASEã¯ã€åŸå­æ§‹é€ ã®æ“ä½œã¨DFTè¨ˆç®—ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’çµ±ä¸€çš„ã«æ‰±ãˆã‚‹Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚</p>

        <pre><code class="language-python">
import numpy as np
from ase import Atoms
from ase.build import bulk, surface, molecule
from ase.visualize import view
import matplotlib.pyplot as plt

# 1. çµæ™¶æ§‹é€ ã®ä½œæˆ
# Siï¼ˆãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼‰
si = bulk('Si', 'diamond', a=5.43)
print("Si çµæ™¶æ§‹é€ :")
print(si)
print(f"æ ¼å­å®šæ•°: {si.cell[0,0]:.3f} Ã…")
print(f"åŸå­æ•°: {len(si)}")

# 2. æ§˜ã€…ãªçµæ™¶æ§‹é€ ã®ä½œæˆ
structures = {
    'Al (FCC)': bulk('Al', 'fcc', a=4.05),
    'Fe (BCC)': bulk('Fe', 'bcc', a=2.87),
    'Cu (FCC)': bulk('Cu', 'fcc', a=3.61),
    'GaAs (zincblende)': bulk('GaAs', 'zincblende', a=5.65)
}

for name, struct in structures.items():
    print(f"\n{name}:")
    print(f"  æ ¼å­å®šæ•°: {struct.cell[0,0]:.3f} Ã…")
    print(f"  åŸå­æ•°: {len(struct)}")
    print(f"  åŒ–å­¦å¼: {struct.get_chemical_formula()}")

# 3. è¡¨é¢æ§‹é€ ã®ä½œæˆ
# Si(111) è¡¨é¢
si_surface = surface('Si', (1,1,1), layers=4, vacuum=10.0)
print(f"\nSi(111) è¡¨é¢:")
print(f"  åŸå­æ•°: {len(si_surface)}")
print(f"  ã‚»ãƒ«ã‚µã‚¤ã‚º: {si_surface.cell.lengths()}")

# 4. åˆ†å­æ§‹é€ ã®ä½œæˆ
h2o = molecule('H2O')
print(f"\nH2O åˆ†å­:")
print(f"  åŸå­æ•°: {len(h2o)}")
for i, atom in enumerate(h2o):
    print(f"  {atom.symbol}: {atom.position}")
</code></pre>

        <h3>çµæ™¶æ§‹é€ ã®è©³ç´°æƒ…å ±å–å¾—</h3>

        <pre><code class="language-python">
from ase.build import bulk
import numpy as np

# Siçµæ™¶ã®è©³ç´°è§£æ
si = bulk('Si', 'diamond', a=5.43)

# ã‚»ãƒ«æƒ…å ±
print("ã‚»ãƒ«è¡Œåˆ—:")
print(si.cell)
print(f"\nã‚»ãƒ«ä½“ç©: {si.get_volume():.3f} Ã…Â³")

# åŸå­ä½ç½®ï¼ˆåˆ†æ•°åº§æ¨™ï¼‰
print("\nåŸå­ã®åˆ†æ•°åº§æ¨™:")
scaled_pos = si.get_scaled_positions()
for i, pos in enumerate(scaled_pos):
    print(f"  åŸå­{i}: ({pos[0]:.4f}, {pos[1]:.4f}, {pos[2]:.4f})")

# åŸå­ä½ç½®ï¼ˆãƒ‡ã‚«ãƒ«ãƒˆåº§æ¨™ï¼‰
print("\nåŸå­ã®ãƒ‡ã‚«ãƒ«ãƒˆåº§æ¨™ [Ã…]:")
for i, pos in enumerate(si.positions):
    print(f"  åŸå­{i}: ({pos[0]:.4f}, {pos[1]:.4f}, {pos[2]:.4f})")

# åŸå­é–“è·é›¢è¨ˆç®—
from ase.neighborlist import NeighborList, natural_cutoffs

cutoffs = natural_cutoffs(si)
nl = NeighborList(cutoffs, self_interaction=False, bothways=True)
nl.update(si)

print("\næœ€è¿‘æ¥åŸå­é–“è·é›¢:")
for i in range(len(si)):
    indices, offsets = nl.get_neighbors(i)
    for j, offset in zip(indices, offsets):
        dist = si.get_distance(i, j, mic=True)
        print(f"  åŸå­{i} - åŸå­{j}: {dist:.4f} Ã…")
    break  # æœ€åˆã®åŸå­ã®ã¿è¡¨ç¤º
</code></pre>

        <h3>Pymatgenã§çµæ™¶æ§‹é€ ã‚’æ“ä½œ</h3>

        <pre><code class="language-python">
from pymatgen.core import Structure, Lattice
import numpy as np

# 1. æ ¼å­å®šæ•°ã‹ã‚‰çµæ™¶æ§‹é€ ã‚’ä½œæˆ
# Siï¼ˆãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼‰
lattice = Lattice.cubic(5.43)
si_struct = Structure(
    lattice,
    ["Si", "Si"],
    [[0.00, 0.00, 0.00],
     [0.25, 0.25, 0.25]]
)

print("Si çµæ™¶æ§‹é€  (Pymatgen):")
print(si_struct)

# 2. å¯¾ç§°æ€§è§£æ
from pymatgen.symmetry.analyzer import SpacegroupAnalyzer

analyzer = SpacegroupAnalyzer(si_struct)
print(f"\nç©ºé–“ç¾¤: {analyzer.get_space_group_symbol()}")
print(f"ç©ºé–“ç¾¤ç•ªå·: {analyzer.get_space_group_number()}")
print(f"ç‚¹ç¾¤: {analyzer.get_point_group_symbol()}")

# 3. åŸå§‹æ ¼å­ã¸ã®å¤‰æ›
primitive = analyzer.get_primitive_standard_structure()
print(f"\nåŸå§‹æ ¼å­ã®åŸå­æ•°: {len(primitive)}")
print(f"æ…£ç”¨æ ¼å­ã®åŸå­æ•°: {len(si_struct)}")

# 4. è¤‡åˆææ–™ï¼šGaAs
gaas_struct = Structure(
    Lattice.cubic(5.65),
    ["Ga", "As"],
    [[0.00, 0.00, 0.00],
     [0.25, 0.25, 0.25]]
)
print("\nGaAs çµæ™¶æ§‹é€ :")
print(gaas_struct)
print(f"ç©ºé–“ç¾¤: {SpacegroupAnalyzer(gaas_struct).get_space_group_symbol()}")
</code></pre>

        <h3>ASEã¨Pymatgenã®ç›¸äº’å¤‰æ›</h3>

        <pre><code class="language-python">
from ase.build import bulk
from pymatgen.io.ase import AseAtomsAdaptor

# ASE â†’ Pymatgen
si_ase = bulk('Si', 'diamond', a=5.43)
adaptor = AseAtomsAdaptor()
si_pmg = adaptor.get_structure(si_ase)

print("ASE ã‹ã‚‰ Pymatgen ã¸ã®å¤‰æ›:")
print(si_pmg)

# Pymatgen â†’ ASE
si_ase_back = adaptor.get_atoms(si_pmg)
print("\nPymatgen ã‹ã‚‰ ASE ã¸ã®å¤‰æ›:")
print(si_ase_back)

# ä¸¡æ–¹ã®åˆ©ç‚¹ã‚’æ´»ç”¨
# ASE: è¨ˆç®—ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«ä¾¿åˆ©
# Pymatgen: å¯¾ç§°æ€§è§£æã€Materials Projecté€£æºã«å¼·åŠ›
</code></pre>

        <h2>VASPå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ</h2>

        <h3>VASPã®4ã¤ã®å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«</h3>
        <p>VASPã«ã¯4ã¤ã®ä¸»è¦ãªå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã™ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>ãƒ•ã‚¡ã‚¤ãƒ«å</th>
                    <th>å†…å®¹</th>
                    <th>ä½œæˆæ–¹æ³•</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>INCAR</strong></td>
                    <td>è¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆæ±é–¢æ•°ã€kç‚¹ã€åæŸæ¡ä»¶ãªã©ï¼‰</td>
                    <td>æ‰‹å‹•ã¾ãŸã¯Pymatgen</td>
                </tr>
                <tr>
                    <td><strong>POSCAR</strong></td>
                    <td>åŸå­æ§‹é€ ï¼ˆæ ¼å­å®šæ•°ã€åŸå­ä½ç½®ï¼‰</td>
                    <td>ASE/Pymatgenã‹ã‚‰è‡ªå‹•ç”Ÿæˆ</td>
                </tr>
                <tr>
                    <td><strong>KPOINTS</strong></td>
                    <td>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥è¨­å®š</td>
                    <td>æ‰‹å‹•ã¾ãŸã¯Pymatgen</td>
                </tr>
                <tr>
                    <td><strong>POTCAR</strong></td>
                    <td>ç–‘æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆPAWï¼‰</td>
                    <td>VASPä»˜å±ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒ”ãƒ¼</td>
                </tr>
            </tbody>
        </table>

        <h3>POSCARï¼ˆåŸå­æ§‹é€ ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰</h3>

        <pre><code class="language-python">
from ase.build import bulk
from ase.io import write

# Siçµæ™¶ã®POSCARãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ
si = bulk('Si', 'diamond', a=5.43)

# 2Ã—2Ã—2ã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ã«æ‹¡å¤§
si_supercell = si.repeat((2, 2, 2))

# POSCARãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãå‡ºã—
write('POSCAR', si_supercell, format='vasp')

print("POSCARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ")
print(f"åŸå­æ•°: {len(si_supercell)}")

# POSCARãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’è¡¨ç¤º
with open('POSCAR', 'r') as f:
    print("\nPOSCAR ã®å†…å®¹:")
    print(f.read())
</code></pre>

        <p>ç”Ÿæˆã•ã‚Œã‚‹POSCARãƒ•ã‚¡ã‚¤ãƒ«ã®å½¢å¼ï¼š</p>

        <pre><code>
Si16
1.0
   10.8600000000    0.0000000000    0.0000000000
    0.0000000000   10.8600000000    0.0000000000
    0.0000000000    0.0000000000   10.8600000000
Si
16
Direct
  0.0000000000  0.0000000000  0.0000000000
  0.1250000000  0.1250000000  0.1250000000
  ...
</code></pre>

        <h3>INCARãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ</h3>

        <pre><code class="language-python">
# INCARãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆç”Ÿæˆ

def create_incar(calculation_type='scf', system_name='Si',
                 functional='PBE', encut=400, ismear=0, sigma=0.05):
    """
    VASP INCARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ

    Parameters:
    -----------
    calculation_type : str
        'scf' (ä¸€ç‚¹è¨ˆç®—), 'relax' (æ§‹é€ æœ€é©åŒ–), 'band' (ãƒãƒ³ãƒ‰æ§‹é€ )
    functional : str
        'PBE', 'LDA', 'PBE0', 'HSE06'
    encut : float
        ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]
    ismear : int
        ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°æ³•ï¼ˆ0: Gaussian, 1: Methfessel-Paxton, -5: tetrahedronï¼‰
    sigma : float
        ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°å¹… [eV]
    """

    incar_content = f"""SYSTEM = {system_name}

# Electronic structure
ENCUT = {encut}         # ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]
PREC = Accurate         # ç²¾åº¦ï¼ˆNormal, Accurate, Highï¼‰
LREAL = Auto            # å®Ÿç©ºé–“å°„å½±ï¼ˆAutoæ¨å¥¨ï¼‰

# Exchange-correlation
GGA = PE                # PBEæ±é–¢æ•°ï¼ˆLDAã®å ´åˆã¯å‰Šé™¤ï¼‰

# SCF convergence
EDIFF = 1E-6            # é›»å­çŠ¶æ…‹åæŸæ¡ä»¶ [eV]
NELM = 100              # æœ€å¤§SCF iteration

# Smearingï¼ˆé‡‘å±ãƒ»åŠå°ä½“ã§ç•°ãªã‚‹è¨­å®šï¼‰
ISMEAR = {ismear}       # ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°æ³•
SIGMA = {sigma}         # ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°å¹… [eV]

# Parallelization
NCORE = 4               # ã‚³ã‚¢ä¸¦åˆ—æ•°ï¼ˆã‚·ã‚¹ãƒ†ãƒ ä¾å­˜ï¼‰
"""

    # æ§‹é€ æœ€é©åŒ–ã®å ´åˆ
    if calculation_type == 'relax':
        incar_content += """
# Structure relaxation
IBRION = 2              # ã‚¤ã‚ªãƒ³ç·©å’Œã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆ2: CG, 1: RMM-DIISï¼‰
NSW = 100               # æœ€å¤§ã‚¤ã‚ªãƒ³ã‚¹ãƒ†ãƒƒãƒ—
ISIF = 3                # ã‚»ãƒ«ã¨ã‚¤ã‚ªãƒ³ä½ç½®ã‚’æœ€é©åŒ–
EDIFFG = -0.01          # åŠ›ã®åæŸæ¡ä»¶ [eV/Ã…]
"""

    # ãƒãƒ³ãƒ‰è¨ˆç®—ã®å ´åˆ
    elif calculation_type == 'band':
        incar_content += """
# Band structure calculation
ICHARG = 11             # é›»è·å¯†åº¦ã‚’èª­ã¿è¾¼ã¿
LORBIT = 11             # å°„å½±DOSè¨ˆç®—
"""

    return incar_content

# SCFè¨ˆç®—ç”¨INCARã‚’ç”Ÿæˆ
incar_scf = create_incar(calculation_type='scf', system_name='Si bulk')
with open('INCAR', 'w') as f:
    f.write(incar_scf)

print("INCAR ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ:")
print(incar_scf)
</code></pre>

        <h3>KPOINTSãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ</h3>

        <pre><code class="language-python">
# KPOINTSãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ

def create_kpoints(kpts=(8, 8, 8), shift=(0, 0, 0), mode='Monkhorst-Pack'):
    """
    VASP KPOINTSãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ

    Parameters:
    -----------
    kpts : tuple
        kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ (nx, ny, nz)
    shift : tuple
        ãƒ¡ãƒƒã‚·ãƒ¥ã®ã‚·ãƒ•ãƒˆï¼ˆé€šå¸¸ã¯(0,0,0)ï¼‰
    mode : str
        'Monkhorst-Pack' or 'Gamma'
    """

    kpoints_content = f"""Automatic mesh
0
{mode}
{kpts[0]} {kpts[1]} {kpts[2]}
{shift[0]} {shift[1]} {shift[2]}
"""
    return kpoints_content

# 8Ã—8Ã—8 Monkhorst-Pack ãƒ¡ãƒƒã‚·ãƒ¥
kpoints_dense = create_kpoints(kpts=(8, 8, 8))
with open('KPOINTS', 'w') as f:
    f.write(kpoints_dense)

print("KPOINTS ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸ:")
print(kpoints_dense)

# Gammaç‚¹ä¸­å¿ƒãƒ¡ãƒƒã‚·ãƒ¥ï¼ˆé‡‘å±ã«æ¨å¥¨ï¼‰
kpoints_gamma = create_kpoints(kpts=(12, 12, 12), mode='Gamma')
print("\nGammaç‚¹ä¸­å¿ƒãƒ¡ãƒƒã‚·ãƒ¥:")
print(kpoints_gamma)
</code></pre>

        <h3>Pymatgenã‚’ä½¿ã£ãŸå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ä¸€æ‹¬ç”Ÿæˆ</h3>

        <pre><code class="language-python">
from pymatgen.io.vasp.inputs import Incar, Kpoints, Poscar
from pymatgen.core import Structure
from pymatgen.io.vasp.sets import MPRelaxSet

# 1. Pymatgenã§Siæ§‹é€ ã‚’ä½œæˆ
si_struct = Structure.from_file('POSCAR')  # ã¾ãŸã¯ç›´æ¥ä½œæˆ

# 2. Materials Projectæ¨™æº–è¨­å®šã§å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ä¸€å¼ã‚’ç”Ÿæˆ
# ï¼ˆç ”ç©¶ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§åºƒãä½¿ã‚ã‚Œã‚‹æ¨™æº–è¨­å®šï¼‰
mp_set = MPRelaxSet(si_struct)

# 3. ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãå‡ºã—
mp_set.write_input('vasp_calc/')  # vasp_calc/ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å…¨ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ

print("VASPå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ä¸€å¼ã‚’ vasp_calc/ ã«ä½œæˆã—ã¾ã—ãŸ")
print("å«ã¾ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«: INCAR, POSCAR, KPOINTS, POTCARï¼ˆã‚³ãƒ”ãƒ¼å¿…è¦ï¼‰")

# 4. å€‹åˆ¥ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º
custom_incar = Incar({
    'SYSTEM': 'Si bulk',
    'ENCUT': 520,
    'ISMEAR': 0,
    'SIGMA': 0.05,
    'EDIFF': 1e-6,
    'PREC': 'Accurate'
})

custom_kpoints = Kpoints.gamma_automatic(kpts=(10, 10, 10))

# æ›¸ãå‡ºã—
custom_incar.write_file('vasp_calc/INCAR')
custom_kpoints.write_file('vasp_calc/KPOINTS')
</code></pre>

        <h2>kç‚¹ã¨ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åæŸãƒ†ã‚¹ãƒˆ</h2>

        <h3>åæŸãƒ†ã‚¹ãƒˆã®æˆ¦ç•¥</h3>

        <pre><code class="language-python">
import numpy as np
import matplotlib.pyplot as plt

# åæŸãƒ†ã‚¹ãƒˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
# ï¼ˆå®Ÿéš›ã®VASPè¨ˆç®—çµæœã‚’æ¨¡æ“¬ï¼‰

# 1. kç‚¹åæŸãƒ†ã‚¹ãƒˆ
k_values = np.array([2, 4, 6, 8, 10, 12, 14, 16])
# åæŸã™ã‚‹ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰
energy_k = -5.4 + 0.1 * np.exp(-k_values/4) + np.random.normal(0, 0.001, len(k_values))

# 2. ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸãƒ†ã‚¹ãƒˆ
encut_values = np.array([200, 250, 300, 350, 400, 450, 500, 550, 600])
# åæŸã™ã‚‹ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰
energy_encut = -5.4 - 0.05 * np.exp(-(encut_values-200)/100) + np.random.normal(0, 0.001, len(encut_values))

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# kç‚¹åæŸ
ax1.plot(k_values, energy_k, 'o-', markersize=8, linewidth=2, color='#f093fb')
ax1.axhline(y=energy_k[-1], color='red', linestyle='--', label='åæŸå€¤')
ax1.fill_between(k_values, energy_k[-1]-0.001, energy_k[-1]+0.001,
                  alpha=0.2, color='red', label='Â±1 meV ç¯„å›²')
ax1.set_xlabel('kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ (kÃ—kÃ—k)', fontsize=12)
ax1.set_ylabel('å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV/atom]', fontsize=12)
ax1.set_title('kç‚¹åæŸãƒ†ã‚¹ãƒˆ', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)

# ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸ
ax2.plot(encut_values, energy_encut, 's-', markersize=8, linewidth=2, color='#f5576c')
ax2.axhline(y=energy_encut[-1], color='red', linestyle='--', label='åæŸå€¤')
ax2.fill_between(encut_values, energy_encut[-1]-0.001, energy_encut[-1]+0.001,
                  alpha=0.2, color='red', label='Â±1 meV ç¯„å›²')
ax2.set_xlabel('ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]', fontsize=12)
ax2.set_ylabel('å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV/atom]', fontsize=12)
ax2.set_title('ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸãƒ†ã‚¹ãƒˆ', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('convergence_tests.png', dpi=300, bbox_inches='tight')
plt.show()

# åæŸåˆ¤å®š
print("=== åæŸãƒ†ã‚¹ãƒˆçµæœ ===")
print(f"\nkç‚¹åæŸ:")
for i in range(1, len(k_values)):
    diff = abs(energy_k[i] - energy_k[i-1]) * 1000  # meV
    status = "âœ“" if diff < 1.0 else "âœ—"
    print(f"  k={k_values[i]:2d}: Î”E = {diff:.3f} meV {status}")

print(f"\nã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸ:")
for i in range(1, len(encut_values)):
    diff = abs(energy_encut[i] - energy_encut[i-1]) * 1000  # meV
    status = "âœ“" if diff < 1.0 else "âœ—"
    print(f"  ENCUT={encut_values[i]:3d} eV: Î”E = {diff:.3f} meV {status}")
</code></pre>

        <h3>å®Ÿè·µçš„ãªåæŸãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>

        <pre><code class="language-python">
import os
import numpy as np
from ase.build import bulk
from ase.io import write

def run_convergence_test(structure, test_type='kpoints',
                          k_range=None, encut_range=None):
    """
    åæŸãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æº–å‚™

    Parameters:
    -----------
    structure : ase.Atoms
        ãƒ†ã‚¹ãƒˆã™ã‚‹çµæ™¶æ§‹é€ 
    test_type : str
        'kpoints' ã¾ãŸã¯ 'encut'
    k_range : list
        ãƒ†ã‚¹ãƒˆã™ã‚‹kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã®ãƒªã‚¹ãƒˆï¼ˆä¾‹ï¼š[4, 6, 8, 10, 12]ï¼‰
    encut_range : list
        ãƒ†ã‚¹ãƒˆã™ã‚‹ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ãƒªã‚¹ãƒˆ [eV]
    """

    if test_type == 'kpoints' and k_range is not None:
        print("=== kç‚¹åæŸãƒ†ã‚¹ãƒˆæº–å‚™ ===")
        for k in k_range:
            dirname = f'ktest_{k}x{k}x{k}'
            os.makedirs(dirname, exist_ok=True)

            # POSCARä½œæˆ
            write(f'{dirname}/POSCAR', structure, format='vasp')

            # KPOINTSä½œæˆ
            with open(f'{dirname}/KPOINTS', 'w') as f:
                f.write(f"""Automatic mesh
0
Monkhorst-Pack
{k} {k} {k}
0 0 0
""")

            # INCARä½œæˆï¼ˆå…±é€šè¨­å®šï¼‰
            with open(f'{dirname}/INCAR', 'w') as f:
                f.write("""SYSTEM = k-point convergence test
ENCUT = 400
ISMEAR = 0
SIGMA = 0.05
EDIFF = 1E-6
PREC = Accurate
""")

            print(f"  {dirname}/ ä½œæˆå®Œäº†")

    elif test_type == 'encut' and encut_range is not None:
        print("=== ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸãƒ†ã‚¹ãƒˆæº–å‚™ ===")
        for encut in encut_range:
            dirname = f'encut_{encut}'
            os.makedirs(dirname, exist_ok=True)

            write(f'{dirname}/POSCAR', structure, format='vasp')

            with open(f'{dirname}/KPOINTS', 'w') as f:
                f.write("""Automatic mesh
0
Monkhorst-Pack
8 8 8
0 0 0
""")

            with open(f'{dirname}/INCAR', 'w') as f:
                f.write(f"""SYSTEM = ENCUT convergence test
ENCUT = {encut}
ISMEAR = 0
SIGMA = 0.05
EDIFF = 1E-6
PREC = Accurate
""")

            print(f"  {dirname}/ ä½œæˆå®Œäº†")

# ä½¿ç”¨ä¾‹
si = bulk('Si', 'diamond', a=5.43)

# kç‚¹åæŸãƒ†ã‚¹ãƒˆç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
run_convergence_test(si, test_type='kpoints',
                      k_range=[4, 6, 8, 10, 12, 14])

# ã‚«ãƒƒãƒˆã‚ªãƒ•åæŸãƒ†ã‚¹ãƒˆç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
run_convergence_test(si, test_type='encut',
                      encut_range=[300, 350, 400, 450, 500, 550, 600])

print("\nå…¨ã¦ã®ãƒ†ã‚¹ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œæˆã—ã¾ã—ãŸ")
print("æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—: å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§VASPã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„")
</code></pre>

        <h2>DFTè¨ˆç®—ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h2>

        <div class="mermaid">
flowchart TD
    A[çµæ™¶æ§‹é€ æº–å‚™] --> B[å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ]
    B --> C{åæŸãƒ†ã‚¹ãƒˆ<br/>kç‚¹ãƒ»ENCUT}
    C -->|æœªåæŸ| B
    C -->|åæŸ| D[SCFè¨ˆç®—]
    D --> E[æ§‹é€ æœ€é©åŒ–]
    E --> F{æ§‹é€ å¤‰åŒ–<br/>å°ã•ã„?}
    F -->|No| E
    F -->|Yes| G[ç‰©æ€§è¨ˆç®—]
    G --> H[ãƒãƒ³ãƒ‰æ§‹é€ ]
    G --> I[çŠ¶æ…‹å¯†åº¦]
    G --> J[é›»è·å¯†åº¦]
    H --> K[çµæœè§£æ]
    I --> K
    J --> K
    K --> L[è«–æ–‡ãƒ»å ±å‘Š]

    style A fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style D fill:#d4edda,stroke:#28a745,stroke-width:2px
    style G fill:#fff3cd,stroke:#ffc107,stroke-width:2px
    style L fill:#d4edda,stroke:#28a745,stroke-width:2px
</div>

        <h3>æ¨™æº–çš„ãªDFTè¨ˆç®—æ‰‹é †</h3>

        <pre><code class="language-python">
# DFTè¨ˆç®—ã®æ¨™æº–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆæ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ï¼‰

def dft_workflow(material_name, structure):
    """
    æ¨™æº–çš„ãªDFTè¨ˆç®—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
    """

    print(f"=== {material_name} ã®DFTè¨ˆç®—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ ===\n")

    # Step 1: åæŸãƒ†ã‚¹ãƒˆ
    print("Step 1: åæŸãƒ†ã‚¹ãƒˆ")
    print("  1-1. kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥åæŸãƒ†ã‚¹ãƒˆ")
    print("       â†’ æœ€é©kç‚¹: 8Ã—8Ã—8 ã¨åˆ¤å®š")
    print("  1-2. ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸãƒ†ã‚¹ãƒˆ")
    print("       â†’ æœ€é©ENCUT: 450 eV ã¨åˆ¤å®š")

    # Step 2: æ§‹é€ æœ€é©åŒ–
    print("\nStep 2: æ§‹é€ æœ€é©åŒ–ï¼ˆIBRION=2, ISIF=3ï¼‰")
    print("  - åˆæœŸæ§‹é€ : å®Ÿé¨“å€¤")
    print("  - æœ€é©åŒ–å¾Œ:")
    print("    æ ¼å­å®šæ•°: 5.43 â†’ 5.47 Ã…ï¼ˆ+0.7%ã€PBEã®éå¤§è©•ä¾¡ï¼‰")
    print("    åŸå­ä½ç½®: å¤‰åŒ–ãªã—ï¼ˆé«˜å¯¾ç§°æ€§ï¼‰")

    # Step 3: é™çš„è¨ˆç®—ï¼ˆé«˜ç²¾åº¦ï¼‰
    print("\nStep 3: é™çš„è¨ˆç®—ï¼ˆä¸€ç‚¹è¨ˆç®—ã€NSW=0ï¼‰")
    print("  - æœ€é©åŒ–æ§‹é€ ã§é«˜ç²¾åº¦SCF")
    print("  - é›»è·å¯†åº¦ãƒ»æ³¢å‹•é–¢æ•°ã‚’ä¿å­˜")

    # Step 4: ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®—
    print("\nStep 4: ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®—ï¼ˆICHARG=11ï¼‰")
    print("  - é«˜å¯¾ç§°ç‚¹ãƒ‘ã‚¹: Î“-X-W-K-Î“-L")
    print("  - é–“æ¥ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: 0.65 eVï¼ˆå®Ÿé¨“å€¤1.12 eVã‚’éå°è©•ä¾¡ï¼‰")

    # Step 5: çŠ¶æ…‹å¯†åº¦è¨ˆç®—
    print("\nStep 5: çŠ¶æ…‹å¯†åº¦è¨ˆç®—ï¼ˆLORBIT=11ï¼‰")
    print("  - å¯†ãªkç‚¹ãƒ¡ãƒƒã‚·ãƒ¥: 16Ã—16Ã—16")
    print("  - å°„å½±DOSï¼ˆåŸå­ãƒ»è»Œé“åˆ†è§£ï¼‰")

    # Step 6: çµæœè§£æ
    print("\nStep 6: çµæœè§£æ")
    print("  - ãƒãƒ³ãƒ‰å›³ãƒ—ãƒ­ãƒƒãƒˆ")
    print("  - DOSãƒ—ãƒ­ãƒƒãƒˆ")
    print("  - å®Ÿé¨“å€¤ã¨ã®æ¯”è¼ƒ")

    return {
        'optimal_k': (8, 8, 8),
        'optimal_encut': 450,
        'lattice_constant': 5.47,
        'band_gap': 0.65
    }

# å®Ÿè¡Œä¾‹
si = bulk('Si', 'diamond', a=5.43)
results = dft_workflow('Silicon', si)

print(f"\n=== è¨ˆç®—çµæœã‚µãƒãƒª ===")
for key, value in results.items():
    print(f"  {key}: {value}")
</code></pre>

        <h2>ã¾ã¨ã‚</h2>

        <div class="success-box">
            <h3>ã“ã®ç« ã§å­¦ã‚“ã ã“ã¨</h3>
            <h4>ç†è«–çš„ç†è§£</h4>
            <ul>
                <li>DFTã¯å¤šä½“SchrÃ¶dingeræ–¹ç¨‹å¼ã‚’é›»å­å¯†åº¦ã§è§£ãç†è«–</li>
                <li>Hohenberg-Kohnå®šç†ï¼šé›»å­å¯†åº¦ãŒå…¨ã¦ã®ç‰©ç†é‡ã‚’æ±ºå®š</li>
                <li>Kohn-Shamæ–¹ç¨‹å¼ï¼šéç›¸äº’ä½œç”¨ç³»ã¸ã®å†™åƒã§è¨ˆç®—å¯èƒ½ã«</li>
                <li>äº¤æ›ç›¸é–¢æ±é–¢æ•°ï¼ˆLDA, GGA, hybridï¼‰ãŒå”¯ä¸€ã®è¿‘ä¼¼éƒ¨åˆ†</li>
            </ul>

            <h4>å®Ÿè·µçš„ã‚¹ã‚­ãƒ«</h4>
            <ul>
                <li>ASE/Pymatgenã§çµæ™¶æ§‹é€ ã‚’ä½œæˆãƒ»æ“ä½œã§ãã‚‹</li>
                <li>VASPå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆINCAR, POSCAR, KPOINTSï¼‰ã‚’ä½œæˆã§ãã‚‹</li>
                <li>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã¨ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åæŸãƒ†ã‚¹ãƒˆã‚’å®Ÿæ–½ã§ãã‚‹</li>
                <li>DFTè¨ˆç®—ã®æ¨™æº–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ç†è§£ã—ãŸ</li>
            </ul>

            <h4>æ¬¡ç« ã¸ã®æº–å‚™</h4>
            <ul>
                <li>ç¬¬4ç« ã§ã¯ã€DFTè¨ˆç®—çµæœã‹ã‚‰é›»æ°—çš„ãƒ»ç£æ°—çš„æ€§è³ªã‚’è¨ˆç®—ã—ã¾ã™</li>
                <li>é›»æ°—ä¼å°ã€HallåŠ¹æœã€ç£åŒ–ãªã©ã®å…·ä½“çš„ãªç‰©æ€§å€¤ã®è¨ˆç®—æ–¹æ³•ã‚’å­¦ã³ã¾ã™</li>
            </ul>
        </div>

        <h2>æ¼”ç¿’å•é¡Œ</h2>

        <div class="exercise-box">
            <h4>æ¼”ç¿’1ï¼šåŸºç¤ç†è«–ï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜†â˜†ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šä»¥ä¸‹ã®è¨˜è¿°ã®æ­£èª¤ã‚’åˆ¤å®šã—ã€èª¤ã‚ŠãŒã‚ã‚Œã°è¨‚æ­£ã—ã¦ãã ã•ã„ã€‚</p>
            <ol>
                <li>DFTã§ã¯ã€é›»å­å¯†åº¦$n(\mathbf{r})$ã¯3æ¬¡å…ƒé–¢æ•°ã§ã‚ã‚‹ãŸã‚ã€å¤šä½“æ³¢å‹•é–¢æ•°ã‚ˆã‚Šæ‰±ã„ã‚„ã™ã„ã€‚</li>
                <li>Kohn-Shamæ–¹ç¨‹å¼ã¯ã€ç›¸äº’ä½œç”¨ã™ã‚‹å¤šé›»å­ç³»ã‚’å³å¯†ã«è§£ãæ–¹ç¨‹å¼ã§ã‚ã‚‹ã€‚</li>
                <li>GGAæ±é–¢æ•°ã¯ã€å¯†åº¦å‹¾é…ã‚‚è€ƒæ…®ã™ã‚‹ãŸã‚ã€å¸¸ã«LDAã‚ˆã‚Šé«˜ç²¾åº¦ã§ã‚ã‚‹ã€‚</li>
                <li>PAWæ³•ã¯ã€ç–‘æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æ³•ã®ä¸€ç¨®ã§ã€å…¨é›»å­è¨ˆç®—ã«è¿‘ã„ç²¾åº¦ã‚’é”æˆã™ã‚‹ã€‚</li>
            </ol>

            <p><strong>è§£ç­”ã®ãƒã‚¤ãƒ³ãƒˆ</strong>ï¼š</p>
            <ol>
                <li>æ­£ã—ã„ã€‚$3N$æ¬¡å…ƒ â†’ 3æ¬¡å…ƒã¸ã®åŠ‡çš„ãªå‰Šæ¸›ã€‚</li>
                <li>èª¤ã‚Šã€‚Kohn-Shamæ–¹ç¨‹å¼ã¯ã€Œéç›¸äº’ä½œç”¨ç³»ã¸ã®å†™åƒã€ã€‚äº¤æ›ç›¸é–¢æ±é–¢æ•°$E_{\text{xc}}$ãŒè¿‘ä¼¼ã€‚</li>
                <li>èª¤ã‚Šã€‚å¤šãã®å ´åˆGGAãŒå„ªã‚Œã‚‹ãŒã€å¯†åº¦ãŒä¸€æ§˜ã«è¿‘ã„ç³»ï¼ˆå˜ç´”é‡‘å±ï¼‰ã§ã¯LDAã‚‚è‰¯ã„ã€‚</li>
                <li>æ­£ã—ã„ã€‚PAWã¯å…¨é›»å­æ³¢å‹•é–¢æ•°ã‚’å¾©å…ƒã™ã‚‹å¤‰æ›ã‚’æŒã¤ã€‚</li>
            </ol>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2ï¼šæ±é–¢æ•°ã®é¸æŠï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜†ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šä»¥ä¸‹ã®ç³»ã«å¯¾ã—ã¦æœ€é©ãªäº¤æ›ç›¸é–¢æ±é–¢æ•°ã‚’é¸ã³ã€ç†ç”±ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>
            <ol>
                <li>Siãƒãƒ«ã‚¯ï¼ˆåŠå°ä½“ï¼‰ã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—è¨ˆç®—</li>
                <li>Cué‡‘å±ã®æ ¼å­å®šæ•°æœ€é©åŒ–</li>
                <li>TiOâ‚‚ï¼ˆé…¸åŒ–ãƒã‚¿ãƒ³ï¼‰ã®é›»å­çŠ¶æ…‹è¨ˆç®—</li>
                <li>æœ‰æ©Ÿåˆ†å­ã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—</li>
            </ol>

            <p><strong>æ¨å¥¨è§£ç­”</strong>ï¼š</p>
            <ol>
                <li>HSE06ï¼ˆhybridï¼‰ï¼šGGAã§ã¯ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’ç´„50%éå°è©•ä¾¡ã™ã‚‹ãŸã‚ã€‚</li>
                <li>PBEï¼ˆGGAï¼‰ï¼šé‡‘å±ã¯é›»å­å¯†åº¦ãŒæ»‘ã‚‰ã‹ã§ã€GGAã§ååˆ†é«˜ç²¾åº¦ã€‚è¨ˆç®—ã‚³ã‚¹ãƒˆã‚‚ä½ã„ã€‚</li>
                <li>PBE+U ã¾ãŸã¯ HSE06ï¼šTiã®dè»Œé“ã®å¼·ç›¸é–¢åŠ¹æœã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚</li>
                <li>B3LYPï¼ˆhybridï¼‰ï¼šåˆ†å­ç³»ã§åºƒãæ¤œè¨¼ã•ã‚Œã¦ã„ã‚‹ã€‚ãŸã ã—PBEã‚‚å¯ã€‚</li>
            </ol>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’3ï¼šPythonã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜†ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šä»¥ä¸‹ã®çµæ™¶æ§‹é€ ã‚’ASEã§ä½œæˆã—ã€POSCARå½¢å¼ã§ä¿å­˜ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚</p>
            <ol>
                <li>GaNï¼ˆã‚¦ãƒ«ãƒ„é‰±æ§‹é€ ã€a=3.19 Ã…, c=5.19 Ã…ï¼‰</li>
                <li>Feï¼ˆBCCæ§‹é€ ã€a=2.87 Ã…ï¼‰</li>
                <li>Alâ‚‚Oâ‚ƒï¼ˆã‚³ãƒ©ãƒ³ãƒ€ãƒ æ§‹é€ ã€Materials Projectã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼‰</li>
            </ol>

            <p><strong>ãƒ’ãƒ³ãƒˆ</strong>ï¼š</p>
            <ul>
                <li>GaNã¯ã‚¦ãƒ«ãƒ„é‰±æ§‹é€ ï¼ˆwurtziteï¼‰</li>
                <li>Feã¯BCCï¼ˆbody-centered cubicï¼‰</li>
                <li>Materials Projectã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã«ã¯<code>pymatgen.ext.matproj</code>ã‚’ä½¿ç”¨</li>
            </ul>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’4ï¼šåæŸãƒ†ã‚¹ãƒˆã®è§£æï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜†ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šä»¥ä¸‹ã®kç‚¹åæŸãƒ†ã‚¹ãƒˆçµæœã‚’è§£æã—ã€æœ€é©ãªkç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã‚’æ¨å¥¨ã—ã¦ãã ã•ã„ã€‚</p>

            <table>
                <thead>
                    <tr>
                        <th>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥</th>
                        <th>å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV/atom]</th>
                        <th>è¨ˆç®—æ™‚é–“ [åˆ†]</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>4Ã—4Ã—4</td><td>-5.3421</td><td>2</td></tr>
                    <tr><td>6Ã—6Ã—6</td><td>-5.3998</td><td>5</td></tr>
                    <tr><td>8Ã—8Ã—8</td><td>-5.4125</td><td>12</td></tr>
                    <tr><td>10Ã—10Ã—10</td><td>-5.4138</td><td>25</td></tr>
                    <tr><td>12Ã—12Ã—12</td><td>-5.4141</td><td>45</td></tr>
                    <tr><td>14Ã—14Ã—14</td><td>-5.4142</td><td>75</td></tr>
                </tbody>
            </table>

            <p><strong>è€ƒå¯Ÿãƒã‚¤ãƒ³ãƒˆ</strong>ï¼š</p>
            <ul>
                <li>1 meV/atomï¼ˆ0.001 eV/atomï¼‰ã‚’åæŸåŸºæº–ã¨ã™ã‚‹</li>
                <li>è¨ˆç®—ã‚³ã‚¹ãƒˆã¨ç²¾åº¦ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®</li>
                <li>é‡‘å±ã‹åŠå°ä½“ã‹ã§åˆ¤æ–­ãŒå¤‰ã‚ã‚‹</li>
            </ul>

            <p><strong>æ¨å¥¨è§£ç­”</strong>ï¼š</p>
            <p>8Ã—8Ã—8 ã€œ 10Ã—10Ã—10 ã‚’æ¨å¥¨ã€‚ç†ç”±ï¼š</p>
            <ul>
                <li>8Ã—8Ã—8: 6Ã—6Ã—6ã‹ã‚‰1.27 meV/atomæ”¹å–„ï¼ˆåæŸã«è¿‘ã„ï¼‰</li>
                <li>10Ã—10Ã—10: 8Ã—8Ã—8ã‹ã‚‰0.13 meV/atomæ”¹å–„ï¼ˆã»ã¼åæŸï¼‰</li>
                <li>12Ã—12Ã—12ä»¥ä¸Š: è¨ˆç®—ã‚³ã‚¹ãƒˆã«è¦‹åˆã†æ”¹å–„ãªã—</li>
                <li>åŠå°ä½“ãªã‚‰8Ã—8Ã—8ã€é‡‘å±ãªã‚‰10Ã—10Ã—10ã‚’æ¨å¥¨</li>
            </ul>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’5ï¼šINCARè¨­å®šã®æœ€é©åŒ–ï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜…ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šä»¥ä¸‹ã®è¨ˆç®—ç›®çš„ã«å¯¾ã—ã¦ã€æœ€é©ãªINCARãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚</p>
            <ol>
                <li>é‡‘å±Alã®æ ¼å­å®šæ•°æœ€é©åŒ–</li>
                <li>åŠå°ä½“GaAsã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—è¨ˆç®—ï¼ˆHSE06ï¼‰</li>
                <li>ç£æ€§ä½“Feã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆè¨ˆç®—</li>
            </ol>

            <p><strong>æ¨å¥¨è§£ç­”</strong>ï¼š</p>

            <p>1. é‡‘å±Alã®æ ¼å­å®šæ•°æœ€é©åŒ–:</p>
            <pre><code>
SYSTEM = Al lattice optimization
ENCUT = 400
PREC = Accurate
GGA = PE
ISMEAR = 1          # Methfessel-Paxtonï¼ˆé‡‘å±ã«æœ€é©ï¼‰
SIGMA = 0.2         # ã‚„ã‚„å¤§ãã‚ã®ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°
IBRION = 2          # CGæ³•
ISIF = 3            # ã‚»ãƒ«å½¢çŠ¶ã‚‚æœ€é©åŒ–
EDIFF = 1E-6
EDIFFG = -0.01
NSW = 50
</code></pre>

            <p>2. åŠå°ä½“GaAsã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—è¨ˆç®—ï¼ˆHSE06ï¼‰:</p>
            <pre><code>
SYSTEM = GaAs band gap (HSE06)
ENCUT = 450
PREC = Accurate
LHFCALC = .TRUE.    # Hybridæ±é–¢æ•°æœ‰åŠ¹åŒ–
HFSCREEN = 0.2      # HSE06ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
ISMEAR = 0          # Gaussianï¼ˆåŠå°ä½“ï¼‰
SIGMA = 0.05        # å°ã•ã‚ã®ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°
EDIFF = 1E-7        # é«˜ç²¾åº¦åæŸ
ALGO = Damped       # HSE06ã«æ¨å¥¨
TIME = 0.4
</code></pre>

            <p>3. ç£æ€§ä½“Feã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆè¨ˆç®—:</p>
            <pre><code>
SYSTEM = Fe magnetic moment
ENCUT = 400
PREC = Accurate
GGA = PE
ISMEAR = 1
SIGMA = 0.2
ISPIN = 2           # ã‚¹ãƒ”ãƒ³åˆ†æ¥µè¨ˆç®—
MAGMOM = 2.0        # åˆæœŸç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼ˆFe: ç´„2.2 Î¼Bï¼‰
LORBIT = 11         # ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆå°„å½±
EDIFF = 1E-6
</code></pre>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’6ï¼šå®Ÿè·µèª²é¡Œï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜…ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šä»¥ä¸‹ã®æ‰‹é †ã§ã€å®Ÿéš›ã«DFTè¨ˆç®—ã®æº–å‚™ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚</p>
            <ol>
                <li>ASEã‚’ä½¿ã£ã¦ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ã®Siçµæ™¶ï¼ˆ2Ã—2Ã—2ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ï¼‰ã‚’ä½œæˆ</li>
                <li>VASPå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆINCAR, POSCAR, KPOINTSï¼‰ã‚’ç”Ÿæˆ</li>
                <li>kç‚¹åæŸãƒ†ã‚¹ãƒˆç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ï¼ˆk=4,6,8,10,12ï¼‰ã‚’ä½œæˆ</li>
                <li>å„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã€è¨ˆç®—æº–å‚™ãŒæ•´ã£ã¦ã„ã‚‹ã‹æ¤œè¨¼</li>
            </ol>

            <p><strong>è©•ä¾¡åŸºæº–</strong>ï¼š</p>
            <ul>
                <li>POSCARãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ã—ã„VASPå½¢å¼ã§ã‚ã‚‹ã‹</li>
                <li>INCARã®è¨­å®šãŒåŠå°ä½“Siã«é©ã—ã¦ã„ã‚‹ã‹ï¼ˆISMEAR=0ãªã©ï¼‰</li>
                <li>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ãŒå„ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§æ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹</li>
                <li>ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ãŒæ•´ç†ã•ã‚Œã€è¿½è·¡å¯èƒ½ã‹</li>
            </ul>
        </div>

        <h2>å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Hohenberg, P., & Kohn, W. (1964). "Inhomogeneous Electron Gas". Physical Review, 136(3B), B864.</li>
            <li>Kohn, W., & Sham, L. J. (1965). "Self-Consistent Equations Including Exchange and Correlation Effects". Physical Review, 140(4A), A1133.</li>
            <li>Perdew, J. P., Burke, K., & Ernzerhof, M. (1996). "Generalized Gradient Approximation Made Simple". Physical Review Letters, 77, 3865.</li>
            <li>BlÃ¶chl, P. E. (1994). "Projector augmented-wave method". Physical Review B, 50, 17953.</li>
            <li>Sholl, D., & Steckel, J. A. (2011). "Density Functional Theory: A Practical Introduction". Wiley.</li>
            <li>ASE documentation: https://wiki.fysik.dtu.dk/ase/</li>
            <li>Pymatgen documentation: https://pymatgen.org/</li>
            <li>VASP manual: https://www.vasp.at/wiki/index.php/The_VASP_Manual</li>
        </ol>

        <div class="navigation">
            <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« ï¼šçµæ™¶å ´ç†è«–</a>
            <a href="chapter-4.html" class="nav-button">ç¬¬4ç« ï¼šé›»æ°—çš„ãƒ»ç£æ°—çš„æ€§è³ª â†’</a>
        </div>
    </main>

    <footer>
        <p><strong>Materials Properties Introduction Series - Chapter 3</strong></p>
        <p>Density Functional Theory (DFT) Basics for Materials Science</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
