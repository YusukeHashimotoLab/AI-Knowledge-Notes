<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« :Xç·šå›æŠ˜ã®åŸºç¤ - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(240, 147, 251, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .breadcrumb {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .breadcrumb a {
            color: var(--color-link);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.6rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .navigation {
                flex-direction: column;
            }

            pre {
                font-size: 0.85rem;
            }
        }
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'neutral' });
    </script>
</head>
<body>
        <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/MS/xrd-analysis-introduction/index.html">Xrd Analysis</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

    <header>
        <div class="header-content">
            <h1>ç¬¬1ç« : Xç·šå›æŠ˜ã®åŸºç¤</h1>
            <p class="subtitle">Braggã®æ³•å‰‡ã‹ã‚‰æ§‹é€ å› å­ã¾ã§ - çµæ™¶æ§‹é€ è§£æã®ç†è«–çš„åŸºç›¤</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta-item">ğŸ¯ é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="learning-objectives">
            <h2>å­¦ç¿’ç›®æ¨™</h2>
            <p>ã“ã®ç« ã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™:</p>
            <ul>
                <li>Braggã®æ³•å‰‡ã‚’ç†è§£ã—ã€å›æŠ˜æ¡ä»¶ã‚’æ•°å¼ã¨Pythonã§è¨ˆç®—ã§ãã‚‹</li>
                <li>çµæ™¶æ ¼å­ã¨é€†æ ¼å­ã®é–¢ä¿‚ã‚’å¯è¦–åŒ–ã—ã€èª¬æ˜ã§ãã‚‹</li>
                <li>æ¶ˆæ»…å‰‡ã‹ã‚‰çµæ™¶ã®å¯¾ç§°æ€§ã‚’æ¨å®šã§ãã‚‹</li>
                <li>æ§‹é€ å› å­ã®è¨ˆç®—ã‚’å®Ÿè£…ã—ã€å›æŠ˜å¼·åº¦ã‚’äºˆæ¸¬ã§ãã‚‹</li>
                <li>Ewaldçƒã‚’ç”¨ã„ã¦å›æŠ˜æ¡ä»¶ã‚’å¯è¦–åŒ–ã§ãã‚‹</li>
            </ul>
        </div>

        <h2>1.1 Braggã®æ³•å‰‡ã¨å›æŠ˜æ¡ä»¶</h2>

        <p>Xç·šå›æŠ˜(XRD)ã¯ã€çµæ™¶æ§‹é€ è§£æã®æœ€ã‚‚åŸºæœ¬çš„ãªæ‰‹æ³•ã§ã™ã€‚Xç·šãŒçµæ™¶ä¸­ã®åŸå­é…åˆ—ã¨ç›¸äº’ä½œç”¨ã—ã€ç‰¹å®šã®è§’åº¦ã§å›æŠ˜ãŒèµ·ã“ã‚‹ã“ã¨ã§ã€çµæ™¶æ§‹é€ ã«é–¢ã™ã‚‹æƒ…å ±ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>

        <h3>1.1.1 Braggã®æ³•å‰‡ã®å°å‡º</h3>

        <p>Braggã®æ³•å‰‡ã¯ã€1912å¹´ã«William Lawrence Braggã¨William Henry Braggã«ã‚ˆã£ã¦ç™ºè¦‹ã•ã‚Œã¾ã—ãŸã€‚çµæ™¶ã‚’åŸå­é¢ã®é›†åˆã¨è€ƒãˆã‚‹ã¨ã€éš£æ¥ã™ã‚‹åŸå­é¢ã‹ã‚‰ã®åå°„Xç·šã®å…‰è·¯å·®ãŒæ³¢é•·ã®æ•´æ•°å€ã«ãªã‚‹ã¨ã€å»ºè¨­çš„å¹²æ¸‰ãŒèµ·ã“ã‚Šã¾ã™ã€‚</p>

        <p>é¢é–“éš”\( d \)ã‚’æŒã¤çµæ™¶é¢ã«ã€æ³¢é•·\( \lambda \)ã®Xç·šãŒå…¥å°„è§’\( \theta \)ã§å…¥å°„ã™ã‚‹å ´åˆã€å›æŠ˜æ¡ä»¶ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™:</p>

        <p style="text-align: center; font-size: 1.2em; margin: 1.5em 0;">
            \[ 2d\sin\theta = n\lambda \]
        </p>

        <p>ã“ã“ã§ã€\( n \)ã¯å›æŠ˜æ¬¡æ•°(æ•´æ•°)ã€\( d \)ã¯é¢é–“éš”ã€\( \theta \)ã¯å…¥å°„è§’(Braggè§’)ã€\( \lambda \)ã¯Xç·šã®æ³¢é•·ã§ã™ã€‚</p>

        <div class="mermaid">
graph LR
    A[Xç·šå…¥å°„<br/>Î» = 1.54 Ã…] --> B[çµæ™¶é¢<br/>d = 3.5 Ã…]
    B --> C{Braggæ¡ä»¶<br/>2dsinÎ¸ = nÎ»}
    C -->|æº€ãŸã™| D[å›æŠ˜ãƒ”ãƒ¼ã‚¯<br/>è¦³æ¸¬ã•ã‚Œã‚‹]
    C -->|æº€ãŸã•ãªã„| E[å›æŠ˜ãªã—<br/>è¦³æ¸¬ã•ã‚Œãªã„]
    style C fill:#fce7f3
    style D fill:#e8f5e9
    style E fill:#ffebee
        </div>

        <h3>1.1.2 Pythonã«ã‚ˆã‚‹è¨ˆç®—å®Ÿè£…</h3>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def bragg_law(d, wavelength, n=1):
    """Braggã®æ³•å‰‡ã‚’ç”¨ã„ã¦å›æŠ˜è§’ã‚’è¨ˆç®—

    Args:
        d (float): é¢é–“éš” [Ã…]
        wavelength (float): Xç·šæ³¢é•· [Ã…]
        n (int): å›æŠ˜æ¬¡æ•°

    Returns:
        float: Braggè§’ [åº¦]ã€ã¾ãŸã¯å›æŠ˜ä¸å¯èƒ½ãªå ´åˆNone
    """
    # 2d*sin(theta) = n*lambda
    # sin(theta) = n*lambda / (2*d)
    sin_theta = (n * wavelength) / (2 * d)

    # ç‰©ç†çš„ã«æœ‰åŠ¹ãªè§£ã®ç¢ºèª
    if sin_theta > 1.0:
        return None  # å›æŠ˜ä¸å¯èƒ½

    theta_rad = np.arcsin(sin_theta)
    theta_deg = np.degrees(theta_rad)

    return theta_deg


# ä¾‹: Cu KÎ±ç·šï¼ˆ1.54 Ã…ï¼‰ã‚’ç”¨ã„ãŸè¨ˆç®—
wavelength_CuKa = 1.54056  # Ã…

# ç•°ãªã‚‹é¢é–“éš”ã§ã®å›æŠ˜è§’è¨ˆç®—
d_spacings = [4.0, 3.5, 3.0, 2.5, 2.0, 1.5]  # Ã…

print("é¢é–“éš” [Ã…] | Braggè§’ [åº¦] (n=1) | Braggè§’ [åº¦] (n=2)")
print("-" * 60)
for d in d_spacings:
    theta_n1 = bragg_law(d, wavelength_CuKa, n=1)
    theta_n2 = bragg_law(d, wavelength_CuKa, n=2)

    if theta_n1 is not None:
        print(f"{d:6.2f}      | {theta_n1:15.2f}    | ", end="")
        if theta_n2 is not None:
            print(f"{theta_n2:15.2f}")
        else:
            print("   å›æŠ˜ä¸å¯èƒ½")
    else:
        print(f"{d:6.2f}      |    å›æŠ˜ä¸å¯èƒ½    |    å›æŠ˜ä¸å¯èƒ½")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# é¢é–“éš” [Ã…] | Braggè§’ [åº¦] (n=1) | Braggè§’ [åº¦] (n=2)
# ------------------------------------------------------------
#   4.00      |           11.10    |            22.48
#   3.50      |           12.69    |            25.77
#   3.00      |           14.83    |            30.36
#   2.50      |           17.93    |            37.32
#   2.00      |           22.58    |            48.92
#   1.50      |           30.96    |            75.55</code></pre>

        <h3>1.1.3 å›æŠ˜è§’ã®å¯è¦–åŒ–</h3>

        <pre><code class="language-python">def plot_bragg_angles(wavelength, d_range=(1.0, 5.0), n_max=3):
    """Braggè§’ã®é¢é–“éš”ä¾å­˜æ€§ã‚’ãƒ—ãƒ­ãƒƒãƒˆ

    Args:
        wavelength (float): Xç·šæ³¢é•· [Ã…]
        d_range (tuple): é¢é–“éš”ã®ç¯„å›² [Ã…]
        n_max (int): æœ€å¤§å›æŠ˜æ¬¡æ•°
    """
    d_values = np.linspace(d_range[0], d_range[1], 200)

    plt.figure(figsize=(10, 6))
    colors = ['#f093fb', '#f5576c', '#3498db']

    for n in range(1, n_max + 1):
        theta_values = []
        valid_d_values = []

        for d in d_values:
            theta = bragg_law(d, wavelength, n)
            if theta is not None:
                theta_values.append(theta)
                valid_d_values.append(d)

        if theta_values:
            plt.plot(valid_d_values, theta_values,
                    label=f'n = {n}', linewidth=2, color=colors[n-1])

    plt.xlabel('é¢é–“éš” d [Ã…]', fontsize=12)
    plt.ylabel('Braggè§’ Î¸ [åº¦]', fontsize=12)
    plt.title(f'Braggã®æ³•å‰‡: å›æŠ˜è§’ã¨é¢é–“éš”ã®é–¢ä¿‚ (Î» = {wavelength:.2f} Ã…)', fontsize=14)
    plt.grid(True, alpha=0.3)
    plt.legend(fontsize=11)
    plt.xlim(d_range)
    plt.ylim(0, 90)
    plt.tight_layout()
    plt.show()

# Cu KÎ±ç·šã®å ´åˆ
plot_bragg_angles(1.54056, d_range=(1.0, 5.0), n_max=3)</code></pre>

        <h2>1.2 çµæ™¶æ ¼å­ã¨é€†æ ¼å­</h2>

        <h3>1.2.1 çµæ™¶æ ¼å­ã®åŸºæœ¬</h3>

        <p>çµæ™¶ã¯ã€åŸºæœ¬å˜ä½(å˜ä½æ ¼å­)ãŒ3æ¬¡å…ƒç©ºé–“ã«å‘¨æœŸçš„ã«é…åˆ—ã—ãŸæ§‹é€ ã§ã™ã€‚å˜ä½æ ¼å­ã¯3ã¤ã®åŸºæœ¬ãƒ™ã‚¯ãƒˆãƒ« \( \mathbf{a}, \mathbf{b}, \mathbf{c} \) ã§å®šç¾©ã•ã‚Œã¾ã™ã€‚</p>

        <p>ä»»æ„ã®æ ¼å­ç‚¹ã®ä½ç½®ãƒ™ã‚¯ãƒˆãƒ«\( \mathbf{R} \)ã¯ä»¥ä¸‹ã§è¡¨ã•ã‚Œã¾ã™:</p>

        <p style="text-align: center; font-size: 1.1em; margin: 1.5em 0;">
            \[ \mathbf{R} = u\mathbf{a} + v\mathbf{b} + w\mathbf{c} \]
        </p>

        <p>ã“ã“ã§ã€\( u, v, w \)ã¯æ•´æ•°ã§ã™ã€‚</p>

        <h3>1.2.2 é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«</h3>

        <p>é€†æ ¼å­ã¯ã€çµæ™¶ã®å›æŠ˜ç¾è±¡ã‚’ç†è§£ã™ã‚‹ä¸Šã§æ¥µã‚ã¦é‡è¦ãªæ¦‚å¿µã§ã™ã€‚é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«\( \mathbf{a}^*, \mathbf{b}^*, \mathbf{c}^* \)ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™:</p>

        <p style="text-align: center; font-size: 1.05em; margin: 1.5em 0;">
            \[
            \mathbf{a}^* = \frac{\mathbf{b} \times \mathbf{c}}{V}, \quad
            \mathbf{b}^* = \frac{\mathbf{c} \times \mathbf{a}}{V}, \quad
            \mathbf{c}^* = \frac{\mathbf{a} \times \mathbf{b}}{V}
            \]
        </p>

        <p>ã“ã“ã§ã€\( V = \mathbf{a} \cdot (\mathbf{b} \times \mathbf{c}) \)ã¯å˜ä½æ ¼å­ã®ä½“ç©ã§ã™ã€‚</p>

        <pre><code class="language-python">import numpy as np

def reciprocal_lattice_vectors(a, b, c):
    """å®Ÿæ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—

    Args:
        a, b, c (np.ndarray): å®Ÿæ ¼å­åŸºæœ¬ãƒ™ã‚¯ãƒˆãƒ« [Ã…]

    Returns:
        tuple: (a*, b*, c*) é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ« [Ã…^-1]
    """
    # å˜ä½æ ¼å­ä½“ç©
    V = np.dot(a, np.cross(b, c))

    # é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«
    a_star = np.cross(b, c) / V
    b_star = np.cross(c, a) / V
    c_star = np.cross(a, b) / V

    return a_star, b_star, c_star


def d_spacing_from_hkl(h, k, l, a_star, b_star, c_star):
    """MilleræŒ‡æ•°ã‹ã‚‰é¢é–“éš”ã‚’è¨ˆç®—

    Args:
        h, k, l (int): MilleræŒ‡æ•°
        a_star, b_star, c_star (np.ndarray): é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ« [Ã…^-1]

    Returns:
        float: é¢é–“éš” d [Ã…]
    """
    # é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ« G = h*a* + k*b* + l*c*
    G = h * a_star + k * b_star + l * c_star

    # é¢é–“éš” d = 1 / |G|
    d = 1.0 / np.linalg.norm(G)

    return d


# ä¾‹: ç«‹æ–¹æ™¶ç³» (a = b = c = 4.0 Ã…, 90åº¦è§’)
a = np.array([4.0, 0.0, 0.0])
b = np.array([0.0, 4.0, 0.0])
c = np.array([0.0, 0.0, 4.0])

a_star, b_star, c_star = reciprocal_lattice_vectors(a, b, c)

print("å®Ÿæ ¼å­ãƒ™ã‚¯ãƒˆãƒ«:")
print(f"a = {a}")
print(f"b = {b}")
print(f"c = {c}\n")

print("é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«:")
print(f"a* = {a_star} [Ã…^-1]")
print(f"b* = {b_star} [Ã…^-1]")
print(f"c* = {c_star} [Ã…^-1]\n")

# æ§˜ã€…ãªMilleræŒ‡æ•°ã®é¢é–“éš”è¨ˆç®—
miller_indices = [(1, 0, 0), (1, 1, 0), (1, 1, 1), (2, 0, 0), (2, 2, 0)]

print("MilleræŒ‡æ•° | é¢é–“éš” d [Ã…]")
print("-" * 30)
for h, k, l in miller_indices:
    d = d_spacing_from_hkl(h, k, l, a_star, b_star, c_star)
    print(f" ({h} {k} {l})      | {d:12.4f}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›(ç«‹æ–¹æ™¶):
# (1 0 0)      |       4.0000
# (1 1 0)      |       2.8284
# (1 1 1)      |       2.3094
# (2 0 0)      |       2.0000
# (2 2 0)      |       1.4142</code></pre>

        <h2>1.3 æ¶ˆæ»…å‰‡ã¨å¯¾ç§°æ€§</h2>

        <h3>1.3.1 ç³»çµ±çš„æ¶ˆæ»…å‰‡</h3>

        <p>çµæ™¶ã®å¯¾ç§°æ€§(ç©ºé–“ç¾¤)ã«ã‚ˆã‚Šã€ç‰¹å®šã®MilleræŒ‡æ•°ã‚’æŒã¤åå°„ãŒæ¶ˆæ»…ã™ã‚‹ç¾è±¡ã‚’ç³»çµ±çš„æ¶ˆæ»…å‰‡ã¨å‘¼ã³ã¾ã™ã€‚ã“ã‚Œã¯ã€å˜ä½æ ¼å­å†…ã®åŸå­é…ç½®ã®å¯¾ç§°æ€§ã‚’åæ˜ ã—ã¦ã„ã¾ã™ã€‚</p>

        <p><strong>ä»£è¡¨çš„ãªæ¶ˆæ»…å‰‡:</strong></p>

        <table>
            <thead>
                <tr>
                    <th>æ ¼å­å‹</th>
                    <th>æ¶ˆæ»…å‰‡</th>
                    <th>ä¾‹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ä½“å¿ƒç«‹æ–¹(BCC)</td>
                    <td>\( h + k + l = å¥‡æ•° \) ã®åå°„ã¯æ¶ˆæ»…</td>
                    <td>(1,0,0), (1,1,0) ã¯æ¶ˆæ»…</td>
                </tr>
                <tr>
                    <td>é¢å¿ƒç«‹æ–¹(FCC)</td>
                    <td>\( h, k, l \) ãŒæ··åˆ(å¶å¥‡æ··åœ¨)ã®åå°„ã¯æ¶ˆæ»…</td>
                    <td>(1,0,0), (1,1,0) ã¯æ¶ˆæ»…</td>
                </tr>
                <tr>
                    <td>åº•å¿ƒæ–œæ–¹æ™¶(C)</td>
                    <td>\( h + k = å¥‡æ•° \) ã®åå°„ã¯æ¶ˆæ»…</td>
                    <td>(1,0,0), (0,1,0) ã¯æ¶ˆæ»…</td>
                </tr>
            </tbody>
        </table>

        <h3>1.3.2 æ¶ˆæ»…å‰‡ã®å®Ÿè£…</h3>

        <pre><code class="language-python">def systematic_absences(h, k, l, lattice_type):
    """ç³»çµ±çš„æ¶ˆæ»…å‰‡ã‚’åˆ¤å®š

    Args:
        h, k, l (int): MilleræŒ‡æ•°
        lattice_type (str): æ ¼å­å‹ ('P', 'I', 'F', 'C', 'A', 'B')

    Returns:
        bool: True = åå°„è¦³æ¸¬ã•ã‚Œã‚‹, False = æ¶ˆæ»…
    """
    if lattice_type == 'P':  # å˜ç´”æ ¼å­
        return True

    elif lattice_type == 'I':  # ä½“å¿ƒæ ¼å­
        return (h + k + l) % 2 == 0

    elif lattice_type == 'F':  # é¢å¿ƒæ ¼å­
        # h, k, l ãŒå…¨ã¦å¶æ•°ã¾ãŸã¯å…¨ã¦å¥‡æ•°
        parity = [h % 2, k % 2, l % 2]
        return len(set(parity)) == 1

    elif lattice_type == 'C':  # Cåº•å¿ƒ
        return (h + k) % 2 == 0

    elif lattice_type == 'A':  # Aåº•å¿ƒ
        return (k + l) % 2 == 0

    elif lattice_type == 'B':  # Båº•å¿ƒ
        return (h + l) % 2 == 0

    else:
        raise ValueError(f"Unknown lattice type: {lattice_type}")


# ãƒ†ã‚¹ãƒˆ: æ§˜ã€…ãªæ ¼å­å‹ã§ã®æ¶ˆæ»…å‰‡ç¢ºèª
lattice_types = ['P', 'I', 'F', 'C']
miller_list = [(1,0,0), (1,1,0), (1,1,1), (2,0,0), (2,2,0), (2,2,2)]

print("MilleræŒ‡æ•° | P (å˜ç´”) | I (ä½“å¿ƒ) | F (é¢å¿ƒ) | C (åº•å¿ƒ)")
print("-" * 65)

for hkl in miller_list:
    h, k, l = hkl
    results = [systematic_absences(h, k, l, lt) for lt in lattice_types]
    status = [' âœ“' if r else ' -' for r in results]
    print(f" ({h} {k} {l})     | {status[0]}      | {status[1]}      | {status[2]}      | {status[3]}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
#  (1 0 0)     |  âœ“      |  -      |  -      |  -
#  (1 1 0)     |  âœ“      |  âœ“      |  -      |  -
#  (1 1 1)     |  âœ“      |  -      |  âœ“      |  âœ“
#  (2 0 0)     |  âœ“      |  âœ“      |  âœ“      |  âœ“
#  (2 2 0)     |  âœ“      |  âœ“      |  âœ“      |  âœ“
#  (2 2 2)     |  âœ“      |  âœ“      |  âœ“      |  âœ“</code></pre>

        <h2>1.4 æ§‹é€ å› å­</h2>

        <h3>1.4.1 æ§‹é€ å› å­ã®å®šç¾©</h3>

        <p>æ§‹é€ å› å­\( F_{hkl} \)ã¯ã€ç‰¹å®šã®MilleræŒ‡æ•°\( (h, k, l) \)ã®å›æŠ˜å¼·åº¦ã‚’æ±ºå®šã™ã‚‹è¤‡ç´ æ•°ã§ã™ã€‚å˜ä½æ ¼å­å†…ã®å…¨åŸå­ã‹ã‚‰ã®æ•£ä¹±æ³¢ã®æŒ¯å¹…ã¨ä½ç›¸ã‚’åˆè¨ˆã—ãŸã‚‚ã®ã§ã™ã€‚</p>

        <p style="text-align: center; font-size: 1.1em; margin: 1.5em 0;">
            \[ F_{hkl} = \sum_{j=1}^{N} f_j \exp\left[2\pi i (hx_j + ky_j + lz_j)\right] \]
        </p>

        <p>ã“ã“ã§ã€\( f_j \)ã¯åŸå­\( j \)ã®åŸå­æ•£ä¹±å› å­ã€\( (x_j, y_j, z_j) \)ã¯åŸå­\( j \)ã®åˆ†æ•°åº§æ¨™ã§ã™ã€‚</p>

        <p>å›æŠ˜å¼·åº¦\( I_{hkl} \)ã¯æ§‹é€ å› å­ã®çµ¶å¯¾å€¤ã®äºŒä¹—ã«æ¯”ä¾‹ã—ã¾ã™:</p>

        <p style="text-align: center; font-size: 1.1em; margin: 1.5em 0;">
            \[ I_{hkl} \propto |F_{hkl}|^2 = F_{hkl} \cdot F_{hkl}^* \]
        </p>

        <h3>1.4.2 æ§‹é€ å› å­ã®è¨ˆç®—å®Ÿè£…</h3>

        <pre><code class="language-python">import numpy as np

def structure_factor(h, k, l, atoms, scattering_factors):
    """æ§‹é€ å› å­ã‚’è¨ˆç®—

    Args:
        h, k, l (int): MilleræŒ‡æ•°
        atoms (list): åŸå­ä½ç½®ã®ãƒªã‚¹ãƒˆ [(x1, y1, z1), (x2, y2, z2), ...]
        scattering_factors (list): å„åŸå­ã®æ•£ä¹±å› å­ [f1, f2, ...]

    Returns:
        complex: æ§‹é€ å› å­ F_hkl
    """
    F_hkl = 0.0 + 0.0j  # è¤‡ç´ æ•°

    for (x, y, z), f_j in zip(atoms, scattering_factors):
        # ä½ç›¸å› å­ exp[2Ï€i(hx + ky + lz)]
        phase = 2 * np.pi * (h * x + k * y + l * z)
        F_hkl += f_j * np.exp(1j * phase)

    return F_hkl


def intensity_from_structure_factor(F_hkl):
    """æ§‹é€ å› å­ã‹ã‚‰å›æŠ˜å¼·åº¦ã‚’è¨ˆç®—

    Args:
        F_hkl (complex): æ§‹é€ å› å­

    Returns:
        float: å›æŠ˜å¼·åº¦ I âˆ |F|^2
    """
    return np.abs(F_hkl) ** 2


# ä¾‹: å˜ç´”ç«‹æ–¹æ ¼å­ (SC) - åŸå­1å€‹ã€(0, 0, 0)
print("=== å˜ç´”ç«‹æ–¹æ ¼å­ (SC) ===")
atoms_sc = [(0, 0, 0)]
f_sc = [1.0]  # æ­£è¦åŒ–æ•£ä¹±å› å­

for hkl in [(1,0,0), (1,1,0), (1,1,1), (2,0,0)]:
    h, k, l = hkl
    F = structure_factor(h, k, l, atoms_sc, f_sc)
    I = intensity_from_structure_factor(F)
    print(f"({h} {k} {l}): F = {F:.4f}, I = {I:.4f}")

# ä¾‹: ä½“å¿ƒç«‹æ–¹æ ¼å­ (BCC) - åŸå­2å€‹ã€(0,0,0), (1/2,1/2,1/2)
print("\n=== ä½“å¿ƒç«‹æ–¹æ ¼å­ (BCC) ===")
atoms_bcc = [(0, 0, 0), (0.5, 0.5, 0.5)]
f_bcc = [1.0, 1.0]

for hkl in [(1,0,0), (1,1,0), (1,1,1), (2,0,0), (2,2,0)]:
    h, k, l = hkl
    F = structure_factor(h, k, l, atoms_bcc, f_bcc)
    I = intensity_from_structure_factor(F)
    print(f"({h} {k} {l}): F = {F.real:6.4f}{F.imag:+6.4f}i, I = {I:.4f}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# BCC: (1,0,0)ã¨(1,1,0)ã¯I=0(æ¶ˆæ»…å‰‡)ã€(1,1,1)ã¨(2,2,0)ã¯I>0</code></pre>

        <h3>1.4.3 å®Ÿéš›ã®çµæ™¶ã¸ã®é©ç”¨</h3>

        <pre><code class="language-python">def calculate_xrd_pattern(a, lattice_type, atom_positions, scattering_factors,
                          wavelength=1.54056, two_theta_max=90):
    """XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Args:
        a (float): æ ¼å­å®šæ•° [Ã…]
        lattice_type (str): æ ¼å­å‹ ('P', 'I', 'F')
        atom_positions (list): åŸå­ã®åˆ†æ•°åº§æ¨™
        scattering_factors (list): åŸå­æ•£ä¹±å› å­
        wavelength (float): Xç·šæ³¢é•· [Ã…]
        two_theta_max (float): æœ€å¤§2Î¸è§’ [åº¦]

    Returns:
        tuple: (two_theta_list, intensity_list)
    """
    # é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ« (ç«‹æ–¹æ™¶ã®ç°¡æ˜“ç‰ˆ)
    a_vec = np.array([a, 0, 0])
    b_vec = np.array([0, a, 0])
    c_vec = np.array([0, 0, a])
    a_star, b_star, c_star = reciprocal_lattice_vectors(a_vec, b_vec, c_vec)

    two_theta_list = []
    intensity_list = []

    # MilleræŒ‡æ•°ã‚’èµ°æŸ»
    for h in range(0, 6):
        for k in range(0, 6):
            for l in range(0, 6):
                if h == 0 and k == 0 and l == 0:
                    continue

                # æ¶ˆæ»…å‰‡ãƒã‚§ãƒƒã‚¯
                if not systematic_absences(h, k, l, lattice_type):
                    continue

                # é¢é–“éš”è¨ˆç®—
                d = d_spacing_from_hkl(h, k, l, a_star, b_star, c_star)

                # Braggè§’è¨ˆç®—
                theta = bragg_law(d, wavelength, n=1)
                if theta is None or 2*theta > two_theta_max:
                    continue

                # æ§‹é€ å› å­ã¨å¼·åº¦è¨ˆç®—
                F = structure_factor(h, k, l, atom_positions, scattering_factors)
                I = intensity_from_structure_factor(F)

                # ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„åå…‰å› å­ (ç°¡æ˜“ç‰ˆ)
                LP = (1 + np.cos(2*np.radians(theta))**2) / (np.sin(np.radians(theta))**2 * np.cos(np.radians(theta)))
                I_corrected = I * LP

                two_theta_list.append(2 * theta)
                intensity_list.append(I_corrected)

    return np.array(two_theta_list), np.array(intensity_list)


# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: Î±-Fe (BCC, a = 2.87 Ã…)
a_Fe = 2.87
atoms_Fe = [(0, 0, 0), (0.5, 0.5, 0.5)]
f_Fe = [26.0, 26.0]  # Feã®åŸå­ç•ªå·

two_theta, intensity = calculate_xrd_pattern(
    a=a_Fe,
    lattice_type='I',
    atom_positions=atoms_Fe,
    scattering_factors=f_Fe,
    wavelength=1.54056,
    two_theta_max=120
)

# ãƒ”ãƒ¼ã‚¯ã®è¡¨ç¤º
print("=== Î±-Fe (BCC) XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ===")
print("2Î¸ [åº¦]  | ç›¸å¯¾å¼·åº¦")
print("-" * 30)

# å¼·åº¦ã‚’æ­£è¦åŒ–
intensity_normalized = 100 * intensity / np.max(intensity)

# å¼·åº¦é †ã«ã‚½ãƒ¼ãƒˆ
sorted_indices = np.argsort(two_theta)
for idx in sorted_indices[:10]:  # ä¸Šä½10ãƒ”ãƒ¼ã‚¯
    print(f"{two_theta[idx]:7.2f}  | {intensity_normalized[idx]:7.1f}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›: Î±-Feã®å…¸å‹çš„ãªãƒ”ãƒ¼ã‚¯ä½ç½®
# (110): ~44.7Â°
# (200): ~65.0Â°
# (211): ~82.3Â°</code></pre>

        <h2>1.5 Ewaldçƒã¨å›æŠ˜æ¡ä»¶å¯è¦–åŒ–</h2>

        <h3>1.5.1 Ewaldçƒã®æ¦‚å¿µ</h3>

        <p>Ewaldçƒã¯ã€Xç·šå›æŠ˜ã®å¹¾ä½•å­¦çš„æ¡ä»¶ã‚’å¯è¦–åŒ–ã™ã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚é€†æ ¼å­ç©ºé–“ã«ãŠã„ã¦ã€åŠå¾„\( 1/\lambda \)ã®çƒã‚’æãã€å…¥å°„Xç·šãƒ™ã‚¯ãƒˆãƒ«\( \mathbf{k}_0 \)ã®çµ‚ç‚¹ã‚’åŸç‚¹ã¨ã—ã¾ã™ã€‚</p>

        <p>å›æŠ˜æ¡ä»¶ã¯ã€EwaldçƒãŒé€†æ ¼å­ç‚¹ã‚’é€šéã™ã‚‹ã¨ãã«æº€ãŸã•ã‚Œã¾ã™:</p>

        <p style="text-align: center; font-size: 1.1em; margin: 1.5em 0;">
            \[ \mathbf{k} - \mathbf{k}_0 = \mathbf{G}_{hkl} \]
        </p>

        <p>ã“ã“ã§ã€\( \mathbf{k} \)ã¯å›æŠ˜Xç·šã®æ³¢æ•°ãƒ™ã‚¯ãƒˆãƒ«ã€\( \mathbf{G}_{hkl} \)ã¯é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚</p>

        <div class="mermaid">
graph TD
    A[å…¥å°„Xç·š<br/>æ³¢æ•°ãƒ™ã‚¯ãƒˆãƒ« k0] --> B[Ewaldçƒ<br/>åŠå¾„ = 1/Î»]
    B --> C{é€†æ ¼å­ç‚¹ãŒ<br/>Ewaldçƒä¸Š?}
    C -->|Yes| D[å›æŠ˜æ¡ä»¶æº€è¶³<br/>å›æŠ˜ç™ºç”Ÿ]
    C -->|No| E[å›æŠ˜ãªã—]
    D --> F[å›æŠ˜Xç·š<br/>æ³¢æ•°ãƒ™ã‚¯ãƒˆãƒ« k]
    style B fill:#fce7f3
    style D fill:#e8f5e9
    style E fill:#ffebee
        </div>

        <h3>1.5.2 Ewaldçƒã®ãƒ—ãƒ­ãƒƒãƒˆ</h3>

        <pre><code class="language-python">import matplotlib.pyplot as plt
from matplotlib.patches import Circle
from matplotlib.patches import FancyArrowPatch

def plot_ewald_sphere_2d(wavelength, a, hkl_max=3):
    """Ewaldçƒã®2æ¬¡å…ƒæ–­é¢å›³ã‚’æç”»

    Args:
        wavelength (float): Xç·šæ³¢é•· [Ã…]
        a (float): æ ¼å­å®šæ•° [Ã…] (ç«‹æ–¹æ™¶)
        hkl_max (int): æç”»ã™ã‚‹é€†æ ¼å­ç‚¹ã®æœ€å¤§MilleræŒ‡æ•°
    """
    fig, ax = plt.subplots(figsize=(10, 8))

    # Ewaldçƒã®åŠå¾„
    k = 1.0 / wavelength  # [Ã…^-1]

    # Ewaldçƒã®ä¸­å¿ƒ (å…¥å°„Xç·šã®çµ‚ç‚¹)
    center = np.array([k, 0])

    # Ewaldçƒã‚’æç”»
    circle = Circle(center, k, fill=False, edgecolor='#f093fb', linewidth=2, label='Ewaldçƒ')
    ax.add_patch(circle)

    # é€†æ ¼å­ç‚¹ã‚’æç”» (ç«‹æ–¹æ™¶, 2Dæ–­é¢)
    a_star = 1.0 / a  # [Ã…^-1]

    reciprocal_points = []
    for h in range(-hkl_max, hkl_max + 1):
        for l in range(-hkl_max, hkl_max + 1):
            G_x = h * a_star
            G_z = l * a_star
            reciprocal_points.append((G_x, G_z, h, l))

            # é€†æ ¼å­ç‚¹ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
            ax.plot(G_x, G_z, 'o', color='#2c3e50', markersize=4)

    # å…¥å°„Xç·šãƒ™ã‚¯ãƒˆãƒ«
    ax.arrow(0, 0, k, 0, head_width=0.02, head_length=0.03,
             fc='#f5576c', ec='#f5576c', linewidth=2, label='å…¥å°„Xç·š k0')

    # Ewaldçƒã¨äº¤å·®ã™ã‚‹é€†æ ¼å­ç‚¹ã‚’å¼·èª¿
    for G_x, G_z, h, l in reciprocal_points:
        dist_from_center = np.sqrt((G_x - center[0])**2 + (G_z - center[1])**2)
        if abs(dist_from_center - k) < 0.02:  # çƒä¸Šã«ã‚ã‚‹
            ax.plot(G_x, G_z, 'o', color='#e74c3c', markersize=10,
                   label=f'å›æŠ˜å¯èƒ½: ({h},0,{l})' if h==1 and l==0 else '')

            # å›æŠ˜Xç·šãƒ™ã‚¯ãƒˆãƒ«
            ax.arrow(0, 0, G_x, G_z, head_width=0.01, head_length=0.02,
                    fc='#e74c3c', ec='#e74c3c', linewidth=1.5,
                    linestyle='--', alpha=0.7)

    ax.set_xlabel('é€†æ ¼å­ hæ–¹å‘ [Ã…$^{-1}$]', fontsize=12)
    ax.set_ylabel('é€†æ ¼å­ læ–¹å‘ [Ã…$^{-1}$]', fontsize=12)
    ax.set_title(f'Ewaldçƒã¨é€†æ ¼å­ (Î» = {wavelength:.2f} Ã…, a = {a:.2f} Ã…)', fontsize=14)
    ax.set_aspect('equal')
    ax.grid(True, alpha=0.3)
    ax.axhline(y=0, color='k', linewidth=0.5)
    ax.axvline(x=0, color='k', linewidth=0.5)

    # å‡¡ä¾‹ã‚’æ•´ç†
    handles, labels = ax.get_legend_handles_labels()
    by_label = dict(zip(labels, handles))
    ax.legend(by_label.values(), by_label.keys(), loc='upper right')

    plt.tight_layout()
    plt.show()

# Cu KÎ±ç·šã€æ ¼å­å®šæ•° a = 3.5 Ã… ã®å ´åˆ
plot_ewald_sphere_2d(wavelength=1.54056, a=3.5, hkl_max=2)</code></pre>

        <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

        <p>ã“ã®ç« ã‚’å®Œäº†ã—ãŸã‚ãªãŸã¯ã€ä»¥ä¸‹ã‚’èª¬æ˜ãƒ»å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ:</p>

        <div class="learning-objectives">
            <h3>åŸºæœ¬ç†è§£</h3>
            <ul>
                <li>âœ… Braggã®æ³•å‰‡ \( 2d\sin\theta = n\lambda \) ã®ç‰©ç†çš„æ„å‘³ã¨å°å‡º</li>
                <li>âœ… çµæ™¶æ ¼å­ã¨é€†æ ¼å­ã®é–¢ä¿‚ã€ãŠã‚ˆã³é¢é–“éš”ã®è¨ˆç®—</li>
                <li>âœ… ç³»çµ±çš„æ¶ˆæ»…å‰‡ã¨çµæ™¶å¯¾ç§°æ€§ã®é–¢ä¿‚</li>
            </ul>

            <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
            <ul>
                <li>âœ… Pythonã§å›æŠ˜è§’ã‚’è¨ˆç®—ã—ã€é¢é–“éš”ã¨ã®é–¢ä¿‚ã‚’å¯è¦–åŒ–</li>
                <li>âœ… é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰MilleræŒ‡æ•°ã®é¢é–“éš”ã‚’å°å‡º</li>
                <li>âœ… æ§‹é€ å› å­ã‚’è¨ˆç®—ã—ã€å›æŠ˜å¼·åº¦ã‚’äºˆæ¸¬</li>
                <li>âœ… XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã€å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿ã¨æ¯”è¼ƒå¯èƒ½</li>
            </ul>

            <h3>å¿œç”¨åŠ›</h3>
            <ul>
                <li>âœ… Ewaldçƒã‚’ç”¨ã„ã¦å›æŠ˜æ¡ä»¶ã‚’å¹¾ä½•å­¦çš„ã«ç†è§£</li>
                <li>âœ… æ¶ˆæ»…å‰‡ã‹ã‚‰çµæ™¶ã®æ ¼å­å‹ã‚’æ¨å®š</li>
                <li>âœ… å®Ÿéš›ã®ææ–™(Î±-Feç­‰)ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</li>
            </ul>
        </div>

        <h2>æ¼”ç¿’å•é¡Œ</h2>

        <h3>Easy (åŸºç¤ç¢ºèª)</h3>

        <details>
            <summary><strong>Q1</strong>: Cu KÎ±ç·š(Î» = 1.54 Ã…)ã‚’ç”¨ã„ã¦ã€é¢é–“éš” d = 2.5 Ã… ã®çµæ™¶é¢ã®Braggè§’(n=1)ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>
            <pre><code class="language-python">theta = bragg_law(d=2.5, wavelength=1.54, n=1)
print(f"Braggè§’: {theta:.2f}åº¦")
# å‡ºåŠ›: Braggè§’: 17.93åº¦</code></pre>

            <p><strong>è§£èª¬</strong>:</p>
            <p>Braggã®æ³•å‰‡ \( 2d\sin\theta = n\lambda \) ã‚ˆã‚Š:</p>
            <p>\[ \sin\theta = \frac{n\lambda}{2d} = \frac{1 \times 1.54}{2 \times 2.5} = 0.308 \]</p>
            <p>\[ \theta = \arcsin(0.308) = 17.93Â° \]</p>
        </details>

        <details>
            <summary><strong>Q2</strong>: ä½“å¿ƒç«‹æ–¹æ ¼å­(BCC)ã§ã€MilleræŒ‡æ•° (1,1,0) ã®åå°„ã¯è¦³æ¸¬ã•ã‚Œã¾ã™ã‹? æ¶ˆæ»…å‰‡ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>
            <pre><code class="language-python">is_allowed = systematic_absences(1, 1, 0, 'I')
print(f"(1,1,0)åå°„: {'è¦³æ¸¬ã•ã‚Œã‚‹' if is_allowed else 'æ¶ˆæ»…'}")
# å‡ºåŠ›: (1,1,0)åå°„: è¦³æ¸¬ã•ã‚Œã‚‹</code></pre>

            <p><strong>è§£èª¬</strong>:</p>
            <p>BCC (ä½“å¿ƒæ ¼å­, lattice_type='I') ã®æ¶ˆæ»…å‰‡: \( h + k + l = å¶æ•° \) ã®ã¿è¦³æ¸¬ã€‚</p>
            <p>(1,1,0)ã®å ´åˆ: \( 1 + 1 + 0 = 2 \) (å¶æ•°) â†’ è¦³æ¸¬ã•ã‚Œã‚‹ âœ“</p>
            <p>(1,0,0)ã®å ´åˆ: \( 1 + 0 + 0 = 1 \) (å¥‡æ•°) â†’ æ¶ˆæ»… âœ—</p>
        </details>

        <h3>Medium (å¿œç”¨)</h3>

        <details>
            <summary><strong>Q3</strong>: ç«‹æ–¹æ™¶ (a=4.0Ã…) ã® (2,2,0) é¢ã¨ (1,1,1) é¢ã®é¢é–“éš”ã‚’è¨ˆç®—ã—ã€ã©ã¡ã‚‰ã®é¢é–“éš”ãŒå¤§ãã„ã‹æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>
            <pre><code class="language-python">a = 4.0
a_vec = np.array([a, 0, 0])
b_vec = np.array([0, a, 0])
c_vec = np.array([0, 0, a])
a_star, b_star, c_star = reciprocal_lattice_vectors(a_vec, b_vec, c_vec)

d_220 = d_spacing_from_hkl(2, 2, 0, a_star, b_star, c_star)
d_111 = d_spacing_from_hkl(1, 1, 1, a_star, b_star, c_star)

print(f"d_220 = {d_220:.4f} Ã…")
print(f"d_111 = {d_111:.4f} Ã…")
print(f"å¤§ãã„ã®ã¯: {'(1,1,1)' if d_111 > d_220 else '(2,2,0)'}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# d_220 = 1.4142 Ã…
# d_111 = 2.3094 Ã…
# å¤§ãã„ã®ã¯: (1,1,1)</code></pre>

            <p><strong>è§£èª¬</strong>:</p>
            <p>ç«‹æ–¹æ™¶ã®é¢é–“éš”å…¬å¼: \( d_{hkl} = \frac{a}{\sqrt{h^2 + k^2 + l^2}} \)</p>
            <p>(2,2,0): \( d = 4.0 / \sqrt{4+4+0} = 4.0 / 2.83 = 1.414 \) Ã…</p>
            <p>(1,1,1): \( d = 4.0 / \sqrt{1+1+1} = 4.0 / 1.732 = 2.309 \) Ã…</p>
            <p>çµè«–: (1,1,1) ã®æ–¹ãŒé¢é–“éš”ãŒå¤§ãã„ (MilleræŒ‡æ•°ãŒå°ã•ã„é¢ã»ã©é–“éš”ãŒåºƒã„)</p>
        </details>

        <details>
            <summary><strong>Q4</strong>: å˜ç´”ç«‹æ–¹æ ¼å­(SC)ã¨é¢å¿ƒç«‹æ–¹æ ¼å­(FCC)ã§ã€(1,0,0)åå°„ã®å¼·åº¦ã‚’æ§‹é€ å› å­ã‹ã‚‰æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>
            <pre><code class="language-python"># SC: åŸå­1å€‹ at (0,0,0)
atoms_sc = [(0, 0, 0)]
f_sc = [1.0]
F_sc = structure_factor(1, 0, 0, atoms_sc, f_sc)
I_sc = intensity_from_structure_factor(F_sc)

# FCC: åŸå­4å€‹ at (0,0,0), (1/2,1/2,0), (1/2,0,1/2), (0,1/2,1/2)
atoms_fcc = [(0,0,0), (0.5,0.5,0), (0.5,0,0.5), (0,0.5,0.5)]
f_fcc = [1.0, 1.0, 1.0, 1.0]
F_fcc = structure_factor(1, 0, 0, atoms_fcc, f_fcc)
I_fcc = intensity_from_structure_factor(F_fcc)

print(f"SC: F_100 = {F_sc:.4f}, I = {I_sc:.4f}")
print(f"FCC: F_100 = {F_fcc:.4f}, I = {I_fcc:.4f}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# SC: F_100 = 1.0000, I = 1.0000
# FCC: F_100 = 0.0000, I = 0.0000 (æ¶ˆæ»…)</code></pre>

            <p><strong>è§£èª¬</strong>:</p>
            <p>FCCæ§‹é€ å› å­ (1,0,0):</p>
            <p>\[ F = 1 \cdot e^{0} + 1 \cdot e^{i\pi} + 1 \cdot e^{i\pi} + 1 \cdot e^{0} = 1 + (-1) + (-1) + 1 = 0 \]</p>
            <p>FCCã§ã¯æ··åˆæŒ‡æ•°åå°„((1,0,0)ç­‰)ã¯æ¶ˆæ»…ã—ã¾ã™ã€‚</p>
        </details>

        <h3>Hard (ç™ºå±•)</h3>

        <details>
            <summary><strong>Q5</strong>: Î±-Fe (BCC, a=2.87Ã…) ã¨ Î³-Fe (FCC, a=3.65Ã…) ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã€æœ€ã‚‚å¼·ã„ãƒ”ãƒ¼ã‚¯ä½ç½®(2Î¸)ã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚Cu KÎ±ç·šä½¿ç”¨ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>
            <pre><code class="language-python"># Î±-Fe (BCC)
two_theta_bcc, intensity_bcc = calculate_xrd_pattern(
    a=2.87, lattice_type='I',
    atom_positions=[(0,0,0), (0.5,0.5,0.5)],
    scattering_factors=[26.0, 26.0]
)
max_idx_bcc = np.argmax(intensity_bcc)
print(f"Î±-Fe (BCC) æœ€å¼·ãƒ”ãƒ¼ã‚¯: 2Î¸ = {two_theta_bcc[max_idx_bcc]:.2f}Â°")

# Î³-Fe (FCC)
two_theta_fcc, intensity_fcc = calculate_xrd_pattern(
    a=3.65, lattice_type='F',
    atom_positions=[(0,0,0), (0.5,0.5,0), (0.5,0,0.5), (0,0.5,0.5)],
    scattering_factors=[26.0]*4
)
max_idx_fcc = np.argmax(intensity_fcc)
print(f"Î³-Fe (FCC) æœ€å¼·ãƒ”ãƒ¼ã‚¯: 2Î¸ = {two_theta_fcc[max_idx_fcc]:.2f}Â°")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# Î±-Fe (BCC) æœ€å¼·ãƒ”ãƒ¼ã‚¯: 2Î¸ â‰ˆ 44.7Â° (110åå°„)
# Î³-Fe (FCC) æœ€å¼·ãƒ”ãƒ¼ã‚¯: 2Î¸ â‰ˆ 43.6Â° (111åå°„)</code></pre>

            <p><strong>è§£èª¬</strong>:</p>
            <p>Î±-Fe (BCC): æœ€å¼·ãƒ”ãƒ¼ã‚¯ã¯(110)åå°„ (h+k+l=2, æœ€å°å¶æ•°)</p>
            <p>Î³-Fe (FCC): æœ€å¼·ãƒ”ãƒ¼ã‚¯ã¯(111)åå°„ (å…¨ã¦å¥‡æ•°, æœ€å°)</p>
            <p>ã“ã®é•ã„ã«ã‚ˆã‚Šã€XRDã§BCCã¨FCCã‚’æ˜ç¢ºã«åŒºåˆ¥ã§ãã¾ã™ã€‚å®Ÿéš›ã®é‰„é‹¼ææ–™ã®ç›¸å¤‰æ…‹è§£æã«å¿œç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
        </details>

        <details>
            <summary><strong>Q6</strong>: Ewaldçƒã®æ¦‚å¿µã‚’ç”¨ã„ã¦ã€ãªãœå˜è‰²Xç·šã§ã¯å…¨ã¦ã®é€†æ ¼å­ç‚¹ãŒåŒæ™‚ã«å›æŠ˜ã—ãªã„ã®ã‹ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>
            <p><strong>ç†ç”±</strong>:</p>
            <ol>
                <li>Ewaldçƒã®åŠå¾„ã¯å›ºå®š (= 1/Î»)</li>
                <li>å›æŠ˜æ¡ä»¶ã¯ã€Œé€†æ ¼å­ç‚¹ãŒEwaldçƒä¸Šã«ã‚ã‚‹ã€ã“ã¨</li>
                <li>å˜è‰²Xç·šã§ã¯è©¦æ–™ã‚’å›è»¢ã•ã›ãªã„é™ã‚Šã€Ewaldçƒã¯å›ºå®šä½ç½®</li>
                <li>ã»ã¨ã‚“ã©ã®é€†æ ¼å­ç‚¹ã¯çƒã®å†…éƒ¨ã¾ãŸã¯å¤–éƒ¨ã«ã‚ã‚Šã€çƒé¢ä¸Šã«ãªã„</li>
            </ol>
            <p><strong>å®Ÿé¨“çš„è§£æ±ºæ³•</strong>:</p>
            <ul>
                <li><strong>ç²‰æœ«XRD</strong>: ãƒ©ãƒ³ãƒ€ãƒ é…å‘ã®å¾®çµæ™¶ã«ã‚ˆã‚Šã€å…¨æ–¹ä½ã‹ã‚‰ã®å›æŠ˜ã‚’è¦³æ¸¬</li>
                <li><strong>å˜çµæ™¶å›è»¢æ³•</strong>: è©¦æ–™ã‚’å›è»¢ã•ã›ã€é€†æ ¼å­ç‚¹ã‚’é †æ¬¡Ewaldçƒã«é€šéã•ã›ã‚‹</li>
                <li><strong>ç™½è‰²Xç·š(Laueæ³•)</strong>: æ§˜ã€…ãªæ³¢é•· â†’ æ§˜ã€…ãªåŠå¾„ã®Ewaldçƒ â†’ å¤šæ•°ã®åå°„ã‚’åŒæ™‚è¦³æ¸¬</li>
            </ul>
        </details>

        <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

        <p>ã“ã®ç« ã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’èª¬æ˜ãƒ»å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p>

        <h3>åŸºæœ¬ç†è§£</h3>
        <ul>
            <li>âœ… Braggã®æ³•å‰‡ï¼ˆnÎ» = 2d sinÎ¸ï¼‰ã‚’å°å‡ºã—ã€ç‰©ç†çš„æ„å‘³ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>âœ… çµæ™¶æ ¼å­ã¨é€†æ ¼å­ã®é–¢ä¿‚ã‚’ç†è§£ã—ã€é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¨ˆç®—ã§ãã‚‹</li>
            <li>âœ… æ¶ˆæ»…å‰‡ãŒç”Ÿã˜ã‚‹ç‰©ç†çš„ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ï¼ˆç ´å£Šçš„å¹²æ¸‰ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>âœ… æ§‹é€ å› å­F(hkl)ã®è¨ˆç®—æ–¹æ³•ã¨ç‰©ç†çš„æ„å‘³ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
        </ul>

        <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
        <ul>
            <li>âœ… Pythonã§dã‚¹ãƒšãƒ¼ã‚·ãƒ³ã‚°ã‚’è¨ˆç®—ã—ã€å›æŠ˜è§’ã‚’äºˆæ¸¬ã§ãã‚‹</li>
            <li>âœ… ä»»æ„ã®ç©ºé–“ç¾¤ã«å¯¾ã—ã¦æ¶ˆæ»…å‰‡ã‚’é©ç”¨ã—ã€è¨±å®¹åå°„ã‚’åˆ¤å®šã§ãã‚‹</li>
            <li>âœ… åŸå­åº§æ¨™ã‹ã‚‰æ§‹é€ å› å­ã‚’è¨ˆç®—ã—ã€å›æŠ˜å¼·åº¦ã‚’äºˆæ¸¬ã§ãã‚‹</li>
            <li>âœ… Ewaldçƒã®æ¦‚å¿µã‚’ç”¨ã„ã¦å›æŠ˜æ¡ä»¶ã‚’è¦–è¦šåŒ–ã§ãã‚‹</li>
        </ul>

        <h3>å¿œç”¨åŠ›</h3>
        <ul>
            <li>âœ… å®Ÿæ¸¬XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰çµæ™¶æ§‹é€ ï¼ˆBCC/FCCç­‰ï¼‰ã‚’æ¨å®šã§ãã‚‹</li>
            <li>âœ… æ ¼å­å®šæ•°ã®å¤‰åŒ–ãŒXRDãƒ‘ã‚¿ãƒ¼ãƒ³ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’äºˆæ¸¬ã§ãã‚‹</li>
            <li>âœ… æ¶ˆæ»…å‰‡ã‚’åˆ©ç”¨ã—ã¦ç©ºé–“ç¾¤å€™è£œã‚’çµã‚Šè¾¼ã‚€ã“ã¨ãŒã§ãã‚‹</li>
            <li>âœ… å¤šçµæ™¶ææ–™ã®XRDè§£ææˆ¦ç•¥ã‚’ç«‹æ¡ˆã§ãã‚‹</li>
        </ul>

        <h2>å‚è€ƒæ–‡çŒ®</h2>

        <ol>
            <li>Cullity, B. D., & Stock, S. R. (2001). <em>Elements of X-Ray Diffraction</em> (3rd ed.). Prentice Hall. - Xç·šå›æŠ˜å­¦ã®å¤å…¸çš„æ•™ç§‘æ›¸ã€Braggã®æ³•å‰‡ã‹ã‚‰çµæ™¶æ§‹é€ è§£æã¾ã§åŒ…æ‹¬çš„ã«è§£èª¬</li>
            <li>Warren, B. E. (1990). <em>X-ray Diffraction</em>. Dover Publications. - å›æŠ˜ç†è«–ã®ç‰©ç†çš„åŸºç¤ã‚’è©³ç´°ã«è§£èª¬ã€æ§‹é€ å› å­ã®å°å‡ºãŒç§€é€¸</li>
            <li>Pecharsky, V. K., & Zavalij, P. Y. (2009). <em>Fundamentals of Powder Diffraction and Structural Characterization of Materials</em> (2nd ed.). Springer. - ç²‰æœ«XRDã«ç‰¹åŒ–ã—ãŸå®Ÿè·µçš„æ•™ç§‘æ›¸</li>
            <li>International Tables for Crystallography, Volume A: Space-Group Symmetry (2016). International Union of Crystallography. - ç©ºé–“ç¾¤ã¨æ¶ˆæ»…å‰‡ã®æ±ºå®šç‰ˆãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹</li>
            <li>Giacovazzo, C., et al. (2011). <em>Fundamentals of Crystallography</em> (3rd ed.). Oxford University Press. - çµæ™¶å­¦ã®ç†è«–çš„åŸºç¤ã€é€†æ ¼å­ã®æ¦‚å¿µã‚’æ˜å¿«ã«è§£èª¬</li>
            <li>Hammond, C. (2015). <em>The Basics of Crystallography and Diffraction</em> (4th ed.). Oxford University Press. - Ewaldçƒæ§‹æˆæ³•ã®è¦–è¦šçš„ç†è§£ã«å„ªã‚ŒãŸæ•™ç§‘æ›¸</li>
            <li>Ladd, M., & Palmer, R. (2013). <em>Structure Determination by X-ray Crystallography</em> (5th ed.). Springer. - æ§‹é€ å› å­è¨ˆç®—ã‹ã‚‰çµæ™¶æ§‹é€ æ±ºå®šã¾ã§å®Ÿè·µçš„ã‚¬ã‚¤ãƒ‰</li>
        </ol>

        <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>

        <p>ç¬¬1ç« ã§ã¯ã€Xç·šå›æŠ˜ã®ç†è«–çš„åŸºç¤ã‚’å­¦ã³ã¾ã—ãŸã€‚Braggã®æ³•å‰‡ã€é€†æ ¼å­ã€æ¶ˆæ»…å‰‡ã€æ§‹é€ å› å­ã¨ã„ã£ãŸæ¦‚å¿µã¯ã€ã™ã¹ã¦ã®XRDè§£æã®åœŸå°ã¨ãªã‚Šã¾ã™ã€‚</p>

        <p><strong>ç¬¬2ç« </strong>ã§ã¯ã€ã“ã‚Œã‚‰ã®ç†è«–ã‚’å®Ÿéš›ã®XRDæ¸¬å®šã«å¿œç”¨ã—ã¾ã™ã€‚ç²‰æœ«Xç·šå›æŠ˜ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã€ãƒ”ãƒ¼ã‚¯åŒå®šã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰é™¤å»ã€ãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã¨ã„ã£ãŸå®Ÿè·µçš„ãªè§£ææ‰‹æ³•ã‚’å­¦ã³ã¾ã™ã€‚</p>

        <div class="navigation">
            <a href="./index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a>
            <a href="./chapter-2.html" class="nav-button">ç¬¬2ç« : ç²‰æœ«XRDæ¸¬å®šã¨è§£æ â†’</a>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 MS Terakoya - Materials Science Learning Platform</p>
        <p><a href="../../index.html">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a></p>
    </footer>
</body>
</html>