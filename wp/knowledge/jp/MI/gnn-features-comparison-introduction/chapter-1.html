<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬1ç« ï¼šGNNæ§‹é€ ãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®åŸºç¤ - ã‚°ãƒ©ãƒ•è¡¨ç¾ã¨çµ„æˆãƒ™ãƒ¼ã‚¹ã¨ã®é•ã„">
    <title>ç¬¬1ç« ï¼šGNNæ§‹é€ ãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®åŸºç¤ | GNNç‰¹å¾´é‡æ¯”è¼ƒå…¥é–€</title>

    <!-- CSS Styling -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #667eea;
            --accent-color: #764ba2;
            --bg-color: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --code-bg: #f5f5f5;
            --link-color: #667eea;
            --link-hover: #764ba2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
            line-height: 1.8;
            color: var(--text-color);
            background: var(--bg-color);
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        header .container {
            padding: 0 1.5rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .meta {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            font-size: 0.9rem;
            opacity: 0.95;
            margin-top: 1rem;
        }

        .meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }

        h2 {
            font-size: 1.75rem;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--secondary-color);
            color: var(--primary-color);
        }

        h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
            margin-bottom: 0.8rem;
            color: var(--primary-color);
        }

        h4 {
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
        }

        p {
            margin-bottom: 1.2rem;
        }

        a {
            color: var(--link-color);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1.2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        pre code {
            background: none;
            padding: 0;
            font-size: 0.9rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            display: block;
        }

        thead {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        th, td {
            padding: 0.8rem;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: #f9f9f9;
        }

        blockquote {
            border-left: 4px solid var(--secondary-color);
            padding-left: 1.5rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #666;
        }

        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .mermaid {
            text-align: center;
            margin: 2rem 0;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        details {
            margin: 1rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--primary-color);
            padding: 0.5rem;
        }

        summary:hover {
            color: var(--secondary-color);
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin: 3rem 0;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-button {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background: var(--secondary-color);
            color: white;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 600;
        }

        .nav-button:hover {
            background: var(--accent-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }

        footer {
            margin-top: 4rem;
            padding: 2rem 0;
            border-top: 2px solid var(--border-color);
            text-align: center;
            color: #666;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 1.6rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }

            table {
                font-size: 0.9rem;
            }
        }
    </style>

    <!-- MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({ startOnLoad: true, theme: 'default' });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>

    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</head>
<body>
    <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/MI/index.html">ãƒãƒ†ãƒªã‚¢ãƒ«ã‚ºãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a><span class="breadcrumb-separator">â€º</span><a href="./index.html">GNNç‰¹å¾´é‡æ¯”è¼ƒå…¥é–€</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">ç¬¬1ç« </span>
        </div>
    </nav>

    <header>
        <div class="container">
            <h1>ç¬¬1ç« ï¼šGNNæ§‹é€ ãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®åŸºç¤</h1>
            <div class="meta">
                <span>ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span>ğŸ“Š é›£æ˜“åº¦: å…¥é–€</span>
                <span>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">
        <p><strong>ã‚°ãƒ©ãƒ•è¡¨ç¾ãŒæ‰ãˆã‚‹æ§‹é€ æƒ…å ±ï¼šçµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã§ã¯è¦‹ãˆãªã‹ã£ãŸä¸–ç•Œ</strong></p>

        <h2 id="intro">1.1 çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®é™ç•Œ</h2>

        <p>ææ–™ç§‘å­¦ã®AIäºˆæ¸¬ã«ãŠã„ã¦ã€é•·å¹´ã®ä¸»æµã¯<strong>çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡</strong>ã§ã—ãŸã€‚Magpieï¼ˆWard et al., 2016ï¼‰ã‚„Matminerã®ã‚ˆã†ãªæ‰‹æ³•ã¯ã€åŒ–å­¦çµ„æˆï¼ˆä¾‹: Feâ‚‚Oâ‚ƒï¼‰ã‹ã‚‰çµ±è¨ˆçš„ç‰¹å¾´é‡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>

        <h3>1.1.1 çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®ä¾‹</h3>

        <pre><code class="language-python"># Google Colabç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
!pip install matminer pymatgen scikit-learn

import numpy as np
from matminer.featurizers.composition import ElementProperty
from pymatgen.core.composition import Composition

# Example 1: Magpieç‰¹å¾´é‡ã®è¨ˆç®—
magpie = ElementProperty.from_preset("magpie")

# Feâ‚‚Oâ‚ƒï¼ˆé…¸åŒ–é‰„ï¼‰ã®ç‰¹å¾´é‡
comp = Composition("Fe2O3")
features = magpie.featurize(comp)

print(f"ç‰¹å¾´é‡ã®æ¬¡å…ƒæ•°: {len(features)}")
print(f"æœ€åˆã®10å€‹ã®ç‰¹å¾´é‡: {features[:10]}")
# å‡ºåŠ›ä¾‹: ç‰¹å¾´é‡ã®æ¬¡å…ƒæ•°: 132
# å‡ºåŠ›ä¾‹: æœ€åˆã®10å€‹ã®ç‰¹å¾´é‡: [55.845, 15.999, 39.998, ...]
</code></pre>

        <p>çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã¯ä»¥ä¸‹ã®132æ¬¡å…ƒã‚’å«ã¿ã¾ã™ï¼š</p>
        <ul>
            <li>å¹³å‡åŸå­é‡ã€å¯†åº¦</li>
            <li>é›»æ°—é™°æ€§åº¦ã€ã‚¤ã‚ªãƒ³åŠå¾„ã®çµ±è¨ˆé‡ï¼ˆå¹³å‡ã€åˆ†æ•£ã€æœ€å¤§ã€æœ€å°ï¼‰</li>
            <li>é›»å­é…ç½®ã®çµ±è¨ˆé‡</li>
        </ul>

        <h3>1.1.2 è‡´å‘½çš„ãªé™ç•Œï¼šæ§‹é€ æƒ…å ±ã®æ¬ è½</h3>

        <p>çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã¯ã€<strong>åŸå­ã®ç©ºé–“é…ç½®</strong>ã‚’ä¸€åˆ‡è€ƒæ…®ã—ã¾ã›ã‚“ã€‚ã“ã‚Œã¯ä»¥ä¸‹ã®å•é¡Œã‚’å¼•ãèµ·ã“ã—ã¾ã™ï¼š</p>

        <div class="mermaid">
graph LR
    A[C: ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰] -.åŒã˜çµ„æˆ.-> B[C: ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆ]
    A --> C[ç¡¬åº¦: 10,000 HV]
    B --> D[ç¡¬åº¦: 2-3 HV]

    E[SiOâ‚‚: Î±-quartz] -.åŒã˜çµ„æˆ.-> F[SiOâ‚‚: Î²-cristobalite]
    E --> G[å¯†åº¦: 2.65 g/cmÂ³]
    F --> H[å¯†åº¦: 2.33 g/cmÂ³]

    style A fill:#e3f2fd
    style B fill:#e3f2fd
    style E fill:#fff3e0
    style F fill:#fff3e0
</div>

        <p><strong>å…·ä½“ä¾‹</strong>:</p>
        <ol>
            <li><strong>ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ vs ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆ</strong>ï¼ˆä¸¡æ–¹ã¨ã‚‚Cï¼‰:
                <ul>
                    <li>ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰: spÂ³æ··æˆã€æ­£å››é¢ä½“æ§‹é€ ã€ç¡¬åº¦ 10,000 HV</li>
                    <li>ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆ: spÂ²æ··æˆã€å±¤çŠ¶æ§‹é€ ã€ç¡¬åº¦ 2-3 HV</li>
                    <li>çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã¯å®Œå…¨ã«åŒä¸€ï¼</li>
                </ul>
            </li>
            <li><strong>SiOâ‚‚ã®å¤šå½¢</strong>ï¼ˆÎ±-quartz vs Î²-cristobaliteï¼‰:
                <ul>
                    <li>Î±-quartz: å¯†åº¦ 2.65 g/cmÂ³ã€å…­æ–¹æ™¶</li>
                    <li>Î²-cristobalite: å¯†åº¦ 2.33 g/cmÂ³ã€ç«‹æ–¹æ™¶</li>
                    <li>çµ„æˆã¯åŒä¸€ã ãŒç‰©æ€§ãŒå…¨ãç•°ãªã‚‹</li>
                </ul>
            </li>
        </ol>

        <pre><code class="language-python"># Example 2: çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®é™ç•Œã®å®Ÿè¨¼
from pymatgen.core import Structure, Lattice

# ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼ˆspÂ³ï¼‰
diamond_lattice = Lattice.cubic(3.567)
diamond = Structure(diamond_lattice, ["C", "C"],
                    [[0, 0, 0], [0.25, 0.25, 0.25]])

# ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆæ§‹é€ ï¼ˆspÂ²ã€ç°¡ç•¥ç‰ˆï¼‰
graphite_lattice = Lattice.hexagonal(2.46, 6.71)
graphite = Structure(graphite_lattice, ["C", "C"],
                     [[0, 0, 0], [1/3, 2/3, 0.5]])

# çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®è¨ˆç®—
comp_diamond = diamond.composition
comp_graphite = graphite.composition

features_diamond = magpie.featurize(comp_diamond)
features_graphite = magpie.featurize(comp_graphite)

print(f"ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã¨ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã®ç‰¹å¾´é‡ãŒåŒä¸€: {np.allclose(features_diamond, features_graphite)}")
# å‡ºåŠ›: Trueï¼ˆçµ„æˆãƒ™ãƒ¼ã‚¹ã§ã¯åŒºåˆ¥ä¸å¯èƒ½ï¼‰

print(f"å®Ÿéš›ã®å¯†åº¦:")
print(f"  ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰: {diamond.density:.2f} g/cmÂ³")  # 3.51
print(f"  ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆ: {graphite.density:.2f} g/cmÂ³")  # 2.26
print(f"å¯†åº¦å·®: {abs(diamond.density - graphite.density)/diamond.density * 100:.1f}%")
# å‡ºåŠ›: å¯†åº¦å·®: 35.6%ï¼ˆçµ„æˆãƒ™ãƒ¼ã‚¹ã§ã¯æ‰ãˆã‚‰ã‚Œãªã„ï¼‰
</code></pre>

        <h2 id="graph">1.2 ã‚°ãƒ©ãƒ•è¡¨ç¾ï¼šæ§‹é€ ã‚’è¨˜è¿°ã™ã‚‹æ•°å­¦çš„è¨€èª</h2>

        <h3>1.2.1 ã‚°ãƒ©ãƒ•ç†è«–ã®åŸºç¤</h3>

        <p>ã‚°ãƒ©ãƒ• \( G = (V, E) \) ã¯ä»¥ä¸‹ã‹ã‚‰æ§‹æˆã•ã‚Œã¾ã™ï¼š</p>
        <ul>
            <li><strong>é ‚ç‚¹é›†åˆ \( V \)</strong>: åŸå­ã®é›†åˆ</li>
            <li><strong>è¾ºé›†åˆ \( E \)</strong>: åŸå­é–“ã®çµåˆï¼ˆåŒ–å­¦çµåˆã€ã¾ãŸã¯ç©ºé–“çš„è¿‘æ¥ï¼‰</li>
        </ul>

        <p>å„é ‚ç‚¹ \( v_i \in V \) ã«ã¯<strong>ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡ \( \mathbf{x}_i \in \mathbb{R}^d \)</strong>ãŒä»˜ä¸ã•ã‚Œã¾ã™ï¼š</p>
        <ul>
            <li>åŸå­ç•ªå·ã€åŸå­é‡</li>
            <li>é›»æ°—é™°æ€§åº¦ã€ã‚¤ã‚ªãƒ³åŠå¾„</li>
            <li>ä¾¡é›»å­æ•°</li>
        </ul>

        <p>å„è¾º \( e_{ij} \in E \) ã«ã¯<strong>ã‚¨ãƒƒã‚¸ç‰¹å¾´é‡ \( \mathbf{e}_{ij} \in \mathbb{R}^k \)</strong>ãŒä»˜ä¸ã•ã‚Œã¾ã™ï¼š</p>
        <ul>
            <li>åŸå­é–“è·é›¢ \( r_{ij} \)</li>
            <li>çµåˆã‚¿ã‚¤ãƒ—ï¼ˆå˜çµåˆã€äºŒé‡çµåˆç­‰ï¼‰</li>
            <li>çµåˆè§’åº¦</li>
        </ul>

        <div class="mermaid">
graph TD
    subgraph "åˆ†å­: Hâ‚‚O"
        O[O<br/>åŸå­ç•ªå·=8<br/>é›»æ°—é™°æ€§åº¦=3.44]
        H1[H<br/>åŸå­ç•ªå·=1<br/>é›»æ°—é™°æ€§åº¦=2.20]
        H2[H<br/>åŸå­ç•ªå·=1<br/>é›»æ°—é™°æ€§åº¦=2.20]

        O ---|"è·é›¢=0.96Ã…<br/>å˜çµåˆ"| H1
        O ---|"è·é›¢=0.96Ã…<br/>å˜çµåˆ"| H2
    end

    style O fill:#e8f5e9
    style H1 fill:#e3f2fd
    style H2 fill:#e3f2fd
</div>

        <h3>1.2.2 PyTorch Geometricã§ã®ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿æ§‹é€ </h3>

        <pre><code class="language-python"># Example 3: PyTorch Geometricã§Hâ‚‚Oã‚’ã‚°ãƒ©ãƒ•è¡¨ç¾
!pip install torch-geometric torch-scatter torch-sparse

import torch
from torch_geometric.data import Data

# Hâ‚‚Oåˆ†å­ã®ã‚°ãƒ©ãƒ•è¡¨ç¾
# ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡: [åŸå­ç•ªå·, é›»æ°—é™°æ€§åº¦]
node_features = torch.tensor([
    [8, 3.44],   # O
    [1, 2.20],   # H1
    [1, 2.20]    # H2
], dtype=torch.float)

# ã‚¨ãƒƒã‚¸ãƒªã‚¹ãƒˆï¼ˆç„¡å‘ã‚°ãƒ©ãƒ•ãªã®ã§åŒæ–¹å‘ï¼‰
edge_index = torch.tensor([
    [0, 1, 1, 0, 0, 2, 2, 0],  # source nodes
    [1, 0, 0, 1, 2, 0, 0, 2]   # target nodes
], dtype=torch.long)

# ã‚¨ãƒƒã‚¸ç‰¹å¾´é‡: [åŸå­é–“è·é›¢ï¼ˆÃ…ï¼‰]
edge_attr = torch.tensor([
    [0.96], [0.96],  # O-H1
    [0.96], [0.96],  # H1-O (åŒæ–¹å‘)
    [0.96], [0.96],  # O-H2
    [0.96], [0.96]   # H2-O (åŒæ–¹å‘)
], dtype=torch.float)

# PyTorch Geometric Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
data = Data(x=node_features, edge_index=edge_index, edge_attr=edge_attr)

print(f"ãƒãƒ¼ãƒ‰æ•°: {data.num_nodes}")        # 3
print(f"ã‚¨ãƒƒã‚¸æ•°: {data.num_edges}")        # 8ï¼ˆåŒæ–¹å‘ï¼‰
print(f"ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡æ¬¡å…ƒ: {data.num_node_features}")  # 2
print(f"ã‚¨ãƒƒã‚¸ç‰¹å¾´é‡æ¬¡å…ƒ: {data.num_edge_features}")  # 1
print(f"\nãƒ‡ãƒ¼ã‚¿æ§‹é€ :")
print(data)
</code></pre>

        <h3>1.2.3 çµ„æˆãƒ™ãƒ¼ã‚¹ vs ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ï¼šæƒ…å ±é‡ã®æ¯”è¼ƒ</h3>

        <table>
            <thead>
                <tr>
                    <th>ç‰¹å¾´</th>
                    <th>çµ„æˆãƒ™ãƒ¼ã‚¹ï¼ˆMagpieï¼‰</th>
                    <th>ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ï¼ˆGNNï¼‰</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>æƒ…å ±æº</strong></td>
                    <td>åŒ–å­¦çµ„æˆã®ã¿</td>
                    <td>çµ„æˆ + åŸå­é…ç½®</td>
                </tr>
                <tr>
                    <td><strong>ç‰¹å¾´é‡æ¬¡å…ƒ</strong></td>
                    <td>å›ºå®šï¼ˆ132æ¬¡å…ƒï¼‰</td>
                    <td>å¯å¤‰ï¼ˆãƒãƒ¼ãƒ‰æ•°ã«ä¾å­˜ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>å¤šå½¢ã®åŒºåˆ¥</strong></td>
                    <td>âŒ ä¸å¯èƒ½</td>
                    <td>âœ… å¯èƒ½</td>
                </tr>
                <tr>
                    <td><strong>å±€æ‰€ç’°å¢ƒ</strong></td>
                    <td>âŒ è€ƒæ…®ã—ãªã„</td>
                    <td>âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã§è€ƒæ…®</td>
                </tr>
                <tr>
                    <td><strong>è¨ˆç®—ã‚³ã‚¹ãƒˆ</strong></td>
                    <td>ä½ï¼ˆç§’å˜ä½ï¼‰</td>
                    <td>ä¸­ã€œé«˜ï¼ˆåˆ†å˜ä½ã€GPUæ¨å¥¨ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>ãƒ‡ãƒ¼ã‚¿è¦ä»¶</strong></td>
                    <td>ä½ï¼ˆ100-1000ã‚µãƒ³ãƒ—ãƒ«ï¼‰</td>
                    <td>ä¸­ã€œé«˜ï¼ˆ1000-10000ã‚µãƒ³ãƒ—ãƒ«ï¼‰</td>
                </tr>
            </tbody>
        </table>

        <h2 id="gnn-basics">1.3 GNNï¼ˆã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼‰ã®åŸºæœ¬åŸç†</h2>

        <h3>1.3.1 ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã®æ¦‚å¿µ</h3>

        <p>GNNã®æ ¸å¿ƒã¯<strong>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°</strong>ã§ã™ã€‚å„åŸå­ï¼ˆãƒãƒ¼ãƒ‰ï¼‰ã¯ã€è¿‘å‚åŸå­ã‹ã‚‰æƒ…å ±ã‚’é›†ç´„ã—ã€è‡ªèº«ã®è¡¨ç¾ã‚’æ›´æ–°ã—ã¾ã™ã€‚</p>

        <p><strong>æ•°å­¦çš„å®šå¼åŒ–</strong>:</p>

        <p>\[
        \mathbf{h}_i^{(k+1)} = \text{UPDATE}^{(k)} \left( \mathbf{h}_i^{(k)}, \text{AGGREGATE}^{(k)} \left( \{ \mathbf{h}_j^{(k)} : j \in \mathcal{N}(i) \} \right) \right)
        \]</p>

        <p>ã“ã“ã§ï¼š</p>
        <ul>
            <li>\( \mathbf{h}_i^{(k)} \): ãƒãƒ¼ãƒ‰ \( i \) ã®ç¬¬ \( k \) å±¤ã§ã®éš ã‚Œè¡¨ç¾</li>
            <li>\( \mathcal{N}(i) \): ãƒãƒ¼ãƒ‰ \( i \) ã®è¿‘å‚ãƒãƒ¼ãƒ‰é›†åˆ</li>
            <li>\( \text{AGGREGATE} \): è¿‘å‚æƒ…å ±ã®é›†ç´„é–¢æ•°ï¼ˆSUMã€MEANã€MAXç­‰ï¼‰</li>
            <li>\( \text{UPDATE} \): ãƒãƒ¼ãƒ‰è¡¨ç¾ã®æ›´æ–°é–¢æ•°ï¼ˆMLPã€GRUç­‰ï¼‰</li>
        </ul>

        <div class="mermaid">
graph LR
    subgraph "Layer k"
        A1[hâ‚â½áµâ¾]
        B1[hâ‚‚â½áµâ¾]
        C1[hâ‚ƒâ½áµâ¾]
        D1[hâ‚„â½áµâ¾]
    end

    subgraph "Message Passing"
        B1 --> M[AGGREGATE]
        C1 --> M
        D1 --> M
        A1 --> U[UPDATE]
        M --> U
    end

    subgraph "Layer k+1"
        A2[hâ‚â½áµâºÂ¹â¾]
    end

    U --> A2

    style M fill:#fff3e0
    style U fill:#e8f5e9
    style A2 fill:#e3f2fd
</div>

        <h3>1.3.2 ã‚·ãƒ³ãƒ—ãƒ«ãªGNNã®å®Ÿè£…</h3>

        <pre><code class="language-python"># Example 4: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã®æœ€å°å®Ÿè£…
import torch
import torch.nn as nn
import torch.nn.functional as F
from torch_geometric.nn import MessagePassing
from torch_geometric.utils import add_self_loops, degree

class SimpleGCNConv(MessagePassing):
    """ã‚·ãƒ³ãƒ—ãƒ«ãªGraph Convolutional Networkå±¤"""
    def __init__(self, in_channels, out_channels):
        super().__init__(aggr='add')  # "add"é›†ç´„
        self.lin = nn.Linear(in_channels, out_channels)

    def forward(self, x, edge_index):
        # ã‚¹ãƒ†ãƒƒãƒ—1: è‡ªå·±ãƒ«ãƒ¼ãƒ—è¿½åŠ ï¼ˆè‡ªåˆ†è‡ªèº«ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚‚è€ƒæ…®ï¼‰
        edge_index, _ = add_self_loops(edge_index, num_nodes=x.size(0))

        # ã‚¹ãƒ†ãƒƒãƒ—2: ç·šå½¢å¤‰æ›
        x = self.lin(x)

        # ã‚¹ãƒ†ãƒƒãƒ—3: æ¬¡æ•°ã«ã‚ˆã‚‹æ­£è¦åŒ–
        row, col = edge_index
        deg = degree(col, x.size(0), dtype=x.dtype)
        deg_inv_sqrt = deg.pow(-0.5)
        deg_inv_sqrt[deg_inv_sqrt == float('inf')] = 0
        norm = deg_inv_sqrt[row] * deg_inv_sqrt[col]

        # ã‚¹ãƒ†ãƒƒãƒ—4: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°
        return self.propagate(edge_index, x=x, norm=norm)

    def message(self, x_j, norm):
        # æ­£è¦åŒ–ã•ã‚ŒãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        return norm.view(-1, 1) * x_j

# ãƒ†ã‚¹ãƒˆ
conv = SimpleGCNConv(in_channels=2, out_channels=8)
h0 = data.x  # Hâ‚‚Oã®ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡ï¼ˆ3ãƒãƒ¼ãƒ‰ã€2æ¬¡å…ƒï¼‰

h1 = conv(h0, data.edge_index)
print(f"å…¥åŠ›å½¢çŠ¶: {h0.shape}")  # torch.Size([3, 2])
print(f"å‡ºåŠ›å½¢çŠ¶: {h1.shape}")  # torch.Size([3, 8])
print(f"ç¬¬1å±¤ã®å‡ºåŠ›ï¼ˆæœ€åˆã®ãƒãƒ¼ãƒ‰ï¼‰:\n{h1[0]}")
</code></pre>

        <h3>1.3.3 CGCNN vs MPNNï¼šã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®é•ã„</h3>

        <p><strong>CGCNNï¼ˆCrystal Graph Convolutional Neural Networksï¼‰</strong>ã¯çµæ™¶ææ–™ã«ç‰¹åŒ–ï¼š</p>
        <ul>
            <li><strong>å¯¾è±¡</strong>: çµæ™¶æ§‹é€ ï¼ˆå‘¨æœŸå¢ƒç•Œæ¡ä»¶ã‚ã‚Šï¼‰</li>
            <li><strong>ã‚¨ãƒƒã‚¸ç‰¹å¾´é‡</strong>: åŸå­é–“è·é›¢ã‚’é‡è¦–</li>
            <li><strong>é›†ç´„</strong>: ã‚¨ãƒƒã‚¸ã‚²ãƒ¼ãƒˆæ©Ÿæ§‹ã«ã‚ˆã‚‹ã‚½ãƒ•ãƒˆã‚¢ãƒ†ãƒ³ã‚·ãƒ§ãƒ³</li>
            <li><strong>é©ç”¨ä¾‹</strong>: Materials Projectã€OQMD</li>
        </ul>

        <p><strong>MPNNï¼ˆMessage Passing Neural Networksï¼‰</strong>ã¯æ±ç”¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ï¼š</p>
        <ul>
            <li><strong>å¯¾è±¡</strong>: åˆ†å­ã€ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã€çµæ™¶å…¨ã¦</li>
            <li><strong>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é–¢æ•°</strong>: ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½</li>
            <li><strong>é›†ç´„</strong>: SUMã€MEANã€MAXç­‰ã‚’é¸æŠ</li>
            <li><strong>é©ç”¨ä¾‹</strong>: QM9ã€ZINCã€ChEMBL</li>
        </ul>

        <table>
            <thead>
                <tr>
                    <th>ç‰¹å¾´</th>
                    <th>CGCNN</th>
                    <th>MPNN</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>è«–æ–‡</strong></td>
                    <td>Xie & Grossman (2018)</td>
                    <td>Gilmer et al. (2017)</td>
                </tr>
                <tr>
                    <td><strong>ä¸»ãªå¯¾è±¡</strong></td>
                    <td>çµæ™¶ææ–™</td>
                    <td>åˆ†å­ãƒ»çµæ™¶ä¸¡æ–¹</td>
                </tr>
                <tr>
                    <td><strong>ã‚¨ãƒƒã‚¸å‡¦ç†</strong></td>
                    <td>ã‚²ãƒ¼ãƒˆæ©Ÿæ§‹</td>
                    <td>æ±ç”¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é–¢æ•°</td>
                </tr>
                <tr>
                    <td><strong>é›†ç´„æ–¹æ³•</strong></td>
                    <td>é‡ã¿ä»˜ãSUM</td>
                    <td>SUM/MEAN/MAX</td>
                </tr>
                <tr>
                    <td><strong>å‘¨æœŸå¢ƒç•Œæ¡ä»¶</strong></td>
                    <td>âœ… è€ƒæ…®</td>
                    <td>âŒ æ¨™æº–ã§ã¯éå¯¾å¿œ</td>
                </tr>
            </tbody>
        </table>

        <h2 id="example">1.4 å®Ÿä¾‹ï¼šãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã¨ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã®åŒºåˆ¥</h2>

        <pre><code class="language-python"># Example 5: GNNã§ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã¨ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã‚’åŒºåˆ¥
from torch_geometric.data import Data
import numpy as np

def structure_to_graph(structure, cutoff=5.0):
    """pymatgenæ§‹é€ ã‹ã‚‰PyTorch Geometricã‚°ãƒ©ãƒ•ã‚’ä½œæˆ"""
    # ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡: åŸå­ç•ªå·
    x = torch.tensor([[site.specie.Z] for site in structure], dtype=torch.float)

    # ã‚¨ãƒƒã‚¸ãƒªã‚¹ãƒˆä½œæˆï¼ˆcutoffåŠå¾„å†…ã®è¿‘å‚ï¼‰
    edges = []
    edge_attrs = []

    for i, site_i in enumerate(structure):
        for j, site_j in enumerate(structure):
            if i != j:
                dist = structure.get_distance(i, j)
                if dist <= cutoff:
                    edges.append([i, j])
                    edge_attrs.append([dist])

    edge_index = torch.tensor(edges, dtype=torch.long).t().contiguous()
    edge_attr = torch.tensor(edge_attrs, dtype=torch.float)

    return Data(x=x, edge_index=edge_index, edge_attr=edge_attr)

# ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã¨ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã‚’ã‚°ãƒ©ãƒ•åŒ–
graph_diamond = structure_to_graph(diamond, cutoff=2.0)
graph_graphite = structure_to_graph(graphite, cutoff=2.0)

print("ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã®ã‚°ãƒ©ãƒ•:")
print(f"  ãƒãƒ¼ãƒ‰æ•°: {graph_diamond.num_nodes}")
print(f"  ã‚¨ãƒƒã‚¸æ•°: {graph_diamond.num_edges}")
print(f"  å¹³å‡æ¬¡æ•°: {graph_diamond.num_edges / graph_diamond.num_nodes:.2f}")

print("\nã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã®ã‚°ãƒ©ãƒ•:")
print(f"  ãƒãƒ¼ãƒ‰æ•°: {graph_graphite.num_nodes}")
print(f"  ã‚¨ãƒƒã‚¸æ•°: {graph_graphite.num_edges}")
print(f"  å¹³å‡æ¬¡æ•°: {graph_graphite.num_edges / graph_graphite.num_nodes:.2f}")

# å‡ºåŠ›ä¾‹:
# ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰: å¹³å‡æ¬¡æ•° 4.00ï¼ˆspÂ³ã€æ­£å››é¢ä½“ï¼‰
# ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆ: å¹³å‡æ¬¡æ•° 3.00ï¼ˆspÂ²ã€å¹³é¢ä¸‰è§’å½¢ï¼‰
# â†’ ã‚°ãƒ©ãƒ•æ§‹é€ ã‹ã‚‰åŒºåˆ¥å¯èƒ½ï¼
</code></pre>

        <h2 id="pytorch-geometric">1.5 PyTorch Geometricã®åŸºç¤</h2>

        <h3>1.5.1 Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®è©³ç´°</h3>

        <pre><code class="language-python"># Example 6: PyTorch Geometric Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®å±æ€§
from torch_geometric.data import Data

# ã‚ˆã‚Šè¤‡é›‘ãªä¾‹ï¼šCOâ‚‚åˆ†å­
# O=C=Oï¼ˆç·šå½¢æ§‹é€ ï¼‰

node_features = torch.tensor([
    [8, 3.44, 6],   # O1: åŸå­ç•ªå·ã€é›»æ°—é™°æ€§åº¦ã€ä¾¡é›»å­æ•°
    [6, 2.55, 4],   # C:  åŸå­ç•ªå·ã€é›»æ°—é™°æ€§åº¦ã€ä¾¡é›»å­æ•°
    [8, 3.44, 6]    # O2: åŸå­ç•ªå·ã€é›»æ°—é™°æ€§åº¦ã€ä¾¡é›»å­æ•°
], dtype=torch.float)

edge_index = torch.tensor([
    [0, 1, 1, 0, 1, 2, 2, 1],
    [1, 0, 0, 1, 2, 1, 1, 2]
], dtype=torch.long)

edge_attr = torch.tensor([
    [1.16, 2],  # O1-C: è·é›¢ï¼ˆÃ…ï¼‰ã€çµåˆæ¬¡æ•°ï¼ˆäºŒé‡çµåˆï¼‰
    [1.16, 2],  # C-O1
    [1.16, 2],  # O1-Cï¼ˆé€†æ–¹å‘ï¼‰
    [1.16, 2],  # C-O1ï¼ˆé€†æ–¹å‘ï¼‰
    [1.16, 2],  # C-O2
    [1.16, 2],  # O2-C
    [1.16, 2],  # C-O2ï¼ˆé€†æ–¹å‘ï¼‰
    [1.16, 2]   # O2-Cï¼ˆé€†æ–¹å‘ï¼‰
], dtype=torch.float)

# ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤: åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼ˆDebyeï¼‰
y = torch.tensor([[0.0]], dtype=torch.float)  # COâ‚‚ã¯å¯¾ç§°ãªã®ã§0

data_co2 = Data(x=node_features, edge_index=edge_index,
                edge_attr=edge_attr, y=y)

print("COâ‚‚åˆ†å­ã®ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿:")
print(f"  ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡å½¢çŠ¶: {data_co2.x.shape}")        # [3, 3]
print(f"  ã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å½¢çŠ¶: {data_co2.edge_index.shape}")  # [2, 8]
print(f"  ã‚¨ãƒƒã‚¸ç‰¹å¾´é‡å½¢çŠ¶: {data_co2.edge_attr.shape}")     # [8, 2]
print(f"  ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤: {data_co2.y.item():.2f} Debye")
print(f"  æœ‰å‘ã‚°ãƒ©ãƒ•: {data_co2.is_directed()}")  # True
</code></pre>

        <h3>1.5.2 DataLoaderã¨ãƒãƒƒãƒå‡¦ç†</h3>

        <pre><code class="language-python"># Example 7: ãƒãƒƒãƒå‡¦ç†ã®å®Ÿè£…
from torch_geometric.loader import DataLoader
from torch_geometric.data import Batch

# è¤‡æ•°ã®åˆ†å­ãƒ‡ãƒ¼ã‚¿ã‚’ä½œæˆ
molecules = [data, data_co2]  # Hâ‚‚Oã¨COâ‚‚

# DataLoaderä½œæˆ
loader = DataLoader(molecules, batch_size=2, shuffle=True)

for batch in loader:
    print("ãƒãƒƒãƒãƒ‡ãƒ¼ã‚¿:")
    print(f"  ãƒãƒƒãƒã‚µã‚¤ã‚º: {batch.num_graphs}")
    print(f"  ç·ãƒãƒ¼ãƒ‰æ•°: {batch.num_nodes}")
    print(f"  ç·ã‚¨ãƒƒã‚¸æ•°: {batch.num_edges}")
    print(f"  ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡å½¢çŠ¶: {batch.x.shape}")
    print(f"  ãƒãƒƒãƒãƒ™ã‚¯ãƒˆãƒ«: {batch.batch}")
    # ãƒãƒƒãƒãƒ™ã‚¯ãƒˆãƒ«ä¾‹: tensor([0, 0, 0, 1, 1, 1])
    # â†’ æœ€åˆã®3ãƒãƒ¼ãƒ‰ã¯åˆ†å­0ã€æ¬¡ã®3ãƒãƒ¼ãƒ‰ã¯åˆ†å­1
    break

# ãƒãƒƒãƒå‡¦ç†ã®åˆ©ç‚¹
print("\nâœ… ãƒãƒƒãƒå‡¦ç†ã®åˆ©ç‚¹:")
print("  1. GPUä¸¦åˆ—åŒ–ã«ã‚ˆã‚‹é«˜é€ŸåŒ–")
print("  2. ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã®å‘ä¸Š")
print("  3. ãƒŸãƒ‹ãƒãƒƒãƒå‹¾é…é™ä¸‹æ³•ã®é©ç”¨")
</code></pre>

        <h3>1.5.3 ã‚°ãƒ©ãƒ•ãƒ—ãƒ¼ãƒªãƒ³ã‚°ï¼šåˆ†å­ãƒ¬ãƒ™ãƒ«ã®è¡¨ç¾</h3>

        <pre><code class="language-python"># Example 8: ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒ—ãƒ¼ãƒªãƒ³ã‚°
from torch_geometric.nn import global_mean_pool, global_max_pool, global_add_pool

# ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡ã‹ã‚‰ã‚°ãƒ©ãƒ•ãƒ¬ãƒ™ãƒ«ã®è¡¨ç¾ã‚’ä½œæˆ
batch = Batch.from_data_list(molecules)

# å¹³å‡ãƒ—ãƒ¼ãƒªãƒ³ã‚°
graph_emb_mean = global_mean_pool(batch.x, batch.batch)
print(f"å¹³å‡ãƒ—ãƒ¼ãƒªãƒ³ã‚°å‡ºåŠ›å½¢çŠ¶: {graph_emb_mean.shape}")  # [2, feature_dim]

# æœ€å¤§ãƒ—ãƒ¼ãƒªãƒ³ã‚°
graph_emb_max = global_max_pool(batch.x, batch.batch)
print(f"æœ€å¤§ãƒ—ãƒ¼ãƒªãƒ³ã‚°å‡ºåŠ›å½¢çŠ¶: {graph_emb_max.shape}")

# åˆè¨ˆãƒ—ãƒ¼ãƒªãƒ³ã‚°
graph_emb_sum = global_add_pool(batch.x, batch.batch)
print(f"åˆè¨ˆãƒ—ãƒ¼ãƒªãƒ³ã‚°å‡ºåŠ›å½¢çŠ¶: {graph_emb_sum.shape}")

print("\nãƒ—ãƒ¼ãƒªãƒ³ã‚°æ‰‹æ³•ã®ä½¿ã„åˆ†ã‘:")
print("  - å¹³å‡ãƒ—ãƒ¼ãƒªãƒ³ã‚°: åˆ†å­ã‚µã‚¤ã‚ºã«ä¸å¤‰ï¼ˆæ¨å¥¨ï¼‰")
print("  - æœ€å¤§ãƒ—ãƒ¼ãƒªãƒ³ã‚°: æœ€ã‚‚é‡è¦ãªåŸå­ã‚’å¼·èª¿")
print("  - åˆè¨ˆãƒ—ãƒ¼ãƒªãƒ³ã‚°: åˆ†å­ã‚µã‚¤ã‚ºã«ä¾å­˜ï¼ˆåŠ æ³•çš„ç‰¹æ€§å‘ãï¼‰")
</code></pre>

        <h2 id="summary">1.6 ã¾ã¨ã‚</h2>

        <p>ã“ã®ç« ã§ã¯ã€GNNæ§‹é€ ãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®åŸºç¤ã‚’å­¦ã³ã¾ã—ãŸï¼š</p>

        <ol>
            <li><strong>çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®é™ç•Œ</strong>: ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã¨ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã‚’åŒºåˆ¥ã§ããªã„</li>
            <li><strong>ã‚°ãƒ©ãƒ•è¡¨ç¾ã®å¼·ã¿</strong>: åŸå­é…ç½®ã‚’æ•°å­¦çš„ã«è¨˜è¿°</li>
            <li><strong>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°</strong>: GNNã®æ ¸å¿ƒçš„ãªè¨ˆç®—ãƒ—ãƒ­ã‚»ã‚¹</li>
            <li><strong>CGCNN vs MPNN</strong>: çµæ™¶ç‰¹åŒ– vs æ±ç”¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</li>
            <li><strong>PyTorch Geometric</strong>: ã‚°ãƒ©ãƒ•æ·±å±¤å­¦ç¿’ã®å®Ÿè£…åŸºç›¤</li>
        </ol>

        <p>æ¬¡ç« ã§ã¯ã€CGCNNã®è©³ç´°ãªå®Ÿè£…ã¨Materials Projectã§ã®çµæ™¶ç‰©æ€§äºˆæ¸¬ã‚’å­¦ã³ã¾ã™ã€‚</p>

        <hr>

        <h2 id="exercises">æ¼”ç¿’å•é¡Œ</h2>

        <h3>Easyï¼ˆåŸºç¤ç¢ºèªï¼‰</h3>

        <details>
            <summary><strong>Q1</strong>: çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ãŒæ‰ãˆã‚‰ã‚Œãªã„æƒ…å ±ã¯ä½•ã§ã™ã‹ï¼Ÿ</summary>

            <p><strong>æ­£è§£</strong>: åŸå­ã®ç©ºé–“é…ç½®ï¼ˆæ§‹é€ æƒ…å ±ï¼‰</p>

            <p><strong>è§£èª¬</strong>:</p>
            <p>çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ï¼ˆMagpieç­‰ï¼‰ã¯ã€åŒ–å­¦çµ„æˆï¼ˆFeâ‚‚Oâ‚ƒç­‰ï¼‰ã‹ã‚‰çµ±è¨ˆçš„ç‰¹å¾´é‡ã‚’è¨ˆç®—ã—ã¾ã™ãŒã€ä»¥ä¸‹ã‚’ä¸€åˆ‡è€ƒæ…®ã—ã¾ã›ã‚“ï¼š</p>
            <ul>
                <li>åŸå­ã®3Dåº§æ¨™</li>
                <li>çµåˆé•·ã€çµåˆè§’</li>
                <li>çµæ™¶æ§‹é€ ï¼ˆfccã€bccç­‰ï¼‰</li>
                <li>å±€æ‰€ç’°å¢ƒï¼ˆé…ä½æ•°ã€é…ä½å¤šé¢ä½“ï¼‰</li>
            </ul>
            <p>ã“ã®ãŸã‚ã€ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã¨ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆï¼ˆä¸¡æ–¹ã¨ã‚‚ç´”ç‚­ç´ ï¼‰ã‚’åŒºåˆ¥ã§ãã¾ã›ã‚“ã€‚</p>
        </details>

        <details>
            <summary><strong>Q2</strong>: PyTorch Geometricã®Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã€ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡ã‚’æ ¼ç´ã™ã‚‹å±æ€§ã¯ä½•ã§ã™ã‹ï¼Ÿ</summary>

            <p><strong>æ­£è§£</strong>: <code>x</code></p>

            <p><strong>è§£èª¬</strong>:</p>
            <p>PyTorch Geometric Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸»è¦å±æ€§ï¼š</p>
            <ul>
                <li><code>data.x</code>: ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡ï¼ˆå½¢çŠ¶: [num_nodes, num_features]ï¼‰</li>
                <li><code>data.edge_index</code>: ã‚¨ãƒƒã‚¸ãƒªã‚¹ãƒˆï¼ˆå½¢çŠ¶: [2, num_edges]ï¼‰</li>
                <li><code>data.edge_attr</code>: ã‚¨ãƒƒã‚¸ç‰¹å¾´é‡ï¼ˆå½¢çŠ¶: [num_edges, num_edge_features]ï¼‰</li>
                <li><code>data.y</code>: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ï¼ˆäºˆæ¸¬ã—ãŸã„ç‰©æ€§ï¼‰</li>
            </ul>
        </details>

        <details>
            <summary><strong>Q3</strong>: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã®3ã¤ã®ä¸»è¦ã‚¹ãƒ†ãƒƒãƒ—ã¯ä½•ã§ã™ã‹ï¼Ÿ</summary>

            <p><strong>æ­£è§£</strong>: Messageï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ç”Ÿæˆï¼‰ã€Aggregateï¼ˆé›†ç´„ï¼‰ã€Updateï¼ˆæ›´æ–°ï¼‰</p>

            <p><strong>è§£èª¬</strong>:</p>
            <ol>
                <li><strong>Message</strong>: å„ã‚¨ãƒƒã‚¸ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç”Ÿæˆ
                    <ul><li>ä¾‹: \( m_{ij} = \text{MLP}(\mathbf{h}_j, \mathbf{e}_{ij}) \)</li></ul>
                </li>
                <li><strong>Aggregate</strong>: è¿‘å‚ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é›†ç´„
                    <ul><li>ä¾‹: \( m_i = \sum_{j \in \mathcal{N}(i)} m_{ij} \)</li></ul>
                </li>
                <li><strong>Update</strong>: ãƒãƒ¼ãƒ‰è¡¨ç¾ã‚’æ›´æ–°
                    <ul><li>ä¾‹: \( \mathbf{h}_i^{(k+1)} = \text{GRU}(\mathbf{h}_i^{(k)}, m_i) \)</li></ul>
                </li>
            </ol>
        </details>

        <h3>Mediumï¼ˆå¿œç”¨ï¼‰</h3>

        <details>
            <summary><strong>Q4</strong>: ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã¨ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã®ã‚°ãƒ©ãƒ•æ§‹é€ ã®é•ã„ã‚’ã€å¹³å‡æ¬¡æ•°ã‚’ç”¨ã„ã¦èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>æ­£è§£</strong>: ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ï¼ˆå¹³å‡æ¬¡æ•° â‰ˆ 4.0ï¼‰vs ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆï¼ˆå¹³å‡æ¬¡æ•° â‰ˆ 3.0ï¼‰</p>

            <p><strong>è§£èª¬</strong>:</p>
            <ul>
                <li><strong>ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰</strong>:
                    <ul>
                        <li>spÂ³æ··æˆè»Œé“</li>
                        <li>å„ç‚­ç´ åŸå­ãŒ4ã¤ã®éš£æ¥åŸå­ã¨çµåˆ</li>
                        <li>æ­£å››é¢ä½“æ§‹é€ </li>
                        <li>å¹³å‡æ¬¡æ•° â‰ˆ 4.0</li>
                    </ul>
                </li>
                <li><strong>ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆ</strong>:
                    <ul>
                        <li>spÂ²æ··æˆè»Œé“</li>
                        <li>å„ç‚­ç´ åŸå­ãŒ3ã¤ã®éš£æ¥åŸå­ã¨çµåˆ</li>
                        <li>å¹³é¢ä¸‰è§’å½¢æ§‹é€ ï¼ˆå±¤çŠ¶ï¼‰</li>
                        <li>å¹³å‡æ¬¡æ•° â‰ˆ 3.0</li>
                    </ul>
                </li>
            </ul>
            <p>ã“ã®æ¬¡æ•°ã®é•ã„ã‚’GNNã¯å­¦ç¿’ã—ã€ä¸¡è€…ã‚’åŒºåˆ¥ã§ãã¾ã™ã€‚</p>
        </details>

        <details>
            <summary><strong>Q5</strong>: CGCNNãŒMPNNã¨æ¯”è¼ƒã—ã¦çµæ™¶ææ–™ã«é©ã—ã¦ã„ã‚‹ç†ç”±ã‚’2ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>æ­£è§£</strong>: (1) å‘¨æœŸå¢ƒç•Œæ¡ä»¶ã®è€ƒæ…®ã€(2) ã‚¨ãƒƒã‚¸ã‚²ãƒ¼ãƒˆæ©Ÿæ§‹</p>

            <p><strong>è§£èª¬</strong>:</p>
            <ol>
                <li><strong>å‘¨æœŸå¢ƒç•Œæ¡ä»¶</strong>:
                    <ul>
                        <li>çµæ™¶ã¯ç„¡é™ã«ç¹°ã‚Šè¿”ã•ã‚Œã‚‹å‘¨æœŸæ§‹é€ </li>
                        <li>CGCNNã¯å˜ä½æ ¼å­å†…ã®åŸå­ã¨ã€å‘¨æœŸçš„ã«ç¹°ã‚Šè¿”ã•ã‚Œã‚‹è¿‘å‚åŸå­ã‚‚è€ƒæ…®</li>
                        <li>MPNNã¯æ¨™æº–ã§ã¯éå‘¨æœŸçš„ï¼ˆåˆ†å­å‘ã‘ï¼‰</li>
                    </ul>
                </li>
                <li><strong>ã‚¨ãƒƒã‚¸ã‚²ãƒ¼ãƒˆæ©Ÿæ§‹</strong>:
                    <ul>
                        <li>åŸå­é–“è·é›¢ã«å¿œã˜ãŸé‡ã¿ä»˜ã‘</li>
                        <li>é ã„åŸå­ã‹ã‚‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æŠ‘åˆ¶</li>
                        <li>çµæ™¶ã®å±€æ‰€ç’°å¢ƒã‚’é©åˆ‡ã«ãƒ¢ãƒ‡ãƒ«åŒ–</li>
                    </ul>
                </li>
            </ol>
        </details>

        <details>
            <summary><strong>Q6</strong>: PyTorch Geometricã§COâ‚‚åˆ†å­ï¼ˆO=C=Oï¼‰ã®ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡ã¯åŸå­ç•ªå·ã®ã¿ã¨ã—ã¾ã™ã€‚</summary>

            <p><strong>è§£ç­”ä¾‹</strong>:</p>
            <pre><code class="language-python">import torch
from torch_geometric.data import Data

# ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡: åŸå­ç•ªå·
x = torch.tensor([[8], [6], [8]], dtype=torch.float)  # O, C, O

# ã‚¨ãƒƒã‚¸ãƒªã‚¹ãƒˆï¼ˆç„¡å‘ã‚°ãƒ©ãƒ•ï¼‰
edge_index = torch.tensor([
    [0, 1, 1, 2],  # O-C, C-O, C-O, O-C
    [1, 0, 2, 1]
], dtype=torch.long)

data_co2 = Data(x=x, edge_index=edge_index)
print(data_co2)
</code></pre>

            <p><strong>è§£èª¬</strong>:</p>
            <ul>
                <li>ãƒãƒ¼ãƒ‰0: Oï¼ˆåŸå­ç•ªå·8ï¼‰</li>
                <li>ãƒãƒ¼ãƒ‰1: Cï¼ˆåŸå­ç•ªå·6ï¼‰</li>
                <li>ãƒãƒ¼ãƒ‰2: Oï¼ˆåŸå­ç•ªå·8ï¼‰</li>
                <li>ã‚¨ãƒƒã‚¸: O-C, C-Oï¼ˆç„¡å‘ã‚°ãƒ©ãƒ•ãªã®ã§åŒæ–¹å‘ï¼‰</li>
            </ul>
        </details>

        <h3>Hardï¼ˆç™ºå±•ï¼‰</h3>

        <details>
            <summary><strong>Q7</strong>: çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã¨GNNç‰¹å¾´é‡ã®ãƒ‡ãƒ¼ã‚¿åŠ¹ç‡æ€§ã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚å°‘é‡ãƒ‡ãƒ¼ã‚¿ï¼ˆ100ã‚µãƒ³ãƒ—ãƒ«ï¼‰ã¨å¤§é‡ãƒ‡ãƒ¼ã‚¿ï¼ˆ10,000ã‚µãƒ³ãƒ—ãƒ«ï¼‰ã§ã©ã¡ã‚‰ãŒæœ‰åˆ©ã‹ã€ç†ç”±ã¨ã¨ã‚‚ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>

            <p><strong>å°‘é‡ãƒ‡ãƒ¼ã‚¿ï¼ˆ100ã‚µãƒ³ãƒ—ãƒ«ï¼‰</strong>: çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ãŒæœ‰åˆ©</p>
            <ul>
                <li><strong>ç†ç”±1</strong>: å›ºå®šæ¬¡å…ƒï¼ˆ132æ¬¡å…ƒï¼‰ã§éå­¦ç¿’ã—ã«ãã„</li>
                <li><strong>ç†ç”±2</strong>: ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜ï¼ˆé›»æ°—é™°æ€§åº¦ã€ã‚¤ã‚ªãƒ³åŠå¾„ç­‰ï¼‰ãŒçµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹</li>
                <li><strong>ç†ç”±3</strong>: ç·šå½¢ãƒ¢ãƒ‡ãƒ«ï¼ˆRidgeã€Lassoï¼‰ã§ã‚‚é«˜ç²¾åº¦</li>
            </ul>

            <p><strong>å¤§é‡ãƒ‡ãƒ¼ã‚¿ï¼ˆ10,000ã‚µãƒ³ãƒ—ãƒ«ï¼‰</strong>: GNNç‰¹å¾´é‡ãŒæœ‰åˆ©</p>
            <ul>
                <li><strong>ç†ç”±1</strong>: æ§‹é€ æƒ…å ±ã‚’æ´»ç”¨ã—ã€çµ„æˆãƒ™ãƒ¼ã‚¹ã‚ˆã‚Šé«˜ç²¾åº¦</li>
                <li><strong>ç†ç”±2</strong>: æ·±å±¤å­¦ç¿’ã®è¡¨ç¾åŠ›ã‚’ãƒ•ãƒ«æ´»ç”¨ã§ãã‚‹</li>
                <li><strong>ç†ç”±3</strong>: è»¢ç§»å­¦ç¿’ï¼ˆäº‹å‰å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ï¼‰ã§ã•ã‚‰ã«ç²¾åº¦å‘ä¸Š</li>
            </ul>

            <p><strong>å®šé‡çš„æ¯”è¼ƒï¼ˆMaterials Projectãƒ‡ãƒ¼ã‚¿ï¼‰</strong>:</p>
            <table>
                <thead>
                    <tr>
                        <th>ãƒ‡ãƒ¼ã‚¿é‡</th>
                        <th>çµ„æˆãƒ™ãƒ¼ã‚¹ï¼ˆMAEï¼‰</th>
                        <th>GNNï¼ˆMAEï¼‰</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>100ã‚µãƒ³ãƒ—ãƒ«</td>
                        <td>0.25 eV/atom</td>
                        <td>0.35 eV/atomï¼ˆéå­¦ç¿’ï¼‰</td>
                    </tr>
                    <tr>
                        <td>1,000ã‚µãƒ³ãƒ—ãƒ«</td>
                        <td>0.18 eV/atom</td>
                        <td>0.15 eV/atom</td>
                    </tr>
                    <tr>
                        <td>10,000ã‚µãƒ³ãƒ—ãƒ«</td>
                        <td>0.15 eV/atom</td>
                        <td>0.08 eV/atom â­</td>
                    </tr>
                </tbody>
            </table>
        </details>

        <details>
            <summary><strong>Q8</strong>: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã®é›†ç´„é–¢æ•°ï¼ˆSUMã€MEANã€MAXï¼‰ã®ç‰¹æ€§ã‚’æ¯”è¼ƒã—ã€ãã‚Œãã‚ŒãŒé©ã™ã‚‹çŠ¶æ³ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>

            <table>
                <thead>
                    <tr>
                        <th>é›†ç´„é–¢æ•°</th>
                        <th>æ•°å¼</th>
                        <th>ç‰¹æ€§</th>
                        <th>é©ã™ã‚‹çŠ¶æ³</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>SUM</strong></td>
                        <td>\( \sum_{j \in \mathcal{N}(i)} m_{ij} \)</td>
                        <td>åŠ æ³•çš„ã€æ¬¡æ•°ä¾å­˜</td>
                        <td>åŒ–å­¦é‡è«–çš„ç‰¹æ€§ï¼ˆè³ªé‡ã€é›»è·ï¼‰</td>
                    </tr>
                    <tr>
                        <td><strong>MEAN</strong></td>
                        <td>\( \frac{1}{|\mathcal{N}(i)|} \sum_{j} m_{ij} \)</td>
                        <td>æ­£è¦åŒ–ã€æ¬¡æ•°ä¸å¤‰</td>
                        <td>å±€æ‰€ç’°å¢ƒã®å¹³å‡çš„ç‰¹æ€§ï¼ˆé›»æ°—é™°æ€§åº¦ï¼‰</td>
                    </tr>
                    <tr>
                        <td><strong>MAX</strong></td>
                        <td>\( \max_{j \in \mathcal{N}(i)} m_{ij} \)</td>
                        <td>æœ€å¤§å€¤æŠ½å‡º</td>
                        <td>æœ€ã‚‚é‡è¦ãªç‰¹å¾´ã‚’å¼·èª¿ï¼ˆæ´»æ€§éƒ¨ä½æ¤œå‡ºï¼‰</td>
                    </tr>
                </tbody>
            </table>

            <p><strong>å®Ÿè·µçš„æ¨å¥¨</strong>:</p>
            <ul>
                <li><strong>MEAN</strong>: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æ¨å¥¨ï¼ˆæ¬¡æ•°ã«ä¸å¤‰ã€å®‰å®šã—ãŸå­¦ç¿’ï¼‰</li>
                <li><strong>SUM</strong>: åŠ æ³•çš„ç‰¹æ€§ã‚’äºˆæ¸¬ã™ã‚‹å ´åˆ</li>
                <li><strong>MAX</strong>: å±€æ‰€çš„ãªç•°å¸¸æ¤œå‡ºã€è§¦åª’æ´»æ€§éƒ¨ä½ã®ç‰¹å®š</li>
            </ul>
        </details>

        <details>
            <summary><strong>Q9</strong>: çµæ™¶ææ–™ã®ã‚°ãƒ©ãƒ•è¡¨ç¾ã«ãŠã„ã¦ã€ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„ã®é¸æŠãŒäºˆæ¸¬ç²¾åº¦ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’è€ƒå¯Ÿã—ã¦ãã ã•ã„ã€‚ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„ãŒçŸ­ã™ãã‚‹å ´åˆã¨é•·ã™ãã‚‹å ´åˆã®å•é¡Œç‚¹ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</summary>

            <p><strong>è§£ç­”</strong>:</p>

            <p><strong>ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„ãŒçŸ­ã™ãã‚‹å ´åˆï¼ˆä¾‹: 2Ã…ï¼‰</strong>:</p>
            <ul>
                <li><strong>å•é¡Œ1</strong>: ç¬¬ä¸€è¿‘æ¥ã®ã¿è€ƒæ…®ã€é•·è·é›¢ç›¸äº’ä½œç”¨ã‚’ç„¡è¦–</li>
                <li><strong>å•é¡Œ2</strong>: ã‚¨ãƒƒã‚¸æ•°ãŒå°‘ãªãã€æƒ…å ±ä¼æ’­ãŒé…ã„</li>
                <li><strong>å•é¡Œ3</strong>: å¤šå±¤GNNãŒå¿…è¦ï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆå¢—ï¼‰</li>
                <li><strong>ä¾‹</strong>: ã‚¤ã‚ªãƒ³çµæ™¶ã®ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨ï¼ˆé•·è·é›¢ï¼‰ã‚’æ‰ãˆã‚‰ã‚Œãªã„</li>
            </ul>

            <p><strong>ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„ãŒé•·ã™ãã‚‹å ´åˆï¼ˆä¾‹: 10Ã…ï¼‰</strong>:</p>
            <ul>
                <li><strong>å•é¡Œ1</strong>: ã‚¨ãƒƒã‚¸æ•°çˆ†ç™ºçš„å¢—åŠ ï¼ˆO(NÂ²)ï¼‰</li>
                <li><strong>å•é¡Œ2</strong>: ãƒ¡ãƒ¢ãƒªæ¯æ¸‡ã€è¨ˆç®—æ™‚é–“å¢—å¤§</li>
                <li><strong>å•é¡Œ3</strong>: ãƒã‚¤ã‚ºå¢—åŠ ï¼ˆé ã„åŸå­ã®å½±éŸ¿ã‚’éå¤§è©•ä¾¡ï¼‰</li>
                <li><strong>å•é¡Œ4</strong>: éå­¦ç¿’ã®ãƒªã‚¹ã‚¯å¢—å¤§</li>
            </ul>

            <p><strong>æœ€é©ãªã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„ã®é¸æŠ</strong>:</p>
            <table>
                <thead>
                    <tr>
                        <th>ææ–™ã‚¿ã‚¤ãƒ—</th>
                        <th>æ¨å¥¨ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„</th>
                        <th>ç†ç”±</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>å…±æœ‰çµåˆçµæ™¶ï¼ˆSiã€Diamondï¼‰</td>
                        <td>4-5Ã…</td>
                        <td>ç¬¬äºŒè¿‘æ¥ã¾ã§è€ƒæ…®</td>
                    </tr>
                    <tr>
                        <td>ã‚¤ã‚ªãƒ³çµæ™¶ï¼ˆNaClã€MgOï¼‰</td>
                        <td>6-8Ã…</td>
                        <td>é•·è·é›¢ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨</td>
                    </tr>
                    <tr>
                        <td>é‡‘å±ï¼ˆFeã€Cuï¼‰</td>
                        <td>5-6Ã…</td>
                        <td>ç¬¬ä¸‰è¿‘æ¥ã¾ã§è€ƒæ…®</td>
                    </tr>
                    <tr>
                        <td>åˆ†å­çµæ™¶</td>
                        <td>8-10Ã…</td>
                        <td>åˆ†å­é–“ç›¸äº’ä½œç”¨ï¼ˆãƒ•ã‚¡ãƒ³ãƒ‡ãƒ«ãƒ¯ãƒ¼ãƒ«ã‚¹åŠ›ï¼‰</td>
                    </tr>
                </tbody>
            </table>

            <p><strong>å®Ÿé¨“çš„æœ€é©åŒ–</strong>:</p>
            <pre><code class="language-python"># ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„ã®å½±éŸ¿ã‚’è©•ä¾¡
cutoffs = [3.0, 4.0, 5.0, 6.0, 8.0, 10.0]
for cutoff in cutoffs:
    graph = structure_to_graph(structure, cutoff=cutoff)
    print(f"Cutoff {cutoff}Ã…: {graph.num_edges} edges")
    # è¨“ç·´ã—ã¦ç²¾åº¦è©•ä¾¡
</code></pre>
        </details>

        <hr>

        <h2 id="objectives">å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

        <p>ã“ã®chapterã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’èª¬æ˜ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p>

        <h3>åŸºæœ¬ç†è§£</h3>
        <ul>
            <li>âœ… çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®3ã¤ã®é™ç•Œã‚’å…·ä½“ä¾‹ã¨ã¨ã‚‚ã«æŒ™ã’ã‚‰ã‚Œã‚‹</li>
            <li>âœ… ã‚°ãƒ©ãƒ•è¡¨ç¾ã®æ•°å­¦çš„å®šç¾©ï¼ˆ\( G = (V, E) \)ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã®3ã‚¹ãƒ†ãƒƒãƒ—ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            <li>âœ… CGCNN vs MPNNã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹</li>
        </ul>

        <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
        <ul>
            <li>âœ… PyTorch Geometricã§Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã§ãã‚‹</li>
            <li>âœ… pymatgenæ§‹é€ ã‹ã‚‰ã‚°ãƒ©ãƒ•ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
            <li>âœ… ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ã¨ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã‚’ã‚°ãƒ©ãƒ•æ§‹é€ ã§åŒºåˆ¥ã§ãã‚‹</li>
            <li>âœ… DataLoaderã§ãƒãƒƒãƒå‡¦ç†ã‚’å®Ÿè£…ã§ãã‚‹</li>
        </ul>

        <h3>å¿œç”¨åŠ›</h3>
        <ul>
            <li>âœ… æ–°ã—ã„ææ–™å•é¡Œã«å¯¾ã—ã¦çµ„æˆãƒ™ãƒ¼ã‚¹ vs GNNã‚’é¸æŠã§ãã‚‹</li>
            <li>âœ… ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„ã®æœ€é©å€¤ã‚’å®Ÿé¨“çš„ã«æ±ºå®šã§ãã‚‹</li>
            <li>âœ… ã‚°ãƒ©ãƒ•æ§‹é€ ã®ç‰¹æ€§ï¼ˆå¹³å‡æ¬¡æ•°ã€å¯†åº¦ï¼‰ã‹ã‚‰ææ–™ç‰¹æ€§ã‚’æ¨æ¸¬ã§ãã‚‹</li>
        </ul>

        <hr>

        <h2 id="next">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>

        <p>æ¬¡ç« ã§ã¯ã€CGCNNã®è©³ç´°ãªå®Ÿè£…ã¨Materials Projectã§ã®å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼äºˆæ¸¬ã‚’å­¦ã³ã¾ã™ã€‚</p>

        <div class="nav-buttons">
            <a href="./index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a>
            <a href="./chapter-2.html" class="nav-button">ç¬¬2ç« ï¼šCGCNNå®Ÿè£… â†’</a>
        </div>

        <hr>

        <h2 id="references">å‚è€ƒæ–‡çŒ®</h2>

        <ol>
            <li>Ward, L., Agrawal, A., Choudhary, A., & Wolverton, C. (2016). "A general-purpose machine learning framework for predicting properties of inorganic materials." <em>npj Computational Materials</em>, 2, 16028, pp. 1-7.</li>
            <li>Xie, T., & Grossman, J. C. (2018). "Crystal Graph Convolutional Neural Networks for an Accurate and Interpretable Prediction of Material Properties." <em>Physical Review Letters</em>, 120(14), 145301, pp. 1-6.</li>
            <li>Gilmer, J., Schoenholz, S. S., Riley, P. F., Vinyals, O., & Dahl, G. E. (2017). "Neural Message Passing for Quantum Chemistry." <em>Proceedings of the 34th International Conference on Machine Learning</em>, PMLR 70, pp. 1263-1272.</li>
            <li>Fey, M., & Lenssen, J. E. (2019). "Fast Graph Representation Learning with PyTorch Geometric." <em>ICLR Workshop on Representation Learning on Graphs and Manifolds</em>, pp. 1-9.</li>
            <li>Jain, A., Ong, S. P., Hautier, G., Chen, W., Richards, W. D., Dacek, S., ... & Persson, K. A. (2013). "Commentary: The Materials Project: A materials genome approach to accelerating materials innovation." <em>APL Materials</em>, 1(1), 011002, pp. 1-11.</li>
            <li>Ong, S. P., Richards, W. D., Jain, A., Hautier, G., Kocher, M., Cholia, S., ... & Persson, K. A. (2013). "Python Materials Genomics (pymatgen): A robust, open-source python library for materials analysis." <em>Computational Materials Science</em>, 68, pp. 314-319.</li>
            <li>SchÃ¼tt, K. T., Sauceda, H. E., Kindermans, P. J., Tkatchenko, A., & MÃ¼ller, K. R. (2018). "SchNet â€“ A deep learning architecture for molecules and materials." <em>The Journal of Chemical Physics</em>, 148(24), 241722, pp. 1-10.</li>
        </ol>

    </main>

    <footer>
        <div class="container">
            <p>&copy; 2025 AI Terakoya - Dr. Yusuke Hashimoto, Tohoku University</p>
            <p>Licensed under CC BY 4.0</p>
        </div>
    </footer>
</body>
</html>
