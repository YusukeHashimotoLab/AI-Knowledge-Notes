<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« : å¤šå¤‰æ•°é–¢æ•°ã®å¾®ç©åˆ† | å¾®ç©åˆ†ã¨ãƒ™ã‚¯ãƒˆãƒ«è§£æå…¥é–€</title>
    <meta name="description" content="åå¾®åˆ†ã€å…¨å¾®åˆ†ã€ãƒ¤ã‚³ãƒ“è¡Œåˆ—ã€é‡ç©åˆ†ã€ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã‚’å­¦ã³ã¾ã™ã€‚">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-block { background: #282c34; color: #abb2bf; padding: 1.5rem; border-radius: 8px; overflow-x: auto; margin: 1rem 0; font-size: 0.85rem;
            white-space: pre-wrap;
}
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
    </style>
</head>
<body>
    <header>
        <h1>ç¬¬3ç« : å¤šå¤‰æ•°é–¢æ•°ã®å¾®ç©åˆ†</h1>
        <p class="subtitle">Multivariable Calculus</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">å¾®ç©åˆ†ã¨ãƒ™ã‚¯ãƒˆãƒ«è§£æå…¥é–€</a> &gt;
            ç¬¬3ç« 
        </div>

        <div class="content">
            <h2>3.1 åå¾®åˆ†ã¨å…¨å¾®åˆ†</h2>

            <div class="definition">
                <strong>ğŸ“ å®šç¾©: åå¾®åˆ†</strong><br>
                å¤šå¤‰æ•°é–¢æ•° f(x, y) ã® x ã«é–¢ã™ã‚‹åå¾®åˆ†ã¯ï¼š
                $$\frac{\partial f}{\partial x} = \lim_{h \to 0} \frac{f(x+h, y) - f(x, y)}{h}$$
                ä»–ã®å¤‰æ•°ã‚’å›ºå®šã—ã¦ã€1ã¤ã®å¤‰æ•°ã®ã¿ã§å¾®åˆ†ã—ã¾ã™ã€‚
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹1: åå¾®åˆ†ã®æ•°å€¤è¨ˆç®—</h3>
            <div class="code-block">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

def f(x, y):
    """2å¤‰æ•°é–¢æ•°: f(x,y) = xÂ² + xy + yÂ²"""
    return x**2 + x*y + y**2

def partial_x(f, x, y, h=1e-5):
    """âˆ‚f/âˆ‚x ã®æ•°å€¤è¨ˆç®—"""
    return (f(x+h, y) - f(x-h, y)) / (2*h)

def partial_y(f, x, y, h=1e-5):
    """âˆ‚f/âˆ‚y ã®æ•°å€¤è¨ˆç®—"""
    return (f(x, y+h) - f(x, y-h)) / (2*h)

# ç‚¹ (1, 2) ã§ã®åå¾®åˆ†
x0, y0 = 1, 2
df_dx = partial_x(f, x0, y0)
df_dy = partial_y(f, x0, y0)

print(f"ç‚¹ ({x0}, {y0}) ã«ãŠã‘ã‚‹åå¾®åˆ†:")
print(f"âˆ‚f/âˆ‚x = {df_dx:.6f} (è§£æè§£: {2*x0 + y0})")
print(f"âˆ‚f/âˆ‚y = {df_dy:.6f} (è§£æè§£: {x0 + 2*y0})")

# 3Då¯è¦–åŒ–
x = np.linspace(-3, 3, 50)
y = np.linspace(-3, 3, 50)
X, Y = np.meshgrid(x, y)
Z = f(X, Y)

fig = plt.figure(figsize=(10, 8))
ax = fig.add_subplot(111, projection='3d')
ax.plot_surface(X, Y, Z, alpha=0.7, cmap='viridis')
ax.scatter([x0], [y0], [f(x0, y0)], color='red', s=100)
ax.set_xlabel('x')
ax.set_ylabel('y')
ax.set_zlabel('f(x,y)')
ax.set_title('f(x,y) = xÂ² + xy + yÂ²')
plt.show()</div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹2: SymPyã«ã‚ˆã‚‹åå¾®åˆ†</h3>
            <div class="code-block">import sympy as sp

x, y, z = sp.symbols('x y z')

# æ§˜ã€…ãªå¤šå¤‰æ•°é–¢æ•°ã®åå¾®åˆ†
f1 = x**2 + y**2
f2 = x*sp.exp(y)
f3 = sp.sin(x*y)
f4 = x**2 * y + y**2 * z + z**2 * x

functions = [f1, f2, f3, f4]

print("åå¾®åˆ†ã®ä¾‹:")
for f in functions:
    print(f"\nf = {f}")
    vars = list(f.free_symbols)
    for var in vars:
        print(f"  âˆ‚f/âˆ‚{var} = {sp.diff(f, var)}")</div>

            <h2>3.2 å‹¾é…ã¨ãƒ¤ã‚³ãƒ“è¡Œåˆ—</h2>

            <div class="definition">
                <strong>ğŸ“ å®šç¾©: å‹¾é…</strong><br>
                ã‚¹ã‚«ãƒ©ãƒ¼å ´ f(x, y, z) ã®å‹¾é…ã¯åå¾®åˆ†ã‚’æˆåˆ†ã¨ã™ã‚‹ãƒ™ã‚¯ãƒˆãƒ«ï¼š
                $$\nabla f = \left( \frac{\partial f}{\partial x}, \frac{\partial f}{\partial y}, \frac{\partial f}{\partial z} \right)$$
                å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ã¯é–¢æ•°ãŒæœ€ã‚‚æ€¥æ¿€ã«å¢—åŠ ã™ã‚‹æ–¹å‘ã‚’ç¤ºã—ã¾ã™ã€‚
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹3: å‹¾é…é™ä¸‹æ³•ã®å®Ÿè£…</h3>
            <div class="code-block">def gradient(f, x, y, h=1e-5):
    """å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ã®æ•°å€¤è¨ˆç®—"""
    grad_x = (f(x+h, y) - f(x-h, y)) / (2*h)
    grad_y = (f(x, y+h) - f(x, y-h)) / (2*h)
    return np.array([grad_x, grad_y])

def gradient_descent(f, x0, y0, learning_rate=0.1, n_iter=50):
    """å‹¾é…é™ä¸‹æ³•ã«ã‚ˆã‚‹æœ€å°å€¤æ¢ç´¢"""
    path = [(x0, y0)]
    x, y = x0, y0

    for i in range(n_iter):
        grad = gradient(f, x, y)
        x -= learning_rate * grad[0]
        y -= learning_rate * grad[1]
        path.append((x, y))

    return np.array(path)

# f(x,y) = xÂ² + yÂ² ã®æœ€å°å€¤ã‚’æ¢ç´¢
f_simple = lambda x, y: x**2 + y**2
path = gradient_descent(f_simple, x0=3, y0=2, learning_rate=0.2, n_iter=20)

print("å‹¾é…é™ä¸‹æ³•ã«ã‚ˆã‚‹æœ€å°å€¤æ¢ç´¢:")
print(f"é–‹å§‹ç‚¹: ({path[0,0]:.2f}, {path[0,1]:.2f})")
print(f"çµ‚äº†ç‚¹: ({path[-1,0]:.6f}, {path[-1,1]:.6f})")
print(f"æœ€å°å€¤: f = {f_simple(path[-1,0], path[-1,1]):.6f}")

# å¯è¦–åŒ–
x = np.linspace(-3, 3, 100)
y = np.linspace(-3, 3, 100)
X, Y = np.meshgrid(x, y)
Z = f_simple(X, Y)

plt.figure(figsize=(10, 8))
plt.contour(X, Y, Z, levels=20, cmap='viridis', alpha=0.6)
plt.colorbar(label='f(x,y)')
plt.plot(path[:,0], path[:,1], 'ro-', linewidth=2, markersize=6)
plt.scatter([path[0,0]], [path[0,1]], color='green', s=150, marker='*', label='é–‹å§‹ç‚¹')
plt.scatter([path[-1,0]], [path[-1,1]], color='red', s=150, marker='*', label='çµ‚äº†ç‚¹')
plt.xlabel('x')
plt.ylabel('y')
plt.title('å‹¾é…é™ä¸‹æ³•ã«ã‚ˆã‚‹æœ€é©åŒ–')
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()</div>

            <h2>3.3 ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•</h2>

            <div class="theorem">
                <strong>ğŸ“ å®šç†: ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•</strong><br>
                åˆ¶ç´„æ¡ä»¶ g(x, y) = 0 ã®ä¸‹ã§ f(x, y) ã‚’æœ€é©åŒ–ã™ã‚‹å•é¡Œã¯ã€
                ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥é–¢æ•° L(x, y, Î») = f(x, y) - Î»g(x, y) ã®åœç•™ç‚¹ã‚’æ±‚ã‚ã‚‹ã“ã¨ã«å¸°ç€ã•ã‚Œã¾ã™ã€‚
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹4: åˆ¶ç´„ä»˜ãæœ€é©åŒ–å•é¡Œ</h3>
            <div class="code-block">from scipy.optimize import minimize

# å•é¡Œ: xÂ² + yÂ² ã‚’æœ€å°åŒ–ã€åˆ¶ç´„ x + y = 1
def objective(X):
    x, y = X
    return x**2 + y**2

def constraint(X):
    x, y = X
    return x + y - 1  # x + y = 1

# åˆ¶ç´„æ¡ä»¶ã‚’è¾æ›¸å½¢å¼ã§æŒ‡å®š
cons = {'type': 'eq', 'fun': constraint}

# æœ€é©åŒ–å®Ÿè¡Œ
x0 = [0, 0]  # åˆæœŸå€¤
result = minimize(objective, x0, method='SLSQP', constraints=cons)

print("åˆ¶ç´„ä»˜ãæœ€é©åŒ–ã®çµæœ:")
print(f"æœ€é©è§£: x = {result.x[0]:.6f}, y = {result.x[1]:.6f}")
print(f"æœ€å°å€¤: f = {result.fun:.6f}")
print(f"åˆ¶ç´„ç¢ºèª: x + y = {result.x[0] + result.x[1]:.6f}")

# è§£æè§£ã¨ã®æ¯”è¼ƒï¼ˆã“ã®å•é¡Œã®è§£æè§£ã¯ x = y = 0.5ï¼‰
print(f"\nè§£æè§£: x = y = 0.5, f = 0.5")
print(f"èª¤å·®: {abs(result.x[0] - 0.5):.2e}")</div>

            <h2>3.4 é‡ç©åˆ†ï¼ˆäºŒé‡ç©åˆ†ãƒ»ä¸‰é‡ç©åˆ†ï¼‰</h2>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹5: äºŒé‡ç©åˆ†ã®æ•°å€¤è¨ˆç®—</h3>
            <div class="code-block">from scipy import integrate

# âˆ«âˆ«_D xy dxdy, D: 0 â‰¤ x â‰¤ 1, 0 â‰¤ y â‰¤ 2
def integrand(y, x):
    """è¢«ç©åˆ†é–¢æ•° f(x,y) = xy"""
    return x * y

# dblquad: äºŒé‡ç©åˆ†
result, error = integrate.dblquad(integrand,
                                   0, 1,      # x ã®ç¯„å›²
                                   0, 2)      # y ã®ç¯„å›²

print("äºŒé‡ç©åˆ†ã®è¨ˆç®—:")
print(f"âˆ«â‚€Â¹ âˆ«â‚€Â² xy dy dx = {result:.6f}")
print(f"è§£æè§£: [xÂ²/2]â‚€Â¹ Â· [yÂ²/2]â‚€Â² = 0.5 Â· 2 = 1.0")
print(f"æ¨å®šèª¤å·®: {error:.2e}")</div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹6: æ¥µåº§æ¨™å¤‰æ›ã«ã‚ˆã‚‹äºŒé‡ç©åˆ†</h3>
            <div class="code-block"># å††ç›¤ xÂ² + yÂ² â‰¤ 1 ä¸Šã§ã® âˆ«âˆ« (xÂ² + yÂ²) dxdy
# æ¥µåº§æ¨™å¤‰æ›: x = r cos Î¸, y = r sin Î¸, dxdy = r dr dÎ¸

def integrand_polar(theta, r):
    """æ¥µåº§æ¨™ã§ã®è¢«ç©åˆ†é–¢æ•°: rÂ² Â· r = rÂ³"""
    return r**3

# ç©åˆ†ç¯„å›²: 0 â‰¤ r â‰¤ 1, 0 â‰¤ Î¸ â‰¤ 2Ï€
result, error = integrate.dblquad(integrand_polar,
                                   0, 1,           # r ã®ç¯„å›²
                                   0, 2*np.pi)     # Î¸ ã®ç¯„å›²

print("\næ¥µåº§æ¨™å¤‰æ›ã«ã‚ˆã‚‹äºŒé‡ç©åˆ†:")
print(f"âˆ«âˆ«_D (xÂ² + yÂ²) dxdy = {result:.6f}")
print(f"è§£æè§£: âˆ«â‚€^2Ï€ dÎ¸ âˆ«â‚€Â¹ rÂ³ dr = 2Ï€ Â· [râ´/4]â‚€Â¹ = Ï€/2 â‰ˆ {np.pi/2:.6f}")
print(f"èª¤å·®: {abs(result - np.pi/2):.2e}")</div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹7: ææ–™ç§‘å­¦ã¸ã®å¿œç”¨ï¼ˆæ¿ƒåº¦åˆ†å¸ƒã®ç©åˆ†ï¼‰</h3>
            <div class="code-block"># å††å½¢ã‚¦ã‚§ãƒä¸Šã®ä¸ç´”ç‰©æ¿ƒåº¦åˆ†å¸ƒ
def concentration(r, theta):
    """
    æ¿ƒåº¦åˆ†å¸ƒ C(r,Î¸) [atoms/cmÂ³]
    ä¸­å¿ƒã‹ã‚‰é›¢ã‚Œã‚‹ã»ã©æ¿ƒåº¦ãŒæ¸›å°‘
    """
    r_max = 5.0  # ã‚¦ã‚§ãƒåŠå¾„ [cm]
    C0 = 1e15    # ä¸­å¿ƒæ¿ƒåº¦ [atoms/cmÂ³]
    return C0 * np.exp(-r**2 / r_max**2)

# ã‚¦ã‚§ãƒå…¨ä½“ã®ä¸ç´”ç‰©åŸå­æ•°ã‚’è¨ˆç®—
R = 5.0  # ã‚¦ã‚§ãƒåŠå¾„ [cm]

def integrand_concentration(theta, r):
    return concentration(r, theta) * r  # ãƒ¤ã‚³ãƒ“ã‚¢ãƒ³ r ã‚’æ›ã‘ã‚‹

total_atoms, error = integrate.dblquad(integrand_concentration,
                                        0, R,
                                        0, 2*np.pi)

print("\nææ–™ç§‘å­¦ã¸ã®å¿œç”¨:")
print(f"ã‚¦ã‚§ãƒåŠå¾„: {R} cm")
print(f"ä¸­å¿ƒæ¿ƒåº¦: {1e15:.2e} atoms/cmÂ³")
print(f"ç·ä¸ç´”ç‰©åŸå­æ•°: {total_atoms:.4e} atoms")
print(f"å¹³å‡æ¿ƒåº¦: {total_atoms / (np.pi * R**2):.4e} atoms/cmÂ³")

# æ¿ƒåº¦åˆ†å¸ƒã®å¯è¦–åŒ–
r_plot = np.linspace(0, R, 100)
theta_plot = np.linspace(0, 2*np.pi, 100)
R_grid, Theta_grid = np.meshgrid(r_plot, theta_plot)
C_grid = concentration(R_grid, Theta_grid)

# æ¥µåº§æ¨™ã‚’ãƒ‡ã‚«ãƒ«ãƒˆåº§æ¨™ã«å¤‰æ›
X_grid = R_grid * np.cos(Theta_grid)
Y_grid = R_grid * np.sin(Theta_grid)

plt.figure(figsize=(10, 8))
plt.contourf(X_grid, Y_grid, C_grid, levels=20, cmap='hot')
plt.colorbar(label='æ¿ƒåº¦ (atoms/cmÂ³)')
plt.xlabel('x (cm)')
plt.ylabel('y (cm)')
plt.title('ã‚¦ã‚§ãƒä¸Šã®ä¸ç´”ç‰©æ¿ƒåº¦åˆ†å¸ƒ')
plt.axis('equal')
plt.grid(True, alpha=0.3)
plt.show()</div>

            <h2>ã¾ã¨ã‚</h2>
            <ul>
                <li>åå¾®åˆ†ã¯å¤šå¤‰æ•°é–¢æ•°ã®å„å¤‰æ•°ã«ã‚ˆã‚‹å¤‰åŒ–ç‡ã‚’è¡¨ã™</li>
                <li>å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ã¯é–¢æ•°ãŒæœ€ã‚‚æ€¥æ¿€ã«å¢—åŠ ã™ã‚‹æ–¹å‘ã‚’ç¤ºã—ã€æœ€é©åŒ–ã«åˆ©ç”¨ã•ã‚Œã‚‹</li>
                <li>ãƒ©ã‚°ãƒ©ãƒ³ã‚¸ãƒ¥ã®æœªå®šä¹—æ•°æ³•ã«ã‚ˆã‚Šåˆ¶ç´„ä»˜ãæœ€é©åŒ–å•é¡Œã‚’è§£ã‘ã‚‹</li>
                <li>é‡ç©åˆ†ã¯å¤šå¤‰æ•°é–¢æ•°ã®ç´¯ç©é‡ã‚’è¨ˆç®—ã—ã€æ¥µåº§æ¨™å¤‰æ›ã«ã‚ˆã‚Šè¨ˆç®—ãŒç°¡å˜ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹</li>
                <li>ææ–™ç§‘å­¦ã§ã¯æ¿ƒåº¦åˆ†å¸ƒã€æ¸©åº¦åˆ†å¸ƒãªã©ã®ç©åˆ†è¨ˆç®—ã«å¿œç”¨ã•ã‚Œã‚‹</li>
            </ul>

            <div class="nav-buttons">
                <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« : ç©åˆ†ã®åŸºç¤</a>
                <a href="chapter-4.html" class="nav-button">ç¬¬4ç« : ãƒ™ã‚¯ãƒˆãƒ«å ´ â†’</a>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - åŸºç¤æ•°ç†é“å ´</p>
    </footer>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
