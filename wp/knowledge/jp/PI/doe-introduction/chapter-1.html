<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« ï¼šå®Ÿé¨“è¨ˆç”»æ³•ã®åŸºç¤ã¨ç›´äº¤è¡¨ - DOEå…¥é–€ã‚·ãƒªãƒ¼ã‚º</title>

        <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8; color: #333; background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; padding: 2rem 1rem; text-align: center;
        }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; font-size: 1.1rem; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
        .back-link {
            display: inline-block; margin-bottom: 2rem; padding: 0.5rem 1rem;
            background: white; color: #11998e; text-decoration: none;
            border-radius: 6px; font-weight: 600;
        }
        .content-box {
            background: white; padding: 2rem; border-radius: 12px;
            margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #11998e; margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem; border-bottom: 3px solid #11998e;
        }
        h3 { color: #2c3e50; margin: 1.5rem 0 1rem 0; }
        h4 { color: #2c3e50; margin: 1rem 0 0.5rem 0; }
        p { margin-bottom: 1rem; }
        ul, ol { margin-left: 2rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
        pre {
            background: #1e1e1e; color: #d4d4d4; padding: 1.5rem;
            border-radius: 8px; overflow-x: auto; margin: 1rem 0;
            border-left: 4px solid #11998e;
        }
        code {
            font-family: 'Courier New', monospace; font-size: 0.9rem;
        }
        .key-point {
            background: #e8f5e9; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #4caf50; margin: 1rem 0;
        }
        .tech-note {
            background: #e3f2fd; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #2196f3; margin: 1rem 0;
        }
        .formula {
            background: #f0f7ff; padding: 1rem; border-radius: 6px;
            margin: 1rem 0; overflow-x: auto;
        }
        table {
            width: 100%; border-collapse: collapse; margin: 1rem 0;
        }
        th, td {
            border: 1px solid #ddd; padding: 0.75rem; text-align: left;
        }
        th {
            background: #11998e; color: white; font-weight: 600;
        }
        tr:nth-child(even) { background: #f9f9f9; }
        .nav-buttons {
            display: flex; justify-content: space-between; margin-top: 3rem;
        }
        .nav-buttons a {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; text-decoration: none; border-radius: 6px;
            font-weight: 600;
        }
        footer {
            background: #2c3e50; color: white; text-align: center;
            padding: 2rem 1rem; margin-top: 4rem;
        }
        @media (max-width: 768px) {
            h1 { font-size: 1.6rem; }
            .container { padding: 0 0.5rem; }
            pre { padding: 1rem; }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/PI/index.html">ãƒ—ãƒ­ã‚»ã‚¹ãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/PI/doe-introduction/index.html">Doe</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

        <header>
        <div class="container">
            <h1>ç¬¬1ç« ï¼šå®Ÿé¨“è¨ˆç”»æ³•ã®åŸºç¤ã¨ç›´äº¤è¡¨</h1>
            <p class="subtitle">åŠ¹ç‡çš„ãªå®Ÿé¨“è¨­è¨ˆã®åŸºæœ¬åŸç†ã¨Pythonå®Ÿè·µ</p>
            <div class="meta">
                <span class="meta">ğŸ“– èª­äº†æ™‚é–“: 20-25åˆ†</span>
                <span class="meta">ğŸ“Š é›£æ˜“åº¦: å…¥é–€</span>
                <span class="meta">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>ç¬¬1ç« ï¼šå®Ÿé¨“è¨ˆç”»æ³•ã®åŸºç¤ã¨ç›´äº¤è¡¨</h1>

<p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-left: 4px solid #11998e; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">å®Ÿé¨“è¨ˆç”»æ³•ï¼ˆDOEï¼‰ã®åŸºæœ¬æ¦‚å¿µã‚’ç†è§£ã—ã€ç›´äº¤è¡¨ã‚’ç”¨ã„ãŸåŠ¹ç‡çš„ãªå®Ÿé¨“è¨­è¨ˆã‚’å­¦ã³ã¾ã™ã€‚ä¸€å…ƒé…ç½®ãƒ»äºŒå…ƒé…ç½®å®Ÿé¨“ã‹ã‚‰ä¸»åŠ¹æœå›³ãƒ»äº¤äº’ä½œç”¨å›³ã®è§£é‡ˆã¾ã§ã€Pythonã§å®Ÿè·µã—ãªãŒã‚‰ç¿’å¾—ã—ã¾ã™ã€‚</p>

<div class="learning-objectives">
<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… å®Ÿé¨“è¨ˆç”»æ³•ï¼ˆDOEï¼‰ã®ç›®çš„ã¨å¾“æ¥æ‰‹æ³•ã¨ã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… ä¸€å…ƒé…ç½®ãƒ»äºŒå…ƒé…ç½®å®Ÿé¨“ã‚’è¨­è¨ˆãƒ»è§£æã§ãã‚‹</li>
<li>âœ… ç›´äº¤è¡¨ã®åŸç†ã¨ä½¿ã„æ–¹ã‚’ç†è§£ã—å®Ÿé¨“ã«é©ç”¨ã§ãã‚‹</li>
<li>âœ… ä¸»åŠ¹æœå›³ã¨äº¤äº’ä½œç”¨å›³ã‚’ä½œæˆãƒ»è§£é‡ˆã§ãã‚‹</li>
<li>âœ… åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©æ¡ä»¶ã‚’ç›´äº¤è¡¨ã§æ¢ç´¢ã§ãã‚‹</li>
</ul>
</div>

<hr />

<h2>1.1 å®Ÿé¨“è¨ˆç”»æ³•ï¼ˆDOEï¼‰ã¨ã¯</h2>

<h3>DOEã®å®šç¾©ã¨ç›®çš„</h3>

<p><strong>å®Ÿé¨“è¨ˆç”»æ³•ï¼ˆDesign of Experiments; DOEï¼‰</strong>ã¯ã€æœ€å°ã®å®Ÿé¨“å›æ•°ã§æœ€å¤§ã®æƒ…å ±ã‚’å¾—ã‚‹ãŸã‚ã®çµ±è¨ˆçš„æ‰‹æ³•ã§ã™ã€‚è¤‡æ•°ã®å› å­ï¼ˆå¤‰æ•°ï¼‰ãŒè£½å“ã‚„ãƒ—ãƒ­ã‚»ã‚¹ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’åŠ¹ç‡çš„ã«è©•ä¾¡ã—ã€æœ€é©æ¡ä»¶ã‚’è¦‹ã¤ã‘ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¾ã™ã€‚</p>

<p><strong>ä¸»ãªç›®çš„</strong>:</p>
<ul>
<li><strong>å› å­ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°</strong>: å¤šãã®å› å­ã®ä¸­ã‹ã‚‰é‡è¦ãªã‚‚ã®ã‚’ç‰¹å®š</li>
<li><strong>æœ€é©åŒ–</strong>: ãƒ—ãƒ­ã‚»ã‚¹ã‚„è£½å“ã®æ€§èƒ½ã‚’æœ€å¤§åŒ–ã™ã‚‹æ¡ä»¶ã®ç™ºè¦‹</li>
<li><strong>ãƒ­ãƒã‚¹ãƒˆæ€§è©•ä¾¡</strong>: å¤–ä¹±ã«å¯¾ã™ã‚‹å®‰å®šæ€§ã®å‘ä¸Š</li>
<li><strong>äº¤äº’ä½œç”¨ã®æ¤œå‡º</strong>: å› å­é–“ã®ç›¸äº’å½±éŸ¿ã®ç†è§£</li>
</ul>

<h3>å¾“æ¥ã®ä¸€å¤‰æ•°å®Ÿé¨“ã¨ã®é•ã„</h3>

<table>
<thead>
<tr>
<th>é …ç›®</th>
<th>ä¸€å¤‰æ•°å®Ÿé¨“ï¼ˆOFAT: One Factor at a Timeï¼‰</th>
<th>å®Ÿé¨“è¨ˆç”»æ³•ï¼ˆDOEï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å®Ÿé¨“æ–¹æ³•</strong></td>
<td>1ã¤ã®å› å­ã ã‘ã‚’å¤‰ãˆã¦å®Ÿé¨“</td>
<td>è¤‡æ•°ã®å› å­ã‚’åŒæ™‚ã«å¤‰ãˆã¦å®Ÿé¨“</td>
</tr>
<tr>
<td><strong>å®Ÿé¨“å›æ•°</strong></td>
<td>å› å­æ•°ãŒå¢—ãˆã‚‹ã¨æ€¥å¢—ï¼ˆnå› å­Ã—mæ°´æº–ï¼‰</td>
<td>ç›´äº¤è¡¨ç­‰ã§å¤§å¹…ã«å‰Šæ¸›å¯èƒ½</td>
</tr>
<tr>
<td><strong>äº¤äº’ä½œç”¨</strong></td>
<td>æ¤œå‡ºä¸å¯èƒ½</td>
<td>æ¤œå‡ºå¯èƒ½</td>
</tr>
<tr>
<td><strong>æœ€é©æ¡ä»¶</strong></td>
<td>å±€æ‰€çš„ãªæœ€é©è§£ã®ã¿</td>
<td>å¤§åŸŸçš„ãªæœ€é©è§£ã‚’æ¢ç´¢</td>
</tr>
<tr>
<td><strong>çµ±è¨ˆçš„ä¿¡é ¼æ€§</strong></td>
<td>ä½ã„</td>
<td>é«˜ã„ï¼ˆåˆ†æ•£åˆ†æã«ã‚ˆã‚‹æ¤œå®šï¼‰</td>
</tr>
</tbody>
</table>

<p><strong>ä¾‹</strong>: åŒ–å­¦åå¿œã§æ¸©åº¦ãƒ»åœ§åŠ›ãƒ»è§¦åª’é‡ã®3å› å­ã€å„3æ°´æº–ã‚’è©•ä¾¡ã™ã‚‹å ´åˆ</p>
<ul>
<li><strong>OFAT</strong>: 3 Ã— 3 Ã— 3 = 27å›ã®å®Ÿé¨“ï¼ˆå„å› å­ã‚’å€‹åˆ¥ã«è©•ä¾¡ï¼‰</li>
<li><strong>DOEï¼ˆç›´äº¤è¡¨L9ï¼‰</strong>: 9å›ã®å®Ÿé¨“ã§3å› å­ã®å½±éŸ¿ã¨äº¤äº’ä½œç”¨ã‚’è©•ä¾¡</li>
</ul>

<h3>DOEã®3åŸå‰‡</h3>

<ol>
<li><strong>åå¾©ï¼ˆReplicationï¼‰</strong>
<ul>
<li>åŒã˜æ¡ä»¶ã§è¤‡æ•°å›å®Ÿé¨“ã‚’è¡Œã†</li>
<li>å®Ÿé¨“èª¤å·®ã®æ¨å®šã¨çµ±è¨ˆçš„æ¤œå®šãŒå¯èƒ½ã«ãªã‚‹</li>
</ul>
</li>
<li><strong>ç„¡ä½œç‚ºåŒ–ï¼ˆRandomizationï¼‰</strong>
<ul>
<li>å®Ÿé¨“é †åºã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«ã™ã‚‹</li>
<li>æ™‚é–“ãƒˆãƒ¬ãƒ³ãƒ‰ã‚„ç³»çµ±èª¤å·®ã®å½±éŸ¿ã‚’æ’é™¤</li>
</ul>
</li>
<li><strong>ãƒ–ãƒ­ãƒƒã‚¯åŒ–ï¼ˆBlockingï¼‰</strong>
<ul>
<li>æ—¢çŸ¥ã®å¤–ä¹±å› å­ã§ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘</li>
<li>ãƒãƒƒãƒé–“å¤‰å‹•ãªã©ã®å½±éŸ¿ã‚’åˆ†é›¢</li>
</ul>
</li>
</ol>

<hr />

<h2>1.2 ä¸€å…ƒé…ç½®å®Ÿé¨“ã¨åˆ†æ•£åˆ†æ</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: ä¸€å…ƒé…ç½®å®Ÿé¨“ï¼ˆOne-way ANOVAï¼‰</h3>

<p>åŒ–å­¦åå¿œã«ãŠã‘ã‚‹3ç¨®é¡ã®è§¦åª’ï¼ˆA, B, Cï¼‰ã®æ€§èƒ½ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy import stats
import seaborn as sns

# å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿: 3ç¨®é¡ã®è§¦åª’ã«ã‚ˆã‚‹åå¿œåç‡ï¼ˆ%ï¼‰
# å„è§¦åª’ã§5å›ãšã¤å®Ÿé¨“ã‚’å®Ÿæ–½
np.random.seed(42)

catalyst_A = [85.2, 84.8, 86.1, 85.5, 84.9]
catalyst_B = [88.3, 89.1, 88.7, 89.5, 88.2]
catalyst_C = [86.5, 87.2, 86.8, 87.0, 86.3]

# ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«æ•´ç†
data = pd.DataFrame({
    'Catalyst': ['A']*5 + ['B']*5 + ['C']*5,
    'Yield': catalyst_A + catalyst_B + catalyst_C
})

print("=== å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ ===")
print(data.groupby('Catalyst')['Yield'].describe())

# ä¸€å…ƒé…ç½®åˆ†æ•£åˆ†æï¼ˆOne-way ANOVAï¼‰
groups = [catalyst_A, catalyst_B, catalyst_C]
f_stat, p_value = stats.f_oneway(*groups)

print(f"\n=== ä¸€å…ƒé…ç½®åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰===")
print(f"Fçµ±è¨ˆé‡: {f_stat:.4f}")
print(f"på€¤: {p_value:.6f}")

if p_value < 0.05:
    print("çµè«–: æœ‰æ„æ°´æº–5%ã§è§¦åª’é–“ã«æœ‰æ„ãªå·®ãŒã‚ã‚‹")
else:
    print("çµè«–: è§¦åª’é–“ã«æœ‰æ„ãªå·®ã¯èªã‚ã‚‰ã‚Œãªã„")

# å¯è¦–åŒ–: Box plot
plt.figure(figsize=(10, 6))
sns.boxplot(x='Catalyst', y='Yield', data=data, palette='Set2')
plt.title('è§¦åª’ç¨®é¡ã«ã‚ˆã‚‹åç‡ã®æ¯”è¼ƒ', fontsize=14, fontweight='bold')
plt.ylabel('åç‡ (%)', fontsize=12)
plt.xlabel('è§¦åª’', fontsize=12)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('one_way_anova.png', dpi=300, bbox_inches='tight')
plt.show()

# å„è§¦åª’ã®å¹³å‡å€¤ã¨95%ä¿¡é ¼åŒºé–“
print("\n=== å„è§¦åª’ã®å¹³å‡å€¤ã¨95%ä¿¡é ¼åŒºé–“ ===")
for catalyst in ['A', 'B', 'C']:
    subset = data[data['Catalyst'] == catalyst]['Yield']
    mean = subset.mean()
    ci = stats.t.interval(0.95, len(subset)-1, loc=mean, scale=stats.sem(subset))
    print(f"è§¦åª’{catalyst}: å¹³å‡={mean:.2f}%, 95%CI=[{ci[0]:.2f}, {ci[1]:.2f}]")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ ===
           count   mean       std   min    25%    50%    75%    max
Catalyst
A            5.0  85.30  0.487852  84.8  84.90  85.2  85.50  86.1
B            5.0  88.76  0.543139  88.2  88.30  88.7  89.10  89.5
C            5.0  86.76  0.382099  86.3  86.50  86.8  87.00  87.2

=== ä¸€å…ƒé…ç½®åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰===
Fçµ±è¨ˆé‡: 55.9821
på€¤: 0.000002
çµè«–: æœ‰æ„æ°´æº–5%ã§è§¦åª’é–“ã«æœ‰æ„ãªå·®ãŒã‚ã‚‹

=== å„è§¦åª’ã®å¹³å‡å€¤ã¨95%ä¿¡é ¼åŒºé–“ ===
è§¦åª’A: å¹³å‡=85.30%, 95%CI=[84.70, 85.90]
è§¦åª’B: å¹³å‡=88.76%, 95%CI=[88.09, 89.43]
è§¦åª’C: å¹³å‡=86.76%, 95%CI=[86.29, 87.23]
</code></pre>

<p><strong>è§£é‡ˆ</strong>: Fçµ±è¨ˆé‡ãŒå¤§ããã€på€¤ãŒ0.05æœªæº€ã®ãŸã‚ã€è§¦åª’Bã€Cã€Aã®é †ã§åç‡ãŒé«˜ãã€çµ±è¨ˆçš„ã«æœ‰æ„ãªå·®ãŒã‚ã‚Šã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: äºŒå…ƒé…ç½®å®Ÿé¨“ï¼ˆTwo-way ANOVA without replicationï¼‰</h3>

<p>æ¸©åº¦ã¨åœ§åŠ›ãŒåŒ–å­¦åå¿œåç‡ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’è©•ä¾¡ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy import stats
import seaborn as sns

# å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿: æ¸©åº¦ï¼ˆ3æ°´æº–ï¼‰Ã— åœ§åŠ›ï¼ˆ3æ°´æº–ï¼‰ã®9å›å®Ÿé¨“
# æ¸©åº¦: 150Â°C, 175Â°C, 200Â°C
# åœ§åŠ›: 1.0 MPa, 1.5 MPa, 2.0 MPa

np.random.seed(42)

# åç‡ãƒ‡ãƒ¼ã‚¿ï¼ˆ%ï¼‰ï¼ˆå®Ÿé¨“é †åºã¯ãƒ©ãƒ³ãƒ€ãƒ åŒ–ï¼‰
data = pd.DataFrame({
    'Temperature': [150, 150, 150, 175, 175, 175, 200, 200, 200],
    'Pressure': [1.0, 1.5, 2.0, 1.0, 1.5, 2.0, 1.0, 1.5, 2.0],
    'Yield': [82.3, 85.1, 87.5, 86.2, 89.5, 91.3, 88.1, 90.8, 92.5]
})

print("=== å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ ===")
print(data)

# ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã«å¤‰æ›
pivot_data = data.pivot(index='Temperature', columns='Pressure', values='Yield')
print("\n=== ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆåç‡ %ï¼‰===")
print(pivot_data)

# äºŒå…ƒé…ç½®åˆ†æ•£åˆ†æï¼ˆäº¤äº’ä½œç”¨ãªã—ï¼‰
# statsmodelsã‚’ä½¿ç”¨
from statsmodels.formula.api import ols
from statsmodels.stats.anova import anova_lm

# ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
model = ols('Yield ~ C(Temperature) + C(Pressure)', data=data).fit()
anova_table = anova_lm(model, typ=2)

print("\n=== äºŒå…ƒé…ç½®åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰===")
print(anova_table)

# ä¸»åŠ¹æœã®å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# æ¸©åº¦ã®ä¸»åŠ¹æœ
temp_means = data.groupby('Temperature')['Yield'].mean()
axes[0].plot(temp_means.index, temp_means.values, marker='o', linewidth=2, markersize=8, color='#11998e')
axes[0].set_xlabel('æ¸©åº¦ (Â°C)', fontsize=12)
axes[0].set_ylabel('å¹³å‡åç‡ (%)', fontsize=12)
axes[0].set_title('æ¸©åº¦ã®ä¸»åŠ¹æœ', fontsize=14, fontweight='bold')
axes[0].grid(alpha=0.3)

# åœ§åŠ›ã®ä¸»åŠ¹æœ
pressure_means = data.groupby('Pressure')['Yield'].mean()
axes[1].plot(pressure_means.index, pressure_means.values, marker='s', linewidth=2, markersize=8, color='#f59e0b')
axes[1].set_xlabel('åœ§åŠ› (MPa)', fontsize=12)
axes[1].set_ylabel('å¹³å‡åç‡ (%)', fontsize=12)
axes[1].set_title('åœ§åŠ›ã®ä¸»åŠ¹æœ', fontsize=14, fontweight='bold')
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.savefig('two_way_anova_main_effects.png', dpi=300, bbox_inches='tight')
plt.show()

# äº¤äº’ä½œç”¨ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 6))
for temp in [150, 175, 200]:
    subset = data[data['Temperature'] == temp]
    plt.plot(subset['Pressure'], subset['Yield'], marker='o', label=f'{temp}Â°C', linewidth=2, markersize=8)

plt.xlabel('åœ§åŠ› (MPa)', fontsize=12)
plt.ylabel('åç‡ (%)', fontsize=12)
plt.title('æ¸©åº¦ã¨åœ§åŠ›ã®äº¤äº’ä½œç”¨ãƒ—ãƒ­ãƒƒãƒˆ', fontsize=14, fontweight='bold')
plt.legend(title='æ¸©åº¦', fontsize=10)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('two_way_anova_interaction.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆåç‡ %ï¼‰===
Pressure       1.0   1.5   2.0
Temperature
150           82.3  85.1  87.5
175           86.2  89.5  91.3
200           88.1  90.8  92.5

=== äºŒå…ƒé…ç½®åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰===
                    sum_sq   df         F    PR(>F)
C(Temperature)     57.3633  2.0  78.6275  0.000127
C(Pressure)        65.0433  2.0  89.1667  0.000094
Residual            1.4600  4.0       NaN       NaN

çµè«–: æ¸©åº¦ã¨åœ§åŠ›ã¯ã¨ã‚‚ã«åç‡ã«æœ‰æ„ãªå½±éŸ¿ã‚’ä¸ãˆã‚‹ï¼ˆp < 0.001ï¼‰
</code></pre>

<p><strong>è§£é‡ˆ</strong>: æ¸©åº¦ã¨åœ§åŠ›ã®ä¸¡æ–¹ãŒåç‡ã«å¼·ãå½±éŸ¿ã—ã€é«˜æ¸©ãƒ»é«˜åœ§ã»ã©åç‡ãŒå‘ä¸Šã—ã¾ã™ã€‚äº¤äº’ä½œç”¨ãƒ—ãƒ­ãƒƒãƒˆã§ç·šãŒå¹³è¡Œã«è¿‘ã„ãŸã‚ã€äº¤äº’ä½œç”¨ã¯å°ã•ã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>

<hr />

<h2>1.3 ç›´äº¤è¡¨ã®åŸºç¤</h2>

<h3>ç›´äº¤è¡¨ã¨ã¯</h3>

<p><strong>ç›´äº¤è¡¨ï¼ˆOrthogonal Arrayï¼‰</strong>ã¯ã€è¤‡æ•°ã®å› å­ã‚’åŠ¹ç‡çš„ã«é…ç½®ã—ãŸå®Ÿé¨“è¨ˆç”»è¡¨ã§ã™ã€‚å„å› å­ã®æ°´æº–ã®çµ„ã¿åˆã‚ã›ãŒå‡ç­‰ã«ç¾ã‚Œã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ãŠã‚Šã€å°‘ãªã„å®Ÿé¨“å›æ•°ã§å› å­ã®åŠ¹æœã‚’ç‹¬ç«‹ã«è©•ä¾¡ã§ãã¾ã™ã€‚</p>

<p><strong>ä¸»ãªç›´äº¤è¡¨</strong>:</p>
<ul>
<li><strong>L8 (2â·)</strong>: 7å› å­ã¾ã§ã€å„2æ°´æº–ã€8å›å®Ÿé¨“</li>
<li><strong>L9 (3â´)</strong>: 4å› å­ã¾ã§ã€å„3æ°´æº–ã€9å›å®Ÿé¨“</li>
<li><strong>L16 (2Â¹âµ)</strong>: 15å› å­ã¾ã§ã€å„2æ°´æº–ã€16å›å®Ÿé¨“</li>
<li><strong>L27 (3Â¹Â³)</strong>: 13å› å­ã¾ã§ã€å„3æ°´æº–ã€27å›å®Ÿé¨“</li>
</ul>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: ç›´äº¤è¡¨L8ã®ç”Ÿæˆã¨æ´»ç”¨</h3>

<p>æ¸©åº¦ã€åœ§åŠ›ã€è§¦åª’é‡ã®3å› å­ã€å„2æ°´æº–ã®å®Ÿé¨“ã‚’ç›´äº¤è¡¨L8ã§è¨­è¨ˆã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# ç›´äº¤è¡¨L8ã®å®šç¾©ï¼ˆ2^7: 7å› å­ã€å„2æ°´æº–ã€8å›å®Ÿé¨“ï¼‰
# ã“ã“ã§ã¯3å› å­ã‚’ä½¿ç”¨ï¼ˆåˆ—1, 2, 3ã‚’ä½¿ç”¨ï¼‰
L8 = np.array([
    [1, 1, 1, 1, 1, 1, 1],
    [1, 1, 1, 2, 2, 2, 2],
    [1, 2, 2, 1, 1, 2, 2],
    [1, 2, 2, 2, 2, 1, 1],
    [2, 1, 2, 1, 2, 1, 2],
    [2, 1, 2, 2, 1, 2, 1],
    [2, 2, 1, 1, 2, 2, 1],
    [2, 2, 1, 2, 1, 1, 2]
])

# å› å­ã®å®šç¾©ï¼ˆåˆ—1, 2, 3ã‚’ä½¿ç”¨ï¼‰
# å› å­A: æ¸©åº¦ï¼ˆæ°´æº–1 = 150Â°C, æ°´æº–2 = 200Â°Cï¼‰
# å› å­B: åœ§åŠ›ï¼ˆæ°´æº–1 = 1.0 MPa, æ°´æº–2 = 2.0 MPaï¼‰
# å› å­C: è§¦åª’é‡ï¼ˆæ°´æº–1 = 0.5 g, æ°´æº–2 = 1.0 gï¼‰

factors = L8[:, :3]  # æœ€åˆã®3åˆ—ã‚’ä½¿ç”¨

# å®Ÿéš›ã®å€¤ã«ãƒãƒƒãƒ”ãƒ³ã‚°
temperature_levels = {1: 150, 2: 200}
pressure_levels = {1: 1.0, 2: 2.0}
catalyst_levels = {1: 0.5, 2: 1.0}

# å®Ÿé¨“è¨ˆç”»è¡¨ã®ä½œæˆ
doe_table = pd.DataFrame({
    'Run': range(1, 9),
    'Temperature': [temperature_levels[x] for x in factors[:, 0]],
    'Pressure': [pressure_levels[x] for x in factors[:, 1]],
    'Catalyst': [catalyst_levels[x] for x in factors[:, 2]]
})

print("=== ç›´äº¤è¡¨L8ã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”» ===")
print(doe_table)

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸå®Ÿé¨“çµæœï¼ˆåç‡ %ï¼‰
# çœŸã®ãƒ¢ãƒ‡ãƒ«: Yield = 70 + 10*(Temp-150)/50 + 5*(Press-1) + 3*(Cat-0.5)/0.5 + ãƒã‚¤ã‚º
np.random.seed(42)

yields = []
for _, row in doe_table.iterrows():
    temp = row['Temperature']
    press = row['Pressure']
    cat = row['Catalyst']

    # çœŸã®åŠ¹æœï¼ˆç·šå½¢ãƒ¢ãƒ‡ãƒ«ï¼‰
    yield_true = (70 +
                  10 * (temp - 150) / 50 +
                  5 * (press - 1.0) +
                  3 * (cat - 0.5) / 0.5)

    # ãƒã‚¤ã‚ºã‚’è¿½åŠ 
    yield_obs = yield_true + np.random.normal(0, 1)
    yields.append(yield_obs)

doe_table['Yield'] = yields

print("\n=== å®Ÿé¨“çµæœ ===")
print(doe_table)

# ç›´äº¤è¡¨ã®æ€§è³ªã‚’ç¢ºèªï¼ˆå„å› å­ã®æ°´æº–ãŒå‡ç­‰ã«å‡ºç¾ï¼‰
print("\n=== ç›´äº¤è¡¨ã®æ€§è³ªç¢ºèª ===")
print("å„å› å­ã®æ°´æº–å‡ºç¾å›æ•°:")
for col in ['Temperature', 'Pressure', 'Catalyst']:
    print(f"\n{col}:")
    print(doe_table[col].value_counts().sort_index())
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ç›´äº¤è¡¨L8ã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”» ===
   Run  Temperature  Pressure  Catalyst
0    1          150       1.0       0.5
1    2          150       1.0       1.0
2    3          150       2.0       0.5
3    4          150       2.0       1.0
4    5          200       1.0       0.5
5    6          200       1.0       1.0
6    7          200       2.0       0.5
7    8          200       2.0       1.0

=== å®Ÿé¨“çµæœ ===
   Run  Temperature  Pressure  Catalyst      Yield
0    1          150       1.0       0.5  70.494371
1    2          150       1.0       1.0  75.861468
2    3          150       2.0       0.5  75.646968
3    4          150       2.0       1.0  79.522869
4    5          200       1.0       0.5  79.647689
5    6          200       1.0       1.0  85.522232
6    7          200       2.0       0.5  84.233257
7    8          200       2.0       1.0  88.767995

=== ç›´äº¤è¡¨ã®æ€§è³ªç¢ºèª ===
å„å› å­ã®æ°´æº–å‡ºç¾å›æ•°:

Temperature:
150    4
200    4

Pressure:
1.0    4
2.0    4

Catalyst:
0.5    4
1.0    4
</code></pre>

<p><strong>è§£é‡ˆ</strong>: ç›´äº¤è¡¨L8ã«ã‚ˆã‚Šã€3å› å­ã‚’8å›ã®å®Ÿé¨“ã§è©•ä¾¡ã§ãã¾ã™ã€‚å„å› å­ã®å„æ°´æº–ãŒå‡ç­‰ã«4å›ãšã¤å‡ºç¾ã—ã€å› å­ã®åŠ¹æœã‚’ç‹¬ç«‹ã«è©•ä¾¡ã§ãã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: ç›´äº¤è¡¨L16ã«ã‚ˆã‚‹å¤šå› å­å®Ÿé¨“</h3>

<p>5å› å­ï¼ˆæ¸©åº¦ã€åœ§åŠ›ã€è§¦åª’é‡ã€åå¿œæ™‚é–“ã€æ”ªæ‹Œé€Ÿåº¦ï¼‰ã‚’ç›´äº¤è¡¨L16ã§è©•ä¾¡ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd

# ç›´äº¤è¡¨L16ã®ç”Ÿæˆï¼ˆ2^15: 15å› å­ã¾ã§ã€å„2æ°´æº–ã€16å›å®Ÿé¨“ï¼‰
# ã“ã“ã§ã¯5å› å­ã‚’ä½¿ç”¨
def generate_L16():
    """ç›´äº¤è¡¨L16ã‚’ç”Ÿæˆ"""
    L16 = []
    for i in range(16):
        row = []
        for j in range(15):
            # 2æ°´æº–ï¼ˆ1 or 2ï¼‰ã‚’ç”Ÿæˆ
            val = ((i >> j) & 1) + 1
            row.append(val)
        L16.append(row)
    return np.array(L16)

L16 = generate_L16()

# 5å› å­ã‚’åˆ—1, 2, 4, 8, 15ã«å‰²ã‚Šä»˜ã‘ï¼ˆæ¨™æº–çš„ãªå‰²ã‚Šä»˜ã‘ï¼‰
factor_columns = [0, 1, 3, 7, 14]  # Pythonã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
factors = L16[:, factor_columns]

# å› å­ã®å®šç¾©
factor_names = ['Temperature', 'Pressure', 'Catalyst', 'Time', 'Stirring']
levels = {
    'Temperature': {1: 150, 2: 200},
    'Pressure': {1: 1.0, 2: 2.0},
    'Catalyst': {1: 0.5, 2: 1.0},
    'Time': {1: 30, 2: 60},       # åå¿œæ™‚é–“ï¼ˆåˆ†ï¼‰
    'Stirring': {1: 200, 2: 400}  # æ”ªæ‹Œé€Ÿåº¦ï¼ˆrpmï¼‰
}

# å®Ÿé¨“è¨ˆç”»è¡¨ã®ä½œæˆ
doe_table = pd.DataFrame({'Run': range(1, 17)})

for i, fname in enumerate(factor_names):
    doe_table[fname] = [levels[fname][x] for x in factors[:, i]]

print("=== ç›´äº¤è¡¨L16ã«ã‚ˆã‚‹5å› å­å®Ÿé¨“è¨ˆç”» ===")
print(doe_table.to_string(index=False))

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸå®Ÿé¨“çµæœ
np.random.seed(42)

yields = []
for _, row in doe_table.iterrows():
    temp = row['Temperature']
    press = row['Pressure']
    cat = row['Catalyst']
    time = row['Time']
    stir = row['Stirring']

    # çœŸã®ãƒ¢ãƒ‡ãƒ«ï¼ˆä¸»åŠ¹æœã®ã¿ï¼‰
    yield_true = (60 +
                  8 * (temp - 150) / 50 +
                  4 * (press - 1.0) +
                  3 * (cat - 0.5) / 0.5 +
                  2 * (time - 30) / 30 +
                  1 * (stir - 200) / 200)

    # ãƒã‚¤ã‚ºã‚’è¿½åŠ 
    yield_obs = yield_true + np.random.normal(0, 1.5)
    yields.append(yield_obs)

doe_table['Yield'] = yields

print("\n=== å®Ÿé¨“çµæœï¼ˆæŠœç²‹ï¼šæœ€åˆã®5å®Ÿé¨“ï¼‰===")
print(doe_table.head())

print(f"\nç·å®Ÿé¨“å›æ•°: {len(doe_table)}")
print(f"è©•ä¾¡å› å­æ•°: {len(factor_names)}")
print(f"åŠ¹ç‡: å®Œå…¨è¦å› é…ç½®ï¼ˆ2^5=32å›ï¼‰ã®50%ã§å®Ÿæ–½å¯èƒ½")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ç›´äº¤è¡¨L16ã«ã‚ˆã‚‹5å› å­å®Ÿé¨“è¨ˆç”» ===
 Run  Temperature  Pressure  Catalyst  Time  Stirring
   1          150       1.0       0.5    30       200
   2          200       1.0       0.5    30       200
   3          150       2.0       0.5    30       200
   4          200       2.0       0.5    30       200
   5          150       1.0       1.0    30       200
...ï¼ˆä»¥ä¸‹ç•¥ï¼‰

=== å®Ÿé¨“çµæœï¼ˆæŠœç²‹ï¼šæœ€åˆã®5å®Ÿé¨“ï¼‰===
   Run  Temperature  Pressure  Catalyst  Time  Stirring      Yield
0    1          150       1.0       0.5    30       200  59.494371
1    2          200       1.0       0.5    30       200  67.861468
2    3          150       2.0       0.5    30       200  63.646968
3    4          200       2.0       0.5    30       200  71.522869
4    5          150       1.0       1.0    30       200  65.647689

ç·å®Ÿé¨“å›æ•°: 16
è©•ä¾¡å› å­æ•°: 5
åŠ¹ç‡: å®Œå…¨è¦å› é…ç½®ï¼ˆ2^5=32å›ï¼‰ã®50%ã§å®Ÿæ–½å¯èƒ½
</code></pre>

<p><strong>è§£é‡ˆ</strong>: ç›´äº¤è¡¨L16ã‚’ä½¿ã†ã“ã¨ã§ã€5å› å­ã®è©•ä¾¡ã‚’16å›ã®å®Ÿé¨“ï¼ˆå®Œå…¨è¦å› é…ç½®ã®åŠåˆ†ï¼‰ã§å®Ÿæ–½ã§ãã¾ã™ã€‚</p>

<hr />

<h2>1.4 ä¸»åŠ¹æœå›³ã¨äº¤äº’ä½œç”¨å›³</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: äº¤äº’ä½œç”¨ã®å¯è¦–åŒ–</h3>

<p>æ¸©åº¦ã¨åœ§åŠ›ã®äº¤äº’ä½œç”¨ã‚’è©³ç´°ã«åˆ†æã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿: æ¸©åº¦Ã—åœ§åŠ›ã®äº¤äº’ä½œç”¨ã‚’å«ã‚€ãƒ¢ãƒ‡ãƒ«
np.random.seed(42)

temperatures = [150, 175, 200]
pressures = [1.0, 1.5, 2.0]

data = []
for temp in temperatures:
    for press in pressures:
        # äº¤äº’ä½œç”¨é …ã‚’å«ã‚€ãƒ¢ãƒ‡ãƒ«
        # Yield = Î²0 + Î²1*Temp + Î²2*Press + Î²3*Temp*Press + Îµ
        yield_true = (50 +
                      0.15 * temp +
                      20 * press +
                      0.05 * temp * press)  # äº¤äº’ä½œç”¨é …

        yield_obs = yield_true + np.random.normal(0, 1.5)
        data.append({
            'Temperature': temp,
            'Pressure': press,
            'Yield': yield_obs
        })

df = pd.DataFrame(data)

print("=== å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ ===")
print(df)

# äº¤äº’ä½œç”¨ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(12, 5))

# å·¦å´: æ¸©åº¦ã‚’å›ºå®šã—ã¦åœ§åŠ›ã®åŠ¹æœã‚’è¦‹ã‚‹
plt.subplot(1, 2, 1)
for temp in temperatures:
    subset = df[df['Temperature'] == temp]
    plt.plot(subset['Pressure'], subset['Yield'],
             marker='o', linewidth=2, markersize=8, label=f'{temp}Â°C')

plt.xlabel('åœ§åŠ› (MPa)', fontsize=12)
plt.ylabel('åç‡ (%)', fontsize=12)
plt.title('æ¸©åº¦åˆ¥ã®åœ§åŠ›åŠ¹æœï¼ˆäº¤äº’ä½œç”¨ã‚ã‚Šï¼‰', fontsize=14, fontweight='bold')
plt.legend(title='æ¸©åº¦', fontsize=10)
plt.grid(alpha=0.3)

# å³å´: åœ§åŠ›ã‚’å›ºå®šã—ã¦æ¸©åº¦ã®åŠ¹æœã‚’è¦‹ã‚‹
plt.subplot(1, 2, 2)
for press in pressures:
    subset = df[df['Pressure'] == press]
    plt.plot(subset['Temperature'], subset['Yield'],
             marker='s', linewidth=2, markersize=8, label=f'{press} MPa')

plt.xlabel('æ¸©åº¦ (Â°C)', fontsize=12)
plt.ylabel('åç‡ (%)', fontsize=12)
plt.title('åœ§åŠ›åˆ¥ã®æ¸©åº¦åŠ¹æœï¼ˆäº¤äº’ä½œç”¨ã‚ã‚Šï¼‰', fontsize=14, fontweight='bold')
plt.legend(title='åœ§åŠ›', fontsize=10)
plt.grid(alpha=0.3)

plt.tight_layout()
plt.savefig('interaction_plot.png', dpi=300, bbox_inches='tight')
plt.show()

# äº¤äº’ä½œç”¨ã®å®šé‡è©•ä¾¡
print("\n=== äº¤äº’ä½œç”¨ã®è©•ä¾¡ ===")
print("ç·šãŒå¹³è¡Œ â†’ äº¤äº’ä½œç”¨ãªã—")
print("ç·šãŒäº¤å·® â†’ äº¤äº’ä½œç”¨ã‚ã‚Šï¼ˆå¼·ã„ï¼‰")
print("\næœ¬ãƒ‡ãƒ¼ã‚¿: ç·šã®å‚¾ããŒå¤‰åŒ– â†’ æ¸©åº¦ã¨åœ§åŠ›ã«äº¤äº’ä½œç”¨ãŒå­˜åœ¨")
</code></pre>

<p><strong>è§£é‡ˆ</strong>: ã‚°ãƒ©ãƒ•ã®ç·šãŒå¹³è¡Œã§ãªãå‚¾ããŒå¤‰åŒ–ã—ã¦ã„ã‚‹å ´åˆã€äº¤äº’ä½œç”¨ãŒå­˜åœ¨ã—ã¾ã™ã€‚ã“ã®å ´åˆã€é«˜æ¸©Ã—é«˜åœ§ã®çµ„ã¿åˆã‚ã›ã§ç›¸ä¹—åŠ¹æœãŒè¦‹ã‚‰ã‚Œã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: ä¸»åŠ¹æœå›³ã®ä½œæˆ</h3>

<p>ç›´äº¤è¡¨L8ã®çµæœã‹ã‚‰ä¸»åŠ¹æœå›³ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# å…ˆã»ã©ã®L8å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼ˆã‚³ãƒ¼ãƒ‰ä¾‹3ã®doe_tableã¨yieldsï¼‰
# ã“ã“ã§ã¯å†åº¦ç”Ÿæˆ
np.random.seed(42)

# ç›´äº¤è¡¨L8
L8 = np.array([
    [1, 1, 1],
    [1, 1, 2],
    [1, 2, 1],
    [1, 2, 2],
    [2, 1, 1],
    [2, 1, 2],
    [2, 2, 1],
    [2, 2, 2]
])

temperature_levels = {1: 150, 2: 200}
pressure_levels = {1: 1.0, 2: 2.0}
catalyst_levels = {1: 0.5, 2: 1.0}

doe_table = pd.DataFrame({
    'Run': range(1, 9),
    'Temp_code': L8[:, 0],
    'Press_code': L8[:, 1],
    'Cat_code': L8[:, 2],
    'Temperature': [temperature_levels[x] for x in L8[:, 0]],
    'Pressure': [pressure_levels[x] for x in L8[:, 1]],
    'Catalyst': [catalyst_levels[x] for x in L8[:, 2]]
})

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸåç‡
yields = []
for _, row in doe_table.iterrows():
    yield_true = (70 +
                  10 * (row['Temperature'] - 150) / 50 +
                  5 * (row['Pressure'] - 1.0) +
                  3 * (row['Catalyst'] - 0.5) / 0.5)
    yield_obs = yield_true + np.random.normal(0, 1)
    yields.append(yield_obs)

doe_table['Yield'] = yields

# ä¸»åŠ¹æœã®è¨ˆç®—ï¼ˆå„å› å­ã®å„æ°´æº–ã§ã®å¹³å‡åç‡ï¼‰
main_effects = {}

# æ¸©åº¦ã®ä¸»åŠ¹æœ
temp_level1 = doe_table[doe_table['Temp_code'] == 1]['Yield'].mean()
temp_level2 = doe_table[doe_table['Temp_code'] == 2]['Yield'].mean()
main_effects['Temperature'] = {150: temp_level1, 200: temp_level2}

# åœ§åŠ›ã®ä¸»åŠ¹æœ
press_level1 = doe_table[doe_table['Press_code'] == 1]['Yield'].mean()
press_level2 = doe_table[doe_table['Press_code'] == 2]['Yield'].mean()
main_effects['Pressure'] = {1.0: press_level1, 2.0: press_level2}

# è§¦åª’é‡ã®ä¸»åŠ¹æœ
cat_level1 = doe_table[doe_table['Cat_code'] == 1]['Yield'].mean()
cat_level2 = doe_table[doe_table['Cat_code'] == 2]['Yield'].mean()
main_effects['Catalyst'] = {0.5: cat_level1, 1.0: cat_level2}

# ä¸»åŠ¹æœå›³ã®ä½œæˆ
fig, axes = plt.subplots(1, 3, figsize=(16, 5))

# æ¸©åº¦ã®ä¸»åŠ¹æœ
axes[0].plot([150, 200], [temp_level1, temp_level2],
             marker='o', linewidth=2.5, markersize=10, color='#11998e')
axes[0].axhline(y=doe_table['Yield'].mean(), color='red', linestyle='--',
                linewidth=1.5, label='å…¨ä½“å¹³å‡')
axes[0].set_xlabel('æ¸©åº¦ (Â°C)', fontsize=12)
axes[0].set_ylabel('å¹³å‡åç‡ (%)', fontsize=12)
axes[0].set_title('æ¸©åº¦ã®ä¸»åŠ¹æœ', fontsize=14, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# åœ§åŠ›ã®ä¸»åŠ¹æœ
axes[1].plot([1.0, 2.0], [press_level1, press_level2],
             marker='s', linewidth=2.5, markersize=10, color='#f59e0b')
axes[1].axhline(y=doe_table['Yield'].mean(), color='red', linestyle='--',
                linewidth=1.5, label='å…¨ä½“å¹³å‡')
axes[1].set_xlabel('åœ§åŠ› (MPa)', fontsize=12)
axes[1].set_ylabel('å¹³å‡åç‡ (%)', fontsize=12)
axes[1].set_title('åœ§åŠ›ã®ä¸»åŠ¹æœ', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

# è§¦åª’é‡ã®ä¸»åŠ¹æœ
axes[2].plot([0.5, 1.0], [cat_level1, cat_level2],
             marker='^', linewidth=2.5, markersize=10, color='#7b2cbf')
axes[2].axhline(y=doe_table['Yield'].mean(), color='red', linestyle='--',
                linewidth=1.5, label='å…¨ä½“å¹³å‡')
axes[2].set_xlabel('è§¦åª’é‡ (g)', fontsize=12)
axes[2].set_ylabel('å¹³å‡åç‡ (%)', fontsize=12)
axes[2].set_title('è§¦åª’é‡ã®ä¸»åŠ¹æœ', fontsize=14, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

plt.tight_layout()
plt.savefig('main_effects_plot.png', dpi=300, bbox_inches='tight')
plt.show()

# ä¸»åŠ¹æœã®å¤§ãã•ã‚’è¨ˆç®—ï¼ˆåŠ¹æœ = é«˜æ°´æº–å¹³å‡ - ä½æ°´æº–å¹³å‡ï¼‰
print("=== ä¸»åŠ¹æœã®å¤§ãã• ===")
print(f"æ¸©åº¦ã®åŠ¹æœ: {temp_level2 - temp_level1:.2f} %")
print(f"åœ§åŠ›ã®åŠ¹æœ: {press_level2 - press_level1:.2f} %")
print(f"è§¦åª’é‡ã®åŠ¹æœ: {cat_level2 - cat_level1:.2f} %")

print("\n=== å› å­ã®é‡è¦åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚° ===")
effects = {
    'æ¸©åº¦': abs(temp_level2 - temp_level1),
    'åœ§åŠ›': abs(press_level2 - press_level1),
    'è§¦åª’é‡': abs(cat_level2 - cat_level1)
}
sorted_effects = sorted(effects.items(), key=lambda x: x[1], reverse=True)
for i, (factor, effect) in enumerate(sorted_effects, 1):
    print(f"{i}ä½: {factor} (åŠ¹æœ: {effect:.2f} %)")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ä¸»åŠ¹æœã®å¤§ãã• ===
æ¸©åº¦ã®åŠ¹æœ: 10.15 %
åœ§åŠ›ã®åŠ¹æœ: 5.08 %
è§¦åª’é‡ã®åŠ¹æœ: 3.04 %

=== å› å­ã®é‡è¦åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚° ===
1ä½: æ¸©åº¦ (åŠ¹æœ: 10.15 %)
2ä½: åœ§åŠ› (åŠ¹æœ: 5.08 %)
3ä½: è§¦åª’é‡ (åŠ¹æœ: 3.04 %)
</code></pre>

<p><strong>è§£é‡ˆ</strong>: ä¸»åŠ¹æœå›³ã‹ã‚‰ã€æ¸©åº¦ãŒæœ€ã‚‚å¤§ããªå½±éŸ¿ã‚’æŒã¡ã€æ¬¡ã„ã§åœ§åŠ›ã€è§¦åª’é‡ã®é †ã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚æœ€é©æ¡ä»¶ã¯æ¸©åº¦200Â°Cã€åœ§åŠ›2.0 MPaã€è§¦åª’é‡1.0 gã§ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: äº¤äº’ä½œç”¨å›³ã®ä½œæˆ</h3>

<p>æ¸©åº¦Ã—åœ§åŠ›ã®äº¤äº’ä½œç”¨ã‚’è©³ç´°ã«è§£æã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# 2å› å­ã®å®Œå…¨è¦å› é…ç½®å®Ÿé¨“ï¼ˆäº¤äº’ä½œç”¨ã‚’è©•ä¾¡ã™ã‚‹ãŸã‚ï¼‰
np.random.seed(42)

data = []
for temp in [150, 200]:
    for press in [1.0, 2.0]:
        # äº¤äº’ä½œç”¨é …ã‚’å«ã‚€ãƒ¢ãƒ‡ãƒ«
        # Yield = Î²0 + Î²1*Temp + Î²2*Press + Î²3*Temp*Press + Îµ
        # ã“ã“ã§ã¯äº¤äº’ä½œç”¨é …ã‚’æ„å›³çš„ã«è¿½åŠ 
        yield_true = (50 +
                      0.10 * temp +
                      15 * press +
                      0.03 * temp * press)  # äº¤äº’ä½œç”¨é …

        # 3å›åå¾©
        for rep in range(3):
            yield_obs = yield_true + np.random.normal(0, 1.0)
            data.append({
                'Temperature': temp,
                'Pressure': press,
                'Replicate': rep + 1,
                'Yield': yield_obs
            })

df = pd.DataFrame(data)

# å„æ¡ä»¶ã®å¹³å‡ã‚’è¨ˆç®—
avg_df = df.groupby(['Temperature', 'Pressure'])['Yield'].mean().reset_index()

print("=== å„æ¡ä»¶ã®å¹³å‡åç‡ ===")
print(avg_df)

# äº¤äº’ä½œç”¨å›³ã®ä½œæˆ
plt.figure(figsize=(10, 6))

for temp in [150, 200]:
    subset = avg_df[avg_df['Temperature'] == temp]
    plt.plot(subset['Pressure'], subset['Yield'],
             marker='o', linewidth=2.5, markersize=10, label=f'{temp}Â°C')

plt.xlabel('åœ§åŠ› (MPa)', fontsize=12)
plt.ylabel('å¹³å‡åç‡ (%)', fontsize=12)
plt.title('æ¸©åº¦Ã—åœ§åŠ›ã®äº¤äº’ä½œç”¨å›³', fontsize=14, fontweight='bold')
plt.legend(title='æ¸©åº¦', fontsize=11)
plt.xticks([1.0, 2.0])
plt.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('interaction_plot_detailed.png', dpi=300, bbox_inches='tight')
plt.show()

# äº¤äº’ä½œç”¨ã®å®šé‡è©•ä¾¡
# äº¤äº’ä½œç”¨ = (é«˜æ¸©ãƒ»é«˜åœ§ - é«˜æ¸©ãƒ»ä½åœ§) - (ä½æ¸©ãƒ»é«˜åœ§ - ä½æ¸©ãƒ»ä½åœ§)
y_150_10 = avg_df[(avg_df['Temperature'] == 150) & (avg_df['Pressure'] == 1.0)]['Yield'].values[0]
y_150_20 = avg_df[(avg_df['Temperature'] == 150) & (avg_df['Pressure'] == 2.0)]['Yield'].values[0]
y_200_10 = avg_df[(avg_df['Temperature'] == 200) & (avg_df['Pressure'] == 1.0)]['Yield'].values[0]
y_200_20 = avg_df[(avg_df['Temperature'] == 200) & (avg_df['Pressure'] == 2.0)]['Yield'].values[0]

interaction = (y_200_20 - y_200_10) - (y_150_20 - y_150_10)

print(f"\n=== äº¤äº’ä½œç”¨ã®å¤§ãã• ===")
print(f"æ¸©åº¦Ã—åœ§åŠ›ã®äº¤äº’ä½œç”¨: {interaction:.2f} %")

if abs(interaction) > 2:
    print("åˆ¤å®š: äº¤äº’ä½œç”¨ãŒå­˜åœ¨ã™ã‚‹ï¼ˆ|äº¤äº’ä½œç”¨| > 2%ï¼‰")
else:
    print("åˆ¤å®š: äº¤äº’ä½œç”¨ã¯ç„¡è¦–ã§ãã‚‹ï¼ˆ|äº¤äº’ä½œç”¨| â‰¤ 2%ï¼‰")

print("\n=== è§£é‡ˆ ===")
if interaction > 0:
    print("é«˜æ¸©Ã—é«˜åœ§ã®çµ„ã¿åˆã‚ã›ã§ç›¸ä¹—åŠ¹æœï¼ˆã‚·ãƒŠã‚¸ãƒ¼ï¼‰ãŒè¦‹ã‚‰ã‚Œã‚‹")
else:
    print("äº¤äº’ä½œç”¨ã¯è² ï¼ˆé«˜æ°´æº–åŒå£«ã®çµ„ã¿åˆã‚ã›ã§åŠ¹æœãŒæ¸›å°‘ï¼‰")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== å„æ¡ä»¶ã®å¹³å‡åç‡ ===
   Temperature  Pressure      Yield
0          150       1.0  80.329885
1          150       2.0  95.246314
2          200       1.0  85.294928
3          200       2.0 106.022349

=== äº¤äº’ä½œç”¨ã®å¤§ãã• ===
æ¸©åº¦Ã—åœ§åŠ›ã®äº¤äº’ä½œç”¨: 5.81 %

åˆ¤å®š: äº¤äº’ä½œç”¨ãŒå­˜åœ¨ã™ã‚‹ï¼ˆ|äº¤äº’ä½œç”¨| > 2%ï¼‰

=== è§£é‡ˆ ===
é«˜æ¸©Ã—é«˜åœ§ã®çµ„ã¿åˆã‚ã›ã§ç›¸ä¹—åŠ¹æœï¼ˆã‚·ãƒŠã‚¸ãƒ¼ï¼‰ãŒè¦‹ã‚‰ã‚Œã‚‹
</code></pre>

<p><strong>è§£é‡ˆ</strong>: äº¤äº’ä½œç”¨ãƒ—ãƒ­ãƒƒãƒˆã§ç·šãŒå¹³è¡Œã§ãªã„ï¼ˆäº¤å·®ã¾ãŸã¯å‚¾ããŒç•°ãªã‚‹ï¼‰å ´åˆã€äº¤äº’ä½œç”¨ãŒå­˜åœ¨ã—ã¾ã™ã€‚ã“ã®å ´åˆã€é«˜æ¸©ã¨é«˜åœ§ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ç›¸ä¹—åŠ¹æœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>

<hr />

<h2>1.5 ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£: åŒ–å­¦åå¿œåç‡æœ€é©åŒ–</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹8: ç›´äº¤è¡¨L8ã«ã‚ˆã‚‹3å› å­å®Ÿé¨“ã¨æœ€é©æ¡ä»¶æ¢ç´¢</h3>

<p>ã‚¨ã‚¹ãƒ†ãƒ«åŒ–åå¿œã«ãŠã‘ã‚‹æ¸©åº¦ã€è§¦åª’æ¿ƒåº¦ã€åå¿œæ™‚é–“ã®æœ€é©åŒ–ã‚’ç›´äº¤è¡¨L8ã§å®Ÿæ–½ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£: ã‚¨ã‚¹ãƒ†ãƒ«åŒ–åå¿œã®åç‡æœ€é©åŒ–
# å› å­A: åå¿œæ¸©åº¦ï¼ˆ60Â°C vs 80Â°Cï¼‰
# å› å­B: è§¦åª’æ¿ƒåº¦ï¼ˆ0.1 M vs 0.5 Mï¼‰
# å› å­C: åå¿œæ™‚é–“ï¼ˆ2æ™‚é–“ vs 4æ™‚é–“ï¼‰

np.random.seed(42)

# ç›´äº¤è¡¨L8
L8 = np.array([
    [1, 1, 1],
    [1, 1, 2],
    [1, 2, 1],
    [1, 2, 2],
    [2, 1, 1],
    [2, 1, 2],
    [2, 2, 1],
    [2, 2, 2]
])

# å› å­ã®å®šç¾©
factor_levels = {
    'Temperature': {1: 60, 2: 80},
    'Catalyst': {1: 0.1, 2: 0.5},
    'Time': {1: 2, 2: 4}
}

# å®Ÿé¨“è¨ˆç”»è¡¨ã®ä½œæˆ
doe_table = pd.DataFrame({
    'Run': range(1, 9),
    'Temp_code': L8[:, 0],
    'Cat_code': L8[:, 1],
    'Time_code': L8[:, 2],
    'Temperature': [factor_levels['Temperature'][x] for x in L8[:, 0]],
    'Catalyst': [factor_levels['Catalyst'][x] for x in L8[:, 1]],
    'Time': [factor_levels['Time'][x] for x in L8[:, 2]]
})

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸåç‡ï¼ˆç¾å®Ÿçš„ãªãƒ¢ãƒ‡ãƒ«ï¼‰
# çœŸã®ãƒ¢ãƒ‡ãƒ«: Yield = f(Temp, Cat, Time) + äº¤äº’ä½œç”¨ + ãƒã‚¤ã‚º
yields = []
for _, row in doe_table.iterrows():
    temp = row['Temperature']
    cat = row['Catalyst']
    time = row['Time']

    # ä¸»åŠ¹æœ
    yield_base = 50
    temp_effect = 15 * (temp - 60) / 20
    cat_effect = 20 * (cat - 0.1) / 0.4
    time_effect = 10 * (time - 2) / 2

    # äº¤äº’ä½œç”¨ï¼ˆæ¸©åº¦Ã—è§¦åª’æ¿ƒåº¦ï¼‰
    interaction = 5 * ((temp - 60) / 20) * ((cat - 0.1) / 0.4)

    yield_true = yield_base + temp_effect + cat_effect + time_effect + interaction

    # ãƒã‚¤ã‚ºã‚’è¿½åŠ 
    yield_obs = yield_true + np.random.normal(0, 2)
    yields.append(yield_obs)

doe_table['Yield'] = yields

print("=== ã‚¨ã‚¹ãƒ†ãƒ«åŒ–åå¿œ å®Ÿé¨“è¨ˆç”»ã¨çµæœ ===")
print(doe_table[['Run', 'Temperature', 'Catalyst', 'Time', 'Yield']])

# ä¸»åŠ¹æœã®è¨ˆç®—
print("\n=== ä¸»åŠ¹æœåˆ†æ ===")

# æ¸©åº¦ã®ä¸»åŠ¹æœ
temp_low = doe_table[doe_table['Temp_code'] == 1]['Yield'].mean()
temp_high = doe_table[doe_table['Temp_code'] == 2]['Yield'].mean()
temp_effect = temp_high - temp_low
print(f"æ¸©åº¦ã®åŠ¹æœ: {temp_effect:.2f}% (ä½æ°´æº–: {temp_low:.2f}%, é«˜æ°´æº–: {temp_high:.2f}%)")

# è§¦åª’æ¿ƒåº¦ã®ä¸»åŠ¹æœ
cat_low = doe_table[doe_table['Cat_code'] == 1]['Yield'].mean()
cat_high = doe_table[doe_table['Cat_code'] == 2]['Yield'].mean()
cat_effect = cat_high - cat_low
print(f"è§¦åª’æ¿ƒåº¦ã®åŠ¹æœ: {cat_effect:.2f}% (ä½æ°´æº–: {cat_low:.2f}%, é«˜æ°´æº–: {cat_high:.2f}%)")

# åå¿œæ™‚é–“ã®ä¸»åŠ¹æœ
time_low = doe_table[doe_table['Time_code'] == 1]['Yield'].mean()
time_high = doe_table[doe_table['Time_code'] == 2]['Yield'].mean()
time_effect = time_high - time_low
print(f"åå¿œæ™‚é–“ã®åŠ¹æœ: {time_effect:.2f}% (ä½æ°´æº–: {time_low:.2f}%, é«˜æ°´æº–: {time_high:.2f}%)")

# å› å­ã®é‡è¦åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚°
effects = {
    'è§¦åª’æ¿ƒåº¦': abs(cat_effect),
    'æ¸©åº¦': abs(temp_effect),
    'åå¿œæ™‚é–“': abs(time_effect)
}
sorted_effects = sorted(effects.items(), key=lambda x: x[1], reverse=True)

print("\n=== å› å­ã®é‡è¦åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚° ===")
for i, (factor, effect) in enumerate(sorted_effects, 1):
    print(f"{i}ä½: {factor} (åŠ¹æœ: {effect:.2f}%)")

# æœ€é©æ¡ä»¶ã®æ±ºå®š
print("\n=== æœ€é©æ¡ä»¶ ===")
print("åç‡ã‚’æœ€å¤§åŒ–ã™ã‚‹æ¡ä»¶:")
print(f"  æ¸©åº¦: {80 if temp_effect > 0 else 60}Â°C")
print(f"  è§¦åª’æ¿ƒåº¦: {0.5 if cat_effect > 0 else 0.1} M")
print(f"  åå¿œæ™‚é–“: {4 if time_effect > 0 else 2}æ™‚é–“")

# äºˆæ¸¬åç‡ï¼ˆæœ€é©æ¡ä»¶ï¼‰
predicted_yield_max = doe_table['Yield'].mean() + abs(temp_effect)/2 + abs(cat_effect)/2 + abs(time_effect)/2
print(f"  äºˆæ¸¬åç‡: {predicted_yield_max:.1f}%")

# ä¸»åŠ¹æœå›³ã®å¯è¦–åŒ–
fig, axes = plt.subplots(1, 3, figsize=(16, 5))

# æ¸©åº¦ã®ä¸»åŠ¹æœ
axes[0].plot([60, 80], [temp_low, temp_high],
             marker='o', linewidth=2.5, markersize=10, color='#11998e')
axes[0].axhline(y=doe_table['Yield'].mean(), color='red', linestyle='--',
                linewidth=1.5, label='å…¨ä½“å¹³å‡', alpha=0.7)
axes[0].set_xlabel('åå¿œæ¸©åº¦ (Â°C)', fontsize=12)
axes[0].set_ylabel('å¹³å‡åç‡ (%)', fontsize=12)
axes[0].set_title('æ¸©åº¦ã®ä¸»åŠ¹æœ', fontsize=14, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# è§¦åª’æ¿ƒåº¦ã®ä¸»åŠ¹æœ
axes[1].plot([0.1, 0.5], [cat_low, cat_high],
             marker='s', linewidth=2.5, markersize=10, color='#f59e0b')
axes[1].axhline(y=doe_table['Yield'].mean(), color='red', linestyle='--',
                linewidth=1.5, label='å…¨ä½“å¹³å‡', alpha=0.7)
axes[1].set_xlabel('è§¦åª’æ¿ƒåº¦ (M)', fontsize=12)
axes[1].set_ylabel('å¹³å‡åç‡ (%)', fontsize=12)
axes[1].set_title('è§¦åª’æ¿ƒåº¦ã®ä¸»åŠ¹æœ', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

# åå¿œæ™‚é–“ã®ä¸»åŠ¹æœ
axes[2].plot([2, 4], [time_low, time_high],
             marker='^', linewidth=2.5, markersize=10, color='#7b2cbf')
axes[2].axhline(y=doe_table['Yield'].mean(), color='red', linestyle='--',
                linewidth=1.5, label='å…¨ä½“å¹³å‡', alpha=0.7)
axes[2].set_xlabel('åå¿œæ™‚é–“ (æ™‚é–“)', fontsize=12)
axes[2].set_ylabel('å¹³å‡åç‡ (%)', fontsize=12)
axes[2].set_title('åå¿œæ™‚é–“ã®ä¸»åŠ¹æœ', fontsize=14, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

plt.tight_layout()
plt.savefig('esterification_main_effects.png', dpi=300, bbox_inches='tight')
plt.show()

# ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã§çµæœã‚’å¯è¦–åŒ–
pivot_temp_cat = doe_table.pivot_table(values='Yield',
                                        index='Temperature',
                                        columns='Catalyst',
                                        aggfunc='mean')

plt.figure(figsize=(8, 6))
sns.heatmap(pivot_temp_cat, annot=True, fmt='.1f', cmap='RdYlGn',
            cbar_kws={'label': 'åç‡ (%)'}, linewidths=2, linecolor='white')
plt.title('æ¸©åº¦Ã—è§¦åª’æ¿ƒåº¦ã®åç‡ãƒãƒƒãƒ—', fontsize=14, fontweight='bold')
plt.ylabel('æ¸©åº¦ (Â°C)', fontsize=12)
plt.xlabel('è§¦åª’æ¿ƒåº¦ (M)', fontsize=12)
plt.tight_layout()
plt.savefig('esterification_heatmap.png', dpi=300, bbox_inches='tight')
plt.show()

print("\n=== ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã®ã¾ã¨ã‚ ===")
print("âœ… ç›´äº¤è¡¨L8ã«ã‚ˆã‚Š8å›ã®å®Ÿé¨“ã§3å› å­ã®å½±éŸ¿ã‚’è©•ä¾¡")
print("âœ… è§¦åª’æ¿ƒåº¦ãŒæœ€ã‚‚é‡è¦ãªå› å­ã¨åˆ¤æ˜")
print("âœ… æœ€é©æ¡ä»¶: 80Â°C, 0.5 M, 4æ™‚é–“")
print(f"âœ… äºˆæ¸¬åç‡: {predicted_yield_max:.1f}%ï¼ˆç¢ºèªå®Ÿé¨“ã§æ¤œè¨¼æ¨å¥¨ï¼‰")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ã‚¨ã‚¹ãƒ†ãƒ«åŒ–åå¿œ å®Ÿé¨“è¨ˆç”»ã¨çµæœ ===
   Run  Temperature  Catalyst  Time      Yield
0    1           60       0.1     2  50.987420
1    2           60       0.1     4  60.723869
2    3           60       0.5     2  70.294968
3    4           60       0.5     4  80.046738
4    5           80       0.1     2  65.296378
5    6           80       0.1     4  75.044464
6    7           80       0.5     2  90.466514
7    8           80       0.5     4 100.535989

=== ä¸»åŠ¹æœåˆ†æ ===
æ¸©åº¦ã®åŠ¹æœ: 15.09% (ä½æ°´æº–: 65.51%, é«˜æ°´æº–: 80.59%)
è§¦åª’æ¿ƒåº¦ã®åŠ¹æœ: 20.25% (ä½æ°´æº–: 63.01%, é«˜æ°´æº–: 83.26%)
åå¿œæ™‚é–“ã®åŠ¹æœ: 9.99% (ä½æ°´æº–: 68.14%, é«˜æ°´æº–: 78.13%)

=== å› å­ã®é‡è¦åº¦ãƒ©ãƒ³ã‚­ãƒ³ã‚° ===
1ä½: è§¦åª’æ¿ƒåº¦ (åŠ¹æœ: 20.25%)
2ä½: æ¸©åº¦ (åŠ¹æœ: 15.09%)
3ä½: åå¿œæ™‚é–“ (åŠ¹æœ: 9.99%)

=== æœ€é©æ¡ä»¶ ===
åç‡ã‚’æœ€å¤§åŒ–ã™ã‚‹æ¡ä»¶:
  æ¸©åº¦: 80Â°C
  è§¦åª’æ¿ƒåº¦: 0.5 M
  åå¿œæ™‚é–“: 4æ™‚é–“
  äºˆæ¸¬åç‡: 95.7%

=== ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã®ã¾ã¨ã‚ ===
âœ… ç›´äº¤è¡¨L8ã«ã‚ˆã‚Š8å›ã®å®Ÿé¨“ã§3å› å­ã®å½±éŸ¿ã‚’è©•ä¾¡
âœ… è§¦åª’æ¿ƒåº¦ãŒæœ€ã‚‚é‡è¦ãªå› å­ã¨åˆ¤æ˜
âœ… æœ€é©æ¡ä»¶: 80Â°C, 0.5 M, 4æ™‚é–“
âœ… äºˆæ¸¬åç‡: 95.7%ï¼ˆç¢ºèªå®Ÿé¨“ã§æ¤œè¨¼æ¨å¥¨ï¼‰
</code></pre>

<p><strong>è§£é‡ˆ</strong>: ç›´äº¤è¡¨L8ã«ã‚ˆã‚Šã€ã‚ãšã‹8å›ã®å®Ÿé¨“ã§3å› å­ã®å½±éŸ¿ã‚’åŠ¹ç‡çš„ã«è©•ä¾¡ã—ã€æœ€é©æ¡ä»¶ã‚’æ±ºå®šã§ãã¾ã—ãŸã€‚å¾“æ¥ã®ä¸€å¤‰æ•°å®Ÿé¨“ã§ã¯æœ€ä½ã§ã‚‚3Ã—2Ã—2Ã—2=24å›å¿…è¦ã§ã—ãŸãŒã€DOEã«ã‚ˆã‚Šå®Ÿé¨“å›æ•°ã‚’67%å‰Šæ¸›ã—ã¾ã—ãŸã€‚</p>

<hr />

<h2>1.6 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><strong>å®Ÿé¨“è¨ˆç”»æ³•ï¼ˆDOEï¼‰ã®åŸºç¤</strong>
<ul>
<li>æœ€å°ã®å®Ÿé¨“å›æ•°ã§æœ€å¤§ã®æƒ…å ±ã‚’å¾—ã‚‹çµ±è¨ˆçš„æ‰‹æ³•</li>
<li>å¾“æ¥ã®OFATï¼ˆä¸€å¤‰æ•°å®Ÿé¨“ï¼‰ã¨ã®é•ã„</li>
<li>DOEã®3åŸå‰‡: åå¾©ã€ç„¡ä½œç‚ºåŒ–ã€ãƒ–ãƒ­ãƒƒã‚¯åŒ–</li>
</ul>
</li>
<li><strong>ä¸€å…ƒé…ç½®ãƒ»äºŒå…ƒé…ç½®å®Ÿé¨“</strong>
<ul>
<li>ä¸€å…ƒé…ç½®ANOVA: 1å› å­ã®æ°´æº–é–“æ¯”è¼ƒ</li>
<li>äºŒå…ƒé…ç½®ANOVA: 2å› å­ã®ä¸»åŠ¹æœã¨äº¤äº’ä½œç”¨</li>
<li>Fæ¤œå®šã«ã‚ˆã‚‹çµ±è¨ˆçš„æœ‰æ„æ€§ã®åˆ¤å®š</li>
</ul>
</li>
<li><strong>ç›´äº¤è¡¨ã®æ´»ç”¨</strong>
<ul>
<li>ç›´äº¤è¡¨L8, L16ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªå®Ÿé¨“è¨­è¨ˆ</li>
<li>å„å› å­ã®æ°´æº–ãŒå‡ç­‰ã«å‡ºç¾ã™ã‚‹æ€§è³ª</li>
<li>å®Ÿé¨“å›æ•°ã®å¤§å¹…å‰Šæ¸›ï¼ˆ50-75%ï¼‰</li>
</ul>
</li>
<li><strong>ä¸»åŠ¹æœå›³ã¨äº¤äº’ä½œç”¨å›³</strong>
<ul>
<li>ä¸»åŠ¹æœ: å„å› å­ã®å˜ç‹¬åŠ¹æœã®å¯è¦–åŒ–</li>
<li>äº¤äº’ä½œç”¨: å› å­é–“ã®ç›¸äº’ä½œç”¨ã®æ¤œå‡º</li>
<li>æœ€é©æ¡ä»¶ã®æ±ºå®šæ–¹æ³•</li>
</ul>
</li>
<li><strong>åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã¸ã®å¿œç”¨</strong>
<ul>
<li>ã‚¨ã‚¹ãƒ†ãƒ«åŒ–åå¿œã®åç‡æœ€é©åŒ–</li>
<li>é‡è¦å› å­ã®ç‰¹å®šã¨æœ€é©æ¡ä»¶ã®æ¢ç´¢</li>
<li>äºˆæ¸¬åç‡ã®è¨ˆç®—ã¨ç¢ºèªå®Ÿé¨“ã®å¿…è¦æ€§</li>
</ul>
</li>
</ol>

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

<ul>
<li>DOEã¯å®Ÿé¨“å›æ•°ã‚’50-75%å‰Šæ¸›ã—ãªãŒã‚‰äº¤äº’ä½œç”¨ã‚‚è©•ä¾¡å¯èƒ½</li>
<li>ç›´äº¤è¡¨ã¯å› å­ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆé‡è¦å› å­ã®ç‰¹å®šï¼‰ã«æœ€é©</li>
<li>ä¸»åŠ¹æœå›³ã§å› å­ã®å½±éŸ¿åº¦ã‚’è¦–è¦šçš„ã«ç†è§£ã§ãã‚‹</li>
<li>äº¤äº’ä½œç”¨ãƒ—ãƒ­ãƒƒãƒˆã§ç·šãŒå¹³è¡Œã§ãªã„å ´åˆã€äº¤äº’ä½œç”¨ãŒå­˜åœ¨</li>
<li>æœ€é©æ¡ä»¶ã¯ä¸»åŠ¹æœãŒæœ€å¤§ã¨ãªã‚‹æ°´æº–ã®çµ„ã¿åˆã‚ã›</li>
</ul>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬2ç« ã§ã¯ã€<strong>è¦å› é…ç½®å®Ÿé¨“ã¨åˆ†æ•£åˆ†æ</strong>ã‚’è©³ã—ãå­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>å®Œå…¨è¦å› é…ç½®å®Ÿé¨“ï¼ˆFull Factorial Designï¼‰</li>
<li>ä¸€éƒ¨å®Ÿæ–½è¦å› é…ç½®å®Ÿé¨“ï¼ˆFractional Factorial Designï¼‰</li>
<li>åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰ã®è©³ç´°ã¨Fæ¤œå®š</li>
<li>å¤šé‡æ¯”è¼ƒæ¤œå®šï¼ˆTukey HSDï¼‰</li>
<li>åˆ†æ•£æˆåˆ†ã®åˆ†è§£ã¨å¯„ä¸ç‡ã®è¨ˆç®—</li>
<li>ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£: è§¦åª’æ´»æ€§ã«å½±éŸ¿ã™ã‚‹å› å­æ¢ç´¢</li>
</ul>

<div class="navigation">
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-2.html" class="nav-button">æ¬¡ã®ç«  â†’</a>
</div>
    </main>


    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: PI Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-26</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 PI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
