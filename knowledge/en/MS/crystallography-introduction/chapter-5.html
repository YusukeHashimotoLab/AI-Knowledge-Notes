<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 5: Practical Crystallographic Computing with pymatgen - MS Terakoya</title>

        <link rel="stylesheet" href="../../assets/css/knowledge-base.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Chapter 5: Practical Crystallographic Computing with pymatgen</h1>
            <p class="subtitle">From Materials Project Integration to Practical Workflows</p>
            <div class="meta">
                <span class="meta-item">ðŸ“– Estimated Learning Time: 30-36 minutes</span>
                <span class="meta-item">ðŸŽ¯ Difficulty: Intermediate</span>
                <span class="meta-item">ðŸ’» Code Examples: 8</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AI Terakoya Top</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">Introduction to Crystallography</a> &gt;
        Chapter 5
    </div>

    <div class="container">
        <div class="learning-objectives">
            <h2>Learning Objectives</h2>
            <p>By completing this final chapter, you will acquire the following practical skills:</p>
            <ul>
                <li>Understand basic usage of the <strong>pymatgen library</strong> and manipulate Structure objects</li>
                <li>Read and write <strong>CIF files</strong></li>
                <li>Retrieve crystal structures from databases using the <strong>Materials Project API</strong></li>
                <li>Perform <strong>crystal structure transformations</strong> (supercells, slab models)</li>
                <li>Conduct <strong>symmetry analysis</strong> (space group identification, Wyckoff positions)</li>
                <li>Perform <strong>crystal structure visualization</strong> (2D/3D)</li>
                <li>Execute <strong>practical workflows</strong> (data acquisition â†’ analysis â†’ visualization)</li>
                <li>Establish a <strong>solid foundation</strong> for Materials Informatics research</li>
            </ul>
        </div>

        <h2>1. Overview of pymatgen and Environment Setup</h2>

        <h3>1.1 What is pymatgen?</h3>

        <p>
            <strong>pymatgen (Python Materials Genomics)</strong> is a comprehensive Python library for materials science.
            Developed by the MIT Materials Project research group, it is widely used in crystal structure analysis, first-principles calculations, and Materials Informatics research.
        </p>

        <div class="info-box">
            <h4>Key Features of pymatgen</h4>
            <ul>
                <li><strong>Crystal structure representation and manipulation</strong>: Managing atomic arrangements through Structure objects</li>
                <li><strong>CIF file reading and writing</strong>: Integration with crystal structure databases</li>
                <li><strong>Symmetry analysis</strong>: Automatic space group recognition, Wyckoff position calculation</li>
                <li><strong>Materials Project integration</strong>: Access to a database of over 140,000 materials</li>
                <li><strong>Structure transformations</strong>: Supercells, surface models, doping</li>
                <li><strong>Physical property calculations</strong>: XRD patterns, density of states, band structures</li>
                <li><strong>First-principles calculation integration</strong>: Input/output for VASP, Quantum ESPRESSO, etc.</li>
            </ul>
        </div>

        <h3>1.2 Installation and Setup</h3>

        <div class="example-box">
            <h4>Installation Procedure</h4>
        </div>

        <pre class="line-numbers"><code class="language-python"># Execute in terminal/command prompt
# Basic installation
pip install pymatgen

# For Materials Project API integration (recommended)
pip install mp-api

# Install visualization libraries together
pip install matplotlib numpy scipy plotly

# Verify installation
python -c "import pymatgen; print(pymatgen.__version__)"
# Example output: 2024.10.3
</code></pre>

        <div class="warning-box">
            <h4>Obtaining a Materials Project API Key</h4>
            <p>To access the Materials Project database, you need a free API key:</p>
            <ol>
                <li>Visit the <a href="https://next-gen.materialsproject.org/" target="_blank">Materials Project official site</a></li>
                <li>Create a free account via "Sign Up" in the upper right</li>
                <li>After logging in, navigate to the "API" section</li>
                <li>Click "Generate API Key" to create a new API key</li>
                <li>Copy the displayed API key (e.g., <code>abc123xyz...</code>)</li>
                <li>Set it as an environment variable or use in your script</li>
            </ol>
            <p><strong>Security Note</strong>: Your API key is confidential information. Do not commit it to GitHub or other repositories.</p>
        </div>

        <h2>2. Basic Operations with Structure Objects</h2>

        <h3>2.1 Creating Crystal Structures and Retrieving Information</h3>

        <div class="example-box">
            <h4>Code Example 1: Basic Structure Object Operations</h4>
            <p>Create the diamond structure of silicon (Si) and retrieve basic information:</p>
        </div>

        <pre class="line-numbers"><code class="language-python">from pymatgen.core import Structure, Lattice
import numpy as np

# Create silicon with diamond structure
# Define lattice vectors (cubic, a = 5.43 Ã…)
a = 5.43
lattice = Lattice.cubic(a)

# Atom species and fractional coordinates
species = ['Si'] * 8
coords = [
    [0.00, 0.00, 0.00],  # FCC lattice points
    [0.50, 0.50, 0.00],
    [0.50, 0.00, 0.50],
    [0.00, 0.50, 0.50],
    [0.25, 0.25, 0.25],  # Tetrahedral interstices
    [0.75, 0.75, 0.25],
    [0.75, 0.25, 0.75],
    [0.25, 0.75, 0.75]
]

# Create Structure object
si_structure = Structure(lattice, species, coords)

print("=== Silicon (Si) Crystal Structure Information ===\n")

# Retrieve basic information
print(f"Composition: {si_structure.composition}")
print(f"Formula: {si_structure.formula}")
print(f"Unit cell volume: {si_structure.volume:.4f} Ã…Â³")
print(f"Density: {si_structure.density:.4f} g/cmÂ³")
print(f"Number of atoms: {len(si_structure)}")

# Retrieve lattice parameters
print(f"\nLattice parameters:")
print(f"  a = {si_structure.lattice.a:.4f} Ã…")
print(f"  b = {si_structure.lattice.b:.4f} Ã…")
print(f"  c = {si_structure.lattice.c:.4f} Ã…")
print(f"  Î± = {si_structure.lattice.alpha:.2f}Â°")
print(f"  Î² = {si_structure.lattice.beta:.2f}Â°")
print(f"  Î³ = {si_structure.lattice.gamma:.2f}Â°")

# Information for each atom
print(f"\nAtomic coordinates:")
print(f"{'Atom':<8} {'Fractional coords (x, y, z)':<30} {'Cartesian coords (Ã…)':<25}")
print("-" * 65)

for i, site in enumerate(si_structure):
    species = site.species_string
    frac_coords = site.frac_coords
    cart_coords = site.coords

    print(f"{species:<8} ({frac_coords[0]:6.3f}, {frac_coords[1]:6.3f}, {frac_coords[2]:6.3f})    "
          f"({cart_coords[0]:6.3f}, {cart_coords[1]:6.3f}, {cart_coords[2]:6.3f})")

# Nearest neighbor distances
print(f"\nNearest neighbor distances:")
neighbors = si_structure.get_neighbors(si_structure[0], 3.0)
for neighbor, distance in neighbors:
    print(f"  {distance:.4f} Ã…")
</code></pre>
