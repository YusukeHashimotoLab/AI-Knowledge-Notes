<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: Fundamentals of Crystallography and Lattice Concepts - MS Terakoya</title>

        <link rel="stylesheet" href="../../assets/css/knowledge-base.css">

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Chapter 1: Fundamentals of Crystallography and Lattice Concepts</h1>
            <p class="subtitle">Understanding the Regularity and Beauty of Atomic Arrangements</p>
            <div class="meta">
                <span class="meta-item">üìñ Reading Time: 26-32 minutes</span>
                <span class="meta-item">üìä Difficulty: Introductory</span>
                <span class="meta-item">üíª Code Examples: 8</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AI Terakoya Top</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">Introduction to Crystallography</a> &gt;
        Chapter 1
    </div>

    <main class="container">
        <p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); border-left: 4px solid #f093fb; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">
            Crystallography is the discipline that studies the regularity of atomic arrangements in materials. In this chapter, we will learn the differences between crystalline and amorphous materials, the concepts of lattice points and unit cells, and the characteristics of the seven crystal systems. Let's step into the beautiful world of crystallography while visualizing lattice structures with Python.
        </p>

        <div class="learning-objectives">
            <h2>Learning Objectives</h2>
            <p>By reading this chapter, you will master the following:</p>
            <ul>
                <li>‚úÖ Understand the differences between crystalline and amorphous materials</li>
                <li>‚úÖ Master the concepts of lattice points, unit cells, and lattice parameters</li>
                <li>‚úÖ Understand the characteristics of the seven crystal systems</li>
                <li>‚úÖ Understand the meaning of lattice parameters (a, b, c, Œ±, Œ≤, Œ≥)</li>
                <li>‚úÖ Visualize basic lattice structures using Python</li>
            </ul>
        </div>

        <hr>

        <h2>1.1 What is Crystallography?</h2>

        <h3>Definition and Importance of Crystallography</h3>

        <p><strong>Crystallography</strong> is the scientific discipline that studies the atomic arrangement, symmetry, and structure of crystals. It serves as foundational knowledge in many fields including materials science, chemistry, physics, mineralogy, and biology.</p>

        <blockquote>
            <strong>Crystallography</strong> is the discipline that studies the internal structure, symmetry, and physical/chemical properties of crystalline materials.
        </blockquote>

        <p><strong>Why Crystallography is Important</strong>:</p>
        <ul>
            <li><strong>Understanding Material Properties</strong>: Atomic arrangements determine mechanical, electrical, and optical properties</li>
            <li><strong>Materials Design</strong>: Foundation for designing materials with desired properties</li>
            <li><strong>X-ray Diffraction Analysis</strong>: Basis for techniques that experimentally determine crystal structures</li>
            <li><strong>New Materials Development</strong>: Applications in various fields including semiconductors, catalysts, and pharmaceuticals</li>
        </ul>

        <h3>Differences Between Crystalline and Amorphous Materials</h3>

        <p>There are two broad patterns of atomic arrangements in materials:</p>

        <h4>1. Crystalline (Crystal)</h4>

        <p><strong>Definition</strong>: A material in which atoms or molecules are <strong>arranged regularly</strong></p>

        <p><strong>Characteristics</strong>:</p>
        <ul>
            <li><strong>Long-range Order</strong>: The regularity of atomic arrangement extends over long distances</li>
            <li><strong>Periodicity</strong>: The same pattern repeats</li>
            <li><strong>Anisotropy</strong>: Properties differ depending on direction (e.g., cleavage, refractive index)</li>
            <li><strong>Sharp Melting Point</strong>: Transitions from solid to liquid at a constant temperature</li>
            <li><strong>Sharp X-ray Diffraction Peaks</strong>: Strong diffraction at specific angles due to regular structure</li>
        </ul>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li><strong>Sodium Chloride (NaCl)</strong>: Table salt, cubic crystal system</li>
            <li><strong>Silicon (Si)</strong>: Semiconductor, diamond structure</li>
            <li><strong>Iron (Fe)</strong>: Structural material, body-centered cubic lattice</li>
            <li><strong>Quartz (SiO‚ÇÇ)</strong>: Hexagonal crystal system</li>
        </ul>

        <h4>2. Amorphous</h4>

        <p><strong>Definition</strong>: A material in which atoms or molecules are <strong>arranged irregularly</strong></p>

        <p><strong>Characteristics</strong>:</p>
        <ul>
            <li><strong>Short-range Order Only</strong>: Regular at short distances but disordered at long distances</li>
            <li><strong>No Periodicity</strong>: No repeating pattern exists</li>
            <li><strong>Isotropy</strong>: Properties are the same in all directions</li>
            <li><strong>Glass Transition Temperature</strong>: Gradually softens (no clear melting point)</li>
            <li><strong>Broad X-ray Diffraction Pattern</strong>: No sharp peaks appear</li>
        </ul>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li><strong>Glass (SiO‚ÇÇ glass)</strong>: Window glass, optical fiber</li>
            <li><strong>Amorphous Silicon (a-Si)</strong>: Solar cells, thin-film transistors</li>
            <li><strong>Polymer Glass</strong>: Polystyrene, PMMA</li>
            <li><strong>Metallic Glass</strong>: Alloys produced by rapid solidification</li>
        </ul>

        <h4>Comparison Table of Crystalline and Amorphous Materials</h4>

        <table>
            <thead>
                <tr>
                    <th>Property</th>
                    <th>Crystalline</th>
                    <th>Amorphous</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Atomic Arrangement</strong></td>
                    <td>Regular (long-range order)</td>
                    <td>Irregular (short-range order only)</td>
                </tr>
                <tr>
                    <td><strong>Periodicity</strong></td>
                    <td>Present</td>
                    <td>Absent</td>
                </tr>
                <tr>
                    <td><strong>Symmetry</strong></td>
                    <td>High (point group, space group)</td>
                    <td>Low (isotropic)</td>
                </tr>
                <tr>
                    <td><strong>Anisotropy</strong></td>
                    <td>Present (direction dependent)</td>
                    <td>Absent (isotropic)</td>
                </tr>
                <tr>
                    <td><strong>Melting</strong></td>
                    <td>Sharp melting point</td>
                    <td>Glass transition (gradual softening)</td>
                </tr>
                <tr>
                    <td><strong>X-ray Diffraction</strong></td>
                    <td>Sharp peaks (Bragg reflection)</td>
                    <td>Broad halo</td>
                </tr>
                <tr>
                    <td><strong>Density</strong></td>
                    <td>High (high packing efficiency)</td>
                    <td>Somewhat lower (more voids)</td>
                </tr>
                <tr>
                    <td><strong>Thermodynamic Stability</strong></td>
                    <td>Stable (minimum free energy)</td>
                    <td>Metastable (can crystallize)</td>
                </tr>
            </tbody>
        </table>

        <h3>Concepts of Periodicity and Symmetry</h3>

        <p>There are two important concepts for understanding crystal structures:</p>

        <h4>1. Periodicity</h4>

        <p><strong>Definition</strong>: The repetition of the same pattern at regular intervals</p>

        <p>In crystals, atomic arrangements repeat periodically in three-dimensional space. The minimum repeating unit is called the <strong>unit cell</strong>.</p>

        <p><strong>Mathematical Expression</strong>:</p>
        <p>When an atom exists at position $\vec{r}$, the same atomic arrangement also exists at the following positions:</p>
        <p>$$\vec{r}' = \vec{r} + n_1\vec{a} + n_2\vec{b} + n_3\vec{c}$$</p>
        <p>where $\vec{a}, \vec{b}, \vec{c}$ are lattice vectors and $n_1, n_2, n_3$ are integers.</p>

        <h4>2. Symmetry</h4>

        <p><strong>Definition</strong>: The property of being indistinguishable from the original state after performing a certain operation</p>

        <p><strong>Types of Symmetry Operations</strong>:</p>
        <ul>
            <li><strong>Translational Symmetry (Translation)</strong>: Parallel displacement in a certain direction</li>
            <li><strong>Rotational Symmetry (Rotation)</strong>: Rotation around an axis (1-fold, 2-fold, 3-fold, 4-fold, 6-fold symmetry)</li>
            <li><strong>Mirror Symmetry (Reflection)</strong>: Inversion with respect to a mirror plane</li>
            <li><strong>Inversion Symmetry (Inversion)</strong>: Inversion with respect to a point</li>
        </ul>

        <p><strong>Important Constraint</strong>: In crystals, rotational symmetries compatible with periodicity are <strong>only 1-fold, 2-fold, 3-fold, 4-fold, and 6-fold</strong> (5-fold symmetry does not exist).</p>

        <hr>

        <h2>1.2 Lattice Points and Unit Cells</h2>

        <h3>Lattice Point</h3>

        <p><strong>Definition</strong>: A reference point of a periodically repeating structure</p>

        <p>A lattice point is not the atom itself, but <strong>an abstract point indicating positions with identical atomic arrangements</strong>. The environment surrounding all lattice points is identical.</p>

        <p><strong>Important Properties</strong>:</p>
        <ul>
            <li>All lattice points are equivalent</li>
            <li>The atomic arrangement as seen from any lattice point is the same</li>
            <li>The arrangement of lattice points alone does not reveal the types or positions of atoms</li>
        </ul>

        <h3>Unit Cell</h3>

        <p><strong>Definition</strong>: The minimum repeating unit that represents the crystal structure</p>

        <p>By repeatedly arranging the unit cell in three-dimensional space, an infinitely extending crystal structure can be constructed.</p>

        <p><strong>Ways to Choose a Unit Cell</strong>:</p>
        <ul>
            <li><strong>Primitive Cell</strong>: The minimum unit with lattice points only at vertices (contains 1 lattice point)</li>
            <li><strong>Conventional Cell</strong>: A unit that easily expresses symmetry (may contain multiple lattice points)</li>
        </ul>

        <h3>Lattice Parameters</h3>

        <p>The shape of a unit cell is completely described by <strong>six lattice parameters</strong>:</p>

        <h4>Length Parameters (3)</h4>
        <ul>
            <li><strong>$a$</strong>: Length of the unit cell in the x-direction (unit: √Ö = 10‚Åª¬π‚Å∞ m)</li>
            <li><strong>$b$</strong>: Length of the unit cell in the y-direction</li>
            <li><strong>$c$</strong>: Length of the unit cell in the z-direction</li>
        </ul>

        <h4>Angle Parameters (3)</h4>
        <ul>
            <li><strong>$\alpha$</strong>: Angle between $b$ and $c$ (unit: ¬∞)</li>
            <li><strong>$\beta$</strong>: Angle between $c$ and $a$</li>
            <li><strong>$\gamma$</strong>: Angle between $a$ and $b$</li>
        </ul>

        <p><strong>Unit Cell Volume</strong>:</p>
        <p>From the lattice parameters, the volume $V$ of the unit cell can be calculated:</p>
        <p>$$V = abc\sqrt{1 - \cos^2\alpha - \cos^2\beta - \cos^2\gamma + 2\cos\alpha\cos\beta\cos\gamma}$$</p>

        <p>In special cases, simpler formulas apply:</p>
        <ul>
            <li><strong>Cubic</strong>: $V = a^3$</li>
            <li><strong>Tetragonal</strong>: $V = a^2c$</li>
            <li><strong>Orthorhombic</strong>: $V = abc$</li>
        </ul>

        <hr>

        <h2>1.3 The Seven Crystal Systems</h2>

        <p>All crystal structures are classified into <strong>seven crystal systems</strong> based on symmetry. This is determined by the relationships among lattice parameters and symmetry.</p>

        <div class="mermaid">
graph TD
    A[Seven Crystal Systems] --> B[Triclinic]
    A --> C[Monoclinic]
    A --> D[Orthorhombic]
    A --> E[Tetragonal]
    A --> F[Hexagonal]
    A --> G[Trigonal]
    A --> H[Cubic]

    B --> B1[Lowest Symmetry<br/>a‚â†b‚â†c, Œ±‚â†Œ≤‚â†Œ≥‚â†90¬∞]
    C --> C1[One 2-fold Axis<br/>a‚â†b‚â†c, Œ±=Œ≥=90¬∞‚â†Œ≤]
    D --> D1[Three Perpendicular 2-fold Axes<br/>a‚â†b‚â†c, Œ±=Œ≤=Œ≥=90¬∞]
    E --> E1[One 4-fold Axis<br/>a=b‚â†c, Œ±=Œ≤=Œ≥=90¬∞]
    F --> F1[One 6-fold Axis<br/>a=b‚â†c, Œ±=Œ≤=90¬∞, Œ≥=120¬∞]
    G --> G1[One 3-fold Axis<br/>a=b=c, Œ±=Œ≤=Œ≥‚â†90¬∞]
    H --> H1[Highest Symmetry<br/>a=b=c, Œ±=Œ≤=Œ≥=90¬∞]

    style A fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style B fill:#fce7f3,stroke:#f093fb,stroke-width:1px
    style C fill:#fce7f3,stroke:#f093fb,stroke-width:1px
    style D fill:#fce7f3,stroke:#f093fb,stroke-width:1px
    style E fill:#fce7f3,stroke:#f093fb,stroke-width:1px
    style F fill:#fce7f3,stroke:#f093fb,stroke-width:1px
    style G fill:#fce7f3,stroke:#f093fb,stroke-width:1px
    style H fill:#fce7f3,stroke:#f093fb,stroke-width:1px
        </div>

        <h3>1. Triclinic</h3>

        <p><strong>Lattice Parameter Relationships</strong>:</p>
        <p>$$a \neq b \neq c, \quad \alpha \neq \beta \neq \gamma \neq 90¬∞$$</p>

        <p><strong>Symmetry</strong>: Lowest (translation and inversion only)</p>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li>Feldspar (Albite, NaAlSi‚ÇÉO‚Çà)</li>
            <li>Copper sulfate pentahydrate (CuSO‚ÇÑ¬∑5H‚ÇÇO)</li>
        </ul>

        <h3>2. Monoclinic</h3>

        <p><strong>Lattice Parameter Relationships</strong>:</p>
        <p>$$a \neq b \neq c, \quad \alpha = \gamma = 90¬∞ \neq \beta$$</p>

        <p><strong>Symmetry</strong>: One 2-fold rotation axis or mirror plane</p>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li>Gypsum (CaSO‚ÇÑ¬∑2H‚ÇÇO)</li>
            <li>Monoclinic sulfur (S)</li>
        </ul>

        <h3>3. Orthorhombic</h3>

        <p><strong>Lattice Parameter Relationships</strong>:</p>
        <p>$$a \neq b \neq c, \quad \alpha = \beta = \gamma = 90¬∞$$</p>

        <p><strong>Symmetry</strong>: Three mutually perpendicular 2-fold rotation axes</p>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li>Orthorhombic sulfur (Œ±-S)</li>
            <li>Topaz (Al‚ÇÇSiO‚ÇÑ(F,OH)‚ÇÇ)</li>
            <li>Barite (BaSO‚ÇÑ)</li>
        </ul>

        <h3>4. Tetragonal</h3>

        <p><strong>Lattice Parameter Relationships</strong>:</p>
        <p>$$a = b \neq c, \quad \alpha = \beta = \gamma = 90¬∞$$</p>

        <p><strong>Symmetry</strong>: One 4-fold rotation axis (c-axis)</p>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li>Rutile titanium dioxide (TiO‚ÇÇ)</li>
            <li>Zircon (ZrSiO‚ÇÑ)</li>
            <li>Tin (Œ≤-Sn, white tin)</li>
        </ul>

        <h3>5. Hexagonal</h3>

        <p><strong>Lattice Parameter Relationships</strong>:</p>
        <p>$$a = b \neq c, \quad \alpha = \beta = 90¬∞, \quad \gamma = 120¬∞$$</p>

        <p><strong>Symmetry</strong>: One 6-fold rotation axis (c-axis)</p>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li>Quartz (Œ±-SiO‚ÇÇ)</li>
            <li>Beryllium (Be)</li>
            <li>Magnesium (Mg)</li>
            <li>Zinc (Zn)</li>
            <li>Graphite (C)</li>
        </ul>

        <h3>6. Trigonal / Rhombohedral</h3>

        <p><strong>Lattice Parameter Relationships</strong>:</p>
        <p>$$a = b = c, \quad \alpha = \beta = \gamma \neq 90¬∞$$</p>

        <p><strong>Symmetry</strong>: One 3-fold rotation axis</p>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li>Calcite (CaCO‚ÇÉ)</li>
            <li>Corundum (Œ±-Al‚ÇÇO‚ÇÉ)</li>
            <li>Mercury (Hg, low-temperature phase)</li>
        </ul>

        <p><strong>Note</strong>: The trigonal crystal system is sometimes described with hexagonal lattices (hexagonal lattice + 3-fold rotation axis).</p>

        <h3>7. Cubic</h3>

        <p><strong>Lattice Parameter Relationships</strong>:</p>
        <p>$$a = b = c, \quad \alpha = \beta = \gamma = 90¬∞$$</p>

        <p><strong>Symmetry</strong>: Highest (four 3-fold rotation axes)</p>

        <p><strong>Representative Examples</strong>:</p>
        <ul>
            <li>Sodium chloride (NaCl)</li>
            <li>Diamond (C)</li>
            <li>Silicon (Si)</li>
            <li>Iron (Œ±-Fe, ferrite)</li>
            <li>Copper (Cu)</li>
            <li>Gold (Au)</li>
        </ul>

        <h3>Comparison Table of the Seven Crystal Systems</h3>

        <table>
            <thead>
                <tr>
                    <th>Crystal System</th>
                    <th>Axis Length Relationship</th>
                    <th>Angle Relationship</th>
                    <th>Key Symmetry Element</th>
                    <th>Representative Examples</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Triclinic</strong></td>
                    <td>$a \neq b \neq c$</td>
                    <td>$\alpha \neq \beta \neq \gamma \neq 90¬∞$</td>
                    <td>Inversion center only</td>
                    <td>Feldspar, CuSO‚ÇÑ¬∑5H‚ÇÇO</td>
                </tr>
                <tr>
                    <td><strong>Monoclinic</strong></td>
                    <td>$a \neq b \neq c$</td>
                    <td>$\alpha = \gamma = 90¬∞ \neq \beta$</td>
                    <td>One 2-fold axis</td>
                    <td>Gypsum, monoclinic sulfur</td>
                </tr>
                <tr>
                    <td><strong>Orthorhombic</strong></td>
                    <td>$a \neq b \neq c$</td>
                    <td>$\alpha = \beta = \gamma = 90¬∞$</td>
                    <td>Three perpendicular 2-fold axes</td>
                    <td>Orthorhombic sulfur, BaSO‚ÇÑ</td>
                </tr>
                <tr>
                    <td><strong>Tetragonal</strong></td>
                    <td>$a = b \neq c$</td>
                    <td>$\alpha = \beta = \gamma = 90¬∞$</td>
                    <td>One 4-fold axis</td>
                    <td>TiO‚ÇÇ, Œ≤-Sn</td>
                </tr>
                <tr>
                    <td><strong>Hexagonal</strong></td>
                    <td>$a = b \neq c$</td>
                    <td>$\alpha = \beta = 90¬∞, \gamma = 120¬∞$</td>
                    <td>One 6-fold axis</td>
                    <td>Quartz, Mg, Zn</td>
                </tr>
                <tr>
                    <td><strong>Trigonal</strong></td>
                    <td>$a = b = c$</td>
                    <td>$\alpha = \beta = \gamma \neq 90¬∞$</td>
                    <td>One 3-fold axis</td>
                    <td>CaCO‚ÇÉ, Œ±-Al‚ÇÇO‚ÇÉ</td>
                </tr>
                <tr>
                    <td><strong>Cubic</strong></td>
                    <td>$a = b = c$</td>
                    <td>$\alpha = \beta = \gamma = 90¬∞$</td>
                    <td>Four 3-fold axes</td>
                    <td>NaCl, Si, Fe, Cu</td>
                </tr>
            </tbody>
        </table>

        <hr>

        <h2>1.4 Visualization of Lattices with Python</h2>

        <p>Now, let's use Python to visualize lattice structures and understand crystallography concepts visually.</p>

        <h3>Environment Setup</h3>

        <p>Install the required libraries:</p>

        <pre><code class="language-bash"># Install required libraries
pip install numpy matplotlib pandas plotly
</code></pre>

        <h3>Code Example 1: Creating a Table of Lattice Parameters for the Seven Crystal Systems</h3>

        <p>First, let's create a table summarizing the relationships of lattice parameters for the seven crystal systems.</p>

        <pre><code class="language-python">import pandas as pd
import numpy as np

# Define lattice parameter relationships for the seven crystal systems
crystal_systems_data = {
    'Crystal System': ['Triclinic', 'Monoclinic', 'Orthorhombic', 'Tetragonal',
                       'Hexagonal', 'Trigonal', 'Cubic'],
    'English Name': ['Triclinic', 'Monoclinic', 'Orthorhombic', 'Tetragonal',
                     'Hexagonal', 'Trigonal', 'Cubic'],
    'Axis Length': ['a‚â†b‚â†c', 'a‚â†b‚â†c', 'a‚â†b‚â†c', 'a=b‚â†c', 'a=b‚â†c', 'a=b=c', 'a=b=c'],
    'Œ±': ['‚â†90¬∞', '90¬∞', '90¬∞', '90¬∞', '90¬∞', '‚â†90¬∞', '90¬∞'],
    'Œ≤': ['‚â†90¬∞', '‚â†90¬∞', '90¬∞', '90¬∞', '90¬∞', '=Œ±', '90¬∞'],
    'Œ≥': ['‚â†90¬∞', '90¬∞', '90¬∞', '90¬∞', '120¬∞', '=Œ±', '90¬∞'],
    'Key Symmetry': ['Inversion only', 'One 2-fold axis', 'Three 2-fold axes', 'One 4-fold axis',
                     'One 6-fold axis', 'One 3-fold axis', 'Four 3-fold axes'],
    'Example': ['Feldspar', 'Gypsum', 'Orthorhombic S', 'TiO‚ÇÇ', 'Mg', 'CaCO‚ÇÉ', 'NaCl']
}

# Create DataFrame
df_crystal_systems = pd.DataFrame(crystal_systems_data)

# Display
print("=" * 100)
print("Summary of Lattice Parameters for the Seven Crystal Systems")
print("=" * 100)
print(df_crystal_systems.to_string(index=False))
print("=" * 100)

# Specific examples of lattice parameters
print("\nSpecific Examples of Lattice Parameters (Representative Materials):")
print("-" * 80)

examples = [
    {'Material': 'NaCl (Sodium Chloride)', 'System': 'Cubic',
     'a': 5.64, 'b': 5.64, 'c': 5.64, 'Œ±': 90, 'Œ≤': 90, 'Œ≥': 90},
    {'Material': 'Si (Silicon)', 'System': 'Cubic',
     'a': 5.43, 'b': 5.43, 'c': 5.43, 'Œ±': 90, 'Œ≤': 90, 'Œ≥': 90},
    {'Material': 'TiO‚ÇÇ (Rutile)', 'System': 'Tetragonal',
     'a': 4.59, 'b': 4.59, 'c': 2.96, 'Œ±': 90, 'Œ≤': 90, 'Œ≥': 90},
    {'Material': 'Mg (Magnesium)', 'System': 'Hexagonal',
     'a': 3.21, 'b': 3.21, 'c': 5.21, 'Œ±': 90, 'Œ≤': 90, 'Œ≥': 120},
    {'Material': 'Œ±-Fe (Ferrite)', 'System': 'Cubic',
     'a': 2.87, 'b': 2.87, 'c': 2.87, 'Œ±': 90, 'Œ≤': 90, 'Œ≥': 90},
]

for ex in examples:
    print(f"{ex['Material']:30s} ({ex['System']})")
    print(f"  a={ex['a']:.2f}√Ö, b={ex['b']:.2f}√Ö, c={ex['c']:.2f}√Ö")
    print(f"  Œ±={ex['Œ±']}¬∞, Œ≤={ex['Œ≤']}¬∞, Œ≥={ex['Œ≥']}¬∞")
    print()
</code></pre>

        <p><strong>Output Example</strong>:</p>
        <pre><code>====================================================================================================
Summary of Lattice Parameters for the Seven Crystal Systems
====================================================================================================
Crystal System  English Name  Axis Length  Œ±    Œ≤    Œ≥    Key Symmetry        Example
Triclinic       Triclinic     a‚â†b‚â†c        ‚â†90¬∞ ‚â†90¬∞ ‚â†90¬∞ Inversion only      Feldspar
Monoclinic      Monoclinic    a‚â†b‚â†c        90¬∞  ‚â†90¬∞ 90¬∞  One 2-fold axis     Gypsum
Orthorhombic    Orthorhombic  a‚â†b‚â†c        90¬∞  90¬∞  90¬∞  Three 2-fold axes   Orthorhombic S
Tetragonal      Tetragonal    a=b‚â†c        90¬∞  90¬∞  90¬∞  One 4-fold axis     TiO‚ÇÇ
Hexagonal       Hexagonal     a=b‚â†c        90¬∞  90¬∞  120¬∞ One 6-fold axis     Mg
Trigonal        Trigonal      a=b=c        ‚â†90¬∞ =Œ±   =Œ±   One 3-fold axis     CaCO‚ÇÉ
Cubic           Cubic         a=b=c        90¬∞  90¬∞  90¬∞  Four 3-fold axes    NaCl
====================================================================================================
</code></pre>

        <p><strong>Explanation</strong>: This table allows you to understand the lattice parameter relationships of the seven crystal systems at a glance. The higher the symmetry, the more constraints exist (e.g., cubic has a=b=c), resulting in fewer parameters.</p>

        <h3>Code Example 2: Generation and Visualization of a 2D Lattice (Square Lattice)</h3>

        <p>First, let's generate a two-dimensional square lattice and visualize the lattice points and unit cell.</p>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# 2D square lattice parameters
a = 1.0  # Lattice constant (arbitrary units)
n_cells = 5  # Number of unit cells to display (x, y direction)

# Generate lattice points
x_points = []
y_points = []

for i in range(n_cells + 1):
    for j in range(n_cells + 1):
        x_points.append(i * a)
        y_points.append(j * a)

# Create plot
fig, ax = plt.subplots(figsize=(8, 8))

# Plot lattice points
ax.scatter(x_points, y_points, s=150, c='#f093fb',
           edgecolors='black', linewidths=2, zorder=3, label='Lattice Points')

# Draw unit cell edges
for i in range(n_cells):
    for j in range(n_cells):
        # Draw 4 edges of unit cell
        # Bottom edge
        ax.plot([i*a, (i+1)*a], [j*a, j*a], 'b-', linewidth=1.5, alpha=0.6)
        # Right edge
        ax.plot([(i+1)*a, (i+1)*a], [j*a, (j+1)*a], 'b-', linewidth=1.5, alpha=0.6)
        # Top edge
        ax.plot([(i+1)*a, i*a], [(j+1)*a, (j+1)*a], 'b-', linewidth=1.5, alpha=0.6)
        # Left edge
        ax.plot([i*a, i*a], [(j+1)*a, j*a], 'b-', linewidth=1.5, alpha=0.6)

# Highlight the first unit cell
ax.plot([0, a], [0, 0], 'r-', linewidth=3, label='Unit Cell')
ax.plot([a, a], [0, a], 'r-', linewidth=3)
ax.plot([a, 0], [a, a], 'r-', linewidth=3)
ax.plot([0, 0], [a, 0], 'r-', linewidth=3)

# Display lattice vectors as arrows
ax.annotate('', xy=(a, 0), xytext=(0, 0),
            arrowprops=dict(arrowstyle='->', lw=2.5, color='green'))
ax.annotate('', xy=(0, a), xytext=(0, 0),
            arrowprops=dict(arrowstyle='->', lw=2.5, color='green'))
ax.text(a/2, -0.3, r'$\vec{a}$', fontsize=14, color='green', fontweight='bold')
ax.text(-0.3, a/2, r'$\vec{b}$', fontsize=14, color='green', fontweight='bold')

# Axis settings
ax.set_xlim(-0.5, n_cells * a + 0.5)
ax.set_ylim(-0.5, n_cells * a + 0.5)
ax.set_aspect('equal')
ax.set_xlabel('x', fontsize=12, fontweight='bold')
ax.set_ylabel('y', fontsize=12, fontweight='bold')
ax.set_title('Visualization of a 2D Square Lattice', fontsize=14, fontweight='bold')
ax.legend(fontsize=11, loc='upper right')
ax.grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("Total number of lattice points:", len(x_points))
print(f"Lattice constant: a = {a}")
print(f"Unit cell area: {a**2:.2f}")
print(f"Number of unit cells in displayed range: {n_cells * n_cells}")
</code></pre>

        <p><strong>Explanation</strong>: This plot visually demonstrates that lattice points are periodically arranged, and the entire lattice is constructed by repeating the unit cell (red box). The lattice vectors $\vec{a}$ and $\vec{b}$ define the basic structure of the lattice.</p>

        <h3>Code Example 3: 3D Unit Cell Visualization (Cubic)</h3>

        <p>Let's visualize a three-dimensional cubic unit cell using Plotly.</p>

        <pre><code class="language-python">import numpy as np
import plotly.graph_objects as go

# Cubic unit cell parameters
a = 1.0  # Lattice constant

# Vertex coordinates of unit cell (8 points)
vertices = np.array([
    [0, 0, 0],
    [a, 0, 0],
    [a, a, 0],
    [0, a, 0],
    [0, 0, a],
    [a, 0, a],
    [a, a, a],
    [0, a, a]
])

# Edges of unit cell (12 edges)
edges = [
    [0, 1], [1, 2], [2, 3], [3, 0],  # Bottom face
    [4, 5], [5, 6], [6, 7], [7, 4],  # Top face
    [0, 4], [1, 5], [2, 6], [3, 7]   # Vertical edges
]

# Create plot
fig = go.Figure()

# Draw edges
for edge in edges:
    v1, v2 = vertices[edge[0]], vertices[edge[1]]
    fig.add_trace(go.Scatter3d(
        x=[v1[0], v2[0]],
        y=[v1[1], v2[1]],
        z=[v1[2], v2[2]],
        mode='lines',
        line=dict(color='blue', width=6),
        showlegend=False,
        hoverinfo='skip'
    ))

# Draw vertices (lattice points)
fig.add_trace(go.Scatter3d(
    x=vertices[:, 0],
    y=vertices[:, 1],
    z=vertices[:, 2],
    mode='markers',
    marker=dict(size=10, color='#f093fb',
                line=dict(color='black', width=2)),
    name='Lattice Points',
    hovertemplate='Coordinate: (%{x:.2f}, %{y:.2f}, %{z:.2f})<extra></extra>'
))

# Axis labels
fig.update_layout(
    title='3D Visualization of a Cubic Unit Cell',
    scene=dict(
        xaxis_title='x (√Ö)',
        yaxis_title='y (√Ö)',
        zaxis_title='z (√Ö)',
        aspectmode='cube',
        xaxis=dict(range=[-0.2, a+0.2]),
        yaxis=dict(range=[-0.2, a+0.2]),
        zaxis=dict(range=[-0.2, a+0.2])
    ),
    width=700,
    height=700
)

fig.show()

print("Information about the cubic unit cell:")
print(f"Lattice constants: a = b = c = {a} √Ö")
print(f"Angles: Œ± = Œ≤ = Œ≥ = 90¬∞")
print(f"Unit cell volume: V = a¬≥ = {a**3:.2f} √Ö¬≥")
print(f"Number of lattice points (vertices only): 8 points (equivalent to 1 lattice point: 8 √ó 1/8 = 1)")
</code></pre>

        <p><strong>Explanation</strong>: This 3D visualization intuitively shows that the cubic unit cell has a cube shape. The 8 lattice points at the vertices are shared with adjacent unit cells, so only 1 lattice point is actually contained in one unit cell (8 √ó 1/8 = 1).</p>

        <h3>Code Example 4: Calculating Unit Cell Volume from Lattice Parameters</h3>

        <p>Let's create a function to calculate the unit cell volume from lattice parameters.</p>

        <pre><code class="language-python">import numpy as np

def calc_unit_cell_volume(a, b, c, alpha, beta, gamma):
    """
    Calculate unit cell volume from lattice parameters

    Parameters:
    -----------
    a, b, c : float
        Axis lengths (√Ö)
    alpha, beta, gamma : float
        Angles (degrees)

    Returns:
    --------
    volume : float
        Unit cell volume (√Ö¬≥)
    """
    # Convert angles to radians
    alpha_rad = np.deg2rad(alpha)
    beta_rad = np.deg2rad(beta)
    gamma_rad = np.deg2rad(gamma)

    # Volume calculation formula
    cos_alpha = np.cos(alpha_rad)
    cos_beta = np.cos(beta_rad)
    cos_gamma = np.cos(gamma_rad)

    volume = a * b * c * np.sqrt(
        1 - cos_alpha**2 - cos_beta**2 - cos_gamma**2
        + 2 * cos_alpha * cos_beta * cos_gamma
    )

    return volume

# Calculate volume for representative examples of each crystal system
examples = [
    {'Name': 'NaCl', 'System': 'Cubic', 'a': 5.64, 'b': 5.64, 'c': 5.64,
     'alpha': 90, 'beta': 90, 'gamma': 90},
    {'Name': 'Si', 'System': 'Cubic', 'a': 5.43, 'b': 5.43, 'c': 5.43,
     'alpha': 90, 'beta': 90, 'gamma': 90},
    {'Name': 'TiO‚ÇÇ', 'System': 'Tetragonal', 'a': 4.59, 'b': 4.59, 'c': 2.96,
     'alpha': 90, 'beta': 90, 'gamma': 90},
    {'Name': 'Mg', 'System': 'Hexagonal', 'a': 3.21, 'b': 3.21, 'c': 5.21,
     'alpha': 90, 'beta': 90, 'gamma': 120},
    {'Name': 'CaCO‚ÇÉ', 'System': 'Trigonal', 'a': 4.99, 'b': 4.99, 'c': 4.99,
     'alpha': 101.9, 'beta': 101.9, 'gamma': 101.9},
]

print("=" * 70)
print("Calculating Unit Cell Volume from Lattice Parameters")
print("=" * 70)

for ex in examples:
    volume = calc_unit_cell_volume(
        ex['a'], ex['b'], ex['c'], ex['alpha'], ex['beta'], ex['gamma']
    )

    print(f"\n{ex['Name']} ({ex['System']})")
    print(f"  Lattice parameters: a={ex['a']:.2f}√Ö, b={ex['b']:.2f}√Ö, c={ex['c']:.2f}√Ö")
    print(f"  Angles: Œ±={ex['alpha']:.1f}¬∞, Œ≤={ex['beta']:.1f}¬∞, Œ≥={ex['gamma']:.1f}¬∞")
    print(f"  Unit cell volume: V = {volume:.2f} √Ö¬≥")

print("\n" + "=" * 70)

# Comparison with simplified formula for cubic system
print("\nFor cubic (NaCl), simplified formula V = a¬≥ can also be used:")
a_nacl = 5.64
v_simple = a_nacl ** 3
v_general = calc_unit_cell_volume(a_nacl, a_nacl, a_nacl, 90, 90, 90)
print(f"  Simplified formula: V = {a_nacl}¬≥ = {v_simple:.2f} √Ö¬≥")
print(f"  General formula: V = {v_general:.2f} √Ö¬≥")
print(f"  Difference: {abs(v_simple - v_general):.6f} √Ö¬≥ (matches within error margin)")
</code></pre>

        <p><strong>Output Example</strong>:</p>
        <pre><code>======================================================================
Calculating Unit Cell Volume from Lattice Parameters
======================================================================

NaCl (Cubic)
  Lattice parameters: a=5.64√Ö, b=5.64√Ö, c=5.64√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=90.0¬∞
  Unit cell volume: V = 179.41 √Ö¬≥

Si (Cubic)
  Lattice parameters: a=5.43√Ö, b=5.43√Ö, c=5.43√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=90.0¬∞
  Unit cell volume: V = 160.10 √Ö¬≥

TiO‚ÇÇ (Tetragonal)
  Lattice parameters: a=4.59√Ö, b=4.59√Ö, c=2.96√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=90.0¬∞
  Unit cell volume: V = 62.35 √Ö¬≥

Mg (Hexagonal)
  Lattice parameters: a=3.21√Ö, b=3.21√Ö, c=5.21√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=120.0¬∞
  Unit cell volume: V = 46.49 √Ö¬≥
</code></pre>

        <p><strong>Explanation</strong>: This function allows you to calculate the unit cell volume for any crystal system using the general formula. While simplified formulas ($V = a^3$ or $V = a^2c$) can be used for cubic and tetragonal systems, the general formula is applicable to all crystal systems.</p>

        <h3>Code Example 5: Visualizing Unit Cells of Different Crystal Systems (Cubic vs Tetragonal vs Orthorhombic)</h3>

        <p>Let's visualize unit cells of three different crystal systems side by side to understand their differences.</p>

        <pre><code class="language-python">import numpy as np
import plotly.graph_objects as go
from plotly.subplots import make_subplots

def create_unit_cell_vertices(a, b, c):
    """Generate vertex coordinates of unit cell"""
    return np.array([
        [0, 0, 0], [a, 0, 0], [a, b, 0], [0, b, 0],
        [0, 0, c], [a, 0, c], [a, b, c], [0, b, c]
    ])

def add_unit_cell_to_fig(fig, a, b, c, row, col, title):
    """Add unit cell to subplot"""
    vertices = create_unit_cell_vertices(a, b, c)

    edges = [
        [0, 1], [1, 2], [2, 3], [3, 0],  # Bottom face
        [4, 5], [5, 6], [6, 7], [7, 4],  # Top face
        [0, 4], [1, 5], [2, 6], [3, 7]   # Vertical edges
    ]

    # Draw edges
    for edge in edges:
        v1, v2 = vertices[edge[0]], vertices[edge[1]]
        fig.add_trace(go.Scatter3d(
            x=[v1[0], v2[0]], y=[v1[1], v2[1]], z=[v1[2], v2[2]],
            mode='lines', line=dict(color='blue', width=4),
            showlegend=False, hoverinfo='skip'
        ), row=row, col=col)

    # Draw vertices
    fig.add_trace(go.Scatter3d(
        x=vertices[:, 0], y=vertices[:, 1], z=vertices[:, 2],
        mode='markers', marker=dict(size=6, color='#f093fb'),
        showlegend=False, hoverinfo='skip'
    ), row=row, col=col)

    # Subplot title and axis settings
    scene_name = f'scene{(row-1)*3 + col}' if row > 1 or col > 1 else 'scene'
    fig.update_layout({
        scene_name: dict(
            xaxis_title='x', yaxis_title='y', zaxis_title='z',
            aspectmode='cube',
            xaxis=dict(range=[0, max(a, b, c)]),
            yaxis=dict(range=[0, max(a, b, c)]),
            zaxis=dict(range=[0, max(a, b, c)])
        )
    })

# Create subplots (1 row, 3 columns)
fig = make_subplots(
    rows=1, cols=3,
    specs=[[{'type': 'scatter3d'}, {'type': 'scatter3d'}, {'type': 'scatter3d'}]],
    subplot_titles=('Cubic (a=b=c)', 'Tetragonal (a=b‚â†c)', 'Orthorhombic (a‚â†b‚â†c)')
)

# Cubic (a=b=c)
add_unit_cell_to_fig(fig, a=2.0, b=2.0, c=2.0, row=1, col=1, title='Cubic')

# Tetragonal (a=b‚â†c)
add_unit_cell_to_fig(fig, a=2.0, b=2.0, c=3.0, row=1, col=2, title='Tetragonal')

# Orthorhombic (a‚â†b‚â†c)
add_unit_cell_to_fig(fig, a=2.0, b=2.5, c=3.5, row=1, col=3, title='Orthorhombic')

# Adjust layout
fig.update_layout(
    title_text="Comparison of Unit Cells for Three Crystal Systems",
    height=500,
    width=1200,
    showlegend=False
)

fig.show()

# Output information for each crystal system
print("Comparison of Three Crystal Systems:")
print("-" * 60)
print("Cubic:       a = b = c = 2.0 √Ö, Œ± = Œ≤ = Œ≥ = 90¬∞")
print("             Volume V = a¬≥ = 8.0 √Ö¬≥")
print("-" * 60)
print("Tetragonal:  a = b = 2.0 √Ö, c = 3.0 √Ö, Œ± = Œ≤ = Œ≥ = 90¬∞")
print("             Volume V = a¬≤c = 12.0 √Ö¬≥")
print("-" * 60)
print("Orthorhombic: a = 2.0 √Ö, b = 2.5 √Ö, c = 3.5 √Ö, Œ± = Œ≤ = Œ≥ = 90¬∞")
print("              Volume V = abc = 17.5 √Ö¬≥")
print("-" * 60)
</code></pre>

        <p><strong>Explanation</strong>: This side-by-side comparison visually demonstrates that symmetry decreases in the order cubic ‚Üí tetragonal ‚Üí orthorhombic, with shape constraints becoming less restrictive. Cubic has the highest symmetry, while orthorhombic has three different axis lengths.</p>

        <h3>Code Example 6: Program to Generate Lattice Points (3D Lattice)</h3>

        <p>Let's generate lattice points in three-dimensional space and visualize a supercell (multiple unit cells).</p>

        <pre><code class="language-python">import numpy as np
import plotly.graph_objects as go

def generate_3d_lattice_points(a, b, c, nx, ny, nz):
    """
    Generate 3D lattice points

    Parameters:
    -----------
    a, b, c : float
        Lattice constants (√Ö)
    nx, ny, nz : int
        Number of unit cells in each direction

    Returns:
    --------
    points : ndarray
        Array of lattice point coordinates (N, 3)
    """
    points = []
    for i in range(nx + 1):
        for j in range(ny + 1):
            for k in range(nz + 1):
                x = i * a
                y = j * b
                z = k * c
                points.append([x, y, z])
    return np.array(points)

# Generate cubic supercell (3√ó3√ó3)
a = 1.0  # Lattice constant
nx, ny, nz = 3, 3, 3  # Number of unit cells in each direction

lattice_points = generate_3d_lattice_points(a, a, a, nx, ny, nz)

# Create plot
fig = go.Figure()

# Draw lattice points
fig.add_trace(go.Scatter3d(
    x=lattice_points[:, 0],
    y=lattice_points[:, 1],
    z=lattice_points[:, 2],
    mode='markers',
    marker=dict(size=5, color='#f093fb',
                line=dict(color='black', width=1)),
    name='Lattice Points',
    hovertemplate='Coordinate: (%{x:.1f}, %{y:.1f}, %{z:.1f})<extra></extra>'
))

# Draw edges of unit cell (first unit cell only)
unit_cell_edges = [
    [[0, 0, 0], [a, 0, 0]], [[a, 0, 0], [a, a, 0]],
    [[a, a, 0], [0, a, 0]], [[0, a, 0], [0, 0, 0]],
    [[0, 0, a], [a, 0, a]], [[a, 0, a], [a, a, a]],
    [[a, a, a], [0, a, a]], [[0, a, a], [0, 0, a]],
    [[0, 0, 0], [0, 0, a]], [[a, 0, 0], [a, 0, a]],
    [[a, a, 0], [a, a, a]], [[0, a, 0], [0, a, a]]
]

for edge in unit_cell_edges:
    fig.add_trace(go.Scatter3d(
        x=[edge[0][0], edge[1][0]],
        y=[edge[0][1], edge[1][1]],
        z=[edge[0][2], edge[1][2]],
        mode='lines',
        line=dict(color='red', width=4),
        showlegend=False,
        hoverinfo='skip'
    ))

# Layout settings
fig.update_layout(
    title=f'Generation of 3D Lattice Points ({nx}√ó{ny}√ó{nz} Supercell)',
    scene=dict(
        xaxis_title='x (√Ö)',
        yaxis_title='y (√Ö)',
        zaxis_title='z (√Ö)',
        aspectmode='cube'
    ),
    width=700,
    height=700
)

fig.show()

# Output statistics
print(f"Supercell Information:")
print(f"  Lattice constants: a = b = c = {a} √Ö")
print(f"  Number of unit cells: {nx} √ó {ny} √ó {nz} = {nx*ny*nz} cells")
print(f"  Total lattice points: {len(lattice_points)} points")
print(f"  Lattice point density: {len(lattice_points)/(nx*a*ny*a*nz*a):.2f} points/√Ö¬≥")
print(f"  Total volume: {nx*a} √ó {ny*a} √ó {nz*a} = {nx*ny*nz*a**3:.2f} √Ö¬≥")
</code></pre>

        <p><strong>Explanation</strong>: This program allows you to generate supercells of arbitrary size (larger structures combining multiple unit cells). You can visually understand how the periodic arrangement of lattice points repeats in three-dimensional space.</p>

        <h3>Code Example 7: Supercell Generation (2√ó2√ó2 Expansion)</h3>

        <p>Let's generate a supercell by expanding the unit cell by a factor of 2√ó2√ó2.</p>

        <pre><code class="language-python">import numpy as np

def expand_unit_cell_to_supercell(unit_cell_atoms, lattice_vectors, n1, n2, n3):
    """
    Expand unit cell to supercell

    Parameters:
    -----------
    unit_cell_atoms : ndarray
        Atomic coordinates in unit cell (fractional coordinates) (N, 3)
    lattice_vectors : ndarray
        Lattice vectors (3, 3) [[a_x, a_y, a_z], [b_x, b_y, b_z], [c_x, c_y, c_z]]
    n1, n2, n3 : int
        Expansion factor in each direction

    Returns:
    --------
    supercell_atoms : ndarray
        Atomic coordinates in supercell (Cartesian coordinates) (M, 3)
    """
    supercell_atoms = []

    for atom_frac in unit_cell_atoms:
        for i in range(n1):
            for j in range(n2):
                for k in range(n3):
                    # Add translation to fractional coordinates
                    frac_coord = atom_frac + np.array([i/n1, j/n2, k/n3])

                    # Convert to Cartesian coordinates
                    cart_coord = np.dot(frac_coord, lattice_vectors)
                    supercell_atoms.append(cart_coord)

    return np.array(supercell_atoms)

# Example: Simple cubic lattice unit cell (lattice points only)
unit_cell_atoms = np.array([
    [0.0, 0.0, 0.0]  # Atom only at origin (fractional coordinates)
])

# Lattice vectors (cubic, a=2.0 √Ö)
a = 2.0
lattice_vectors = np.array([
    [a, 0, 0],
    [0, a, 0],
    [0, 0, a]
])

# Generate 2√ó2√ó2 supercell
supercell = expand_unit_cell_to_supercell(unit_cell_atoms, lattice_vectors, 2, 2, 2)

print("2√ó2√ó2 Supercell Generation Results:")
print("=" * 60)
print(f"Number of atoms in unit cell: {len(unit_cell_atoms)}")
print(f"Number of atoms in supercell: {len(supercell)} (= {len(unit_cell_atoms)} √ó 2¬≥)")
print("=" * 60)
print("\nAtomic Coordinates in Supercell (Cartesian Coordinates, √Ö):")
for i, coord in enumerate(supercell, 1):
    print(f"  Atom{i:2d}: ({coord[0]:5.2f}, {coord[1]:5.2f}, {coord[2]:5.2f})")

# Calculate supercell size
supercell_size = 2 * a
supercell_volume = supercell_size ** 3
print(f"\nSupercell Size: {supercell_size} √ó {supercell_size} √ó {supercell_size} √Ö")
print(f"Supercell Volume: {supercell_volume:.2f} √Ö¬≥")
print(f"Atomic Density: {len(supercell)/supercell_volume:.4f} atoms/√Ö¬≥")
</code></pre>

        <p><strong>Output Example</strong>:</p>
        <pre><code>2√ó2√ó2 Supercell Generation Results:
============================================================
Number of atoms in unit cell: 1
Number of atoms in supercell: 8 (= 1 √ó 2¬≥)
============================================================

Atomic Coordinates in Supercell (Cartesian Coordinates, √Ö):
  Atom 1: ( 0.00,  0.00,  0.00)
  Atom 2: ( 0.00,  0.00,  2.00)
  Atom 3: ( 0.00,  2.00,  0.00)
  Atom 4: ( 0.00,  2.00,  2.00)
  Atom 5: ( 2.00,  0.00,  0.00)
  Atom 6: ( 2.00,  0.00,  2.00)
  Atom 7: ( 2.00,  2.00,  0.00)
  Atom 8: ( 2.00,  2.00,  2.00)

Supercell Size: 4.0 √ó 4.0 √ó 4.0 √Ö
Supercell Volume: 64.00 √Ö¬≥
Atomic Density: 0.1250 atoms/√Ö¬≥
</code></pre>

        <p><strong>Explanation</strong>: Supercells are frequently used in computational chemistry and simulations. By repeating the unit cell, you can model large-scale structures such as surfaces, interfaces, and defects.</p>

        <h3>Code Example 8: Crystal System Determination Program (Determination from Lattice Parameters)</h3>

        <p>Let's create a program that determines which crystal system a material belongs to based on input lattice parameters.</p>

        <pre><code class="language-python">import numpy as np

def determine_crystal_system(a, b, c, alpha, beta, gamma, tolerance=0.01):
    """
    Determine crystal system from lattice parameters

    Parameters:
    -----------
    a, b, c : float
        Axis lengths (√Ö)
    alpha, beta, gamma : float
        Angles (degrees)
    tolerance : float
        Tolerance for determination (relative error)

    Returns:
    --------
    system : str
        Name of crystal system
    """
    # Angle tolerance (degrees)
    angle_tol = 1.0

    # Length comparison (relative error)
    def is_equal(x, y):
        return abs(x - y) / max(x, y) < tolerance

    # Angle comparison
    def angle_is(angle, target):
        return abs(angle - target) < angle_tol

    # Cubic: a=b=c, Œ±=Œ≤=Œ≥=90¬∞
    if is_equal(a, b) and is_equal(b, c) and \
       angle_is(alpha, 90) and angle_is(beta, 90) and angle_is(gamma, 90):
        return 'Cubic'

    # Tetragonal: a=b‚â†c, Œ±=Œ≤=Œ≥=90¬∞
    elif is_equal(a, b) and not is_equal(a, c) and \
         angle_is(alpha, 90) and angle_is(beta, 90) and angle_is(gamma, 90):
        return 'Tetragonal'

    # Orthorhombic: a‚â†b‚â†c, Œ±=Œ≤=Œ≥=90¬∞
    elif not is_equal(a, b) and not is_equal(b, c) and not is_equal(a, c) and \
         angle_is(alpha, 90) and angle_is(beta, 90) and angle_is(gamma, 90):
        return 'Orthorhombic'

    # Hexagonal: a=b‚â†c, Œ±=Œ≤=90¬∞, Œ≥=120¬∞
    elif is_equal(a, b) and not is_equal(a, c) and \
         angle_is(alpha, 90) and angle_is(beta, 90) and angle_is(gamma, 120):
        return 'Hexagonal'

    # Trigonal: a=b=c, Œ±=Œ≤=Œ≥‚â†90¬∞
    elif is_equal(a, b) and is_equal(b, c) and \
         is_equal(alpha, beta) and is_equal(beta, gamma) and not angle_is(alpha, 90):
        return 'Trigonal / Rhombohedral'

    # Monoclinic: a‚â†b‚â†c, Œ±=Œ≥=90¬∞‚â†Œ≤
    elif not is_equal(a, b) and not is_equal(b, c) and not is_equal(a, c) and \
         angle_is(alpha, 90) and not angle_is(beta, 90) and angle_is(gamma, 90):
        return 'Monoclinic'

    # Triclinic: a‚â†b‚â†c, Œ±‚â†Œ≤‚â†Œ≥‚â†90¬∞ (most general)
    else:
        return 'Triclinic'

# Test cases
test_cases = [
    {'Name': 'NaCl', 'a': 5.64, 'b': 5.64, 'c': 5.64, 'alpha': 90, 'beta': 90, 'gamma': 90},
    {'Name': 'Si', 'a': 5.43, 'b': 5.43, 'c': 5.43, 'alpha': 90, 'beta': 90, 'gamma': 90},
    {'Name': 'TiO‚ÇÇ', 'a': 4.59, 'b': 4.59, 'c': 2.96, 'alpha': 90, 'beta': 90, 'gamma': 90},
    {'Name': 'Mg', 'a': 3.21, 'b': 3.21, 'c': 5.21, 'alpha': 90, 'beta': 90, 'gamma': 120},
    {'Name': 'CaCO‚ÇÉ', 'a': 4.99, 'b': 4.99, 'c': 4.99, 'alpha': 101.9, 'beta': 101.9, 'gamma': 101.9},
    {'Name': 'Gypsum', 'a': 5.68, 'b': 15.18, 'c': 6.29, 'alpha': 90, 'beta': 113.8, 'gamma': 90},
    {'Name': 'Sulfur', 'a': 10.47, 'b': 12.87, 'c': 24.49, 'alpha': 90, 'beta': 90, 'gamma': 90},
]

print("=" * 80)
print("Crystal System Determination Program")
print("=" * 80)

for case in test_cases:
    system = determine_crystal_system(
        case['a'], case['b'], case['c'],
        case['alpha'], case['beta'], case['gamma']
    )

    print(f"\n{case['Name']:10s}")
    print(f"  Lattice parameters: a={case['a']:.2f}√Ö, b={case['b']:.2f}√Ö, c={case['c']:.2f}√Ö")
    print(f"  Angles: Œ±={case['alpha']:.1f}¬∞, Œ≤={case['beta']:.1f}¬∞, Œ≥={case['gamma']:.1f}¬∞")
    print(f"  ‚Üí Determination result: {system}")

print("\n" + "=" * 80)
</code></pre>

        <p><strong>Output Example</strong>:</p>
        <pre><code>================================================================================
Crystal System Determination Program
================================================================================

NaCl
  Lattice parameters: a=5.64√Ö, b=5.64√Ö, c=5.64√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=90.0¬∞
  ‚Üí Determination result: Cubic

Si
  Lattice parameters: a=5.43√Ö, b=5.43√Ö, c=5.43√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=90.0¬∞
  ‚Üí Determination result: Cubic

TiO‚ÇÇ
  Lattice parameters: a=4.59√Ö, b=4.59√Ö, c=2.96√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=90.0¬∞
  ‚Üí Determination result: Tetragonal

Mg
  Lattice parameters: a=3.21√Ö, b=3.21√Ö, c=5.21√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=120.0¬∞
  ‚Üí Determination result: Hexagonal

CaCO‚ÇÉ
  Lattice parameters: a=4.99√Ö, b=4.99√Ö, c=4.99√Ö
  Angles: Œ±=101.9¬∞, Œ≤=101.9¬∞, Œ≥=101.9¬∞
  ‚Üí Determination result: Trigonal / Rhombohedral

Gypsum
  Lattice parameters: a=5.68√Ö, b=15.18√Ö, c=6.29√Ö
  Angles: Œ±=90.0¬∞, Œ≤=113.8¬∞, Œ≥=90.0¬∞
  ‚Üí Determination result: Monoclinic

Sulfur
  Lattice parameters: a=10.47√Ö, b=12.87√Ö, c=24.49√Ö
  Angles: Œ±=90.0¬∞, Œ≤=90.0¬∞, Œ≥=90.0¬∞
  ‚Üí Determination result: Orthorhombic

================================================================================
</code></pre>

        <p><strong>Explanation</strong>: This program allows automatic determination of the crystal system from lattice parameters. By inputting lattice parameters obtained from experimental data, classification of crystal structures is possible. By adjusting the tolerance, it can also accommodate measurement errors.</p>

        <hr>

        <h2>1.5 Exercises</h2>

        <p>Let's work on the following exercises to confirm what you've learned.</p>

        <details>
            <summary><strong>Exercise 1: Calculating Cubic Unit Cell Volume</strong></summary>
            <p><strong>Problem</strong>: The lattice constant of iron (Œ±-Fe) is a = 2.87 √Ö. Calculate the unit cell volume.</p>

            <p><strong>Solution Example</strong>:</p>
            <pre><code class="language-python"># Calculate cubic unit cell volume
a_Fe = 2.87  # √Ö
V_Fe = a_Fe ** 3
print(f"Unit cell volume of iron (Œ±-Fe): V = {V_Fe:.2f} √Ö¬≥")
# Output: Unit cell volume of iron (Œ±-Fe): V = 23.64 √Ö¬≥
</code></pre>
        </details>

        <details>
            <summary><strong>Exercise 2: Determining Crystal System from Lattice Parameters</strong></summary>
            <p><strong>Problem</strong>: Determine the crystal system of a material with the following lattice parameters.</p>
            <ul>
                <li>a = 4.5 √Ö, b = 4.5 √Ö, c = 6.0 √Ö</li>
                <li>Œ± = 90¬∞, Œ≤ = 90¬∞, Œ≥ = 90¬∞</li>
            </ul>

            <p><strong>Solution Example</strong>:</p>
            <pre><code class="language-python"># Use the function from Code Example 8
system = determine_crystal_system(4.5, 4.5, 6.0, 90, 90, 90)
print(f"Determination result: {system}")
# Output: Determination result: Tetragonal
</code></pre>
            <p><strong>Reason</strong>: Since a = b ‚â† c and Œ± = Œ≤ = Œ≥ = 90¬∞, it is a tetragonal system.</p>
        </details>

        <details>
            <summary><strong>Exercise 3: Calculating 2D Lattice Point Coordinates</strong></summary>
            <p><strong>Problem</strong>: For a two-dimensional square lattice (a = 3.0 √Ö), list all lattice point coordinates in a 3√ó3 range.</p>

            <p><strong>Solution Example</strong>:</p>
            <pre><code class="language-python">a = 3.0
points = []
for i in range(4):  # 0, 1, 2, 3
    for j in range(4):
        points.append((i * a, j * a))

print("Lattice point coordinates:")
for i, (x, y) in enumerate(points, 1):
    print(f"  Point{i:2d}: ({x:.1f}, {y:.1f})")
print(f"\nTotal lattice points: {len(points)}")
# Total lattice points: 16
</code></pre>
        </details>

        <details>
            <summary><strong>Exercise 4: Calculating Supercell Size</strong></summary>
            <p><strong>Problem</strong>: For a cubic unit cell (a = 5.0 √Ö) expanded by a factor of 4√ó4√ó4, calculate the supercell volume and the total number of atoms in the supercell if the unit cell contains 1 atom.</p>

            <p><strong>Solution Example</strong>:</p>
            <pre><code class="language-python">a = 5.0  # √Ö
n = 4    # Expansion factor

# Supercell size
supercell_size = n * a
supercell_volume = supercell_size ** 3

# Total atoms
atoms_per_unit_cell = 1
total_atoms = atoms_per_unit_cell * n ** 3

print(f"Supercell size: {supercell_size} √Ö")
print(f"Supercell volume: {supercell_volume} √Ö¬≥")
print(f"Total atoms: {total_atoms} atoms")
# Output:
# Supercell size: 20.0 √Ö
# Supercell volume: 8000.0 √Ö¬≥
# Total atoms: 64 atoms
</code></pre>
        </details>

        <details>
            <summary><strong>Exercise 5: Comparing Symmetry of Crystal Systems</strong></summary>
            <p><strong>Problem</strong>: Compare the symmetries of cubic, tetragonal, and orthorhombic systems, and state the number of rotational symmetry axes for each.</p>

            <p><strong>Answer</strong>:</p>
            <ul>
                <li><strong>Cubic</strong>:
                    <ul>
                        <li>4-fold axes: 3 (x, y, z axes)</li>
                        <li>3-fold axes: 4 (body diagonals)</li>
                        <li>2-fold axes: 6 (face diagonals)</li>
                        <li>Highest symmetry</li>
                    </ul>
                </li>
                <li><strong>Tetragonal</strong>:
                    <ul>
                        <li>4-fold axis: 1 (c-axis)</li>
                        <li>2-fold axes: 4 (a, b axes and diagonals)</li>
                        <li>Moderate symmetry</li>
                    </ul>
                </li>
                <li><strong>Orthorhombic</strong>:
                    <ul>
                        <li>2-fold axes: 3 (a, b, c axes)</li>
                        <li>Lowest symmetry (among the three)</li>
                    </ul>
                </li>
            </ul>
            <p><strong>Conclusion</strong>: Symmetry is highest in the order: Cubic > Tetragonal > Orthorhombic.</p>
        </details>

        <hr>

        <h2>1.6 Chapter Summary</h2>

        <h3>What We Learned</h3>

        <ol>
            <li><strong>Basic Concepts of Crystallography</strong>
                <ul>
                    <li>Crystals are materials in which atoms are regularly arranged (long-range order, periodicity)</li>
                    <li>Amorphous materials are those in which atoms are irregularly arranged (short-range order only)</li>
                    <li>Periodicity and symmetry are fundamental to crystal structures</li>
                </ul>
            </li>
            <li><strong>Lattice Points and Unit Cells</strong>
                <ul>
                    <li>Lattice points are reference points of periodically repeating structures</li>
                    <li>The unit cell is the minimum repeating unit of the crystal structure</li>
                    <li>Lattice parameters: six parameters consisting of a, b, c (axis lengths) and Œ±, Œ≤, Œ≥ (angles)</li>
                </ul>
            </li>
            <li><strong>Seven Crystal Systems</strong>
                <ul>
                    <li>Triclinic, Monoclinic, Orthorhombic, Tetragonal, Hexagonal, Trigonal, Cubic</li>
                    <li>Classified by relationships among lattice parameters and symmetry</li>
                    <li>Cubic has the highest symmetry, triclinic the lowest</li>
                </ul>
            </li>
            <li><strong>Visualization with Python</strong>
                <ul>
                    <li>Generation and visualization of lattice points</li>
                    <li>3D display of unit cells</li>
                    <li>Construction of supercells</li>
                    <li>Automatic determination of crystal systems from lattice parameters</li>
                </ul>
            </li>
        </ol>

        <h3>Important Points</h3>

        <ul>
            <li>Crystal structures are characterized by <strong>periodicity and symmetry</strong></li>
            <li>By repeating the unit cell, infinitely extending crystal structures can be constructed</li>
            <li>Lattice parameters are fundamental parameters that quantitatively describe crystal structures</li>
            <li>In crystals, <strong>only 1-, 2-, 3-, 4-, and 6-fold symmetries</strong> are allowed (5-fold symmetry is not possible)</li>
            <li>Higher symmetry means more constraints among lattice parameters (lower degrees of freedom)</li>
        </ul>

        <h3>Next Chapter</h3>

        <p>In Chapter 2, we will learn about <strong>Bravais Lattices and Space Groups</strong>:</p>
        <ul>
            <li>The 14 Bravais lattices (primitive, body-centered, face-centered, base-centered)</li>
            <li>Space groups and symmetry operations (rotation, inversion, reflection, screw, glide)</li>
            <li>Complete description methods for crystal structures</li>
            <li>Visualization of Bravais lattices with Python</li>
            <li>Representative crystal structures (fcc, bcc, hcp, diamond structure)</li>
        </ul>

        <div class="navigation">
            <a href="index.html" class="nav-button">‚Üê Return to Series Index</a>
            <a href="chapter-2.html" class="nav-button">Next Chapter: Bravais Lattices and Space Groups ‚Üí</a>
        </div>
    </main>


    <section class="disclaimer">
        <h3>Disclaimer</h3>
        <ul>
            <li>This content is provided solely for educational, research, and informational purposes and does not constitute professional advice (legal, accounting, technical guarantees, etc.).</li>
            <li>This content and accompanying code examples are provided "AS IS" without any warranties, express or implied, including but not limited to merchantability, fitness for a particular purpose, non-infringement, accuracy, completeness, operation, or safety.</li>
            <li>The authors and Tohoku University assume no responsibility for the content, availability, or safety of external links or third-party data, tools, or libraries.</li>
            <li>To the maximum extent permitted by applicable law, the authors and Tohoku University shall not be liable for any direct, indirect, incidental, special, consequential, or punitive damages arising from the use, execution, or interpretation of this content.</li>
            <li>The content of this material may be changed, updated, or discontinued without notice.</li>
            <li>The copyright and license of this content follow the specified conditions (e.g., CC BY 4.0). Such licenses typically include no-warranty clauses.</li>
        </ul>
    </section>

<footer>
        <p><strong>Created by</strong>: MS Knowledge Hub Content Team</p>
        <p><strong>Version</strong>: 1.0 | <strong>Created</strong>: 2025-10-27</p>
        <p><strong>License</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
