<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 4ï¼šé›»æ°—çš„ãƒ»ç£æ°—çš„æ€§è³ª | MS Terakoya - ææ–™ç‰©æ€§è«–å…¥é–€</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        @media (hover: hover) and (pointer: fine) {
            a:hover {
                color: var(--color-link-hover);
                text-decoration: underline;
            }
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .info-box {
            background-color: #e8f4f8;
            border-left: 4px solid #3498db;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .warning-box {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .success-box {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .exercise-box {
            background-color: var(--color-bg-alt);
            border: 2px solid var(--color-accent);
            padding: var(--spacing-md);
            margin: var(--spacing-lg) 0;
            border-radius: var(--border-radius);
        }

        .exercise-box h4 {
            color: var(--color-accent-light);
            margin-top: 0;
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
            gap: var(--spacing-md);
        }

        .nav-button {
            padding: var(--spacing-md) var(--spacing-lg);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
            flex: 1;
            max-width: 250px;
        }

        @media (hover: hover) and (pointer: fine) {
            .nav-button:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                text-decoration: none;
            }
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .navigation {
                flex-direction: column;
            }

            .nav-button {
                max-width: 100%;
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'strict'
        });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$']],
                displayMath: [['$$', '$$']],
                processEscapes: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
                ignoreHtmlClass: 'mermaid'
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AI Terakoya Home</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/index.html">Materials Science</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/materials-properties-introduction/index.html">Materials Properties</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 4</span>
        </div>
    </nav>

        <header>
        <div class="header-content">
            <h1>Chapter 4ï¼šé›»æ°—çš„ãƒ»ç£æ°—çš„æ€§è³ª</h1>
            <p class="subtitle">ä¼å°ç¾è±¡ã¨ç£æ€§ã®ç‰©ç†</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– 30-35min</span>
                <span class="meta-item">ğŸ’» 9code examples</span>
                <span class="meta-item">ğŸ“Š Level: Intermediateã€œAdvanced</span>
                <span class="meta-item">ğŸ¯ Learning Objectives: 3ã¤</span>
            </div>
        </div>
    </header>

    <main class="container">
        <h2>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h2>
        <div class="info-box">
            <h3>Learning Objectivesï¼ˆ3ãƒ¬ãƒ™ãƒ«ï¼‰</h3>
            <h4>åŸºæœ¬ãƒ¬ãƒ™ãƒ«</h4>
            <ul>
                <li>Drudeãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹é›»æ°—ä¼å°ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’Descriptionã§ãã‚‹</li>
                <li>HallåŠ¹æœã¨ã‚­ãƒ£ãƒªã‚¢å¯†åº¦ãƒ»ç§»å‹•åº¦ã®é–¢ä¿‚understandã§ãã‚‹</li>
                <li>å¼·ç£æ€§ãƒ»åå¼·ç£æ€§ãƒ»å¸¸ç£æ€§ã®é•ã„ã‚’Descriptionã§ãã‚‹</li>
            </ul>
            <h4>Intermediateãƒ¬ãƒ™ãƒ«</h4>
            <ul>
                <li>ãƒãƒ³ãƒ‰æ§‹é€ ã‹ã‚‰é›»æ°—ä¼å°åº¦ã‚’calculationã§ãã‚‹</li>
                <li>ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¨ã‚¹ãƒ”ãƒ³å¯†åº¦ã®é–¢ä¿‚understandã—ã€calculationã§ãã‚‹</li>
                <li>ã‚¹ãƒ”ãƒ³è»Œé“ç›¸äº’ä½œç”¨ãŒç£æ€§ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’Descriptionã§ãã‚‹</li>
            </ul>
            <h4>Advancedãƒ¬ãƒ™ãƒ«</h4>
            <ul>
                <li>DFTcalculationçµæœã‹ã‚‰é›»æ°—çš„ãƒ»ç£æ°—çš„æ€§è³ªã‚’å®šé‡çš„ã«äºˆæ¸¬ã§ãã‚‹</li>
                <li>è¶…ä¼å°ã®åŸºæœ¬ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ï¼ˆBCSç†è«–ï¼‰understandã§ãã‚‹</li>
                <li>å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã¨DFTcalculationã‚’æ¯”è¼ƒã—ã€æ±é–¢æ•°ã®å¦¥å½“æ€§ã‚’è©•ä¾¡ã§ãã‚‹</li>
            </ul>
        </div>

        <h2>é›»æ°—ä¼å°ã®å¤å…¸ç†è«–ï¼šDrudeãƒ¢ãƒ‡ãƒ«</h2>

        <h3>è‡ªç”±é›»å­è¿‘ä¼¼</h3>
        <p>é‡‘å±ä¸­ã®ä¾¡é›»å­ã‚’ã€Œè‡ªç”±ã«å‹•ãå›ã‚‹ç²’å­ã€ã¨ã¿ãªã™æœ€ã‚‚å˜ç´”ãªãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚é›»å­ã¯atomæ ¸ã®æ ¼å­ä¸­ã‚’è‡ªç”±ã«ç§»å‹•ã—ã€æ•£ä¹±ã¯æ ¼å­æŒ¯å‹•ï¼ˆãƒ•ã‚©ãƒãƒ³ï¼‰ã‚„ä¸ç´”ç‰©ã«ã‚ˆã£ã¦èµ·ã“ã‚Šã¾ã™ã€‚</p>

        <h3>Drudeãƒ¢ãƒ‡ãƒ«ã®åŸºæœ¬æ–¹ç¨‹å¼</h3>
        <p>é›»å ´$\mathbf{E}$ä¸­ã§ã®é›»å­ã®é‹å‹•æ–¹ç¨‹å¼ï¼š</p>

        $$
        m^* \frac{d\mathbf{v}}{dt} = -e\mathbf{E} - \frac{m^*\mathbf{v}}{\tau}
        $$

        <ul>
            <li>$m^*$ï¼šé›»å­ã®æœ‰åŠ¹è³ªé‡</li>
            <li>$\mathbf{v}$ï¼šãƒ‰ãƒªãƒ•ãƒˆé€Ÿåº¦</li>
            <li>$\tau$ï¼šç·©å’Œhoursï¼ˆè¡çªã¾ã§ã®å¹³å‡hoursï¼‰</li>
            <li>$-e$ï¼šé›»å­ã®é›»è·</li>
        </ul>

        <p>å®šå¸¸çŠ¶æ…‹ï¼ˆ$d\mathbf{v}/dt = 0$ï¼‰ã§ã¯ï¼š</p>

        $$
        \mathbf{v} = -\frac{e\tau}{m^*}\mathbf{E}
        $$

        <h3>é›»æ°—ä¼å°åº¦</h3>
        <p>é›»æµå¯†åº¦$\mathbf{J}$ã¯ï¼š</p>

        $$
        \mathbf{J} = -ne\mathbf{v} = \frac{ne^2\tau}{m^*}\mathbf{E} = \sigma \mathbf{E}
        $$

        <p>ã—ãŸãŒã£ã¦ã€é›»æ°—ä¼å°åº¦ã¯ï¼š</p>

        $$
        \sigma = \frac{ne^2\tau}{m^*}
        $$

        <ul>
            <li>$n$ï¼šã‚­ãƒ£ãƒªã‚¢å¯†åº¦ [mâ»Â³]</li>
            <li>$e$ï¼šé›»å­é›»è·ï¼ˆ$1.602 \times 10^{-19}$ Cï¼‰</li>
        </ul>

        <p><strong>ç§»å‹•åº¦$\mu$</strong>ã¨ã®é–¢ä¿‚ï¼š</p>

        $$
        \mu = \frac{e\tau}{m^*}, \quad \sigma = ne\mu
        $$

        <div class="info-box">
            <h4>å…¸å‹çš„ãªå€¤ï¼ˆå®¤æ¸©ï¼‰</h4>
            <table>
                <thead>
                    <tr>
                        <th>ææ–™</th>
                        <th>é›»æ°—ä¼å°åº¦ [S/m]</th>
                        <th>ã‚­ãƒ£ãƒªã‚¢å¯†åº¦ [mâ»Â³]</th>
                        <th>ç§»å‹•åº¦ [cmÂ²/Vs]</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Cuï¼ˆéŠ…ï¼‰</td>
                        <td>5.96 Ã— 10â·</td>
                        <td>8.5 Ã— 10Â²â¸</td>
                        <td>43</td>
                    </tr>
                    <tr>
                        <td>Siï¼ˆnå‹ï¼‰</td>
                        <td>10Â³ - 10âµ</td>
                        <td>10Â²Â¹ - 10Â²Â³</td>
                        <td>1400</td>
                    </tr>
                    <tr>
                        <td>GaAsï¼ˆnå‹ï¼‰</td>
                        <td>10Â³ - 10â¶</td>
                        <td>10Â²Â¹ - 10Â²Â³</td>
                        <td>8500</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>Drudeãƒ¢ãƒ‡ãƒ«ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>

        <pre><code class="language-python">
import numpy as np
import matplotlib.pyplot as plt

# ç‰©ç†å®šæ•°
e = 1.602e-19  # é›»å­é›»è· [C]
m_e = 9.109e-31  # é›»å­è³ªé‡ [kg]

def calculate_conductivity(n, tau, m_star=1.0):
    """
    é›»æ°—ä¼å°åº¦ã‚’calculation

    Parameters:
    -----------
    n : float
        ã‚­ãƒ£ãƒªã‚¢å¯†åº¦ [m^-3]
    tau : float
        ç·©å’Œhours [s]
    m_star : float
        æœ‰åŠ¹è³ªé‡ï¼ˆé›»å­è³ªé‡ã®å˜ä½ï¼‰

    Returns:
    --------
    sigma : float
        é›»æ°—ä¼å°åº¦ [S/m]
    mu : float
        ç§»å‹•åº¦ [cm^2/Vs]
    """
    m_eff = m_star * m_e
    sigma = n * e**2 * tau / m_eff  # ä¼å°åº¦ [S/m]
    mu = e * tau / m_eff * 1e4  # ç§»å‹•åº¦ [cm^2/Vs]
    return sigma, mu

# å…¸å‹çš„ãªé‡‘å±ï¼ˆCuï¼‰
n_Cu = 8.5e28  # [m^-3]
tau_Cu = 2.7e-14  # [s]
sigma_Cu, mu_Cu = calculate_conductivity(n_Cu, tau_Cu, m_star=1.0)

print("=== éŠ…ï¼ˆCuï¼‰ã®é›»æ°—ç‰¹æ€§ ===")
print(f"ã‚­ãƒ£ãƒªã‚¢å¯†åº¦: {n_Cu:.2e} m^-3")
print(f"ç·©å’Œhours: {tau_Cu:.2e} s")
print(f"é›»æ°—ä¼å°åº¦: {sigma_Cu:.2e} S/m")
print(f"ç§»å‹•åº¦: {mu_Cu:.1f} cm^2/Vs")

# åŠå°ä½“ï¼ˆSi nå‹ï¼‰ã®ç§»å‹•åº¦ã¨æ¸©åº¦ä¾å­˜æ€§
temperatures = np.linspace(100, 500, 50)  # [K]
# ç§»å‹•åº¦ã®æ¸©åº¦ä¾å­˜æ€§ï¼ˆç°¡ç•¥ãƒ¢ãƒ‡ãƒ«: Î¼ âˆ T^-3/2ï¼‰
mu_Si_ref = 1400  # [cm^2/Vs] at 300K
T_ref = 300
mu_Si = mu_Si_ref * (temperatures / T_ref)**(-1.5)

plt.figure(figsize=(10, 6))
plt.plot(temperatures, mu_Si, linewidth=2, color='#f093fb')
plt.axhline(y=1400, color='red', linestyle='--', label='å®¤æ¸©å€¤ (300K)')
plt.xlabel('æ¸©åº¦ [K]', fontsize=12)
plt.ylabel('ç§»å‹•åº¦ [cmÂ²/Vs]', fontsize=12)
plt.title('Si nå‹åŠå°ä½“ã®ç§»å‹•åº¦ã®æ¸©åº¦ä¾å­˜æ€§', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('mobility_temperature.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>

        <h2>HallåŠ¹æœã¨ã‚­ãƒ£ãƒªã‚¢æ¸¬å®š</h2>

        <h3>HallåŠ¹æœã®åŸç†</h3>
        <p>é›»æµãŒæµã‚Œã‚‹å°ä½“ã«å‚ç›´ãªç£å ´ã‚’ã‹ã‘ã‚‹ã¨ã€ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„åŠ›ã«ã‚ˆã‚Šé›»è·ãŒåã‚Šã€æ¨ªæ–¹å‘ã«é›»ä½å·®ï¼ˆHallé›»åœ§ï¼‰ãŒç”Ÿã˜ã¾ã™ã€‚</p>

        <div class="mermaid">
graph LR
    A[é›»æµ Jx] --> B[ç£å ´ Bz]
    B --> C[ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„åŠ›<br/>F = -e v Ã— B]
    C --> D[é›»è·miné›¢]
    D --> E[Hallé›»åœ§ VH]

    style A fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style E fill:#d4edda,stroke:#28a745,stroke-width:2px
</div>

        <h3>Hallä¿‚æ•°</h3>
        <p>Hallé›»å ´$E_y$ã¯ï¼š</p>

        $$
        E_y = R_H J_x B_z
        $$

        <p>Hallä¿‚æ•°$R_H$ã¯ï¼š</p>

        $$
        R_H = \frac{1}{ne}
        $$

        <ul>
            <li>æ­£å­”ï¼ˆãƒ›ãƒ¼ãƒ«ï¼‰ã®å ´åˆï¼š$R_H > 0$</li>
            <li>é›»å­ã®å ´åˆï¼š$R_H < 0$</li>
        </ul>

        <p><strong>ã‚­ãƒ£ãƒªã‚¢å¯†åº¦ã®æ¸¬å®š</strong>ï¼š</p>

        $$
        n = \frac{1}{|R_H| e}
        $$

        <p><strong>ç§»å‹•åº¦ã®æ¸¬å®š</strong>ï¼š</p>

        $$
        \mu = |R_H| \sigma
        $$

        <h3>HallåŠ¹æœæ¸¬å®šã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>

        <pre><code class="language-python">
import numpy as np
import matplotlib.pyplot as plt

def hall_effect_simulation(n, mu, B_range, thickness=1e-3):
    """
    HallåŠ¹æœã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ

    Parameters:
    -----------
    n : float
        ã‚­ãƒ£ãƒªã‚¢å¯†åº¦ [m^-3]
    mu : float
        ç§»å‹•åº¦ [m^2/Vs]
    B_range : array
        ç£å ´ç¯„å›² [T]
    thickness : float
        è©¦æ–™åšã• [m]
    """
    e = 1.602e-19

    # Hallä¿‚æ•°
    R_H = 1 / (n * e)  # [m^3/C]

    # é›»æµå¯†åº¦ã‚’ä¸€å®šã¨ä»®å®š
    J = 1e6  # [A/m^2]

    # Hallé›»åœ§
    V_H = R_H * J * B_range * thickness  # [V]

    # HallæŠµæŠ—
    R_Hall = V_H / (J * thickness**2)  # [Î©]

    return V_H, R_Hall, R_H

# Si nå‹åŠå°ä½“ã®ä¾‹
n_Si = 1e22  # [m^-3]
mu_Si = 0.14  # [m^2/Vs] = 1400 cm^2/Vs

B_range = np.linspace(-2, 2, 100)  # [T]
V_H, R_Hall, R_H = hall_effect_simulation(n_Si, mu_Si, B_range)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# Hallé›»åœ§ vs ç£å ´
ax1.plot(B_range, V_H * 1e3, linewidth=2, color='#f093fb')
ax1.axhline(y=0, color='black', linestyle='-', linewidth=0.5)
ax1.axvline(x=0, color='black', linestyle='-', linewidth=0.5)
ax1.set_xlabel('ç£å ´ [T]', fontsize=12)
ax1.set_ylabel('Hallé›»åœ§ [mV]', fontsize=12)
ax1.set_title('Hallé›»åœ§ã®ç£å ´ä¾å­˜æ€§', fontsize=14, fontweight='bold')
ax1.grid(True, alpha=0.3)

# HallæŠµæŠ— vs ç£å ´
ax2.plot(B_range, R_Hall, linewidth=2, color='#f5576c')
ax2.axhline(y=0, color='black', linestyle='-', linewidth=0.5)
ax2.set_xlabel('ç£å ´ [T]', fontsize=12)
ax2.set_ylabel('HallæŠµæŠ— [Î©]', fontsize=12)
ax2.set_title('HallæŠµæŠ—ã®ç£å ´ä¾å­˜æ€§', fontsize=14, fontweight='bold')
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('hall_effect.png', dpi=300, bbox_inches='tight')
plt.show()

print("=== HallåŠ¹æœæ¸¬å®šçµæœ ===")
print(f"ã‚­ãƒ£ãƒªã‚¢å¯†åº¦: {n_Si:.2e} m^-3")
print(f"Hallä¿‚æ•°: {R_H:.2e} m^3/C")
print(f"Hallä¿‚æ•°ã®ç¬¦å·: {'è² ï¼ˆé›»å­ï¼‰' if R_H < 0 else 'æ­£ï¼ˆæ­£å­”ï¼‰'}")
print(f"1Tç£å ´ã§ã®Hallé›»åœ§: {V_H[np.argmin(np.abs(B_range - 1.0))] * 1e3:.3f} mV")
</code></pre>

        <h2>ç£æ€§fundamentals ofç†è«–</h2>

        <h3>ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®èµ·æº</h3>
        <p>atomãƒ»minå­ã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¯ã€2ã¤ã®å¯„ä¸ãŒã‚ã‚Šã¾ã™ï¼š</p>

        <ol>
            <li><strong>è»Œé“ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ</strong>ï¼šé›»å­ã®è»Œé“é‹å‹•ã«ã‚ˆã‚‹
                $$\mathbf{\mu}_L = -\frac{e}{2m_e}\mathbf{L}$$
            </li>
            <li><strong>ã‚¹ãƒ”ãƒ³ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ</strong>ï¼šé›»å­ã®å›ºæœ‰è§’é‹å‹•é‡ï¼ˆã‚¹ãƒ”ãƒ³ï¼‰ã«ã‚ˆã‚‹
                $$\mathbf{\mu}_S = -g_s \frac{e}{2m_e}\mathbf{S}$$
            </li>
        </ol>

        <p>ã“ã“ã§ã€$g_s \approx 2$ã¯gå› å­ã§ã™ã€‚Bohr magneton $\mu_B$ã‚’ç”¨ã„ã¦ï¼š</p>

        $$
        \mu_B = \frac{e\hbar}{2m_e} = 9.274 \times 10^{-24} \, \text{J/T}
        $$

        <h3>ç£åŒ–ã¨ç£åŒ–ç‡</h3>
        <p>ç£åŒ–$M$ã¯ã€å˜ä½ä½“ç©ã‚ãŸã‚Šã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼š</p>

        $$
        \mathbf{M} = \frac{1}{V}\sum_i \mathbf{\mu}_i
        $$

        <p>ç£åŒ–ç‡$\chi$ã¯ï¼š</p>

        $$
        \mathbf{M} = \chi \mathbf{H}
        $$

        <ul>
            <li>$\chi > 0$ï¼šå¸¸ç£æ€§ï¼ˆç£å ´æ–¹å‘ã«ç£åŒ–ï¼‰</li>
            <li>$\chi < 0$ï¼šåç£æ€§ï¼ˆç£å ´ã¨é€†æ–¹å‘ã«ç£åŒ–ï¼‰</li>
        </ul>

        <h3>ç£æ€§ã®miné¡</h3>

        <table>
            <thead>
                <tr>
                    <th>ç£æ€§</th>
                    <th>ç£åŒ–ç‡$\chi$</th>
                    <th>ç‰¹å¾´</th>
                    <th>ä»£è¡¨ä¾‹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>åç£æ€§</strong></td>
                    <td>$\chi < 0$ï¼ˆå°ï¼‰</td>
                    <td>å¤–éƒ¨ç£å ´ã«åç™ºã€æ¸©åº¦ä¾å­˜æ€§ãªã—</td>
                    <td>Cu, Au, Si</td>
                </tr>
                <tr>
                    <td><strong>å¸¸ç£æ€§</strong></td>
                    <td>$\chi > 0$ï¼ˆå°ï¼‰</td>
                    <td>ç£å ´æ–¹å‘ã«å¼±ãç£åŒ–ã€Curieå‰‡ï¼ˆ$\chi \propto 1/T$ï¼‰</td>
                    <td>Al, Pt, Oâ‚‚</td>
                </tr>
                <tr>
                    <td><strong>å¼·ç£æ€§</strong></td>
                    <td>$\chi \gg 1$</td>
                    <td>è‡ªç™ºç£åŒ–ã€ã‚­ãƒ¥ãƒªãƒ¼æ¸©åº¦$T_C$ä»¥ä¸‹ã§ç§©åº</td>
                    <td>Fe, Co, Ni</td>
                </tr>
                <tr>
                    <td><strong>åå¼·ç£æ€§</strong></td>
                    <td>$\chi > 0$ï¼ˆå°ï¼‰</td>
                    <td>éš£æ¥ã‚¹ãƒ”ãƒ³ãŒåå¹³è¡Œã€NÃ©elæ¸©åº¦$T_N$ä»¥ä¸‹ã§ç§©åº</td>
                    <td>MnO, Cr</td>
                </tr>
                <tr>
                    <td><strong>ãƒ•ã‚§ãƒªç£æ€§</strong></td>
                    <td>$\chi > 0$ï¼ˆå¤§ï¼‰</td>
                    <td>åå¹³è¡Œã ãŒå¤§ãã•ãŒç•°ãªã‚‹ â†’ æ­£å‘³ã®ç£åŒ–</td>
                    <td>Feâ‚ƒOâ‚„ï¼ˆç£é‰„é‰±ï¼‰</td>
                </tr>
            </tbody>
        </table>

        <h3>å¼·ç£æ€§ã®å¹³å‡å ´ç†è«–ï¼ˆWeissç†è«–ï¼‰</h3>
        <p>å¼·ç£æ€§ä½“ã§ã¯ã€éš£æ¥ã‚¹ãƒ”ãƒ³ãŒå¹³è¡Œã«æƒãŠã†ã¨ã™ã‚‹ã€Œäº¤æ›ç›¸äº’ä½œç”¨ã€ãŒåƒãã¾ã™ã€‚Weissã¯ã€å„ã‚¹ãƒ”ãƒ³ãŒæ„Ÿã˜ã‚‹ã€Œæœ‰åŠ¹ç£å ´ã€$H_{\text{eff}}$ã‚’å°å…¥ã—ã¾ã—ãŸï¼š</p>

        $$
        H_{\text{eff}} = H + \lambda M
        $$

        <p>$\lambda$ã¯Weisså®šæ•°ï¼ˆminå­å ´å®šæ•°ï¼‰ã§ã™ã€‚è‡ªå·±ç„¡æ’ç€æ–¹ç¨‹å¼ã‚’è§£ãã¨ã€ã‚­ãƒ¥ãƒªãƒ¼æ¸©åº¦$T_C$ãŒå¾—ã‚‰ã‚Œã¾ã™ï¼š</p>

        $$
        T_C = \frac{C\lambda}{N_A k_B}
        $$

        <p>$T < T_C$ã§ã¯è‡ªç™ºç£åŒ–ãŒç”Ÿã˜ã¾ã™ã€‚</p>

        <h2>DFTcalculationã«ã‚ˆã‚‹ç£æ€§ã®äºˆæ¸¬</h2>

        <h3>ã‚¹ãƒ”ãƒ³minæ¥µDFTcalculation</h3>
        <p>ç£æ€§ææ–™ã®DFTcalculationã§ã¯ã€ã‚¹ãƒ”ãƒ³ã‚¢ãƒƒãƒ—ï¼ˆâ†‘ï¼‰ã¨ã‚¹ãƒ”ãƒ³ãƒ€ã‚¦ãƒ³ï¼ˆâ†“ï¼‰ã®é›»å­ã‚’åˆ¥ã€…ã«æ‰±ã„ã¾ã™ï¼ˆã‚¹ãƒ”ãƒ³minæ¥µcalculationï¼‰ã€‚</p>

        <p>é›»å­å¯†åº¦ã¯ã€ã‚¹ãƒ”ãƒ³æˆminã«minè§£ã•ã‚Œã¾ã™ï¼š</p>

        $$
        n(\mathbf{r}) = n_\uparrow(\mathbf{r}) + n_\downarrow(\mathbf{r})
        $$

        <p><strong>ã‚¹ãƒ”ãƒ³å¯†åº¦</strong>ï¼ˆç£åŒ–å¯†åº¦ï¼‰ï¼š</p>

        $$
        m(\mathbf{r}) = n_\uparrow(\mathbf{r}) - n_\downarrow(\mathbf{r})
        $$

        <p><strong>ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ</strong>ï¼š</p>

        $$
        \mu = \mu_B \int m(\mathbf{r}) d\mathbf{r}
        $$

        <h3>VASPã§ã®ã‚¹ãƒ”ãƒ³minæ¥µcalculationè¨­å®š</h3>

        <pre><code class="language-python">
# VASPã§ã‚¹ãƒ”ãƒ³minæ¥µcalculationã‚’è¨­å®šã™ã‚‹INCARãƒ•ã‚¡ã‚¤ãƒ«

def create_magnetic_incar(system_name='Fe', initial_magmom=2.0):
    """
    ç£æ€§ææ–™ã®VASP INCARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ

    Parameters:
    -----------
    system_name : str
        ã‚·ã‚¹ãƒ†ãƒ å
    initial_magmom : float
        åˆæœŸç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ [Î¼B/atom]
    """

    incar_content = f"""SYSTEM = {system_name} magnetic calculation

# Electronic structure
ENCUT = 400
PREC = Accurate
LREAL = Auto

# Exchange-correlation
GGA = PE

# SCF convergence
EDIFF = 1E-6
NELM = 100

# Smearing (é‡‘å±ã®ãŸã‚)
ISMEAR = 1          # Methfessel-Paxton
SIGMA = 0.2

# ã‚¹ãƒ”ãƒ³minæ¥µcalculation
ISPIN = 2           # ã‚¹ãƒ”ãƒ³minæ¥µã‚’æœ‰åŠ¹åŒ–
MAGMOM = {initial_magmom}  # åˆæœŸç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ [Î¼B]

# ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®å‡ºåŠ›
LORBIT = 11         # atomãƒ»è»Œé“å°„å½±ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ

# Parallelization
NCORE = 4
"""
    return incar_content

# å¼·ç£æ€§Feï¼ˆBCCï¼‰ã®calculationè¨­å®š
incar_fe = create_magnetic_incar('Fe BCC', initial_magmom=2.2)
print("=== Fe å¼·ç£æ€§calculation INCAR ===")
print(incar_fe)

# åå¼·ç£æ€§MnOï¼ˆrocksaltï¼‰ã®calculationè¨­å®š
# Mnatomã®åˆæœŸã‚¹ãƒ”ãƒ³ã‚’äº¤äº’ã«è¨­å®š
incar_mno = """SYSTEM = MnO antiferromagnetic

ENCUT = 450
PREC = Accurate
GGA = PE

EDIFF = 1E-6
ISMEAR = 0
SIGMA = 0.05

# ã‚¹ãƒ”ãƒ³minæ¥µcalculation
ISPIN = 2
MAGMOM = 4.0 -4.0 4.0 -4.0 0 0 0 0  # Mn4å€‹ï¼ˆäº¤äº’ï¼‰+ O4å€‹ï¼ˆéç£æ€§ï¼‰

LORBIT = 11
NCORE = 4
"""

print("\n=== MnO åå¼·ç£æ€§calculation INCAR ===")
print(incar_mno)
</code></pre>

        <h3>ã‚¹ãƒ”ãƒ³å¯†åº¦ã®visualization</h3>

        <pre><code class="language-python">
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# ã‚¹ãƒ”ãƒ³å¯†åº¦ã®ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆå®Ÿéš›ã¯VASPå‡ºåŠ›ã‹ã‚‰èª­ã¿è¾¼ã‚€ï¼‰
def generate_spin_density_data():
    """
    Featomå‘¨è¾ºã®ã‚¹ãƒ”ãƒ³å¯†åº¦ã‚’æ¨¡æ“¬çš„ã«ç”Ÿæˆ
    """
    x = np.linspace(-3, 3, 50)
    y = np.linspace(-3, 3, 50)
    X, Y = np.meshgrid(x, y)

    # ã‚¬ã‚¦ã‚¹minå¸ƒã§ã‚¹ãƒ”ãƒ³å¯†åº¦ã‚’è¿‘ä¼¼
    spin_density = 2.2 * np.exp(-(X**2 + Y**2) / 2)

    return X, Y, spin_density

X, Y, spin_density = generate_spin_density_data()

# 2Dãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ã‚³ãƒ³ã‚¿ãƒ¼å›³
contour = ax1.contourf(X, Y, spin_density, levels=20, cmap='RdBu_r')
ax1.contour(X, Y, spin_density, levels=10, colors='black', linewidths=0.5, alpha=0.3)
fig.colorbar(contour, ax=ax1, label='ã‚¹ãƒ”ãƒ³å¯†åº¦ [Î¼B/Ã…Â³]')
ax1.set_xlabel('x [Ã…]', fontsize=12)
ax1.set_ylabel('y [Ã…]', fontsize=12)
ax1.set_title('Featomå‘¨è¾ºã®ã‚¹ãƒ”ãƒ³å¯†åº¦ï¼ˆ2Dï¼‰', fontsize=14, fontweight='bold')
ax1.set_aspect('equal')

# 3Dã‚µãƒ¼ãƒ•ã‚§ã‚¹
from matplotlib import cm
ax2 = fig.add_subplot(122, projection='3d')
surf = ax2.plot_surface(X, Y, spin_density, cmap=cm.coolwarm, alpha=0.8)
ax2.set_xlabel('x [Ã…]', fontsize=10)
ax2.set_ylabel('y [Ã…]', fontsize=10)
ax2.set_zlabel('ã‚¹ãƒ”ãƒ³å¯†åº¦ [Î¼B/Ã…Â³]', fontsize=10)
ax2.set_title('Featomå‘¨è¾ºã®ã‚¹ãƒ”ãƒ³å¯†åº¦ï¼ˆ3Dï¼‰', fontsize=14, fontweight='bold')

plt.tight_layout()
plt.savefig('spin_density.png', dpi=300, bbox_inches='tight')
plt.show()

# ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®calculationï¼ˆæ•°å€¤ç©minï¼‰
dx = X[0, 1] - X[0, 0]
dy = Y[1, 0] - Y[0, 0]
total_moment = np.sum(spin_density) * dx * dy

print(f"\n=== ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆcalculationçµæœ ===")
print(f"ç©minç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ: {total_moment:.2f} Î¼B")
print(f"ï¼ˆå®Ÿéš›ã®Fe: ç´„2.2 Î¼Bï¼‰")
</code></pre>

        <h2>ã‚¹ãƒ”ãƒ³è»Œé“ç›¸äº’ä½œç”¨ï¼ˆSOCï¼‰</h2>

        <h3>SOCã®èµ·æº</h3>
        <p>é›»å­ã®ã‚¹ãƒ”ãƒ³$\mathbf{S}$ã¨è»Œé“è§’é‹å‹•é‡$\mathbf{L}$ãŒç›¸äº’ä½œç”¨ã™ã‚‹åŠ¹æœã§ã™ã€‚ç›¸å¯¾è«–çš„åŠ¹æœã«ã‚ˆã‚Šç”Ÿã˜ã¾ã™ï¼š</p>

        $$
        H_{\text{SOC}} = \lambda \mathbf{L} \cdot \mathbf{S}
        $$

        <p>$\lambda$ã¯ã‚¹ãƒ”ãƒ³è»Œé“çµåˆå®šæ•°ã§ã€atomç•ªå·$Z$ã®å¢—åŠ ã¨ã¨ã‚‚ã«æ€¥æ¿€ã«å¤§ãããªã‚Šã¾ã™ï¼ˆ$\lambda \propto Z^4$ï¼‰ã€‚</p>

        <h3>SOCã®ç‰©ç†çš„å½±éŸ¿</h3>

        <ul>
            <li><strong>ç£æ°—ç•°æ–¹æ€§</strong>ï¼šç£åŒ–ã®å‘ãã«ä¾å­˜ã—ã¦ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå¤‰ã‚ã‚‹</li>
            <li><strong>ç£æ°—å††äºŒè‰²æ€§</strong>ï¼ˆMCDï¼‰ï¼šå††åå…‰ã«å¯¾ã™ã‚‹å¸åã®å·®</li>
            <li><strong>RashbaåŠ¹æœ</strong>ï¼šåè»¢å¯¾ç§°æ€§ã®ç ´ã‚ŒãŸç³»ã§ã®ã‚¹ãƒ”ãƒ³minè£‚</li>
            <li><strong>ãƒˆãƒãƒ­ã‚¸ã‚«ãƒ«çµ¶ç¸ä½“</strong>ï¼šSOCã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰åè»¢</li>
        </ul>

        <h3>VASPã§ã®SOCcalculationè¨­å®š</h3>

        <pre><code class="language-python">
# ã‚¹ãƒ”ãƒ³è»Œé“ç›¸äº’ä½œç”¨ã‚’å«ã‚€VASPcalculationè¨­å®š

def create_soc_incar(system_name='Pt', include_soc=True):
    """
    SOCcalculationã®INCARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆ

    Parameters:
    -----------
    system_name : str
        ã‚·ã‚¹ãƒ†ãƒ å
    include_soc : bool
        SOCã‚’æœ‰åŠ¹åŒ–ã™ã‚‹ã‹
    """

    incar_content = f"""SYSTEM = {system_name} with SOC

ENCUT = 400
PREC = Accurate
GGA = PE

EDIFF = 1E-7        # SOCcalculationã§ã¯é«˜ç²¾åº¦ãŒå¿…è¦
ISMEAR = 1
SIGMA = 0.2

# ã‚¹ãƒ”ãƒ³minæ¥µ + SOC
ISPIN = 2
"""

    if include_soc:
        incar_content += """LSORBIT = .TRUE.    # ã‚¹ãƒ”ãƒ³è»Œé“ç›¸äº’ä½œç”¨ã‚’æœ‰åŠ¹åŒ–
LNONCOLLINEAR = .TRUE.  # éå…±ç·šçš„ç£æ€§ï¼ˆã‚¹ãƒ”ãƒ³ã®å‘ããŒè‡ªç”±ï¼‰
GGA_COMPAT = .FALSE.    # SOCcalculationã«æ¨å¥¨
"""

    incar_content += """
LORBIT = 11
NCORE = 4
"""
    return incar_content

# Ptï¼ˆé‡å…ƒç´ ã€SOCé‡è¦ï¼‰
incar_pt_soc = create_soc_incar('Pt bulk', include_soc=True)
print("=== Pt + SOC calculation INCAR ===")
print(incar_pt_soc)

# SOCãªã—ã¨ã®æ¯”è¼ƒç”¨
incar_pt_no_soc = create_soc_incar('Pt bulk', include_soc=False)
print("\n=== Pt (SOCãªã—) calculation INCAR ===")
print(incar_pt_no_soc)
</code></pre>

        <h3>SOCã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰minè£‚</h3>

        <pre><code class="language-python">
import numpy as np
import matplotlib.pyplot as plt

# SOCã‚ã‚Šãªã—ã®ãƒãƒ³ãƒ‰æ§‹é€ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
def simulate_soc_band_splitting():
    """
    SOCã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰minè£‚ã‚’æ¨¡æ“¬çš„ã«visualization
    """
    k = np.linspace(-np.pi, np.pi, 200)

    # SOCãªã—ï¼ˆç¸®é€€ï¼‰
    E_no_soc = np.cos(k) + 0.5 * np.cos(2*k)

    # SOCã‚ã‚Šï¼ˆminè£‚ï¼‰
    lambda_soc = 0.3  # SOCå¼·åº¦
    E_soc_up = E_no_soc + lambda_soc * np.abs(np.sin(k))
    E_soc_down = E_no_soc - lambda_soc * np.abs(np.sin(k))

    return k, E_no_soc, E_soc_up, E_soc_down

k, E_no_soc, E_soc_up, E_soc_down = simulate_soc_band_splitting()

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# SOCãªã—
ax1.plot(k/np.pi, E_no_soc, linewidth=2, color='blue', label='ç¸®é€€ãƒãƒ³ãƒ‰')
ax1.axhline(y=0, color='black', linestyle='--', linewidth=0.5)
ax1.set_xlabel('k [Ï€/a]', fontsize=12)
ax1.set_ylabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]', fontsize=12)
ax1.set_title('SOCãªã—', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)

# SOCã‚ã‚Š
ax2.plot(k/np.pi, E_soc_up, linewidth=2, color='red', label='ã‚¹ãƒ”ãƒ³ã‚¢ãƒƒãƒ—')
ax2.plot(k/np.pi, E_soc_down, linewidth=2, color='blue', label='ã‚¹ãƒ”ãƒ³ãƒ€ã‚¦ãƒ³')
ax2.axhline(y=0, color='black', linestyle='--', linewidth=0.5)
ax2.set_xlabel('k [Ï€/a]', fontsize=12)
ax2.set_ylabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]', fontsize=12)
ax2.set_title('SOCã‚ã‚Š', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('soc_band_splitting.png', dpi=300, bbox_inches='tight')
plt.show()

# k=Ï€/2ã§ã®minè£‚ã‚¨ãƒãƒ«ã‚®ãƒ¼
idx = len(k) // 4
splitting = E_soc_up[idx] - E_soc_down[idx]
print(f"\n=== SOCã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰minè£‚ ===")
print(f"k=Ï€/2ã§ã®minè£‚: {splitting:.3f} eV")
</code></pre>

        <h2>è¶…ä¼å°fundamentals of</h2>

        <h3>è¶…ä¼å°ç¾è±¡</h3>
        <p>è‡¨ç•Œæ¸©åº¦$T_c$ä»¥ä¸‹ã§ã€é›»æ°—æŠµæŠ—ãŒã‚¼ãƒ­ã«ãªã‚‹ç¾è±¡ã§ã™ã€‚1911å¹´ã€Kamerlingh OnnesãŒHgã§ç™ºè¦‹ã—ã¾ã—ãŸã€‚</p>

        <h3>BCSç†è«–ï¼ˆ1957å¹´ï¼‰</h3>
        <p>Bardeen, Cooper, Schriefferã«ã‚ˆã‚‹å¾®è¦–çš„ç†è«–ã€‚é›»å­ãŒãƒ•ã‚©ãƒãƒ³ï¼ˆæ ¼å­æŒ¯å‹•ï¼‰ã‚’åª’ä»‹ã¨ã—ã¦å¼•åŠ›ã‚’æŒã¡ã€ã€ŒCooperå¯¾ã€ã‚’å½¢æˆã—ã¾ã™ã€‚</p>

        <div class="info-box">
            <h4>Cooperå¯¾å½¢æˆã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ </h4>
            <ol>
                <li>é›»å­AãŒæ ¼å­ã‚’æ­ªã¾ã›ã‚‹ï¼ˆæ­£é›»è·ã‚’å¼•ãå¯„ã›ã‚‹ï¼‰</li>
                <li>æ­ªã‚“ã æ ¼å­ãŒé›»å­Bã‚’å¼•ãå¯„ã›ã‚‹</li>
                <li>å®ŸåŠ¹çš„ã«é›»å­A-Bé–“ã«å¼•åŠ›ãŒåƒãï¼ˆãƒ•ã‚©ãƒãƒ³åª’ä»‹ï¼‰</li>
                <li>åå¯¾ã‚¹ãƒ”ãƒ³ãƒ»åå¯¾é‹å‹•é‡ã®é›»å­å¯¾ãŒå½¢æˆã•ã‚Œã‚‹ï¼ˆ$\mathbf{k}\uparrow, -\mathbf{k}\downarrow$ï¼‰</li>
            </ol>
        </div>

        <p><strong>è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ—</strong>ï¼š</p>

        $$
        \Delta(T) = \Delta_0 \tanh\left(1.74\sqrt{\frac{T_c - T}{T}}\right)
        $$

        <p>$T=0$Kã§ã®ã‚®ãƒ£ãƒƒãƒ—ï¼š</p>

        $$
        \Delta_0 \approx 1.76 k_B T_c
        $$

        <h3>ä»£è¡¨çš„ãªè¶…ä¼å°ä½“</h3>

        <table>
            <thead>
                <tr>
                    <th>ææ–™</th>
                    <th>$T_c$ [K]</th>
                    <th>ç¨®é¡</th>
                    <th>å‚™è€ƒ</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Hgï¼ˆæ°´éŠ€ï¼‰</td>
                    <td>4.15</td>
                    <td>Type I</td>
                    <td>æœ€åˆã«ç™ºè¦‹ã•ã‚ŒãŸè¶…ä¼å°ä½“</td>
                </tr>
                <tr>
                    <td>Nbâ‚ƒSn</td>
                    <td>18.3</td>
                    <td>Type II</td>
                    <td>A15æ§‹é€ ã€ç£çŸ³ã«ä½¿ç”¨</td>
                </tr>
                <tr>
                    <td>YBaâ‚‚Cuâ‚ƒOâ‚‡ï¼ˆYBCOï¼‰</td>
                    <td>92</td>
                    <td>é«˜æ¸©</td>
                    <td>éŠ…é…¸åŒ–ç‰©ã€æ¶²ä½“çª’ç´ æ¸©åº¦ä»¥ä¸Š</td>
                </tr>
                <tr>
                    <td>MgBâ‚‚</td>
                    <td>39</td>
                    <td>Type II</td>
                    <td>å˜ç´”æ§‹é€ ã€BCSç†è«–ã§Descriptionå¯èƒ½</td>
                </tr>
                <tr>
                    <td>Hâ‚ƒSï¼ˆé«˜åœ§ï¼‰</td>
                    <td>203</td>
                    <td>é«˜æ¸©</td>
                    <td>150 GPaã€æœ€é«˜$T_c$è¨˜éŒ²</td>
                </tr>
            </tbody>
        </table>

        <h3>è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ—ã®æ¸©åº¦ä¾å­˜æ€§</h3>

        <pre><code class="language-python">
import numpy as np
import matplotlib.pyplot as plt

def superconducting_gap(T, Tc):
    """
    BCSç†è«–ã«ã‚ˆã‚‹è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ—ã®æ¸©åº¦ä¾å­˜æ€§

    Parameters:
    -----------
    T : array
        æ¸©åº¦ [K]
    Tc : float
        è‡¨ç•Œæ¸©åº¦ [K]

    Returns:
    --------
    Delta : array
        è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ— [meV]
    """
    k_B = 8.617e-5  # Boltzmann constant [eV/K]

    # BCSç†è«–ã®è¿‘ä¼¼å¼
    Delta_0 = 1.76 * k_B * Tc * 1000  # [meV]

    Delta = np.zeros_like(T)
    mask = T < Tc
    Delta[mask] = Delta_0 * np.tanh(1.74 * np.sqrt((Tc - T[mask]) / T[mask]))

    return Delta

# å„ç¨®è¶…ä¼å°ä½“ã®T_c
materials = {
    'Al': 1.2,
    'Nb': 9.2,
    'MgBâ‚‚': 39,
    'YBCO': 92
}

T = np.linspace(0.1, 100, 500)

plt.figure(figsize=(10, 6))

for name, Tc in materials.items():
    Delta = superconducting_gap(T, Tc)
    plt.plot(T, Delta, linewidth=2, label=f'{name} ($T_c$={Tc}K)')

plt.xlabel('æ¸©åº¦ [K]', fontsize=12)
plt.ylabel('è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ— Î”(T) [meV]', fontsize=12)
plt.title('è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ—ã®æ¸©åº¦ä¾å­˜æ€§', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.xlim(0, 100)
plt.tight_layout()
plt.savefig('superconducting_gap.png', dpi=300, bbox_inches='tight')
plt.show()

# Î”_0 / k_B T_c ã®æ¤œè¨¼ï¼ˆBCSç†è«–ã§ã¯1.76ï¼‰
for name, Tc in materials.items():
    k_B = 8.617e-5
    Delta_0 = 1.76 * k_B * Tc * 1000
    ratio = Delta_0 / (k_B * Tc * 1000)
    print(f"{name}: Î”â‚€/(kBÂ·Tc) = {ratio:.2f}")
</code></pre>

        <h2>ã¾ã¨ã‚</h2>

        <div class="success-box">
            <h3>ã“ã®ç« ã§å­¦ã‚“ã ã“ã¨</h3>
            <h4>é›»æ°—çš„æ€§è³ª</h4>
            <ul>
                <li>Drudeãƒ¢ãƒ‡ãƒ«ã§é›»æ°—ä¼å°understandï¼š$\sigma = ne^2\tau/m^*$</li>
                <li>HallåŠ¹æœã§ã‚­ãƒ£ãƒªã‚¢å¯†åº¦ã¨ç§»å‹•åº¦ã‚’æ¸¬å®šã§ãã‚‹</li>
                <li>åŠå°ä½“ã¯æ¸©åº¦ä¸Šæ˜‡ã§ç§»å‹•åº¦ãŒä½ä¸‹ï¼ˆ$\mu \propto T^{-3/2}$ï¼‰</li>
            </ul>

            <h4>ç£æ°—çš„æ€§è³ª</h4>
            <ul>
                <li>ç£æ€§ã¯åç£æ€§ã€å¸¸ç£æ€§ã€å¼·ç£æ€§ã€åå¼·ç£æ€§ã€ãƒ•ã‚§ãƒªç£æ€§ã«miné¡ã•ã‚Œã‚‹</li>
                <li>ã‚¹ãƒ”ãƒ³minæ¥µDFTcalculationï¼ˆISPIN=2ï¼‰ã§ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã‚’äºˆæ¸¬ã§ãã‚‹</li>
                <li>ã‚¹ãƒ”ãƒ³è»Œé“ç›¸äº’ä½œç”¨ï¼ˆSOCï¼‰ã¯é‡å…ƒç´ ã§é‡è¦ã€ç£æ°—ç•°æ–¹æ€§ã®èµ·æº</li>
            </ul>

            <h4>è¶…ä¼å°</h4>
            <ul>
                <li>BCSç†è«–ï¼šé›»å­ãŒCooperå¯¾ã‚’å½¢æˆã—ã€æŠµæŠ—ã‚¼ãƒ­ã«</li>
                <li>è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ—ï¼š$\Delta_0 \approx 1.76 k_B T_c$</li>
                <li>é«˜æ¸©è¶…ä¼å°ä½“ï¼ˆYBCO: 92Kï¼‰ã¯æ¶²ä½“çª’ç´ æ¸©åº¦ä»¥ä¸Šã§å‹•ä½œ</li>
            </ul>

            <h4>æ¬¡ç« ã¸ã®æº–å‚™</h4>
            <ul>
                <li>Chapter 5ã§ã¯ã€å…‰å­¦çš„ãƒ»ç†±çš„æ€§è³ªwill be covered</li>
                <li>å…‰å¸åã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã€ãƒ•ã‚©ãƒãƒ³ã€ç†±ä¼å°ã‚’calculationã—ã¾ã™</li>
            </ul>
        </div>

        <h2>æ¼”ç¿’å•é¡Œ</h2>

        <div class="exercise-box">
            <h4>æ¼”ç¿’1ï¼šDrudeãƒ¢ãƒ‡ãƒ«ã®é©ç”¨ï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜†â˜†ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€é›»æ°—ä¼å°åº¦ã¨ç§»å‹•åº¦ã‚’calculationã—ã¦ãã ã•ã„ã€‚</p>
            <ul>
                <li>ææ–™: nå‹SiåŠå°ä½“</li>
                <li>ã‚­ãƒ£ãƒªã‚¢å¯†åº¦: $n = 1.0 \times 10^{22}$ mâ»Â³</li>
                <li>ç·©å’Œhours: $\tau = 0.1$ ps = $1.0 \times 10^{-13}$ s</li>
                <li>æœ‰åŠ¹è³ªé‡: $m^* = 0.26 m_e$</li>
            </ul>

            <p><strong>ãƒ’ãƒ³ãƒˆ</strong>ï¼š</p>
            <ul>
                <li>$\sigma = ne^2\tau/m^*$</li>
                <li>$\mu = e\tau/m^*$</li>
                <li>$e = 1.602 \times 10^{-19}$ C, $m_e = 9.109 \times 10^{-31}$ kg</li>
            </ul>

            <p><strong>è§£ç­”</strong>ï¼š$\sigma \approx 1.08 \times 10^4$ S/mã€$\mu \approx 674$ cmÂ²/Vs</p>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’2ï¼šHallåŠ¹æœã«ã‚ˆã‚‹ã‚­ãƒ£ãƒªã‚¢åˆ¤å®šï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜†ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šã‚ã‚‹åŠå°ä½“ã«1Tã®ç£å ´ã‚’å°åŠ ã—ã€Hallæ¸¬å®šã‚’è¡Œã£ãŸã¨ã“ã‚ã€Hallä¿‚æ•°$R_H = +5.0 \times 10^{-4}$ mÂ³/Cã§ã—ãŸã€‚</p>
            <ol>
                <li>ã‚­ãƒ£ãƒªã‚¢ã¯é›»å­ã‹æ­£å­”ã‹ï¼Ÿ</li>
                <li>ã‚­ãƒ£ãƒªã‚¢å¯†åº¦ã‚’calculationã›ã‚ˆ</li>
                <li>é›»æ°—ä¼å°åº¦ãŒ$\sigma = 100$ S/mã®ã¨ãã€ç§»å‹•åº¦ã‚’calculationã›ã‚ˆ</li>
            </ol>

            <p><strong>è§£ç­”</strong>ï¼š</p>
            <ol>
                <li>$R_H > 0$ ãªã®ã§æ­£å­”ã‚­ãƒ£ãƒªã‚¢ï¼ˆpå‹åŠå°ä½“ï¼‰</li>
                <li>$n = 1/(R_H \cdot e) = 1.25 \times 10^{22}$ mâ»Â³</li>
                <li>$\mu = R_H \cdot \sigma = 0.05$ mÂ²/Vs = 500 cmÂ²/Vs</li>
            </ol>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’3ï¼šç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®calculationï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜†ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šFeatomï¼ˆBCCæ§‹é€ ã€a=2.87 Ã…ï¼‰ã®ã‚¹ãƒ”ãƒ³minæ¥µDFTcalculationã‚’è¡Œã„ã€ä»¥ä¸‹ã®çµæœã‚’å¾—ã¾ã—ãŸï¼š</p>
            <ul>
                <li>ã‚¹ãƒ”ãƒ³ã‚¢ãƒƒãƒ—é›»å­æ•°: 8.1å€‹</li>
                <li>ã‚¹ãƒ”ãƒ³ãƒ€ã‚¦ãƒ³é›»å­æ•°: 5.9å€‹</li>
            </ul>
            <p>ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã‚’calculationã—ã€å®Ÿé¨“å€¤ï¼ˆ2.2 Î¼Bï¼‰ã¨æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚</p>

            <p><strong>ãƒ’ãƒ³ãƒˆ</strong>ï¼š$\mu = (N_\uparrow - N_\downarrow) \mu_B$</p>

            <p><strong>è§£ç­”</strong>ï¼š$\mu = (8.1 - 5.9) \mu_B = 2.2 \mu_B$ï¼ˆå®Ÿé¨“å€¤ã¨ä¸€è‡´ï¼‰</p>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’4ï¼šè¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ—ã®calculationï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜†ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šNbï¼ˆãƒ‹ã‚ªãƒ–ï¼‰ã®è‡¨ç•Œæ¸©åº¦ã¯$T_c = 9.2$Kã§ã™ã€‚</p>
            <ol>
                <li>$T = 0$Kã§ã®è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ—$\Delta_0$ã‚’calculationã›ã‚ˆ</li>
                <li>$T = 5$Kã§ã®è¶…ä¼å°ã‚®ãƒ£ãƒƒãƒ—$\Delta(5K)$ã‚’calculationã›ã‚ˆ</li>
            </ol>

            <p><strong>ãƒ’ãƒ³ãƒˆ</strong>ï¼š</p>
            <ul>
                <li>$\Delta_0 = 1.76 k_B T_c$</li>
                <li>$\Delta(T) = \Delta_0 \tanh(1.74\sqrt{(T_c - T)/T})$</li>
                <li>$k_B = 8.617 \times 10^{-5}$ eV/K</li>
            </ul>

            <p><strong>è§£ç­”</strong>ï¼š</p>
            <ol>
                <li>$\Delta_0 = 1.76 \times 8.617 \times 10^{-5} \times 9.2 = 1.40$ meV</li>
                <li>$\Delta(5K) = 1.40 \times \tanh(1.74\sqrt{(9.2-5)/5}) = 1.40 \times 0.87 = 1.22$ meV</li>
            </ol>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’5ï¼šVASPã‚¹ãƒ”ãƒ³minæ¥µcalculationã®æº–å‚™ï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜…ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šåå¼·ç£æ€§MnOï¼ˆrocksaltæ§‹é€ ã€a=4.43 Ã…ï¼‰ã®ã‚¹ãƒ”ãƒ³minæ¥µDFTcalculationã‚’æº–å‚™ã—ã¦ãã ã•ã„ã€‚</p>
            <ol>
                <li>ASEã§MnOæ§‹é€ ã‚’ä½œæˆï¼ˆ2Ã—2Ã—2ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ï¼‰</li>
                <li>Mnatomã®åˆæœŸç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã‚’äº¤äº’ã«è¨­å®šï¼ˆÂ±5.0 Î¼Bï¼‰</li>
                <li>INCARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆISPIN=2, MAGMOMè¨­å®šï¼‰</li>
                <li>KPOINTSãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼ˆ6Ã—6Ã—6ãƒ¡ãƒƒã‚·ãƒ¥ï¼‰</li>
            </ol>

            <p><strong>è©•ä¾¡åŸºæº–</strong>ï¼š</p>
            <ul>
                <li>MAGMOMãŒMnatomã®ã¿ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹</li>
                <li>Mnatomã®ã‚¹ãƒ”ãƒ³ãŒäº¤äº’é…ç½®ã«ãªã£ã¦ã„ã‚‹ã‹</li>
                <li>Oatomã®åˆæœŸç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãŒ0ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹</li>
            </ul>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’6ï¼šç£åŒ–ç‡ã®æ¸©åº¦ä¾å­˜æ€§ï¼ˆé›£æ˜“åº¦ï¼šâ˜…â˜…â˜…ï¼‰</h4>
            <p><strong>å•é¡Œ</strong>ï¼šå¸¸ç£æ€§ç‰©è³ªã®ç£åŒ–ç‡ã¯ã€Curieå‰‡ã«å¾“ã„ã¾ã™ï¼š</p>
            $$
            \chi = \frac{C}{T}
            $$
            <p>ã“ã“ã§ã€$C$ã¯Curieå®šæ•°ã§ã™ã€‚ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€Curieå®šæ•°ã‚’æ±‚ã‚ã¦ãã ã•ã„ï¼š</p>
            <table>
                <thead>
                    <tr>
                        <th>æ¸©åº¦ [K]</th>
                        <th>ç£åŒ–ç‡ $\chi$ [10â»â¶]</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>100</td><td>8.5</td></tr>
                    <tr><td>200</td><td>4.2</td></tr>
                    <tr><td>300</td><td>2.8</td></tr>
                    <tr><td>400</td><td>2.1</td></tr>
                </tbody>
            </table>

            <p><strong>ãƒ’ãƒ³ãƒˆ</strong>ï¼š$\chi$å¯¾$1/T$ã®ãƒ—ãƒ­ãƒƒãƒˆã§ç›´ç·šã®å‚¾ããŒCurieå®šæ•°</p>

            <p><strong>è§£ç­”ä¾‹</strong>ï¼š$C \approx 8.5 \times 10^{-4}$ Kï¼ˆç·šå½¢ãƒ•ã‚£ãƒƒãƒˆï¼‰</p>
        </div>

        <h2>å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Ashcroft, N. W., & Mermin, N. D. (1976). "Solid State Physics". Harcourt College Publishers.</li>
            <li>Kittel, C. (2004). "Introduction to Solid State Physics" (8th ed.). Wiley.</li>
            <li>Blundell, S. (2001). "Magnetism in Condensed Matter". Oxford University Press.</li>
            <li>Tinkham, M. (2004). "Introduction to Superconductivity" (2nd ed.). Dover Publications.</li>
            <li>Bardeen, J., Cooper, L. N., & Schrieffer, J. R. (1957). "Theory of Superconductivity". Physical Review, 108, 1175.</li>
            <li>VASP manual: Magnetism and SOC - https://www.vasp.at/wiki/index.php/Magnetism</li>
        </ol>

        <div class="navigation">
            <a href="chapter-3.html" class="nav-button">â† Chapter 3ï¼šDFTåŸºç¤</a>
            <a href="chapter-5.html" class="nav-button">Chapter 5ï¼šå…‰å­¦çš„ãƒ»ç†±çš„æ€§è³ª â†’</a>
        </div>
    </main>

    <footer>
        <p><strong>Materials Properties Introduction Series - Chapter 4</strong></p>
        <p>Electrical and Magnetic Properties of Materials</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
