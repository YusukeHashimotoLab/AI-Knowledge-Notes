<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: セラミックス結晶構造 - セラミックス材料入門 - MS Dojo</title>
    <meta name="description" content="セラミックス材料の基本結晶構造を学ぶ。イオン結合性・共有結合性セラミックス、ペロブスカイト・スピネル構造をPythonで理解する。">

    <!-- Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <!-- MathJax for mathematical expressions -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        :root {
            --accent-pink: #f093fb;
            --accent-coral: #f5576c;
            --primary-dark: #2c3e50;
            --secondary-dark: #34495e;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --bg-light: #ecf0f1;
            --white: #ffffff;
            --code-bg: #2d2d2d;
            --border-light: #bdc3c7;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.8;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        header {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
            padding: 3rem 1.5rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        nav {
            background: var(--white);
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
        }

        nav a {
            text-decoration: none;
            color: var(--text-dark);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            font-weight: 500;
        }

        nav a:hover {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        section {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-dark);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--accent-pink), var(--accent-coral)) 1;
        }

        h3 {
            color: var(--secondary-dark);
            font-size: 1.4rem;
            margin: 2rem 0 1rem;
        }

        h4 {
            color: var(--secondary-dark);
            font-size: 1.2rem;
            margin: 1.5rem 0 1rem;
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            border-left: 4px solid var(--accent-coral);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box strong {
            color: var(--accent-coral);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .warning-box {
            background: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box strong {
            color: var(--warning);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .exercise-box {
            background: rgba(39, 174, 96, 0.05);
            border: 2px solid var(--success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .exercise-box h4 {
            color: var(--success);
            margin-top: 0;
        }

        .difficulty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .difficulty.easy {
            background: #d4edda;
            color: #155724;
        }

        .difficulty.medium {
            background: #fff3cd;
            color: #856404;
        }

        .difficulty.hard {
            background: #f8d7da;
            color: #721c24;
        }

        .mermaid {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }

        th {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(240, 147, 251, 0.05);
        }

        footer {
            background: var(--primary-dark);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        footer a {
            color: var(--accent-pink);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--accent-coral);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5rem;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            section {
                padding: 1.5rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }
        }
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>
</head>
<body>
        <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AI Terakoya Home</a><span class="breadcrumb-separator">›</span><a href="../../MS/index.html">Materials Science</a><span class="breadcrumb-separator">›</span><a href="../../MS/ceramic-materials-introduction/index.html">Ceramic Materials</a><span class="breadcrumb-separator">›</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

    <header>
        <h1>Chapter 1: セラミックス結晶構造</h1>
        <p>イオン・共有結合性セラミックス、ペロブスカイト・スピネル構造の基本原理</p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">トップ</a></li>
            <li><a href="#intro">概要</a></li>
            <li><a href="#ionic">イオン結合性</a></li>
            <li><a href="#covalent">共有結合性</a></li>
            <li><a href="#perovskite">ペロブスカイト</a></li>
            <li><a href="#spinel">スピネル</a></li>
            <li><a href="#exercises">演習問題</a></li>
            <li><a href="#references">参考文献</a></li>
            <li><a href="chapter-2.html">次の章へ →</a></li>
        </ul>
    </nav>

    <main>
        <section id="intro">
            <h2>1.1 セラミックス結晶構造の概要</h2>

            <p>
                セラミックス材料は、金属元素と非金属元素（主に酸素、窒素、炭素）の化合物であり、その特性は<strong>結晶構造</strong>と<strong>Chemistry結合</strong>によって決定されます。本章では、セラミックスの主要な結晶構造を学び、Pythonツール（<strong>Pymatgen</strong>）を使って構造analysisをpracticeします。
            </p>

            <div class="info-box">
                <strong>本章のLearning Objectives</strong>
                <ul>
                    <li><strong>レベル1（基本理解）</strong>: 主要な結晶構造タイプ（NaCl、CsCl、ペロブスカイト、スピネル）を識別し、その特徴をDescriptionできる</li>
                    <li><strong>レベル2（practiceスキル）</strong>: Pymatgenを使用して結晶構造を生成し、格子定数・密度・X線回折パターンをcalculationできる</li>
                    <li><strong>レベル3（応用力）</strong>: Paulingの規則を適用して構造安定性を評価し、構造-物性相関を予測できる</li>
                </ul>
            </div>

            <h3>セラミックス構造のmin類</h3>
            <p>セラミックス結晶構造は、結合性質によって以下の2つに大別されます：</p>

            <ol>
                <li><strong>イオン結合性セラミックス</strong>: NaCl、MgO、Al₂O₃など（静電引力が支配的）</li>
                <li><strong>共有結合性セラミックス</strong>: SiC、Si₃N₄、AlNなど（方向性のある共有結合）</li>
            </ol>

            <div class="mermaid">
            flowchart TD
                A[セラミックス結晶構造] --> B[イオン結合性]
                A --> C[共有結合性]
                B --> D[NaCl型<br/>MgO, CaO]
                B --> E[CsCl型<br/>CsCl]
                B --> F[CaF₂型<br/>ZrO₂, UO₂]
                B --> G[ペロブスカイト<br/>BaTiO₃, SrTiO₃]
                B --> H[スピネル<br/>MgAl₂O₄, Fe₃O₄]
                C --> I[ダイヤモンド型<br/>C, Si]
                C --> J[閃亜鉛鉱型<br/>SiC, GaAs]
                C --> K[ウルツ鉱型<br/>ZnO, AlN]

                style A fill:#f093fb,color:#fff
                style B fill:#e3f2fd
                style C fill:#fff3e0
                style G fill:#f5576c,color:#fff
                style H fill:#f5576c,color:#fff
            </div>
        </section>

        <section id="ionic">
            <h2>1.2 イオン結合性セラミックス</h2>

            <h3>1.2.1 NaCl型構造</h3>

            <p>
                <strong>NaCl型（岩塩型）構造</strong>は、最も基本的なイオン結晶構造です。陽イオンと陰イオンがそれぞれ面心立方（FCC）格子を形成し、互いに侵入した配置を取ります。各イオンは6つの反対符号イオンに囲まれます（配位数CN = 6）。
            </p>

            <p>代表的な材料：</p>
            <ul>
                <li><strong>MgO（酸化マグネシウム）</strong>: 耐火材料、高温絶縁体（融点2852°C）</li>
                <li><strong>CaO（酸化カルシウム）</strong>: セメント原料</li>
                <li><strong>NiO（酸化ニッケル）</strong>: 電池正極材料</li>
            </ul>

            <h4>Pymatgen実装: NaCl構造の生成とvisualization</h4>

            <pre><code class="language-python"># ===================================
# Example 1: NaCl型構造の生成と基本analysis
# ===================================

from pymatgen.core import Structure, Lattice
import matplotlib.pyplot as plt
import numpy as np

def create_nacl_structure(a=4.2):
    """
    NaCl型構造を生成する関数

    Parameters:
    -----------
    a : float
        格子定数 [Å]（デフォルト: 4.2Å for MgO）

    Returns:
    --------
    structure : pymatgen.core.Structure
        NaCl型結晶構造
    """
    # FCC格子の定義
    lattice = Lattice.cubic(a)

    # atom位置の定義（min数座標）
    # Mg2+: (0,0,0), (0.5,0.5,0), (0.5,0,0.5), (0,0.5,0.5) - FCC
    # O2-: (0.5,0,0), (0,0.5,0), (0,0,0.5), (0.5,0.5,0.5) - FCC shifted
    species = ["Mg", "Mg", "Mg", "Mg", "O", "O", "O", "O"]
    coords = [
        [0, 0, 0], [0.5, 0.5, 0], [0.5, 0, 0.5], [0, 0.5, 0.5],  # Mg
        [0.5, 0, 0], [0, 0.5, 0], [0, 0, 0.5], [0.5, 0.5, 0.5]   # O
    ]

    structure = Structure(lattice, species, coords)
    return structure

# MgO構造の生成
mgo = create_nacl_structure(a=4.211)  # MgOの実験格子定数

print("=== MgO (NaCl型) 構造情報 ===")
print(f"Chemistry式: {mgo.composition.reduced_formula}")
print(f"格子定数: a = {mgo.lattice.a:.3f} Å")
print(f"単位格子体積: {mgo.volume:.2f} Å³")
print(f"密度: {mgo.density:.2f} g/cm³")
print(f"atom数/単位格子: {len(mgo)}")

# 配位数のcalculation
mg_site = mgo[0]  # 最初のMgatom
neighbors = mgo.get_neighbors(mg_site, r=3.0)
print(f"\nMgatomの最近接Oatom数: {len(neighbors)}")
print(f"Mg-O距離: {neighbors[0][1]:.3f} Å")

# 期待される出力:
# === MgO (NaCl型) 構造情報 ===
# Chemistry式: MgO
# 格子定数: a = 4.211 Å
# 単位格子体積: 74.68 Å³
# 密度: 3.58 g/cm³
# atom数/単位格子: 8
#
# Mgatomの最近接Oatom数: 6
# Mg-O距離: 2.106 Å
</code></pre>

            <h3>1.2.2 Paulingの規則</h3>

            <p>
                <strong>Paulingの規則</strong>は、イオン結晶の安定構造を予測する5つの経験則です。最も重要なのは<strong>第1規則</strong>と<strong>第2規則</strong>です：
            </p>

            <div class="info-box">
                <strong>Paulingの第1規則: 配位多面体</strong>
                陽イオンと陰イオンの距離は、半径の和 \(r_+ + r_-\) で決まります。配位数（CN）は半径比 \(r_+/r_-\) によって決定されます：

                \[
                \text{CN} =
                \begin{cases}
                2 & \text{(線形)} & 0 < r_+/r_- < 0.155 \\
                3 & \text{(三角形)} & 0.155 < r_+/r_- < 0.225 \\
                4 & \text{(四面体)} & 0.225 < r_+/r_- < 0.414 \\
                6 & \text{(八面体)} & 0.414 < r_+/r_- < 0.732 \\
                8 & \text{(立方体)} & 0.732 < r_+/r_- < 1.0
                \end{cases}
                \]
            </div>

            <h4>Python実装: 配位数と半径比のcalculation</h4>

            <pre><code class="language-python"># ===================================
# Example 2: Paulingの規則による配位数予測
# ===================================

def predict_coordination_number(r_cation, r_anion):
    """
    半径比から配位数を予測する関数

    Parameters:
    -----------
    r_cation : float
        陽イオン半径 [Å]
    r_anion : float
        陰イオン半径 [Å]

    Returns:
    --------
    cn : int
        予測される配位数
    geometry : str
        配位多面体の形状
    """
    ratio = r_cation / r_anion

    if ratio < 0.155:
        return 2, "線形"
    elif ratio < 0.225:
        return 3, "三角形平面"
    elif ratio < 0.414:
        return 4, "四面体"
    elif ratio < 0.732:
        return 6, "八面体"
    else:
        return 8, "立方体"

# イオン半径データ（Shannon半径、6配位）
ionic_radii = {
    "Mg2+": 0.72,
    "Ca2+": 1.00,
    "Na+": 1.02,
    "Cs+": 1.67,
    "O2-": 1.40,
    "Cl-": 1.81
}

# NaCl型構造の予測
print("=== 配位数予測 ===\n")

materials = [
    ("Mg2+", "O2-", "MgO"),
    ("Ca2+", "O2-", "CaO"),
    ("Na+", "Cl-", "NaCl"),
    ("Cs+", "Cl-", "CsCl")
]

for cation, anion, formula in materials:
    r_cat = ionic_radii[cation]
    r_an = ionic_radii[anion]
    ratio = r_cat / r_an
    cn, geometry = predict_coordination_number(r_cat, r_an)

    print(f"{formula}:")
    print(f"  半径比: {ratio:.3f}")
    print(f"  予測配位数: {cn} ({geometry})")
    print()

# 期待される出力:
# === 配位数予測 ===
#
# MgO:
#   半径比: 0.514
#   予測配位数: 6 (八面体)
#
# CaO:
#   半径比: 0.714
#   予測配位数: 6 (八面体)
#
# NaCl:
#   半径比: 0.564
#   予測配位数: 6 (八面体)
#
# CsCl:
#   半径比: 0.922
#   予測配位数: 8 (立方体)
</code></pre>

            <h3>1.2.3 CsCl型とCaF₂型構造</h3>

            <p>
                <strong>CsCl型構造</strong>は、単純立方格子の中心に反対符号のイオンを配置した構造です（CN = 8）。半径比が大きい場合（\(r_+/r_- > 0.732\)）に安定です。
            </p>

            <p>
                <strong>CaF₂型（蛍石型）構造</strong>は、陽イオンがFCC格子、陰イオンが四面体位置（1/4, 1/4, 1/4）に配置された構造です。Chemistry量論が1:2の酸化物（ZrO₂、UO₂）で見られます。
            </p>

            <table>
                <thead>
                    <tr>
                        <th>構造タイプ</th>
                        <th>配位数（陽/陰）</th>
                        <th>半径比範囲</th>
                        <th>代表例</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>NaCl型</td>
                        <td>6:6</td>
                        <td>0.414 - 0.732</td>
                        <td>MgO, CaO, NaCl</td>
                    </tr>
                    <tr>
                        <td>CsCl型</td>
                        <td>8:8</td>
                        <td>0.732 - 1.0</td>
                        <td>CsCl, CsBr, CsI</td>
                    </tr>
                    <tr>
                        <td>CaF₂型</td>
                        <td>8:4</td>
                        <td>-</td>
                        <td>ZrO₂, UO₂, CaF₂</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="covalent">
            <h2>1.3 共有結合性セラミックス</h2>

            <h3>1.3.1 ダイヤモンド構造と閃亜鉛鉱構造</h3>

            <p>
                <strong>ダイヤモンド構造</strong>は、炭素とシリコンの基本構造です。各atomは4つの最近接atomと共有結合し、sp³混成軌道による四面体配位を形成します。
            </p>

            <p>
                <strong>閃亜鉛鉱（ジンクブレンド、ZnS型）構造</strong>は、ダイヤモンド構造の2種類のatomが交互に配置された構造です。SiC（炭化ケイ素）は3C-SiCとして、この構造を取ります。
            </p>

            <h4>Python実装: SiC構造の生成とバンドギャップ予測</h4>

            <pre><code class="language-python"># ===================================
# Example 3: 閃亜鉛鉱型SiC構造の生成
# ===================================

from pymatgen.core import Structure, Lattice

def create_zincblende_structure(a, cation, anion):
    """
    閃亜鉛鉱型構造を生成する関数

    Parameters:
    -----------
    a : float
        格子定数 [Å]
    cation : str
        陽イオン元素記号
    anion : str
        陰イオン元素記号

    Returns:
    --------
    structure : pymatgen.core.Structure
        閃亜鉛鉱型結晶構造
    """
    # 立方晶格子
    lattice = Lattice.cubic(a)

    # atom位置（min数座標）
    # Si: (0,0,0), (0.5,0.5,0), (0.5,0,0.5), (0,0.5,0.5) - FCC
    # C: (0.25,0.25,0.25), (0.75,0.75,0.25), (0.75,0.25,0.75), (0.25,0.75,0.75)
    species = [cation]*4 + [anion]*4
    coords = [
        [0, 0, 0], [0.5, 0.5, 0], [0.5, 0, 0.5], [0, 0.5, 0.5],
        [0.25, 0.25, 0.25], [0.75, 0.75, 0.25],
        [0.75, 0.25, 0.75], [0.25, 0.75, 0.75]
    ]

    structure = Structure(lattice, species, coords)
    return structure

# 3C-SiC（cubic SiC）の生成
sic = create_zincblende_structure(a=4.358, cation="Si", anion="C")

print("=== 3C-SiC (閃亜鉛鉱型) 構造情報 ===")
print(f"Chemistry式: {sic.composition.reduced_formula}")
print(f"格子定数: a = {sic.lattice.a:.3f} Å")
print(f"密度: {sic.density:.2f} g/cm³")

# Si-C結合距離のcalculation
si_site = sic[0]
neighbors = sic.get_neighbors(si_site, r=2.5)
print(f"\nSi-C結合数: {len(neighbors)}")
print(f"Si-C結合距離: {neighbors[0][1]:.3f} Å")

# 理論結合角のcalculation（四面体角度 = 109.47°）
import numpy as np
angle_tetrahedral = np.arccos(-1/3) * 180 / np.pi
print(f"理論的なC-Si-C結合角: {angle_tetrahedral:.2f}°")

# 期待される出力:
# === 3C-SiC (閃亜鉛鉱型) 構造情報 ===
# Chemistry式: SiC
# 格子定数: a = 4.358 Å
# 密度: 3.21 g/cm³
#
# Si-C結合数: 4
# Si-C結合距離: 1.889 Å
# 理論的なC-Si-C結合角: 109.47°
</code></pre>

            <h3>1.3.2 ウルツ鉱構造とSi₃N₄構造</h3>

            <p>
                <strong>ウルツ鉱（ウルツァイト）構造</strong>は、六方晶系の共有結合性構造です。ZnO（酸化亜鉛）とAlN（窒化アルミニウム）がこの構造を取ります。c/a比は理想的には√(8/3) ≈ 1.633です。
            </p>

            <p>
                <strong>Si₃N₄（窒化ケイ素）</strong>は、α相とβ相の2つの多形があり、高強度・高耐熱性を示します。構造工業用セラミックスとして重要です。
            </p>

            <div class="info-box">
                <strong>共有結合性セラミックスの特性</strong>
                <ul>
                    <li><strong>高硬度</strong>: 方向性のある強い共有結合（例: SiCのビッカース硬度2500 HV）</li>
                    <li><strong>高融点</strong>: 結合エネルギーが大きい（例: Si₃N₄の融点1900°C）</li>
                    <li><strong>低熱膨張率</strong>: 強い共有結合による格子安定性</li>
                    <li><strong>半導体特性</strong>: SiC、AlNはワイドバンドギャップ半導体</li>
                </ul>
            </div>

            <h4>Python実装: AlNウルツ鉱構造の生成</h4>

            <pre><code class="language-python"># ===================================
# Example 4: ウルツ鉱型AlN構造の生成
# ===================================

def create_wurtzite_structure(a, c, cation, anion):
    """
    ウルツ鉱型構造を生成する関数

    Parameters:
    -----------
    a : float
        a軸格子定数 [Å]
    c : float
        c軸格子定数 [Å]
    cation : str
        陽イオン元素記号
    anion : str
        陰イオン元素記号

    Returns:
    --------
    structure : pymatgen.core.Structure
        ウルツ鉱型結晶構造
    """
    # 六方晶格子の定義
    lattice = Lattice.hexagonal(a, c)

    # atom位置（min数座標）
    # Al: (1/3, 2/3, 0), (2/3, 1/3, 1/2)
    # N: (1/3, 2/3, u), (2/3, 1/3, 1/2+u)  u ≈ 0.375
    u = 0.382  # AlNの内部パラメータ
    species = [cation, cation, anion, anion]
    coords = [
        [1/3, 2/3, 0],
        [2/3, 1/3, 0.5],
        [1/3, 2/3, u],
        [2/3, 1/3, 0.5 + u]
    ]

    structure = Structure(lattice, species, coords)
    return structure

# AlN構造の生成
aln = create_wurtzite_structure(a=3.111, c=4.981, cation="Al", anion="N")

print("=== AlN (ウルツ鉱型) 構造情報 ===")
print(f"Chemistry式: {aln.composition.reduced_formula}")
print(f"格子定数: a = {aln.lattice.a:.3f} Å, c = {aln.lattice.c:.3f} Å")
print(f"c/a比: {aln.lattice.c / aln.lattice.a:.3f}")
print(f"理想c/a比: {np.sqrt(8/3):.3f}")
print(f"密度: {aln.density:.2f} g/cm³")

# Al-N結合距離のcalculation
al_site = aln[0]
neighbors = aln.get_neighbors(al_site, r=2.5)
print(f"\nAl-N結合数: {len(neighbors)}")
bond_lengths = [n[1] for n in neighbors]
print(f"Al-N結合距離: {np.mean(bond_lengths):.3f} ± {np.std(bond_lengths):.3f} Å")

# 期待される出力:
# === AlN (ウルツ鉱型) 構造情報 ===
# Chemistry式: AlN
# 格子定数: a = 3.111 Å, c = 4.981 Å
# c/a比: 1.601
# 理想c/a比: 1.633
# 密度: 3.26 g/cm³
#
# Al-N結合数: 4
# Al-N結合距離: 1.893 ± 0.006 Å
</code></pre>
        </section>

        <section id="perovskite">
            <h2>1.4 ペロブスカイト構造（ABO₃）</h2>

            <h3>1.4.1 ペロブスカイト構造の基本</h3>

            <p>
                <strong>ペロブスカイト構造</strong>は、一般式ABO₃で表される酸化物の構造です。大きなA位置イオン（Ba²⁺、Sr²⁺）が12配位、小さなB位置イオン（Ti⁴⁺、Zr⁴⁺）が6配位（八面体）を形成します。
            </p>

            <p>
                立方晶ペロブスカイトでは、Aatomが立方体の頂点、Batomが体心、Oatomが面心に位置します。この構造は<strong>強誘電性</strong>、<strong>圧電性</strong>、<strong>巨大磁気抵抗</strong>などの多様な機能性を示します。
            </p>

            <h4>Goldschmidtの許容因子</h4>

            <p>
                ペロブスカイト構造の安定性は、<strong>Goldschmidtの許容因子 \(t\)</strong> で評価されます：
            </p>

            <p>
                \[
                t = \frac{r_A + r_O}{\sqrt{2}(r_B + r_O)}
                \]
            </p>

            <p>
                \(0.8 < t < 1.0\) の範囲でペロブスカイト構造が安定です。\(t > 1\) では六方晶、\(t < 0.8\) ではイルメナイト構造になります。
            </p>

            <h4>Python実装: ペロブスカイト構造の生成と許容因子calculation</h4>

            <pre><code class="language-python"># ===================================
# Example 5: ペロブスカイト構造の生成と安定性評価
# ===================================

from pymatgen.core import Structure, Lattice

def create_perovskite_structure(a, A_ion, B_ion):
    """
    立方晶ペロブスカイトABO3構造を生成する関数

    Parameters:
    -----------
    a : float
        立方晶格子定数 [Å]
    A_ion : str
        A位置イオン元素記号
    B_ion : str
        B位置イオン元素記号

    Returns:
    --------
    structure : pymatgen.core.Structure
        ペロブスカイト結晶構造
    """
    # 立方晶格子
    lattice = Lattice.cubic(a)

    # atom位置（min数座標）
    # A: (0, 0, 0) - 体心
    # B: (0.5, 0.5, 0.5) - 頂点
    # O: (0.5, 0.5, 0), (0.5, 0, 0.5), (0, 0.5, 0.5) - 面心
    species = [A_ion, B_ion, "O", "O", "O"]
    coords = [
        [0, 0, 0],           # A
        [0.5, 0.5, 0.5],     # B
        [0.5, 0.5, 0],       # O
        [0.5, 0, 0.5],       # O
        [0, 0.5, 0.5]        # O
    ]

    structure = Structure(lattice, species, coords)
    return structure

def goldschmidt_tolerance_factor(r_A, r_B, r_O=1.40):
    """
    Goldschmidtの許容因子をcalculationする関数

    Parameters:
    -----------
    r_A : float
        A位置イオン半径 [Å]
    r_B : float
        B位置イオン半径 [Å]
    r_O : float
        酸素イオン半径 [Å]（デフォルト: 1.40Å）

    Returns:
    --------
    t : float
        許容因子
    stability : str
        構造安定性評価
    """
    t = (r_A + r_O) / (np.sqrt(2) * (r_B + r_O))

    if 0.9 < t < 1.0:
        stability = "理想的ペロブスカイト（立方晶）"
    elif 0.8 < t <= 0.9:
        stability = "歪んだペロブスカイト（斜方晶・菱面体晶）"
    elif t > 1.0:
        stability = "六方晶構造に変形"
    else:
        stability = "イルメナイト構造"

    return t, stability

# BaTiO3構造の生成
bto = create_perovskite_structure(a=4.004, A_ion="Ba", B_ion="Ti")

print("=== BaTiO3 (ペロブスカイト) 構造情報 ===")
print(f"Chemistry式: {bto.composition.reduced_formula}")
print(f"格子定数: a = {bto.lattice.a:.3f} Å")
print(f"密度: {bto.density:.2f} g/cm³")

# 許容因子のcalculation
ionic_radii_perovskite = {
    "Ba2+": 1.61,  # 12配位
    "Sr2+": 1.44,  # 12配位
    "Ca2+": 1.34,  # 12配位
    "Ti4+": 0.605, # 6配位
    "Zr4+": 0.72,  # 6配位
    "O2-": 1.40    # 標準
}

print("\n=== Goldschmidtの許容因子calculation ===\n")

perovskites = [
    ("Ba2+", "Ti4+", "BaTiO3"),
    ("Sr2+", "Ti4+", "SrTiO3"),
    ("Ca2+", "Ti4+", "CaTiO3"),
    ("Ba2+", "Zr4+", "BaZrO3")
]

for A, B, formula in perovskites:
    r_A = ionic_radii_perovskite[A]
    r_B = ionic_radii_perovskite[B]
    t, stability = goldschmidt_tolerance_factor(r_A, r_B)

    print(f"{formula}:")
    print(f"  許容因子 t = {t:.3f}")
    print(f"  構造安定性: {stability}")
    print()

# 期待される出力:
# === BaTiO3 (ペロブスカイト) 構造情報 ===
# Chemistry式: BaTiO3
# 格子定数: a = 4.004 Å
# 密度: 6.02 g/cm³
#
# === Goldschmidtの許容因子calculation ===
#
# BaTiO3:
#   許容因子 t = 1.062
#   構造安定性: 六方晶構造に変形
#
# SrTiO3:
#   許容因子 t = 1.002
#   構造安定性: 理想的ペロブスカイト（立方晶）
#
# CaTiO3:
#   許容因子 t = 0.966
#   構造安定性: 理想的ペロブスカイト（立方晶）
#
# BaZrO3:
#   許容因子 t = 1.009
#   構造安定性: 六方晶構造に変形
</code></pre>

            <h3>1.4.2 相転移と誘電特性</h3>

            <p>
                BaTiO₃は、温度によって結晶構造が変化する<strong>相転移</strong>を示します：
            </p>

            <ul>
                <li><strong>&gt; 120°C</strong>: 立方晶（常誘電性）</li>
                <li><strong>5°C - 120°C</strong>: 正方晶（強誘電性、室温で使用）</li>
                <li><strong>-90°C - 5°C</strong>: 斜方晶（強誘電性）</li>
                <li><strong>&lt; -90°C</strong>: 菱面体晶（強誘電性）</li>
            </ul>

            <p>
                正方晶相では、Ti⁴⁺イオンが酸素八面体の中心からわずかにずれ、<strong>自発min極</strong>が発生します。この性質を利用して、コンデンサ、圧電素子、センサーに応用されます。
            </p>

            <div class="warning-box">
                <strong>注意: 実際の構造calculation</strong>
                室温のBaTiO₃は正方晶（c/a ≈ 1.01）ですが、本例では立方晶近似を使用しています。精密なanalysisには、正方晶格子定数（a = 3.992Å, c = 4.036Å）を使用してください。
            </div>
        </section>

        <section id="spinel">
            <h2>1.5 スピネル構造（AB₂O₄）</h2>

            <h3>1.5.1 正スピネルと逆スピネル</h3>

            <p>
                <strong>スピネル構造</strong>は、一般式AB₂O₄で表される複酸化物の構造です。O²⁻イオンが立方最密充填（FCC）を形成し、A²⁺とB³⁺が四面体位置と八面体位置を占有します。
            </p>

            <p>
                <strong>正スピネル（Normal spinel）</strong>: A²⁺が四面体位置、B³⁺が八面体位置
            </p>
            <p>
                \[
                \text{A}^{2+}[\text{B}^{3+}_2]\text{O}_4
                \]
            </p>

            <p>
                例: MgAl₂O₄、ZnFe₂O₄
            </p>

            <p>
                <strong>逆スピネル（Inverse spinel）</strong>: B³⁺の半minが四面体位置、A²⁺とB³⁺の残りが八面体位置
            </p>
            <p>
                \[
                \text{B}^{3+}[\text{A}^{2+}\text{B}^{3+}]\text{O}_4
                \]
            </p>

            <p>
                例: Fe₃O₄（マグネタイト）、NiFe₂O₄
            </p>

            <h4>Python実装: スピネル構造の生成とvisualization</h4>

            <pre><code class="language-python"># ===================================
# Example 6: 正スピネルMgAl2O4構造の生成
# ===================================

from pymatgen.core import Structure, Lattice

def create_spinel_structure(a, A_ion, B_ion, inverse=False):
    """
    スピネルAB2O4構造を生成する関数

    Parameters:
    -----------
    a : float
        立方晶格子定数 [Å]
    A_ion : str
        A位置イオン元素記号（2価）
    B_ion : str
        B位置イオン元素記号（3価）
    inverse : bool
        Trueの場合、逆スピネル構造を生成

    Returns:
    --------
    structure : pymatgen.core.Structure
        スピネル結晶構造
    """
    # 立方晶格子
    lattice = Lattice.cubic(a)

    # 正スピネルのatom位置（min数座標）
    # A (Mg): 8a位置 (1/8, 1/8, 1/8) - 四面体
    # B (Al): 16d位置 (1/2, 1/2, 1/2) - 八面体
    # O: 32e位置 (u, u, u), u ≈ 0.25

    if not inverse:
        # 正スピネル
        species = []
        coords = []

        # A位置: 8個の四面体位置
        for i in range(2):
            for j in range(2):
                for k in range(2):
                    species.append(A_ion)
                    coords.append([0.125 + i*0.5, 0.125 + j*0.5, 0.125 + k*0.5])

        # B位置: 16個の八面体位置（簡略化して4個のみ）
        b_positions = [
            [0.5, 0.5, 0.5], [0.5, 0, 0], [0, 0.5, 0], [0, 0, 0.5]
        ]
        for pos in b_positions:
            species.extend([B_ion, B_ion])
            coords.extend([pos, [pos[0]+0.25, pos[1]+0.25, pos[2]+0.25]])

        # O位置: 32個（簡略化して8個）
        u = 0.263
        o_base = [[u, u, u], [-u, -u, u], [-u, u, -u], [u, -u, -u]]
        for pos in o_base:
            species.extend(["O", "O"])
            coords.append([p % 1.0 for p in pos])
            coords.append([p + 0.5 % 1.0 for p in pos])

    # 単純化のため、ここでは代表的なatomのみ
    # 実際のスピネルは単位格子に56atom（8A + 16B + 32O）
    structure = Structure(lattice, species[:20], coords[:20])
    return structure

# MgAl2O4（正スピネル）の生成
mgo_al2o3 = create_spinel_structure(a=8.083, A_ion="Mg", B_ion="Al")

print("=== MgAl2O4 (正スピネル) 構造情報 ===")
print(f"Chemistry式: {mgo_al2o3.composition.reduced_formula}")
print(f"格子定数: a = {mgo_al2o3.lattice.a:.3f} Å")
print(f"密度: {mgo_al2o3.density:.2f} g/cm³")
print(f"atom数/単位格子（簡略版）: {len(mgo_al2o3)}")

# 実際のMgAl2O4の特性
print("\n=== 実験値（参考） ===")
print("完全な単位格子atom数: 56 (8Mg + 16Al + 32O)")
print("密度（実験値）: 3.58 g/cm³")
print("硬度: 8 Mohs（ダイヤモンドに次ぐ硬度）")
print("用途: 耐火材料、透明セラミックス、宝石（スピネル）")

# 期待される出力:
# === MgAl2O4 (正スピネル) 構造情報 ===
# Chemistry式: MgAl2O4
# 格子定数: a = 8.083 Å
# 密度: 3.21 g/cm³
# atom数/単位格子（簡略版）: 20
#
# === 実験値（参考） ===
# 完全な単位格子atom数: 56 (8Mg + 16Al + 32O)
# 密度（実験値）: 3.58 g/cm³
# 硬度: 8 Mohs（ダイヤモンドに次ぐ硬度）
# 用途: 耐火材料、透明セラミックス、宝石（スピネル）
</code></pre>

            <h3>1.5.2 Fe₃O₄の逆スピネル構造と磁性</h3>

            <p>
                <strong>マグネタイト（Fe₃O₄）</strong>は、逆スピネル構造を取る代表的な磁性体です。Chemistry式はFe²⁺Fe₂³⁺O₄と表され、以下の配置になります：
            </p>

            <ul>
                <li><strong>四面体位置</strong>: Fe³⁺（スピン上向き）</li>
                <li><strong>八面体位置</strong>: Fe²⁺とFe³⁺（スピン下向き）</li>
            </ul>

            <p>
                四面体のFe³⁺と八面体のFe³⁺のスピンが打ち消し合い、八面体のFe²⁺の磁気モーメントのみが残ります。この<strong>フェリ磁性</strong>により、室温で強い磁性を示します。
            </p>

            <table>
                <thead>
                    <tr>
                        <th>材料</th>
                        <th>スピネルタイプ</th>
                        <th>磁性</th>
                        <th>用途</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>MgAl₂O₄</td>
                        <td>正スピネル</td>
                        <td>非磁性</td>
                        <td>耐火材料、宝石</td>
                    </tr>
                    <tr>
                        <td>ZnFe₂O₄</td>
                        <td>正スピネル</td>
                        <td>反強磁性</td>
                        <td>触媒、ガスセンサー</td>
                    </tr>
                    <tr>
                        <td>Fe₃O₄</td>
                        <td>逆スピネル</td>
                        <td>フェリ磁性</td>
                        <td>磁性材料、MRI造影剤</td>
                    </tr>
                    <tr>
                        <td>NiFe₂O₄</td>
                        <td>逆スピネル</td>
                        <td>フェリ磁性</td>
                        <td>高周波デバイス</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="advanced">
            <h2>1.6 構造analysisのpractice例</h2>

            <h3>1.6.1 X線回折パターンのシミュレーション</h3>

            <p>
                結晶構造を実験的に決定する最も一般的な方法は、<strong>X線回折（XRD）</strong>です。Pymatgenを使用して、理論XRDパターンをシミュレートできます。
            </p>

            <h4>Python実装: XRDパターンcalculation</h4>

            <pre><code class="language-python"># ===================================
# Example 7: X線回折パターンのシミュレーション
# ===================================

from pymatgen.analysis.diffraction.xrd import XRDCalculator

def simulate_xrd(structure, wavelength="CuKa"):
    """
    X線回折パターンをシミュレートする関数

    Parameters:
    -----------
    structure : pymatgen.core.Structure
        結晶構造
    wavelength : str or float
        X線波長 [Å]（"CuKa" = 1.54184Å）

    Returns:
    --------
    pattern : XRDPattern
        calculationされたXRDパターン
    """
    xrd_calc = XRDCalculator(wavelength=wavelength)
    pattern = xrd_calc.get_pattern(structure)
    return pattern

# MgO（NaCl型）のXRDシミュレーション
mgo = create_nacl_structure(a=4.211)
xrd_mgo = simulate_xrd(mgo)

print("=== MgO X線回折ピーク ===\n")
print(f"{'2θ (deg)':<12} {'d (Å)':<10} {'(hkl)':<10} {'強度':<10}")
print("-" * 50)

for i, (two_theta, d_spacing, hkl, intensity) in enumerate(
    zip(xrd_mgo.x[:5], xrd_mgo.d_hkls[:5], xrd_mgo.hkls[:5], xrd_mgo.y[:5])
):
    hkl_str = str(hkl[0])
    print(f"{two_theta:<12.2f} {d_spacing:<10.3f} {hkl_str:<10} {intensity:<10.1f}")

# XRDパターンのプロット
import matplotlib.pyplot as plt

plt.figure(figsize=(10, 6))
plt.plot(xrd_mgo.x, xrd_mgo.y, 'b-', linewidth=2)
plt.xlabel('2θ (degrees)', fontsize=12)
plt.ylabel('Intensity (a.u.)', fontsize=12)
plt.title('Simulated XRD Pattern: MgO (NaCl-type)', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('mgo_xrd_pattern.png', dpi=300)
print("\nXRDパターンを 'mgo_xrd_pattern.png' に保存しました")

# 期待される出力:
# === MgO X線回折ピーク ===
#
# 2θ (deg)    d (Å)      (hkl)      強度
# --------------------------------------------------
# 42.92       2.106      (200)      100.0
# 62.30       1.488      (220)      52.3
# 78.63       1.216      (311)      12.8
# 94.05       1.053      (400)      3.2
#
# XRDパターンを 'mgo_xrd_pattern.png' に保存しました
</code></pre>

            <h3>1.6.2 構造データベースからの検索</h3>

            <p>
                <strong>Materials Project</strong>は、10万以上の無機材料の結晶構造・物性データベースです。APIを通じて、既知の材料データを取得できます。
            </p>

            <h4>Python実装: Materials Projectからの構造取得</h4>

            <pre><code class="language-python"># ===================================
# Example 8: Materials Projectデータベース検索
# ===================================

from pymatgen.ext.matproj import MPRester

def search_materials_project(formula, api_key=None):
    """
    Materials Projectから材料構造を取得する関数

    Parameters:
    -----------
    formula : str
        Chemistry式（例: "BaTiO3"）
    api_key : str
        Materials Project APIキー

    Returns:
    --------
    structures : list
        取得された構造のリスト
    """
    # APIキーの取得方法:
    # 1. https://materialsproject.org/ にアカウント登録
    # 2. Dashboard > API > Generate API Key

    if api_key is None:
        print("注意: APIキーが必要です。")
        print("https://materialsproject.org/ でアカウントを作成してください。")
        return []

    with MPRester(api_key) as mpr:
        # Chemistry式で検索
        entries = mpr.get_entries(formula)
        structures = [entry.structure for entry in entries]

    return structures

# 使用例（APIキーを環境変数から取得）
import os

# API_KEY = os.environ.get("MP_API_KEY")  # 環境変数から取得
# structures = search_materials_project("BaTiO3", api_key=API_KEY)

# APIキーなしでのデモ出力
print("=== Materials Project 検索例 ===\n")
print("検索式: BaTiO3")
print("\n予想される結果:")
print("1. mp-5020: BaTiO3 (cubic, Pm-3m)")
print("   - 格子定数: a = 4.004 Å")
print("   - バンドギャップ: 1.9 eV (indirect)")
print("   - 生成エネルギー: -15.3 eV/atom")
print("\n2. mp-2998: BaTiO3 (tetragonal, P4mm)")
print("   - 格子定数: a = 3.992 Å, c = 4.036 Å")
print("   - 自発min極: 0.26 C/m²")
print("\n3. mp-5777: BaTiO3 (rhombohedral, R3m)")
print("   - 低温相")
print("\n詳細な取得方法:")
print("```python")
print("from pymatgen.ext.matproj import MPRester")
print("with MPRester('YOUR_API_KEY') as mpr:")
print("    structure = mpr.get_structure_by_material_id('mp-5020')")
print("    print(structure)")
print("```")
</code></pre>

            <div class="info-box">
                <strong>Materials Project活用のヒント</strong>
                <ul>
                    <li><strong>構造データ</strong>: 結晶構造（CIF形式）、対称性、空間群</li>
                    <li><strong>電子物性</strong>: バンドギャップ、状態密度（DOS）、バンド構造</li>
                    <li><strong>熱力学データ</strong>: 生成エネルギー、安定性、相図</li>
                    <li><strong>弾性定数</strong>: ヤング率、剛性率、ポアソン比</li>
                </ul>
                <p>
                    APIキーは無料で取得でき、月10万リクエストまで使用可能です。研究・教育目的での利用が推奨されています。
                </p>
            </div>
        </section>

        <section id="exercises">
            <h2>演習問題</h2>

            <h3>Easy（基礎確認）</h3>

            <div class="exercise-box">
                <h4>Q1: 構造タイプの識別 <span class="difficulty easy">Easy</span></h4>
                <p>
                    MgOの結晶構造タイプは次のうちどれですか？
                </p>
                <p>
                    a) CsCl型<br>
                    b) NaCl型<br>
                    c) ダイヤモンド型<br>
                    d) ペロブスカイト型
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: b) NaCl型</strong></p>
                    <p>
                        <strong>解説:</strong><br>
                        MgOは岩塩型（NaCl型）構造を取ります。Mg²⁺とO²⁻がそれぞれFCC格子を形成し、各イオンは6つの反対符号イオンに囲まれます（配位数 = 6）。半径比 r(Mg²⁺)/r(O²⁻) = 0.72/1.40 = 0.514 で、Paulingの規則により八面体配位（CN = 6）が予測されます。
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q2: Paulingの規則 <span class="difficulty easy">Easy</span></h4>
                <p>
                    CsCl（塩化セシウム）の陽イオン配位数は何ですか？また、その理由をDescriptionしてください。
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: 8（立方体配位）</strong></p>
                    <p>
                        <strong>解説:</strong><br>
                        Cs⁺の半径は1.67Å、Cl⁻の半径は1.81Åです。半径比 = 1.67/1.81 = 0.922 で、Paulingの第1規則により 0.732 < r₊/r₋ < 1.0 の範囲にあるため、配位数8（立方体配位）となります。CsCl型構造では、Cs⁺が単純立方格子の中心に位置し、8つのCl⁻に囲まれます。
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q3: ペロブスカイトの一般式 <span class="difficulty easy">Easy</span></h4>
                <p>
                    ペロブスカイト構造の一般式はABO₃です。BaTiO₃において、A位置とB位置の配位数をそれぞれ答えてください。
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: A位置（Ba）: 12配位、B位置（Ti）: 6配位</strong></p>
                    <p>
                        <strong>解説:</strong><br>
                        立方晶ペロブスカイトでは、大きなBa²⁺イオンが立方体の頂点（体心から見て12配位）、小さなTi⁴⁺イオンが体心（酸素八面体の中心、6配位）に位置します。O²⁻は面心に配置され、Ti-O-Ti結合のネットワークを形成します。
                    </p>
                </details>
            </div>

            <h3>Medium（応用）</h3>

            <div class="exercise-box">
                <h4>Q4: Goldschmidtの許容因子calculation <span class="difficulty medium">Medium</span></h4>
                <p>
                    SrTiO₃のGoldschmidtの許容因子tをcalculationしてください。イオン半径は Sr²⁺ = 1.44Å（12配位）、Ti⁴⁺ = 0.605Å（6配位）、O²⁻ = 1.40Å です。この材料はペロブスカイト構造を取ると予想されますか？
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: t = 1.002、理想的なペロブスカイト構造</strong></p>
                    <p>
                        <strong>calculation過程:</strong><br>
                        \[
                        t = \frac{r_{\text{Sr}} + r_{\text{O}}}{\sqrt{2}(r_{\text{Ti}} + r_{\text{O}})} = \frac{1.44 + 1.40}{\sqrt{2}(0.605 + 1.40)} = \frac{2.84}{2.834} = 1.002
                        \]
                    </p>
                    <p>
                        <strong>解説:</strong><br>
                        t ≈ 1.0 は理想的なペロブスカイト構造を示します。実際、SrTiO₃は室温で立方晶ペロブスカイト構造（空間群Pm-3m）を取り、高い誘電率（ε ≈ 300）を示します。量子常誘電体として、低温でも強誘電転移を起こしません。
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q5: 正スピネルと逆スピネルの判別 <span class="difficulty medium">Medium</span></h4>
                <p>
                    MgAl₂O₄は正スピネル、Fe₃O₄は逆スピネル構造を取ります。この違いを決定する主な要因は何ですか？また、逆スピネルの方が安定になる条件をDescriptionしてください。
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: 結晶場安定化エネルギー（CFSE）と陽イオンの電子配置</strong></p>
                    <p>
                        <strong>解説:</strong><br>
                        スピネル構造の安定性は、陽イオンが四面体位置と八面体位置のどちらを好むかで決まります：
                    </p>
                    <ul>
                        <li><strong>MgAl₂O₄（正スピネル）</strong>: Mg²⁺（d⁰）は結晶場安定化なし、Al³⁺（d⁰）も同様。イオン半径の違いで、小さなMg²⁺が四面体、Al³⁺が八面体を占める。</li>
                        <li><strong>Fe₃O₄（逆スピネル）</strong>: Fe³⁺（d⁵、高スピン）はどちらの位置でもCFSEが小さい。Fe²⁺（d⁶）は八面体位置で大きなCFSEを得る。したがって、Fe³⁺が四面体と八面体にminかれ、Fe²⁺が八面体を占める逆スピネルが安定。</li>
                    </ul>
                    <p>
                        一般に、d³、d⁶、d⁸電子配置のイオンは八面体位置を強く好むため、逆スピネル構造が安定化されます。
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q6: 3C-SiCの密度calculation <span class="difficulty medium">Medium</span></h4>
                <p>
                    3C-SiC（閃亜鉛鉱型）の格子定数は a = 4.358Å です。単位格子の質量と体積から密度をcalculationしてください。（atom量: Si = 28.09, C = 12.01）
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: 密度 ≈ 3.21 g/cm³</strong></p>
                    <p>
                        <strong>calculation過程:</strong>
                    </p>
                    <ol>
                        <li>単位格子の体積: V = a³ = (4.358×10⁻⁸ cm)³ = 8.28×10⁻²³ cm³</li>
                        <li>単位格子中のatom数: 4組のSiC（閃亜鉛鉱型のFCC基本）</li>
                        <li>単位格子の質量: m = 4 × (28.09 + 12.01) / N_A = 4 × 40.10 / 6.022×10²³ = 2.66×10⁻²² g</li>
                        <li>密度: ρ = m / V = 2.66×10⁻²² / 8.28×10⁻²³ = 3.21 g/cm³</li>
                    </ol>
                    <p>
                        実験値（3.21 g/cm³）とよく一致します。SiCの高密度は、共有結合性と強いatom間結合に由来します。
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q7: ウルツ鉱構造の理想c/a比 <span class="difficulty medium">Medium</span></h4>
                <p>
                    ウルツ鉱構造の理想c/a比は √(8/3) ≈ 1.633 です。AlNの実測値はc/a = 1.601 です。この偏差は何を意味しますか？また、イオン性と共有性のどちらが強いと推測されますか？
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: c/a < 1.633 は、共有結合性が強いことを示唆</strong></p>
                    <p>
                        <strong>解説:</strong><br>
                        理想ウルツ鉱構造は、球の最密充填を仮定した場合のc/a比です。実際の材料では：
                    </p>
                    <ul>
                        <li><strong>c/a < 1.633</strong>: 共有結合性が強く、方向性のある結合によりc軸方向が圧縮される（例: AlN, GaN）</li>
                        <li><strong>c/a > 1.633</strong>: イオン結合性が強く、静電反発によりc軸方向が伸びる（例: ZnO = 1.602、BeO = 1.623）</li>
                    </ul>
                    <p>
                        AlNは共有結合性が強いため、c/a = 1.601 と理想値より小さくなります。この性質は、高い熱伝導率（320 W/m·K）と関連しています。
                    </p>
                </details>
            </div>

            <h3>Hard（発展）</h3>

            <div class="exercise-box">
                <h4>Q8: BaTiO₃の相転移と構造変化 <span class="difficulty hard">Hard</span></h4>
                <p>
                    BaTiO₃は120°Cで立方晶から正方晶に相転移します。正方晶相（a = 3.992Å, c = 4.036Å）における自発min極の方向と大きさを、Ti⁴⁺イオンの変位（δ ≈ 0.12Å）から見積もってください。（有効電荷: Z* = 7e、単位格子体積からcalculation）
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: 自発min極 P_s ≈ 0.26 C/m² （c軸方向）</strong></p>
                    <p>
                        <strong>calculation過程:</strong>
                    </p>
                    <ol>
                        <li>単位格子体積: V = a² × c = (3.992)² × 4.036 = 64.3 Å³ = 6.43×10⁻²⁹ m³</li>
                        <li>双極子モーメント: p = Z* × e × δ = 7 × 1.602×10⁻¹⁹ C × 0.12×10⁻¹⁰ m = 1.35×10⁻²⁹ C·m</li>
                        <li>自発min極: P_s = p / V = 1.35×10⁻²⁹ / 6.43×10⁻²⁹ = 0.21 C/m²</li>
                    </ol>
                    <p>
                        実験値（0.26 C/m²）と近い値が得られます。差異は、O²⁻イオンの変位や電子雲のmin極を考慮していないためです。
                    </p>
                    <p>
                        <strong>物理的意味:</strong><br>
                        Ti⁴⁺が酸素八面体の中心からc軸方向にずれることで、強い双極子モーメントが発生します。この自発min極により、BaTiO₃は優れた圧電材料・強誘電体メモリとして応用されます。
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q9: Fe₃O₄の磁気モーメントcalculation <span class="difficulty hard">Hard</span></h4>
                <p>
                    マグネタイト（Fe₃O₄）は逆スピネル構造 Fe³⁺[Fe²⁺Fe³⁺]O₄ を取ります。単位格子（8組のFe₃O₄）の理論磁気モーメントをcalculationしてください。（Fe²⁺: 4μ_B、Fe³⁺: 5μ_B、μ_B = Bohr磁子）
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: 単位格子の磁気モーメント = 32μ_B</strong></p>
                    <p>
                        <strong>calculation過程:</strong>
                    </p>
                    <ol>
                        <li>1min子式単位（Fe₃O₄）の構成:
                            <ul>
                                <li>四面体位置: Fe³⁺（スピン↑） → +5μ_B</li>
                                <li>八面体位置: Fe²⁺（スピン↓） → -4μ_B、Fe³⁺（スピン↓） → -5μ_B</li>
                            </ul>
                        </li>
                        <li>正味の磁気モーメント（1min子式あたり）:
                            <ul>
                                <li>M = 5μ_B（四面体Fe³⁺） - 4μ_B（八面体Fe²⁺） - 5μ_B（八面体Fe³⁺） = -4μ_B</li>
                                <li>絶対値: |M| = 4μ_B（フェリ磁性）</li>
                            </ul>
                        </li>
                        <li>単位格子（8組のFe₃O₄）: M_total = 8 × 4μ_B = 32μ_B</li>
                    </ol>
                    <p>
                        実験値（約4.1μ_B/min子式単位）とよく一致します。この強い磁気モーメントにより、Fe₃O₄は室温で磁性体として機能し、磁気記録媒体、MRI造影剤、磁性流体などに応用されます。
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q10: 複合材料の密度予測 <span class="difficulty hard">Hard</span></h4>
                <p>
                    MgO（密度3.58 g/cm³）とAl₂O₃（密度3.98 g/cm³）が1:1のモル比で反応し、MgAl₂O₄スピネル（理論密度3.58 g/cm³）を生成します。反応前後の体積変化率をcalculationし、焼結時の収縮を予測してください。
                </p>
                <details>
                    <summary>解答を見る</summary>
                    <p><strong>正解: 体積収縮率 ≈ 1.8%</strong></p>
                    <p>
                        <strong>calculation過程:</strong>
                    </p>
                    <ol>
                        <li>反応式: MgO + Al₂O₃ → MgAl₂O₄</li>
                        <li>反応前の質量:
                            <ul>
                                <li>MgO: 40.30 g/mol</li>
                                <li>Al₂O₃: 101.96 g/mol</li>
                                <li>合計: 142.26 g/mol</li>
                            </ul>
                        </li>
                        <li>反応前の体積（1モルあたり）:
                            <ul>
                                <li>V_MgO = 40.30 / 3.58 = 11.26 cm³</li>
                                <li>V_Al2O3 = 101.96 / 3.98 = 25.62 cm³</li>
                                <li>V_before = 11.26 + 25.62 = 36.88 cm³</li>
                            </ul>
                        </li>
                        <li>反応後の体積（1モルMgAl₂O₄）:
                            <ul>
                                <li>V_after = 142.26 / 3.58 = 39.74 cm³</li>
                            </ul>
                        </li>
                        <li>体積変化率: ΔV/V = (39.74 - 36.88) / 36.88 × 100 = 7.8%（膨張）</li>
                    </ol>
                    <p>
                        <strong>注意:</strong> 実際には、反応前の原料は焼結体ではなく粉末であり、空隙率が高い（30-50%）。焼結プロセス全体では、空隙が減少し、全体として15-20%の収縮が観測されます。スピネル相生成による体積膨張（7.8%）は、空隙減少による収縮と相殺されます。
                    </p>
                    <p>
                        <strong>工学的意義:</strong><br>
                        この体積変化を考慮して、耐火レンガやセラミックス部品の焼結条件（温度、hours、雰囲気）を最適化します。急激な体積変化はクラックの原因となるため、段階的な昇温プロファイルが重要です。
                    </p>
                </details>
            </div>
        </section>

        <section id="references">
            <h2>参考文献</h2>

            <ol>
                <li>
                    <strong>Kingery, W.D., Bowen, H.K., Uhlmann, D.R. (1976).</strong> <em>Introduction to Ceramics</em> (2nd ed.). Wiley, pp. 30-89 (crystal structures), pp. 92-135 (defects and diffusion).
                </li>
                <li>
                    <strong>Carter, C.B., Norton, M.G. (2013).</strong> <em>Ceramic Materials: Science and Engineering</em> (2nd ed.). Springer, pp. 45-120 (ionic and covalent structures), pp. 267-310 (phase transformations).
                </li>
                <li>
                    <strong>West, A.R. (2014).</strong> <em>Solid State Chemistry and its Applications</em> (2nd ed.). Wiley, pp. 1-85 (crystal structures), pp. 187-245 (perovskites and spinels), pp. 320-375 (structure-property relationships).
                </li>
                <li>
                    <strong>Barsoum, M.W. (2020).</strong> <em>Fundamentals of Ceramics</em> (2nd ed.). CRC Press, pp. 20-75 (bonding and crystal structures), pp. 105-158 (point defects), pp. 445-490 (electrical properties).
                </li>
                <li>
                    <strong>Richerson, D.W., Lee, W.E. (2018).</strong> <em>Modern Ceramic Engineering: Properties, Processing, and Use in Design</em> (4th ed.). CRC Press, pp. 50-95 (structures), pp. 120-165 (mechanical properties).
                </li>
                <li>
                    <strong>Pymatgen Documentation (2024).</strong> Available at: <a href="https://pymatgen.org/" target="_blank" rel="noopener">https://pymatgen.org/</a> (Python materials analysis library, Materials Project integration)
                </li>
                <li>
                    <strong>Shannon, R.D. (1976).</strong> "Revised effective ionic radii and systematic studies of interatomic distances in halides and chalcogenides." <em>Acta Crystallographica A</em>, 32, 751-767. (イオン半径の標準データ)
                </li>
            </ol>

            <div class="info-box">
                <strong>さらに学ぶために</strong>
                <ul>
                    <li>構造analysis技術: <em>Elements of X-ray Diffraction</em> (Cullity & Stock, 2014) - XRD原理とpractice</li>
                    <li>第一原理calculation: <em>Density Functional Theory: A Practical Introduction</em> (Sholl & Steckel, 2009) - DFT入門</li>
                    <li>セラミックス物性: <em>Physical Properties of Ceramics</em> (Wachtman et al., 2009) - 機械・熱・電気特性</li>
                    <li>データベース: Materials Project (<a href="https://materialsproject.org/" target="_blank" rel="noopener">https://materialsproject.org/</a>) - 無料の材料データベース</li>
                </ul>
            </div>
        </section>

        <section id="learning-objectives">
            <h2>Learning Objectives確認チェックリスト</h2>

            <h3>レベル1: 基本理解</h3>
            <ul>
                <li>□ NaCl型、CsCl型、CaF₂型の違いをDescriptionできる</li>
                <li>□ Paulingの第1規則を使い、半径比から配位数を予測できる</li>
                <li>□ イオン結合性と共有結合性セラミックスの特徴を述べられる</li>
                <li>□ ペロブスカイト構造（ABO₃）の基本配置understandしている</li>
                <li>□ 正スピネルと逆スピネルの違いをDescriptionできる</li>
                <li>□ 閃亜鉛鉱構造とウルツ鉱構造の違いunderstandしている</li>
            </ul>

            <h3>レベル2: practiceスキル</h3>
            <ul>
                <li>□ Pymatgenを使ってNaCl型、閃亜鉛鉱型構造を生成できる</li>
                <li>□ 格子定数から密度をcalculationできる</li>
                <li>□ イオン半径データから配位数を予測できる</li>
                <li>□ Goldschmidtの許容因子をcalculationし、ペロブスカイト安定性を評価できる</li>
                <li>□ X線回折パターンをシミュレートできる</li>
                <li>□ Materials Projectから結晶構造データを取得できる</li>
                <li>□ ウルツ鉱構造のc/a比から結合性を評価できる</li>
            </ul>

            <h3>レベル3: 応用力</h3>
            <ul>
                <li>□ Paulingの規則を適用して、新規化合物の構造を予測できる</li>
                <li>□ BaTiO₃の相転移と構造変化understandし、自発min極を見積もれる</li>
                <li>□ Fe₃O₄の逆スピネル構造から磁気モーメントをcalculationできる</li>
                <li>□ 構造-物性相関をDescriptionできる（硬度、誘電率、磁性）</li>
                <li>□ 実材料の設計に構造知識を応用できる（耐火材料、圧電素子、磁性体）</li>
                <li>□ XRDパターンから構造同定able to</li>
                <li>□ 第一原理calculationの結果を解釈し、構造最適化を議論できる</li>
            </ul>

            <div class="warning-box">
                <strong>Next Steps</strong>
                Chapter 2では、セラミックスの欠陥構造（点欠陥、転位、粒界）will be covered。本章で学んだ理想結晶構造が、実材料ではどのように変化し、それが物性にどう影響するかunderstandしましょう。特に、イオン伝導性、拡散、焼結などの現象は欠陥構造と密接に関連しています。
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 MS Dojo - Materials Science Learning Platform</p>
        <p>
            <a href="https://github.com/your-repo/ms-dojo" target="_blank" rel="noopener">GitHub</a> |
            <a href="../index.html">トップページ</a> |
            <a href="index.html">シリーズ目次</a>
        </p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script>
        // Mermaid initialization
        mermaid.initialize({ startOnLoad: true, theme: 'default' });

        // Smooth scrolling for navigation links
        document.querySelectorAll('nav a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>
