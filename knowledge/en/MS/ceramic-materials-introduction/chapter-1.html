<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: Crystal Structure of Ceramics - Introduction to Ceramic Materials - MS Dojo</title>
    <meta name="description" content="Learn the fundamental crystal structures of ceramic materials. Understand ionic and covalent ceramics, perovskite and spinel structures using Python.">

    <!-- Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <!-- MathJax for mathematical expressions -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        :root {
            --accent-pink: #f093fb;
            --accent-coral: #f5576c;
            --primary-dark: #2c3e50;
            --secondary-dark: #34495e;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --bg-light: #ecf0f1;
            --white: #ffffff;
            --code-bg: #2d2d2d;
            --border-light: #bdc3c7;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.8;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        header {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
            padding: 3rem 1.5rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        nav {
            background: var(--white);
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
        }

        nav a {
            text-decoration: none;
            color: var(--text-dark);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            font-weight: 500;
        }

        nav a:hover {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        section {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-dark);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--accent-pink), var(--accent-coral)) 1;
        }

        h3 {
            color: var(--secondary-dark);
            font-size: 1.4rem;
            margin: 2rem 0 1rem;
        }

        h4 {
            color: var(--secondary-dark);
            font-size: 1.2rem;
            margin: 1.5rem 0 1rem;
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            border-left: 4px solid var(--accent-coral);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box strong {
            color: var(--accent-coral);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .warning-box {
            background: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box strong {
            color: var(--warning);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .exercise-box {
            background: rgba(39, 174, 96, 0.05);
            border: 2px solid var(--success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .exercise-box h4 {
            color: var(--success);
            margin-top: 0;
        }

        .difficulty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .difficulty.easy {
            background: #d4edda;
            color: #155724;
        }

        .difficulty.medium {
            background: #fff3cd;
            color: #856404;
        }

        .difficulty.hard {
            background: #f8d7da;
            color: #721c24;
        }

        .mermaid {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }

        th {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(240, 147, 251, 0.05);
        }

        footer {
            background: var(--primary-dark);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        footer a {
            color: var(--accent-pink);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--accent-coral);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5rem;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            section {
                padding: 1.5rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }
        }
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>
</head>
<body>
        <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AI Terakoya Top</a><span class="breadcrumb-separator">›</span><a href="../../MS/index.html">Materials Science</a><span class="breadcrumb-separator">›</span><a href="../../MS/ceramic-materials-introduction/index.html">Ceramic Materials</a><span class="breadcrumb-separator">›</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

    <header>
        <h1>Chapter 1: Crystal Structure of Ceramics</h1>
        <p>Fundamental Principles of Ionic and Covalent Ceramics, Perovskite and Spinel Structures</p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">Top</a></li>
            <li><a href="#intro">Overview</a></li>
            <li><a href="#ionic">Ionic Bonding</a></li>
            <li><a href="#covalent">Covalent Bonding</a></li>
            <li><a href="#perovskite">Perovskite</a></li>
            <li><a href="#spinel">Spinel</a></li>
            <li><a href="#exercises">Exercises</a></li>
            <li><a href="#references">References</a></li>
            <li><a href="chapter-2.html">Next Chapter →</a></li>
        </ul>
    </nav>

    <main>
        <section id="intro">
            <h2>1.1 Overview of Ceramic Crystal Structures</h2>

            <p>
                Ceramic materials are compounds of metallic elements with non-metallic elements (primarily oxygen, nitrogen, and carbon), and their properties are determined by <strong>crystal structure</strong> and <strong>chemical bonding</strong>. In this chapter, we will learn the major crystal structures of ceramics and practice structural analysis using Python tools (<strong>Pymatgen</strong>).
            </p>

            <div class="info-box">
                <strong>Learning Objectives of This Chapter</strong>
                <ul>
                    <li><strong>Level 1 (Fundamental Understanding)</strong>: Identify and explain the characteristics of major crystal structure types (NaCl, CsCl, perovskite, spinel)</li>
                    <li><strong>Level 2 (Practical Skills)</strong>: Generate crystal structures using Pymatgen and calculate lattice parameters, density, and X-ray diffraction patterns</li>
                    <li><strong>Level 3 (Application Ability)</strong>: Apply Pauling's rules to evaluate structural stability and predict structure-property correlations</li>
                </ul>
            </div>

            <h3>Classification of Ceramic Structures</h3>
            <p>Ceramic crystal structures are broadly classified into two categories based on bonding nature:</p>

            <ol>
                <li><strong>Ionic bonding ceramics</strong>: NaCl, MgO, Al₂O₃, etc. (dominated by electrostatic attraction)</li>
                <li><strong>Covalent bonding ceramics</strong>: SiC, Si₃N₄, AlN, etc. (directional covalent bonds)</li>
            </ol>

            <div class="mermaid">
            flowchart TD
                A[Ceramic Crystal Structures] --> B[Ionic Bonding]
                A --> C[Covalent Bonding]
                B --> D[NaCl Type<br/>MgO, CaO]
                B --> E[CsCl Type<br/>CsCl]
                B --> F[CaF₂ Type<br/>ZrO₂, UO₂]
                B --> G[Perovskite<br/>BaTiO₃, SrTiO₃]
                B --> H[Spinel<br/>MgAl₂O₄, Fe₃O₄]
                C --> I[Diamond Type<br/>C, Si]
                C --> J[Zinc Blende Type<br/>SiC, GaAs]
                C --> K[Wurtzite Type<br/>ZnO, AlN]

                style A fill:#f093fb,color:#fff
                style B fill:#e3f2fd
                style C fill:#fff3e0
                style G fill:#f5576c,color:#fff
                style H fill:#f5576c,color:#fff
            </div>
        </section>

        <section id="ionic">
            <h2>1.2 Ionic Bonding Ceramics</h2>

            <h3>1.2.1 NaCl-Type Structure</h3>

            <p>
                The <strong>NaCl-type (rock salt) structure</strong> is the most fundamental ionic crystal structure. Cations and anions each form face-centered cubic (FCC) lattices that interpenetrate each other. Each ion is surrounded by six ions of opposite charge (coordination number CN = 6).
            </p>

            <p>Representative materials:</p>
            <ul>
                <li><strong>MgO (magnesium oxide)</strong>: Refractory materials, high-temperature insulators (melting point 2852°C)</li>
                <li><strong>CaO (calcium oxide)</strong>: Cement raw material</li>
                <li><strong>NiO (nickel oxide)</strong>: Battery cathode material</li>
            </ul>

            <h4>Pymatgen Implementation: Generation and Visualization of NaCl Structure</h4>

            <pre><code class="language-python"># ===================================
# Example 1: NaCl-type structure generation and basic analysis
# ===================================

from pymatgen.core import Structure, Lattice
import matplotlib.pyplot as plt
import numpy as np

def create_nacl_structure(a=4.2):
    """
    Function to generate NaCl-type structure

    Parameters:
    -----------
    a : float
        Lattice parameter [Å] (default: 4.2Å for MgO)

    Returns:
    --------
    structure : pymatgen.core.Structure
        NaCl-type crystal structure
    """
    # Define FCC lattice
    lattice = Lattice.cubic(a)

    # Define atomic positions (fractional coordinates)
    # Mg2+: (0,0,0), (0.5,0.5,0), (0.5,0,0.5), (0,0.5,0.5) - FCC
    # O2-: (0.5,0,0), (0,0.5,0), (0,0,0.5), (0.5,0.5,0.5) - FCC shifted
    species = ["Mg", "Mg", "Mg", "Mg", "O", "O", "O", "O"]
    coords = [
        [0, 0, 0], [0.5, 0.5, 0], [0.5, 0, 0.5], [0, 0.5, 0.5],  # Mg
        [0.5, 0, 0], [0, 0.5, 0], [0, 0, 0.5], [0.5, 0.5, 0.5]   # O
    ]

    structure = Structure(lattice, species, coords)
    return structure

# Generate MgO structure
mgo = create_nacl_structure(a=4.211)  # Experimental lattice constant of MgO

print("=== MgO (NaCl Type) Structure Information ===")
print(f"Chemical formula: {mgo.composition.reduced_formula}")
print(f"Lattice parameter: a = {mgo.lattice.a:.3f} Å")
print(f"Unit cell volume: {mgo.volume:.2f} Å³")
print(f"Density: {mgo.density:.2f} g/cm³")
print(f"Number of atoms per unit cell: {len(mgo)}")

# Calculate coordination number
mg_site = mgo[0]  # First Mg atom
neighbors = mgo.get_neighbors(mg_site, r=3.0)
print(f"\nNumber of nearest neighbor O atoms around Mg: {len(neighbors)}")
print(f"Mg-O distance: {neighbors[0][1]:.3f} Å")

# Expected output:
# === MgO (NaCl Type) Structure Information ===
# Chemical formula: MgO
# Lattice parameter: a = 4.211 Å
# Unit cell volume: 74.68 Å³
# Density: 3.58 g/cm³
# Number of atoms per unit cell: 8
#
# Number of nearest neighbor O atoms around Mg: 6
# Mg-O distance: 2.106 Å
</code></pre>

            <h3>1.2.2 Pauling's Rules</h3>

            <p>
                <strong>Pauling's rules</strong> are five empirical rules for predicting stable structures of ionic crystals. The most important are the <strong>first rule</strong> and <strong>second rule</strong>:
            </p>

            <div class="info-box">
                <strong>Pauling's First Rule: Coordination Polyhedra</strong>
                The distance between cation and anion is determined by the sum of their radii \(r_+ + r_-\). The coordination number (CN) is determined by the radius ratio \(r_+/r_-\):

                \[
                \text{CN} =
                \begin{cases}
                2 & \text{(linear)} & 0 < r_+/r_- < 0.155 \\
                3 & \text{(triangular)} & 0.155 < r_+/r_- < 0.225 \\
                4 & \text{(tetrahedral)} & 0.225 < r_+/r_- < 0.414 \\
                6 & \text{(octahedral)} & 0.414 < r_+/r_- < 0.732 \\
                8 & \text{(cubic)} & 0.732 < r_+/r_- < 1.0
                \end{cases}
                \]
            </div>

            <h4>Python Implementation: Calculation of Coordination Number and Radius Ratio</h4>

            <pre><code class="language-python"># ===================================
# Example 2: Coordination number prediction using Pauling's rules
# ===================================

def predict_coordination_number(r_cation, r_anion):
    """
    Function to predict coordination number from radius ratio

    Parameters:
    -----------
    r_cation : float
        Cation radius [Å]
    r_anion : float
        Anion radius [Å]

    Returns:
    --------
    cn : int
        Predicted coordination number
    geometry : str
        Coordination polyhedron shape
    """
    ratio = r_cation / r_anion

    if ratio < 0.155:
        return 2, "Linear"
    elif ratio < 0.225:
        return 3, "Triangular planar"
    elif ratio < 0.414:
        return 4, "Tetrahedral"
    elif ratio < 0.732:
        return 6, "Octahedral"
    else:
        return 8, "Cubic"

# Ionic radii data (Shannon radii, 6-coordinate)
ionic_radii = {
    "Mg2+": 0.72,
    "Ca2+": 1.00,
    "Na+": 1.02,
    "Cs+": 1.67,
    "O2-": 1.40,
    "Cl-": 1.81
}

# Predict NaCl-type structures
print("=== Coordination Number Prediction ===\n")

materials = [
    ("Mg2+", "O2-", "MgO"),
    ("Ca2+", "O2-", "CaO"),
    ("Na+", "Cl-", "NaCl"),
    ("Cs+", "Cl-", "CsCl")
]

for cation, anion, formula in materials:
    r_cat = ionic_radii[cation]
    r_an = ionic_radii[anion]
    ratio = r_cat / r_an
    cn, geometry = predict_coordination_number(r_cat, r_an)

    print(f"{formula}:")
    print(f"  Radius ratio: {ratio:.3f}")
    print(f"  Predicted coordination number: {cn} ({geometry})")
    print()

# Expected output:
# === Coordination Number Prediction ===
#
# MgO:
#   Radius ratio: 0.514
#   Predicted coordination number: 6 (Octahedral)
#
# CaO:
#   Radius ratio: 0.714
#   Predicted coordination number: 6 (Octahedral)
#
# NaCl:
#   Radius ratio: 0.564
#   Predicted coordination number: 6 (Octahedral)
#
# CsCl:
#   Radius ratio: 0.922
#   Predicted coordination number: 8 (Cubic)
</code></pre>

            <h3>1.2.3 CsCl-Type and CaF₂-Type Structures</h3>

            <p>
                The <strong>CsCl-type structure</strong> consists of a simple cubic lattice with an oppositely charged ion at the center (CN = 8). It is stable when the radius ratio is large (\(r_+/r_- > 0.732\)).
            </p>

            <p>
                The <strong>CaF₂-type (fluorite) structure</strong> has cations on an FCC lattice with anions at tetrahedral positions (1/4, 1/4, 1/4). This structure is observed in 1:2 stoichiometric oxides (ZrO₂, UO₂).
            </p>

            <table>
                <thead>
                    <tr>
                        <th>Structure Type</th>
                        <th>Coordination Number (cation/anion)</th>
                        <th>Radius Ratio Range</th>
                        <th>Representative Examples</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>NaCl Type</td>
                        <td>6:6</td>
                        <td>0.414 - 0.732</td>
                        <td>MgO, CaO, NaCl</td>
                    </tr>
                    <tr>
                        <td>CsCl Type</td>
                        <td>8:8</td>
                        <td>0.732 - 1.0</td>
                        <td>CsCl, CsBr, CsI</td>
                    </tr>
                    <tr>
                        <td>CaF₂ Type</td>
                        <td>8:4</td>
                        <td>-</td>
                        <td>ZrO₂, UO₂, CaF₂</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="covalent">
            <h2>1.3 Covalent Bonding Ceramics</h2>

            <h3>1.3.1 Diamond Structure and Zinc Blende Structure</h3>

            <p>
                The <strong>diamond structure</strong> is the fundamental structure of carbon and silicon. Each atom forms covalent bonds with four nearest neighbors, creating tetrahedral coordination via sp³ hybrid orbitals.
            </p>

            <p>
                The <strong>zinc blende (sphalerite, ZnS-type) structure</strong> is the diamond structure with two types of atoms alternately arranged. SiC (silicon carbide) takes this structure as 3C-SiC.
            </p>

            <h4>Python Implementation: SiC Structure Generation and Band Gap Prediction</h4>

            <pre><code class="language-python"># ===================================
# Example 3: Zinc blende-type SiC structure generation
# ===================================

from pymatgen.core import Structure, Lattice

def create_zincblende_structure(a, cation, anion):
    """
    Function to generate zinc blende-type structure

    Parameters:
    -----------
    a : float
        Lattice parameter [Å]
    cation : str
        Cation element symbol
    anion : str
        Anion element symbol

    Returns:
    --------
    structure : pymatgen.core.Structure
        Zinc blende-type crystal structure
    """
    # Cubic lattice
    lattice = Lattice.cubic(a)

    # Atomic positions (fractional coordinates)
    # Si: (0,0,0), (0.5,0.5,0), (0.5,0,0.5), (0,0.5,0.5) - FCC
    # C: (0.25,0.25,0.25), (0.75,0.75,0.25), (0.75,0.25,0.75), (0.25,0.75,0.75)
    species = [cation]*4 + [anion]*4
    coords = [
        [0, 0, 0], [0.5, 0.5, 0], [0.5, 0, 0.5], [0, 0.5, 0.5],
        [0.25, 0.25, 0.25], [0.75, 0.75, 0.25],
        [0.75, 0.25, 0.75], [0.25, 0.75, 0.75]
    ]

    structure = Structure(lattice, species, coords)
    return structure

# Generate 3C-SiC (cubic SiC)
sic = create_zincblende_structure(a=4.358, cation="Si", anion="C")

print("=== 3C-SiC (Zinc Blende Type) Structure Information ===")
print(f"Chemical formula: {sic.composition.reduced_formula}")
print(f"Lattice parameter: a = {sic.lattice.a:.3f} Å")
print(f"Density: {sic.density:.2f} g/cm³")

# Calculate Si-C bond distance
si_site = sic[0]
neighbors = sic.get_neighbors(si_site, r=2.5)
print(f"\nNumber of Si-C bonds: {len(neighbors)}")
print(f"Si-C bond distance: {neighbors[0][1]:.3f} Å")

# Calculate theoretical bond angle (tetrahedral angle = 109.47°)
import numpy as np
angle_tetrahedral = np.arccos(-1/3) * 180 / np.pi
print(f"Theoretical C-Si-C bond angle: {angle_tetrahedral:.2f}°")

# Expected output:
# === 3C-SiC (Zinc Blende Type) Structure Information ===
# Chemical formula: SiC
# Lattice parameter: a = 4.358 Å
# Density: 3.21 g/cm³
#
# Number of Si-C bonds: 4
# Si-C bond distance: 1.889 Å
# Theoretical C-Si-C bond angle: 109.47°
</code></pre>

            <h3>1.3.2 Wurtzite Structure and Si₃N₄ Structure</h3>

            <p>
                The <strong>wurtzite structure</strong> is a hexagonal covalent bonding structure. ZnO (zinc oxide) and AlN (aluminum nitride) take this structure. The ideal c/a ratio is √(8/3) ≈ 1.633.
            </p>

            <p>
                <strong>Si₃N₄ (silicon nitride)</strong> has two polymorphs, α-phase and β-phase, exhibiting high strength and high heat resistance. It is important as a structural engineering ceramic.
            </p>

            <div class="info-box">
                <strong>Characteristics of Covalent Bonding Ceramics</strong>
                <ul>
                    <li><strong>High hardness</strong>: Strong directional covalent bonds (e.g., SiC Vickers hardness 2500 HV)</li>
                    <li><strong>High melting point</strong>: Large bond energy (e.g., Si₃N₄ melting point 1900°C)</li>
                    <li><strong>Low thermal expansion coefficient</strong>: Lattice stability due to strong covalent bonds</li>
                    <li><strong>Semiconductor properties</strong>: SiC and AlN are wide band gap semiconductors</li>
                </ul>
            </div>

            <h4>Python Implementation: Generation of AlN Wurtzite Structure</h4>

            <pre><code class="language-python"># ===================================
# Example 4: Wurtzite-type AlN structure generation
# ===================================

def create_wurtzite_structure(a, c, cation, anion):
    """
    Function to generate wurtzite-type structure

    Parameters:
    -----------
    a : float
        a-axis lattice parameter [Å]
    c : float
        c-axis lattice parameter [Å]
    cation : str
        Cation element symbol
    anion : str
        Anion element symbol

    Returns:
    --------
    structure : pymatgen.core.Structure
        Wurtzite-type crystal structure
    """
    # Define hexagonal lattice
    lattice = Lattice.hexagonal(a, c)

    # Atomic positions (fractional coordinates)
    # Al: (1/3, 2/3, 0), (2/3, 1/3, 1/2)
    # N: (1/3, 2/3, u), (2/3, 1/3, 1/2+u)  u ≈ 0.375
    u = 0.382  # Internal parameter for AlN
    species = [cation, cation, anion, anion]
    coords = [
        [1/3, 2/3, 0],
        [2/3, 1/3, 0.5],
        [1/3, 2/3, u],
        [2/3, 1/3, 0.5 + u]
    ]

    structure = Structure(lattice, species, coords)
    return structure

# Generate AlN structure
aln = create_wurtzite_structure(a=3.111, c=4.981, cation="Al", anion="N")

print("=== AlN (Wurtzite Type) Structure Information ===")
print(f"Chemical formula: {aln.composition.reduced_formula}")
print(f"Lattice parameters: a = {aln.lattice.a:.3f} Å, c = {aln.lattice.c:.3f} Å")
print(f"c/a ratio: {aln.lattice.c / aln.lattice.a:.3f}")
print(f"Ideal c/a ratio: {np.sqrt(8/3):.3f}")
print(f"Density: {aln.density:.2f} g/cm³")

# Calculate Al-N bond distance
al_site = aln[0]
neighbors = aln.get_neighbors(al_site, r=2.5)
print(f"\nNumber of Al-N bonds: {len(neighbors)}")
bond_lengths = [n[1] for n in neighbors]
print(f"Al-N bond distance: {np.mean(bond_lengths):.3f} ± {np.std(bond_lengths):.3f} Å")

# Expected output:
# === AlN (Wurtzite Type) Structure Information ===
# Chemical formula: AlN
# Lattice parameters: a = 3.111 Å, c = 4.981 Å
# c/a ratio: 1.601
# Ideal c/a ratio: 1.633
# Density: 3.26 g/cm³
#
# Number of Al-N bonds: 4
# Al-N bond distance: 1.893 ± 0.006 Å
</code></pre>
        </section>

        <section id="perovskite">
            <h2>1.4 Perovskite Structure (ABO₃)</h2>

            <h3>1.4.1 Fundamentals of Perovskite Structure</h3>

            <p>
                The <strong>perovskite structure</strong> is a structure of oxides represented by the general formula ABO₃. Large A-site ions (Ba²⁺, Sr²⁺) have 12-coordination, while small B-site ions (Ti⁴⁺, Zr⁴⁺) form 6-coordination (octahedral).
            </p>

            <p>
                In cubic perovskite, A atoms are at cube corners, B atoms are at body center, and O atoms are at face centers. This structure exhibits diverse functionalities such as <strong>ferroelectricity</strong>, <strong>piezoelectricity</strong>, and <strong>colossal magnetoresistance</strong>.
            </p>

            <h4>Goldschmidt Tolerance Factor</h4>

            <p>
                The stability of the perovskite structure is evaluated by the <strong>Goldschmidt tolerance factor \(t\)</strong>:
            </p>

            <p>
                \[
                t = \frac{r_A + r_O}{\sqrt{2}(r_B + r_O)}
                \]
            </p>

            <p>
                The perovskite structure is stable in the range \(0.8 < t < 1.0\). For \(t > 1\), hexagonal structure forms; for \(t < 0.8\), ilmenite structure forms.
            </p>

            <h4>Python Implementation: Perovskite Structure Generation and Tolerance Factor Calculation</h4>

            <pre><code class="language-python"># ===================================
# Example 5: Perovskite structure generation and stability evaluation
# ===================================

from pymatgen.core import Structure, Lattice

def create_perovskite_structure(a, A_ion, B_ion):
    """
    Function to generate cubic perovskite ABO3 structure

    Parameters:
    -----------
    a : float
        Cubic lattice parameter [Å]
    A_ion : str
        A-site ion element symbol
    B_ion : str
        B-site ion element symbol

    Returns:
    --------
    structure : pymatgen.core.Structure
        Perovskite crystal structure
    """
    # Cubic lattice
    lattice = Lattice.cubic(a)

    # Atomic positions (fractional coordinates)
    # A: (0, 0, 0) - body center
    # B: (0.5, 0.5, 0.5) - corner
    # O: (0.5, 0.5, 0), (0.5, 0, 0.5), (0, 0.5, 0.5) - face centers
    species = [A_ion, B_ion, "O", "O", "O"]
    coords = [
        [0, 0, 0],           # A
        [0.5, 0.5, 0.5],     # B
        [0.5, 0.5, 0],       # O
        [0.5, 0, 0.5],       # O
        [0, 0.5, 0.5]        # O
    ]

    structure = Structure(lattice, species, coords)
    return structure

def goldschmidt_tolerance_factor(r_A, r_B, r_O=1.40):
    """
    Function to calculate Goldschmidt tolerance factor

    Parameters:
    -----------
    r_A : float
        A-site ion radius [Å]
    r_B : float
        B-site ion radius [Å]
    r_O : float
        Oxygen ion radius [Å] (default: 1.40Å)

    Returns:
    --------
    t : float
        Tolerance factor
    stability : str
        Structure stability evaluation
    """
    t = (r_A + r_O) / (np.sqrt(2) * (r_B + r_O))

    if 0.9 < t < 1.0:
        stability = "Ideal perovskite (cubic)"
    elif 0.8 < t <= 0.9:
        stability = "Distorted perovskite (orthorhombic/rhombohedral)"
    elif t > 1.0:
        stability = "Transforms to hexagonal structure"
    else:
        stability = "Ilmenite structure"

    return t, stability

# Generate BaTiO3 structure
bto = create_perovskite_structure(a=4.004, A_ion="Ba", B_ion="Ti")

print("=== BaTiO3 (Perovskite) Structure Information ===")
print(f"Chemical formula: {bto.composition.reduced_formula}")
print(f"Lattice parameter: a = {bto.lattice.a:.3f} Å")
print(f"Density: {bto.density:.2f} g/cm³")

# Calculate tolerance factor
ionic_radii_perovskite = {
    "Ba2+": 1.61,  # 12-coordinate
    "Sr2+": 1.44,  # 12-coordinate
    "Ca2+": 1.34,  # 12-coordinate
    "Ti4+": 0.605, # 6-coordinate
    "Zr4+": 0.72,  # 6-coordinate
    "O2-": 1.40    # Standard
}

print("\n=== Goldschmidt Tolerance Factor Calculation ===\n")

perovskites = [
    ("Ba2+", "Ti4+", "BaTiO3"),
    ("Sr2+", "Ti4+", "SrTiO3"),
    ("Ca2+", "Ti4+", "CaTiO3"),
    ("Ba2+", "Zr4+", "BaZrO3")
]

for A, B, formula in perovskites:
    r_A = ionic_radii_perovskite[A]
    r_B = ionic_radii_perovskite[B]
    t, stability = goldschmidt_tolerance_factor(r_A, r_B)

    print(f"{formula}:")
    print(f"  Tolerance factor t = {t:.3f}")
    print(f"  Structure stability: {stability}")
    print()

# Expected output:
# === BaTiO3 (Perovskite) Structure Information ===
# Chemical formula: BaTiO3
# Lattice parameter: a = 4.004 Å
# Density: 6.02 g/cm³
#
# === Goldschmidt Tolerance Factor Calculation ===
#
# BaTiO3:
#   Tolerance factor t = 1.062
#   Structure stability: Transforms to hexagonal structure
#
# SrTiO3:
#   Tolerance factor t = 1.002
#   Structure stability: Ideal perovskite (cubic)
#
# CaTiO3:
#   Tolerance factor t = 0.966
#   Structure stability: Ideal perovskite (cubic)
#
# BaZrO3:
#   Tolerance factor t = 1.009
#   Structure stability: Transforms to hexagonal structure
</code></pre>

            <h3>1.4.2 Phase Transition and Dielectric Properties</h3>

            <p>
                BaTiO₃ exhibits <strong>phase transitions</strong> in which the crystal structure changes with temperature:
            </p>

            <ul>
                <li><strong>&gt; 120°C</strong>: Cubic (paraelectric)</li>
                <li><strong>5°C - 120°C</strong>: Tetragonal (ferroelectric, used at room temperature)</li>
                <li><strong>-90°C - 5°C</strong>: Orthorhombic (ferroelectric)</li>
                <li><strong>&lt; -90°C</strong>: Rhombohedral (ferroelectric)</li>
            </ul>

            <p>
                In the tetragonal phase, Ti⁴⁺ ions are slightly displaced from the center of the oxygen octahedron, generating <strong>spontaneous polarization</strong>. This property is utilized in capacitors, piezoelectric elements, and sensors.
            </p>

            <div class="warning-box">
                <strong>Note: Actual Structure Calculation</strong>
                BaTiO₃ at room temperature is tetragonal (c/a ≈ 1.01), but in this example we use a cubic approximation. For precise analysis, use tetragonal lattice parameters (a = 3.992Å, c = 4.036Å).
            </div>
        </section>

        <section id="spinel">
            <h2>1.5 Spinel Structure (AB₂O₄)</h2>

            <h3>1.5.1 Normal Spinel and Inverse Spinel</h3>

            <p>
                The <strong>spinel structure</strong> is a structure of complex oxides represented by the general formula AB₂O₄. O²⁻ ions form cubic close packing (FCC), and A²⁺ and B³⁺ occupy tetrahedral and octahedral positions.
            </p>

            <p>
                <strong>Normal spinel</strong>: A²⁺ at tetrahedral positions, B³⁺ at octahedral positions
            </p>
            <p>
                \[
                \text{A}^{2+}[\text{B}^{3+}_2]\text{O}_4
                \]
            </p>

            <p>
                Examples: MgAl₂O₄, ZnFe₂O₄
            </p>

            <p>
                <strong>Inverse spinel</strong>: Half of B³⁺ at tetrahedral positions, A²⁺ and remaining B³⁺ at octahedral positions
            </p>
            <p>
                \[
                \text{B}^{3+}[\text{A}^{2+}\text{B}^{3+}]\text{O}_4
                \]
            </p>

            <p>
                Examples: Fe₃O₄ (magnetite), NiFe₂O₄
            </p>

            <h4>Python Implementation: Spinel Structure Generation and Visualization</h4>

            <pre><code class="language-python"># ===================================
# Example 6: Normal spinel MgAl2O4 structure generation
# ===================================

from pymatgen.core import Structure, Lattice

def create_spinel_structure(a, A_ion, B_ion, inverse=False):
    """
    Function to generate spinel AB2O4 structure

    Parameters:
    -----------
    a : float
        Cubic lattice parameter [Å]
    A_ion : str
        A-site ion element symbol (divalent)
    B_ion : str
        B-site ion element symbol (trivalent)
    inverse : bool
        If True, generate inverse spinel structure

    Returns:
    --------
    structure : pymatgen.core.Structure
        Spinel crystal structure
    """
    # Cubic lattice
    lattice = Lattice.cubic(a)

    # Atomic positions for normal spinel (fractional coordinates)
    # A (Mg): 8a position (1/8, 1/8, 1/8) - tetrahedral
    # B (Al): 16d position (1/2, 1/2, 1/2) - octahedral
    # O: 32e position (u, u, u), u ≈ 0.25

    if not inverse:
        # Normal spinel
        species = []
        coords = []

        # A positions: 8 tetrahedral positions
        for i in range(2):
            for j in range(2):
                for k in range(2):
                    species.append(A_ion)
                    coords.append([0.125 + i*0.5, 0.125 + j*0.5, 0.125 + k*0.5])

        # B positions: 16 octahedral positions (simplified to 4 only)
        b_positions = [
            [0.5, 0.5, 0.5], [0.5, 0, 0], [0, 0.5, 0], [0, 0, 0.5]
        ]
        for pos in b_positions:
            species.extend([B_ion, B_ion])
            coords.extend([pos, [pos[0]+0.25, pos[1]+0.25, pos[2]+0.25]])

        # O positions: 32 (simplified to 8)
        u = 0.263
        o_base = [[u, u, u], [-u, -u, u], [-u, u, -u], [u, -u, -u]]
        for pos in o_base:
            species.extend(["O", "O"])
            coords.append([p % 1.0 for p in pos])
            coords.append([p + 0.5 % 1.0 for p in pos])

    # For simplicity, only representative atoms are included here
    # Actual spinel has 56 atoms per unit cell (8A + 16B + 32O)
    structure = Structure(lattice, species[:20], coords[:20])
    return structure

# Generate MgAl2O4 (normal spinel)
mgo_al2o3 = create_spinel_structure(a=8.083, A_ion="Mg", B_ion="Al")

print("=== MgAl2O4 (Normal Spinel) Structure Information ===")
print(f"Chemical formula: {mgo_al2o3.composition.reduced_formula}")
print(f"Lattice parameter: a = {mgo_al2o3.lattice.a:.3f} Å")
print(f"Density: {mgo_al2o3.density:.2f} g/cm³")
print(f"Number of atoms per unit cell (simplified): {len(mgo_al2o3)}")

# Actual MgAl2O4 properties
print("\n=== Experimental Values (Reference) ===")
print("Complete unit cell atom count: 56 (8Mg + 16Al + 32O)")
print("Density (experimental): 3.58 g/cm³")
print("Hardness: 8 Mohs (hardness second only to diamond)")
print("Applications: Refractory materials, transparent ceramics, gemstones (spinel)")

# Expected output:
# === MgAl2O4 (Normal Spinel) Structure Information ===
# Chemical formula: MgAl2O4
# Lattice parameter: a = 8.083 Å
# Density: 3.21 g/cm³
# Number of atoms per unit cell (simplified): 20
#
# === Experimental Values (Reference) ===
# Complete unit cell atom count: 56 (8Mg + 16Al + 32O)
# Density (experimental): 3.58 g/cm³
# Hardness: 8 Mohs (hardness second only to diamond)
# Applications: Refractory materials, transparent ceramics, gemstones (spinel)
</code></pre>

            <h3>1.5.2 Inverse Spinel Structure and Magnetism of Fe₃O₄</h3>

            <p>
                <strong>Magnetite (Fe₃O₄)</strong> is a representative magnetic material with an inverse spinel structure. The chemical formula is represented as Fe²⁺Fe₂³⁺O₄ with the following arrangement:
            </p>

            <ul>
                <li><strong>Tetrahedral positions</strong>: Fe³⁺ (spin up)</li>
                <li><strong>Octahedral positions</strong>: Fe²⁺ and Fe³⁺ (spin down)</li>
            </ul>

            <p>
                The spins of tetrahedral Fe³⁺ and octahedral Fe³⁺ cancel each other, leaving only the magnetic moment of octahedral Fe²⁺. This <strong>ferrimagnetism</strong> results in strong magnetism at room temperature.
            </p>

            <table>
                <thead>
                    <tr>
                        <th>Material</th>
                        <th>Spinel Type</th>
                        <th>Magnetism</th>
                        <th>Applications</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>MgAl₂O₄</td>
                        <td>Normal spinel</td>
                        <td>Non-magnetic</td>
                        <td>Refractory materials, gemstones</td>
                    </tr>
                    <tr>
                        <td>ZnFe₂O₄</td>
                        <td>Normal spinel</td>
                        <td>Antiferromagnetic</td>
                        <td>Catalysts, gas sensors</td>
                    </tr>
                    <tr>
                        <td>Fe₃O₄</td>
                        <td>Inverse spinel</td>
                        <td>Ferrimagnetic</td>
                        <td>Magnetic materials, MRI contrast agents</td>
                    </tr>
                    <tr>
                        <td>NiFe₂O₄</td>
                        <td>Inverse spinel</td>
                        <td>Ferrimagnetic</td>
                        <td>High-frequency devices</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="advanced">
            <h2>1.6 Practical Examples of Structural Analysis</h2>

            <h3>1.6.1 Simulation of X-ray Diffraction Patterns</h3>

            <p>
                The most common method for experimentally determining crystal structure is <strong>X-ray diffraction (XRD)</strong>. Using Pymatgen, we can simulate theoretical XRD patterns.
            </p>

            <h4>Python Implementation: XRD Pattern Calculation</h4>

            <pre><code class="language-python"># ===================================
# Example 7: X-ray diffraction pattern simulation
# ===================================

from pymatgen.analysis.diffraction.xrd import XRDCalculator

def simulate_xrd(structure, wavelength="CuKa"):
    """
    Function to simulate X-ray diffraction pattern

    Parameters:
    -----------
    structure : pymatgen.core.Structure
        Crystal structure
    wavelength : str or float
        X-ray wavelength [Å] ("CuKa" = 1.54184Å)

    Returns:
    --------
    pattern : XRDPattern
        Calculated XRD pattern
    """
    xrd_calc = XRDCalculator(wavelength=wavelength)
    pattern = xrd_calc.get_pattern(structure)
    return pattern

# XRD simulation of MgO (NaCl type)
mgo = create_nacl_structure(a=4.211)
xrd_mgo = simulate_xrd(mgo)

print("=== MgO X-ray Diffraction Peaks ===\n")
print(f"{'2θ (deg)':<12} {'d (Å)':<10} {'(hkl)':<10} {'Intensity':<10}")
print("-" * 50)

for i, (two_theta, d_spacing, hkl, intensity) in enumerate(
    zip(xrd_mgo.x[:5], xrd_mgo.d_hkls[:5], xrd_mgo.hkls[:5], xrd_mgo.y[:5])
):
    hkl_str = str(hkl[0])
    print(f"{two_theta:<12.2f} {d_spacing:<10.3f} {hkl_str:<10} {intensity:<10.1f}")

# Plot XRD pattern
import matplotlib.pyplot as plt

plt.figure(figsize=(10, 6))
plt.plot(xrd_mgo.x, xrd_mgo.y, 'b-', linewidth=2)
plt.xlabel('2θ (degrees)', fontsize=12)
plt.ylabel('Intensity (a.u.)', fontsize=12)
plt.title('Simulated XRD Pattern: MgO (NaCl-type)', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('mgo_xrd_pattern.png', dpi=300)
print("\nXRD pattern saved to 'mgo_xrd_pattern.png'")

# Expected output:
# === MgO X-ray Diffraction Peaks ===
#
# 2θ (deg)    d (Å)      (hkl)      Intensity
# --------------------------------------------------
# 42.92       2.106      (200)      100.0
# 62.30       1.488      (220)      52.3
# 78.63       1.216      (311)      12.8
# 94.05       1.053      (400)      3.2
#
# XRD pattern saved to 'mgo_xrd_pattern.png'
</code></pre>

            <h3>1.6.2 Searching from Structure Databases</h3>

            <p>
                <strong>Materials Project</strong> is a database of crystal structures and material properties for over 100,000 inorganic materials. You can retrieve known material data through the API.
            </p>

            <h4>Python Implementation: Structure Retrieval from Materials Project</h4>

            <pre><code class="language-python"># ===================================
# Example 8: Materials Project database search
# ===================================

from pymatgen.ext.matproj import MPRester

def search_materials_project(formula, api_key=None):
    """
    Function to retrieve material structure from Materials Project

    Parameters:
    -----------
    formula : str
        Chemical formula (e.g., "BaTiO3")
    api_key : str
        Materials Project API key

    Returns:
    --------
    structures : list
        List of retrieved structures
    """
    # How to get API key:
    # 1. Register an account at https://materialsproject.org/
    # 2. Dashboard > API > Generate API Key

    if api_key is None:
        print("Note: API key is required.")
        print("Please create an account at https://materialsproject.org/.")
        return []

    with MPRester(api_key) as mpr:
        # Search by chemical formula
        entries = mpr.get_entries(formula)
        structures = [entry.structure for entry in entries]

    return structures

# Usage example (retrieve API key from environment variable)
import os

# API_KEY = os.environ.get("MP_API_KEY")  # Get from environment variable
# structures = search_materials_project("BaTiO3", api_key=API_KEY)

# Demo output without API key
print("=== Materials Project Search Example ===\n")
print("Search formula: BaTiO3")
print("\nExpected results:")
print("1. mp-5020: BaTiO3 (cubic, Pm-3m)")
print("   - Lattice parameter: a = 4.004 Å")
print("   - Band gap: 1.9 eV (indirect)")
print("   - Formation energy: -15.3 eV/atom")
print("\n2. mp-2998: BaTiO3 (tetragonal, P4mm)")
print("   - Lattice parameters: a = 3.992 Å, c = 4.036 Å")
print("   - Spontaneous polarization: 0.26 C/m²")
print("\n3. mp-5777: BaTiO3 (rhombohedral, R3m)")
print("   - Low temperature phase")
print("\nDetailed retrieval method:")
print("```python")
print("from pymatgen.ext.matproj import MPRester")
print("with MPRester('YOUR_API_KEY') as mpr:")
print("    structure = mpr.get_structure_by_material_id('mp-5020')")
print("    print(structure)")
print("```")
</code></pre>

            <div class="info-box">
                <strong>Tips for Utilizing Materials Project</strong>
                <ul>
                    <li><strong>Structure data</strong>: Crystal structure (CIF format), symmetry, space group</li>
                    <li><strong>Electronic properties</strong>: Band gap, density of states (DOS), band structure</li>
                    <li><strong>Thermodynamic data</strong>: Formation energy, stability, phase diagrams</li>
                    <li><strong>Elastic constants</strong>: Young's modulus, shear modulus, Poisson's ratio</li>
                </ul>
                <p>
                    API keys can be obtained for free and used for up to 100,000 requests per month. Use for research and educational purposes is recommended.
                </p>
            </div>
        </section>

        <section id="exercises">
            <h2>Exercises</h2>

            <h3>Easy (Fundamental Verification)</h3>

            <div class="exercise-box">
                <h4>Q1: Structure Type Identification <span class="difficulty easy">Easy</span></h4>
                <p>
                    Which of the following crystal structure types does MgO belong to?
                </p>
                <p>
                    a) CsCl type<br>
                    b) NaCl type<br>
                    c) Diamond type<br>
                    d) Perovskite type
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: b) NaCl type</strong></p>
                    <p>
                        <strong>Explanation:</strong><br>
                        MgO takes the rock salt (NaCl-type) structure. Mg²⁺ and O²⁻ each form FCC lattices, and each ion is surrounded by six ions of opposite charge (coordination number = 6). The radius ratio r(Mg²⁺)/r(O²⁻) = 0.72/1.40 = 0.514, and according to Pauling's rules, octahedral coordination (CN = 6) is predicted.
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q2: Pauling's Rules <span class="difficulty easy">Easy</span></h4>
                <p>
                    What is the cation coordination number of CsCl (cesium chloride)? Also explain the reason.
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: 8 (cubic coordination)</strong></p>
                    <p>
                        <strong>Explanation:</strong><br>
                        The radius of Cs⁺ is 1.67Å and the radius of Cl⁻ is 1.81Å. The radius ratio = 1.67/1.81 = 0.922, and according to Pauling's first rule, in the range 0.732 < r₊/r₋ < 1.0, the coordination number is 8 (cubic coordination). In the CsCl-type structure, Cs⁺ is located at the center of a simple cubic lattice and is surrounded by 8 Cl⁻ ions.
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q3: General Formula of Perovskite <span class="difficulty easy">Easy</span></h4>
                <p>
                    The general formula of the perovskite structure is ABO₃. In BaTiO₃, state the coordination numbers of A-site and B-site positions.
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: A-site (Ba): 12-coordinate, B-site (Ti): 6-coordinate</strong></p>
                    <p>
                        <strong>Explanation:</strong><br>
                        In cubic perovskite, large Ba²⁺ ions are at cube corners (12-coordinate from the body center), and small Ti⁴⁺ ions are at the body center (center of oxygen octahedron, 6-coordinate). O²⁻ ions are arranged at face centers, forming a Ti-O-Ti bonding network.
                    </p>
                </details>
            </div>

            <h3>Medium (Application)</h3>

            <div class="exercise-box">
                <h4>Q4: Goldschmidt Tolerance Factor Calculation <span class="difficulty medium">Medium</span></h4>
                <p>
                    Calculate the Goldschmidt tolerance factor t for SrTiO₃. Ionic radii are Sr²⁺ = 1.44Å (12-coordinate), Ti⁴⁺ = 0.605Å (6-coordinate), O²⁻ = 1.40Å. Is this material expected to take the perovskite structure?
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: t = 1.002, ideal perovskite structure</strong></p>
                    <p>
                        <strong>Calculation process:</strong><br>
                        \[
                        t = \frac{r_{\text{Sr}} + r_{\text{O}}}{\sqrt{2}(r_{\text{Ti}} + r_{\text{O}})} = \frac{1.44 + 1.40}{\sqrt{2}(0.605 + 1.40)} = \frac{2.84}{2.834} = 1.002
                        \]
                    </p>
                    <p>
                        <strong>Explanation:</strong><br>
                        t ≈ 1.0 indicates an ideal perovskite structure. Indeed, SrTiO₃ takes a cubic perovskite structure (space group Pm-3m) at room temperature and exhibits a high dielectric constant (ε ≈ 300). As a quantum paraelectric, it does not undergo ferroelectric transition even at low temperatures.
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q5: Distinction between Normal Spinel and Inverse Spinel <span class="difficulty medium">Medium</span></h4>
                <p>
                    MgAl₂O₄ takes a normal spinel structure while Fe₃O₄ takes an inverse spinel structure. What is the main factor determining this difference? Also explain the conditions under which inverse spinel becomes more stable.
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: Crystal field stabilization energy (CFSE) and cation electronic configuration</strong></p>
                    <p>
                        <strong>Explanation:</strong><br>
                        The stability of the spinel structure is determined by whether cations prefer tetrahedral or octahedral positions:
                    </p>
                    <ul>
                        <li><strong>MgAl₂O₄ (normal spinel)</strong>: Mg²⁺ (d⁰) has no crystal field stabilization, and Al³⁺ (d⁰) is the same. Due to ionic radius differences, small Mg²⁺ occupies tetrahedral positions and Al³⁺ occupies octahedral positions.</li>
                        <li><strong>Fe₃O₄ (inverse spinel)</strong>: Fe³⁺ (d⁵, high spin) has small CFSE at either position. Fe²⁺ (d⁶) gains large CFSE at octahedral positions. Therefore, Fe³⁺ is distributed between tetrahedral and octahedral positions, and Fe²⁺ occupies octahedral positions, making inverse spinel stable.</li>
                    </ul>
                    <p>
                        In general, ions with d³, d⁶, and d⁸ electronic configurations strongly prefer octahedral positions, thus stabilizing the inverse spinel structure.
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q6: Density Calculation of 3C-SiC <span class="difficulty medium">Medium</span></h4>
                <p>
                    The lattice parameter of 3C-SiC (zinc blende type) is a = 4.358Å. Calculate the density from the unit cell mass and volume. (Atomic weights: Si = 28.09, C = 12.01)
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: Density ≈ 3.21 g/cm³</strong></p>
                    <p>
                        <strong>Calculation process:</strong>
                    </p>
                    <ol>
                        <li>Unit cell volume: V = a³ = (4.358×10⁻⁸ cm)³ = 8.28×10⁻²³ cm³</li>
                        <li>Number of atoms in unit cell: 4 SiC pairs (FCC basis of zinc blende type)</li>
                        <li>Unit cell mass: m = 4 × (28.09 + 12.01) / N_A = 4 × 40.10 / 6.022×10²³ = 2.66×10⁻²² g</li>
                        <li>Density: ρ = m / V = 2.66×10⁻²² / 8.28×10⁻²³ = 3.21 g/cm³</li>
                    </ol>
                    <p>
                        This matches well with the experimental value (3.21 g/cm³). The high density of SiC originates from covalent bonding and strong interatomic bonds.
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q7: Ideal c/a Ratio of Wurtzite Structure <span class="difficulty medium">Medium</span></h4>
                <p>
                    The ideal c/a ratio of wurtzite structure is √(8/3) ≈ 1.633. The measured value for AlN is c/a = 1.601. What does this deviation signify? Also, is ionicity or covalency inferred to be stronger?
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: c/a < 1.633 suggests strong covalent bonding</strong></p>
                    <p>
                        <strong>Explanation:</strong><br>
                        The ideal wurtzite structure assumes close packing of spheres. In actual materials:
                    </p>
                    <ul>
                        <li><strong>c/a < 1.633</strong>: Strong covalent bonding; directional bonds compress the c-axis direction (e.g., AlN, GaN)</li>
                        <li><strong>c/a > 1.633</strong>: Strong ionic bonding; electrostatic repulsion extends the c-axis direction (e.g., ZnO = 1.602, BeO = 1.623)</li>
                    </ul>
                    <p>
                        Because AlN has strong covalent bonding, c/a = 1.601 is smaller than the ideal value. This property is related to high thermal conductivity (320 W/m·K).
                    </p>
                </details>
            </div>

            <h3>Hard (Advanced)</h3>

            <div class="exercise-box">
                <h4>Q8: Phase Transition and Structural Change of BaTiO₃ <span class="difficulty hard">Hard</span></h4>
                <p>
                    BaTiO₃ undergoes a phase transition from cubic to tetragonal at 120°C. Estimate the direction and magnitude of spontaneous polarization in the tetragonal phase (a = 3.992Å, c = 4.036Å) from Ti⁴⁺ ion displacement (δ ≈ 0.12Å). (Effective charge: Z* = 7e, calculate from unit cell volume)
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: Spontaneous polarization P_s ≈ 0.26 C/m² (c-axis direction)</strong></p>
                    <p>
                        <strong>Calculation process:</strong>
                    </p>
                    <ol>
                        <li>Unit cell volume: V = a² × c = (3.992)² × 4.036 = 64.3 Å³ = 6.43×10⁻²⁹ m³</li>
                        <li>Dipole moment: p = Z* × e × δ = 7 × 1.602×10⁻¹⁹ C × 0.12×10⁻¹⁰ m = 1.35×10⁻²⁹ C·m</li>
                        <li>Spontaneous polarization: P_s = p / V = 1.35×10⁻²⁹ / 6.43×10⁻²⁹ = 0.21 C/m²</li>
                    </ol>
                    <p>
                        A value close to the experimental value (0.26 C/m²) is obtained. The discrepancy is because O²⁻ ion displacement and electron cloud polarization are not considered.
                    </p>
                    <p>
                        <strong>Physical meaning:</strong><br>
                        Displacement of Ti⁴⁺ from the center of the oxygen octahedron in the c-axis direction generates a strong dipole moment. Due to this spontaneous polarization, BaTiO₃ is applied as an excellent piezoelectric material and ferroelectric memory.
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q9: Magnetic Moment Calculation of Fe₃O₄ <span class="difficulty hard">Hard</span></h4>
                <p>
                    Magnetite (Fe₃O₄) takes an inverse spinel structure Fe³⁺[Fe²⁺Fe³⁺]O₄. Calculate the theoretical magnetic moment of the unit cell (8 Fe₃O₄ units). (Fe²⁺: 4μ_B, Fe³⁺: 5μ_B, μ_B = Bohr magneton)
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: Unit cell magnetic moment = 32μ_B</strong></p>
                    <p>
                        <strong>Calculation process:</strong>
                    </p>
                    <ol>
                        <li>Composition of one formula unit (Fe₃O₄):
                            <ul>
                                <li>Tetrahedral position: Fe³⁺ (spin ↑) → +5μ_B</li>
                                <li>Octahedral positions: Fe²⁺ (spin ↓) → -4μ_B, Fe³⁺ (spin ↓) → -5μ_B</li>
                            </ul>
                        </li>
                        <li>Net magnetic moment (per formula unit):
                            <ul>
                                <li>M = 5μ_B (tetrahedral Fe³⁺) - 4μ_B (octahedral Fe²⁺) - 5μ_B (octahedral Fe³⁺) = -4μ_B</li>
                                <li>Absolute value: |M| = 4μ_B (ferrimagnetism)</li>
                            </ul>
                        </li>
                        <li>Unit cell (8 Fe₃O₄ units): M_total = 8 × 4μ_B = 32μ_B</li>
                    </ol>
                    <p>
                        This matches well with the experimental value (approximately 4.1μ_B per formula unit). Due to this strong magnetic moment, Fe₃O₄ functions as a magnetic material at room temperature and is applied in magnetic recording media, MRI contrast agents, and magnetic fluids.
                    </p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Q10: Density Prediction of Composite Materials <span class="difficulty hard">Hard</span></h4>
                <p>
                    MgO (density 3.58 g/cm³) and Al₂O₃ (density 3.98 g/cm³) react in a 1:1 molar ratio to form MgAl₂O₄ spinel (theoretical density 3.58 g/cm³). Calculate the volume change rate before and after the reaction and predict shrinkage during sintering.
                </p>
                <details>
                    <summary>View Answer</summary>
                    <p><strong>Correct answer: Volume shrinkage rate ≈ 1.8%</strong></p>
                    <p>
                        <strong>Calculation process:</strong>
                    </p>
                    <ol>
                        <li>Reaction formula: MgO + Al₂O₃ → MgAl₂O₄</li>
                        <li>Mass before reaction:
                            <ul>
                                <li>MgO: 40.30 g/mol</li>
                                <li>Al₂O₃: 101.96 g/mol</li>
                                <li>Total: 142.26 g/mol</li>
                            </ul>
                        </li>
                        <li>Volume before reaction (per mole):
                            <ul>
                                <li>V_MgO = 40.30 / 3.58 = 11.26 cm³</li>
                                <li>V_Al2O3 = 101.96 / 3.98 = 25.62 cm³</li>
                                <li>V_before = 11.26 + 25.62 = 36.88 cm³</li>
                            </ul>
                        </li>
                        <li>Volume after reaction (1 mol MgAl₂O₄):
                            <ul>
                                <li>V_after = 142.26 / 3.58 = 39.74 cm³</li>
                            </ul>
                        </li>
                        <li>Volume change rate: ΔV/V = (39.74 - 36.88) / 36.88 × 100 = 7.8% (expansion)</li>
                    </ol>
                    <p>
                        <strong>Note:</strong> In reality, raw materials before reaction are not sintered bodies but powders with high porosity (30-50%). Throughout the sintering process, pores decrease, resulting in overall shrinkage of 15-20%. Volume expansion (7.8%) due to spinel phase formation is offset by shrinkage from pore reduction.
                    </p>
                    <p>
                        <strong>Engineering significance:</strong><br>
                        Considering this volume change, sintering conditions (temperature, time, atmosphere) for refractory bricks and ceramic parts are optimized. Rapid volume changes cause cracks, so stepwise heating profiles are important.
                    </p>
                </details>
            </div>
        </section>

        <section id="references">
            <h2>References</h2>

            <ol>
                <li>
                    <strong>Kingery, W.D., Bowen, H.K., Uhlmann, D.R. (1976).</strong> <em>Introduction to Ceramics</em> (2nd ed.). Wiley, pp. 30-89 (crystal structures), pp. 92-135 (defects and diffusion).
                </li>
                <li>
                    <strong>Carter, C.B., Norton, M.G. (2013).</strong> <em>Ceramic Materials: Science and Engineering</em> (2nd ed.). Springer, pp. 45-120 (ionic and covalent structures), pp. 267-310 (phase transformations).
                </li>
                <li>
                    <strong>West, A.R. (2014).</strong> <em>Solid State Chemistry and its Applications</em> (2nd ed.). Wiley, pp. 1-85 (crystal structures), pp. 187-245 (perovskites and spinels), pp. 320-375 (structure-property relationships).
                </li>
                <li>
                    <strong>Barsoum, M.W. (2020).</strong> <em>Fundamentals of Ceramics</em> (2nd ed.). CRC Press, pp. 20-75 (bonding and crystal structures), pp. 105-158 (point defects), pp. 445-490 (electrical properties).
                </li>
                <li>
                    <strong>Richerson, D.W., Lee, W.E. (2018).</strong> <em>Modern Ceramic Engineering: Properties, Processing, and Use in Design</em> (4th ed.). CRC Press, pp. 50-95 (structures), pp. 120-165 (mechanical properties).
                </li>
                <li>
                    <strong>Pymatgen Documentation (2024).</strong> Available at: <a href="https://pymatgen.org/" target="_blank" rel="noopener">https://pymatgen.org/</a> (Python materials analysis library, Materials Project integration)
                </li>
                <li>
                    <strong>Shannon, R.D. (1976).</strong> "Revised effective ionic radii and systematic studies of interatomic distances in halides and chalcogenides." <em>Acta Crystallographica A</em>, 32, 751-767. (Standard ionic radii data)
                </li>
            </ol>

            <div class="info-box">
                <strong>For Further Learning</strong>
                <ul>
                    <li>Structural analysis techniques: <em>Elements of X-ray Diffraction</em> (Cullity & Stock, 2014) - XRD principles and practice</li>
                    <li>First-principles calculations: <em>Density Functional Theory: A Practical Introduction</em> (Sholl & Steckel, 2009) - Introduction to DFT</li>
                    <li>Ceramic properties: <em>Physical Properties of Ceramics</em> (Wachtman et al., 2009) - Mechanical, thermal, and electrical properties</li>
                    <li>Database: Materials Project (<a href="https://materialsproject.org/" target="_blank" rel="noopener">https://materialsproject.org/</a>) - Free materials database</li>
                </ul>
            </div>
        </section>

        <section id="learning-objectives">
            <h2>Learning Objectives Verification Checklist</h2>

            <h3>Level 1: Fundamental Understanding</h3>
            <ul>
                <li>□ Can explain the differences between NaCl type, CsCl type, and CaF₂ type</li>
                <li>□ Can predict coordination number from radius ratio using Pauling's first rule</li>
                <li>□ Can describe characteristics of ionic and covalent bonding ceramics</li>
                <li>□ Understand the basic arrangement of perovskite structure (ABO₃)</li>
                <li>□ Can explain the difference between normal spinel and inverse spinel</li>
                <li>□ Understand the difference between zinc blende structure and wurtzite structure</li>
            </ul>

            <h3>Level 2: Practical Skills</h3>
            <ul>
                <li>□ Can generate NaCl-type and zinc blende-type structures using Pymatgen</li>
                <li>□ Can calculate density from lattice parameters</li>
                <li>□ Can predict coordination number from ionic radii data</li>
                <li>□ Can calculate Goldschmidt tolerance factor and evaluate perovskite stability</li>
                <li>□ Can simulate X-ray diffraction patterns</li>
                <li>□ Can retrieve crystal structure data from Materials Project</li>
                <li>□ Can evaluate bonding nature from c/a ratio of wurtzite structure</li>
            </ul>

            <h3>Level 3: Application Ability</h3>
            <ul>
                <li>□ Can predict structure of new compounds by applying Pauling's rules</li>
                <li>□ Understand phase transitions and structural changes of BaTiO₃ and can estimate spontaneous polarization</li>
                <li>□ Can calculate magnetic moment from inverse spinel structure of Fe₃O₄</li>
                <li>□ Can explain structure-property correlations (hardness, dielectric constant, magnetism)</li>
                <li>□ Can apply structural knowledge to real material design (refractory materials, piezoelectric elements, magnetic materials)</li>
                <li>□ Can identify structures from XRD patterns</li>
                <li>□ Can interpret results of first-principles calculations and discuss structure optimization</li>
            </ul>

            <div class="warning-box">
                <strong>Next Steps</strong>
                In Chapter 2, we will learn about defect structures in ceramics (point defects, dislocations, grain boundaries). We will understand how the ideal crystal structures learned in this chapter change in real materials and how this affects properties. In particular, phenomena such as ionic conductivity, diffusion, and sintering are closely related to defect structures.
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 MS Dojo - Materials Science Learning Platform</p>
        <p>
            <a href="https://github.com/your-repo/ms-dojo" target="_blank" rel="noopener">GitHub</a> |
            <a href="../index.html">Top Page</a> |
            <a href="index.html">Series Index</a>
        </p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script>
        // Mermaid initialization
        mermaid.initialize({ startOnLoad: true, theme: 'default' });

        // Smooth scrolling for navigation links
        document.querySelectorAll('nav a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>
