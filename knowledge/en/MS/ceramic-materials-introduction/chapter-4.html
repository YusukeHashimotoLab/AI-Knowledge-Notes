<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 4: 機能性セラミックス - セラミックス材料入門 - MS Dojo</title>
    <meta name="description" content="誘電体、圧電、イオン伝導、発光、磁性セラミックスの原理と応用をPythonで学ぶ。">

    <!-- Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <!-- MathJax for mathematical expressions -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        :root {
            --accent-pink: #f093fb;
            --accent-coral: #f5576c;
            --primary-dark: #2c3e50;
            --secondary-dark: #34495e;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --bg-light: #ecf0f1;
            --white: #ffffff;
            --code-bg: #2d2d2d;
            --border-light: #bdc3c7;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.8;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        header {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
            padding: 3rem 1.5rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        nav {
            background: var(--white);
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
        }

        nav a {
            text-decoration: none;
            color: var(--text-dark);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            font-weight: 500;
        }

        nav a:hover {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        section {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-dark);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--accent-pink), var(--accent-coral)) 1;
        }

        h3 {
            color: var(--secondary-dark);
            font-size: 1.4rem;
            margin: 2rem 0 1rem;
        }

        h4 {
            color: var(--secondary-dark);
            font-size: 1.2rem;
            margin: 1.5rem 0 1rem;
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            border-left: 4px solid var(--accent-coral);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box strong {
            color: var(--accent-coral);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .warning-box {
            background: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box strong {
            color: var(--warning);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .exercise-box {
            background: rgba(39, 174, 96, 0.05);
            border: 2px solid var(--success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .exercise-box h4 {
            color: var(--success);
            margin-top: 0;
        }

        .difficulty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .difficulty.easy {
            background: #d4edda;
            color: #155724;
        }

        .difficulty.medium {
            background: #fff3cd;
            color: #856404;
        }

        .difficulty.hard {
            background: #f8d7da;
            color: #721c24;
        }

        .mermaid {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }

        th {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(240, 147, 251, 0.05);
        }

        footer {
            background: var(--primary-dark);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        footer a {
            color: var(--accent-pink);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--accent-coral);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5rem;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            section {
                padding: 1.5rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }
        }
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>
</head>
<body>
        <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AI Terakoya Home</a><span class="breadcrumb-separator">›</span><a href="../../MS/index.html">Materials Science</a><span class="breadcrumb-separator">›</span><a href="../../MS/ceramic-materials-introduction/index.html">Ceramic Materials</a><span class="breadcrumb-separator">›</span><span class="breadcrumb-current">Chapter 4</span>
        </div>
    </nav>

    <header>
        <h1>Chapter 4: 機能性セラミックス</h1>
        <p>誘電体、圧電、イオン伝導、発光、磁性セラミックスの原理と応用</p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">トップ</a></li>
            <li><a href="#intro">概要</a></li>
            <li><a href="#dielectric">誘電体</a></li>
            <li><a href="#piezoelectric">圧電</a></li>
            <li><a href="#ionic">イオン伝導</a></li>
            <li><a href="#luminescence">発光材料</a></li>
            <li><a href="#magnetic">磁性</a></li>
            <li><a href="#exercises">演習問題</a></li>
            <li><a href="#references">参考文献</a></li>
            <li><a href="chapter-3.html">← 前の章</a></li>
            <li><a href="chapter-5.html">次の章へ →</a></li>
        </ul>
    </nav>

    <main>
        <section id="intro">
            <h2>4.1 機能性セラミックスの概要</h2>

            <p>
                機能性セラミックスは、<strong>誘電性、圧電性、イオン伝導性、発光性、磁性</strong>などの電気的・光学的・磁気的性質を利用する材料群です。これらはコンデンサ、センサ、固体電解質、LED蛍光体、磁性デバイスとして広く応用されています。本章では、各機能の物理的メカニズムを学び、Pythonで特性calculationをpracticeします。
            </p>

            <div class="info-box">
                <strong>本章のLearning Objectives</strong>
                <ul>
                    <li><strong>レベル1（基本理解）</strong>: 誘電率、圧電定数、イオン伝導度の定義をDescriptionでき、代表材料と応用understandできる</li>
                    <li><strong>レベル2（practiceスキル）</strong>: Pythonで誘電率calculation、圧電応答シミュレーション、Arrheniusプロットを実行できる</li>
                    <li><strong>レベル3（応用力）</strong>: 実測データから材料定数を抽出し、デバイス設計に応用できる。相図と組成の最適化able to</li>
                </ul>
            </div>

            <h3>機能性セラミックスのmin類</h3>

            <div class="mermaid">
            flowchart TD
                A[機能性セラミックス] --> B[誘電体材料]
                A --> C[圧電・焦電材料]
                A --> D[イオン伝導体]
                A --> E[光機能材料]
                A --> F[磁性材料]

                B --> B1[BaTiO₃<br/>MLCC]
                B --> B2[高誘電率材料<br/>εᵣ > 1000]

                C --> C1[PZT<br/>アクチュエータ]
                C --> C2[AlN<br/>高周波フィルタ]

                D --> D1[YSZ<br/>SOFC電解質]
                D --> D2[Li系<br/>全固体電池]

                E --> E1[蛍光体<br/>LED, PDP]
                E --> E2[レーザー<br/>YAG:Nd]

                F --> F1[フェライト<br/>磁性コア]
                F --> F2[磁性ガーネット<br/>光アイソレータ]

                style A fill:#f093fb,color:#fff
                style B fill:#e3f2fd
                style C fill:#fff3e0
                style D fill:#e8f5e9
                style E fill:#fce4ec
                style F fill:#f3e5f5
            </flowchart>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>機能</th>
                        <th>代表材料</th>
                        <th>特性パラメータ</th>
                        <th>主要応用</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>誘電体</td>
                        <td>BaTiO₃, (Ba,Sr)TiO₃</td>
                        <td>誘電率 εᵣ = 1000-10000</td>
                        <td>MLCC, メモリ</td>
                    </tr>
                    <tr>
                        <td>圧電体</td>
                        <td>PZT, BaTiO₃, AlN</td>
                        <td>圧電定数 d₃₃ = 100-600 pC/N</td>
                        <td>超音波センサ、振動子</td>
                    </tr>
                    <tr>
                        <td>イオン伝導体</td>
                        <td>YSZ, LLZO, β-Al₂O₃</td>
                        <td>伝導度 σ = 0.01-1 S/cm</td>
                        <td>SOFC, 全固体電池</td>
                    </tr>
                    <tr>
                        <td>発光体</td>
                        <td>Y₃Al₅O₁₂:Ce (YAG:Ce)</td>
                        <td>量子効率 > 90%</td>
                        <td>白色LED蛍光体</td>
                    </tr>
                    <tr>
                        <td>磁性体</td>
                        <td>NiFe₂O₄, BaFe₁₂O₁₉</td>
                        <td>飽和磁化 Ms = 0.3-0.6 T</td>
                        <td>トランス、モーター</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="dielectric">
            <h2>4.2 誘電体セラミックス</h2>

            <h3>4.2.1 誘電min極のメカニズム</h3>

            <p>
                誘電体に電場を印加すると、以下の4種類のmin極が生じます：
            </p>

            <ol>
                <li><strong>電子min極</strong>: 電子雲の変位（全材料、~10<sup>15</sup> Hz）</li>
                <li><strong>イオンmin極</strong>: イオンの相対変位（赤外域、~10<sup>13</sup> Hz）</li>
                <li><strong>配向min極</strong>: 永久双極子の回転（マイクロ波域、~10<sup>9</sup> Hz）</li>
                <li><strong>界面min極</strong>: 界面での電荷蓄積（低周波、~10<sup>3</sup> Hz）</li>
            </ol>

            <p>
                誘電率 \( \epsilon_r \) は真空誘電率 \( \epsilon_0 = 8.854 \times 10^{-12} \) F/m に対する比で定義されます：
            </p>

            <p>
                \[
                \epsilon_r = \frac{\epsilon}{\epsilon_0}
                \]
            </p>

            <h3>4.2.2 BaTiO₃の強誘電性</h3>

            <p>
                BaTiO₃は、キュリー温度（T<sub>c</sub> ≈ 120°C）以下で正方晶に相転移し、自発min極を持ちます。この強誘電性により、誘電率が10,000を超える高い値を示します。
            </p>

            <h4>Python実装: Clausius-Mossotti式による誘電率calculation</h4>

            <pre><code class="language-python"># ===================================
# Example 1: Clausius-Mossotti誘電率calculation
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def clausius_mossotti_permittivity(alpha, N, epsilon_0=8.854e-12):
    """
    Clausius-Mossotti式による誘電率のcalculation

    Parameters:
    -----------
    alpha : float
        min極率 [C·m²/V]
    N : float
        単位体積あたりのatom数 [m^-3]
    epsilon_0 : float
        真空誘電率 [F/m]

    Returns:
    --------
    epsilon_r : float
        比誘電率（無次元）
    """
    # Clausius-Mossotti式: (εᵣ - 1)/(εᵣ + 2) = N·α/(3ε₀)
    # 変形: εᵣ = (1 + 2·N·α/(3ε₀)) / (1 - N·α/(3ε₀))

    numerator = 1 + 2 * N * alpha / (3 * epsilon_0)
    denominator = 1 - N * alpha / (3 * epsilon_0)

    epsilon_r = numerator / denominator

    return epsilon_r


def curie_weiss_law(T, T_c=393, C=1.5e5):
    """
    Curie-Weiss則による誘電率の温度依存性

    Parameters:
    -----------
    T : float or array
        温度 [K]
    T_c : float
        キュリー温度 [K] (BaTiO₃ ≈ 120°C = 393K)
    C : float
        Curie定数 [K]

    Returns:
    --------
    epsilon_r : float or array
        比誘電率
    """
    # Curie-Weiss則: εᵣ = C / (T - Tᶜ)
    epsilon_r = C / np.abs(T - T_c)

    # 発散を避けるため、最大値を制限
    epsilon_r = np.minimum(epsilon_r, 20000)

    return epsilon_r


def plot_dielectric_properties():
    """
    誘電体の特性をvisualization
    """
    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # 左図: min極率と誘電率の関係
    ax1 = axes[0]

    # 典型的な材料のmin極率範囲
    alpha_range = np.linspace(1e-40, 5e-40, 100)  # C·m²/V
    N = 5e28  # m^-3 (典型的なイオン密度)

    epsilon_r_values = [clausius_mossotti_permittivity(alpha, N) for alpha in alpha_range]

    ax1.plot(alpha_range * 1e40, epsilon_r_values, linewidth=2, color='navy')

    # 代表的な材料をプロット
    materials = {
        'SiO₂': {'alpha': 3.5e-41, 'epsilon_r': 3.8},
        'Al₂O₃': {'alpha': 1.0e-40, 'epsilon_r': 9.0},
        'TiO₂': {'alpha': 2.5e-40, 'epsilon_r': 80},
        'BaTiO₃': {'alpha': 4.5e-40, 'epsilon_r': 1200}
    }

    for name, props in materials.items():
        ax1.scatter(props['alpha'] * 1e40, props['epsilon_r'],
                   s=150, edgecolors='black', linewidth=2, zorder=5)
        ax1.annotate(name, (props['alpha'] * 1e40, props['epsilon_r']),
                    xytext=(5, 5), textcoords='offset points', fontsize=10)

    ax1.set_xlabel('Polarizability α (10^-40 C·m²/V)', fontsize=12)
    ax1.set_ylabel('Relative Permittivity εᵣ', fontsize=12)
    ax1.set_title('Clausius-Mossotti Relation', fontsize=14, fontweight='bold')
    ax1.grid(True, alpha=0.3)

    # 右図: BaTiO₃のCurie-Weiss則
    ax2 = axes[1]

    T_range = np.linspace(293, 493, 500)  # 20°C ~ 220°C
    T_c = 393  # 120°C

    epsilon_r_bto = curie_weiss_law(T_range, T_c, C=1.5e5)

    ax2.plot(T_range - 273.15, epsilon_r_bto, linewidth=2, color='crimson')
    ax2.axvline(x=T_c - 273.15, color='blue', linestyle='--', linewidth=2,
                label=f'Curie temperature = {T_c-273.15:.0f}°C')

    ax2.set_xlabel('Temperature (°C)', fontsize=12)
    ax2.set_ylabel('Relative Permittivity εᵣ', fontsize=12)
    ax2.set_title('BaTiO₃ Curie-Weiss Behavior', fontsize=14, fontweight='bold')
    ax2.set_ylim(0, 20000)
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('dielectric_properties.png', dpi=300, bbox_inches='tight')
    plt.show()

    # 数値例
    print("=== Clausius-Mossotti Calculation ===")
    for name, props in materials.items():
        calculated_eps = clausius_mossotti_permittivity(props['alpha'], N)
        print(f"{name:10s}: α = {props['alpha']*1e40:.2f}×10^-40, εᵣ = {calculated_eps:.1f} (exp: {props['epsilon_r']})")

    print("\n=== BaTiO₃ Temperature Dependence ===")
    for T_celsius in [80, 100, 120, 140, 160]:
        T = T_celsius + 273.15
        eps = curie_weiss_law(T, T_c=393, C=1.5e5)
        print(f"T = {T_celsius:3d}°C → εᵣ = {eps:6.0f}")

# 実行
plot_dielectric_properties()
</code></pre>

            <h3>4.2.3 MLCC（積層セラミックコンデンサ）の設計</h3>

            <p>
                MLCCは、誘電体層と内部電極を交互に積層した構造で、高容量化を実現しています。容量Cは：
            </p>

            <p>
                \[
                C = \frac{\epsilon_0 \epsilon_r A}{d} \times n
                \]
            </p>

            <p>
                ここで、\( A \) は電極面積、\( d \) は誘電体層厚み、\( n \) は層数です。
            </p>

            <h4>Python実装: MLCCキャパシタンス設計calculation</h4>

            <pre><code class="language-python"># ===================================
# Example 2: MLCCキャパシタンス設計
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def mlcc_capacitance(epsilon_r, A, d, n, epsilon_0=8.854e-12):
    """
    MLCC（積層セラミックコンデンサ）の容量calculation

    Parameters:
    -----------
    epsilon_r : float
        比誘電率
    A : float
        電極面積 [m²]
    d : float
        誘電体層厚み [m]
    n : int
        積層数
    epsilon_0 : float
        真空誘電率 [F/m]

    Returns:
    --------
    C : float
        容量 [F]
    """
    C = (epsilon_0 * epsilon_r * A / d) * n
    return C


def design_mlcc_optimization():
    """
    MLCC設計の最適化シミュレーション
    """
    # 設計パラメータ
    epsilon_r = 3000  # X7R材料（BaTiO₃系）
    A = (1e-3)**2  # 1mm × 1mm
    d_range = np.linspace(1e-6, 50e-6, 100)  # 1~50 μm
    n = 100  # 100層

    # 容量calculation
    C_values = [mlcc_capacitance(epsilon_r, A, d, n) for d in d_range]

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # 左図: 層厚みと容量の関係
    ax1 = axes[0]
    ax1.plot(d_range * 1e6, np.array(C_values) * 1e6, linewidth=2, color='navy')
    ax1.axhline(y=1, color='red', linestyle='--', alpha=0.5, label='Target: 1 μF')

    ax1.set_xlabel('Dielectric Layer Thickness (μm)', fontsize=12)
    ax1.set_ylabel('Capacitance (μF)', fontsize=12)
    ax1.set_title('MLCC Capacitance vs Layer Thickness', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # 右図: 積層数の影響
    ax2 = axes[1]
    d_fixed = 5e-6  # 5 μm
    n_range = np.arange(10, 501, 10)
    C_vs_n = [mlcc_capacitance(epsilon_r, A, d_fixed, n) for n in n_range]

    ax2.plot(n_range, np.array(C_vs_n) * 1e6, linewidth=2, color='green')

    ax2.set_xlabel('Number of Layers n', fontsize=12)
    ax2.set_ylabel('Capacitance (μF)', fontsize=12)
    ax2.set_title(f'MLCC Capacitance vs Layer Count (d = {d_fixed*1e6} μm)', fontsize=14, fontweight='bold')
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('mlcc_design.png', dpi=300, bbox_inches='tight')
    plt.show()

    # 設計例
    print("=== MLCC Design Examples ===")
    designs = [
        {'name': 'Low-C (1 nF)', 'd': 20e-6, 'n': 10},
        {'name': 'Mid-C (100 nF)', 'd': 10e-6, 'n': 50},
        {'name': 'High-C (1 μF)', 'd': 5e-6, 'n': 200},
        {'name': 'Ultra-C (10 μF)', 'd': 2e-6, 'n': 500}
    ]

    for design in designs:
        C = mlcc_capacitance(epsilon_r, A, design['d'], design['n'])
        volume = A * design['d'] * design['n']
        density = C / volume  # F/m³
        print(f"{design['name']:20s}: d={design['d']*1e6:4.1f} μm, n={design['n']:3d} → C={C*1e6:8.2f} μF, density={density*1e-9:.2f} μF/mm³")

# 実行
design_mlcc_optimization()
</code></pre>

            <div class="info-box">
                <strong>MLCCの薄層化トレンド</strong>
                現代のMLCCでは、誘電体層厚みが1 μm以下（先端品では0.5 μm）まで薄層化されています。これにより、1608サイズ（1.6 mm × 0.8 mm）で10 μFを超える高容量を実現しています。薄層化には、均一な誘電体スラリーとナノ粒子原料が不可欠です。
            </div>
        </section>

        <section id="piezoelectric">
            <h2>4.3 圧電セラミックス</h2>

            <h3>4.3.1 圧電効果の原理</h3>

            <p>
                圧電効果は、機械的応力により電荷が発生する現象（正圧電効果）と、電場印加により歪みが生じる現象（逆圧電効果）です。結晶構造の非対称性が必要で、32種の結晶点群のうち20種が圧電性を示します。
            </p>

            <p>
                圧電定数 \( d_{33} \) は、電場方向と応力方向が平行な場合の歪み（または電荷）を表します：
            </p>

            <p>
                \[
                S_3 = d_{33} E_3 \quad \text{（逆圧電効果）}
                \]
                \[
                D_3 = d_{33} T_3 \quad \text{（正圧電効果）}
                \]
            </p>

            <p>
                ここで、\( S \) は歪み、\( E \) は電場、\( D \) は電束密度、\( T \) は応力です。
            </p>

            <h3>4.3.2 PZT（チタン酸ジルコン酸鉛）の特性</h3>

            <p>
                PZT（Pb(Zr<sub>x</sub>Ti<sub>1-x</sub>)O₃）は、最も広く使われる圧電材料です。MPB（Morphotropic Phase Boundary、x ≈ 0.52）組成で圧電特性が最大となります。
            </p>

            <table>
                <thead>
                    <tr>
                        <th>材料</th>
                        <th>d₃₃ (pC/N)</th>
                        <th>k<sub>p</sub></th>
                        <th>用途</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>BaTiO₃</td>
                        <td>190</td>
                        <td>0.36</td>
                        <td>初期圧電素子</td>
                    </tr>
                    <tr>
                        <td>PZT-4</td>
                        <td>289</td>
                        <td>0.58</td>
                        <td>センサ</td>
                    </tr>
                    <tr>
                        <td>PZT-5H</td>
                        <td>593</td>
                        <td>0.65</td>
                        <td>アクチュエータ</td>
                    </tr>
                    <tr>
                        <td>AlN</td>
                        <td>5.5</td>
                        <td>0.20</td>
                        <td>高周波フィルタ</td>
                    </tr>
                </tbody>
            </table>

            <h4>Python実装: 圧電定数と結合係数のcalculation</h4>

            <pre><code class="language-python"># ===================================
# Example 3: 圧電定数と結合係数のcalculation
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def piezoelectric_strain(d_33, E_3):
    """
    逆圧電効果による歪みのcalculation

    Parameters:
    -----------
    d_33 : float
        圧電定数 [m/V] または [C/N]
    E_3 : float
        電場 [V/m]

    Returns:
    --------
    S_3 : float
        歪み（無次元）
    """
    S_3 = d_33 * E_3
    return S_3


def electromechanical_coupling_factor(d_33, epsilon_33, s_33):
    """
    電気機械結合係数のcalculation

    Parameters:
    -----------
    d_33 : float
        圧電定数 [C/N]
    epsilon_33 : float
        誘電率 [F/m]
    s_33 : float
        弾性コンプライアンス [m²/N]

    Returns:
    --------
    k_33 : float
        結合係数（無次元、0~1）
    """
    k_33 = d_33 / np.sqrt(epsilon_33 * s_33)
    return k_33


def plot_piezoelectric_response():
    """
    圧電応答のvisualization
    """
    # PZT-5Hの物性値
    d_33 = 593e-12  # C/N
    epsilon_0 = 8.854e-12
    epsilon_r = 3400
    epsilon_33 = epsilon_0 * epsilon_r

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # 左図: 電場-歪み関係（逆圧電効果）
    ax1 = axes[0]
    E_range = np.linspace(-2e6, 2e6, 500)  # -2 ~ +2 MV/m
    strain = piezoelectric_strain(d_33, E_range)

    ax1.plot(E_range / 1e6, strain * 1e6, linewidth=2, color='navy')
    ax1.axhline(y=0, color='black', linestyle='-', linewidth=0.5)
    ax1.axvline(x=0, color='black', linestyle='-', linewidth=0.5)

    ax1.set_xlabel('Electric Field E₃ (MV/m)', fontsize=12)
    ax1.set_ylabel('Strain S₃ (μstrain)', fontsize=12)
    ax1.set_title('Converse Piezoelectric Effect (PZT-5H)', fontsize=14, fontweight='bold')
    ax1.grid(True, alpha=0.3)

    # 右図: 材料比較（圧電定数と結合係数）
    ax2 = axes[1]

    materials_piezo = {
        'BaTiO₃': {'d33': 190e-12, 'epsilon_r': 1700, 's33': 8.3e-12},
        'PZT-4': {'d33': 289e-12, 'epsilon_r': 1300, 's33': 12.3e-12},
        'PZT-5H': {'d33': 593e-12, 'epsilon_r': 3400, 's33': 16.5e-12},
        'PVDF': {'d33': 33e-12, 'epsilon_r': 12, 's33': 400e-12},
        'AlN': {'d33': 5.5e-12, 'epsilon_r': 9, 's33': 3.0e-12}
    }

    names = list(materials_piezo.keys())
    d33_values = [props['d33'] * 1e12 for props in materials_piezo.values()]
    k33_values = []

    for props in materials_piezo.values():
        epsilon = epsilon_0 * props['epsilon_r']
        k33 = electromechanical_coupling_factor(props['d33'], epsilon, props['s33'])
        k33_values.append(k33)

    x = np.arange(len(names))
    width = 0.35

    ax2.bar(x - width/2, d33_values, width, label='d₃₃ (pC/N)', color='skyblue', edgecolor='black')
    ax2_twin = ax2.twinx()
    ax2_twin.bar(x + width/2, k33_values, width, label='k₃₃', color='salmon', edgecolor='black')

    ax2.set_xlabel('Material', fontsize=12)
    ax2.set_ylabel('Piezoelectric Constant d₃₃ (pC/N)', fontsize=12, color='skyblue')
    ax2_twin.set_ylabel('Coupling Coefficient k₃₃', fontsize=12, color='salmon')
    ax2.set_title('Piezoelectric Material Comparison', fontsize=14, fontweight='bold')
    ax2.set_xticks(x)
    ax2.set_xticklabels(names, rotation=15)
    ax2.tick_params(axis='y', labelcolor='skyblue')
    ax2_twin.tick_params(axis='y', labelcolor='salmon')
    ax2.grid(True, alpha=0.3, axis='y')

    plt.tight_layout()
    plt.savefig('piezoelectric_response.png', dpi=300, bbox_inches='tight')
    plt.show()

    # 数値例
    print("=== Piezoelectric Response Calculation (PZT-5H) ===")
    for E_MV in [0.5, 1.0, 2.0]:
        E = E_MV * 1e6
        S = piezoelectric_strain(d_33, E)
        displacement = S * 1e-3  # 1 mm厚さの場合
        print(f"E = {E_MV:.1f} MV/m → Strain = {S*1e6:.1f} μstrain, Displacement (1mm) = {displacement*1e9:.2f} nm")

    print("\n=== Electromechanical Coupling Coefficients ===")
    for name, props in materials_piezo.items():
        epsilon = epsilon_0 * props['epsilon_r']
        k33 = electromechanical_coupling_factor(props['d33'], epsilon, props['s33'])
        print(f"{name:10s}: d₃₃ = {props['d33']*1e12:5.1f} pC/N, k₃₃ = {k33:.3f}")

# 実行
plot_piezoelectric_response()
</code></pre>

            <h4>Python実装: PZT相図とMPB組成</h4>

            <pre><code class="language-python"># ===================================
# Example 4: PZT相図とMPB組成のvisualization
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def pzt_phase_diagram():
    """
    PZTの相図とMPB（Morphotropic Phase Boundary）のvisualization
    """
    # 組成範囲（Zr含有率）
    x_Zr = np.linspace(0, 1, 500)

    # キュリー温度の組成依存性（簡略モデル）
    T_c = 490 - 200 * x_Zr + 150 * x_Zr**2  # °C

    # 圧電定数の組成依存性（MPB付近で最大）
    # MPB組成: x ≈ 0.52
    x_MPB = 0.52
    d_33 = 200 + 400 * np.exp(-((x_Zr - x_MPB) / 0.1)**2)

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # 左図: 相図
    ax1 = axes[0]

    # 相境界の定義（簡略化）
    x_rhomb = x_Zr[x_Zr > x_MPB]
    x_tetra = x_Zr[x_Zr <= x_MPB]
    T_c_rhomb = T_c[x_Zr > x_MPB]
    T_c_tetra = T_c[x_Zr <= x_MPB]

    # 領域の塗りminけ
    ax1.fill_between(x_rhomb, 0, T_c_rhomb, alpha=0.3, color='blue', label='Rhombohedral (FE_R)')
    ax1.fill_between(x_tetra, 0, T_c_tetra, alpha=0.3, color='red', label='Tetragonal (FE_T)')
    ax1.fill_between(x_Zr, T_c, 500, alpha=0.2, color='gray', label='Cubic (Paraelectric)')

    # MPB線
    ax1.axvline(x=x_MPB, color='green', linestyle='--', linewidth=2, label=f'MPB (x = {x_MPB})')
    ax1.plot(x_Zr, T_c, 'k-', linewidth=2, label='Curie Temperature')

    ax1.set_xlabel('Zr Content x in Pb(Zr_xTi_{1-x})O₃', fontsize=12)
    ax1.set_ylabel('Temperature (°C)', fontsize=12)
    ax1.set_title('PZT Phase Diagram', fontsize=14, fontweight='bold')
    ax1.set_xlim(0, 1)
    ax1.set_ylim(0, 500)
    ax1.legend(loc='upper right')
    ax1.grid(True, alpha=0.3)

    # 右図: 圧電定数の組成依存性
    ax2 = axes[1]
    ax2.plot(x_Zr, d_33, linewidth=2, color='navy')
    ax2.axvline(x=x_MPB, color='green', linestyle='--', linewidth=2, label=f'MPB (x = {x_MPB})')
    ax2.scatter([x_MPB], [np.max(d_33)], s=200, c='red', marker='*', edgecolors='black',
                linewidth=2, zorder=5, label=f'd₃₃ max = {np.max(d_33):.0f} pC/N')

    ax2.set_xlabel('Zr Content x in Pb(Zr_xTi_{1-x})O₃', fontsize=12)
    ax2.set_ylabel('Piezoelectric Constant d₃₃ (pC/N)', fontsize=12)
    ax2.set_title('PZT Piezoelectric Constant vs Composition', fontsize=14, fontweight='bold')
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('pzt_phase_diagram.png', dpi=300, bbox_inches='tight')
    plt.show()

    # 数値例
    print("=== PZT Composition Effects ===")
    compositions = [0.3, 0.4, 0.52, 0.6, 0.7]
    for x in compositions:
        idx = np.argmin(np.abs(x_Zr - x))
        T_c_val = T_c[idx]
        d_33_val = d_33[idx]
        phase = 'Tetragonal' if x < x_MPB else 'Rhombohedral'
        print(f"x = {x:.2f} ({phase:15s}): T_c = {T_c_val:5.1f}°C, d₃₃ = {d_33_val:5.0f} pC/N")

# 実行
pzt_phase_diagram()
</code></pre>

            <div class="warning-box">
                <strong>鉛フリー圧電材料の開発</strong>
                PZTは高性能ですが、鉛（Pb）の環境負荷が問題です。近年、(K,Na)NbO₃（KNN）、(Bi,Na)TiO₃（BNT）などの鉛フリー材料が研究されていますが、PZTの性能（d₃₃ ≈ 600 pC/N）に到達するには至っていません（KNN: ~300 pC/N）。
            </div>
        </section>

        <section id="ionic">
            <h2>4.4 イオン伝導体セラミックス</h2>

            <h3>4.4.1 イオン伝導のメカニズム</h3>

            <p>
                イオン伝導体では、イオン（O²⁻, Li⁺, Na⁺など）が結晶格子中を移動します。伝導度 \( \sigma \) は、Arrhenius式で表されます：
            </p>

            <p>
                \[
                \sigma = \sigma_0 \exp\left(-\frac{E_a}{k_B T}\right)
                \]
            </p>

            <p>
                ここで、\( \sigma_0 \) は前指数因子、\( E_a \) は活性化エネルギー、\( k_B \) はボルツマン定数、\( T \) は温度です。
            </p>

            <h3>4.4.2 YSZ（イットリア安定化ジルコニア）</h3>

            <p>
                YSZ（(Y₂O₃)<sub>x</sub>(ZrO₂)<sub>1-x</sub>）は、SOFC（固体酸化物形燃料電池）の電解質として使われます。Y³⁺ドープにより酸素空孔が生成され、O²⁻イオンが伝導します。
            </p>

            <table>
                <thead>
                    <tr>
                        <th>材料</th>
                        <th>伝導イオン</th>
                        <th>σ (S/cm) @ 800°C</th>
                        <th>E<sub>a</sub> (eV)</th>
                        <th>用途</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>YSZ (8mol% Y₂O₃)</td>
                        <td>O²⁻</td>
                        <td>0.1</td>
                        <td>1.0</td>
                        <td>SOFC電解質</td>
                    </tr>
                    <tr>
                        <td>LLZO (Li₇La₃Zr₂O₁₂)</td>
                        <td>Li⁺</td>
                        <td>0.05 (室温)</td>
                        <td>0.3</td>
                        <td>全固体電池</td>
                    </tr>
                    <tr>
                        <td>β-Al₂O₃</td>
                        <td>Na⁺</td>
                        <td>0.2 (300°C)</td>
                        <td>0.16</td>
                        <td>Na-S電池</td>
                    </tr>
                    <tr>
                        <td>GDC (Ce₀.₉Gd₀.₁O₁.₉₅)</td>
                        <td>O²⁻</td>
                        <td>0.02</td>
                        <td>0.7</td>
                        <td>低温SOFC</td>
                    </tr>
                </tbody>
            </table>

            <h4>Python実装: Arrhenius伝導度と活性化エネルギー</h4>

            <pre><code class="language-python"># ===================================
# Example 5: Arrhenius伝導度calculation
# ===================================

import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def ionic_conductivity(T, sigma_0, E_a, k_B=8.617e-5):
    """
    Arrhenius式によるイオン伝導度のcalculation

    Parameters:
    -----------
    T : float or array
        温度 [K]
    sigma_0 : float
        前指数因子 [S/cm]
    E_a : float
        活性化エネルギー [eV]
    k_B : float
        ボルツマン定数 [eV/K]

    Returns:
    --------
    sigma : float or array
        イオン伝導度 [S/cm]
    """
    sigma = sigma_0 * np.exp(-E_a / (k_B * T))
    return sigma


def fit_arrhenius_data(T_data, sigma_data):
    """
    実測データからArrhenius パラメータをフィッティング

    Parameters:
    -----------
    T_data : array
        温度データ [K]
    sigma_data : array
        伝導度データ [S/cm]

    Returns:
    --------
    sigma_0 : float
        前指数因子 [S/cm]
    E_a : float
        活性化エネルギー [eV]
    """
    # 対数変換: ln(σ) = ln(σ₀) - E_a/(k_B·T)
    # y = ln(σ), x = 1/T, slope = -E_a/k_B, intercept = ln(σ₀)

    x = 1 / T_data
    y = np.log(sigma_data)

    # 線形回帰
    coeffs = np.polyfit(x, y, 1)
    slope = coeffs[0]
    intercept = coeffs[1]

    E_a = -slope * 8.617e-5  # eV
    sigma_0 = np.exp(intercept)

    return sigma_0, E_a


def plot_ionic_conductivity():
    """
    イオン伝導度のArrhenius plotと材料比較
    """
    # 各材料のパラメータ
    materials_ionic = {
        'YSZ (8YSZ)': {'sigma_0': 2.5e4, 'E_a': 1.0, 'color': 'navy'},
        'GDC': {'sigma_0': 1.0e4, 'E_a': 0.7, 'color': 'green'},
        'LLZO': {'sigma_0': 1.0e2, 'E_a': 0.3, 'color': 'red'},
        'β-Al₂O₃': {'sigma_0': 5.0e2, 'E_a': 0.16, 'color': 'purple'}
    }

    # 温度範囲
    T_range = np.linspace(300, 1200, 500)  # K

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # 左図: Arrhenius plot
    ax1 = axes[0]

    for name, params in materials_ionic.items():
        sigma = ionic_conductivity(T_range, params['sigma_0'], params['E_a'])
        ax1.semilogy(1e4 / T_range, sigma, linewidth=2, label=name, color=params['color'])

    ax1.set_xlabel('10^4 / T (K^-1)', fontsize=12)
    ax1.set_ylabel('Ionic Conductivity σ (S/cm)', fontsize=12)
    ax1.set_title('Arrhenius Plot for Ionic Conductors', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3, which='both')

    # 右図: 実温度での伝導度比較
    ax2 = axes[1]

    temperatures_celsius = [400, 600, 800, 1000]
    x_pos = np.arange(len(temperatures_celsius))
    width = 0.2

    for i, (name, params) in enumerate(materials_ionic.items()):
        sigma_values = [ionic_conductivity(T + 273.15, params['sigma_0'], params['E_a'])
                       for T in temperatures_celsius]
        ax2.bar(x_pos + i * width, sigma_values, width, label=name, color=params['color'], edgecolor='black')

    ax2.set_xlabel('Temperature (°C)', fontsize=12)
    ax2.set_ylabel('Ionic Conductivity σ (S/cm)', fontsize=12)
    ax2.set_title('Conductivity Comparison at Different Temperatures', fontsize=14, fontweight='bold')
    ax2.set_xticks(x_pos + width * 1.5)
    ax2.set_xticklabels(temperatures_celsius)
    ax2.set_yscale('log')
    ax2.legend()
    ax2.grid(True, alpha=0.3, which='both')

    plt.tight_layout()
    plt.savefig('ionic_conductivity.png', dpi=300, bbox_inches='tight')
    plt.show()

    # 数値例
    print("=== Ionic Conductivity at SOFC Operating Temperature (800°C) ===")
    T_SOFC = 800 + 273.15
    for name, params in materials_ionic.items():
        sigma = ionic_conductivity(T_SOFC, params['sigma_0'], params['E_a'])
        print(f"{name:15s}: σ = {sigma:.4f} S/cm, E_a = {params['E_a']:.2f} eV")

# 実行
plot_ionic_conductivity()
</code></pre>

            <h4>Python実装: YSZイオン伝導度の温度依存性</h4>

            <pre><code class="language-python"># ===================================
# Example 6: YSZ伝導度の詳細analysis
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def ysz_conductivity_vs_doping():
    """
    YSZのY₂O₃ドープ量と伝導度の関係
    """
    # Y₂O₃ドープ量（mol%）
    doping_levels = np.array([3, 5, 8, 10, 12, 15])

    # 800°Cでの伝導度（実験データに基づく）
    sigma_800C = np.array([0.02, 0.06, 0.10, 0.08, 0.05, 0.03])

    # 活性化エネルギー
    E_a_values = np.array([1.1, 1.05, 1.0, 1.05, 1.15, 1.2])

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # 左図: ドープ量と伝導度
    ax1 = axes[0]
    ax1.plot(doping_levels, sigma_800C, 'o-', linewidth=2, markersize=10, color='navy')
    ax1.axvline(x=8, color='red', linestyle='--', linewidth=2, label='Optimal: 8 mol%')

    ax1.set_xlabel('Y₂O₃ Content (mol%)', fontsize=12)
    ax1.set_ylabel('Ionic Conductivity σ (S/cm) @ 800°C', fontsize=12)
    ax1.set_title('YSZ Conductivity vs Doping Level', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # 右図: 温度依存性（各ドープ量）
    ax2 = axes[1]
    T_range = np.linspace(600, 1200, 100) + 273.15

    for i, doping in enumerate([5, 8, 10]):
        idx = np.where(doping_levels == doping)[0][0]
        sigma_0_calc = sigma_800C[idx] / np.exp(-E_a_values[idx] / (8.617e-5 * (800 + 273.15)))
        sigma_T = ionic_conductivity(T_range, sigma_0_calc, E_a_values[idx])

        ax2.semilogy(T_range - 273.15, sigma_T, linewidth=2, label=f'{doping} mol% Y₂O₃')

    ax2.set_xlabel('Temperature (°C)', fontsize=12)
    ax2.set_ylabel('Ionic Conductivity σ (S/cm)', fontsize=12)
    ax2.set_title('YSZ Conductivity vs Temperature', fontsize=14, fontweight='bold')
    ax2.legend()
    ax2.grid(True, alpha=0.3, which='both')

    plt.tight_layout()
    plt.savefig('ysz_conductivity_analysis.png', dpi=300, bbox_inches='tight')
    plt.show()

    # 数値例
    print("=== YSZ Doping Level Effects ===")
    for i, doping in enumerate(doping_levels):
        print(f"{doping:2d} mol% Y₂O₃: σ(800°C) = {sigma_800C[i]:.3f} S/cm, E_a = {E_a_values[i]:.2f} eV")

# 実行
ysz_conductivity_vs_doping()
</code></pre>

            <div class="info-box">
                <strong>SOFCの動作原理とYSZの役割</strong>
                SOFC（固体酸化物形燃料電池）では、YSZ電解質を介してO²⁻イオンが陰極から陽極へ移動し、水素と反応して水を生成します。800-1000°Cの高温動作により、0.1 S/cm以上の伝導度が得られ、高効率発電（45-60%）を実現します。
            </div>
        </section>

        <section id="luminescence">
            <h2>4.5 発光材料セラミックス</h2>

            <h3>4.5.1 蛍光体の発光メカニズム</h3>

            <p>
                蛍光体は、励起エネルギー（電子線、UV、青色LED）を吸収し、可視光を放出します。発光中心となる希土類イオン（Ce³⁺, Eu²⁺, Eu³⁺など）が、母体結晶（YAG, CaS, SrSiO₅など）中にドープされます。
            </p>

            <p>
                発光効率（量子効率）は：
            </p>

            <p>
                \[
                \eta = \frac{\text{放出光子数}}{\text{吸収光子数}} \times 100\%
                \]
            </p>

            <h3>4.5.2 白色LED用YAG:Ce蛍光体</h3>

            <p>
                YAG:Ce（Y₃Al₅O₁₂:Ce³⁺）は、青色LED（450-470 nm）で励起され、黄色光（500-650 nm）を放出します。青色光との混色により、白色光を実現します。
            </p>

            <h4>Python実装: CIE色度座標のcalculation</h4>

            <pre><code class="language-python"># ===================================
# Example 7: CIE色度座標calculation
# ===================================

import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import simpson

def gaussian_emission_spectrum(wavelength, peak, fwhm, intensity=1.0):
    """
    ガウス型発光スペクトルの生成

    Parameters:
    -----------
    wavelength : array
        波長 [nm]
    peak : float
        ピーク波長 [nm]
    fwhm : float
        半値全幅 (FWHM) [nm]
    intensity : float
        強度（任意単位）

    Returns:
    --------
    spectrum : array
        発光強度
    """
    sigma = fwhm / (2 * np.sqrt(2 * np.log(2)))
    spectrum = intensity * np.exp(-((wavelength - peak)**2) / (2 * sigma**2))
    return spectrum


def cie_xyz_from_spectrum(wavelength, spectrum):
    """
    発光スペクトルからCIE XYZ値をcalculation（簡略版）

    Parameters:
    -----------
    wavelength : array
        波長 [nm]
    spectrum : array
        発光強度

    Returns:
    --------
    X, Y, Z : float
        CIE三刺激値
    """
    # CIE 1931標準観測者の簡略モデル（実際は標準データを使用）
    # ここでは簡単のためガウス近似

    # x̄(λ): 赤錐体感度（ピーク 600 nm）
    x_bar = gaussian_emission_spectrum(wavelength, 600, 50, 1.0)

    # ȳ(λ): 緑錐体感度（ピーク 550 nm）
    y_bar = gaussian_emission_spectrum(wavelength, 550, 50, 1.0)

    # z̄(λ): 青錐体感度（ピーク 450 nm）
    z_bar = gaussian_emission_spectrum(wavelength, 450, 50, 1.0)

    # 積min
    X = simpson(spectrum * x_bar, wavelength)
    Y = simpson(spectrum * y_bar, wavelength)
    Z = simpson(spectrum * z_bar, wavelength)

    return X, Y, Z


def plot_yag_ce_emission():
    """
    YAG:Ce発光スペクトルとCIE色度座標
    """
    # 波長範囲
    wavelength = np.linspace(380, 780, 400)

    # 青色LED（励起光）
    blue_led = gaussian_emission_spectrum(wavelength, 460, 20, 1.0)

    # YAG:Ce発光（黄色）
    yag_ce_emission = gaussian_emission_spectrum(wavelength, 560, 100, 0.8)

    # 合成スペクトル（白色光）
    white_light = blue_led + yag_ce_emission

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # 左図: 発光スペクトル
    ax1 = axes[0]
    ax1.fill_between(wavelength, 0, blue_led, alpha=0.5, color='blue', label='Blue LED (460 nm)')
    ax1.fill_between(wavelength, 0, yag_ce_emission, alpha=0.5, color='yellow', label='YAG:Ce (560 nm)')
    ax1.plot(wavelength, white_light, 'k-', linewidth=2, label='White Light (combined)')

    ax1.set_xlabel('Wavelength (nm)', fontsize=12)
    ax1.set_ylabel('Intensity (a.u.)', fontsize=12)
    ax1.set_title('YAG:Ce White LED Emission Spectrum', fontsize=14, fontweight='bold')
    ax1.set_xlim(380, 780)
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # 右図: CIE 1931色度図（簡略版）
    ax2 = axes[1]

    # CIE色度座標のcalculation
    X_blue, Y_blue, Z_blue = cie_xyz_from_spectrum(wavelength, blue_led)
    x_blue = X_blue / (X_blue + Y_blue + Z_blue)
    y_blue = Y_blue / (X_blue + Y_blue + Z_blue)

    X_yellow, Y_yellow, Z_yellow = cie_xyz_from_spectrum(wavelength, yag_ce_emission)
    x_yellow = X_yellow / (X_yellow + Y_yellow + Z_yellow)
    y_yellow = Y_yellow / (X_yellow + Y_yellow + Z_yellow)

    X_white, Y_white, Z_white = cie_xyz_from_spectrum(wavelength, white_light)
    x_white = X_white / (X_white + Y_white + Z_white)
    y_white = Y_white / (X_white + Y_white + Z_white)

    # プロット
    ax2.scatter(x_blue, y_blue, s=200, c='blue', marker='o', edgecolors='black', linewidth=2, label='Blue LED')
    ax2.scatter(x_yellow, y_yellow, s=200, c='yellow', marker='s', edgecolors='black', linewidth=2, label='YAG:Ce')
    ax2.scatter(x_white, y_white, s=250, c='white', marker='*', edgecolors='black', linewidth=2, label='White Light', zorder=5)

    # 色温度線（簡略）
    blackbody_x = np.array([0.45, 0.40, 0.35, 0.31])
    blackbody_y = np.array([0.41, 0.40, 0.38, 0.33])
    ax2.plot(blackbody_x, blackbody_y, 'k--', linewidth=1, alpha=0.5, label='Blackbody Locus')

    ax2.set_xlabel('CIE x', fontsize=12)
    ax2.set_ylabel('CIE y', fontsize=12)
    ax2.set_title('CIE 1931 Chromaticity Diagram', fontsize=14, fontweight='bold')
    ax2.set_xlim(0, 0.8)
    ax2.set_ylim(0, 0.9)
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('yag_ce_emission.png', dpi=300, bbox_inches='tight')
    plt.show()

    # 数値結果
    print("=== CIE Chromaticity Coordinates ===")
    print(f"Blue LED:  (x, y) = ({x_blue:.3f}, {y_blue:.3f})")
    print(f"YAG:Ce:    (x, y) = ({x_yellow:.3f}, {y_yellow:.3f})")
    print(f"White Light: (x, y) = ({x_white:.3f}, {y_white:.3f})")
    print(f"\nColor Temperature: ~5000-6000 K (cool white)")

# 実行
plot_yag_ce_emission()
</code></pre>

            <div class="info-box">
                <strong>白色LED蛍光体の設計</strong>
                理想的な白色光（色温度5000 K、演色性Ra > 80）には、YAG:Ce単独では不十minです。赤色成minを補うため、CaAlSiN₃:Eu²⁺（窒化物赤色蛍光体）を追加することで、演色性Ra > 90を実現できます。
            </div>
        </section>

        <section id="magnetic">
            <h2>4.6 磁性セラミックス</h2>

            <h3>4.6.1 フェライトの磁性</h3>

            <p>
                フェライトは、一般式 MFe₂O₄（M = Mn, Ni, Zn, Co）で表される酸化物磁性体です。スピネル構造を持ち、フェリ磁性を示します。電気抵抗が高いため（>10⁶ Ω·cm）、高周波用途に適しています。
            </p>

            <h3>4.6.2 主要特性パラメータ</h3>

            <ul>
                <li><strong>飽和磁化 M<sub>s</sub></strong>: 最大磁化（T = テスラ）</li>
                <li><strong>保磁力 H<sub>c</sub></strong>: 磁化を反転させる磁場（A/m）</li>
                <li><strong>透磁率 μ<sub>r</sub></strong>: 磁気透過率（無次元）</li>
                <li><strong>キュリー温度 T<sub>c</sub></strong>: 強磁性→常磁性転移温度（°C）</li>
            </ul>

            <table>
                <thead>
                    <tr>
                        <th>材料</th>
                        <th>M<sub>s</sub> (T)</th>
                        <th>H<sub>c</sub> (A/m)</th>
                        <th>μ<sub>r</sub></th>
                        <th>用途</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>MnZn-ferrite</td>
                        <td>0.35</td>
                        <td>10-20</td>
                        <td>2000-5000</td>
                        <td>トランスコア</td>
                    </tr>
                    <tr>
                        <td>NiZn-ferrite</td>
                        <td>0.30</td>
                        <td>15-30</td>
                        <td>100-1000</td>
                        <td>高周波コア</td>
                    </tr>
                    <tr>
                        <td>BaFe₁₂O₁₉ (M-type)</td>
                        <td>0.48</td>
                        <td>200k-400k</td>
                        <td>1.1</td>
                        <td>永久磁石</td>
                    </tr>
                    <tr>
                        <td>CoFe₂O₄</td>
                        <td>0.53</td>
                        <td>5k-10k</td>
                        <td>10-50</td>
                        <td>磁気記録</td>
                    </tr>
                </tbody>
            </table>

            <h4>Python実装: フェライト磁化特性のシミュレーション</h4>

            <pre><code class="language-python"># ===================================
# Example 8: フェライト磁化曲線
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def langevin_function(x):
    """
    Langevin関数（常磁性の磁化）

    Parameters:
    -----------
    x : float or array
        引数 (μH/kT)

    Returns:
    --------
    L(x) : float or array
        Langevin関数の値
    """
    # 小さいxで発散を避ける
    with np.errstate(divide='ignore', invalid='ignore'):
        L = np.where(np.abs(x) < 1e-3, x / 3, 1 / np.tanh(x) - 1 / x)
    return L


def ferrite_magnetization_curve(H, M_s=0.35, H_c=15, a=1000):
    """
    フェライトの磁化曲線（簡略モデル）

    Parameters:
    -----------
    H : array
        磁場 [A/m]
    M_s : float
        飽和磁化 [T]
    H_c : float
        保磁力 [A/m]
    a : float
        形状パラメータ

    Returns:
    --------
    M : array
        磁化 [T]
    """
    # tanhベースの簡略モデル
    M = M_s * np.tanh((H - H_c) / a) if isinstance(H, (int, float)) else \
        M_s * np.tanh((H - H_c) / a)
    return M


def plot_ferrite_properties():
    """
    フェライトの磁気特性をvisualization
    """
    # 磁場範囲
    H_range = np.linspace(-5000, 5000, 1000)

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # 左図: 軟磁性フェライト（MnZn）
    ax1 = axes[0]

    M_s_soft = 0.35
    H_c_soft = 15
    M_soft = M_s_soft * np.tanh(H_range / 500)

    ax1.plot(H_range, M_soft, linewidth=2, color='navy')
    ax1.axhline(y=M_s_soft, color='red', linestyle='--', linewidth=1, alpha=0.5, label=f'M_s = {M_s_soft} T')
    ax1.axhline(y=-M_s_soft, color='red', linestyle='--', linewidth=1, alpha=0.5)
    ax1.axvline(x=0, color='black', linestyle='-', linewidth=0.5)
    ax1.axhline(y=0, color='black', linestyle='-', linewidth=0.5)

    ax1.set_xlabel('Magnetic Field H (A/m)', fontsize=12)
    ax1.set_ylabel('Magnetization M (T)', fontsize=12)
    ax1.set_title('Soft Ferrite (MnZn) M-H Curve', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # 右図: 硬磁性フェライト（BaFe₁₂O₁₉）
    ax2 = axes[1]

    M_s_hard = 0.48
    H_c_hard = 250000  # 250 kA/m
    H_hard = np.linspace(-400000, 400000, 1000)
    M_hard = M_s_hard * np.tanh((H_hard - H_c_hard) / 50000)

    # ヒステリシスループの近似
    M_hard_up = M_s_hard * np.tanh((H_hard + H_c_hard) / 50000)
    M_hard_down = M_s_hard * np.tanh((H_hard - H_c_hard) / 50000)

    ax2.plot(H_hard / 1000, M_hard_up, linewidth=2, color='blue', label='Ascending')
    ax2.plot(H_hard / 1000, M_hard_down, linewidth=2, color='red', label='Descending')
    ax2.axvline(x=H_c_hard / 1000, color='green', linestyle='--', linewidth=2, label=f'H_c = {H_c_hard/1000:.0f} kA/m')
    ax2.axvline(x=-H_c_hard / 1000, color='green', linestyle='--', linewidth=2)

    ax2.set_xlabel('Magnetic Field H (kA/m)', fontsize=12)
    ax2.set_ylabel('Magnetization M (T)', fontsize=12)
    ax2.set_title('Hard Ferrite (BaFe₁₂O₁₉) Hysteresis Loop', fontsize=14, fontweight='bold')
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('ferrite_magnetization.png', dpi=300, bbox_inches='tight')
    plt.show()

    # 数値例
    print("=== Ferrite Magnetic Properties ===")
    print("\nSoft Ferrite (MnZn):")
    print(f"  M_s = {M_s_soft} T, H_c = {H_c_soft} A/m")
    print(f"  Application: High permeability (μ_r ~ 2000-5000), transformer cores")

    print("\nHard Ferrite (BaFe₁₂O₁₉):")
    print(f"  M_s = {M_s_hard} T, H_c = {H_c_hard/1000} kA/m")
    print(f"  Application: Permanent magnets, motors, speakers")

# 実行
plot_ferrite_properties()
</code></pre>

            <div class="warning-box">
                <strong>ソフト磁性とハード磁性の用途min離</strong>
                ソフトフェライト（低H<sub>c</sub>、高μ<sub>r</sub>）は、磁化が容易に反転するため、トランスやインダクタに使用されます。一方、ハードフェライト（高H<sub>c</sub>）は、磁化が安定で永久磁石として機能します。両者は組成（Mn/Zn vs Ba/Sr）と焼結条件で制御されます。
            </div>
        </section>

        <section id="exercises">
            <h2>演習問題</h2>

            <div class="exercise-box">
                <h4>演習 4-1: Clausius-Mossotti式applications of<span class="difficulty easy">易</span></h4>
                <p>
                    TiO₂のmin極率α = 2.5×10⁻⁴⁰ C·m²/V、イオン密度N = 5×10²⁸ m⁻³のとき、比誘電率ε<sub>r</sub>をcalculationしなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">alpha = 2.5e-40
N = 5e28
epsilon_r = clausius_mossotti_permittivity(alpha, N)
print(f"εᵣ = {epsilon_r:.1f}")
# 出力: εᵣ ≈ 80
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-2: MLCC容量設計<span class="difficulty easy">易</span></h4>
                <p>
                    1 μFのMLCCを設計します。ε<sub>r</sub>=3000、電極面積1 mm²、層厚み5 μmのとき、必要な積層数nをcalculationしなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">C_target = 1e-6  # 1 μF
epsilon_r = 3000
A = (1e-3)**2
d = 5e-6
epsilon_0 = 8.854e-12

n = (C_target * d) / (epsilon_0 * epsilon_r * A)
print(f"必要な積層数 n = {n:.0f}")
# 出力: n ≈ 377層
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-3: 圧電変位のcalculation<span class="difficulty easy">易</span></h4>
                <p>
                    PZT-5H（d₃₃ = 593 pC/N）に電場1 MV/mを印加したとき、1 mm厚の試験片の変位をcalculationしなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">d_33 = 593e-12
E = 1e6
thickness = 1e-3

strain = piezoelectric_strain(d_33, E)
displacement = strain * thickness
print(f"変位 = {displacement*1e9:.1f} nm")
# 出力: 変位 ≈ 593 nm
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-4: Arrhenius活性化エネルギーの推定<span class="difficulty medium">中</span></h4>
                <p>
                    YSZの伝導度が、700°Cで0.05 S/cm、900°Cで0.15 S/cmでした。活性化エネルギーE<sub>a</sub>を求めなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">T1 = 700 + 273.15
T2 = 900 + 273.15
sigma1 = 0.05
sigma2 = 0.15
k_B = 8.617e-5

# ln(σ₂/σ₁) = -E_a/k_B × (1/T₂ - 1/T₁)
E_a = -k_B * np.log(sigma2 / sigma1) / (1/T2 - 1/T1)
print(f"E_a = {E_a:.2f} eV")
# 出力: E_a ≈ 0.95 eV
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-5: 白色LED色温度の調整<span class="difficulty medium">中</span></h4>
                <p>
                    青色LED（460 nm）とYAG:Ce（560 nm）の強度比を変えて、色温度を4000 K（温白色）から6500 K（昼白色）に調整する方法をDescriptionしなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python"># 色温度を上げる（昼白色）には、青色成minを増やす
# YAG:Ce発光強度を減らすか、YAG:Ce層を薄くする

# 4000 K: 青/黄 = 1.0
# 6500 K: 青/黄 = 1.5

print("色温度を上げるには:")
print("1. YAG:Ce蛍光体層を薄くする（黄色減少）")
print("2. YAG:Ce濃度を下げる")
print("3. 青色LED出力を上げる")
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-6: PZT組成最適化<span class="difficulty medium">中</span></h4>
                <p>
                    PZTのZr/Ti比を変えて、d₃₃が最大となる組成（MPB）を見つけるシミュレーションを実行しなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">x_Zr = np.linspace(0, 1, 100)
x_MPB = 0.52
d_33 = 200 + 400 * np.exp(-((x_Zr - x_MPB) / 0.1)**2)

max_idx = np.argmax(d_33)
print(f"最適組成: x_Zr = {x_Zr[max_idx]:.2f}")
print(f"最大d₃₃ = {d_33[max_idx]:.0f} pC/N")
# 出力: x_Zr = 0.52, d₃₃ ≈ 600 pC/N
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-7: フェライト透磁率の周波数依存性<span class="difficulty medium">中</span></h4>
                <p>
                    MnZnフェライトの透磁率が、1 kHzで3000、1 MHzで500に低下します。この周波数依存性の原因をDescriptionしなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">print("周波数依存性の原因:")
print("1. 渦電流損失（低抵抗率）")
print("2. 磁壁移動の遅延（高周波で磁壁が追従できない）")
print("3. スピン回転の共鳴（フェリ磁性共鳴周波数）")
print("\n対策: NiZnフェライト（高抵抗）への変更")
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-8: SOFC電解質の厚み最適化<span class="difficulty hard">難</span></h4>
                <p>
                    YSZ電解質の抵抗Rは、R = ρ × L / A（ρ: 抵抗率、L: 厚み、A: 面積）です。800°Cで0.1 S/cmの伝導度、10 cm²の面積のとき、抵抗を0.1 Ω以下にする最大厚みを求めなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">sigma = 0.1  # S/cm = 10 S/m
rho = 1 / sigma  # Ω·m
A = 10e-4  # m²
R_target = 0.1  # Ω

L_max = R_target * A / rho
print(f"最大厚み L = {L_max*1e6:.0f} μm")
# 出力: L ≈ 100 μm
# 実際のSOFCでは10-50 μmが一般的
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-9: 圧電エネルギーハーベスティング<span class="difficulty hard">難</span></h4>
                <p>
                    PZT素子（d₃₃ = 300 pC/N、面積10 cm²）に100 Nの荷重を周期的（10 Hz）に印加します。発生電力を推定しなさい（簡略calculation）。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">d_33 = 300e-12
F = 100  # N
A = 10e-4  # m²
f = 10  # Hz
epsilon_r = 1300
epsilon_0 = 8.854e-12

# 発生電荷 Q = d₃₃ × F
Q = d_33 * F
print(f"発生電荷 Q = {Q*1e9:.1f} nC")

# 容量 C = ε₀εᵣA/d（厚み1 mmと仮定）
d = 1e-3
C = epsilon_0 * epsilon_r * A / d
V = Q / C
print(f"電圧 V = {V:.1f} V")

# 電力 P = 0.5 × C × V² × f
P = 0.5 * C * V**2 * f
print(f"電力 P = {P*1e6:.1f} μW")
# 出力例: ~10-100 μW（実用レベルは mW必要）
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>演習 4-10: 多層構造蛍光体の設計<span class="difficulty hard">難</span></h4>
                <p>
                    高演色性白色LED（Ra > 90）を実現するため、YAG:Ce（黄）とCaAlSiN₃:Eu（赤）の2層蛍光体を設計します。各層の厚み比と発光強度比を最適化する方針を述べなさい。
                </p>
                <details>
                    <summary>解答例</summary>
                    <pre><code class="language-python">print("設計方針:")
print("1. YAG:Ce層（黄）: 青色LED励起で550 nm発光")
print("2. CaAlSiN₃:Eu層（赤）: 青色励起で630 nm発光")
print("3. 厚み比: YAG:Ce = 80%, 赤蛍光体 = 20%")
print("4. 発光強度比: 青:黄:赤 = 30:50:20")
print("5. CIE色度座標を(0.33, 0.33)に調整")
print("6. 演色評価数Ra > 90を確認（R9赤成minが重要）")
print("\n最適化アルゴリズム:")
print("- 厚みと濃度をパラメータとしたモンテカルロ最適化")
print("- 目的関数: Ra最大化 & 色温度5000-6500K制約")
</code></pre>
                </details>
            </div>
        </section>

        <section id="references">
            <h2>参考文献</h2>
            <ol>
                <li>Moulson, A.J., Herbert, J.M. (2003). <em>Electroceramics: Materials, Properties, Applications</em>. Wiley, pp. 1-85, 155-210, 340-395.</li>
                <li>Jaffe, B., Cook, W.R., Jaffe, H. (1971). <em>Piezoelectric Ceramics</em>. Academic Press, pp. 50-135.</li>
                <li>Tuller, H.L. (2000). Ionic conduction in nanocrystalline materials. <em>Solid State Ionics</em>, 131, 15-68.</li>
                <li>Ronda, C.R. (2008). <em>Luminescence: From Theory to Applications</em>. Wiley-VCH, pp. 120-180.</li>
                <li>Blasse, G., Grabmaier, B.C. (1994). <em>Luminescent Materials</em>. Springer, pp. 1-65.</li>
                <li>Goldman, A. (2006). <em>Modern Ferrite Technology</em>. Springer, pp. 30-95.</li>
                <li>Setter, N. (2002). <em>Piezoelectric Materials in Devices</em>. EPFL Swiss Federal Institute of Technology, pp. 1-50, 200-250.</li>
            </ol>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 MS Dojo - Materials Science Education</p>
        <p><a href="index.html">セラミックス材料入門トップへ戻る</a> | <a href="../../MS/">MSmin野トップ</a></p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'base' });
    </script>
</body>
</html>
