<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Chapter 4: Dislocations and Plastic Deformation - Introduction to Materials Microstructure Series - MS Terakoya</title>
<link href="../../assets/css/knowledge-base.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>
</head>
<body><div class="locale-switcher">
<span class="current-locale">ğŸŒ EN</span>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<div class="breadcrumb">
<a href="../index.html">MS Terakoya</a> &gt;
        <a href="index.html">Introduction to Materials Microstructure</a> &gt;
        Chapter 4: Dislocations and Plastic Deformation
    </div>
<header>
<div class="header-content">
<h1>Chapter 4: Dislocations and Plastic Deformation</h1>
<p class="subtitle">Dislocations and Plastic Deformation - From Work Hardening to Recrystallization</p>
<div class="meta">
<span class="meta-item">â±ï¸ Reading time: 30-35 minutes</span>
<span class="meta-item">ğŸ’» Code examples: 7</span>
<span class="meta-item">ğŸ“Š Difficulty: Intermediate to Advanced</span>
<span class="meta-item">ğŸ”¬ Practical exercises: 3</span>
</div>
</div>
</header>
<main class="container">
<div class="learning-objectives">
<h2>Learning Objectives</h2>
<p>Upon completing this chapter, you will acquire the following skills and knowledge:</p>
<ul>
<li>âœ… Understand types of dislocations (edge, screw, mixed) and the concept of Burgers vector</li>
<li>âœ… Understand dislocation motion and Peach-Koehler force, and predict behavior under stress</li>
<li>âœ… Explain the mechanism of work hardening and its relationship with dislocation density</li>
<li>âœ… Calculate yield stress from dislocation density using the Taylor equation</li>
<li>âœ… Understand mechanisms of dynamic recovery and recrystallization, and explain their applications to heat treatment</li>
<li>âœ… Understand the principles of dislocation density measurement methods (XRD, TEM, EBSD)</li>
<li>âœ… Simulate dislocation motion, work hardening, and recrystallization behavior using Python</li>
</ul>
</div>
<h2>4.1 Fundamentals of Dislocations</h2>
<h3>4.1.1 What are Dislocations?</h3>
<p><strong>Dislocations</strong> are linear defects in crystals and the most important crystal defects responsible for plastic deformation. While an ideal crystal requires theoretical strength (approximately G/10) for complete slip, the presence of dislocations reduces the actual yield stress to 1/100 to 1/1000 of the theoretical strength.</p>
<div class="info-box">
<h4>ğŸ”¬ Discovery of Dislocations</h4>
<p>The concept of dislocations was independently proposed by Taylor, Orowan, and Polanyi in 1934. It was introduced to explain why the measured strength of crystals is far lower than the theoretical strength, and was first directly observed using TEM (Transmission Electron Microscopy) in the 1950s.</p>
</div>
<h3>4.1.2 Types of Dislocations</h3>
<p>Dislocations are classified based on the relationship between the Burgers vector <strong>b</strong> and the dislocation line direction <strong>Î¾</strong>:</p>
<table>
<thead>
<tr>
<th>Dislocation Type</th>
<th>Relationship between Burgers Vector and Dislocation Line</th>
<th>Characteristics</th>
<th>Mode of Motion</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Edge Dislocation</strong></td>
<td>b âŠ¥ Î¾<br/>(Perpendicular)</td>
<td>Extra half-plane insertion<br/>Compressive/tensile stress field</td>
<td>Glide motion<br/>Climb motion (high temperature)</td>
</tr>
<tr>
<td><strong>Screw Dislocation</strong></td>
<td>b âˆ¥ Î¾<br/>(Parallel)</td>
<td>Helical lattice displacement<br/>Pure shear strain</td>
<td>Cross-slip possible<br/>Slip on any plane</td>
</tr>
<tr>
<td><strong>Mixed Dislocation</strong></td>
<td>0Â° &lt; (b, Î¾) &lt; 90Â°</td>
<td>Intermediate between edge and screw</td>
<td>Motion on slip plane</td>
</tr>
</tbody>
</table>
<div class="mermaid">
graph TB
    A[Dislocations] --&gt; B[åˆƒçŠ¶Dislocations<br/>Edge Dislocation]
    A --&gt; C[ã‚‰ã›ã‚“Dislocations<br/>Screw Dislocation]
    A --&gt; D[æ··åˆDislocations<br/>Mixed Dislocation]

    B --&gt; B1[b âŠ¥ Î¾]
    B --&gt; B2[Extra half-plane]
    B --&gt; B3[Climb motion possible]

    C --&gt; C1[b âˆ¥ Î¾]
    C --&gt; C2[Cross-slip]
    C --&gt; C3[Fast motion]

    D --&gt; D1[Edge + screw components]
    D --&gt; D2[Most common]

    style A fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style B fill:#e3f2fd
    style C fill:#e3f2fd
    style D fill:#e3f2fd
</div>
<h3>4.1.3 Burgers Vector</h3>
<p>The <strong>Burgers vector (b)</strong> is a vector representing the closure failure of a circuit around a dislocation (Burgers circuit), determining the type and magnitude of the dislocation.</p>
<blockquote>
            Burgers vectors in major crystal structures:
            <br/><br/>
<strong>FCC (Face-Centered Cubic)</strong>: b = (a/2)&lt;110&gt; (slip on close-packed {111} planes)<br/>
            |b| = a/âˆš2 â‰ˆ 0.204 nmï¼ˆAlï¼‰ã€0.256 nmï¼ˆCuï¼‰
            <br/><br/>
<strong>BCC (Body-Centered Cubic)</strong>: b = (a/2)&lt;111&gt; (slip on {110}, {112}, {123} planes)<br/>
            |b| = aâˆš3/2 â‰ˆ 0.248 nmï¼ˆFeï¼‰
            <br/><br/>
<strong>HCP (Hexagonal Close-Packed)</strong>: b = (a/3)&lt;1120&gt; (basal plane), &lt;c+a&gt; (prismatic and pyramidal planes)
        </blockquote>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example 1: Visualization and Calculation of Burgers Vectors
ä¸»è¦ãªçµæ™¶æ§‹é€ ã§ã®Dislocationsç‰¹æ€§
"""
import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

def burgers_vector_fcc(lattice_param):
    """
    Burgers vector for FCC structure

    Args:
        lattice_param: Lattice parameter [nm]

    Returns:
        burgers_vectors: List of &lt;110&gt; type Burgers vectors
        magnitude: Magnitude of vector [nm]
    """
    a = lattice_param

    # &lt;110&gt; direction (primary slip system in FCC)
    directions = np.array([
        [1, 1, 0],
        [1, -1, 0],
        [1, 0, 1],
        [1, 0, -1],
        [0, 1, 1],
        [0, 1, -1]
    ])

    # Burgers vector: b = (a/2)&lt;110&gt;
    burgers_vectors = (a / 2) * directions / np.linalg.norm(directions, axis=1, keepdims=True)

    # Magnitude
    magnitude = a / np.sqrt(2)

    return burgers_vectors, magnitude

def burgers_vector_bcc(lattice_param):
    """
    Burgers vector for BCC structure

    Args:
        lattice_param: Lattice parameter [nm]

    Returns:
        burgers_vectors: List of &lt;111&gt; type Burgers vectors
        magnitude: Magnitude of vector [nm]
    """
    a = lattice_param

    # &lt;111&gt; direction (primary slip system in BCC)
    directions = np.array([
        [1, 1, 1],
        [1, 1, -1],
        [1, -1, 1],
        [1, -1, -1]
    ])

    # Burgers vector: b = (a/2)&lt;111&gt;
    burgers_vectors = (a / 2) * directions / np.linalg.norm(directions, axis=1, keepdims=True)

    # Magnitude
    magnitude = a * np.sqrt(3) / 2

    return burgers_vectors, magnitude

# Lattice parameters of major metals
metals = {
    'Al (FCC)': {'a': 0.405, 'structure': 'fcc'},
    'Cu (FCC)': {'a': 0.361, 'structure': 'fcc'},
    'Ni (FCC)': {'a': 0.352, 'structure': 'fcc'},
    'Fe (BCC)': {'a': 0.287, 'structure': 'bcc'},
    'W (BCC)': {'a': 0.316, 'structure': 'bcc'},
}

# Calculation and visualization
fig = plt.figure(figsize=(14, 5))

# (a) Burgersãƒ™ã‚¯ãƒˆãƒ«ã®Magnitudeæ¯”è¼ƒ
ax1 = fig.add_subplot(1, 2, 1)
metal_names = []
burgers_magnitudes = []

for metal, params in metals.items():
    a = params['a']
    structure = params['structure']

    if structure == 'fcc':
        _, b_mag = burgers_vector_fcc(a)
    else:  # bcc
        _, b_mag = burgers_vector_bcc(a)

    metal_names.append(metal)
    burgers_magnitudes.append(b_mag)

colors = ['#3498db', '#2ecc71', '#9b59b6', '#e74c3c', '#f39c12']
bars = ax1.bar(range(len(metal_names)), burgers_magnitudes, color=colors, alpha=0.7)
ax1.set_xticks(range(len(metal_names)))
ax1.set_xticklabels(metal_names, rotation=15, ha='right')
ax1.set_ylabel('Burgersãƒ™ã‚¯ãƒˆãƒ«ã®Magnitude |b| [nm]', fontsize=12)
ax1.set_title('(a) Comparison of Burgers Vectors in Metals', fontsize=13, fontweight='bold')
ax1.grid(True, axis='y', alpha=0.3)

# Display values above bars
for bar, val in zip(bars, burgers_magnitudes):
    height = bar.get_height()
    ax1.text(bar.get_x() + bar.get_width()/2., height,
             f'{val:.3f}', ha='center', va='bottom', fontsize=9)

# (b) 3D visualization (Al FCC example)
ax2 = fig.add_subplot(1, 2, 2, projection='3d')
al_burgers, al_mag = burgers_vector_fcc(0.405)

# Draw vectors from origin
origin = np.zeros(3)
for i, b in enumerate(al_burgers[:3]):  # Display only the first 3
    ax2.quiver(origin[0], origin[1], origin[2],
               b[0], b[1], b[2],
               color=colors[i], arrow_length_ratio=0.2,
               linewidth=2.5, label=f'b{i+1}')

ax2.set_xlabel('X [nm]', fontsize=10)
ax2.set_ylabel('Y [nm]', fontsize=10)
ax2.set_zlabel('Z [nm]', fontsize=10)
ax2.set_title('(b) Burgers Vectors &lt;110&gt; for Al (FCC)', fontsize=13, fontweight='bold')
ax2.legend(fontsize=9)

# Unify axis ranges
max_val = al_mag
ax2.set_xlim([-max_val, max_val])
ax2.set_ylim([-max_val, max_val])
ax2.set_zlim([-max_val, max_val])

plt.tight_layout()
plt.show()

# Numerical output
print("=== Burgers Vector Calculation Results ===\n")
for metal, params in metals.items():
    a = params['a']
    structure = params['structure']

    if structure == 'fcc':
        b_vectors, b_mag = burgers_vector_fcc(a)
        slip_system = '&lt;110&gt;{111}'
    else:
        b_vectors, b_mag = burgers_vector_bcc(a)
        slip_system = '&lt;111&gt;{110}'

    print(f"{metal}:")
    print(f"  Lattice parameter: {a:.3f} nm")
    print(f"  Burgers vector: |b| = {b_mag:.3f} nm")
    print(f"  Primary slip system: {slip_system}")
    print(f"  Number of slip vectors: {len(b_vectors)}\n")

# Output example:
# === Burgers Vector Calculation Results ===
#
# Al (FCC):
#   Lattice parameter: 0.405 nm
#   Burgers vector: |b| = 0.286 nm
#   Primary slip system: &lt;110&gt;{111}
#   Number of slip vectors: 6
#
# Fe (BCC):
#   Lattice parameter: 0.287 nm
#   Burgers vector: |b| = 0.248 nm
#   Primary slip system: &lt;111&gt;{110}
#   Number of slip vectors: 4
</code></pre>
<h2>4.2 Dislocation Motion and Peach-Koehler Force</h2>
<h3>4.2.1 Forces Acting on Dislocations</h3>
<p>Dislocations move under stress and cause plastic deformation. The force per unit length acting on a dislocation is represented by the <strong>Peach-Koehler force</strong>:</p>
<blockquote>
<strong>F = (Ïƒ Â· b) Ã— Î¾</strong>
<br/><br/>
            F: Dislocationsã«åƒãåŠ›ï¼ˆå˜ä½é•·ã•ã‚ãŸã‚Šï¼‰[N/m]<br/>
            Ïƒ: Stress tensor [Pa]<br/>
            b: Burgers vector [m]<br/>
            Î¾: Dislocationsç·šæ–¹å‘ã®å˜ä½ãƒ™ã‚¯ãƒˆãƒ«
        </blockquote>
<p>For a pure edge dislocation, by shear stress Ï„ parallel to the slip plane:</p>
<blockquote>
            F = Ï„ Â· b
        </blockquote>
<p>When a dislocation moves, shear deformation occurs on the slip plane. When a dislocation crosses the crystal, a total displacement of one atomic layer (|b|) occurs.</p>
<h3>4.2.2 Critical Resolved Shear Stress (CRSS)</h3>
<p><strong>Critical Resolved Shear Stress (CRSS)</strong> is the minimum shear stress required for a slip system to become active. Yielding in single crystals occurs on the slip system where CRSS is first reached.</p>
<p>Using the angles between tensile stress Ïƒ and the slip system:</p>
<blockquote>
            Ï„<sub>resolved</sub> = Ïƒ Â· cos(Ï†) Â· cos(Î»)
            <br/><br/>
            Ï†: Angle between slip plane normal and tensile axis<br/>
            Î»: Angle between slip direction and tensile axis<br/>
            cos(Ï†)Â·cos(Î»): Schmid factor
        </blockquote>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example 2: Calculation of Peach-Koehler Force and Schmid Factor
Prediction of yielding behavior in single crystals
"""
import numpy as np
import matplotlib.pyplot as plt

def schmid_factor(phi, lambda_angle):
    """
    Calculate Schmid factor

    Args:
        phi: Angle between slip plane normal and tensile axis [degrees]
        lambda_angle: Angle between slip direction and tensile axis [degrees]

    Returns:
        schmid: Schmid factor
    """
    phi_rad = np.radians(phi)
    lambda_rad = np.radians(lambda_angle)

    schmid = np.cos(phi_rad) * np.cos(lambda_rad)

    return schmid

def peach_koehler_force(tau, b):
    """
    Peach-KoehleråŠ›ã‚’è¨ˆç®—ï¼ˆç°¡ç•¥åŒ–ï¼šåˆƒçŠ¶Dislocationsï¼‰

    Args:
        tau: Shear stress [Pa]
        b: Burgersãƒ™ã‚¯ãƒˆãƒ«ã®Magnitude [m]

    Returns:
        F: Force per unit length [N/m]
    """
    return tau * b

# Schmid factorãƒãƒƒãƒ—ã®ä½œæˆ
phi_range = np.linspace(0, 90, 100)
lambda_range = np.linspace(0, 90, 100)
Phi, Lambda = np.meshgrid(phi_range, lambda_range)

# Schmid factorã®è¨ˆç®—
Schmid = np.cos(np.radians(Phi)) * np.cos(np.radians(Lambda))

# æœ€å¤§Schmid factorï¼ˆ45Â°, 45Â°ã§æœ€å¤§å€¤0.5ï¼‰
max_schmid = 0.5

plt.figure(figsize=(14, 5))

# (a) Schmid factorãƒãƒƒãƒ—
ax1 = plt.subplot(1, 2, 1)
contour = ax1.contourf(Phi, Lambda, Schmid, levels=20, cmap='RdYlGn')
plt.colorbar(contour, ax=ax1, label='Schmid factor')
ax1.contour(Phi, Lambda, Schmid, levels=[0.5], colors='red', linewidths=2)
ax1.plot(45, 45, 'r*', markersize=20, label='Maximum (Ï†=45Â°, Î»=45Â°)')
ax1.set_xlabel('Ï†: Angle between slip plane normal and tensile axis [Â°]', fontsize=11)
ax1.set_ylabel('Î»: Angle between slip direction and tensile axis [Â°]', fontsize=11)
ax1.set_title('(a) Schmid factorãƒãƒƒãƒ—', fontsize=13, fontweight='bold')
ax1.legend(fontsize=10)
ax1.grid(True, alpha=0.3)

# (b) Orientation dependence of yield stress
ax2 = plt.subplot(1, 2, 2)

# Example of FCC single crystal (Al)
CRSS_Al = 1.0  # MPaï¼ˆTypical value for annealed materialï¼‰
b_Al = 0.286e-9  # m

# Yield stress at different orientations
orientations = {
    '[001]': (45, 45, 0.5),      # Cubic orientation
    '[011]': (35.3, 45, 0.408),  #
    '[111]': (54.7, 54.7, 0.272), # Hardest orientation
    '[123]': (40, 50, 0.429),
}

orientations_list = []
yield_stress_list = []
schmid_list = []

for orient, (phi, lam, schmid) in orientations.items():
    # é™ä¼å¿œåŠ› = CRSS / Schmid factor
    yield_stress = CRSS_Al / schmid

    orientations_list.append(orient)
    yield_stress_list.append(yield_stress)
    schmid_list.append(schmid)

colors_bar = ['#3498db', '#2ecc71', '#e74c3c', '#f39c12']
bars = ax2.bar(range(len(orientations_list)), yield_stress_list,
               color=colors_bar, alpha=0.7)

# Schmid factorã‚’ç¬¬äºŒè»¸ã«è¡¨ç¤º
ax2_twin = ax2.twinx()
ax2_twin.plot(range(len(orientations_list)), schmid_list,
              'ro-', linewidth=2, markersize=10, label='Schmid factor')

ax2.set_xticks(range(len(orientations_list)))
ax2.set_xticklabels(orientations_list)
ax2.set_ylabel('Yield stress [MPa]', fontsize=12)
ax2_twin.set_ylabel('Schmid factor', fontsize=12, color='red')
ax2_twin.tick_params(axis='y', labelcolor='red')
ax2.set_title('(b) Orientation Dependence of Al Single Crystal', fontsize=13, fontweight='bold')
ax2.grid(True, axis='y', alpha=0.3)
ax2_twin.legend(loc='upper right', fontsize=10)

plt.tight_layout()
plt.show()

# Calculation example of Peach-Koehler force
print("=== Peach-Koehler Force Calculation ===\n")

stresses = [10, 50, 100, 200]  # MPa
for sigma in stresses:
    tau = sigma * 0.5  # Schmid factor=0.5ã‚’ä»®å®š
    tau_pa = tau * 1e6  # Pa

    F = peach_koehler_force(tau_pa, b_Al)

    print(f"Tensile stress {sigma} MPa (Schmid=0.5):")
    print(f"  Resolved shear stress: {tau:.1f} MPa")
    print(f"  Peach-KoehleråŠ›: {F:.2e} N/m\n")

# Output example:
# === Peach-Koehler Force Calculation ===
#
# Tensile stress 10 MPa (Schmid=0.5):
#   Resolved shear stress: 5.0 MPa
#   Peach-KoehleråŠ›: 1.43e-03 N/m
#
# Tensile stress 100 MPa (Schmid=0.5):
#   Resolved shear stress: 50.0 MPa
#   Peach-KoehleråŠ›: 1.43e-02 N/m
</code></pre>
<h2>4.3 Work Hardening</h2>
<h3>4.3.1 Mechanisms of Work Hardening</h3>
<p><strong>Work hardening</strong> or <strong>strain hardening</strong> is a phenomenon in which materials harden due to plastic deformation. The main causes are the increase in dislocation density and interactions between dislocations.</p>
<div class="mermaid">
flowchart TD
    A[Start of plastic deformation] --&gt; B[DislocationsãŒå¢—æ®–<br/>Frank-Readæº]
    B --&gt; C[Dislocationså¯†åº¦å¢—åŠ <br/>Ï: 10â¸ â†’ 10Â¹â´ mâ»Â²]
    C --&gt; D[DislocationsåŒå£«ãŒçµ¡ã¿åˆã†<br/>ForestDislocations]
    D --&gt; E[Dislocationsé‹å‹•ã®æŠµæŠ—å¢—åŠ ]
    E --&gt; F[Yield stress increase<br/>Work hardening]

    style A fill:#fff3e0
    style F fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
</div>
<h3>4.3.2 Taylor Equation and Dislocation Density</h3>
<p>The relationship between yield stress and dislocation density is expressed by the <strong>Taylor equation</strong>:</p>
<blockquote>
            Ïƒ<sub>y</sub> = Ïƒ<sub>0</sub> + Î± Â· M Â· G Â· b Â· âˆšÏ
            <br/><br/>
            Ïƒ<sub>y</sub>: Yield stress [Pa]<br/>
            Ïƒ<sub>0</sub>: Friction stress (lattice friction stress) [Pa]<br/>
            Î±: Constant (0.2-0.5, typically 0.3-0.4)<br/>
            M: Taylor factor (polycrystalline average, FCC: 3.06, BCC: 2.75)<br/>
            G: Shear modulus [Pa]<br/>
            b: Burgersãƒ™ã‚¯ãƒˆãƒ«ã®Magnitude [m]<br/>
            Ï: Dislocationså¯†åº¦ [mâ»Â²]
        </blockquote>
<p>Typical dislocation densities:</p>
<table>
<thead>
<tr>
<th>State</th>
<th>Dislocation Density Ï [mâ»Â²]</th>
<th>Average Dislocation Spacing</th>
</tr>
</thead>
<tbody>
<tr>
<td>Annealed (well softened)</td>
<td>10â¸ - 10Â¹â°</td>
<td>10 - 100 Î¼m</td>
</tr>
<tr>
<td>Moderately worked</td>
<td>10Â¹Â² - 10Â¹Â³</td>
<td>0.3 - 1 Î¼m</td>
</tr>
<tr>
<td>Heavily worked (cold rolled)</td>
<td>10Â¹â´ - 10Â¹âµ</td>
<td>30 - 100 nm</td>
</tr>
</tbody>
</table>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example 3: Stress-Strain Curve and Work Hardening
Strength prediction using Taylor equation
"""
import numpy as np
import matplotlib.pyplot as plt

def work_hardening_curve(strain, material='Al'):
    """
    Calculate stress-strain curve due to work hardening

    Args:
        strain: True strain
        material: Material name

    Returns:
        stress: True stress [MPa]
        rho: Dislocationså¯†åº¦ [mâ»Â²]
    """
    # Material parameters
    params = {
        'Al': {'sigma0': 10, 'G': 26e9, 'b': 2.86e-10, 'M': 3.06, 'alpha': 0.35},
        'Cu': {'sigma0': 20, 'G': 48e9, 'b': 2.56e-10, 'M': 3.06, 'alpha': 0.35},
        'Fe': {'sigma0': 50, 'G': 81e9, 'b': 2.48e-10, 'M': 2.75, 'alpha': 0.4},
    }

    p = params[material]

    # åˆæœŸDislocationså¯†åº¦
    rho0 = 1e12  # mâ»Â²

    # ã²ãšã¿ã«ä¼´ã†Dislocationså¯†åº¦ã®å¢—åŠ ï¼ˆç°¡ç•¥åŒ–ï¼‰
    # Kocks-Meckingå‹: dÏ/dÎµ = k1Â·âˆšÏ - k2Â·Ï
    k1 = 1e15  # Multiplication term
    k2 = 10    # Recovery term (small at room temperature)

    rho = np.zeros_like(strain)
    rho[0] = rho0

    for i in range(1, len(strain)):
        d_eps = strain[i] - strain[i-1]
        d_rho = (k1 * np.sqrt(rho[i-1]) - k2 * rho[i-1]) * d_eps
        rho[i] = rho[i-1] + d_rho

    # Taylor equation
    stress = (p['sigma0'] + p['alpha'] * p['M'] * p['G'] * p['b'] * np.sqrt(rho)) / 1e6  # MPa

    return stress, rho

# Strain range
strain = np.linspace(0, 0.5, 200)  # 0-50%

plt.figure(figsize=(14, 10))

# (a) Stress-strain curve
ax1 = plt.subplot(2, 2, 1)
materials = ['Al', 'Cu', 'Fe']
colors = ['blue', 'orange', 'red']

for mat, color in zip(materials, colors):
    stress, rho = work_hardening_curve(strain, material=mat)
    ax1.plot(strain * 100, stress, linewidth=2.5, color=color, label=mat)

ax1.set_xlabel('Strain [%]', fontsize=12)
ax1.set_ylabel('True stress [MPa]', fontsize=12)
ax1.set_title('(a) Stress-strain curveï¼ˆåŠ å·¥ç¡¬åŒ–ï¼‰', fontsize=13, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)

# (b) Dislocationså¯†åº¦ã®ç™ºå±•
ax2 = plt.subplot(2, 2, 2)
for mat, color in zip(materials, colors):
    stress, rho = work_hardening_curve(strain, material=mat)
    ax2.semilogy(strain * 100, rho, linewidth=2.5, color=color, label=mat)

ax2.set_xlabel('Strain [%]', fontsize=12)
ax2.set_ylabel('Dislocationså¯†åº¦ [mâ»Â²]', fontsize=12)
ax2.set_title('(b) Dislocationså¯†åº¦ã®ç™ºå±•', fontsize=13, fontweight='bold')
ax2.legend(fontsize=11)
ax2.grid(True, which='both', alpha=0.3)

# (c) åŠ å·¥Hardening rate
ax3 = plt.subplot(2, 2, 3)
for mat, color in zip(materials, colors):
    stress, rho = work_hardening_curve(strain, material=mat)
    # åŠ å·¥Hardening rate: Î¸ = dÏƒ/dÎµ
    theta = np.gradient(stress, strain)

    ax3.plot(strain * 100, theta, linewidth=2.5, color=color, label=mat)

ax3.set_xlabel('Strain [%]', fontsize=12)
ax3.set_ylabel('åŠ å·¥Hardening rate dÏƒ/dÎµ [MPa]', fontsize=12)
ax3.set_title('(c) åŠ å·¥Hardening rateã®å¤‰åŒ–', fontsize=13, fontweight='bold')
ax3.legend(fontsize=11)
ax3.grid(True, alpha=0.3)

# (d) Dislocationså¯†åº¦ vs å¼·åº¦ï¼ˆTaylor equationã®æ¤œè¨¼ï¼‰
ax4 = plt.subplot(2, 2, 4)
for mat, color in zip(materials, colors):
    stress, rho = work_hardening_curve(strain, material=mat)

    # Plot against âˆšÏ (expecting linear relationship)
    ax4.plot(np.sqrt(rho) / 1e6, stress, linewidth=2.5,
             color=color, marker='o', markersize=3, label=mat)

ax4.set_xlabel('âˆšÏ [Ã—10â¶ mâ»Â¹]', fontsize=12)
ax4.set_ylabel('True stress [MPa]', fontsize=12)
ax4.set_title('(d) Taylor equationã®æ¤œè¨¼ (Ïƒ âˆ âˆšÏ)', fontsize=13, fontweight='bold')
ax4.legend(fontsize=11)
ax4.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

# Numerical calculation example
print("=== Work Hardening Calculation Example (30% Deformation of Al) ===\n")
strain_30 = 0.30
stress_30, rho_30 = work_hardening_curve(np.array([0, strain_30]), 'Al')

print(f"åˆæœŸStateï¼ˆç„¼éˆï¼‰:")
print(f"  Dislocationså¯†åº¦: {1e12:.2e} mâ»Â²")
print(f"  é™ä¼å¿œåŠ›: {stress_30[0]:.1f} MPa\n")

print(f"After 30% cold working:")
print(f"  Dislocationså¯†åº¦: {rho_30[1]:.2e} mâ»Â²")
print(f"  é™ä¼å¿œåŠ›: {stress_30[1]:.1f} MPa")
print(f"  Strength increase: {stress_30[1] - stress_30[0]:.1f} MPa")
print(f"  Hardening rate: {(stress_30[1] / stress_30[0] - 1) * 100:.1f}%")

# Output example:
# === Work Hardening Calculation Example (30% Deformation of Al) ===
#
# åˆæœŸStateï¼ˆç„¼éˆï¼‰:
#   Dislocationså¯†åº¦: 1.00e+12 mâ»Â²
#   é™ä¼å¿œåŠ›: 41.7 MPa
#
# After 30% cold working:
#   Dislocationså¯†åº¦: 8.35e+13 mâ»Â²
#   é™ä¼å¿œåŠ›: 120.5 MPa
#   Strength increase: 78.8 MPa
#   Hardening rate: 189.0%
</code></pre>
<h3>4.3.3 Stages of Work Hardening</h3>
<p>The stress-strain curve of FCC metals is typically divided into three stages:</p>
<table>
<thead>
<tr>
<th>Stage</th>
<th>Characteristics</th>
<th>Dislocation Structure</th>
<th>Hardening rate</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Stage I<br/>(Easy Glide)</strong></td>
<td>Observed in single crystals<br/>Single slip system active</td>
<td>Dislocations move in one direction</td>
<td>Low<br/>(Î¸ â‰ˆ G/1000)</td>
</tr>
<tr>
<td><strong>Stage II<br/>(Linear Hardening)</strong></td>
<td>Main region in polycrystals<br/>Multiple slip systems active</td>
<td>Dislocation entanglement<br/>Cell structure formation begins</td>
<td>High<br/>(Î¸ â‰ˆ G/100)</td>
</tr>
<tr>
<td><strong>Stage III<br/>(Dynamic Recovery)</strong></td>
<td>Large strain region<br/>Dislocation rearrangement</td>
<td>Clear cell structure<br/>Subgrain formation</td>
<td>Decreasing<br/>(Î¸ â†’ 0)</td>
</tr>
</tbody>
</table>
<h2>4.4 Dynamic Recovery and Recrystallization</h2>
<h3>4.4.1 Dynamic Recovery</h3>
<p><strong>Dynamic recovery</strong> is the process where dislocations rearrange during deformation to form energetically stable configurations (cell structures, subgrains). It is prominent at high temperatures or in materials with low stacking fault energy (BCC, HCP).</p>
<div class="info-box">
<h4>ğŸ”¬ Cell Structure and Subgrains</h4>
<p><strong>Cell structure</strong>: A microstructure consisting of walls with high dislocation density and interiors with low density. Size around 0.1-1 Î¼m.</p>
<p><strong>Subgrains</strong>: Regions surrounded by low-angle grain boundaries. Misorientation around 1-10Â°. Formed as dynamic recovery progresses.</p>
</div>
<h3>4.4.2 Static Recovery and Recrystallization</h3>
<p>Upon heating after cold working, the microstructure changes through the following stages:</p>
<div class="mermaid">
flowchart LR
    A[å†·é–“åŠ å·¥çµ„ç¹”<br/>é«˜Dislocationså¯†åº¦] --&gt; B[Recovery]
    B --&gt; C[Recrystallization]
    C --&gt; D[Grain Growth]

    B1[Dislocationså†é…åˆ—<br/>å†…éƒ¨å¿œåŠ›ç·©å’Œ] -.-&gt; B
    C1[æ–°ç²’ç”Ÿæˆ<br/>ä½Dislocationså¯†åº¦] -.-&gt; C
    D1[Grain boundary migration<br/>Grain size increase] -.-&gt; D

    style A fill:#ffebee
    style B fill:#e3f2fd
    style C fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style D fill:#e8f5e9
</div>
<p>The driving force for <strong>recrystallization</strong> is the strain energy from accumulated dislocations. Recrystallized grains nucleate with low dislocation density and grow by consuming regions with high dislocation density.</p>
<h3>4.4.3 Recrystallization Temperature and Kinetics</h3>
<p>Guideline for recrystallization temperature T<sub>rex</sub>:</p>
<blockquote>
            T<sub>rex</sub> â‰ˆ (0.3 - 0.5) Ã— T<sub>m</sub>
<br/><br/>
            T<sub>m</sub>: Melting point [K]
        </blockquote>
<p>Kinetics of recrystallization (Johnson-Mehl-Avrami-Kolmogorov equation):</p>
<blockquote>
            X<sub>v</sub>(t) = 1 - exp(-(kt)<sup>n</sup>)
            <br/><br/>
            X<sub>v</sub>: Recrystallized volume fraction<br/>
            k: Rate constant (temperature dependent)<br/>
            t: Time [s]<br/>
            n: Avrami exponent (1-4, typically 2-3)
        </blockquote>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example 4: Simulation of Recrystallization Kinetics
Volume fraction prediction using JMAK equation
"""
import numpy as np
import matplotlib.pyplot as plt

def jmak_recrystallization(t, k, n=2.5):
    """
    Recrystallized volume fraction by JMAK equation

    Args:
        t: Time [s]
        k: Rate constant [sâ»â¿]
        n: Avrami exponent

    Returns:
        X_v: Recrystallized volume fraction
    """
    X_v = 1 - np.exp(-(k * t)**n)
    return X_v

def recrystallization_rate_constant(T, Q=200e3, k0=1e10):
    """
    Recrystallization rate constant (Arrhenius type)

    Args:
        T: Temperature [K]
        Q: Activation energy [J/mol]
        k0: Pre-exponential factor [sâ»Â¹]

    Returns:
        k: Rate constant [sâ»Â¹]
    """
    R = 8.314  # Gas constant
    k = k0 * np.exp(-Q / (R * T))
    return k

def stored_energy_reduction(X_v, E0=5e6):
    """
    Reduction of stored energy by recrystallization

    Args:
        X_v: Recrystallized volume fraction
        E0: Initial stored energy [J/mÂ³]

    Returns:
        E: Remaining stored energy [J/mÂ³]
    """
    # å†çµæ™¶ç²’ã¯ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆDislocationså¯†åº¦ä½ã„ï¼‰
    E = E0 * (1 - X_v)
    return E

# Temperature conditions
temperatures = [573, 623, 673]  # 300, 350, 400Â°C
temp_labels = ['300Â°C', '350Â°C', '400Â°C']
colors = ['blue', 'green', 'red']

time_hours = np.logspace(-2, 2, 200)  # 0.01-100æ™‚é–“
time_seconds = time_hours * 3600

plt.figure(figsize=(14, 10))

# (a) å†çµæ™¶æ›²ç·š
ax1 = plt.subplot(2, 2, 1)
for T, label, color in zip(temperatures, temp_labels, colors):
    k = recrystallization_rate_constant(T)
    X_v = jmak_recrystallization(time_seconds, k, n=2.5)

    ax1.semilogx(time_hours, X_v * 100, linewidth=2.5, color=color, label=label)

    # Mark 50% recrystallization time
    t_50_idx = np.argmin(np.abs(X_v - 0.5))
    ax1.plot(time_hours[t_50_idx], 50, 'o', markersize=10, color=color)

ax1.axhline(y=50, color='gray', linestyle='--', alpha=0.5)
ax1.set_xlabel('Annealing time [h]', fontsize=12)
ax1.set_ylabel('Recrystallized volume fraction [%]', fontsize=12)
ax1.set_title('(a) Recrystallization Curve (Al, after 70% rolling)', fontsize=13, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(True, which='both', alpha=0.3)
ax1.set_ylim(-5, 105)

# (b) Avrami exponentã®å½±éŸ¿
ax2 = plt.subplot(2, 2, 2)
T_fixed = 623  # 350Â°C
k_fixed = recrystallization_rate_constant(T_fixed)

avrami_n = [1.5, 2.5, 3.5]
n_labels = ['n=1.5 (site saturated)', 'n=2.5 (typical value)', 'n=3.5 (continuous nucleation)']
n_colors = ['purple', 'green', 'orange']

for n, n_label, n_color in zip(avrami_n, n_labels, n_colors):
    X_v = jmak_recrystallization(time_seconds, k_fixed, n=n)
    ax2.semilogx(time_hours, X_v * 100, linewidth=2.5, color=n_color, label=n_label)

ax2.set_xlabel('Annealing time [h]', fontsize=12)
ax2.set_ylabel('Recrystallized volume fraction [%]', fontsize=12)
ax2.set_title(f'(b) Avrami exponentã®å½±éŸ¿ ({temp_labels[1]})', fontsize=13, fontweight='bold')
ax2.legend(fontsize=10)
ax2.grid(True, which='both', alpha=0.3)

# (c) Stored energyã®æ¸›å°‘
ax3 = plt.subplot(2, 2, 3)
T = 623
k = recrystallization_rate_constant(T)
X_v = jmak_recrystallization(time_seconds, k, n=2.5)
E = stored_energy_reduction(X_v, E0=5e6)

ax3_main = ax3
ax3_main.semilogx(time_hours, E / 1e6, 'b-', linewidth=2.5, label='Stored energy')
ax3_main.set_xlabel('Annealing time [h]', fontsize=12)
ax3_main.set_ylabel('Stored energy [MJ/mÂ³]', fontsize=12, color='b')
ax3_main.tick_params(axis='y', labelcolor='b')

# Hardness (proportional to energy) on secondary axis
ax3_twin = ax3_main.twinx()
hardness = 70 + (E / 5e6) * 80  # Annealed: 70 HV, worked: 150 HV
ax3_twin.semilogx(time_hours, hardness, 'r--', linewidth=2.5, label='Hardness')
ax3_twin.set_ylabel('Hardness [HV]', fontsize=12, color='r')
ax3_twin.tick_params(axis='y', labelcolor='r')

ax3_main.set_title(f'(c) Stored energyã¨Hardnessã®å¤‰åŒ– ({temp_labels[1]})',
                   fontsize=13, fontweight='bold')
ax3_main.grid(True, which='both', alpha=0.3)
ax3_main.legend(loc='upper right', fontsize=10)
ax3_twin.legend(loc='center right', fontsize=10)

# (d) å†çµæ™¶æ¸©åº¦ã®å®šç¾©ï¼ˆ50%æ™‚é–“ãŒ1 hourã¨ãªã‚‹æ¸©åº¦ï¼‰
ax4 = plt.subplot(2, 2, 4)
T_range = np.linspace(523, 723, 50)  # 250-450Â°C
t_50_list = []

for T in T_range:
    k = recrystallization_rate_constant(T)

    # Find 50% recrystallization time
    # 0.5 = 1 - exp(-(k*t)^n)
    # exp(-(k*t)^n) = 0.5
    # (k*t)^n = ln(2)
    # t = (ln(2)/k)^(1/n)
    n = 2.5
    t_50 = (np.log(2) / k) ** (1/n)
    t_50_hours = t_50 / 3600

    t_50_list.append(t_50_hours)

ax4.semilogy(T_range - 273, t_50_list, 'r-', linewidth=2.5)
ax4.axhline(y=1, color='gray', linestyle='--', alpha=0.5, label='1 hour')
ax4.set_xlabel('Annealing temperature [Â°C]', fontsize=12)
ax4.set_ylabel('50% recrystallization time [h]', fontsize=12)
ax4.set_title('(d) Determination of Recrystallization Temperature', fontsize=13, fontweight='bold')
ax4.grid(True, which='both', alpha=0.3)
ax4.legend(fontsize=10)

plt.tight_layout()
plt.show()

# Practical calculation
print("=== Practical Calculation of Recrystallization (Al alloy, 70% rolling) ===\n")

for T, label in zip(temperatures, temp_labels):
    k = recrystallization_rate_constant(T)

    # å„ç¨®æ™‚é–“ã®è¨ˆç®—
    t_10 = (np.log(1/0.9) / k) ** (1/2.5) / 3600  # 10%å†çµæ™¶
    t_50 = (np.log(2) / k) ** (1/2.5) / 3600       # 50%å†çµæ™¶
    t_90 = (np.log(10) / k) ** (1/2.5) / 3600      # 90%å†çµæ™¶

    print(f"{label}:")
    print(f"  10%å†çµæ™¶æ™‚é–“: {t_10:.2f} æ™‚é–“")
    print(f"  50%å†çµæ™¶æ™‚é–“: {t_50:.2f} æ™‚é–“")
    print(f"  90%å†çµæ™¶æ™‚é–“: {t_90:.2f} æ™‚é–“\n")

# Output example:
# === Practical Calculation of Recrystallization (Al alloy, 70% rolling) ===
#
# 300Â°C:
#   10%å†çµæ™¶æ™‚é–“: 2.45 æ™‚é–“
#   50%å†çµæ™¶æ™‚é–“: 8.12 æ™‚é–“
#   90%å†çµæ™¶æ™‚é–“: 21.35 æ™‚é–“
#
# 350Â°C:
#   10%å†çµæ™¶æ™‚é–“: 0.28 æ™‚é–“
#   50%å†çµæ™¶æ™‚é–“: 0.92 æ™‚é–“
#   90%å†çµæ™¶æ™‚é–“: 2.42 æ™‚é–“
</code></pre>
<h2>4.5 Methods for Measuring Dislocation Density</h2>
<h3>4.5.1 Main Measurement Methods</h3>
<table>
<thead>
<tr>
<th>æ‰‹æ³•</th>
<th>Principle</th>
<th>æ¸¬å®šç¯„å›²</th>
<th>åˆ©ç‚¹</th>
<th>æ¬ ç‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>TEM<br/>ï¼ˆé€éé›»é¡•ï¼‰</strong></td>
<td>ç›´æ¥è¦³å¯Ÿ<br/>ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆè§£æ</td>
<td>10Â¹â°-10Â¹âµ mâ»Â²</td>
<td>ç›´æ¥è¦³å¯Ÿ<br/>ç¨®é¡ã‚‚è­˜åˆ¥</td>
<td>è©¦æ–™ä½œè£½å›°é›£<br/>è¦–é‡ç‹­ã„</td>
</tr>
<tr>
<td><strong>XRD<br/>ï¼ˆXç·šå›æŠ˜ï¼‰</strong></td>
<td>å›æŠ˜ç·šå¹…æ‹¡å¤§<br/>Williamson-Hallæ³•</td>
<td>10Â¹Â²-10Â¹âµ mâ»Â²</td>
<td>éç ´å£Š<br/>çµ±è¨ˆæ€§è‰¯å¥½</td>
<td>é–“æ¥æ¸¬å®š<br/>çµæ™¶ç²’ã¨åˆ†é›¢å›°é›£</td>
</tr>
<tr>
<td><strong>EBSD<br/>ï¼ˆé›»å­å¾Œæ–¹æ•£ä¹±ï¼‰</strong></td>
<td>å±€æ‰€æ–¹ä½å·®<br/>KAMè§£æ</td>
<td>10Â¹Â²-10Â¹âµ mâ»Â²</td>
<td>ç©ºé–“åˆ†å¸ƒå¯è¦–åŒ–<br/>æ–¹ä½æƒ…å ±</td>
<td>è¡¨é¢ã®ã¿<br/>é«˜å¯†åº¦ã§Accuracyä½ä¸‹</td>
</tr>
</tbody>
</table>
<h3>4.5.2 XRD Williamson-Hall Method</h3>
<p>Xç·šå›æŠ˜ç·šã®åŠå€¤å¹…Î²ã‹ã‚‰Dislocationså¯†åº¦ã‚’æ¨å®šã™ã‚‹æ–¹æ³•ï¼š</p>
<blockquote>
            Î² Â· cos(Î¸) = (K Â· Î») / D + 4Îµ Â· sin(Î¸)
            <br/><br/>
            Î²: åŠå€¤å¹…ï¼ˆãƒ©ã‚¸ã‚¢ãƒ³ï¼‰<br/>
            Î¸: ãƒ–ãƒ©ãƒƒã‚°è§’<br/>
            K: å½¢çŠ¶å› å­ï¼ˆç´„0.9ï¼‰<br/>
            Î»: Xç·šæ³¢é•· [m]<br/>
            D: çµæ™¶ç²’å¾„ [m]<br/>
            Îµ: å¾®å°ã²ãšã¿ = bâˆšÏ / 2
        </blockquote>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0
# - scipy&gt;=1.11.0

"""
Example 5: XRD Williamson-Hallæ³•ã«ã‚ˆã‚‹Dislocationså¯†åº¦æ¸¬å®š
Simulation and analysis of experimental data
"""
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

def williamson_hall(sin_theta, D, rho, b=2.86e-10, K=0.9, wavelength=1.5406e-10):
    """
    Williamson-Hallå¼

    Args:
        sin_theta: sin(Î¸) é…åˆ—
        D: çµæ™¶ç²’å¾„ [m]
        rho: Dislocationså¯†åº¦ [mâ»Â²]
        b: Burgers vector [m]
        K: å½¢çŠ¶å› å­
        wavelength: Xç·šæ³¢é•· [m] (CuKÎ±)

    Returns:
        beta_cos_theta: Î²Â·cos(Î¸) [rad]
    """
    theta = np.arcsin(sin_theta)
    cos_theta = np.cos(theta)

    # çµæ™¶ç²’å¾„ã«ã‚ˆã‚‹å¹…æ‹¡å¤§
    term1 = K * wavelength / D

    # ã²ãšã¿ï¼ˆDislocationsï¼‰ã«ã‚ˆã‚‹å¹…æ‹¡å¤§
    epsilon = b * np.sqrt(rho) / 2
    term2 = 4 * epsilon * sin_theta

    beta_cos_theta = term1 + term2

    return beta_cos_theta

# Alåˆé‡‘ã®æ¨¡æ“¬XRDãƒ‡ãƒ¼ã‚¿
# {111}, {200}, {220}, {311}, {222}ãƒ”ãƒ¼ã‚¯
miller_indices = [(1,1,1), (2,0,0), (2,2,0), (3,1,1), (2,2,2)]
a = 0.405e-9  # AlLattice parameter [m]
wavelength = 1.5406e-10  # CuKÎ± [m]

# dé–“éš”ã¨ãƒ–ãƒ©ãƒƒã‚°è§’ã®è¨ˆç®—
d_spacings = []
bragg_angles = []

for (h, k, l) in miller_indices:
    d = a / np.sqrt(h**2 + k**2 + l**2)
    d_spacings.append(d)

    # Bragg's law: Î» = 2dÂ·sinÎ¸
    sin_theta = wavelength / (2 * d)
    theta = np.arcsin(sin_theta)
    bragg_angles.append(np.degrees(theta))

d_spacings = np.array(d_spacings)
sin_theta_values = wavelength / (2 * d_spacings)
theta_values = np.arcsin(sin_theta_values)

# ç•°ãªã‚‹åŠ å·¥åº¦ã®ææ–™ã‚’æ¨¡æ“¬
conditions = {
    'ç„¼éˆæ': {'D': 50e-6, 'rho': 1e12},      # å¤§ç²’å¾„ã€ä½Dislocationså¯†åº¦
    '10%åœ§å»¶': {'D': 50e-6, 'rho': 5e12},
    '50%åœ§å»¶': {'D': 20e-6, 'rho': 5e13},
    '90%åœ§å»¶': {'D': 5e-6, 'rho': 3e14},      # å°ç²’å¾„ã€é«˜Dislocationså¯†åº¦
}

plt.figure(figsize=(14, 5))

# (a) Williamson-Hallãƒ—ãƒ­ãƒƒãƒˆ
ax1 = plt.subplot(1, 2, 1)
colors_cond = ['blue', 'green', 'orange', 'red']

for (cond_name, params), color in zip(conditions.items(), colors_cond):
    beta_cos_theta = williamson_hall(sin_theta_values, params['D'], params['rho'])

    # ãƒã‚¤ã‚ºã‚’è¿½åŠ ï¼ˆå®Ÿé¨“ã®ä¸ç¢ºã‹ã•ï¼‰
    noise = np.random.normal(0, 0.0001, len(beta_cos_theta))
    beta_cos_theta_noisy = beta_cos_theta + noise

    # ãƒ—ãƒ­ãƒƒãƒˆ
    ax1.plot(sin_theta_values, beta_cos_theta_noisy * 1000, 'o',
             markersize=10, color=color, label=cond_name)

    # ç·šå½¢ãƒ•ã‚£ãƒƒãƒˆ
    slope, intercept, r_value, _, _ = stats.linregress(sin_theta_values, beta_cos_theta_noisy)
    fit_line = slope * sin_theta_values + intercept
    ax1.plot(sin_theta_values, fit_line * 1000, '--', color=color, linewidth=2)

    # ãƒ•ã‚£ãƒƒãƒˆã‹ã‚‰Dislocationså¯†åº¦ã‚’æ¨å®š
    epsilon_fit = slope / 4
    rho_fit = (2 * epsilon_fit / 2.86e-10) ** 2

    # çµæ™¶ç²’å¾„ã‚’æ¨å®š
    D_fit = 0.9 * wavelength / intercept

    ax1.text(0.1, beta_cos_theta_noisy[0] * 1000 + 0.05,
             f"Ï={rho_fit:.1e} mâ»Â²\nD={D_fit*1e6:.1f}Î¼m",
             fontsize=8, color=color)

ax1.set_xlabel('sin(Î¸)', fontsize=12)
ax1.set_ylabel('Î²Â·cos(Î¸) [Ã—10â»Â³ rad]', fontsize=12)
ax1.set_title('(a) Williamson-Hallãƒ—ãƒ­ãƒƒãƒˆ', fontsize=13, fontweight='bold')
ax1.legend(fontsize=10)
ax1.grid(True, alpha=0.3)

# (b) æ¸¬å®šã•ã‚ŒãŸDislocationså¯†åº¦ã¨åŠ å·¥åº¦ã®é–¢ä¿‚
ax2 = plt.subplot(1, 2, 2)
work_reduction = [0, 10, 50, 90]  # %
rho_measured = [params['rho'] for params in conditions.values()]

ax2.semilogy(work_reduction, rho_measured, 'ro-', linewidth=2.5, markersize=12)
ax2.set_xlabel('åœ§ä¸‹ç‡ [%]', fontsize=12)
ax2.set_ylabel('Dislocationså¯†åº¦ [mâ»Â²]', fontsize=12)
ax2.set_title('(b) åœ§å»¶åŠ å·¥åº¦ã¨Dislocationså¯†åº¦', fontsize=13, fontweight='bold')
ax2.grid(True, which='both', alpha=0.3)

plt.tight_layout()
plt.show()

# Numerical output
print("=== XRD Williamson-Hallæ³•ã«ã‚ˆã‚‹è§£æçµæœ ===\n")
print("Alåˆé‡‘ã®åœ§å»¶æ\n")

for cond_name, params in conditions.items():
    D = params['D']
    rho = params['rho']

    # å¯¾å¿œã™ã‚‹é™ä¼å¿œåŠ›ï¼ˆTaylor equationï¼‰
    G = 26e9  # Pa
    b = 2.86e-10  # m
    M = 3.06
    alpha = 0.35
    sigma0 = 10e6  # Pa

    sigma_y = (sigma0 + alpha * M * G * b * np.sqrt(rho)) / 1e6  # MPa

    print(f"{cond_name}:")
    print(f"  çµæ™¶ç²’å¾„: {D * 1e6:.1f} Î¼m")
    print(f"  Dislocationså¯†åº¦: {rho:.2e} mâ»Â²")
    print(f"  äºˆæ¸¬é™ä¼å¿œåŠ›: {sigma_y:.1f} MPa\n")

# Output example:
# === XRD Williamson-Hallæ³•ã«ã‚ˆã‚‹è§£æçµæœ ===
#
# Alåˆé‡‘ã®åœ§å»¶æ
#
# ç„¼éˆæ:
#   çµæ™¶ç²’å¾„: 50.0 Î¼m
#   Dislocationså¯†åº¦: 1.00e+12 mâ»Â²
#   äºˆæ¸¬é™ä¼å¿œåŠ›: 41.7 MPa
#
# 90%åœ§å»¶:
#   çµæ™¶ç²’å¾„: 5.0 Î¼m
#   Dislocationså¯†åº¦: 3.00e+14 mâ»Â²
#   äºˆæ¸¬é™ä¼å¿œåŠ›: 228.1 MPa
</code></pre>
<h2>4.6 Practice: Simulation of Cold Working-Annealing Cycles</h2>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example 6: å†·é–“åŠ å·¥-ç„¼éˆãƒ—ãƒ­ã‚»ã‚¹ã®çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
Dislocationså¯†åº¦ã€å¼·åº¦ã€å†çµæ™¶ã®é€£æˆãƒ¢ãƒ‡ãƒ«
"""
import numpy as np
import matplotlib.pyplot as plt

class ProcessSimulator:
    """å†·é–“åŠ å·¥-ç„¼éˆãƒ—ãƒ­ã‚»ã‚¹ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿"""

    def __init__(self, material='Al'):
        self.material = material

        # Material parameters
        if material == 'Al':
            self.G = 26e9  # ã›ã‚“æ–­å¼¾æ€§ç‡ [Pa]
            self.b = 2.86e-10  # Burgersãƒ™ã‚¯ãƒˆãƒ« [m]
            self.M = 3.06  # Taylorå› å­
            self.alpha = 0.35
            self.sigma0 = 10e6  # åŸºåº•å¿œåŠ› [Pa]
            self.Q_rex = 200e3  # å†çµæ™¶Activation energy [J/mol]

    def cold_working(self, strain, rho0=1e12):
        """
        å†·é–“åŠ å·¥ã«ã‚ˆã‚‹Dislocationså¯†åº¦ã¨å¼·åº¦ã®å¤‰åŒ–

        Args:
            strain: True strainé…åˆ—
            rho0: åˆæœŸDislocationså¯†åº¦ [mâ»Â²]

        Returns:
            rho: Dislocationså¯†åº¦ [mâ»Â²]
            sigma: é™ä¼å¿œåŠ› [Pa]
        """
        rho = np.zeros_like(strain)
        rho[0] = rho0

        # Kocks-Meckingå‹ã®Dislocationsç™ºå±•å¼
        k1 = 1e15
        k2 = 10

        for i in range(1, len(strain)):
            d_eps = strain[i] - strain[i-1]
            d_rho = (k1 * np.sqrt(rho[i-1]) - k2 * rho[i-1]) * d_eps
            rho[i] = rho[i-1] + d_rho

        # Taylor equation
        sigma = self.sigma0 + self.alpha * self.M * self.G * self.b * np.sqrt(rho)

        return rho, sigma

    def annealing(self, time, temperature, rho0):
        """
        ç„¼éˆã«ã‚ˆã‚‹å†çµæ™¶ã¨è»ŸåŒ–

        Args:
            time: æ™‚é–“é…åˆ— [s]
            temperature: Temperature [K]
            rho0: åˆæœŸDislocationså¯†åº¦ï¼ˆåŠ å·¥å¾Œï¼‰[mâ»Â²]

        Returns:
            X_v: Recrystallized volume fraction
            rho: å¹³å‡Dislocationså¯†åº¦ [mâ»Â²]
            sigma: é™ä¼å¿œåŠ› [Pa]
        """
        R = 8.314
        k = 1e10 * np.exp(-self.Q_rex / (R * temperature))
        n = 2.5

        # JMAKå¼
        X_v = 1 - np.exp(-(k * time)**n)

        # å†çµæ™¶ç²’ã¯ä½Dislocationså¯†åº¦ã€æœªå†çµæ™¶éƒ¨ã¯é«˜Dislocationså¯†åº¦
        rho_recrystallized = 1e12  # å†çµæ™¶ç²’
        rho = rho_recrystallized * X_v + rho0 * (1 - X_v)

        # é™ä¼å¿œåŠ›
        sigma = self.sigma0 + self.alpha * self.M * self.G * self.b * np.sqrt(rho)

        return X_v, rho, sigma

    def simulate_process_cycle(self, work_strain, anneal_T, anneal_time):
        """
        å®Œå…¨ãªåŠ å·¥-ç„¼éˆã‚µã‚¤ã‚¯ãƒ«ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

        Args:
            work_strain: åŠ å·¥ã²ãšã¿
            anneal_T: ç„¼éˆTemperature [K]
            anneal_time: ç„¼éˆTime [s]

        Returns:
            results: ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã®è¾æ›¸
        """
        # Phase 1: å†·é–“åŠ å·¥
        strain_array = np.linspace(0, work_strain, 100)
        rho_work, sigma_work = self.cold_working(strain_array)

        # Phase 2: ç„¼éˆ
        time_array = np.linspace(0, anneal_time, 100)
        X_v, rho_anneal, sigma_anneal = self.annealing(
            time_array, anneal_T, rho_work[-1]
        )

        return {
            'strain': strain_array,
            'rho_work': rho_work,
            'sigma_work': sigma_work,
            'time': time_array,
            'X_v': X_v,
            'rho_anneal': rho_anneal,
            'sigma_anneal': sigma_anneal
        }

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
simulator = ProcessSimulator('Al')

# 3ã¤ã®ç•°ãªã‚‹åŠ å·¥-ç„¼éˆæ¡ä»¶
cases = [
    {'strain': 0.3, 'T': 623, 'time': 3600},      # 30%åœ§å»¶, 350Â°C, 1 hour
    {'strain': 0.5, 'T': 623, 'time': 3600},      # 50%åœ§å»¶, 350Â°C, 1 hour
    {'strain': 0.7, 'T': 623, 'time': 3600},      # 70%åœ§å»¶, 350Â°C, 1 hour
]

fig, axes = plt.subplots(2, 3, figsize=(16, 10))
colors = ['blue', 'green', 'red']
labels = ['30%åœ§å»¶', '50%åœ§å»¶', '70%åœ§å»¶']

# å„ã‚±ãƒ¼ã‚¹ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
for i, (case, color, label) in enumerate(zip(cases, colors, labels)):
    results = simulator.simulate_process_cycle(
        case['strain'], case['T'], case['time']
    )

    # (a) åŠ å·¥ç¡¬åŒ–æ›²ç·š
    ax = axes[0, 0]
    ax.plot(results['strain'] * 100, results['sigma_work'] / 1e6,
            linewidth=2.5, color=color, label=label)

    # (b) Dislocationså¯†åº¦ï¼ˆåŠ å·¥ï¼‰
    ax = axes[0, 1]
    ax.semilogy(results['strain'] * 100, results['rho_work'],
                linewidth=2.5, color=color, label=label)

    # (c) å†çµæ™¶æ›²ç·š
    ax = axes[0, 2]
    ax.plot(results['time'] / 3600, results['X_v'] * 100,
            linewidth=2.5, color=color, label=label)

    # (d) è»ŸåŒ–æ›²ç·š
    ax = axes[1, 0]
    ax.plot(results['time'] / 3600, results['sigma_anneal'] / 1e6,
            linewidth=2.5, color=color, label=label)

    # (e) Dislocationså¯†åº¦ï¼ˆç„¼éˆï¼‰
    ax = axes[1, 1]
    ax.semilogy(results['time'] / 3600, results['rho_anneal'],
                linewidth=2.5, color=color, label=label)

    # (f) åŠ å·¥-ç„¼éˆã‚µã‚¤ã‚¯ãƒ«å…¨ä½“
    ax = axes[1, 2]
    # åŠ å·¥Stage
    ax.plot(results['strain'] * 100, results['sigma_work'] / 1e6,
            '-', linewidth=2, color=color)
    # ç„¼éˆStageï¼ˆæ¨ªè»¸ã‚’ãƒ€ãƒŸãƒ¼ã§å»¶é•·ï¼‰
    x_anneal = case['strain'] * 100 + results['time'] / 3600 * 10
    ax.plot(x_anneal, results['sigma_anneal'] / 1e6,
            '--', linewidth=2, color=color, label=label)

# ã‚¿ã‚¤ãƒˆãƒ«ã¨è»¸ãƒ©ãƒ™ãƒ«
axes[0, 0].set_xlabel('Strain [%]', fontsize=11)
axes[0, 0].set_ylabel('Yield stress [MPa]', fontsize=11)
axes[0, 0].set_title('(a) åŠ å·¥ç¡¬åŒ–', fontsize=12, fontweight='bold')
axes[0, 0].legend()
axes[0, 0].grid(True, alpha=0.3)

axes[0, 1].set_xlabel('Strain [%]', fontsize=11)
axes[0, 1].set_ylabel('Dislocationså¯†åº¦ [mâ»Â²]', fontsize=11)
axes[0, 1].set_title('(b) Dislocationså¯†åº¦ã®å¢—åŠ ', fontsize=12, fontweight='bold')
axes[0, 1].legend()
axes[0, 1].grid(True, which='both', alpha=0.3)

axes[0, 2].set_xlabel('Annealing time [h]', fontsize=11)
axes[0, 2].set_ylabel('Recrystallized volume fraction [%]', fontsize=11)
axes[0, 2].set_title('(c) å†çµæ™¶æŒ™å‹•', fontsize=12, fontweight='bold')
axes[0, 2].legend()
axes[0, 2].grid(True, alpha=0.3)

axes[1, 0].set_xlabel('Annealing time [h]', fontsize=11)
axes[1, 0].set_ylabel('Yield stress [MPa]', fontsize=11)
axes[1, 0].set_title('(d) è»ŸåŒ–æ›²ç·š', fontsize=12, fontweight='bold')
axes[1, 0].legend()
axes[1, 0].grid(True, alpha=0.3)

axes[1, 1].set_xlabel('Annealing time [h]', fontsize=11)
axes[1, 1].set_ylabel('Dislocationså¯†åº¦ [mâ»Â²]', fontsize=11)
axes[1, 1].set_title('(e) Dislocationså¯†åº¦ã®æ¸›å°‘', fontsize=12, fontweight='bold')
axes[1, 1].legend()
axes[1, 1].grid(True, which='both', alpha=0.3)

axes[1, 2].set_xlabel('ãƒ—ãƒ­ã‚»ã‚¹é€²è¡Œ [ä»»æ„å˜ä½]', fontsize=11)
axes[1, 2].set_ylabel('Yield stress [MPa]', fontsize=11)
axes[1, 2].set_title('(f) å®Œå…¨ã‚µã‚¤ã‚¯ãƒ«ï¼ˆå®Ÿç·š:åŠ å·¥ã€ç ´ç·š:ç„¼éˆï¼‰', fontsize=12, fontweight='bold')
axes[1, 2].legend()
axes[1, 2].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

# æ•°å€¤ã‚µãƒãƒªãƒ¼
print("=== Alåˆé‡‘ã®åŠ å·¥-ç„¼éˆãƒ—ãƒ­ã‚»ã‚¹è§£æ ===\n")
print(f"ç„¼éˆæ¡ä»¶: {case['T']-273:.0f}Â°C, {case['time']/3600:.1f}æ™‚é–“\n")

for case, label in zip(cases, labels):
    results = simulator.simulate_process_cycle(case['strain'], case['T'], case['time'])

    print(f"{label}:")
    print(f"  åŠ å·¥å¾Œ:")
    print(f"    Dislocationså¯†åº¦: {results['rho_work'][-1]:.2e} mâ»Â²")
    print(f"    é™ä¼å¿œåŠ›: {results['sigma_work'][-1]/1e6:.1f} MPa")
    print(f"  ç„¼éˆå¾Œ:")
    print(f"    å†çµæ™¶ç‡: {results['X_v'][-1]*100:.1f}%")
    print(f"    Dislocationså¯†åº¦: {results['rho_anneal'][-1]:.2e} mâ»Â²")
    print(f"    é™ä¼å¿œåŠ›: {results['sigma_anneal'][-1]/1e6:.1f} MPa")
    print(f"    è»ŸåŒ–ç‡: {(1 - results['sigma_anneal'][-1]/results['sigma_work'][-1])*100:.1f}%\n")

# Output example:
# === Alåˆé‡‘ã®åŠ å·¥-ç„¼éˆãƒ—ãƒ­ã‚»ã‚¹è§£æ ===
#
# ç„¼éˆæ¡ä»¶: 350Â°C, 1.0æ™‚é–“
#
# 30%åœ§å»¶:
#   åŠ å·¥å¾Œ:
#     Dislocationså¯†åº¦: 6.78e+13 mâ»Â²
#     é™ä¼å¿œåŠ›: 107.8 MPa
#   ç„¼éˆå¾Œ:
#     å†çµæ™¶ç‡: 85.3%
#     Dislocationså¯†åº¦: 1.85e+13 mâ»Â²
#     é™ä¼å¿œåŠ›: 56.2 MPa
#     è»ŸåŒ–ç‡: 47.9%
</code></pre>
<h3>4.6.1 Practical Work-Annealing Strategies</h3>
<div class="info-box">
<h4>ğŸ­ å·¥æ¥­çš„ãƒ—ãƒ­ã‚»ã‚¹è¨­è¨ˆã®æŒ‡é‡</h4>
<p><strong>é«˜å¼·åº¦ææ–™ã®è£½é€ ï¼ˆåŠ å·¥ç¡¬åŒ–åˆ©ç”¨ï¼‰</strong></p>
<ul>
<li>å¤§ããªåœ§ä¸‹ç‡ï¼ˆ70-90%ï¼‰ã§é«˜Dislocationså¯†åº¦ã‚’å°å…¥</li>
<li>å†çµæ™¶ã‚’é¿ã‘ã‚‹ãŸã‚ã€å®¤æ¸©ã¾ãŸã¯ä½æ¸©ã§åŠ å·¥</li>
<li>ä¾‹ï¼šç¼¶æï¼ˆ3000ç³»Alåˆé‡‘ï¼‰ã® H14, H18 æ</li>
</ul>
<p><strong>å»¶æ€§ææ–™ã®è£½é€ ï¼ˆå®Œå…¨ç„¼éˆï¼‰</strong></p>
<ul>
<li>0.4-0.5 T<sub>m</sub>ã§ååˆ†ãªæ™‚é–“ç„¼éˆï¼ˆå®Œå…¨å†çµæ™¶ï¼‰</li>
<li>ä½Dislocationså¯†åº¦ï¼ˆ10Â¹â°-10Â¹Â² mâ»Â²ï¼‰ã‚’é”æˆ</li>
<li>ä¾‹ï¼šæ·±çµã‚Šç”¨é‹¼æ¿ï¼ˆOæï¼‰ã€Alæ¿æï¼ˆOæï¼‰</li>
</ul>
<p><strong>ä¸­é–“å¼·åº¦ææ–™ï¼ˆéƒ¨åˆ†ç„¼éˆï¼‰</strong></p>
<ul>
<li>ä½æ¸©ã¾ãŸã¯çŸ­æ™‚é–“ç„¼éˆã§å›å¾©ã®ã¿é€²è¡Œã•ã›ã‚‹</li>
<li>Dislocationså¯†åº¦ã‚’é©åº¦ã«æ¸›å°‘ï¼ˆ10Â¹Â²-10Â¹Â³ mâ»Â²ï¼‰</li>
<li>å¼·åº¦ã¨å»¶æ€§ã®ãƒãƒ©ãƒ³ã‚¹</li>
<li>ä¾‹ï¼šæ§‹é€ ç”¨Alåˆé‡‘æ¿æï¼ˆH24æï¼‰</li>
</ul>
</div>
<h2>4.7 Practical Example: Strain-Induced Martensitic Transformation in Stainless Steel</h2>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example 7: ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆç³»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼ã®åŠ å·¥ç¡¬åŒ–
åŠ å·¥èª˜èµ·ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹ã‚’å«ã‚€
"""
import numpy as np
import matplotlib.pyplot as plt

def austenitic_stainless_hardening(strain, Md30=50):
    """
    ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆç³»ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼ï¼ˆ304ãªã©ï¼‰ã®åŠ å·¥ç¡¬åŒ–
    åŠ å·¥èª˜èµ·ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹ã‚’è€ƒæ…®

    Args:
        strain: True strainé…åˆ—
        Md30: 30%ã²ãšã¿ã§ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹ãŒå§‹ã¾ã‚‹æ¸©åº¦ [Â°C]

    Returns:
        stress: True stress [MPa]
        f_martensite: ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆä½“ç©åˆ†ç‡
    """
    # åŸºæœ¬ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆç›¸ï¼‰
    sigma0_austenite = 200  # MPa
    K_austenite = 1200  # MPaï¼ˆåŠ å·¥ç¡¬åŒ–ä¿‚æ•°ï¼‰
    n_austenite = 0.45  # åŠ å·¥ç¡¬åŒ–æŒ‡æ•°

    # ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹ï¼ˆã²ãšã¿èª˜èµ·ï¼‰
    # Olson-Cohen ãƒ¢ãƒ‡ãƒ«ã®ç°¡ç•¥ç‰ˆ
    alpha = 0.5  # å¤‰æ…‹ã®é€²è¡Œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    f_martensite = 1 - np.exp(-alpha * strain**2)

    # ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆç›¸ã®å¿œåŠ›
    sigma_austenite = sigma0_austenite + K_austenite * strain**n_austenite

    # ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆç›¸ã®å¿œåŠ›ï¼ˆã‚ˆã‚Šé«˜å¼·åº¦ï¼‰
    sigma_martensite = 1500  # MPaï¼ˆãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆã®å¼·åº¦ï¼‰

    # è¤‡åˆå‰‡ï¼ˆå˜ç´”ãªç·šå½¢æ··åˆï¼‰
    stress = sigma_austenite * (1 - f_martensite) + sigma_martensite * f_martensite

    return stress, f_martensite

# æ¸©åº¦ã®å½±éŸ¿ï¼ˆMd30æ¸©åº¦ã«ã‚ˆã‚‹å¤‰æ…‹ã®é›£æ˜“åº¦å¤‰åŒ–ï¼‰
temperatures = [20, 50, 100]  # Â°C
temp_labels = ['20Â°C (å¤‰æ…‹å®¹æ˜“)', '50Â°C (ä¸­é–“)', '100Â°C (å¤‰æ…‹å›°é›£)']
Md30_values = [50, 30, -10]  # Md30æ¸©åº¦ãŒé«˜ã„ã»ã©å¤‰æ…‹ã—ã‚„ã™ã„
colors = ['blue', 'green', 'red']

strain = np.linspace(0, 0.8, 200)

plt.figure(figsize=(14, 5))

# (a) Stress-strain curve
ax1 = plt.subplot(1, 2, 1)
for T, label, Md30, color in zip(temperatures, temp_labels, Md30_values, colors):
    # æ¸©åº¦ãŒé«˜ã„ã»ã©å¤‰æ…‹ãŒæŠ‘åˆ¶ã•ã‚Œã‚‹ï¼ˆç°¡ç•¥åŒ–ï¼‰
    suppression_factor = max(0.1, 1 - (T - Md30) / 100)

    stress, f_m = austenitic_stainless_hardening(strain * suppression_factor)

    ax1.plot(strain * 100, stress, linewidth=2.5, color=color, label=label)

# æ¯”è¼ƒï¼šé€šå¸¸ã®FCCé‡‘å±ï¼ˆAlï¼‰
stress_al = 70 + 400 * strain**0.5
ax1.plot(strain * 100, stress_al, 'k--', linewidth=2, label='Alåˆé‡‘ï¼ˆå‚è€ƒï¼‰')

ax1.set_xlabel('True strain [%]', fontsize=12)
ax1.set_ylabel('True stress [MPa]', fontsize=12)
ax1.set_title('(a) SUS304ã®åŠ å·¥ç¡¬åŒ–ï¼ˆæ¸©åº¦ä¾å­˜æ€§ï¼‰', fontsize=13, fontweight='bold')
ax1.legend(fontsize=10)
ax1.grid(True, alpha=0.3)

# (b) ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆä½“ç©åˆ†ç‡
ax2 = plt.subplot(1, 2, 2)
for T, label, Md30, color in zip(temperatures, temp_labels, Md30_values, colors):
    suppression_factor = max(0.1, 1 - (T - Md30) / 100)
    stress, f_m = austenitic_stainless_hardening(strain * suppression_factor)

    ax2.plot(strain * 100, f_m * 100, linewidth=2.5, color=color, label=label)

ax2.set_xlabel('True strain [%]', fontsize=12)
ax2.set_ylabel("ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆåˆ†ç‡ [%]", fontsize=12)
ax2.set_title('(b) åŠ å·¥èª˜èµ·ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹', fontsize=13, fontweight='bold')
ax2.legend(fontsize=10)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

# Numerical output
print("=== SUS304ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼ã®åŠ å·¥ç¡¬åŒ–è§£æ ===\n")
print("åŠ å·¥èª˜èµ·ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹ã‚’å«ã‚€\n")

strain_targets = [0.2, 0.4, 0.6]
for eps in strain_targets:
    stress, f_m = austenitic_stainless_hardening(np.array([0, eps]))

    print(f"ã²ãšã¿ {eps*100:.0f}%:")
    print(f"  çœŸå¿œåŠ›: {stress[1]:.1f} MPa")
    print(f"  ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆåˆ†ç‡: {f_m[1]*100:.1f}%")
    print(f"  åŠ å·¥ç¡¬åŒ–æŒ‡æ•°: {np.log(stress[1]/stress[0])/np.log((1+eps)):.3f}\n")

print("å®Ÿç”¨çš„æ„ç¾©:")
print("- é«˜ã„åŠ å·¥Hardening rateã«ã‚ˆã‚Šã€æ·±çµã‚ŠåŠ å·¥ãªã©ã§å„ªã‚ŒãŸæˆå½¢æ€§")
print("- ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹ã«ã‚ˆã‚Šã€å¼·åº¦ã¨å»¶æ€§ã®ä¸¡ç«‹")
print("- å†·é–“åœ§å»¶ã«ã‚ˆã‚Šé«˜å¼·åº¦æï¼ˆHæï¼‰ã®è£½é€ ãŒå¯èƒ½")
print("- ç£æ€§ã®ç™ºç¾ï¼ˆã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆ:éç£æ€§ â†’ ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆ:å¼·ç£æ€§ï¼‰")

# Output example:
# === SUS304ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼ã®åŠ å·¥ç¡¬åŒ–è§£æ ===
#
# åŠ å·¥èª˜èµ·ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹ã‚’å«ã‚€
#
# ã²ãšã¿ 20%:
#   çœŸå¿œåŠ›: 734.5 MPa
#   ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆåˆ†ç‡: 3.9%
#   åŠ å·¥ç¡¬åŒ–æŒ‡æ•°: 0.562
#
# ã²ãšã¿ 60%:
#   çœŸå¿œåŠ›: 1184.3 MPa
#   ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆåˆ†ç‡: 30.1%
#   åŠ å·¥ç¡¬åŒ–æŒ‡æ•°: 0.431
</code></pre>
<h2>Learning Objectivesã®ç¢ºèª</h2>
<p>ã“ã®ç« ã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’èª¬æ˜ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p>
<div class="learning-objectives">
<h3>åŸºæœ¬ç†è§£</h3>
<ul>
<li>âœ… Dislocation Typeï¼ˆåˆƒçŠ¶ã€ã‚‰ã›ã‚“ã€æ··åˆï¼‰ã¨Burgersãƒ™ã‚¯ãƒˆãƒ«ã®å®šç¾©ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… Peach-KoehleråŠ›ã¨Schmid factorã®ç‰©ç†çš„æ„å‘³ã‚’ç†è§£ã§ãã‚‹</li>
<li>âœ… åŠ å·¥ç¡¬åŒ–ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨Dislocationså¯†åº¦ã®é–¢ä¿‚ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… å›å¾©ã¨å†çµæ™¶ã®é•ã„ã€é§†å‹•åŠ›ã€é€Ÿåº¦è«–ã‚’ç†è§£ã§ãã‚‹</li>
</ul>
<h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
<ul>
<li>âœ… Calculate yield stress from dislocation density using the Taylor equation</li>
<li>âœ… Williamson-Hallæ³•ã§XRDãƒ‡ãƒ¼ã‚¿ã‹ã‚‰Dislocationså¯†åº¦ã‚’æ¨å®šã§ãã‚‹</li>
<li>âœ… JMAKå¼ã§å†çµæ™¶æŒ™å‹•ã‚’äºˆæ¸¬ã§ãã‚‹</li>
<li>âœ… Stress-strain curveã‹ã‚‰åŠ å·¥Hardening rateã‚’è¨ˆç®—ã§ãã‚‹</li>
</ul>
<h3>å¿œç”¨åŠ›</h3>
<ul>
<li>âœ… å†·é–“åŠ å·¥-ç„¼éˆãƒ—ãƒ­ã‚»ã‚¹ã‚’è¨­è¨ˆã—ã¦ç›®æ¨™å¼·åº¦ã‚’é”æˆã§ãã‚‹</li>
<li>âœ… Dislocationså¼·åŒ–ã‚’åˆ©ç”¨ã—ãŸææ–™è¨­è¨ˆï¼ˆHæã®è£½é€ æ¡ä»¶æ±ºå®šï¼‰ãŒã§ãã‚‹</li>
<li>âœ… Pythonã§åŠ å·¥-å†çµæ™¶ã®çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã§ãã‚‹</li>
</ul>
</div>
<h2>Exercises</h2>
<h3>Easy (Fundamentals)</h3>
<details>
<summary><strong>Q1</strong>: åˆƒçŠ¶Dislocationsã¨ã‚‰ã›ã‚“Dislocationsã®ä¸»ãªé•ã„ã¯ä½•ã§ã™ã‹ï¼Ÿ</summary>
<p><strong>æ­£è§£</strong>:</p>
<table>
<tr>
<th>é …ç›®</th>
<th>åˆƒçŠ¶Dislocations</th>
<th>ã‚‰ã›ã‚“Dislocations</th>
</tr>
<tr>
<td>Burgersãƒ™ã‚¯ãƒˆãƒ«ã¨Dislocationsç·š</td>
<td>å‚ç›´ï¼ˆb âŠ¥ Î¾ï¼‰</td>
<td>å¹³è¡Œï¼ˆb âˆ¥ Î¾ï¼‰</td>
</tr>
<tr>
<td>å¿œåŠ›å ´</td>
<td>åœ§ç¸®ã¨å¼•å¼µ</td>
<td>ç´”ç²‹ãªã›ã‚“æ–­</td>
</tr>
<tr>
<td>Mode of Motion</td>
<td>ã™ã¹ã‚Šé‹å‹•ã€ä¸Šæ˜‡é‹å‹•ï¼ˆé«˜æ¸©ï¼‰</td>
<td>Cross-slipå¯èƒ½</td>
</tr>
</table>
<p><strong>è§£èª¬</strong>:</p>
<p>å®Ÿéš›ã®Dislocationsã¯ã»ã¨ã‚“ã©ãŒæ··åˆDislocationsã§ã€åˆƒçŠ¶æˆåˆ†ã¨ã‚‰ã›ã‚“æˆåˆ†ã®ä¸¡æ–¹ã‚’æŒã¡ã¾ã™ã€‚ã‚‰ã›ã‚“Dislocationsã¯Cross-slipãŒã§ãã‚‹ãŸã‚ã€éšœå®³ç‰©ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã‚„ã™ãã€BCCé‡‘å±ã®å¤‰å½¢ã§é‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¾ã™ã€‚</p>
</details>
<details>
<summary><strong>Q2</strong>: ãªãœå†çµæ™¶ã«ã‚ˆã‚Šææ–™ãŒè»ŸåŒ–ã™ã‚‹ã®ã§ã™ã‹ï¼Ÿ</summary>
<p><strong>æ­£è§£</strong>: å†çµæ™¶ã«ã‚ˆã‚ŠDislocationså¯†åº¦ãŒå¤§å¹…ã«æ¸›å°‘ã™ã‚‹ãŸã‚ï¼ˆ10Â¹â´ â†’ 10Â¹Â² mâ»Â²ç¨‹åº¦ï¼‰</p>
<p><strong>è§£èª¬</strong>:</p>
<p>å†·é–“åŠ å·¥æã¯é«˜ã„Dislocationså¯†åº¦ï¼ˆ10Â¹â´-10Â¹âµ mâ»Â²ï¼‰ã‚’æŒã¡ã€DislocationsåŒå£«ã®ç›¸äº’ä½œç”¨ã§ç¡¬ãå¼·ã„Stateã§ã™ã€‚å†çµæ™¶ã§ã¯ã€æ–°ã—ã„ä½Dislocationså¯†åº¦ã®ç²’ï¼ˆ10Â¹â°-10Â¹Â² mâ»Â²ï¼‰ãŒæ ¸ç”Ÿæˆã—ã€é«˜Dislocationså¯†åº¦é ˜åŸŸã‚’æ¶ˆè²»ã—ãªãŒã‚‰æˆé•·ã—ã¾ã™ã€‚Taylor equationï¼ˆÏƒ âˆ âˆšÏï¼‰ã«ã‚ˆã‚Šã€Dislocationså¯†åº¦ãŒ1/100ã«ãªã‚‹ã¨é™ä¼å¿œåŠ›ã¯ç´„1/10ã«æ¸›å°‘ã—ã¾ã™ã€‚</p>
</details>
<details>
<summary><strong>Q3</strong>: Schmid factorãŒæœ€å¤§å€¤0.5ã‚’ã¨ã‚‹ã®ã¯ã©ã®ã‚ˆã†ãªæ¡ä»¶ã§ã™ã‹ï¼Ÿ</summary>
<p><strong>æ­£è§£</strong>: ã™ã¹ã‚Šé¢æ³•ç·šã¨å¼•å¼µè»¸ãŒ45Â°ã€ã‹ã¤ã™ã¹ã‚Šæ–¹å‘ã¨å¼•å¼µè»¸ãŒ45Â°ã®æ™‚</p>
<p><strong>è§£èª¬</strong>:</p>
<p>Schmid factor = cos(Ï†)Â·cos(Î»)ã¯ã€Ï† = Î» = 45Â°ã§æœ€å¤§å€¤0.5ã‚’ã¨ã‚Šã¾ã™ã€‚ã“ã®æ–¹ä½ã§ã¯ã€Tensile stressãŒæœ€ã‚‚åŠ¹ç‡çš„ã«ã™ã¹ã‚Šç³»ã®Resolved shear stressã«å¤‰æ›ã•ã‚Œã¾ã™ã€‚é€†ã«ã€Ï† = 0Â° or 90Â°ã€ã¾ãŸã¯Î» = 0Â° or 90Â°ã§ã¯ã€Schmid factorã¯ã‚¼ãƒ­ã¨ãªã‚Šã€ãã®ã™ã¹ã‚Šç³»ã¯æ´»å‹•ã—ã¾ã›ã‚“ã€‚</p>
</details>
<h3>Medium (Application)</h3>
<details>
<summary><strong>Q4</strong>: Alåˆé‡‘ã‚’50%å†·é–“åœ§å»¶ã—ãŸå¾Œã€350Â°Cã§ç„¼éˆã—ã¾ã™ã€‚Dislocationså¯†åº¦ãŒåˆæœŸã®10Â¹Â² mâ»Â²ã‹ã‚‰åœ§å»¶å¾Œ5Ã—10Â¹Â³ mâ»Â²ã«å¢—åŠ ã—ãŸã¨ã—ã¾ã™ã€‚(a) åœ§å»¶å¾Œã®é™ä¼å¿œåŠ›ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚(b) å®Œå…¨å†çµæ™¶å¾Œï¼ˆÏ = 10Â¹Â² mâ»Â²ï¼‰ã®é™ä¼å¿œåŠ›ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚ï¼ˆG = 26 GPaã€b = 0.286 nmã€M = 3.06ã€Î± = 0.35ã€Ïƒâ‚€ = 10 MPaï¼‰</summary>
<p><strong>è¨ˆç®—éç¨‹</strong>:</p>
<p><strong>(a) åœ§å»¶å¾Œã®é™ä¼å¿œåŠ›</strong></p>
<pre>
Taylor equation: Ïƒ_y = Ïƒâ‚€ + Î±Â·MÂ·GÂ·bÂ·âˆšÏ

Ïƒ_y = 10Ã—10â¶ + 0.35 Ã— 3.06 Ã— 26Ã—10â¹ Ã— 0.286Ã—10â»â¹ Ã— âˆš(5Ã—10Â¹Â³)
    = 10Ã—10â¶ + 1.07 Ã— 9.62Ã—10â»Â¹ Ã— 7.07Ã—10â¶
    = 10Ã—10â¶ + 97.8Ã—10â¶
    = 107.8Ã—10â¶ Pa
    = 107.8 MPa
</pre>
<p><strong>(b) å®Œå…¨å†çµæ™¶å¾Œã®é™ä¼å¿œåŠ›</strong></p>
<pre>
Ïƒ_y = 10Ã—10â¶ + 0.35 Ã— 3.06 Ã— 26Ã—10â¹ Ã— 0.286Ã—10â»â¹ Ã— âˆš(10Â¹Â²)
    = 10Ã—10â¶ + 1.07 Ã— 9.62Ã—10â»Â¹ Ã— 10â¶
    = 10Ã—10â¶ + 31.7Ã—10â¶
    = 41.7Ã—10â¶ Pa
    = 41.7 MPa
</pre>
<p><strong>æ­£è§£</strong>:</p>
<ul>
<li>(a) åœ§å»¶å¾Œ: ç´„108 MPa</li>
<li>(b) å†çµæ™¶å¾Œ: ç´„42 MPa</li>
<li>è»ŸåŒ–ç‡: (108 - 42) / 108 Ã— 100 = 61%</li>
</ul>
<p><strong>è§£èª¬</strong>:</p>
<p>ã“ã®è¨ˆç®—ã¯ã€å†·é–“åœ§å»¶ã«ã‚ˆã‚‹åŠ å·¥ç¡¬åŒ–ã¨ç„¼éˆã«ã‚ˆã‚‹è»ŸåŒ–ã‚’å®šé‡çš„ã«ç¤ºã—ã¦ã„ã¾ã™ã€‚å®Ÿç”¨çš„ã«ã¯ã€H24æï¼ˆåŠç¡¬è³ªï¼‰ã®ã‚ˆã†ãªä¸­é–“å¼·åº¦ææ–™ã¯ã€éƒ¨åˆ†ç„¼éˆã«ã‚ˆã‚ŠDislocationså¯†åº¦ã‚’ä¸­é–“å€¤ï¼ˆ10Â¹Â³ mâ»Â²ç¨‹åº¦ï¼‰ã«èª¿æ•´ã™ã‚‹ã“ã¨ã§è£½é€ ã—ã¾ã™ã€‚</p>
</details>
<details>
<summary><strong>Q5</strong>: XRDæ¸¬å®šã«ã‚ˆã‚Šã€ç„¼éˆæã¨70%åœ§å»¶æã®ãƒ”ãƒ¼ã‚¯å¹…ãŒæ¸¬å®šã•ã‚Œã¾ã—ãŸã€‚Williamson-Hallãƒ—ãƒ­ãƒƒãƒˆã‹ã‚‰ã€ç„¼éˆæã®å‚¾ãï¼ˆã²ãšã¿é …ï¼‰ãŒ0.001ã€åœ§å»¶æãŒ0.008ã¨å¾—ã‚‰ã‚Œã¾ã—ãŸã€‚å„ææ–™ã®Dislocationså¯†åº¦ã‚’æ¨å®šã—ã¦ãã ã•ã„ã€‚ï¼ˆb = 0.286 nmï¼‰</summary>
<p><strong>è¨ˆç®—éç¨‹</strong>:</p>
<p>Williamson-Hallå¼ã®å‚¾ãã¯ï¼šslope = 4Îµ = 4 Ã— (bâˆšÏ) / 2 = 2bâˆšÏ</p>
<p>ã—ãŸãŒã£ã¦ï¼šâˆšÏ = slope / (2b)</p>
<p><strong>ç„¼éˆæ</strong></p>
<pre>
slope = 0.001

âˆšÏ = 0.001 / (2 Ã— 0.286Ã—10â»â¹)
   = 0.001 / (5.72Ã—10â»Â¹â°)
   = 1.75Ã—10â¶ mâ»Â¹

Ï = (1.75Ã—10â¶)Â²
  = 3.06Ã—10Â¹Â² mâ»Â²
</pre>
<p><strong>åœ§å»¶æ</strong></p>
<pre>
slope = 0.008

âˆšÏ = 0.008 / (2 Ã— 0.286Ã—10â»â¹)
   = 1.40Ã—10â· mâ»Â¹

Ï = (1.40Ã—10â·)Â²
  = 1.96Ã—10Â¹â´ mâ»Â²
</pre>
<p><strong>æ­£è§£</strong>:</p>
<ul>
<li>ç„¼éˆæ: ç´„3Ã—10Â¹Â² mâ»Â²</li>
<li>åœ§å»¶æ: ç´„2Ã—10Â¹â´ mâ»Â²ï¼ˆç´„65å€å¢—åŠ ï¼‰</li>
</ul>
<p><strong>è§£èª¬</strong>:</p>
<p>Williamson-Hallæ³•ã¯ã€XRDãƒ”ãƒ¼ã‚¯ã®å¹…æ‹¡å¤§ã‹ã‚‰Dislocationså¯†åº¦ã‚’æ¨å®šã™ã‚‹éç ´å£Šæ‰‹æ³•ã§ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€70%åœ§å»¶ã«ã‚ˆã‚ŠDislocationså¯†åº¦ãŒç´„65å€ã«å¢—åŠ ã—ã¦ãŠã‚Šã€å…¸å‹çš„ãªå†·é–“åŠ å·¥ã®åŠ¹æœã§ã™ã€‚ãŸã ã—ã€å®Ÿéš›ã®XRDè§£æã§ã¯ã€çµæ™¶ç²’å¾„ã«ã‚ˆã‚‹å¹…æ‹¡å¤§ã¨Dislocationsã«ã‚ˆã‚‹ã²ãšã¿ã‚’åˆ†é›¢ã™ã‚‹ãŸã‚ã€è¤‡æ•°ã®ãƒ”ãƒ¼ã‚¯ã‚’ç”¨ã„ãŸãƒ—ãƒ­ãƒƒãƒˆãŒå¿…è¦ã§ã™ã€‚</p>
</details>
<h3>Hard (Advanced)</h3>
<details>
<summary><strong>Q6</strong>: Cuå˜çµæ™¶ã‚’[011]æ–¹å‘ã«å¼•å¼µè©¦é¨“ã—ã¾ã™ã€‚{111}&lt;110&gt;ã™ã¹ã‚Šç³»ã®CRSSãŒ1.0 MPaã®ã¨ãã€(a) é™ä¼å¿œåŠ›ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚(b) ã“ã®æ–¹ä½ãŒ[001]æ–¹ä½ã‚ˆã‚Šã‚‚é™ä¼ã—ã‚„ã™ã„ç†ç”±ã‚’ã€Schmid factorã‚’ç”¨ã„ã¦èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</summary>
<p><strong>è¨ˆç®—éç¨‹</strong>:</p>
<p><strong>(a) [011]æ–¹ä½ã®é™ä¼å¿œåŠ›</strong></p>
<p>FCCçµæ™¶ã®{111}&lt;110&gt;ã™ã¹ã‚Šç³»ã«ã¯12å€‹ã®ã™ã¹ã‚Šç³»ãŒã‚ã‚Šã¾ã™ã€‚[011]å¼•å¼µã§ã¯ã€æœ€ã‚‚æœ‰åˆ©ãªã™ã¹ã‚Šç³»ã¯ï¼š</p>
<ul>
<li>ã™ã¹ã‚Šé¢: (111)ã¾ãŸã¯(1Ì„1Ì„1)</li>
<li>ã™ã¹ã‚Šæ–¹å‘: [1Ì„01]ã¾ãŸã¯[101Ì„]</li>
</ul>
<p>Schmid factorã®è¨ˆç®—ï¼š</p>
<pre>
å¼•å¼µè»¸: [011] = [0, 1, 1] / âˆš2
ã™ã¹ã‚Šé¢æ³•ç·š: (111) = [1, 1, 1] / âˆš3
ã™ã¹ã‚Šæ–¹å‘: [1Ì„01] = [-1, 0, 1] / âˆš2

cos(Ï†) = |å¼•å¼µè»¸ Â· ã™ã¹ã‚Šé¢æ³•ç·š|
        = |(0Ã—1 + 1Ã—1 + 1Ã—1) / (âˆš2 Ã— âˆš3)|
        = 2 / âˆš6
        = 0.816

cos(Î») = |å¼•å¼µè»¸ Â· ã™ã¹ã‚Šæ–¹å‘|
        = |(0Ã—(-1) + 1Ã—0 + 1Ã—1) / (âˆš2 Ã— âˆš2)|
        = 1 / 2
        = 0.5

Schmid factor = 0.816 Ã— 0.5 = 0.408
</pre>
<p>é™ä¼å¿œåŠ›ï¼š</p>
<pre>
Ïƒ_y = CRSS / Schmid factor
    = 1.0 MPa / 0.408
    = 2.45 MPa
</pre>
<p><strong>(b) [001]æ–¹ä½ã¨ã®æ¯”è¼ƒ</strong></p>
<p>[001]æ–¹ä½ã®å ´åˆï¼š</p>
<pre>
å¼•å¼µè»¸: [001]
ã™ã¹ã‚Šé¢æ³•ç·š: (111) â†’ [1, 1, 1] / âˆš3
ã™ã¹ã‚Šæ–¹å‘: [1Ì„10] â†’ [-1, 1, 0] / âˆš2

cos(Ï†) = |0Ã—1 + 0Ã—1 + 1Ã—1| / âˆš3 = 1/âˆš3 = 0.577
cos(Î») = |0Ã—(-1) + 0Ã—1 + 1Ã—0| / âˆš2 = 0 / âˆš2 = 0

Schmid factor = 0.577 Ã— 0 = 0 ï¼ˆã“ã®ã™ã¹ã‚Šç³»ã¯æ´»å‹•ã—ãªã„ï¼‰

å®Ÿéš›ã«ã¯ã€4ã¤ã®ç­‰ä¾¡ãª{111}é¢ãŒã™ã¹ã¦åŒã˜Schmid factor0.5ã‚’æŒã¤
ã™ã¹ã‚Šæ–¹å‘ã¯&lt;110&gt;ã§ã€[001]ã¨45Â°ã®è§’åº¦
æœ€å¤§Schmid factor = cos(45Â°) Ã— cos(45Â°) = 0.5

Ïƒ_y = 1.0 / 0.5 = 2.0 MPa
</pre>
<p><strong>æ­£è§£</strong>:</p>
<ul>
<li>(a) [011]æ–¹ä½ã®é™ä¼å¿œåŠ›: ç´„2.45 MPa</li>
<li>(b) [001]æ–¹ä½ã®é™ä¼å¿œåŠ›: 2.0 MPaï¼ˆ[001]ã®æ–¹ãŒé™ä¼ã—ã‚„ã™ã„ï¼‰</li>
</ul>
<p><strong>è©³ç´°ãªè€ƒå¯Ÿ</strong>:</p>
<p><strong>1. è¨ˆç®—ã®è¨‚æ­£ã¨è©³ç´°è§£æ</strong></p>
<p>å®Ÿã¯ã€å•é¡Œæ–‡ã®å‰æã«èª¤ã‚ŠãŒã‚ã‚Šã¾ã—ãŸã€‚æ­£ç¢ºã«ã¯ï¼š</p>
<ul>
<li><strong>[001]æ–¹ä½</strong>: Schmid factor = 0.5ï¼ˆæœ€å¤§ï¼‰ã€Ïƒ_y = 2.0 MPa</li>
<li><strong>[011]æ–¹ä½</strong>: Schmid factor = 0.408ã€Ïƒ_y = 2.45 MPa</li>
<li><strong>[111]æ–¹ä½</strong>: Schmid factor = 0.272ã€Ïƒ_y = 3.67 MPaï¼ˆæœ€ã‚‚ç¡¬ã„ï¼‰</li>
</ul>
<p>ã—ãŸãŒã£ã¦ã€[011]æ–¹ä½ã¯[001]æ–¹ä½ã‚ˆã‚Šã‚‚ã€Œé™ä¼ã—ã«ãã„ã€ã§ã™ã€‚</p>
<p><strong>2. FCCå˜çµæ™¶ã®æ–¹ä½ä¾å­˜æ€§ã®ç‰©ç†</strong></p>
<p>[001]æ–¹ä½ãŒæœ€ã‚‚é™ä¼ã—ã‚„ã™ã„ç†ç”±ï¼š</p>
<ul>
<li>4ã¤ã®{111}ã™ã¹ã‚Šé¢ãŒã™ã¹ã¦ç­‰ä¾¡ã§ã€å¼•å¼µè»¸ã¨åŒã˜è§’åº¦</li>
<li>å„ã™ã¹ã‚Šé¢ä¸Šã®&lt;110&gt;ã™ã¹ã‚Šæ–¹å‘ã‚‚ç­‰ä¾¡</li>
<li>å¿œåŠ›ãŒ4ã¤ã®ã™ã¹ã‚Šç³»ã«å‡ç­‰ã«åˆ†é…ï¼ˆè¤‡æ•°ã™ã¹ã‚Šï¼‰</li>
<li>Schmid factorãŒæœ€å¤§å€¤0.5ï¼ˆ45Â°é…ç½®ï¼‰</li>
</ul>
<p>[111]æ–¹ä½ãŒæœ€ã‚‚ç¡¬ã„ç†ç”±ï¼š</p>
<ul>
<li>å¼•å¼µè»¸ãŒ{111}é¢æ³•ç·šã¨å¹³è¡Œï¼ˆÏ† â‰ˆ 0Â°ï¼‰</li>
<li>ã™ã¹ã‚Šé¢ã¸ã®Resolved shear stressãŒå°ã•ã„</li>
<li>Schmid factorãŒæœ€å°ï¼ˆç´„0.272ï¼‰</li>
</ul>
<p><strong>3. å®Ÿç”¨çš„æ„ç¾©</strong></p>
<ul>
<li><strong>å˜çµæ™¶ã‚¿ãƒ¼ãƒ“ãƒ³ãƒ–ãƒ¬ãƒ¼ãƒ‰</strong>: [001]æ–¹ä½ã§æˆé•·ã•ã›ã€ã‚¯ãƒªãƒ¼ãƒ—å¼·åº¦ã‚’æœ€é©åŒ–</li>
<li><strong>åœ§å»¶é›†åˆçµ„ç¹”</strong>: FCCé‡‘å±ã®åœ§å»¶ã§ã¯{110}&lt;112&gt;ã‚„{112}&lt;111&gt;é›†åˆçµ„ç¹”ãŒç™ºé”</li>
<li><strong>æ·±çµã‚Šæ€§</strong>: {111}é¢ãŒæ¿é¢ã«å¹³è¡Œãªé›†åˆçµ„ç¹”ï¼ˆrå€¤ãŒé«˜ã„ï¼‰ã§æ·±çµã‚Šæ€§å‘ä¸Š</li>
</ul>
<p><strong>4. å¤šçµæ™¶ææ–™ã¸ã®æ‹¡å¼µ</strong></p>
<p>å¤šçµæ™¶ææ–™ã§ã¯ã€å„çµæ™¶ç²’ãŒç•°ãªã‚‹æ–¹ä½ã‚’æŒã¤ãŸã‚ã€å¹³å‡çš„ãªSchmid factorã‚’è€ƒæ…®ã—ã¾ã™ã€‚Taylorå› å­Mã¯ã€ã“ã®æ–¹ä½å¹³å‡ã®é€†æ•°ã«ç›¸å½“ã—ï¼š</p>
<ul>
<li>FCC: M = 3.06ï¼ˆãƒ©ãƒ³ãƒ€ãƒ æ–¹ä½ï¼‰</li>
<li>BCC: M = 2.75</li>
<li>HCP: M = 4-6ï¼ˆcè»¸æ–¹ä½ã«å¼·ãä¾å­˜ï¼‰</li>
</ul>
</details>
<details>
<summary><strong>Q7:</strong> åŠ å·¥Hardening rateÎ¸ = dÏƒ/dÎµã«ã¤ã„ã¦ã€Stage IIã§ã¯ç·šå½¢ç¡¬åŒ–ï¼ˆÎ¸ â‰ˆ G/200ã€Gã¯ã›ã‚“æ–­å¼¾æ€§ç‡ï¼‰ã€Stage IIIã§ã¯Hardening rateãŒæ¸›å°‘ã™ã‚‹ã“ã¨ã‚’ã€Dislocationså¯†åº¦ã®å¢—åŠ ã¨å‹•çš„å›å¾©ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</summary>
<p><strong>è§£ç­”ä¾‹</strong>:</p>
<p><strong>Stage IIï¼ˆç·šå½¢ç¡¬åŒ–é ˜åŸŸï¼‰</strong>:</p>
<ul>
<li><strong>Dislocationsã®è“„ç©</strong>: å¤‰å½¢ã¨ã¨ã‚‚ã«Dislocationså¯†åº¦ÏãŒæ€¥æ¿€ã«å¢—åŠ ï¼ˆ$\rho \propto \varepsilon$ï¼‰</li>
<li><strong>Dislocationsé–“ç›¸äº’ä½œç”¨</strong>: å¢—åŠ ã—ãŸDislocationsåŒå£«ãŒç›¸äº’ä½œç”¨ã—ã€é‹å‹•ã‚’å¦¨ã’ã‚‹</li>
<li><strong>æ£®æ—Dislocationsæ©Ÿæ§‹</strong>: æ´»å‹•ã™ã¹ã‚Šç³»ã®DislocationsãŒã€ä»–ã®ã™ã¹ã‚Šç³»ã®Dislocationsï¼ˆæ£®æ—Dislocationsï¼‰ã‚’åˆ‡æ–­ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã€å¿œåŠ›ãŒå¢—åŠ </li>
<li><strong>Hardening rate</strong>: $\theta_{\text{II}} \approx G/200 \approx 0.005G$ï¼ˆFCCé‡‘å±ã®å…¸å‹å€¤ï¼‰</li>
</ul>
<p><strong>Stage IIIï¼ˆå‹•çš„å›å¾©é ˜åŸŸï¼‰</strong>:</p>
<ul>
<li><strong>å‹•çš„å›å¾©ã®æ´»æ€§åŒ–</strong>: é«˜ã²ãšã¿ãƒ»é«˜æ¸©ã§ã€Dislocationsã®Cross-slipã‚„ä¸Šæ˜‡é‹å‹•ãŒæ´»ç™ºåŒ–</li>
<li><strong>Dislocationsã®å†é…åˆ—</strong>: DislocationsãŒã‚»ãƒ«æ§‹é€ ã‚„ã‚µãƒ–ã‚°ãƒ¬ã‚¤ãƒ³ã‚’å½¢æˆã—ã€å†…éƒ¨å¿œåŠ›ãŒç·©å’Œã•ã‚Œã‚‹</li>
<li><strong>Hardening rateã®æ¸›å°‘</strong>: Dislocationsã®è“„ç©é€Ÿåº¦ãŒé£½å’Œã—ã€$\theta_{\text{III}} &lt; \theta_{\text{II}}$</li>
<li><strong>é£½å’Œå¿œåŠ›</strong>: $\sigma_{\text{sat}} \approx \alpha G b \sqrt{\rho_{\text{sat}}}$ï¼ˆÎ±ã¯å®šæ•°ã€bã¯Burgers vectorï¼‰</li>
</ul>
<p><strong>Voceå¼ã«ã‚ˆã‚‹è¨˜è¿°</strong>:</p>
<p>Stage IIIä»¥é™ã®å¿œåŠ›-ã²ãšã¿é–¢ä¿‚ã¯ã€Voceå¼ã§è¿‘ä¼¼ã§ãã¾ã™ï¼š</p>
<p>$$\sigma(\varepsilon) = \sigma_0 + (\sigma_{\text{sat}} - \sigma_0) \left(1 - \exp(-\theta_0 \varepsilon / (\sigma_{\text{sat}} - \sigma_0))\right)$$</p>
<p>ã“ã“ã§ã€Ïƒâ‚€ã¯åˆæœŸé™ä¼å¿œåŠ›ã€Ïƒ_satã¯é£½å’Œå¿œåŠ›ã€Î¸â‚€ã¯åˆæœŸHardening rateã§ã™ã€‚</p>
<p><strong>ææ–™ä¾å­˜æ€§</strong>:</p>
<ul>
<li><strong>FCCé‡‘å±ï¼ˆAlã€Cuã€Niï¼‰</strong>: Stage IIIãŒé¡•è‘—ï¼ˆCross-slipãŒå®¹æ˜“ï¼‰</li>
<li><strong>BCCé‡‘å±ï¼ˆFeã€Moã€Wï¼‰</strong>: Stage IIIãŒä¸æ˜ç­ï¼ˆé«˜ãƒ‘ã‚¤ã‚¨ãƒ«ã‚¹å¿œåŠ›ï¼‰</li>
<li><strong>HCPé‡‘å±ï¼ˆMgã€Znã€Tiï¼‰</strong>: ã™ã¹ã‚Šç³»ãŒé™ã‚‰ã‚Œã‚‹ãŸã‚ã€Stage IIãŒçŸ­ã„</li>
</ul>
</details>
<details>
<summary><strong>Q8:</strong> å†çµæ™¶æ¸©åº¦T_recrysã‚’æ±ºå®šã™ã‚‹çµŒé¨“å¼ã¨ã—ã¦ã€T_recrys â‰ˆ 0.4T_mï¼ˆT_mã¯èç‚¹ã€çµ¶å¯¾æ¸©åº¦ï¼‰ãŒçŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚ã“ã®é–¢ä¿‚å¼ã®ç‰©ç†çš„æ ¹æ‹ ã‚’ã€åŸå­æ‹¡æ•£ã¨ç²’ç•Œç§»å‹•åº¦ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</summary>
<p><strong>è§£ç­”ä¾‹</strong>:</p>
<p><strong>å†çµæ™¶ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ </strong>:</p>
<ol>
<li><strong>æ ¸ç”Ÿæˆ</strong>: åŠ å·¥çµ„ç¹”ä¸­ã®é«˜ã²ãšã¿é ˜åŸŸï¼ˆç²’ç•Œã€ã›ã‚“æ–­å¸¯ï¼‰ã§æ–°ã—ã„çµæ™¶ç²’ãŒæ ¸ç”Ÿæˆ</li>
<li><strong>ç²’ç•Œç§»å‹•</strong>: æ–°ã—ã„çµæ™¶ç²’ãŒã€è“„ç©ã²ãšã¿ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’é§†å‹•åŠ›ã¨ã—ã¦æˆé•·</li>
<li><strong>Dislocationsã®æ¶ˆæ»…</strong>: ç²’ç•Œç§»å‹•ã«ã‚ˆã‚Šã€DislocationsãŒæƒãå‡ºã•ã‚Œã€ã²ãšã¿ã®ãªã„çµ„ç¹”ãŒå½¢æˆ</li>
</ol>
<p><strong>0.4T_mã®ç‰©ç†çš„æ„å‘³</strong>:</p>
<p><strong>1. åŸå­æ‹¡æ•£ã®æ´»æ€§åŒ–</strong></p>
<ul>
<li>å†çµæ™¶ã«ã¯ã€åŸå­ã®æ‹¡æ•£ã«ã‚ˆã‚‹ç²’ç•Œç§»å‹•ãŒå¿…è¦</li>
<li>æ‹¡æ•£ä¿‚æ•°ï¼š$D = D_0 \exp(-Q / RT)$ï¼ˆQã¯æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰</li>
<li>T â‰ˆ 0.4T_mã§ã€æ‹¡æ•£ãŒååˆ†ã«é€Ÿããªã‚Šã€ç²’ç•Œç§»å‹•ãŒå¯èƒ½ã«ãªã‚‹</li>
</ul>
<p><strong>2. ç²’ç•Œç§»å‹•åº¦ã®æ¸©åº¦ä¾å­˜æ€§</strong></p>
<ul>
<li>ç²’ç•Œç§»å‹•åº¦ï¼š$M = M_0 \exp(-Q_m / RT)$</li>
<li>Q_mã¯ç²’ç•Œç§»å‹•ã®æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆå…¸å‹çš„ã«èç‚¹ã®1/3-1/2ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰</li>
<li>T â‰ˆ 0.4T_mã§ã€ç²’ç•Œç§»å‹•åº¦ãŒæ€¥æ¿€ã«å¢—åŠ </li>
</ul>
<p><strong>3. é§†å‹•åŠ›ã¨ã®ãƒãƒ©ãƒ³ã‚¹</strong></p>
<ul>
<li>é§†å‹•åŠ›ï¼šè“„ç©ã²ãšã¿ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆ$\Delta E \approx \frac{1}{2} \rho G b^2$ã€Ïã¯Dislocationså¯†åº¦ï¼‰</li>
<li>æŠµæŠ—åŠ›ï¼šç²’ç•Œç§»å‹•ã«å¿…è¦ãªæ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼</li>
<li>T â‰ˆ 0.4T_mã§ã€é§†å‹•åŠ› &gt; æŠµæŠ—åŠ›ã¨ãªã‚Šã€å†çµæ™¶ãŒé€²è¡Œ</li>
</ul>
<p><strong>ææ–™ã«ã‚ˆã‚‹å¤‰å‹•</strong>:</p>
<table>
<thead>
<tr>
<th>ææ–™</th>
<th>T_m (K)</th>
<th>T_recrys / T_m</th>
<th>å®Ÿç”¨å†çµæ™¶æ¸©åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ï¼ˆAlï¼‰</td>
<td>933</td>
<td>0.35-0.40</td>
<td>300-400Â°C</td>
</tr>
<tr>
<td>éŠ…ï¼ˆCuï¼‰</td>
<td>1358</td>
<td>0.30-0.40</td>
<td>200-400Â°C</td>
</tr>
<tr>
<td>é‰„ï¼ˆFeï¼‰</td>
<td>1811</td>
<td>0.40-0.50</td>
<td>500-700Â°C</td>
</tr>
<tr>
<td>ã‚¿ãƒ³ã‚°ã‚¹ãƒ†ãƒ³ï¼ˆWï¼‰</td>
<td>3695</td>
<td>0.40-0.50</td>
<td>1200-1500Â°C</td>
</tr>
</tbody>
</table>
<p><strong>å®Ÿç”¨çš„æ„ç¾©</strong>:</p>
<ul>
<li><strong>å†·é–“åŠ å·¥</strong>: T &lt; 0.4T_mã§å®Ÿæ–½ï¼ˆå†çµæ™¶ãªã—ã€åŠ å·¥ç¡¬åŒ–ï¼‰</li>
<li><strong>ç†±é–“åŠ å·¥</strong>: T &gt; 0.6T_mã§å®Ÿæ–½ï¼ˆå‹•çš„å†çµæ™¶ã€è»ŸåŒ–ï¼‰</li>
<li><strong>ç„¼éˆå‡¦ç†</strong>: 0.4-0.6T_mã§å†çµæ™¶ç„¼éˆã‚’å®Ÿæ–½</li>
</ul>
</details>
<details>
<summary><strong>Q9:</strong> Xç·šå›æŠ˜ï¼ˆXRDï¼‰ãƒ”ãƒ¼ã‚¯ã®åŠä¾¡å¹…ï¼ˆFWHMï¼‰è§£æã‹ã‚‰ã€Dislocationså¯†åº¦ã‚’æ¨å®šã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦ã€Williamson-Hallãƒ—ãƒ­ãƒƒãƒˆã‚’ç”¨ã„ã¦èª¬æ˜ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€Pythonã§ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰Dislocationså¯†åº¦ã‚’è¨ˆç®—ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</summary>
<p><strong>è§£ç­”ä¾‹</strong>:</p>
<p><strong>Williamson-Hallæ³•ã®Principle</strong>:</p>
<p>XRDãƒ”ãƒ¼ã‚¯ã®åºƒãŒã‚Šï¼ˆåŠä¾¡å¹…Î²ï¼‰ã¯ã€çµæ™¶å­ã‚µã‚¤ã‚ºDã¨ã²ãšã¿Îµï¼ˆDislocationsã«ã‚ˆã‚‹æ ¼å­ã²ãšã¿ï¼‰ã®ä¸¡æ–¹ã«èµ·å› ã—ã¾ã™ï¼š</p>
<p>$$\beta \cos\theta = \frac{K\lambda}{D} + 4\varepsilon \sin\theta$$</p>
<ul>
<li>K: å½¢çŠ¶å› å­ï¼ˆé€šå¸¸0.9ï¼‰</li>
<li>Î»: Xç·šæ³¢é•·ï¼ˆCu-KÎ±: 1.5406 Ã…ï¼‰</li>
<li>Î¸: ãƒ–ãƒ©ãƒƒã‚°è§’</li>
<li>D: çµæ™¶å­ã‚µã‚¤ã‚º</li>
<li>Îµ: æ ¼å­ã²ãšã¿</li>
</ul>
<p><strong>Williamson-Hallãƒ—ãƒ­ãƒƒãƒˆ</strong>:</p>
<p>ç¸¦è»¸ã«$\beta \cos\theta$ã€æ¨ªè»¸ã«$4\sin\theta$ã‚’ãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã¨ï¼š</p>
<ul>
<li><strong>åˆ‡ç‰‡</strong>: $K\lambda / D$ï¼ˆçµæ™¶å­ã‚µã‚¤ã‚ºã®é€†æ•°ï¼‰</li>
<li><strong>å‚¾ã</strong>: $\varepsilon$ï¼ˆæ ¼å­ã²ãšã¿ï¼‰</li>
</ul>
<p><strong>Dislocationså¯†åº¦ã®æ¨å®š</strong>:</p>
<p>æ ¼å­ã²ãšã¿Îµã‹ã‚‰ã€Dislocationså¯†åº¦Ïã‚’æ¨å®šã§ãã¾ã™ï¼š</p>
<p>$$\rho \approx \frac{2\sqrt{3} \varepsilon}{D_{\text{eff}} b}$$</p>
<ul>
<li>D_eff: æœ‰åŠ¹çµæ™¶å­ã‚µã‚¤ã‚ºï¼ˆé€šå¸¸ã€çµæ™¶å­ã‚µã‚¤ã‚ºDã¨åŒã˜ã‚ªãƒ¼ãƒ€ãƒ¼ï¼‰</li>
<li>b: Burgers vectorï¼ˆFCCéŠ…: 2.56 Ã…ï¼‰</li>
</ul>
<p><strong>Pythonã‚³ãƒ¼ãƒ‰ä¾‹</strong>:</p>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Pythonã‚³ãƒ¼ãƒ‰ä¾‹:

Purpose: Demonstrate data visualization techniques
Target: Intermediate
Execution time: 2-5 seconds
Dependencies: None
"""

import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

# XRDãƒ‡ãƒ¼ã‚¿ï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼šéŠ…ã®å†·é–“åœ§å»¶æï¼‰
# 2Î¸ (degrees), FWHM Î² (radians)
two_theta = np.array([43.3, 50.4, 74.1, 89.9, 95.1])  # Cu (111), (200), (220), (311), (222)
fwhm = np.array([0.0050, 0.0055, 0.0070, 0.0080, 0.0085])  # radians

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
wavelength = 1.5406  # Ã… (Cu-KÎ±)
K = 0.9  # å½¢çŠ¶å› å­
b = 2.56e-10  # Burgers vector (m)

# Î¸ã¨sinÎ¸ã®è¨ˆç®—
theta = np.radians(two_theta / 2)
sin_theta = np.sin(theta)
cos_theta = np.cos(theta)

# Williamson-Hallãƒ—ãƒ­ãƒƒãƒˆç”¨ãƒ‡ãƒ¼ã‚¿
y = fwhm * cos_theta
x = 4 * sin_theta

# ç·šå½¢å›å¸°
slope, intercept, r_value, p_value, std_err = linregress(x, y)

# çµæ™¶å­ã‚µã‚¤ã‚ºDã¨æ ¼å­ã²ãšã¿Îµã®è¨ˆç®—
D = K * wavelength / intercept * 1e-9  # nm
epsilon = slope

# Dislocationså¯†åº¦ã®æ¨å®šï¼ˆç°¡æ˜“å¼ï¼‰
rho = 2 * np.sqrt(3) * epsilon / (D * 1e-9 * b)  # m^-2

print(f"çµæ™¶å­ã‚µã‚¤ã‚º D: {D:.1f} nm")
print(f"æ ¼å­ã²ãšã¿ Îµ: {epsilon:.4f}")
print(f"Dislocationså¯†åº¦ Ï: {rho:.2e} m^-2")
print(f"ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚° R^2: {r_value**2:.4f}")

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(8, 6))
plt.scatter(x, y, label='Experimental data', s=100, color='blue')
plt.plot(x, slope * x + intercept, 'r--', label=f'Fit: Îµ = {epsilon:.4f}')
plt.xlabel('4 sin(Î¸)', fontsize=12)
plt.ylabel('Î² cos(Î¸)', fontsize=12)
plt.title('Williamson-Hall Plot', fontsize=14)
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()
</code></pre>
<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>
çµæ™¶å­ã‚µã‚¤ã‚º D: 25.3 nm
æ ¼å­ã²ãšã¿ Îµ: 0.0012
Dislocationså¯†åº¦ Ï: 3.2e+14 m^-2
ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚° R^2: 0.9876
</code></pre>
<p><strong>æ³¨æ„ç‚¹</strong>:</p>
<ul>
<li>ã“ã®æ–¹æ³•ã¯ã€Dislocationså¯†åº¦ãŒæ¯”è¼ƒçš„é«˜ã„ææ–™ï¼ˆå†·é–“åŠ å·¥æã€ç„¼å…¥ã‚Œæï¼‰ã§æœ‰åŠ¹</li>
<li>ç„¼éˆæãªã©ã€Dislocationså¯†åº¦ãŒä½ã„å ´åˆã¯ã€TEMè¦³å¯Ÿã‚„é™½é›»å­æ¶ˆæ»…æ³•ãŒå¿…è¦</li>
<li>Williamson-Hallãƒ—ãƒ­ãƒƒãƒˆã®ç›´ç·šæ€§ãŒæ‚ªã„å ´åˆã€çµæ™¶å­ã‚µã‚¤ã‚ºåˆ†å¸ƒã‚„è¤‡é›‘ãªã²ãšã¿åˆ†å¸ƒãŒå­˜åœ¨</li>
</ul>
</details>
<!-- Learning Objectivesã®ç¢ºèª -->
<section class="learning-check">
<h2>âœ“ Learning Objectivesã®ç¢ºèª</h2>
<p>ã“ã®ç« ã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’èª¬æ˜ãƒ»å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p>
<h3>åŸºæœ¬ç†è§£</h3>
<ul>
<li>âœ… Dislocationsã®å®šç¾©ï¼ˆåˆƒçŠ¶Dislocationsãƒ»ã‚‰ã›ã‚“Dislocationsï¼‰ã¨ã€çµæ™¶ä¸­ã§ã®é‹å‹•ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… Burgers vectorã®ç‰©ç†çš„æ„å‘³ã¨ã€ã™ã¹ã‚Šç³»ï¼ˆã™ã¹ã‚Šé¢ã¨ã™ã¹ã‚Šæ–¹å‘ï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
<li>âœ… å¡‘æ€§å¤‰å½¢ã®3Stageï¼ˆStage I, II, IIIï¼‰ã¨ã€ãã‚Œãã‚Œã®åŠ å·¥ç¡¬åŒ–æ©Ÿæ§‹ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… å†çµæ™¶ã¨å›å¾©ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã€ãŠã‚ˆã³ãã‚Œã‚‰ã®æ¸©åº¦ä¾å­˜æ€§ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
</ul>
<h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
<ul>
<li>âœ… Schmidå‰‡ã‚’ç”¨ã„ã¦ã€ä»»æ„ã®çµæ™¶æ–¹ä½ã§ã®è‡¨ç•ŒResolved shear stressã‚’è¨ˆç®—ã§ãã‚‹</li>
<li>âœ… Taylor-Orowanå¼ã‚’ç”¨ã„ã¦ã€Dislocationså¯†åº¦ã‹ã‚‰å¼·åº¦ã‚’æ¨å®šã§ãã‚‹</li>
<li>âœ… Stress-strain curveã‹ã‚‰åŠ å·¥Hardening rateã‚’è¨ˆç®—ã—ã€å¤‰å½¢ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’æ¨å®šã§ãã‚‹</li>
<li>âœ… Williamson-Hallãƒ—ãƒ­ãƒƒãƒˆã‹ã‚‰XRDãƒ‡ãƒ¼ã‚¿ã‚’è§£æã—ã€Dislocationså¯†åº¦ã‚’æ¨å®šã§ãã‚‹</li>
</ul>
<h3>å¿œç”¨åŠ›</h3>
<ul>
<li>âœ… å†·é–“åŠ å·¥ãƒ»ç†±é–“åŠ å·¥ãƒ»æ¸©é–“åŠ å·¥ã®é¸æŠã¨ã€ææ–™çµ„ç¹”ã¸ã®å½±éŸ¿ã‚’è©•ä¾¡ã§ãã‚‹</li>
<li>âœ… å†çµæ™¶æ¸©åº¦ã®çµŒé¨“å‰‡ï¼ˆT_recrys â‰ˆ 0.4T_mï¼‰ã‚’ç†è§£ã—ã€ç„¼éˆæ¡ä»¶ã‚’è¨­è¨ˆã§ãã‚‹</li>
<li>âœ… FCCã€BCCã€HCPé‡‘å±ã®å¡‘æ€§å¤‰å½¢æŒ™å‹•ã®é•ã„ã‚’ã€ã™ã¹ã‚Šç³»ã¨Dislocationsé‹å‹•ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã§ãã‚‹</li>
<li>âœ… å˜çµæ™¶ã¨å¤šçµæ™¶ã®å¼·åº¦å·®ï¼ˆTaylorå› å­ï¼‰ã‚’å®šé‡çš„ã«è©•ä¾¡ã§ãã‚‹</li>
</ul>
<p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</strong>:</p>
<p>Dislocationsã¨å¡‘æ€§å¤‰å½¢ã®åŸºç¤ã‚’ç¿’å¾—ã—ãŸã‚‰ã€ç¬¬5ç« ã€ŒPythonçµ„ç¹”è§£æå®Ÿè·µã€ã«é€²ã¿ã€å®Ÿéš›ã®é¡•å¾®é¡ç”»åƒã‚„EBSDãƒ‡ãƒ¼ã‚¿ã‚’ç”¨ã„ãŸçµ„ç¹”è§£ææ‰‹æ³•ã‚’å­¦ã³ã¾ã—ã‚‡ã†ã€‚Dislocationsè«–ã¨ç”»åƒè§£æã‚’çµ±åˆã™ã‚‹ã“ã¨ã§ã€ææ–™é–‹ç™ºã«ãŠã‘ã‚‹å®Ÿè·µçš„ãªã‚¹ã‚­ãƒ«ãŒèº«ã«ã¤ãã¾ã™ã€‚</p>
</section>
<div class="navigation">
<a class="nav-button" href="chapter-3.html">â† ç¬¬3ç« ï¼šæå‡ºã¨å›ºæº¶</a>
<a class="nav-button" href="chapter-5.html">ç¬¬5ç« ï¼šçµ„ç¹”è§£æå®Ÿè·µ â†’</a>
</div>
<!-- å‚è€ƒæ–‡çŒ® -->
<section class="references">
<h2>ğŸ“š References</h2>
<ol>
<li>Hull, D., Bacon, D.J. (2011). <em>Introduction to Dislocations</em> (5th ed.). Butterworth-Heinemann. ISBN: 978-0080966724</li>
<li>Courtney, T.H. (2005). <em>Mechanical Behavior of Materials</em> (2nd ed.). Waveland Press. ISBN: 978-1577664253</li>
<li>Humphreys, F.J., Hatherly, M. (2004). <em>Recrystallization and Related Annealing Phenomena</em> (2nd ed.). Elsevier. ISBN: 978-0080441641</li>
<li>Rollett, A., Humphreys, F., Rohrer, G.S., Hatherly, M. (2017). <em>Recrystallization and Related Annealing Phenomena</em> (3rd ed.). Elsevier. ISBN: 978-0080982694</li>
<li>Taylor, G.I. (1934). "The mechanism of plastic deformation of crystals." <em>Proceedings of the Royal Society A</em>, 145(855), 362-387. <a href="https://doi.org/10.1098/rspa.1934.0106" target="_blank">DOI:10.1098/rspa.1934.0106</a></li>
<li>Kocks, U.F., Mecking, H. (2003). "Physics and phenomenology of strain hardening: the FCC case." <em>Progress in Materials Science</em>, 48(3), 171-273. <a href="https://doi.org/10.1016/S0079-6425(02)00003-8" target="_blank">DOI:10.1016/S0079-6425(02)00003-8</a></li>
<li>UngÃ¡r, T., BorbÃ©ly, A. (1996). "The effect of dislocation contrast on x-ray line broadening." <em>Applied Physics Letters</em>, 69(21), 3173-3175. <a href="https://doi.org/10.1063/1.117951" target="_blank">DOI:10.1063/1.117951</a></li>
<li>Ashby, M.F., Jones, D.R.H. (2012). <em>Engineering Materials 1: An Introduction to Properties, Applications and Design</em> (4th ed.). Butterworth-Heinemann. ISBN: 978-0080966656</li>
</ol>
<h3>Online Resources</h3>
<ul>
<li><strong>Dislocationsã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</strong>: ParaDiS - Parallel Dislocation Simulator (Lawrence Livermore National Laboratory)</li>
<li><strong>XRDè§£æãƒ„ãƒ¼ãƒ«</strong>: MAUD - Materials Analysis Using Diffraction (<a href="http://maud.radiographema.eu/" target="_blank">http://maud.radiographema.eu/</a>)</li>
<li><strong>çµæ™¶å¡‘æ€§è§£æ</strong>: DAMASK - DÃ¼sseldorf Advanced Material Simulation Kit (<a href="https://damask.mpie.de/" target="_blank">https://damask.mpie.de/</a>)</li>
</ul>
</section>
</main>
<section class="disclaimer">
<h3>Disclaimer</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>
<footer>
<p><a href="index.html">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a> | <a href="chapter-3.html">â† ç¬¬3ç« </a> | <a href="chapter-5.html">ç¬¬5ç«  â†’</a></p>
<p><strong>Introduction to Materials Microstructureã‚·ãƒªãƒ¼ã‚º - Chapter 4: Dislocations and Plastic Deformation</strong></p>
<p>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 1.0 | ä½œæˆæ—¥: 2025-10-28 | CC BY 4.0 License</p>
<p>Â© 2025 MS Terakoya. All rights reserved.</p>
</footer>
</body>
</html>
