<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 3ï¼šé€éå‹é›»å­é¡•å¾®é¡ï¼ˆTEMï¼‰å…¥é–€ - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .breadcrumb {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .breadcrumb a {
            color: var(--color-link);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Chapter 3ï¼šé€éå‹é›»å­é¡•å¾®é¡ï¼ˆTEMï¼‰å…¥é–€</h1>
            <p class="subtitle">TEMçµåƒç†è«–ã€å›æŠ˜analysisã€é«˜minè§£èƒ½è¦³å¯Ÿfundamentals of</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†hours: 25-35min</span>
                <span class="meta-item">ğŸ“Š Level: Intermediate</span>
                <span class="meta-item">ğŸ’» Code Examples: 7å€‹</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AI Terakoya Home</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">é›»å­é¡•å¾®é¡å…¥é–€</a> &gt;
        Chapter 3
    </div>

    <main class="container">
        <p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); border-left: 4px solid #f093fb; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">
            é€éå‹é›»å­é¡•å¾®é¡ï¼ˆTEMï¼‰ã¯ã€è©¦æ–™ã‚’é€éã—ãŸé›»å­ç·šã‚’åˆ©ç”¨ã—ã¦ã€ææ–™ã®å†…éƒ¨æ§‹é€ ã‚’atomãƒ¬ãƒ™ãƒ«ã§è¦³å¯Ÿã™ã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã“ã®ç« ã§ã¯ã€TEMçµåƒç†è«–ã€æ˜è¦–é‡ãƒ»æš—è¦–é‡åƒã€åˆ¶é™è¦–é‡å›æŠ˜ï¼ˆSAEDï¼‰ã€é«˜minè§£èƒ½TEMï¼ˆHRTEMï¼‰ã€åå·®è£œæ­£æŠ€è¡“ã‚’å­¦ã³ã€Pythonã§å›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³analysisã¨FFTå‡¦ç†ã‚’practiceã—ã¾ã™ã€‚
        </p>

        <div class="learning-objectives">
            <h2>Learning Objectives</h2>
            <p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹masterã§ãã¾ã™ï¼š</p>
            <ul>
                <li>âœ… TEMçµåƒç†è«–ã¨ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆæ©Ÿæ§‹ï¼ˆè³ªé‡åšã•ã€å›æŠ˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆï¼‰understandã™ã‚‹</li>
                <li>âœ… æ˜è¦–é‡åƒï¼ˆBFï¼‰ã¨æš—è¦–é‡åƒï¼ˆDFï¼‰ã®å½¢æˆåŸç†ã¨ä½¿ã„minã‘able to</li>
                <li>âœ… åˆ¶é™è¦–é‡é›»å­å›æŠ˜ï¼ˆSAEDï¼‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æŒ‡æ•°ä»˜ã‘able to</li>
                <li>âœ… æ ¼å­åƒã¨é«˜minè§£èƒ½TEMåƒã®é•ã„understandã—ã€FFTanalysisable to</li>
                <li>âœ… ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ï¼ˆCTFï¼‰ã®å½¹å‰²ã¨åå·®è£œæ­£æŠ€è¡“ã‚’Descriptionã§ãã‚‹</li>
                <li>âœ… Pythonã§ã‚¨ãƒ¯ãƒ«ãƒ‰çƒæ§‹æˆã€SAEDanalysisã€HRTEMåƒã®FFTå‡¦ç†ã‚’å®Ÿè£…ã§ãã‚‹</li>
                <li>âœ… ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã¨çƒé¢åå·®ãŒåƒã«ä¸ãˆã‚‹å½±éŸ¿ã‚’å®šé‡çš„ã«è©•ä¾¡ã§ãã‚‹</li>
            </ul>
        </div>

        <h2>3.1 TEMçµåƒç†è«–fundamentals of</h2>

        <h3>3.1.1 é€éé›»å­é¡•å¾®é¡ã®æ§‹æˆ</h3>
        <p>TEMï¼ˆTransmission Electron Microscopeï¼‰ã¯ã€è©¦æ–™ã‚’é€éã—ãŸé›»å­ç·šã‚’å¯¾ç‰©ãƒ¬ãƒ³ã‚ºã§çµåƒã—ã€æŠ•å½±ãƒ¬ãƒ³ã‚ºã§æ‹¡å¤§ã™ã‚‹å…‰å­¦ç³»ã‚’æŒã¡ã¾ã™ã€‚</p>

        <div class="mermaid">
flowchart TD
    A[é›»å­éŠƒ] --> B[ç…§å°„ç³»ãƒ¬ãƒ³ã‚º]
    B --> C[è©¦æ–™ã‚¹ãƒ†ãƒ¼ã‚¸]
    C --> D[å¯¾ç‰©ãƒ¬ãƒ³ã‚º]
    D --> E[åˆ¶é™è¦–é‡çµã‚Š<br/>Selected Area Aperture]
    E --> F[ä¸­é–“ãƒ¬ãƒ³ã‚º]
    F --> G[æŠ•å½±ãƒ¬ãƒ³ã‚º]
    G --> H[è›å…‰ã‚¹ã‚¯ãƒªãƒ¼ãƒ³/æ¤œå‡ºå™¨]

    D -.å›æŠ˜é¢.-> I[ãƒãƒƒã‚¯ãƒ•ã‚©ãƒ¼ã‚«ãƒ«é¢<br/>BFP]
    I -.-> F
    D -.åƒé¢.-> J[ã‚¬ã‚¦ã‚¹åƒé¢]
    J -.-> F

    style A fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style D fill:#f5576c,stroke:#f093fb,stroke-width:2px,color:#fff
    style I fill:#ffeb99,stroke:#ffa500
    style J fill:#99ccff,stroke:#0066cc
        </div>

        <p><strong>é‡è¦ãªæ¦‚å¿µ</strong>ï¼š</p>
        <ul>
            <li><strong>ãƒãƒƒã‚¯ãƒ•ã‚©ãƒ¼ã‚«ãƒ«é¢ï¼ˆBFP: Back Focal Planeï¼‰</strong>ï¼šå¯¾ç‰©ãƒ¬ãƒ³ã‚ºã®ç„¦ç‚¹é¢ã€‚ã“ã“ã«å›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒå½¢æˆã•ã‚Œã‚‹</li>
            <li><strong>ã‚¬ã‚¦ã‚¹åƒé¢</strong>ï¼šè©¦æ–™ã®å®ŸåƒãŒå½¢æˆã•ã‚Œã‚‹é¢</li>
            <li><strong>å¯¾ç‰©çµã‚Š</strong>ï¼šBFPã«é…ç½®ã•ã‚Œã€ç‰¹å®šã®å›æŠ˜ã‚¹ãƒãƒƒãƒˆã‚’é¸æŠã—ã¦ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã‚’åˆ¶å¾¡</li>
            <li><strong>åˆ¶é™è¦–é‡çµã‚Š</strong>ï¼šåƒé¢ã«é…ç½®ã•ã‚Œã€ç‰¹å®šã®é ˜åŸŸã‹ã‚‰å›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å–å¾—ï¼ˆSAED: Selected Area Electron Diffractionï¼‰</li>
        </ul>

        <h3>3.1.2 TEMåƒã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆæ©Ÿæ§‹</h3>
        <p>TEMåƒã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã¯ä¸»ã«3ã¤ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã§å½¢æˆã•ã‚Œã¾ã™ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆç¨®é¡</th>
                    <th>ç‰©ç†çš„èµ·æº</th>
                    <th>é©ç”¨ä¾‹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>è³ªé‡åšã•ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ</strong></td>
                    <td>è©¦æ–™ã®å¯†åº¦ãƒ»åšã•ã«ã‚ˆã‚‹é›»å­ã®æ•£ä¹±å¼·åº¦å·®</td>
                    <td>éæ™¶è³ªè©¦æ–™ã€ç”Ÿç‰©è©¦æ–™ã€åšã•å¤‰åŒ–ã®è¦³å¯Ÿ</td>
                </tr>
                <tr>
                    <td><strong>å›æŠ˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ</strong></td>
                    <td>çµæ™¶ã®å›æŠ˜æ¡ä»¶ï¼ˆãƒ–ãƒ©ãƒƒã‚°æ¡ä»¶ï¼‰ã®å¤‰åŒ–</td>
                    <td>è»¢ä½ã€åŒæ™¶ã€çµæ™¶ç²’ç•Œã®è¦³å¯Ÿ</td>
                </tr>
                <tr>
                    <td><strong>ä½ç›¸ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ</strong></td>
                    <td>é€éæ³¢ã¨å›æŠ˜æ³¢ã®ä½ç›¸å·®ã«ã‚ˆã‚‹å¹²æ¸‰</td>
                    <td>é«˜minè§£èƒ½TEMï¼ˆHRTEMï¼‰ã§ã®æ ¼å­åƒè¦³å¯Ÿ</td>
                </tr>
            </tbody>
        </table>

        <p><strong>æ˜è¦–é‡åƒï¼ˆBright Field, BFï¼‰</strong>ï¼šå¯¾ç‰©çµã‚Šã§é€éãƒ“ãƒ¼ãƒ ï¼ˆ000åå°„ï¼‰ã®ã¿ã‚’é€šéã•ã›ã‚‹ã€‚åšã„éƒ¨minã‚„æ•£ä¹±ã®å¼·ã„éƒ¨minãŒæš—ãè¦‹ãˆã‚‹ã€‚</p>
        <p><strong>æš—è¦–é‡åƒï¼ˆDark Field, DFï¼‰</strong>ï¼šå¯¾ç‰©çµã‚Šã§ç‰¹å®šã®å›æŠ˜ãƒ“ãƒ¼ãƒ ã®ã¿ã‚’é€šéã•ã›ã‚‹ã€‚ãã®åå°„æ¡ä»¶ã‚’æº€ãŸã™çµæ™¶ç²’ã®ã¿ãŒæ˜ã‚‹ãå…‰ã‚‹ã€‚</p>

        <h3>3.1.3 ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ï¼ˆCTFï¼‰</h3>
        <p>é«˜minè§£èƒ½TEMã§ã¯ã€ä½ç›¸ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒé‡è¦ã§ã™ã€‚ã“ã®ä½ç›¸ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã¯<strong>ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ï¼ˆContrast Transfer Function, CTFï¼‰</strong>ã§è¨˜è¿°ã•ã‚Œã¾ã™ï¼š</p>

        $$
        \text{CTF}(k) = A(k) \sin\left[\chi(k)\right]
        $$

        <p>ã“ã“ã§ã€$A(k)$ ã¯çµã‚Šé–¢æ•°ã€$\chi(k)$ ã¯ä½ç›¸ã‚·ãƒ•ãƒˆã§æ¬¡å¼ã§è¡¨ã•ã‚Œã¾ã™ï¼š</p>

        $$
        \chi(k) = \frac{2\pi}{\lambda}\left(\frac{\lambda^2 k^2}{2}\Delta f + \frac{\lambda^4 k^4}{4}C_s\right)
        $$

        <ul>
            <li>$k$ï¼šç©ºé–“å‘¨æ³¢æ•°ï¼ˆé€†Ã…å˜ä½ï¼‰</li>
            <li>$\lambda$ï¼šé›»å­æ³¢é•·ï¼ˆåŠ é€Ÿé›»åœ§ã§æ±ºã¾ã‚‹ï¼‰</li>
            <li>$\Delta f$ï¼šãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼ˆç„¦ç‚¹ãšã‚Œé‡ã€è² å€¤ãŒã‚¢ãƒ³ãƒ€ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼‰</li>
            <li>$C_s$ï¼šçƒé¢åå·®ä¿‚æ•°ï¼ˆãƒ¬ãƒ³ã‚ºã®åå·®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰</li>
        </ul>

        <p><strong>ç‰©ç†çš„æ„å‘³</strong>ï¼š</p>
        <ul>
            <li>CTFãŒæ­£å€¤ã®ç©ºé–“å‘¨æ³¢æ•°é ˜åŸŸã§ã¯ã€ä½ç›¸ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒåè»¢ã›ãšã«åƒã«å¯„ä¸</li>
            <li>CTFãŒè² å€¤ã®é ˜åŸŸã§ã¯ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒåè»¢ï¼ˆç™½é»’é€†è»¢ï¼‰</li>
            <li>CTFãŒã‚¼ãƒ­ã¨ãªã‚‹å‘¨æ³¢æ•°ï¼ˆã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ï¼‰ã§ã¯ã€ãã®ç©ºé–“å‘¨æ³¢æ•°æˆminã¯åƒã«å¯„ä¸ã—ãªã„</li>
            <li>é©åˆ‡ãªãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼ˆã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼‰ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€åºƒã„ç©ºé–“å‘¨æ³¢æ•°ç¯„å›²ã§ä¸€å®šç¬¦å·ã®CTFã‚’å®Ÿç¾</li>
        </ul>

        <h4>code examples3-1: ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ï¼ˆCTFï¼‰ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def calculate_ctf(k, voltage_kV, defocus_nm, Cs_mm, aperture_mrad=None):
    """
    ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ï¼ˆCTFï¼‰ã‚’calculation

    Parameters
    ----------
    k : array-like
        ç©ºé–“å‘¨æ³¢æ•° [1/Ã…]
    voltage_kV : float
        åŠ é€Ÿé›»åœ§ [kV]
    defocus_nm : float
        ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ [nm]ï¼ˆè² å€¤ï¼šã‚¢ãƒ³ãƒ€ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼‰
    Cs_mm : float
        çƒé¢åå·®ä¿‚æ•° [mm]
    aperture_mrad : float, optional
        å¯¾ç‰©çµã‚ŠåŠè§’ [mrad]ã€‚Noneã®å ´åˆã¯ç„¡é™å¤§ï¼ˆçµã‚Šãªã—ï¼‰

    Returns
    -------
    ctf : ndarray
        CTFå€¤
    """
    # é›»å­æ³¢é•·calculationï¼ˆç›¸å¯¾è«–è£œæ­£ã‚ã‚Šï¼‰
    m0 = 9.10938e-31  # é›»å­è³ªé‡ [kg]
    e = 1.60218e-19   # é›»è· [C]
    c = 2.99792e8     # å…‰é€Ÿ [m/s]
    h = 6.62607e-34   # ãƒ—ãƒ©ãƒ³ã‚¯å®šæ•° [JÂ·s]

    E = voltage_kV * 1000 * e  # ã‚¨ãƒãƒ«ã‚®ãƒ¼ [J]
    lambda_pm = h / np.sqrt(2 * m0 * E * (1 + E / (2 * m0 * c**2))) * 1e12  # [pm]
    lambda_A = lambda_pm / 100  # [Ã…]

    # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é©åˆ‡ãªå˜ä½ã«å¤‰æ›
    defocus_A = defocus_nm * 10  # [Ã…]
    Cs_A = Cs_mm * 1e7  # [Ã…]

    # ä½ç›¸ã‚·ãƒ•ãƒˆ Ï‡(k)
    chi = (2 * np.pi / lambda_A) * (
        0.5 * lambda_A**2 * k**2 * defocus_A +
        0.25 * lambda_A**4 * k**4 * Cs_A
    )

    # çµã‚Šé–¢æ•°ï¼ˆã‚¬ã‚¦ã‚¹å‹ã§è¿‘ä¼¼ï¼‰
    if aperture_mrad is not None:
        theta_max = aperture_mrad * 1e-3  # [rad]
        k_max = theta_max / lambda_A
        A = np.exp(-(k / k_max)**4)
    else:
        A = 1.0

    # CTF = A(k) * sin(Ï‡(k))
    ctf = A * np.sin(chi)

    return ctf, lambda_A

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
voltage = 200  # [kV]
Cs = 0.5  # [mm]ï¼ˆç¾ä»£çš„ãªTEMï¼‰
k = np.linspace(0, 10, 1000)  # ç©ºé–“å‘¨æ³¢æ•° [1/Ã…]

# ç•°ãªã‚‹ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å€¤ã§ã®CTF
defocus_values = [-50, -70, -100]  # [nm]
colors = ['blue', 'green', 'red']

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³ï¼šãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ä¾å­˜æ€§
for df, color in zip(defocus_values, colors):
    ctf, wavelength = calculate_ctf(k, voltage, df, Cs)
    ax1.plot(k, ctf, color=color, linewidth=2, label=f'Î”f = {df} nm')

ax1.axhline(y=0, color='black', linestyle='--', linewidth=0.8)
ax1.set_xlabel('Spatial Frequency [1/Ã…]', fontsize=12)
ax1.set_ylabel('CTF', fontsize=12)
ax1.set_title(f'CTF vs Defocus (200 kV, Cs = {Cs} mm)', fontsize=14, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(alpha=0.3)
ax1.set_xlim(0, 10)
ax1.set_ylim(-1, 1)

# å³å›³ï¼šçƒé¢åå·®ä¿‚æ•°ä¾å­˜æ€§
defocus = -70  # [nm]
Cs_values = [0.5, 1.0, 2.0]  # [mm]
colors2 = ['purple', 'orange', 'brown']

for Cs_val, color in zip(Cs_values, colors2):
    ctf, wavelength = calculate_ctf(k, voltage, defocus, Cs_val)
    ax2.plot(k, ctf, color=color, linewidth=2, label=f'Cs = {Cs_val} mm')

ax2.axhline(y=0, color='black', linestyle='--', linewidth=0.8)
ax2.set_xlabel('Spatial Frequency [1/Ã…]', fontsize=12)
ax2.set_ylabel('CTF', fontsize=12)
ax2.set_title(f'CTF vs Cs (200 kV, Î”f = {defocus} nm)', fontsize=14, fontweight='bold')
ax2.legend(fontsize=11)
ax2.grid(alpha=0.3)
ax2.set_xlim(0, 10)
ax2.set_ylim(-1, 1)

plt.tight_layout()
plt.show()

# ã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼ˆæœ€é©ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼‰ã®calculation
Cs_mm = 0.5
lambda_A = 0.0251  # 200 kVã§ã®æ³¢é•·
Cs_A = Cs_mm * 1e7
scherzer_defocus_A = -1.2 * np.sqrt(Cs_A * lambda_A)
scherzer_defocus_nm = scherzer_defocus_A / 10

print(f"ã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹: {scherzer_defocus_nm:.1f} nm")
print(f"ç¬¬1ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹å‘¨æ³¢æ•°: ~{1/2.5:.2f} Ã…")
</code></pre>

        <p><strong>å‡ºåŠ›è§£é‡ˆ</strong>ï¼š</p>
        <ul>
            <li>ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒå¤§ãã™ãã‚‹ã¨ã€ä½ç©ºé–“å‘¨æ³¢æ•°ã§CTFãŒæŒ¯å‹•ã—ã€åƒãŒè¤‡é›‘ã«ãªã‚‹</li>
            <li>CsãŒå¤§ãã„ã»ã©ã€é«˜ç©ºé–“å‘¨æ³¢æ•°é ˜åŸŸã§ã®CTFæŒ¯å‹•ãŒæ¿€ã—ããªã‚Šã€minè§£èƒ½ãŒä½ä¸‹</li>
            <li>ã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼ˆ~-70 nmï¼‰ã§ã¯ã€åºƒã„ç©ºé–“å‘¨æ³¢æ•°ç¯„å›²ã§æ­£ã®CTFãŒå¾—ã‚‰ã‚Œã‚‹</li>
        </ul>

        <h2>3.2 æ˜è¦–é‡åƒã¨æš—è¦–é‡åƒ</h2>

        <h3>3.2.1 æ˜è¦–é‡åƒï¼ˆBFï¼‰ã®å½¢æˆ</h3>
        <p>æ˜è¦–é‡åƒã¯ã€å¯¾ç‰©çµã‚Šã§é€éãƒ“ãƒ¼ãƒ ï¼ˆ000åå°„ï¼‰ã®ã¿ã‚’é¸æŠã—ã¦å½¢æˆã—ã¾ã™ã€‚è©¦æ–™ãŒè–„ãå‡ä¸€ãªå ´åˆã€è³ªé‡åšã•ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒä¸»ã¨ãªã‚Šã¾ã™ã€‚</p>

        <p><strong>æ˜è¦–é‡åƒã®ç‰¹å¾´</strong>ï¼š</p>
        <ul>
            <li>åšã„éƒ¨minã‚„é‡å…ƒç´ ã‚’å«ã‚€éƒ¨minãŒæš—ãè¦‹ãˆã‚‹</li>
            <li>S/Næ¯”ãŒé«˜ãã€ä½å€ç‡è¦³å¯Ÿã«é©ã™ã‚‹</li>
            <li>éæ™¶è³ªè©¦æ–™ã‚„ç”Ÿç‰©è©¦æ–™ã®è¦³å¯Ÿã«æœ‰åŠ¹</li>
            <li>çµæ™¶è©¦æ–™ã§ã¯ã€ãƒ–ãƒ©ãƒƒã‚°æ¡ä»¶ã‚’æº€ãŸã™çµæ™¶ç²’ãŒæš—ãï¼ˆå›æŠ˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆï¼‰</li>
        </ul>

        <h3>3.2.2 æš—è¦–é‡åƒï¼ˆDFï¼‰ã®å½¢æˆ</h3>
        <p>æš—è¦–é‡åƒã¯ã€å¯¾ç‰©çµã‚Šã§ç‰¹å®šã®å›æŠ˜ã‚¹ãƒãƒƒãƒˆï¼ˆä¾‹ï¼š111åå°„ï¼‰ã®ã¿ã‚’é¸æŠã—ã¦å½¢æˆã—ã¾ã™ã€‚</p>

        <p><strong>æš—è¦–é‡åƒã®åˆ©ç‚¹</strong>ï¼š</p>
        <ul>
            <li>ç‰¹å®šã®çµæ™¶æ–¹ä½ã‚’æŒã¤ç²’å­ã®ã¿ãŒæ˜ã‚‹ãå…‰ã‚‹</li>
            <li>å¾®å°æå‡ºç‰©ã‚„ç¬¬äºŒç›¸ã®æ¤œå‡ºã«æœ‰åŠ¹</li>
            <li>çµæ™¶ç²’ã®è­˜åˆ¥ãŒå®¹æ˜“ï¼ˆåŒä¸€æ–¹ä½ã®ç²’ãŒåŒã˜æ˜ã‚‹ã•ï¼‰</li>
            <li>è»¢ä½ã‚„ç©å±¤æ¬ é™¥ã®è¦³å¯Ÿã«é©ã™ã‚‹</li>
        </ul>

        <p><strong>ä¸­å¿ƒæš—è¦–é‡æ³•ï¼ˆCentered Dark Field, CDFï¼‰</strong>ï¼šå…‰è»¸ã‚’å‚¾æ–œã•ã›ã¦å›æŠ˜ãƒ“ãƒ¼ãƒ ã‚’ä¸­å¿ƒã«æŒã£ã¦ãã‚‹æ‰‹æ³•ã€‚çƒé¢åå·®ã®å½±éŸ¿ã‚’ä½æ¸›ã—ã€é«˜minè§£èƒ½ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚</p>

        <h4>code examples3-2: æ˜è¦–é‡ãƒ»æš—è¦–é‡åƒã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter, rotate

def simulate_polycrystalline_sample(size=512, num_grains=50):
    """
    å¤šçµæ™¶è©¦æ–™ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters
    ----------
    size : int
        ç”»åƒã‚µã‚¤ã‚º [pixels]
    num_grains : int
        çµæ™¶ç²’æ•°

    Returns
    -------
    grain_map : ndarray
        çµæ™¶ç²’ãƒãƒƒãƒ—ï¼ˆå„ãƒ”ã‚¯ã‚»ãƒ«ã®çµæ™¶ç²’IDï¼‰
    orientations : ndarray
        å„çµæ™¶ç²’ã®æ–¹ä½ [degrees]
    """
    # ãƒœãƒ­ãƒã‚¤minå‰²ã§çµæ™¶ç²’ã‚’ç”Ÿæˆ
    from scipy.spatial import Voronoi

    # ãƒ©ãƒ³ãƒ€ãƒ ãªç¨®ç‚¹
    np.random.seed(42)
    points = np.random.rand(num_grains, 2) * size

    # å…¨ãƒ”ã‚¯ã‚»ãƒ«ã®åº§æ¨™
    x, y = np.meshgrid(np.arange(size), np.arange(size))
    pixels = np.stack([x.ravel(), y.ravel()], axis=1)

    # æœ€è¿‘å‚ã®ç¨®ç‚¹ã‚’æ¢ã—ã¦ãƒœãƒ­ãƒã‚¤é ˜åŸŸã‚’ä½œæˆ
    from scipy.spatial.distance import cdist
    distances = cdist(pixels, points)
    grain_map = np.argmin(distances, axis=1).reshape(size, size)

    # å„çµæ™¶ç²’ã«ãƒ©ãƒ³ãƒ€ãƒ ãªæ–¹ä½ã‚’å‰²ã‚Šå½“ã¦
    orientations = np.random.rand(num_grains) * 360

    return grain_map, orientations

def calculate_diffraction_intensity(grain_map, orientations, hkl=(111,)):
    """
    ç‰¹å®šã®å›æŠ˜æ¡ä»¶ã§ã®å¼·åº¦ã‚’calculation

    Parameters
    ----------
    grain_map : ndarray
        çµæ™¶ç²’ãƒãƒƒãƒ—
    orientations : ndarray
        å„çµæ™¶ç²’ã®æ–¹ä½ [degrees]
    hkl : tuple
        å›æŠ˜é¢æŒ‡æ•°ï¼ˆç°¡ç•¥åŒ–ã®ãŸã‚æ–¹ä½ä¾å­˜ã®ã¿è€ƒæ…®ï¼‰

    Returns
    -------
    intensity : ndarray
        å›æŠ˜å¼·åº¦ãƒãƒƒãƒ—
    """
    # ãƒ–ãƒ©ãƒƒã‚°æ¡ä»¶ï¼šç‰¹å®šã®æ–¹ä½ç¯„å›²ã§ã®ã¿å¼·ãå›æŠ˜
    # ç°¡ç•¥åŒ–ï¼šæ–¹ä½ãŒ30Â°Â±5Â°ã®ç¯„å›²ã§å¼·ãå›æŠ˜ã™ã‚‹ã¨ä»®å®š
    target_angle = 30.0
    tolerance = 5.0

    intensity = np.zeros_like(grain_map, dtype=float)

    for grain_id in range(len(orientations)):
        mask = (grain_map == grain_id)
        angle = orientations[grain_id]

        # å›æŠ˜æ¡ä»¶ã‚’æº€ãŸã™ã‹åˆ¤å®š
        angle_diff = min(abs(angle - target_angle),
                        abs(angle - target_angle + 360),
                        abs(angle - target_angle - 360))

        if angle_diff < tolerance:
            # ãƒ–ãƒ©ãƒƒã‚°æ¡ä»¶ã‚’æº€ãŸã™ â†’ å¼·ãå›æŠ˜ï¼ˆæ˜è¦–é‡ã§ã¯æš—ãã€æš—è¦–é‡ã§ã¯æ˜ã‚‹ãï¼‰
            intensity[mask] = 1.0
        else:
            intensity[mask] = 0.1  # å¼±ã„å›æŠ˜

    # ãƒã‚¤ã‚ºè¿½åŠ 
    intensity += np.random.normal(0, 0.05, intensity.shape)

    return intensity

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
size = 512
grain_map, orientations = simulate_polycrystalline_sample(size, num_grains=30)

# æ˜è¦–é‡åƒï¼šå›æŠ˜ãŒå¼·ã„éƒ¨minãŒæš—ã„
diffraction_intensity = calculate_diffraction_intensity(grain_map, orientations)
bf_image = 1.0 - diffraction_intensity * 0.7  # é€éå¼·åº¦ = 1 - å›æŠ˜å¼·åº¦

# æš—è¦–é‡åƒï¼šç‰¹å®šã®å›æŠ˜æ¡ä»¶ã‚’æº€ãŸã™çµæ™¶ç²’ã®ã¿æ˜ã‚‹ã„
df_image = calculate_diffraction_intensity(grain_map, orientations)

# ã¼ã‹ã—ã‚’è¿½åŠ ï¼ˆç¾å®Ÿçš„ãªåƒã«è¿‘ã¥ã‘ã‚‹ï¼‰
bf_image = gaussian_filter(bf_image, sigma=1.0)
df_image = gaussian_filter(df_image, sigma=1.0)

# visualization
fig, axes = plt.subplots(1, 3, figsize=(15, 5))

# çµæ™¶ç²’ãƒãƒƒãƒ—
im0 = axes[0].imshow(grain_map, cmap='tab20', interpolation='nearest')
axes[0].set_title('Crystal Grain Map\n(Ground Truth)', fontsize=13, fontweight='bold')
axes[0].axis('off')

# æ˜è¦–é‡åƒ
im1 = axes[1].imshow(bf_image, cmap='gray', vmin=0, vmax=1)
axes[1].set_title('Bright Field Image\n(Transmitted Beam: 000)', fontsize=13, fontweight='bold')
axes[1].axis('off')

# æš—è¦–é‡åƒ
im2 = axes[2].imshow(df_image, cmap='gray', vmin=0, vmax=1)
axes[2].set_title('Dark Field Image\n(Diffracted Beam: 111)', fontsize=13, fontweight='bold')
axes[2].axis('off')

plt.tight_layout()
plt.show()

print("æ˜è¦–é‡åƒï¼šå›æŠ˜æ¡ä»¶ã‚’æº€ãŸã™çµæ™¶ç²’ãŒæš—ãè¦‹ãˆã‚‹")
print("æš—è¦–é‡åƒï¼šç‰¹å®šã®å›æŠ˜æ¡ä»¶ï¼ˆ111åå°„ï¼‰ã‚’æº€ãŸã™çµæ™¶ç²’ã®ã¿ãŒæ˜ã‚‹ãå…‰ã‚‹")
</code></pre>

        <p><strong>è¦³å¯Ÿãƒã‚¤ãƒ³ãƒˆ</strong>ï¼š</p>
        <ul>
            <li>æ˜è¦–é‡åƒã§ã¯ã€å›æŠ˜ãŒå¼·ã„çµæ™¶ç²’ãŒæš—ãè¡¨ç¤ºã•ã‚Œã‚‹</li>
            <li>æš—è¦–é‡åƒã§ã¯ã€ç‰¹å®šã®æ–¹ä½ã‚’æŒã¤çµæ™¶ç²’ã®ã¿ãŒé¸æŠçš„ã«æ˜ã‚‹ãå…‰ã‚‹</li>
            <li>å®Ÿéš›ã®TEMã§ã¯ã€å¯¾ç‰©çµã‚Šã®ä½ç½®ã‚’å¤‰ãˆã‚‹ã“ã¨ã§ç•°ãªã‚‹å›æŠ˜ã‚¹ãƒãƒƒãƒˆã‚’é¸æŠå¯èƒ½</li>
        </ul>

        <h2>3.3 åˆ¶é™è¦–é‡é›»å­å›æŠ˜ï¼ˆSAEDï¼‰</h2>

        <h3>3.3.1 é›»å­å›æŠ˜ã®åŸç†</h3>
        <p>é›»å­å›æŠ˜ã¯ã€é›»å­æ³¢ãŒçµæ™¶ã®å‘¨æœŸæ§‹é€ ã«ã‚ˆã£ã¦å›æŠ˜ã•ã‚Œã‚‹ç¾è±¡ã§ã™ã€‚ãƒ–ãƒ©ãƒƒã‚°ã®æ³•å‰‡ãŒé©ç”¨ã•ã‚Œã¾ã™ï¼š</p>

        $$
        2d_{hkl}\sin\theta = n\lambda
        $$

        <p>TEMã§ã¯ã€å…¥å°„é›»å­ç·šãŒè©¦æ–™ã«ã»ã¼å‚ç›´ã«å…¥ã‚‹ãŸã‚ã€$\theta$ ã¯éå¸¸ã«å°ã•ãï¼ˆé€šå¸¸1Â°ä»¥ä¸‹ï¼‰ã€å°è§’è¿‘ä¼¼ãŒæˆç«‹ã—ã¾ã™ï¼š</p>

        $$
        \sin\theta \approx \theta \approx \tan\theta = \frac{R}{L}
        $$

        <p>ã“ã“ã§ã€$R$ ã¯å›æŠ˜ã‚¹ãƒãƒƒãƒˆã®è·é›¢ã€$L$ ã¯ã‚«ãƒ¡ãƒ©é•·ã§ã™ã€‚ã—ãŸãŒã£ã¦ï¼š</p>

        $$
        d_{hkl} = \frac{\lambda L}{R}
        $$

        <p><strong>SAEDï¼ˆSelected Area Electron Diffractionï¼‰</strong>ï¼šåˆ¶é™è¦–é‡çµã‚Šã§ç‰¹å®šã®é ˜åŸŸï¼ˆé€šå¸¸æ•°ç™¾nmã€œæ•°Î¼mï¼‰ã‹ã‚‰ã®å›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å–å¾—ã™ã‚‹æ‰‹æ³•ã€‚</p>

        <h3>3.3.2 ã‚¨ãƒ¯ãƒ«ãƒ‰çƒæ§‹æˆ</h3>
        <p>é›»å­å›æŠ˜ã¯ã€é€†æ ¼å­ç©ºé–“ã§ã®ã‚¨ãƒ¯ãƒ«ãƒ‰çƒï¼ˆEwald Sphereï¼‰ã¨é€†æ ¼å­ç‚¹ã®äº¤å·®ã¨ã—ã¦ç†è§£ã•ã‚Œã¾ã™ã€‚</p>

        <ul>
            <li><strong>ã‚¨ãƒ¯ãƒ«ãƒ‰çƒ</strong>ï¼šåŠå¾„ $1/\lambda$ ã®çƒã€‚å…¥å°„ãƒ“ãƒ¼ãƒ æ–¹å‘ã«æ²¿ã£ã¦æã‹ã‚Œã‚‹</li>
            <li><strong>é€†æ ¼å­ç‚¹</strong>ï¼šçµæ™¶ã®å‘¨æœŸæ§‹é€ ã«å¯¾å¿œã™ã‚‹é€†æ ¼å­ç©ºé–“ã®ç‚¹</li>
            <li><strong>å›æŠ˜æ¡ä»¶</strong>ï¼šã‚¨ãƒ¯ãƒ«ãƒ‰çƒãŒé€†æ ¼å­ç‚¹ã‚’é€šã‚‹ã¨ãã€ãƒ–ãƒ©ãƒƒã‚°æ¡ä»¶ãŒæº€ãŸã•ã‚Œå›æŠ˜ãŒç”Ÿã˜ã‚‹</li>
        </ul>

        <h4>code examples3-3: ã‚¨ãƒ¯ãƒ«ãƒ‰çƒæ§‹æˆã¨å›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

def generate_reciprocal_lattice_fcc(max_hkl=3):
    """
    FCCçµæ™¶ã®é€†æ ¼å­ç‚¹ã‚’ç”Ÿæˆ

    Parameters
    ----------
    max_hkl : int
        æœ€å¤§ãƒŸãƒ©ãƒ¼æŒ‡æ•°

    Returns
    -------
    points : list of tuples
        é€†æ ¼å­ç‚¹ (h, k, l)
    """
    points = []
    for h in range(-max_hkl, max_hkl + 1):
        for k in range(-max_hkl, max_hkl + 1):
            for l in range(-max_hkl, max_hkl + 1):
                # FCCæ¶ˆæ»…å‰‡ï¼šh, k, lãŒå…¨ã¦å¶æ•°ã¾ãŸã¯å…¨ã¦å¥‡æ•°
                if (h % 2 == k % 2 == l % 2):
                    points.append((h, k, l))
    return points

def plot_ewald_sphere(a_lattice=4.05, voltage_kV=200, zone_axis=[0, 0, 1]):
    """
    ã‚¨ãƒ¯ãƒ«ãƒ‰çƒæ§‹æˆã‚’3Dãƒ—ãƒ­ãƒƒãƒˆ

    Parameters
    ----------
    a_lattice : float
        æ ¼å­å®šæ•° [Ã…]
    voltage_kV : float
        åŠ é€Ÿé›»åœ§ [kV]
    zone_axis : list
        æ™¶å¸¯è»¸ [uvw]
    """
    # é›»å­æ³¢é•·calculation
    m0 = 9.10938e-31
    e = 1.60218e-19
    c = 2.99792e8
    h = 6.62607e-34
    E = voltage_kV * 1000 * e
    lambda_m = h / np.sqrt(2 * m0 * E * (1 + E / (2 * m0 * c**2)))
    lambda_A = lambda_m * 1e10

    # ã‚¨ãƒ¯ãƒ«ãƒ‰çƒã®åŠå¾„ï¼ˆé€†Ã…ï¼‰
    k = 1 / lambda_A

    # é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆFCCï¼‰
    reciprocal_points = generate_reciprocal_lattice_fcc(max_hkl=2)

    # é€†æ ¼å­å®šæ•°
    a_star = 1 / a_lattice

    # 3Dãƒ—ãƒ­ãƒƒãƒˆ
    fig = plt.figure(figsize=(14, 6))

    # å·¦å›³ï¼š3Dã‚¨ãƒ¯ãƒ«ãƒ‰çƒæ§‹æˆ
    ax1 = fig.add_subplot(121, projection='3d')

    # é€†æ ¼å­ç‚¹ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
    for (h, k, l) in reciprocal_points:
        x = h * a_star
        y = k * a_star
        z = l * a_star
        ax1.scatter(x, y, z, c='blue', s=30, alpha=0.6)
        if abs(l) <= 1:  # [001] zone axisè¿‘å‚
            ax1.text(x, y, z, f'  {h}{k}{l}', fontsize=8)

    # ã‚¨ãƒ¯ãƒ«ãƒ‰çƒï¼ˆç°¡ç•¥åŒ–ï¼šå††ã§è¡¨ç¾ï¼‰
    theta = np.linspace(0, 2*np.pi, 100)
    phi = np.linspace(0, np.pi, 50)

    x_sphere = k * np.outer(np.cos(theta), np.sin(phi))
    y_sphere = k * np.outer(np.sin(theta), np.sin(phi))
    z_sphere = k * np.outer(np.ones(100), np.cos(phi)) - k

    ax1.plot_surface(x_sphere, y_sphere, z_sphere, alpha=0.1, color='red')

    # å…¥å°„ãƒ“ãƒ¼ãƒ 
    ax1.quiver(0, 0, -k, 0, 0, k*1.5, color='green', arrow_length_ratio=0.1, linewidth=2)

    ax1.set_xlabel('$k_x$ [1/Ã…]', fontsize=11)
    ax1.set_ylabel('$k_y$ [1/Ã…]', fontsize=11)
    ax1.set_zlabel('$k_z$ [1/Ã…]', fontsize=11)
    ax1.set_title('Ewald Sphere Construction\n(3D Reciprocal Space)', fontsize=13, fontweight='bold')
    ax1.set_xlim(-2, 2)
    ax1.set_ylim(-2, 2)
    ax1.set_zlim(-2, 2)

    # å³å›³ï¼š[001] zone axisã®å›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆ2DæŠ•å½±ï¼‰
    ax2 = fig.add_subplot(122)

    for (h, k, l) in reciprocal_points:
        if l == 0:  # [001] zone axis
            x = h * a_star
            y = k * a_star
            ax2.scatter(x, y, c='blue', s=100, alpha=0.8)
            ax2.text(x, y + 0.1, f'{h}{k}{l}', fontsize=10, ha='center', fontweight='bold')

    ax2.scatter(0, 0, c='red', s=200, marker='o', label='Transmitted Beam (000)')
    ax2.set_xlabel('$k_x$ [1/Ã…]', fontsize=12)
    ax2.set_ylabel('$k_y$ [1/Ã…]', fontsize=12)
    ax2.set_title('SAED Pattern: [001] Zone Axis\n(Al FCC, 200 kV)', fontsize=13, fontweight='bold')
    ax2.legend(fontsize=10)
    ax2.grid(alpha=0.3)
    ax2.set_aspect('equal')
    ax2.set_xlim(-2.5, 2.5)
    ax2.set_ylim(-2.5, 2.5)

    plt.tight_layout()
    plt.show()

    print(f"é›»å­æ³¢é•·: {lambda_A:.5f} Ã…")
    print(f"ã‚¨ãƒ¯ãƒ«ãƒ‰çƒåŠå¾„: {k:.2f} 1/Ã…")
    print(f"é€†æ ¼å­å®šæ•°: {a_star:.3f} 1/Ã…")

# å®Ÿè¡Œ
plot_ewald_sphere(a_lattice=4.05, voltage_kV=200, zone_axis=[0, 0, 1])
</code></pre>

        <h3>3.3.3 SAED ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æŒ‡æ•°ä»˜ã‘</h3>
        <p>SAED ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰çµæ™¶æ§‹é€ ã‚’åŒå®šã™ã‚‹æ‰‹é †ï¼š</p>

        <ol>
            <li><strong>ã‚«ãƒ¡ãƒ©å®šæ•°ã®æ ¡æ­£</strong>ï¼šæ—¢çŸ¥ã®è©¦æ–™ï¼ˆä¾‹ï¼šAuï¼‰ã§ $\lambda L$ ã‚’æ±ºå®š</li>
            <li><strong>å›æŠ˜ã‚¹ãƒãƒƒãƒˆé–“è·é›¢ã®æ¸¬å®š</strong>ï¼šä¸­å¿ƒï¼ˆ000ï¼‰ã‹ã‚‰å„ã‚¹ãƒãƒƒãƒˆã¾ã§ã®è·é›¢ $R$</li>
            <li><strong>é¢é–“éš”ã®calculation</strong>ï¼š$d = \lambda L / R$</li>
            <li><strong>ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®åŒå®š</strong>ï¼šcalculationã—ãŸ $d$ å€¤ã‚’çµæ™¶å­¦ãƒ‡ãƒ¼ã‚¿ã¨æ¯”è¼ƒ</li>
            <li><strong>æ™¶å¸¯è»¸ã®æ±ºå®š</strong>ï¼šè¤‡æ•°ã®å›æŠ˜ã‚¹ãƒãƒƒãƒˆã‹ã‚‰æ™¶å¸¯è»¸ $[uvw]$ ã‚’æ±ºå®š</li>
        </ol>

        <h4>code examples3-4: SAED ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æŒ‡æ•°ä»˜ã‘ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def calculate_d_spacing_fcc(a, h, k, l):
    """
    FCCçµæ™¶ã®é¢é–“éš”ã‚’calculation

    Parameters
    ----------
    a : float
        æ ¼å­å®šæ•° [Ã…]
    h, k, l : int
        ãƒŸãƒ©ãƒ¼æŒ‡æ•°

    Returns
    -------
    d : float
        é¢é–“éš” [Ã…]
    """
    d = a / np.sqrt(h**2 + k**2 + l**2)
    return d

def index_saed_pattern(camera_length_mm=500, voltage_kV=200, crystal='Al'):
    """
    SAED ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æŒ‡æ•°ä»˜ã‘ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters
    ----------
    camera_length_mm : float
        ã‚«ãƒ¡ãƒ©é•· [mm]
    voltage_kV : float
        åŠ é€Ÿé›»åœ§ [kV]
    crystal : str
        çµæ™¶ç¨®é¡ï¼ˆ'Al', 'Cu', 'Au'ï¼‰
    """
    # é›»å­æ³¢é•·calculation
    m0 = 9.10938e-31
    e = 1.60218e-19
    c = 2.99792e8
    h = 6.62607e-34
    E = voltage_kV * 1000 * e
    lambda_m = h / np.sqrt(2 * m0 * E * (1 + E / (2 * m0 * c**2)))
    lambda_pm = lambda_m * 1e12  # [pm]

    # ã‚«ãƒ¡ãƒ©å®šæ•°
    lambda_L = lambda_pm * camera_length_mm  # [pmÂ·mm]

    # æ ¼å­å®šæ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
    lattice_constants = {
        'Al': 4.05,  # [Ã…]
        'Cu': 3.61,
        'Au': 4.08
    }
    a = lattice_constants[crystal]

    # FCC [001] zone axisã®è¨±å®¹åå°„
    reflections = [
        (0, 0, 0),  # é€éæ³¢
        (2, 0, 0), (0, 2, 0), (-2, 0, 0), (0, -2, 0),
        (2, 2, 0), (2, -2, 0), (-2, 2, 0), (-2, -2, 0),
        (4, 0, 0), (0, 4, 0), (-4, 0, 0), (0, -4, 0)
    ]

    # å›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ç”Ÿæˆ
    fig, ax = plt.subplots(figsize=(10, 10))

    for (h, k, l) in reflections:
        if h == 0 and k == 0 and l == 0:
            # é€éæ³¢
            ax.scatter(0, 0, c='red', s=300, marker='o', edgecolors='black', linewidths=2, zorder=10)
            ax.text(0, -5, '000', fontsize=12, ha='center', fontweight='bold', color='red')
            continue

        # é¢é–“éš”calculation
        d = calculate_d_spacing_fcc(a, h, k, l)

        # å›æŠ˜ã‚¹ãƒãƒƒãƒˆã®ä½ç½®ï¼ˆã‚¹ã‚¯ãƒªãƒ¼ãƒ³ä¸Šã®è·é›¢ï¼‰[mm]
        R_mm = lambda_L / (d * 100)  # d [Ã…] â†’ [pm]ã«å¤‰æ›

        # 2Dãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã®ä½ç½®ï¼ˆ[001] zone axisï¼‰
        x = h / np.sqrt(h**2 + k**2) * R_mm if h != 0 or k != 0 else 0
        y = k / np.sqrt(h**2 + k**2) * R_mm if h != 0 or k != 0 else 0

        # ç°¡ç•¥åŒ–ï¼šh, kã®ç¬¦å·ã‚’ãã®ã¾ã¾ä½¿ç”¨
        x = h * (lambda_L / (calculate_d_spacing_fcc(a, 2, 0, 0) * 100)) / 2
        y = k * (lambda_L / (calculate_d_spacing_fcc(a, 0, 2, 0) * 100)) / 2

        ax.scatter(x, y, c='blue', s=150, alpha=0.8, edgecolors='black', linewidths=1)
        ax.text(x, y - 2, f'{h}{k}{l}', fontsize=10, ha='center', fontweight='bold')
        ax.text(x, y + 2, f'd={d:.3f}Ã…', fontsize=8, ha='center', color='green')

    ax.set_xlabel('x [mm on screen]', fontsize=13)
    ax.set_ylabel('y [mm on screen]', fontsize=13)
    ax.set_title(f'Indexed SAED Pattern: {crystal} FCC [001]\n' +
                 f'(Î»L = {lambda_L:.2f} pmÂ·mm, a = {a} Ã…)',
                 fontsize=14, fontweight='bold')
    ax.grid(alpha=0.3)
    ax.set_aspect('equal')
    ax.axhline(0, color='gray', linestyle='--', linewidth=0.8)
    ax.axvline(0, color='gray', linestyle='--', linewidth=0.8)

    # ã‚¹ã‚±ãƒ¼ãƒ«ãƒãƒ¼
    ax.plot([25, 35], [-35, -35], 'k-', linewidth=3)
    ax.text(30, -38, '10 mm', fontsize=10, ha='center')

    plt.tight_layout()
    plt.show()

    # ä¸»è¦åå°„ã®då€¤ã‚’å‡ºåŠ›
    print(f"\n{crystal} FCC ä¸»è¦åå°„ã®é¢é–“éš”:")
    print(f"  (200): d = {calculate_d_spacing_fcc(a, 2, 0, 0):.3f} Ã…")
    print(f"  (220): d = {calculate_d_spacing_fcc(a, 2, 2, 0):.3f} Ã…")
    print(f"  (400): d = {calculate_d_spacing_fcc(a, 4, 0, 0):.3f} Ã…")

# å®Ÿè¡Œ
index_saed_pattern(camera_length_mm=500, voltage_kV=200, crystal='Al')
</code></pre>

        <h2>3.4 é«˜minè§£èƒ½TEMï¼ˆHRTEMï¼‰</h2>

        <h3>3.4.1 æ ¼å­åƒã¨æ§‹é€ åƒ</h3>
        <p>é«˜minè§£èƒ½TEMï¼ˆHigh-Resolution TEM, HRTEMï¼‰ã§ã¯ã€é€éæ³¢ã¨è¤‡æ•°ã®å›æŠ˜æ³¢ãŒå¹²æ¸‰ã—ã¦æ ¼å­åƒã‚’å½¢æˆã—ã¾ã™ã€‚</p>

        <p><strong>æ ¼å­åƒã¨HRTEMåƒã®é•ã„</strong>ï¼š</p>
        <ul>
            <li><strong>æ ¼å­åƒï¼ˆLattice Fringeï¼‰</strong>ï¼š2æ³¢å¹²æ¸‰ï¼ˆé€éæ³¢ + 1ã¤ã®å›æŠ˜æ³¢ï¼‰ã§å½¢æˆã€‚ç‰¹å®šã®æ ¼å­é¢ãŒç¸æ¨¡æ§˜ã¨ã—ã¦è¦‹ãˆã‚‹</li>
            <li><strong>HRTEMåƒ</strong>ï¼šå¤šæ³¢å¹²æ¸‰ï¼ˆé€éæ³¢ + å¤šæ•°ã®å›æŠ˜æ³¢ï¼‰ã§å½¢æˆã€‚atomé…åˆ—ã‚’ç›´æ¥åæ˜ ã—ãŸåƒ</li>
        </ul>

        <p><strong>HRTEMåƒã®è§£é‡ˆã«ãŠã‘ã‚‹æ³¨æ„ç‚¹</strong>ï¼š</p>
        <ul>
            <li>HRTEMåƒã¯atomé…åˆ—ã®<strong>æŠ•å½±</strong>ã§ã‚ã‚Šã€åšã•æ–¹å‘ã®æƒ…å ±ãŒé‡ç•³ã•ã‚Œã‚‹</li>
            <li>ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚„Csã«ã‚ˆã‚Šã€åƒãŒatomä½ç½®ã¨å¯¾å¿œã—ãªã„å ´åˆãŒã‚ã‚‹ï¼ˆç™½é»’åè»¢ï¼‰</li>
            <li>åƒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆmultisliceæ³•ãªã©ï¼‰ã¨ã®æ¯”è¼ƒãŒå¿…é ˆ</li>
        </ul>

        <h3>3.4.2 HRTEMåƒã®FFTanalysis</h3>
        <p>HRTEMåƒã®<strong>é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼ˆFFTï¼‰</strong>ã«ã‚ˆã‚Šã€é€†æ ¼å­æƒ…å ±ã‚’æŠ½å‡ºã§ãã¾ã™ã€‚FFTãƒ‘ã‚¿ãƒ¼ãƒ³ã¯SAEDãƒ‘ã‚¿ãƒ¼ãƒ³ã«å¯¾å¿œã—ã¾ã™ã€‚</p>

        <h4>code examples3-5: HRTEMåƒã®ç”Ÿæˆã¨FFTanalysis</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.fft import fft2, fftshift

def generate_hrtem_image(size=512, lattice_a=4.05, zone_axis=[1, 1, 0], noise_level=0.1):
    """
    ç°¡ç•¥åŒ–ã•ã‚ŒãŸHRTEMåƒã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼ˆ2æ³¢è¿‘ä¼¼ï¼‰

    Parameters
    ----------
    size : int
        ç”»åƒã‚µã‚¤ã‚º [pixels]
    lattice_a : float
        æ ¼å­å®šæ•° [Ã…]
    zone_axis : list
        æ™¶å¸¯è»¸ [uvw]
    noise_level : float
        ãƒã‚¤ã‚ºãƒ¬ãƒ™ãƒ«

    Returns
    -------
    image : ndarray
        HRTEMåƒ
    """
    # ãƒ”ã‚¯ã‚»ãƒ«ã‚µã‚¤ã‚ºï¼ˆÃ…/pixelï¼‰
    pixel_size = 0.1  # 0.1 Ã…/pixel â†’ minè§£èƒ½0.2 Ã…ç›¸å½“

    # åº§æ¨™ã‚°ãƒªãƒƒãƒ‰
    x = np.arange(size) * pixel_size
    y = np.arange(size) * pixel_size
    X, Y = np.meshgrid(x, y)

    # [110] zone axisã®å ´åˆã€(111)ã¨(-111)é¢ã®å¹²æ¸‰ç¸
    # é¢é–“éš”ï¼ˆFCCï¼‰
    d_111 = lattice_a / np.sqrt(3)

    # æ ¼å­ç¸ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    k1 = 2 * np.pi / d_111

    # 2æ–¹å‘ã®æ ¼å­ç¸ã‚’é‡ã­åˆã‚ã›
    fringe1 = np.cos(k1 * (X + Y) / np.sqrt(2))
    fringe2 = np.cos(k1 * (X - Y) / np.sqrt(2))

    # HRTEMåƒï¼šå¤šæ³¢å¹²æ¸‰ã®ç°¡ç•¥ãƒ¢ãƒ‡ãƒ«
    image = 0.5 + 0.3 * fringe1 + 0.3 * fringe2

    # ãƒã‚¤ã‚ºè¿½åŠ 
    image += np.random.normal(0, noise_level, image.shape)

    # æ­£è¦åŒ–
    image = (image - image.min()) / (image.max() - image.min())

    return image, pixel_size

def plot_hrtem_with_fft(image, pixel_size):
    """
    HRTEMåƒã¨ãã®FFTãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ãƒ—ãƒ­ãƒƒãƒˆ

    Parameters
    ----------
    image : ndarray
        HRTEMåƒ
    pixel_size : float
        ãƒ”ã‚¯ã‚»ãƒ«ã‚µã‚¤ã‚º [Ã…/pixel]
    """
    # FFTcalculation
    fft_image = fftshift(fft2(image))
    fft_magnitude = np.abs(fft_image)
    fft_magnitude_log = np.log(1 + fft_magnitude)  # å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«

    # å‘¨æ³¢æ•°è»¸ï¼ˆ1/Ã…ï¼‰
    freq_x = np.fft.fftshift(np.fft.fftfreq(image.shape[1], d=pixel_size))
    freq_y = np.fft.fftshift(np.fft.fftfreq(image.shape[0], d=pixel_size))

    # visualization
    fig, axes = plt.subplots(1, 3, figsize=(17, 5))

    # HRTEMåƒï¼ˆå…¨ä½“ï¼‰
    im0 = axes[0].imshow(image, cmap='gray', extent=[0, image.shape[1]*pixel_size,
                                                      0, image.shape[0]*pixel_size])
    axes[0].set_title('HRTEM Image (Full)', fontsize=13, fontweight='bold')
    axes[0].set_xlabel('x [Ã…]', fontsize=11)
    axes[0].set_ylabel('y [Ã…]', fontsize=11)

    # HRTEMåƒï¼ˆæ‹¡å¤§ï¼‰
    zoom_size = 50
    center = image.shape[0] // 2
    zoomed = image[center-zoom_size:center+zoom_size, center-zoom_size:center+zoom_size]
    extent_zoom = [0, zoom_size*2*pixel_size, 0, zoom_size*2*pixel_size]

    im1 = axes[1].imshow(zoomed, cmap='gray', extent=extent_zoom)
    axes[1].set_title('HRTEM Image (Zoomed)\nLattice Fringes Visible', fontsize=13, fontweight='bold')
    axes[1].set_xlabel('x [Ã…]', fontsize=11)
    axes[1].set_ylabel('y [Ã…]', fontsize=11)

    # FFTãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆå¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰
    im2 = axes[2].imshow(fft_magnitude_log, cmap='hot',
                        extent=[freq_x.min(), freq_x.max(), freq_y.min(), freq_y.max()])
    axes[2].set_title('FFT Pattern (Log Scale)\n(= Diffractogram)', fontsize=13, fontweight='bold')
    axes[2].set_xlabel('$k_x$ [1/Ã…]', fontsize=11)
    axes[2].set_ylabel('$k_y$ [1/Ã…]', fontsize=11)
    axes[2].set_xlim(-5, 5)
    axes[2].set_ylim(-5, 5)

    # FFTã®ä¸»è¦ãƒ”ãƒ¼ã‚¯ã‚’ãƒãƒ¼ã‚¯
    # ä¸­å¿ƒï¼ˆ000ï¼‰
    axes[2].scatter(0, 0, c='cyan', s=100, marker='o', edgecolors='white', linewidths=2)

    plt.tight_layout()
    plt.show()

# å®Ÿè¡Œ
image, pixel_size = generate_hrtem_image(size=512, lattice_a=4.05, zone_axis=[1, 1, 0], noise_level=0.05)
plot_hrtem_with_fft(image, pixel_size)

print("FFTãƒ‘ã‚¿ãƒ¼ãƒ³ã®è§£é‡ˆï¼š")
print("  - ä¸­å¿ƒï¼ˆæ˜ã‚‹ã„ç‚¹ï¼‰ï¼šé€éæ³¢ï¼ˆ000ï¼‰")
print("  - å¯¾ç§°ãªæ˜ã‚‹ã„ã‚¹ãƒãƒƒãƒˆï¼šæ ¼å­é¢ã‹ã‚‰ã®å›æŠ˜æ³¢")
print("  - ã‚¹ãƒãƒƒãƒˆé–“è·é›¢ âˆ 1/dï¼ˆé¢é–“éš”ã®é€†æ•°ï¼‰")
</code></pre>

        <h3>3.4.3 åå·®è£œæ­£æŠ€è¡“</h3>
        <p>ç¾ä»£ã®TEMã§ã¯ã€çƒé¢åå·®è£œæ­£å™¨ï¼ˆCs-correctorï¼‰ã«ã‚ˆã‚Šã€çƒé¢åå·®ä¿‚æ•°ã‚’é™ã‚Šãªãã‚¼ãƒ­ã«è¿‘ã¥ã‘ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

        <p><strong>åå·®è£œæ­£ã®åŠ¹æœ</strong>ï¼š</p>
        <ul>
            <li><strong>minè§£èƒ½å‘ä¸Š</strong>ï¼š0.5 Ã… â†’ 0.05 Ã…ï¼ˆatomãƒ¬ãƒ™ãƒ«ï¼‰</li>
            <li><strong>CTFæ”¹å–„</strong>ï¼šåºƒã„ç©ºé–“å‘¨æ³¢æ•°ç¯„å›²ã§ä¸€å®šç¬¦å·ã®CTFã‚’å®Ÿç¾</li>
            <li><strong>ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ä¾å­˜æ€§ã®ä½æ¸›</strong>ï¼šã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã®åˆ¶ç´„ãŒç·©å’Œ</li>
            <li><strong>åƒè§£é‡ˆã®ç°¡ç´ åŒ–</strong>ï¼šatomä½ç½®ã¨åƒã®å¯¾å¿œãŒç›´æ„Ÿçš„ã«</li>
        </ul>

        <h4>code examples3-6: åå·®è£œæ­£å‰å¾Œã®CTFæ¯”è¼ƒ</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def ctf_comparison_corrected_vs_uncorrected():
    """
    åå·®è£œæ­£å‰å¾Œã®CTFæ¯”è¼ƒ
    """
    k = np.linspace(0, 15, 1000)  # ç©ºé–“å‘¨æ³¢æ•° [1/Ã…]

    voltage = 200  # [kV]
    lambda_A = 0.0251  # 200 kVã§ã®æ³¢é•· [Ã…]
    defocus_nm = -70  # [nm]
    defocus_A = defocus_nm * 10  # [Ã…]

    # åå·®è£œæ­£å‰ï¼šCs = 0.5 mm
    Cs_uncorrected_mm = 0.5
    Cs_uncorrected_A = Cs_uncorrected_mm * 1e7

    chi_uncorrected = (2 * np.pi / lambda_A) * (
        0.5 * lambda_A**2 * k**2 * defocus_A +
        0.25 * lambda_A**4 * k**4 * Cs_uncorrected_A
    )
    ctf_uncorrected = np.sin(chi_uncorrected)

    # åå·®è£œæ­£å¾Œï¼šCs â‰ˆ -0.01 mmï¼ˆè² ã®åå·®ã§è£œæ­£ï¼‰
    Cs_corrected_mm = -0.01
    Cs_corrected_A = Cs_corrected_mm * 1e7

    chi_corrected = (2 * np.pi / lambda_A) * (
        0.5 * lambda_A**2 * k**2 * defocus_A +
        0.25 * lambda_A**4 * k**4 * Cs_corrected_A
    )
    ctf_corrected = np.sin(chi_corrected)

    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

    # ä¸Šå›³ï¼šCTFæ¯”è¼ƒ
    ax1.plot(k, ctf_uncorrected, 'b-', linewidth=2, label='Uncorrected (Cs = 0.5 mm)')
    ax1.plot(k, ctf_corrected, 'r-', linewidth=2, label='Corrected (Cs â‰ˆ 0 mm)')
    ax1.axhline(0, color='black', linestyle='--', linewidth=0.8)
    ax1.set_xlabel('Spatial Frequency [1/Ã…]', fontsize=12)
    ax1.set_ylabel('CTF', fontsize=12)
    ax1.set_title('CTF: Aberration-Corrected vs Uncorrected TEM\n(200 kV, Î”f = -70 nm)',
                  fontsize=14, fontweight='bold')
    ax1.legend(fontsize=11, loc='upper right')
    ax1.grid(alpha=0.3)
    ax1.set_xlim(0, 15)
    ax1.set_ylim(-1, 1)

    # æ³¨é‡ˆï¼šæƒ…å ±ä¼é”é™ç•Œ
    ax1.axvline(x=1/0.2, color='blue', linestyle=':', linewidth=2, alpha=0.7)
    ax1.text(1/0.2 + 0.3, 0.8, 'Uncorrected limit\n(~2 Ã…)', fontsize=10, color='blue')

    ax1.axvline(x=1/0.08, color='red', linestyle=':', linewidth=2, alpha=0.7)
    ax1.text(1/0.08 + 0.3, -0.8, 'Corrected limit\n(~0.8 Ã…)', fontsize=10, color='red')

    # ä¸‹å›³ï¼šCTFã®ä½ç›¸ã‚·ãƒ•ãƒˆÏ‡(k)
    ax2.plot(k, chi_uncorrected, 'b-', linewidth=2, label='Uncorrected (Cs = 0.5 mm)')
    ax2.plot(k, chi_corrected, 'r-', linewidth=2, label='Corrected (Cs â‰ˆ 0 mm)')
    ax2.set_xlabel('Spatial Frequency [1/Ã…]', fontsize=12)
    ax2.set_ylabel('Phase Shift Ï‡(k) [rad]', fontsize=12)
    ax2.set_title('Phase Shift Function Ï‡(k)', fontsize=14, fontweight='bold')
    ax2.legend(fontsize=11, loc='upper left')
    ax2.grid(alpha=0.3)
    ax2.set_xlim(0, 15)

    plt.tight_layout()
    plt.show()

    # minè§£èƒ½ã®æ¨å®š
    # ç¬¬1ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ã¾ã§ã®å‘¨æ³¢æ•°ç¯„å›²ãŒæƒ…å ±ä¼é”ã«æœ‰åŠ¹
    k_zero_uncorrected = k[np.where(np.diff(np.sign(ctf_uncorrected)))[0][0]]
    k_zero_corrected = k[np.where(np.diff(np.sign(ctf_corrected)))[0][0]]

    resolution_uncorrected = 1 / k_zero_uncorrected
    resolution_corrected = 1 / k_zero_corrected

    print(f"åå·®è£œæ­£å‰ã®minè§£èƒ½: ~{resolution_uncorrected:.2f} Ã…")
    print(f"åå·®è£œæ­£å¾Œã®minè§£èƒ½: ~{resolution_corrected:.2f} Ã…")
    print(f"minè§£èƒ½å‘ä¸Š: {resolution_uncorrected / resolution_corrected:.1f}å€")

# å®Ÿè¡Œ
ctf_comparison_corrected_vs_uncorrected()
</code></pre>

        <h2>3.5 æ¼”ç¿’å•é¡Œ</h2>

        <h3>æ¼”ç¿’3-1: CTFã®æœ€é©åŒ–</h3>
        <p><strong>å•é¡Œ</strong>ï¼š300 kVã®TEMï¼ˆCs = 1.0 mmï¼‰ã§ã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’calculationã—ã€ç¬¬1ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ã®ç©ºé–“å‘¨æ³¢æ•°ã‚’æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
voltage_kV = 300
Cs_mm = 1.0

# é›»å­æ³¢é•·calculationï¼ˆç›¸å¯¾è«–è£œæ­£ï¼‰
m0 = 9.10938e-31
e = 1.60218e-19
c = 2.99792e8
h = 6.62607e-34
E = voltage_kV * 1000 * e
lambda_m = h / np.sqrt(2 * m0 * E * (1 + E / (2 * m0 * c**2)))
lambda_A = lambda_m * 1e10

# ã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
Cs_A = Cs_mm * 1e7
scherzer_defocus_A = -1.2 * np.sqrt(Cs_A * lambda_A)
scherzer_defocus_nm = scherzer_defocus_A / 10

# ç¬¬1ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ã®ç©ºé–“å‘¨æ³¢æ•°ï¼ˆè¿‘ä¼¼ï¼‰
k_first_zero = 1.5 / (Cs_A**0.25 * lambda_A**0.75)
resolution_A = 1 / k_first_zero

print(f"300 kVã§ã®é›»å­æ³¢é•·: {lambda_A:.5f} Ã…")
print(f"ã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹: {scherzer_defocus_nm:.1f} nm")
print(f"ç¬¬1ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ç©ºé–“å‘¨æ³¢æ•°: {k_first_zero:.3f} 1/Ã…")
print(f"ç‚¹minè§£èƒ½: {resolution_A:.3f} Ã…")
</code></pre>
        </details>

        <h3>æ¼”ç¿’3-2: SAEDæŒ‡æ•°ä»˜ã‘</h3>
        <p><strong>å•é¡Œ</strong>ï¼šCu FCCè©¦æ–™ï¼ˆa = 3.61 Ã…ï¼‰ã®[011]æ™¶å¸¯è»¸SAED ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã€200åå°„ã‚¹ãƒãƒƒãƒˆãŒä¸­å¿ƒã‹ã‚‰15 mmé›¢ã‚Œã¦ã„ãŸã€‚ã‚«ãƒ¡ãƒ©å®šæ•°Î»Lã‚’æ±‚ã‚ã‚ˆï¼ˆåŠ é€Ÿé›»åœ§200 kVï¼‰ã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np

# ä¸ãˆã‚‰ã‚ŒãŸãƒ‡ãƒ¼ã‚¿
a = 3.61  # [Ã…]
h, k, l = 2, 0, 0
R_mm = 15  # [mm]

# é¢é–“éš”
d_200 = a / np.sqrt(h**2 + k**2 + l**2)

# ã‚«ãƒ¡ãƒ©å®šæ•° Î»L = R * d
# dã‚’pmã«å¤‰æ›
d_pm = d_200 * 100
lambda_L = R_mm * d_pm

print(f"Cu (200)é¢ã®é¢é–“éš”: {d_200:.3f} Ã… = {d_pm:.1f} pm")
print(f"ã‚«ãƒ¡ãƒ©å®šæ•° Î»L: {lambda_L:.1f} pmÂ·mm")

# æ¤œè¨¼ï¼š200 kVã§ã®ç†è«–å€¤
m0 = 9.10938e-31
e = 1.60218e-19
c = 2.99792e8
h_planck = 6.62607e-34
E = 200 * 1000 * e
lambda_m = h_planck / np.sqrt(2 * m0 * E * (1 + E / (2 * m0 * c**2)))
lambda_pm = lambda_m * 1e12

# ä»®ã«ã‚«ãƒ¡ãƒ©é•·500 mmã¨ã™ã‚‹ã¨
L_mm = lambda_L / lambda_pm
print(f"æ¨å®šã‚«ãƒ¡ãƒ©é•·: {L_mm:.0f} mm")
</code></pre>
        </details>

        <h3>æ¼”ç¿’3-3: FFTanalysis</h3>
        <p><strong>å•é¡Œ</strong>ï¼šHRTEMåƒã®FFTãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã€ä¸­å¿ƒã‹ã‚‰æœ€ã‚‚è¿‘ã„å¯¾ç§°ã‚¹ãƒãƒƒãƒˆãŒ3.5 1/Ã…é›¢ã‚Œã¦ã„ã‚‹ã€‚å¯¾å¿œã™ã‚‹æ ¼å­é¢ã®é¢é–“éš”ã‚’æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">k = 3.5  # [1/Ã…]ï¼ˆFFTãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚¹ãƒãƒƒãƒˆä½ç½®ï¼‰

# é¢é–“éš” d = 1/k
d = 1 / k

print(f"FFTã‚¹ãƒãƒƒãƒˆç©ºé–“å‘¨æ³¢æ•°: {k} 1/Ã…")
print(f"å¯¾å¿œã™ã‚‹é¢é–“éš”: {d:.3f} Ã…")
print(f"ã“ã‚Œã¯ä¾‹ãˆã°ã€Si (111)é¢ (d = 3.14 Ã…) ã‚„Al (111)é¢ (d = 2.34 Ã…) ã«ç›¸å½“ã™ã‚‹å¯èƒ½æ€§")
</code></pre>
        </details>

        <h3>æ¼”ç¿’3-4: æš—è¦–é‡åƒã®æ´»ç”¨</h3>
        <p><strong>å•é¡Œ</strong>ï¼šAlåˆé‡‘ä¸­ã®Al<sub>2</sub>Cuæå‡ºç‰©ï¼ˆÎ¸'ç›¸ï¼‰ã‚’æš—è¦–é‡åƒã§è¦³å¯Ÿã—ãŸã„ã€‚é©åˆ‡ãªå›æŠ˜ã‚¹ãƒãƒƒãƒˆã‚’é¸ã¶æˆ¦ç•¥ã‚’Descriptionã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <p><strong>æˆ¦ç•¥</strong>ï¼š</p>
            <ol>
                <li>ã¾ãš[001]_Alãªã©ã®ä½æŒ‡æ•°æ™¶å¸¯è»¸ã«è©¦æ–™ã‚’å‚¾æ–œ</li>
                <li>SAEDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å–å¾—ã—ã€Alæ¯ç›¸ã¨Î¸'ç›¸ã®å›æŠ˜ã‚¹ãƒãƒƒãƒˆã‚’åŒå®š</li>
                <li>Î¸'ç›¸ã«<strong>ç‰¹æœ‰ã®å›æŠ˜ã‚¹ãƒãƒƒãƒˆ</strong>ï¼ˆAlã«ã¯ç¾ã‚Œãªã„æŒ‡æ•°ï¼‰ã‚’é¸æŠ</li>
                <li>ä¾‹ï¼šÎ¸'ç›¸ã®(002)ã‚„(100)åå°„ãªã©</li>
                <li>ãã®ã‚¹ãƒãƒƒãƒˆã§æš—è¦–é‡åƒã‚’æ’®å½± â†’ Î¸'æå‡ºç‰©ã®ã¿ãŒæ˜ã‚‹ãå…‰ã‚‹</li>
                <li>ä¸­å¿ƒæš—è¦–é‡æ³•ï¼ˆCDFï¼‰ã‚’ä½¿ãˆã°ã€ã‚ˆã‚Šé«˜minè§£èƒ½ãªåƒãŒå¾—ã‚‰ã‚Œã‚‹</li>
            </ol>
        </details>

        <h3>æ¼”ç¿’3-5: å¤šæ³¢å¹²æ¸‰ã®ç†è§£</h3>
        <p><strong>å•é¡Œ</strong>ï¼š2æ³¢å¹²æ¸‰ï¼ˆé€éæ³¢ + 1ã¤ã®å›æŠ˜æ³¢ï¼‰ã¨å¤šæ³¢å¹²æ¸‰ï¼ˆé€éæ³¢ + è¤‡æ•°ã®å›æŠ˜æ³¢ï¼‰ã®é•ã„ã‚’ã€CTFã®è¦³ç‚¹ã‹ã‚‰Descriptionã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <p><strong>å›ç­”</strong>ï¼š</p>
            <ul>
                <li><strong>2æ³¢å¹²æ¸‰</strong>ï¼š1ã¤ã®ç©ºé–“å‘¨æ³¢æ•°æˆminã®ã¿ãŒå¹²æ¸‰ã€‚CTFã¯ãã®1ç‚¹ã§ã®ã¿è©•ä¾¡ã•ã‚Œã‚‹ã€‚æ ¼å­ç¸ã¨ã—ã¦è¦³å¯Ÿã•ã‚Œã‚‹ãŒã€atomé…åˆ—ã®è©³ç´°ã¯è¦‹ãˆãªã„</li>
                <li><strong>å¤šæ³¢å¹²æ¸‰</strong>ï¼šå¤šæ•°ã®ç©ºé–“å‘¨æ³¢æ•°æˆminãŒåŒæ™‚ã«å¹²æ¸‰ã€‚CTFã®åºƒã„ç¯„å›²ãŒåƒå½¢æˆã«å¯„ä¸ã€‚atomé…åˆ—ã‚’åæ˜ ã—ãŸHRTEMåƒãŒå¾—ã‚‰ã‚Œã‚‹</li>
                <li><strong>CTFã®å½¹å‰²</strong>ï¼šå„ç©ºé–“å‘¨æ³¢æ•°æˆminãŒã©ã®ç¨‹åº¦åƒã«å¯„ä¸ã™ã‚‹ã‹ã‚’æ±ºå®šã€‚åå·®è£œæ­£ã«ã‚ˆã‚Šã€åºƒã„å‘¨æ³¢æ•°ç¯„å›²ã§ä¸€å®šç¬¦å·ã®CTFã‚’å®Ÿç¾ã™ã‚‹ã¨ã€ã‚ˆã‚Šå¿ å®Ÿãªatomé…åˆ—åƒãŒå¾—ã‚‰ã‚Œã‚‹</li>
            </ul>
        </details>

        <h3>æ¼”ç¿’3-6: åå·®è£œæ­£ã®åŠ¹æœ</h3>
        <p><strong>å•é¡Œ</strong>ï¼šåå·®è£œæ­£å‰ï¼ˆCs = 1.0 mmï¼‰ã¨åå·®è£œæ­£å¾Œï¼ˆCs â‰ˆ 0.001 mmï¼‰ã®300 kV TEMã§ã€ãã‚Œãã‚Œã®ç‚¹minè§£èƒ½ã‚’æ¯”è¼ƒã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np

voltage_kV = 300

# é›»å­æ³¢é•·
m0 = 9.10938e-31
e = 1.60218e-19
c = 2.99792e8
h = 6.62607e-34
E = voltage_kV * 1000 * e
lambda_m = h / np.sqrt(2 * m0 * E * (1 + E / (2 * m0 * c**2)))
lambda_A = lambda_m * 1e10

# åå·®è£œæ­£å‰
Cs_uncorrected_mm = 1.0
Cs_uncorrected_A = Cs_uncorrected_mm * 1e7
k_limit_uncorrected = 1.5 / (Cs_uncorrected_A**0.25 * lambda_A**0.75)
resolution_uncorrected = 1 / k_limit_uncorrected

# åå·®è£œæ­£å¾Œ
Cs_corrected_mm = 0.001
Cs_corrected_A = Cs_corrected_mm * 1e7
k_limit_corrected = 1.5 / (Cs_corrected_A**0.25 * lambda_A**0.75)
resolution_corrected = 1 / k_limit_corrected

print(f"300 kVã§ã®é›»å­æ³¢é•·: {lambda_A:.5f} Ã…")
print(f"\nåå·®è£œæ­£å‰ï¼ˆCs = {Cs_uncorrected_mm} mmï¼‰:")
print(f"  ç‚¹minè§£èƒ½: {resolution_uncorrected:.3f} Ã…")
print(f"\nåå·®è£œæ­£å¾Œï¼ˆCs = {Cs_corrected_mm} mmï¼‰:")
print(f"  ç‚¹minè§£èƒ½: {resolution_corrected:.3f} Ã…")
print(f"\nminè§£èƒ½å‘ä¸Š: {resolution_uncorrected / resolution_corrected:.1f}å€")
</code></pre>
        </details>

        <h3>æ¼”ç¿’3-7: practiceçš„HRTEManalysis</h3>
        <p><strong>å•é¡Œ</strong>ï¼šä¸ãˆã‚‰ã‚ŒãŸHRTEMåƒï¼ˆ512Ã—512ãƒ”ã‚¯ã‚»ãƒ«ã€ãƒ”ã‚¯ã‚»ãƒ«ã‚µã‚¤ã‚º0.05 Ã…/pixelï¼‰ã®FFTã‚’calculationã—ã€ä¸»è¦ãªæ ¼å­é¢ã®é¢é–“éš”ã‚’3ã¤æŠ½å‡ºã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.fft import fft2, fftshift
from scipy.ndimage import gaussian_filter

# ãƒ€ãƒŸãƒ¼HRTEMåƒç”Ÿæˆï¼ˆå®Ÿéš›ã®ãƒ‡ãƒ¼ã‚¿ã«ç½®ãæ›ãˆã‚‹ï¼‰
size = 512
pixel_size = 0.05  # [Ã…/pixel]

# 3ã¤ã®æ ¼å­é¢ã‚’æŒã¤çµæ™¶ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
x = np.arange(size) * pixel_size
y = np.arange(size) * pixel_size
X, Y = np.meshgrid(x, y)

# æ ¼å­é¢1: d1 = 3.5 Ã…
d1 = 3.5
image = 0.5 + 0.2 * np.cos(2*np.pi * X / d1)

# æ ¼å­é¢2: d2 = 2.0 Ã…
d2 = 2.0
image += 0.15 * np.cos(2*np.pi * (X + Y) / (d2 * np.sqrt(2)))

# æ ¼å­é¢3: d3 = 1.5 Ã…
d3 = 1.5
image += 0.1 * np.cos(2*np.pi * Y / d3)

# ãƒã‚¤ã‚ºè¿½åŠ 
image += np.random.normal(0, 0.05, image.shape)
image = gaussian_filter(image, sigma=0.5)

# FFTcalculation
fft_image = fftshift(fft2(image))
fft_magnitude = np.abs(fft_image)
fft_magnitude_log = np.log(1 + fft_magnitude)

# å‘¨æ³¢æ•°è»¸
freq = np.fft.fftshift(np.fft.fftfreq(size, d=pixel_size))

# FFTãƒ”ãƒ¼ã‚¯æ¤œå‡ºï¼ˆç°¡æ˜“ç‰ˆï¼šä¸­å¿ƒã‹ã‚‰3ã¤ã®ä¸»è¦ãƒ”ãƒ¼ã‚¯ã‚’æ‰‹å‹•æŠ½å‡ºï¼‰
center = size // 2
# å®Ÿéš›ã®analysisã§ã¯ã€scipy.signal.find_peaks ãªã©ã‚’ä½¿ç”¨

print("FFTanalysisçµæœï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼‰:")
print(f"  ãƒ”ãƒ¼ã‚¯1: k â‰ˆ {1/d1:.3f} 1/Ã… â†’ d â‰ˆ {d1:.2f} Ã…")
print(f"  ãƒ”ãƒ¼ã‚¯2: k â‰ˆ {1/d2:.3f} 1/Ã… â†’ d â‰ˆ {d2:.2f} Ã…")
print(f"  ãƒ”ãƒ¼ã‚¯3: k â‰ˆ {1/d3:.3f} 1/Ã… â†’ d â‰ˆ {d3:.2f} Ã…")

# visualization
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

ax1.imshow(image, cmap='gray')
ax1.set_title('HRTEM Image', fontsize=13, fontweight='bold')
ax1.axis('off')

ax2.imshow(fft_magnitude_log, cmap='hot', extent=[freq.min(), freq.max(), freq.min(), freq.max()])
ax2.set_title('FFT Pattern (Log Scale)', fontsize=13, fontweight='bold')
ax2.set_xlabel('$k_x$ [1/Ã…]', fontsize=11)
ax2.set_ylabel('$k_y$ [1/Ã…]', fontsize=11)
ax2.set_xlim(-2, 2)
ax2.set_ylim(-2, 2)

plt.tight_layout()
plt.show()
</code></pre>
        </details>

        <h3>æ¼”ç¿’3-8: å®Ÿé¨“è¨ˆç”»</h3>
        <p><strong>å•é¡Œ</strong>ï¼šæœªçŸ¥ã®çµæ™¶è©¦æ–™ã‚’TEMã§analysisã™ã‚‹å®Ÿé¨“è¨ˆç”»ã‚’ç«‹æ¡ˆã›ã‚ˆã€‚æ˜è¦–é‡åƒã€æš—è¦–é‡åƒã€SAEDã€HRTEMã‚’ã©ã®é †åºã§å–å¾—ã—ã€ä½•ã‚’èª¿ã¹ã‚‹ã‹Descriptionã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <p><strong>å®Ÿé¨“è¨ˆç”»</strong>ï¼š</p>
            <ol>
                <li><strong>ä½å€ç‡æ˜è¦–é‡åƒ</strong>ï¼šè©¦æ–™å…¨ä½“ã®å½¢æ…‹ã€åšã•ã€çµæ™¶ç²’ã‚µã‚¤ã‚ºã‚’æŠŠæ¡</li>
                <li><strong>SAEDï¼ˆåºƒç¯„å›²ï¼‰</strong>ï¼šå¤šçµæ™¶ã‹å˜çµæ™¶ã‹ã‚’åˆ¤å®šã€‚å¤šçµæ™¶ã®å ´åˆã€ãƒ‡ãƒã‚¤ãƒªãƒ³ã‚°å–å¾—</li>
                <li><strong>è©¦æ–™å‚¾æ–œã¨SAED</strong>ï¼šä½æŒ‡æ•°æ™¶å¸¯è»¸ï¼ˆ[001], [011], [111]ãªã©ï¼‰ã‚’æ¢ç´¢ã€‚ãƒ‡ãƒã‚¤ãƒªãƒ³ã‚°analysisã§æ ¼å­å®šæ•°ã¨çµæ™¶ç³»ã‚’æ¨å®š</li>
                <li><strong>SAEDï¼ˆåˆ¶é™è¦–é‡ï¼‰</strong>ï¼šç‰¹å®šã®çµæ™¶ç²’ã‹ã‚‰SAEDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å–å¾—ã—ã€æŒ‡æ•°ä»˜ã‘ã€‚çµæ™¶æ§‹é€ ã‚’åŒå®š</li>
                <li><strong>æš—è¦–é‡åƒ</strong>ï¼šç‰¹å®šã®å›æŠ˜ã‚¹ãƒãƒƒãƒˆã§æš—è¦–é‡åƒã‚’æ’®å½±ã€‚çµæ™¶ç²’ã€åŒæ™¶ã€æå‡ºç‰©ã®minå¸ƒã‚’è¦³å¯Ÿ</li>
                <li><strong>HRTEM</strong>ï¼šé«˜minè§£èƒ½åƒã‚’å–å¾—ã—ã€æ ¼å­åƒã‚„FFTanalysisã§é¢é–“éš”ã‚’ç²¾å¯†æ¸¬å®šã€‚æ¬ é™¥ï¼ˆè»¢ä½ã€ç©å±¤æ¬ é™¥ï¼‰ã®è¦³å¯Ÿ</li>
                <li><strong>ãƒ‡ãƒ¼ã‚¿çµ±åˆ</strong>ï¼šSAEDã€HRTEMã€æš—è¦–é‡åƒã®çµæœã‚’çµ±åˆã—ã€çµæ™¶æ§‹é€ ã€æ–¹ä½ã€æ¬ é™¥ã‚’ç·åˆçš„ã«analysis</li>
            </ol>
        </details>

        <h2>3.6 å­¦ç¿’ãƒã‚§ãƒƒã‚¯</h2>
        <p>ä»¥ä¸‹ã®è³ªå•ã«ç­”ãˆã¦ã€ç†è§£åº¦ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>

        <ol>
            <li>TEMçµåƒã§ãƒãƒƒã‚¯ãƒ•ã‚©ãƒ¼ã‚«ãƒ«é¢ï¼ˆBFPï¼‰ã¨åƒé¢ã®å½¹å‰²ã‚’Descriptionã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>æ˜è¦–é‡åƒã¨æš—è¦–é‡åƒã®é•ã„ã¨ã€ãã‚Œãã‚Œã®é©ç”¨ä¾‹ã‚’æŒ™ã’ã‚‰ã‚Œã¾ã™ã‹ï¼Ÿ</li>
            <li>ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ï¼ˆCTFï¼‰ã®ç‰©ç†çš„æ„å‘³understandã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</li>
            <li>ã‚·ã‚§ãƒ«ãƒ„ã‚¡ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã®ç›®çš„ã¨ãã®calculationæ–¹æ³•ã‚’Descriptionã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>SAED ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰æ ¼å­å®šæ•°ã‚’æ±ºå®šã™ã‚‹æ‰‹é †ã‚’Descriptionã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>ã‚¨ãƒ¯ãƒ«ãƒ‰çƒæ§‹æˆã‚’ä½¿ã£ã¦å›æŠ˜æ¡ä»¶ã‚’Descriptionã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>HRTEMåƒã®FFTanalysisã§ä½•ãŒminã‹ã‚‹ã‹Descriptionã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>åå·®è£œæ­£æŠ€è¡“ã®åŠ¹æœã¨minè§£èƒ½ã¸ã®å½±éŸ¿understandã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</li>
        </ol>

        <h2>3.7 å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Williams, D. B., & Carter, C. B. (2009). <em>Transmission Electron Microscopy: A Textbook for Materials Science</em> (2nd ed.). Springer. - TEMæ•™ç§‘æ›¸ã®æ±ºå®šç‰ˆ</li>
            <li>Kirkland, E. J. (2020). <em>Advanced Computing in Electron Microscopy</em> (3rd ed.). Springer. - HRTEMåƒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨FFTanalysis</li>
            <li>Pennycook, S. J., & Nellist, P. D. (Eds.). (2011). <em>Scanning Transmission Electron Microscopy: Imaging and Analysis</em>. Springer. - STEMæŠ€è¡“ï¼ˆæ¬¡ç« ã§è©³è¿°ï¼‰</li>
            <li>Spence, J. C. H. (2013). <em>High-Resolution Electron Microscopy</em> (4th ed.). Oxford University Press. - HRTEMç†è«–ã®è©³ç´°</li>
            <li>Hawkes, P. W., & Spence, J. C. H. (Eds.). (2019). <em>Springer Handbook of Microscopy</em>. Springer. - é›»å­é¡•å¾®é¡æŠ€è¡“ã®åŒ…æ‹¬çš„ãƒãƒ³ãƒ‰ãƒ–ãƒƒã‚¯</li>
            <li>Reimer, L., & Kohl, H. (2008). <em>Transmission Electron Microscopy: Physics of Image Formation</em> (5th ed.). Springer. - TEMçµåƒç†è«–ã®è©³ç´°</li>
            <li>Haider, M., et al. (1998). "Electron microscopy image enhanced." <em>Nature</em>, 392, 768â€“769. - åå·®è£œæ­£æŠ€è¡“ã®ãƒ–ãƒ¬ãƒ¼ã‚¯ã‚¹ãƒ«ãƒ¼è«–æ–‡</li>
        </ol>

        <h2>3.8 æ¬¡ç« ã¸</h2>
        <p>æ¬¡ç« ã§ã¯ã€èµ°æŸ»é€éå‹é›»å­é¡•å¾®é¡ï¼ˆSTEMï¼‰ã®åŸç†ã€Z-contraståƒï¼ˆHAADF-STEMï¼‰ã€é›»å­ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±minå…‰ï¼ˆEELSï¼‰ã€atomminè§£èƒ½minæã€ãƒˆãƒ¢ã‚°ãƒ©ãƒ•ã‚£ãƒ¼fundamentals ofã¨å¿œç”¨will be coveredã€‚STEMã¯ã€åæŸé›»å­ãƒ“ãƒ¼ãƒ ã‚’è©¦æ–™ä¸Šã§èµ°æŸ»ã—ã€å¤šæ§˜ãªä¿¡å·ã‚’åŒæ™‚ã«æ¤œå‡ºã§ãã‚‹å¼·åŠ›ãªæ‰‹æ³•ã§ã™ã€‚</p>

        <div class="navigation">
            <a href="chapter-2.html" class="nav-button">â† Chapter 2ï¼šSEMå…¥é–€</a>
            <a href="index.html" class="nav-button">ç›®æ¬¡ã«æˆ»ã‚‹</a>
            <a href="chapter-4.html" class="nav-button">Chapter 4ï¼šSTEMã¨minææŠ€è¡“ â†’</a>
        </div>
    </main>

    <section class="disclaimer">
        <h3>Disclaimer</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€ï¼ˆæ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©ï¼‰ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿ï¼ˆAS ISï¼‰ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§regardingã€AuthorãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€AuthorãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»Licenseã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶ï¼ˆä¾‹: CC BY 4.0ï¼‰ã«å¾“ã„ã¾ã™ã€‚å½“è©²Licenseã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

    <footer>
        <p><strong>Author</strong>: MS Knowledge Hub Content Team</p>
        <p><strong>Version</strong>: 1.0 | <strong>Created</strong>: 2025-10-28</p>
        <p><strong>License</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
