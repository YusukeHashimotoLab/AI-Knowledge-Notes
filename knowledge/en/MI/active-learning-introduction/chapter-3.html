<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 3: Acquisition Function Design - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "‚ö†Ô∏è";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/en/index.html">AI Terakoya Home</a><span class="breadcrumb-separator">‚Ä∫</span><a href="/AI-Knowledge-Notes/knowledge/en/MI/index.html">Materials Informatics</a><span class="breadcrumb-separator">‚Ä∫</span><a href="/AI-Knowledge-Notes/knowledge/en/MI/active-learning-introduction/index.html">Active Learning</a><span class="breadcrumb-separator">‚Ä∫</span><span class="breadcrumb-current">Chapter 3</span>
        </div>
    </nav>

        <header>
        <div class="header-content">
            <h1>Chapter 3: Acquisition Function Design</h1>
            <p class="subtitle">Expected Improvement„ÉªUCB„ÉªMulti-Objective Optimization</p>
            <div class="meta">
                <span class="meta-item">üìñ Reading Time: 25-30 min</span>
                <span class="meta-item">üìä Difficulty: Intermediate-Advanced</span>
                <span class="meta-item">üíª Code Examples: 7</span>
                <span class="meta-item">üìù Exercises: 3</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Chapter 3: Acquisition Function Design</h1>
<p><strong>Expected Improvement„ÉªUCB„ÉªMulti-Objective Optimization</strong></p>
<h2>Learning Objectives</h2>
<p>By reading this chapter, you will master the following:</p>
<ul>
<li>‚úÖ Understand the characteristics of four major Acquisition Functions</li>
<li>‚úÖ Implement Expected Improvement</li>
<li>‚úÖ Apply Pareto optimality to multi-objective optimization</li>
<li>‚úÖ Incorporate constraints into Acquisition Functions</li>
<li>‚úÖ Explain selection criteria for Acquisition Functions</li>
</ul>
<p><strong>Reading Time</strong>: 25-30 min
<strong>Code Examples</strong>: 7
<strong>Exercises</strong>: 3</p>
<hr />
<h2>3.1 Fundamentals of Acquisition Functions</h2>
<h3>What is an Acquisition Function?</h3>
<p><strong>Definition</strong>: A scoring function that determines which sample should be acquired next</p>
<p><strong>Formula</strong>:
$$
x^* = \arg\max_{x \in \mathcal{X}} \alpha(x | \mathcal{D})
$$</p>
<ul>
<li>$\alpha(x | \mathcal{D})$: Acquisition Function</li>
<li>$\mathcal{X}$: Search space</li>
<li>$\mathcal{D}$: Data acquired so far</li>
</ul>
<h3>Four Major Acquisition Functions</h3>
<h4>1. Expected Improvement (EI)</h4>
<p><strong>Principle</strong>: Expected value of improvement from the current best value</p>
<p><strong>Formula</strong>:
$$
\text{EI}(x) = \mathbb{E}[\max(f(x) - f^*, 0)]
$$</p>
<p>$$
= \begin{cases}
(\mu(x) - f^*)\Phi(Z) + \sigma(x)\phi(Z) &amp; \text{if } \sigma(x) &gt; 0 \
0 &amp; \text{if } \sigma(x) = 0
\end{cases}
$$</p>
<p>where,
$$
Z = \frac{\mu(x) - f^*}{\sigma(x)}
$$</p>
<ul>
<li>$f^*$: Current best value</li>
<li>$\mu(x)$: Predicted mean</li>
<li>$\sigma(x)$: Predicted standard deviation</li>
<li>$\Phi(\cdot)$: Cumulative distribution function of standard normal distribution</li>
<li>$\phi(\cdot)$: Probability density function of standard normal distribution</li>
</ul>
<p><strong>Code Example 1: Implementation of Expected Improvement</strong></p>
<pre>__PROTECTED_CODE_0__</pre>
<h4>2. Probability of Improvement (PI)</h4>
<p><strong>Principle</strong>: Probability of improving the current best value</p>
<p><strong>Formula</strong>:
$$
\text{PI}(x) = P(f(x) \geq f^* + \xi)
$$</p>
<p>$$
= \Phi\left(\frac{\mu(x) - f^* - \xi}{\sigma(x)}\right)
$$</p>
<ul>
<li>$\xi$: Improvement threshold (typically 0.01)</li>
</ul>
<p><strong>Code Example 2: Implementation of Probability of Improvement</strong></p>
<pre>__PROTECTED_CODE_1__</pre>
<h4>3. Upper Confidence Bound (UCB)</h4>
<p><strong>Principle</strong>: Predicted mean + uncertainty bonus</p>
<p><strong>Formula</strong>:
$$
\text{UCB}(x) = \mu(x) + \kappa \sigma(x)
$$</p>
<ul>
<li>$\kappa$: Exploration parameter (typically 1.0-3.0)</li>
</ul>
<p><strong>Code Example 3: Implementation of UCB</strong></p>
<pre>__PROTECTED_CODE_2__</pre>
<h4>4. Thompson Sampling</h4>
<p><strong>Principle</strong>: Sample from Gaussian Process and select the maximum value</p>
<p><strong>Formula</strong>:
$$
f(x) \sim \mathcal{GP}(\mu(x), k(x, x'))
$$</p>
<p>$$
x^* = \arg\max_{x \in \mathcal{X}} f(x)
$$</p>
<p><strong>Code Example 4: Implementation of Thompson Sampling</strong></p>
<pre>__PROTECTED_CODE_3__</pre>
<hr />
<h2>3.2 Multi-Objective Acquisition Functions</h2>
<h3>Pareto Optimality</h3>
<p><strong>Definition</strong>: A solution that does not sacrifice other objectives to improve one objective</p>
<p><strong>Formula</strong>:
$$
x^* \text{ is Pareto optimal} \iff \nexists x : f_i(x) \geq f_i(x^*) \ \forall i \land f_j(x) &gt; f_j(x^*) \ \text{for some } j
$$</p>
<h3>Expected Hypervolume Improvement (EHVI)</h3>
<p><strong>Principle</strong>: Maximize the expected improvement in hypervolume</p>
<p><strong>Formula</strong>:
$$
\text{EHVI}(x) = \mathbb{E}[HV(\mathcal{P} \cup {f(x)}) - HV(\mathcal{P})]
$$</p>
<ul>
<li>$HV(\cdot)$: Hypervolume</li>
<li>$\mathcal{P}$: Current Pareto set</li>
</ul>
<p><strong>Code Example 5: Implementation of Multi-Objective Optimization (BoTorch)</strong></p>
<pre>__PROTECTED_CODE_4__</pre>
<hr />
<h2>3.3 Constrained Acquisition Functions</h2>
<h3>Handling Constraints</h3>
<p><strong>Example</strong>: Synthesizability constraints, cost constraints</p>
<p><strong>Formula</strong>:
$$
x^* = \arg\max_{x \in \mathcal{X}} \alpha(x | \mathcal{D}) \cdot P_c(x)
$$</p>
<ul>
<li>$P_c(x)$: Probability of satisfying constraints</li>
</ul>
<p><strong>Constrained Expected Improvement</strong>:
$$
\text{CEI}(x) = \text{EI}(x) \cdot P(c(x) \leq 0)
$$</p>
<hr />
<h2>3.4 Case Study: Thermoelectric Materials Exploration</h2>
<h3>Problem Setting</h3>
<p><strong>Objective</strong>: Maximize the thermoelectric figure of merit ZT value</p>
<p><strong>ZT value</strong>:
$$
ZT = \frac{S^2 \sigma T}{\kappa}
$$</p>
<ul>
<li>$S$: Seebeck coefficient</li>
<li>$\sigma$: Electrical conductivity</li>
<li>$T$: Absolute temperature</li>
<li>$\kappa$: Thermal conductivity</li>
</ul>
<p><strong>Challenge</strong>: Simultaneous optimization of three properties (multi-objective optimization)</p>
<hr />
<h2>Chapter Summary</h2>
<h3>Comparison Table of Acquisition Functions</h3>
<table>
<thead>
<tr>
<th>Acquisition Function</th>
<th>Characteristics</th>
<th>Exploration Tendency</th>
<th>Computational Cost</th>
<th>Recommended Use</th>
</tr>
</thead>
<tbody>
<tr>
<td>EI</td>
<td>Expected improvement</td>
<td>Balanced</td>
<td>Low</td>
<td>General optimization</td>
</tr>
<tr>
<td>PI</td>
<td>Improvement probability</td>
<td>Exploitation-focused</td>
<td>Low</td>
<td>Fast exploration</td>
</tr>
<tr>
<td>UCB</td>
<td>Upper confidence bound</td>
<td>Exploration-focused</td>
<td>Low</td>
<td>Wide-range exploration</td>
</tr>
<tr>
<td>Thompson</td>
<td>Stochastic</td>
<td>Balanced</td>
<td>Medium</td>
<td>Parallel experiments</td>
</tr>
</tbody>
</table>
<h3>Next Chapter</h3>
<p>In Chapter 4, you will learn about <strong>Applications and Practice in Materials Exploration</strong>:
- Active Learning √ó Bayesian Optimization
- Active Learning √ó High-Throughput Computation
- Active Learning √ó Experimental Robots
- Real-World Applications and Career Paths</p>
<p><strong><a href="./chapter-4.html">Chapter 4: Applications and Practice in Materials Exploration ‚Üí</a></strong></p>
<hr />
<h2>Exercises</h2>
<p>(Omitted: Detailed Implementation of Exercises)</p>
<hr />
<h2>References</h2>
<ol>
<li>
<p>Jones, D. R. et al. (1998). "Efficient Global Optimization of Expensive Black-Box Functions." <em>Journal of Global Optimization</em>, 13(4), 455-492.</p>
</li>
<li>
<p>Daulton, S. et al. (2020). "Differentiable Expected Hypervolume Improvement for Parallel Multi-Objective Bayesian Optimization." <em>NeurIPS</em>.</p>
</li>
</ol>
<hr />
<h2>Navigation</h2>
<h3>Previous Chapter</h3>
<p><strong><a href="./chapter-2.html">‚Üê Chapter 2: Uncertainty Estimation Techniques</a></strong></p>
<h3>Next Chapter</h3>
<p><strong><a href="./chapter-4.html">Chapter 4: Applications and Practice in Materials Exploration ‚Üí</a></strong></p>
<h3>Series Table of Contents</h3>
<p><strong><a href="./index.html">‚Üê Back to Series Table of Contents</a></strong></p>
<hr />
<p><strong>Learn practical applications in the next chapter!</strong></p><div class="navigation">
    <a href="chapter-2.html" class="nav-button">‚Üê Previous Chapter</a>
    <a href="index.html" class="nav-button">Back to Table of Contents</a>
    <a href="chapter-4.html" class="nav-button">Next Chapter ‚Üí</a>
</div>
    </main>

    
    <section class="disclaimer">
        <h3>Disclaimer</h3>
        <ul>
            <li>This content is intended solely for educational, research, and informational purposes, and does not provide professional advice (legal, accounting, technical guarantees, etc.).</li>
            <li>This content and accompanying code examples are provided "AS IS" with no warranty, express or implied, including but not limited to merchantability, fitness for a particular purpose, non-infringement, accuracy, completeness, functionality, or safety.</li>
            <li>The creators and Tohoku University are not responsible for the content, availability, or safety of external links, third-party data, tools, or libraries.</li>
            <li>To the maximum extent permitted by applicable law, the creators and Tohoku University are not liable for any direct, indirect, incidental, special, consequential, or punitive damages arising from the use, execution, or interpretation of this content.</li>
            <li>The content may be changed, updated, or discontinued without notice.</li>
            <li>The copyright and license of this content follow the specified conditions (e.g., CC BY 4.0). Such licenses typically include warranty disclaimers.</li>
        </ul>
    </section>

<footer>
        <p><strong>Creator</strong>: AI Terakoya Content Team</p>
        <p><strong>Version</strong>: 1.0 | <strong>Created</strong>: 2025-10-18</p>
        <p><strong>License</strong>: Creative Commons BY 4.0</p>
        <p>¬© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
