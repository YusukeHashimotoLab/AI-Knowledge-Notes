<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="Chapter 1: Protein Structure and Biomaterials - AI Terakoya" name="description"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Chapter 1: Protein Structure and Biomaterials - AI Terakoya</title>
<link href="../../assets/css/knowledge-base.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>
<!-- MathJax for LaTeX equation rendering -->
<script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<nav class="breadcrumb">
<div class="breadcrumb-content">
<a href="../../index.html">AI Terakoya Top</a><span class="breadcrumb-separator">‚Ä∫</span><a href="../index.html">Materials Informatics</a><span class="breadcrumb-separator">‚Ä∫</span><a href="index.html">Bioinformatics</a><span class="breadcrumb-separator">‚Ä∫</span><span class="breadcrumb-current">Chapter 1</span>
</div>
</nav><div class="locale-switcher">
<span class="current-locale">üåê EN</span>
<span class="locale-separator">|</span>
<a href="../../../jp/MI/bioinformatics-introduction/chapter-1.html" class="locale-link">üáØüáµ JP</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
<div class="header-content">
<h1>Chapter 1: Protein Structure and Biomaterials</h1>
<p class="subtitle">Understanding Biomolecular Shapes with PDB and AlphaFold</p>
<div class="meta">
<span class="meta-item">üìñ Reading Time: 25-30 min</span>
<span class="meta-item">üìä Difficulty: Beginner</span>
<span class="meta-item">üíª Code Examples: 8</span>
<span class="meta-item">üìù Exercises: 3</span>
</div>
</div>
</header>
<main class="container">
<h1>Chapter 1: Protein Structure and Biomaterials</h1><p class="chapter-description">This chapter covers Protein Structure and Biomaterials. You will learn definition of bioinformatics, Read structure files, and Evaluate AlphaFold2 prediction accuracy.</p>


<p><strong>Understanding Biomolecular Shapes with PDB and AlphaFold</strong></p>
<h2>Learning Objectives</h2>
<p>By reading this chapter, you will be able to:</p>
<ul>
<li>‚úÖ Understand the definition of bioinformatics and its applications to materials science</li>
<li>‚úÖ Explain the hierarchical structure of proteins (primary to quaternary)</li>
<li>‚úÖ Retrieve and analyze protein structures from the PDB database</li>
<li>‚úÖ Read structure files and extract information using Biopython</li>
<li>‚úÖ Evaluate AlphaFold2 prediction accuracy and assess practical utility</li>
<li>‚úÖ Explain collagen structure and biomaterial applications</li>
</ul>
<p><strong>Reading Time</strong>: 25-30 minutes
<strong>Code Examples</strong>: 8
<strong>Exercises</strong>: 3</p>
<hr/>
<h2>1.1 What is Bioinformatics?</h2>
<h3>Definition and Interdisciplinarity</h3>
<p><strong>Bioinformatics</strong> is an interdisciplinary field that analyzes biological data using computational and information sciences.</p>
<div class="mermaid">
flowchart LR
    A[Biology] --&gt; D[Bioinformatics]
    B[Computer Science] --&gt; D
    C[Materials Science] --&gt; D

    D --&gt; E[Biomaterial Design]
    D --&gt; F[Drug Delivery]
    D --&gt; G[Biosensor Development]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#4CAF50,color:#fff
    style E fill:#ffebee
    style F fill:#f3e5f5
    style G fill:#fff9c4
</div>
<hr/>
<h3>Application Domains</h3>
<p><strong>1. Biomaterial Design</strong>
- Collagen artificial skin (tissue engineering)
- Silk fiber structure optimization (Spiber Inc.)
- Peptide hydrogels (drug delivery)</p>
<p><strong>2. Drug Delivery Systems (DDS)</strong>
- Antibody therapeutics (targeted therapy)
- Nanoparticle carriers (cancer treatment)
- Liposomal formulations (vaccines)</p>
<p><strong>3. Biosensor Development</strong>
- Glucose sensors (diabetes management)
- Antibody biosensors (COVID-19 diagnostics)
- DNA chips (genetic diagnostics)</p>
<hr/>
<h3>Protein Structural Hierarchy</h3>
<p>Protein structure is described at four levels:</p>
<p><strong>Primary Structure</strong>
- Amino acid sequence
- Connected by peptide bonds
- Example: Gly-Pro-Ala-Ser-...</p>
<p><strong>Secondary Structure</strong>
- Alpha helix (Œ±-helix, helical structure)
- Beta sheet (Œ≤-sheet, planar structure)
- Loops</p>
<p><strong>Tertiary Structure</strong>
- Three-dimensional folding of polypeptide chain
- Hydrophobic interactions, hydrogen bonds, disulfide bonds</p>
<p><strong>Quaternary Structure</strong>
- Assembly of multiple subunits
- Example: Hemoglobin (4 subunits)</p>
<hr/>
<h2>1.2 Utilizing PDB (Protein Data Bank)</h2>
<h3>What is PDB?</h3>
<p><strong>PDB (Protein Data Bank)</strong> is the world's largest database for publicly sharing three-dimensional structures of proteins and nucleic acids.</p>
<p><strong>Statistics (as of 2025)</strong>:
- Registered structures: Over 200,000
- X-ray crystallography: 90%
- NMR: 8%
- Electron microscopy: 2%</p>
<p><strong>Access</strong>: <a href="https://www.rcsb.org/">https://www.rcsb.org/</a></p>
<hr/>
<h3>PDB File Structure</h3>
<p>PDB files are text-based and contain atomic coordinates with associated information.</p>
<p><strong>Example 1: Basic PDB File Structure</strong></p>
<pre><code class="language-python"># Main sections of a PDB file
"""
HEADER    Structure classification and date
TITLE     Brief description of structure
COMPND    Compound name
SOURCE    Biological species
ATOM      Atomic coordinates
HELIX     Alpha helix regions
SHEET     Beta sheet regions
CONECT    Bond information
"""

# Example of ATOM record
"""
ATOM      1  N   MET A   1      20.154  29.699   5.276  1.00 49.05           N
ATOM      2  CA  MET A   1      21.289  28.803   5.063  1.00 49.05           C
ATOM      3  C   MET A   1      21.628  28.123   6.377  1.00 49.05           C
"""

# Column meanings
"""
ATOM: Record type
1: Atom number
N: Atom name
MET: Amino acid (Methionine)
A: Chain ID
1: Residue number
20.154, 29.699, 5.276: x, y, z coordinates (√Ö)
1.00: Occupancy
49.05: B-factor (temperature factor)
N: Element symbol
"""
</code></pre>
<hr/>
<h3>Reading PDB Files with Biopython</h3>
<p><strong>Example 2: Reading PDB Structure and Extracting Basic Information</strong></p>
<pre><code class="language-python">from Bio.PDB import PDBParser
import warnings

# Suppress warnings
warnings.filterwarnings('ignore')

# Initialize PDB parser
parser = PDBParser(QUIET=True)

# Read PDB file (example: 1UBQ - Ubiquitin)
structure = parser.get_structure('ubiquitin', '1ubq.pdb')

# Display basic information
print("=== Basic Structure Information ===")
print(f"Structure name: {structure.id}")
print(f"Number of models: {len(structure)}")

# Get first model
model = structure[0]
print(f"Number of chains: {len(model)}")

# Information for each chain
for chain in model:
    residue_count = len(chain)
    print(f"Chain {chain.id}: {residue_count} residues")

    # Count atoms
    atom_count = sum(1 for residue in chain for atom in residue)
    print(f"  Number of atoms: {atom_count}")
</code></pre>
<p><strong>Output Example</strong>:</p>
<pre><code>=== Basic Structure Information ===
Structure name: ubiquitin
Number of models: 1
Number of chains: 1
Chain A: 76 residues
  Number of atoms: 602
</code></pre>
<hr/>
<h3>Atomic Coordinates and Distance Calculation</h3>
<p><strong>Example 3: Extracting Atomic Coordinates and Calculating Distances</strong></p>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Example 3: Extracting Atomic Coordinates and Calculating Dis

Purpose: Demonstrate core concepts and implementation patterns
Target: Beginner to Intermediate
Execution time: ~5 seconds
Dependencies: None
"""

from Bio.PDB import PDBParser
import numpy as np

parser = PDBParser(QUIET=True)
structure = parser.get_structure('ubiquitin', '1ubq.pdb')
model = structure[0]
chain = model['A']

# Get specific residue (10th isoleucine)
residue = chain[10]

print(f"=== Residue {residue.get_resname()} {residue.id[1]} ===")

# Get atomic coordinates
for atom in residue:
    coord = atom.get_coord()
    print(f"Atom {atom.name}: "
          f"({coord[0]:.2f}, {coord[1]:.2f}, {coord[2]:.2f})")

# Calculate distance between two atoms
atom1 = residue['CA']  # Alpha carbon
atom2 = residue['CB']  # Beta carbon

distance = atom1 - atom2  # Bio.PDB automatically calculates distance
print(f"\nCA-CB distance: {distance:.2f} √Ö")

# Manual distance calculation
coord1 = atom1.get_coord()
coord2 = atom2.get_coord()
manual_distance = np.linalg.norm(coord1 - coord2)
print(f"Manual calculation: {manual_distance:.2f} √Ö")
</code></pre>
<p><strong>Output Example</strong>:</p>
<pre><code>=== Residue ILE 10 ===
Atom N: (15.23, 18.45, 12.67)
Atom CA: (16.12, 17.89, 11.65)
Atom C: (17.28, 18.85, 11.32)
Atom O: (17.15, 20.07, 11.45)
Atom CB: (15.34, 17.53, 10.38)

CA-CB distance: 1.53 √Ö
Manual calculation: 1.53 √Ö
</code></pre>
<hr/>
<h3>Retrieving Secondary Structure</h3>
<p><strong>Example 4: DSSP (Secondary Structure Analysis)</strong></p>
<pre><code class="language-python">from Bio.PDB import PDBParser, DSSP
import warnings
warnings.filterwarnings('ignore')

# Read structure
parser = PDBParser(QUIET=True)
structure = parser.get_structure('protein', '1ubq.pdb')
model = structure[0]

# Run DSSP (Define Secondary Structure of Proteins)
# Note: Requires dssp executable (conda install -c salilab dssp)
try:
    dssp = DSSP(model, '1ubq.pdb', dssp='mkdssp')

    print("=== Secondary Structure Analysis ===")
    print("Residue | AA | Secondary Structure | Solvent Accessible Area")
    print("-" * 45)

    # Information for each residue
    for key in list(dssp.keys())[:20]:  # First 20 residues
        residue_info = dssp[key]
        chain_id = key[0]
        res_id = key[1][1]
        aa = residue_info[1]
        ss = residue_info[2]  # Secondary structure
        asa = residue_info[3]  # Solvent accessible area

        # Secondary structure symbols
        # H: Alpha helix, B: Beta bridge,
        # E: Beta strand, G: 3-10 helix
        # I: Pi helix, T: Turn, S: Bend
        # -: Coil

        print(f"{res_id:4d} | {aa:3s} | {ss:^12s} | "
              f"{asa:6.1f} ≈≤")

except FileNotFoundError:
    print("DSSP not installed")
    print("Install: conda install -c salilab dssp")
</code></pre>
<hr/>
<h2>1.3 Utilizing AlphaFold</h2>
<h3>The AlphaFold2 Revolution</h3>
<p><strong>AlphaFold2</strong> (DeepMind, 2020) is a deep learning model that predicts protein three-dimensional structures from amino acid sequences with high accuracy.</p>
<p><strong>Achievements</strong>:
- Overwhelming victory in CASP14 (structure prediction competition)
- Prediction accuracy: RMSD &lt; 1.5 √Ö with experimental structures (atomic-level precision)
- Prediction time: Minutes to hours (compared to months to years for traditional experiments)</p>
<hr/>
<h3>AlphaFold Database</h3>
<p><strong>AlphaFold Protein Structure Database</strong> publicly shares over 200 million protein structures.</p>
<p><strong>Access</strong>: <a href="https://alphafold.ebi.ac.uk/">https://alphafold.ebi.ac.uk/</a></p>
<p><strong>Example 5: Downloading AlphaFold Predicted Structures</strong></p>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - requests&gt;=2.31.0

import requests
import gzip
import shutil

def download_alphafold_structure(uniprot_id, output_file):
    """
    Download PDB structure from AlphaFold Database

    Parameters:
    -----------
    uniprot_id : str
        UniProt ID (e.g., P69905)
    output_file : str
        Output filename
    """
    # AlphaFold DB URL
    base_url = "https://alphafold.ebi.ac.uk/files/"
    pdb_url = f"{base_url}AF-{uniprot_id}-F1-model_v4.pdb"

    print(f"Downloading: {pdb_url}")

    try:
        response = requests.get(pdb_url)
        response.raise_for_status()

        with open(output_file, 'w') as f:
            f.write(response.text)

        print(f"Saved: {output_file}")
        return True
    except requests.exceptions.RequestException as e:
        print(f"Error: {e}")
        return False

# Example: Download hemoglobin beta chain (P69905)
download_alphafold_structure('P69905', 'hemoglobin_beta.pdb')
</code></pre>
<hr/>
<h3>Evaluating Prediction Confidence (pLDDT)</h3>
<p><strong>pLDDT (predicted Local Distance Difference Test)</strong> is AlphaFold's prediction confidence score (0-100).</p>
<p><strong>Interpretation</strong>:
- <strong>90-100</strong>: Very high confidence (equivalent to experimental structures)
- <strong>70-90</strong>: High confidence (generally accurate)
- <strong>50-70</strong>: Low confidence (loop regions, etc.)
- <strong>&lt; 50</strong>: Very low confidence (disordered regions)</p>
<p><strong>Example 6: Extracting and Visualizing pLDDT</strong></p>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Example 6: Extracting and Visualizing pLDDT

Purpose: Demonstrate data visualization techniques
Target: Beginner to Intermediate
Execution time: 2-5 seconds
Dependencies: None
"""

from Bio.PDB import PDBParser
import matplotlib.pyplot as plt
import numpy as np

# Read AlphaFold structure
parser = PDBParser(QUIET=True)
structure = parser.get_structure('alphafold', 'hemoglobin_beta.pdb')

# pLDDT is stored in the B-factor column
model = structure[0]
chain = model['A']

residue_numbers = []
plddt_scores = []

for residue in chain:
    if residue.id[0] == ' ':  # Only standard residues
        residue_numbers.append(residue.id[1])
        # Get B-factor of CA atom (pLDDT)
        ca_atom = residue['CA']
        plddt_scores.append(ca_atom.bfactor)

# Visualization
plt.figure(figsize=(12, 5))
plt.plot(residue_numbers, plddt_scores, linewidth=2)
plt.axhline(y=90, color='green', linestyle='--',
            label='Very High Confidence (&gt;90)')
plt.axhline(y=70, color='orange', linestyle='--',
            label='High Confidence (&gt;70)')
plt.axhline(y=50, color='red', linestyle='--',
            label='Low Confidence (&gt;50)')

plt.xlabel('Residue Number', fontsize=12)
plt.ylabel('pLDDT Score', fontsize=12)
plt.title('AlphaFold Prediction Confidence (Hemoglobin Beta Chain)',
          fontsize=14)
plt.legend()
plt.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('plddt_plot.png', dpi=300)
plt.show()

# Statistical information
print(f"=== pLDDT Statistics ===")
print(f"Mean: {np.mean(plddt_scores):.1f}")
print(f"Median: {np.median(plddt_scores):.1f}")
print(f"Minimum: {np.min(plddt_scores):.1f}")
print(f"Maximum: {np.max(plddt_scores):.1f}")
print(f"High confidence region (&gt;70): "
      f"{100 * np.sum(np.array(plddt_scores) &gt; 70) / len(plddt_scores):.1f}%")
</code></pre>
<hr/>
<h2>1.4 Case Study: Collagen Structure Analysis</h2>
<h3>What is Collagen?</h3>
<p><strong>Collagen</strong> is the most abundant protein in mammals and is the main component of skin, bone, and cartilage.</p>
<p><strong>Structural Features</strong>:
- Triple helix structure (3 polypeptide chains)
- Repeating sequence: (Gly-X-Y)n (X, Y are proline, hydroxyproline)
- Full length: Approximately 300 nm</p>
<p><strong>Biomaterial Applications</strong>:
- Artificial skin (burn treatment)
- Bone regeneration materials
- Cosmetic medicine (collagen injections)</p>
<hr/>
<h3>Retrieving Collagen Structure from PDB</h3>
<p><strong>Example 7: Collagen Structure Analysis</strong></p>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Example 7: Collagen Structure Analysis

Purpose: Demonstrate data visualization techniques
Target: Intermediate
Execution time: 2-5 seconds
Dependencies: None
"""

from Bio.PDB import PDBParser
import matplotlib.pyplot as plt
import numpy as np

# Collagen-like peptide structure (1K6F)
parser = PDBParser(QUIET=True)
structure = parser.get_structure('collagen', '1k6f.pdb')

model = structure[0]

print("=== Collagen Structure Analysis ===")
print(f"Number of chains: {len(model)}")

# Length of each chain
for chain in model:
    residue_count = len([res for res in chain if res.id[0] == ' '])
    print(f"Chain {chain.id}: {residue_count} residues")

# Confirming triple helix structure: inter-chain distances
chainA = model['A']
chainB = model['B']
chainC = model['C']

# Get CA atom of central residue in each chain
def get_central_ca(chain):
    residues = [res for res in chain if res.id[0] == ' ']
    central_idx = len(residues) // 2
    return residues[central_idx]['CA']

ca_A = get_central_ca(chainA)
ca_B = get_central_ca(chainB)
ca_C = get_central_ca(chainC)

# Inter-chain distances
dist_AB = ca_A - ca_B
dist_BC = ca_B - ca_C
dist_CA = ca_C - ca_A

print(f"\n=== Triple Helix Inter-Chain Distances ===")
print(f"A-B: {dist_AB:.2f} √Ö")
print(f"B-C: {dist_BC:.2f} √Ö")
print(f"C-A: {dist_CA:.2f} √Ö")
print(f"Average: {np.mean([dist_AB, dist_BC, dist_CA]):.2f} √Ö")

# Calculate helix pitch (rise per residue)
first_ca = chainA[7]['CA']
last_ca = chainA[20]['CA']
z_rise = last_ca.get_coord()[2] - first_ca.get_coord()[2]
num_residues = 20 - 7

rise_per_residue = z_rise / num_residues
print(f"\nHelix rise (per residue): {rise_per_residue:.2f} √Ö")
</code></pre>
<p><strong>Output Example</strong>:</p>
<pre><code>=== Collagen Structure Analysis ===
Number of chains: 3
Chain A: 27 residues
Chain B: 27 residues
Chain C: 27 residues

=== Triple Helix Inter-Chain Distances ===
A-B: 10.2 √Ö
B-C: 10.1 √Ö
C-A: 10.3 √Ö
Average: 10.2 √Ö

Helix rise (per residue): 2.9 √Ö
</code></pre>
<hr/>
<h3>Collagen Sequence Pattern Analysis</h3>
<p><strong>Example 8: Validating Gly-X-Y Repeats</strong></p>
<pre><code class="language-python">from Bio.PDB import PDBParser
from collections import Counter

parser = PDBParser(QUIET=True)
structure = parser.get_structure('collagen', '1k6f.pdb')
chain = structure[0]['A']

# Get amino acid sequence
sequence = []
for residue in chain:
    if residue.id[0] == ' ':  # Standard residues
        resname = residue.get_resname()
        # Convert 3-letter code to 1-letter code (simplified version)
        aa_dict = {
            'GLY': 'G', 'PRO': 'P', 'ALA': 'A',
            'VAL': 'V', 'LEU': 'L', 'ILE': 'I',
            'MET': 'M', 'PHE': 'F', 'TYR': 'Y',
            'TRP': 'W', 'SER': 'S', 'THR': 'T',
            'CYS': 'C', 'ASN': 'N', 'GLN': 'Q',
            'ASP': 'D', 'GLU': 'E', 'LYS': 'K',
            'ARG': 'R', 'HIS': 'H'
        }
        if resname in aa_dict:
            sequence.append(aa_dict[resname])
        else:
            sequence.append('X')  # Unknown amino acid

seq_str = ''.join(sequence)
print(f"Sequence: {seq_str}")

# Validate Gly-X-Y pattern
gly_positions = [i for i, aa in enumerate(sequence) if aa == 'G']
print(f"\nGly positions: {gly_positions}")

# Check if Gly appears every 3 residues
expected_positions = list(range(0, len(sequence), 3))
match_count = sum(1 for pos in gly_positions
                  if pos in expected_positions)
print(f"Gly-X-Y pattern match rate: "
      f"{100 * match_count / len(gly_positions):.1f}%")

# Amino acid composition
aa_composition = Counter(sequence)
print(f"\nAmino acid composition:")
for aa, count in aa_composition.most_common():
    percentage = 100 * count / len(sequence)
    print(f"  {aa}: {count} ({percentage:.1f}%)")
</code></pre>
<hr/>
<h2>1.5 Chapter Summary</h2>
<h3>What We Learned</h3>
<ol>
<li>
<p><strong>Definition of Bioinformatics</strong>
   - Biology √ó Computer Science √ó Materials Science
   - Application domains: Biomaterials, DDS, biosensors</p>
</li>
<li>
<p><strong>Protein Structural Hierarchy</strong>
   - Primary structure (sequence) ‚Üí Secondary structure (Œ±-helix, Œ≤-sheet)
   - Tertiary structure (folding) ‚Üí Quaternary structure (complex)</p>
</li>
<li>
<p><strong>PDB Database</strong>
   - Over 200,000 structural data entries
   - Analysis methods with Biopython</p>
</li>
<li>
<p><strong>AlphaFold2</strong>
   - High-accuracy structure prediction from sequence
   - Reliability assessment using pLDDT</p>
</li>
<li>
<p><strong>Collagen Structure</strong>
   - Triple helix structure
   - Gly-X-Y repeating pattern
   - Biomaterial applications</p>
</li>
</ol>
<h3>Key Points</h3>
<ul>
<li>‚úÖ Protein structure <strong>determines function</strong></li>
<li>‚úÖ PDB is a <strong>treasure trove of experimental structures</strong></li>
<li>‚úÖ AlphaFold has <strong>revolutionized prediction</strong></li>
<li>‚úÖ Biopython makes <strong>structure analysis easy</strong></li>
<li>‚úÖ Collagen is an <strong>important biomaterial</strong></li>
</ul>
<h3>To the Next Chapter</h3>
<p>In Chapter 2, we will learn about <strong>sequence analysis and machine learning</strong>:
- Homology sequence search with BLAST
- Feature extraction from sequences
- Functional prediction using machine learning
- Case study: Enzyme activity prediction</p>
<p><strong><a href="chapter-2.html">Chapter 2: Sequence Analysis and Machine Learning ‚Üí</a></strong></p>
<hr/>
<h2>Exercises</h2>
<h3>Exercise 1 (Difficulty: Easy)</h3>
<p>Extract specific information from a PDB file.</p>
<p><strong>Task</strong>:
1. Download PDB file (1UBQ)
2. Calculate total number of atoms
3. Aggregate counts for each element (C, N, O, S)</p>
<details>
<summary>Hint</summary>

- Use `atom.element` to get element symbol
- Use Counter for aggregation

</details>
<details>
<summary>Solution Example</summary>
<pre><code class="language-python">from Bio.PDB import PDBParser
from collections import Counter

parser = PDBParser(QUIET=True)
structure = parser.get_structure('ubiquitin', '1ubq.pdb')

elements = []
for model in structure:
    for chain in model:
        for residue in chain:
            for atom in residue:
                elements.append(atom.element)

print(f"Total atoms: {len(elements)}")
print("\nElement composition:")
for elem, count in Counter(elements).most_common():
    print(f"  {elem}: {count}")
</code></pre>


**Output Example**:

<pre><code>Total atoms: 602
Element composition:
  C: 312
  O: 100
  N: 89
  S: 1
</code></pre>
</details>
<hr/>
<h3>Exercise 2 (Difficulty: Medium)</h3>
<p>Analyze the pLDDT scores of an AlphaFold predicted structure and identify regions of high and low confidence.</p>
<details>
<summary>Solution Example</summary>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Analyze the pLDDT scores of an AlphaFold predicted structure

Purpose: Demonstrate core concepts and implementation patterns
Target: Beginner to Intermediate
Execution time: ~5 seconds
Dependencies: None
"""

from Bio.PDB import PDBParser
import numpy as np

parser = PDBParser(QUIET=True)
structure = parser.get_structure('alphafold', 'alphafold_structure.pdb')

chain = structure[0]['A']
high_confidence = []
low_confidence = []

for residue in chain:
    if residue.id[0] == ' ':
        res_id = residue.id[1]
        plddt = residue['CA'].bfactor

        if plddt &gt;= 90:
            high_confidence.append(res_id)
        elif plddt &lt; 70:
            low_confidence.append(res_id)

print(f"High confidence region (pLDDT &gt;= 90): {len(high_confidence)} residues")
print(f"Range: {min(high_confidence)}-{max(high_confidence)}")

print(f"\nLow confidence region (pLDDT &lt; 70): {len(low_confidence)} residues")
if low_confidence:
    print(f"Range: {min(low_confidence)}-{max(low_confidence)}")
</code></pre>
</details>
<hr/>
<h3>Exercise 3 (Difficulty: Hard)</h3>
<p>Analyze the triple helix structure of collagen in detail.</p>
<p><strong>Task</strong>:
1. Extract CA atom coordinates from 3 chains
2. Calculate helix radius
3. Estimate helix pitch (rise per turn)</p>
<details>
<summary>Hint</summary>

- Find helix central axis (center of mass of 3 chains)
- Distance from each CA atom to central axis = radius
- Pitch = (z-direction rise) / (number of turns)

</details>
<details>
<summary>Solution Example</summary>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Task:
1. Extract CA atom coordinates from 3 chains
2. Calcul

Purpose: Demonstrate core concepts and implementation patterns
Target: Beginner to Intermediate
Execution time: 10-30 seconds
Dependencies: None
"""

from Bio.PDB import PDBParser
import numpy as np

parser = PDBParser(QUIET=True)
structure = parser.get_structure('collagen', '1k6f.pdb')
model = structure[0]

# Get CA coordinates from 3 chains
chains_coords = {}
for chain_id in ['A', 'B', 'C']:
    chain = model[chain_id]
    coords = []
    for residue in chain:
        if residue.id[0] == ' ':
            coords.append(residue['CA'].get_coord())
    chains_coords[chain_id] = np.array(coords)

# Central axis (center of mass of all CA atoms)
all_coords = np.vstack(list(chains_coords.values()))
center = np.mean(all_coords, axis=0)

# Helix radius (distance from central axis)
radii = []
for coords in chains_coords.values():
    for coord in coords:
        # Distance in xy plane
        dist = np.linalg.norm(coord[:2] - center[:2])
        radii.append(dist)

print(f"Helix radius: {np.mean(radii):.2f} ¬± "
      f"{np.std(radii):.2f} √Ö")

# Pitch (z-direction rise)
z_coords = chains_coords['A'][:, 2]
z_rise = z_coords[-1] - z_coords[0]
num_residues = len(chains_coords['A'])

# Collagen helix makes approximately 1 turn per 3 residues
turns = num_residues / 3
pitch = z_rise / turns

print(f"Helix pitch: {pitch:.2f} √Ö/turn")
</code></pre>
</details>
<hr/>
<h2>Data Licenses and Citations</h2>
<h3>Structure Databases</h3>
<p>Biological databases used in code examples in this chapter:</p>
<h4>1. PDB (Protein Data Bank)</h4>
<ul>
<li><strong>License</strong>: CC0 1.0 Public Domain</li>
<li><strong>Citation</strong>: Berman, H. M. et al. (2000). "The Protein Data Bank." <em>Nucleic Acids Research</em>, 28(1), 235-242.</li>
<li><strong>Access</strong>: https://www.rcsb.org/</li>
<li><strong>Purpose</strong>: Experimental structure data for proteins and nucleic acids</li>
<li><strong>Data Examples</strong>: 1UBQ (Ubiquitin), 1K6F (Collagen-like peptide)</li>
</ul>
<h4>2. AlphaFold Protein Structure Database</h4>
<ul>
<li><strong>License</strong>: CC BY 4.0</li>
<li><strong>Citation</strong>: Jumper, J. et al. (2021). "Highly accurate protein structure prediction with AlphaFold." <em>Nature</em>, 596(7873), 583-589.</li>
<li><strong>Access</strong>: https://alphafold.ebi.ac.uk/</li>
<li><strong>Purpose</strong>: AlphaFold2 structure prediction data (over 200 million proteins)</li>
<li><strong>API</strong>: https://alphafold.ebi.ac.uk/api/</li>
</ul>
<h4>3. UniProt</h4>
<ul>
<li><strong>License</strong>: CC BY 4.0</li>
<li><strong>Citation</strong>: The UniProt Consortium. (2023). "UniProt: the Universal Protein Knowledgebase in 2023." <em>Nucleic Acids Research</em>, 51(D1), D523-D531.</li>
<li><strong>Access</strong>: https://www.uniprot.org/</li>
<li><strong>Purpose</strong>: Protein sequences and annotation information</li>
</ul>
<h3>Library Licenses</h3>
<table>
<thead>
<tr>
<th>Library</th>
<th>Version</th>
<th>License</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>Biopython</td>
<td>1.81+</td>
<td>BSD-3-Clause</td>
<td>Structure analysis/sequence manipulation</td>
</tr>
<tr>
<td>NumPy</td>
<td>1.24+</td>
<td>BSD-3-Clause</td>
<td>Numerical computation</td>
</tr>
<tr>
<td>Matplotlib</td>
<td>3.7+</td>
<td>PSF (BSD-like)</td>
<td>Visualization</td>
</tr>
<tr>
<td>requests</td>
<td>2.31+</td>
<td>Apache 2.0</td>
<td>Data download</td>
</tr>
</tbody>
</table>
<p><strong>License Compliance</strong>:
- All allow commercial use
- Proper citations required in academic papers
- Always cite sources when using PDB/AlphaFold structures</p>
<hr/>
<h2>Code Reproducibility</h2>
<h3>Environment Setup</h3>
<h4>Installing Required Packages</h4>
<pre><code class="language-bash"># requirements.txt
biopython==1.81
numpy==1.24.3
matplotlib==3.7.1
requests==2.31.0
scipy==1.11.1

# Install
pip install -r requirements.txt
</code></pre>
<h4>Optional Tools</h4>
<pre><code class="language-bash"># DSSP (secondary structure analysis)
conda install -c salilab dssp

# PyMOL (structure visualization)
conda install -c conda-forge pymol-open-source
</code></pre>
<h3>Obtaining PDB Files</h3>
<pre><code class="language-python"># Reproducible PDB download
from Bio.PDB import PDBList

def download_pdb_reproducible(pdb_id, output_dir='./pdb_files'):
    """
    Download PDB structure reproducibly

    Parameters:
    -----------
    pdb_id : str
        PDB ID (e.g., '1ubq')
    output_dir : str
        Save directory
    """
    pdbl = PDBList()
    filename = pdbl.retrieve_pdb_file(
        pdb_id,
        pdir=output_dir,
        file_format='pdb'
    )

    print(f"Downloaded: {pdb_id} ‚Üí {filename}")
    return filename

# Usage example
download_pdb_reproducible('1ubq')
download_pdb_reproducible('1k6f')  # Collagen
</code></pre>
<h3>Obtaining Fixed Version AlphaFold Structures</h3>
<pre><code class="language-python">def download_alphafold_with_version(uniprot_id, version='v4'):
    """
    Download AlphaFold structure with specific version

    Parameters:
    -----------
    uniprot_id : str
        UniProt ID
    version : str
        AlphaFold version (v1-v4)
    """
    base_url = "https://alphafold.ebi.ac.uk/files/"
    pdb_url = f"{base_url}AF-{uniprot_id}-F1-model_{version}.pdb"

    response = requests.get(pdb_url)
    response.raise_for_status()

    filename = f"AF_{uniprot_id}_{version}.pdb"
    with open(filename, 'w') as f:
        f.write(response.text)

    print(f"Downloaded AlphaFold {version}: {filename}")
    return filename
</code></pre>
<hr/>
<h2>Common Pitfalls and Solutions</h2>
<h3>1. PDB File Parsing Errors</h3>
<p><strong>Problem</strong>: Errors due to format differences or missing atoms in PDB files</p>
<p><strong>Symptom</strong>:</p>
<pre><code class="language-python"># NG example
structure = parser.get_structure('protein', 'broken.pdb')
# KeyError: 'CA'
</code></pre>
<p><strong>Solution</strong>:</p>
<pre><code class="language-python"># OK example: With error handling
from Bio.PDB import PDBParser
import warnings

parser = PDBParser(QUIET=True)
structure = parser.get_structure('protein', 'protein.pdb')

for residue in chain:
    try:
        ca_atom = residue['CA']
        coord = ca_atom.get_coord()
    except KeyError:
        # Skip residues without CA atom
        print(f"Warning: No CA atom in residue {residue.id}")
        continue
</code></pre>
<h3>2. Misinterpreting AlphaFold pLDDT</h3>
<p><strong>Problem</strong>: Misunderstanding pLDDT score as absolute accuracy</p>
<p><strong>NG</strong>:</p>
<pre><code class="language-python"># Assuming all pLDDT &gt; 70 is reliable
if plddt &gt; 70:
    use_structure()  # Dangerous!
</code></pre>
<p><strong>OK</strong>:</p>
<pre><code class="language-python"># Setting thresholds based on application
if application == 'drug_design':
    threshold = 90  # High precision required
elif application == 'homology_modeling':
    threshold = 70  # Medium acceptable

if plddt &gt; threshold:
    use_structure()
</code></pre>
<p><strong>Recommended Standards</strong>:
- Docking studies: pLDDT &gt; 90
- Homology modeling: pLDDT &gt; 70
- Structure prediction validation: pLDDT &gt; 50</p>
<h3>3. Confusion of Coordinate System Units</h3>
<p><strong>Problem</strong>: Confusion between √Ö (Angstrom) and nm</p>
<p><strong>NG</strong>:</p>
<pre><code class="language-python">distance = atom1 - atom2  # √Ö units
if distance &lt; 5:  # nm? √Ö? Unclear
    print("Close contact")
</code></pre>
<p><strong>OK</strong>:</p>
<pre><code class="language-python">distance_angstrom = atom1 - atom2  # Explicitly √Ö units
CONTACT_THRESHOLD_A = 5.0  # √Ö

if distance_angstrom &lt; CONTACT_THRESHOLD_A:
    print(f"Close contact: {distance_angstrom:.2f} √Ö")

# Convert to nm if needed
distance_nm = distance_angstrom / 10.0
</code></pre>
<h3>4. DSSP Execution Errors</h3>
<p><strong>Problem</strong>: DSSP not installed or path not set</p>
<p><strong>Symptom</strong>:</p>
<pre><code class="language-python">dssp = DSSP(model, 'protein.pdb')
# FileNotFoundError: dssp executable not found
</code></pre>
<p><strong>Solution</strong>:</p>
<pre><code class="language-python">import shutil

# Check for DSSP executable
dssp_path = shutil.which('mkdssp') or shutil.which('dssp')

if dssp_path:
    dssp = DSSP(model, 'protein.pdb', dssp=dssp_path)
else:
    print("DSSP not installed. Please run:")
    print("  conda install -c salilab dssp")
    # Switch to alternative method
    use_alternative_ss_prediction()
</code></pre>
<h3>5. Memory Issues (Large Structures)</h3>
<p><strong>Problem</strong>: Memory errors with huge complexes (viruses, ribosomes, etc.)</p>
<p><strong>Solution</strong>:</p>
<pre><code class="language-python"># Process by chain
for chain in structure[0]:
    # Analyze per chain
    analyze_chain(chain)
    # Free memory
    del chain

# Or load only specific chains
chain_selection = ['A', 'B']  # Only needed chains
for chain_id in chain_selection:
    chain = structure[0][chain_id]
    analyze_chain(chain)
</code></pre>
<h3>6. Network Errors (Download Failures)</h3>
<p><strong>Problem</strong>: Downloads from AlphaFold/PDB fail mid-way</p>
<p><strong>Solution</strong>:</p>
<pre><code class="language-python">import time
from requests.adapters import HTTPAdapter
from requests.packages.urllib3.util.retry import Retry

def download_with_retry(url, max_retries=3):
    """
    Download with retry
    """
    session = requests.Session()
    retry = Retry(
        total=max_retries,
        backoff_factor=1,
        status_forcelist=[500, 502, 503, 504]
    )
    adapter = HTTPAdapter(max_retries=retry)
    session.mount('http://', adapter)
    session.mount('https://', adapter)

    for attempt in range(max_retries):
        try:
            response = session.get(url, timeout=30)
            response.raise_for_status()
            return response.text
        except requests.exceptions.RequestException as e:
            print(f"Attempt {attempt+1}/{max_retries} failed: {e}")
            if attempt &lt; max_retries - 1:
                time.sleep(2 ** attempt)  # Exponential backoff
            else:
                raise
</code></pre>
<hr/>
<h2>Quality Checklist</h2>
<h3>Data Acquisition Phase</h3>
<ul>
<li>[ ] Confirm PDB ID is correct (search on PDB site)</li>
<li>[ ] Confirm UniProt ID is correct</li>
<li>[ ] Verify downloaded file MD5 checksum</li>
<li>[ ] File size is reasonable (not empty file)</li>
<li>[ ] Visual inspection in text editor (ATOM records exist)</li>
</ul>
<h3>Structure Analysis Phase</h3>
<ul>
<li>[ ] Confirm CA atom exists in all residues</li>
<li>[ ] Check for missing residues (REMARK 465)</li>
<li>[ ] Check for abnormal coordinate values (typically -100 to 100 √Ö range)</li>
<li>[ ] B-factor values are reasonable (typically 0-100)</li>
<li>[ ] Check pLDDT score distribution (for AlphaFold structures)</li>
</ul>
<h3>AlphaFold-Specific Checks</h3>
<ul>
<li>[ ] pLDDT score average &gt; 70 (reliability)</li>
<li>[ ] Confirm positions of low confidence regions (pLDDT &lt; 50)</li>
<li>[ ] Distinguish loop regions vs structured regions</li>
<li>[ ] Check PAE map for relative placement reliability (if available)</li>
</ul>
<h3>Code Quality</h3>
<ul>
<li>[ ] Type hints added (<code>def func(x: Structure) -&gt; float:</code>)</li>
<li>[ ] Error handling implemented</li>
<li>[ ] Logging implemented (progress checkable)</li>
<li>[ ] Units explicitly stated (√Ö, nm, degrees, etc.)</li>
</ul>
<h3>Materials Science-Specific Checks</h3>
<ul>
<li>[ ] Understand protein biological function</li>
<li>[ ] Confirm feasibility of biomaterial application</li>
<li>[ ] Consider stability (thermal stability, pH stability)</li>
<li>[ ] Synthesis/manufacturing feasibility</li>
</ul>
<hr/>
<h2>References</h2>
<ol>
<li>
<p>Berman, H. M. et al. (2000). "The Protein Data Bank."
   <em>Nucleic Acids Research</em>, 28, 235-242.
   DOI: <a href="https://doi.org/10.1093/nar/28.1.235">10.1093/nar/28.1.235</a></p>
</li>
<li>
<p>Jumper, J. et al. (2021). "Highly accurate protein structure
   prediction with AlphaFold." <em>Nature</em>, 596, 583-589.
   DOI: <a href="https://doi.org/10.1038/s41586-021-03819-2">10.1038/s41586-021-03819-2</a></p>
</li>
<li>
<p>Shoulders, M. D. &amp; Raines, R. T. (2009). "Collagen Structure
   and Stability." <em>Annual Review of Biochemistry</em>, 78, 929-958.
   DOI: <a href="https://doi.org/10.1146/annurev.biochem.77.032207.120833">10.1146/annurev.biochem.77.032207.120833</a></p>
</li>
</ol>
<hr/>
<h2>Navigation</h2>
<h3>Next Chapter</h3>
<p><strong><a href="chapter-2.html">Chapter 2: Sequence Analysis and Machine Learning ‚Üí</a></strong></p>
<h3>Series Table of Contents</h3>
<p><strong><a href="./index.html">‚Üê Return to Series Table of Contents</a></strong></p>
<hr/>
<h2>Author Information</h2>
<p><strong>Created by</strong>: AI Terakoya Content Team
<strong>Created</strong>: 2025-10-17
<strong>Version</strong>: 1.0</p>
<p><strong>License</strong>: Creative Commons BY 4.0</p>
<hr/>
<p><strong>Let's learn sequence analysis and machine learning in detail in Chapter 2!</strong></p>
<div class="navigation">
<a class="nav-button" href="index.html">Return to Series Table of Contents</a>
<a class="nav-button" href="chapter-2.html">Next Chapter ‚Üí</a>
</div>
</main>
<section class="disclaimer">
<h3>Disclaimer</h3>
<ul>
<li>This content is provided solely for educational, research, and informational purposes and does not constitute professional advice (legal, accounting, technical guarantees, etc.).</li>
<li>This content and accompanying code examples are provided "AS IS" without any warranty, express or implied, including but not limited to merchantability, fitness for a particular purpose, non-infringement, accuracy, completeness, operation, or safety.</li>
<li>The creator and Tohoku University bear no responsibility for the content, availability, or safety of external links, third-party data, tools, libraries, etc.</li>
<li>To the maximum extent permitted by applicable law, the creator and Tohoku University are not liable for any direct, indirect, incidental, special, consequential, or punitive damages arising from the use, execution, or interpretation of this content.</li>
<li>The content of this material may be changed, updated, or discontinued without notice.</li>
<li>The copyright and license of this content are subject to the specified terms (e.g., CC BY 4.0). Such licenses typically include no-warranty clauses.</li>
</ul>
</section>
<footer>
<p><strong>Created by</strong>: AI Terakoya Content Team</p>
<p><strong>Version</strong>: 1.0 | <strong>Created</strong>: 2025-10-17</p>
<p><strong>License</strong>: Creative Commons BY 4.0</p>
<p>¬© 2025 AI Terakoya. All rights reserved.</p>
</footer>
</body>
</html>
