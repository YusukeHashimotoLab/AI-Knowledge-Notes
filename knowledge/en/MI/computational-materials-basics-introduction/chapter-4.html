<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Chapter 4: Phonon Calculations and Thermodynamic Properties - AI Terakoya</title>
<link href="../../assets/css/knowledge-base.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>
<!-- MathJax for LaTeX equation rendering -->
<script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
<nav class="breadcrumb">
<div class="breadcrumb-content">
<a href="/AI-Knowledge-Notes/knowledge/en/index.html">AI Terakoya Home</a><span class="breadcrumb-separator">‚Ä∫</span><a href="/AI-Knowledge-Notes/knowledge/en/MI/index.html">Materials Informatics</a><span class="breadcrumb-separator">‚Ä∫</span><a href="/AI-Knowledge-Notes/knowledge/en/MI/computational-materials-basics-introduction/index.html">Computational Materials Basics</a><span class="breadcrumb-separator">‚Ä∫</span><span class="breadcrumb-current">Chapter 4</span>
</div>
</nav><div class="locale-switcher">
<span class="current-locale">üåê EN</span>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
<div class="header-content">
<h1>Chapter 4: Phonon Calculations and Thermodynamic Properties</h1>
<p class="subtitle">From Lattice Vibrations to Thermal Transport</p>
<div class="meta">
<span class="meta-item">üìñ Reading Time: 20-25 min</span>
<span class="meta-item">üìä Difficulty: Intermediate to Advanced</span>
<span class="meta-item">üíª Code Examples: 6</span>
<span class="meta-item">üìù Exercises: 0</span>
</div>
</div>
</header>
<main class="container">
<h1>Chapter 4: Phonon Calculations and Thermodynamic Properties</h1>
<p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-left: 4px solid #7b2cbf; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">Grasp the concepts of lattice vibrations and density of states, and step into the world of property calculations including thermal transport.</p>
<p class="chapter-supplement" style="margin: 0.75rem 0 1.5rem 0; padding: 0.75rem 1rem; background: linear-gradient(135deg, #fff8e1 0%, #fff3cd 100%); border-left: 3px solid #f59e0b; border-radius: 6px; font-size: 0.95rem; line-height: 1.7; color: #4a5568;"><strong>üí° Note:</strong> Phonons are like an "atomic orchestra". Their frequency distribution reveals the characteristics of heat and vibrations.</p>
<h2>Learning Objectives</h2>
<p>By reading this chapter, you will master:
- Understanding the theoretical foundations of lattice vibrations (phonons)
- Explaining the concepts of harmonic approximation and dynamical matrix
- Executing actual phonon calculations with Phonopy
- Interpreting phonon band structures and density of states
- Calculating thermodynamic properties (heat capacity, free energy, entropy)</p>
<hr/>
<h2>4.1 Theory of Lattice Vibrations</h2>
<h3>Harmonic Oscillator Model</h3>
<p>Atoms in a crystal vibrate around their equilibrium positions $\mathbf{R}_I^0$. Let the displacement be $\mathbf{u}_I$:</p>
<p>$$
\mathbf{R}_I = \mathbf{R}_I^0 + \mathbf{u}_I
$$</p>
<p>Taylor expansion of potential energy (harmonic approximation):</p>
<p>$$
U = U_0 + \sum_I \frac{\partial U}{\partial \mathbf{u}_I}\Bigg|_0 \mathbf{u}_I + \frac{1}{2}\sum_{I,J} \mathbf{u}_I \cdot \frac{\partial^2 U}{\partial \mathbf{u}_I \partial \mathbf{u}_J}\Bigg|_0 \cdot \mathbf{u}_J + O(\mathbf{u}^3)
$$</p>
<p>At equilibrium, the first-order term vanishes:</p>
<p>$$
U \approx U_0 + \frac{1}{2}\sum_{I,J} \mathbf{u}_I \cdot \mathbf{\Phi}_{IJ} \cdot \mathbf{u}_J
$$</p>
<p>$\mathbf{\Phi}_{IJ}$ is the <strong>force constant matrix</strong>:</p>
<p>$$
\Phi_{IJ}^{\alpha\beta} = \frac{\partial^2 U}{\partial u_I^\alpha \partial u_J^\beta}\Bigg|_0
$$</p>
<h3>Equations of Motion</h3>
<p>Equation of motion for atom $I$:</p>
<p>$$
M_I \frac{d^2 u_I^\alpha}{dt^2} = -\sum_{J,\beta} \Phi_{IJ}^{\alpha\beta} u_J^\beta
$$</p>
<p>Assume plane wave solutions:</p>
<p>$$
u_I^\alpha = \frac{1}{\sqrt{M_I}} e_I^\alpha(\mathbf{k}) e^{i(\mathbf{k}\cdot\mathbf{R}_I - \omega t)}
$$</p>
<p>Introducing the <strong>dynamical matrix</strong>:</p>
<p>$$
D_{IJ}^{\alpha\beta}(\mathbf{k}) = \frac{1}{\sqrt{M_I M_J}} \Phi_{IJ}^{\alpha\beta} e^{i\mathbf{k}\cdot(\mathbf{R}_I - \mathbf{R}_J)}
$$</p>
<h3>Eigenvalue Problem</h3>
<p>$$
\sum_{J,\beta} D_{IJ}^{\alpha\beta}(\mathbf{k}) e_J^\beta(\mathbf{k}) = \omega^2(\mathbf{k}) e_I^\alpha(\mathbf{k})
$$</p>
<ul>
<li>$\omega(\mathbf{k})$: Phonon angular frequency (phonon dispersion)</li>
<li>$\mathbf{e}(\mathbf{k})$: Phonon eigenvector (polarization vector)</li>
</ul>
<p><strong>Number of phonon bands</strong>: $3N_{\text{atom}}$ branches (for $N_{\text{atom}}$ atoms per unit cell)</p>
<hr/>
<h2>4.2 Classification of Phonons</h2>
<h3>Acoustic Modes</h3>
<ul>
<li>$\omega(\mathbf{k}) \to 0$ as $\mathbf{k} \to 0$</li>
<li>Zero frequency at Œì point ($\mathbf{k}=0$)</li>
<li>3 branches (1 longitudinal LA, 2 transverse TA)</li>
<li>Physical meaning: Translational motion</li>
</ul>
<h3>Optical Modes</h3>
<ul>
<li>$\omega(\mathbf{k}) \neq 0$ at $\mathbf{k} = 0$</li>
<li>Finite frequency at Œì point</li>
<li>$3(N_{\text{atom}} - 1)$ branches</li>
<li>Physical meaning: Relative motion within unit cell</li>
</ul>
<h3>Longitudinal vs Transverse Waves</h3>
<ul>
<li><strong>Longitudinal (L)</strong>: Vibration direction parallel to wave propagation</li>
<li><strong>Transverse (T)</strong>: Vibration direction perpendicular to wave propagation</li>
</ul>
<p><strong>Monatomic crystals (Si, Cu, etc.)</strong>:
- Acoustic modes: 3 branches (1 LA + 2 TA)
- Optical modes: None</p>
<p><strong>Diatomic crystals (NaCl, GaAs, etc.)</strong>:
- Acoustic modes: 3 branches
- Optical modes: 3 branches (1 LO + 2 TO)</p>
<hr/>
<h2>4.3 Practical Application with Phonopy</h2>
<h3>Installation</h3>
<pre><code class="language-bash">pip install phonopy
# Or with conda
conda install -c conda-forge phonopy
</code></pre>
<h3>Example 1: Phonon Calculation for Si (using GPAW)</h3>
<p><strong>Step 1: Ground State Calculation</strong></p>
<pre><code class="language-python">from ase.build import bulk
from gpaw import GPAW, PW

# Create Si crystal
si = bulk('Si', 'diamond', a=5.43)

# DFT calculation
calc = GPAW(mode=PW(400),
            xc='PBE',
            kpts=(8, 8, 8),
            txt='si_gs.txt')

si.calc = calc
si.get_potential_energy()
calc.write('si_groundstate.gpw')
</code></pre>
<p><strong>Step 2: Create Supercell for Phonopy</strong></p>
<pre><code class="language-bash"># Create phonopy_disp.conf
cat &gt; phonopy_disp.conf &lt;&lt;EOF
DIM = 2 2 2
ATOM_NAME = Si
EOF

# Generate displacement structures with Phonopy
phonopy -d --dim="2 2 2" --gpaw
</code></pre>
<p>This generates <code>supercell-XXX.py</code> files.</p>
<p><strong>Step 3: Force Calculations</strong></p>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Step 3: Force Calculations

Purpose: Demonstrate core concepts and implementation patterns
Target: Beginner to Intermediate
Execution time: 5-10 seconds
Dependencies: None
"""

# Run supercell-001.py (for each displaced structure)
from gpaw import GPAW

calc = GPAW('si_groundstate.gpw', txt=None)
atoms = calc.get_atoms()
forces = atoms.get_forces()

# Write to FORCE_SETS file (format for Phonopy)
import numpy as np
np.savetxt('forces_001.dat', forces)
</code></pre>
<p><strong>Repeat for all displaced structures</strong> (typically automated with scripts)</p>
<p><strong>Step 4: Phonon Calculation</strong></p>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0

"""
Example: Step 4: Phonon Calculation

Purpose: Demonstrate data visualization techniques
Target: Beginner to Intermediate
Execution time: 2-5 seconds
Dependencies: None
"""

from phonopy import Phonopy
from phonopy.interface.gpaw import read_gpaw
import matplotlib.pyplot as plt

# Create Phonopy object
unitcell, calc_forces = read_gpaw('si_groundstate.gpw')
phonon = Phonopy(unitcell, [[2, 0, 0], [0, 2, 0], [0, 0, 2]])

# Set force constant matrix (from FORCE_SETS)
phonon.set_displacement_dataset(dataset)
phonon.produce_force_constants()

# Calculate band structure
path = [[[0, 0, 0], [0.5, 0, 0.5], [0.625, 0.25, 0.625],
         [0.375, 0.375, 0.75], [0, 0, 0], [0.5, 0.5, 0.5]]]
labels = ["$\\Gamma$", "X", "U", "K", "$\\Gamma$", "L"]
qpoints, connections = phonon.get_band_structure_plot_data(path)

phonon.plot_band_structure(path, labels=labels)
plt.ylabel('Frequency (THz)')
plt.savefig('si_phonon_band.png', dpi=150)
plt.show()

# Density of states (DOS)
phonon.set_mesh([20, 20, 20])
phonon.set_total_DOS()
dos_freq, dos_val = phonon.get_total_DOS()

plt.figure(figsize=(8, 6))
plt.plot(dos_freq, dos_val, linewidth=2)
plt.xlabel('Frequency (THz)', fontsize=12)
plt.ylabel('DOS (states/THz)', fontsize=12)
plt.title('Si Phonon DOS', fontsize=14)
plt.grid(alpha=0.3)
plt.savefig('si_phonon_dos.png', dpi=150)
plt.show()
</code></pre>
<hr/>
<h3>Example 2: Fully Automated Script</h3>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - numpy&gt;=1.24.0, &lt;2.0.0

from ase.build import bulk
from gpaw import GPAW, PW
from phonopy import Phonopy
from phonopy.structure.atoms import PhonopyAtoms
import numpy as np

def calculate_phonon(symbol='Si', a=5.43, dim=(2,2,2)):
    """
    Fully automated phonon calculation
    """
    # 1. Ground state calculation
    print("Step 1: Ground state calculation...")
    atoms = bulk(symbol, 'diamond', a=a)
    calc = GPAW(mode=PW(400), xc='PBE', kpts=(8,8,8), txt=None)
    atoms.calc = calc
    atoms.get_potential_energy()

    # 2. Phonopy setup
    print("Step 2: Generate displacements...")
    cell = PhonopyAtoms(symbols=[symbol]*len(atoms),
                       cell=atoms.cell,
                       scaled_positions=atoms.get_scaled_positions())

    phonon = Phonopy(cell, np.diag(dim))
    phonon.generate_displacements(distance=0.01)

    # 3. Force calculations
    print(f"Step 3: Calculate forces for {len(phonon.supercells_with_displacements)} supercells...")
    set_of_forces = []

    for i, scell in enumerate(phonon.supercells_with_displacements):
        supercell = bulk(symbol, 'diamond', a=a).repeat(dim)
        supercell.positions = scell.positions
        supercell.calc = calc
        forces = supercell.get_forces()
        drift_force = forces.sum(axis=0)
        for force in forces:
            force -= drift_force / len(forces)  # Drift correction
        set_of_forces.append(forces)

    # 4. Phonon calculation
    print("Step 4: Phonon calculation...")
    phonon.produce_force_constants(forces=set_of_forces)

    # Band structure
    path = [[[0, 0, 0], [0.5, 0, 0.5], [0.625, 0.25, 0.625],
             [0.375, 0.375, 0.75], [0, 0, 0], [0.5, 0.5, 0.5]]]
    labels = ["$\\Gamma$", "X", "U", "K", "$\\Gamma$", "L"]

    phonon.auto_band_structure(plot=True, labels=labels, filename=f'{symbol}_band.png')

    # DOS
    phonon.auto_total_dos(plot=True, filename=f'{symbol}_dos.png')

    print("Done!")
    return phonon

# Execute
si_phonon = calculate_phonon('Si', a=5.43, dim=(2,2,2))
</code></pre>
<hr/>
<h2>4.4 Calculation of Thermodynamic Properties</h2>
<h3>Free Energy</h3>
<p><strong>Helmholtz free energy</strong> (NVT):</p>
<p>$$
F(T) = U_0 + k_B T \sum_{\mathbf{q},j} \ln\left[2\sinh\left(\frac{\hbar\omega_{\mathbf{q}j}}{2k_B T}\right)\right]
$$</p>
<ul>
<li>$U_0$: Zero-point energy</li>
<li>$\omega_{\mathbf{q}j}$: Phonon frequency at wavevector $\mathbf{q}$, band $j$</li>
</ul>
<h3>Internal Energy</h3>
<p>$$
U(T) = U_0 + \sum_{\mathbf{q},j} \hbar\omega_{\mathbf{q}j} \left[\frac{1}{2} + n_B(\omega_{\mathbf{q}j}, T)\right]
$$</p>
<p>$n_B(\omega, T)$ is the Bose-Einstein distribution function:</p>
<p>$$
n_B(\omega, T) = \frac{1}{e^{\hbar\omega/(k_B T)} - 1}
$$</p>
<h3>Entropy</h3>
<p>$$
S(T) = -\left(\frac{\partial F}{\partial T}\right)_V = k_B \sum_{\mathbf{q},j} \left[\frac{\hbar\omega_{\mathbf{q}j}}{k_B T} n_B(\omega_{\mathbf{q}j}, T) - \ln(1 - e^{-\hbar\omega_{\mathbf{q}j}/(k_B T)})\right]
$$</p>
<h3>Heat Capacity (Constant Volume)</h3>
<p>$$
C_V(T) = \left(\frac{\partial U}{\partial T}\right)_V = k_B \sum_{\mathbf{q},j} \left(\frac{\hbar\omega_{\mathbf{q}j}}{k_B T}\right)^2 \frac{e^{\hbar\omega_{\mathbf{q}j}/(k_B T)}}{(e^{\hbar\omega_{\mathbf{q}j}/(k_B T)} - 1)^2}
$$</p>
<h3>Implementation in Phonopy</h3>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Implementation in Phonopy

Purpose: Demonstrate data visualization techniques
Target: Beginner to Intermediate
Execution time: 2-5 seconds
Dependencies: None
"""

import numpy as np
import matplotlib.pyplot as plt

# Temperature range
temperatures = np.arange(0, 1000, 10)

# Calculate thermodynamic properties
si_phonon.set_mesh([20, 20, 20])
si_phonon.set_thermal_properties(t_step=10, t_max=1000, t_min=0)

tp_dict = si_phonon.get_thermal_properties_dict()
temps = tp_dict['temperatures']
free_energy = tp_dict['free_energy']  # kJ/mol
entropy = tp_dict['entropy']  # J/K/mol
heat_capacity = tp_dict['heat_capacity']  # J/K/mol

# Plotting
fig, axes = plt.subplots(2, 2, figsize=(12, 10))

# Free energy
axes[0,0].plot(temps, free_energy, linewidth=2)
axes[0,0].set_xlabel('Temperature (K)', fontsize=12)
axes[0,0].set_ylabel('Free Energy (kJ/mol)', fontsize=12)
axes[0,0].set_title('Helmholtz Free Energy', fontsize=14)
axes[0,0].grid(alpha=0.3)

# Entropy
axes[0,1].plot(temps, entropy, linewidth=2, color='orange')
axes[0,1].set_xlabel('Temperature (K)', fontsize=12)
axes[0,1].set_ylabel('Entropy (J/K/mol)', fontsize=12)
axes[0,1].set_title('Entropy', fontsize=14)
axes[0,1].grid(alpha=0.3)

# Heat capacity
axes[1,0].plot(temps, heat_capacity, linewidth=2, color='green')
axes[1,0].axhline(3*8.314, color='red', linestyle='--', label='Dulong-Petit (3R)')
axes[1,0].set_xlabel('Temperature (K)', fontsize=12)
axes[1,0].set_ylabel('Heat Capacity (J/K/mol)', fontsize=12)
axes[1,0].set_title('Heat Capacity at Constant Volume', fontsize=14)
axes[1,0].legend()
axes[1,0].grid(alpha=0.3)

# Internal energy (calculated from F = U - TS)
internal_energy = free_energy + temps * entropy / 1000  # kJ/mol
axes[1,1].plot(temps, internal_energy, linewidth=2, color='purple')
axes[1,1].set_xlabel('Temperature (K)', fontsize=12)
axes[1,1].set_ylabel('Internal Energy (kJ/mol)', fontsize=12)
axes[1,1].set_title('Internal Energy', fontsize=14)
axes[1,1].grid(alpha=0.3)

plt.tight_layout()
plt.savefig('si_thermodynamics.png', dpi=150)
plt.show()

# Calculation of Debye temperature
# Temperature where heat capacity reaches 63% of 3R (Dulong-Petit limit)
R = 8.314  # J/K/mol
target_cv = 0.63 * 3 * R
idx = np.argmin(np.abs(heat_capacity - target_cv))
theta_D = temps[idx]
print(f"Debye temperature: {theta_D:.1f} K")
print(f"Experimental value (Si): 645 K")
</code></pre>
<hr/>
<h2>4.5 Thermal Expansion Coefficient</h2>
<h3>Quasi-harmonic Approximation (QHA)</h3>
<p>Perform phonon calculations at multiple volumes:</p>
<p>$$
\alpha(T) = \frac{1}{V}\left(\frac{\partial V}{\partial T}\right)_P = -\frac{1}{V}\frac{(\partial^2 F/\partial T \partial V)}{(\partial^2 F/\partial V^2)}
$$</p>
<h3>Implementation Example</h3>
<pre><code class="language-python"># Requirements:
# - Python 3.9+
# - matplotlib&gt;=3.7.0
# - numpy&gt;=1.24.0, &lt;2.0.0

"""
Example: Implementation Example

Purpose: Demonstrate data visualization techniques
Target: Advanced
Execution time: 2-5 seconds
Dependencies: None
"""

import numpy as np
import matplotlib.pyplot as plt

# Calculate for different lattice constants
lattice_constants = np.linspace(5.35, 5.51, 5)  # √Ö
phonons = []

for a in lattice_constants:
    print(f"Calculating phonon for a = {a:.3f} √Ö...")
    phonon = calculate_phonon('Si', a=a, dim=(2,2,2))
    phonons.append(phonon)

# Calculate free energy for each temperature and volume
temps = np.arange(0, 1000, 50)
volumes = (lattice_constants / 5.43)**3  # Normalized volume
free_energies = np.zeros((len(temps), len(volumes)))

for i, phonon in enumerate(phonons):
    phonon.set_mesh([20, 20, 20])
    phonon.set_thermal_properties(t_step=50, t_max=1000, t_min=0)
    tp = phonon.get_thermal_properties_dict()
    free_energies[:, i] = tp['free_energy']

# Find equilibrium volume for each temperature (F minimum)
V_eq = np.zeros(len(temps))
for i, T in enumerate(temps):
    # Quadratic polynomial fit
    coeffs = np.polyfit(volumes, free_energies[i], 2)
    V_eq[i] = -coeffs[1] / (2 * coeffs[0])  # Extremum

# Thermal expansion coefficient
alpha = np.gradient(V_eq, temps) / V_eq

# Plotting
plt.figure(figsize=(8, 6))
plt.plot(temps, alpha * 1e6, linewidth=2)
plt.xlabel('Temperature (K)', fontsize=12)
plt.ylabel('Thermal expansion coefficient (10$^{-6}$ K$^{-1}$)', fontsize=12)
plt.title('Si Thermal Expansion (QHA)', fontsize=14)
plt.grid(alpha=0.3)
plt.savefig('si_thermal_expansion.png', dpi=150)
plt.show()

print(f"Thermal expansion coefficient at room temperature (300K): {alpha[6]*1e6:.2f} √ó 10‚Åª‚Å∂ K‚Åª¬π")
print(f"Experimental value: 2.6 √ó 10‚Åª‚Å∂ K‚Åª¬π")
</code></pre>
<hr/>
<h2>4.6 Applications of Phonon Calculations</h2>
<h3>1. Lattice Thermal Conductivity</h3>
<p><strong>Estimation from Boltzmann transport equation</strong> (simplified version):</p>
<p>$$
\kappa = \frac{1}{3} \sum_{\mathbf{q},j} C_{\mathbf{q}j} v_{\mathbf{q}j}^2 \tau_{\mathbf{q}j}
$$</p>
<ul>
<li>$C_{\mathbf{q}j}$: Heat capacity per mode</li>
<li>$v_{\mathbf{q}j}$: Group velocity ($\partial\omega/\partial\mathbf{q}$)</li>
<li>$\tau_{\mathbf{q}j}$: Relaxation time (phonon scattering)</li>
</ul>
<p><strong>Group velocity calculation in Phonopy</strong>:</p>
<pre><code class="language-python"># Calculate group velocity
si_phonon.set_group_velocity()
group_velocities = si_phonon.get_group_velocity()

print("Group velocities at Gamma point:")
print(group_velocities[0])  # [band, cartesian_direction]
</code></pre>
<h3>2. Superconducting Critical Temperature (Tc)</h3>
<p><strong>McMillan formula</strong> (simplified):</p>
<p>$$
T_c = \frac{\omega_{\text{log}}}{1.2} \exp\left[-\frac{1.04(1+\lambda)}{\lambda - \mu^*(1+0.62\lambda)}\right]
$$</p>
<ul>
<li>$\omega_{\text{log}}$: Logarithmic average phonon frequency</li>
<li>$\lambda$: Electron-phonon coupling constant</li>
<li>$\mu^*$: Coulomb pseudopotential</li>
</ul>
<h3>3. Detection of Phase Transitions</h3>
<p><strong>Imaginary phonon modes</strong> indicate structural instability:</p>
<pre><code class="language-python"># Check for negative frequencies (imaginary modes)
frequencies = si_phonon.get_frequencies(q=[0, 0, 0])
if np.any(frequencies &lt; -1e-3):
    print("Warning: Imaginary phonon modes detected!")
    print("Structure may be unstable.")
</code></pre>
<hr/>
<h2>4.7 Chapter Summary</h2>
<h3>What We Learned</h3>
<ol>
<li>
<p><strong>Theory of Lattice Vibrations</strong>
   - Harmonic approximation
   - Dynamical matrix
   - Phonon dispersion relations</p>
</li>
<li>
<p><strong>Classification of Phonons</strong>
   - Acoustic modes vs optical modes
   - Longitudinal vs transverse waves</p>
</li>
<li>
<p><strong>Practical Application with Phonopy</strong>
   - Phonon band structures
   - Phonon density of states
   - Fully automated scripts</p>
</li>
<li>
<p><strong>Thermodynamic Properties</strong>
   - Free energy
   - Internal energy
   - Entropy
   - Heat capacity
   - Debye temperature</p>
</li>
<li>
<p><strong>Applications</strong>
   - Thermal expansion coefficient (quasi-harmonic approximation)
   - Thermal conductivity
   - Phase transition detection</p>
</li>
</ol>
<h3>Key Points</h3>
<ul>
<li>Phonons are quantized lattice vibrations</li>
<li>Harmonic approximation provides sufficient accuracy (in most cases)</li>
<li>Thermodynamic properties can be calculated from phonons</li>
<li>Good agreement with experiments (Si: Debye temperature, thermal expansion coefficient)</li>
</ul>
<h3>To the Next Chapter</h3>
<p>In Chapter 5, we will learn cutting-edge methods integrating DFT calculations with machine learning.</p>
<hr/>
<h2>Exercises</h2>
<h3>Problem 1 (Difficulty: Easy)</h3>
<p>Explain the differences between acoustic and optical modes, including their physical meanings.</p>
<details>
<summary>Sample Answer</summary>

**Acoustic modes**:

**Number**: 3 branches (1 LA + 2 TA)
**Characteristics**: Zero frequency at Œì point ($\mathbf{k}=0$), $\omega \to 0$ as $\mathbf{k} \to 0$
**Physical meaning**: Translational motion of entire crystal, corresponds to sound waves
- All atoms vibrate in the same direction and phase
- Becomes elastic waves (sound waves) in the long-wavelength limit

**Optical modes**:

**Number**: $3(N\_{\text{atom}} - 1)$ branches (for $N\_{\text{atom}}$ atoms per unit cell)
**Characteristics**: Finite frequency at Œì point ($\omega(\mathbf{k}=0) \neq 0$)
**Physical meaning**: Relative motion of atoms within unit cell, couples with light (infrared)
- Different atoms vibrate in opposite phases
- In ionic crystals, creates electric dipole moment ‚Üí infrared absorption

**Example (NaCl crystal)**:
- Acoustic mode: Na and Cl move in the same direction
- Optical mode: Na and Cl move in opposite directions ‚Üí dipole ‚Üí light absorption

</details>
<h3>Problem 2 (Difficulty: Medium)</h3>
<p>Explain the physical meaning of the Debye temperature $\theta_D$ and its relationship to heat capacity.</p>
<details>
<summary>Sample Answer</summary>

**Definition of Debye temperature $\theta\_D$**:

In the Debye model, all phonon modes are approximated by a single Debye frequency $\omega\_D$:

$$
\theta\_D = \frac{\hbar\omega\_D}{k\_B}
$$

**Physical meaning**:

1. **Boundary temperature for quantum effects**:
   - $T \ll \theta\_D$: Quantum effects dominate (low temperature)
   - $T \gg \theta\_D$: Classical behavior (high temperature)

2. **Indicator of phonon excitation**:
   - $\theta\_D$ corresponds to the maximum phonon frequency
   - $T &lt; \theta\_D$: High-energy phonons are not excited
   - $T &gt; \theta\_D$: All phonon modes are excited

**Relationship to heat capacity**:

**Low temperature ($T \ll \theta\_D$)**: Debye $T^3$ law

$$
C\_V \propto T^3
$$

Quantum effects of phonons are significant.

**High temperature ($T \gg \theta\_D$)**: Dulong-Petit law

$$
C\_V \to 3Nk\_B = 3R
$$

All degrees of freedom are excited, classical limit.

**Typical values**:
- Si: $\theta\_D \approx 645$ K
- Diamond: $\theta\_D \approx 2230$ K (hard lattice ‚Üí high frequency)
- Pb: $\theta\_D \approx 105$ K (soft lattice ‚Üí low frequency)

**Practical meaning**:
- High $\theta\_D$ ‚Üí Quantum effects important even at room temperature
- Low $\theta\_D$ ‚Üí Classical behavior at room temperature

</details>
<h3>Problem 3 (Difficulty: Hard)</h3>
<p>Explain why multiple volume calculations are necessary when computing thermal expansion coefficient using the quasi-harmonic approximation (QHA).</p>
<details>
<summary>Sample Answer</summary>

**Limitations of harmonic approximation**:

In the harmonic approximation, the volume dependence of free energy $F(V, T)$ is:

$$
F\_{\text{harm}}(V, T) = U\_0(V) + k\_B T \sum\_{\mathbf{q},j} \ln\left[2\sinh\left(\frac{\hbar\omega\_{\mathbf{q}j}(V)}{2k\_B T}\right)\right]
$$

where $\omega\_{\mathbf{q}j}(V)$ depends on volume $V$.

However, the harmonic approximation assumes **constant lattice constant**, leading to these problems:

1. **Cannot describe thermal expansion**: $(‚àÇV/‚àÇT)\_P = 0$
2. **Only constant volume heat capacity**: $C\_P = C\_V$ (actually $C\_P &gt; C\_V$)

**Introduction of Quasi-harmonic Approximation (QHA)**:

QHA applies **harmonic approximation independently at different volumes**:

**Procedure**:

1. Perform phonon calculations at multiple volumes $V\_1, V\_2, \ldots, V\_n$
2. Calculate free energy $F(V\_i, T)$ at each volume
3. Find equilibrium volume $V\_{\text{eq}}(T)$ that minimizes free energy at each temperature $T$:
   $$\left(\frac{\partial F}{\partial V}\right)_T = 0$$
4. Calculate thermal expansion coefficient:
   $$\alpha(T) = \frac{1}{V}\left(\frac{\partial V}{\partial T}\right)_P$$

**Why multiple volumes are needed**:

- To know the volume dependence $F(V, T)$
- Curvature of free energy $(\partial^2 F/\partial V^2)$ is required
- Minimum position $V\_{\text{eq}}(T)$ is temperature-dependent

**Assumptions of QHA**:

- Considers volume dependence of phonon frequencies
- However, anharmonic interactions between phonons are ignored
- Harmonic approximation applied independently at each volume

**Limitations of QHA**:

- Inaccurate at high temperatures (near melting point)
- Difficult to describe strong anharmonicity (e.g., negative thermal expansion materials)
- Full anharmonic calculations (TDEP, SSCHA, etc.) are necessary

**Computational cost**:

- Phonon calculations at 5-10 volumes ‚Üí 5-10 times the cost
- However, benefit of obtaining thermal expansion coefficient

</details>
<hr/>
<h2>Data License and Citation</h2>
<h3>Software Used</h3>
<ol>
<li>
<p><strong>Phonopy - Phonon calculation tool</strong> (BSD 3-Clause)
   - Phonon calculation software
   - URL: https://phonopy.github.io/phonopy/
   - Citation: Togo, A., &amp; Tanaka, I. (2015). *Scr. Mater.*, 108, 1-5.</p>
</li>
<li>
<p><strong>GPAW</strong> (GPL v3) + <strong>ASE</strong> (LGPL v2.1+)
   - DFT force calculation backend
   - Same licenses as Chapter 2</p>
</li>
</ol>
<h3>Calculation Parameters</h3>
<ul>
<li><strong>Displacement amplitude</strong>: 0.01 √Ö (standard for harmonic approximation)</li>
<li><strong>Supercell size</strong>: 2√ó2√ó2 or larger (convergence testing required)</li>
<li><strong>q-point mesh</strong>: 20√ó20√ó20 or larger (for DOS and enthalpy calculations)</li>
</ul>
<hr/>
<h2>Code Reproducibility Checklist</h2>
<h3>Environment Setup</h3>
<pre><code class="language-bash">conda create -n phonon python=3.11
conda activate phonon
conda install -c conda-forge phonopy gpaw ase matplotlib
pip install spglib  # Symmetry analysis (recommended)
</code></pre>
<h3>Calculation Time Estimates</h3>
<table>
<thead>
<tr>
<th>System</th>
<th>Supercell</th>
<th>Displacements</th>
<th>DFT time/displacement</th>
<th>Total time</th>
</tr>
</thead>
<tbody>
<tr>
<td>Si (2 atoms)</td>
<td>2√ó2√ó2</td>
<td>3-6</td>
<td>10 min</td>
<td>~1 hour</td>
</tr>
<tr>
<td>NaCl (2 atoms)</td>
<td>2√ó2√ó2</td>
<td>6-12</td>
<td>15 min</td>
<td>~3 hours</td>
</tr>
<tr>
<td>GaAs (2 atoms)</td>
<td>3√ó3√ó3</td>
<td>6-12</td>
<td>30 min</td>
<td>~6 hours</td>
</tr>
</tbody>
</table>
<h3>Troubleshooting</h3>
<p><strong>Problem</strong>: Imaginary phonons (negative frequency¬≤)
<strong>Solutions</strong>:</p>
<pre><code class="language-python"># 1. Insufficient structure optimization
# ‚Üí Set force threshold to 0.01 eV/√Ö or below
# 2. Supercell too small
# ‚Üí Increase from 2√ó2√ó2 to 3√ó3√ó3
# 3. Symmetry breaking
# ‚Üí Check symmetry with spglib
</code></pre>
<hr/>
<h2>Practical Pitfalls and Solutions</h2>
<h3>1. Insufficient Supercell Size</h3>
<pre><code class="language-python"># ‚ùå Insufficient: 1√ó1√ó1 (does not converge)
phonon = Phonopy(unitcell, [[1, 0, 0], [0, 1, 0], [0, 0, 1]])

# ‚úÖ Recommended: 2√ó2√ó2 or larger (convergence test required)
for dim in [(2,2,2), (3,3,3), (4,4,4)]:
    phonon = Phonopy(unitcell, np.diag(dim))
    # Check phonon frequency convergence
</code></pre>
<h3>2. Incomplete Structure Optimization</h3>
<pre><code class="language-python"># ‚ùå Insufficient: Coarse optimization ‚Üí imaginary phonons
opt.run(fmax=0.1)  # Forces too large

# ‚úÖ Recommended: High-precision optimization
opt.run(fmax=0.01)  # 0.01 eV/√Ö or below
</code></pre>
<h3>3. Insufficient q-point Mesh (DOS Calculation)</h3>
<pre><code class="language-python"># ‚ùå Coarse: 10√ó10√ó10 (misses features)
phonon.set_mesh([10, 10, 10])

# ‚úÖ Recommended: 20√ó20√ó20 or larger
phonon.set_mesh([20, 20, 20])
</code></pre>
<h3>4. Unit Conversion Errors</h3>
<pre><code class="language-python"># Phonopy internal units: THz
# Conversions:
# - cm‚Åª¬π = THz √ó 33.356
# - meV = THz √ó 4.136
# - K (temperature) = THz √ó 47.992
</code></pre>
<hr/>
<h2>Quality Assurance Checklist</h2>
<h3>Validity of Phonon Calculation</h3>
<ul>
<li>[ ] Acoustic modes at Œì point (k=0) are 0 Hz (error &lt; 0.1 THz)</li>
<li>[ ] 3 acoustic modes (translational degrees of freedom)</li>
<li>[ ] All frequencies are real (no imaginary modes)</li>
<li>[ ] Bands degenerate at high-symmetry points</li>
<li>[ ] DOS integrates to 3N (number of degrees of freedom)</li>
</ul>
<h3>Validity of Thermodynamic Properties</h3>
<ul>
<li>[ ] Heat capacity ‚Üí 3R in high-temperature limit (Dulong-Petit)</li>
<li>[ ] Debye temperature within ¬±20% of literature values</li>
<li>[ ] Thermal expansion coefficient is positive (normal materials)</li>
<li>[ ] Entropy increases monotonically with temperature</li>
</ul>
<hr/>
<h2>References</h2>
<ol>
<li>
<p>Dove, M. T. (1993). *Introduction to Lattice Dynamics*. Cambridge University Press.</p>
</li>
<li>
<p>Togo, A., &amp; Tanaka, I. (2015). "First principles phonon calculations in materials science." *Scripta Materialia*, 108, 1-5.
   DOI: <a href="https://doi.org/10.1016/j.scriptamat.2015.07.021">10.1016/j.scriptamat.2015.07.021</a></p>
</li>
<li>
<p>Phonopy Documentation: https://phonopy.github.io/phonopy/</p>
</li>
<li>
<p>Shulumba, N., et al. (2017). "Temperature-dependent elastic properties of Ti$_x$Zr$_{1-x}$N alloys." <em>Applied Physics Letters</em>, 111, 061901.</p>
</li>
</ol>
<hr/>
<h2>Author Information</h2>
<p><strong>Created by</strong>: MI Knowledge Hub Content Team
<strong>Created</strong>: 2025-10-17
<strong>Version</strong>: 1.0
<strong>Series</strong>: Computational Materials Science Basics v1.0</p>
<p><strong>License</strong>: Creative Commons BY-NC-SA 4.0</p>
<div class="navigation">
<a class="nav-button" href="chapter-3.html">‚Üê Previous Chapter</a>
<a class="nav-button" href="index.html">Back to Series Index</a>
<a class="nav-button" href="chapter-5.html">Next Chapter ‚Üí</a>
</div>
</main>
<section class="disclaimer">
<h3>Disclaimer</h3>
<ul>
<li>This content is provided for educational, research, and informational purposes only and does not constitute professional advice (legal, accounting, technical guarantees, etc.).</li>
<li>This content and accompanying code examples are provided "AS IS" without warranties of any kind, express or implied, including merchantability, fitness for a particular purpose, non-infringement, accuracy, completeness, operation, or safety.</li>
<li>The creators and Tohoku University assume no responsibility for the content, availability, or safety of external links, third-party data, tools, or libraries.</li>
<li>The creators and Tohoku University shall not be liable for any direct, indirect, incidental, special, consequential, or punitive damages arising from the use, execution, or interpretation of this content, to the maximum extent permitted by applicable law.</li>
<li>The content may be changed, updated, or discontinued without notice.</li>
<li>The copyright and license of this content are subject to the specified terms (e.g., CC BY 4.0). Such licenses typically include warranty disclaimers.</li>
</ul>
</section>
<footer>
<p><strong>Created by</strong>: AI Terakoya Content Team</p>
<p><strong>Version</strong>: 1.0 | <strong>Created</strong>: 2025-10-17</p>
<p><strong>License</strong>: Creative Commons BY 4.0</p>
<p>¬© 2025 AI Terakoya. All rights reserved.</p>
</footer>
</body>
</html>
