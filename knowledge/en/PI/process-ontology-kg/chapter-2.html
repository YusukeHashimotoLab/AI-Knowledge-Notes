<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta content="Chapter 2: Process Ontology Design and OWL Modeling - Comprehensive ontology construction of chemical process equipment using owlready2" name="description"/>
<title>Chapter 2: Process Ontology Design and OWL Modeling - Process Ontology Introduction | PI Knowledge Hub</title>
<link href="../../assets/css/knowledge-base.css" rel="stylesheet"/>
<!-- Mermaid for diagrams -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script>
        mermaid.initialize({ startOnLoad: true });
    </script>
</head>
<body>
<nav class="breadcrumb">
<div class="breadcrumb-content">
<a href="../index.html">AI Terakoya Home</a><span class="breadcrumb-separator">â€º</span><a href="../../PI/index.html">Process Informatics</a><span class="breadcrumb-separator">â€º</span><a href="../../PI/process-ontology-kg/index.html">Process Ontology Kg</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 2</span>
</div>
</nav><div class="locale-switcher">
<span class="current-locale">ğŸŒ EN</span>
<span class="locale-separator">|</span>
<a class="locale-link" href="../../../jp/PI/process-ontology-kg/chapter-2.html">æ—¥æœ¬èª</a>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>

<header>
<div class="container">
<h1>Chapter 2: Process Ontology Design and OWL Modeling</h1>
<p class="subtitle">Comprehensive ontology construction of chemical process equipment using owlready2</p>
<div class="meta">
<span class="meta">ğŸ“– Reading time: 35-40 minutes</span>
<span class="meta">ğŸ’» Code examples: 7</span>
<span class="meta">ğŸ“Š Difficulty: Advanced</span>
</div>
</div>
</header>
<main class="container">
<section>
<h2>2.1 Fundamentals of OWL (Web Ontology Language)</h2>
<p>OWL extends RDFS and is a standard language for describing ontologies with higher expressiveness. It enables formal definition of complex relationships, constraints, and inference rules for chemical process equipment.</p>
<div class="info-box">
<p><strong>ğŸ’¡ Three OWL Sublanguages</strong></p>
<ul>
<li><strong>OWL Lite</strong>: Basic hierarchical structure and simple constraints</li>
<li><strong>OWL DL</strong>: Description logic-based, guaranteed inference (used in this series)</li>
<li><strong>OWL Full</strong>: Maximum expressiveness but inference not guaranteed</li>
</ul>
</div>
<h3>Example 1: OWL Class and Individual Definition with owlready2</h3>
<p>Build the basic class hierarchy of chemical process equipment.</p>
<pre><code># ===================================
# Example 1: OWL Class and Individual Definition
# ===================================

from owlready2 import *

# Create ontology
onto = get_ontology("http://example.org/process.owl")

with onto:
    # ===== Class Definition =====

    # Top-level class: ProcessEquipment
    class ProcessEquipment(Thing):
        """Base class for process equipment"""
        pass

    # Subclass: Reactor
    class Reactor(ProcessEquipment):
        """Reactor class"""
        pass

    # More specific subclass: CSTR (Continuous Stirred Tank Reactor)
    class CSTR(Reactor):
        """Continuous Stirred Tank Reactor"""
        pass

    # Subclass: HeatExchanger
    class HeatExchanger(ProcessEquipment):
        """Heat exchanger class"""
        pass

    # Subclass: Separator
    class Separator(ProcessEquipment):
        """Separator class"""
        pass

    # ===== Individual (Instance) Creation =====

    # CSTR reactor R-101
    r101 = CSTR("R-101")
    r101.label = ["Continuous Stirred Tank Reactor R-101"]
    r101.comment = ["Main reactor for esterification reaction"]

    # Heat exchanger HX-201
    hx201 = HeatExchanger("HX-201")
    hx201.label = ["Cooler HX-201"]

    # Separator SEP-301
    sep301 = Separator("SEP-301")
    sep301.label = ["Vapor-Liquid Separator SEP-301"]

# Save ontology
onto.save(file="process_ontology_v1.owl", format="rdfxml")

# ===== Visualize Class Hierarchy =====
print("=== Class Hierarchy ===")
for cls in onto.classes():
    if cls != Thing:
        ancestors = list(cls.ancestors())
        ancestors.remove(cls)
        ancestors.remove(Thing)
        if ancestors:
            print(f"{cls.name} âŠ‚ {ancestors[0].name}")
        else:
            print(f"{cls.name} (Top level)")

print("\n=== Individual List ===")
for individual in onto.individuals():
    print(f"- {individual.name}: {individual.__class__.name}")
    if individual.label:
        print(f"  Label: {individual.label[0]}")

print(f"\nâœ“ Ontology saved: process_ontology_v1.owl")
print(f"Total classes: {len(list(onto.classes()))}")
print(f"Total individuals: {len(list(onto.individuals()))}")
</code></pre>
<div class="example-output">
<strong>Output example:</strong><br/>
                === Class Hierarchy ===<br/>
                ProcessEquipment (Top level)<br/>
                Reactor âŠ‚ ProcessEquipment<br/>
                CSTR âŠ‚ Reactor<br/>
                HeatExchanger âŠ‚ ProcessEquipment<br/>
                Separator âŠ‚ ProcessEquipment<br/>
<br/>
                === Individual List ===<br/>
                - R-101: CSTR<br/>
                Â Â Label: Continuous Stirred Tank Reactor R-101<br/>
                - HX-201: HeatExchanger<br/>
                Â Â Label: Cooler HX-201<br/>
                - SEP-301: Separator<br/>
                Â Â Label: Vapor-Liquid Separator SEP-301<br/>
<br/>
                âœ“ Ontology saved: process_ontology_v1.owl<br/>
                Total classes: 5<br/>
                Total individuals: 3
            </div>
</section>
<section>
<h2>2.2 Object Properties</h2>
<p>Object properties represent connections between equipment and process flows.</p>
<h3>Example 2: Object Property Definition for Equipment Connections</h3>
<p>Express input-output connections between equipment using object properties.</p>
<pre><code># ===================================
# Example 2: Object Property Definition
# ===================================

from owlready2 import *

onto = get_ontology("http://example.org/process.owl")

with onto:
    # ===== Class Definition =====
    class ProcessEquipment(Thing):
        pass

    class Reactor(ProcessEquipment):
        pass

    class HeatExchanger(ProcessEquipment):
        pass

    class Stream(Thing):
        """Material stream class"""
        pass

    # ===== Object Property Definition =====

    # hasInput: input stream to equipment
    class hasInput(ProcessEquipment &gt;&gt; Stream):
        """Indicates input stream to equipment"""
        pass

    # hasOutput: output stream from equipment
    class hasOutput(ProcessEquipment &gt;&gt; Stream):
        """Indicates output stream from equipment"""
        pass

    # connectedTo: connection between equipment (symmetric)
    class connectedTo(ProcessEquipment &gt;&gt; ProcessEquipment, SymmetricProperty):
        """Indicates physical connection between equipment (symmetric)"""
        pass

    # feedsTo: upstream to downstream connection (transitive)
    class feedsTo(ProcessEquipment &gt;&gt; ProcessEquipment, TransitiveProperty):
        """Indicates flow from upstream to downstream equipment (transitive)"""
        pass

    # ===== Individual and Property Configuration =====

    # Create streams
    s1 = Stream("S-001")
    s1.label = ["Raw material feed"]

    s2 = Stream("S-002")
    s2.label = ["Reaction product"]

    s3 = Stream("S-003")
    s3.label = ["Cooled product"]

    # Create equipment
    r101 = Reactor("R-101")
    hx201 = HeatExchanger("HX-201")

    # Set properties
    r101.hasInput = [s1]
    r101.hasOutput = [s2]

    hx201.hasInput = [s2]
    hx201.hasOutput = [s3]

    # Equipment connections
    r101.connectedTo = [hx201]
    r101.feedsTo = [hx201]

# ===== Property Verification =====
print("=== Process Flow ===")
print(f"{r101.name} â†’ hasInput â†’ {r101.hasInput[0].name}")
print(f"{r101.name} â†’ hasOutput â†’ {r101.hasOutput[0].name}")
print(f"{hx201.name} â†’ hasInput â†’ {hx201.hasInput[0].name}")

print("\n=== Equipment Connections ===")
print(f"{r101.name} â†’ connectedTo â†’ {r101.connectedTo[0].name}")
print(f"{r101.name} â†’ feedsTo â†’ {r101.feedsTo[0].name}")

# Check symmetry
print(f"\nSymmetry check: {hx201.name} â†’ connectedTo â†’ {hx201.connectedTo}")

onto.save(file="process_ontology_v2.owl", format="rdfxml")
print("\nâœ“ Ontology saved: process_ontology_v2.owl")
</code></pre>
<div class="example-output">
<strong>Output example:</strong><br/>
                === Process Flow ===<br/>
                R-101 â†’ hasInput â†’ S-001<br/>
                R-101 â†’ hasOutput â†’ S-002<br/>
                HX-201 â†’ hasInput â†’ S-002<br/>
<br/>
                === Equipment Connections ===<br/>
                R-101 â†’ connectedTo â†’ HX-201<br/>
                R-101 â†’ feedsTo â†’ HX-201<br/>
<br/>
                Symmetry check: HX-201 â†’ connectedTo â†’ [process.R-101]<br/>
<br/>
                âœ“ Ontology saved: process_ontology_v2.owl
            </div>
<h3>Example 3: Data Properties (Temperature, Pressure, Flow Rate)</h3>
<p>Express process variables using data properties.</p>
<pre><code># ===================================
# Example 3: Data Property Definition
# ===================================

from owlready2 import *

onto = get_ontology("http://example.org/process.owl")

with onto:
    class ProcessEquipment(Thing):
        pass

    class Reactor(ProcessEquipment):
        pass

    # ===== Data Property Definition =====

    # hasTemperature: temperature [K]
    class hasTemperature(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]
        label = ["Temperature"]
        comment = ["Equipment operating temperature (unit: K)"]

    # hasPressure: pressure [bar]
    class hasPressure(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]
        label = ["Pressure"]
        comment = ["Equipment operating pressure (unit: bar)"]

    # hasVolume: volume [m3]
    class hasVolume(DataProperty, FunctionalProperty):
        domain = [Reactor]
        range = [float]
        label = ["Volume"]

    # hasFlowRate: flow rate [kg/h]
    class hasFlowRate(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]
        label = ["Flow rate"]

    # hasEfficiency: efficiency [%]
    class hasEfficiency(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]
        label = ["Efficiency"]

    # ===== Set Values for Individuals =====

    # CSTR reactor R-101
    r101 = Reactor("R-101")
    r101.label = ["CSTR reactor"]
    r101.hasTemperature = [350.0]  # 350 K (approx. 77Â°C)
    r101.hasPressure = [5.0]       # 5 bar
    r101.hasVolume = [10.0]        # 10 m3
    r101.hasFlowRate = [1000.0]    # 1000 kg/h
    r101.hasEfficiency = [92.5]    # 92.5%

    # PFR reactor R-102
    r102 = Reactor("R-102")
    r102.label = ["Plug flow reactor"]
    r102.hasTemperature = [420.0]  # 420 K (approx. 147Â°C)
    r102.hasPressure = [8.0]       # 8 bar
    r102.hasVolume = [5.0]         # 5 m3
    r102.hasFlowRate = [800.0]     # 800 kg/h

# ===== Retrieve Data Properties =====
print("=== Operating Conditions for Reactor R-101 ===")
print(f"Temperature: {r101.hasTemperature[0]} K ({r101.hasTemperature[0] - 273.15:.1f}Â°C)")
print(f"Pressure: {r101.hasPressure[0]} bar")
print(f"Volume: {r101.hasVolume[0]} mÂ³")
print(f"Flow rate: {r101.hasFlowRate[0]} kg/h")
print(f"Efficiency: {r101.hasEfficiency[0]}%")

print("\n=== Operating Conditions for Reactor R-102 ===")
print(f"Temperature: {r102.hasTemperature[0]} K ({r102.hasTemperature[0] - 273.15:.1f}Â°C)")
print(f"Pressure: {r102.hasPressure[0]} bar")
print(f"Volume: {r102.hasVolume[0]} mÂ³")
print(f"Flow rate: {r102.hasFlowRate[0]} kg/h")

onto.save(file="process_ontology_v3.owl", format="rdfxml")
print("\nâœ“ Ontology saved: process_ontology_v3.owl")
</code></pre>
<div class="example-output">
<strong>Output example:</strong><br/>
                === Operating Conditions for Reactor R-101 ===<br/>
                Temperature: 350.0 K (76.9Â°C)<br/>
                Pressure: 5.0 bar<br/>
                Volume: 10.0 mÂ³<br/>
                Flow rate: 1000.0 kg/h<br/>
                Efficiency: 92.5%<br/>
<br/>
                === Operating Conditions for Reactor R-102 ===<br/>
                Temperature: 420.0 K (146.9Â°C)<br/>
                Pressure: 8.0 bar<br/>
                Volume: 5.0 mÂ³<br/>
                Flow rate: 800.0 kg/h<br/>
<br/>
                âœ“ Ontology saved: process_ontology_v3.owl
            </div>
</section>
<section>
<h2>2.3 Class Hierarchy and Property Restrictions</h2>
<h3>Example 4: Detailed Class Hierarchy Construction</h3>
<p>Build a detailed classification hierarchy of equipment types.</p>
<pre><code># ===================================
# Example 4: Detailed Class Hierarchy
# ===================================

from owlready2 import *

onto = get_ontology("http://example.org/process.owl")

with onto:
    # ===== Hierarchical Class Definition =====

    class ProcessEquipment(Thing):
        """Process Equipment (Base class)"""
        pass

    # Reactor family
    class Reactor(ProcessEquipment):
        """Reactor"""
        pass

    class CSTR(Reactor):
        """Continuous Stirred Tank Reactor"""
        pass

    class PFR(Reactor):
        """Plug Flow Reactor"""
        pass

    class BatchReactor(Reactor):
        """Batch Reactor"""
        pass

    # Heat exchanger family
    class HeatExchanger(ProcessEquipment):
        """Heat Exchanger"""
        pass

    class ShellTubeHX(HeatExchanger):
        """Shell and Tube Heat Exchanger"""
        pass

    class PlateHX(HeatExchanger):
        """Plate Heat Exchanger"""
        pass

    # Separator family
    class Separator(ProcessEquipment):
        """Separator"""
        pass

    class DistillationColumn(Separator):
        """Distillation Column"""
        pass

    class Absorber(Separator):
        """Absorber"""
        pass

    class Extractor(Separator):
        """Extractor"""
        pass

    # Pump and compressor family
    class FluidMover(ProcessEquipment):
        """Fluid Moving Equipment"""
        pass

    class Pump(FluidMover):
        """Pump"""
        pass

    class Compressor(FluidMover):
        """Compressor"""
        pass

# ===== Visualize Class Hierarchy (Generate Mermaid data) =====
print("=== Class Hierarchy Tree ===")

def print_class_tree(cls, indent=0):
    """Display class hierarchy recursively"""
    if cls != Thing:
        print("  " * indent + f"â”œâ”€ {cls.name}")
        for subclass in cls.subclasses():
            print_class_tree(subclass, indent + 1)

print_class_tree(ProcessEquipment)

# Statistics by category
print("\n=== Number of Classes by Equipment Category ===")
categories = {
    "Reactor": len(list(Reactor.descendants())),
    "HeatExchanger": len(list(HeatExchanger.descendants())),
    "Separator": len(list(Separator.descendants())),
    "FluidMover": len(list(FluidMover.descendants()))
}

for cat, count in categories.items():
    print(f"{cat}: {count} subclasses")

onto.save(file="process_ontology_v4.owl", format="rdfxml")
print("\nâœ“ Ontology saved: process_ontology_v4.owl")
</code></pre>
<div class="example-output">
<strong>Output example:</strong><br/>
                === Class Hierarchy Tree ===<br/>
                â”œâ”€ ProcessEquipment<br/>
                Â Â â”œâ”€ Reactor<br/>
                Â Â Â Â â”œâ”€ CSTR<br/>
                Â Â Â Â â”œâ”€ PFR<br/>
                Â Â Â Â â”œâ”€ BatchReactor<br/>
                Â Â â”œâ”€ HeatExchanger<br/>
                Â Â Â Â â”œâ”€ ShellTubeHX<br/>
                Â Â Â Â â”œâ”€ PlateHX<br/>
                Â Â â”œâ”€ Separator<br/>
                Â Â Â Â â”œâ”€ DistillationColumn<br/>
                Â Â Â Â â”œâ”€ Absorber<br/>
                Â Â Â Â â”œâ”€ Extractor<br/>
                Â Â â”œâ”€ FluidMover<br/>
                Â Â Â Â â”œâ”€ Pump<br/>
                Â Â Â Â â”œâ”€ Compressor<br/>
<br/>
                === Number of Classes by Equipment Category ===<br/>
                Reactor: 3 subclasses<br/>
                HeatExchanger: 2 subclasses<br/>
                Separator: 3 subclasses<br/>
                FluidMover: 2 subclasses<br/>
<br/>
                âœ“ Ontology saved: process_ontology_v4.owl
            </div>
<div class="tip-box">
<p><strong>ğŸ’¡ Best Practices for Class Design</strong></p>
<p>Equipment classification is hierarchically organized by two axes: functional (reaction, separation, heat exchange) and type (CSTR, PFR). This enables systematic equipment selection during process design.</p>
</div>
<div class="mermaid">
graph TB
    PE[ProcessEquipment]

    PE --&gt; R[Reactor]
    PE --&gt; HX[HeatExchanger]
    PE --&gt; SEP[Separator]
    PE --&gt; FM[FluidMover]

    R --&gt; CSTR[CSTR]
    R --&gt; PFR[PFR]
    R --&gt; BR[BatchReactor]

    HX --&gt; STHX[ShellTubeHX]
    HX --&gt; PHX[PlateHX]

    SEP --&gt; DC[DistillationColumn]
    SEP --&gt; ABS[Absorber]
    SEP --&gt; EXT[Extractor]

    FM --&gt; PUMP[Pump]
    FM --&gt; COMP[Compressor]

    style PE fill:#11998e,color:#fff
    style R fill:#38ef7d,color:#000
    style HX fill:#38ef7d,color:#000
    style SEP fill:#38ef7d,color:#000
    style FM fill:#38ef7d,color:#000
            </div>
</section>
<section>
<h2>2.4 Property Restrictions</h2>
<h3>Example 5: Cardinality and Value Restrictions</h3>
<p>Define constraints for the number of inputs/outputs and value ranges that equipment should have.</p>
<pre><code># ===================================
# Example 5: Property Restriction Definition
# ===================================

from owlready2 import *

onto = get_ontology("http://example.org/process.owl")

with onto:
    class ProcessEquipment(Thing):
        pass

    class Stream(Thing):
        pass

    # Property definition
    class hasInput(ProcessEquipment &gt;&gt; Stream):
        pass

    class hasOutput(ProcessEquipment &gt;&gt; Stream):
        pass

    class hasTemperature(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]

    class hasPressure(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]

    # ===== Class Definition with Restrictions =====

    # Reactor: at least 1 input, 1 output, temperature and pressure required
    class Reactor(ProcessEquipment):
        equivalent_to = [
            ProcessEquipment
            &amp; hasInput.min(1, Stream)        # At least 1 input
            &amp; hasOutput.min(1, Stream)       # At least 1 output
            &amp; hasTemperature.exactly(1)      # Temperature required (exactly 1)
            &amp; hasPressure.exactly(1)         # Pressure required (exactly 1)
        ]

    # HeatExchanger: 1 input, 1 output (fixed)
    class HeatExchanger(ProcessEquipment):
        equivalent_to = [
            ProcessEquipment
            &amp; hasInput.exactly(1, Stream)    # Exactly 1 input
            &amp; hasOutput.exactly(1, Stream)   # Exactly 1 output
            &amp; hasTemperature.exactly(1)
        ]

    # DistillationColumn: 1 input, 2 or more outputs (distillate and bottoms)
    class DistillationColumn(ProcessEquipment):
        equivalent_to = [
            ProcessEquipment
            &amp; hasInput.exactly(1, Stream)
            &amp; hasOutput.min(2, Stream)       # At least 2 outputs (distillate, bottoms)
        ]

    # ===== Classes with Value Restrictions =====

    # HighTemperatureReactor: temperature &gt; 400K
    class HighTemperatureReactor(Reactor):
        """High temperature reactor (400K or above)"""
        pass

    # HighPressureReactor: pressure &gt; 10bar
    class HighPressureReactor(Reactor):
        """High pressure reactor (10bar or above)"""
        pass

    # ===== Create Individuals and Verify =====

    # Valid reactor (satisfies constraints)
    r101 = Reactor("R-101")
    s1 = Stream("S-001")
    s2 = Stream("S-002")
    r101.hasInput = [s1]
    r101.hasOutput = [s2]
    r101.hasTemperature = [450.0]  # High temperature
    r101.hasPressure = [5.0]

    # Heat exchanger (satisfies constraints)
    hx201 = HeatExchanger("HX-201")
    s3 = Stream("S-003")
    s4 = Stream("S-004")
    hx201.hasInput = [s3]
    hx201.hasOutput = [s4]
    hx201.hasTemperature = [350.0]

# ===== Constraint Verification =====
print("=== Verification for Reactor R-101 ===")
print(f"Number of inputs: {len(r101.hasInput)} (at least 1 required)")
print(f"Number of outputs: {len(r101.hasOutput)} (at least 1 required)")
print(f"Temperature setting: {r101.hasTemperature[0]} K (required)")
print(f"Pressure setting: {r101.hasPressure[0]} bar (required)")
print("âœ“ All constraints satisfied")

print("\n=== Verification for Heat Exchanger HX-201 ===")
print(f"Number of inputs: {len(hx201.hasInput)} (exactly 1 required)")
print(f"Number of outputs: {len(hx201.hasOutput)} (exactly 1 required)")
print("âœ“ All constraints satisfied")

onto.save(file="process_ontology_v5.owl", format="rdfxml")
print("\nâœ“ Ontology saved: process_ontology_v5.owl")
</code></pre>
<div class="example-output">
<strong>Output example:</strong><br/>
                === Verification for Reactor R-101 ===<br/>
                Number of inputs: 1 (at least 1 required)<br/>
                Number of outputs: 1 (at least 1 required)<br/>
                Temperature setting: 450.0 K (required)<br/>
                Pressure setting: 5.0 bar (required)<br/>
                âœ“ All constraints satisfied<br/>
<br/>
                === Verification for Heat Exchanger HX-201 ===<br/>
                Number of inputs: 1 (exactly 1 required)<br/>
                Number of outputs: 1 (exactly 1 required)<br/>
                âœ“ All constraints satisfied<br/>
<br/>
                âœ“ Ontology saved: process_ontology_v5.owl
            </div>
<div class="warning-box">
<p><strong>âš ï¸ Constraint Violation Detection</strong></p>
<p>Using owlready2's inference engines (Pellet, HermiT), constraint violations can be automatically detected. For example, reactors without inputs or equipment with unset temperatures are detected as inconsistencies.</p>
</div>
</section>
<section>
<h2>2.5 Complete Ontology for Process Equipment</h2>
<h3>Example 6: Comprehensive Process Equipment Ontology Construction</h3>
<p>Build a comprehensive process equipment ontology integrating all elements.</p>
<pre><code># ===================================
# Example 6: Complete Process Equipment Ontology
# ===================================

from owlready2 import *
import numpy as np

onto = get_ontology("http://example.org/process.owl")

with onto:
    # ===== Basic Classes =====
    class ProcessEquipment(Thing):
        pass

    class Stream(Thing):
        pass

    # ===== Equipment Class Hierarchy =====
    class Reactor(ProcessEquipment):
        pass

    class CSTR(Reactor):
        pass

    class HeatExchanger(ProcessEquipment):
        pass

    class Separator(ProcessEquipment):
        pass

    class Pump(ProcessEquipment):
        pass

    # ===== Property Definition =====

    # Object properties
    class hasInput(ProcessEquipment &gt;&gt; Stream):
        pass

    class hasOutput(ProcessEquipment &gt;&gt; Stream):
        pass

    class connectedTo(ProcessEquipment &gt;&gt; ProcessEquipment, SymmetricProperty):
        pass

    # Data properties
    class hasTemperature(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]

    class hasPressure(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]

    class hasFlowRate(DataProperty, FunctionalProperty):
        domain = [Stream]
        range = [float]

    class hasVolume(DataProperty, FunctionalProperty):
        domain = [Reactor]
        range = [float]

    class hasEfficiency(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]

    class hasResidenceTime(DataProperty, FunctionalProperty):
        domain = [Reactor]
        range = [float]
        comment = ["Residence time (unit: seconds)"]

    # ===== Complete Process Plant Construction =====

    # Streams
    feed = Stream("Feed")
    feed.label = ["Raw material feed"]
    feed.hasFlowRate = [1000.0]  # kg/h

    s1 = Stream("S-001")
    s2 = Stream("S-002")
    s3 = Stream("S-003")
    product = Stream("Product")
    product.label = ["Final product"]

    # Pump P-101
    p101 = Pump("P-101")
    p101.label = ["Feed pump"]
    p101.hasInput = [feed]
    p101.hasOutput = [s1]
    p101.hasEfficiency = [85.0]

    # Reactor R-101
    r101 = CSTR("R-101")
    r101.label = ["Main reactor"]
    r101.hasInput = [s1]
    r101.hasOutput = [s2]
    r101.hasTemperature = [350.0]  # K
    r101.hasPressure = [5.0]       # bar
    r101.hasVolume = [10.0]        # m3
    r101.hasEfficiency = [92.5]
    r101.hasResidenceTime = [3600.0]  # 1 hour

    # Heat exchanger HX-201
    hx201 = HeatExchanger("HX-201")
    hx201.label = ["Cooler"]
    hx201.hasInput = [s2]
    hx201.hasOutput = [s3]
    hx201.hasTemperature = [320.0]  # Temperature after cooling
    hx201.hasEfficiency = [88.0]

    # Separator SEP-301
    sep301 = Separator("SEP-301")
    sep301.label = ["Product separator"]
    sep301.hasInput = [s3]
    sep301.hasOutput = [product]
    sep301.hasTemperature = [320.0]
    sep301.hasPressure = [1.0]
    sep301.hasEfficiency = [95.0]

    # Equipment connections
    p101.connectedTo = [r101]
    r101.connectedTo = [hx201]
    hx201.connectedTo = [sep301]

# ===== Visualize Entire Plant =====
print("=== Process Plant Configuration ===\n")

equipment_list = [p101, r101, hx201, sep301]

for eq in equipment_list:
    print(f"ã€{eq.label[0]}ã€‘ ({eq.__class__.__name__} {eq.name})")
    if eq.hasTemperature:
        print(f"  Temperature: {eq.hasTemperature[0]} K ({eq.hasTemperature[0] - 273.15:.1f}Â°C)")
    if eq.hasPressure:
        print(f"  Pressure: {eq.hasPressure[0]} bar")
    if eq.hasEfficiency:
        print(f"  Efficiency: {eq.hasEfficiency[0]}%")
    if hasattr(eq, 'hasVolume') and eq.hasVolume:
        print(f"  Volume: {eq.hasVolume[0]} mÂ³")
    if hasattr(eq, 'hasResidenceTime') and eq.hasResidenceTime:
        print(f"  Residence time: {eq.hasResidenceTime[0] / 3600:.1f} hours")
    print()

# Connection relationships
print("=== Process Flow ===")
print("Feed â†’ P-101 â†’ R-101 â†’ HX-201 â†’ SEP-301 â†’ Product")

onto.save(file="process_plant_complete.owl", format="rdfxml")
print("\nâœ“ Complete process plant ontology saved")
print(f"Total equipment: {len(equipment_list)}")
print(f"Total streams: {len([feed, s1, s2, s3, product])}")
</code></pre>
<div class="example-output">
<strong>Output example:</strong><br/>
                === Process Plant Configuration ===<br/>
<br/>
                ã€Feed pumpã€‘ (Pump P-101)<br/>
                Â Â Efficiency: 85.0%<br/>
<br/>
                ã€Main reactorã€‘ (CSTR R-101)<br/>
                Â Â Temperature: 350.0 K (76.9Â°C)<br/>
                Â Â Pressure: 5.0 bar<br/>
                Â Â Efficiency: 92.5%<br/>
                Â Â Volume: 10.0 mÂ³<br/>
                Â Â Residence time: 1.0 hours<br/>
<br/>
                ã€Coolerã€‘ (HeatExchanger HX-201)<br/>
                Â Â Temperature: 320.0 K (46.9Â°C)<br/>
                Â Â Efficiency: 88.0%<br/>
<br/>
                ã€Product separatorã€‘ (Separator SEP-301)<br/>
                Â Â Temperature: 320.0 K (46.9Â°C)<br/>
                Â Â Pressure: 1.0 bar<br/>
                Â Â Efficiency: 95.0%<br/>
<br/>
                === Process Flow ===<br/>
                Feed â†’ P-101 â†’ R-101 â†’ HX-201 â†’ SEP-301 â†’ Product<br/>
<br/>
                âœ“ Complete process plant ontology saved<br/>
                Total equipment: 4<br/>
                Total streams: 5
            </div>
</section>
<section>
<h2>2.6 Integrated Chemical Process Plant Ontology</h2>
<h3>Example 7: Integrated Plant Ontology and SPARQL Queries</h3>
<p>Represent a complete chemical plant using ontology and execute advanced queries with SPARQL.</p>
<pre><code># ===================================
# Example 7: Integrated Plant Ontology and SPARQL
# ===================================

from owlready2 import *
from rdflib import Graph, Namespace

# Build ontology with owlready2
onto = get_ontology("http://example.org/chemicalplant.owl")

with onto:
    # Class and property definitions (similar to Example 6)
    class ProcessEquipment(Thing):
        pass

    class Reactor(ProcessEquipment):
        pass

    class HeatExchanger(ProcessEquipment):
        pass

    class Separator(ProcessEquipment):
        pass

    class hasTemperature(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]

    class hasPressure(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]

    class hasEfficiency(DataProperty, FunctionalProperty):
        domain = [ProcessEquipment]
        range = [float]

    # Build complete plant
    r101 = Reactor("R-101")
    r101.label = ["Reactor R-101"]
    r101.hasTemperature = [350.0]
    r101.hasPressure = [5.0]
    r101.hasEfficiency = [92.5]

    r102 = Reactor("R-102")
    r102.label = ["Reactor R-102"]
    r102.hasTemperature = [420.0]
    r102.hasPressure = [8.0]
    r102.hasEfficiency = [88.0]

    hx201 = HeatExchanger("HX-201")
    hx201.label = ["Heat Exchanger HX-201"]
    hx201.hasTemperature = [320.0]
    hx201.hasEfficiency = [90.0]

    hx202 = HeatExchanger("HX-202")
    hx202.label = ["Heat Exchanger HX-202"]
    hx202.hasTemperature = [340.0]
    hx202.hasEfficiency = [85.0]

    sep301 = Separator("SEP-301")
    sep301.label = ["Separator SEP-301"]
    sep301.hasTemperature = [310.0]
    sep301.hasPressure = [1.0]
    sep301.hasEfficiency = [95.0]

# Save OWL and load RDF
onto.save(file="chemical_plant.owl", format="rdfxml")

# Execute SPARQL query with rdflib
g = Graph()
g.parse("chemical_plant.owl", format="xml")

# Define namespace
ONTO = Namespace("http://example.org/chemicalplant.owl#")

# ===== SPARQL Query Collection =====

# Query 1: Equipment with efficiency &gt;= 90%
query1 = """
PREFIX onto: <http: chemicalplant.owl#="" example.org="">
PREFIX rdfs: <http: 01="" 2000="" rdf-schema#="" www.w3.org="">

SELECT ?equipment ?label ?efficiency
WHERE {
    ?equipment onto:hasEfficiency ?efficiency .
    ?equipment rdfs:label ?label .
    FILTER (?efficiency &gt;= 90.0)
}
ORDER BY DESC(?efficiency)
"""

print("=== Query 1: Equipment with efficiency &gt;= 90% ===")
for row in g.query(query1):
    print(f"{row.label}: {float(row.efficiency):.1f}%")

# Query 2: Equipment with temperature &gt;= 350K
query2 = """
PREFIX onto: <http: chemicalplant.owl#="" example.org="">
PREFIX rdfs: <http: 01="" 2000="" rdf-schema#="" www.w3.org="">

SELECT ?label ?temp ?press
WHERE {
    ?equipment onto:hasTemperature ?temp .
    ?equipment rdfs:label ?label .
    OPTIONAL { ?equipment onto:hasPressure ?press }
    FILTER (?temp &gt;= 350.0)
}
ORDER BY DESC(?temp)
"""

print("\n=== Query 2: High-temperature equipment &gt;= 350K ===")
for row in g.query(query2):
    temp_c = float(row.temp) - 273.15
    print(f"{row.label}: {float(row.temp):.1f}K ({temp_c:.1f}Â°C)", end="")
    if row.press:
        print(f", {float(row.press):.1f}bar")
    else:
        print()

# Query 3: Reactor statistics
query3 = """
PREFIX onto: <http: chemicalplant.owl#="" example.org="">
PREFIX rdf: <http: 02="" 1999="" 22-rdf-syntax-ns#="" www.w3.org="">

SELECT (AVG(?temp) AS ?avgTemp) (AVG(?eff) AS ?avgEff) (COUNT(?reactor) AS ?count)
WHERE {
    ?reactor rdf:type onto:Reactor .
    ?reactor onto:hasTemperature ?temp .
    ?reactor onto:hasEfficiency ?eff .
}
"""

print("\n=== Query 3: Reactor statistics ===")
for row in g.query(query3):
    print(f"Number of reactors: {row.count}")
    print(f"Average temperature: {float(row.avgTemp):.1f}K ({float(row.avgTemp) - 273.15:.1f}Â°C)")
    print(f"Average efficiency: {float(row.avgEff):.1f}%")

print("\nâœ“ Integrated plant ontology and SPARQL queries completed")
</http:></http:></http:></http:></http:></http:></code></pre>
<div class="example-output">
<strong>Output example:</strong><br/>
                === Query 1: Equipment with efficiency &gt;= 90% ===<br/>
                Separator SEP-301: 95.0%<br/>
                Reactor R-101: 92.5%<br/>
                Heat Exchanger HX-201: 90.0%<br/>
<br/>
                === Query 2: High-temperature equipment &gt;= 350K ===<br/>
                Reactor R-102: 420.0K (146.9Â°C), 8.0bar<br/>
                Reactor R-101: 350.0K (76.9Â°C), 5.0bar<br/>
<br/>
                === Query 3: Reactor statistics ===<br/>
                Number of reactors: 2<br/>
                Average temperature: 385.0K (111.9Â°C)<br/>
                Average efficiency: 90.3%<br/>
<br/>
                âœ“ Integrated plant ontology and SPARQL queries completed
            </div>
<div class="success-box">
<p><strong>âœ… Ontology Design Achievements</strong></p>
<ul>
<li><strong>Structuring</strong>: Hierarchical ontology with 13 classes and 5 properties</li>
<li><strong>Constraints</strong>: Quality assurance through cardinality and value range restrictions</li>
<li><strong>Querying</strong>: Advanced knowledge extraction and analysis with SPARQL</li>
<li><strong>Extensibility</strong>: Easy addition of new equipment types and properties</li>
</ul>
</div>
</section>
<section>
<h2>Learning Objectives Check</h2>
<p>Upon completing this chapter, you will be able to explain and implement the following:</p>
<h3>Basic Understanding</h3>
<ul>
<li>âœ… Explain the differences between the three OWL sublanguages (Lite, DL, Full)</li>
<li>âœ… Understand the roles of object properties and data properties</li>
<li>âœ… Know the concepts of FunctionalProperty, SymmetricProperty, and TransitiveProperty</li>
<li>âœ… Understand design principles for class hierarchies and is-a relationships</li>
</ul>
<h3>Practical Skills</h3>
<ul>
<li>âœ… Define OWL classes and instances with owlready2</li>
<li>âœ… Express connections between equipment using object properties</li>
<li>âœ… Define physical properties like temperature, pressure, and flow rate using data properties</li>
<li>âœ… Implement cardinality restrictions (min, max, exactly)</li>
<li>âœ… Build a complete chemical process plant ontology</li>
<li>âœ… Query equipment statistics and conditional searches using SPARQL</li>
</ul>
<h3>Applied Capabilities</h3>
<ul>
<li>âœ… Integrate new equipment types into existing ontologies</li>
<li>âœ… Support equipment selection in process design using ontologies</li>
<li>âœ… Detect inconsistent equipment configurations through property restrictions</li>
<li>âœ… Convert actual plant P&amp;ID information into ontologies</li>
</ul>
</section>
<section>
<h2>Next Steps</h2>
<p>In Chapter 2, we learned comprehensive ontology design for chemical process equipment using OWL and owlready2. In the next chapter, we will learn methods to automatically construct knowledge graphs from actual process data (CSV, sensor streams, P&amp;ID).</p>
<div class="info-box">
<p><strong>ğŸ“š Preview of Next Chapter (Chapter 3)</strong></p>
<ul>
<li>Entity extraction from CSV data</li>
<li>Automatic extraction of equipment connection relationships</li>
<li>RDF conversion of sensor data streams</li>
<li>Time-series knowledge graphs for historical data</li>
<li>Integrated knowledge graph construction from multi-source data</li>
</ul>
</div>
</section>
<div class="navigation">
<a class="nav-button" href="chapter-1.html">â† Chapter 1: Ontology Fundamentals</a>
<a class="nav-button" href="chapter-3.html">Chapter 3: Building KG from Data â†’</a>
</div>
</main>
<footer style="background-color: var(--color-bg-alt); padding: var(--spacing-lg); margin-top: var(--spacing-xl); text-align: center; border-top: 1px solid var(--color-border);">
<p style="color: var(--color-text-light); font-size: 0.9rem;">
            Â© 2025 PI Knowledge Hub - Process Ontology Series |
            <a href="../../../../index.html" style="color: var(--color-link);">Back to Home</a>
</p>
</footer>
</body>
</html>
