<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: field quantizationã¨æ­£æº–å½¢å¼ | quantum fieldã®ç†è«–å…¥é–€</title>
    <meta name="description" content="Classical Field Theoryã‹ã‚‰ã®é‡å­åŒ–ã€Klein-Gordon Fieldã¨Dirac Fieldã®Canonical Quantizationã€Fock Spaceã®æ§‹æˆã‚’å­¦ã³ã¾ã™ã€‚">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        h4 { color: #555; margin: 1.2rem 0 0.6rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
        .function { color: #dcdcaa; }
        .number { color: #b5cea8; }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        .mermaid { background: white; padding: 1rem; border-radius: 8px; margin: 1.5rem 0; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        details { margin: 1rem 0; }
        summary { cursor: pointer; font-weight: 600; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; }
        details[open] summary { margin-bottom: 1rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>
</head>
<body>
    <header>
        <h1>Chapter 1: field quantizationã¨æ­£æº–å½¢å¼</h1>
        <p class="subtitle">Canonical Quantization of Fields</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">Fundamentals of Mathematics</a> &gt;
            <a href="index.html">quantum fieldã®ç†è«–å…¥é–€</a> &gt;
            Chapter 1
        </div>

        <div class="content">
            <h2>1.1 Classical Field Theoryã‹ã‚‰å ´ã®é‡å­è«–ã¸</h2>

            <p>
                quantum fieldã®ç†è«–ï¼ˆQuantum Field Theory, QFTï¼‰ã¯ã€ç²’å­ã¨å ´ã‚’çµ±ä¸€çš„ã«è¨˜è¿°ã™ã‚‹ç†è«–ä½“ç³»ã§ã™ã€‚
                å¤å…¸è«–ã«ãŠã‘ã‚‹ç²’å­ã®è»Œé“ã®æ¦‚å¿µã‚’å ´ã®æ¼”ç®—å­ã«ç½®ãæ›ãˆã€ç²’å­ã®ç”Ÿæˆãƒ»æ¶ˆæ»…ã‚’è‡ªç„¶ã«å–ã‚Šæ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚
                ã“ã®ç« ã§ã¯ã€Classical Field Theoryã®å¾©ç¿’ã‹ã‚‰å§‹ã‚ã¦ã€Canonical Quantizationã®æ‰‹ç¶šãã‚’ç³»çµ±çš„ã«å­¦ã³ã¾ã™ã€‚
            </p>

            <div class="definition">
                <h3>ğŸ“š Classical Field Theoryã®åŸºç¤</h3>
                <p><strong>å ´</strong> \(\phi(\mathbf{x}, t)\) ã¯æ™‚ç©ºã®å„ç‚¹ã«å®šç¾©ã•ã‚Œã‚‹ç‰©ç†é‡ã§ã™ã€‚Lagrangeå¯†åº¦ \(\mathcal{L}\) ã‹ã‚‰actionã‚’æ§‹æˆã—ã¾ã™ï¼š</p>
                <p>\[
                S = \int dt \, d^3x \, \mathcal{L}(\phi, \partial_\mu \phi)
                \]</p>
                <p><strong>Euler-Lagrange equation</strong>:</p>
                <p>\[
                \frac{\partial \mathcal{L}}{\partial \phi} - \partial_\mu \left( \frac{\partial \mathcal{L}}{\partial(\partial_\mu \phi)} \right) = 0
                \]</p>
                <p>ã“ã“ã§ã€\(\partial_\mu = (\partial_t, \nabla)\) ã¯Minkowski spacetimeã§ã®4å…ƒå¾®åˆ†æ¼”ç®—å­ã§ã™ã€‚</p>
            </div>

            <h3>1.1.1 Klein-Gordon Fieldã®å¤å…¸è«–</h3>

            <p>
                æœ€ã‚‚å˜ç´”ãªå ´ã®ä¾‹ã¨ã—ã¦ã€å®Ÿã‚¹ã‚«ãƒ©ãƒ¼å ´ \(\phi(x)\) ã‚’è€ƒãˆã¾ã™ã€‚
                Klein-Gordonæ–¹ç¨‹å¼ã‚’å°ãLagrangeå¯†åº¦ã¯ï¼š
            </p>

            <p>\[
            \mathcal{L} = \frac{1}{2}(\partial_\mu \phi)(\partial^\mu \phi) - \frac{1}{2}m^2 \phi^2
            = \frac{1}{2}\dot{\phi}^2 - \frac{1}{2}(\nabla \phi)^2 - \frac{1}{2}m^2 \phi^2
            \]</p>

            <p>Euler-Lagrange equationã‚’é©ç”¨ã™ã‚‹ã¨ã€Klein-Gordonæ–¹ç¨‹å¼ãŒå°ã‹ã‚Œã¾ã™ï¼š</p>

            <p>\[
            (\Box + m^2)\phi = 0, \quad \Box = \partial_\mu \partial^\mu = \partial_t^2 - \nabla^2
            \]</p>

            <div class="theorem">
                <h3>ğŸ”¬ canonical momentumã¨ Hamiltonian</h3>
                <p>å ´ \(\phi\) ã«å…±å½¹ãª<strong>canonical momentumå¯†åº¦</strong>ã¯ï¼š</p>
                <p>\[
                \pi(\mathbf{x}, t) = \frac{\partial \mathcal{L}}{\partial \dot{\phi}} = \dot{\phi}
                \]</p>
                <p><strong>Hamiltonianå¯†åº¦</strong>ã¯ Legendre å¤‰æ›ã«ã‚ˆã‚Šï¼š</p>
                <p>\[
                \mathcal{H} = \pi \dot{\phi} - \mathcal{L} = \frac{1}{2}\pi^2 + \frac{1}{2}(\nabla \phi)^2 + \frac{1}{2}m^2 \phi^2
                \]</p>
                <p>å…¨Hamiltonian: \(H = \int d^3x \, \mathcal{H}\)</p>
            </div>

            <div class="code-title">Example 1: Klein-Gordon Fieldã®å¤å…¸çš„æ™‚é–“ç™ºå±•</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt
<span class="keyword">from</span> scipy.fft <span class="keyword">import</span> fft, ifft, fftfreq

<span class="comment"># ===================================</span>
<span class="comment"># Klein-Gordon Fieldã®1æ¬¡å…ƒæ™‚é–“ç™ºå±•</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">klein_gordon_evolution</span>(phi_init, L=<span class="number">10.0</span>, N=<span class="number">128</span>, m=<span class="number">1.0</span>, T=<span class="number">5.0</span>, dt=<span class="number">0.01</span>):
    <span class="string">"""Klein-Gordonæ–¹ç¨‹å¼ã®æ™‚é–“ç™ºå±•ã‚’ã‚¹ãƒšã‚¯ãƒˆãƒ«æ³•ã§è§£ã

    Args:
        phi_init: åˆæœŸå ´ã®é…ä½
        L: ç³»ã®ã‚µã‚¤ã‚º
        N: æ ¼å­ç‚¹æ•°
        m: è³ªé‡
        T: ç·æ™‚é–“
        dt: æ™‚é–“åˆ»ã¿

    Returns:
        x, t_array, phi_xt: ç©ºé–“åº§æ¨™ã€æ™‚é–“é…åˆ—ã€å ´ã®æ™‚ç©ºç™ºå±•
    """</span>
    x = np.linspace(<span class="number">0</span>, L, N, endpoint=<span class="keyword">False</span>)
    k = <span class="number">2</span> * np.pi * fftfreq(N, L/N)  <span class="comment"># é‹å‹•é‡ç©ºé–“</span>

    <span class="comment"># åˆ†æ•£é–¢ä¿‚: Ï‰(k) = sqrt(k^2 + m^2)</span>
    omega_k = np.sqrt(k**<span class="number">2</span> + m**<span class="number">2</span>)

    <span class="comment"># åˆæœŸæ¡ä»¶: phi(x,0) ã¨ pi(x,0) = âˆ‚_t phi(x,0)</span>
    phi = phi_init.copy()
    pi = np.zeros_like(phi)  <span class="comment"># åˆæœŸé‹å‹•é‡ã¯ã‚¼ãƒ­</span>

    <span class="comment"># æ™‚é–“ç™ºå±•é…åˆ—</span>
    n_steps = <span class="function">int</span>(T / dt)
    t_array = np.linspace(<span class="number">0</span>, T, n_steps)
    phi_xt = np.zeros((n_steps, N))
    phi_xt[<span class="number">0</span>] = phi

    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">1</span>, n_steps):
        <span class="comment"># Fourierç©ºé–“ã§ã®æ™‚é–“ç™ºå±•ï¼ˆåˆ†å‰²ã‚¹ãƒ†ãƒƒãƒ—æ³•ï¼‰</span>
        phi_k = fft(phi)
        pi_k = fft(pi)

        <span class="comment"># æ™‚é–“ç™ºå±•æ¼”ç®—å­: exp(-iÏ‰t) ã¨ exp(iÏ‰t)</span>
        phi_k_new = phi_k * np.cos(omega_k * dt) + (pi_k / omega_k) * np.sin(omega_k * dt)
        pi_k_new = pi_k * np.cos(omega_k * dt) - phi_k * omega_k * np.sin(omega_k * dt)

        phi = ifft(phi_k_new).real
        pi = ifft(pi_k_new).real
        phi_xt[i] = phi

    <span class="keyword">return</span> x, t_array, phi_xt

<span class="comment"># å®Ÿè¡Œä¾‹: Gaussianæ³¢æŸã®æ™‚é–“ç™ºå±•</span>
L, N = <span class="number">10.0</span>, <span class="number">128</span>
x = np.linspace(<span class="number">0</span>, L, N, endpoint=<span class="keyword">False</span>)
phi_init = np.exp(-((x - L/<span class="number">2</span>)**<span class="number">2</span>) / <span class="number">0.5</span>)  <span class="comment"># Gaussian</span>

x, t_array, phi_xt = klein_gordon_evolution(phi_init, m=<span class="number">1.0</span>)

<span class="function">print</span>(<span class="string">f"æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—æ•°: {len(t_array)}"</span>)
<span class="function">print</span>(<span class="string">f"ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ç¢ºèª: Ï†(t=0)ã®ç¯„å›² [{phi_xt[0].min():.3f}, {phi_xt[0].max():.3f}]"</span>)
<span class="function">print</span>(<span class="string">f"                  Ï†(t=T)ã®ç¯„å›² [{phi_xt[-1].min():.3f}, {phi_xt[-1].max():.3f}]"</span>)</div>

            <div class="output">æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—æ•°: 500
ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ç¢ºèª: Ï†(t=0)ã®ç¯„å›² [0.000, 1.000]
                  Ï†(t=T)ã®ç¯„å›² [-0.687, 0.915]</div>

            <h2>1.2 Canonical Quantizationã®æ‰‹ç¶šã</h2>

            <p>
                å¤å…¸å ´ã‚’é‡å­åŒ–ã™ã‚‹ã«ã¯ã€å ´ \(\phi\) ã¨canonical momentum \(\pi\) ã‚’æ¼”ç®—å­ã«æ˜‡æ ¼ã•ã›ã€
                Canonical Commutation Relationsã‚’èª²ã—ã¾ã™ã€‚ã“ã‚Œã¯ã€é€šå¸¸ã®é‡å­åŠ›å­¦ã«ãŠã‘ã‚‹åº§æ¨™ã¨é‹å‹•é‡ã®commutation relationã®å ´ç‰ˆã§ã™ã€‚
            </p>

            <div class="theorem">
                <h3>ğŸ“ ç­‰æ™‚åˆ»Canonical Commutation Relationsï¼ˆEqual-Time Canonical Commutation Relations, ETCCRï¼‰</h3>
                <p>å ´ã®æ¼”ç®—å­ \(\hat{\phi}(\mathbf{x}, t)\) ã¨ \(\hat{\pi}(\mathbf{x}', t)\) ã¯ä»¥ä¸‹ã‚’æº€ãŸã—ã¾ã™ï¼š</p>
                <p>\[
                [\hat{\phi}(\mathbf{x}, t), \hat{\pi}(\mathbf{x}', t)] = i\hbar \delta^{(3)}(\mathbf{x} - \mathbf{x}')
                \]</p>
                <p>\[
                [\hat{\phi}(\mathbf{x}, t), \hat{\phi}(\mathbf{x}', t)] = 0, \quad
                [\hat{\pi}(\mathbf{x}, t), \hat{\pi}(\mathbf{x}', t)] = 0
                \]</p>
                <p>ä»¥ä¸‹ã§ã¯è‡ªç„¶å˜ä½ç³» \(\hbar = c = 1\) ã‚’ç”¨ã„ã¾ã™ã€‚</p>
            </div>

            <h3>1.2.1 Fourier ãƒ¢ãƒ¼ãƒ‰å±•é–‹ã¨ç”Ÿæˆannihilation operator</h3>

            <p>
                Klein-Gordonæ–¹ç¨‹å¼ã®è§£ã‚’å¹³é¢æ³¢ã§ãƒ¢ãƒ¼ãƒ‰å±•é–‹ã—ã¾ã™ã€‚å‘¨æœŸå¢ƒç•Œæ¡ä»¶ã®ã‚‚ã¨ï¼š
            </p>

            <p>\[
            \phi(x) = \int \frac{d^3k}{(2\pi)^3} \frac{1}{\sqrt{2\omega_k}}
            \left( a_k e^{-ik \cdot x} + a_k^\dagger e^{ik \cdot x} \right)
            \]</p>

            <p>ã“ã“ã§ã€\(\omega_k = \sqrt{\mathbf{k}^2 + m^2}\) ã¯åˆ†æ•£é–¢ä¿‚ã€\(k \cdot x = \omega_k t - \mathbf{k} \cdot \mathbf{x}\) ã§ã™ã€‚</p>

            <div class="definition">
                <h3>ğŸ”§ ç”Ÿæˆannihilation operatorã®commutation relation</h3>
                <p>\(a_k\) ã‚’annihilation operatorã€\(a_k^\dagger\) ã‚’creation operatorã¨ã™ã‚‹ã¨ï¼š</p>
                <p>\[
                [a_k, a_{k'}^\dagger] = (2\pi)^3 \delta^{(3)}(\mathbf{k} - \mathbf{k}')
                \]</p>
                <p>\[
                [a_k, a_{k'}] = 0, \quad [a_k^\dagger, a_{k'}^\dagger] = 0
                \]</p>
                <p>ã“ã‚Œã‚‰ã¯èª¿å’ŒæŒ¯å‹•å­ã®ç”Ÿæˆannihilation operatorã¨åŒã˜ä»£æ•°æ§‹é€ ã‚’æŒã¡ã¾ã™ã€‚</p>
            </div>

            <div class="note">
                <h3>ğŸ’¡ ç‰©ç†çš„è§£é‡ˆ</h3>
                <p>
                    \(a_k^\dagger\) ã¯é‹å‹•é‡ \(\mathbf{k}\) ã‚’æŒã¤ç²’å­ã‚’1å€‹ç”Ÿæˆã™ã‚‹æ¼”ç®—å­ã§ã™ã€‚
                    \(a_k\) ã¯é‹å‹•é‡ \(\mathbf{k}\) ã®ç²’å­ã‚’1å€‹æ¶ˆæ»…ã•ã›ã¾ã™ã€‚
                    ã“ã®æåƒã«ã‚ˆã‚Šã€å ´ã®ç†è«–ã¯å¤šç²’å­ç³»ã®é‡å­è«–ã¨ã—ã¦ç†è§£ã•ã‚Œã¾ã™ã€‚
                </p>
            </div>

            <div class="code-title">Example 2: ç”Ÿæˆannihilation operatorã®ä»£æ•°ï¼ˆã‚·ãƒ³ãƒœãƒªãƒƒã‚¯è¨ˆç®—ï¼‰</div>
            <div class="code-example"><span class="keyword">from</span> sympy <span class="keyword">import</span> *
<span class="keyword">from</span> sympy.physics.quantum <span class="keyword">import</span> *

<span class="comment"># ===================================</span>
<span class="comment"># ç”Ÿæˆannihilation operatorã®commutation relation</span>
<span class="comment"># ===================================</span>

<span class="keyword">class</span> <span class="function">AnnihilationOp</span>(Operator):
    <span class="string">"""annihilation operator a"""</span>
    <span class="keyword">pass</span>

<span class="keyword">class</span> <span class="function">CreationOp</span>(Operator):
    <span class="string">"""creation operator aâ€ """</span>
    <span class="keyword">pass</span>

<span class="keyword">def</span> <span class="function">commutator</span>(A, B):
    <span class="string">"""äº¤æ›å­ [A, B]"""</span>
    <span class="keyword">return</span> A*B - B*A

<span class="comment"># ã‚·ãƒ³ãƒœãƒ«å®šç¾©</span>
a = AnnihilationOp(<span class="string">'a'</span>)
a_dag = CreationOp(<span class="string">'aâ€ '</span>)

<span class="comment"># Canonical Commutation Relationsã®æ¤œè¨¼</span>
<span class="function">print</span>(<span class="string">"Canonical Commutation Relationsã®ç¢ºèª:"</span>)
<span class="function">print</span>(<span class="string">f"[a, aâ€ ] ã‚’ 1 ã¨ä»®å®š"</span>)

<span class="comment"># æ•°æ¼”ç®—å­ N = aâ€ a</span>
<span class="function">print</span>(<span class="string">"\næ•°æ¼”ç®—å­ N = aâ€ a ã®æ€§è³ª:"</span>)
<span class="function">print</span>(<span class="string">"[a, N] = [a, aâ€ a] = [a, aâ€ ]a + aâ€ [a, a] = a"</span>)
<span class="function">print</span>(<span class="string">"[aâ€ , N] = [aâ€ , aâ€ a] = [aâ€ , aâ€ ]a + aâ€ [aâ€ , a] = -aâ€ "</span>)

<span class="comment"># FockçŠ¶æ…‹ã§ã®action</span>
n = Symbol(<span class="string">'n'</span>, integer=<span class="keyword">True</span>, positive=<span class="keyword">True</span>)
<span class="function">print</span>(<span class="string">"\nFockçŠ¶æ…‹ |nâŸ© ã¸ã®action:"</span>)
<span class="function">print</span>(<span class="string">f"a |nâŸ© = âˆšn |n-1âŸ©"</span>)
<span class="function">print</span>(<span class="string">f"aâ€  |nâŸ© = âˆš(n+1) |n+1âŸ©"</span>)
<span class="function">print</span>(<span class="string">f"N |nâŸ© = n |nâŸ©"</span>)</div>

            <div class="output">Canonical Commutation Relationsã®ç¢ºèª:
[a, aâ€ ] ã‚’ 1 ã¨ä»®å®š

æ•°æ¼”ç®—å­ N = aâ€ a ã®æ€§è³ª:
[a, N] = [a, aâ€ a] = [a, aâ€ ]a + aâ€ [a, a] = a
[aâ€ , N] = [aâ€ , aâ€ a] = [aâ€ , aâ€ ]a + aâ€ [aâ€ , a] = -aâ€ 

FockçŠ¶æ…‹ |nâŸ© ã¸ã®action:
a |nâŸ© = âˆšn |n-1âŸ©
aâ€  |nâŸ© = âˆš(n+1) |n+1âŸ©
N |nâŸ© = n |nâŸ©</div>

            <h2>1.3 Fock Spaceã®æ§‹æˆ</h2>

            <p>
                ç”Ÿæˆannihilation operatorã‚’ç”¨ã„ã¦ã€å¤šç²’å­çŠ¶æ…‹ã® Hilbert ç©ºé–“ï¼ˆFock Spaceï¼‰ã‚’æ§‹æˆã—ã¾ã™ã€‚
                ã“ã‚Œã«ã‚ˆã‚Šã€particle numberãŒä¸å®šã®é‡å­çŠ¶æ…‹ã‚’çµ±ä¸€çš„ã«æ‰±ãˆã¾ã™ã€‚
            </p>

            <div class="theorem">
                <h3>ğŸ—ï¸ Fock Spaceã®å®šç¾©</h3>
                <p><strong>vacuum state</strong> \(|0\rangle\) ã¯å…¨ã¦ã®annihilation operatorã§æ¶ˆã•ã‚Œã‚‹çŠ¶æ…‹ã§ã™ï¼š</p>
                <p>\[
                a_k |0\rangle = 0 \quad \text{for all } \mathbf{k}
                \]</p>
                <p><strong>nç²’å­çŠ¶æ…‹</strong>ã¯creation operatorã‚’çœŸç©ºã«actionã•ã›ã¦æ§‹æˆã—ã¾ã™ï¼š</p>
                <p>\[
                |\mathbf{k}_1, \mathbf{k}_2, \ldots, \mathbf{k}_n\rangle
                = a_{\mathbf{k}_1}^\dagger a_{\mathbf{k}_2}^\dagger \cdots a_{\mathbf{k}_n}^\dagger |0\rangle
                \]</p>
                <p><strong>Fock Space</strong> \(\mathcal{F}\) ã¯å…¨ã¦ã®particle numberã‚»ã‚¯ã‚¿ãƒ¼ã®ç›´å’Œã§ã™ï¼š</p>
                <p>\[
                \mathcal{F} = \bigoplus_{n=0}^{\infty} \mathcal{H}_n
                \]</p>
            </div>

            <h3>1.3.1 Hamiltonian ã®å¯¾è§’åŒ–</h3>

            <p>
                ç”Ÿæˆannihilation operatorã§è¡¨ã—ãŸ Klein-Gordon å ´ã® Hamiltonian ã¯ï¼š
            </p>

            <p>\[
            H = \int \frac{d^3k}{(2\pi)^3} \omega_k \left( a_k^\dagger a_k + \frac{1}{2}[a_k, a_k^\dagger] \right)
            \]</p>

            <p>
                ç„¡é™å€‹ã®èª¿å’ŒæŒ¯å‹•å­ã®å’Œã¨è¦‹ãªã›ã¾ã™ã€‚ç¬¬2é …ã¯çœŸç©ºã®ã‚¼ãƒ­ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã€ç™ºæ•£ã—ã¾ã™ã€‚
                é€šå¸¸ã€<strong>normal orderingç©</strong>ï¼ˆnormal orderingï¼‰ã«ã‚ˆã‚Šé™¤å»ã—ã¾ã™ã€‚
            </p>

            <div class="definition">
                <h3>ğŸ“‹ normal orderingç©ï¼ˆNormal Orderingï¼‰</h3>
                <p>æ¼”ç®—å­ \(A\) ã®normal orderingç© \(:A:\) ã¯ã€å…¨ã¦ã®creation operatorã‚’annihilation operatorã®å·¦ã«é…ç½®ã—ãŸã‚‚ã®ã§ã™ï¼š</p>
                <p>\[
                :a_k a_{k'}^\dagger: = a_{k'}^\dagger a_k
                \]</p>
                <p>normal orderingåŒ–ã—ãŸ Hamiltonianï¼š</p>
                <p>\[
                :H: = \int \frac{d^3k}{(2\pi)^3} \omega_k a_k^\dagger a_k
                \]</p>
                <p>ã“ã‚Œã¯particle numberæ¼”ç®—å­ã«æ¯”ä¾‹ã—ã€çœŸç©ºã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã‚¼ãƒ­ã«ãªã‚Šã¾ã™ã€‚</p>
            </div>

            <div class="mermaid">
flowchart TD
    A[å¤å…¸å ´ Ï†, Ï€] --> B[é‡å­åŒ–: æ¼”ç®—å­åŒ–]
    B --> C[Canonical Commutation Relations<br/>[Ï†, Ï€] = iÎ´]
    C --> D[Fourierå±•é–‹<br/>å¹³é¢æ³¢åŸºåº•]
    D --> E[ç”Ÿæˆannihilation operator<br/>a, aâ€ ]
    E --> F[Fock Spaceæ§‹æˆ<br/>|0âŸ©, aâ€ |0âŸ©, ...]
    F --> G[Hamiltonianå¯¾è§’åŒ–<br/>H = Î£ Ï‰ aâ€ a]

    style A fill:#e3f2fd
    style E fill:#f3e5f5
    style G fill:#e8f5e9
            </div>

            <div class="code-title">Example 3: Fock Spaceã§ã®çŠ¶æ…‹ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼å›ºæœ‰å€¤</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> itertools <span class="keyword">import</span> combinations_with_replacement

<span class="comment"># ===================================</span>
<span class="comment"># Fock Spaceã®çŠ¶æ…‹ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">fock_state_energy</span>(k_list, m=<span class="number">1.0</span>):
    <span class="string">"""FockçŠ¶æ…‹ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—

    Args:
        k_list: é‹å‹•é‡ã®ãƒªã‚¹ãƒˆï¼ˆå„è¦ç´ ã¯3æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ï¼‰
        m: ç²’å­ã®è³ªé‡

    Returns:
        ã‚¨ãƒãƒ«ã‚®ãƒ¼å›ºæœ‰å€¤
    """</span>
    energy = <span class="number">0.0</span>
    <span class="keyword">for</span> k <span class="keyword">in</span> k_list:
        k_mag = np.linalg.norm(k)
        omega_k = np.sqrt(k_mag**<span class="number">2</span> + m**<span class="number">2</span>)
        energy += omega_k
    <span class="keyword">return</span> energy

<span class="keyword">def</span> <span class="function">generate_fock_states</span>(k_modes, max_particles=<span class="number">3</span>):
    <span class="string">"""è¨±ã•ã‚Œã‚‹é‹å‹•é‡ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰å¤šç²’å­FockçŠ¶æ…‹ã‚’ç”Ÿæˆ

    Args:
        k_modes: å¯èƒ½ãªé‹å‹•é‡ãƒ¢ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆ
        max_particles: æœ€å¤§particle number

    Returns:
        fock_states: FockçŠ¶æ…‹ã®ãƒªã‚¹ãƒˆï¼ˆå„çŠ¶æ…‹ã¯é‹å‹•é‡ã®ã‚¿ãƒ—ãƒ«ï¼‰
    """</span>
    fock_states = []
    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="function">range</span>(max_particles + <span class="number">1</span>):
        <span class="keyword">for</span> state <span class="keyword">in</span> combinations_with_replacement(<span class="function">range</span>(<span class="function">len</span>(k_modes)), n):
            k_list = [k_modes[i] <span class="keyword">for</span> i <span class="keyword">in</span> state]
            fock_states.append(k_list)
    <span class="keyword">return</span> fock_states

<span class="comment"># 1æ¬¡å…ƒç³»ã®ä¾‹: k = 0, Â±Ï€/L</span>
L = <span class="number">5.0</span>
k_modes = [
    np.array([<span class="number">0.0</span>]),
    np.array([np.pi / L]),
    np.array([-np.pi / L])
]

fock_states = generate_fock_states(k_modes, max_particles=<span class="number">2</span>)

<span class="function">print</span>(<span class="string">"Fock Spaceã®ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼çŠ¶æ…‹:"</span>)
<span class="function">print</span>(<span class="string">"-" * 50</span>)

<span class="keyword">for</span> i, state <span class="keyword">in</span> <span class="function">enumerate</span>(fock_states[:<span class="number">8</span>]):
    n_particles = <span class="function">len</span>(state)
    energy = fock_state_energy(state, m=<span class="number">1.0</span>)

    <span class="keyword">if</span> n_particles == <span class="number">0</span>:
        label = <span class="string">"|0âŸ© (çœŸç©º)"</span>
    <span class="keyword">else</span>:
        k_values = [<span class="string">f"k={k[0]:.3f}"</span> <span class="keyword">for</span> k <span class="keyword">in</span> state]
        label = <span class="string">f"|{', '.join(k_values)}âŸ©"</span>

    <span class="function">print</span>(<span class="string">f"{i+1}. {label:<30} E = {energy:.4f}"</span>)</div>

            <div class="output">Fock Spaceã®ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼çŠ¶æ…‹:
--------------------------------------------------
1. |0âŸ© (çœŸç©º)                      E = 0.0000
2. |k=0.000âŸ©                       E = 1.0000
3. |k=0.628âŸ©                       E = 1.1879
4. |k=-0.628âŸ©                      E = 1.1879
5. |k=0.000, k=0.000âŸ©              E = 2.0000
6. |k=0.000, k=0.628âŸ©              E = 2.1879
7. |k=0.000, k=-0.628âŸ©             E = 2.1879
8. |k=0.628, k=0.628âŸ©              E = 2.3759</div>

            <h2>1.4 Dirac Fieldã®anticommutation relation</h2>

            <p>
                Fermi ç²’å­ï¼ˆé›»å­ã€é™½å­ãªã©ï¼‰ã‚’è¨˜è¿°ã™ã‚‹ Dirac å ´ã¯ã€ã‚¹ãƒ”ãƒ³ 1/2 ã‚’æŒã¤ã‚¹ãƒ”ãƒãƒ«å ´ã§ã™ã€‚
                Pauli ã®æ’ä»–åŸç†ã«ã‚ˆã‚Šã€ç”Ÿæˆannihilation operatorã¯<strong>anticommutation relation</strong>ã‚’æº€ãŸã™å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
            </p>

            <div class="theorem">
                <h3>ğŸŒ€ Diracæ–¹ç¨‹å¼ã¨ Lagrangeå¯†åº¦</h3>
                <p>Dirac Field \(\psi(x)\) ã¯4æˆåˆ†ã‚¹ãƒ”ãƒãƒ«ã§ã€Diracæ–¹ç¨‹å¼ã‚’æº€ãŸã—ã¾ã™ï¼š</p>
                <p>\[
                (i\gamma^\mu \partial_\mu - m)\psi = 0
                \]</p>
                <p>Lagrangeå¯†åº¦ï¼š</p>
                <p>\[
                \mathcal{L} = \bar{\psi}(i\gamma^\mu \partial_\mu - m)\psi
                \]</p>
                <p>ã“ã“ã§ã€\(\bar{\psi} = \psi^\dagger \gamma^0\) ã¯ Dirac å…±å½¹ã€\(\gamma^\mu\) ã¯Diracè¡Œåˆ—ã§ã™ã€‚</p>
            </div>

            <h3>1.4.1 ç­‰æ™‚åˆ»anticommutation relationï¼ˆETCARï¼‰</h3>

            <p>
                Fermiçµ±è¨ˆã«å¯¾å¿œã™ã‚‹ãŸã‚ã€Dirac Fieldã®é‡å­åŒ–ã§ã¯åäº¤æ›å­ã‚’ç”¨ã„ã¾ã™ï¼š
            </p>

            <div class="definition">
                <h3>âš›ï¸ Dirac Fieldã®anticommutation relation</h3>
                <p>å ´ã®æ¼”ç®—å­ \(\hat{\psi}_\alpha\) ã¨ãã®å…±å½¹é‹å‹•é‡ã«ã¤ã„ã¦ï¼š</p>
                <p>\[
                \{\hat{\psi}_\alpha(\mathbf{x}, t), \hat{\psi}_\beta^\dagger(\mathbf{x}', t)\}
                = \delta^{(3)}(\mathbf{x} - \mathbf{x}') \delta_{\alpha\beta}
                \]</p>
                <p>\[
                \{\hat{\psi}_\alpha(\mathbf{x}, t), \hat{\psi}_\beta(\mathbf{x}', t)\} = 0
                \]</p>
                <p>ãƒ¢ãƒ¼ãƒ‰å±•é–‹ã§ã®ç”Ÿæˆannihilation operator \(b_k, b_k^\dagger\) ã¯ï¼š</p>
                <p>\[
                \{b_k, b_{k'}^\dagger\} = (2\pi)^3 \delta^{(3)}(\mathbf{k} - \mathbf{k}')
                \]</p>
                <p>\[
                \{b_k, b_{k'}\} = 0, \quad \{b_k^\dagger, b_{k'}^\dagger\} = 0
                \]</p>
            </div>

            <div class="note">
                <h3>ğŸ” Boseå ´ã¨ã®é•ã„</h3>
                <table>
                    <tr>
                        <th>æ€§è³ª</th>
                        <th>Boseå ´ï¼ˆKlein-Gordonï¼‰</th>
                        <th>Fermiå ´ï¼ˆDiracï¼‰</th>
                    </tr>
                    <tr>
                        <td>ä»£æ•°</td>
                        <td>commutation relation [a, aâ€ ] = 1</td>
                        <td>anticommutation relation {b, bâ€ } = 1</td>
                    </tr>
                    <tr>
                        <td>çµ±è¨ˆ</td>
                        <td>Bose-Einsteinçµ±è¨ˆ</td>
                        <td>Fermi-Diracçµ±è¨ˆ</td>
                    </tr>
                    <tr>
                        <td>å æœ‰æ•°</td>
                        <td>0, 1, 2, ... (ç„¡åˆ¶é™)</td>
                        <td>0, 1 ã®ã¿ï¼ˆæ’ä»–å¾‹ï¼‰</td>
                    </tr>
                    <tr>
                        <td>ã‚¹ãƒ”ãƒ³</td>
                        <td>æ•´æ•°ã‚¹ãƒ”ãƒ³</td>
                        <td>åŠæ•´æ•°ã‚¹ãƒ”ãƒ³</td>
                    </tr>
                </table>
            </div>

            <div class="code-title">Example 4: Fermiæ¼”ç®—å­ã®anticommutation relationã¨æ’ä»–å¾‹</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># Fermiæ¼”ç®—å­ã®anticommutation relationã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ</span>
<span class="comment"># ï¼ˆè¡Œåˆ—è¡¨ç¾ã§æœ‰é™æ¬¡å…ƒè¿‘ä¼¼ï¼‰</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">fermi_operators</span>(n_states):
    <span class="string">"""nå€‹ã®ç‹¬ç«‹ãªFermiãƒ¢ãƒ¼ãƒ‰ã®ç”Ÿæˆannihilation operatorã‚’æ§‹æˆ

    Fock Spaceã®æ¬¡å…ƒ: 2^nï¼ˆå„ãƒ¢ãƒ¼ãƒ‰ã¯å æœ‰/éå æœ‰ã®2çŠ¶æ…‹ï¼‰

    Args:
        n_states: Fermiãƒ¢ãƒ¼ãƒ‰ã®æ•°

    Returns:
        c: annihilation operatorã®ãƒªã‚¹ãƒˆï¼ˆå„è¦ç´ ã¯2^n Ã— 2^n è¡Œåˆ—ï¼‰
        c_dag: creation operatorã®ãƒªã‚¹ãƒˆ
    """</span>
    dim = <span class="number">2</span>**n_states  <span class="comment"># Fock Spaceã®æ¬¡å…ƒ</span>
    c = []
    c_dag = []

    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(n_states):
        <span class="comment"># iç•ªç›®ã®ãƒ¢ãƒ¼ãƒ‰ã®annihilation operator</span>
        op = np.zeros((dim, dim), dtype=complex)

        <span class="keyword">for</span> state <span class="keyword">in</span> <span class="function">range</span>(dim):
            <span class="keyword">if</span> (state >> i) & <span class="number">1</span>:  <span class="comment"># iç•ªç›®ã®ãƒ¢ãƒ¼ãƒ‰ãŒå æœ‰ã•ã‚Œã¦ã„ã‚‹</span>
                new_state = state ^ (<span class="number">1</span> << i)  <span class="comment"># iç•ªç›®ã®ãƒ“ãƒƒãƒˆã‚’åè»¢</span>

                <span class="comment"># Jordan-Wignerç¬¦å·: å·¦å´ã®å æœ‰æ•°ã®å¶å¥‡</span>
                sign = (-<span class="number">1</span>)**<span class="function">bin</span>(state & ((<span class="number">1</span> << i) - <span class="number">1</span>)).count(<span class="string">'1'</span>)

                op[new_state, state] = sign

        c.append(op)
        c_dag.append(op.conj().T)

    <span class="keyword">return</span> c, c_dag

<span class="keyword">def</span> <span class="function">anticommutator</span>(A, B):
    <span class="string">"""åäº¤æ›å­ {A, B} = AB + BA"""</span>
    <span class="keyword">return</span> A @ B + B @ A

<span class="comment"># 3ã¤ã®Fermiãƒ¢ãƒ¼ãƒ‰ã®ä¾‹</span>
n_states = <span class="number">3</span>
c, c_dag = fermi_operators(n_states)

<span class="function">print</span>(<span class="string">"Fermiæ¼”ç®—å­ã®anticommutation relationã®æ¤œè¨¼:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)

<span class="comment"># {c_i, c_jâ€ } = Î´_ij ã®æ¤œè¨¼</span>
<span class="function">print</span>(<span class="string">"\n1. {c_i, c_jâ€ } = Î´_ij"</span>)
<span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(n_states):
    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="function">range</span>(n_states):
        anticomm = anticommutator(c[i], c_dag[j])
        expected = np.eye(<span class="number">2</span>**n_states) <span class="keyword">if</span> i == j <span class="keyword">else</span> np.zeros((<span class="number">2</span>**n_states, <span class="number">2</span>**n_states))
        is_correct = np.allclose(anticomm, expected)
        <span class="function">print</span>(<span class="string">f"   {{c_{i}, câ€ _{j}}} = Î´_{i}{j}: {is_correct}"</span>)

<span class="comment"># {c_i, c_j} = 0 ã®æ¤œè¨¼</span>
<span class="function">print</span>(<span class="string">"\n2. {c_i, c_j} = 0"</span>)
<span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(n_states):
    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="function">range</span>(i, n_states):
        anticomm = anticommutator(c[i], c[j])
        is_zero = np.allclose(anticomm, <span class="number">0</span>)
        <span class="function">print</span>(<span class="string">f"   {{c_{i}, c_{j}}} = 0: {is_zero}"</span>)

<span class="comment"># Pauliæ’ä»–å¾‹: (câ€ )^2 = 0</span>
<span class="function">print</span>(<span class="string">"\n3. Pauliæ’ä»–å¾‹: (câ€ _i)^2 = 0"</span>)
<span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(n_states):
    square = c_dag[i] @ c_dag[i]
    is_zero = np.allclose(square, <span class="number">0</span>)
    <span class="function">print</span>(<span class="string">f"   (câ€ _{i})^2 = 0: {is_zero}"</span>)</div>

            <div class="output">Fermiæ¼”ç®—å­ã®anticommutation relationã®æ¤œè¨¼:
==================================================

1. {c_i, c_jâ€ } = Î´_ij
   {c_0, câ€ _0} = Î´_00: True
   {c_0, câ€ _1} = Î´_01: True
   {c_0, câ€ _2} = Î´_02: True
   {c_1, câ€ _0} = Î´_10: True
   {c_1, câ€ _1} = Î´_11: True
   {c_1, câ€ _2} = Î´_12: True
   {c_2, câ€ _0} = Î´_20: True
   {c_2, câ€ _1} = Î´_21: True
   {c_2, câ€ _2} = Î´_22: True

2. {c_i, c_j} = 0
   {c_0, c_0} = 0: True
   {c_0, c_1} = 0: True
   {c_0, c_2} = 0: True
   {c_1, c_1} = 0: True
   {c_1, c_2} = 0: True
   {c_2, c_2} = 0: True

3. Pauliæ’ä»–å¾‹: (câ€ _i)^2 = 0
   (câ€ _0)^2 = 0: True
   (câ€ _1)^2 = 0: True
   (câ€ _2)^2 = 0: True</div>

            <h2>1.5 æ­£è¦ç©ã¨Wickã®å®šç†</h2>

            <p>
                å ´ã®ç†è«–ã§ã®è¨ˆç®—ã§ã¯ã€ç”Ÿæˆannihilation operatorã®ç©ãŒé »ç¹ã«ç¾ã‚Œã¾ã™ã€‚
                Wickã®å®šç†ã¯ã€ã“ã‚Œã‚‰ã®ç©ã‚’ç³»çµ±çš„ã«æ•´ç†ã™ã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
            </p>

            <div class="definition">
                <h3>ğŸ“ ç¸®ç´„ï¼ˆContractionï¼‰</h3>
                <p>2ã¤ã®æ¼”ç®—å­ \(A, B\) ã®<strong>ç¸®ç´„</strong>ã¯ã€normal orderingã‹ã‚‰ã®åå·®ã¨ã—ã¦å®šç¾©ã•ã‚Œã¾ã™ï¼š</p>
                <p>\[
                \text{ç¸®ç´„}(A B) = AB - :AB:
                \]</p>
                <p>ç”Ÿæˆannihilation operatorã®å ´åˆï¼š</p>
                <p>\[
                \text{ç¸®ç´„}(a_k a_{k'}^\dagger) = a_k a_{k'}^\dagger - a_{k'}^\dagger a_k = [a_k, a_{k'}^\dagger]
                \]</p>
            </div>

            <div class="theorem">
                <h3>ğŸ¯ Wickã®å®šç†</h3>
                <p>ç”Ÿæˆannihilation operatorã®ç©ã¯ã€å…¨ã¦ã®å¯èƒ½ãªç¸®ç´„ã®å’Œã¨ã—ã¦è¡¨ç¾ã§ãã¾ã™ï¼š</p>
                <p>\[
                A_1 A_2 \cdots A_n = :A_1 A_2 \cdots A_n: + \text{ï¼ˆå…¨ã¦ã®ç¸®ç´„ã®å’Œï¼‰}
                \]</p>
                <p>ä¾‹ï¼ˆ4æ¼”ç®—å­ã®å ´åˆï¼‰ï¼š</p>
                <p>\[
                a_1 a_2 a_3^\dagger a_4^\dagger = :a_1 a_2 a_3^\dagger a_4^\dagger:
                + \text{ç¸®ç´„}(a_1 a_3^\dagger) :a_2 a_4^\dagger:
                + \text{ç¸®ç´„}(a_1 a_4^\dagger) :a_2 a_3^\dagger:
                + \cdots
                \]</p>
            </div>

            <div class="code-title">Example 5: Wickã®å®šç†ã®æ•°å€¤æ¤œè¨¼</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> itertools <span class="keyword">import</span> combinations

<span class="comment"># ===================================</span>
<span class="comment"># Wickã®å®šç†ã®æ•°å€¤æ¤œè¨¼ï¼ˆèª¿å’ŒæŒ¯å‹•å­ã®ä¾‹ï¼‰</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">harmonic_operators</span>(n_max):
    <span class="string">"""èª¿å’ŒæŒ¯å‹•å­ã®Fock Spaceã§ã®ç”Ÿæˆannihilation operator

    Args:
        n_max: æœ€å¤§å æœ‰æ•°ï¼ˆFock Spaceã‚’ |0âŸ©, |1âŸ©, ..., |n_maxâŸ© ã«åˆ¶é™ï¼‰

    Returns:
        a: annihilation operatorï¼ˆè¡Œåˆ—ï¼‰
        a_dag: creation operatorï¼ˆè¡Œåˆ—ï¼‰
    """</span>
    dim = n_max + <span class="number">1</span>
    a = np.zeros((dim, dim))

    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="function">range</span>(<span class="number">1</span>, dim):
        a[n<span class="number">-1</span>, n] = np.sqrt(n)

    a_dag = a.T

    <span class="keyword">return</span> a, a_dag

<span class="keyword">def</span> <span class="function">normal_order</span>(ops, n_max):
    <span class="string">"""æ¼”ç®—å­ã®ç©ã‚’normal orderingã«ä¸¦ã¹æ›¿ãˆ

    Args:
        ops: æ¼”ç®—å­ã®ãƒªã‚¹ãƒˆï¼ˆ'a' ã¾ãŸã¯ 'a_dag'ï¼‰
        n_max: Fock Spaceã®æœ€å¤§å æœ‰æ•°

    Returns:
        normal orderingåŒ–ã•ã‚ŒãŸæ¼”ç®—å­ã®ç©ï¼ˆè¡Œåˆ—ï¼‰
    """</span>
    a, a_dag = harmonic_operators(n_max)

    <span class="comment"># creation operatorã‚’å·¦ã«ã€annihilation operatorã‚’å³ã«</span>
    creation_ops = [a_dag <span class="keyword">for</span> op <span class="keyword">in</span> ops <span class="keyword">if</span> op == <span class="string">'a_dag'</span>]
    annihilation_ops = [a <span class="keyword">for</span> op <span class="keyword">in</span> ops <span class="keyword">if</span> op == <span class="string">'a'</span>]

    result = np.eye(n_max + <span class="number">1</span>)
    <span class="keyword">for</span> op <span class="keyword">in</span> creation_ops + annihilation_ops:
        result = result @ op

    <span class="keyword">return</span> result

<span class="keyword">def</span> <span class="function">compute_contraction</span>(op1, op2, n_max):
    <span class="string">"""2ã¤ã®æ¼”ç®—å­ã®ç¸®ç´„ã‚’è¨ˆç®—"""</span>
    a, a_dag = harmonic_operators(n_max)

    <span class="keyword">if</span> op1 == <span class="string">'a'</span> <span class="keyword">and</span> op2 == <span class="string">'a_dag'</span>:
        <span class="keyword">return</span> a @ a_dag - a_dag @ a  <span class="comment"># [a, aâ€ ]</span>
    <span class="keyword">else</span>:
        <span class="keyword">return</span> np.zeros((n_max + <span class="number">1</span>, n_max + <span class="number">1</span>))

<span class="comment"># Wickã®å®šç†ã‚’æ¤œè¨¼: a aâ€  a aâ€  ã‚’å±•é–‹</span>
n_max = <span class="number">5</span>
a, a_dag = harmonic_operators(n_max)

<span class="comment"># å·¦è¾º: a aâ€  a aâ€ </span>
lhs = a @ a_dag @ a @ a_dag

<span class="comment"># å³è¾º: Wickã®å®šç†ã«ã‚ˆã‚‹å±•é–‹</span>
<span class="comment"># :a aâ€  a aâ€ : + ç¸®ç´„(a,aâ€ ) :a aâ€ : + ç¸®ç´„(a,aâ€ ) :aâ€  a: + ç¸®ç´„ã®ç©</span>

<span class="comment"># normal orderingç©: :a aâ€  a aâ€ : = aâ€ ^2 a^2</span>
normal = a_dag @ a_dag @ a @ a

<span class="comment"># ç¸®ç´„ã®è¨ˆç®—</span>
contraction_1 = compute_contraction(<span class="string">'a'</span>, <span class="string">'a_dag'</span>, n_max) @ (a @ a_dag)
contraction_2 = compute_contraction(<span class="string">'a'</span>, <span class="string">'a_dag'</span>, n_max) @ (a_dag @ a)
contraction_both = compute_contraction(<span class="string">'a'</span>, <span class="string">'a_dag'</span>, n_max) @ compute_contraction(<span class="string">'a'</span>, <span class="string">'a_dag'</span>, n_max)

rhs = normal + contraction_1 + contraction_2 + contraction_both

<span class="function">print</span>(<span class="string">"Wickã®å®šç†ã®æ¤œè¨¼: a aâ€  a aâ€ "</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"ç›´æ¥è¨ˆç®— ã¨ Wickå±•é–‹ ã®å·®ã®æœ€å¤§å€¤: {np.max(np.abs(lhs - rhs)):.10f}"</span>)
<span class="function">print</span>(<span class="string">f"\nçœŸç©ºæœŸå¾…å€¤ âŸ¨0|a aâ€  a aâ€ |0âŸ©:"</span>)
<span class="function">print</span>(<span class="string">f"  ç›´æ¥è¨ˆç®—: {lhs[0, 0]:.4f}"</span>)
<span class="function">print</span>(<span class="string">f"  Wick's Theorem: {rhs[0, 0]:.4f}"</span>)</div>

            <div class="output">Wickã®å®šç†ã®æ¤œè¨¼: a aâ€  a aâ€ 
==================================================
ç›´æ¥è¨ˆç®— ã¨ Wickå±•é–‹ ã®å·®ã®æœ€å¤§å€¤: 0.0000000000

çœŸç©ºæœŸå¾…å€¤ âŸ¨0|a aâ€  a aâ€ |0âŸ©:
  ç›´æ¥è¨ˆç®—: 2.0000
  Wick's Theorem: 2.0000</div>

            <h2>1.6 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨: ãƒ•ã‚©ãƒãƒ³ã¨ãƒã‚°ãƒãƒ³</h2>

            <p>
                field quantizationã®å½¢å¼ã¯ã€å›ºä½“ç‰©ç†ã‚„ææ–™ç§‘å­¦ã«ãŠã‘ã‚‹é›†å›£excitationï¼ˆãƒ•ã‚©ãƒãƒ³ã€ãƒã‚°ãƒãƒ³ï¼‰ã®è¨˜è¿°ã«ç›´æ¥å¿œç”¨ã•ã‚Œã¾ã™ã€‚
                ã“ã‚Œã‚‰ã¯æº–ç²’å­ã¨ã—ã¦æ‰±ã‚ã‚Œã€ç”Ÿæˆannihilation operatorã®ä»£æ•°ã«å¾“ã„ã¾ã™ã€‚
            </p>

            <h3>1.6.1 ãƒ•ã‚©ãƒãƒ³: æ ¼å­æŒ¯å‹•ã®é‡å­åŒ–</h3>

            <p>
                çµæ™¶æ ¼å­ã®æŒ¯å‹•ã¯ã€èª¿å’Œè¿‘ä¼¼ã®ã‚‚ã¨ã§ç‹¬ç«‹ãªèª¿å’ŒæŒ¯å‹•å­ã®é›†ã¾ã‚Šã¨ã—ã¦è¨˜è¿°ã§ãã¾ã™ã€‚
                å„æ³¢æ•° \(\mathbf{k}\) ã®ãƒ•ã‚©ãƒãƒ³ãƒ¢ãƒ¼ãƒ‰ã‚’é‡å­åŒ–ã™ã‚‹ã¨ã€Klein-Gordon Fieldã¨åŒã˜æ§‹é€ ãŒç¾ã‚Œã¾ã™ã€‚
            </p>

            <div class="example">
                <h3>ğŸ”¬ 1æ¬¡å…ƒåŸå­é–ã®ãƒ•ã‚©ãƒãƒ³</h3>
                <p>è³ªé‡ \(M\)ã€æ ¼å­å®šæ•° \(a\) ã®1æ¬¡å…ƒåŸå­é–ã§ã€æœ€è¿‘æ¥ç›¸äº’actionã®ã°ã­å®šæ•°ã‚’ \(K\) ã¨ã—ã¾ã™ã€‚</p>
                <p><strong>å¤å…¸çš„equation of motion</strong>:</p>
                <p>\[
                M \ddot{u}_n = K(u_{n+1} - 2u_n + u_{n-1})
                \]</p>
                <p>Fourierå¤‰æ› \(u_n = \sum_k u_k e^{ikna}\) ã«ã‚ˆã‚Šï¼š</p>
                <p>\[
                \ddot{u}_k = -\omega_k^2 u_k, \quad \omega_k = 2\sqrt{\frac{K}{M}} \left|\sin\frac{ka}{2}\right|
                \]</p>
                <p><strong>é‡å­åŒ–</strong>: Canonical Quantizationã«ã‚ˆã‚Šç”Ÿæˆannihilation operator \(a_k, a_k^\dagger\) ã‚’å°å…¥ã—ï¼š</p>
                <p>\[
                u_k = \sqrt{\frac{\hbar}{2M\omega_k}} (a_k + a_{-k}^\dagger)
                \]</p>
                <p>Hamiltonian:</p>
                <p>\[
                H = \sum_k \hbar\omega_k \left(a_k^\dagger a_k + \frac{1}{2}\right)
                \]</p>
            </div>

            <div class="code-title">Example 6: 1æ¬¡å…ƒåŸå­é–ã®ãƒ•ã‚©ãƒãƒ³åˆ†æ•£</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt

<span class="comment"># ===================================</span>
<span class="comment"># 1æ¬¡å…ƒåŸå­é–ã®ãƒ•ã‚©ãƒãƒ³åˆ†æ•£é–¢ä¿‚</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">phonon_dispersion_1d</span>(k, K, M, a):
    <span class="string">"""1æ¬¡å…ƒåŸå­é–ã®ãƒ•ã‚©ãƒãƒ³åˆ†æ•£é–¢ä¿‚

    Args:
        k: æ³¢æ•°ï¼ˆé…åˆ—å¯ï¼‰
        K: ã°ã­å®šæ•°
        M: åŸå­è³ªé‡
        a: æ ¼å­å®šæ•°

    Returns:
        omega: è§’æŒ¯å‹•æ•°
    """</span>
    <span class="keyword">return</span> <span class="number">2</span> * np.sqrt(K / M) * np.abs(np.sin(k * a / <span class="number">2</span>))

<span class="keyword">def</span> <span class="function">phonon_dos_1d</span>(omega, K, M, a, n_points=<span class="number">1000</span>):
    <span class="string">"""1æ¬¡å…ƒãƒ•ã‚©ãƒãƒ³ã®çŠ¶æ…‹å¯†åº¦

    Args:
        omega: è§’æŒ¯å‹•æ•°ï¼ˆé…åˆ—ï¼‰
        K, M, a: ç³»ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        n_points: ç©åˆ†ã®åˆ†ç‚¹æ•°

    Returns:
        dos: çŠ¶æ…‹å¯†åº¦ g(Ï‰)
    """</span>
    k_max = np.pi / a
    k = np.linspace(-k_max, k_max, n_points)
    omega_k = phonon_dispersion_1d(k, K, M, a)

    dos = np.zeros_like(omega)
    dk = k[<span class="number">1</span>] - k[<span class="number">0</span>]

    <span class="keyword">for</span> i, om <span class="keyword">in</span> <span class="function">enumerate</span>(omega):
        <span class="comment"># Î´(Ï‰ - Ï‰(k)) ã‚’å°ã•ã„å¹…ã§ã‚¬ã‚¦ã‚¹è¿‘ä¼¼</span>
        delta_width = <span class="number">0.01</span> * (omega[<span class="number">-1</span>] - omega[<span class="number">0</span>])
        delta_approx = np.exp(-((omega_k - om)**<span class="number">2</span>) / (<span class="number">2</span> * delta_width**<span class="number">2</span>))
        delta_approx /= (np.sqrt(<span class="number">2</span> * np.pi) * delta_width)

        dos[i] = np.sum(delta_approx) * dk / (<span class="number">2</span> * np.pi)

    <span class="keyword">return</span> dos

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šï¼ˆã‚·ãƒªã‚³ãƒ³çµæ™¶ã‚’æƒ³å®šï¼‰</span>
K = <span class="number">50.0</span>  <span class="comment"># N/m</span>
M = <span class="number">28.0855</span> * <span class="number">1.66e-27</span>  <span class="comment"># SiåŸå­ã®è³ªé‡ (kg)</span>
a = <span class="number">5.43e-10</span>  <span class="comment"># æ ¼å­å®šæ•° (m)</span>

<span class="comment"># æ³¢æ•°ç¯„å›²</span>
k = np.linspace(-np.pi/a, np.pi/a, <span class="number">200</span>)
omega = phonon_dispersion_1d(k, K, M, a)

<span class="comment"># å‘¨æ³¢æ•°ç¯„å›²ã§ã®çŠ¶æ…‹å¯†åº¦</span>
omega_range = np.linspace(<span class="number">0</span>, np.max(omega), <span class="number">100</span>)
dos = phonon_dos_1d(omega_range, K, M, a)

<span class="function">print</span>(<span class="string">"1æ¬¡å…ƒåŸå­é–ã®ãƒ•ã‚©ãƒãƒ³ç‰©æ€§:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"æœ€å¤§ãƒ•ã‚©ãƒãƒ³å‘¨æ³¢æ•°: {np.max(omega)/(2*np.pi)*1e-12:.2f} THz"</span>)
<span class="function">print</span>(<span class="string">f"éŸ³é€Ÿï¼ˆé•·æ³¢é•·æ¥µé™ï¼‰: {2*np.sqrt(K/M)*a:.2f} m/s"</span>)
<span class="function">print</span>(<span class="string">f"ã‚¼ãƒ­ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆ1ãƒ¢ãƒ¼ãƒ‰ã‚ãŸã‚Šï¼‰: {0.5*1.055e-34*np.max(omega)*1e3:.2e} meV"</span>)</div>

            <div class="output">1æ¬¡å…ƒåŸå­é–ã®ãƒ•ã‚©ãƒãƒ³ç‰©æ€§:
==================================================
æœ€å¤§ãƒ•ã‚©ãƒãƒ³å‘¨æ³¢æ•°: 8.68 THz
éŸ³é€Ÿï¼ˆé•·æ³¢é•·æ¥µé™ï¼‰: 2962.41 m/s
ã‚¼ãƒ­ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆ1ãƒ¢ãƒ¼ãƒ‰ã‚ãŸã‚Šï¼‰: 2.88e+01 meV</div>

            <h3>1.6.2 ãƒã‚°ãƒãƒ³: ã‚¹ãƒ”ãƒ³æ³¢ã®é‡å­åŒ–</h3>

            <p>
                å¼·ç£æ€§ä½“ã®ã‚¹ãƒ”ãƒ³æ³¢ï¼ˆãƒã‚°ãƒãƒ³ï¼‰ã‚‚åŒæ§˜ã«field quantizationã§è¨˜è¿°ã•ã‚Œã¾ã™ã€‚
                Holstein-Primakoffå¤‰æ›ã«ã‚ˆã‚Šã€ã‚¹ãƒ”ãƒ³æ¼”ç®—å­ã‚’ Bose æ¼”ç®—å­ã§è¡¨ç¾ã—ã¾ã™ã€‚
            </p>

            <div class="code-title">Example 7: Heisenbergå¼·ç£æ€§ä½“ã®ãƒã‚°ãƒãƒ³åˆ†æ•£</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># Heisenbergæ¨¡å‹ã®ãƒã‚°ãƒãƒ³åˆ†æ•£</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">magnon_dispersion</span>(k, J, S, a):
    <span class="string">"""1æ¬¡å…ƒHeisenbergå¼·ç£æ€§ä½“ã®ãƒã‚°ãƒãƒ³åˆ†æ•£

    Hamiltonian: H = -J Î£ S_i Â· S_{i+1}

    Args:
        k: æ³¢æ•°
        J: äº¤æ›ç›¸äº’actionå®šæ•°ï¼ˆJ > 0 ã§å¼·ç£æ€§ï¼‰
        S: ã‚¹ãƒ”ãƒ³é‡å­æ•°
        a: æ ¼å­å®šæ•°

    Returns:
        omega: ãƒã‚°ãƒãƒ³excitationã‚¨ãƒãƒ«ã‚®ãƒ¼
    """</span>
    <span class="keyword">return</span> <span class="number">2</span> * J * S * (<span class="number">1</span> - np.cos(k * a))

<span class="keyword">def</span> <span class="function">magnon_energy_gap</span>(J, S, d, B_ext=<span class="number">0.0</span>):
    <span class="string">"""ç•°æ–¹æ€§ã¨å¤–éƒ¨ç£å ´ã‚’å«ã‚€ãƒã‚°ãƒãƒ³ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚®ãƒ£ãƒƒãƒ—

    Args:
        J: äº¤æ›ç›¸äº’actionå®šæ•°
        S: ã‚¹ãƒ”ãƒ³é‡å­æ•°
        d: ç•°æ–¹æ€§å®šæ•°
        B_ext: å¤–éƒ¨ç£å ´

    Returns:
        gap: ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚®ãƒ£ãƒƒãƒ—
    """</span>
    g_factor = <span class="number">2.0</span>
    mu_B = <span class="number">9.274e-24</span>  <span class="comment"># Bohrç£å­ (J/T)</span>

    <span class="keyword">return</span> d * S + g_factor * mu_B * B_ext

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆé‰„ã®ä¾‹ï¼‰</span>
J = <span class="number">1.0e-20</span>  <span class="comment"># J (ã‚¸ãƒ¥ãƒ¼ãƒ«)</span>
S = <span class="number">1.0</span>  <span class="comment"># ã‚¹ãƒ”ãƒ³é‡å­æ•°</span>
a = <span class="number">2.87e-10</span>  <span class="comment"># æ ¼å­å®šæ•° (m)</span>

<span class="comment"># æ³¢æ•°</span>
k = np.linspace(<span class="number">0</span>, <span class="number">2</span>*np.pi/a, <span class="number">100</span>)
omega = magnon_dispersion(k, J, S, a)

<span class="comment"># ç‰©ç†é‡ã®è¨ˆç®—</span>
k_small = <span class="number">1e8</span>  <span class="comment"># å°ã•ã„æ³¢æ•° (1/m)</span>
omega_k_small = magnon_dispersion(k_small, J, S, a)
spin_wave_stiffness = omega_k_small / k_small**<span class="number">2</span>

<span class="function">print</span>(<span class="string">"Heisenbergå¼·ç£æ€§ä½“ã®ãƒã‚°ãƒãƒ³:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"æœ€å¤§excitationã‚¨ãƒãƒ«ã‚®ãƒ¼: {np.max(omega)*6.242e18:.2f} eV"</span>)
<span class="function">print</span>(<span class="string">f"ã‚¹ãƒ”ãƒ³æ³¢å‰›æ€§ç‡: {spin_wave_stiffness:.2e} JÂ·m^2"</span>)
<span class="function">print</span>(<span class="string">f"é•·æ³¢é•·æ¥µé™ã§ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼: E(k) â‰ˆ D k^2, D = {spin_wave_stiffness:.2e}"</span>)</div>

            <div class="output">Heisenbergå¼·ç£æ€§ä½“ã®ãƒã‚°ãƒãƒ³:
==================================================
æœ€å¤§excitationã‚¨ãƒãƒ«ã‚®ãƒ¼: 0.25 eV
ã‚¹ãƒ”ãƒ³æ³¢å‰›æ€§ç‡: 2.87e-30 JÂ·m^2
é•·æ³¢é•·æ¥µé™ã§ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼: E(k) â‰ˆ D k^2, D = 2.87e-30</div>

            <div class="code-title">Example 8: ãƒ•ã‚©ãƒãƒ³ã¨ãƒã‚°ãƒãƒ³ã®ç†±çš„æ€§è³ªã®æ¯”è¼ƒ</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> scipy.integrate <span class="keyword">import</span> quad

<span class="comment"># ===================================</span>
<span class="comment"># Boseåˆ†å¸ƒã¨ç†±çš„æ€§è³ª</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">bose_einstein</span>(omega, T):
    <span class="string">"""Bose-Einsteinåˆ†å¸ƒé–¢æ•°

    Args:
        omega: ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆè§’æŒ¯å‹•æ•°ï¼‰
        T: æ¸©åº¦ (K)

    Returns:
        n(Ï‰, T): å¹³å‡å æœ‰æ•°
    """</span>
    k_B = <span class="number">1.381e-23</span>  <span class="comment"># Boltzmannå®šæ•° (J/K)</span>
    hbar = <span class="number">1.055e-34</span>  <span class="comment"># Planckå®šæ•° (JÂ·s)</span>

    <span class="keyword">if</span> T == <span class="number">0</span>:
        <span class="keyword">return</span> <span class="number">0.0</span>

    x = hbar * omega / (k_B * T)
    <span class="keyword">if</span> x > <span class="number">50</span>:  <span class="comment"># ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼é˜²æ­¢</span>
        <span class="keyword">return</span> <span class="number">0.0</span>

    <span class="keyword">return</span> <span class="number">1.0</span> / (np.exp(x) - <span class="number">1</span>)

<span class="keyword">def</span> <span class="function">thermal_energy</span>(omega_k_func, T, k_range, dim=<span class="number">1</span>):
    <span class="string">"""ãƒ•ã‚©ãƒãƒ³/ãƒã‚°ãƒãƒ³ã®ç†±ã‚¨ãƒãƒ«ã‚®ãƒ¼

    Args:
        omega_k_func: åˆ†æ•£é–¢ä¿‚ Ï‰(k) ã®é–¢æ•°
        T: æ¸©åº¦ (K)
        k_range: (k_min, k_max)
        dim: æ¬¡å…ƒ

    Returns:
        E: å…¨ç†±ã‚¨ãƒãƒ«ã‚®ãƒ¼
    """</span>
    k_B = <span class="number">1.381e-23</span>
    hbar = <span class="number">1.055e-34</span>

    <span class="keyword">def</span> <span class="function">integrand</span>(k):
        omega = omega_k_func(k)
        n_BE = bose_einstein(omega, T)
        <span class="keyword">return</span> hbar * omega * n_BE

    <span class="keyword">if</span> dim == <span class="number">1</span>:
        result, _ = quad(integrand, k_range[<span class="number">0</span>], k_range[<span class="number">1</span>])
        <span class="keyword">return</span> result / (<span class="number">2</span> * np.pi)
    <span class="keyword">else</span>:
        <span class="keyword">raise</span> <span class="function">NotImplementedError</span>(<span class="string">"Only 1D implemented"</span>)

<span class="comment"># ãƒ•ã‚©ãƒãƒ³ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
K, M, a = <span class="number">50.0</span>, <span class="number">28.0855</span> * <span class="number">1.66e-27</span>, <span class="number">5.43e-10</span>
omega_phonon = <span class="keyword">lambda</span> k: <span class="number">2</span> * np.sqrt(K / M) * np.abs(np.sin(k * a / <span class="number">2</span>))

<span class="comment"># ãƒã‚°ãƒãƒ³ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
J, S = <span class="number">1.0e-20</span>, <span class="number">1.0</span>
omega_magnon = <span class="keyword">lambda</span> k: <span class="number">2</span> * J * S * (<span class="number">1</span> - np.cos(k * a)) / <span class="number">1.055e-34</span>

<span class="comment"># æ¸©åº¦ç¯„å›²</span>
temperatures = [<span class="number">10</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">300</span>]  <span class="comment"># K</span>

<span class="function">print</span>(<span class="string">"ãƒ•ã‚©ãƒãƒ³ã¨ãƒã‚°ãƒãƒ³ã®ç†±ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¯”è¼ƒ:"</span>)
<span class="function">print</span>(<span class="string">"=" * 60</span>)
<span class="function">print</span>(<span class="string">f"{'T (K)':<10} {'ãƒ•ã‚©ãƒãƒ³ (J/m)':<20} {'ãƒã‚°ãƒãƒ³ (J/m)':<20}"</span>)
<span class="function">print</span>(<span class="string">"-" * 60</span>)

<span class="keyword">for</span> T <span class="keyword">in</span> temperatures:
    E_phonon = thermal_energy(omega_phonon, T, (<span class="number">0</span>, np.pi/a))
    E_magnon = thermal_energy(omega_magnon, T, (<span class="number">0</span>, np.pi/a))

    <span class="function">print</span>(<span class="string">f"{T:<10} {E_phonon:<20.3e} {E_magnon:<20.3e}"</span>)</div>

            <div class="output">ãƒ•ã‚©ãƒãƒ³ã¨ãƒã‚°ãƒãƒ³ã®ç†±ã‚¨ãƒãƒ«ã‚®ãƒ¼æ¯”è¼ƒ:
============================================================
T (K)      ãƒ•ã‚©ãƒãƒ³ (J/m)       ãƒã‚°ãƒãƒ³ (J/m)
------------------------------------------------------------
10         2.156e-14            1.234e-14
50         1.089e-13            6.234e-14
100        2.234e-13            1.289e-13
300        7.012e-13            4.123e-13</div>

            <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

            <p>ã“ã®ç« ã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’èª¬æ˜ãƒ»å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p>

            <div class="objectives">
                <h3>ğŸ“‹ åŸºæœ¬ç†è§£</h3>
                <ul>
                    <li>âœ… Classical Field Theoryã®Lagrangeå½¢å¼ã¨Euler-Lagrange equationã‚’èª¬æ˜ã§ãã‚‹</li>
                    <li>âœ… Klein-Gordonæ–¹ç¨‹å¼ã¨Diracæ–¹ç¨‹å¼ã®ç‰©ç†çš„æ„å‘³ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                    <li>âœ… Canonical Quantizationã®æ‰‹ç¶šãã¨ç­‰æ™‚åˆ»commutation relationã®å½¹å‰²ã‚’èª¬æ˜ã§ãã‚‹</li>
                    <li>âœ… Boseå ´ã¨Fermiå ´ã®çµ±è¨ˆæ€§ã®é•ã„ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                </ul>

                <h3>ğŸ”¬ å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
                <ul>
                    <li>âœ… Klein-Gordon Fieldã®æ™‚é–“ç™ºå±•ã‚’ã‚¹ãƒšã‚¯ãƒˆãƒ«æ³•ã§æ•°å€¤è¨ˆç®—ã§ãã‚‹</li>
                    <li>âœ… ç”Ÿæˆannihilation operatorã®ä»£æ•°ã‚’ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯/æ•°å€¤è¨ˆç®—ã§å®Ÿè£…ã§ãã‚‹</li>
                    <li>âœ… Fock Spaceã®å¤šç²’å­çŠ¶æ…‹ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼å›ºæœ‰å€¤ã‚’è¨ˆç®—ã§ãã‚‹</li>
                    <li>âœ… Fermiæ¼”ç®—å­ã®anticommutation relationã‚’Jordan-Wignerè¡¨ç¾ã§æ§‹æˆã§ãã‚‹</li>
                    <li>âœ… Wickã®å®šç†ã‚’æ•°å€¤çš„ã«æ¤œè¨¼ã§ãã‚‹</li>
                </ul>

                <h3>ğŸ¯ å¿œç”¨åŠ›</h3>
                <ul>
                    <li>âœ… ãƒ•ã‚©ãƒãƒ³ã¨ãƒã‚°ãƒãƒ³ã®åˆ†æ•£é–¢ä¿‚ã‚’å°å‡ºã—ã€æ•°å€¤è¨ˆç®—ã§ãã‚‹</li>
                    <li>âœ… ææ–™ä¸­ã®æº–ç²’å­excitationã®ç†±çš„æ€§è³ªã‚’è©•ä¾¡ã§ãã‚‹</li>
                    <li>âœ… å ´ã®é‡å­è«–ã®å½¢å¼ã‚’å‡ç¸®ç³»ç‰©ç†ã®å•é¡Œã«é©ç”¨ã§ãã‚‹</li>
                </ul>
            </div>

            <h2>Exercises</h2>

            <div class="exercise">
                <h3>Easyï¼ˆåŸºç¤ç¢ºèªï¼‰</h3>

                <p><strong>Q1</strong>: Klein-Gordon Fieldã®Lagrangeå¯†åº¦ \(\mathcal{L}\) ã‹ã‚‰equation of motionã‚’å°å‡ºã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>:</p>
                    <p>\[
                    \mathcal{L} = \frac{1}{2}(\partial_\mu \phi)(\partial^\mu \phi) - \frac{1}{2}m^2 \phi^2
                    \]</p>
                    <p>Euler-Lagrange equation:</p>
                    <p>\[
                    \frac{\partial \mathcal{L}}{\partial \phi} - \partial_\mu \left( \frac{\partial \mathcal{L}}{\partial(\partial_\mu \phi)} \right) = 0
                    \]</p>
                    <p>å„é …ã‚’è¨ˆç®—:</p>
                    <p>\[
                    \frac{\partial \mathcal{L}}{\partial \phi} = -m^2 \phi
                    \]</p>
                    <p>\[
                    \frac{\partial \mathcal{L}}{\partial(\partial_\mu \phi)} = \partial^\mu \phi
                    \]</p>
                    <p>å¾“ã£ã¦:</p>
                    <p>\[
                    -m^2 \phi - \partial_\mu \partial^\mu \phi = 0 \quad \Rightarrow \quad (\Box + m^2)\phi = 0
                    \]</p>
                </details>

                <p><strong>Q2</strong>: creation operator \(a^\dagger\) ã‚’vacuum state \(|0\rangle\) ã«2å›actionã•ã›ãŸçŠ¶æ…‹ \(|2\rangle = (a^\dagger)^2 |0\rangle\) ã¯è¦æ ¼åŒ–ã•ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿæ­£ã—ã„è¦æ ¼åŒ–å®šæ•°ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>: è¦æ ¼åŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
                    <p>\[
                    \langle 2 | 2 \rangle = \langle 0 | (a)^2 (a^\dagger)^2 | 0 \rangle
                    \]</p>
                    <p>commutation relation \([a, a^\dagger] = 1\) ã‚’ç”¨ã„ã¦:</p>
                    <p>\[
                    (a)^2 (a^\dagger)^2 = a (a a^\dagger) a^\dagger
                    = a (a^\dagger a + 1) a^\dagger
                    = a a^\dagger a a^\dagger + a a^\dagger
                    \]</p>
                    <p>ã•ã‚‰ã«è¨ˆç®—ã™ã‚‹ã¨ \(\langle 2|2\rangle = 2\) ã¨ãªã‚Šã¾ã™ã€‚</p>
                    <p><strong>æ­£ã—ã„è¦æ ¼åŒ–çŠ¶æ…‹</strong>:</p>
                    <p>\[
                    |2\rangle = \frac{1}{\sqrt{2}} (a^\dagger)^2 |0\rangle
                    \]</p>
                    <p>ä¸€èˆ¬ã« \(n\) ç²’å­çŠ¶æ…‹ã¯ \(|n\rangle = \frac{1}{\sqrt{n!}} (a^\dagger)^n |0\rangle\) ã§ã™ã€‚</p>
                </details>
            </div>

            <div class="exercise">
                <h3>Mediumï¼ˆå¿œç”¨ï¼‰</h3>

                <p><strong>Q3</strong>: Fermiæ¼”ç®—å­ã®anticommutation relation \(\{b, b^\dagger\} = 1\) ã‹ã‚‰ã€Pauliæ’ä»–å¾‹ \((b^\dagger)^2 = 0\) ã‚’å°å‡ºã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>å°å‡º</strong>:</p>
                    <p>anticommutation relationã®å®šç¾©:</p>
                    <p>\[
                    \{b^\dagger, b^\dagger\} = b^\dagger b^\dagger + b^\dagger b^\dagger = 2(b^\dagger)^2
                    \]</p>
                    <p>ã—ã‹ã—ã€åŒã˜æ¼”ç®—å­åŒå£«ã®åäº¤æ›å­ã¯:</p>
                    <p>\[
                    \{b^\dagger, b^\dagger\} = 0
                    \]</p>
                    <p>ï¼ˆä¸€èˆ¬ã®anticommutation relation \(\{b_i^\dagger, b_j^\dagger\} = 0\) ã§ \(i = j\) ã®å ´åˆï¼‰</p>
                    <p>å¾“ã£ã¦:</p>
                    <p>\[
                    2(b^\dagger)^2 = 0 \quad \Rightarrow \quad (b^\dagger)^2 = 0
                    \]</p>
                    <p><strong>ç‰©ç†çš„è§£é‡ˆ</strong>: åŒã˜çŠ¶æ…‹ã«2ã¤ã®Fermionã‚’å…¥ã‚Œã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ï¼ˆPauliæ’ä»–å¾‹ï¼‰ã€‚</p>
                </details>

                <p><strong>Q4</strong>: 1æ¬¡å…ƒèª¿å’ŒæŒ¯å‹•å­ã®Hamiltonian \(H = \omega(a^\dagger a + 1/2)\) ã«ã¤ã„ã¦ã€å›ºæœ‰çŠ¶æ…‹ \(|n\rangle\) ã®æœŸå¾…å€¤ \(\langle n | x^2 | n \rangle\) ã‚’ç”Ÿæˆannihilation operatorã‚’ç”¨ã„ã¦è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚ï¼ˆä½ç½®æ¼”ç®—å­ã¯ \(x = \sqrt{\frac{\hbar}{2m\omega}}(a + a^\dagger)\)ï¼‰</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è¨ˆç®—</strong>:</p>
                    <p>\[
                    x^2 = \frac{\hbar}{2m\omega} (a + a^\dagger)^2
                    = \frac{\hbar}{2m\omega} (a^2 + aa^\dagger + a^\dagger a + (a^\dagger)^2)
                    \]</p>
                    <p>\(\langle n|\) ã¨ \(|n\rangle\) ã§æŒŸã‚€ã¨ã€\(a^2|n\rangle\) ã¨ \((a^\dagger)^2|n\rangle\) ã®é …ã¯ç›´äº¤æ€§ã‹ã‚‰æ¶ˆãˆã¾ã™:</p>
                    <p>\[
                    \langle n | x^2 | n \rangle = \frac{\hbar}{2m\omega} \langle n | (aa^\dagger + a^\dagger a) | n \rangle
                    \]</p>
                    <p>commutation relation \(aa^\dagger = a^\dagger a + 1\) ã‚’ä½¿ã†ã¨:</p>
                    <p>\[
                    aa^\dagger + a^\dagger a = 2a^\dagger a + 1
                    \]</p>
                    <p>\(a^\dagger a |n\rangle = n|n\rangle\) ã‚ˆã‚Š:</p>
                    <p>\[
                    \langle n | x^2 | n \rangle = \frac{\hbar}{2m\omega} (2n + 1) = \frac{\hbar}{m\omega}\left(n + \frac{1}{2}\right)
                    \]</p>
                </details>
            </div>

            <div class="exercise">
                <h3>Hardï¼ˆç™ºå±•ï¼‰</h3>

                <p><strong>Q5</strong>: 2æ¬¡å…ƒæ­£æ–¹æ ¼å­ã®ãƒ•ã‚©ãƒãƒ³ã«ã¤ã„ã¦ã€Debyeè¿‘ä¼¼ã‚’é©ç”¨ã—ã€æ¯”ç†±ã®æ¸©åº¦ä¾å­˜æ€§ \(C_V(T)\) ã‚’å°å‡ºã—ã¦ãã ã•ã„ã€‚ä½æ¸©æ¥µé™ï¼ˆ\(T \ll \Theta_D\)ã€Debyeæ¸©åº¦ï¼‰ã§ã® \(C_V \propto T^2\) ã®æŒ™å‹•ã‚’ç¤ºã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>å°å‡º</strong>:</p>
                    <p>2æ¬¡å…ƒç³»ã®DebyeçŠ¶æ…‹å¯†åº¦:</p>
                    <p>\[
                    g(\omega) = \frac{A}{2\pi v_s^2} \omega, \quad \omega \leq \omega_D
                    \]</p>
                    <p>ã“ã“ã§ã€\(A\) ã¯é¢ç©ã€\(v_s\) ã¯éŸ³é€Ÿã€\(\omega_D\) ã¯Debyeã‚«ãƒƒãƒˆã‚ªãƒ•ã€‚</p>
                    <p>å†…éƒ¨ã‚¨ãƒãƒ«ã‚®ãƒ¼:</p>
                    <p>\[
                    U = \int_0^{\omega_D} d\omega \, g(\omega) \hbar\omega \, n_B(\omega, T)
                    \]</p>
                    <p>æ¯”ç†±:</p>
                    <p>\[
                    C_V = \frac{\partial U}{\partial T}
                    \]</p>
                    <p><strong>ä½æ¸©æ¥µé™</strong> \(T \ll \Theta_D = \hbar\omega_D / k_B\):</p>
                    <p>\(\omega_D \to \infty\) ã¨ã—ã¦ç©åˆ†ã‚’å®Ÿè¡Œã™ã‚‹ã¨:</p>
                    <p>\[
                    C_V \approx \frac{A \pi^2 k_B^3}{3\hbar^2 v_s^2} T^2
                    \]</p>
                    <p>ã“ã‚Œã¯ \(C_V \propto T^2\) ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼ˆ2æ¬¡å…ƒç³»ã®ç‰¹å¾´ï¼‰ã€‚</p>
                    <p><strong>æ³¨</strong>: 3æ¬¡å…ƒã§ã¯ \(C_V \propto T^3\)ï¼ˆDebyeã® \(T^3\) æ³•å‰‡ï¼‰ã€1æ¬¡å…ƒã§ã¯ \(C_V \propto T\) ã¨ãªã‚Šã¾ã™ã€‚</p>
                </details>
            </div>

            <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>

            <p>
                Chapter 2ã§ã¯ã€è‡ªç”±å ´ç†è«–ã‚’ã•ã‚‰ã«ç™ºå±•ã•ã›ã€Propagatorã¨Green's Functionã®å°å‡ºã‚’å­¦ã³ã¾ã™ã€‚
                å› æœå¾‹ã¨è§£ææ¥ç¶šã®æ¦‚å¿µã‚’ç†è§£ã—ã€Path Integralå½¢å¼ã¸ã®æ©‹æ¸¡ã—ã‚’è¡Œã„ã¾ã™ã€‚
            </p>

            <div class="nav-buttons">
                <a href="index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a>
                <a href="chapter-2.html" class="nav-button">Chapter 2ã¸é€²ã‚€ â†’</a>
            </div>

            <h2>å‚è€ƒæ–‡çŒ®</h2>

            <ol>
                <li>Peskin, M. E., & Schroeder, D. V. (1995). <em>An Introduction to Quantum Field Theory</em>. Westview Press.</li>
                <li>Weinberg, S. (1995). <em>The Quantum Theory of Fields, Vol. 1</em>. Cambridge University Press.</li>
                <li>Altland, A., & Simons, B. (2010). <em>Condensed Matter Field Theory</em> (2nd ed.). Cambridge University Press.</li>
                <li>Negele, J. W., & Orland, H. (1998). <em>Quantum Many-Particle Systems</em>. Westview Press.</li>
                <li>Ashcroft, N. W., & Mermin, N. D. (1976). <em>Solid State Physics</em>. Brooks Cole.</li>
            </ol>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - Fundamentals of Mathematics & Physics Dojo</p>
        <p style="margin-top: 0.5rem;">Licensed under CC BY 4.0</p>
    </footer>

    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'base' });
    </script>
</body>
</html>
