<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>Chapter 2: Heat Conduction Equation and Diffusion Phenomena | Partial Differential Equations and Boundary Value Problems</title>
 <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
 <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
 <style>
 * { margin: 0; padding: 0; box-sizing: border-box; }
 body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
 header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
 h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
 .subtitle { opacity: 0.9; }
 .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
 .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
 .breadcrumb a { color: #667eea; text-decoration: none; }
 .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
 h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
 h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
 .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
 .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
 .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
 .code-title {
 background: #667eea;
 color: white;
 padding: 0.5rem 1rem;
 border-radius: 6px 6px 0 0;
 font-weight: 600;
 margin-top: 1.5rem;
 }
 .code-example {
 background: #1e1e1e;
 color: #d4d4d4;
 padding: 1.5rem;
 border-radius: 0 0 8px 8px;
 overflow-x: auto;
 margin: 0 0 1rem 0;
 font-family: 'Courier New', monospace;
 font-size: 0.9rem;
 line-height: 1.6;
 white-space: pre-wrap;
 }
 .code-block {
 background: #1e1e1e;
 color: #d4d4d4;
 padding: 1.5rem;
 border-radius: 8px;
 overflow-x: auto;
 margin: 1rem 0;
 font-family: 'Courier New', monospace;
 font-size: 0.9rem;
 line-height: 1.6;
 white-space: pre-wrap;
 }
 .code-block code {
 font-family: 'Courier New', monospace;
 font-size: 0.9rem;
 line-height: 1.6;
 white-space: pre-wrap;
 }
 .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
 table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
 th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
 th { background: #667eea; color: white; }
 .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
 .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
 .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
 .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
 .nav-button:hover { background: #764ba2; }
 footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
 @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
 </style>
</head>
<body>
 <header>
 <h1>Chapter 2: Heat Conduction Equation and Diffusion Phenomena</h1>
 <p class="subtitle">Heat Equation and Diffusion</p>
 </header>

 <div class="container">
 <div class="breadcrumb">
 <a href="../index.html">FM Dojo</a> &gt;
 <a href="index.html">Partial Differential Equations and Boundary Value Problems</a> &gt;
 Chapter 2
 </div>

 <div class="content">
 <h2>2.1 Derivation of the Heat Conduction Equation</h2>
 <p>
 We derive the diffusion equation from Fourier's law of heat conduction.
 </p>

 <div class="theorem">
 <strong>üìê Theory</strong><br>
 <p><strong>heat conduction equationÔºàdiffusion equationÔºâ:</strong></p>
 $$\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}$$
 <p>where $u(x,t)$ is temperature and $\alpha = k/(\rho c_p)$ is thermal diffusivity</p>
 <p>$k$: thermal conductivity, $\rho$: density, $c_p$: specific heat</p>
 </div>

 <div class="code-title">üíª Code Example 1: Numerical solution of heat conduction equation (explicit scheme)</div>
 <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# Parameters
L = 10.0 # rod length
alpha = 0.1 # thermal diffusivity
T_total = 10.0
Nx = 100
Nt = 2000

x = np.linspace(0, L, Nx)
t = np.linspace(0, T_total, Nt)
dx = x[1] - x[0]
dt = t[1] - t[0]

# Stability condition verification
r = alpha * dt / dx**2
print(f"Stability parameter r = {r:.4f} (stability condition: r ‚â§ 0.5)")

# Initial condition: step function
u = np.zeros((Nt, Nx))
u[0, Nx//4:3*Nx//4] = 100.0

# Boundary conditions: u(0,t) = u(L,t) = 0
# explicit schemeÔºàFTCS: Forward Time Central SpaceÔºâ
for n in range(Nt-1):
 for i in range(1, Nx-1):
 u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])

 u[n+1, 0] = 0
 u[n+1, -1] = 0

# Visualization
fig, axes = plt.subplots(2, 2, figsize=(14, 10))
axes = axes.flatten()

times_idx = [0, Nt//10, Nt//3, Nt-1]
for idx, n in enumerate(times_idx):
 ax = axes[idx]
 ax.plot(x, u[n], 'b-', linewidth=2)
 ax.axhline(0, color='gray', linewidth=0.5)
 ax.grid(True, alpha=0.3)
 ax.set_xlabel('Position x', fontsize=12)
 ax.set_ylabel('Temperature u(x,t)', fontsize=12)
 ax.set_title(f't = {t[n]:.2f}', fontsize=12)
 ax.set_ylim(-10, 110)

plt.suptitle('Numerical solution of heat conduction equation (explicit scheme)', fontsize=14)
plt.tight_layout()
plt.show()

# Spacetime plot
plt.figure(figsize=(12, 6))
plt.contourf(x, t, u, levels=50, cmap='hot')
plt.colorbar(label='Temperature u(x,t)')
plt.xlabel('Position x', fontsize=12)
plt.ylabel('Time t', fontsize=12)
plt.title('Heat diffusion spacetime diagram', fontsize=14)
plt.tight_layout()
plt.show()

print("\nProperties of heat conduction equation:")
print("- Heat diffuses from high temperature to low temperature")
print("- Temperature distribution becomes smoother over time")
print("- Entropy increases (irreversible process)")</div>
 </div>

 <div class="content">
 <h2>2.2 Fundamental Solution (Gaussian Kernel)</h2>
 <p>
 We learn the fundamental solution of the heat conduction equation in an infinite domain.
 </p>

 <div class="theorem">
 <strong>üìê Theory</strong><br>
 <p><strong>Fundamental Solution (Gaussian Kernel):</strong></p>
 $$G(x,t) = \frac{1}{\sqrt{4\pi\alpha t}} e^{-x^2/(4\alpha t)}$$
 <p><strong>General solution by convolution:</strong></p>
 $$u(x,t) = \int_{-\infty}^{\infty} G(x-\xi, t) f(\xi) d\xi$$
 </div>

 <div class="code-title">üíª Code Example 2: Visualization of fundamental solution (Gaussian kernel)</div>
 <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# Parameters
alpha = 0.1
x = np.linspace(-10, 10, 500)

# fundamental solution
def fundamental_solution(x, t, alpha):
 if t <= 0:
 return np.zeros_like(x)
 return (1/np.sqrt(4*np.pi*alpha*t)) * np.exp(-x**2 / (4*alpha*t))

# Time evolution
t_values = [0.1, 0.5, 1.0, 2.0, 5.0]

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# Time evolution of fundamental solution
for t in t_values:
 G = fundamental_solution(x, t, alpha)
 ax1.plot(x, G, linewidth=2, label=f't = {t}')

ax1.grid(True, alpha=0.3)
ax1.set_xlabel('Position x', fontsize=12)
ax1.set_ylabel('G(x,t)', fontsize=12)
ax1.set_title('Time evolution of fundamental solution (Gaussian kernel)', fontsize=14)
ax1.legend()

# General solution by convolution
# Initial condition: step function
def initial_condition(x):
 return np.where(np.abs(x) < 1, 1.0, 0.0)

# Convolution
def convolution_solution(x, t, alpha, f):
 xi = np.linspace(-20, 20, 1000)
 dxi = xi[1] - xi[0]
 u = np.zeros_like(x)

 for i, x_val in enumerate(x):
 G = fundamental_solution(x_val - xi, t, alpha)
 integrand = G * f(xi)
 u[i] = np.trapz(integrand, dx=dxi)

 return u

# Solutions at different times
for t in [0.5, 1.0, 2.0, 5.0]:
 u = convolution_solution(x, t, alpha, initial_condition)
 ax2.plot(x, u, linewidth=2, label=f't = {t}')

# Initial condition
ax2.plot(x, initial_condition(x), 'k--', linewidth=2, alpha=0.5, label='Initial condition')

ax2.grid(True, alpha=0.3)
ax2.set_xlabel('Position x', fontsize=12)
ax2.set_ylabel('Temperature u(x,t)', fontsize=12)
ax2.set_title('General solution by convolution', fontsize=14)
ax2.legend()

plt.tight_layout()
plt.show()

print("=== Properties of fundamental solution ===")
print("- Mass conservation: ‚à´G(x,t)dx = 1")
print("- Spreads over time (diffusion)")
print("- Approaches delta function as t‚Üí0")</div>
 </div>

 <div class="content">
 <h2>2.3 Boundary Value Problems by Separation of Variables</h2>
 <p>
 We solve the heat conduction equation in a finite domain using the method of separation of variables.
 </p>

 <div class="code-title">üíª Code Example 3: Separation of variables solution and Fourier series</div>
 <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# Parameters
L = 10.0
alpha = 0.1
n_modes = 20

x = np.linspace(0, L, 200)

# Initial condition
def initial_temp(x):
 return 100 * np.sin(np.pi * x / L) + 50 * np.sin(2 * np.pi * x / L)

# Fourier coefficients
def compute_fourier_coeff(f, L, n_max):
 coeffs = []
 for n in range(1, n_max+1):
 x_int = np.linspace(0, L, 1000)
 integrand = f(x_int) * np.sin(n * np.pi * x_int / L)
 c_n = (2/L) * np.trapz(integrand, x_int)
 coeffs.append(c_n)
 return coeffs

c_n = compute_fourier_coeff(initial_temp, L, n_modes)
print(f"Fourier coefficients c_n: {c_n[:5]}")

# Separation of variables solution
def separation_solution(x, t, L, alpha, c_n):
 u = np.zeros_like(x)
 for n, c in enumerate(c_n, 1):
 lambda_n = (n * np.pi / L)**2
 u += c * np.sin(n * np.pi * x / L) * np.exp(-alpha * lambda_n * t)
 return u

# Visualization
fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

times = [0, 1, 2, 5, 10, 20]
for idx, t in enumerate(times):
 ax = axes[idx]
 u = separation_solution(x, t, L, alpha, c_n)
 ax.plot(x, u, 'b-', linewidth=2)
 ax.axhline(0, color='gray', linewidth=0.5)
 ax.grid(True, alpha=0.3)
 ax.set_xlabel('Position x', fontsize=11)
 ax.set_ylabel('Temperature u(x,t)', fontsize=11)
 ax.set_title(f't = {t:.1f}', fontsize=12)
 ax.set_ylim(-200, 200)

plt.suptitle('Separation of variables solution: Fourier series expansion', fontsize=14)
plt.tight_layout()
plt.show()

# Mode decay
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# Time decay of modes
t_range = np.linspace(0, 20, 200)
for n in range(1, 6):
 lambda_n = (n * np.pi / L)**2
 amplitude = np.exp(-alpha * lambda_n * t_range)
 ax1.plot(t_range, amplitude, linewidth=2, label=f'Mode {n}')

ax1.grid(True, alpha=0.3)
ax1.set_xlabel('Time t', fontsize=12)
ax1.set_ylabel('Amplitude (normalized)', fontsize=12)
ax1.set_title('Time decay of each mode', fontsize=14)
ax1.legend()

# Decay rates
modes = np.arange(1, 11)
decay_rates = alpha * (modes * np.pi / L)**2

ax2.plot(modes, decay_rates, 'bo-', linewidth=2, markersize=8)
ax2.grid(True, alpha=0.3)
ax2.set_xlabel('Mode number n', fontsize=12)
ax2.set_ylabel('Decay rate $\\alpha\\lambda_n$', fontsize=12)
ax2.set_title('Relationship between decay rate and mode number', fontsize=14)

plt.tight_layout()
plt.show()

print("\nCharacteristics of separation of variables solution:")
print("- Higher-order modes decay faster")
print("- After long time, the fundamental mode (n=1) dominates")
print(f"- Decay time constant of fundamental mode: œÑ = 1/(Œ±Œª‚ÇÅ) = {1/(alpha*(np.pi/L)**2):.2f}")</div>
 </div>

 <div class="content">
 <h2>2.4 Types of Boundary Conditions</h2>
 <p>
 We learn Dirichlet, Neumann, and Robin boundary conditions.
 </p>

 <div class="theorem">
 <strong>üìê Theory</strong><br>
 <p><strong>Types of Boundary Conditions:</strong></p>
 <ul>
 <li><strong>Dirichlet:</strong> $u(0,t) = T_0$ (specified temperature)</li>
 <li><strong>Neumann:</strong> $\frac{\partial u}{\partial x}(0,t) = q_0$ (specified heat flux)</li>
 <li><strong>Robin:</strong> $\frac{\partial u}{\partial x} + hu = 0$ (convective boundary)</li>
 </ul>
 </div>

 <div class="code-title">üíª Code Example 4: Comparison of different boundary conditions</div>
 <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# Parameters
L = 10.0
alpha = 0.1
T_total = 15.0
Nx = 100
Nt = 1500

x = np.linspace(0, L, Nx)
dx = x[1] - x[0]
dt = T_total / Nt
r = alpha * dt / dx**2

# Initial condition
def init_cond(x):
 return 100 * np.exp(-((x - L/2)/2)**2)

# Simulation with 3 types of boundary conditions
cases = {
 'Dirichlet (u=0)': 'dirichlet',
 'Neumann (‚àÇu/‚àÇx=0)': 'neumann',
 'Robin (convection)': 'robin'
}

solutions = {}

for name, bc_type in cases.items():
 u = np.zeros((Nt, Nx))
 u[0] = init_cond(x)

 for n in range(Nt-1):
 for i in range(1, Nx-1):
 u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])

 # Boundary conditions
 if bc_type == 'dirichlet':
 # Temperature fixed at both ends
 u[n+1, 0] = 0
 u[n+1, -1] = 0

 elif bc_type == 'neumann':
 # Insulated at both ends (‚àÇu/‚àÇx = 0)
 u[n+1, 0] = u[n+1, 1]
 u[n+1, -1] = u[n+1, -2]

 elif bc_type == 'robin':
 # Convective boundary conditions (simplified)
 h = 0.5 # convection coefficient
 u[n+1, 0] = (u[n+1, 1] + h*dx*0) / (1 + h*dx)
 u[n+1, -1] = (u[n+1, -2] + h*dx*0) / (1 + h*dx)

 solutions[name] = u

# Visualization
fig, axes = plt.subplots(2, 3, figsize=(16, 10))

times_idx = [0, Nt//5, 2*Nt//5, 3*Nt//5, 4*Nt//5, Nt-1]
t = np.linspace(0, T_total, Nt)

for idx, n in enumerate(times_idx):
 ax = axes[idx//3, idx%3]

 for name, u in solutions.items():
 ax.plot(x, u[n], linewidth=2, label=name, alpha=0.8)

 ax.axhline(0, color='gray', linewidth=0.5)
 ax.grid(True, alpha=0.3)
 ax.set_xlabel('Position x', fontsize=11)
 ax.set_ylabel('Temperature u(x,t)', fontsize=11)
 ax.set_title(f't = {t[n]:.2f}', fontsize=12)
 ax.set_ylim(-10, 110)
 if idx == 0:
 ax.legend()

plt.suptitle('Difference in temperature distribution by boundary condition types', fontsize=14)
plt.tight_layout()
plt.show()

print("=== Physical meaning of boundary conditions ===")
print("Dirichlet: Boundary held at constant temperature (e.g., ice water bath)")
print("Neumann: Insulated boundary (e.g., insulation material)")
print("Robin: Convective boundary (e.g., heat dissipation to air)")</div>
 </div>

 <div class="content">
 <h2>üìù End-of-Chapter Problems</h2>
 <div class="exercise">
 <strong>Exercise Problems</strong>
 <ol>
 <li>For a rod with thermal diffusivity $\alpha = 0.2$ cm¬≤/s and length $L=10$ cm, find the decay time constant of the fundamental mode.</li>
 <li>Find the temperature distribution in equilibrium when the entire system is insulated under Neumann boundary conditions.</li>
 <li>Find the steady state for a 2D square domain where only one edge is at high temperature (others at low temperature).</li>
 <li>Compare the numerical solution using the Crank-Nicolson method with $r=2$ to the explicit method.</li>
 </ol>
 </div>
 </div>

 <div class="nav-buttons">
 <a href="chapter-1.html" class="nav-button">‚Üê Chapter 1</a>
 <a href="chapter-3.html" class="nav-button">Chapter 3 ‚Üí</a>
 </div>
 </div>

 <footer>
 <p>&copy; 2025 AI Terakoya. All rights reserved.</p>
 </footer>
</body>
</html>
