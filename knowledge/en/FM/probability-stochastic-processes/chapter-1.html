<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: Fundamentals of Random Variables and Probability Distributions | Probability Theory and Stochastic Processes</title>
    <meta name="description" content="Learn about discrete and continuous random variables, PMF and PDF, expectation and variance, binomial, Poisson, normal, and exponential distributions.">
            <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <header>
        <h1>Chapter 1: Fundamentals of Random Variables and Probability Distributions</h1>
        <p class="subtitle">Random Variables and Probability Distributions</p>
    </header>

    <div class="container">
                <div class="breadcrumb">
            <a href="../index.html">Fundamentals of Mathematics</a> &gt;
            <a href="index.html">ç¢ºç‡è«–ã¨ç¢ºç‡éç¨‹</a> &gt;
            Chapter 1
        </div>

        <div class="content">
            <h2>1.1 Discrete Random Variables and Probability Mass Functions</h2>

            <div class="definition">
                <strong>ğŸ“ Definition: Discrete Random Variable</strong><br>
                discrete random variable \(X\)  is å¯ç®—å€‹ã®å€¤ \(\{x_1, x_2, \ldots\}\)  takes ç¢ºç‡å¤‰æ•°.<br>
                probability mass functionï¼ˆPMF: Probability Mass Functionï¼‰ã¯ï¼š
                \[P(X = x_i) = p_i, \quad \sum_{i} p_i = 1\]
                å„å€¤ã®ç”Ÿèµ·ç¢ºç‡ã‚’è¡¨.
            </div>

            <h3>ğŸ’» Code Example1: é›¢æ•£ç¢ºç‡åˆ†å¸ƒã®visualization</h3>
            <div class="code-block">import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# ã‚µã‚¤ã‚³ãƒ­ã®ä¾‹ï¼ˆä¸€æ§˜é›¢æ•£åˆ†å¸ƒï¼‰
outcomes = np.arange(1, 7)  # 1ã‹ã‚‰6
probabilities = np.ones(6) / 6  # å„é¢ã®ç¢ºç‡ã¯1/6

fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# PMFã®æ£’ã‚°ãƒ©ãƒ•
axes[0].bar(outcomes, probabilities, color='#667eea', alpha=0.7, edgecolor='black')
axes[0].set_xlabel('çµæœ (x)', fontsize=12)
axes[0].set_ylabel('ç¢ºç‡ P(X=x)', fontsize=12)
axes[0].set_title('ã‚µã‚¤ã‚³ãƒ­ã®probability mass functionï¼ˆPMFï¼‰', fontsize=14, fontweight='bold')
axes[0].set_xticks(outcomes)
axes[0].grid(axis='y', alpha=0.3)

# cumulative distribution functionï¼ˆCDFï¼‰
cdf = np.cumsum(probabilities)
axes[1].step(outcomes, cdf, where='post', color='#764ba2', linewidth=2)
axes[1].scatter(outcomes, cdf, color='#764ba2', s=50, zorder=5)
axes[1].set_xlabel('çµæœ (x)', fontsize=12)
axes[1].set_ylabel('ç´¯ç©ç¢ºç‡ P(Xâ‰¤x)', fontsize=12)
axes[1].set_title('cumulative distribution functionï¼ˆCDFï¼‰', fontsize=14, fontweight='bold')
axes[1].set_xticks(outcomes)
axes[1].grid(alpha=0.3)
axes[1].set_ylim([0, 1.1])

plt.tight_layout()
plt.show()

# expectationã¨varianceã®è¨ˆç®—
E_X = np.sum(outcomes * probabilities)
E_X2 = np.sum(outcomes**2 * probabilities)
Var_X = E_X2 - E_X**2

print("ã‚µã‚¤ã‚³ãƒ­ã®çµ±è¨ˆé‡:")
print(f"expectation E[X] = {E_X:.4f}")
print(f"variance Var(X) = {Var_X:.4f}")
print(f"standard deviation Ïƒ = {np.sqrt(Var_X):.4f}")</div>

            <div class="output">ã‚µã‚¤ã‚³ãƒ­ã®çµ±è¨ˆé‡:
expectation E[X] = 3.5000
variance Var(X) = 2.9167
standard deviation Ïƒ = 1.7078</div>

            <h2>1.2 Continuous Random Variables and Probability Density Functions</h2>

            <div class="definition">
                <strong>ğŸ“ Definition: Continuous Random Variable</strong><br>
                continuous random variable \(X\) ã¯å®Ÿæ•°å€¤ã‚’å–ã‚Šã€probability density functionï¼ˆPDF: Probability Density Functionï¼‰\(f(x)\) ã«ã‚ˆã£ã¦ç‰¹å¾´ä»˜ã‘ã‚‰ã‚Œã¾ã™ï¼š
                \[P(a \leq X \leq b) = \int_a^b f(x) \, dx, \quad \int_{-\infty}^{\infty} f(x) \, dx = 1\]
                cumulative distribution functionï¼ˆCDFï¼‰ã¯ï¼š
                \[F(x) = P(X \leq x) = \int_{-\infty}^x f(t) \, dt\]
            </div>

            <h3>ğŸ’» Code Example2: é€£ç¶šç¢ºç‡åˆ†å¸ƒã¨PDF/CDF</h3>
            <div class="code-block"># uniform distribution U(0, 1)ã®ä¾‹
x = np.linspace(-0.5, 1.5, 1000)
uniform_dist = stats.uniform(loc=0, scale=1)

pdf = uniform_dist.pdf(x)
cdf = uniform_dist.cdf(x)

fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# PDF
axes[0].plot(x, pdf, color='#667eea', linewidth=2.5, label='PDF')
axes[0].fill_between(x, 0, pdf, where=(x >= 0.3) & (x <= 0.7),
                       alpha=0.3, color='#764ba2', label='P(0.3 â‰¤ X â‰¤ 0.7)')
axes[0].set_xlabel('x', fontsize=12)
axes[0].set_ylabel('f(x)', fontsize=12)
axes[0].set_title('uniform distribution U(0,1) ã®probability density function', fontsize=14, fontweight='bold')
axes[0].legend(fontsize=10)
axes[0].grid(alpha=0.3)
axes[0].set_ylim([0, 1.5])

# CDF
axes[1].plot(x, cdf, color='#764ba2', linewidth=2.5)
axes[1].axhline(y=0.7, color='red', linestyle='--', alpha=0.5, label='P(Xâ‰¤0.7) = 0.7')
axes[1].axvline(x=0.7, color='red', linestyle='--', alpha=0.5)
axes[1].set_xlabel('x', fontsize=12)
axes[1].set_ylabel('F(x)', fontsize=12)
axes[1].set_title('cumulative distribution functionï¼ˆCDFï¼‰', fontsize=14, fontweight='bold')
axes[1].legend(fontsize=10)
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# ç¢ºç‡è¨ˆç®—
prob = uniform_dist.cdf(0.7) - uniform_dist.cdf(0.3)
print(f"P(0.3 â‰¤ X â‰¤ 0.7) = {prob:.4f}")</div>

            <div class="output">P(0.3 â‰¤ X â‰¤ 0.7) = 0.4000</div>

            <h2>1.3 Expectation, Variance, and Moments</h2>

            <div class="theorem">
                <strong>ğŸ“Š Theorem: Expectation and Variance</strong><br>
                <strong>expectationï¼ˆå¹³å‡ï¼‰:</strong>
                \[E[X] = \sum_i x_i p_i \quad (\text{é›¢æ•£}), \quad E[X] = \int_{-\infty}^{\infty} x f(x) \, dx \quad (\text{é€£ç¶š})\]

                <strong>variance:</strong>
                \[Var(X) = E[(X - E[X])^2] = E[X^2] - (E[X])^2\]

                <strong>kæ¬¡moment:</strong>
                \[E[X^k] = \sum_i x_i^k p_i \quad (\text{é›¢æ•£}), \quad E[X^k] = \int_{-\infty}^{\infty} x^k f(x) \, dx \quad (\text{é€£ç¶š})\]
            </div>

            <h3>ğŸ’» Code Example3: expectationã¨varianceã®è¨ˆç®—</h3>
            <div class="code-block"># è¤‡æ•°ã®åˆ†å¸ƒã®expectationãƒ»varianceã‚’è¨ˆç®—
distributions = {
    'uniform distribution U(0,1)': stats.uniform(0, 1),
    'normal distribution N(5,2Â²)': stats.norm(5, 2),
    'exponential distribution Exp(Î»=1)': stats.expon(scale=1),
    'beta distribution Beta(2,5)': stats.beta(2, 5)
}

print("å„åˆ†å¸ƒã®expectationã¨variance:\n" + "="*50)
for name, dist in distributions.items():
    mean = dist.mean()
    var = dist.var()
    std = dist.std()

    # kæ¬¡momentï¼ˆk=3,4ï¼‰ã®è¨ˆç®—
    if hasattr(dist, 'moment'):
        third_moment = dist.moment(3)
        fourth_moment = dist.moment(4)
    else:
        third_moment = np.nan
        fourth_moment = np.nan

    print(f"\n{name}:")
    print(f"  expectation E[X]  = {mean:.4f}")
    print(f"  variance Var(X) = {var:.4f}")
    print(f"  standard deviation Ïƒ  = {std:.4f}")

# visualization
fig, axes = plt.subplots(2, 2, figsize=(14, 10))
axes = axes.flatten()

x_ranges = [
    np.linspace(0, 1, 500),
    np.linspace(-1, 11, 500),
    np.linspace(0, 6, 500),
    np.linspace(0, 1, 500)
]

for i, ((name, dist), x_range) in enumerate(zip(distributions.items(), x_ranges)):
    pdf = dist.pdf(x_range)
    mean = dist.mean()
    std = dist.std()

    axes[i].plot(x_range, pdf, color='#667eea', linewidth=2.5, label='PDF')
    axes[i].axvline(mean, color='red', linestyle='--', linewidth=2, label=f'E[X]={mean:.2f}')
    axes[i].axvline(mean - std, color='orange', linestyle=':', alpha=0.7, label=f'Ïƒ={std:.2f}')
    axes[i].axvline(mean + std, color='orange', linestyle=':', alpha=0.7)
    axes[i].fill_between(x_range, 0, pdf, alpha=0.2, color='#764ba2')

    axes[i].set_xlabel('x', fontsize=11)
    axes[i].set_ylabel('f(x)', fontsize=11)
    axes[i].set_title(name, fontsize=12, fontweight='bold')
    axes[i].legend(fontsize=9)
    axes[i].grid(alpha=0.3)

plt.tight_layout()
plt.show()</div>

            <h2>1.4 Binomial and Poisson Distributions</h2>

            <div class="definition">
                <strong>ğŸ“ Definition: Binomial and Poisson Distributions</strong><br>

                <strong>binomial distribution \(B(n, p)\):</strong> nå›ã®ç‹¬ç«‹è©¦è¡Œã§æˆåŠŸç¢ºç‡pã®ã¨ãã€æˆåŠŸå›æ•°Xã®åˆ†å¸ƒ
                \[P(X = k) = \binom{n}{k} p^k (1-p)^{n-k}, \quad E[X] = np, \quad Var(X) = np(1-p)\]

                <strong>Poisson distribution \(Pois(\lambda)\):</strong> å˜ä½æ™‚é–“ã‚ãŸã‚Šã®å¹³å‡ç™ºç”Ÿå›æ•°Î»ã®ã¨ã
                \[P(X = k) = \frac{\lambda^k e^{-\lambda}}{k!}, \quad E[X] = Var(X) = \lambda\]

                Poisson distributionã¯binomial distributionã®æ¥µé™ï¼ˆ\(n \to \infty, p \to 0, np = \lambda\)ï¼‰ã¨ã—ã¦å¾—.
            </div>

            <h3>ğŸ’» Code Example4: Binomial and Poisson Distributionsã®æ¯”è¼ƒ</h3>
            <div class="code-block"># Binomial and Poisson Distributionsã®æ¯”è¼ƒ
n = 100  # è©¦è¡Œå›æ•°
p = 0.03  # æˆåŠŸç¢ºç‡
lam = n * p  # Î» = np = 3

binomial = stats.binom(n, p)
poisson = stats.poisson(lam)

k = np.arange(0, 15)

fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# PMFã®æ¯”è¼ƒ
axes[0].bar(k - 0.2, binomial.pmf(k), width=0.4, alpha=0.7,
            color='#667eea', label=f'binomial distribution B({n},{p})')
axes[0].bar(k + 0.2, poisson.pmf(k), width=0.4, alpha=0.7,
            color='#764ba2', label=f'Poisson distribution Pois({lam})')
axes[0].set_xlabel('k (æˆåŠŸå›æ•°)', fontsize=12)
axes[0].set_ylabel('ç¢ºç‡ P(X=k)', fontsize=12)
axes[0].set_title('Binomial and Poisson Distributionsã®æ¯”è¼ƒ', fontsize=14, fontweight='bold')
axes[0].legend(fontsize=10)
axes[0].grid(axis='y', alpha=0.3)

# errorã®visualization
error = np.abs(binomial.pmf(k) - poisson.pmf(k))
axes[1].bar(k, error, color='red', alpha=0.6)
axes[1].set_xlabel('k', fontsize=12)
axes[1].set_ylabel('|P_binomial - P_poisson|', fontsize=12)
axes[1].set_title('è¿‘ä¼¼error', fontsize=14, fontweight='bold')
axes[1].grid(axis='y', alpha=0.3)

plt.tight_layout()
plt.show()

# çµ±è¨ˆé‡ã®æ¯”è¼ƒ
print("çµ±è¨ˆé‡ã®æ¯”è¼ƒ:")
print(f"binomial distribution:   E[X]={binomial.mean():.4f}, Var(X)={binomial.var():.4f}")
print(f"Poisson distribution: E[X]={poisson.mean():.4f}, Var(X)={poisson.var():.4f}")

# materials scienceã¸ã®application exampleï¼šdefectã®ç™ºç”Ÿç¢ºç‡
print("\nã€materials scienceã¸ã®application exampleã€‘")
print("è–„è†œæˆè†œãƒ—ãƒ­ã‚»ã‚¹ã§ã€1cmÂ²ã‚ãŸã‚Šå¹³å‡3å€‹ã®defectãŒç™ºç”Ÿã™ã‚‹ã¨ãï¼š")
area = 5  # cmÂ²
lam_defects = 3 * area
poisson_defects = stats.poisson(lam_defects)

print(f"5cmÂ²é ˜åŸŸã§10å€‹ä»¥ä¸‹ã®defectãŒç™ºç”Ÿã™ã‚‹ç¢ºç‡: {poisson_defects.cdf(10):.4f}")
print(f"5cmÂ²é ˜åŸŸã§15å€‹ä»¥ä¸Šã®defectãŒç™ºç”Ÿã™ã‚‹ç¢ºç‡: {1 - poisson_defects.cdf(14):.4f}")</div>

            <div class="output">çµ±è¨ˆé‡ã®æ¯”è¼ƒ:
binomial distribution:   E[X]=3.0000, Var(X)=2.9100
Poisson distribution: E[X]=3.0000, Var(X)=3.0000

ã€materials scienceã¸ã®application exampleã€‘
è–„è†œæˆè†œãƒ—ãƒ­ã‚»ã‚¹ã§ã€1cmÂ²ã‚ãŸã‚Šå¹³å‡3å€‹ã®defectãŒç™ºç”Ÿã™ã‚‹ã¨ãï¼š
5cmÂ²é ˜åŸŸã§10å€‹ä»¥ä¸‹ã®defectãŒç™ºç”Ÿã™ã‚‹ç¢ºç‡: 0.1185
5cmÂ²é ˜åŸŸã§15å€‹ä»¥ä¸Šã®defectãŒç™ºç”Ÿã™ã‚‹ç¢ºç‡: 0.5289</div>

            <h2>1.5 Normal Distribution (Gaussian Distribution)</h2>

            <div class="definition">
                <strong>ğŸ“ Definition: Normal Distribution</strong><br>
                normal distribution \(N(\mu, \sigma^2)\) ã®probability density functionï¼š
                \[f(x) = \frac{1}{\sqrt{2\pi\sigma^2}} \exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)\]

                expectation \(E[X] = \mu\), variance \(Var(X) = \sigma^2\)<br>

                <strong>standard normal distribution:</strong> \(N(0, 1)\) ã¯ \(\mu=0, \sigma=1\) ã®normal distribution<br>
                ä»»æ„ã®normal distributionã¯standardizationå¤‰æ› \(Z = \frac{X - \mu}{\sigma}\) ã§standard normal distributionã«å¤‰æ›ã§ã.
            </div>

            <h3>ğŸ’» Code Example5: normal distributionã®æ€§è³ªã¨å¿œç”¨</h3>
            <div class="code-block"># normal distributionã®visualization
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# (1) ç•°ãªã‚‹Î¼ã®åŠ¹æœ
x = np.linspace(-10, 10, 1000)
mus = [0, 2, -2]
sigma = 1

axes[0, 0].set_title('å¹³å‡Î¼ã®åŠ¹æœï¼ˆÏƒ=1å›ºå®šï¼‰', fontsize=12, fontweight='bold')
for mu in mus:
    dist = stats.norm(mu, sigma)
    axes[0, 0].plot(x, dist.pdf(x), linewidth=2, label=f'Î¼={mu}')
axes[0, 0].set_xlabel('x', fontsize=11)
axes[0, 0].set_ylabel('f(x)', fontsize=11)
axes[0, 0].legend()
axes[0, 0].grid(alpha=0.3)

# (2) ç•°ãªã‚‹Ïƒã®åŠ¹æœ
mu = 0
sigmas = [0.5, 1, 2]

axes[0, 1].set_title('standard deviationÏƒã®åŠ¹æœï¼ˆÎ¼=0å›ºå®šï¼‰', fontsize=12, fontweight='bold')
for sigma in sigmas:
    dist = stats.norm(mu, sigma)
    axes[0, 1].plot(x, dist.pdf(x), linewidth=2, label=f'Ïƒ={sigma}')
axes[0, 1].set_xlabel('x', fontsize=11)
axes[0, 1].set_ylabel('f(x)', fontsize=11)
axes[0, 1].legend()
axes[0, 1].grid(alpha=0.3)

# (3) 68-95-99.7ãƒ«ãƒ¼ãƒ«ï¼ˆ3Ïƒãƒ«ãƒ¼ãƒ«ï¼‰
mu, sigma = 0, 1
dist = stats.norm(mu, sigma)
x_range = np.linspace(-4, 4, 1000)

axes[1, 0].plot(x_range, dist.pdf(x_range), 'black', linewidth=2)
axes[1, 0].fill_between(x_range, 0, dist.pdf(x_range),
                         where=(x_range >= -sigma) & (x_range <= sigma),
                         alpha=0.3, color='green', label='68% (Â±1Ïƒ)')
axes[1, 0].fill_between(x_range, 0, dist.pdf(x_range),
                         where=((x_range >= -2*sigma) & (x_range < -sigma)) |
                               ((x_range > sigma) & (x_range <= 2*sigma)),
                         alpha=0.3, color='yellow', label='95% (Â±2Ïƒ)')
axes[1, 0].fill_between(x_range, 0, dist.pdf(x_range),
                         where=((x_range >= -3*sigma) & (x_range < -2*sigma)) |
                               ((x_range > 2*sigma) & (x_range <= 3*sigma)),
                         alpha=0.3, color='orange', label='99.7% (Â±3Ïƒ)')
axes[1, 0].set_title('68-95-99.7ãƒ«ãƒ¼ãƒ«ï¼ˆ3Ïƒãƒ«ãƒ¼ãƒ«ï¼‰', fontsize=12, fontweight='bold')
axes[1, 0].set_xlabel('x', fontsize=11)
axes[1, 0].set_ylabel('f(x)', fontsize=11)
axes[1, 0].legend(fontsize=9)
axes[1, 0].grid(alpha=0.3)

# (4) standardizationã¨ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«
standard_normal = stats.norm(0, 1)
percentiles = [0.01, 0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99]
z_values = [standard_normal.ppf(p) for p in percentiles]

axes[1, 1].plot(x_range, standard_normal.pdf(x_range), 'black', linewidth=2)
for p, z in zip(percentiles, z_values):
    axes[1, 1].axvline(z, color='red', linestyle='--', alpha=0.5)
    axes[1, 1].text(z, 0.4, f'{int(p*100)}%', fontsize=8, ha='center')
axes[1, 1].set_title('standard normal distributionã®ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«', fontsize=12, fontweight='bold')
axes[1, 1].set_xlabel('z', fontsize=11)
axes[1, 1].set_ylabel('Ï†(z)', fontsize=11)
axes[1, 1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# ç¢ºç‡è¨ˆç®—
print("normal distribution N(100, 15Â²) ã«ãŠã‘ã‚‹ç¢ºç‡è¨ˆç®—:")
mu, sigma = 100, 15
exam_scores = stats.norm(mu, sigma)

print(f"P(X â‰¥ 120) = {1 - exam_scores.cdf(120):.4f}")
print(f"P(85 â‰¤ X â‰¤ 115) = {exam_scores.cdf(115) - exam_scores.cdf(85):.4f}")

# standardization
x_value = 120
z_score = (x_value - mu) / sigma
print(f"\nX=120ã®z-score: z = {z_score:.4f}")
print(f"P(Z â‰¥ {z_score:.4f}) = {1 - standard_normal.cdf(z_score):.4f}")</div>

            <h2>1.6 Exponential Distribution and Waiting Time Problems</h2>

            <div class="definition">
                <strong>ğŸ“ Definition: Exponential Distribution</strong><br>
                exponential distribution \(Exp(\lambda)\)  is Poisson processã«ãŠã‘ã‚‹äº‹è±¡é–“ã®waiting timeã‚’è¡¨ã—ã¾ã™ï¼š
                \[f(x) = \lambda e^{-\lambda x} \quad (x \geq 0), \quad F(x) = 1 - e^{-\lambda x}\]

                expectation \(E[X] = \frac{1}{\lambda}\), variance \(Var(X) = \frac{1}{\lambda^2}\)<br>

                <strong>memoryless property:</strong> \(P(X > s+t \mid X > s) = P(X > t)\)ï¼ˆéå»ã®æƒ…å ±ãŒæœªæ¥ã«å½±éŸ¿ã—ãªã„ï¼‰
            </div>

            <h3>ğŸ’» Code Example6: Exponential Distribution and Waiting Time Problems</h3>
            <div class="code-block"># exponential distributionã®simulation
lambda_rate = 0.5  # å¹³å‡arrival rateï¼ˆ1æ™‚é–“ã‚ãŸã‚Š0.5å› = 2æ™‚é–“ã«1å›ï¼‰
exp_dist = stats.expon(scale=1/lambda_rate)

# PDF, CDFã®visualization
x = np.linspace(0, 10, 1000)
pdf = exp_dist.pdf(x)
cdf = exp_dist.cdf(x)

fig, axes = plt.subplots(1, 3, figsize=(16, 5))

# (1) PDFã¨CDF
axes[0].plot(x, pdf, color='#667eea', linewidth=2.5, label='PDF')
axes[0].fill_between(x, 0, pdf, alpha=0.2, color='#667eea')
axes[0].set_xlabel('æ™‚é–“ (æ™‚é–“)', fontsize=11)
axes[0].set_ylabel('f(x)', fontsize=11)
axes[0].set_title('exponential distributionã®probability density function', fontsize=12, fontweight='bold')
axes[0].grid(alpha=0.3)
axes[0].legend()

axes[1].plot(x, cdf, color='#764ba2', linewidth=2.5, label='CDF')
axes[1].axhline(y=0.5, color='red', linestyle='--', alpha=0.5, label='ä¸­å¤®å€¤')
median = exp_dist.median()
axes[1].axvline(x=median, color='red', linestyle='--', alpha=0.5)
axes[1].set_xlabel('æ™‚é–“ (æ™‚é–“)', fontsize=11)
axes[1].set_ylabel('F(x)', fontsize=11)
axes[1].set_title('cumulative distribution function', fontsize=12, fontweight='bold')
axes[1].grid(alpha=0.3)
axes[1].legend()

# (2) memoryless propertyã®verification
# P(X > 3+2 | X > 3) = P(X > 2)ã‚’ç¢ºèª
t = 2
s = 3

prob_uncond = 1 - exp_dist.cdf(t)  # P(X > 2)
prob_cond = (1 - exp_dist.cdf(s+t)) / (1 - exp_dist.cdf(s))  # P(X > 5 | X > 3)

print("memoryless propertyã®verification:")
print(f"P(X > {t}) = {prob_uncond:.6f}")
print(f"P(X > {s+t} | X > {s}) = {prob_cond:.6f}")
print(f"å·®: {abs(prob_uncond - prob_cond):.10f}")

# (3) simulation
np.random.seed(42)
n_simulations = 10000
samples = exp_dist.rvs(size=n_simulations)

axes[2].hist(samples, bins=50, density=True, alpha=0.6,
             color='#764ba2', edgecolor='black', label='simulation')
axes[2].plot(x, pdf, color='#667eea', linewidth=2.5, label='ç†è«–PDF')
axes[2].set_xlabel('æ™‚é–“ (æ™‚é–“)', fontsize=11)
axes[2].set_ylabel('å¯†åº¦', fontsize=11)
axes[2].set_title(f'simulation (n={n_simulations})', fontsize=12, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# çµ±è¨ˆé‡
print(f"\nç†è«–å€¤: E[X]={exp_dist.mean():.4f}, Var(X)={exp_dist.var():.4f}")
print(f"å®Ÿæ¸¬å€¤: E[X]={np.mean(samples):.4f}, Var(X)={np.var(samples):.4f}")

# materials scienceã¸ã®å¿œç”¨ï¼šè£…ç½®failureé–“éš”
print("\nã€materials scienceã¸ã®application exampleã€‘")
print("è£½é€ è£…ç½®ã®failureé–“éš”ãŒexponential distributionExp(Î»=0.1 [1/æ—¥])ã«å¾“ã†ã¨ãï¼š")
lambda_failure = 0.1
failure_dist = stats.expon(scale=1/lambda_failure)

print(f"å¹³å‡failureé–“éš”ï¼ˆMTBFï¼‰: {failure_dist.mean():.2f} æ—¥")
print(f"7æ—¥ä»¥å†…ã«failureã™ã‚‹ç¢ºç‡: {failure_dist.cdf(7):.4f}")
print(f"30æ—¥ä»¥ä¸Šfailureã—ãªã„ç¢ºç‡: {1 - failure_dist.cdf(30):.4f}")</div>

            <div class="output">memoryless propertyã®verification:
P(X > 2) = 0.367879
P(X > 5 | X > 3) = 0.367879
å·®: 0.0000000000

ç†è«–å€¤: E[X]=2.0000, Var(X)=4.0000
å®Ÿæ¸¬å€¤: E[X]=2.0124, Var(X)=4.0346

ã€materials scienceã¸ã®application exampleã€‘
è£½é€ è£…ç½®ã®failureé–“éš”ãŒexponential distributionExp(Î»=0.1 [1/æ—¥])ã«å¾“ã†ã¨ãï¼š
å¹³å‡failureé–“éš”ï¼ˆMTBFï¼‰: 10.00 æ—¥
7æ—¥ä»¥å†…ã«failureã™ã‚‹ç¢ºç‡: 0.5034
30æ—¥ä»¥ä¸Šfailureã—ãªã„ç¢ºç‡: 0.0498</div>

            <h2>1.7 Utilizing Statistical Distributions with scipy.stats</h2>

            <h3>ğŸ’» Code Example7: Utilizing Statistical Distributions with scipy.stats</h3>
            <div class="code-block"># scipy.statsã§åˆ©ç”¨å¯èƒ½ãªæ§˜ã€…ãªåˆ†å¸ƒ
from scipy.stats import (
    bernoulli, binom, poisson, geom,  # é›¢æ•£åˆ†å¸ƒ
    uniform, norm, expon, gamma, beta, weibull_min  # é€£ç¶šåˆ†å¸ƒ
)

# çµ±ä¸€çš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
distributions = {
    'Bernoulli': bernoulli(p=0.3),
    'äºŒé …': binom(n=10, p=0.3),
    'ãƒã‚¢ã‚½ãƒ³': poisson(mu=3),
    'geometric': geom(p=0.3),
    'ä¸€æ§˜': uniform(loc=0, scale=1),
    'æ­£è¦': norm(loc=0, scale=1),
    'æŒ‡æ•°': expon(scale=2),
    'ã‚¬ãƒ³ãƒ': gamma(a=2, scale=2),
    'ãƒ™ãƒ¼ã‚¿': beta(a=2, b=5),
    'ãƒ¯ã‚¤ãƒ–ãƒ«': weibull_min(c=1.5, scale=1)
}

print("scipy.stats ã«ã‚ˆã‚‹çµ±è¨ˆåˆ†å¸ƒã®æ“ä½œ:\n" + "="*60)

# å„åˆ†å¸ƒã®ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰
example_dist = norm(loc=5, scale=2)
print("\nä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆnormal distribution N(5, 2Â²) ã®ä¾‹ï¼‰:")
print(f"  .mean()      å¹³å‡: {example_dist.mean():.4f}")
print(f"  .var()       variance: {example_dist.var():.4f}")
print(f"  .std()       standard deviation: {example_dist.std():.4f}")
print(f"  .pdf(6)      ç¢ºç‡å¯†åº¦ï¼ˆx=6ï¼‰: {example_dist.pdf(6):.6f}")
print(f"  .cdf(7)      ç´¯ç©ç¢ºç‡ï¼ˆxâ‰¤7ï¼‰: {example_dist.cdf(7):.6f}")
print(f"  .ppf(0.95)   95%ç‚¹: {example_dist.ppf(0.95):.4f}")
print(f"  .rvs(5)      ä¹±æ•°ç”Ÿæˆï¼ˆ5å€‹ï¼‰: {example_dist.rvs(5)}")

# å„åˆ†å¸ƒã®ç‰¹æ€§
print("\n\nå„åˆ†å¸ƒã®çµ±è¨ˆé‡:")
print(f"{'åˆ†å¸ƒå':<12} {'å¹³å‡':>10} {'variance':>10} {'æ­ªåº¦':>10} {'å°–åº¦':>10}")
print("="*60)
for name, dist in distributions.items():
    try:
        mean = dist.mean()
        var = dist.var()
        skew = dist.stats(moments='s')
        kurt = dist.stats(moments='k')
        print(f"{name:<12} {mean:>10.4f} {var:>10.4f} {skew:>10.4f} {kurt:>10.4f}")
    except:
        print(f"{name:<12} (è¨ˆç®—ä¸å¯)")

# åˆ†ä½ç‚¹ã®è¨ˆç®—ï¼ˆconfidence intervalãªã©ï¼‰
print("\n\nnormal distribution N(0,1) ã®åˆ†ä½ç‚¹:")
alpha_levels = [0.90, 0.95, 0.99]
standard_normal = norm(0, 1)

for alpha in alpha_levels:
    lower = standard_normal.ppf((1-alpha)/2)
    upper = standard_normal.ppf((1+alpha)/2)
    print(f"{int(alpha*100)}% confidence interval: [{lower:.4f}, {upper:.4f}]")

# é©åˆåº¦æ¤œå®šï¼ˆKolmogorov-Smirnovæ¤œå®šï¼‰
from scipy.stats import kstest

np.random.seed(42)
sample_data = norm(loc=10, scale=2).rvs(1000)

# ä»®èª¬: ãƒ‡ãƒ¼ã‚¿ã¯ N(10, 2Â²) ã«å¾“ã†
ks_stat, p_value = kstest(sample_data, lambda x: norm(10, 2).cdf(x))

print(f"\n\nKolmogorov-Smirnov é©åˆåº¦æ¤œå®š:")
print(f"æ¤œå®šçµ±è¨ˆé‡: {ks_stat:.6f}")
print(f"på€¤: {p_value:.6f}")
print(f"çµè«–: {'å¸°ç„¡ä»®èª¬ã‚’æ£„å´ã§ããªã„ï¼ˆåˆ†å¸ƒã¯é©åˆï¼‰' if p_value > 0.05 else 'å¸°ç„¡ä»®èª¬ã‚’æ£„å´ï¼ˆåˆ†å¸ƒã¯ä¸é©åˆï¼‰'}")

# materials scienceã¸ã®å¿œç”¨ï¼šææ–™å¼·åº¦ã®Weibull distributionè§£æ
print("\n\nã€materials scienceã¸ã®application exampleã€‘ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã®å¼·åº¦åˆ†å¸ƒï¼ˆWeibull distributionï¼‰:")
shape_param = 10  # å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆå¤§ãã„ã»ã©å‡ä¸€ï¼‰
scale_param = 500  # å°ºåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆç‰¹æ€§å¼·åº¦ï¼‰

weibull = weibull_min(c=shape_param, scale=scale_param)

print(f"Weibull distribution: shape={shape_param}, scale={scale_param} MPa")
print(f"å¹³å‡å¼·åº¦: {weibull.mean():.2f} MPa")
print(f"standard deviation: {weibull.std():.2f} MPa")
print(f"450 MPaä»¥ä¸‹ã§ç ´å£Šã™ã‚‹ç¢ºç‡: {weibull.cdf(450):.4f}")
print(f"è¨­è¨ˆå¼·åº¦ï¼ˆ99%ä¿¡é ¼æ€§ï¼‰: {weibull.ppf(0.01):.2f} MPa")</div>

            <div class="note">
                <strong>ğŸ’¡ Note:</strong> scipy.statsã¯70ä»¥ä¸Šã®ç¢ºç‡åˆ†å¸ƒã‚’æä¾›ã—ã€çµ±ä¸€çš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆpdf, cdf, ppf, rvs, mean, varç­‰ï¼‰ã§æ“ä½œã§ã.materials scienceã§ is Weibull distributionï¼ˆè„†æ€§ææ–™ã®å¼·åº¦ï¼‰ã€lognormal distributionï¼ˆç²’å¾„åˆ†å¸ƒï¼‰ã€gamma distributionï¼ˆwaiting timeï¼‰ãªã©ãŒã‚ˆãä½¿ã‚ã‚Œ.
            </div>

            <h2>Exercises</h2>

            <div class="exercise">
                <strong>ğŸ“ Exercise1: quality controlã«ãŠã‘ã‚‹çµ±è¨ˆåˆ†å¸ƒ</strong><br>
                ã‚ã‚‹è£½å“ã®ä¸è‰¯ç‡ãŒ2%ã§ã‚ã‚‹ã¨ãã€100å€‹ã®è£½å“ãƒ­ãƒƒãƒˆã‹ã‚‰ï¼š
                <ol>
                    <li>Binomial and Poisson Distributionsã§ä¸è‰¯å“æ•°ã®åˆ†å¸ƒã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã—ã€æ¯”è¼ƒã›ã‚ˆ</li>
                    <li>3å€‹ä»¥ä¸Šã®ä¸è‰¯å“ãŒå«ã¾ã‚Œã‚‹ç¢ºç‡ã‚’è¨ˆç®—ã›ã‚ˆ</li>
                    <li>ä¸è‰¯å“æ•°ãŒexpectationÂ±1standard deviationã®ç¯„å›²å†…ã«å…¥ã‚‹ç¢ºç‡ã‚’æ±‚ã‚ã‚ˆ</li>
                </ol>
            </div>

            <div class="exercise">
                <strong>ğŸ“ Exercise2: normal distributionã«ã‚ˆã‚‹measurementerrorè§£æ</strong><br>
                measurementè£…ç½®ã®errorãŒnormal distribution N(0, 0.5Â²) ã«å¾“ã†ã¨ãï¼š
                <ol>
                    <li>errorãŒÂ±1 mmä»¥å†…ã«åã¾ã‚‹ç¢ºç‡ã‚’è¨ˆç®—ã›ã‚ˆ</li>
                    <li>95%confidence intervalã‚’æ±‚ã‚ã‚ˆ</li>
                    <li>errorã®çµ¶å¯¾å€¤ãŒ0.8 mmã‚’è¶…ãˆã‚‹ç¢ºç‡ã‚’è¨ˆç®—ã›ã‚ˆ</li>
                </ol>
            </div>

            <div class="exercise">
                <strong>ğŸ“ Exercise3: exponential distributionã«ã‚ˆã‚‹failureè§£æ</strong><br>
                é›»å­éƒ¨å“ã®å¯¿å‘½ãŒexponential distribution Exp(Î»=0.001 [1/æ™‚é–“]) ã«å¾“ã†ã¨ãï¼š
                <ol>
                    <li>å¹³å‡å¯¿å‘½ï¼ˆMTBFï¼‰ã‚’è¨ˆç®—ã›ã‚ˆ</li>
                    <li>1000æ™‚é–“ä»¥ä¸Šå‹•ä½œã™ã‚‹ç¢ºç‡ã‚’æ±‚ã‚ã‚ˆ</li>
                    <li>memoryless propertyã‚’åˆ©ç”¨ã—ã¦ã€æ—¢ã«500æ™‚é–“å‹•ä½œã—ãŸéƒ¨å“ãŒã€ã•ã‚‰ã«1000æ™‚é–“ä»¥ä¸Šå‹•ä½œã™ã‚‹ç¢ºç‡ã‚’è¨ˆç®—ã›ã‚ˆ</li>
                </ol>
            </div>

            <div class="nav-buttons">
                <a href="index.html" class="nav-button">â† Series Top</a>
                <a href="chapter-2.html" class="nav-button">To Chapter 2 â†’</a>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - Fundamentals of Mathematics & Physics Dojo</p>
    </footer>
</body>
</html>
