<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 2: Determinants and Systems of Linear Equations | Linear Algebra and Tensor Analysis</title>
    <meta name="description" content="Learn determinant calculation, Cramer's rule, Gaussian elimination, LU decomposition, rank and existence conditions for solutions.">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>
</head>
<body>
    <header>
        <h1>Chapter 2: Determinants and Systems of Linear Equations</h1>
        <p class="subtitle">Determinants and Systems of Linear Equations</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">Fundamentals of Mathematics Dojo</a> &gt;
            <a href="index.html">Linear Algebra and Tensor Analysis</a> &gt;
            Chapter 2
        </div>

        <div class="content">
            <h2>2.1 Definition and Calculation of Determinants</h2>

            <div class="definition">
                <strong>Definition: Determinant</strong><br>
                The determinant det(A) or |A| of an n×n square matrix A is a scalar value satisfying the following properties:<br>
                2×2 matrix: $\det\begin{pmatrix}a&b\\c&d\end{pmatrix} = ad - bc$<br>
                3×3 matrix: calculated using Sarrus's rule or cofactor expansion
            </div>

            <h3>Code Example 1: Calculating Determinants</h3>
            <div class="code-title">Python Implementation: Calculating Determinants</div>
            <div class="code-example">import numpy as np

# 2×2 matrix determinant
A_2x2 = np.array([[3, 8],
                  [4, 6]])

det_A = np.linalg.det(A_2x2)
det_manual = 3*6 - 8*4  # ad - bc

print("2×2 Matrix Determinant:")
print(f"A =\n{A_2x2}")
print(f"det(A) = {det_A:.4f}")
print(f"Manual calculation: 3×6 - 8×4 = {det_manual}")

# 3×3 matrix determinant
A_3x3 = np.array([[1, 2, 3],
                  [4, 5, 6],
                  [7, 8, 9]])

det_A_3x3 = np.linalg.det(A_3x3)
print(f"\n3×3 Matrix Determinant:")
print(f"A =\n{A_3x3}")
print(f"det(A) = {det_A_3x3:.10f}")
print("det(A) ≈ 0 so singular matrix (no inverse)")</div>

            <div class="theorem">
                <strong>Theorem: Properties of Determinants</strong><br>
                <ul style="margin-top: 0.5rem;">
                    <li>det(AB) = det(A) det(B) (product of determinants)</li>
                    <li>det(A^T) = det(A) (invariant under transpose)</li>
                    <li>det(kA) = k^n det(A) (scalar multiplication of n×n matrix)</li>
                    <li>det(A) ≠ 0 ⇔ A is non-singular (inverse exists)</li>
                    <li>Swapping rows changes sign</li>
                </ul>
            </div>

            <h3>Code Example 2: Verification of Determinant Properties</h3>
            <div class="code-block">A = np.array([[2, 1],
              [3, 4]])
B = np.array([[5, 6],
              [7, 8]])

det_A = np.linalg.det(A)
det_B = np.linalg.det(B)
det_AB = np.linalg.det(A @ B)

print("Verification of Determinant Properties:")
print(f"det(A) = {det_A:.4f}")
print(f"det(B) = {det_B:.4f}")
print(f"det(AB) = {det_AB:.4f}")
print(f"det(A) × det(B) = {det_A * det_B:.4f}")
print(f"det(AB) = det(A)×det(B)? {np.isclose(det_AB, det_A * det_B)}")

# Transpose
det_AT = np.linalg.det(A.T)
print(f"\ndet(A^T) = {det_AT:.4f}")
print(f"det(A) = det(A^T)? {np.isclose(det_A, det_AT)}")</div>

            <h2>2.2 Solving Systems of Linear Equations</h2>

            <div class="definition">
                <strong>Definition: System of Linear Equations</strong><br>
                Equation system represented as Ax = b. A: coefficient matrix, x: unknown vector, b: constant term vector
            </div>

            <h3>Code Example 3: Solving Linear Systems with NumPy</h3>
            <div class="code-block"># System of equations: 2x + 3y = 8, x - y = -1
A = np.array([[2, 3],
              [1, -1]])
b = np.array([8, -1])

# Solve with np.linalg.solve
x = np.linalg.solve(A, b)

print("Solution of Linear System:")
print(f"2x + 3y = 8")
print(f"x - y = -1")
print(f"\nSolution: x = {x[0]:.4f}, y = {x[1]:.4f}")

# Verification
b_check = A @ x
print(f"\nVerification: Ax = {b_check}")
print(f"Error: {np.linalg.norm(b - b_check):.2e}")</div>

            <h3>Code Example 4: Cramer's Rule</h3>
            <div class="code-block">def cramers_rule(A, b):
    """
    Solve linear system using Cramer's rule
    x_i = det(A_i) / det(A)
    A_i: matrix with i-th column replaced by b
    """
    det_A = np.linalg.det(A)

    if np.abs(det_A) < 1e-10:
        raise ValueError("Determinant is zero, cannot solve")

    n = len(b)
    x = np.zeros(n)

    for i in range(n):
        A_i = A.copy()
        A_i[:, i] = b  # Replace i-th column with b
        x[i] = np.linalg.det(A_i) / det_A

    return x

# Solve the same system
x_cramer = cramers_rule(A, b)

print("Cramer's Rule:")
print(f"Solution: x = {x_cramer[0]:.4f}, y = {x_cramer[1]:.4f}")
print(f"Difference from np.linalg.solve: {np.linalg.norm(x - x_cramer):.2e}")</div>

            <h2>2.3 Gaussian Elimination</h2>

            <h3>Code Example 5: Implementation of Gaussian Elimination</h3>
            <div class="code-block">def gaussian_elimination(A, b):
    """
    Solve linear system using Gaussian elimination
    Forward elimination → Back substitution
    """
    n = len(b)
    # Create augmented matrix
    Ab = np.hstack([A.astype(float), b.reshape(-1, 1)])

    # Forward elimination
    for i in range(n):
        # Pivot selection (partial pivoting)
        max_row = np.argmax(np.abs(Ab[i:, i])) + i
        Ab[[i, max_row]] = Ab[[max_row, i]]

        # Normalize i-th row
        Ab[i] = Ab[i] / Ab[i, i]

        # Zero out below i-th column
        for j in range(i+1, n):
            Ab[j] = Ab[j] - Ab[j, i] * Ab[i]

    # Back substitution
    x = np.zeros(n)
    for i in range(n-1, -1, -1):
        x[i] = Ab[i, -1] - np.dot(Ab[i, i+1:n], x[i+1:])

    return x

# Test
A_test = np.array([[2.0, 1.0, -1.0],
                   [-3.0, -1.0, 2.0],
                   [-2.0, 1.0, 2.0]])
b_test = np.array([8.0, -11.0, -3.0])

x_gauss = gaussian_elimination(A_test.copy(), b_test.copy())
x_numpy = np.linalg.solve(A_test, b_test)

print("Gaussian Elimination:")
print(f"Gaussian solution: {x_gauss}")
print(f"NumPy solution:    {x_numpy}")
print(f"Difference: {np.linalg.norm(x_gauss - x_numpy):.2e}")</div>

            <h2>2.4 LU Decomposition</h2>

            <div class="definition">
                <strong>Definition: LU Decomposition</strong><br>
                Decompose matrix A into lower triangular matrix L and upper triangular matrix U: A = LU<br>
                Linear system Ax = b can be solved in two stages: Ly = b → Ux = y
            </div>

            <h3>Code Example 6: Solving Linear Systems with LU Decomposition</h3>
            <div class="code-block">from scipy.linalg import lu

# LU decomposition
A_lu = np.array([[4, 3],
                 [6, 3]])

P, L, U = lu(A_lu)

print("LU Decomposition:")
print(f"A =\n{A_lu}\n")
print(f"P (permutation matrix) =\n{P}\n")
print(f"L (lower triangular) =\n{L}\n")
print(f"U (upper triangular) =\n{U}\n")

# Verification: PA = LU
print(f"PA =\n{P @ A_lu}\n")
print(f"LU =\n{L @ U}\n")
print(f"PA = LU? {np.allclose(P @ A_lu, L @ U)}")

# Solve linear system using LU decomposition
b_lu = np.array([10, 12])

# Step 1: Solve Ly = Pb (forward substitution)
y = np.linalg.solve(L, P @ b_lu)

# Step 2: Solve Ux = y (back substitution)
x_lu = np.linalg.solve(U, y)

print(f"\nSolution of linear system Ax = b:")
print(f"x = {x_lu}")

# Verification
print(f"Ax = {A_lu @ x_lu}")
print(f"b  = {b_lu}")</div>

            <h2>2.5 Rank and Existence Conditions for Solutions</h2>

            <div class="theorem">
                <strong>Theorem: Existence Conditions for Solutions</strong><br>
                For Ax = b:<br>
                <ul style="margin-top: 0.5rem;">
                    <li>rank(A) = rank([A|b]) = n → unique solution</li>
                    <li>rank(A) = rank([A|b]) < n → infinite solutions</li>
                    <li>rank(A) < rank([A|b]) → no solution</li>
                </ul>
            </div>

            <h3>Code Example 7: Rank Calculation and Solution Classification</h3>
            <div class="code-block"># Rank calculation
A_rank = np.array([[1, 2, 3],
                   [4, 5, 6],
                   [7, 8, 9]])

rank_A = np.linalg.matrix_rank(A_rank)

print("Rank Calculation:")
print(f"A =\n{A_rank}")
print(f"rank(A) = {rank_A}")
print(f"A is 3×3 square matrix but rank < 3 so singular matrix\n")

# Example with unique solution
A_unique = np.array([[1, 2],
                     [3, 4]])
b_unique = np.array([5, 6])

Ab_unique = np.column_stack([A_unique, b_unique])
rank_A_u = np.linalg.matrix_rank(A_unique)
rank_Ab_u = np.linalg.matrix_rank(Ab_unique)

print("Unique Solution Example:")
print(f"rank(A) = {rank_A_u}")
print(f"rank([A|b]) = {rank_Ab_u}")
print(f"rank(A) = rank([A|b]) = 2 → unique solution")
x_unique = np.linalg.solve(A_unique, b_unique)
print(f"Solution: {x_unique}\n")

# Example with no solution
A_no_sol = np.array([[1, 2],
                     [2, 4]])
b_no_sol = np.array([3, 7])  # 2nd equation is 2× 1st equation but RHS inconsistent

Ab_no_sol = np.column_stack([A_no_sol, b_no_sol])
rank_A_n = np.linalg.matrix_rank(A_no_sol)
rank_Ab_n = np.linalg.matrix_rank(Ab_no_sol)

print("No Solution Example:")
print(f"rank(A) = {rank_A_n}")
print(f"rank([A|b]) = {rank_Ab_n}")
print(f"rank(A) < rank([A|b]) → no solution")</div>

            <h2>2.6 Application to Materials Science: Stoichiometry Calculations</h2>

            <div class="example">
                <strong>Application Example: Balancing Chemical Equations</strong><br>
                By solving chemical equation coefficients as linear equations, we can derive reaction formulas that satisfy elemental balance.
            </div>

            <h3>Code Example 8: Balancing Chemical Equations</h3>
            <div class="code-block"># Chemical equation: aFe + bO2 → cFe2O3
# Elemental balance:
#   Fe: a = 2c
#   O:  2b = 3c
# Express in matrix form

# Coefficient matrix (unknowns on left, knowns on right)
# a - 2c = 0
# 2b - 3c = 0
# c = 1 (fix arbitrarily)

# Transform to solvable form
A_chem = np.array([[1, 0, -2],   # Fe balance
                   [0, 2, -3]])  # O balance

# With c=1
c = 1
b_chem = np.array([2*c, 3*c])

# Find least squares solution
x_chem = np.linalg.lstsq(A_chem[:, :2], b_chem, rcond=None)[0]

a, b = x_chem
print("Chemical Equation Balancing:")
print(f"Fe + O2 → Fe2O3")
print(f"\nCoefficients:")
print(f"a (Fe) = {a:.1f}")
print(f"b (O2) = {b:.1f}")
print(f"c (Fe2O3) = {c:.1f}")
print(f"\nBalanced Equation:")
print(f"{int(a*2)}Fe + {int(b*2)}O2 → {int(c*2)}Fe2O3")

# Verification
print(f"\nElemental Balance Verification:")
print(f"Fe: left = {int(a*2)}, right = {int(c*2)*2}")
print(f"O:  left = {int(b*2)*2}, right = {int(c*2)*3}")</div>

            <h2>Summary</h2>
            <ul>
                <li>Determinant is an important invariant of square matrices, used to determine existence of inverse</li>
                <li>Systems of linear equations are efficiently solved with NumPy's solve function</li>
                <li>Gaussian elimination is important as a systematic manual calculation method</li>
                <li>LU decomposition efficiently solves multiple problems with same A but different b</li>
                <li>Rank is key to determining existence and uniqueness of solutions</li>
                <li>Linear equations appear in many contexts in materials science such as stoichiometry calculations</li>
            </ul>

            <div class="nav-buttons">
                <a href="chapter-1.html" class="nav-button">← Chapter 1: Vectors and Matrices</a>
                <a href="chapter-3.html" class="nav-button">Chapter 3: Eigenvalues & Eigenvectors →</a>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - Fundamentals of Mathematics Dojo</p>
    </footer>
</body>
</html>
