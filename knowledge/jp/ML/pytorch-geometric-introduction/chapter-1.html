<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¬¬1ç« ï¼šPyTorch Geometricå…¥é–€ã¨ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®åŸºç¤ - PyTorch Geometricå…¥é–€ - AI Terakoya</title>
  <meta name="description" content="PyTorch Geometricã®åŸºç¤ã¨ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®æ‰±ã„æ–¹ã‚’å­¦ã¶ã€‚ã‚°ãƒ©ãƒ•æ§‹é€ ã€Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€çµ„ã¿è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã€GNNã®åŸºæœ¬å®Ÿè£…ã‚’å®Ÿè·µçš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ã§ç†è§£ã—ã¾ã™ã€‚">

  <style>
    :root {
      --color-primary: #2c3e50;
      --color-primary-dark: #1a252f;
      --color-accent: #7b2cbf;
      --color-accent-light: #9d4edd;
      --color-text: #2d3748;
      --color-text-light: #4a5568;
      --color-bg: #ffffff;
      --color-bg-alt: #f7fafc;
      --color-border: #e2e8f0;
      --color-code-bg: #f8f9fa;
      --color-link: #3182ce;
      --color-link-hover: #2c5aa0;

      --spacing-xs: 0.5rem;
      --spacing-sm: 1rem;
      --spacing-md: 1.5rem;
      --spacing-lg: 2rem;
      --spacing-xl: 3rem;

      --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
      --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

      --border-radius: 8px;
      --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-body);
      line-height: 1.7;
      color: var(--color-text);
      background-color: var(--color-bg);
      font-size: 16px;
    }

    header {
      background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
      color: white;
      padding: var(--spacing-xl) var(--spacing-md);
      margin-bottom: var(--spacing-xl);
      box-shadow: var(--box-shadow);
    }

    .header-content {
      max-width: 900px;
      margin: 0 auto;
    }

    h1 {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: var(--spacing-sm);
      line-height: 1.2;
    }

    .subtitle {
      font-size: 1.1rem;
      opacity: 0.95;
      font-weight: 400;
      margin-bottom: var(--spacing-md);
    }

    .meta {
      display: flex;
      flex-wrap: wrap;
      gap: var(--spacing-md);
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 var(--spacing-md) var(--spacing-xl);
    }

    h2 {
      font-size: 1.75rem;
      color: var(--color-primary);
      margin-top: var(--spacing-xl);
      margin-bottom: var(--spacing-md);
      padding-bottom: var(--spacing-xs);
      border-bottom: 3px solid var(--color-accent);
    }

    h3 {
      font-size: 1.4rem;
      color: var(--color-primary);
      margin-top: var(--spacing-lg);
      margin-bottom: var(--spacing-sm);
    }

    h4 {
      font-size: 1.1rem;
      color: var(--color-primary-dark);
      margin-top: var(--spacing-md);
      margin-bottom: var(--spacing-sm);
    }

    p {
      margin-bottom: var(--spacing-md);
      color: var(--color-text);
    }

    a {
      color: var(--color-link);
      text-decoration: none;
      transition: color 0.2s;
    }

    a:hover {
      color: var(--color-link-hover);
      text-decoration: underline;
    }

    ul, ol {
      margin-left: var(--spacing-lg);
      margin-bottom: var(--spacing-md);
    }

    li {
      margin-bottom: var(--spacing-xs);
      color: var(--color-text);
    }

    pre {
      background-color: var(--color-code-bg);
      border: 1px solid var(--color-border);
      border-radius: var(--border-radius);
      padding: var(--spacing-md);
      overflow-x: auto;
      margin-bottom: var(--spacing-md);
      font-family: var(--font-mono);
      font-size: 0.9rem;
      line-height: 1.5;
    }

    code {
      font-family: var(--font-mono);
      font-size: 0.9em;
      background-color: var(--color-code-bg);
      padding: 0.2em 0.4em;
      border-radius: 3px;
    }

    pre code {
      background-color: transparent;
      padding: 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: var(--spacing-md);
      font-size: 0.95rem;
    }

    th, td {
      border: 1px solid var(--color-border);
      padding: var(--spacing-sm);
      text-align: left;
    }

    th {
      background-color: var(--color-bg-alt);
      font-weight: 600;
      color: var(--color-primary);
    }

    blockquote {
      border-left: 4px solid var(--color-accent);
      padding-left: var(--spacing-md);
      margin: var(--spacing-md) 0;
      color: var(--color-text-light);
      font-style: italic;
      background-color: var(--color-bg-alt);
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
    }

    .mermaid {
      text-align: center;
      margin: var(--spacing-lg) 0;
      background-color: var(--color-bg-alt);
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
    }

    details {
      background-color: var(--color-bg-alt);
      border: 1px solid var(--color-border);
      border-radius: var(--border-radius);
      padding: var(--spacing-md);
      margin-bottom: var(--spacing-md);
    }

    summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--color-primary);
      user-select: none;
      padding: var(--spacing-xs);
      margin: calc(-1 * var(--spacing-md));
      padding: var(--spacing-md);
      border-radius: var(--border-radius);
    }

    summary:hover {
      background-color: rgba(123, 44, 191, 0.1);
    }

    details[open] summary {
      margin-bottom: var(--spacing-md);
      border-bottom: 1px solid var(--color-border);
    }

    .chapter-description {
      margin: 1.5rem 0;
      padding: 1rem;
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-left: 4px solid #7b2cbf;
      border-radius: 8px;
      font-size: 1.05rem;
      line-height: 1.8;
      color: #2d3748;
    }

    .learning-objectives {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      padding: var(--spacing-lg);
      border-radius: var(--border-radius);
      border-left: 4px solid var(--color-accent);
      margin-bottom: var(--spacing-xl);
    }

    .learning-objectives h2 {
      margin-top: 0;
      border-bottom: none;
    }

    .navigation {
      display: flex;
      justify-content: space-between;
      gap: var(--spacing-md);
      margin: var(--spacing-xl) 0;
      padding-top: var(--spacing-lg);
      border-top: 2px solid var(--color-border);
    }

    .nav-button {
      flex: 1;
      padding: var(--spacing-md);
      background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
      color: white;
      border-radius: var(--border-radius);
      text-align: center;
      font-weight: 600;
      transition: transform 0.2s, box-shadow 0.2s;
      box-shadow: var(--box-shadow);
    }

    .nav-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      text-decoration: none;
    }

    .nav-button.disabled {
      opacity: 0.5;
      cursor: not-allowed;
      background: #6c757d;
    }

    .nav-button.disabled:hover {
      transform: none;
      box-shadow: var(--box-shadow);
    }

    footer {
      margin-top: var(--spacing-xl);
      padding: var(--spacing-lg) var(--spacing-md);
      background-color: var(--color-bg-alt);
      border-top: 1px solid var(--color-border);
      text-align: center;
      font-size: 0.9rem;
      color: var(--color-text-light);
    }

    .disclaimer {
      max-width: 900px;
      margin: 2rem auto;
      padding: 1.5rem;
      background: #f8f9fa;
      border-left: 4px solid #6c757d;
      border-radius: 4px;
    }

    .disclaimer h3 {
      color: #495057;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }

    .disclaimer ul {
      list-style: none;
      padding-left: 0;
    }

    .disclaimer li {
      padding: 0.5rem 0;
      padding-left: 1.5rem;
      position: relative;
      font-size: 0.9rem;
      color: #6c757d;
      line-height: 1.6;
    }

    .disclaimer li::before {
      content: "âš ï¸";
      position: absolute;
      left: 0;
    }

    /* Breadcrumb styles */
    .breadcrumb {
      background: #f7fafc;
      padding: 0.75rem 1rem;
      border-bottom: 1px solid #e2e8f0;
      font-size: 0.9rem;
    }

    .breadcrumb-content {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .breadcrumb a {
      color: #667eea;
      text-decoration: none;
      transition: color 0.2s;
    }

    .breadcrumb a:hover {
      color: #764ba2;
      text-decoration: underline;
    }

    .breadcrumb-separator {
      color: #a0aec0;
      margin: 0 0.25rem;
    }

    .breadcrumb-current {
      color: #4a5568;
      font-weight: 500;
    }

    .info-box {
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
      padding: var(--spacing-md);
      margin: var(--spacing-md) 0;
      border-radius: var(--border-radius);
    }

    .warning-box {
      background: #fff3e0;
      border-left: 4px solid #ff9800;
      padding: var(--spacing-md);
      margin: var(--spacing-md) 0;
      border-radius: var(--border-radius);
    }

    .success-box {
      background: #e8f5e9;
      border-left: 4px solid #4caf50;
      padding: var(--spacing-md);
      margin: var(--spacing-md) 0;
      border-radius: var(--border-radius);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .container {
        padding: 0 1rem 2rem;
      }

      h1 {
        font-size: 1.6rem;
      }

      h2 {
        font-size: 1.4rem;
      }

      .navigation {
        flex-direction: column;
      }
    }
  </style>

  <!-- Mermaid for diagrams -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <!-- Prism.js for syntax highlighting -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <!-- MathJax for equations -->
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <script>
    // Mermaid.js initialization
    document.addEventListener('DOMContentLoaded', function() {
      if (typeof mermaid !== 'undefined') {
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
      }
    });
  </script>
</head>
<body>
  <nav class="breadcrumb">
    <div class="breadcrumb-content">
      <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../index.html">æ©Ÿæ¢°å­¦ç¿’</a><span class="breadcrumb-separator">â€º</span><a href="./index.html">PyTorch Geometricå…¥é–€</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">ç¬¬1ç« </span>
    </div>
  </nav>

  <header>
    <div class="header-content">
      <h1>ç¬¬1ç« ï¼šPyTorch Geometricå…¥é–€ã¨ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®åŸºç¤</h1>
      <p class="subtitle">ã‚°ãƒ©ãƒ•æ§‹é€ ãƒ‡ãƒ¼ã‚¿ã¨GNNã®ç¬¬ä¸€æ­©</p>
      <div class="meta">
        <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 30-35åˆ†</span>
        <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
        <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 12å€‹</span>
        <span class="meta-item">ğŸ“ æ¼”ç¿’: 5å•</span>
      </div>
    </div>
  </header>

  <main class="container">
    <div class="chapter-description">
      <p>ã“ã®ç« ã§ã¯ã€ã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆGNNï¼‰ã®åŸºç¤ã¨ãªã‚‹ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®æ¦‚å¿µã¨ã€PyTorch Geometricï¼ˆPyGï¼‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ã„æ–¹ã‚’å­¦ã³ã¾ã™ã€‚ã‚°ãƒ©ãƒ•ã®åŸºæœ¬æ§‹é€ ã€PyGã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ‰±ã„æ–¹ã€çµ„ã¿è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã€ãã—ã¦ç°¡å˜ãªGCNãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å®Ÿè£…ã‚’é€šã˜ã¦ã€GNNé–‹ç™ºã®åŸºç›¤ã‚’å›ºã‚ã¦ã„ãã¾ã—ã‚‡ã†ã€‚</p>
    </div>

    <div class="learning-objectives">
      <h2>å­¦ç¿’ç›®æ¨™</h2>
      <ul>
        <li>âœ… ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬æ¦‚å¿µï¼ˆãƒãƒ¼ãƒ‰ã€ã‚¨ãƒƒã‚¸ã€éš£æ¥è¡Œåˆ—ï¼‰ã‚’ç†è§£ã™ã‚‹</li>
        <li>âœ… PyTorch Geometricã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€å‹•ä½œç¢ºèªãŒã§ãã‚‹</li>
        <li>âœ… PyGã®Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆãƒ»æ“ä½œã§ãã‚‹</li>
        <li>âœ… çµ„ã¿è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ã€æ¢ç´¢ã§ãã‚‹</li>
        <li>âœ… ç°¡å˜ãªGCNãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½¿ã£ãŸãƒãƒ¼ãƒ‰åˆ†é¡ã‚’å®Ÿè£…ã§ãã‚‹</li>
      </ul>
    </div>

    <h2 id="graph-basics">1. ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®åŸºç¤æ¦‚å¿µ</h2>

    <p><strong>ã‚°ãƒ©ãƒ•ï¼ˆGraphï¼‰</strong>ã¯ã€ãƒãƒ¼ãƒ‰ï¼ˆé ‚ç‚¹ï¼‰ã¨ã‚¨ãƒƒã‚¸ï¼ˆè¾ºï¼‰ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ã€‚å®Ÿä¸–ç•Œã®å¤šãã®è¤‡é›‘ãªé–¢ä¿‚æ€§ã‚’ã‚°ãƒ©ãƒ•ã§è¡¨ç¾ã§ãã¾ã™ã€‚</p>

    <h3>ã‚°ãƒ©ãƒ•ã®åŸºæœ¬è¦ç´ </h3>

    <ul>
      <li><strong>ãƒãƒ¼ãƒ‰ï¼ˆNode/Vertexï¼‰</strong>: ã‚°ãƒ©ãƒ•ã®è¦ç´ ã‚’è¡¨ã™ç‚¹ã€‚ä¾‹ï¼šäººã€åˆ†å­ã®åŸå­ã€è«–æ–‡</li>
      <li><strong>ã‚¨ãƒƒã‚¸ï¼ˆEdge/Linkï¼‰</strong>: ãƒãƒ¼ãƒ‰é–“ã®é–¢ä¿‚ã‚’è¡¨ã™ç·šã€‚ä¾‹ï¼šå‹äººé–¢ä¿‚ã€åŒ–å­¦çµåˆã€å¼•ç”¨é–¢ä¿‚</li>
      <li><strong>ç‰¹å¾´é‡ï¼ˆFeaturesï¼‰</strong>: ãƒãƒ¼ãƒ‰ã‚„ã‚¨ãƒƒã‚¸ã«ä»˜éšã™ã‚‹å±æ€§æƒ…å ±</li>
    </ul>

    <div class="mermaid">
graph LR
  A[ãƒãƒ¼ãƒ‰ A] -->|ã‚¨ãƒƒã‚¸| B[ãƒãƒ¼ãƒ‰ B]
  B --> C[ãƒãƒ¼ãƒ‰ C]
  A --> C
  C --> D[ãƒãƒ¼ãƒ‰ D]
  B --> D
    </div>

    <h3>ã‚°ãƒ©ãƒ•ã®ç¨®é¡</h3>

    <table>
      <thead>
        <tr>
          <th>åˆ†é¡</th>
          <th>ç¨®é¡</th>
          <th>èª¬æ˜</th>
          <th>ä¾‹</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>æ–¹å‘æ€§</td>
          <td>æœ‰å‘ã‚°ãƒ©ãƒ•</td>
          <td>ã‚¨ãƒƒã‚¸ã«æ–¹å‘ãŒã‚ã‚‹</td>
          <td>Twitterã®ãƒ•ã‚©ãƒ­ãƒ¼é–¢ä¿‚ã€å¼•ç”¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</td>
        </tr>
        <tr>
          <td></td>
          <td>ç„¡å‘ã‚°ãƒ©ãƒ•</td>
          <td>ã‚¨ãƒƒã‚¸ã«æ–¹å‘ãŒãªã„</td>
          <td>Facebookã®å‹äººé–¢ä¿‚ã€åˆ†å­æ§‹é€ </td>
        </tr>
        <tr>
          <td>ãƒãƒ¼ãƒ‰ç¨®é¡</td>
          <td>åŒç¨®ã‚°ãƒ©ãƒ•</td>
          <td>1ç¨®é¡ã®ãƒãƒ¼ãƒ‰</td>
          <td>ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆäººã®ã¿ï¼‰</td>
        </tr>
        <tr>
          <td></td>
          <td>ç•°ç¨®ã‚°ãƒ©ãƒ•</td>
          <td>è¤‡æ•°ç¨®é¡ã®ãƒãƒ¼ãƒ‰</td>
          <td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨å•†å“ã‚’å«ã‚€ãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚°ãƒ©ãƒ•</td>
        </tr>
        <tr>
          <td>é‡ã¿</td>
          <td>é‡ã¿ä»˜ãã‚°ãƒ©ãƒ•</td>
          <td>ã‚¨ãƒƒã‚¸ã«é‡ã¿ï¼ˆå¼·åº¦ï¼‰ãŒã‚ã‚‹</td>
          <td>é“è·¯ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆè·é›¢ï¼‰ã€é¡ä¼¼åº¦ã‚°ãƒ©ãƒ•</td>
        </tr>
      </tbody>
    </table>

    <h3>ã‚°ãƒ©ãƒ•ã®è¡¨ç¾æ–¹æ³•</h3>

    <p>ã‚°ãƒ©ãƒ•ã‚’ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã§æ‰±ã†ãŸã‚ã®ä¸»ãªè¡¨ç¾æ–¹æ³•ï¼š</p>

    <h4>1. éš£æ¥è¡Œåˆ—ï¼ˆAdjacency Matrixï¼‰</h4>

    <p>ãƒãƒ¼ãƒ‰æ•°ã‚’ \(N\) ã¨ã™ã‚‹ã¨ã€\(N \times N\) ã®è¡Œåˆ— \(A\) ã§è¡¨ç¾ï¼š</p>
    <p>$$A_{ij} = \begin{cases} 1 & \text{if ãƒãƒ¼ãƒ‰ } i \text{ ã‹ã‚‰ } j \text{ ã¸ã‚¨ãƒƒã‚¸ãŒã‚ã‚‹} \\ 0 & \text{otherwise} \end{cases}$$</p>

    <pre><code class="language-python">import numpy as np

# 4ãƒãƒ¼ãƒ‰ã®ã‚°ãƒ©ãƒ•ã®éš£æ¥è¡Œåˆ—
# ã‚¨ãƒƒã‚¸: 0â†’1, 1â†’2, 0â†’2, 2â†’3, 1â†’3
adjacency_matrix = np.array([
    [0, 1, 1, 0],  # ãƒãƒ¼ãƒ‰0ã‹ã‚‰ã®æ¥ç¶š
    [0, 0, 1, 1],  # ãƒãƒ¼ãƒ‰1ã‹ã‚‰ã®æ¥ç¶š
    [0, 0, 0, 1],  # ãƒãƒ¼ãƒ‰2ã‹ã‚‰ã®æ¥ç¶š
    [0, 0, 0, 0]   # ãƒãƒ¼ãƒ‰3ã‹ã‚‰ã®æ¥ç¶š
])

print("éš£æ¥è¡Œåˆ—:\n", adjacency_matrix)
</code></pre>

    <h4>2. ã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆEdge Indexï¼‰</h4>

    <p>PyTorch Geometricã§æ¡ç”¨ã•ã‚Œã¦ã„ã‚‹åŠ¹ç‡çš„ãªè¡¨ç¾æ–¹æ³•ã€‚ã‚¹ãƒ‘ãƒ¼ã‚¹ï¼ˆç–ï¼‰ãªã‚°ãƒ©ãƒ•ã«é©ã—ã¦ã„ã¾ã™ã€‚</p>

    <pre><code class="language-python">import torch

# åŒã˜ã‚°ãƒ©ãƒ•ã‚’ã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§è¡¨ç¾
# å½¢çŠ¶: [2, num_edges]
# 1è¡Œç›®: å§‹ç‚¹ãƒãƒ¼ãƒ‰ã€2è¡Œç›®: çµ‚ç‚¹ãƒãƒ¼ãƒ‰
edge_index = torch.tensor([
    [0, 1, 0, 2, 1],  # å§‹ç‚¹ãƒãƒ¼ãƒ‰
    [1, 2, 2, 3, 3]   # çµ‚ç‚¹ãƒãƒ¼ãƒ‰
], dtype=torch.long)

print("ã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹:\n", edge_index)
</code></pre>

    <div class="info-box">
      <p><strong>ğŸ’¡ ãªãœã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼Ÿ</strong></p>
      <p>éš£æ¥è¡Œåˆ—ã¯ \(O(N^2)\) ã®ãƒ¡ãƒ¢ãƒªãŒå¿…è¦ã§ã™ãŒã€å®Ÿä¸–ç•Œã®ã‚°ãƒ©ãƒ•ã¯ç–ï¼ˆã‚¹ãƒ‘ãƒ¼ã‚¹ï¼‰ãªã“ã¨ãŒå¤šãã€ã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ \(O(E)\)ï¼ˆ\(E\)ã¯ã‚¨ãƒƒã‚¸æ•°ï¼‰ã§æ¸ˆã¿ã¾ã™ã€‚ä¾‹ãˆã°ã€1ä¸‡ãƒãƒ¼ãƒ‰ã§å¹³å‡æ¬¡æ•°10ã®ã‚°ãƒ©ãƒ•ã§ã¯ã€éš£æ¥è¡Œåˆ—ã¯100MBå¿…è¦ã§ã™ãŒã€ã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã¯ç´„800KBã§æ¸ˆã¿ã¾ã™ã€‚</p>
    </div>

    <h2 id="installation">2. PyTorch Geometricã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ç’°å¢ƒæ§‹ç¯‰</h2>

    <p><strong>PyTorch Geometric</strong>ã¯ã€PyTorchã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ãŸã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å°‚ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚</p>

    <h3>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•</h3>

    <p>PyTorch Geometricã¯ã€PyTorchã¨CUDAã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ä¾å­˜ã—ã¾ã™ã€‚ã¾ãšã€ä½¿ç”¨ç’°å¢ƒã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚</p>

    <pre><code class="language-python">import torch
print(f"PyTorch version: {torch.__version__}")
print(f"CUDA available: {torch.cuda.is_available()}")
if torch.cuda.is_available():
    print(f"CUDA version: {torch.version.cuda}")
</code></pre>

    <h4>æ–¹æ³•1: pipçµŒç”±ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæ¨å¥¨ï¼‰</h4>

    <pre><code class="language-bash"># PyTorch 2.0ä»¥é™ã®å ´åˆï¼ˆCPUç‰ˆï¼‰
pip install torch-geometric

# è¿½åŠ ã®ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
pip install pyg-lib torch-scatter torch-sparse torch-cluster torch-spline-conv -f https://data.pyg.org/whl/torch-2.1.0+cpu.html

# GPUç‰ˆï¼ˆCUDA 11.8ã®å ´åˆï¼‰
pip install torch-geometric
pip install pyg-lib torch-scatter torch-sparse torch-cluster torch-spline-conv -f https://data.pyg.org/whl/torch-2.1.0+cu118.html
</code></pre>

    <h4>æ–¹æ³•2: condaçµŒç”±ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h4>

    <pre><code class="language-bash"># condaã®å ´åˆ
conda install pyg -c pyg
</code></pre>

    <h4>æ–¹æ³•3: Google Colabï¼ˆç’°å¢ƒæ§‹ç¯‰ä¸è¦ï¼‰</h4>

    <p>Google Colabã§ã¯ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ç°¡å˜ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ï¼š</p>

    <pre><code class="language-python">!pip install torch-geometric
!pip install pyg-lib torch-scatter torch-sparse -f https://data.pyg.org/whl/torch-2.1.0+cu118.html
</code></pre>

    <h3>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª</h3>

    <pre><code class="language-python">import torch
import torch_geometric

print(f"PyTorch version: {torch.__version__}")
print(f"PyTorch Geometric version: {torch_geometric.__version__}")

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§å‹•ä½œç¢ºèª
from torch_geometric.data import Data

edge_index = torch.tensor([[0, 1, 1, 2],
                           [1, 0, 2, 1]], dtype=torch.long)
x = torch.tensor([[-1], [0], [1]], dtype=torch.float)
data = Data(x=x, edge_index=edge_index)

print(f"\nSample Data object created successfully!")
print(f"Number of nodes: {data.num_nodes}")
print(f"Number of edges: {data.num_edges}")
</code></pre>

    <p><strong>å‡ºåŠ›ä¾‹ï¼š</strong></p>

    <pre><code>PyTorch version: 2.1.0
PyTorch Geometric version: 2.4.0

Sample Data object created successfully!
Number of nodes: 3
Number of edges: 4
</code></pre>

    <h2 id="data-object">3. PyGã®Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h2>

    <p>PyTorch Geometricã®ä¸­å¿ƒçš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ãŒ<strong>Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</strong>ã§ã™ã€‚ã‚°ãƒ©ãƒ•ã®æ§‹é€ ã¨ç‰¹å¾´é‡ã‚’åŠ¹ç‡çš„ã«æ ¼ç´ã—ã¾ã™ã€‚</p>

    <h3>Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ </h3>

    <table>
      <thead>
        <tr>
          <th>å±æ€§</th>
          <th>å½¢çŠ¶</th>
          <th>èª¬æ˜</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>x</code></td>
          <td>[num_nodes, num_features]</td>
          <td>ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡è¡Œåˆ—</td>
        </tr>
        <tr>
          <td><code>edge_index</code></td>
          <td>[2, num_edges]</td>
          <td>ã‚¨ãƒƒã‚¸ã®æ¥ç¶šæƒ…å ±ï¼ˆCOOå½¢å¼ï¼‰</td>
        </tr>
        <tr>
          <td><code>edge_attr</code></td>
          <td>[num_edges, num_edge_features]</td>
          <td>ã‚¨ãƒƒã‚¸ç‰¹å¾´é‡è¡Œåˆ—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</td>
        </tr>
        <tr>
          <td><code>y</code></td>
          <td>ä»»æ„</td>
          <td>ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãƒ©ãƒ™ãƒ«ï¼ˆãƒãƒ¼ãƒ‰ã¾ãŸã¯ã‚°ãƒ©ãƒ•ï¼‰</td>
        </tr>
        <tr>
          <td><code>pos</code></td>
          <td>[num_nodes, num_dimensions]</td>
          <td>ãƒãƒ¼ãƒ‰ã®ä½ç½®åº§æ¨™ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</td>
        </tr>
      </tbody>
    </table>

    <h3>Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ</h3>

    <pre><code class="language-python">import torch
from torch_geometric.data import Data

# ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡ï¼ˆ3ãƒãƒ¼ãƒ‰ã€å„ãƒãƒ¼ãƒ‰2æ¬¡å…ƒç‰¹å¾´ï¼‰
x = torch.tensor([[1.0, 2.0],
                  [3.0, 4.0],
                  [5.0, 6.0]], dtype=torch.float)

# ã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ4ã¤ã®ã‚¨ãƒƒã‚¸ï¼‰
# 0â†’1, 1â†’0, 1â†’2, 2â†’1
edge_index = torch.tensor([[0, 1, 1, 2],
                           [1, 0, 2, 1]], dtype=torch.long)

# ã‚¨ãƒƒã‚¸ç‰¹å¾´é‡ï¼ˆå„ã‚¨ãƒƒã‚¸1æ¬¡å…ƒç‰¹å¾´ï¼‰
edge_attr = torch.tensor([[1.0], [1.0], [2.0], [2.0]], dtype=torch.float)

# ãƒãƒ¼ãƒ‰ãƒ©ãƒ™ãƒ«ï¼ˆãƒãƒ¼ãƒ‰åˆ†é¡ã‚¿ã‚¹ã‚¯ã®å ´åˆï¼‰
y = torch.tensor([0, 1, 0], dtype=torch.long)

# Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
data = Data(x=x, edge_index=edge_index, edge_attr=edge_attr, y=y)

print(data)
print(f"\nNumber of nodes: {data.num_nodes}")
print(f"Number of edges: {data.num_edges}")
print(f"Number of features: {data.num_node_features}")
print(f"Has isolated nodes: {data.has_isolated_nodes()}")
print(f"Has self-loops: {data.has_self_loops()}")
print(f"Is undirected: {data.is_undirected()}")
</code></pre>

    <p><strong>å‡ºåŠ›ï¼š</strong></p>

    <pre><code>Data(x=[3, 2], edge_index=[2, 4], edge_attr=[4, 1], y=[3])

Number of nodes: 3
Number of edges: 4
Number of features: 2
Has isolated nodes: False
Has self-loops: False
Is undirected: True
</code></pre>

    <h3>Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ“ä½œ</h3>

    <pre><code class="language-python">import torch
from torch_geometric.data import Data

data = Data(x=x, edge_index=edge_index, edge_attr=edge_attr, y=y)

# ç‰¹å®šãƒãƒ¼ãƒ‰ã®ç‰¹å¾´é‡å–å¾—
print("Node 0 features:", data.x[0])

# ç‰¹å®šã‚¨ãƒƒã‚¸ã®æƒ…å ±å–å¾—
print("Edge 0:", data.edge_index[:, 0])
print("Edge 0 attribute:", data.edge_attr[0])

# ãƒ‡ãƒ¼ã‚¿ã‚’GPUã«è»¢é€
if torch.cuda.is_available():
    data = data.to('cuda')
    print(f"Data moved to: {data.x.device}")

# CPUã«æˆ»ã™
data = data.to('cpu')

# ãƒ‡ãƒ¼ã‚¿ã®æ¤œè¨¼
print(f"\nIs valid: {data.validate()}")
</code></pre>

    <h2 id="datasets">4. åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿æ“ä½œã¨çµ„ã¿è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</h2>

    <p>PyTorch Geometricã«ã¯ã€ç ”ç©¶ãƒ»å­¦ç¿’ç”¨ã®çµ„ã¿è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãŒå¤šæ•°ç”¨æ„ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>

    <h3>ä¸»è¦ãªçµ„ã¿è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</h3>

    <table>
      <thead>
        <tr>
          <th>ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</th>
          <th>ç¨®é¡</th>
          <th>ãƒãƒ¼ãƒ‰æ•°</th>
          <th>èª¬æ˜</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>Cora</td>
          <td>å¼•ç”¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</td>
          <td>2,708</td>
          <td>è«–æ–‡ã®å¼•ç”¨é–¢ä¿‚ã€7ã‚¯ãƒ©ã‚¹åˆ†é¡</td>
        </tr>
        <tr>
          <td>Citeseer</td>
          <td>å¼•ç”¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</td>
          <td>3,327</td>
          <td>è«–æ–‡ã®å¼•ç”¨é–¢ä¿‚ã€6ã‚¯ãƒ©ã‚¹åˆ†é¡</td>
        </tr>
        <tr>
          <td>PubMed</td>
          <td>å¼•ç”¨ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</td>
          <td>19,717</td>
          <td>åŒ»å­¦è«–æ–‡ã®å¼•ç”¨é–¢ä¿‚ã€3ã‚¯ãƒ©ã‚¹åˆ†é¡</td>
        </tr>
        <tr>
          <td>PPI</td>
          <td>ç”Ÿç‰©ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</td>
          <td>14,755</td>
          <td>ã‚¿ãƒ³ãƒ‘ã‚¯è³ªç›¸äº’ä½œç”¨ã€ãƒãƒ«ãƒãƒ©ãƒ™ãƒ«åˆ†é¡</td>
        </tr>
        <tr>
          <td>QM9</td>
          <td>åˆ†å­ã‚°ãƒ©ãƒ•</td>
          <td>ç´„13ä¸‡åˆ†å­</td>
          <td>åˆ†å­ç‰¹æ€§äºˆæ¸¬ã€å›å¸°ã‚¿ã‚¹ã‚¯</td>
        </tr>
      </tbody>
    </table>

    <h3>Coraãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®èª­ã¿è¾¼ã¿</h3>

    <pre><code class="language-python">from torch_geometric.datasets import Planetoid

# Coraãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»èª­ã¿è¾¼ã¿
dataset = Planetoid(root='/tmp/Cora', name='Cora')

print(f"Dataset: {dataset}")
print(f"Number of graphs: {len(dataset)}")
print(f"Number of features: {dataset.num_features}")
print(f"Number of classes: {dataset.num_classes}")

# æœ€åˆã®ã‚°ãƒ©ãƒ•ï¼ˆCoraã¯å˜ä¸€ã‚°ãƒ©ãƒ•ï¼‰
data = dataset[0]

print(f"\nGraph structure:")
print(f"Number of nodes: {data.num_nodes}")
print(f"Number of edges: {data.num_edges}")
print(f"Average node degree: {data.num_edges / data.num_nodes:.2f}")
print(f"Training nodes: {data.train_mask.sum().item()}")
print(f"Validation nodes: {data.val_mask.sum().item()}")
print(f"Test nodes: {data.test_mask.sum().item()}")

# ãƒãƒ¼ãƒ‰ç‰¹å¾´é‡ã¨ãƒ©ãƒ™ãƒ«ã®ç¢ºèª
print(f"\nNode features shape: {data.x.shape}")
print(f"Node labels shape: {data.y.shape}")
print(f"First node features: {data.x[0][:10]}...")
print(f"First node label: {data.y[0].item()}")
</code></pre>

    <p><strong>å‡ºåŠ›ä¾‹ï¼š</strong></p>

    <pre><code>Dataset: Cora()
Number of graphs: 1
Number of features: 1433
Number of classes: 7

Graph structure:
Number of nodes: 2708
Number of edges: 10556
Average node degree: 3.90
Training nodes: 140
Validation nodes: 500
Test nodes: 1000

Node features shape: torch.Size([2708, 1433])
Node labels shape: torch.Size([2708])
First node features: tensor([0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])...
First node label: 3
</code></pre>

    <h3>DataLoaderã®ä½¿ã„æ–¹</h3>

    <p>è¤‡æ•°ã®ã‚°ãƒ©ãƒ•ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã¯ã€DataLoaderã‚’ä½¿ã£ã¦ãƒãƒƒãƒå‡¦ç†ã—ã¾ã™ã€‚</p>

    <pre><code class="language-python">from torch_geometric.datasets import TUDataset
from torch_geometric.loader import DataLoader

# ENZYMES ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®ã‚°ãƒ©ãƒ•åˆ†é¡ï¼‰
dataset = TUDataset(root='/tmp/ENZYMES', name='ENZYMES')

print(f"Dataset: {dataset}")
print(f"Number of graphs: {len(dataset)}")
print(f"Number of classes: {dataset.num_classes}")
print(f"Number of features: {dataset.num_features}")

# DataLoaderä½œæˆ
loader = DataLoader(dataset, batch_size=32, shuffle=True)

# ãƒãƒƒãƒã®ç¢ºèª
for batch in loader:
    print(f"\nBatch:")
    print(f"Number of graphs in batch: {batch.num_graphs}")
    print(f"Total nodes in batch: {batch.num_nodes}")
    print(f"Total edges in batch: {batch.num_edges}")
    print(f"Batch shape: {batch.batch.shape}")
    break  # æœ€åˆã®ãƒãƒƒãƒã®ã¿è¡¨ç¤º
</code></pre>

    <div class="info-box">
      <p><strong>ğŸ’¡ ãƒãƒƒãƒå‡¦ç†ã®ä»•çµ„ã¿</strong></p>
      <p>PyGã®DataLoaderã¯ã€è¤‡æ•°ã®ã‚°ãƒ©ãƒ•ã‚’1ã¤ã®å¤§ããªã‚°ãƒ©ãƒ•ã¨ã—ã¦çµåˆã—ã¾ã™ã€‚å„ãƒãƒ¼ãƒ‰ãŒã©ã®ã‚°ãƒ©ãƒ•ã«å±ã™ã‚‹ã‹ã¯<code>batch</code>å±æ€§ã§ç®¡ç†ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç•°ãªã‚‹ã‚µã‚¤ã‚ºã®ã‚°ãƒ©ãƒ•ã‚’åŠ¹ç‡çš„ã«ãƒãƒƒãƒå‡¦ç†ã§ãã¾ã™ã€‚</p>
    </div>

    <h2 id="first-gnn">5. ç°¡å˜ãªGNNã®å®Ÿè£…ä¾‹</h2>

    <p>æœ€ã‚‚åŸºæœ¬çš„ãªã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å±¤ã§ã‚ã‚‹<strong>GCNConvï¼ˆGraph Convolutional Networkï¼‰</strong>ã‚’ä½¿ã£ã¦ã€ãƒãƒ¼ãƒ‰åˆ†é¡ãƒ¢ãƒ‡ãƒ«ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

    <h3>GCNã®åŸºæœ¬åŸç†</h3>

    <p>GCNã¯å„ãƒãƒ¼ãƒ‰ã®ç‰¹å¾´é‡ã‚’ã€éš£æ¥ãƒãƒ¼ãƒ‰ã®ç‰¹å¾´é‡ã‚’é›†ç´„ã—ã¦æ›´æ–°ã—ã¾ã™ï¼š</p>
    <p>$$\mathbf{x}_i^{(k+1)} = \sigma\left(\sum_{j \in \mathcal{N}(i) \cup \{i\}} \frac{1}{\sqrt{d_i d_j}} \mathbf{W}^{(k)} \mathbf{x}_j^{(k)}\right)$$</p>

    <p>ã“ã“ã§ï¼š</p>
    <ul>
      <li>\(\mathbf{x}_i^{(k)}\): å±¤ \(k\) ã«ãŠã‘ã‚‹ãƒãƒ¼ãƒ‰ \(i\) ã®ç‰¹å¾´é‡</li>
      <li>\(\mathcal{N}(i)\): ãƒãƒ¼ãƒ‰ \(i\) ã®éš£æ¥ãƒãƒ¼ãƒ‰é›†åˆ</li>
      <li>\(d_i\): ãƒãƒ¼ãƒ‰ \(i\) ã®æ¬¡æ•°</li>
      <li>\(\mathbf{W}^{(k)}\): å­¦ç¿’å¯èƒ½ãªé‡ã¿è¡Œåˆ—</li>
      <li>\(\sigma\): æ´»æ€§åŒ–é–¢æ•°ï¼ˆReLUç­‰ï¼‰</li>
    </ul>

    <div class="mermaid">
graph LR
  A[ãƒãƒ¼ãƒ‰ A<br/>ç‰¹å¾´é‡] --> AGG[é›†ç´„]
  B[éš£æ¥ãƒãƒ¼ãƒ‰ B<br/>ç‰¹å¾´é‡] --> AGG
  C[éš£æ¥ãƒãƒ¼ãƒ‰ C<br/>ç‰¹å¾´é‡] --> AGG
  AGG --> UPDATE[æ›´æ–°]
  UPDATE --> A2[æ–°ã—ã„ç‰¹å¾´é‡]
    </div>

    <h3>GCNãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…</h3>

    <pre><code class="language-python">import torch
import torch.nn.functional as F
from torch_geometric.nn import GCNConv

class GCN(torch.nn.Module):
    def __init__(self, num_features, num_classes):
        super(GCN, self).__init__()
        # 2å±¤ã®GCN
        self.conv1 = GCNConv(num_features, 16)
        self.conv2 = GCNConv(16, num_classes)

    def forward(self, data):
        x, edge_index = data.x, data.edge_index

        # ç¬¬1å±¤: å…¥åŠ› â†’ 16æ¬¡å…ƒ
        x = self.conv1(x, edge_index)
        x = F.relu(x)
        x = F.dropout(x, p=0.5, training=self.training)

        # ç¬¬2å±¤: 16æ¬¡å…ƒ â†’ ã‚¯ãƒ©ã‚¹æ•°
        x = self.conv2(x, edge_index)

        return F.log_softmax(x, dim=1)

# ãƒ¢ãƒ‡ãƒ«ä½œæˆ
from torch_geometric.datasets import Planetoid

dataset = Planetoid(root='/tmp/Cora', name='Cora')
data = dataset[0]

model = GCN(num_features=dataset.num_features,
            num_classes=dataset.num_classes)

print(model)
print(f"\nTotal parameters: {sum(p.numel() for p in model.parameters())}")
</code></pre>

    <h3>å­¦ç¿’ãƒ«ãƒ¼ãƒ—ã®å®Ÿè£…</h3>

    <pre><code class="language-python">import torch
import torch.nn.functional as F
from torch_geometric.datasets import Planetoid

# ãƒ‡ãƒ¼ã‚¿ã¨ãƒ¢ãƒ‡ãƒ«ã®æº–å‚™
dataset = Planetoid(root='/tmp/Cora', name='Cora')
data = dataset[0]

device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = GCN(num_features=dataset.num_features,
            num_classes=dataset.num_classes).to(device)
data = data.to(device)

# ã‚ªãƒ—ãƒ†ã‚£ãƒã‚¤ã‚¶
optimizer = torch.optim.Adam(model.parameters(), lr=0.01, weight_decay=5e-4)

# å­¦ç¿’ãƒ«ãƒ¼ãƒ—
model.train()
for epoch in range(200):
    optimizer.zero_grad()

    # é †ä¼æ’­
    out = model(data)

    # æå¤±è¨ˆç®—ï¼ˆè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ã¿ï¼‰
    loss = F.nll_loss(out[data.train_mask], data.y[data.train_mask])

    # é€†ä¼æ’­
    loss.backward()
    optimizer.step()

    # 10ã‚¨ãƒãƒƒã‚¯ã”ã¨ã«çµæœè¡¨ç¤º
    if (epoch + 1) % 10 == 0:
        model.eval()
        _, pred = model(data).max(dim=1)
        correct = pred[data.train_mask].eq(data.y[data.train_mask]).sum().item()
        accuracy = correct / data.train_mask.sum().item()
        print(f'Epoch {epoch+1:03d}, Loss: {loss:.4f}, Train Acc: {accuracy:.4f}')
        model.train()
</code></pre>

    <h3>ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡</h3>

    <pre><code class="language-python">def test(model, data):
    model.eval()
    with torch.no_grad():
        out = model(data)
        _, pred = out.max(dim=1)

        # è¨“ç·´ãƒ‡ãƒ¼ã‚¿ç²¾åº¦
        correct = pred[data.train_mask].eq(data.y[data.train_mask]).sum().item()
        train_acc = correct / data.train_mask.sum().item()

        # æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿ç²¾åº¦
        correct = pred[data.val_mask].eq(data.y[data.val_mask]).sum().item()
        val_acc = correct / data.val_mask.sum().item()

        # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ç²¾åº¦
        correct = pred[data.test_mask].eq(data.y[data.test_mask]).sum().item()
        test_acc = correct / data.test_mask.sum().item()

    return train_acc, val_acc, test_acc

train_acc, val_acc, test_acc = test(model, data)
print(f'\nFinal Results:')
print(f'Train Accuracy: {train_acc:.4f}')
print(f'Validation Accuracy: {val_acc:.4f}')
print(f'Test Accuracy: {test_acc:.4f}')
</code></pre>

    <p><strong>å‡ºåŠ›ä¾‹ï¼š</strong></p>

    <pre><code>Epoch 010, Loss: 1.9234, Train Acc: 0.3143
Epoch 020, Loss: 1.7845, Train Acc: 0.4357
Epoch 030, Loss: 1.5234, Train Acc: 0.6000
...
Epoch 200, Loss: 0.5123, Train Acc: 0.9714

Final Results:
Train Accuracy: 0.9714
Validation Accuracy: 0.7540
Test Accuracy: 0.8130
</code></pre>

    <div class="success-box">
      <p><strong>ğŸ‰ åˆã‚ã¦ã®GNNå®Ÿè£…å®Œäº†ï¼</strong></p>
      <p>Coraãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ãƒ†ã‚¹ãƒˆç²¾åº¦81%ã‚’é”æˆã—ã¾ã—ãŸã€‚ã“ã‚Œã¯ã‚°ãƒ©ãƒ•æ§‹é€ ã‚’è€ƒæ…®ã—ãªã„MLPãƒ¢ãƒ‡ãƒ«ï¼ˆç´„60%ï¼‰ã¨æ¯”ã¹ã¦å¤§å¹…ã«æ”¹å–„ã•ã‚Œã¦ã„ã¾ã™ã€‚GNNã¯ãƒãƒ¼ãƒ‰é–“ã®é–¢ä¿‚æ€§ã‚’å­¦ç¿’ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šé«˜ã„ç²¾åº¦ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚</p>
    </div>

    <h2 id="exercises">æ¼”ç¿’å•é¡Œ</h2>

    <details>
      <summary><strong>æ¼”ç¿’1ï¼šã‚«ã‚¹ã‚¿ãƒ ã‚°ãƒ©ãƒ•ã®ä½œæˆ</strong></summary>
      <p>ä»¥ä¸‹ã®æ¡ä»¶ã§ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã¦ãã ã•ã„ï¼š</p>
      <ol>
        <li>5ã¤ã®ãƒãƒ¼ãƒ‰ï¼ˆå„ãƒãƒ¼ãƒ‰3æ¬¡å…ƒç‰¹å¾´é‡ï¼‰</li>
        <li>ç„¡å‘ã‚°ãƒ©ãƒ•ï¼ˆåŒæ–¹å‘ã‚¨ãƒƒã‚¸ï¼‰</li>
        <li>ã‚¨ãƒƒã‚¸: 0-1, 1-2, 2-3, 3-4, 4-0</li>
        <li>å„ãƒãƒ¼ãƒ‰ã«ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ©ãƒ™ãƒ«ï¼ˆ0,1,2ã®ã„ãšã‚Œã‹ï¼‰ã‚’ä»˜ä¸</li>
      </ol>
      <pre><code class="language-python"># ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
</code></pre>
    </details>

    <details>
      <summary><strong>æ¼”ç¿’2ï¼šãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæ¢ç´¢</strong></summary>
      <p>Citeseerãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’èª­ã¿è¾¼ã¿ã€ä»¥ä¸‹ã®æƒ…å ±ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ï¼š</p>
      <ul>
        <li>ãƒãƒ¼ãƒ‰æ•°ã€ã‚¨ãƒƒã‚¸æ•°</li>
        <li>å¹³å‡ãƒãƒ¼ãƒ‰æ¬¡æ•°</li>
        <li>ç‰¹å¾´é‡æ¬¡å…ƒæ•°</li>
        <li>ã‚¯ãƒ©ã‚¹æ•°</li>
        <li>è¨“ç·´/æ¤œè¨¼/ãƒ†ã‚¹ãƒˆãƒãƒ¼ãƒ‰æ•°</li>
      </ul>
    </details>

    <details>
      <summary><strong>æ¼”ç¿’3ï¼š3å±¤GCNã®å®Ÿè£…</strong></summary>
      <p>2å±¤GCNã‚’æ‹¡å¼µã—ã¦ã€3å±¤ã®GCNãƒ¢ãƒ‡ãƒ«ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚ä¸­é–“å±¤ã®æ¬¡å…ƒæ•°ã¯32ã¨16ã«ã—ã¦ãã ã•ã„ã€‚Coraãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§å­¦ç¿’ã—ã€ç²¾åº¦ã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚</p>
      <p>ãƒ’ãƒ³ãƒˆ: å±¤ã‚’å¢—ã‚„ã™ã¨éå­¦ç¿’ã—ã‚„ã™ããªã‚‹ãŸã‚ã€Dropoutã®èª¿æ•´ãŒå¿…è¦ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚</p>
    </details>

    <details>
      <summary><strong>æ¼”ç¿’4ï¼šã‚¨ãƒƒã‚¸ç‰¹å¾´é‡ã®æ´»ç”¨</strong></summary>
      <p>ã‚¨ãƒƒã‚¸ã«é‡ã¿ï¼ˆç‰¹å¾´é‡ï¼‰ã‚’æŒã¤ã‚°ãƒ©ãƒ•ã‚’ä½œæˆã—ã€<code>edge_attr</code>å±æ€§ã‚’è¨­å®šã—ã¦ãã ã•ã„ã€‚ã‚¨ãƒƒã‚¸ã®é‡ã¿ã¯ãƒ©ãƒ³ãƒ€ãƒ ãªå€¤ï¼ˆ0.1ã€œ1.0ã®ç¯„å›²ï¼‰ã¨ã—ã¦ãã ã•ã„ã€‚</p>
    </details>

    <details>
      <summary><strong>æ¼”ç¿’5ï¼šã‚°ãƒ©ãƒ•ã®å¯è¦–åŒ–</strong></summary>
      <p>NetworkXã¨Matplotlibã‚’ä½¿ã£ã¦ã€ä½œæˆã—ãŸã‚°ãƒ©ãƒ•ã‚’å¯è¦–åŒ–ã—ã¦ãã ã•ã„ã€‚ãƒãƒ¼ãƒ‰ã®è‰²ã‚’ãƒ©ãƒ™ãƒ«ã§åˆ†ã‘ã¦è¡¨ç¤ºã—ã¦ãã ã•ã„ã€‚</p>
      <pre><code class="language-python">import networkx as nx
import matplotlib.pyplot as plt
from torch_geometric.utils import to_networkx

# PyGã®Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’NetworkXã‚°ãƒ©ãƒ•ã«å¤‰æ›
# ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã
</code></pre>
    </details>

    <h2 id="summary">ã¾ã¨ã‚</h2>

    <p>ã“ã®ç« ã§ã¯ã€ã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®åŸºç¤ã‚’å­¦ã³ã¾ã—ãŸï¼š</p>

    <ul>
      <li>âœ… ã‚°ãƒ©ãƒ•ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬æ¦‚å¿µï¼ˆãƒãƒ¼ãƒ‰ã€ã‚¨ãƒƒã‚¸ã€éš£æ¥è¡Œåˆ—ã€ã‚¨ãƒƒã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼‰</li>
      <li>âœ… PyTorch Geometricã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ç’°å¢ƒæ§‹ç¯‰</li>
      <li>âœ… Dataã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹é€ ã¨æ“ä½œæ–¹æ³•</li>
      <li>âœ… çµ„ã¿è¾¼ã¿ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆCoraã€ENZYMESç­‰ï¼‰ã®ä½¿ã„æ–¹</li>
      <li>âœ… GCNConvãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½¿ã£ãŸãƒãƒ¼ãƒ‰åˆ†é¡ã®å®Ÿè£…</li>
    </ul>

    <div class="success-box">
      <p><strong>ğŸ‰ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</strong></p>
      <p>æ¬¡ç« ã§ã¯ã€ã‚°ãƒ©ãƒ•ç•³ã¿è¾¼ã¿ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ï¼ˆGCNï¼‰ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ã®ä»•çµ„ã¿ã‚’è©³ã—ãå­¦ã³ã€ãƒãƒ¼ãƒ‰åˆ†é¡ã‚¿ã‚¹ã‚¯ã‚’å®Œå…¨ã«ç†è§£ã—ã¾ã™ã€‚éå­¦ç¿’å¯¾ç­–ã‚„ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã«ã¤ã„ã¦ã‚‚å®Ÿè·µçš„ã«å­¦ã³ã¾ã™ã€‚</p>
    </div>

    <div class="navigation">
      <a href="./index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºæ¦‚è¦</a>
      <span class="nav-button disabled">ç¬¬2ç« : ã‚°ãƒ©ãƒ•ç•³ã¿è¾¼ã¿ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ ï¼ˆæº–å‚™ä¸­ï¼‰â†’</span>
    </div>

    <hr style="margin: 2rem 0;">

    <p><strong>å‚è€ƒãƒªã‚½ãƒ¼ã‚¹</strong></p>
    <ul>
      <li><a href="https://pytorch-geometric.readthedocs.io/" target="_blank">PyTorch Geometricå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></li>
      <li><a href="https://github.com/pyg-team/pytorch_geometric" target="_blank">PyTorch Geometric GitHub</a></li>
      <li><a href="https://arxiv.org/abs/1609.02907" target="_blank">GCNè«–æ–‡: Semi-Supervised Classification with Graph Convolutional Networks</a></li>
    </ul>

  </main>

  <section class="disclaimer">
    <h3>å…è²¬äº‹é …</h3>
    <ul>
      <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
      <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
      <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
      <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
      <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
      <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
    </ul>
  </section>

  <footer>
    <div class="container">
      <p>&copy; 2025 AI Terakoya - Dr. Yusuke Hashimoto, Tohoku University</p>
      <p>Licensed under CC BY 4.0</p>
    </div>
  </footer>
</body>
</html>
