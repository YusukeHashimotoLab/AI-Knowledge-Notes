<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 2: ÊïôÂ∏´„ÅÇ„ÇäÂ≠¶Áøí„ÅÆÂü∫Á§é - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Chapter 2: ÊïôÂ∏´„ÅÇ„ÇäÂ≠¶Áøí„ÅÆÂü∫Á§é</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">üìñ Ë™≠‰∫ÜÊôÇÈñì: 30-35ÂàÜ</span>
                <span class="meta-item">üìä Èõ£ÊòìÂ∫¶: ÂàùÁ¥ö„Äú‰∏≠Á¥ö</span>
                <span class="meta-item">üíª „Ç≥„Éº„Éâ‰æã: 0ÂÄã</span>
                <span class="meta-item">üìù ÊºîÁøíÂïèÈ°å: 0Âïè</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Chapter 2: ÊïôÂ∏´„ÅÇ„ÇäÂ≠¶Áøí„ÅÆÂü∫Á§é</h1>
<h2>Êú¨Á´†„ÅÆÊ¶ÇË¶Å</h2>
<p>ÊïôÂ∏´„ÅÇ„ÇäÂ≠¶Áøí„ÅØ„ÄÅÂÖ•Âäõ„Éá„Éº„ÇøÔºàÁâπÂæ¥ÈáèÔºâ„Å®Ê≠£Ëß£„É©„Éô„É´„ÅÆ„Éö„Ç¢„Åã„ÇâÂ≠¶Áøí„Åó„ÄÅÊñ∞„Åó„ÅÑ„Éá„Éº„Çø„Å´ÂØæ„Åó„Å¶‰∫àÊ∏¨„ÇíË°å„ÅÜÊâãÊ≥ï„Åß„Åô„ÄÇÊú¨Á´†„Åß„ÅØ„ÄÅÂàÜÈ°û„Å®ÂõûÂ∏∞„ÅÆ‰ª£Ë°®ÁöÑ„Å™„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÇíÂ≠¶„Å≥„ÄÅscikit-learn„Çí‰Ωø„Å£„ÅüÂÆüË£ÖÊñπÊ≥ï„ÇíÁøíÂæó„Åó„Åæ„Åô„ÄÇ</p>
<h3>Â≠¶ÁøíÁõÆÊ®ô</h3>
<ul>
<li>‚úÖ Á∑öÂΩ¢ÂõûÂ∏∞„Å®„É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞„ÅÆÈÅï„ÅÑ„ÇíÁêÜËß£„Åô„Çã</li>
<li>‚úÖ kËøëÂÇçÊ≥ï„ÄÅÊ±∫ÂÆöÊú®„ÄÅSVM„ÅÆ‰ªïÁµÑ„Åø„ÇíË™¨Êòé„Åß„Åç„Çã</li>
<li>‚úÖ scikit-learn„ÅßÂêÑ„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÇíÂÆüË£Ö„Åß„Åç„Çã</li>
<li>‚úÖ ÂïèÈ°å„Å´Âøú„Åò„Å¶ÈÅ©Âàá„Å™„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÇíÈÅ∏Êäû„Åß„Åç„Çã</li>
</ul>
<hr />
<h2>1. Á∑öÂΩ¢ÂõûÂ∏∞ÔºàLinear RegressionÔºâ</h2>
<h3>1.1 Ê¶ÇË¶Å</h3>
<p><strong>Á∑öÂΩ¢ÂõûÂ∏∞</strong>„ÅØ„ÄÅÁâπÂæ¥Èáè„Å®„Çø„Éº„Ç≤„ÉÉ„ÉàÂ§âÊï∞„ÅÆÈñì„Å´Á∑öÂΩ¢Èñ¢‰øÇ„Çí‰ªÆÂÆö„Åó„ÄÅÊúÄÈÅ©„Å™Áõ¥Á∑öÔºà„Åæ„Åü„ÅØË∂ÖÂπ≥Èù¢Ôºâ„ÇíË¶ã„Å§„Åë„ÇãÂõûÂ∏∞„Ç¢„É´„Ç¥„É™„Ç∫„É†„Åß„Åô„ÄÇ</p>
<p><strong>Êï∞Âºè:</strong>
$$
y = w_0 + w_1 x_1 + w_2 x_2 + \cdots + w_n x_n
$$</p>
<ul>
<li>$y$: ‰∫àÊ∏¨ÂÄ§</li>
<li>$x_i$: ÁâπÂæ¥Èáè</li>
<li>$w_i$: Èáç„ÅøÔºà‰øÇÊï∞Ôºâ</li>
<li>$w_0$: ÂàáÁâáÔºà„Éê„Ç§„Ç¢„ÇπÔºâ</li>
</ul>
<h3>1.2 ÊúÄÂ∞è‰∫å‰πóÊ≥ï</h3>
<p>Á∑öÂΩ¢ÂõûÂ∏∞„ÅØ„ÄÅ<strong>ÊúÄÂ∞è‰∫å‰πóÊ≥ï</strong>„Çí‰Ωø„Å£„Å¶ÊúÄÈÅ©„Å™Èáç„Åø„ÇíÊ±Ç„ÇÅ„Åæ„Åô„ÄÇ</p>
<p><strong>ÁõÆÁöÑÈñ¢Êï∞ÔºàÊêçÂ§±Èñ¢Êï∞Ôºâ:</strong>
$$
J(w) = \frac{1}{2m} \sum_{i=1}^{m} (y_i - \hat{y}_i)^2
$$</p>
<ul>
<li>$m$: „Çµ„É≥„Éó„É´Êï∞</li>
<li>$y_i$: ÂÆüÈöõ„ÅÆÂÄ§</li>
<li>$\hat{y}_i$: ‰∫àÊ∏¨ÂÄ§</li>
</ul>
<h3>1.3 ÂÆüË£Ö‰æã</h3>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

# „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÁîüÊàê
np.random.seed(42)
X = np.random.rand(100, 1) * 10
y = 2.5 * X + 5 + np.random.randn(100, 1) * 2

# Ë®ìÁ∑¥„Éª„ÉÜ„Çπ„Éà„Éá„Éº„ÇøÂàÜÂâ≤
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# „É¢„Éá„É´‰ΩúÊàê„Å®Ë®ìÁ∑¥
model = LinearRegression()
model.fit(X_train, y_train)

# ‰∫àÊ∏¨
y_pred = model.predict(X_test)

# Ë©ï‰æ°
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f&quot;‰øÇÊï∞: {model.coef_[0][0]:.2f}&quot;)
print(f&quot;ÂàáÁâá: {model.intercept_[0]:.2f}&quot;)
print(f&quot;MSE: {mse:.2f}&quot;)
print(f&quot;R¬≤„Çπ„Ç≥„Ç¢: {r2:.2f}&quot;)

# ÂèØË¶ñÂåñ
plt.figure(figsize=(10, 6))
plt.scatter(X_test, y_test, color='blue', label='ÂÆüÈöõ„ÅÆÂÄ§', alpha=0.6)
plt.plot(X_test, y_pred, color='red', linewidth=2, label='‰∫àÊ∏¨ÂÄ§')
plt.xlabel('X')
plt.ylabel('y')
plt.title('Á∑öÂΩ¢ÂõûÂ∏∞')
plt.legend()
plt.show()
</code></pre>
<h3>1.4 Âà©ÁÇπ„Å®Ê¨†ÁÇπ</h3>
<p><strong>Âà©ÁÇπ:</strong>
- ‚úÖ „Ç∑„É≥„Éó„É´„ÅßËß£Èáà„Åó„ÇÑ„Åô„ÅÑ
- ‚úÖ Ë®àÁÆó„ÅåÈ´òÈÄü
- ‚úÖ ÈÅéÂ≠¶Áøí„Åó„Å´„Åè„ÅÑ</p>
<p><strong>Ê¨†ÁÇπ:</strong>
- ‚ùå ÈùûÁ∑öÂΩ¢Èñ¢‰øÇ„Çí„ÅÜ„Åæ„ÅèÊçâ„Åà„Çâ„Çå„Å™„ÅÑ
- ‚ùå Â§ñ„ÇåÂÄ§„Å´ÊïèÊÑü
- ‚ùå ÁâπÂæ¥ÈáèÈñì„ÅÆÁõ∏Èñ¢ÔºàÂ§öÈáçÂÖ±Á∑öÊÄßÔºâ„Å´Âº±„ÅÑ</p>
<hr />
<h2>2. „É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞ÔºàLogistic RegressionÔºâ</h2>
<h3>2.1 Ê¶ÇË¶Å</h3>
<p><strong>„É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞</strong>„ÅØ„ÄÅÂàÜÈ°ûÂïèÈ°å„Å´‰Ωø„Çè„Çå„Çã„Ç¢„É´„Ç¥„É™„Ç∫„É†„Åß„ÄÅÁ∑öÂΩ¢„É¢„Éá„É´„ÅÆÂá∫Âäõ„Çí„Ç∑„Ç∞„É¢„Ç§„ÉâÈñ¢Êï∞„Åß0„Äú1„ÅÆÁ¢∫Áéá„Å´Â§âÊèõ„Åó„Åæ„Åô„ÄÇ</p>
<p><strong>„Ç∑„Ç∞„É¢„Ç§„ÉâÈñ¢Êï∞:</strong>
$$
\sigma(z) = \frac{1}{1 + e^{-z}}
$$</p>
<h3>2.2 Ê±∫ÂÆöÂ¢ÉÁïå</h3>
<p>„É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞„ÅØ„ÄÅÁâπÂæ¥Á©∫Èñì„Çí2„Å§„ÅÆ„ÇØ„É©„Çπ„Å´ÂàÜ„Åë„Çã<strong>Ê±∫ÂÆöÂ¢ÉÁïå</strong>„ÇíÂ≠¶Áøí„Åó„Åæ„Åô„ÄÇ</p>
<h3>2.3 ÂÆüË£Ö‰æã: „Ç¢„Ç§„É™„ÇπÂàÜÈ°ûÔºà2„ÇØ„É©„ÇπÔºâ</h3>
<pre><code class="language-python">from sklearn.datasets import load_iris
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
import seaborn as sns

# „Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÔºà2„ÇØ„É©„Çπ„ÅÆ„Åø‰ΩøÁî®Ôºâ
iris = load_iris()
X = iris.data[iris.target != 2]  # setosa„Å®versicolor
y = iris.target[iris.target != 2]

# Ë®ìÁ∑¥„Éª„ÉÜ„Çπ„Éà„Éá„Éº„ÇøÂàÜÂâ≤
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

# „É¢„Éá„É´‰ΩúÊàê„Å®Ë®ìÁ∑¥
model = LogisticRegression(random_state=42)
model.fit(X_train, y_train)

# ‰∫àÊ∏¨
y_pred = model.predict(X_test)
y_prob = model.predict_proba(X_test)  # Á¢∫Áéá

# Ë©ï‰æ°
accuracy = accuracy_score(y_test, y_pred)
print(f&quot;Ê≠£Ëß£Áéá: {accuracy:.2%}&quot;)
print(&quot;\nÂàÜÈ°û„É¨„Éù„Éº„Éà:&quot;)
print(classification_report(y_test, y_pred, target_names=['setosa', 'versicolor']))

# Ê∑∑ÂêåË°åÂàó
cm = confusion_matrix(y_test, y_pred)
plt.figure(figsize=(6, 5))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues',
            xticklabels=['setosa', 'versicolor'],
            yticklabels=['setosa', 'versicolor'])
plt.ylabel('ÂÆüÈöõ„ÅÆ„É©„Éô„É´')
plt.xlabel('‰∫àÊ∏¨„É©„Éô„É´')
plt.title('Ê∑∑ÂêåË°åÂàó')
plt.show()
</code></pre>
<h3>2.4 Â§ö„ÇØ„É©„ÇπÂàÜÈ°û</h3>
<p>„É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞„ÅØ„ÄÅ<strong>One-vs-Rest (OvR)</strong> „Åæ„Åü„ÅØ <strong>Multinomial</strong> ÊñπÂºè„ÅßÂ§ö„ÇØ„É©„ÇπÂàÜÈ°û„Å´„ÇÇÂØæÂøú„Åß„Åç„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python"># Â§ö„ÇØ„É©„ÇπÂàÜÈ°ûÔºàÂÖ®3„ÇØ„É©„ÇπÔºâ
iris = load_iris()
X, y = iris.data, iris.target

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

model = LogisticRegression(multi_class='multinomial', max_iter=200)
model.fit(X_train, y_train)

accuracy = model.score(X_test, y_test)
print(f&quot;Â§ö„ÇØ„É©„ÇπÂàÜÈ°û„ÅÆÊ≠£Ëß£Áéá: {accuracy:.2%}&quot;)
</code></pre>
<hr />
<h2>3. kËøëÂÇçÊ≥ïÔºàk-Nearest Neighbors, k-NNÔºâ</h2>
<h3>3.1 Ê¶ÇË¶Å</h3>
<p><strong>kËøëÂÇçÊ≥ï</strong>„ÅØ„ÄÅÊñ∞„Åó„ÅÑ„Éá„Éº„Çø„Éù„Ç§„É≥„Éà„Å´ÊúÄ„ÇÇËøë„ÅÑ$k$ÂÄã„ÅÆË®ìÁ∑¥„Éá„Éº„Çø„ÇíË¶ã„Å§„Åë„ÄÅ„Åù„Çå„Çâ„ÅÆÂ§öÊï∞Ê±∫ÔºàÂàÜÈ°ûÔºâ„Åæ„Åü„ÅØÂπ≥ÂùáÔºàÂõûÂ∏∞Ôºâ„Åß‰∫àÊ∏¨„Åó„Åæ„Åô„ÄÇ</p>
<div class="mermaid">
graph TD
    A[Êñ∞„Åó„ÅÑ„Éá„Éº„ÇøÁÇπ] --> B[Ë∑ùÈõ¢Ë®àÁÆó]
    B --> C[kÂÄã„ÅÆÊúÄËøëÂÇç„ÇíÈÅ∏Êäû]
    C --> D[Â§öÊï∞Ê±∫ or Âπ≥Âùá]
    D --> E[‰∫àÊ∏¨ÁµêÊûú]
</div>

<h3>3.2 Ë∑ùÈõ¢„ÅÆË®àÁÆó</h3>
<p><strong>„É¶„Éº„ÇØ„É™„ÉÉ„ÉâË∑ùÈõ¢:</strong>
$$
d(x, x') = \sqrt{\sum_{i=1}^{n} (x_i - x'_i)^2}
$$</p>
<h3>3.3 ÂÆüË£Ö‰æã: ÂàÜÈ°û</h3>
<pre><code class="language-python">from sklearn.neighbors import KNeighborsClassifier
from sklearn.preprocessing import StandardScaler

# „Éá„Éº„ÇøÊ∫ñÂÇô
iris = load_iris()
X, y = iris.data, iris.target

# Ê®ôÊ∫ñÂåñÔºàk-NN„ÅØË∑ùÈõ¢„Éô„Éº„Çπ„Å™„ÅÆ„Åß„Çπ„Ç±„Éº„É´„ÅåÈáçË¶ÅÔºâ
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# Ë®ìÁ∑¥„Éª„ÉÜ„Çπ„Éà„Éá„Éº„ÇøÂàÜÂâ≤
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.3, random_state=42
)

# k„ÅÆÂÄ§„ÇíÂ§â„Åà„Å¶ÊÄßËÉΩ„ÇíÊØîËºÉ
k_values = [1, 3, 5, 7, 9, 11]
accuracies = []

for k in k_values:
    model = KNeighborsClassifier(n_neighbors=k)
    model.fit(X_train, y_train)
    accuracy = model.score(X_test, y_test)
    accuracies.append(accuracy)
    print(f&quot;k={k}: Ê≠£Ëß£Áéá {accuracy:.2%}&quot;)

# ÊúÄÈÅ©„Å™k„ÅÆÂèØË¶ñÂåñ
plt.figure(figsize=(10, 6))
plt.plot(k_values, accuracies, marker='o', linewidth=2)
plt.xlabel('kÔºàËøëÂÇçÊï∞Ôºâ')
plt.ylabel('Ê≠£Ëß£Áéá')
plt.title('kÂÄ§„Å®ÊÄßËÉΩ„ÅÆÈñ¢‰øÇ')
plt.xticks(k_values)
plt.grid(True)
plt.show()
</code></pre>
<h3>3.4 Âà©ÁÇπ„Å®Ê¨†ÁÇπ</h3>
<p><strong>Âà©ÁÇπ:</strong>
- ‚úÖ „Ç∑„É≥„Éó„É´„ÅßÁõ¥ÊÑüÁöÑ
- ‚úÖ ÈùûÁ∑öÂΩ¢„Å™Ê±∫ÂÆöÂ¢ÉÁïå„ÇíÂ≠¶ÁøíÂèØËÉΩ
- ‚úÖ Â≠¶Áøí„Åå‰∏çË¶ÅÔºà„Ç§„É≥„Çπ„Çø„É≥„Çπ„Éô„Éº„ÇπÔºâ</p>
<p><strong>Ê¨†ÁÇπ:</strong>
- ‚ùå ‰∫àÊ∏¨„ÅåÈÅÖ„ÅÑÔºàÂÖ®„Éá„Éº„Çø„Å®„ÅÆË∑ùÈõ¢Ë®àÁÆó„ÅåÂøÖË¶ÅÔºâ
- ‚ùå È´òÊ¨°ÂÖÉ„Éá„Éº„Çø„Å´Âº±„ÅÑÔºàÊ¨°ÂÖÉ„ÅÆÂë™„ÅÑÔºâ
- ‚ùå ‰∏çÂùáË°°„Éá„Éº„Çø„Å´Âº±„ÅÑ</p>
<hr />
<h2>4. Ê±∫ÂÆöÊú®ÔºàDecision TreeÔºâ</h2>
<h3>4.1 Ê¶ÇË¶Å</h3>
<p><strong>Ê±∫ÂÆöÊú®</strong>„ÅØ„ÄÅ„Éá„Éº„Çø„ÇíÊú®ÊßãÈÄ†„ÅßÂàÜÂ≤ê„Åï„Åõ„Å™„Åå„ÇâÂàÜÈ°û„ÉªÂõûÂ∏∞„ÇíË°å„ÅÜ„Ç¢„É´„Ç¥„É™„Ç∫„É†„Åß„Åô„ÄÇ</p>
<div class="mermaid">
graph TD
    A[Ëä±„Å≥„Çâ„ÅÆÈï∑„Åï <= 2.45?] -->|Yes| B[Setosa]
    A -->|No| C[Ëä±„Å≥„Çâ„ÅÆÂπÖ <= 1.75?]
    C -->|Yes| D[Versicolor]
    C -->|No| E[Virginica]
</div>

<h3>4.2 ÂàÜÂ≤êÂü∫Ê∫ñ</h3>
<p><strong>„Ç∏„Éã‰∏çÁ¥îÂ∫¶ÔºàGini ImpurityÔºâ:</strong>
$$
Gini = 1 - \sum_{i=1}^{C} p_i^2
$$</p>
<ul>
<li>$C$: „ÇØ„É©„ÇπÊï∞</li>
<li>$p_i$: „ÇØ„É©„Çπ$i$„ÅÆÂâ≤Âêà</li>
</ul>
<p><strong>ÊÉÖÂ†±Âà©ÂæóÔºàInformation GainÔºâ:</strong>
„Ç®„É≥„Éà„É≠„Éî„Éº„ÅÆÊ∏õÂ∞ëÈáè„ÇíÂü∫Ê∫ñ„Å´ÂàÜÂ≤ê</p>
<h3>4.3 ÂÆüË£Ö‰æã</h3>
<pre><code class="language-python">from sklearn.tree import DecisionTreeClassifier, plot_tree

# „Éá„Éº„ÇøÊ∫ñÂÇô
iris = load_iris()
X, y = iris.data, iris.target

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

# Ê±∫ÂÆöÊú®„É¢„Éá„É´
model = DecisionTreeClassifier(
    max_depth=3,  # Ê∑±„Åï„ÇíÂà∂ÈôêÔºàÈÅéÂ≠¶ÁøíÈò≤Ê≠¢Ôºâ
    random_state=42
)
model.fit(X_train, y_train)

# Ë©ï‰æ°
accuracy = model.score(X_test, y_test)
print(f&quot;Ê≠£Ëß£Áéá: {accuracy:.2%}&quot;)

# ÁâπÂæ¥Èáè„ÅÆÈáçË¶ÅÂ∫¶
feature_importance = pd.DataFrame({
    'ÁâπÂæ¥Èáè': iris.feature_names,
    'ÈáçË¶ÅÂ∫¶': model.feature_importances_
}).sort_values('ÈáçË¶ÅÂ∫¶', ascending=False)

print(&quot;\nÁâπÂæ¥Èáè„ÅÆÈáçË¶ÅÂ∫¶:&quot;)
print(feature_importance)

# Êú®ÊßãÈÄ†„ÅÆÂèØË¶ñÂåñ
plt.figure(figsize=(20, 10))
plot_tree(model, feature_names=iris.feature_names,
         class_names=iris.target_names, filled=True, fontsize=10)
plt.title('Ê±∫ÂÆöÊú®„ÅÆÂèØË¶ñÂåñ')
plt.show()
</code></pre>
<h3>4.4 ÈÅéÂ≠¶Áøí„ÅÆÈò≤Ê≠¢</h3>
<p>Ê±∫ÂÆöÊú®„ÅØÈÅéÂ≠¶Áøí„Åó„ÇÑ„Åô„ÅÑ„Åü„ÇÅ„ÄÅ‰ª•‰∏ã„ÅÆ„Éë„É©„É°„Éº„Çø„ÅßÂà∂Âæ°„Åó„Åæ„ÅôÔºö</p>
<pre><code class="language-python">model = DecisionTreeClassifier(
    max_depth=5,           # ÊúÄÂ§ß„ÅÆÊ∑±„Åï
    min_samples_split=20,  # ÂàÜÂ≤ê„Å´ÂøÖË¶Å„Å™ÊúÄÂ∞è„Çµ„É≥„Éó„É´Êï∞
    min_samples_leaf=10,   # Ëëâ„Éé„Éº„Éâ„ÅÆÊúÄÂ∞è„Çµ„É≥„Éó„É´Êï∞
    max_features='sqrt'    # ÂêÑÂàÜÂ≤ê„Åß‰ΩøÁî®„Åô„ÇãÁâπÂæ¥ÈáèÊï∞
)
</code></pre>
<hr />
<h2>5. „Çµ„Éù„Éº„Éà„Éô„ÇØ„Çø„Éº„Éû„Ç∑„É≥ÔºàSVMÔºâ</h2>
<h3>5.1 Ê¶ÇË¶Å</h3>
<p><strong>SVM</strong>„ÅØ„ÄÅ„ÇØ„É©„ÇπÈñì„ÅÆ„Éû„Éº„Ç∏„É≥Ôºà‰ΩôÁôΩÔºâ„ÇíÊúÄÂ§ßÂåñ„Åô„ÇãÊ±∫ÂÆöÂ¢ÉÁïå„ÇíÂ≠¶Áøí„Åô„Çã„Ç¢„É´„Ç¥„É™„Ç∫„É†„Åß„Åô„ÄÇ</p>
<div class="mermaid">
graph LR
    A[„Éá„Éº„ÇøÁÇπ] --> B[„Éû„Éº„Ç∏„É≥ÊúÄÂ§ßÂåñ]
    B --> C[ÊúÄÈÅ©„Å™Ë∂ÖÂπ≥Èù¢]
    C --> D[ÂàÜÈ°û]
</div>

<h3>5.2 „Ç´„Éº„Éç„É´„Éà„É™„ÉÉ„ÇØ</h3>
<p>SVM„ÅØ<strong>„Ç´„Éº„Éç„É´„Éà„É™„ÉÉ„ÇØ</strong>„Çí‰Ωø„Å£„Å¶„ÄÅÈùûÁ∑öÂΩ¢„Å™Ê±∫ÂÆöÂ¢ÉÁïå„ÇíÂ≠¶Áøí„Åß„Åç„Åæ„Åô„ÄÇ</p>
<p><strong>‰∏ª„Å™„Ç´„Éº„Éç„É´:</strong>
- <strong>Á∑öÂΩ¢ÔºàlinearÔºâ</strong>: Á∑öÂΩ¢ÂàÜÈõ¢ÂèØËÉΩ„Å™Â†¥Âêà
- <strong>RBFÔºàGaussianÔºâ</strong>: ‰∏ÄËà¨ÁöÑ„Å™ÈùûÁ∑öÂΩ¢ÂïèÈ°å
- <strong>Â§öÈ†ÖÂºèÔºàpolyÔºâ</strong>: Â§öÈ†ÖÂºè„ÅÆÊ±∫ÂÆöÂ¢ÉÁïå
- <strong>„Ç∑„Ç∞„É¢„Ç§„ÉâÔºàsigmoidÔºâ</strong>: „Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Å´È°û‰ºº</p>
<h3>5.3 ÂÆüË£Ö‰æã</h3>
<pre><code class="language-python">from sklearn.svm import SVC
from sklearn.preprocessing import StandardScaler

# „Éá„Éº„ÇøÊ∫ñÂÇô„Å®Ê®ôÊ∫ñÂåñ
iris = load_iris()
X, y = iris.data, iris.target

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.3, random_state=42
)

# Áï∞„Å™„Çã„Ç´„Éº„Éç„É´„ÅßÊØîËºÉ
kernels = ['linear', 'poly', 'rbf', 'sigmoid']

for kernel in kernels:
    model = SVC(kernel=kernel, random_state=42)
    model.fit(X_train, y_train)
    accuracy = model.score(X_test, y_test)
    print(f&quot;{kernel}„Ç´„Éº„Éç„É´: Ê≠£Ëß£Áéá {accuracy:.2%}&quot;)
</code></pre>
<h3>5.4 „Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø</h3>
<p><strong>CÔºàÊ≠£ÂâáÂåñ„Éë„É©„É°„Éº„ÇøÔºâ:</strong>
- Â§ß„Åç„ÅÑÂÄ§: „Éû„Éº„Ç∏„É≥„ÅåÁã≠„ÅÑÔºàÈÅéÂ≠¶Áøí„É™„Çπ„ÇØÔºâ
- Â∞è„Åï„ÅÑÂÄ§: „Éû„Éº„Ç∏„É≥„ÅåÂ∫É„ÅÑÔºàÈÅéÂ∞ëÂ≠¶Áøí„É™„Çπ„ÇØÔºâ</p>
<p><strong>gammaÔºàRBF„Ç´„Éº„Éç„É´„ÅÆ„Éë„É©„É°„Éº„ÇøÔºâ:</strong>
- Â§ß„Åç„ÅÑÂÄ§: Ê±∫ÂÆöÂ¢ÉÁïå„ÅåË§áÈõëÔºàÈÅéÂ≠¶Áøí„É™„Çπ„ÇØÔºâ
- Â∞è„Åï„ÅÑÂÄ§: Ê±∫ÂÆöÂ¢ÉÁïå„ÅåÊªë„Çâ„Åã</p>
<pre><code class="language-python">from sklearn.model_selection import GridSearchCV

# „Ç∞„É™„ÉÉ„Éâ„Çµ„Éº„ÉÅ„Åß„Éë„É©„É°„Éº„ÇøÊúÄÈÅ©Âåñ
param_grid = {
    'C': [0.1, 1, 10, 100],
    'gamma': ['scale', 'auto', 0.001, 0.01, 0.1],
    'kernel': ['rbf']
}

grid_search = GridSearchCV(SVC(), param_grid, cv=5)
grid_search.fit(X_train, y_train)

print(f&quot;ÊúÄÈÅ©„Å™„Éë„É©„É°„Éº„Çø: {grid_search.best_params_}&quot;)
print(f&quot;ÊúÄËâØ„Çπ„Ç≥„Ç¢: {grid_search.best_score_:.2%}&quot;)
</code></pre>
<hr />
<h2>6. „Ç¢„É´„Ç¥„É™„Ç∫„É†ÊØîËºÉ„Å®ÈÅ∏Êäû</h2>
<h3>6.1 ÊÄßËÉΩÊØîËºÉ</h3>
<pre><code class="language-python">from sklearn.datasets import load_iris
from sklearn.model_selection import cross_val_score
import pandas as pd

# „Éá„Éº„ÇøÊ∫ñÂÇô
iris = load_iris()
X, y = iris.data, iris.target

# ÂêÑ„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅÆ‰∫§Â∑ÆÊ§úË®º„Çπ„Ç≥„Ç¢
models = {
    'Á∑öÂΩ¢ÂõûÂ∏∞': LinearRegression(),  # ÂõûÂ∏∞„Å™„ÅÆ„Åß‰∏çÈÅ©ÂàáÔºàÂèÇËÄÉÔºâ
    '„É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞': LogisticRegression(max_iter=200),
    'k-NN (k=5)': KNeighborsClassifier(n_neighbors=5),
    'Ê±∫ÂÆöÊú®': DecisionTreeClassifier(max_depth=5, random_state=42),
    'SVM (RBF)': SVC(kernel='rbf', random_state=42)
}

results = []
for name, model in models.items():
    if name != 'Á∑öÂΩ¢ÂõûÂ∏∞':  # ÂàÜÈ°ûÂïèÈ°å„Å™„ÅÆ„Åß„Çπ„Ç≠„ÉÉ„Éó
        scores = cross_val_score(model, X, y, cv=5)
        results.append({
            '„Ç¢„É´„Ç¥„É™„Ç∫„É†': name,
            'Âπ≥Âùá„Çπ„Ç≥„Ç¢': scores.mean(),
            'Ê®ôÊ∫ñÂÅèÂ∑Æ': scores.std()
        })

df_results = pd.DataFrame(results)
print(df_results.sort_values('Âπ≥Âùá„Çπ„Ç≥„Ç¢', ascending=False))
</code></pre>
<h3>6.2 ÈÅ∏Êäû„Ç¨„Ç§„Éâ„É©„Ç§„É≥</h3>
<table>
<thead>
<tr>
<th>Êù°‰ª∂</th>
<th>Êé®Â•®„Ç¢„É´„Ç¥„É™„Ç∫„É†</th>
<th>ÁêÜÁî±</th>
</tr>
</thead>
<tbody>
<tr>
<td>„Éá„Éº„Çø„ÅåÁ∑öÂΩ¢ÂàÜÈõ¢ÂèØËÉΩ</td>
<td>„É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞„ÄÅÁ∑öÂΩ¢SVM</td>
<td>„Ç∑„É≥„Éó„É´„ÅßÈ´òÈÄü</td>
</tr>
<tr>
<td>ÈùûÁ∑öÂΩ¢„Å™Èñ¢‰øÇ</td>
<td>Ê±∫ÂÆöÊú®„ÄÅRBF-SVM„ÄÅk-NN</td>
<td>Ë§áÈõë„Å™„Éë„Çø„Éº„É≥„ÇíÊçâ„Åà„Çã</td>
</tr>
<tr>
<td>Ëß£ÈáàÊÄß„ÅåÈáçË¶Å</td>
<td>Ê±∫ÂÆöÊú®„ÄÅÁ∑öÂΩ¢ÂõûÂ∏∞</td>
<td>Ë¶ñË¶öÂåñ„ÉªË™¨Êòé„Åó„ÇÑ„Åô„ÅÑ</td>
</tr>
<tr>
<td>È´òÊ¨°ÂÖÉ„Éá„Éº„Çø</td>
<td>SVM„ÄÅ„É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞</td>
<td>Ê¨°ÂÖÉ„ÅÆÂë™„ÅÑ„Å´Âº∑„ÅÑ</td>
</tr>
<tr>
<td>Â∞èË¶èÊ®°„Éá„Éº„Çø</td>
<td>SVM„ÄÅk-NN</td>
<td>Â∞ë„Å™„ÅÑ„Éá„Éº„Çø„Åß„ÇÇÊÄßËÉΩËâØÂ•Ω</td>
</tr>
<tr>
<td>Â§ßË¶èÊ®°„Éá„Éº„Çø</td>
<td>„É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞„ÄÅÊ±∫ÂÆöÊú®</td>
<td>Ë®àÁÆó„ÅåÈ´òÈÄü</td>
</tr>
</tbody>
</table>
<hr />
<h2>7. „Åæ„Å®„ÇÅ</h2>
<h3>7.1 Êú¨Á´†„ÅßÂ≠¶„Çì„Å†„Åì„Å®</h3>
<p>‚úÖ <strong>5„Å§„ÅÆ‰∏ªË¶Å„Ç¢„É´„Ç¥„É™„Ç∫„É†</strong>
- Á∑öÂΩ¢ÂõûÂ∏∞: ÈÄ£Á∂öÂÄ§‰∫àÊ∏¨
- „É≠„Ç∏„Çπ„ÉÜ„Ç£„ÉÉ„ÇØÂõûÂ∏∞: Á¢∫ÁéáÁöÑÂàÜÈ°û
- k-NN: „Ç§„É≥„Çπ„Çø„É≥„Çπ„Éô„Éº„ÇπÂ≠¶Áøí
- Ê±∫ÂÆöÊú®: Êú®ÊßãÈÄ†„Å´„Çà„ÇãÂàÜÈ°û„ÉªÂõûÂ∏∞
- SVM: „Éû„Éº„Ç∏„É≥ÊúÄÂ§ßÂåñ</p>
<p>‚úÖ <strong>ÂÆüË£Ö„Çπ„Ç≠„É´</strong>
- scikit-learn„Åß„ÅÆÂÆüË£ÖÊñπÊ≥ï
- „Éë„É©„É°„Éº„Çø„ÉÅ„É•„Éº„Éã„É≥„Ç∞
- „É¢„Éá„É´Ë©ï‰æ°„Å®ÊØîËºÉ</p>
<p>‚úÖ <strong>ÈÅ∏ÊäûÂü∫Ê∫ñ</strong>
- ÂïèÈ°å„Å®„Éá„Éº„Çø„Å´Âøú„Åò„Åü„Ç¢„É´„Ç¥„É™„Ç∫„É†ÈÅ∏Êäû</p>
<h3>7.2 Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó</h3>
<p>Ê¨°Á´†„Åß„ÅØ„ÄÅÊïôÂ∏´„Å™„ÅóÂ≠¶ÁøíÔºà„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞„ÉªÊ¨°ÂÖÉÂâäÊ∏õÔºâ„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>
<hr />
<h2>8. Á∑¥ÁøíÂïèÈ°å</h2>
<h3>ÂïèÈ°å1: „ÉØ„Ç§„É≥ÂìÅË≥™‰∫àÊ∏¨ÔºàÂü∫Á§éÔºâ</h3>
<p>„ÉØ„Ç§„É≥„ÅÆÁâπÂæ¥Èáè„Åã„ÇâÂìÅË≥™„Çí‰∫àÊ∏¨„Åô„Çã„É¢„Éá„É´„Çí‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<pre><code class="language-python">from sklearn.datasets import load_wine

wine = load_wine()
X, y = wine.data, wine.target

# „Åì„Åì„Å´ÂÆüË£Ö
</code></pre>
<details>
<summary>Ëß£Á≠î‰æã</summary>


<pre><code class="language-python">from sklearn.datasets import load_wine
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report

wine = load_wine()
X, y = wine.data, wine.target

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

model = RandomForestClassifier(random_state=42)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)
print(classification_report(y_test, y_pred))
</code></pre>


</details>

<hr />
<p><strong>Ê¨°„Å∏</strong>: <a href="chapter-3.html">Chapter 3: ÊïôÂ∏´„Å™„ÅóÂ≠¶Áøí„ÅÆÂü∫Á§é ‚Üí</a></p>
<p><strong>Ââç„Å∏</strong>: <a href="chapter-1.html">‚Üê Chapter 1: Ê©üÊ¢∞Â≠¶Áøí„ÅÆÂü∫Á§é</a></p>
<p><strong>ÁõÆÊ¨°„Å∏</strong>: <a href="index.html">‚Üë „Ç∑„É™„Éº„Ç∫ÁõÆÊ¨°</a></p><div class="navigation">
    <a href="chapter-1.html" class="nav-button">‚Üê Á¨¨1Á´†</a>
    <a href="index.html" class="nav-button">„Ç∑„É™„Éº„Ç∫ÁõÆÊ¨°„Å´Êàª„Çã</a>
    <a href="chapter-3.html" class="nav-button">Á¨¨3Á´† ‚Üí</a>
</div>
    </main>

    <footer>
        <p><strong>‰ΩúÊàêËÄÖ</strong>: AI Terakoya Content Team</p>
        <p><strong>Áõ£‰øÆ</strong>: Dr. Yusuke HashimotoÔºàÊù±ÂåóÂ§ßÂ≠¶Ôºâ</p>
        <p><strong>„Éê„Éº„Ç∏„Éß„É≥</strong>: 1.0 | <strong>‰ΩúÊàêÊó•</strong>: 2025-10-17</p>
        <p><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: Creative Commons BY 4.0</p>
        <p>¬© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
