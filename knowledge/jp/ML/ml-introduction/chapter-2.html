<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 2: æ•™å¸«ã‚ã‚Šå­¦ç¿’ã®åŸºç¤ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Chapter 2: æ•™å¸«ã‚ã‚Šå­¦ç¿’ã®åŸºç¤</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 30-35åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 0å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 0å•</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Chapter 2: æ•™å¸«ã‚ã‚Šå­¦ç¿’ã®åŸºç¤</h1>
<h2>æœ¬ç« ã®æ¦‚è¦</h2>
<p>æ•™å¸«ã‚ã‚Šå­¦ç¿’ã¯ã€å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼ˆç‰¹å¾´é‡ï¼‰ã¨æ­£è§£ãƒ©ãƒ™ãƒ«ã®ãƒšã‚¢ã‹ã‚‰å­¦ç¿’ã—ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦äºˆæ¸¬ã‚’è¡Œã†æ‰‹æ³•ã§ã™ã€‚æœ¬ç« ã§ã¯ã€åˆ†é¡ã¨å›å¸°ã®ä»£è¡¨çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å­¦ã³ã€scikit-learnã‚’ä½¿ã£ãŸå®Ÿè£…æ–¹æ³•ã‚’ç¿’å¾—ã—ã¾ã™ã€‚</p>
<h3>å­¦ç¿’ç›®æ¨™</h3>
<ul>
<li>âœ… ç·šå½¢å›å¸°ã¨ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã®é•ã„ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… kè¿‘å‚æ³•ã€æ±ºå®šæœ¨ã€SVMã®ä»•çµ„ã¿ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… scikit-learnã§å„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å®Ÿè£…ã§ãã‚‹</li>
<li>âœ… å•é¡Œã«å¿œã˜ã¦é©åˆ‡ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸æŠã§ãã‚‹</li>
</ul>
<hr />
<h2>1. ç·šå½¢å›å¸°ï¼ˆLinear Regressionï¼‰</h2>
<h3>1.1 æ¦‚è¦</h3>
<p><strong>ç·šå½¢å›å¸°</strong>ã¯ã€ç‰¹å¾´é‡ã¨ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå¤‰æ•°ã®é–“ã«ç·šå½¢é–¢ä¿‚ã‚’ä»®å®šã—ã€æœ€é©ãªç›´ç·šï¼ˆã¾ãŸã¯è¶…å¹³é¢ï¼‰ã‚’è¦‹ã¤ã‘ã‚‹å›å¸°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚</p>
<p><strong>æ•°å¼:</strong>
$$
y = w_0 + w_1 x_1 + w_2 x_2 + \cdots + w_n x_n
$$</p>
<ul>
<li>$y$: äºˆæ¸¬å€¤</li>
<li>$x_i$: ç‰¹å¾´é‡</li>
<li>$w_i$: é‡ã¿ï¼ˆä¿‚æ•°ï¼‰</li>
<li>$w_0$: åˆ‡ç‰‡ï¼ˆãƒã‚¤ã‚¢ã‚¹ï¼‰</li>
</ul>
<h3>1.2 æœ€å°äºŒä¹—æ³•</h3>
<p>ç·šå½¢å›å¸°ã¯ã€<strong>æœ€å°äºŒä¹—æ³•</strong>ã‚’ä½¿ã£ã¦æœ€é©ãªé‡ã¿ã‚’æ±‚ã‚ã¾ã™ã€‚</p>
<p><strong>ç›®çš„é–¢æ•°ï¼ˆæå¤±é–¢æ•°ï¼‰:</strong>
$$
J(w) = \frac{1}{2m} \sum_{i=1}^{m} (y_i - \hat{y}_i)^2
$$</p>
<ul>
<li>$m$: ã‚µãƒ³ãƒ—ãƒ«æ•°</li>
<li>$y_i$: å®Ÿéš›ã®å€¤</li>
<li>$\hat{y}_i$: äºˆæ¸¬å€¤</li>
</ul>
<h3>1.3 å®Ÿè£…ä¾‹</h3>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_squared_error, r2_score

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
np.random.seed(42)
X = np.random.rand(100, 1) * 10
y = 2.5 * X + 5 + np.random.randn(100, 1) * 2

# è¨“ç·´ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# ãƒ¢ãƒ‡ãƒ«ä½œæˆã¨è¨“ç·´
model = LinearRegression()
model.fit(X_train, y_train)

# äºˆæ¸¬
y_pred = model.predict(X_test)

# è©•ä¾¡
mse = mean_squared_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f&quot;ä¿‚æ•°: {model.coef_[0][0]:.2f}&quot;)
print(f&quot;åˆ‡ç‰‡: {model.intercept_[0]:.2f}&quot;)
print(f&quot;MSE: {mse:.2f}&quot;)
print(f&quot;RÂ²ã‚¹ã‚³ã‚¢: {r2:.2f}&quot;)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
plt.scatter(X_test, y_test, color='blue', label='å®Ÿéš›ã®å€¤', alpha=0.6)
plt.plot(X_test, y_pred, color='red', linewidth=2, label='äºˆæ¸¬å€¤')
plt.xlabel('X')
plt.ylabel('y')
plt.title('ç·šå½¢å›å¸°')
plt.legend()
plt.show()
</code></pre>
<h3>1.4 åˆ©ç‚¹ã¨æ¬ ç‚¹</h3>
<p><strong>åˆ©ç‚¹:</strong>
- âœ… ã‚·ãƒ³ãƒ—ãƒ«ã§è§£é‡ˆã—ã‚„ã™ã„
- âœ… è¨ˆç®—ãŒé«˜é€Ÿ
- âœ… éå­¦ç¿’ã—ã«ãã„</p>
<p><strong>æ¬ ç‚¹:</strong>
- âŒ éç·šå½¢é–¢ä¿‚ã‚’ã†ã¾ãæ‰ãˆã‚‰ã‚Œãªã„
- âŒ å¤–ã‚Œå€¤ã«æ•æ„Ÿ
- âŒ ç‰¹å¾´é‡é–“ã®ç›¸é–¢ï¼ˆå¤šé‡å…±ç·šæ€§ï¼‰ã«å¼±ã„</p>
<hr />
<h2>2. ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ï¼ˆLogistic Regressionï¼‰</h2>
<h3>2.1 æ¦‚è¦</h3>
<p><strong>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</strong>ã¯ã€åˆ†é¡å•é¡Œã«ä½¿ã‚ã‚Œã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã€ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã®å‡ºåŠ›ã‚’ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã§0ã€œ1ã®ç¢ºç‡ã«å¤‰æ›ã—ã¾ã™ã€‚</p>
<p><strong>ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°:</strong>
$$
\sigma(z) = \frac{1}{1 + e^{-z}}
$$</p>
<h3>2.2 æ±ºå®šå¢ƒç•Œ</h3>
<p>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã¯ã€ç‰¹å¾´ç©ºé–“ã‚’2ã¤ã®ã‚¯ãƒ©ã‚¹ã«åˆ†ã‘ã‚‹<strong>æ±ºå®šå¢ƒç•Œ</strong>ã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>
<h3>2.3 å®Ÿè£…ä¾‹: ã‚¢ã‚¤ãƒªã‚¹åˆ†é¡ï¼ˆ2ã‚¯ãƒ©ã‚¹ï¼‰</h3>
<pre><code class="language-python">from sklearn.datasets import load_iris
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, confusion_matrix, classification_report
import seaborn as sns

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ï¼ˆ2ã‚¯ãƒ©ã‚¹ã®ã¿ä½¿ç”¨ï¼‰
iris = load_iris()
X = iris.data[iris.target != 2]  # setosaã¨versicolor
y = iris.target[iris.target != 2]

# è¨“ç·´ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

# ãƒ¢ãƒ‡ãƒ«ä½œæˆã¨è¨“ç·´
model = LogisticRegression(random_state=42)
model.fit(X_train, y_train)

# äºˆæ¸¬
y_pred = model.predict(X_test)
y_prob = model.predict_proba(X_test)  # ç¢ºç‡

# è©•ä¾¡
accuracy = accuracy_score(y_test, y_pred)
print(f&quot;æ­£è§£ç‡: {accuracy:.2%}&quot;)
print(&quot;\nåˆ†é¡ãƒ¬ãƒãƒ¼ãƒˆ:&quot;)
print(classification_report(y_test, y_pred, target_names=['setosa', 'versicolor']))

# æ··åŒè¡Œåˆ—
cm = confusion_matrix(y_test, y_pred)
plt.figure(figsize=(6, 5))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues',
            xticklabels=['setosa', 'versicolor'],
            yticklabels=['setosa', 'versicolor'])
plt.ylabel('å®Ÿéš›ã®ãƒ©ãƒ™ãƒ«')
plt.xlabel('äºˆæ¸¬ãƒ©ãƒ™ãƒ«')
plt.title('æ··åŒè¡Œåˆ—')
plt.show()
</code></pre>
<h3>2.4 å¤šã‚¯ãƒ©ã‚¹åˆ†é¡</h3>
<p>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã¯ã€<strong>One-vs-Rest (OvR)</strong> ã¾ãŸã¯ <strong>Multinomial</strong> æ–¹å¼ã§å¤šã‚¯ãƒ©ã‚¹åˆ†é¡ã«ã‚‚å¯¾å¿œã§ãã¾ã™ã€‚</p>
<pre><code class="language-python"># å¤šã‚¯ãƒ©ã‚¹åˆ†é¡ï¼ˆå…¨3ã‚¯ãƒ©ã‚¹ï¼‰
iris = load_iris()
X, y = iris.data, iris.target

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

model = LogisticRegression(multi_class='multinomial', max_iter=200)
model.fit(X_train, y_train)

accuracy = model.score(X_test, y_test)
print(f&quot;å¤šã‚¯ãƒ©ã‚¹åˆ†é¡ã®æ­£è§£ç‡: {accuracy:.2%}&quot;)
</code></pre>
<hr />
<h2>3. kè¿‘å‚æ³•ï¼ˆk-Nearest Neighbors, k-NNï¼‰</h2>
<h3>3.1 æ¦‚è¦</h3>
<p><strong>kè¿‘å‚æ³•</strong>ã¯ã€æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆã«æœ€ã‚‚è¿‘ã„$k$å€‹ã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã¤ã‘ã€ãã‚Œã‚‰ã®å¤šæ•°æ±ºï¼ˆåˆ†é¡ï¼‰ã¾ãŸã¯å¹³å‡ï¼ˆå›å¸°ï¼‰ã§äºˆæ¸¬ã—ã¾ã™ã€‚</p>
<div class="mermaid">
graph TD
    A[æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ç‚¹] --> B[è·é›¢è¨ˆç®—]
    B --> C[kå€‹ã®æœ€è¿‘å‚ã‚’é¸æŠ]
    C --> D[å¤šæ•°æ±º or å¹³å‡]
    D --> E[äºˆæ¸¬çµæœ]
</div>

<h3>3.2 è·é›¢ã®è¨ˆç®—</h3>
<p><strong>ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢:</strong>
$$
d(x, x') = \sqrt{\sum_{i=1}^{n} (x_i - x'_i)^2}
$$</p>
<h3>3.3 å®Ÿè£…ä¾‹: åˆ†é¡</h3>
<pre><code class="language-python">from sklearn.neighbors import KNeighborsClassifier
from sklearn.preprocessing import StandardScaler

# ãƒ‡ãƒ¼ã‚¿æº–å‚™
iris = load_iris()
X, y = iris.data, iris.target

# æ¨™æº–åŒ–ï¼ˆk-NNã¯è·é›¢ãƒ™ãƒ¼ã‚¹ãªã®ã§ã‚¹ã‚±ãƒ¼ãƒ«ãŒé‡è¦ï¼‰
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# è¨“ç·´ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.3, random_state=42
)

# kã®å€¤ã‚’å¤‰ãˆã¦æ€§èƒ½ã‚’æ¯”è¼ƒ
k_values = [1, 3, 5, 7, 9, 11]
accuracies = []

for k in k_values:
    model = KNeighborsClassifier(n_neighbors=k)
    model.fit(X_train, y_train)
    accuracy = model.score(X_test, y_test)
    accuracies.append(accuracy)
    print(f&quot;k={k}: æ­£è§£ç‡ {accuracy:.2%}&quot;)

# æœ€é©ãªkã®å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
plt.plot(k_values, accuracies, marker='o', linewidth=2)
plt.xlabel('kï¼ˆè¿‘å‚æ•°ï¼‰')
plt.ylabel('æ­£è§£ç‡')
plt.title('kå€¤ã¨æ€§èƒ½ã®é–¢ä¿‚')
plt.xticks(k_values)
plt.grid(True)
plt.show()
</code></pre>
<h3>3.4 åˆ©ç‚¹ã¨æ¬ ç‚¹</h3>
<p><strong>åˆ©ç‚¹:</strong>
- âœ… ã‚·ãƒ³ãƒ—ãƒ«ã§ç›´æ„Ÿçš„
- âœ… éç·šå½¢ãªæ±ºå®šå¢ƒç•Œã‚’å­¦ç¿’å¯èƒ½
- âœ… å­¦ç¿’ãŒä¸è¦ï¼ˆã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ™ãƒ¼ã‚¹ï¼‰</p>
<p><strong>æ¬ ç‚¹:</strong>
- âŒ äºˆæ¸¬ãŒé…ã„ï¼ˆå…¨ãƒ‡ãƒ¼ã‚¿ã¨ã®è·é›¢è¨ˆç®—ãŒå¿…è¦ï¼‰
- âŒ é«˜æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã«å¼±ã„ï¼ˆæ¬¡å…ƒã®å‘ªã„ï¼‰
- âŒ ä¸å‡è¡¡ãƒ‡ãƒ¼ã‚¿ã«å¼±ã„</p>
<hr />
<h2>4. æ±ºå®šæœ¨ï¼ˆDecision Treeï¼‰</h2>
<h3>4.1 æ¦‚è¦</h3>
<p><strong>æ±ºå®šæœ¨</strong>ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’æœ¨æ§‹é€ ã§åˆ†å²ã•ã›ãªãŒã‚‰åˆ†é¡ãƒ»å›å¸°ã‚’è¡Œã†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚</p>
<div class="mermaid">
graph TD
    A[èŠ±ã³ã‚‰ã®é•·ã• <= 2.45?] -->|Yes| B[Setosa]
    A -->|No| C[èŠ±ã³ã‚‰ã®å¹… <= 1.75?]
    C -->|Yes| D[Versicolor]
    C -->|No| E[Virginica]
</div>

<h3>4.2 åˆ†å²åŸºæº–</h3>
<p><strong>ã‚¸ãƒ‹ä¸ç´”åº¦ï¼ˆGini Impurityï¼‰:</strong>
$$
Gini = 1 - \sum_{i=1}^{C} p_i^2
$$</p>
<ul>
<li>$C$: ã‚¯ãƒ©ã‚¹æ•°</li>
<li>$p_i$: ã‚¯ãƒ©ã‚¹$i$ã®å‰²åˆ</li>
</ul>
<p><strong>æƒ…å ±åˆ©å¾—ï¼ˆInformation Gainï¼‰:</strong>
ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®æ¸›å°‘é‡ã‚’åŸºæº–ã«åˆ†å²</p>
<h3>4.3 å®Ÿè£…ä¾‹</h3>
<pre><code class="language-python">from sklearn.tree import DecisionTreeClassifier, plot_tree

# ãƒ‡ãƒ¼ã‚¿æº–å‚™
iris = load_iris()
X, y = iris.data, iris.target

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

# æ±ºå®šæœ¨ãƒ¢ãƒ‡ãƒ«
model = DecisionTreeClassifier(
    max_depth=3,  # æ·±ã•ã‚’åˆ¶é™ï¼ˆéå­¦ç¿’é˜²æ­¢ï¼‰
    random_state=42
)
model.fit(X_train, y_train)

# è©•ä¾¡
accuracy = model.score(X_test, y_test)
print(f&quot;æ­£è§£ç‡: {accuracy:.2%}&quot;)

# ç‰¹å¾´é‡ã®é‡è¦åº¦
feature_importance = pd.DataFrame({
    'ç‰¹å¾´é‡': iris.feature_names,
    'é‡è¦åº¦': model.feature_importances_
}).sort_values('é‡è¦åº¦', ascending=False)

print(&quot;\nç‰¹å¾´é‡ã®é‡è¦åº¦:&quot;)
print(feature_importance)

# æœ¨æ§‹é€ ã®å¯è¦–åŒ–
plt.figure(figsize=(20, 10))
plot_tree(model, feature_names=iris.feature_names,
         class_names=iris.target_names, filled=True, fontsize=10)
plt.title('æ±ºå®šæœ¨ã®å¯è¦–åŒ–')
plt.show()
</code></pre>
<h3>4.4 éå­¦ç¿’ã®é˜²æ­¢</h3>
<p>æ±ºå®šæœ¨ã¯éå­¦ç¿’ã—ã‚„ã™ã„ãŸã‚ã€ä»¥ä¸‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§åˆ¶å¾¡ã—ã¾ã™ï¼š</p>
<pre><code class="language-python">model = DecisionTreeClassifier(
    max_depth=5,           # æœ€å¤§ã®æ·±ã•
    min_samples_split=20,  # åˆ†å²ã«å¿…è¦ãªæœ€å°ã‚µãƒ³ãƒ—ãƒ«æ•°
    min_samples_leaf=10,   # è‘‰ãƒãƒ¼ãƒ‰ã®æœ€å°ã‚µãƒ³ãƒ—ãƒ«æ•°
    max_features='sqrt'    # å„åˆ†å²ã§ä½¿ç”¨ã™ã‚‹ç‰¹å¾´é‡æ•°
)
</code></pre>
<hr />
<h2>5. ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ãƒã‚·ãƒ³ï¼ˆSVMï¼‰</h2>
<h3>5.1 æ¦‚è¦</h3>
<p><strong>SVM</strong>ã¯ã€ã‚¯ãƒ©ã‚¹é–“ã®ãƒãƒ¼ã‚¸ãƒ³ï¼ˆä½™ç™½ï¼‰ã‚’æœ€å¤§åŒ–ã™ã‚‹æ±ºå®šå¢ƒç•Œã‚’å­¦ç¿’ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚</p>
<div class="mermaid">
graph LR
    A[ãƒ‡ãƒ¼ã‚¿ç‚¹] --> B[ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–]
    B --> C[æœ€é©ãªè¶…å¹³é¢]
    C --> D[åˆ†é¡]
</div>

<h3>5.2 ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯</h3>
<p>SVMã¯<strong>ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯</strong>ã‚’ä½¿ã£ã¦ã€éç·šå½¢ãªæ±ºå®šå¢ƒç•Œã‚’å­¦ç¿’ã§ãã¾ã™ã€‚</p>
<p><strong>ä¸»ãªã‚«ãƒ¼ãƒãƒ«:</strong>
- <strong>ç·šå½¢ï¼ˆlinearï¼‰</strong>: ç·šå½¢åˆ†é›¢å¯èƒ½ãªå ´åˆ
- <strong>RBFï¼ˆGaussianï¼‰</strong>: ä¸€èˆ¬çš„ãªéç·šå½¢å•é¡Œ
- <strong>å¤šé …å¼ï¼ˆpolyï¼‰</strong>: å¤šé …å¼ã®æ±ºå®šå¢ƒç•Œ
- <strong>ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰ï¼ˆsigmoidï¼‰</strong>: ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«é¡ä¼¼</p>
<h3>5.3 å®Ÿè£…ä¾‹</h3>
<pre><code class="language-python">from sklearn.svm import SVC
from sklearn.preprocessing import StandardScaler

# ãƒ‡ãƒ¼ã‚¿æº–å‚™ã¨æ¨™æº–åŒ–
iris = load_iris()
X, y = iris.data, iris.target

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

X_train, X_test, y_train, y_test = train_test_split(
    X_scaled, y, test_size=0.3, random_state=42
)

# ç•°ãªã‚‹ã‚«ãƒ¼ãƒãƒ«ã§æ¯”è¼ƒ
kernels = ['linear', 'poly', 'rbf', 'sigmoid']

for kernel in kernels:
    model = SVC(kernel=kernel, random_state=42)
    model.fit(X_train, y_train)
    accuracy = model.score(X_test, y_test)
    print(f&quot;{kernel}ã‚«ãƒ¼ãƒãƒ«: æ­£è§£ç‡ {accuracy:.2%}&quot;)
</code></pre>
<h3>5.4 ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</h3>
<p><strong>Cï¼ˆæ­£å‰‡åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰:</strong>
- å¤§ãã„å€¤: ãƒãƒ¼ã‚¸ãƒ³ãŒç‹­ã„ï¼ˆéå­¦ç¿’ãƒªã‚¹ã‚¯ï¼‰
- å°ã•ã„å€¤: ãƒãƒ¼ã‚¸ãƒ³ãŒåºƒã„ï¼ˆéå°‘å­¦ç¿’ãƒªã‚¹ã‚¯ï¼‰</p>
<p><strong>gammaï¼ˆRBFã‚«ãƒ¼ãƒãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰:</strong>
- å¤§ãã„å€¤: æ±ºå®šå¢ƒç•ŒãŒè¤‡é›‘ï¼ˆéå­¦ç¿’ãƒªã‚¹ã‚¯ï¼‰
- å°ã•ã„å€¤: æ±ºå®šå¢ƒç•ŒãŒæ»‘ã‚‰ã‹</p>
<pre><code class="language-python">from sklearn.model_selection import GridSearchCV

# ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–
param_grid = {
    'C': [0.1, 1, 10, 100],
    'gamma': ['scale', 'auto', 0.001, 0.01, 0.1],
    'kernel': ['rbf']
}

grid_search = GridSearchCV(SVC(), param_grid, cv=5)
grid_search.fit(X_train, y_train)

print(f&quot;æœ€é©ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: {grid_search.best_params_}&quot;)
print(f&quot;æœ€è‰¯ã‚¹ã‚³ã‚¢: {grid_search.best_score_:.2%}&quot;)
</code></pre>
<hr />
<h2>6. ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ¯”è¼ƒã¨é¸æŠ</h2>
<h3>6.1 æ€§èƒ½æ¯”è¼ƒ</h3>
<pre><code class="language-python">from sklearn.datasets import load_iris
from sklearn.model_selection import cross_val_score
import pandas as pd

# ãƒ‡ãƒ¼ã‚¿æº–å‚™
iris = load_iris()
X, y = iris.data, iris.target

# å„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®äº¤å·®æ¤œè¨¼ã‚¹ã‚³ã‚¢
models = {
    'ç·šå½¢å›å¸°': LinearRegression(),  # å›å¸°ãªã®ã§ä¸é©åˆ‡ï¼ˆå‚è€ƒï¼‰
    'ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°': LogisticRegression(max_iter=200),
    'k-NN (k=5)': KNeighborsClassifier(n_neighbors=5),
    'æ±ºå®šæœ¨': DecisionTreeClassifier(max_depth=5, random_state=42),
    'SVM (RBF)': SVC(kernel='rbf', random_state=42)
}

results = []
for name, model in models.items():
    if name != 'ç·šå½¢å›å¸°':  # åˆ†é¡å•é¡Œãªã®ã§ã‚¹ã‚­ãƒƒãƒ—
        scores = cross_val_score(model, X, y, cv=5)
        results.append({
            'ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ': name,
            'å¹³å‡ã‚¹ã‚³ã‚¢': scores.mean(),
            'æ¨™æº–åå·®': scores.std()
        })

df_results = pd.DataFrame(results)
print(df_results.sort_values('å¹³å‡ã‚¹ã‚³ã‚¢', ascending=False))
</code></pre>
<h3>6.2 é¸æŠã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</h3>
<table>
<thead>
<tr>
<th>æ¡ä»¶</th>
<th>æ¨å¥¨ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>ãƒ‡ãƒ¼ã‚¿ãŒç·šå½¢åˆ†é›¢å¯èƒ½</td>
<td>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã€ç·šå½¢SVM</td>
<td>ã‚·ãƒ³ãƒ—ãƒ«ã§é«˜é€Ÿ</td>
</tr>
<tr>
<td>éç·šå½¢ãªé–¢ä¿‚</td>
<td>æ±ºå®šæœ¨ã€RBF-SVMã€k-NN</td>
<td>è¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ‰ãˆã‚‹</td>
</tr>
<tr>
<td>è§£é‡ˆæ€§ãŒé‡è¦</td>
<td>æ±ºå®šæœ¨ã€ç·šå½¢å›å¸°</td>
<td>è¦–è¦šåŒ–ãƒ»èª¬æ˜ã—ã‚„ã™ã„</td>
</tr>
<tr>
<td>é«˜æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿</td>
<td>SVMã€ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</td>
<td>æ¬¡å…ƒã®å‘ªã„ã«å¼·ã„</td>
</tr>
<tr>
<td>å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿</td>
<td>SVMã€k-NN</td>
<td>å°‘ãªã„ãƒ‡ãƒ¼ã‚¿ã§ã‚‚æ€§èƒ½è‰¯å¥½</td>
</tr>
<tr>
<td>å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿</td>
<td>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã€æ±ºå®šæœ¨</td>
<td>è¨ˆç®—ãŒé«˜é€Ÿ</td>
</tr>
</tbody>
</table>
<hr />
<h2>7. ã¾ã¨ã‚</h2>
<h3>7.1 æœ¬ç« ã§å­¦ã‚“ã ã“ã¨</h3>
<p>âœ… <strong>5ã¤ã®ä¸»è¦ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong>
- ç·šå½¢å›å¸°: é€£ç¶šå€¤äºˆæ¸¬
- ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°: ç¢ºç‡çš„åˆ†é¡
- k-NN: ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãƒ™ãƒ¼ã‚¹å­¦ç¿’
- æ±ºå®šæœ¨: æœ¨æ§‹é€ ã«ã‚ˆã‚‹åˆ†é¡ãƒ»å›å¸°
- SVM: ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–</p>
<p>âœ… <strong>å®Ÿè£…ã‚¹ã‚­ãƒ«</strong>
- scikit-learnã§ã®å®Ÿè£…æ–¹æ³•
- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
- ãƒ¢ãƒ‡ãƒ«è©•ä¾¡ã¨æ¯”è¼ƒ</p>
<p>âœ… <strong>é¸æŠåŸºæº–</strong>
- å•é¡Œã¨ãƒ‡ãƒ¼ã‚¿ã«å¿œã˜ãŸã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸æŠ</p>
<h3>7.2 æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
<p>æ¬¡ç« ã§ã¯ã€æ•™å¸«ãªã—å­¦ç¿’ï¼ˆã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¬¡å…ƒå‰Šæ¸›ï¼‰ã‚’å­¦ã³ã¾ã™ã€‚</p>
<hr />
<h2>8. ç·´ç¿’å•é¡Œ</h2>
<h3>å•é¡Œ1: ãƒ¯ã‚¤ãƒ³å“è³ªäºˆæ¸¬ï¼ˆåŸºç¤ï¼‰</h3>
<p>ãƒ¯ã‚¤ãƒ³ã®ç‰¹å¾´é‡ã‹ã‚‰å“è³ªã‚’äºˆæ¸¬ã™ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
<pre><code class="language-python">from sklearn.datasets import load_wine

wine = load_wine()
X, y = wine.data, wine.target

# ã“ã“ã«å®Ÿè£…
</code></pre>
<details>
<summary>è§£ç­”ä¾‹</summary>


<pre><code class="language-python">from sklearn.datasets import load_wine
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report

wine = load_wine()
X, y = wine.data, wine.target

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42
)

model = RandomForestClassifier(random_state=42)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)
print(classification_report(y_test, y_pred))
</code></pre>


</details>

<hr />
<p><strong>æ¬¡ã¸</strong>: <a href="chapter-3.html">Chapter 3: æ•™å¸«ãªã—å­¦ç¿’ã®åŸºç¤ â†’</a></p>
<p><strong>å‰ã¸</strong>: <a href="chapter-1.html">â† Chapter 1: æ©Ÿæ¢°å­¦ç¿’ã®åŸºç¤</a></p>
<p><strong>ç›®æ¬¡ã¸</strong>: <a href="index.html">â†‘ ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a></p><div class="navigation">
    <a href="chapter-1.html" class="nav-button">â† ç¬¬1ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-3.html" class="nav-button">ç¬¬3ç«  â†’</a>
</div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
