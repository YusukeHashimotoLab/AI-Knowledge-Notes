<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 3: æ•™å¸«ãªã—å­¦ç¿’ã®åŸºç¤ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Chapter 3: æ•™å¸«ãªã—å­¦ç¿’ã®åŸºç¤</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 0å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 0å•</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Chapter 3: æ•™å¸«ãªã—å­¦ç¿’ã®åŸºç¤</h1>
<h2>æœ¬ç« ã®æ¦‚è¦</h2>
<p>æ•™å¸«ãªã—å­¦ç¿’ã¯ã€æ­£è§£ãƒ©ãƒ™ãƒ«ãŒãªã„ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€éš ã‚ŒãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„æ§‹é€ ã‚’ç™ºè¦‹ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚æœ¬ç« ã§ã¯ã€ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã¨æ¬¡å…ƒå‰Šæ¸›ã®ä»£è¡¨çš„ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å­¦ã³ã€ãƒ‡ãƒ¼ã‚¿ã®æ¢ç´¢çš„åˆ†æï¼ˆEDAï¼‰ã«æ´»ç”¨ã™ã‚‹æ–¹æ³•ã‚’ç¿’å¾—ã—ã¾ã™ã€‚</p>
<h3>å­¦ç¿’ç›®æ¨™</h3>
<ul>
<li>âœ… ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… æ¬¡å…ƒå‰Šæ¸›ã®ç›®çš„ã¨æ‰‹æ³•ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… PCA, t-SNEã§ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã§ãã‚‹</li>
<li>âœ… é©åˆ‡ãªã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’é¸æŠã§ãã‚‹</li>
</ul>
<hr />
<h2>1. ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°å…¥é–€</h2>
<h3>1.1 ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã¨ã¯</h3>
<p><strong>ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°</strong>ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’ä¼¼ã¦ã„ã‚‹ã‚‚ã®åŒå£«ã§ã‚°ãƒ«ãƒ¼ãƒ—ï¼ˆã‚¯ãƒ©ã‚¹ã‚¿ï¼‰ã«åˆ†ã‘ã‚‹æ•™å¸«ãªã—å­¦ç¿’ã®æ‰‹æ³•ã§ã™ã€‚</p>
<p><strong>å¿œç”¨ä¾‹:</strong>
- é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
- ç”»åƒã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
- æ–‡æ›¸åˆ†é¡
- éºä¼å­ç™ºç¾è§£æ</p>
<div class="mermaid">
graph LR
    A[ãƒ‡ãƒ¼ã‚¿ç‚¹] --> B[é¡ä¼¼åº¦è¨ˆç®—]
    B --> C[ã‚°ãƒ«ãƒ¼ãƒ—åŒ–]
    C --> D[ã‚¯ãƒ©ã‚¹ã‚¿1]
    C --> E[ã‚¯ãƒ©ã‚¹ã‚¿2]
    C --> F[ã‚¯ãƒ©ã‚¹ã‚¿3]
</div>

<hr />
<h2>2. K-meansã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°</h2>
<h3>2.1 ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h3>
<p><strong>K-means</strong>ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’kå€‹ã®ã‚¯ãƒ©ã‚¹ã‚¿ã«åˆ†å‰²ã™ã‚‹æœ€ã‚‚ä¸€èˆ¬çš„ãªã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°æ‰‹æ³•ã§ã™ã€‚</p>
<p><strong>æ‰‹é †:</strong>
1. kå€‹ã®é‡å¿ƒã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«åˆæœŸåŒ–
2. å„ãƒ‡ãƒ¼ã‚¿ç‚¹ã‚’æœ€ã‚‚è¿‘ã„é‡å¿ƒã«å‰²ã‚Šå½“ã¦
3. å„ã‚¯ãƒ©ã‚¹ã‚¿ã®é‡å¿ƒã‚’å†è¨ˆç®—
4. åæŸã™ã‚‹ã¾ã§2-3ã‚’ç¹°ã‚Šè¿”ã™</p>
<h3>2.2 å®Ÿè£…ä¾‹: é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³</h3>
<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.preprocessing import StandardScaler
from sklearn.datasets import make_blobs

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆé¡§å®¢ã®å¹´é½¢ã¨å¹´åï¼‰
np.random.seed(42)
X, _ = make_blobs(n_samples=300, centers=4, cluster_std=0.60, random_state=42)

# ãƒ‡ãƒ¼ã‚¿ã‚’DataFrameã«å¤‰æ›
df = pd.DataFrame(X, columns=['å¹´é½¢', 'å¹´å'])

# æ¨™æº–åŒ–
scaler = StandardScaler()
X_scaled = scaler.fit_transform(df)

# K-meansã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°
kmeans = KMeans(n_clusters=4, random_state=42, n_init=10)
clusters = kmeans.fit_predict(X_scaled)

# ã‚¯ãƒ©ã‚¹ã‚¿ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ 
df['ã‚¯ãƒ©ã‚¹ã‚¿'] = clusters

# å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
scatter = plt.scatter(df['å¹´é½¢'], df['å¹´å'], c=clusters, cmap='viridis', s=50, alpha=0.6)
plt.scatter(kmeans.cluster_centers_[:, 0],
           kmeans.cluster_centers_[:, 1],
           c='red', marker='X', s=200, label='é‡å¿ƒ')
plt.xlabel('å¹´é½¢ï¼ˆæ¨™æº–åŒ–ï¼‰')
plt.ylabel('å¹´åï¼ˆæ¨™æº–åŒ–ï¼‰')
plt.title('é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆK-meansï¼‰')
plt.colorbar(scatter, label='ã‚¯ãƒ©ã‚¹ã‚¿')
plt.legend()
plt.show()

# å„ã‚¯ãƒ©ã‚¹ã‚¿ã®çµ±è¨ˆ
print(&quot;å„ã‚¯ãƒ©ã‚¹ã‚¿ã®çµ±è¨ˆ:&quot;)
print(df.groupby('ã‚¯ãƒ©ã‚¹ã‚¿').mean())
</code></pre>
<h3>2.3 æœ€é©ãªkå€¤ã®é¸æŠ: ã‚¨ãƒ«ãƒœãƒ¼æ³•</h3>
<pre><code class="language-python">from sklearn.metrics import silhouette_score

# ã‚¨ãƒ«ãƒœãƒ¼æ³•
inertias = []
silhouette_scores = []
K = range(2, 11)

for k in K:
    kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)
    kmeans.fit(X_scaled)
    inertias.append(kmeans.inertia_)
    silhouette_scores.append(silhouette_score(X_scaled, kmeans.labels_))

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 5))

# ã‚¨ãƒ«ãƒœãƒ¼æ›²ç·š
ax1.plot(K, inertias, marker='o')
ax1.set_xlabel('ã‚¯ãƒ©ã‚¹ã‚¿æ•° k')
ax1.set_ylabel('Inertiaï¼ˆã‚¯ãƒ©ã‚¹ã‚¿å†…åˆ†æ•£ï¼‰')
ax1.set_title('ã‚¨ãƒ«ãƒœãƒ¼æ³•')
ax1.grid(True)

# ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°
ax2.plot(K, silhouette_scores, marker='o', color='orange')
ax2.set_xlabel('ã‚¯ãƒ©ã‚¹ã‚¿æ•° k')
ax2.set_ylabel('ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°')
ax2.set_title('ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°æ³•')
ax2.grid(True)

plt.tight_layout()
plt.show()
</code></pre>
<h3>2.4 K-meansã®åˆ©ç‚¹ã¨æ¬ ç‚¹</h3>
<p><strong>åˆ©ç‚¹:</strong>
- âœ… ã‚·ãƒ³ãƒ—ãƒ«ã§é«˜é€Ÿ
- âœ… å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã«å¯¾å¿œ
- âœ… å®Ÿè£…ãŒå®¹æ˜“</p>
<p><strong>æ¬ ç‚¹:</strong>
- âŒ ã‚¯ãƒ©ã‚¹ã‚¿æ•°kã‚’äº‹å‰ã«æŒ‡å®šå¿…è¦
- âŒ çƒçŠ¶ã‚¯ãƒ©ã‚¹ã‚¿ã®ã¿å¯¾å¿œ
- âŒ å¤–ã‚Œå€¤ã«æ•æ„Ÿ</p>
<hr />
<h2>3. éšå±¤çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°</h2>
<h3>3.1 æ¦‚è¦</h3>
<p><strong>éšå±¤çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°</strong>ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚’éšå±¤çš„ã«çµåˆã¾ãŸã¯åˆ†å‰²ã—ã¦ã‚¯ãƒ©ã‚¹ã‚¿ã‚’ä½œæˆã™ã‚‹æ‰‹æ³•ã§ã™ã€‚</p>
<p><strong>2ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:</strong>
- <strong>å‡é›†å‹ï¼ˆAgglomerativeï¼‰</strong>: ãƒœãƒˆãƒ ã‚¢ãƒƒãƒ—ï¼ˆå„ç‚¹ã‹ã‚‰é–‹å§‹ï¼‰
- <strong>åˆ†å‰²å‹ï¼ˆDivisiveï¼‰</strong>: ãƒˆãƒƒãƒ—ãƒ€ã‚¦ãƒ³ï¼ˆå…¨ä½“ã‹ã‚‰åˆ†å‰²ï¼‰</p>
<h3>3.2 ãƒ‡ãƒ³ãƒ‰ãƒ­ã‚°ãƒ©ãƒ </h3>
<p>éšå±¤çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã®çµæœã¯ã€<strong>ãƒ‡ãƒ³ãƒ‰ãƒ­ã‚°ãƒ©ãƒ </strong>ï¼ˆæ¨¹å½¢å›³ï¼‰ã§å¯è¦–åŒ–ã§ãã¾ã™ã€‚</p>
<pre><code class="language-python">from scipy.cluster.hierarchy import dendrogram, linkage
from sklearn.cluster import AgglomerativeClustering

# éšå±¤çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°
linkage_matrix = linkage(X_scaled, method='ward')

# ãƒ‡ãƒ³ãƒ‰ãƒ­ã‚°ãƒ©ãƒ 
plt.figure(figsize=(12, 6))
dendrogram(linkage_matrix, truncate_mode='level', p=5)
plt.xlabel('ãƒ‡ãƒ¼ã‚¿ç‚¹ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹')
plt.ylabel('è·é›¢')
plt.title('ãƒ‡ãƒ³ãƒ‰ãƒ­ã‚°ãƒ©ãƒ ï¼ˆéšå±¤çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ï¼‰')
plt.show()

# AgglomerativeClusteringã§å®Ÿè¡Œ
agg_clustering = AgglomerativeClustering(n_clusters=4, linkage='ward')
clusters = agg_clustering.fit_predict(X_scaled)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
plt.scatter(X[:, 0], X[:, 1], c=clusters, cmap='viridis', s=50, alpha=0.6)
plt.xlabel('ç‰¹å¾´é‡1')
plt.ylabel('ç‰¹å¾´é‡2')
plt.title('éšå±¤çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°çµæœ')
plt.colorbar(label='ã‚¯ãƒ©ã‚¹ã‚¿')
plt.show()
</code></pre>
<hr />
<h2>4. DBSCAN</h2>
<h3>4.1 æ¦‚è¦</h3>
<p><strong>DBSCANï¼ˆDensity-Based Spatial Clustering of Applications with Noiseï¼‰</strong> ã¯ã€å¯†åº¦ãƒ™ãƒ¼ã‚¹ã®ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°æ‰‹æ³•ã§ã€ä»»æ„ã®å½¢çŠ¶ã®ã‚¯ãƒ©ã‚¹ã‚¿ã‚’æ¤œå‡ºã§ãã€ãƒã‚¤ã‚ºï¼ˆå¤–ã‚Œå€¤ï¼‰ã‚‚è­˜åˆ¥ã§ãã¾ã™ã€‚</p>
<p><strong>ä¸»è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:</strong>
- <strong>eps</strong>: è¿‘å‚ã®åŠå¾„
- <strong>min_samples</strong>: ã‚³ã‚¢ç‚¹ã¨ãªã‚‹æœ€å°ã‚µãƒ³ãƒ—ãƒ«æ•°</p>
<h3>4.2 å®Ÿè£…ä¾‹</h3>
<pre><code class="language-python">from sklearn.cluster import DBSCAN
from sklearn.datasets import make_moons

# éç·šå½¢ãªãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
X_moons, _ = make_moons(n_samples=300, noise=0.05, random_state=42)

# DBSCAN
dbscan = DBSCAN(eps=0.3, min_samples=5)
clusters = dbscan.fit_predict(X_moons)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
unique_labels = set(clusters)
colors = plt.cm.Spectral(np.linspace(0, 1, len(unique_labels)))

for k, col in zip(unique_labels, colors):
    if k == -1:
        # ãƒã‚¤ã‚ºç‚¹ã¯é»’
        col = 'black'
        marker = 'x'
    else:
        marker = 'o'

    class_members = (clusters == k)
    plt.scatter(X_moons[class_members, 0],
               X_moons[class_members, 1],
               c=[col], marker=marker, s=50, alpha=0.6,
               label=f'ã‚¯ãƒ©ã‚¹ã‚¿ {k}' if k != -1 else 'ãƒã‚¤ã‚º')

plt.xlabel('ç‰¹å¾´é‡1')
plt.ylabel('ç‰¹å¾´é‡2')
plt.title('DBSCANï¼ˆéç·šå½¢ã‚¯ãƒ©ã‚¹ã‚¿æ¤œå‡ºï¼‰')
plt.legend()
plt.show()

# ãƒã‚¤ã‚ºç‚¹ã®æ•°
n_noise = list(clusters).count(-1)
print(f&quot;ãƒã‚¤ã‚ºç‚¹ã®æ•°: {n_noise}&quot;)
print(f&quot;æ¤œå‡ºã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ã‚¿æ•°: {len(set(clusters)) - (1 if -1 in clusters else 0)}&quot;)
</code></pre>
<hr />
<h2>5. ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰</h2>
<h3>5.1 æ¦‚è¦</h3>
<p><strong>PCAï¼ˆPrincipal Component Analysisï¼‰</strong> ã¯ã€é«˜æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã‚’ä½æ¬¡å…ƒã«åœ§ç¸®ã—ãªãŒã‚‰ã€ãƒ‡ãƒ¼ã‚¿ã®åˆ†æ•£ã‚’æœ€å¤§é™ä¿æŒã™ã‚‹æ¬¡å…ƒå‰Šæ¸›æ‰‹æ³•ã§ã™ã€‚</p>
<p><strong>ç”¨é€”:</strong>
- ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ï¼ˆ3D â†’ 2Dï¼‰
- ãƒã‚¤ã‚ºé™¤å»
- è¨ˆç®—é‡å‰Šæ¸›
- å¤šé‡å…±ç·šæ€§ã®é™¤å»</p>
<h3>5.2 æ•°å­¦çš„èƒŒæ™¯</h3>
<p>PCAã¯ã€ãƒ‡ãƒ¼ã‚¿ã®<strong>å…±åˆ†æ•£è¡Œåˆ—</strong>ã®å›ºæœ‰å€¤åˆ†è§£ã«ã‚ˆã‚Šã€ä¸»æˆåˆ†ï¼ˆPrincipal Componentsï¼‰ã‚’æ±‚ã‚ã¾ã™ã€‚</p>
<p><strong>ä¸»æˆåˆ†:</strong>
- ç¬¬1ä¸»æˆåˆ†: åˆ†æ•£ãŒæœ€å¤§ã®æ–¹å‘
- ç¬¬2ä¸»æˆåˆ†: ç¬¬1ä¸»æˆåˆ†ã¨ç›´äº¤ã—ã€åˆ†æ•£ãŒæ¬¡ã«å¤§ãã„æ–¹å‘</p>
<h3>5.3 å®Ÿè£…ä¾‹: ã‚¢ã‚¤ãƒªã‚¹ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–</h3>
<pre><code class="language-python">from sklearn.decomposition import PCA
from sklearn.datasets import load_iris

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
iris = load_iris()
X = iris.data
y = iris.target

# PCAã§4æ¬¡å…ƒâ†’2æ¬¡å…ƒã«å‰Šæ¸›
pca = PCA(n_components=2)
X_pca = pca.fit_transform(X)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
colors = ['red', 'green', 'blue']
for i, color in enumerate(colors):
    plt.scatter(X_pca[y == i, 0], X_pca[y == i, 1],
               c=color, label=iris.target_names[i], s=50, alpha=0.6)

plt.xlabel(f'ç¬¬1ä¸»æˆåˆ†ï¼ˆåˆ†æ•£: {pca.explained_variance_ratio_[0]:.2%}ï¼‰')
plt.ylabel(f'ç¬¬2ä¸»æˆåˆ†ï¼ˆåˆ†æ•£: {pca.explained_variance_ratio_[1]:.2%}ï¼‰')
plt.title('PCAã«ã‚ˆã‚‹ã‚¢ã‚¤ãƒªã‚¹ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–')
plt.legend()
plt.grid(True)
plt.show()

# ç´¯ç©å¯„ä¸ç‡
print(&quot;å„ä¸»æˆåˆ†ã®å¯„ä¸ç‡:&quot;)
for i, ratio in enumerate(pca.explained_variance_ratio_):
    print(f&quot;  ç¬¬{i+1}ä¸»æˆåˆ†: {ratio:.2%}&quot;)
print(f&quot;ç´¯ç©å¯„ä¸ç‡: {sum(pca.explained_variance_ratio_):.2%}&quot;)
</code></pre>
<h3>5.4 ä¸»æˆåˆ†æ•°ã®é¸æŠ</h3>
<pre><code class="language-python"># å…¨ä¸»æˆåˆ†ã§ PCA
pca_full = PCA()
pca_full.fit(X)

# ç´¯ç©å¯„ä¸ç‡ã®ãƒ—ãƒ­ãƒƒãƒˆ
cumulative_variance = np.cumsum(pca_full.explained_variance_ratio_)

plt.figure(figsize=(10, 6))
plt.plot(range(1, len(cumulative_variance) + 1), cumulative_variance, marker='o')
plt.axhline(y=0.95, color='r', linestyle='--', label='95%é–¾å€¤')
plt.xlabel('ä¸»æˆåˆ†æ•°')
plt.ylabel('ç´¯ç©å¯„ä¸ç‡')
plt.title('ç´¯ç©å¯„ä¸ç‡ã¨ä¸»æˆåˆ†æ•°')
plt.grid(True)
plt.legend()
plt.show()

# 95%ã®åˆ†æ•£ã‚’èª¬æ˜ã™ã‚‹ä¸»æˆåˆ†æ•°
n_components_95 = np.argmax(cumulative_variance &gt;= 0.95) + 1
print(f&quot;95%ã®åˆ†æ•£ã‚’èª¬æ˜ã™ã‚‹ä¸»æˆåˆ†æ•°: {n_components_95}&quot;)
</code></pre>
<hr />
<h2>6. t-SNE</h2>
<h3>6.1 æ¦‚è¦</h3>
<p><strong>t-SNEï¼ˆt-Distributed Stochastic Neighbor Embeddingï¼‰</strong> ã¯ã€é«˜æ¬¡å…ƒãƒ‡ãƒ¼ã‚¿ã‚’2æ¬¡å…ƒã¾ãŸã¯3æ¬¡å…ƒã«å¯è¦–åŒ–ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªæ¬¡å…ƒå‰Šæ¸›æ‰‹æ³•ã§ã™ã€‚</p>
<p><strong>PCA vs t-SNE:</strong>
- <strong>PCA</strong>: ç·šå½¢å¤‰æ›ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªæ§‹é€ ã‚’ä¿æŒ
- <strong>t-SNE</strong>: éç·šå½¢å¤‰æ›ã€ãƒ­ãƒ¼ã‚«ãƒ«ãªæ§‹é€ ï¼ˆè¿‘å‚é–¢ä¿‚ï¼‰ã‚’ä¿æŒ</p>
<h3>6.2 å®Ÿè£…ä¾‹</h3>
<pre><code class="language-python">from sklearn.manifold import TSNE
from sklearn.datasets import load_digits

# MNISTã®æ•°å­—ãƒ‡ãƒ¼ã‚¿ï¼ˆ8x8ãƒ”ã‚¯ã‚»ãƒ«ï¼‰
digits = load_digits()
X = digits.data
y = digits.target

# t-SNEï¼ˆæ™‚é–“ãŒã‹ã‹ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ï¼‰
tsne = TSNE(n_components=2, random_state=42, perplexity=30)
X_tsne = tsne.fit_transform(X)

# å¯è¦–åŒ–
plt.figure(figsize=(12, 10))
scatter = plt.scatter(X_tsne[:, 0], X_tsne[:, 1], c=y, cmap='tab10', s=20, alpha=0.6)
plt.colorbar(scatter, label='æ•°å­—')
plt.xlabel('t-SNE æˆåˆ†1')
plt.ylabel('t-SNE æˆåˆ†2')
plt.title('t-SNEã«ã‚ˆã‚‹æ‰‹æ›¸ãæ•°å­—ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–')
plt.show()
</code></pre>
<h3>6.3 ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</h3>
<p><strong>perplexityï¼ˆå›°æƒ‘åº¦ï¼‰:</strong>
- å°ã•ã„å€¤ï¼ˆ5-20ï¼‰: ãƒ­ãƒ¼ã‚«ãƒ«ãªæ§‹é€ ã‚’å¼·èª¿
- å¤§ãã„å€¤ï¼ˆ30-50ï¼‰: ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªæ§‹é€ ã‚’é‡è¦–</p>
<pre><code class="language-python"># ç•°ãªã‚‹perplexityã§æ¯”è¼ƒ
perplexities = [5, 30, 50]
fig, axes = plt.subplots(1, 3, figsize=(18, 5))

for ax, perp in zip(axes, perplexities):
    tsne = TSNE(n_components=2, random_state=42, perplexity=perp)
    X_tsne = tsne.fit_transform(X[:1000])  # ã‚µãƒ³ãƒ—ãƒ«æ•°ã‚’åˆ¶é™

    scatter = ax.scatter(X_tsne[:, 0], X_tsne[:, 1], c=y[:1000], cmap='tab10', s=10, alpha=0.6)
    ax.set_title(f'perplexity = {perp}')
    ax.set_xlabel('æˆåˆ†1')
    ax.set_ylabel('æˆåˆ†2')

plt.tight_layout()
plt.show()
</code></pre>
<hr />
<h2>7. ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ãƒ»æ¬¡å…ƒå‰Šæ¸›ã®è©•ä¾¡</h2>
<h3>7.1 ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ã®è©•ä¾¡æŒ‡æ¨™</h3>
<h4>ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°</h4>
<p>$$
s(i) = \frac{b(i) - a(i)}{\max(a(i), b(i))}
$$</p>
<ul>
<li>$a(i)$: ã‚¯ãƒ©ã‚¹ã‚¿å†…è·é›¢ã®å¹³å‡</li>
<li>$b(i)$: æœ€ã‚‚è¿‘ã„ä»–ã‚¯ãƒ©ã‚¹ã‚¿ã¾ã§ã®è·é›¢</li>
<li>ç¯„å›²: -1ã€œ1ï¼ˆ1ã«è¿‘ã„ã»ã©è‰¯ã„ï¼‰</li>
</ul>
<pre><code class="language-python">from sklearn.metrics import silhouette_score, silhouette_samples

# ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°ã®è¨ˆç®—
silhouette_avg = silhouette_score(X_scaled, clusters)
print(f&quot;å¹³å‡ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°: {silhouette_avg:.3f}&quot;)

# å„ã‚µãƒ³ãƒ—ãƒ«ã®ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°
sample_silhouette_values = silhouette_samples(X_scaled, clusters)

# å¯è¦–åŒ–
fig, ax = plt.subplots(figsize=(10, 6))
y_lower = 10

for i in range(len(set(clusters))):
    # ã‚¯ãƒ©ã‚¹ã‚¿iã®ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°ã‚’æŠ½å‡º
    ith_cluster_silhouette_values = sample_silhouette_values[clusters == i]
    ith_cluster_silhouette_values.sort()

    size_cluster_i = ith_cluster_silhouette_values.shape[0]
    y_upper = y_lower + size_cluster_i

    ax.fill_betweenx(np.arange(y_lower, y_upper),
                     0, ith_cluster_silhouette_values,
                     alpha=0.7, label=f'ã‚¯ãƒ©ã‚¹ã‚¿ {i}')
    y_lower = y_upper + 10

ax.axvline(x=silhouette_avg, color=&quot;red&quot;, linestyle=&quot;--&quot;, label='å¹³å‡')
ax.set_xlabel('ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°')
ax.set_ylabel('ã‚¯ãƒ©ã‚¹ã‚¿')
ax.set_title('ã‚·ãƒ«ã‚¨ãƒƒãƒˆåˆ†æ')
ax.legend()
plt.show()
</code></pre>
<h3>7.2 æ¬¡å…ƒå‰Šæ¸›ã®è©•ä¾¡</h3>
<p><strong>å†æ§‹æˆèª¤å·®:</strong>
PCAã®å ´åˆã€å…ƒã®ãƒ‡ãƒ¼ã‚¿ã¨å¾©å…ƒã—ãŸãƒ‡ãƒ¼ã‚¿ã®å·®</p>
<pre><code class="language-python"># PCAã§åœ§ç¸®ãƒ»å¾©å…ƒ
pca = PCA(n_components=2)
X_reduced = pca.fit_transform(X)
X_reconstructed = pca.inverse_transform(X_reduced)

# å†æ§‹æˆèª¤å·®
reconstruction_error = np.mean((X - X_reconstructed) ** 2)
print(f&quot;å†æ§‹æˆèª¤å·®: {reconstruction_error:.4f}&quot;)
</code></pre>
<hr />
<h2>8. å®Ÿè·µä¾‹: é¡§å®¢åˆ†æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</h2>
<pre><code class="language-python">import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.cluster import KMeans
from sklearn.decomposition import PCA
import matplotlib.pyplot as plt

# ã‚µãƒ³ãƒ—ãƒ«é¡§å®¢ãƒ‡ãƒ¼ã‚¿
np.random.seed(42)
n_customers = 500

customer_data = pd.DataFrame({
    'å¹´é½¢': np.random.randint(20, 70, n_customers),
    'å¹´å': np.random.randint(300, 1500, n_customers),
    'è³¼å…¥å›æ•°': np.random.randint(1, 50, n_customers),
    'å¹³å‡è³¼å…¥é¡': np.random.randint(1000, 50000, n_customers),
    'ä¼šå“¡å¹´æ•°': np.random.randint(1, 15, n_customers)
})

# 1. ãƒ‡ãƒ¼ã‚¿æ¨™æº–åŒ–
scaler = StandardScaler()
X_scaled = scaler.fit_transform(customer_data)

# 2. æœ€é©ãªã‚¯ãƒ©ã‚¹ã‚¿æ•°ã‚’æ±ºå®šï¼ˆã‚¨ãƒ«ãƒœãƒ¼æ³•ï¼‰
inertias = []
K_range = range(2, 11)
for k in K_range:
    kmeans = KMeans(n_clusters=k, random_state=42, n_init=10)
    kmeans.fit(X_scaled)
    inertias.append(kmeans.inertia_)

plt.figure(figsize=(8, 5))
plt.plot(K_range, inertias, marker='o')
plt.xlabel('ã‚¯ãƒ©ã‚¹ã‚¿æ•° k')
plt.ylabel('Inertia')
plt.title('ã‚¨ãƒ«ãƒœãƒ¼æ³•ã§æœ€é©ãªkå€¤ã‚’æ±ºå®š')
plt.grid(True)
plt.show()

# 3. K-meansã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°ï¼ˆk=4ã¨ä»®å®šï¼‰
optimal_k = 4
kmeans = KMeans(n_clusters=optimal_k, random_state=42, n_init=10)
customer_data['ã‚¯ãƒ©ã‚¹ã‚¿'] = kmeans.fit_predict(X_scaled)

# 4. PCAã§2æ¬¡å…ƒã«å‰Šæ¸›ã—ã¦å¯è¦–åŒ–
pca = PCA(n_components=2)
X_pca = pca.fit_transform(X_scaled)

plt.figure(figsize=(10, 6))
scatter = plt.scatter(X_pca[:, 0], X_pca[:, 1],
                     c=customer_data['ã‚¯ãƒ©ã‚¹ã‚¿'], cmap='viridis', s=50, alpha=0.6)
plt.xlabel(f'PC1 ({pca.explained_variance_ratio_[0]:.1%})')
plt.ylabel(f'PC2 ({pca.explained_variance_ratio_[1]:.1%})')
plt.title('é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆPCAå¯è¦–åŒ–ï¼‰')
plt.colorbar(scatter, label='ã‚¯ãƒ©ã‚¹ã‚¿')
plt.show()

# 5. å„ã‚¯ãƒ©ã‚¹ã‚¿ã®ç‰¹å¾´åˆ†æ
print(&quot;å„ã‚¯ãƒ©ã‚¹ã‚¿ã®å¹³å‡å€¤:&quot;)
print(customer_data.groupby('ã‚¯ãƒ©ã‚¹ã‚¿').mean().round(2))
</code></pre>
<hr />
<h2>9. ã¾ã¨ã‚</h2>
<h3>9.1 æœ¬ç« ã§å­¦ã‚“ã ã“ã¨</h3>
<p>âœ… <strong>ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°æ‰‹æ³•</strong>
- K-means: é«˜é€Ÿãƒ»ã‚·ãƒ³ãƒ—ãƒ«
- éšå±¤çš„ã‚¯ãƒ©ã‚¹ã‚¿ãƒªãƒ³ã‚°: ãƒ‡ãƒ³ãƒ‰ãƒ­ã‚°ãƒ©ãƒ å¯è¦–åŒ–
- DBSCAN: ä»»æ„å½¢çŠ¶ãƒ»ãƒã‚¤ã‚ºæ¤œå‡º</p>
<p>âœ… <strong>æ¬¡å…ƒå‰Šæ¸›æ‰‹æ³•</strong>
- PCA: ç·šå½¢ãƒ»ã‚°ãƒ­ãƒ¼ãƒãƒ«æ§‹é€ ä¿æŒ
- t-SNE: éç·šå½¢ãƒ»ãƒ­ãƒ¼ã‚«ãƒ«æ§‹é€ ä¿æŒ</p>
<p>âœ… <strong>è©•ä¾¡æ–¹æ³•</strong>
- ã‚¨ãƒ«ãƒœãƒ¼æ³•ã€ã‚·ãƒ«ã‚¨ãƒƒãƒˆä¿‚æ•°
- ç´¯ç©å¯„ä¸ç‡ã€å†æ§‹æˆèª¤å·®</p>
<h3>9.2 æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
<p>æ¬¡ç« ã§ã¯ã€ãƒ¢ãƒ‡ãƒ«è©•ä¾¡ã¨å®Ÿè·µçš„ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å­¦ã³ã¾ã™ã€‚</p>
<hr />
<p><strong>æ¬¡ã¸</strong>: <a href="chapter-4.html">Chapter 4: ãƒ¢ãƒ‡ãƒ«è©•ä¾¡ã¨å®Ÿè·µ â†’</a></p>
<p><strong>å‰ã¸</strong>: <a href="chapter-2.html">â† Chapter 2: æ•™å¸«ã‚ã‚Šå­¦ç¿’ã®åŸºç¤</a></p>
<p><strong>ç›®æ¬¡ã¸</strong>: <a href="index.html">â†‘ ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a></p><div class="navigation">
    <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-4.html" class="nav-button">ç¬¬4ç«  â†’</a>
</div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ç›£ä¿®</strong>: Dr. Yusuke Hashimotoï¼ˆæ±åŒ—å¤§å­¦ï¼‰</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
