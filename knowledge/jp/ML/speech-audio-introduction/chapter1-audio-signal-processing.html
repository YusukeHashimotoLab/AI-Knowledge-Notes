<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« ï¼šéŸ³å£°ä¿¡å·å‡¦ç†ã®åŸºç¤ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
            <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/ML/speech-audio-introduction/chapter1-audio-signal-processing.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../ML/index.html">æ©Ÿæ¢°å­¦ç¿’</a><span class="breadcrumb-separator">â€º</span><a href="../../ML/speech-audio-introduction/index.html">Speech Audio</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

        <header>
        <div class="header-content">
            <h1>ç¬¬1ç« ï¼šéŸ³å£°ä¿¡å·å‡¦ç†ã®åŸºç¤</h1>
            <p class="subtitle">ãƒ‡ã‚¸ã‚¿ãƒ«éŸ³å£°ã‹ã‚‰ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã¾ã§ - éŸ³éŸ¿ä¿¡å·ã®ç†è§£ã¨å‡¦ç†</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 35-40åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 10å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 5å•</span>
            </div>
        </div>
    </header>

    <main class="container">

<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… ãƒ‡ã‚¸ã‚¿ãƒ«éŸ³å£°ã®åŸºæœ¬æ¦‚å¿µï¼ˆã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã€é‡å­åŒ–ï¼‰ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… æ™‚é–“é ˜åŸŸã¨å‘¨æ³¢æ•°é ˜åŸŸã§ã®éŸ³å£°åˆ†ææ‰‹æ³•ã‚’å®Ÿè£…ã§ãã‚‹</li>
<li>âœ… ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã¨ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®é•ã„ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… MFCCãªã©ã®éŸ³éŸ¿ç‰¹å¾´é‡ã‚’æŠ½å‡ºã§ãã‚‹</li>
<li>âœ… librosaã‚’ä½¿ã£ãŸéŸ³å£°å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
<li>âœ… éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†ã¨ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µã‚’å®Ÿè£…ã§ãã‚‹</li>
</ul>

<hr>

<h2>1.1 ãƒ‡ã‚¸ã‚¿ãƒ«éŸ³å£°ã®åŸºç¤</h2>

<h3>éŸ³å£°ä¿¡å·ã¨ã¯</h3>
<p><strong>éŸ³å£°ä¿¡å·ï¼ˆAudio Signalï¼‰</strong>ã¯ã€ç©ºæ°—ã®æŒ¯å‹•ã‚’é›»æ°—ä¿¡å·ã‚„æ•°å€¤ãƒ‡ãƒ¼ã‚¿ã«å¤‰æ›ã—ãŸã‚‚ã®ã§ã™ã€‚æ©Ÿæ¢°å­¦ç¿’ã§æ‰±ã†ãŸã‚ã«ã¯ã€é€£ç¶šçš„ãªã‚¢ãƒŠãƒ­ã‚°ä¿¡å·ã‚’ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

<blockquote>
<p>ã€ŒéŸ³å£°ã¯æ™‚é–“ã®é–¢æ•°ã§ã‚ã‚‹ã€ã¨ã„ã†ç‰¹æ€§ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒã€éŸ³å£°å‡¦ç†ã®ç¬¬ä¸€æ­©ã§ã™ã€‚</p>
</blockquote>

<h3>ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã®ãƒ—ãƒ­ã‚»ã‚¹</h3>

<div class="mermaid">
graph LR
    A[ã‚¢ãƒŠãƒ­ã‚°éŸ³å£°<br>é€£ç¶šä¿¡å·] --> B[ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°<br>é›¢æ•£åŒ–]
    B --> C[é‡å­åŒ–<br>æ•°å€¤åŒ–]
    C --> D[ãƒ‡ã‚¸ã‚¿ãƒ«éŸ³å£°<br>æ•°å€¤é…åˆ—]
    D --> E[éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«<br>WAV/MP3/FLAC]

    style A fill:#ffebee
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#e3f2fd
    style E fill:#e8f5e9
</div>

<h3>1.1.1 ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ</h3>

<p><strong>ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆï¼ˆSampling Rateï¼‰</strong>ã¯ã€1ç§’é–“ã«ä½•å›éŸ³å£°ã‚’è¨˜éŒ²ã™ã‚‹ã‹ã‚’è¡¨ã™å€¤ã§ã€å˜ä½ã¯Hzï¼ˆãƒ˜ãƒ«ãƒ„ï¼‰ã§ã™ã€‚</p>

<p>$$
f_s = \frac{\text{ã‚µãƒ³ãƒ—ãƒ«æ•°}}{\text{ç§’}}
$$</p>

<p><strong>ãƒŠã‚¤ã‚­ã‚¹ãƒˆå®šç†</strong>: ä¿¡å·ã‚’æ­£ç¢ºã«å†ç¾ã™ã‚‹ã«ã¯ã€æœ€é«˜å‘¨æ³¢æ•°ã®2å€ä»¥ä¸Šã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆãŒå¿…è¦ã§ã™ã€‚</p>

<p>$$
f_s \geq 2 \times f_{\max}
$$</p>

<h4>ä¸€èˆ¬çš„ãªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ</h4>

<table>
<thead>
<tr>
<th>ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ</th>
<th>ç”¨é€”</th>
<th>å‘¨æ³¢æ•°å¸¯åŸŸ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>8,000 Hz</strong></td>
<td>é›»è©±éŸ³å£°</td>
<td>0-4 kHz</td>
</tr>
<tr>
<td><strong>16,000 Hz</strong></td>
<td>éŸ³å£°èªè­˜</td>
<td>0-8 kHz</td>
</tr>
<tr>
<td><strong>22,050 Hz</strong></td>
<td>ä½å“è³ªéŸ³æ¥½</td>
<td>0-11 kHz</td>
</tr>
<tr>
<td><strong>44,100 Hz</strong></td>
<td>CDå“è³ªéŸ³æ¥½</td>
<td>0-22 kHz</td>
</tr>
<tr>
<td><strong>48,000 Hz</strong></td>
<td>ãƒ—ãƒ­ã‚ªãƒ¼ãƒ‡ã‚£ã‚ª</td>
<td>0-24 kHz</td>
</tr>
</tbody>
</table>

<h3>1.1.2 é‡å­åŒ–ã¨ãƒ“ãƒƒãƒˆæ·±åº¦</h3>

<p><strong>é‡å­åŒ–ï¼ˆQuantizationï¼‰</strong>ã¯ã€é€£ç¶šçš„ãªæŒ¯å¹…å€¤ã‚’é›¢æ•£çš„ãªæ•°å€¤ã«å¤‰æ›ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã§ã™ã€‚<strong>ãƒ“ãƒƒãƒˆæ·±åº¦ï¼ˆBit Depthï¼‰</strong>ã¯ã€å„ã‚µãƒ³ãƒ—ãƒ«ã‚’ä½•ãƒ“ãƒƒãƒˆã§è¡¨ç¾ã™ã‚‹ã‹ã‚’ç¤ºã—ã¾ã™ã€‚</p>

<p>$$
\text{è¡¨ç¾å¯èƒ½ãªãƒ¬ãƒ™ãƒ«æ•°} = 2^{\text{ãƒ“ãƒƒãƒˆæ·±åº¦}}
$$</p>

<table>
<thead>
<tr>
<th>ãƒ“ãƒƒãƒˆæ·±åº¦</th>
<th>ãƒ¬ãƒ™ãƒ«æ•°</th>
<th>ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ãƒ¬ãƒ³ã‚¸</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>8-bit</strong></td>
<td>256</td>
<td>48 dB</td>
<td>ä½å“è³ª</td>
</tr>
<tr>
<td><strong>16-bit</strong></td>
<td>65,536</td>
<td>96 dB</td>
<td>CDå“è³ª</td>
</tr>
<tr>
<td><strong>24-bit</strong></td>
<td>16,777,216</td>
<td>144 dB</td>
<td>ãƒ—ãƒ­éŒ²éŸ³</td>
</tr>
<tr>
<td><strong>32-bit float</strong></td>
<td>-</td>
<td>1,528 dB</td>
<td>å‡¦ç†ç”¨</td>
</tr>
</tbody>
</table>

<h3>1.1.3 éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼</h3>

<table>
<thead>
<tr>
<th>å½¢å¼</th>
<th>åœ§ç¸®</th>
<th>å“è³ª</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>WAV</strong></td>
<td>éåœ§ç¸®</td>
<td>æœ€é«˜</td>
<td>éŒ²éŸ³ãƒ»å‡¦ç†</td>
</tr>
<tr>
<td><strong>FLAC</strong></td>
<td>å¯é€†åœ§ç¸®</td>
<td>æœ€é«˜</td>
<td>ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–</td>
</tr>
<tr>
<td><strong>MP3</strong></td>
<td>éå¯é€†åœ§ç¸®</td>
<td>ä¸­ã€œé«˜</td>
<td>é…å¸ƒãƒ»å†ç”Ÿ</td>
</tr>
<tr>
<td><strong>AAC</strong></td>
<td>éå¯é€†åœ§ç¸®</td>
<td>é«˜</td>
<td>ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°</td>
</tr>
<tr>
<td><strong>OGG</strong></td>
<td>éå¯é€†åœ§ç¸®</td>
<td>ä¸­ã€œé«˜</td>
<td>ã‚ªãƒ¼ãƒ—ãƒ³å½¢å¼</td>
</tr>
</tbody>
</table>

<h3>1.1.4 librosaã®åŸºæœ¬</h3>

<pre><code class="language-python">import librosa
import librosa.display
import numpy as np
import matplotlib.pyplot as plt

# éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
# librosaã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ãƒ¢ãƒãƒ©ãƒ«ã€22050Hzã«ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
audio_path = "sample.wav"
y, sr = librosa.load(audio_path)

print("=== éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ± ===")
print(f"ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ: {sr} Hz")
print(f"ã‚µãƒ³ãƒ—ãƒ«æ•°: {len(y)}")
print(f"æ™‚é–“é•·: {len(y) / sr:.2f} ç§’")
print(f"ãƒ‡ãƒ¼ã‚¿å‹: {y.dtype}")
print(f"æŒ¯å¹…ç¯„å›²: [{y.min():.3f}, {y.max():.3f}]")

# ã‚ªãƒªã‚¸ãƒŠãƒ«ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã§èª­ã¿è¾¼ã¿
y_orig, sr_orig = librosa.load(audio_path, sr=None)
print(f"\nã‚ªãƒªã‚¸ãƒŠãƒ«ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ: {sr_orig} Hz")

# ç‰¹å®šã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã§èª­ã¿è¾¼ã¿
y_16k, sr_16k = librosa.load(audio_path, sr=16000)
print(f"16kHzãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°: {len(y_16k)} ã‚µãƒ³ãƒ—ãƒ«")

# ã‚¹ãƒ†ãƒ¬ã‚ªã§èª­ã¿è¾¼ã¿
y_stereo, sr = librosa.load(audio_path, mono=False)
print(f"ã‚¹ãƒ†ãƒ¬ã‚ª: shape = {y_stereo.shape}")
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>=== éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«æƒ…å ± ===
ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ: 22050 Hz
ã‚µãƒ³ãƒ—ãƒ«æ•°: 66150
æ™‚é–“é•·: 3.00 ç§’
ãƒ‡ãƒ¼ã‚¿å‹: float32
æŒ¯å¹…ç¯„å›²: [-0.523, 0.487]

ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ: 44100 Hz
16kHzãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°: 48000 ã‚µãƒ³ãƒ—ãƒ«
ã‚¹ãƒ†ãƒ¬ã‚ª: shape = (2, 66150)
</code></pre>

<hr>

<h2>1.2 æ™‚é–“é ˜åŸŸã®å‡¦ç†</h2>

<h3>æ™‚é–“é ˜åŸŸã¨ã¯</h3>
<p><strong>æ™‚é–“é ˜åŸŸï¼ˆTime Domainï¼‰</strong>ã¯ã€éŸ³å£°ä¿¡å·ã‚’æ™‚é–“ã®é–¢æ•°ã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚æ¨ªè»¸ãŒæ™‚é–“ã€ç¸¦è»¸ãŒæŒ¯å¹…ã‚’è¡¨ã—ã¾ã™ã€‚</p>

<h3>1.2.1 æŒ¯å¹…ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼</h3>

<p><strong>æŒ¯å¹…ï¼ˆAmplitudeï¼‰</strong>ã¯éŸ³ã®å¤§ãã•ã‚’è¡¨ã—ã¾ã™ã€‚<strong>ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆEnergyï¼‰</strong>ã¯æŒ¯å¹…ã®äºŒä¹—ã®ç·å’Œã§ã™ã€‚</p>

<p>$$
E = \sum_{n=1}^{N} |x[n]|^2
$$</p>

<p><strong>RMSï¼ˆRoot Mean Squareï¼‰</strong>ã¯å¹³å‡çš„ãªæŒ¯å¹…ã‚’è¡¨ã—ã¾ã™ï¼š</p>

<p>$$
\text{RMS} = \sqrt{\frac{1}{N} \sum_{n=1}^{N} x[n]^2}
$$</p>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt

# ã‚µãƒ³ãƒ—ãƒ«éŸ³å£°ã®ç”Ÿæˆï¼ˆ440Hzæ­£å¼¦æ³¢ + ãƒã‚¤ã‚ºï¼‰
sr = 22050
duration = 2.0
t = np.linspace(0, duration, int(sr * duration))
y = 0.5 * np.sin(2 * np.pi * 440 * t) + 0.1 * np.random.randn(len(t))

print("=== æŒ¯å¹…ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ ===")

# æŒ¯å¹…çµ±è¨ˆ
print(f"æœ€å¤§æŒ¯å¹…: {np.max(np.abs(y)):.3f}")
print(f"å¹³å‡æŒ¯å¹…: {np.mean(np.abs(y)):.3f}")

# ã‚¨ãƒãƒ«ã‚®ãƒ¼
energy = np.sum(y**2)
print(f"ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼: {energy:.2f}")

# RMS
rms = np.sqrt(np.mean(y**2))
print(f"RMS: {rms:.3f}")

# ãƒ•ãƒ¬ãƒ¼ãƒ ã”ã¨ã®RMSè¨ˆç®—
frame_length = 2048
hop_length = 512
rms_frames = librosa.feature.rms(y=y, frame_length=frame_length, hop_length=hop_length)[0]

print(f"\nãƒ•ãƒ¬ãƒ¼ãƒ æ•°: {len(rms_frames)}")
print(f"RMSç¯„å›²: [{rms_frames.min():.3f}, {rms_frames.max():.3f}]")

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(12, 6))

# æ³¢å½¢
axes[0].plot(t, y, linewidth=0.5)
axes[0].set_xlabel('æ™‚é–“ (ç§’)')
axes[0].set_ylabel('æŒ¯å¹…')
axes[0].set_title('éŸ³å£°æ³¢å½¢')
axes[0].grid(True, alpha=0.3)

# RMS
times = librosa.frames_to_time(np.arange(len(rms_frames)), sr=sr, hop_length=hop_length)
axes[1].plot(times, rms_frames)
axes[1].set_xlabel('æ™‚é–“ (ç§’)')
axes[1].set_ylabel('RMS')
axes[1].set_title('RMSã‚¨ãƒãƒ«ã‚®ãƒ¼')
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('amplitude_rms.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: amplitude_rms.png")
</code></pre>

<h3>1.2.2 Zero Crossing Rate</h3>

<p><strong>Zero Crossing Rate (ZCR)</strong>ã¯ã€ä¿¡å·ãŒã‚¼ãƒ­ã‚’æ¨ªåˆ‡ã‚‹é »åº¦ã‚’è¡¨ã—ã¾ã™ã€‚éŸ³å£°ã®ç¨®é¡ï¼ˆæœ‰å£°éŸ³/ç„¡å£°éŸ³ï¼‰ã‚„æ¥½å™¨ã®åˆ¤åˆ¥ã«æœ‰ç”¨ã§ã™ã€‚</p>

<p>$$
\text{ZCR} = \frac{1}{T-1} \sum_{t=1}^{T-1} \mathbb{1}_{x[t] \cdot x[t-1] < 0}
$$</p>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt

# ã‚µãƒ³ãƒ—ãƒ«éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav', duration=5.0)

# Zero Crossing Rateã®è¨ˆç®—
zcr = librosa.feature.zero_crossing_rate(y, frame_length=2048, hop_length=512)[0]

print("=== Zero Crossing Rate ===")
print(f"ZCRå¹³å‡: {np.mean(zcr):.4f}")
print(f"ZCRç¯„å›²: [{zcr.min():.4f}, {zcr.max():.4f}]")

# æ™‚é–“è»¸
times = librosa.frames_to_time(np.arange(len(zcr)), sr=sr, hop_length=512)

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(12, 6))

# æ³¢å½¢
librosa.display.waveshow(y, sr=sr, ax=axes[0])
axes[0].set_title('éŸ³å£°æ³¢å½¢')
axes[0].set_ylabel('æŒ¯å¹…')

# ZCR
axes[1].plot(times, zcr)
axes[1].set_xlabel('æ™‚é–“ (ç§’)')
axes[1].set_ylabel('ZCR')
axes[1].set_title('Zero Crossing Rate')
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('zcr_analysis.png', dpi=150, bbox_inches='tight')
print("å›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: zcr_analysis.png")

# ç‰¹å¾´ï¼šé«˜ZCR = ç„¡å£°éŸ³/ãƒã‚¤ã‚ºã€ä½ZCR = æœ‰å£°éŸ³/éŸ³æ¥½
print("\nè§£é‡ˆ:")
print("- é«˜ZCR (>0.1): ç„¡å£°éŸ³ã€ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºã€ã‚·ãƒ³ãƒãƒ«ç­‰")
print("- ä½ZCR (<0.05): æœ‰å£°éŸ³ã€éŸ³æ¥½ã€ä½å‘¨æ³¢æˆåˆ†")
</code></pre>

<h3>1.2.3 éŸ³å£°ã®èª­ã¿è¾¼ã¿ã¨å¯è¦–åŒ–</h3>

<pre><code class="language-python">import librosa
import librosa.display
import matplotlib.pyplot as plt
import numpy as np

# éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
audio_path = 'sample.wav'
y, sr = librosa.load(audio_path, sr=None)

print("=== éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ– ===")
print(f"ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ: {sr} Hz")
print(f"æ™‚é–“é•·: {len(y)/sr:.2f} ç§’")

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 1, figsize=(14, 10))

# 1. æ³¢å½¢è¡¨ç¤º
librosa.display.waveshow(y, sr=sr, ax=axes[0])
axes[0].set_title('éŸ³å£°æ³¢å½¢ï¼ˆå…¨ä½“ï¼‰', fontsize=14)
axes[0].set_ylabel('æŒ¯å¹…')
axes[0].grid(True, alpha=0.3)

# 2. æ‹¡å¤§æ³¢å½¢ï¼ˆæœ€åˆã®0.1ç§’ï¼‰
n_samples = int(0.1 * sr)
time_zoom = np.arange(n_samples) / sr
axes[1].plot(time_zoom, y[:n_samples])
axes[1].set_title('éŸ³å£°æ³¢å½¢ï¼ˆæ‹¡å¤§ï¼šæœ€åˆã®0.1ç§’ï¼‰', fontsize=14)
axes[1].set_xlabel('æ™‚é–“ (ç§’)')
axes[1].set_ylabel('æŒ¯å¹…')
axes[1].grid(True, alpha=0.3)

# 3. ã‚¨ãƒ³ãƒ™ãƒ­ãƒ¼ãƒ—ï¼ˆåŒ…çµ¡ç·šï¼‰
hop_length = 512
rms = librosa.feature.rms(y=y, hop_length=hop_length)[0]
times = librosa.frames_to_time(np.arange(len(rms)), sr=sr, hop_length=hop_length)

axes[2].plot(times, rms, label='RMS Energy', color='red', linewidth=2)
axes[2].set_title('éŸ³å£°ã‚¨ãƒ³ãƒ™ãƒ­ãƒ¼ãƒ—ï¼ˆRMSï¼‰', fontsize=14)
axes[2].set_xlabel('æ™‚é–“ (ç§’)')
axes[2].set_ylabel('RMSæŒ¯å¹…')
axes[2].legend()
axes[2].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('audio_visualization.png', dpi=150, bbox_inches='tight')
print("å›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: audio_visualization.png")

# çµ±è¨ˆæƒ…å ±
print("\néŸ³å£°çµ±è¨ˆ:")
print(f"  æœ€å¤§æŒ¯å¹…: {np.max(np.abs(y)):.3f}")
print(f"  RMS: {np.sqrt(np.mean(y**2)):.3f}")
print(f"  ãƒ€ã‚¤ãƒŠãƒŸãƒƒã‚¯ãƒ¬ãƒ³ã‚¸: {20*np.log10(np.max(np.abs(y))/np.min(np.abs(y[y!=0]))):.1f} dB")
</code></pre>

<hr>

<h2>1.3 å‘¨æ³¢æ•°é ˜åŸŸã®å‡¦ç†</h2>

<h3>å‘¨æ³¢æ•°é ˜åŸŸã¨ã¯</h3>
<p><strong>å‘¨æ³¢æ•°é ˜åŸŸï¼ˆFrequency Domainï¼‰</strong>ã¯ã€éŸ³å£°ä¿¡å·ã‚’ã©ã®ã‚ˆã†ãªå‘¨æ³¢æ•°æˆåˆ†ã§æ§‹æˆã•ã‚Œã¦ã„ã‚‹ã‹ã§è¡¨ç¾ã—ã¾ã™ã€‚ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã«ã‚ˆã‚Šæ™‚é–“é ˜åŸŸã‹ã‚‰å¤‰æ›ã§ãã¾ã™ã€‚</p>

<h3>1.3.1 ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼ˆFFTï¼‰</h3>

<p><strong>é›¢æ•£ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼ˆDFT: Discrete Fourier Transformï¼‰</strong>ã¯ã€æ™‚é–“é ˜åŸŸã®ä¿¡å·ã‚’å‘¨æ³¢æ•°é ˜åŸŸã«å¤‰æ›ã—ã¾ã™ï¼š</p>

<p>$$
X[k] = \sum_{n=0}^{N-1} x[n] \cdot e^{-i 2\pi k n / N}
$$</p>

<p><strong>é«˜é€Ÿãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼ˆFFT: Fast Fourier Transformï¼‰</strong>ã¯ã€DFTã‚’é«˜é€Ÿã«è¨ˆç®—ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã™ã€‚</p>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt

# ã‚µãƒ³ãƒ—ãƒ«éŸ³å£°ï¼ˆè¤‡æ•°å‘¨æ³¢æ•°ã®æ­£å¼¦æ³¢ï¼‰
sr = 22050
duration = 1.0
t = np.linspace(0, duration, int(sr * duration))

# 440Hzï¼ˆA4ï¼‰+ 880Hzï¼ˆA5ï¼‰+ 1320Hzï¼ˆE6ï¼‰
y = (0.5 * np.sin(2 * np.pi * 440 * t) +
     0.3 * np.sin(2 * np.pi * 880 * t) +
     0.2 * np.sin(2 * np.pi * 1320 * t))

print("=== ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼ˆFFTï¼‰===")

# FFTã®è¨ˆç®—
n_fft = 2048
fft_result = np.fft.fft(y[:n_fft])
magnitude = np.abs(fft_result)
phase = np.angle(fft_result)

# å‘¨æ³¢æ•°è»¸
frequencies = np.fft.fftfreq(n_fft, 1/sr)

# æ­£ã®å‘¨æ³¢æ•°ã®ã¿ï¼ˆå¯¾ç§°æ€§ã®ãŸã‚ï¼‰
positive_frequencies = frequencies[:n_fft//2]
positive_magnitude = magnitude[:n_fft//2]

print(f"FFTã‚µã‚¤ã‚º: {n_fft}")
print(f"å‘¨æ³¢æ•°åˆ†è§£èƒ½: {sr/n_fft:.2f} Hz")

# ãƒ”ãƒ¼ã‚¯å‘¨æ³¢æ•°ã®æ¤œå‡º
peak_indices = np.argsort(positive_magnitude)[-3:][::-1]
print("\næ¤œå‡ºã•ã‚ŒãŸãƒ”ãƒ¼ã‚¯å‘¨æ³¢æ•°:")
for i, idx in enumerate(peak_indices, 1):
    print(f"  {i}. {positive_frequencies[idx]:.1f} Hz (æŒ¯å¹…: {positive_magnitude[idx]:.1f})")

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 1, figsize=(12, 10))

# æ™‚é–“é ˜åŸŸ
axes[0].plot(t[:1000], y[:1000])
axes[0].set_xlabel('æ™‚é–“ (ç§’)')
axes[0].set_ylabel('æŒ¯å¹…')
axes[0].set_title('æ™‚é–“é ˜åŸŸã®ä¿¡å·')
axes[0].grid(True, alpha=0.3)

# å‘¨æ³¢æ•°é ˜åŸŸï¼ˆæŒ¯å¹…ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼‰
axes[1].plot(positive_frequencies, positive_magnitude)
axes[1].set_xlabel('å‘¨æ³¢æ•° (Hz)')
axes[1].set_ylabel('æŒ¯å¹…')
axes[1].set_title('æŒ¯å¹…ã‚¹ãƒšã‚¯ãƒˆãƒ«')
axes[1].set_xlim([0, 2000])
axes[1].grid(True, alpha=0.3)

# å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«
axes[2].plot(positive_frequencies, 20*np.log10(positive_magnitude + 1e-10))
axes[2].set_xlabel('å‘¨æ³¢æ•° (Hz)')
axes[2].set_ylabel('æŒ¯å¹… (dB)')
axes[2].set_title('æŒ¯å¹…ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆå¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰')
axes[2].set_xlim([0, 2000])
axes[2].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('fft_analysis.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: fft_analysis.png")
</code></pre>

<h3>1.3.2 ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ </h3>

<p><strong>ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼ˆSpectrogramï¼‰</strong>ã¯ã€æ™‚é–“-å‘¨æ³¢æ•°é ˜åŸŸã§ã®éŸ³å£°è¡¨ç¾ã§ã™ã€‚çŸ­æ™‚é–“ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼ˆSTFTï¼‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>

<p>$$
\text{STFT}(t, f) = \sum_{n=-\infty}^{\infty} x[n] \cdot w[n-t] \cdot e^{-i 2\pi f n}
$$</p>

<p>$w[n]$ã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦é–¢æ•°ï¼ˆãƒãƒŸãƒ³ã‚°çª“ã€ãƒãƒ‹ãƒ³ã‚°çª“ãªã©ï¼‰ã§ã™ã€‚</p>

<pre><code class="language-python">import librosa
import librosa.display
import matplotlib.pyplot as plt
import numpy as np

# éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav', duration=5.0)

print("=== ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ  ===")

# STFTã®è¨ˆç®—
n_fft = 2048
hop_length = 512
D = librosa.stft(y, n_fft=n_fft, hop_length=hop_length)

# æŒ¯å¹…ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
S_db = librosa.amplitude_to_db(np.abs(D), ref=np.max)

print(f"ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®å½¢çŠ¶: {S_db.shape}")
print(f"  å‘¨æ³¢æ•°ãƒ“ãƒ³æ•°: {S_db.shape[0]}")
print(f"  æ™‚é–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°: {S_db.shape[1]}")
print(f"  å‘¨æ³¢æ•°åˆ†è§£èƒ½: {sr/n_fft:.2f} Hz")
print(f"  æ™‚é–“åˆ†è§£èƒ½: {hop_length/sr*1000:.2f} ms")

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

# æ³¢å½¢
librosa.display.waveshow(y, sr=sr, ax=axes[0])
axes[0].set_title('éŸ³å£°æ³¢å½¢', fontsize=14)
axes[0].set_ylabel('æŒ¯å¹…')

# ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
img = librosa.display.specshow(S_db, sr=sr, hop_length=hop_length,
                                x_axis='time', y_axis='hz', ax=axes[1], cmap='viridis')
axes[1].set_title('ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ', fontsize=14)
axes[1].set_ylabel('å‘¨æ³¢æ•° (Hz)')
axes[1].set_xlabel('æ™‚é–“ (ç§’)')
fig.colorbar(img, ax=axes[1], format='%+2.0f dB')

plt.tight_layout()
plt.savefig('spectrogram.png', dpi=150, bbox_inches='tight')
print("å›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: spectrogram.png")

# ãƒ‘ãƒ¯ãƒ¼ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
S_power = np.abs(D)**2
print(f"\nãƒ‘ãƒ¯ãƒ¼ç¯„å›²: [{S_power.min():.2e}, {S_power.max():.2e}]")
</code></pre>

<h3>1.3.3 ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ </h3>

<p><strong>ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼ˆMel Spectrogramï¼‰</strong>ã¯ã€äººé–“ã®è´è¦šç‰¹æ€§ã‚’è€ƒæ…®ã—ãŸå‘¨æ³¢æ•°ã‚¹ã‚±ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚</p>

<p><strong>ãƒ¡ãƒ«ã‚¹ã‚±ãƒ¼ãƒ«</strong>ã¯ã€äººé–“ãŒçŸ¥è¦šã™ã‚‹éŸ³é«˜ã®å°ºåº¦ã§ã™ï¼š</p>

<p>$$
m = 2595 \log_{10}\left(1 + \frac{f}{700}\right)
$$</p>

<pre><code class="language-python">import librosa
import librosa.display
import matplotlib.pyplot as plt
import numpy as np

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav', duration=5.0)

print("=== ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ  ===")

# ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®è¨ˆç®—
n_fft = 2048
hop_length = 512
n_mels = 128

S_mel = librosa.feature.melspectrogram(y=y, sr=sr, n_fft=n_fft,
                                        hop_length=hop_length, n_mels=n_mels)
S_mel_db = librosa.power_to_db(S_mel, ref=np.max)

print(f"ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®å½¢çŠ¶: {S_mel_db.shape}")
print(f"  ãƒ¡ãƒ«ãƒãƒ³ãƒ‰æ•°: {n_mels}")
print(f"  æ™‚é–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°: {S_mel_db.shape[1]}")

# é€šå¸¸ã®ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
D = librosa.stft(y, n_fft=n_fft, hop_length=hop_length)
S_db = librosa.amplitude_to_db(np.abs(D), ref=np.max)

# å¯è¦–åŒ–ï¼šæ¯”è¼ƒ
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

# é€šå¸¸ã®ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
img1 = librosa.display.specshow(S_db, sr=sr, hop_length=hop_length,
                                  x_axis='time', y_axis='hz', ax=axes[0], cmap='viridis')
axes[0].set_title('é€šå¸¸ã®ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼ˆç·šå½¢å‘¨æ³¢æ•°ï¼‰', fontsize=14)
axes[0].set_ylabel('å‘¨æ³¢æ•° (Hz)')
fig.colorbar(img1, ax=axes[0], format='%+2.0f dB')

# ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
img2 = librosa.display.specshow(S_mel_db, sr=sr, hop_length=hop_length,
                                  x_axis='time', y_axis='mel', ax=axes[1], cmap='viridis')
axes[1].set_title('ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼ˆãƒ¡ãƒ«ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰', fontsize=14)
axes[1].set_ylabel('å‘¨æ³¢æ•° (ãƒ¡ãƒ«)')
axes[1].set_xlabel('æ™‚é–“ (ç§’)')
fig.colorbar(img2, ax=axes[1], format='%+2.0f dB')

plt.tight_layout()
plt.savefig('mel_spectrogram.png', dpi=150, bbox_inches='tight')
print("å›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: mel_spectrogram.png")

# ãƒ¡ãƒ«ã‚¹ã‚±ãƒ¼ãƒ«ã®ç‰¹æ€§
print("\nãƒ¡ãƒ«ã‚¹ã‚±ãƒ¼ãƒ«ã®ç‰¹æ€§:")
print("- ä½å‘¨æ³¢æ•°: é«˜ã„å‘¨æ³¢æ•°åˆ†è§£èƒ½")
print("- é«˜å‘¨æ³¢æ•°: ä½ã„å‘¨æ³¢æ•°åˆ†è§£èƒ½")
print("- äººé–“ã®è´è¦šç‰¹æ€§ã«è¿‘ã„è¡¨ç¾")
</code></pre>

<hr>

<h2>1.4 éŸ³éŸ¿ç‰¹å¾´é‡</h2>

<h3>éŸ³éŸ¿ç‰¹å¾´é‡ã¨ã¯</h3>
<p><strong>éŸ³éŸ¿ç‰¹å¾´é‡ï¼ˆAcoustic Featuresï¼‰</strong>ã¯ã€éŸ³å£°ä¿¡å·ã‹ã‚‰æŠ½å‡ºã•ã‚Œã‚‹ç‰¹å¾´çš„ãªæ•°å€¤è¡¨ç¾ã§ã™ã€‚æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®å…¥åŠ›ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</p>

<h3>1.4.1 MFCCï¼ˆMel-Frequency Cepstral Coefficientsï¼‰</h3>

<p><strong>MFCC</strong>ã¯ã€éŸ³å£°èªè­˜ã§æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹ç‰¹å¾´é‡ã§ã™ã€‚ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã«å¯¾æ•°ã¨é›¢æ•£ã‚³ã‚µã‚¤ãƒ³å¤‰æ›ï¼ˆDCTï¼‰ã‚’é©ç”¨ã—ã¾ã™ã€‚</p>

<div class="mermaid">
graph LR
    A[éŸ³å£°ä¿¡å·] --> B[ãƒ—ãƒªã‚¨ãƒ³ãƒ•ã‚¡ã‚·ã‚¹]
    B --> C[ãƒ•ãƒ¬ãƒ¼ãƒ åˆ†å‰²]
    C --> D[çª“é–¢æ•°é©ç”¨]
    D --> E[FFT]
    E --> F[ãƒ¡ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒãƒ³ã‚¯]
    F --> G[å¯¾æ•°]
    G --> H[DCT]
    H --> I[MFCCä¿‚æ•°]

    style A fill:#ffebee
    style I fill:#e8f5e9
</div>

<pre><code class="language-python">import librosa
import librosa.display
import matplotlib.pyplot as plt
import numpy as np

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav', duration=5.0)

print("=== MFCCï¼ˆMel-Frequency Cepstral Coefficientsï¼‰===")

# MFCCã®è¨ˆç®—
n_mfcc = 13  # ä¸€èˆ¬çš„ã«ã¯13ã¾ãŸã¯20
mfccs = librosa.feature.mfcc(y=y, sr=sr, n_mfcc=n_mfcc)

print(f"MFCCã®å½¢çŠ¶: {mfccs.shape}")
print(f"  MFCCä¿‚æ•°æ•°: {n_mfcc}")
print(f"  æ™‚é–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°: {mfccs.shape[1]}")

# çµ±è¨ˆé‡
print(f"\nMFCCçµ±è¨ˆ:")
print(f"  å¹³å‡: {np.mean(mfccs, axis=1)[:5]}")  # æœ€åˆã®5ä¿‚æ•°
print(f"  æ¨™æº–åå·®: {np.std(mfccs, axis=1)[:5]}")

# ãƒ‡ãƒ«ã‚¿ç‰¹å¾´é‡ï¼ˆ1æ¬¡å¾®åˆ†ï¼‰
mfccs_delta = librosa.feature.delta(mfccs)
print(f"\nãƒ‡ãƒ«ã‚¿MFCCå½¢çŠ¶: {mfccs_delta.shape}")

# ãƒ‡ãƒ«ã‚¿ãƒ‡ãƒ«ã‚¿ç‰¹å¾´é‡ï¼ˆ2æ¬¡å¾®åˆ†ï¼‰
mfccs_delta2 = librosa.feature.delta(mfccs, order=2)
print(f"ãƒ‡ãƒ«ã‚¿ãƒ‡ãƒ«ã‚¿MFCCå½¢çŠ¶: {mfccs_delta2.shape}")

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 1, figsize=(14, 12))

# MFCC
img1 = librosa.display.specshow(mfccs, sr=sr, x_axis='time', ax=axes[0], cmap='coolwarm')
axes[0].set_title('MFCC', fontsize=14)
axes[0].set_ylabel('MFCCä¿‚æ•°')
fig.colorbar(img1, ax=axes[0])

# ãƒ‡ãƒ«ã‚¿MFCC
img2 = librosa.display.specshow(mfccs_delta, sr=sr, x_axis='time', ax=axes[1], cmap='coolwarm')
axes[1].set_title('ãƒ‡ãƒ«ã‚¿MFCCï¼ˆ1æ¬¡å¾®åˆ†ï¼‰', fontsize=14)
axes[1].set_ylabel('ãƒ‡ãƒ«ã‚¿MFCCä¿‚æ•°')
fig.colorbar(img2, ax=axes[1])

# ãƒ‡ãƒ«ã‚¿ãƒ‡ãƒ«ã‚¿MFCC
img3 = librosa.display.specshow(mfccs_delta2, sr=sr, x_axis='time', ax=axes[2], cmap='coolwarm')
axes[2].set_title('ãƒ‡ãƒ«ã‚¿ãƒ‡ãƒ«ã‚¿MFCCï¼ˆ2æ¬¡å¾®åˆ†ï¼‰', fontsize=14)
axes[2].set_ylabel('ãƒ‡ãƒ«ã‚¿ãƒ‡ãƒ«ã‚¿MFCCä¿‚æ•°')
axes[2].set_xlabel('æ™‚é–“ (ç§’)')
fig.colorbar(img3, ax=axes[2])

plt.tight_layout()
plt.savefig('mfcc_features.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: mfcc_features.png")

# ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã®çµåˆï¼ˆéŸ³å£°èªè­˜ã§ä¸€èˆ¬çš„ï¼‰
combined_features = np.vstack([mfccs, mfccs_delta, mfccs_delta2])
print(f"\nçµåˆç‰¹å¾´é‡ã®å½¢çŠ¶: {combined_features.shape}")
print(f"  (13 MFCC + 13 ãƒ‡ãƒ«ã‚¿ + 13 ãƒ‡ãƒ«ã‚¿ãƒ‡ãƒ«ã‚¿ = 39æ¬¡å…ƒ)")
</code></pre>

<h3>1.4.2 Chroma Features</h3>

<p><strong>ã‚¯ãƒ­ãƒç‰¹å¾´é‡ï¼ˆChroma Featuresï¼‰</strong>ã¯ã€éŸ³æ¥½ã®èª¿æ€§ã‚„å’ŒéŸ³ã‚’è¡¨ç¾ã—ã¾ã™ã€‚12å€‹ã®éŸ³éšã‚¯ãƒ©ã‚¹ï¼ˆC, C#, D, ..., Bï¼‰ã”ã¨ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import librosa
import librosa.display
import matplotlib.pyplot as plt
import numpy as np

# éŸ³æ¥½ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('music.wav', duration=10.0)

print("=== Chroma Features ===")

# ã‚¯ãƒ­ãƒã‚°ãƒ©ãƒ ã®è¨ˆç®—
chromagram = librosa.feature.chroma_stft(y=y, sr=sr)

print(f"ã‚¯ãƒ­ãƒã‚°ãƒ©ãƒ ã®å½¢çŠ¶: {chromagram.shape}")
print(f"  éŸ³éšã‚¯ãƒ©ã‚¹æ•°: 12 (C, C#, D, D#, E, F, F#, G, G#, A, A#, B)")
print(f"  æ™‚é–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°: {chromagram.shape[1]}")

# CQTï¼ˆConstant-Q Transformï¼‰ãƒ™ãƒ¼ã‚¹ã®ã‚¯ãƒ­ãƒ
chromagram_cqt = librosa.feature.chroma_cqt(y=y, sr=sr)
print(f"\nCQTã‚¯ãƒ­ãƒã‚°ãƒ©ãƒ ã®å½¢çŠ¶: {chromagram_cqt.shape}")

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 1, figsize=(14, 10))

# æ³¢å½¢
librosa.display.waveshow(y, sr=sr, ax=axes[0])
axes[0].set_title('éŸ³å£°æ³¢å½¢', fontsize=14)
axes[0].set_ylabel('æŒ¯å¹…')

# STFTãƒ™ãƒ¼ã‚¹ã®ã‚¯ãƒ­ãƒ
img1 = librosa.display.specshow(chromagram, sr=sr, x_axis='time',
                                  y_axis='chroma', ax=axes[1], cmap='coolwarm')
axes[1].set_title('ã‚¯ãƒ­ãƒã‚°ãƒ©ãƒ ï¼ˆSTFTï¼‰', fontsize=14)
axes[1].set_ylabel('ãƒ”ãƒƒãƒã‚¯ãƒ©ã‚¹')
fig.colorbar(img1, ax=axes[1])

# CQTãƒ™ãƒ¼ã‚¹ã®ã‚¯ãƒ­ãƒ
img2 = librosa.display.specshow(chromagram_cqt, sr=sr, x_axis='time',
                                  y_axis='chroma', ax=axes[2], cmap='coolwarm')
axes[2].set_title('ã‚¯ãƒ­ãƒã‚°ãƒ©ãƒ ï¼ˆCQTï¼‰', fontsize=14)
axes[2].set_ylabel('ãƒ”ãƒƒãƒã‚¯ãƒ©ã‚¹')
axes[2].set_xlabel('æ™‚é–“ (ç§’)')
fig.colorbar(img2, ax=axes[2])

plt.tight_layout()
plt.savefig('chroma_features.png', dpi=150, bbox_inches='tight')
print("å›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: chroma_features.png")

# å„ãƒ”ãƒƒãƒã‚¯ãƒ©ã‚¹ã®å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼
pitch_classes = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B']
mean_energy = np.mean(chromagram, axis=1)

print("\nå„ãƒ”ãƒƒãƒã‚¯ãƒ©ã‚¹ã®å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼:")
for pc, energy in zip(pitch_classes, mean_energy):
    print(f"  {pc}: {energy:.3f}")
</code></pre>

<h3>1.4.3 Spectral Features</h3>

<p><strong>ã‚¹ãƒšã‚¯ãƒˆãƒ«ç‰¹å¾´é‡</strong>ã¯ã€å‘¨æ³¢æ•°åˆ†å¸ƒã®ç‰¹æ€§ã‚’æ‰ãˆã¾ã™ã€‚</p>

<pre><code class="language-python">import librosa
import matplotlib.pyplot as plt
import numpy as np

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav', duration=5.0)

print("=== Spectral Features ===")

# 1. Spectral Centroidï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«é‡å¿ƒï¼‰
spectral_centroids = librosa.feature.spectral_centroid(y=y, sr=sr)[0]
print(f"Spectral Centroid: å¹³å‡ {np.mean(spectral_centroids):.2f} Hz")

# 2. Spectral Rolloffï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ­ãƒ¼ãƒ«ã‚ªãƒ•ï¼‰
spectral_rolloff = librosa.feature.spectral_rolloff(y=y, sr=sr)[0]
print(f"Spectral Rolloff: å¹³å‡ {np.mean(spectral_rolloff):.2f} Hz")

# 3. Spectral Bandwidthï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«å¸¯åŸŸå¹…ï¼‰
spectral_bandwidth = librosa.feature.spectral_bandwidth(y=y, sr=sr)[0]
print(f"Spectral Bandwidth: å¹³å‡ {np.mean(spectral_bandwidth):.2f} Hz")

# 4. Spectral Contrastï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆï¼‰
spectral_contrast = librosa.feature.spectral_contrast(y=y, sr=sr)
print(f"Spectral Contrastå½¢çŠ¶: {spectral_contrast.shape}")

# 5. Spectral Flatnessï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«å¹³å¦åº¦ï¼‰
spectral_flatness = librosa.feature.spectral_flatness(y=y)[0]
print(f"Spectral Flatness: å¹³å‡ {np.mean(spectral_flatness):.4f}")

# æ™‚é–“è»¸
frames = range(len(spectral_centroids))
t = librosa.frames_to_time(frames, sr=sr)

# å¯è¦–åŒ–
fig, axes = plt.subplots(5, 1, figsize=(14, 14))

# ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼ˆèƒŒæ™¯ï¼‰
D = librosa.stft(y)
S_db = librosa.amplitude_to_db(np.abs(D), ref=np.max)

# 1. Spectral Centroid
librosa.display.specshow(S_db, sr=sr, x_axis='time', y_axis='hz', ax=axes[0], cmap='gray_r', alpha=0.5)
axes[0].plot(t, spectral_centroids, color='red', linewidth=2, label='Spectral Centroid')
axes[0].set_title('Spectral Centroid', fontsize=14)
axes[0].set_ylabel('å‘¨æ³¢æ•° (Hz)')
axes[0].legend()

# 2. Spectral Rolloff
librosa.display.specshow(S_db, sr=sr, x_axis='time', y_axis='hz', ax=axes[1], cmap='gray_r', alpha=0.5)
axes[1].plot(t, spectral_rolloff, color='blue', linewidth=2, label='Spectral Rolloff')
axes[1].set_title('Spectral Rolloff', fontsize=14)
axes[1].set_ylabel('å‘¨æ³¢æ•° (Hz)')
axes[1].legend()

# 3. Spectral Bandwidth
axes[2].plot(t, spectral_bandwidth, color='green', linewidth=2)
axes[2].set_title('Spectral Bandwidth', fontsize=14)
axes[2].set_ylabel('å¸¯åŸŸå¹… (Hz)')
axes[2].grid(True, alpha=0.3)

# 4. Spectral Contrast
img = librosa.display.specshow(spectral_contrast, sr=sr, x_axis='time', ax=axes[3], cmap='coolwarm')
axes[3].set_title('Spectral Contrast', fontsize=14)
axes[3].set_ylabel('å‘¨æ³¢æ•°ãƒãƒ³ãƒ‰')
fig.colorbar(img, ax=axes[3])

# 5. Spectral Flatness
axes[4].plot(t, spectral_flatness, color='purple', linewidth=2)
axes[4].set_title('Spectral Flatnessï¼ˆ0=ãƒˆãƒ¼ãƒ³çš„, 1=ãƒã‚¤ã‚ºçš„ï¼‰', fontsize=14)
axes[4].set_ylabel('å¹³å¦åº¦')
axes[4].set_xlabel('æ™‚é–“ (ç§’)')
axes[4].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('spectral_features.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: spectral_features.png")

print("\nè§£é‡ˆ:")
print("- Centroid: éŸ³ã®ã€Œæ˜ã‚‹ã•ã€")
print("- Rolloff: ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®é›†ä¸­åº¦")
print("- Bandwidth: å‘¨æ³¢æ•°ã®åºƒãŒã‚Š")
print("- Contrast: å‘¨æ³¢æ•°å¸¯åŸŸé–“ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆ")
print("- Flatness: ãƒˆãƒ¼ãƒ³çš„ï¼ˆ0ï¼‰ã‹ãƒã‚¤ã‚ºçš„ï¼ˆ1ï¼‰ã‹")
</code></pre>

<h3>1.4.4 ç‰¹å¾´æŠ½å‡ºãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</h3>

<pre><code class="language-python">import librosa
import numpy as np

def extract_audio_features(audio_path, sr=22050):
    """
    éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰åŒ…æ‹¬çš„ãªç‰¹å¾´é‡ã‚’æŠ½å‡º
    """
    # éŸ³å£°ã®èª­ã¿è¾¼ã¿
    y, sr = librosa.load(audio_path, sr=sr)

    # ç‰¹å¾´é‡è¾æ›¸
    features = {}

    # 1. åŸºæœ¬çµ±è¨ˆ
    features['duration'] = len(y) / sr
    features['rms_mean'] = float(np.mean(librosa.feature.rms(y=y)))
    features['zcr_mean'] = float(np.mean(librosa.feature.zero_crossing_rate(y)))

    # 2. MFCCï¼ˆçµ±è¨ˆé‡ï¼‰
    mfccs = librosa.feature.mfcc(y=y, sr=sr, n_mfcc=13)
    for i in range(13):
        features[f'mfcc_{i}_mean'] = float(np.mean(mfccs[i]))
        features[f'mfcc_{i}_std'] = float(np.std(mfccs[i]))

    # 3. ã‚¹ãƒšã‚¯ãƒˆãƒ«ç‰¹å¾´
    features['spectral_centroid_mean'] = float(np.mean(librosa.feature.spectral_centroid(y=y, sr=sr)))
    features['spectral_rolloff_mean'] = float(np.mean(librosa.feature.spectral_rolloff(y=y, sr=sr)))
    features['spectral_bandwidth_mean'] = float(np.mean(librosa.feature.spectral_bandwidth(y=y, sr=sr)))
    features['spectral_flatness_mean'] = float(np.mean(librosa.feature.spectral_flatness(y=y)))

    # 4. ã‚¯ãƒ­ãƒç‰¹å¾´
    chroma = librosa.feature.chroma_stft(y=y, sr=sr)
    features['chroma_mean'] = float(np.mean(chroma))
    features['chroma_std'] = float(np.std(chroma))

    # 5. ãƒ†ãƒ³ãƒ
    tempo, _ = librosa.beat.beat_track(y=y, sr=sr)
    features['tempo'] = float(tempo)

    return features

# ä½¿ç”¨ä¾‹
print("=== éŸ³éŸ¿ç‰¹å¾´æŠ½å‡ºãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ ===")
audio_file = 'sample.wav'
features = extract_audio_features(audio_file)

print(f"\næŠ½å‡ºã•ã‚ŒãŸç‰¹å¾´é‡ã®æ•°: {len(features)}")
print("\nä¸»ãªç‰¹å¾´é‡:")
for key in list(features.keys())[:10]:
    print(f"  {key}: {features[key]:.4f}")

# ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦å–å¾—
feature_vector = np.array(list(features.values()))
print(f"\nç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒ: {len(feature_vector)}")
print(f"ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆæœ€åˆã®10æ¬¡å…ƒï¼‰: {feature_vector[:10]}")

# è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ç‰¹å¾´æŠ½å‡º
audio_files = ['sample1.wav', 'sample2.wav', 'sample3.wav']
all_features = []

print("\nè¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®ç‰¹å¾´æŠ½å‡º:")
for audio_file in audio_files:
    try:
        feats = extract_audio_features(audio_file)
        all_features.append(list(feats.values()))
        print(f"  âœ“ {audio_file}: {len(feats)} ç‰¹å¾´é‡")
    except Exception as e:
        print(f"  âœ— {audio_file}: ã‚¨ãƒ©ãƒ¼ ({e})")

if all_features:
    # NumPyé…åˆ—ã«å¤‰æ›ï¼ˆæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®å…¥åŠ›ã¨ã—ã¦ä½¿ç”¨ï¼‰
    X = np.array(all_features)
    print(f"\nç‰¹å¾´è¡Œåˆ—ã®å½¢çŠ¶: {X.shape}")
    print(f"  (ã‚µãƒ³ãƒ—ãƒ«æ•°, ç‰¹å¾´é‡æ•°)")
</code></pre>

<hr>

<h2>1.5 éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†</h2>

<h3>å‰å‡¦ç†ã®é‡è¦æ€§</h3>
<p>éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†ã¯ã€ãƒ¢ãƒ‡ãƒ«æ€§èƒ½ã«å¤§ããå½±éŸ¿ã—ã¾ã™ã€‚ãƒã‚¤ã‚ºé™¤å»ã€æ­£è¦åŒ–ã€ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µãªã©ãŒå«ã¾ã‚Œã¾ã™ã€‚</p>

<h3>1.5.1 Noise Reduction</h3>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import wiener

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav')

print("=== ãƒã‚¤ã‚ºé™¤å» ===")

# 1. ã‚¦ã‚£ãƒ¼ãƒŠãƒ¼ãƒ•ã‚£ãƒ«ã‚¿
y_wiener = wiener(y)
print(f"ã‚¦ã‚£ãƒ¼ãƒŠãƒ¼ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨")

# 2. ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚²ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆç°¡æ˜“ç‰ˆï¼‰
# ãƒã‚¤ã‚ºãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨å®šï¼ˆæœ€åˆã®0.5ç§’ã‚’ãƒã‚¤ã‚ºã¨ä»®å®šï¼‰
noise_sample = y[:int(0.5 * sr)]
noise_spec = np.abs(librosa.stft(noise_sample))
noise_profile = np.mean(noise_spec, axis=1, keepdims=True)

# å…¨ä½“ã®ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
D = librosa.stft(y)
magnitude = np.abs(D)
phase = np.angle(D)

# ãƒã‚¤ã‚ºé™¤å»ï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚µãƒ–ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³ï¼‰
magnitude_clean = np.maximum(magnitude - 2.0 * noise_profile, 0.0)
D_clean = magnitude_clean * np.exp(1j * phase)
y_clean = librosa.istft(D_clean)

print(f"ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚µãƒ–ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³é©ç”¨")

# 3. ãƒã‚¤ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆä½å‘¨æ³¢ãƒã‚¤ã‚ºé™¤å»ï¼‰
from scipy.signal import butter, filtfilt

def highpass_filter(data, cutoff, fs, order=5):
    nyquist = 0.5 * fs
    normal_cutoff = cutoff / nyquist
    b, a = butter(order, normal_cutoff, btype='high', analog=False)
    return filtfilt(b, a, data)

y_highpass = highpass_filter(y, cutoff=80, fs=sr)
print(f"ãƒã‚¤ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨ï¼ˆ80Hzä»¥ä¸‹ã‚’ã‚«ãƒƒãƒˆï¼‰")

# å¯è¦–åŒ–
fig, axes = plt.subplots(4, 1, figsize=(14, 12))

# ã‚ªãƒªã‚¸ãƒŠãƒ«
librosa.display.waveshow(y, sr=sr, ax=axes[0], color='blue')
axes[0].set_title('ã‚ªãƒªã‚¸ãƒŠãƒ«éŸ³å£°', fontsize=14)
axes[0].set_ylabel('æŒ¯å¹…')

# ã‚¦ã‚£ãƒ¼ãƒŠãƒ¼ãƒ•ã‚£ãƒ«ã‚¿
librosa.display.waveshow(y_wiener, sr=sr, ax=axes[1], color='green')
axes[1].set_title('ã‚¦ã‚£ãƒ¼ãƒŠãƒ¼ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨å¾Œ', fontsize=14)
axes[1].set_ylabel('æŒ¯å¹…')

# ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚µãƒ–ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³
librosa.display.waveshow(y_clean, sr=sr, ax=axes[2], color='red')
axes[2].set_title('ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚µãƒ–ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³é©ç”¨å¾Œ', fontsize=14)
axes[2].set_ylabel('æŒ¯å¹…')

# ãƒã‚¤ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿
librosa.display.waveshow(y_highpass, sr=sr, ax=axes[3], color='purple')
axes[3].set_title('ãƒã‚¤ãƒ‘ã‚¹ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨å¾Œ', fontsize=14)
axes[3].set_ylabel('æŒ¯å¹…')
axes[3].set_xlabel('æ™‚é–“ (ç§’)')

plt.tight_layout()
plt.savefig('noise_reduction.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: noise_reduction.png")

# SNRè¨ˆç®—ï¼ˆç°¡æ˜“ç‰ˆï¼‰
def calculate_snr(signal, noise):
    signal_power = np.mean(signal**2)
    noise_power = np.mean(noise**2)
    return 10 * np.log10(signal_power / noise_power)

print(f"\nSNRæ”¹å–„:")
print(f"  ã‚ªãƒªã‚¸ãƒŠãƒ«: åŸºæº–")
print(f"  ã‚¦ã‚£ãƒ¼ãƒŠãƒ¼: +{calculate_snr(y_wiener, y-y_wiener):.2f} dB")
print(f"  ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚µãƒ–ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³: +{calculate_snr(y_clean, y-y_clean):.2f} dB")
</code></pre>

<h3>1.5.2 Normalization</h3>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav')

print("=== æ­£è¦åŒ–ï¼ˆNormalizationï¼‰===")

# 1. ãƒ”ãƒ¼ã‚¯æ­£è¦åŒ–ï¼ˆæœ€å¤§æŒ¯å¹…ã‚’1.0ã«ï¼‰
y_peak_norm = y / np.max(np.abs(y))
print(f"ãƒ”ãƒ¼ã‚¯æ­£è¦åŒ–: æœ€å¤§å€¤ = {np.max(np.abs(y_peak_norm)):.3f}")

# 2. RMSæ­£è¦åŒ–ï¼ˆç›®æ¨™RMSãƒ¬ãƒ™ãƒ«ã«èª¿æ•´ï¼‰
target_rms = 0.1
current_rms = np.sqrt(np.mean(y**2))
y_rms_norm = y * (target_rms / current_rms)
new_rms = np.sqrt(np.mean(y_rms_norm**2))
print(f"RMSæ­£è¦åŒ–: {current_rms:.4f} â†’ {new_rms:.4f}")

# 3. Z-scoreæ­£è¦åŒ–ï¼ˆå¹³å‡0ã€æ¨™æº–åå·®1ï¼‰
y_zscore = (y - np.mean(y)) / np.std(y)
print(f"Z-scoreæ­£è¦åŒ–: å¹³å‡ = {np.mean(y_zscore):.6f}, æ¨™æº–åå·® = {np.std(y_zscore):.3f}")

# 4. Min-Maxæ­£è¦åŒ–ï¼ˆ-1 to 1ï¼‰
y_minmax = 2 * (y - np.min(y)) / (np.max(y) - np.min(y)) - 1
print(f"Min-Maxæ­£è¦åŒ–: ç¯„å›² = [{np.min(y_minmax):.3f}, {np.max(y_minmax):.3f}]")

# å¯è¦–åŒ–
fig, axes = plt.subplots(4, 2, figsize=(14, 12))

normalizations = [
    ('ãƒ”ãƒ¼ã‚¯æ­£è¦åŒ–', y_peak_norm),
    ('RMSæ­£è¦åŒ–', y_rms_norm),
    ('Z-scoreæ­£è¦åŒ–', y_zscore),
    ('Min-Maxæ­£è¦åŒ–', y_minmax)
]

for idx, (title, y_norm) in enumerate(normalizations):
    # æ³¢å½¢
    librosa.display.waveshow(y_norm, sr=sr, ax=axes[idx, 0])
    axes[idx, 0].set_title(f'{title} - æ³¢å½¢', fontsize=12)
    axes[idx, 0].set_ylabel('æŒ¯å¹…')

    # ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ 
    axes[idx, 1].hist(y_norm, bins=50, alpha=0.7, color='blue')
    axes[idx, 1].set_title(f'{title} - æŒ¯å¹…åˆ†å¸ƒ', fontsize=12)
    axes[idx, 1].set_xlabel('æŒ¯å¹…')
    axes[idx, 1].set_ylabel('é »åº¦')
    axes[idx, 1].grid(True, alpha=0.3)

axes[3, 0].set_xlabel('æ™‚é–“ (ç§’)')

plt.tight_layout()
plt.savefig('normalization.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: normalization.png")

# çµ±è¨ˆæƒ…å ±
print("\næ­£è¦åŒ–å¾Œã®çµ±è¨ˆ:")
for title, y_norm in normalizations:
    print(f"{title}:")
    print(f"  å¹³å‡: {np.mean(y_norm):.6f}")
    print(f"  æ¨™æº–åå·®: {np.std(y_norm):.6f}")
    print(f"  ç¯„å›²: [{np.min(y_norm):.3f}, {np.max(y_norm):.3f}]")
</code></pre>

<h3>1.5.3 Trimming and Padding</h3>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav')

print("=== ãƒˆãƒªãƒŸãƒ³ã‚°ã¨ãƒ‘ãƒ‡ã‚£ãƒ³ã‚° ===")

# 1. ç„¡éŸ³éƒ¨åˆ†ã®ãƒˆãƒªãƒŸãƒ³ã‚°
y_trimmed, index = librosa.effects.trim(y, top_db=20)
print(f"ãƒˆãƒªãƒŸãƒ³ã‚°:")
print(f"  å…ƒã®é•·ã•: {len(y)/sr:.2f} ç§’")
print(f"  ãƒˆãƒªãƒŸãƒ³ã‚°å¾Œ: {len(y_trimmed)/sr:.2f} ç§’")
print(f"  å‰Šæ¸›: {(1 - len(y_trimmed)/len(y))*100:.1f}%")

# 2. å›ºå®šé•·ã¸ã®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°/ãƒˆãƒªãƒŸãƒ³ã‚°
target_length = sr * 5  # 5ç§’

def pad_or_trim(audio, target_length):
    """å›ºå®šé•·ã«ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã¾ãŸã¯ãƒˆãƒªãƒŸãƒ³ã‚°"""
    if len(audio) < target_length:
        # ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°
        pad_length = target_length - len(audio)
        audio_padded = np.pad(audio, (0, pad_length), mode='constant')
        return audio_padded, 'padded'
    else:
        # ãƒˆãƒªãƒŸãƒ³ã‚°
        return audio[:target_length], 'trimmed'

y_fixed, action = pad_or_trim(y, target_length)
print(f"\nå›ºå®šé•·å‡¦ç† (5ç§’):")
print(f"  ã‚¢ã‚¯ã‚·ãƒ§ãƒ³: {action}")
print(f"  çµæœã®é•·ã•: {len(y_fixed)/sr:.2f} ç§’")

# 3. ä¸­å¤®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°
def center_pad(audio, target_length):
    """ä¸­å¤®ã«ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°"""
    if len(audio) >= target_length:
        return audio[:target_length]

    pad_length = target_length - len(audio)
    pad_left = pad_length // 2
    pad_right = pad_length - pad_left
    return np.pad(audio, (pad_left, pad_right), mode='constant')

y_center_padded = center_pad(y_trimmed, target_length)
print(f"\nä¸­å¤®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°:")
print(f"  çµæœã®é•·ã•: {len(y_center_padded)/sr:.2f} ç§’")

# å¯è¦–åŒ–
fig, axes = plt.subplots(4, 1, figsize=(14, 10))

# ã‚ªãƒªã‚¸ãƒŠãƒ«
librosa.display.waveshow(y, sr=sr, ax=axes[0], color='blue')
axes[0].set_title('ã‚ªãƒªã‚¸ãƒŠãƒ«éŸ³å£°', fontsize=14)
axes[0].set_ylabel('æŒ¯å¹…')
axes[0].axvline(x=index[0]/sr, color='red', linestyle='--', alpha=0.5)
axes[0].axvline(x=index[1]/sr, color='red', linestyle='--', alpha=0.5)

# ãƒˆãƒªãƒŸãƒ³ã‚°å¾Œ
librosa.display.waveshow(y_trimmed, sr=sr, ax=axes[1], color='green')
axes[1].set_title('ç„¡éŸ³ãƒˆãƒªãƒŸãƒ³ã‚°å¾Œ', fontsize=14)
axes[1].set_ylabel('æŒ¯å¹…')

# å›ºå®šé•·
librosa.display.waveshow(y_fixed, sr=sr, ax=axes[2], color='red')
axes[2].set_title(f'å›ºå®šé•·å‡¦ç†å¾Œ (5ç§’, {action})', fontsize=14)
axes[2].set_ylabel('æŒ¯å¹…')

# ä¸­å¤®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°
librosa.display.waveshow(y_center_padded, sr=sr, ax=axes[3], color='purple')
axes[3].set_title('ä¸­å¤®ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°', fontsize=14)
axes[3].set_ylabel('æŒ¯å¹…')
axes[3].set_xlabel('æ™‚é–“ (ç§’)')

plt.tight_layout()
plt.savefig('trim_pad.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: trim_pad.png")
</code></pre>

<h3>1.5.4 Data Augmentation</h3>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav', duration=3.0)

print("=== ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µï¼ˆData Augmentationï¼‰===")

# 1. Pitch Shiftingï¼ˆãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆï¼‰
y_pitch_up = librosa.effects.pitch_shift(y, sr=sr, n_steps=4)  # 4åŠéŸ³ä¸Šã’ã‚‹
y_pitch_down = librosa.effects.pitch_shift(y, sr=sr, n_steps=-4)  # 4åŠéŸ³ä¸‹ã’ã‚‹
print("ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ: Â±4åŠéŸ³")

# 2. Time Stretchingï¼ˆæ™‚é–“ä¼¸ç¸®ï¼‰
y_fast = librosa.effects.time_stretch(y, rate=1.5)  # 1.5å€é€Ÿ
y_slow = librosa.effects.time_stretch(y, rate=0.8)  # 0.8å€é€Ÿ
print(f"ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ: 1.5å€é€Ÿ({len(y_fast)/sr:.2f}ç§’), 0.8å€é€Ÿ({len(y_slow)/sr:.2f}ç§’)")

# 3. ãƒã‚¤ã‚ºè¿½åŠ 
noise_factor = 0.005
noise = np.random.randn(len(y))
y_noise = y + noise_factor * noise
print(f"ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºè¿½åŠ : ãƒã‚¤ã‚ºãƒ¬ãƒ™ãƒ« = {noise_factor}")

# 4. ã‚²ã‚¤ãƒ³èª¿æ•´ï¼ˆéŸ³é‡å¤‰åŒ–ï¼‰
y_louder = y * 1.5
y_quieter = y * 0.5
print("ã‚²ã‚¤ãƒ³èª¿æ•´: 1.5å€, 0.5å€")

# 5. Time Shiftï¼ˆæ™‚é–“ã‚·ãƒ•ãƒˆï¼‰
shift_samples = int(0.2 * sr)  # 0.2ç§’ã‚·ãƒ•ãƒˆ
y_shift = np.roll(y, shift_samples)
print(f"æ™‚é–“ã‚·ãƒ•ãƒˆ: {shift_samples/sr:.2f}ç§’")

# å¯è¦–åŒ–
fig, axes = plt.subplots(6, 1, figsize=(14, 16))

augmentations = [
    ('ã‚ªãƒªã‚¸ãƒŠãƒ«', y),
    ('ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ (+4åŠéŸ³)', y_pitch_up),
    ('ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ (1.5x)', y_fast),
    ('ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºè¿½åŠ ', y_noise),
    ('ã‚²ã‚¤ãƒ³èª¿æ•´ (1.5x)', y_louder),
    ('æ™‚é–“ã‚·ãƒ•ãƒˆ (0.2ç§’)', y_shift)
]

for idx, (title, y_aug) in enumerate(augmentations):
    librosa.display.waveshow(y_aug, sr=sr, ax=axes[idx])
    axes[idx].set_title(title, fontsize=14)
    axes[idx].set_ylabel('æŒ¯å¹…')

axes[5].set_xlabel('æ™‚é–“ (ç§’)')

plt.tight_layout()
plt.savefig('data_augmentation.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: data_augmentation.png")

# ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
def augment_audio(y, sr):
    """ãƒ©ãƒ³ãƒ€ãƒ ã«ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µã‚’é©ç”¨"""
    augmentations = []

    # ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ (50%ã®ç¢ºç‡)
    if np.random.rand() > 0.5:
        n_steps = np.random.randint(-3, 4)
        y = librosa.effects.pitch_shift(y, sr=sr, n_steps=n_steps)
        augmentations.append(f'pitch_shift({n_steps})')

    # ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ (50%ã®ç¢ºç‡)
    if np.random.rand() > 0.5:
        rate = np.random.uniform(0.8, 1.2)
        y = librosa.effects.time_stretch(y, rate=rate)
        augmentations.append(f'time_stretch({rate:.2f})')

    # ãƒã‚¤ã‚ºè¿½åŠ  (30%ã®ç¢ºç‡)
    if np.random.rand() > 0.7:
        noise = np.random.randn(len(y))
        y = y + 0.005 * noise
        augmentations.append('add_noise')

    # ã‚²ã‚¤ãƒ³èª¿æ•´ (50%ã®ç¢ºç‡)
    if np.random.rand() > 0.5:
        gain = np.random.uniform(0.7, 1.3)
        y = y * gain
        augmentations.append(f'gain({gain:.2f})')

    return y, augmentations

# ä½¿ç”¨ä¾‹
print("\nãƒ©ãƒ³ãƒ€ãƒ æ‹¡å¼µã®ä¾‹:")
for i in range(3):
    y_aug, augs = augment_audio(y, sr)
    print(f"  è©¦è¡Œ {i+1}: {', '.join(augs) if augs else 'ãªã—'}")
</code></pre>

<hr>

<h2>1.6 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><p><strong>ãƒ‡ã‚¸ã‚¿ãƒ«éŸ³å£°ã®åŸºç¤</strong></p>
<ul>
<li>ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆï¼šæ™‚é–“æ–¹å‘ã®é›¢æ•£åŒ–</li>
<li>é‡å­åŒ–ã¨ãƒ“ãƒƒãƒˆæ·±åº¦ï¼šæŒ¯å¹…ã®é›¢æ•£åŒ–</li>
<li>éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ï¼šWAVã€MP3ã€FLAC</li>
<li>librosaã«ã‚ˆã‚‹éŸ³å£°ã®èª­ã¿è¾¼ã¿ã¨åŸºæœ¬æ“ä½œ</li>
</ul></li>

<li><p><strong>æ™‚é–“é ˜åŸŸã®å‡¦ç†</strong></p>
<ul>
<li>æŒ¯å¹…ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€RMS</li>
<li>Zero Crossing Rateï¼ˆZCRï¼‰</li>
<li>éŸ³å£°æ³¢å½¢ã®å¯è¦–åŒ–</li>
</ul></li>

<li><p><strong>å‘¨æ³¢æ•°é ˜åŸŸã®å‡¦ç†</strong></p>
<ul>
<li>ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼ˆFFTï¼‰ï¼šæ™‚é–“â†’å‘¨æ³¢æ•°</li>
<li>ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼šæ™‚é–“-å‘¨æ³¢æ•°è¡¨ç¾</li>
<li>ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼šäººé–“ã®è´è¦šç‰¹æ€§ã‚’è€ƒæ…®</li>
</ul></li>

<li><p><strong>éŸ³éŸ¿ç‰¹å¾´é‡</strong></p>
<ul>
<li>MFCCï¼šéŸ³å£°èªè­˜ã®æ¨™æº–ç‰¹å¾´é‡</li>
<li>Chromaï¼šéŸ³æ¥½ã®èª¿æ€§è¡¨ç¾</li>
<li>Spectral Featuresï¼šå‘¨æ³¢æ•°åˆ†å¸ƒã®ç‰¹æ€§</li>
<li>ç‰¹å¾´æŠ½å‡ºãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</li>
</ul></li>

<li><p><strong>éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†</strong></p>
<ul>
<li>ãƒã‚¤ã‚ºé™¤å»ï¼šã‚¦ã‚£ãƒ¼ãƒŠãƒ¼ãƒ•ã‚£ãƒ«ã‚¿ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚µãƒ–ãƒˆãƒ©ã‚¯ã‚·ãƒ§ãƒ³</li>
<li>æ­£è¦åŒ–ï¼šãƒ”ãƒ¼ã‚¯ã€RMSã€Z-score</li>
<li>ãƒˆãƒªãƒŸãƒ³ã‚°ã¨ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ï¼šå›ºå®šé•·åŒ–</li>
<li>ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µï¼šãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆã€ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ</li>
</ul></li>
</ol>

<h3>å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®ä¾‹</h3>

<div class="mermaid">
graph LR
    A[éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«] --> B[èª­ã¿è¾¼ã¿<br>librosa.load]
    B --> C[å‰å‡¦ç†<br>ãƒˆãƒªãƒŸãƒ³ã‚°ãƒ»æ­£è¦åŒ–]
    C --> D[ç‰¹å¾´æŠ½å‡º<br>MFCC/Mel-Spec]
    D --> E[ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µ<br>ãƒ”ãƒƒãƒãƒ»æ™‚é–“]
    E --> F[ãƒ¢ãƒ‡ãƒ«å…¥åŠ›<br>NumPyé…åˆ—]

    style A fill:#ffebee
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#e3f2fd
    style E fill:#e8f5e9
    style F fill:#c8e6c9
</div>

<h3>ç‰¹å¾´é‡ã®é¸æŠã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</h3>

<table>
<thead>
<tr>
<th>ã‚¿ã‚¹ã‚¯</th>
<th>æ¨å¥¨ç‰¹å¾´é‡</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>éŸ³å£°èªè­˜</td>
<td>MFCC + ãƒ‡ãƒ«ã‚¿</td>
<td>éŸ³ç´ ã®ç‰¹å¾´ã‚’æ‰ãˆã‚‹</td>
</tr>
<tr>
<td>è©±è€…è­˜åˆ¥</td>
<td>MFCC + ãƒ”ãƒƒãƒ</td>
<td>è©±è€…å›ºæœ‰ã®ç‰¹æ€§</td>
</tr>
<tr>
<td>éŸ³æ¥½ã‚¸ãƒ£ãƒ³ãƒ«åˆ†é¡</td>
<td>Chroma + Spectral</td>
<td>èª¿æ€§ã¨ãƒ†ã‚¯ã‚¹ãƒãƒ£</td>
</tr>
<tr>
<td>ç’°å¢ƒéŸ³èªè­˜</td>
<td>Mel-Spectrogram</td>
<td>æ™‚é–“-å‘¨æ³¢æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³</td>
</tr>
<tr>
<td>æ„Ÿæƒ…èªè­˜</td>
<td>MFCC + éŸ»å¾‹ç‰¹å¾´</td>
<td>éŸ³å£°ã®è¡¨ç¾åŠ›</td>
</tr>
</tbody>
</table>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬2ç« ã§ã¯ã€<strong>éŸ³å£°èªè­˜ã®åŸºç¤</strong>ã‚’å­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>éŸ³å£°èªè­˜ã®æ­´å²ã¨ç™ºå±•</li>
<li>HMMï¼ˆéš ã‚Œãƒãƒ«ã‚³ãƒ•ãƒ¢ãƒ‡ãƒ«ï¼‰</li>
<li>ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ™ãƒ¼ã‚¹ã®éŸ³å£°èªè­˜</li>
<li>CTCï¼ˆConnectionist Temporal Classificationï¼‰</li>
<li>End-to-Endãƒ¢ãƒ‡ãƒ«ï¼ˆWav2Vecã€Whisperï¼‰</li>
</ul>

<hr>

<h2>æ¼”ç¿’å•é¡Œ</h2>

<h3>å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰</h3>
<p>ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ44100Hzã§éŒ²éŸ³ã•ã‚ŒãŸ3ç§’ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ä½•ã‚µãƒ³ãƒ—ãƒ«ã§æ§‹æˆã•ã‚Œã¾ã™ã‹ï¼Ÿã¾ãŸã€ãƒŠã‚¤ã‚­ã‚¹ãƒˆå®šç†ã«åŸºã¥ã„ã¦ã€ã“ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£ç¢ºã«è¡¨ç¾ã§ãã‚‹æœ€é«˜å‘¨æ³¢æ•°ã¯ã„ãã‚‰ã§ã™ã‹ï¼Ÿ</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>è§£ç­”</strong>ï¼š</p>

<p><strong>ã‚µãƒ³ãƒ—ãƒ«æ•°ã®è¨ˆç®—</strong>ï¼š</p>
<p>$$
\text{ã‚µãƒ³ãƒ—ãƒ«æ•°} = \text{ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ} \times \text{æ™‚é–“é•·}
$$</p>
<p>$$
= 44100 \text{ Hz} \times 3 \text{ ç§’} = 132300 \text{ ã‚µãƒ³ãƒ—ãƒ«}
$$</p>

<p><strong>æœ€é«˜å‘¨æ³¢æ•°ã®è¨ˆç®—ï¼ˆãƒŠã‚¤ã‚­ã‚¹ãƒˆå®šç†ï¼‰</strong>ï¼š</p>
<p>$$
f_{\max} = \frac{f_s}{2} = \frac{44100}{2} = 22050 \text{ Hz}
$$</p>

<p><strong>ç­”ãˆ</strong>ï¼š</p>
<ul>
<li>ã‚µãƒ³ãƒ—ãƒ«æ•°: 132,300ã‚µãƒ³ãƒ—ãƒ«</li>
<li>æœ€é«˜å‘¨æ³¢æ•°: 22,050 Hz (22.05 kHz)</li>
</ul>

<p><strong>è£œè¶³</strong>ï¼šäººé–“ã®å¯è´åŸŸã¯ç´„20-20,000 Hzãªã®ã§ã€44,100 Hzã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆã¯éŸ³æ¥½CDã«ååˆ†ãªå“è³ªã§ã™ã€‚</p>

</details>

<h3>å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>
<p>ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Œæˆã•ã›ã¦ã€éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰MFCCã‚’æŠ½å‡ºã—ã€ãã®çµ±è¨ˆé‡ï¼ˆå¹³å‡ã¨æ¨™æº–åå·®ï¼‰ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>

<pre><code class="language-python">import librosa
import numpy as np

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav')

# MFCCã®æŠ½å‡ºï¼ˆ13ä¿‚æ•°ï¼‰
# TODO: ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 

# å„MFCCä¿‚æ•°ã®å¹³å‡ã¨æ¨™æº–åå·®ã‚’è¨ˆç®—
# TODO: ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 

# çµæœã®è¡¨ç¤º
# TODO: ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ 
</code></pre>

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">import librosa
import numpy as np

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav')

# MFCCã®æŠ½å‡ºï¼ˆ13ä¿‚æ•°ï¼‰
n_mfcc = 13
mfccs = librosa.feature.mfcc(y=y, sr=sr, n_mfcc=n_mfcc)

print(f"=== MFCCçµ±è¨ˆé‡ ===")
print(f"MFCCã®å½¢çŠ¶: {mfccs.shape}")
print(f"  ä¿‚æ•°æ•°: {n_mfcc}")
print(f"  æ™‚é–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°: {mfccs.shape[1]}")

# å„MFCCä¿‚æ•°ã®å¹³å‡ã¨æ¨™æº–åå·®ã‚’è¨ˆç®—
mfcc_mean = np.mean(mfccs, axis=1)
mfcc_std = np.std(mfccs, axis=1)

# çµæœã®è¡¨ç¤º
print("\nå„MFCCä¿‚æ•°ã®çµ±è¨ˆé‡:")
print(f"{'ä¿‚æ•°':<10} {'å¹³å‡':<15} {'æ¨™æº–åå·®':<15}")
print("-" * 40)
for i in range(n_mfcc):
    print(f"MFCC-{i:<4} {mfcc_mean[i]:<15.4f} {mfcc_std[i]:<15.4f}")

# ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã¨ã—ã¦çµåˆï¼ˆæ©Ÿæ¢°å­¦ç¿’ã§ä½¿ç”¨ï¼‰
feature_vector = np.concatenate([mfcc_mean, mfcc_std])
print(f"\nç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒ: {len(feature_vector)}")
print(f"  (13å¹³å‡ + 13æ¨™æº–åå·® = 26æ¬¡å…ƒ)")

# å¯è¦–åŒ–
import matplotlib.pyplot as plt

fig, axes = plt.subplots(2, 1, figsize=(12, 8))

# MFCCãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
img = librosa.display.specshow(mfccs, sr=sr, x_axis='time', ax=axes[0], cmap='coolwarm')
axes[0].set_title('MFCC', fontsize=14)
axes[0].set_ylabel('MFCCä¿‚æ•°')
fig.colorbar(img, ax=axes[0])

# çµ±è¨ˆé‡ã®ãƒãƒ¼ãƒ—ãƒ­ãƒƒãƒˆ
x = np.arange(n_mfcc)
width = 0.35
axes[1].bar(x - width/2, mfcc_mean, width, label='å¹³å‡', alpha=0.8)
axes[1].bar(x + width/2, mfcc_std, width, label='æ¨™æº–åå·®', alpha=0.8)
axes[1].set_xlabel('MFCCä¿‚æ•°')
axes[1].set_ylabel('å€¤')
axes[1].set_title('MFCCçµ±è¨ˆé‡', fontsize=14)
axes[1].legend()
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('mfcc_statistics.png', dpi=150)
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: mfcc_statistics.png")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>ï¼š</p>
<pre><code>=== MFCCçµ±è¨ˆé‡ ===
MFCCã®å½¢çŠ¶: (13, 130)
  ä¿‚æ•°æ•°: 13
  æ™‚é–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°: 130

å„MFCCä¿‚æ•°ã®çµ±è¨ˆé‡:
ä¿‚æ•°        å¹³å‡             æ¨™æº–åå·®
----------------------------------------
MFCC-0    -123.4567       45.2341
MFCC-1     32.1234        12.5678
MFCC-2     -8.9012        7.3456
MFCC-3     5.6789         6.1234
...

ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒ: 26
  (13å¹³å‡ + 13æ¨™æº–åå·® = 26æ¬¡å…ƒ)
</code></pre>

</details>

<h3>å•é¡Œ3ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>
<p>ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã¨ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®é•ã„ã‚’èª¬æ˜ã—ã€ãªãœãƒ¡ãƒ«ã‚¹ã‚±ãƒ¼ãƒ«ãŒéŸ³å£°å‡¦ç†ã§æœ‰ç”¨ãªã®ã‹è¿°ã¹ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>è§£ç­”</strong>ï¼š</p>

<p><strong>ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ  vs ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ </strong>ï¼š</p>

<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ </th>
<th>ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ </th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å‘¨æ³¢æ•°ã‚¹ã‚±ãƒ¼ãƒ«</strong></td>
<td>ç·šå½¢ï¼ˆHzï¼‰</td>
<td>ãƒ¡ãƒ«ã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆå¯¾æ•°çš„ï¼‰</td>
</tr>
<tr>
<td><strong>å‘¨æ³¢æ•°åˆ†è§£èƒ½</strong></td>
<td>å…¨å‘¨æ³¢æ•°ã§å‡ä¸€</td>
<td>ä½å‘¨æ³¢æ•°ã§é«˜ãã€é«˜å‘¨æ³¢æ•°ã§ä½ã„</td>
</tr>
<tr>
<td><strong>æ¬¡å…ƒæ•°</strong></td>
<td>é«˜ã„ï¼ˆn_fft/2 + 1ï¼‰</td>
<td>ä½ã„ï¼ˆé€šå¸¸40-128ï¼‰</td>
</tr>
<tr>
<td><strong>è¨ˆç®—æ–¹æ³•</strong></td>
<td>STFT</td>
<td>STFT + ãƒ¡ãƒ«ãƒ•ã‚£ãƒ«ã‚¿ãƒãƒ³ã‚¯</td>
</tr>
</tbody>
</table>

<p><strong>ãƒ¡ãƒ«ã‚¹ã‚±ãƒ¼ãƒ«ã®æœ‰ç”¨æ€§</strong>ï¼š</p>

<ol>
<li><p><strong>äººé–“ã®è´è¦šç‰¹æ€§ã«é©åˆ</strong></p>
<ul>
<li>äººé–“ã®è€³ã¯ä½å‘¨æ³¢æ•°ã®å¤‰åŒ–ã«æ•æ„Ÿã€é«˜å‘¨æ³¢æ•°ã§ã¯éˆæ„Ÿ</li>
<li>ãƒ¡ãƒ«ã‚¹ã‚±ãƒ¼ãƒ«ã¯ã“ã®ç‰¹æ€§ã‚’æ•°å­¦çš„ã«ãƒ¢ãƒ‡ãƒ«åŒ–</li>
</ul></li>

<li><p><strong>æ¬¡å…ƒå‰Šæ¸›</strong></p>
<ul>
<li>ç·šå½¢ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼š1025æ¬¡å…ƒï¼ˆn_fft=2048ã®å ´åˆï¼‰</li>
<li>ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼š40-128æ¬¡å…ƒ</li>
<li>è¨ˆç®—åŠ¹ç‡ã¨å­¦ç¿’åŠ¹ç‡ã®å‘ä¸Š</li>
</ul></li>

<li><p><strong>éŸ³å£°èªè­˜ã¸ã®é©æ€§</strong></p>
<ul>
<li>éŸ³å£°ã®é‡è¦ãªæƒ…å ±ï¼ˆä½ã€œä¸­å‘¨æ³¢æ•°ï¼‰ã«ç„¦ç‚¹</li>
<li>é«˜å‘¨æ³¢æ•°ã®ãƒã‚¤ã‚ºã®å½±éŸ¿ã‚’è»½æ¸›</li>
</ul></li>

<li><p><strong>å¤‰æ›å¼</strong></p>
<p>$$
m = 2595 \log_{10}\left(1 + \frac{f}{700}\right)
$$</p>
<ul>
<li>ä½å‘¨æ³¢æ•°ï¼ˆä¾‹ï¼š100Hzâ†’150Hzï¼‰ï¼šå¤§ããªãƒ¡ãƒ«å¤‰åŒ–</li>
<li>é«˜å‘¨æ³¢æ•°ï¼ˆä¾‹ï¼š5000Hzâ†’5100Hzï¼‰ï¼šå°ã•ãªãƒ¡ãƒ«å¤‰åŒ–</li>
</ul></li>
</ol>

<p><strong>å®Ÿç”¨ä¾‹</strong>ï¼š</p>
<ul>
<li>éŸ³å£°èªè­˜ï¼šãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ  â†’ MFCC</li>
<li>éŸ³æ¥½æƒ…å ±æ¤œç´¢ï¼šãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ç›´æ¥ä½¿ç”¨</li>
<li>éŸ³å£°åˆæˆï¼šãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã‹ã‚‰éŸ³å£°ç”Ÿæˆï¼ˆWaveNetã€Tacotronï¼‰</li>
</ul>

</details>

<h3>å•é¡Œ4ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>
<p>éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µã‚’é©ç”¨ã—ã€å…ƒã®éŸ³å£°ã¨æ‹¡å¼µå¾Œã®éŸ³å£°ã®MFCCã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ï¼š</p>
<ol>
<li>ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆï¼ˆ+3åŠéŸ³ï¼‰</li>
<li>ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒï¼ˆ1.2å€é€Ÿï¼‰</li>
<li>ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºè¿½åŠ ï¼ˆSNR=20dBï¼‰</li>
</ol>

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt

# éŸ³å£°ã®èª­ã¿è¾¼ã¿
y, sr = librosa.load('sample.wav', duration=3.0)

print("=== ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µã¨MFCCæ¯”è¼ƒ ===")

# ã‚ªãƒªã‚¸ãƒŠãƒ«ã®MFCC
mfcc_original = librosa.feature.mfcc(y=y, sr=sr, n_mfcc=13)

# 1. ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆï¼ˆ+3åŠéŸ³ï¼‰
y_pitch = librosa.effects.pitch_shift(y, sr=sr, n_steps=3)
mfcc_pitch = librosa.feature.mfcc(y=y_pitch, sr=sr, n_mfcc=13)
print("1. ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ: +3åŠéŸ³")

# 2. ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒï¼ˆ1.2å€é€Ÿï¼‰
y_stretch = librosa.effects.time_stretch(y, rate=1.2)
mfcc_stretch = librosa.feature.mfcc(y=y_stretch, sr=sr, n_mfcc=13)
print("2. ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ: 1.2å€é€Ÿ")

# 3. ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºè¿½åŠ ï¼ˆSNR=20dBï¼‰
def add_noise(signal, snr_db):
    """æŒ‡å®šã—ãŸSNRã§ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºã‚’è¿½åŠ """
    signal_power = np.mean(signal ** 2)
    snr_linear = 10 ** (snr_db / 10)
    noise_power = signal_power / snr_linear
    noise = np.sqrt(noise_power) * np.random.randn(len(signal))
    return signal + noise

y_noise = add_noise(y, snr_db=20)
mfcc_noise = librosa.feature.mfcc(y=y_noise, sr=sr, n_mfcc=13)
print("3. ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºè¿½åŠ : SNR=20dB")

# MFCCçµ±è¨ˆã®æ¯”è¼ƒ
def mfcc_statistics(mfcc):
    return {
        'mean': np.mean(mfcc, axis=1),
        'std': np.std(mfcc, axis=1)
    }

stats_original = mfcc_statistics(mfcc_original)
stats_pitch = mfcc_statistics(mfcc_pitch)
stats_stretch = mfcc_statistics(mfcc_stretch)
stats_noise = mfcc_statistics(mfcc_noise)

print("\nMFCCçµ±è¨ˆã®æ¯”è¼ƒï¼ˆæœ€åˆã®5ä¿‚æ•°ï¼‰:")
print(f"{'ä¿‚æ•°':<10} {'å…ƒã®å¹³å‡':<15} {'ãƒ”ãƒƒãƒå¹³å‡':<15} {'ã‚¹ãƒˆãƒ¬ãƒƒãƒå¹³å‡':<15} {'ãƒã‚¤ã‚ºå¹³å‡':<15}")
print("-" * 70)
for i in range(5):
    print(f"MFCC-{i:<4} {stats_original['mean'][i]:<15.3f} {stats_pitch['mean'][i]:<15.3f} "
          f"{stats_stretch['mean'][i]:<15.3f} {stats_noise['mean'][i]:<15.3f}")

# ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ã®è¨ˆç®—
def euclidean_distance(mfcc1, mfcc2):
    """2ã¤ã®MFCCé–“ã®ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢"""
    # æ™‚é–“æ–¹å‘ã§å¹³å‡ã‚’å–ã‚‹
    mean1 = np.mean(mfcc1, axis=1)
    mean2 = np.mean(mfcc2, axis=1)
    return np.linalg.norm(mean1 - mean2)

dist_pitch = euclidean_distance(mfcc_original, mfcc_pitch)
dist_stretch = euclidean_distance(mfcc_original, mfcc_stretch)
dist_noise = euclidean_distance(mfcc_original, mfcc_noise)

print("\nå…ƒã®MFCCã¨ã®è·é›¢:")
print(f"  ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ: {dist_pitch:.3f}")
print(f"  ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ: {dist_stretch:.3f}")
print(f"  ãƒã‚¤ã‚ºè¿½åŠ : {dist_noise:.3f}")

# å¯è¦–åŒ–
fig, axes = plt.subplots(4, 2, figsize=(16, 14))

augmentations = [
    ('ã‚ªãƒªã‚¸ãƒŠãƒ«', y, mfcc_original),
    ('ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ (+3åŠéŸ³)', y_pitch, mfcc_pitch),
    ('ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ (1.2x)', y_stretch, mfcc_stretch),
    ('ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚º (SNR=20dB)', y_noise, mfcc_noise)
]

for idx, (title, audio, mfcc) in enumerate(augmentations):
    # æ³¢å½¢
    librosa.display.waveshow(audio, sr=sr, ax=axes[idx, 0])
    axes[idx, 0].set_title(f'{title} - æ³¢å½¢', fontsize=12)
    axes[idx, 0].set_ylabel('æŒ¯å¹…')

    # MFCC
    img = librosa.display.specshow(mfcc, sr=sr, x_axis='time', ax=axes[idx, 1], cmap='coolwarm')
    axes[idx, 1].set_title(f'{title} - MFCC', fontsize=12)
    axes[idx, 1].set_ylabel('MFCCä¿‚æ•°')
    fig.colorbar(img, ax=axes[idx, 1])

axes[3, 0].set_xlabel('æ™‚é–“ (ç§’)')
axes[3, 1].set_xlabel('æ™‚é–“ (ç§’)')

plt.tight_layout()
plt.savefig('augmentation_mfcc_comparison.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: augmentation_mfcc_comparison.png")

# è€ƒå¯Ÿ
print("\n=== è€ƒå¯Ÿ ===")
print("1. ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ:")
print("   - MFCCã®å€¤ãŒå¤‰åŒ–ï¼ˆç‰¹ã«ä½æ¬¡ä¿‚æ•°ï¼‰")
print("   - è©±è€…ã‚„éŸ³é«˜æƒ…å ±ãŒå¤‰åŒ–")
print("\n2. ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ:")
print("   - ãƒ•ãƒ¬ãƒ¼ãƒ æ•°ãŒå¤‰åŒ–")
print("   - MFCCçµ±è¨ˆã¯æ¯”è¼ƒçš„é¡ä¼¼")
print("\n3. ãƒã‚¤ã‚ºè¿½åŠ :")
print("   - é«˜æ¬¡MFCCä¿‚æ•°ãŒå½±éŸ¿ã‚’å—ã‘ã‚‹")
print("   - ä½æ¬¡ä¿‚æ•°ã¯æ¯”è¼ƒçš„ãƒ­ãƒã‚¹ãƒˆ")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>ï¼š</p>
<pre><code>=== ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µã¨MFCCæ¯”è¼ƒ ===
1. ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ: +3åŠéŸ³
2. ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ: 1.2å€é€Ÿ
3. ãƒ›ãƒ¯ã‚¤ãƒˆãƒã‚¤ã‚ºè¿½åŠ : SNR=20dB

MFCCçµ±è¨ˆã®æ¯”è¼ƒï¼ˆæœ€åˆã®5ä¿‚æ•°ï¼‰:
ä¿‚æ•°        å…ƒã®å¹³å‡         ãƒ”ãƒƒãƒå¹³å‡       ã‚¹ãƒˆãƒ¬ãƒƒãƒå¹³å‡   ãƒã‚¤ã‚ºå¹³å‡
----------------------------------------------------------------------
MFCC-0    -123.456        -125.234        -123.789        -122.891
MFCC-1     32.123          35.678          32.456          31.234
MFCC-2     -8.901          -10.234         -8.756          -9.123
MFCC-3     5.678           6.234           5.789           5.456
MFCC-4     -3.456          -4.123          -3.567          -3.891

å…ƒã®MFCCã¨ã®è·é›¢:
  ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ: 12.345
  ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ: 2.567
  ãƒã‚¤ã‚ºè¿½åŠ : 4.891

=== è€ƒå¯Ÿ ===
1. ãƒ”ãƒƒãƒã‚·ãƒ•ãƒˆ:
   - MFCCã®å€¤ãŒå¤‰åŒ–ï¼ˆç‰¹ã«ä½æ¬¡ä¿‚æ•°ï¼‰
   - è©±è€…ã‚„éŸ³é«˜æƒ…å ±ãŒå¤‰åŒ–

2. ã‚¿ã‚¤ãƒ ã‚¹ãƒˆãƒ¬ãƒƒãƒ:
   - ãƒ•ãƒ¬ãƒ¼ãƒ æ•°ãŒå¤‰åŒ–
   - MFCCçµ±è¨ˆã¯æ¯”è¼ƒçš„é¡ä¼¼

3. ãƒã‚¤ã‚ºè¿½åŠ :
   - é«˜æ¬¡MFCCä¿‚æ•°ãŒå½±éŸ¿ã‚’å—ã‘ã‚‹
   - ä½æ¬¡ä¿‚æ•°ã¯æ¯”è¼ƒçš„ãƒ­ãƒã‚¹ãƒˆ
</code></pre>

</details>

<h3>å•é¡Œ5ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>
<p>éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã¯ã€ä»¥ä¸‹ã‚’å«ã‚ã¦ãã ã•ã„ï¼š</p>
<ol>
<li>ç„¡éŸ³éƒ¨åˆ†ã®ãƒˆãƒªãƒŸãƒ³ã‚°</li>
<li>RMSæ­£è¦åŒ–ï¼ˆç›®æ¨™RMS=0.1ï¼‰</li>
<li>å›ºå®šé•·ã¸ã®èª¿æ•´ï¼ˆ5ç§’ï¼‰</li>
<li>ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®æŠ½å‡º</li>
<li>æ­£è¦åŒ–ï¼ˆå¹³å‡0ã€æ¨™æº–åå·®1ï¼‰</li>
</ol>

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">import librosa
import numpy as np
import matplotlib.pyplot as plt

class AudioPreprocessor:
    """éŸ³å£°å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³"""

    def __init__(self, sr=22050, target_length=5.0, target_rms=0.1,
                 n_mels=128, n_fft=2048, hop_length=512):
        """
        Parameters:
        -----------
        sr : int
            ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãƒ¬ãƒ¼ãƒˆ
        target_length : float
            ç›®æ¨™ã®æ™‚é–“é•·ï¼ˆç§’ï¼‰
        target_rms : float
            ç›®æ¨™ã®RMSãƒ¬ãƒ™ãƒ«
        n_mels : int
            ãƒ¡ãƒ«ãƒãƒ³ãƒ‰æ•°
        n_fft : int
            FFTã‚µã‚¤ã‚º
        hop_length : int
            ãƒ›ãƒƒãƒ—é•·
        """
        self.sr = sr
        self.target_length = target_length
        self.target_samples = int(sr * target_length)
        self.target_rms = target_rms
        self.n_mels = n_mels
        self.n_fft = n_fft
        self.hop_length = hop_length

    def trim_silence(self, y, top_db=20):
        """1. ç„¡éŸ³éƒ¨åˆ†ã®ãƒˆãƒªãƒŸãƒ³ã‚°"""
        y_trimmed, _ = librosa.effects.trim(y, top_db=top_db)
        return y_trimmed

    def rms_normalize(self, y):
        """2. RMSæ­£è¦åŒ–"""
        current_rms = np.sqrt(np.mean(y**2))
        if current_rms > 0:
            y_normalized = y * (self.target_rms / current_rms)
        else:
            y_normalized = y
        return y_normalized

    def fix_length(self, y):
        """3. å›ºå®šé•·ã¸ã®èª¿æ•´"""
        if len(y) < self.target_samples:
            # ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°
            pad_length = self.target_samples - len(y)
            y_fixed = np.pad(y, (0, pad_length), mode='constant')
        else:
            # ãƒˆãƒªãƒŸãƒ³ã‚°
            y_fixed = y[:self.target_samples]
        return y_fixed

    def extract_mel_spectrogram(self, y):
        """4. ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ã®æŠ½å‡º"""
        mel_spec = librosa.feature.melspectrogram(
            y=y, sr=self.sr, n_mels=self.n_mels,
            n_fft=self.n_fft, hop_length=self.hop_length
        )
        # å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«
        mel_spec_db = librosa.power_to_db(mel_spec, ref=np.max)
        return mel_spec_db

    def standardize(self, mel_spec):
        """5. æ­£è¦åŒ–ï¼ˆå¹³å‡0ã€æ¨™æº–åå·®1ï¼‰"""
        mean = np.mean(mel_spec)
        std = np.std(mel_spec)
        if std > 0:
            mel_spec_normalized = (mel_spec - mean) / std
        else:
            mel_spec_normalized = mel_spec - mean
        return mel_spec_normalized

    def process(self, audio_path, verbose=True):
        """å®Œå…¨ãªå‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³"""
        if verbose:
            print(f"=== éŸ³å£°å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ ===")
            print(f"å…¥åŠ›: {audio_path}")

        # éŸ³å£°ã®èª­ã¿è¾¼ã¿
        y, sr = librosa.load(audio_path, sr=self.sr)
        if verbose:
            print(f"0. èª­ã¿è¾¼ã¿: {len(y)} ã‚µãƒ³ãƒ—ãƒ« ({len(y)/sr:.2f}ç§’)")

        # 1. ç„¡éŸ³ãƒˆãƒªãƒŸãƒ³ã‚°
        y = self.trim_silence(y)
        if verbose:
            print(f"1. ãƒˆãƒªãƒŸãƒ³ã‚°å¾Œ: {len(y)} ã‚µãƒ³ãƒ—ãƒ« ({len(y)/sr:.2f}ç§’)")

        # 2. RMSæ­£è¦åŒ–
        y = self.rms_normalize(y)
        current_rms = np.sqrt(np.mean(y**2))
        if verbose:
            print(f"2. RMSæ­£è¦åŒ–: {current_rms:.4f} (ç›®æ¨™: {self.target_rms})")

        # 3. å›ºå®šé•·èª¿æ•´
        y = self.fix_length(y)
        if verbose:
            print(f"3. å›ºå®šé•·èª¿æ•´: {len(y)} ã‚µãƒ³ãƒ—ãƒ« ({len(y)/sr:.2f}ç§’)")

        # 4. ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ æŠ½å‡º
        mel_spec = self.extract_mel_spectrogram(y)
        if verbose:
            print(f"4. ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ : {mel_spec.shape}")

        # 5. æ¨™æº–åŒ–
        mel_spec_normalized = self.standardize(mel_spec)
        if verbose:
            mean = np.mean(mel_spec_normalized)
            std = np.std(mel_spec_normalized)
            print(f"5. æ¨™æº–åŒ–: å¹³å‡={mean:.6f}, æ¨™æº–åå·®={std:.6f}")

        return {
            'audio': y,
            'mel_spectrogram_raw': mel_spec,
            'mel_spectrogram': mel_spec_normalized,
            'shape': mel_spec_normalized.shape
        }

# ä½¿ç”¨ä¾‹
preprocessor = AudioPreprocessor(
    sr=22050,
    target_length=5.0,
    target_rms=0.1,
    n_mels=128
)

# å‰å‡¦ç†ã®å®Ÿè¡Œ
result = preprocessor.process('sample.wav')

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 1, figsize=(14, 12))

# 1. æ³¢å½¢
librosa.display.waveshow(result['audio'], sr=preprocessor.sr, ax=axes[0])
axes[0].set_title('å‰å‡¦ç†å¾Œã®æ³¢å½¢', fontsize=14)
axes[0].set_ylabel('æŒ¯å¹…')

# 2. ç”Ÿã®ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
img1 = librosa.display.specshow(result['mel_spectrogram_raw'],
                                  sr=preprocessor.sr,
                                  hop_length=preprocessor.hop_length,
                                  x_axis='time', y_axis='mel',
                                  ax=axes[1], cmap='viridis')
axes[1].set_title('ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ï¼ˆdBã‚¹ã‚±ãƒ¼ãƒ«ï¼‰', fontsize=14)
axes[1].set_ylabel('å‘¨æ³¢æ•° (ãƒ¡ãƒ«)')
fig.colorbar(img1, ax=axes[1], format='%+2.0f dB')

# 3. æ­£è¦åŒ–å¾Œã®ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ 
img2 = librosa.display.specshow(result['mel_spectrogram'],
                                  sr=preprocessor.sr,
                                  hop_length=preprocessor.hop_length,
                                  x_axis='time', y_axis='mel',
                                  ax=axes[2], cmap='viridis')
axes[2].set_title('æ­£è¦åŒ–å¾Œã®ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ ', fontsize=14)
axes[2].set_ylabel('å‘¨æ³¢æ•° (ãƒ¡ãƒ«)')
axes[2].set_xlabel('æ™‚é–“ (ç§’)')
fig.colorbar(img2, ax=axes[2])

plt.tight_layout()
plt.savefig('preprocessing_pipeline.png', dpi=150, bbox_inches='tight')
print("\nå›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: preprocessing_pipeline.png")

# ãƒãƒƒãƒå‡¦ç†
print("\n=== ãƒãƒƒãƒå‡¦ç† ===")
audio_files = ['sample1.wav', 'sample2.wav', 'sample3.wav']
batch_results = []

for audio_file in audio_files:
    try:
        result = preprocessor.process(audio_file, verbose=False)
        batch_results.append(result['mel_spectrogram'])
        print(f"âœ“ {audio_file}: {result['shape']}")
    except Exception as e:
        print(f"âœ— {audio_file}: ã‚¨ãƒ©ãƒ¼ ({e})")

# NumPyé…åˆ—ã«å¤‰æ›ï¼ˆãƒ¢ãƒ‡ãƒ«ã®å…¥åŠ›ã¨ã—ã¦ä½¿ç”¨ï¼‰
if batch_results:
    X = np.array(batch_results)
    print(f"\nãƒãƒƒãƒã®å½¢çŠ¶: {X.shape}")
    print(f"  (ãƒãƒƒãƒã‚µã‚¤ã‚º, ãƒ¡ãƒ«ãƒãƒ³ãƒ‰æ•°, æ™‚é–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°)")
    print(f"\nã“ã®ãƒ‡ãƒ¼ã‚¿ã¯æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®å…¥åŠ›ã¨ã—ã¦ä½¿ç”¨å¯èƒ½ã§ã™ã€‚")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>ï¼š</p>
<pre><code>=== éŸ³å£°å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ ===
å…¥åŠ›: sample.wav
0. èª­ã¿è¾¼ã¿: 66150 ã‚µãƒ³ãƒ—ãƒ« (3.00ç§’)
1. ãƒˆãƒªãƒŸãƒ³ã‚°å¾Œ: 55125 ã‚µãƒ³ãƒ—ãƒ« (2.50ç§’)
2. RMSæ­£è¦åŒ–: 0.1000 (ç›®æ¨™: 0.1)
3. å›ºå®šé•·èª¿æ•´: 110250 ã‚µãƒ³ãƒ—ãƒ« (5.00ç§’)
4. ãƒ¡ãƒ«ã‚¹ãƒšã‚¯ãƒˆãƒ­ã‚°ãƒ©ãƒ : (128, 216)
5. æ¨™æº–åŒ–: å¹³å‡=0.000000, æ¨™æº–åå·®=1.000000

å›³ã‚’ä¿å­˜ã—ã¾ã—ãŸ: preprocessing_pipeline.png

=== ãƒãƒƒãƒå‡¦ç† ===
âœ“ sample1.wav: (128, 216)
âœ“ sample2.wav: (128, 216)
âœ“ sample3.wav: (128, 216)

ãƒãƒƒãƒã®å½¢çŠ¶: (3, 128, 216)
  (ãƒãƒƒãƒã‚µã‚¤ã‚º, ãƒ¡ãƒ«ãƒãƒ³ãƒ‰æ•°, æ™‚é–“ãƒ•ãƒ¬ãƒ¼ãƒ æ•°)

ã“ã®ãƒ‡ãƒ¼ã‚¿ã¯æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®å…¥åŠ›ã¨ã—ã¦ä½¿ç”¨å¯èƒ½ã§ã™ã€‚
</code></pre>

</details>

<hr>

<h2>å‚è€ƒæ–‡çŒ®</h2>

<ol>
<li>Rabiner, L., & Schafer, R. (2010). <em>Theory and Applications of Digital Speech Processing</em>. Pearson.</li>
<li>MÃ¼ller, M. (2015). <em>Fundamentals of Music Processing</em>. Springer.</li>
<li>McFee, B., et al. (2015). "librosa: Audio and Music Signal Analysis in Python." <em>Proceedings of the 14th Python in Science Conference</em>.</li>
<li>Davis, S., & Mermelstein, P. (1980). "Comparison of Parametric Representations for Monosyllabic Word Recognition in Continuously Spoken Sentences." <em>IEEE Transactions on ASSP</em>.</li>
<li>Logan, B. (2000). "Mel Frequency Cepstral Coefficients for Music Modeling." <em>ISMIR</em>.</li>
<li>Oppenheim, A. V., & Schafer, R. W. (2009). <em>Discrete-Time Signal Processing</em> (3rd ed.). Pearson.</li>
</ol>

<div class="navigation">
    <a href="index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a>
    <a href="chapter2-speech-recognition.html" class="nav-button">æ¬¡ã®ç« : éŸ³å£°èªè­˜ã®åŸºç¤ â†’</a>
</div>

    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-21</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
