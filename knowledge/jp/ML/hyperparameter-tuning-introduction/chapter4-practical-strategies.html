<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« ï¼šå®Ÿè·µçš„ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æˆ¦ç•¥ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;
            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;
            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;
            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: var(--font-body); line-height: 1.7; color: var(--color-text); background-color: var(--color-bg); font-size: 16px; }
        header { background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%); color: white; padding: var(--spacing-xl) var(--spacing-md); margin-bottom: var(--spacing-xl); box-shadow: var(--box-shadow); }
        .header-content { max-width: 900px; margin: 0 auto; }
        h1 { font-size: 2rem; font-weight: 700; margin-bottom: var(--spacing-sm); line-height: 1.2; }
        .subtitle { font-size: 1.1rem; opacity: 0.95; font-weight: 400; margin-bottom: var(--spacing-md); }
        .meta { display: flex; flex-wrap: wrap; gap: var(--spacing-md); font-size: 0.9rem; opacity: 0.9; }
        .meta-item { display: flex; align-items: center; gap: 0.3rem; }
        .container { max-width: 900px; margin: 0 auto; padding: 0 var(--spacing-md) var(--spacing-xl); }
        h2 { font-size: 1.75rem; color: var(--color-primary); margin-top: var(--spacing-xl); margin-bottom: var(--spacing-md); padding-bottom: var(--spacing-xs); border-bottom: 3px solid var(--color-accent); }
        h3 { font-size: 1.4rem; color: var(--color-primary); margin-top: var(--spacing-lg); margin-bottom: var(--spacing-sm); }
        h4 { font-size: 1.1rem; color: var(--color-primary-dark); margin-top: var(--spacing-md); margin-bottom: var(--spacing-sm); }
        p { margin-bottom: var(--spacing-md); color: var(--color-text); }
        a { color: var(--color-link); text-decoration: none; transition: color 0.2s; }
        a:hover { color: var(--color-link-hover); text-decoration: underline; }
        ul, ol { margin-left: var(--spacing-lg); margin-bottom: var(--spacing-md); }
        li { margin-bottom: var(--spacing-xs); color: var(--color-text); }
        pre { background-color: var(--color-code-bg); border: 1px solid var(--color-border); border-radius: var(--border-radius); padding: var(--spacing-md); overflow-x: auto; margin-bottom: var(--spacing-md); font-family: var(--font-mono); font-size: 0.9rem; line-height: 1.5; }
        code { font-family: var(--font-mono); font-size: 0.9em; background-color: var(--color-code-bg); padding: 0.2em 0.4em; border-radius: 3px; }
        pre code { background-color: transparent; padding: 0; }
        table { width: 100%; border-collapse: collapse; margin-bottom: var(--spacing-md); font-size: 0.95rem; }
        th, td { border: 1px solid var(--color-border); padding: var(--spacing-sm); text-align: left; }
        th { background-color: var(--color-bg-alt); font-weight: 600; color: var(--color-primary); }
        blockquote { border-left: 4px solid var(--color-accent); padding-left: var(--spacing-md); margin: var(--spacing-md) 0; color: var(--color-text-light); font-style: italic; background-color: var(--color-bg-alt); padding: var(--spacing-md); border-radius: var(--border-radius); }
        .mermaid { text-align: center; margin: var(--spacing-lg) 0; background-color: var(--color-bg-alt); padding: var(--spacing-md); border-radius: var(--border-radius); }
        details { background-color: var(--color-bg-alt); border: 1px solid var(--color-border); border-radius: var(--border-radius); padding: var(--spacing-md); margin-bottom: var(--spacing-md); }
        summary { cursor: pointer; font-weight: 600; color: var(--color-primary); user-select: none; padding: var(--spacing-xs); margin: calc(-1 * var(--spacing-md)); padding: var(--spacing-md); border-radius: var(--border-radius); }
        summary:hover { background-color: rgba(123, 44, 191, 0.1); }
        details[open] summary { margin-bottom: var(--spacing-md); border-bottom: 1px solid var(--color-border); }
        .navigation { display: flex; justify-content: space-between; gap: var(--spacing-md); margin: var(--spacing-xl) 0; padding-top: var(--spacing-lg); border-top: 2px solid var(--color-border); }
        .nav-button { flex: 1; padding: var(--spacing-md); background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%); color: white; border-radius: var(--border-radius); text-align: center; font-weight: 600; transition: transform 0.2s, box-shadow 0.2s; box-shadow: var(--box-shadow); }
        .nav-button:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15); text-decoration: none; }
        footer { margin-top: var(--spacing-xl); padding: var(--spacing-lg) var(--spacing-md); background-color: var(--color-bg-alt); border-top: 1px solid var(--color-border); text-align: center; font-size: 0.9rem; color: var(--color-text-light); }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }

        .project-box { background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 50%); border-radius: var(--border-radius); padding: var(--spacing-lg); margin: var(--spacing-lg) 0; box-shadow: var(--box-shadow); }
        .tip-box { background: linear-gradient(135deg, #fff3cd 0%, #ffe69c 50%); border-left: 4px solid #ffc107; border-radius: var(--border-radius); padding: var(--spacing-md); margin: var(--spacing-md) 0; }
        .warning-box { background: linear-gradient(135deg, #f8d7da 0%, #f5c2c7 50%); border-left: 4px solid #dc3545; border-radius: var(--border-radius); padding: var(--spacing-md); margin: var(--spacing-md) 0; }
        @media (max-width: 768px) { h1 { font-size: 1.5rem; } h2 { font-size: 1.4rem; } h3 { font-size: 1.2rem; } .meta { font-size: 0.85rem; } .navigation { flex-direction: column; } table { font-size: 0.85rem; } th, td { padding: var(--spacing-xs); } }
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
    <script>
        MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']], processEscapes: true, processEnvironments: true },
            options: { skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'], ignoreHtmlClass: 'mermaid' }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
        <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/wp/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/wp/knowledge/jp/ML/index.html">æ©Ÿæ¢°å­¦ç¿’</a><span class="breadcrumb-separator">â€º</span><a href="/wp/knowledge/jp/ML/hyperparameter-tuning-introduction/index.html">Hyperparameter Tuning</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 4</span>
        </div>
    </nav>

    <header>
        <div class="header-content">
            <h1>ç¬¬4ç« ï¼šå®Ÿè·µçš„ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æˆ¦ç•¥</h1>
            <p class="subtitle">ãƒãƒ«ãƒç›®çš„æœ€é©åŒ–ã‹ã‚‰æœ¬ç•ªé‹ç”¨ã¾ã§ - å®Ÿå‹™ã§ä½¿ãˆã‚‹é«˜åº¦ãªãƒ†ã‚¯ãƒ‹ãƒƒã‚¯</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 25åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸Šç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 6å€‹</span>
                <span class="meta-item">ğŸ¯ å®Ÿè·µé‡è¦–</span>
            </div>
        </div>
    </header>

    <main class="container">

<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… ãƒãƒ«ãƒç›®çš„æœ€é©åŒ–ã«ã‚ˆã‚‹ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãƒãƒ©ãƒ³ã‚¹ã®å–å¾—</li>
<li>âœ… Early Stoppingã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªæ¢ç´¢ç©ºé–“ã®çµã‚Šè¾¼ã¿</li>
<li>âœ… åˆ†æ•£ç’°å¢ƒã§ã®ã‚¹ã‚±ãƒ¼ãƒ©ãƒ–ãƒ«ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</li>
<li>âœ… è»¢ç§»å­¦ç¿’ã¨ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆã«ã‚ˆã‚‹äº‹å‰çŸ¥è­˜ã®æ´»ç”¨</li>
<li>âœ… æœ¬ç•ªç’°å¢ƒã§ã®å®Ÿè·µçš„ãªãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°é‹ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</li>
</ul>

<h2>1. ãƒãƒ«ãƒç›®çš„æœ€é©åŒ–</h2>

<p>å®Ÿéš›ã®MLã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ç²¾åº¦ã ã‘ã§ãªããƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã€ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã€æ¨è«–ã‚³ã‚¹ãƒˆãªã©è¤‡æ•°ã®æŒ‡æ¨™ã‚’ãƒãƒ©ãƒ³ã‚¹ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>

<h3>1.1 ç²¾åº¦ã¨ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•</h3>

<p>å˜ä¸€æŒ‡æ¨™ã®æœ€é©åŒ–ã§ã¯ã€å®Ÿé‹ç”¨ã«é©ã•ãªã„ãƒ¢ãƒ‡ãƒ«ãŒé¸æŠã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ï¼š</p>

<ul>
<li><strong>é«˜ç²¾åº¦ã ãŒé…ã„ãƒ¢ãƒ‡ãƒ«ï¼š</strong>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¨è«–ã«ä¸é©</li>
<li><strong>é«˜é€Ÿã ãŒä½ç²¾åº¦ãªãƒ¢ãƒ‡ãƒ«ï¼š</strong>ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã‚’æº€ãŸã•ãªã„</li>
<li><strong>ãƒãƒ©ãƒ³ã‚¹å‹ãƒ¢ãƒ‡ãƒ«ï¼š</strong>å®Ÿç”¨çš„ãªå¦¥å”ç‚¹</li>
</ul>

<div class="mermaid">
graph LR
    A[ç²¾åº¦é‡è¦–] -->|ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•| B[Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢]
    C[é€Ÿåº¦é‡è¦–] -->|ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•| B
    B --> D[æœ€é©è§£ã®é›†åˆ]
    D --> E[ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã‹ã‚‰é¸æŠ]
</div>

<h3>1.2 Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã®ç†è§£</h3>

<p>Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã¯ã€ã©ã¡ã‚‰ã®æŒ‡æ¨™ã‚‚æ”¹å–„ã§ããªã„è§£ã®é›†åˆã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šè¤‡æ•°ã®å€™è£œãƒ¢ãƒ‡ãƒ«ã‹ã‚‰æœ€é©ãªã‚‚ã®ã‚’é¸æŠã§ãã¾ã™ã€‚</p>

<blockquote>
<strong>Paretoæœ€é©æ€§ï¼š</strong>ã‚ã‚‹è§£ãŒä»–ã®ã™ã¹ã¦ã®æŒ‡æ¨™ã§åŠ£ã‚‹ã“ã¨ãªãã€å°‘ãªãã¨ã‚‚1ã¤ã®æŒ‡æ¨™ã§å„ªã‚Œã¦ã„ã‚‹çŠ¶æ…‹ã€‚
</blockquote>

<h3>1.3 Optunaã®ãƒãƒ«ãƒç›®çš„æœ€é©åŒ–</h3>

<p>Optunaã¯è¤‡æ•°ã®ç›®çš„é–¢æ•°ã‚’åŒæ™‚ã«æœ€é©åŒ–ã™ã‚‹ãƒãƒ«ãƒç›®çš„æœ€é©åŒ–ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚</p>

<pre><code class="language-python">import optuna
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import cross_val_score
from sklearn.datasets import load_breast_cancer
import time
import numpy as np

# ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæº–å‚™
X, y = load_breast_cancer(return_X_y=True)

def objective(trial):
    """ç²¾åº¦ã¨ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’åŒæ™‚ã«æœ€é©åŒ–"""
    # ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ææ¡ˆ
    params = {
        'n_estimators': trial.suggest_int('n_estimators', 10, 200),
        'max_depth': trial.suggest_int('max_depth', 2, 32),
        'min_samples_split': trial.suggest_int('min_samples_split', 2, 20),
        'min_samples_leaf': trial.suggest_int('min_samples_leaf', 1, 10),
        'max_features': trial.suggest_categorical('max_features', ['sqrt', 'log2', None])
    }

    # ãƒ¢ãƒ‡ãƒ«å­¦ç¿’ã¨ç²¾åº¦è©•ä¾¡
    clf = RandomForestClassifier(**params, random_state=42, n_jobs=-1)
    accuracy = cross_val_score(clf, X, y, cv=3, n_jobs=-1).mean()

    # ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·æ¸¬å®šï¼ˆæ¨è«–æ™‚é–“ï¼‰
    clf.fit(X, y)
    start_time = time.time()
    _ = clf.predict(X[:100])  # 100ã‚µãƒ³ãƒ—ãƒ«ã®æ¨è«–æ™‚é–“æ¸¬å®š
    latency = (time.time() - start_time) * 1000  # ãƒŸãƒªç§’

    # 2ã¤ã®ç›®çš„é–¢æ•°ã‚’è¿”ã™ï¼šç²¾åº¦ã‚’æœ€å¤§åŒ–ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã‚’æœ€å°åŒ–
    return accuracy, latency

# ãƒãƒ«ãƒç›®çš„æœ€é©åŒ–study
study = optuna.create_study(
    directions=['maximize', 'minimize'],  # ç²¾åº¦ã¯æœ€å¤§åŒ–ã€ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã¯æœ€å°åŒ–
    study_name='multi_objective_optimization'
)

study.optimize(objective, n_trials=50)

# Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã®è§£ã‚’å–å¾—
print("=== Paretoæœ€é©è§£ ===")
for trial in study.best_trials:
    print(f"Trial {trial.number}:")
    print(f"  Accuracy: {trial.values[0]:.4f}")
    print(f"  Latency: {trial.values[1]:.2f} ms")
    print(f"  Params: {trial.params}\n")
</code></pre>

<div class="tip-box">
<strong>ğŸ’¡ å®Ÿè·µçš„ãªãƒ’ãƒ³ãƒˆï¼š</strong>
<ul>
<li>ç›®çš„é–¢æ•°ã®æ•°ã¯é€šå¸¸2ã€œ3å€‹ã«æŠ‘ãˆã‚‹ï¼ˆ4å€‹ä»¥ä¸Šã¯è§£é‡ˆãŒå›°é›£ï¼‰</li>
<li>å„ç›®çš„é–¢æ•°ã®ã‚¹ã‚±ãƒ¼ãƒ«ã‚’æƒãˆã‚‹ï¼ˆæ­£è¦åŒ–æ¨å¥¨ï¼‰</li>
<li>ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ã«å¿œã˜ã¦Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã‹ã‚‰æœ€çµ‚ãƒ¢ãƒ‡ãƒ«ã‚’é¸æŠ</li>
</ul>
</div>

<h3>1.4 Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã®å¯è¦–åŒ–</h3>

<pre><code class="language-python">import matplotlib.pyplot as plt

def visualize_pareto_frontier(study):
    """Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã®å¯è¦–åŒ–"""
    # ã™ã¹ã¦ã®è©¦è¡Œçµæœã‚’å–å¾—
    trials = study.trials
    accuracies = [t.values[0] for t in trials]
    latencies = [t.values[1] for t in trials]

    # Paretoæœ€é©è§£ã‚’å–å¾—
    pareto_trials = study.best_trials
    pareto_accuracies = [t.values[0] for t in pareto_trials]
    pareto_latencies = [t.values[1] for t in pareto_trials]

    # ãƒ—ãƒ­ãƒƒãƒˆ
    plt.figure(figsize=(10, 6))
    plt.scatter(latencies, accuracies, alpha=0.5, label='All trials')
    plt.scatter(pareto_latencies, pareto_accuracies,
                color='red', s=100, marker='*', label='Pareto frontier')

    # Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã‚’ç·šã§æ¥ç¶š
    sorted_pareto = sorted(zip(pareto_latencies, pareto_accuracies))
    plt.plot([p[0] for p in sorted_pareto], [p[1] for p in sorted_pareto],
             'r--', alpha=0.5)

    plt.xlabel('Latency (ms)')
    plt.ylabel('Accuracy')
    plt.title('Multi-Objective Optimization: Accuracy vs Latency')
    plt.legend()
    plt.grid(True, alpha=0.3)
    plt.tight_layout()
    plt.show()

visualize_pareto_frontier(study)
</code></pre>

<h2>2. Early Stoppingæˆ¦ç•¥</h2>

<p>æœ‰æœ›ã§ãªã„è©¦è¡Œã‚’æ—©æœŸã«æ‰“ã¡åˆ‡ã‚‹ã“ã¨ã§ã€è¨ˆç®—ãƒªã‚½ãƒ¼ã‚¹ã‚’åŠ¹ç‡çš„ã«ä½¿ç”¨ã—ã€ã‚ˆã‚Šå¤šãã®æ¢ç´¢ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚</p>

<h3>2.1 Pruningï¼ˆæåˆˆã‚Šï¼‰ã®é‡è¦æ€§</h3>

<p>ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã§ã¯ã€å¤šãã®è©¦è¡ŒãŒæœ€çµ‚çš„ã«è‰¯ã„çµæœã‚’ç”Ÿã¾ãªã„ãŸã‚ã€æ—©æœŸã«æ‰“ã¡åˆ‡ã‚‹ã“ã¨ãŒåŠ¹ç‡åŒ–ã®éµã§ã™ã€‚</p>

<table>
<thead>
<tr>
<th>æˆ¦ç•¥</th>
<th>ç‰¹å¾´</th>
<th>é©ç”¨å ´é¢</th>
</tr>
</thead>
<tbody>
<tr>
<td>MedianPruner</td>
<td>ä¸­å¤®å€¤ã¨æ¯”è¼ƒã—ã¦åŠ£ã‚‹è©¦è¡Œã‚’æ‰“ã¡åˆ‡ã‚Š</td>
<td>ä¸€èˆ¬çš„ãªç”¨é€”ã€ãƒãƒ©ãƒ³ã‚¹å‹</td>
</tr>
<tr>
<td>PercentilePruner</td>
<td>ä¸Šä½X%ã«å…¥ã‚‰ãªã„è©¦è¡Œã‚’æ‰“ã¡åˆ‡ã‚Š</td>
<td>ç©æ¥µçš„ãªæ¢ç´¢å‰Šæ¸›ãŒå¿…è¦ãªå ´åˆ</td>
</tr>
<tr>
<td>SuccessiveHalvingPruner</td>
<td>æ®µéšçš„ã«ãƒªã‚½ãƒ¼ã‚¹ã‚’é…åˆ†</td>
<td>å­¦ç¿’æ›²ç·šãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆ</td>
</tr>
<tr>
<td>HyperbandPruner</td>
<td>è¤‡æ•°ã®SuccessiveHalvingã‚’ä¸¦åˆ—å®Ÿè¡Œ</td>
<td>å¤§è¦æ¨¡æ¢ç´¢ã€æœ€å…ˆç«¯æ‰‹æ³•</td>
</tr>
</tbody>
</table>

<h3>2.2 MedianPrunerã®å®Ÿè£…</h3>

<pre><code class="language-python">import optuna
from optuna.pruners import MedianPruner
from sklearn.model_selection import cross_validate
from sklearn.ensemble import GradientBoostingClassifier
import numpy as np

def objective_with_pruning(trial):
    """Pruningã‚’ä½¿ã£ãŸç›®çš„é–¢æ•°"""
    params = {
        'n_estimators': trial.suggest_int('n_estimators', 50, 500),
        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.3),
        'max_depth': trial.suggest_int('max_depth', 3, 10),
        'subsample': trial.suggest_float('subsample', 0.5, 1.0),
    }

    clf = GradientBoostingClassifier(**params, random_state=42)

    # æ®µéšçš„ãªè©•ä¾¡ï¼ˆå­¦ç¿’ã®é€”ä¸­çµŒéã‚’å ±å‘Šï¼‰
    for step in range(5):
        # æ®µéšçš„ã«n_estimatorsã‚’å¢—ã‚„ã—ã¦è©•ä¾¡
        intermediate_clf = GradientBoostingClassifier(
            n_estimators=(step + 1) * 20,
            learning_rate=params['learning_rate'],
            max_depth=params['max_depth'],
            subsample=params['subsample'],
            random_state=42
        )

        # ä¸­é–“è©•ä¾¡
        scores = cross_validate(intermediate_clf, X, y, cv=3,
                                scoring='accuracy', n_jobs=-1)
        intermediate_score = scores['test_score'].mean()

        # ä¸­é–“çµæœã‚’å ±å‘Š
        trial.report(intermediate_score, step)

        # Pruningã®åˆ¤æ–­
        if trial.should_prune():
            raise optuna.TrialPruned()

    # æœ€çµ‚è©•ä¾¡
    final_scores = cross_validate(clf, X, y, cv=5, scoring='accuracy', n_jobs=-1)
    return final_scores['test_score'].mean()

# MedianPrunerã‚’ä½¿ç”¨ã—ãŸstudy
pruner = MedianPruner(
    n_startup_trials=5,  # æœ€åˆã®5è©¦è¡Œã¯Pruningã—ãªã„
    n_warmup_steps=2,    # æœ€åˆã®2ã‚¹ãƒ†ãƒƒãƒ—ã¯Pruningã—ãªã„
    interval_steps=1     # å„ã‚¹ãƒ†ãƒƒãƒ—ã§Pruningåˆ¤æ–­
)

study = optuna.create_study(
    direction='maximize',
    pruner=pruner,
    study_name='pruning_optimization'
)

study.optimize(objective_with_pruning, n_trials=50)

print(f"Best accuracy: {study.best_value:.4f}")
print(f"Best params: {study.best_params}")
print(f"Pruned trials: {len([t for t in study.trials if t.state == optuna.trial.TrialState.PRUNED])}")
print(f"Completed trials: {len([t for t in study.trials if t.state == optuna.trial.TrialState.COMPLETE])}")
</code></pre>

<h3>2.3 PercentilePrunerã®å®Ÿè£…</h3>

<pre><code class="language-python">from optuna.pruners import PercentilePruner

# PercentilePrunerï¼šä¸Šä½25%ã«å…¥ã‚‰ãªã„è©¦è¡Œã‚’æ‰“ã¡åˆ‡ã‚Š
pruner = PercentilePruner(
    percentile=25.0,      # ä¸Šä½25%ã®ã¿ç¶™ç¶š
    n_startup_trials=5,   # æœ€åˆã®5è©¦è¡Œã¯å¿…ãšå®Œäº†
    n_warmup_steps=2      # æœ€åˆã®2ã‚¹ãƒ†ãƒƒãƒ—ã¯Pruningã—ãªã„
)

study = optuna.create_study(
    direction='maximize',
    pruner=pruner,
    study_name='percentile_pruning'
)

study.optimize(objective_with_pruning, n_trials=50)

# PruningåŠ¹æœã®åˆ†æ
pruned_count = len([t for t in study.trials if t.state == optuna.trial.TrialState.PRUNED])
completed_count = len([t for t in study.trials if t.state == optuna.trial.TrialState.COMPLETE])
pruning_rate = pruned_count / len(study.trials) * 100

print(f"Pruning rate: {pruning_rate:.1f}%")
print(f"Time saved: ~{pruning_rate * 0.8:.1f}% (estimated)")
</code></pre>

<div class="warning-box">
<strong>âš ï¸ æ³¨æ„ç‚¹ï¼š</strong>
<ul>
<li>PruningãŒç©æ¥µçš„ã™ãã‚‹ã¨æœ‰æœ›ãªè©¦è¡Œã‚‚æ‰“ã¡åˆ‡ã‚‰ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹</li>
<li>n_startup_trialsã¯æ¢ç´¢ç©ºé–“ã®è¤‡é›‘ã•ã«å¿œã˜ã¦èª¿æ•´ã™ã‚‹</li>
<li>å­¦ç¿’æ›²ç·šãŒä¸å®‰å®šãªå ´åˆã¯n_warmup_stepsã‚’å¤§ããã™ã‚‹</li>
</ul>
</div>

<h2>3. åˆ†æ•£ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</h2>

<p>å¤§è¦æ¨¡ãªæ¢ç´¢ç©ºé–“ã‚„è¨ˆç®—é‡ã®å¤šã„ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€åˆ†æ•£ç’°å¢ƒã§ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§å¤§å¹…ãªæ™‚é–“çŸ­ç¸®ãŒå¯èƒ½ã§ã™ã€‚</p>

<h3>3.1 Optunaåˆ†æ•£æœ€é©åŒ–ã®ä»•çµ„ã¿</h3>

<p>Optunaã¯å…±æœ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆRDBã€Redisç­‰ï¼‰ã‚’é€šã˜ã¦è¤‡æ•°ã®ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒå”èª¿ã—ã¦æœ€é©åŒ–ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚</p>

<div class="mermaid">
graph TD
    A[å…±æœ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸<br/>RDB/Redis] --> B[Worker 1]
    A --> C[Worker 2]
    A --> D[Worker 3]
    A --> E[Worker N]
    B --> F[è©¦è¡Œçµæœã‚’ä¿å­˜]
    C --> F
    D --> F
    E --> F
    F --> A
</div>

<h3>3.2 RDBã‚’ä½¿ã£ãŸåˆ†æ•£æœ€é©åŒ–</h3>

<pre><code class="language-python">import optuna
from optuna.storages import RDBStorage

# å…±æœ‰ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®è¨­å®šï¼ˆPostgreSQLä¾‹ï¼‰
storage = RDBStorage(
    url='postgresql://user:password@localhost/optuna_db',
    engine_kwargs={
        'pool_size': 20,
        'max_overflow': 0,
    }
)

# åˆ†æ•£studyä½œæˆï¼ˆè¤‡æ•°ãƒ¯ãƒ¼ã‚«ãƒ¼ã§å…±æœ‰ï¼‰
study = optuna.create_study(
    study_name='distributed_optimization',
    storage=storage,
    direction='maximize',
    load_if_exists=True  # æ—¢å­˜studyãŒã‚ã‚Œã°å†åˆ©ç”¨
)

# å„ãƒ¯ãƒ¼ã‚«ãƒ¼ã§ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œ
def objective(trial):
    x = trial.suggest_float('x', -10, 10)
    y = trial.suggest_float('y', -10, 10)
    return -(x**2 + y**2)

# å„ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒä¸¦åˆ—ã§æœ€é©åŒ–
study.optimize(objective, n_trials=100)

print(f"Best value: {study.best_value}")
print(f"Best params: {study.best_params}")
print(f"Total trials: {len(study.trials)}")
</code></pre>

<div class="tip-box">
<strong>ğŸ’¡ åˆ†æ•£æœ€é©åŒ–ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ï¼š</strong>
<ul>
<li><strong>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸é¸æŠï¼š</strong> å°ã€œä¸­è¦æ¨¡â†’SQLiteã€å¤§è¦æ¨¡â†’PostgreSQL/MySQLã€è¶…é«˜é€Ÿâ†’Redis</li>
<li><strong>ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°ï¼š</strong> CPUæ•°ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å¸¯åŸŸã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸æ€§èƒ½ã‚’è€ƒæ…®</li>
<li><strong>è² è·åˆ†æ•£ï¼š</strong> å„ãƒ¯ãƒ¼ã‚«ãƒ¼ã®n_trialsã‚’èª¿æ•´ã—ã¦ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹</li>
</ul>
</div>

<h3>3.3 Ray Tuneã«ã‚ˆã‚‹åˆ†æ•£ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</h3>

<p>Ray Tuneã¯åˆ†æ•£å®Ÿè¡Œã¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒªãƒ³ã‚°ã«ç‰¹åŒ–ã—ãŸãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã€å¤§è¦æ¨¡ã‚¯ãƒ©ã‚¹ã‚¿ã§ã®ä¸¦åˆ—ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã«é©ã—ã¦ã„ã¾ã™ã€‚</p>

<pre><code class="language-python">from ray import tune
from ray.tune.schedulers import ASHAScheduler
from ray.tune.search.optuna import OptunaSearch
import numpy as np

def train_model(config):
    """è¨“ç·´é–¢æ•°ï¼ˆRay TuneãŒä¸¦åˆ—å®Ÿè¡Œï¼‰"""
    # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šå®Ÿéš›ã«ã¯ãƒ¢ãƒ‡ãƒ«è¨“ç·´ã‚’å®Ÿè£…
    for epoch in range(10):
        # config['lr']ã‚„config['batch_size']ã‚’ä½¿ã£ãŸè¨“ç·´
        accuracy = 1 - (config['lr'] - 0.01)**2 - (config['batch_size'] - 32)**2 / 1000
        accuracy += np.random.normal(0, 0.01)  # ãƒã‚¤ã‚º

        # ä¸­é–“çµæœã‚’å ±å‘Š
        tune.report(accuracy=accuracy)

# æ¢ç´¢ç©ºé–“å®šç¾©
search_space = {
    'lr': tune.loguniform(1e-4, 1e-1),
    'batch_size': tune.choice([16, 32, 64, 128]),
    'hidden_size': tune.choice([64, 128, 256, 512]),
}

# ASHA Schedulerï¼ˆåŠ¹ç‡çš„ãªearly stoppingï¼‰
scheduler = ASHAScheduler(
    max_t=10,           # æœ€å¤§ã‚¨ãƒãƒƒã‚¯æ•°
    grace_period=1,     # æœ€å°å®Ÿè¡Œã‚¨ãƒãƒƒã‚¯æ•°
    reduction_factor=2  # å„æ®µéšã§åŠåˆ†ã‚’æ‰“ã¡åˆ‡ã‚Š
)

# Optunaæ¤œç´¢ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’ä½¿ç”¨
search_alg = OptunaSearch()

# åˆ†æ•£ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å®Ÿè¡Œ
analysis = tune.run(
    train_model,
    config=search_space,
    num_samples=50,           # è©¦è¡Œå›æ•°
    scheduler=scheduler,
    search_alg=search_alg,
    resources_per_trial={     # å„è©¦è¡Œã®ãƒªã‚½ãƒ¼ã‚¹
        'cpu': 2,
        'gpu': 0.5
    },
    verbose=1
)

# æœ€é©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
best_config = analysis.best_config
print(f"Best config: {best_config}")
print(f"Best accuracy: {analysis.best_result['accuracy']:.4f}")
</code></pre>

<h3>3.4 ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®è€ƒæ…®äº‹é …</h3>

<table>
<thead>
<tr>
<th>è¦æ¨¡</th>
<th>æ¨å¥¨ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</th>
<th>ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸</th>
<th>ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>å°è¦æ¨¡ï¼ˆã€œ100è©¦è¡Œï¼‰</td>
<td>Optuna</td>
<td>SQLite</td>
<td>1-4</td>
</tr>
<tr>
<td>ä¸­è¦æ¨¡ï¼ˆ100ã€œ1000è©¦è¡Œï¼‰</td>
<td>Optuna</td>
<td>PostgreSQL</td>
<td>4-16</td>
</tr>
<tr>
<td>å¤§è¦æ¨¡ï¼ˆ1000ã€œ10000è©¦è¡Œï¼‰</td>
<td>Ray Tune</td>
<td>PostgreSQL/Redis</td>
<td>16-64</td>
</tr>
<tr>
<td>è¶…å¤§è¦æ¨¡ï¼ˆ10000è©¦è¡Œã€œï¼‰</td>
<td>Ray Tune</td>
<td>åˆ†æ•£Redis</td>
<td>64+</td>
</tr>
</tbody>
</table>

<h2>4. è»¢ç§»å­¦ç¿’ã¨ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ</h2>

<p>éå»ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°çµæœã‚„é¡ä¼¼ã‚¿ã‚¹ã‚¯ã®çŸ¥è­˜ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§ã€æ¢ç´¢ã‚’å¤§å¹…ã«åŠ¹ç‡åŒ–ã§ãã¾ã™ã€‚</p>

<h3>4.1 äº‹å‰çŸ¥è­˜ã®æ´»ç”¨</h3>

<p>ã‚¼ãƒ­ã‹ã‚‰ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’é–‹å§‹ã™ã‚‹ã®ã§ã¯ãªãã€æ—¢çŸ¥ã®è‰¯å¥½ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰æ¢ç´¢ã‚’é–‹å§‹ã™ã‚‹æ–¹æ³•ã§ã™ã€‚</p>

<h4>ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆã®åˆ©ç‚¹</h4>
<ul>
<li><strong>æ¢ç´¢æ™‚é–“çŸ­ç¸®ï¼š</strong>è‰¯å¥½ãªåˆæœŸå€¤ã‹ã‚‰é–‹å§‹ã™ã‚‹ã“ã¨ã§åæŸãŒæ—©ã„</li>
<li><strong>ãƒªã‚¹ã‚¯ä½æ¸›ï¼š</strong>æœ€ä½é™ã®æ€§èƒ½ã‚’æ‹…ä¿ã§ãã‚‹</li>
<li><strong>çŸ¥è­˜ã®è“„ç©ï¼š</strong>éå»ã®çµŒé¨“ã‚’æ´»ã‹ã›ã‚‹</li>
</ul>

<h3>4.2 Optunaã§ã®ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆå®Ÿè£…</h3>

<pre><code class="language-python">import optuna
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import cross_val_score

# æ—¢çŸ¥ã®è‰¯å¥½ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆéå»ã®çµŒé¨“ã‚„ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜ï¼‰
known_good_params = [
    {'n_estimators': 100, 'max_depth': 10, 'min_samples_split': 5},
    {'n_estimators': 200, 'max_depth': 15, 'min_samples_split': 2},
    {'n_estimators': 150, 'max_depth': 12, 'min_samples_split': 4},
]

def objective(trial):
    params = {
        'n_estimators': trial.suggest_int('n_estimators', 50, 300),
        'max_depth': trial.suggest_int('max_depth', 5, 20),
        'min_samples_split': trial.suggest_int('min_samples_split', 2, 10),
    }

    clf = RandomForestClassifier(**params, random_state=42, n_jobs=-1)
    score = cross_val_score(clf, X, y, cv=3, n_jobs=-1).mean()
    return score

# Studyä½œæˆ
study = optuna.create_study(direction='maximize')

# ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆï¼šæ—¢çŸ¥ã®è‰¯å¥½ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’äº‹å‰ã«è¿½åŠ 
for params in known_good_params:
    study.enqueue_trial(params)

# æœ€é©åŒ–å®Ÿè¡Œï¼ˆenqueueã•ã‚ŒãŸè©¦è¡ŒãŒå„ªå…ˆçš„ã«å®Ÿè¡Œã•ã‚Œã‚‹ï¼‰
study.optimize(objective, n_trials=50)

print(f"Best score: {study.best_value:.4f}")
print(f"Best params: {study.best_params}")

# äº‹å‰ç™»éŒ²ã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®åŠ¹æœç¢ºèª
warmstart_trials = study.trials[:len(known_good_params)]
print("\n=== Warmstart trials performance ===")
for i, trial in enumerate(warmstart_trials):
    print(f"Params {i+1}: {trial.params} -> Score: {trial.value:.4f}")
</code></pre>

<h3>4.3 ãƒ¡ã‚¿å­¦ç¿’ã®å¿œç”¨</h3>

<p>è¤‡æ•°ã®é¡ä¼¼ã‚¿ã‚¹ã‚¯ã‹ã‚‰å­¦ç¿’ã—ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã«å¯¾ã™ã‚‹è‰¯å¥½ãªåˆæœŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’äºˆæ¸¬ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚</p>

<blockquote>
<strong>ãƒ¡ã‚¿å­¦ç¿’ï¼š</strong>ã€Œå­¦ç¿’ã®å­¦ç¿’ã€ã¨å‘¼ã°ã‚Œã€è¤‡æ•°ã®ã‚¿ã‚¹ã‚¯ã§ã®çµŒé¨“ã‹ã‚‰æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã¸ã®é©å¿œã‚’é«˜é€ŸåŒ–ã™ã‚‹æŠ€è¡“ã€‚
</blockquote>

<h4>å®Ÿè·µçš„ãªãƒ¡ã‚¿å­¦ç¿’ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</h4>

<ol>
<li><strong>éå»ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å±¥æ­´ã‚’ä¿å­˜ï¼š</strong>ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç‰¹æ€§ã¨ãƒ™ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒšã‚¢ã‚’è¨˜éŒ²</li>
<li><strong>é¡ä¼¼ã‚¿ã‚¹ã‚¯æ¤œç´¢ï¼š</strong>æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã«é¡ä¼¼ã™ã‚‹éå»ã‚¿ã‚¹ã‚¯ã‚’ç‰¹å®š</li>
<li><strong>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å¥¨ï¼š</strong>é¡ä¼¼ã‚¿ã‚¹ã‚¯ã®ãƒ™ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åˆæœŸå€¤ã¨ã—ã¦ä½¿ç”¨</li>
</ol>

<pre><code class="language-python">import json
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity

class MetaLearningOptimizer:
    """ãƒ¡ã‚¿å­¦ç¿’ã‚’ä½¿ã£ãŸãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–"""

    def __init__(self, history_file='tuning_history.json'):
        self.history_file = history_file
        self.history = self.load_history()

    def load_history(self):
        """éå»ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å±¥æ­´ã‚’èª­ã¿è¾¼ã¿"""
        try:
            with open(self.history_file, 'r') as f:
                return json.load(f)
        except FileNotFoundError:
            return []

    def save_history(self, dataset_features, best_params, best_score):
        """æ–°ã—ã„ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°çµæœã‚’ä¿å­˜"""
        self.history.append({
            'dataset_features': dataset_features,
            'best_params': best_params,
            'best_score': best_score
        })
        with open(self.history_file, 'w') as f:
            json.dump(self.history, f, indent=2)

    def get_dataset_features(self, X, y):
        """ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ç‰¹å¾´é‡ã‚’æŠ½å‡º"""
        return {
            'n_samples': X.shape[0],
            'n_features': X.shape[1],
            'n_classes': len(np.unique(y)),
            'class_imbalance': np.std(np.bincount(y)) / np.mean(np.bincount(y)),
            'feature_correlation': np.mean(np.abs(np.corrcoef(X.T))),
        }

    def find_similar_tasks(self, current_features, top_k=3):
        """é¡ä¼¼ã‚¿ã‚¹ã‚¯ã‚’æ¤œç´¢"""
        if not self.history:
            return []

        # ç‰¹å¾´é‡ãƒ™ã‚¯ãƒˆãƒ«åŒ–
        current_vec = np.array(list(current_features.values())).reshape(1, -1)

        similarities = []
        for record in self.history:
            hist_vec = np.array(list(record['dataset_features'].values())).reshape(1, -1)
            sim = cosine_similarity(current_vec, hist_vec)[0][0]
            similarities.append((sim, record))

        # é¡ä¼¼åº¦é †ã«ã‚½ãƒ¼ãƒˆ
        similarities.sort(reverse=True, key=lambda x: x[0])
        return [record for _, record in similarities[:top_k]]

    def get_warmstart_params(self, X, y):
        """ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆç”¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¨å¥¨"""
        current_features = self.get_dataset_features(X, y)
        similar_tasks = self.find_similar_tasks(current_features)

        if not similar_tasks:
            return []

        # é¡ä¼¼ã‚¿ã‚¹ã‚¯ã®ãƒ™ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿”ã™
        return [task['best_params'] for task in similar_tasks]

# ä½¿ç”¨ä¾‹
meta_optimizer = MetaLearningOptimizer()

# æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã«å¯¾ã™ã‚‹ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ
warmstart_params = meta_optimizer.get_warmstart_params(X, y)

if warmstart_params:
    print("=== Recommended warmstart parameters ===")
    for i, params in enumerate(warmstart_params):
        print(f"Recommendation {i+1}: {params}")

    # Optunaã§ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ
    study = optuna.create_study(direction='maximize')
    for params in warmstart_params:
        study.enqueue_trial(params)
    study.optimize(objective, n_trials=50)
else:
    # å±¥æ­´ãŒãªã„å ´åˆã¯é€šå¸¸ã®æœ€é©åŒ–
    study = optuna.create_study(direction='maximize')
    study.optimize(objective, n_trials=50)

# çµæœã‚’å±¥æ­´ã«ä¿å­˜
dataset_features = meta_optimizer.get_dataset_features(X, y)
meta_optimizer.save_history(dataset_features, study.best_params, study.best_value)
</code></pre>

<h3>4.4 è»¢ç§»å­¦ç¿’ã®å®Ÿè·µçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</h3>

<table>
<thead>
<tr>
<th>ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</th>
<th>é©ç”¨å ´é¢</th>
<th>åŠ¹æœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>ã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆ</td>
<td>é¡ä¼¼ã‚¿ã‚¹ã‚¯ã®çµŒé¨“ãŒã‚ã‚‹</td>
<td>æ¢ç´¢æ™‚é–“20-40%çŸ­ç¸®</td>
</tr>
<tr>
<td>ãƒ¡ã‚¿å­¦ç¿’</td>
<td>å¤šæ•°ã®éå»ã‚¿ã‚¹ã‚¯ãŒã‚ã‚‹</td>
<td>åˆæœŸæ€§èƒ½å‘ä¸Š+æ¢ç´¢åŠ¹ç‡åŒ–</td>
</tr>
<tr>
<td>ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜æ³¨å…¥</td>
<td>å°‚é–€å®¶ã®çŸ¥è¦‹ãŒã‚ã‚‹</td>
<td>ãƒªã‚¹ã‚¯ä½æ¸›+é«˜é€ŸåæŸ</td>
</tr>
<tr>
<td>ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«æ´»ç”¨</td>
<td>è¤‡æ•°ã®å€™è£œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</td>
<td>ãƒ­ãƒã‚¹ãƒˆæ€§å‘ä¸Š</td>
</tr>
</tbody>
</table>

<h2>5. ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å®Ÿè·µã‚¬ã‚¤ãƒ‰</h2>

<p>ç†è«–ã‚’å®Ÿå‹™ã«é©ç”¨ã™ã‚‹éš›ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã€ãƒ‡ãƒãƒƒã‚°æ‰‹æ³•ã€æœ¬ç•ªé‹ç”¨ã®ãƒã‚¦ãƒã‚¦ã‚’è§£èª¬ã—ã¾ã™ã€‚</p>

<h3>5.1 æ¢ç´¢ç©ºé–“è¨­è¨ˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h3>

<h4>åŠ¹æœçš„ãªæ¢ç´¢ç©ºé–“ã®è¨­è¨ˆåŸå‰‡</h4>

<ol>
<li><strong>å½±éŸ¿åº¦é †ã«å„ªå…ˆé †ä½ä»˜ã‘</strong>
   <ul>
   <li>å­¦ç¿’ç‡ã€æ­£å‰‡åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ â†’ é«˜å„ªå…ˆåº¦</li>
   <li>ãƒãƒƒãƒã‚µã‚¤ã‚ºã€ã‚¨ãƒãƒƒã‚¯æ•° â†’ ä¸­å„ªå…ˆåº¦</li>
   <li>å¾®èª¿æ•´ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ â†’ ä½å„ªå…ˆåº¦</li>
   </ul>
</li>
<li><strong>é©åˆ‡ãªã‚¹ã‚±ãƒ¼ãƒ«é¸æŠ</strong>
   <ul>
   <li>å­¦ç¿’ç‡ï¼šå¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆloguniformï¼‰</li>
   <li>æ­£å‰‡åŒ–å¼·åº¦ï¼šå¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«</li>
   <li>å±¤æ•°ã€ãƒ¦ãƒ‹ãƒƒãƒˆæ•°ï¼šæ•´æ•°ã€ç·šå½¢ã‚¹ã‚±ãƒ¼ãƒ«</li>
   </ul>
</li>
<li><strong>æ¡ä»¶ä»˜ããƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ´»ç”¨</strong>
   <ul>
   <li>ç‰¹å®šã®é¸æŠã«ä¾å­˜ã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯æ¡ä»¶åˆ†å²</li>
   </ul>
</li>
</ol>

<div class="tip-box">
<strong>ğŸ’¡ æ¢ç´¢ç©ºé–“è¨­è¨ˆã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼š</strong>
<ul>
<li>âœ… ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é–“ã®ä¾å­˜é–¢ä¿‚ã‚’æ˜ç¢ºåŒ–ã—ã¦ã„ã‚‹ã‹</li>
<li>âœ… é©åˆ‡ãªåˆ†å¸ƒï¼ˆuniformã€loguniformç­‰ï¼‰ã‚’é¸æŠã—ã¦ã„ã‚‹ã‹</li>
<li>âœ… æ¢ç´¢ç¯„å›²ãŒåºƒã™ã/ç‹­ã™ããªã„ã‹</li>
<li>âœ… è¨ˆç®—ã‚³ã‚¹ãƒˆã®é«˜ã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’çµã‚Šè¾¼ã‚“ã§ã„ã‚‹ã‹</li>
</ul>
</div>

<h3>5.2 ãƒ‡ãƒãƒƒã‚°ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h3>

<h4>ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºç­–</h4>

<table>
<thead>
<tr>
<th>å•é¡Œ</th>
<th>åŸå› </th>
<th>è§£æ±ºç­–</th>
</tr>
</thead>
<tbody>
<tr>
<td>åæŸã—ãªã„</td>
<td>æ¢ç´¢ç©ºé–“ãŒåºƒã™ãã‚‹</td>
<td>äº‹å‰å®Ÿé¨“ã§ç¯„å›²ã‚’çµã‚‹</td>
</tr>
<tr>
<td>åŒã˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã°ã‹ã‚Š</td>
<td>ã‚µãƒ³ãƒ—ãƒ©ãƒ¼ã®åã‚Š</td>
<td>RandomSamplerã¨æ¯”è¼ƒ</td>
</tr>
<tr>
<td>PruningãŒå¤šã™ã</td>
<td>Prunerè¨­å®šãŒå³ã—ã„</td>
<td>n_warmup_stepså¢—åŠ </td>
</tr>
<tr>
<td>çµæœãŒä¸å®‰å®š</td>
<td>è©•ä¾¡ã®ãƒ©ãƒ³ãƒ€ãƒ æ€§</td>
<td>CV foldæ•°å¢—åŠ ã€seedå›ºå®š</td>
</tr>
<tr>
<td>ãƒ¡ãƒ¢ãƒªä¸è¶³</td>
<td>å¤§ãã™ãã‚‹ãƒ¢ãƒ‡ãƒ«</td>
<td>ãƒãƒƒãƒã‚µã‚¤ã‚ºå‰Šæ¸›ã€å‹¾é…è“„ç©</td>
</tr>
</tbody>
</table>

<h4>ãƒ‡ãƒãƒƒã‚°ã®ãŸã‚ã®å¯è¦–åŒ–</h4>

<pre><code class="language-python">import optuna
from optuna.visualization import (
    plot_optimization_history,
    plot_param_importances,
    plot_parallel_coordinate,
    plot_slice
)

# æœ€é©åŒ–å®Ÿè¡Œå¾Œã®å¯è¦–åŒ–
study = optuna.create_study(direction='maximize')
study.optimize(objective, n_trials=100)

# 1. æœ€é©åŒ–å±¥æ­´ï¼šæ™‚é–“çµŒéã¨ã¨ã‚‚ã«æ”¹å–„ã—ã¦ã„ã‚‹ã‹ç¢ºèª
fig1 = plot_optimization_history(study)
fig1.show()

# 2. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é‡è¦åº¦ï¼šã©ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒé‡è¦ã‹ç¢ºèª
fig2 = plot_param_importances(study)
fig2.show()

# 3. ä¸¦åˆ—åº§æ¨™ãƒ—ãƒ­ãƒƒãƒˆï¼šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é–“ã®é–¢ä¿‚æ€§ã‚’ç¢ºèª
fig3 = plot_parallel_coordinate(study)
fig3.show()

# 4. ã‚¹ãƒ©ã‚¤ã‚¹ãƒ—ãƒ­ãƒƒãƒˆï¼šå„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½±éŸ¿ã‚’å€‹åˆ¥ç¢ºèª
fig4 = plot_slice(study)
fig4.show()
</code></pre>

<h3>5.3 æœ¬ç•ªç’°å¢ƒã§ã®é‹ç”¨</h3>

<h4>æœ¬ç•ªé‹ç”¨ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h4>

<div class="mermaid">
graph TD
    A[é–‹ç™ºç’°å¢ƒã§æ¢ç´¢] --> B[å€™è£œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿é¸å®š]
    B --> C[ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç’°å¢ƒã§æ¤œè¨¼]
    C --> D{æ€§èƒ½ãƒ»å®‰å®šæ€§OK?}
    D -->|No| A
    D -->|Yes| E[æœ¬ç•ªç’°å¢ƒãƒ‡ãƒ—ãƒ­ã‚¤]
    E --> F[ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°]
    F --> G{æ€§èƒ½åŠ£åŒ–æ¤œçŸ¥?}
    G -->|Yes| H[å†ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°]
    G -->|No| F
    H --> A
</div>

<h4>æœ¬ç•ªé‹ç”¨ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h4>

<ol>
<li><strong>æ®µéšçš„ãƒ­ãƒ¼ãƒ«ã‚¢ã‚¦ãƒˆ</strong>
   <ul>
   <li>Canary deploymentï¼šä¸€éƒ¨ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã§æ¤œè¨¼</li>
   <li>A/Bãƒ†ã‚¹ãƒˆï¼šæ—¢å­˜ãƒ¢ãƒ‡ãƒ«ã¨ä¸¦è¡Œé‹ç”¨</li>
   <li>æ®µéšçš„ãªåˆ‡ã‚Šæ›¿ãˆï¼šå•é¡Œç™ºç”Ÿæ™‚ã®å³åº§ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯</li>
   </ul>
</li>
<li><strong>ç¶™ç¶šçš„ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°</strong>
   <ul>
   <li>äºˆæ¸¬æ€§èƒ½ã®è¿½è·¡ï¼ˆç²¾åº¦ã€AUCç­‰ï¼‰</li>
   <li>ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ã€ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆã®ç›£è¦–</li>
   <li>ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ•ãƒˆæ¤œçŸ¥</li>
   </ul>
</li>
<li><strong>å®šæœŸçš„ãªå†ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</strong>
   <ul>
   <li>ãƒ‡ãƒ¼ã‚¿åˆ†å¸ƒã®å¤‰åŒ–ã«å¿œã˜ã¦å››åŠæœŸã”ã¨ç­‰ã«å®Ÿæ–½</li>
   <li>æ–°ã—ã„ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚„æ‰‹æ³•ã®è©•ä¾¡</li>
   <li>éå»ã®çµæœã‚’æ´»ã‹ã—ãŸãƒ¡ã‚¿å­¦ç¿’</li>
   </ul>
</li>
</ol>

<div class="warning-box">
<strong>âš ï¸ æœ¬ç•ªé‹ç”¨ã§ã®æ³¨æ„ç‚¹ï¼š</strong>
<ul>
<li><strong>å†ç¾æ€§ã®ç¢ºä¿ï¼š</strong>ä¹±æ•°ã‚·ãƒ¼ãƒ‰ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’å›ºå®š</li>
<li><strong>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼š</strong>æ—¢å­˜ãƒ¢ãƒ‡ãƒ«ã‚’ã„ã¤ã§ã‚‚å¾©å…ƒã§ãã‚‹çŠ¶æ…‹ã«</li>
<li><strong>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆåŒ–ï¼š</strong>ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°å±¥æ­´ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰æ›´ç†ç”±ã‚’è¨˜éŒ²</li>
<li><strong>ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®šï¼š</strong>æ€§èƒ½åŠ£åŒ–æ™‚ã®è‡ªå‹•é€šçŸ¥</li>
</ul>
</div>

<h3>5.4 å®Ÿè·µçš„ãªãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æˆ¦ç•¥ã¾ã¨ã‚</h3>

<table>
<thead>
<tr>
<th>ãƒ•ã‚§ãƒ¼ã‚º</th>
<th>ç›®çš„</th>
<th>æ¨å¥¨æ‰‹æ³•</th>
<th>è©¦è¡Œå›æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>åˆæœŸæ¢ç´¢</td>
<td>å…¨ä½“åƒæŠŠæ¡</td>
<td>Random Search</td>
<td>20-50</td>
</tr>
<tr>
<td>çµã‚Šè¾¼ã¿</td>
<td>æœ‰æœ›é ˜åŸŸç‰¹å®š</td>
<td>TPE + Pruning</td>
<td>50-100</td>
</tr>
<tr>
<td>ç²¾å¯†æ¢ç´¢</td>
<td>æœ€é©è§£ç™ºè¦‹</td>
<td>CMA-ES/GP</td>
<td>100-200</td>
</tr>
<tr>
<td>ãƒãƒ«ãƒç›®çš„</td>
<td>ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•èª¿æ•´</td>
<td>Multi-objective TPE</td>
<td>100-300</td>
</tr>
<tr>
<td>æœ¬ç•ªæ¤œè¨¼</td>
<td>æœ€çµ‚ç¢ºèª</td>
<td>Cross-validationå¢—</td>
<td>5-10</td>
</tr>
</tbody>
</table>

<h3>5.5 ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°åŠ¹ç‡åŒ–ã®ãƒãƒ¼ãƒˆã‚·ãƒ¼ãƒˆ</h3>

<blockquote>
<strong>æ™‚é–“ãŒãªã„æ™‚ã®ã‚¯ã‚¤ãƒƒã‚¯ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æ‰‹é †ï¼š</strong>
<ol>
<li>ãƒ‰ãƒ¡ã‚¤ãƒ³çŸ¥è­˜/éå»çµŒé¨“ã‹ã‚‰åˆæœŸå€¤è¨­å®šï¼ˆã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆï¼‰</li>
<li>é‡è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿2-3å€‹ã«çµã£ã¦æ¢ç´¢ï¼ˆå­¦ç¿’ç‡ã€æ­£å‰‡åŒ–ï¼‰</li>
<li>MedianPruneræœ‰åŠ¹åŒ–ã§ç„¡é§„ãªè©¦è¡Œå‰Šæ¸›</li>
<li>ä¸¦åˆ—å®Ÿè¡Œï¼ˆ4-8ãƒ¯ãƒ¼ã‚«ãƒ¼ï¼‰ã§æ™‚é–“çŸ­ç¸®</li>
<li>50-100è©¦è¡Œã§å®Ÿç”¨çš„ãªæ€§èƒ½ã‚’ç¢ºä¿</li>
</ol>
</blockquote>

<h2>ç« æœ«æ¼”ç¿’å•é¡Œ</h2>

<details>
<summary><strong>æ¼”ç¿’1ï¼šãƒãƒ«ãƒç›®çš„æœ€é©åŒ–ã®å®Ÿè£…ï¼ˆé›£æ˜“åº¦ï¼šä¸­ï¼‰</strong></summary>
<p>ç²¾åº¦ã€æ¨è«–æ™‚é–“ã€ãƒ¢ãƒ‡ãƒ«ã‚µã‚¤ã‚ºã®3ã¤ã‚’åŒæ™‚ã«æœ€é©åŒ–ã™ã‚‹Optunaã®studyã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã‚’å¯è¦–åŒ–ã—ã€ãƒ“ã‚¸ãƒã‚¹è¦ä»¶ï¼ˆç²¾åº¦0.90ä»¥ä¸Šã€æ¨è«–æ™‚é–“50msä»¥ä¸‹ï¼‰ã‚’æº€ãŸã™è§£ã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>
</details>

<details>
<summary><strong>æ¼”ç¿’2ï¼šPruningæˆ¦ç•¥ã®æ¯”è¼ƒï¼ˆé›£æ˜“åº¦ï¼šä¸­ï¼‰</strong></summary>
<p>MedianPrunerã€PercentilePrunerã€HyperbandPrunerã®3ã¤ã‚’æ¯”è¼ƒå®Ÿé¨“ã—ã¦ãã ã•ã„ã€‚åŒã˜ç›®çš„é–¢æ•°ã«å¯¾ã—ã¦ã€å„Prunerã®æ‰“ã¡åˆ‡ã‚Šç‡ã€æœ€çµ‚æ€§èƒ½ã€è¨ˆç®—æ™‚é–“ã‚’æ¯”è¼ƒã—ã€ã©ã®PrunerãŒæœ€ã‚‚åŠ¹ç‡çš„ã‹è©•ä¾¡ã—ã¦ãã ã•ã„ã€‚</p>
</details>

<details>
<summary><strong>æ¼”ç¿’3ï¼šåˆ†æ•£ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®å®Ÿè£…ï¼ˆé›£æ˜“åº¦ï¼šä¸Šç´šï¼‰</strong></summary>
<p>PostgreSQLã‚’ä½¿ã£ãŸOptunaåˆ†æ•£æœ€é©åŒ–ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚3ã¤ã®ç•°ãªã‚‹ãƒ¯ãƒ¼ã‚«ãƒ¼ã‹ã‚‰åŒæ™‚ã«studyã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã€åˆè¨ˆ150è©¦è¡Œã‚’åŠ¹ç‡çš„ã«å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚å„ãƒ¯ãƒ¼ã‚«ãƒ¼ã®è²¢çŒ®åº¦ã‚’åˆ†æã—ã¦ãã ã•ã„ã€‚</p>
</details>

<details>
<summary><strong>æ¼”ç¿’4ï¼šãƒ¡ã‚¿å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ï¼ˆé›£æ˜“åº¦ï¼šä¸Šç´šï¼‰</strong></summary>
<p>è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆUCI MLãƒªãƒã‚¸ãƒˆãƒªç­‰ï¼‰ã«å¯¾ã—ã¦ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’å®Ÿè¡Œã—ã€ãã®å±¥æ­´ã‹ã‚‰æ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã™ã‚‹æœ€é©ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¨å¥¨ã™ã‚‹ãƒ¡ã‚¿å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¦ãã ã•ã„ã€‚</p>
</details>

<details>
<summary><strong>æ¼”ç¿’5ï¼šæœ¬ç•ªé‹ç”¨ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆé›£æ˜“åº¦ï¼šä¸Šç´šï¼‰</strong></summary>
<p>æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ã£ã¦ã€æœ¬ç•ªé‹ç”¨ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ•ãƒˆãŒç™ºç”Ÿã—ãŸéš›ã®æ€§èƒ½åŠ£åŒ–ã‚’æ¤œçŸ¥ã—ã€è‡ªå‹•çš„ã«å†ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ä»•çµ„ã¿ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
</details>

<h2>ã¾ã¨ã‚</h2>

<p>æœ¬ç« ã§ã¯å®Ÿè·µçš„ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æˆ¦ç•¥ã‚’å­¦ã³ã¾ã—ãŸï¼š</p>

<ul>
<li>âœ… <strong>ãƒãƒ«ãƒç›®çš„æœ€é©åŒ–ï¼š</strong>ç²¾åº¦ã¨ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ç­‰ã€è¤‡æ•°æŒ‡æ¨™ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢ã§è§£æ±º</li>
<li>âœ… <strong>Early Stoppingï¼š</strong>Pruningã«ã‚ˆã‚Šæœ‰æœ›ã§ãªã„è©¦è¡Œã‚’æ‰“ã¡åˆ‡ã‚Šã€è¨ˆç®—åŠ¹ç‡ã‚’å¤§å¹…å‘ä¸Š</li>
<li>âœ… <strong>åˆ†æ•£ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ï¼š</strong>RDBã‚„Redisã‚’ä½¿ã£ãŸä¸¦åˆ—å®Ÿè¡Œã§å¤§è¦æ¨¡æ¢ç´¢ã‚’å®Ÿç¾</li>
<li>âœ… <strong>è»¢ç§»å­¦ç¿’ï¼š</strong>éå»ã®çŸ¥è­˜ã‚’æ´»ç”¨ã—ãŸã‚¦ã‚©ãƒ¼ãƒ ã‚¹ã‚¿ãƒ¼ãƒˆã€ãƒ¡ã‚¿å­¦ç¿’ã§æ¢ç´¢åŠ¹ç‡åŒ–</li>
<li>âœ… <strong>æœ¬ç•ªé‹ç”¨ï¼š</strong>æ®µéšçš„ãƒ‡ãƒ—ãƒ­ã‚¤ã€ç¶™ç¶šçš„ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã€å®šæœŸçš„å†ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</li>
</ul>

<p>ã“ã‚Œã‚‰ã®æŠ€è¡“ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€å®Ÿå‹™ã§æ±‚ã‚ã‚‰ã‚Œã‚‹é«˜å“è³ªã‹ã¤åŠ¹ç‡çš„ãªãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚</p>

<div class="project-box">
<h3>ğŸ“Š å®Ÿè·µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼šã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</h3>
<p>æœ¬ç« ã§å­¦ã‚“ã ã™ã¹ã¦ã®æŠ€è¡“ã‚’çµ±åˆã—ã€å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹èª²é¡Œã‚’è§£æ±ºã™ã‚‹ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã—ã¦ãã ã•ã„ï¼š</p>
<ol>
<li>Kaggleã‚³ãƒ³ãƒšãƒ†ã‚£ã‚·ãƒ§ãƒ³ã‚„å®Ÿãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’é¸æŠ</li>
<li>ãƒãƒ«ãƒç›®çš„æœ€é©åŒ–ã§ç²¾åº¦ã¨æ¨è«–æ™‚é–“ã‚’æœ€é©åŒ–</li>
<li>Pruningã§æ¢ç´¢åŠ¹ç‡åŒ–ã€åˆ†æ•£å®Ÿè¡Œã§æ™‚é–“çŸ­ç¸®</li>
<li>ãƒ¡ã‚¿å­¦ç¿’ã§éå»ã®çŸ¥è­˜ã‚’æ´»ç”¨</li>
<li>æœ¬ç•ªé‹ç”¨ã‚’æƒ³å®šã—ãŸãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ãƒ»å†ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æ©Ÿæ§‹ã®å®Ÿè£…</li>
</ol>
<p>ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é€šã˜ã¦ã€å®Ÿå‹™ãƒ¬ãƒ™ãƒ«ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã‚¹ã‚­ãƒ«ã‚’ç¢ºç«‹ã—ã¾ã—ã‚‡ã†ã€‚</p>
</div>

<div class="navigation">
    <a href="chapter3-advanced-methods.html" class="nav-button">â† ç¬¬3ç« ï¼šé«˜åº¦ãªæœ€é©åŒ–æ‰‹æ³•</a>
    <a href="index.html" class="nav-button">ç›®æ¬¡ã«æˆ»ã‚‹</a>
</div>

    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p>&copy; 2025 AI Terakoya. All rights reserved.</p>
    </footer>

</body>
</html>
