<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« ï¼šåˆ†é¡å•é¡Œã®åŸºç¤ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
        <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/wp/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/wp/knowledge/jp/ML/index.html">æ©Ÿæ¢°å­¦ç¿’</a><span class="breadcrumb-separator">â€º</span><a href="/wp/knowledge/jp/ML/supervised-learning-introduction/index.html">Supervised Learning</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 2</span>
        </div>
    </nav>

    <header>
        <div class="header-content">
            <h1>ç¬¬2ç« ï¼šåˆ†é¡å•é¡Œã®åŸºç¤</h1>
            <p class="subtitle">ã‚«ãƒ†ã‚´ãƒªäºˆæ¸¬ã®ç†è«–ã¨å®Ÿè£… - ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã‹ã‚‰æ±ºå®šæœ¨ãƒ»SVMã¾ã§</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 12å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 5å•</span>
            </div>
        </div>
    </header>

    <main class="container">

<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… åˆ†é¡å•é¡Œã®å®šç¾©ã¨å¿œç”¨ä¾‹ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã®ç†è«–ã¨å®Ÿè£…ãŒã§ãã‚‹</li>
<li>âœ… ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã¨ç¢ºç‡è§£é‡ˆã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… æ±ºå®šæœ¨ã®ä»•çµ„ã¿ã¨å®Ÿè£…ãŒã§ãã‚‹</li>
<li>âœ… k-NNã€SVMã‚’é©ç”¨ã§ãã‚‹</li>
<li>âœ… æ··åŒè¡Œåˆ—ã€ç²¾åº¦ã€å†ç¾ç‡ã€F1ã‚¹ã‚³ã‚¢ã§è©•ä¾¡ã§ãã‚‹</li>
<li>âœ… ROCæ›²ç·šã¨AUCã‚’ç†è§£ã—ä½¿ã„ã“ãªã›ã‚‹</li>
</ul>

<hr>

<h2>2.1 åˆ†é¡å•é¡Œã¨ã¯</h2>

<h3>å®šç¾©</h3>
<p><strong>åˆ†é¡å•é¡Œï¼ˆClassificationï¼‰</strong>ã¯ã€å…¥åŠ›å¤‰æ•°ã‹ã‚‰<strong>é›¢æ•£å€¤ï¼ˆã‚«ãƒ†ã‚´ãƒªï¼‰</strong>ã®å‡ºåŠ›ã‚’äºˆæ¸¬ã™ã‚‹æ•™å¸«ã‚ã‚Šå­¦ç¿’ã®ã‚¿ã‚¹ã‚¯ã§ã™ã€‚</p>

<blockquote>
<p>ã€Œç‰¹å¾´é‡ $X$ ã‹ã‚‰é›¢æ•£çš„ãªã‚¯ãƒ©ã‚¹ãƒ©ãƒ™ãƒ« $y \in \{1, 2, ..., K\}$ ã‚’äºˆæ¸¬ã™ã‚‹é–¢æ•° $f: X \rightarrow y$ ã‚’å­¦ç¿’ã™ã‚‹ã€</p>
</blockquote>

<h3>åˆ†é¡ã®ã‚¿ã‚¤ãƒ—</h3>

<table>
<thead>
<tr>
<th>ã‚¿ã‚¤ãƒ—</th>
<th>ã‚¯ãƒ©ã‚¹æ•°</th>
<th>ä¾‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>äºŒå€¤åˆ†é¡</strong></td>
<td>2ã‚¯ãƒ©ã‚¹</td>
<td>ã‚¹ãƒ‘ãƒ åˆ¤å®šã€ç–¾ç—…è¨ºæ–­ã€é¡§å®¢é›¢åäºˆæ¸¬</td>
</tr>
<tr>
<td><strong>å¤šã‚¯ãƒ©ã‚¹åˆ†é¡</strong></td>
<td>3+ã‚¯ãƒ©ã‚¹</td>
<td>æ‰‹æ›¸ãæ•°å­—èªè­˜ã€ç”»åƒåˆ†é¡ã€æ„Ÿæƒ…åˆ†æ</td>
</tr>
<tr>
<td><strong>å¤šãƒ©ãƒ™ãƒ«åˆ†é¡</strong></td>
<td>è¤‡æ•°ãƒ©ãƒ™ãƒ«</td>
<td>ã‚¿ã‚°ä»˜ã‘ã€éºä¼å­æ©Ÿèƒ½äºˆæ¸¬</td>
</tr>
</tbody>
</table>

<h3>å®Ÿä¸–ç•Œã®å¿œç”¨ä¾‹</h3>

<div class="mermaid">
graph LR
    A[åˆ†é¡å•é¡Œã®å¿œç”¨] --> B[åŒ»ç™‚: ç–¾ç—…è¨ºæ–­]
    A --> C[é‡‘è: ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆå¯©æŸ»]
    A --> D[ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°: é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆ]
    A --> E[ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: ä¸æ­£æ¤œçŸ¥]
    A --> F[ç”»åƒ: ç‰©ä½“èªè­˜]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#fff3e0
    style D fill:#fff3e0
    style E fill:#fff3e0
    style F fill:#fff3e0
</div>

<hr>

<h2>2.2 ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ï¼ˆLogistic Regressionï¼‰</h2>

<h3>æ¦‚è¦</h3>

<p><strong>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</strong>ã¯ã€äºŒå€¤åˆ†é¡ã«ä½¿ã‚ã‚Œã‚‹ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚ç·šå½¢å›å¸°ã«ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã‚’é©ç”¨ã—ã¦ç¢ºç‡ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚</p>

<h3>ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°</h3>

<p>$$
\sigma(z) = \frac{1}{1 + e^{-z}}
$$</p>

<p>ç‰¹å¾´ï¼š</p>
<ul>
<li>å‡ºåŠ›ç¯„å›²: $[0, 1]$ï¼ˆç¢ºç‡ã¨ã—ã¦è§£é‡ˆå¯èƒ½ï¼‰</li>
<li>$z = 0$ ã§ $\sigma(z) = 0.5$</li>
<li>æ»‘ã‚‰ã‹ãª Så­—ã‚«ãƒ¼ãƒ–</li>
</ul>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°
def sigmoid(z):
    return 1 / (1 + np.exp(-z))

# å¯è¦–åŒ–
z = np.linspace(-10, 10, 100)
y = sigmoid(z)

plt.figure(figsize=(10, 6))
plt.plot(z, y, linewidth=2, label='Ïƒ(z)')
plt.axhline(y=0.5, color='r', linestyle='--', alpha=0.5, label='é–¾å€¤ 0.5')
plt.axvline(x=0, color='g', linestyle='--', alpha=0.5)
plt.xlabel('z = w^T x', fontsize=12)
plt.ylabel('Ïƒ(z)', fontsize=12)
plt.title('ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°', fontsize=14)
plt.grid(True, alpha=0.3)
plt.legend()
plt.show()
</code></pre>

<h3>ãƒ¢ãƒ‡ãƒ«ã®å®šç¾©</h3>

<p>$$
P(y=1 | \mathbf{x}) = \sigma(\mathbf{w}^T \mathbf{x}) = \frac{1}{1 + e^{-\mathbf{w}^T \mathbf{x}}}
$$</p>

<p>äºˆæ¸¬ï¼š</p>

<p>$$
\hat{y} = \begin{cases}
1 & \text{if } P(y=1 | \mathbf{x}) \geq 0.5 \\
0 & \text{otherwise}
\end{cases}
$$</p>

<h3>æå¤±é–¢æ•°ï¼šäº¤å·®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</h3>

<p>$$
J(\mathbf{w}) = -\frac{1}{m} \sum_{i=1}^{m} \left[ y^{(i)} \log(\hat{y}^{(i)}) + (1 - y^{(i)}) \log(1 - \hat{y}^{(i)}) \right]
$$</p>

<h3>å®Ÿè£…ä¾‹</h3>

<pre><code class="language-python">from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, classification_report

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
X, y = make_classification(n_samples=1000, n_features=2, n_redundant=0,
                          n_informative=2, random_state=42, n_clusters_per_class=1)

# ãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°
model = LogisticRegression()
model.fit(X_train, y_train)

# äºˆæ¸¬
y_pred = model.predict(X_test)
y_proba = model.predict_proba(X_test)

print("=== ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸° ===")
print(f"ç²¾åº¦: {accuracy_score(y_test, y_pred):.4f}")
print(f"\né‡ã¿: {model.coef_[0]}")
print(f"åˆ‡ç‰‡: {model.intercept_[0]:.4f}")

# æ±ºå®šå¢ƒç•Œã®å¯è¦–åŒ–
def plot_decision_boundary(model, X, y):
    h = 0.02
    x_min, x_max = X[:, 0].min() - 1, X[:, 0].max() + 1
    y_min, y_max = X[:, 1].min() - 1, X[:, 1].max() + 1
    xx, yy = np.meshgrid(np.arange(x_min, x_max, h),
                        np.arange(y_min, y_max, h))

    Z = model.predict(np.c_[xx.ravel(), yy.ravel()])
    Z = Z.reshape(xx.shape)

    plt.figure(figsize=(10, 6))
    plt.contourf(xx, yy, Z, alpha=0.3, cmap='RdYlBu')
    plt.scatter(X[y==0, 0], X[y==0, 1], c='blue', marker='o',
                edgecolors='k', s=80, label='ã‚¯ãƒ©ã‚¹ 0')
    plt.scatter(X[y==1, 0], X[y==1, 1], c='red', marker='s',
                edgecolors='k', s=80, label='ã‚¯ãƒ©ã‚¹ 1')
    plt.xlabel('ç‰¹å¾´é‡ 1', fontsize=12)
    plt.ylabel('ç‰¹å¾´é‡ 2', fontsize=12)
    plt.title('ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã®æ±ºå®šå¢ƒç•Œ', fontsize=14)
    plt.legend()
    plt.show()

plot_decision_boundary(model, X_test, y_test)
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>=== ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸° ===
ç²¾åº¦: 0.9550

é‡ã¿: [2.14532851 1.87653214]
åˆ‡ç‰‡: -0.2341
</code></pre>

<hr>

<h2>2.3 æ±ºå®šæœ¨ï¼ˆDecision Treeï¼‰</h2>

<h3>æ¦‚è¦</h3>

<p><strong>æ±ºå®šæœ¨</strong>ã¯ã€if-then-elseãƒ«ãƒ¼ãƒ«ã®éšå±¤æ§‹é€ ã§åˆ†é¡ã‚’è¡Œã„ã¾ã™ã€‚ç‰¹å¾´é‡ã‚’åŸºæº–ã«å†å¸°çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆ†å‰²ã—ã¾ã™ã€‚</p>

<div class="mermaid">
graph TD
    A[ç‰¹å¾´é‡1 <= 0.5] -->|Yes| B[ç‰¹å¾´é‡2 <= 1.2]
    A -->|No| C[ã‚¯ãƒ©ã‚¹ 1]
    B -->|Yes| D[ã‚¯ãƒ©ã‚¹ 0]
    B -->|No| E[ã‚¯ãƒ©ã‚¹ 1]

    style A fill:#fff3e0
    style B fill:#fff3e0
    style C fill:#e8f5e9
    style D fill:#e3f2fd
    style E fill:#e8f5e9
</div>

<h3>åˆ†å‰²åŸºæº–</h3>

<p><strong>1. ã‚¸ãƒ‹ä¸ç´”åº¦ï¼ˆGini Impurityï¼‰</strong>ï¼š</p>

<p>$$
\text{Gini}(S) = 1 - \sum_{i=1}^{K} p_i^2
$$</p>

<ul>
<li>$p_i$: ã‚¯ãƒ©ã‚¹ $i$ ã®å‰²åˆ</li>
<li>å€¤ãŒå°ã•ã„ã»ã©ç´”ç²‹ï¼ˆä¸€ã¤ã®ã‚¯ãƒ©ã‚¹ã«åã£ã¦ã„ã‚‹ï¼‰</li>
</ul>

<p><strong>2. ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆEntropyï¼‰</strong>ï¼š</p>

<p>$$
\text{Entropy}(S) = -\sum_{i=1}^{K} p_i \log_2(p_i)
$$</p>

<h3>å®Ÿè£…ä¾‹</h3>

<pre><code class="language-python">from sklearn.tree import DecisionTreeClassifier
from sklearn.tree import plot_tree

# æ±ºå®šæœ¨ãƒ¢ãƒ‡ãƒ«
dt_model = DecisionTreeClassifier(max_depth=3, random_state=42)
dt_model.fit(X_train, y_train)

# äºˆæ¸¬
y_pred_dt = dt_model.predict(X_test)

print("=== æ±ºå®šæœ¨ ===")
print(f"ç²¾åº¦: {accuracy_score(y_test, y_pred_dt):.4f}")

# æ±ºå®šæœ¨ã®å¯è¦–åŒ–
plt.figure(figsize=(16, 10))
plot_tree(dt_model, filled=True, feature_names=['ç‰¹å¾´é‡1', 'ç‰¹å¾´é‡2'],
          class_names=['ã‚¯ãƒ©ã‚¹0', 'ã‚¯ãƒ©ã‚¹1'], fontsize=10)
plt.title('æ±ºå®šæœ¨ã®æ§‹é€ ', fontsize=16)
plt.show()

# æ±ºå®šå¢ƒç•Œ
plot_decision_boundary(dt_model, X_test, y_test)
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>=== æ±ºå®šæœ¨ ===
ç²¾åº¦: 0.9450
</code></pre>

<h3>ç‰¹å¾´é‡é‡è¦åº¦</h3>

<pre><code class="language-python"># ç‰¹å¾´é‡é‡è¦åº¦
importances = dt_model.feature_importances_

plt.figure(figsize=(8, 6))
plt.bar(['ç‰¹å¾´é‡1', 'ç‰¹å¾´é‡2'], importances, color=['#3498db', '#e74c3c'])
plt.ylabel('é‡è¦åº¦', fontsize=12)
plt.title('ç‰¹å¾´é‡é‡è¦åº¦', fontsize=14)
plt.grid(axis='y', alpha=0.3)
plt.show()

print(f"\nç‰¹å¾´é‡1ã®é‡è¦åº¦: {importances[0]:.4f}")
print(f"ç‰¹å¾´é‡2ã®é‡è¦åº¦: {importances[1]:.4f}")
</code></pre>

<hr>

<h2>2.4 k-è¿‘å‚æ³•ï¼ˆk-Nearest Neighbors, k-NNï¼‰</h2>

<h3>æ¦‚è¦</h3>

<p><strong>k-NN</strong>ã¯ã€æœ€ã‚‚è¿‘ã„ $k$ å€‹ã®è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®å¤šæ•°æ±ºã§åˆ†é¡ã—ã¾ã™ã€‚</p>

<h3>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h3>

<ol>
<li>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ $\mathbf{x}$ ã«å¯¾ã—ã¦ã€è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ã®è·é›¢ã‚’è¨ˆç®—</li>
<li>æœ€ã‚‚è¿‘ã„ $k$ å€‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’é¸æŠ</li>
<li>å¤šæ•°æ±ºã§æœ€ã‚‚å¤šã„ã‚¯ãƒ©ã‚¹ã‚’äºˆæ¸¬</li>
</ol>

<h3>è·é›¢ã®ç¨®é¡</h3>

<table>
<thead>
<tr>
<th>è·é›¢</th>
<th>æ•°å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢</strong></td>
<td>$\sqrt{\sum_{i=1}^{n} (x_i - y_i)^2}$</td>
</tr>
<tr>
<td><strong>ãƒãƒ³ãƒãƒƒã‚¿ãƒ³è·é›¢</strong></td>
<td>$\sum_{i=1}^{n} |x_i - y_i|$</td>
</tr>
<tr>
<td><strong>ãƒŸãƒ³ã‚³ãƒ•ã‚¹ã‚­ãƒ¼è·é›¢</strong></td>
<td>$\left(\sum_{i=1}^{n} |x_i - y_i|^p\right)^{1/p}$</td>
</tr>
</tbody>
</table>

<h3>å®Ÿè£…ä¾‹</h3>

<pre><code class="language-python">from sklearn.neighbors import KNeighborsClassifier

# k-NNãƒ¢ãƒ‡ãƒ«
knn_model = KNeighborsClassifier(n_neighbors=5)
knn_model.fit(X_train, y_train)

# äºˆæ¸¬
y_pred_knn = knn_model.predict(X_test)

print("=== k-NN (k=5) ===")
print(f"ç²¾åº¦: {accuracy_score(y_test, y_pred_knn):.4f}")

# æ±ºå®šå¢ƒç•Œ
plot_decision_boundary(knn_model, X_test, y_test)
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>=== k-NN (k=5) ===
ç²¾åº¦: 0.9400
</code></pre>

<h3>kã®é¸æŠ</h3>

<pre><code class="language-python"># ç•°ãªã‚‹kã§ã®ç²¾åº¦æ¯”è¼ƒ
k_range = range(1, 31)
train_scores = []
test_scores = []

for k in k_range:
    knn = KNeighborsClassifier(n_neighbors=k)
    knn.fit(X_train, y_train)

    train_scores.append(knn.score(X_train, y_train))
    test_scores.append(knn.score(X_test, y_test))

plt.figure(figsize=(10, 6))
plt.plot(k_range, train_scores, 'o-', label='è¨“ç·´ãƒ‡ãƒ¼ã‚¿', linewidth=2)
plt.plot(k_range, test_scores, 's-', label='ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿', linewidth=2)
plt.xlabel('k (è¿‘å‚æ•°)', fontsize=12)
plt.ylabel('ç²¾åº¦', fontsize=12)
plt.title('k-NN: kã®å€¤ã¨ç²¾åº¦ã®é–¢ä¿‚', fontsize=14)
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()

best_k = k_range[np.argmax(test_scores)]
print(f"\næœ€é©ãªk: {best_k}")
print(f"æœ€é«˜ç²¾åº¦: {max(test_scores):.4f}")
</code></pre>

<hr>

<h2>2.5 ã‚µãƒãƒ¼ãƒˆãƒ™ã‚¯ã‚¿ãƒ¼ãƒã‚·ãƒ³ï¼ˆSVMï¼‰</h2>

<h3>æ¦‚è¦</h3>

<p><strong>SVM</strong>ã¯ã€ãƒãƒ¼ã‚¸ãƒ³ã‚’æœ€å¤§åŒ–ã™ã‚‹æ±ºå®šå¢ƒç•Œã‚’è¦‹ã¤ã‘ã¾ã™ã€‚</p>

<div class="mermaid">
graph LR
    A[SVM] --> B[ç·šå½¢SVM]
    A --> C[éç·šå½¢SVM ã‚«ãƒ¼ãƒãƒ«æ³•]

    B --> B1[ç·šå½¢åˆ†é›¢å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿]
    C --> C1[RBFã‚«ãƒ¼ãƒãƒ«]
    C --> C2[å¤šé …å¼ã‚«ãƒ¼ãƒãƒ«]
    C --> C3[ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰ã‚«ãƒ¼ãƒãƒ«]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5
</div>

<h3>ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–</h3>

<p>$$
\text{maximize} \quad \frac{2}{||\mathbf{w}||} \quad \text{subject to} \quad y^{(i)}(\mathbf{w}^T \mathbf{x}^{(i)} + b) \geq 1
$$</p>

<h3>ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯</h3>

<p><strong>RBFï¼ˆã‚¬ã‚¦ã‚·ã‚¢ãƒ³ï¼‰ã‚«ãƒ¼ãƒãƒ«</strong>ï¼š</p>

<p>$$
K(\mathbf{x}, \mathbf{x}') = \exp\left(-\frac{||\mathbf{x} - \mathbf{x}'||^2}{2\sigma^2}\right)
$$</p>

<h3>å®Ÿè£…ä¾‹</h3>

<pre><code class="language-python">from sklearn.svm import SVC

# ç·šå½¢SVM
svm_linear = SVC(kernel='linear')
svm_linear.fit(X_train, y_train)

# RBF SVM
svm_rbf = SVC(kernel='rbf', gamma='auto')
svm_rbf.fit(X_train, y_train)

print("=== SVM (ç·šå½¢ã‚«ãƒ¼ãƒãƒ«) ===")
print(f"ç²¾åº¦: {svm_linear.score(X_test, y_test):.4f}")

print("\n=== SVM (RBFã‚«ãƒ¼ãƒãƒ«) ===")
print(f"ç²¾åº¦: {svm_rbf.score(X_test, y_test):.4f}")

# æ±ºå®šå¢ƒç•Œã®æ¯”è¼ƒ
fig, axes = plt.subplots(1, 2, figsize=(16, 6))

for ax, model, title in zip(axes, [svm_linear, svm_rbf],
                            ['ç·šå½¢SVM', 'RBF SVM']):
    h = 0.02
    x_min, x_max = X_test[:, 0].min() - 1, X_test[:, 0].max() + 1
    y_min, y_max = X_test[:, 1].min() - 1, X_test[:, 1].max() + 1
    xx, yy = np.meshgrid(np.arange(x_min, x_max, h),
                        np.arange(y_min, y_max, h))

    Z = model.predict(np.c_[xx.ravel(), yy.ravel()])
    Z = Z.reshape(xx.shape)

    ax.contourf(xx, yy, Z, alpha=0.3, cmap='RdYlBu')
    ax.scatter(X_test[y_test==0, 0], X_test[y_test==0, 1],
              c='blue', marker='o', edgecolors='k', s=80, label='ã‚¯ãƒ©ã‚¹ 0')
    ax.scatter(X_test[y_test==1, 0], X_test[y_test==1, 1],
              c='red', marker='s', edgecolors='k', s=80, label='ã‚¯ãƒ©ã‚¹ 1')
    ax.set_xlabel('ç‰¹å¾´é‡ 1')
    ax.set_ylabel('ç‰¹å¾´é‡ 2')
    ax.set_title(title, fontsize=14)
    ax.legend()

plt.tight_layout()
plt.show()
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>=== SVM (ç·šå½¢ã‚«ãƒ¼ãƒãƒ«) ===
ç²¾åº¦: 0.9550

=== SVM (RBFã‚«ãƒ¼ãƒãƒ«) ===
ç²¾åº¦: 0.9650
</code></pre>

<hr>

<h2>2.6 åˆ†é¡ãƒ¢ãƒ‡ãƒ«ã®è©•ä¾¡</h2>

<h3>æ··åŒè¡Œåˆ—ï¼ˆConfusion Matrixï¼‰</h3>

<table>
<thead>
<tr>
<th></th>
<th>äºˆæ¸¬: é™½æ€§</th>
<th>äºˆæ¸¬: é™°æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å®Ÿéš›: é™½æ€§</strong></td>
<td>TP (çœŸé™½æ€§)</td>
<td>FN (å½é™°æ€§)</td>
</tr>
<tr>
<td><strong>å®Ÿéš›: é™°æ€§</strong></td>
<td>FP (å½é™½æ€§)</td>
<td>TN (çœŸé™°æ€§)</td>
</tr>
</tbody>
</table>

<h3>è©•ä¾¡æŒ‡æ¨™</h3>

<table>
<thead>
<tr>
<th>æŒ‡æ¨™</th>
<th>æ•°å¼</th>
<th>æ„å‘³</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ç²¾åº¦</strong><br>(Accuracy)</td>
<td>$\frac{TP + TN}{TP + TN + FP + FN}$</td>
<td>å…¨ä½“ã®æ­£è§£ç‡</td>
</tr>
<tr>
<td><strong>é©åˆç‡</strong><br>(Precision)</td>
<td>$\frac{TP}{TP + FP}$</td>
<td>é™½æ€§äºˆæ¸¬ã®æ­£ç¢ºã•</td>
</tr>
<tr>
<td><strong>å†ç¾ç‡</strong><br>(Recall)</td>
<td>$\frac{TP}{TP + FN}$</td>
<td>å®Ÿéš›ã®é™½æ€§ã‚’æ•æ‰ã™ã‚‹ç‡</td>
</tr>
<tr>
<td><strong>F1ã‚¹ã‚³ã‚¢</strong></td>
<td>$2 \cdot \frac{\text{Precision} \cdot \text{Recall}}{\text{Precision} + \text{Recall}}$</td>
<td>Precisionã¨Recallã®èª¿å’Œå¹³å‡</td>
</tr>
</tbody>
</table>

<h3>å®Ÿè£…ä¾‹</h3>

<pre><code class="language-python">from sklearn.metrics import confusion_matrix, classification_report
import seaborn as sns

# æ··åŒè¡Œåˆ—
cm = confusion_matrix(y_test, y_pred)

plt.figure(figsize=(8, 6))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues',
            xticklabels=['ã‚¯ãƒ©ã‚¹ 0', 'ã‚¯ãƒ©ã‚¹ 1'],
            yticklabels=['ã‚¯ãƒ©ã‚¹ 0', 'ã‚¯ãƒ©ã‚¹ 1'])
plt.xlabel('äºˆæ¸¬', fontsize=12)
plt.ylabel('å®Ÿéš›', fontsize=12)
plt.title('æ··åŒè¡Œåˆ—', fontsize=14)
plt.show()

# è©³ç´°ãªè©•ä¾¡ãƒ¬ãƒãƒ¼ãƒˆ
print("\n=== åˆ†é¡ãƒ¬ãƒãƒ¼ãƒˆ ===")
print(classification_report(y_test, y_pred,
                          target_names=['ã‚¯ãƒ©ã‚¹ 0', 'ã‚¯ãƒ©ã‚¹ 1']))
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>=== åˆ†é¡ãƒ¬ãƒãƒ¼ãƒˆ ===
              precision    recall  f1-score   support

    ã‚¯ãƒ©ã‚¹ 0       0.96      0.95      0.95        99
    ã‚¯ãƒ©ã‚¹ 1       0.95      0.96      0.96       101

    accuracy                           0.96       200
   macro avg       0.96      0.96      0.96       200
weighted avg       0.96      0.96      0.96       200
</code></pre>

<h3>ROCæ›²ç·šã¨AUC</h3>

<p><strong>ROCï¼ˆReceiver Operating Characteristicï¼‰æ›²ç·š</strong>ã¯ã€é–¾å€¤ã‚’å¤‰ãˆãŸã¨ãã®TPRï¼ˆçœŸé™½æ€§ç‡ï¼‰ã¨FPRï¼ˆå½é™½æ€§ç‡ï¼‰ã®é–¢ä¿‚ã‚’ç¤ºã—ã¾ã™ã€‚</p>

<p>$$
\text{TPR} = \frac{TP}{TP + FN}, \quad \text{FPR} = \frac{FP}{FP + TN}
$$</p>

<pre><code class="language-python">from sklearn.metrics import roc_curve, roc_auc_score

# ROCæ›²ç·šã®è¨ˆç®—
fpr, tpr, thresholds = roc_curve(y_test, y_proba[:, 1])
auc = roc_auc_score(y_test, y_proba[:, 1])

plt.figure(figsize=(10, 6))
plt.plot(fpr, tpr, linewidth=2, label=f'ROCæ›²ç·š (AUC = {auc:.4f})')
plt.plot([0, 1], [0, 1], 'k--', linewidth=2, label='ãƒ©ãƒ³ãƒ€ãƒ  (AUC = 0.5)')
plt.xlabel('å½é™½æ€§ç‡ (FPR)', fontsize=12)
plt.ylabel('çœŸé™½æ€§ç‡ (TPR)', fontsize=12)
plt.title('ROCæ›²ç·š', fontsize=14)
plt.legend(fontsize=12)
plt.grid(True, alpha=0.3)
plt.show()

print(f"AUC: {auc:.4f}")
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>AUC: 0.9876
</code></pre>

<blockquote>
<p><strong>AUCï¼ˆArea Under the Curveï¼‰</strong>: ROCæ›²ç·šã®ä¸‹ã®é¢ç©ã€‚1ã«è¿‘ã„ã»ã©è‰¯ã„ãƒ¢ãƒ‡ãƒ«ã€‚</p>
</blockquote>

<hr>

<h2>2.7 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><p><strong>åˆ†é¡å•é¡Œã®å®šç¾©</strong></p>
<ul>
<li>é›¢æ•£å€¤ï¼ˆã‚«ãƒ†ã‚´ãƒªï¼‰ã®äºˆæ¸¬ã‚¿ã‚¹ã‚¯</li>
<li>äºŒå€¤åˆ†é¡ã€å¤šã‚¯ãƒ©ã‚¹åˆ†é¡ã€å¤šãƒ©ãƒ™ãƒ«åˆ†é¡</li>
</ul></li>
<li><p><strong>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</strong></p>
<ul>
<li>ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ã«ã‚ˆã‚‹ç¢ºç‡å‡ºåŠ›</li>
<li>äº¤å·®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼æå¤±</li>
</ul></li>
<li><p><strong>æ±ºå®šæœ¨</strong></p>
<ul>
<li>if-then-elseãƒ«ãƒ¼ãƒ«ã®éšå±¤æ§‹é€ </li>
<li>ã‚¸ãƒ‹ä¸ç´”åº¦ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</li>
<li>ç‰¹å¾´é‡é‡è¦åº¦</li>
</ul></li>
<li><p><strong>k-NN</strong></p>
<ul>
<li>æœ€è¿‘å‚ã®å¤šæ•°æ±º</li>
<li>kã®é¸æŠã®é‡è¦æ€§</li>
</ul></li>
<li><p><strong>SVM</strong></p>
<ul>
<li>ãƒãƒ¼ã‚¸ãƒ³æœ€å¤§åŒ–</li>
<li>ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯</li>
</ul></li>
<li><p><strong>è©•ä¾¡æŒ‡æ¨™</strong></p>
<ul>
<li>æ··åŒè¡Œåˆ—ã€ç²¾åº¦ã€é©åˆç‡ã€å†ç¾ç‡ã€F1ã‚¹ã‚³ã‚¢</li>
<li>ROCæ›²ç·šã¨AUC</li>
</ul></li>
</ol>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬3ç« ã§ã¯ã€<strong>ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«æ‰‹æ³•</strong>ã‚’å­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>Baggingã®åŸç†</li>
<li>Random Forest</li>
<li>Boostingï¼ˆGradient Boostingã€XGBoostã€LightGBMã€CatBoostï¼‰</li>
</ul>

<hr>

<h2>æ¼”ç¿’å•é¡Œ</h2>

<h3>å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰</h3>
<p>ç²¾åº¦ï¼ˆAccuracyï¼‰ãŒé«˜ãã¦ã‚‚ä¸é©åˆ‡ãªå ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã©ã®ã‚ˆã†ãªçŠ¶æ³ã‹èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>è§£ç­”</strong>ï¼š</p>
<p><strong>ä¸å‡è¡¡ãƒ‡ãƒ¼ã‚¿ï¼ˆImbalanced Dataï¼‰</strong>ã®å ´åˆã€ç²¾åº¦ã¯ä¸é©åˆ‡ã§ã™ã€‚</p>

<p><strong>ä¾‹</strong>ï¼š</p>
<ul>
<li>ãŒã‚“è¨ºæ–­ãƒ‡ãƒ¼ã‚¿: é™½æ€§1%ã€é™°æ€§99%</li>
<li>ã™ã¹ã¦ã€Œé™°æ€§ã€ã¨äºˆæ¸¬ã™ã‚‹ã¨ç²¾åº¦99%ã ãŒã€æ„å‘³ãŒãªã„</li>
<li>é™½æ€§ã‚’è¦‹é€ƒã™ã¨é‡å¤§ãªçµæœã«</li>
</ul>

<p><strong>é©åˆ‡ãªæŒ‡æ¨™</strong>ï¼š</p>
<ul>
<li>å†ç¾ç‡ï¼ˆRecallï¼‰: é™½æ€§ã‚’è¦‹é€ƒã•ãªã„</li>
<li>F1ã‚¹ã‚³ã‚¢: Precisionã¨Recallã®ãƒãƒ©ãƒ³ã‚¹</li>
<li>AUC: é–¾å€¤ã«ä¾å­˜ã—ãªã„è©•ä¾¡</li>
</ul>

</details>

<h3>å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>
<p>ä»¥ä¸‹ã®æ··åŒè¡Œåˆ—ã‹ã‚‰ã€ç²¾åº¦ã€é©åˆç‡ã€å†ç¾ç‡ã€F1ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>

<table>
<thead>
<tr>
<th></th>
<th>äºˆæ¸¬: é™½æ€§</th>
<th>äºˆæ¸¬: é™°æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td>å®Ÿéš›: é™½æ€§</td>
<td>80</td>
<td>20</td>
</tr>
<tr>
<td>å®Ÿéš›: é™°æ€§</td>
<td>10</td>
<td>90</td>
</tr>
</tbody>
</table>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>è§£ç­”</strong>ï¼š</p>

<pre><code>TP = 80, FN = 20, FP = 10, TN = 90

ç²¾åº¦ (Accuracy) = (TP + TN) / (TP + TN + FP + FN)
                = (80 + 90) / (80 + 90 + 10 + 20)
                = 170 / 200 = 0.85 = 85%

é©åˆç‡ (Precision) = TP / (TP + FP)
                   = 80 / (80 + 10)
                   = 80 / 90 = 0.8889 = 88.89%

å†ç¾ç‡ (Recall) = TP / (TP + FN)
                = 80 / (80 + 20)
                = 80 / 100 = 0.80 = 80%

F1ã‚¹ã‚³ã‚¢ = 2 * (Precision * Recall) / (Precision + Recall)
        = 2 * (0.8889 * 0.80) / (0.8889 + 0.80)
        = 2 * 0.7111 / 1.6889
        = 0.8421 = 84.21%
</code></pre>

</details>

<h3>å•é¡Œ3ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>
<p>k-NNã§æœ€é©ãªkã‚’é¸ã¶éš›ã€kãŒå°ã•ã™ãã‚‹å ´åˆã¨å¤§ãã™ãã‚‹å ´åˆã®å•é¡Œã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>kãŒå°ã•ã™ãã‚‹å ´åˆï¼ˆä¾‹: k=1ï¼‰</strong>ï¼š</p>
<ul>
<li><strong>éå­¦ç¿’ï¼ˆOverfittingï¼‰</strong>: ãƒã‚¤ã‚ºã«æ•æ„Ÿ</li>
<li>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ç²¾åº¦ã¯é«˜ã„ãŒã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã®ç²¾åº¦ã¯ä½ã„</li>
<li>æ±ºå®šå¢ƒç•ŒãŒè¤‡é›‘ã§ã‚®ã‚¶ã‚®ã‚¶</li>
</ul>

<p><strong>kãŒå¤§ãã™ãã‚‹å ´åˆï¼ˆä¾‹: k=å…¨ãƒ‡ãƒ¼ã‚¿æ•°ï¼‰</strong>ï¼š</p>
<ul>
<li><strong>éåº¦ãªå˜ç´”åŒ–</strong>: ã™ã¹ã¦å¤šæ•°æ´¾ã‚¯ãƒ©ã‚¹ã«åˆ†é¡</li>
<li>æ±ºå®šå¢ƒç•ŒãŒå˜ç´”ã™ãã‚‹</li>
<li>è¨“ç·´ãƒ»ãƒ†ã‚¹ãƒˆä¸¡æ–¹ã®ç²¾åº¦ãŒä½ã„</li>
</ul>

<p><strong>æœ€é©ãªk</strong>ï¼š</p>
<ul>
<li>äº¤å·®æ¤œè¨¼ã§é¸æŠ</li>
<li>é€šå¸¸ $\sqrt{N}$ ä»˜è¿‘ï¼ˆ$N$ã¯ãƒ‡ãƒ¼ã‚¿æ•°ï¼‰</li>
<li>å¥‡æ•°ã‚’é¸ã¶ï¼ˆäºŒå€¤åˆ†é¡ã®åŒç¥¨ã‚’é¿ã‘ã‚‹ï¼‰</li>
</ul>

</details>

<h3>å•é¡Œ4ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>
<p>SVMã®ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯ã‚’ä½¿ã†æ„ç¾©ã‚’ã€è¨ˆç®—é‡ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯ã®æ„ç¾©</strong>ï¼š</p>

<p><strong>å•é¡Œ</strong>ï¼šéç·šå½¢åˆ†é›¢å¯èƒ½ãªãƒ‡ãƒ¼ã‚¿ã‚’åˆ†é¡ã™ã‚‹ã«ã¯ã€é«˜æ¬¡å…ƒç©ºé–“ã«å¤‰æ›ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚</p>

<p><strong>ç›´æ¥çš„ãªæ–¹æ³•</strong>ï¼š</p>
<ul>
<li>ç‰¹å¾´é‡ã‚’æ˜ç¤ºçš„ã«é«˜æ¬¡å…ƒã«å¤‰æ›: $\phi(\mathbf{x})$</li>
<li>è¨ˆç®—é‡: $O(d^2)$ ã¾ãŸã¯ $O(d^3)$ï¼ˆ$d$ã¯æ¬¡å…ƒï¼‰</li>
<li>æ¬¡å…ƒãŒé«˜ã„ã¨è¨ˆç®—ä¸å¯èƒ½</li>
</ul>

<p><strong>ã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯</strong>ï¼š</p>
<ul>
<li>å†…ç© $\langle \phi(\mathbf{x}), \phi(\mathbf{x}') \rangle$ ã‚’ã‚«ãƒ¼ãƒãƒ«é–¢æ•° $K(\mathbf{x}, \mathbf{x}')$ ã§ç›´æ¥è¨ˆç®—</li>
<li>é«˜æ¬¡å…ƒå¤‰æ›ã‚’æ˜ç¤ºçš„ã«è¡Œã‚ãªã„</li>
<li>è¨ˆç®—é‡: $O(d)$ï¼ˆå…ƒã®æ¬¡å…ƒã®ã¾ã¾ï¼‰</li>
</ul>

<p><strong>ä¾‹ï¼ˆRBFã‚«ãƒ¼ãƒãƒ«ï¼‰</strong>ï¼š</p>
<ul>
<li>ç„¡é™æ¬¡å…ƒã¸ã®å¤‰æ›ã‚’ $O(d)$ ã§è¨ˆç®—</li>
<li>$K(\mathbf{x}, \mathbf{x}') = \exp(-\gamma ||\mathbf{x} - \mathbf{x}'||^2)$</li>
</ul>

<p><strong>çµè«–</strong>ï¼šã‚«ãƒ¼ãƒãƒ«ãƒˆãƒªãƒƒã‚¯ã«ã‚ˆã‚Šã€é«˜æ¬¡å…ƒã§ã®è¨ˆç®—ã‚’ä½æ¬¡å…ƒã§åŠ¹ç‡çš„ã«å®Ÿè¡Œå¯èƒ½ã€‚</p>

</details>

<h3>å•é¡Œ5ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>
<p>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã‚’å®Ÿè£…ã—ã€irisãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®äºŒå€¤åˆ†é¡ï¼ˆsetosa vs versicolorï¼‰ã‚’è¡Œã£ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">import numpy as np
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import classification_report, confusion_matrix
import matplotlib.pyplot as plt
import seaborn as sns

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
iris = load_iris()
X = iris.data[iris.target != 2]  # setosa (0) ã¨ versicolor (1)ã®ã¿
y = iris.target[iris.target != 2]

# æœ€åˆã®2ã¤ã®ç‰¹å¾´é‡ã®ã¿ä½¿ç”¨ï¼ˆå¯è¦–åŒ–ã®ãŸã‚ï¼‰
X = X[:, :2]

# ãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# æ¨™æº–åŒ–
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_test_scaled = scaler.transform(X_test)

# ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°
model = LogisticRegression()
model.fit(X_train_scaled, y_train)

# äºˆæ¸¬
y_pred = model.predict(X_test_scaled)
y_proba = model.predict_proba(X_test_scaled)

# è©•ä¾¡
print("=== åˆ†é¡ãƒ¬ãƒãƒ¼ãƒˆ ===")
print(classification_report(y_test, y_pred,
                          target_names=['setosa', 'versicolor']))

# æ··åŒè¡Œåˆ—
cm = confusion_matrix(y_test, y_pred)
plt.figure(figsize=(8, 6))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues',
            xticklabels=['setosa', 'versicolor'],
            yticklabels=['setosa', 'versicolor'])
plt.xlabel('äºˆæ¸¬')
plt.ylabel('å®Ÿéš›')
plt.title('æ··åŒè¡Œåˆ—')
plt.show()

# æ±ºå®šå¢ƒç•Œã®å¯è¦–åŒ–
h = 0.02
x_min, x_max = X_train_scaled[:, 0].min() - 1, X_train_scaled[:, 0].max() + 1
y_min, y_max = X_train_scaled[:, 1].min() - 1, X_train_scaled[:, 1].max() + 1
xx, yy = np.meshgrid(np.arange(x_min, x_max, h),
                    np.arange(y_min, y_max, h))

Z = model.predict(np.c_[xx.ravel(), yy.ravel()])
Z = Z.reshape(xx.shape)

plt.figure(figsize=(10, 6))
plt.contourf(xx, yy, Z, alpha=0.3, cmap='RdYlBu')
plt.scatter(X_train_scaled[y_train==0, 0], X_train_scaled[y_train==0, 1],
           c='blue', marker='o', edgecolors='k', s=80, label='setosa')
plt.scatter(X_train_scaled[y_train==1, 0], X_train_scaled[y_train==1, 1],
           c='red', marker='s', edgecolors='k', s=80, label='versicolor')
plt.xlabel('Sepal length (æ¨™æº–åŒ–)')
plt.ylabel('Sepal width (æ¨™æº–åŒ–)')
plt.title('ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°ã®æ±ºå®šå¢ƒç•Œ')
plt.legend()
plt.show()

print(f"\nç²¾åº¦: {model.score(X_test_scaled, y_test):.4f}")
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>=== åˆ†é¡ãƒ¬ãƒãƒ¼ãƒˆ ===
              precision    recall  f1-score   support

      setosa       1.00      1.00      1.00        10
  versicolor       1.00      1.00      1.00        10

    accuracy                           1.00        20
   macro avg       1.00      1.00      1.00        20
weighted avg       1.00      1.00      1.00        20

ç²¾åº¦: 1.0000
</code></pre>

</details>

<hr>

<h2>å‚è€ƒæ–‡çŒ®</h2>

<ol>
<li>Hastie, T., Tibshirani, R., & Friedman, J. (2009). <em>The Elements of Statistical Learning</em>. Springer.</li>
<li>Murphy, K. P. (2012). <em>Machine Learning: A Probabilistic Perspective</em>. MIT Press.</li>
<li>James, G., Witten, D., Hastie, T., & Tibshirani, R. (2013). <em>An Introduction to Statistical Learning</em>. Springer.</li>
</ol>

<div class="navigation">
    <a href="chapter1-regression.html" class="nav-button">â† å‰ã®ç« : å›å¸°å•é¡Œã®åŸºç¤</a>
    <a href="chapter3-ensemble.html" class="nav-button">æ¬¡ã®ç« : ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«æ‰‹æ³• â†’</a>
</div>

    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-20</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
