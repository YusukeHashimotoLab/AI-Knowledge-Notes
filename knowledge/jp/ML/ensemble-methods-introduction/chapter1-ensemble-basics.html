<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« ï¼šã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ã®åŸºç¤ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../ML/index.html">æ©Ÿæ¢°å­¦ç¿’</a><span class="breadcrumb-separator">â€º</span><a href="../../ML/ensemble-methods-introduction/index.html">Ensemble Methods</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

        <header>
        <div class="header-content">
            <h1>ç¬¬1ç« ï¼šã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ã®åŸºç¤</h1>
            <p class="subtitle">è¤‡æ•°ãƒ¢ãƒ‡ãƒ«ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã‚‹äºˆæ¸¬ç²¾åº¦å‘ä¸Š - ãƒã‚®ãƒ³ã‚°ã€ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã€ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°ã®åŸç†</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 20-25åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 5å•</span>
            </div>
        </div>
    </header>

    <main class="container">

<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ã®åŸç†ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… ãƒã‚¤ã‚¢ã‚¹ãƒ»ãƒãƒªã‚¢ãƒ³ã‚¹åˆ†è§£ã®æ¦‚å¿µã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… ãƒã‚®ãƒ³ã‚°ï¼ˆRandom Forestã€Extra Treesï¼‰ã‚’å®Ÿè£…ã§ãã‚‹</li>
<li>âœ… ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°ï¼ˆAdaBoostã€Gradient Boostingï¼‰ã®ä»•çµ„ã¿ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°ã¨ãƒ¡ã‚¿å­¦ç¿’å™¨ã‚’ä½¿ã„ã“ãªã›ã‚‹</li>
<li>âœ… å„æ‰‹æ³•ã®ä½¿ã„åˆ†ã‘ãŒã§ãã‚‹</li>
</ul>

<hr>

<h2>1.1 ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ã¨ã¯</h2>

<h3>å®šç¾©</h3>
<p><strong>ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ï¼ˆEnsemble Learningï¼‰</strong>ã¯ã€è¤‡æ•°ã®å¼±å­¦ç¿’å™¨ï¼ˆweak learnerï¼‰ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ã‚ˆã‚Šå¼·åŠ›ãªäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã™ã‚‹æ©Ÿæ¢°å­¦ç¿’æ‰‹æ³•ã§ã™ã€‚</p>

<blockquote>
<p>ã€Œè¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ«ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€å˜ä¸€ãƒ¢ãƒ‡ãƒ«ã‚ˆã‚Šé«˜ã„æ€§èƒ½ã‚’å®Ÿç¾ã™ã‚‹ã€</p>
</blockquote>

<h3>ãªãœè¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ«ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã®ã‹</h3>

<div class="mermaid">
graph LR
    A[å˜ä¸€ãƒ¢ãƒ‡ãƒ«ã®é™ç•Œ] --> B[éå­¦ç¿’ã—ã‚„ã™ã„]
    A --> C[ãƒã‚¤ã‚¢ã‚¹ãŒé«˜ã„]
    A --> D[ãƒã‚¤ã‚ºã«æ•æ„Ÿ]

    E[ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«] --> F[åˆ†æ•£ã‚’æ¸›ã‚‰ã™]
    E --> G[ãƒã‚¤ã‚¢ã‚¹ã‚’æ¸›ã‚‰ã™]
    E --> H[å®‰å®šæ€§å‘ä¸Š]

    style A fill:#ffebee
    style E fill:#e8f5e9
</div>

<h3>ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã®åŠ¹æœ</h3>

<p><strong>ä¾‹</strong>ï¼š3ã¤ã®ãƒ¢ãƒ‡ãƒ«ãŒãã‚Œãã‚Œ70%ã®ç²¾åº¦ã§ç‹¬ç«‹ã«äºˆæ¸¬ã™ã‚‹å ´åˆ</p>

<p>å¤šæ•°æ±ºã«ã‚ˆã‚‹ç²¾åº¦ï¼š</p>

<p>$$
P(\text{æ­£è§£}) = P(\text{2ã¤ä»¥ä¸Šæ­£è§£}) = \binom{3}{2}(0.7)^2(0.3) + \binom{3}{3}(0.7)^3 = 0.784
$$</p>

<p>å˜ä¸€ãƒ¢ãƒ‡ãƒ«ï¼ˆ70%ï¼‰ã‚ˆã‚Šé«˜ã„ç²¾åº¦ï¼ˆ78.4%ï¼‰ã‚’é”æˆï¼</p>

<h3>ãƒã‚¤ã‚¢ã‚¹ãƒ»ãƒãƒªã‚¢ãƒ³ã‚¹åˆ†è§£</h3>

<p>äºˆæ¸¬èª¤å·®ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«åˆ†è§£ã•ã‚Œã¾ã™ï¼š</p>

<p>$$
\text{Error} = \text{Bias}^2 + \text{Variance} + \text{Irreducible Error}
$$</p>

<table>
<thead>
<tr>
<th>è¦ç´ </th>
<th>æ„å‘³</th>
<th>å¯¾ç­–</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ãƒã‚¤ã‚¢ã‚¹</strong></td>
<td>ãƒ¢ãƒ‡ãƒ«ã®å˜ç´”åŒ–ã«ã‚ˆã‚‹èª¤å·®</td>
<td>è¤‡é›‘ãªãƒ¢ãƒ‡ãƒ«ã€ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°</td>
</tr>
<tr>
<td><strong>ãƒãƒªã‚¢ãƒ³ã‚¹</strong></td>
<td>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®å¤‰å‹•ã¸ã®æ•æ„Ÿã•</td>
<td>ãƒã‚®ãƒ³ã‚°ã€å¹³å‡åŒ–</td>
</tr>
<tr>
<td><strong>æ—¢ç´„èª¤å·®</strong></td>
<td>ãƒ‡ãƒ¼ã‚¿ã«å«ã¾ã‚Œã‚‹ãƒã‚¤ã‚º</td>
<td>å‰Šæ¸›ä¸å¯èƒ½</td>
</tr>
</tbody>
</table>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_regression
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeRegressor

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
X, y = make_regression(n_samples=100, n_features=1, noise=10, random_state=42)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# ç•°ãªã‚‹æ·±ã•ã®æ±ºå®šæœ¨ã§äºˆæ¸¬
depths = [1, 3, 10]
plt.figure(figsize=(15, 4))

for i, depth in enumerate(depths, 1):
    model = DecisionTreeRegressor(max_depth=depth, random_state=42)
    model.fit(X_train, y_train)

    X_plot = np.linspace(X.min(), X.max(), 300).reshape(-1, 1)
    y_pred = model.predict(X_plot)

    plt.subplot(1, 3, i)
    plt.scatter(X_train, y_train, alpha=0.5, label='è¨“ç·´ãƒ‡ãƒ¼ã‚¿')
    plt.plot(X_plot, y_pred, 'r-', linewidth=2, label=f'æ·±ã•={depth}')
    plt.xlabel('X')
    plt.ylabel('y')
    plt.title(f'æ·±ã•={depth}: {"é«˜ãƒã‚¤ã‚¢ã‚¹" if depth==1 else "é«˜ãƒãƒªã‚¢ãƒ³ã‚¹" if depth==10 else "ãƒãƒ©ãƒ³ã‚¹"}')
    plt.legend()
    plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
</code></pre>

<hr>

<h2>1.2 ãƒã‚®ãƒ³ã‚°ï¼ˆBaggingï¼‰</h2>

<h3>æ¦‚è¦</h3>

<p><strong>ãƒã‚®ãƒ³ã‚°ï¼ˆBootstrap Aggregatingï¼‰</strong>ã¯ã€è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã—ã¦è¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã—ã€äºˆæ¸¬ã‚’å¹³å‡åŒ–ï¼ˆå›å¸°ï¼‰ã¾ãŸã¯å¤šæ•°æ±ºï¼ˆåˆ†é¡ï¼‰ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚</p>

<h3>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h3>

<ol>
<li>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰<strong>ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒ«</strong>ã‚’ $B$ å€‹ç”Ÿæˆ</li>
<li>å„ã‚µãƒ³ãƒ—ãƒ«ã§ç‹¬ç«‹ã«ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´</li>
<li>äºˆæ¸¬ã‚’é›†ç´„ï¼š
<ul>
<li>å›å¸°: $\hat{y} = \frac{1}{B}\sum_{b=1}^{B} \hat{f}_b(x)$</li>
<li>åˆ†é¡: å¤šæ•°æ±º</li>
</ul></li>
</ol>

<div class="mermaid">
graph TD
    A[è¨“ç·´ãƒ‡ãƒ¼ã‚¿] --> B1[ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—1]
    A --> B2[ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—2]
    A --> B3[ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—3]

    B1 --> M1[ãƒ¢ãƒ‡ãƒ«1]
    B2 --> M2[ãƒ¢ãƒ‡ãƒ«2]
    B3 --> M3[ãƒ¢ãƒ‡ãƒ«3]

    M1 --> AGG[é›†ç´„]
    M2 --> AGG
    M3 --> AGG

    AGG --> PRED[æœ€çµ‚äºˆæ¸¬]

    style A fill:#e3f2fd
    style AGG fill:#fff3e0
    style PRED fill:#e8f5e9
</div>

<h3>Random Forest</h3>

<p><strong>Random Forest</strong>ã¯ã€ãƒã‚®ãƒ³ã‚° + ãƒ©ãƒ³ãƒ€ãƒ ç‰¹å¾´é‡é¸æŠã‚’çµ„ã¿åˆã‚ã›ãŸæ‰‹æ³•ã§ã™ã€‚</p>

<p><strong>ç‰¹å¾´</strong>ï¼š</p>
<ul>
<li>å„åˆ†å‰²ã§ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã‚“ã ç‰¹å¾´é‡ã®ã‚µãƒ–ã‚»ãƒƒãƒˆã‹ã‚‰æœ€é©ãªåˆ†å‰²ã‚’é¸æŠ</li>
<li>ãƒ¢ãƒ‡ãƒ«é–“ã®ç›¸é–¢ã‚’æ¸›ã‚‰ã—ã€å¤šæ§˜æ€§ã‚’å‘ä¸Š</li>
</ul>

<pre><code class="language-python">from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
X, y = make_classification(n_samples=1000, n_features=20, n_informative=15,
                          n_redundant=5, random_state=42)
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# å˜ä¸€ã®æ±ºå®šæœ¨
dt = DecisionTreeClassifier(random_state=42)
dt.fit(X_train, y_train)
dt_acc = accuracy_score(y_test, dt.predict(X_test))

# Random Forest
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)
rf_acc = accuracy_score(y_test, rf.predict(X_test))

print("=== ãƒã‚®ãƒ³ã‚°ã®åŠ¹æœ ===")
print(f"æ±ºå®šæœ¨ï¼ˆå˜ä¸€ï¼‰: {dt_acc:.4f}")
print(f"Random Forest: {rf_acc:.4f}")
print(f"æ”¹å–„: {(rf_acc - dt_acc):.4f}")
</code></pre>

<p><strong>å‡ºåŠ›</strong>ï¼š</p>
<pre><code>=== ãƒã‚®ãƒ³ã‚°ã®åŠ¹æœ ===
æ±ºå®šæœ¨ï¼ˆå˜ä¸€ï¼‰: 0.8600
Random Forest: 0.9250
æ”¹å–„: 0.0650
</code></pre>

<h3>Extra Trees</h3>

<p><strong>Extra Treesï¼ˆExtremely Randomized Treesï¼‰</strong>ã¯ã€Random Forestã®ã•ã‚‰ã«ãƒ©ãƒ³ãƒ€ãƒ åŒ–ã•ã‚ŒãŸãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã™ã€‚</p>

<p><strong>ç›¸é•ç‚¹</strong>ï¼š</p>
<ul>
<li>åˆ†å‰²ã®é–¾å€¤ã‚‚ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠ</li>
<li>ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã‚’ä½¿ã‚ãªã„ï¼ˆå…¨ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰</li>
</ul>

<pre><code class="language-python">from sklearn.ensemble import ExtraTreesClassifier

# Extra Trees
et = ExtraTreesClassifier(n_estimators=100, random_state=42)
et.fit(X_train, y_train)
et_acc = accuracy_score(y_test, et.predict(X_test))

print("=== Extra Trees vs Random Forest ===")
print(f"Random Forest: {rf_acc:.4f}")
print(f"Extra Trees: {et_acc:.4f}")
</code></pre>

<hr>

<h2>1.3 ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°ï¼ˆBoostingï¼‰</h2>

<h3>æ¦‚è¦</h3>

<p><strong>ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°</strong>ã¯ã€å¼±å­¦ç¿’å™¨ã‚’é †æ¬¡è¨“ç·´ã—ã€å‰ã®ãƒ¢ãƒ‡ãƒ«ã®èª¤ã‚Šã‚’æ¬¡ã®ãƒ¢ãƒ‡ãƒ«ã§ä¿®æ­£ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚</p>

<div class="mermaid">
graph LR
    A[ãƒ‡ãƒ¼ã‚¿] --> M1[ãƒ¢ãƒ‡ãƒ«1]
    M1 --> W1[é‡ã¿æ›´æ–°]
    W1 --> M2[ãƒ¢ãƒ‡ãƒ«2]
    M2 --> W2[é‡ã¿æ›´æ–°]
    W2 --> M3[ãƒ¢ãƒ‡ãƒ«3]
    M3 --> F[åŠ é‡å’Œ]

    style A fill:#e3f2fd
    style F fill:#e8f5e9
</div>

<h3>AdaBoost</h3>

<p><strong>AdaBoostï¼ˆAdaptive Boostingï¼‰</strong>ã¯ã€èª¤åˆ†é¡ã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã®é‡ã¿ã‚’å¢—ã‚„ã—ãªãŒã‚‰é †æ¬¡ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã—ã¾ã™ã€‚</p>

<p><strong>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong>ï¼š</p>

<ol>
<li>ã™ã¹ã¦ã®ã‚µãƒ³ãƒ—ãƒ«ã®é‡ã¿ $w_i = \frac{1}{m}$ ã§åˆæœŸåŒ–</li>
<li>å„åå¾© $t = 1, ..., T$:
<ul>
<li>é‡ã¿ä»˜ããƒ‡ãƒ¼ã‚¿ã§å¼±å­¦ç¿’å™¨ $h_t$ ã‚’è¨“ç·´</li>
<li>èª¤å·®ç‡ $\epsilon_t = \sum_{i: h_t(x_i) \neq y_i} w_i$</li>
<li>ãƒ¢ãƒ‡ãƒ«é‡ã¿ $\alpha_t = \frac{1}{2}\ln\frac{1-\epsilon_t}{\epsilon_t}$</li>
<li>ã‚µãƒ³ãƒ—ãƒ«é‡ã¿æ›´æ–°</li>
</ul></li>
<li>æœ€çµ‚äºˆæ¸¬: $H(x) = \text{sign}\left(\sum_{t=1}^{T} \alpha_t h_t(x)\right)$</li>
</ol>

<pre><code class="language-python">from sklearn.ensemble import AdaBoostClassifier

# AdaBoost
ada = AdaBoostClassifier(n_estimators=100, random_state=42)
ada.fit(X_train, y_train)
ada_acc = accuracy_score(y_test, ada.predict(X_test))

print("=== AdaBoost ===")
print(f"ç²¾åº¦: {ada_acc:.4f}")

# åå¾©ã”ã¨ã®ç²¾åº¦æ¨ç§»
from sklearn.metrics import accuracy_score

n_trees = [1, 5, 10, 25, 50, 100]
train_scores = []
test_scores = []

for n in n_trees:
    ada_temp = AdaBoostClassifier(n_estimators=n, random_state=42)
    ada_temp.fit(X_train, y_train)
    train_scores.append(ada_temp.score(X_train, y_train))
    test_scores.append(ada_temp.score(X_test, y_test))

plt.figure(figsize=(10, 6))
plt.plot(n_trees, train_scores, 'o-', label='è¨“ç·´ãƒ‡ãƒ¼ã‚¿', linewidth=2)
plt.plot(n_trees, test_scores, 's-', label='ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿', linewidth=2)
plt.xlabel('å¼±å­¦ç¿’å™¨ã®æ•°', fontsize=12)
plt.ylabel('ç²¾åº¦', fontsize=12)
plt.title('AdaBoost: å­¦ç¿’å™¨æ•°ã¨ç²¾åº¦ã®é–¢ä¿‚', fontsize=14)
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()
</code></pre>

<h3>Gradient BoostingåŸºç¤</h3>

<p><strong>Gradient Boosting</strong>ã¯ã€æå¤±é–¢æ•°ã®å‹¾é…æ–¹å‘ã«ãƒ¢ãƒ‡ãƒ«ã‚’è¿½åŠ ã—ã¦ã„ãæ‰‹æ³•ã§ã™ã€‚</p>

<p><strong>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong>ï¼š</p>

<ol>
<li>åˆæœŸäºˆæ¸¬ $F_0(x) = \arg\min_{\gamma} \sum_{i=1}^{m} L(y_i, \gamma)$</li>
<li>å„åå¾© $t = 1, ..., T$:
<ul>
<li>æ®‹å·®ï¼ˆè² ã®å‹¾é…ï¼‰ã‚’è¨ˆç®—: $r_i = -\frac{\partial L(y_i, F_{t-1}(x_i))}{\partial F_{t-1}(x_i)}$</li>
<li>æ®‹å·®ã«å¯¾ã—ã¦å¼±å­¦ç¿’å™¨ $h_t$ ã‚’è¨“ç·´</li>
<li>ãƒ¢ãƒ‡ãƒ«æ›´æ–°: $F_t(x) = F_{t-1}(x) + \nu \cdot h_t(x)$</li>
</ul></li>
</ol>

<pre><code class="language-python">from sklearn.ensemble import GradientBoostingClassifier

# Gradient Boosting
gb = GradientBoostingClassifier(n_estimators=100, learning_rate=0.1,
                                max_depth=3, random_state=42)
gb.fit(X_train, y_train)
gb_acc = accuracy_score(y_test, gb.predict(X_test))

print("=== Gradient Boosting ===")
print(f"ç²¾åº¦: {gb_acc:.4f}")
</code></pre>

<hr>

<h2>1.4 ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°ï¼ˆStackingï¼‰</h2>

<h3>æ¦‚è¦</h3>

<p><strong>ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°</strong>ã¯ã€è¤‡æ•°ã®ç•°ãªã‚‹ãƒ¢ãƒ‡ãƒ«ï¼ˆãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ï¼‰ã®äºˆæ¸¬ã‚’å…¥åŠ›ã¨ã—ã¦ã€ãƒ¡ã‚¿å­¦ç¿’å™¨ãŒæœ€çµ‚äºˆæ¸¬ã‚’è¡Œã†æ‰‹æ³•ã§ã™ã€‚</p>

<div class="mermaid">
graph TD
    A[è¨“ç·´ãƒ‡ãƒ¼ã‚¿] --> M1[ãƒ¢ãƒ‡ãƒ«1: ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°]
    A --> M2[ãƒ¢ãƒ‡ãƒ«2: Random Forest]
    A --> M3[ãƒ¢ãƒ‡ãƒ«3: SVM]

    M1 --> P1[äºˆæ¸¬1]
    M2 --> P2[äºˆæ¸¬2]
    M3 --> P3[äºˆæ¸¬3]

    P1 --> META[ãƒ¡ã‚¿å­¦ç¿’å™¨]
    P2 --> META
    P3 --> META

    META --> FINAL[æœ€çµ‚äºˆæ¸¬]

    style A fill:#e3f2fd
    style META fill:#fff3e0
    style FINAL fill:#e8f5e9
</div>

<h3>ãƒ¡ã‚¿å­¦ç¿’å™¨</h3>

<p>ãƒ¡ã‚¿å­¦ç¿’å™¨ï¼ˆMeta-learnerï¼‰ã¯ã€ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬ã‚’ç‰¹å¾´é‡ã¨ã—ã¦å­¦ç¿’ã—ã¾ã™ã€‚</p>

<p><strong>ä¸€èˆ¬çš„ãªãƒ¡ã‚¿å­¦ç¿’å™¨</strong>ï¼š</p>
<ul>
<li>ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯å›å¸°</li>
<li>Ridgeå›å¸°</li>
<li>ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯</li>
</ul>

<h3>äº¤å·®æ¤œè¨¼æˆ¦ç•¥</h3>

<p>éå­¦ç¿’ã‚’é˜²ããŸã‚ã€<strong>K-Foldäº¤å·®æ¤œè¨¼</strong>ã‚’ä½¿ã£ã¦ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>

<pre><code class="language-python">from sklearn.ensemble import StackingClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.svm import SVC

# ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«
estimators = [
    ('rf', RandomForestClassifier(n_estimators=50, random_state=42)),
    ('et', ExtraTreesClassifier(n_estimators=50, random_state=42)),
    ('ada', AdaBoostClassifier(n_estimators=50, random_state=42))
]

# ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°
stack = StackingClassifier(
    estimators=estimators,
    final_estimator=LogisticRegression(),
    cv=5
)
stack.fit(X_train, y_train)
stack_acc = accuracy_score(y_test, stack.predict(X_test))

print("=== ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚° ===")
print(f"Random Forest: {rf_acc:.4f}")
print(f"Extra Trees: {et_acc:.4f}")
print(f"AdaBoost: {ada_acc:.4f}")
print(f"ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°: {stack_acc:.4f}")
</code></pre>

<hr>

<h2>1.5 æ¯”è¼ƒã¨ä½¿ã„åˆ†ã‘</h2>

<h3>æ€§èƒ½æ¯”è¼ƒ</h3>

<table>
<thead>
<tr>
<th>æ‰‹æ³•</th>
<th>ãƒãƒªã‚¢ãƒ³ã‚¹å‰Šæ¸›</th>
<th>ãƒã‚¤ã‚¢ã‚¹å‰Šæ¸›</th>
<th>ä¸¦åˆ—åŒ–</th>
<th>è¨“ç·´é€Ÿåº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ãƒã‚®ãƒ³ã‚°</strong></td>
<td>âœ“</td>
<td>-</td>
<td>å¯èƒ½</td>
<td>é€Ÿã„</td>
</tr>
<tr>
<td><strong>Random Forest</strong></td>
<td>âœ“âœ“</td>
<td>-</td>
<td>å¯èƒ½</td>
<td>é€Ÿã„</td>
</tr>
<tr>
<td><strong>AdaBoost</strong></td>
<td>-</td>
<td>âœ“</td>
<td>ä¸å¯</td>
<td>ä¸­ç¨‹åº¦</td>
</tr>
<tr>
<td><strong>Gradient Boosting</strong></td>
<td>-</td>
<td>âœ“âœ“</td>
<td>ä¸å¯</td>
<td>é…ã„</td>
</tr>
<tr>
<td><strong>ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°</strong></td>
<td>âœ“</td>
<td>âœ“</td>
<td>å¯èƒ½</td>
<td>é…ã„</td>
</tr>
</tbody>
</table>

<h3>é©ç”¨å ´é¢</h3>

<table>
<thead>
<tr>
<th>çŠ¶æ³</th>
<th>æ¨å¥¨æ‰‹æ³•</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>é«˜ãƒãƒªã‚¢ãƒ³ã‚¹ãƒ¢ãƒ‡ãƒ«</strong></td>
<td>ãƒã‚®ãƒ³ã‚°ã€Random Forest</td>
<td>åˆ†æ•£ã‚’åŠ¹æœçš„ã«å‰Šæ¸›</td>
</tr>
<tr>
<td><strong>é«˜ãƒã‚¤ã‚¢ã‚¹ãƒ¢ãƒ‡ãƒ«</strong></td>
<td>ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°</td>
<td>è¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’</td>
</tr>
<tr>
<td><strong>å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿</strong></td>
<td>Random Forest</td>
<td>ä¸¦åˆ—åŒ–å¯èƒ½ã§é«˜é€Ÿ</td>
</tr>
<tr>
<td><strong>ä¸å‡è¡¡ãƒ‡ãƒ¼ã‚¿</strong></td>
<td>AdaBoost</td>
<td>èª¤åˆ†é¡ã‚µãƒ³ãƒ—ãƒ«ã«æ³¨ç›®</td>
</tr>
<tr>
<td><strong>æœ€é«˜æ€§èƒ½è¿½æ±‚</strong></td>
<td>ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°ã€GB</td>
<td>è¤‡æ•°æ‰‹æ³•ã®é•·æ‰€ã‚’çµ±åˆ</td>
</tr>
</tbody>
</table>

<pre><code class="language-python"># å…¨æ‰‹æ³•ã®æ¯”è¼ƒ
results = {
    'æ±ºå®šæœ¨': dt_acc,
    'Random Forest': rf_acc,
    'Extra Trees': et_acc,
    'AdaBoost': ada_acc,
    'Gradient Boosting': gb_acc,
    'ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°': stack_acc
}

plt.figure(figsize=(10, 6))
methods = list(results.keys())
accuracies = list(results.values())

bars = plt.bar(methods, accuracies, color=['#e74c3c', '#3498db', '#2ecc71',
                                           '#f39c12', '#9b59b6', '#1abc9c'])
plt.ylabel('ç²¾åº¦', fontsize=12)
plt.title('ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«æ‰‹æ³•ã®æ€§èƒ½æ¯”è¼ƒ', fontsize=14)
plt.xticks(rotation=15, ha='right')
plt.ylim([0.8, 1.0])
plt.grid(axis='y', alpha=0.3)

# å€¤ã‚’ãƒãƒ¼ã®ä¸Šã«è¡¨ç¤º
for bar in bars:
    height = bar.get_height()
    plt.text(bar.get_x() + bar.get_width()/2., height,
            f'{height:.4f}', ha='center', va='bottom', fontsize=10)

plt.tight_layout()
plt.show()

print("\n=== æœ€çµ‚çµæœ ===")
for method, acc in sorted(results.items(), key=lambda x: x[1], reverse=True):
    print(f"{method:20s}: {acc:.4f}")
</code></pre>

<hr>

<h2>1.6 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><p><strong>ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«å­¦ç¿’ã®åŸç†</strong></p>
<ul>
<li>è¤‡æ•°ã®ãƒ¢ãƒ‡ãƒ«ã‚’çµ„ã¿åˆã‚ã›ã¦æ€§èƒ½å‘ä¸Š</li>
<li>ãƒã‚¤ã‚¢ã‚¹ãƒ»ãƒãƒªã‚¢ãƒ³ã‚¹åˆ†è§£</li>
</ul></li>
<li><p><strong>ãƒã‚®ãƒ³ã‚°</strong></p>
<ul>
<li>ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã¨å¹³å‡åŒ–</li>
<li>Random Forest: ãƒ©ãƒ³ãƒ€ãƒ ç‰¹å¾´é‡é¸æŠã§å¤šæ§˜æ€§å‘ä¸Š</li>
<li>Extra Trees: ã•ã‚‰ãªã‚‹ãƒ©ãƒ³ãƒ€ãƒ åŒ–</li>
</ul></li>
<li><p><strong>ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°</strong></p>
<ul>
<li>AdaBoost: èª¤åˆ†é¡ã‚µãƒ³ãƒ—ãƒ«ã«æ³¨ç›®</li>
<li>Gradient Boosting: å‹¾é…æ–¹å‘ã¸ã®æœ€é©åŒ–</li>
</ul></li>
<li><p><strong>ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°</strong></p>
<ul>
<li>ãƒ¡ã‚¿å­¦ç¿’å™¨ã«ã‚ˆã‚‹çµ±åˆ</li>
<li>äº¤å·®æ¤œè¨¼ã«ã‚ˆã‚‹éå­¦ç¿’é˜²æ­¢</li>
</ul></li>
<li><p><strong>ä½¿ã„åˆ†ã‘</strong></p>
<ul>
<li>ãƒã‚®ãƒ³ã‚°: ãƒãƒªã‚¢ãƒ³ã‚¹å‰Šæ¸›ã€ä¸¦åˆ—åŒ–</li>
<li>ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°: ãƒã‚¤ã‚¢ã‚¹å‰Šæ¸›ã€é«˜ç²¾åº¦</li>
<li>ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°: æœ€é«˜æ€§èƒ½è¿½æ±‚</li>
</ul></li>
</ol>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬2ç« ã§ã¯ã€<strong>å‹¾é…ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã®ç™ºå±•</strong>ã‚’å­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>XGBoost</li>
<li>LightGBM</li>
<li>CatBoost</li>
<li>ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</li>
</ul>

<hr>

<h2>æ¼”ç¿’å•é¡Œ</h2>

<h3>å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰</h3>
<p>ãƒã‚¤ã‚¢ã‚¹ã¨ãƒãƒªã‚¢ãƒ³ã‚¹ã®é•ã„ã‚’èª¬æ˜ã—ã€ãã‚Œãã‚Œã‚’å‰Šæ¸›ã™ã‚‹ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«æ‰‹æ³•ã‚’æŒ™ã’ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>ãƒã‚¤ã‚¢ã‚¹ï¼ˆBiasï¼‰</strong>ï¼š</p>
<ul>
<li>ãƒ¢ãƒ‡ãƒ«ã®å˜ç´”åŒ–ã«ã‚ˆã‚‹èª¤å·®</li>
<li>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã‚‚é«˜ã„èª¤å·®</li>
<li>ä¾‹: ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã§éç·šå½¢ãƒ‡ãƒ¼ã‚¿ã‚’äºˆæ¸¬</li>
</ul>

<p><strong>ãƒãƒªã‚¢ãƒ³ã‚¹ï¼ˆVarianceï¼‰</strong>ï¼š</p>
<ul>
<li>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®å¤‰å‹•ã¸ã®æ•æ„Ÿã•</li>
<li>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã«ã¯è‰¯ã„ãŒãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã«æ‚ªã„</li>
<li>ä¾‹: æ·±ã„æ±ºå®šæœ¨ã®éå­¦ç¿’</li>
</ul>

<p><strong>å‰Šæ¸›æ‰‹æ³•</strong>ï¼š</p>
<ul>
<li><strong>ãƒãƒªã‚¢ãƒ³ã‚¹å‰Šæ¸›</strong>: ãƒã‚®ãƒ³ã‚°ã€Random Forestï¼ˆå¹³å‡åŒ–ã«ã‚ˆã‚Šåˆ†æ•£ã‚’å‰Šæ¸›ï¼‰</li>
<li><strong>ãƒã‚¤ã‚¢ã‚¹å‰Šæ¸›</strong>: ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°ï¼ˆé€æ¬¡çš„ã«è¤‡é›‘ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’ï¼‰</li>
</ul>

</details>

<h3>å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>
<p>Random Forestã¨Extra Treesã®é•ã„ã‚’2ã¤æŒ™ã’ã€ãã‚Œãã‚Œã®ç‰¹å¾´ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>é•ã„1: ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</strong></p>
<ul>
<li><strong>Random Forest</strong>: ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼ˆå¾©å…ƒæŠ½å‡ºï¼‰</li>
<li><strong>Extra Trees</strong>: å…¨ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼ˆã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ãªã—ï¼‰</li>
</ul>

<p><strong>é•ã„2: åˆ†å‰²æ–¹æ³•</strong></p>
<ul>
<li><strong>Random Forest</strong>: ãƒ©ãƒ³ãƒ€ãƒ ãªç‰¹å¾´é‡ã‚µãƒ–ã‚»ãƒƒãƒˆã‹ã‚‰æœ€é©ãªåˆ†å‰²ã‚’é¸æŠ</li>
<li><strong>Extra Trees</strong>: ç‰¹å¾´é‡ã‚‚é–¾å€¤ã‚‚ãƒ©ãƒ³ãƒ€ãƒ ã«é¸æŠ</li>
</ul>

<p><strong>ç‰¹å¾´</strong>ï¼š</p>
<ul>
<li><strong>Random Forest</strong>: ãƒãƒªã‚¢ãƒ³ã‚¹å‰Šæ¸›ã€è¨“ç·´ã«ã‚„ã‚„æ™‚é–“</li>
<li><strong>Extra Trees</strong>: ã‚ˆã‚Šé«˜é€Ÿã€ã•ã‚‰ãªã‚‹ãƒ©ãƒ³ãƒ€ãƒ åŒ–ã«ã‚ˆã‚Šå¤šæ§˜æ€§å‘ä¸Š</li>
</ul>

</details>

<h3>å•é¡Œ3ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>
<p>AdaBoostã§èª¤åˆ†é¡ã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ«ã®é‡ã¿ãŒå¢—åŠ ã™ã‚‹ç†ç”±ã‚’ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>ç†ç”±</strong>ï¼š</p>
<ul>
<li>AdaBoostã¯ã€å„åå¾©ã§å‰ã®ãƒ¢ãƒ‡ãƒ«ãŒ<strong>è‹¦æ‰‹ãªã‚µãƒ³ãƒ—ãƒ«ã«æ³¨ç›®</strong>ã™ã‚‹ã‚ˆã†ã«è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹</li>
<li>èª¤åˆ†é¡ã‚µãƒ³ãƒ—ãƒ«ã®é‡ã¿ã‚’å¢—ã‚„ã™ã“ã¨ã§ã€æ¬¡ã®ãƒ¢ãƒ‡ãƒ«ã¯ãã‚Œã‚‰ã‚’æ­£ã—ãåˆ†é¡ã—ã‚ˆã†ã¨ã™ã‚‹</li>
</ul>

<p><strong>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong>ï¼š</p>
<pre><code>èª¤åˆ†é¡ã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ« i ã®é‡ã¿æ›´æ–°:
w_i â† w_i * exp(Î±_t)

æ­£ã—ãåˆ†é¡ã•ã‚ŒãŸã‚µãƒ³ãƒ—ãƒ« j ã®é‡ã¿æ›´æ–°:
w_j â† w_j * exp(-Î±_t)

ã“ã“ã§ Î±_t = 0.5 * ln((1 - Îµ_t) / Îµ_t) > 0
</code></pre>

<p><strong>åŠ¹æœ</strong>ï¼š</p>
<ul>
<li>å¼±å­¦ç¿’å™¨ãŒé †æ¬¡ã€å›°é›£ãªã‚µãƒ³ãƒ—ãƒ«ã‚’å­¦ç¿’</li>
<li>æœ€çµ‚çš„ã«è¤‡é›‘ãªæ±ºå®šå¢ƒç•Œã‚’å½¢æˆ</li>
</ul>

</details>

<h3>å•é¡Œ4ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>
<p>ã‚¹ã‚¿ãƒƒã‚­ãƒ³ã‚°ã§K-Foldäº¤å·®æ¤œè¨¼ã‚’ä½¿ã†ç†ç”±ã‚’ã€éå­¦ç¿’ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<p><strong>å•é¡Œ</strong>ï¼šè¨“ç·´ãƒ‡ãƒ¼ã‚¿å…¨ä½“ã§ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã—ã€åŒã˜ãƒ‡ãƒ¼ã‚¿ã§äºˆæ¸¬ã‚’ç”Ÿæˆã™ã‚‹ã¨ï¼š</p>
<ul>
<li>ãƒ¡ã‚¿å­¦ç¿’å™¨ãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã«éå­¦ç¿’</li>
<li>ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬ãŒã€Œè¦‹ãŸã“ã¨ãŒã‚ã‚‹ãƒ‡ãƒ¼ã‚¿ã€ã«æœ€é©åŒ–</li>
</ul>

<p><strong>K-Foldäº¤å·®æ¤œè¨¼ã®è§£æ±ºç­–</strong>ï¼š</p>

<pre><code>1. ãƒ‡ãƒ¼ã‚¿ã‚’Kå€‹ã«åˆ†å‰²
2. å„Fold k ã«ã¤ã„ã¦:
   - Fold k ä»¥å¤–ã§ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´
   - Fold k ã®äºˆæ¸¬ã‚’ç”Ÿæˆï¼ˆæœªçŸ¥ãƒ‡ãƒ¼ã‚¿ã¸ã®äºˆæ¸¬ï¼‰
3. å…¨Foldã®äºˆæ¸¬ã‚’çµåˆã—ã¦ãƒ¡ã‚¿å­¦ç¿’å™¨ã‚’è¨“ç·´
</code></pre>

<p><strong>åŠ¹æœ</strong>ï¼š</p>
<ul>
<li>ãƒ¡ã‚¿å­¦ç¿’å™¨ã¸ã®å…¥åŠ›ã¯ã€ŒæœªçŸ¥ãƒ‡ãƒ¼ã‚¿ã¸ã®äºˆæ¸¬ã€</li>
<li>æ±åŒ–æ€§èƒ½ãŒå‘ä¸Š</li>
<li>éå­¦ç¿’ã‚’é˜²æ­¢</li>
</ul>

<p><strong>å®Ÿè£…ä¾‹</strong>ï¼š</p>
<pre><code class="language-python">StackingClassifier(
    estimators=base_models,
    final_estimator=meta_model,
    cv=5  # 5-Foldäº¤å·®æ¤œè¨¼
)
</code></pre>

</details>

<h3>å•é¡Œ5ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰</h3>
<p>irisãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ä½¿ã„ã€Random Forestã¨Gradient Boostingã‚’å®Ÿè£…ãƒ»æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚è¨“ç·´æ™‚é–“ã¨ç²¾åº¦ã‚’å ±å‘Šã—ã¦ãã ã•ã„ã€‚</p>

<details>
<summary>è§£ç­”ä¾‹</summary>

<pre><code class="language-python">import time
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from sklearn.metrics import classification_report

# ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
iris = load_iris()
X, y = iris.data, iris.target

# ãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# Random Forest
print("=== Random Forest ===")
start = time.time()
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)
rf_time = time.time() - start

rf_acc = rf.score(X_test, y_test)
cv_rf = cross_val_score(rf, X, y, cv=5).mean()

print(f"è¨“ç·´æ™‚é–“: {rf_time:.4f}ç§’")
print(f"ãƒ†ã‚¹ãƒˆç²¾åº¦: {rf_acc:.4f}")
print(f"äº¤å·®æ¤œè¨¼ç²¾åº¦: {cv_rf:.4f}")

# Gradient Boosting
print("\n=== Gradient Boosting ===")
start = time.time()
gb = GradientBoostingClassifier(n_estimators=100, random_state=42)
gb.fit(X_train, y_train)
gb_time = time.time() - start

gb_acc = gb.score(X_test, y_test)
cv_gb = cross_val_score(gb, X, y, cv=5).mean()

print(f"è¨“ç·´æ™‚é–“: {gb_time:.4f}ç§’")
print(f"ãƒ†ã‚¹ãƒˆç²¾åº¦: {gb_acc:.4f}")
print(f"äº¤å·®æ¤œè¨¼ç²¾åº¦: {cv_gb:.4f}")

# æ¯”è¼ƒ
print("\n=== æ¯”è¼ƒ ===")
print(f"ç²¾åº¦: RF={rf_acc:.4f} vs GB={gb_acc:.4f}")
print(f"è¨“ç·´æ™‚é–“: RF={rf_time:.4f}ç§’ vs GB={gb_time:.4f}ç§’")
print(f"é€Ÿåº¦æ¯”: GB/RF = {gb_time/rf_time:.2f}å€")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>ï¼š</p>
<pre><code>=== Random Forest ===
è¨“ç·´æ™‚é–“: 0.0523ç§’
ãƒ†ã‚¹ãƒˆç²¾åº¦: 1.0000
äº¤å·®æ¤œè¨¼ç²¾åº¦: 0.9533

=== Gradient Boosting ===
è¨“ç·´æ™‚é–“: 0.1245ç§’
ãƒ†ã‚¹ãƒˆç²¾åº¦: 1.0000
äº¤å·®æ¤œè¨¼ç²¾åº¦: 0.9467

=== æ¯”è¼ƒ ===
ç²¾åº¦: RF=1.0000 vs GB=1.0000
è¨“ç·´æ™‚é–“: RF=0.0523ç§’ vs GB=0.1245ç§’
é€Ÿåº¦æ¯”: GB/RF = 2.38å€
</code></pre>

<p><strong>è€ƒå¯Ÿ</strong>ï¼š</p>
<ul>
<li>ç²¾åº¦ã¯ã»ã¼åŒç­‰</li>
<li>Random Forestã®æ–¹ãŒè¨“ç·´ãŒé«˜é€Ÿï¼ˆä¸¦åˆ—åŒ–å¯èƒ½ï¼‰</li>
<li>ãƒ‡ãƒ¼ã‚¿ãŒå°è¦æ¨¡ã§å˜ç´”ãªãŸã‚ã€ä¸¡æ‰‹æ³•ã¨ã‚‚é«˜ç²¾åº¦</li>
</ul>

</details>

<hr>

<h2>å‚è€ƒæ–‡çŒ®</h2>

<ol>
<li>Breiman, L. (1996). <em>Bagging predictors</em>. Machine Learning, 24(2), 123-140.</li>
<li>Breiman, L. (2001). <em>Random forests</em>. Machine Learning, 45(1), 5-32.</li>
<li>Freund, Y., & Schapire, R. E. (1997). <em>A decision-theoretic generalization of on-line learning and an application to boosting</em>. Journal of Computer and System Sciences, 55(1), 119-139.</li>
<li>Friedman, J. H. (2001). <em>Greedy function approximation: A gradient boosting machine</em>. Annals of Statistics, 1189-1232.</li>
</ol>

<div class="navigation">
    <a href="index.html" class="nav-button">â† ç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter2-gradient-boosting.html" class="nav-button">æ¬¡ã®ç« : å‹¾é…ãƒ–ãƒ¼ã‚¹ãƒ†ã‚£ãƒ³ã‚°ã®ç™ºå±• â†’</a>
</div>

    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-21</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
