<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬4ç« ï¼šå“è³ªæ¨™æº–ã¨ISO 9001 - å›½éš›å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆè¦æ ¼ã®ç†è§£ã¨å®Ÿè·µçš„Pythonå®Ÿè£…">
    <title>ç¬¬4ç« ï¼šå“è³ªæ¨™æº–ã¨ISO 9001 - PI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #11998e;
            --color-accent-light: #38ef7d;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #11998e;
            --color-link-hover: #0d7a6f;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        ul, ol {
            margin-bottom: var(--spacing-md);
            padding-left: var(--spacing-lg);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        code {
            font-family: var(--font-mono);
            background-color: var(--color-code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
            color: #e83e8c;
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
        }

        pre code {
            background-color: transparent;
            padding: 0;
            color: var(--color-text);
            font-size: 0.9rem;
        }

        .info-box {
            background-color: #e7f5ff;
            border-left: 4px solid #1c7ed6;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .warning-box {
            background-color: #fff4e6;
            border-left: 4px solid #fd7e14;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .tip-box {
            background-color: #d3f9d8;
            border-left: 4px solid #37b24d;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .example-box {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        .example-title {
            font-weight: 600;
            color: var(--color-accent);
            margin-bottom: var(--spacing-sm);
            font-size: 1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            background-color: var(--color-bg);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        th, td {
            padding: var(--spacing-sm);
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        tr:hover {
            background-color: var(--color-bg-alt);
        }

        .nav-links {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--color-border);
        }

        .nav-links a {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-md);
            background-color: var(--color-accent);
            color: white;
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: background-color 0.3s;
        }

        .nav-links a:hover {
            background-color: var(--color-link-hover);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h3 {
            color: white;
            margin-top: 0;
        }

        .learning-objectives ul {
            margin-bottom: 0;
        }

        .learning-objectives li {
            color: white;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .nav-links {
                flex-direction: column;
                gap: var(--spacing-sm);
            }

            pre {
                font-size: 0.85rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬4ç« ï¼šå“è³ªæ¨™æº–ã¨ISO 9001</h1>
            <p class="subtitle">å›½éš›å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆè¦æ ¼ã®ç†è§£ã¨å®Ÿè·µçš„Pythonå®Ÿè£…</p>
            <div class="meta">
                <span class="meta-item">ğŸ“š ã‚·ãƒªãƒ¼ã‚º: å“è³ªç®¡ç†ãƒ»QAå…¥é–€</span>
                <span class="meta-item">â±ï¸ èª­äº†æ™‚é–“: 35-40åˆ†</span>
                <span class="meta-item">ğŸ¯ é›£æ˜“åº¦: ä¸­ç´š</span>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="learning-objectives">
            <h3>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h3>
            <ul>
                <li>ISO 9001å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®7åŸå‰‡ã¨è¦æ±‚äº‹é …</li>
                <li>æ–‡æ›¸ç®¡ç†ã€å†…éƒ¨ç›£æŸ»ã€æ˜¯æ­£å‡¦ç½®ã®ãƒ—ãƒ­ã‚»ã‚¹</li>
                <li>ãƒªã‚¹ã‚¯ãƒ™ãƒ¼ã‚¹æ€è€ƒã¨FMEAï¼ˆæ•…éšœãƒ¢ãƒ¼ãƒ‰å½±éŸ¿è§£æï¼‰</li>
                <li>Pythonã‚’ä½¿ã£ãŸå“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…</li>
                <li>ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å“è³ªç®¡ç†ã¨ç¶™ç¶šçš„æ”¹å–„ã®å®Ÿè·µ</li>
            </ul>
        </div>

        <h2>4.1 ISO 9001ã®æ¦‚è¦</h2>

        <h3>4.1.1 ISO 9001ã¨ã¯</h3>

        <p>ISO 9001ã¯ã€å›½éš›æ¨™æº–åŒ–æ©Ÿæ§‹ï¼ˆISOï¼‰ãŒåˆ¶å®šã—ãŸå“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆQMS: Quality Management Systemï¼‰ã«é–¢ã™ã‚‹å›½éš›è¦æ ¼ã§ã™ã€‚çµ„ç¹”ãŒé¡§å®¢æº€è¶³åº¦ã‚’å‘ä¸Šã•ã›ã€ç¶™ç¶šçš„ã«å“è³ªã‚’æ”¹å–„ã™ã‚‹ãŸã‚ã®è¦æ±‚äº‹é …ã‚’å®šã‚ã¦ã„ã¾ã™ã€‚</p>

        <div class="info-box">
            <h4>ğŸ“Š ISO 9001ã®ä¸–ç•Œçš„å½±éŸ¿</h4>
            <ul>
                <li><strong>èªè¨¼çµ„ç¹”æ•°</strong>: ä¸–ç•Œã§100ä¸‡ä»¥ä¸Šã®çµ„ç¹”ãŒèªè¨¼å–å¾—</li>
                <li><strong>å¯¾è±¡å›½</strong>: 170ã‚«å›½ä»¥ä¸Šã§æ¡ç”¨</li>
                <li><strong>æœ€æ–°ç‰ˆ</strong>: ISO 9001:2015ï¼ˆ2015å¹´9æœˆç™ºè¡Œï¼‰</li>
                <li><strong>æ¬¡æœŸæ”¹è¨‚</strong>: 2024-2025å¹´é ƒã‚’äºˆå®š</li>
            </ul>
        </div>

        <h3>4.1.2 å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã®7åŸå‰‡</h3>

        <p>ISO 9001:2015ã¯ä»¥ä¸‹ã®7ã¤ã®å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆåŸå‰‡ã«åŸºã¥ã„ã¦ã„ã¾ã™ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>åŸå‰‡</th>
                    <th>èª¬æ˜</th>
                    <th>å®Ÿè·µä¾‹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>1. é¡§å®¢é‡è¦–</strong></td>
                    <td>é¡§å®¢ã®è¦æ±‚ã‚’ç†è§£ã—ã€æœŸå¾…ã‚’è¶…ãˆã‚‹</td>
                    <td>é¡§å®¢æº€è¶³åº¦èª¿æŸ»ã€VOCåˆ†æ</td>
                </tr>
                <tr>
                    <td><strong>2. ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—</strong></td>
                    <td>çµŒå–¶å±¤ãŒæ–¹å‘æ€§ã¨ç’°å¢ƒã‚’ç¢ºç«‹</td>
                    <td>å“è³ªæ–¹é‡ç­–å®šã€ç›®æ¨™è¨­å®š</td>
                </tr>
                <tr>
                    <td><strong>3. äººã€…ã®ç©æ¥µçš„å‚åŠ </strong></td>
                    <td>å…¨å“¡ãŒèƒ½åŠ›ã‚’ç™ºæ®ã—è²¢çŒ®</td>
                    <td>æ•™è‚²è¨“ç·´ã€ææ¡ˆåˆ¶åº¦</td>
                </tr>
                <tr>
                    <td><strong>4. ãƒ—ãƒ­ã‚»ã‚¹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</strong></td>
                    <td>æ´»å‹•ã‚’ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦ç®¡ç†</td>
                    <td>ãƒ•ãƒ­ãƒ¼å›³ä½œæˆã€KPIè¨­å®š</td>
                </tr>
                <tr>
                    <td><strong>5. æ”¹å–„</strong></td>
                    <td>ç¶™ç¶šçš„ãªæ”¹å–„ã‚’è¿½æ±‚</td>
                    <td>PDCAã€ã‚«ã‚¤ã‚¼ãƒ³æ´»å‹•</td>
                </tr>
                <tr>
                    <td><strong>6. å®¢è¦³çš„äº‹å®Ÿã«åŸºã¥ãæ„æ€æ±ºå®š</strong></td>
                    <td>ãƒ‡ãƒ¼ã‚¿ã¨åˆ†æã«åŸºã¥ãåˆ¤æ–­</td>
                    <td>çµ±è¨ˆçš„åˆ†æã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</td>
                </tr>
                <tr>
                    <td><strong>7. é–¢ä¿‚æ€§ç®¡ç†</strong></td>
                    <td>åˆ©å®³é–¢ä¿‚è€…ã¨ã®ç›¸äº’åˆ©ç›Šé–¢ä¿‚</td>
                    <td>ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼è©•ä¾¡ã€ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—</td>
                </tr>
            </tbody>
        </table>

        <h2>4.2 ISO 9001è¦æ±‚äº‹é …ã¨Pythonå®Ÿè£…</h2>

        <h3>4.2.1 ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ </h3>

        <p>ISO 9001ã®è¦æ±‚äº‹é …ã¸ã®é©åˆã‚’ç®¡ç†ã™ã‚‹ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

        <div class="example-box">
            <div class="example-title">ä¾‹1: ISO 9001ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ãƒã‚§ãƒƒã‚«ãƒ¼</div>
            <pre><code>import pandas as pd
from datetime import datetime, timedelta
from typing import List, Dict, Optional
import json

class ISO9001ComplianceChecker:
    """ISO 9001è¦æ±‚äº‹é …ã¸ã®é©åˆæ€§ã‚’ãƒã‚§ãƒƒã‚¯ãƒ»ç®¡ç†ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ 

    ISO 9001:2015ã®10ç« æ§‹æˆã«åŸºã¥ã„ãŸè¦æ±‚äº‹é …ã®é©åˆæ€§è©•ä¾¡ã€
    ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ç®¡ç†ã€æ”¹å–„è¨ˆç”»ã®è¿½è·¡ã‚’è¡Œã†ã€‚
    """

    def __init__(self):
        # ISO 9001:2015ã®è¦æ±‚äº‹é …å®šç¾©
        self.requirements = {
            "4": {"title": "çµ„ç¹”ã®çŠ¶æ³", "subclauses": [
                "4.1 çµ„ç¹”åŠã³ãã®çŠ¶æ³ã®ç†è§£",
                "4.2 åˆ©å®³é–¢ä¿‚è€…ã®ãƒ‹ãƒ¼ã‚ºåŠã³æœŸå¾…ã®ç†è§£",
                "4.3 å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®é©ç”¨ç¯„å›²ã®æ±ºå®š",
                "4.4 å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ åŠã³ãã®ãƒ—ãƒ­ã‚»ã‚¹"
            ]},
            "5": {"title": "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—", "subclauses": [
                "5.1 ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—åŠã³ã‚³ãƒŸãƒƒãƒˆãƒ¡ãƒ³ãƒˆ",
                "5.2 æ–¹é‡",
                "5.3 çµ„ç¹”ã®å½¹å‰²ã€è²¬ä»»åŠã³æ¨©é™"
            ]},
            "6": {"title": "è¨ˆç”»", "subclauses": [
                "6.1 ãƒªã‚¹ã‚¯åŠã³æ©Ÿä¼šã¸ã®å–çµ„ã¿",
                "6.2 å“è³ªç›®æ¨™åŠã³ãã‚Œã‚’é”æˆã™ã‚‹ãŸã‚ã®è¨ˆç”»ç­–å®š",
                "6.3 å¤‰æ›´ã®è¨ˆç”»"
            ]},
            "7": {"title": "æ”¯æ´", "subclauses": [
                "7.1 è³‡æº",
                "7.2 åŠ›é‡",
                "7.3 èªè­˜",
                "7.4 ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
                "7.5 æ–‡æ›¸åŒ–ã—ãŸæƒ…å ±"
            ]},
            "8": {"title": "é‹ç”¨", "subclauses": [
                "8.1 é‹ç”¨ã®è¨ˆç”»åŠã³ç®¡ç†",
                "8.2 è£½å“åŠã³ã‚µãƒ¼ãƒ“ã‚¹ã«é–¢ã™ã‚‹è¦æ±‚äº‹é …",
                "8.3 è£½å“åŠã³ã‚µãƒ¼ãƒ“ã‚¹ã®è¨­è¨ˆãƒ»é–‹ç™º",
                "8.4 å¤–éƒ¨ã‹ã‚‰æä¾›ã•ã‚Œã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã€è£½å“åŠã³ã‚µãƒ¼ãƒ“ã‚¹ã®ç®¡ç†",
                "8.5 è£½å“åŠã³ã‚µãƒ¼ãƒ“ã‚¹ã®æä¾›",
                "8.6 è£½å“åŠã³ã‚µãƒ¼ãƒ“ã‚¹ã®ãƒªãƒªãƒ¼ã‚¹",
                "8.7 ä¸é©åˆãªã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®ç®¡ç†"
            ]},
            "9": {"title": "ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©•ä¾¡", "subclauses": [
                "9.1 ç›£è¦–ã€æ¸¬å®šã€åˆ†æåŠã³è©•ä¾¡",
                "9.2 å†…éƒ¨ç›£æŸ»",
                "9.3 ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼"
            ]},
            "10": {"title": "æ”¹å–„", "subclauses": [
                "10.1 ä¸€èˆ¬",
                "10.2 ä¸é©åˆåŠã³æ˜¯æ­£å‡¦ç½®",
                "10.3 ç¶™ç¶šçš„æ”¹å–„"
            ]}
        }

        self.compliance_data = []

    def add_compliance_record(self, clause: str, subclause: str,
                            status: str, evidence: str,
                            auditor: str, notes: str = "") -> Dict:
        """ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¨˜éŒ²ã‚’è¿½åŠ 

        Args:
            clause: ç« ç•ªå·ï¼ˆä¾‹: "4", "5"ï¼‰
            subclause: è©³ç´°è¦æ±‚äº‹é …
            status: é©åˆçŠ¶æ³ï¼ˆ"Compliant", "Partial", "Non-Compliant", "Not Applicable"ï¼‰
            evidence: ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ï¼ˆæ–‡æ›¸ç•ªå·ã€å‚ç…§å…ˆï¼‰
            auditor: ç›£æŸ»è€…å
            notes: å‚™è€ƒ

        Returns:
            è¿½åŠ ã•ã‚ŒãŸè¨˜éŒ²
        """
        record = {
            "date": datetime.now().strftime("%Y-%m-%d"),
            "clause": clause,
            "subclause": subclause,
            "status": status,
            "evidence": evidence,
            "auditor": auditor,
            "notes": notes,
            "action_required": status in ["Partial", "Non-Compliant"]
        }

        self.compliance_data.append(record)
        return record

    def get_compliance_summary(self) -> pd.DataFrame:
        """é©åˆæ€§ã‚µãƒãƒªãƒ¼ã‚’å–å¾—

        Returns:
            ç« ã”ã¨ã®é©åˆç‡ã‚’å«ã‚€DataFrame
        """
        if not self.compliance_data:
            return pd.DataFrame()

        df = pd.DataFrame(self.compliance_data)

        # ç« ã”ã¨ã®é›†è¨ˆ
        summary = df.groupby('clause').agg({
            'status': lambda x: (x == 'Compliant').sum() / len(x) * 100,
            'subclause': 'count',
            'action_required': 'sum'
        }).round(2)

        summary.columns = ['é©åˆç‡(%)', 'è¦æ±‚äº‹é …æ•°', 'å¯¾å¿œå¿…è¦é …ç›®']
        summary.index.name = 'ç« '

        return summary

    def get_non_compliant_items(self) -> List[Dict]:
        """éé©åˆé …ç›®ã®ãƒªã‚¹ãƒˆã‚’å–å¾—

        Returns:
            éé©åˆãƒ»éƒ¨åˆ†é©åˆé …ç›®ã®ãƒªã‚¹ãƒˆ
        """
        return [
            record for record in self.compliance_data
            if record['status'] in ['Partial', 'Non-Compliant']
        ]

    def export_audit_report(self, filename: str):
        """ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

        Args:
            filename: å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆJSONå½¢å¼ï¼‰
        """
        report = {
            "report_date": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "total_requirements": len(self.compliance_data),
            "summary": self.get_compliance_summary().to_dict(),
            "non_compliant_items": self.get_non_compliant_items(),
            "overall_compliance": (
                sum(1 for r in self.compliance_data if r['status'] == 'Compliant')
                / len(self.compliance_data) * 100
                if self.compliance_data else 0
            )
        }

        with open(filename, 'w', encoding='utf-8') as f:
            json.dump(report, f, indent=2, ensure_ascii=False)

        print(f"ç›£æŸ»ãƒ¬ãƒãƒ¼ãƒˆã‚’ {filename} ã«å‡ºåŠ›ã—ã¾ã—ãŸ")
        print(f"ç·åˆé©åˆç‡: {report['overall_compliance']:.2f}%")


# ä½¿ç”¨ä¾‹
checker = ISO9001ComplianceChecker()

# ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹è¨˜éŒ²ã®è¿½åŠ 
checker.add_compliance_record(
    clause="4",
    subclause="4.1 çµ„ç¹”åŠã³ãã®çŠ¶æ³ã®ç†è§£",
    status="Compliant",
    evidence="DOC-001: SWOTåˆ†ææ›¸",
    auditor="ç”°ä¸­å¤ªéƒ"
)

checker.add_compliance_record(
    clause="6",
    subclause="6.1 ãƒªã‚¹ã‚¯åŠã³æ©Ÿä¼šã¸ã®å–çµ„ã¿",
    status="Partial",
    evidence="DOC-015: ãƒªã‚¹ã‚¯ç™»éŒ²ç°¿ï¼ˆæ›´æ–°å¿…è¦ï¼‰",
    auditor="ä½è—¤èŠ±å­",
    notes="ãƒªã‚¹ã‚¯è©•ä¾¡ãŒ6ãƒ¶æœˆä»¥ä¸Šæ›´æ–°ã•ã‚Œã¦ã„ãªã„"
)

checker.add_compliance_record(
    clause="9",
    subclause="9.2 å†…éƒ¨ç›£æŸ»",
    status="Non-Compliant",
    evidence="ãªã—",
    auditor="éˆ´æœ¨ä¸€éƒ",
    notes="å¹´æ¬¡å†…éƒ¨ç›£æŸ»ãŒå®Ÿæ–½ã•ã‚Œã¦ã„ãªã„"
)

# ã‚µãƒãƒªãƒ¼è¡¨ç¤º
print("\n=== ISO 9001é©åˆæ€§ã‚µãƒãƒªãƒ¼ ===")
print(checker.get_compliance_summary())

# éé©åˆé …ç›®ã®ç¢ºèª
print("\n=== å¯¾å¿œãŒå¿…è¦ãªé …ç›® ===")
for item in checker.get_non_compliant_items():
    print(f"[{item['clause']}] {item['subclause']}")
    print(f"  çŠ¶æ…‹: {item['status']}")
    print(f"  å‚™è€ƒ: {item['notes']}\n")

# ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›
checker.export_audit_report("iso9001_audit_report.json")</code></pre>
        </div>

        <div class="tip-box">
            <h4>ğŸ’¡ å®Ÿè£…ã®ãƒã‚¤ãƒ³ãƒˆ</h4>
            <ul>
                <li><strong>è¦æ±‚äº‹é …ã®æ§‹é€ åŒ–</strong>: ISO 9001ã®ç« ç«‹ã¦ã«æ²¿ã£ãŸç®¡ç†</li>
                <li><strong>ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£</strong>: å„è¦æ±‚äº‹é …ã¸ã®è¨¼æ‹ ã‚’æ˜ç¢ºåŒ–</li>
                <li><strong>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†</strong>: éé©åˆé …ç›®ã¸ã®è‡ªå‹•ãƒ•ãƒ©ã‚°ä»˜ã‘</li>
                <li><strong>é©åˆç‡ã®å¯è¦–åŒ–</strong>: ç« ã”ã¨ã®é€²æ—çŠ¶æ³ã‚’æ•°å€¤åŒ–</li>
            </ul>
        </div>

        <h3>4.2.2 æ–‡æ›¸ç®¡ç†ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h3>

        <p>ISO 9001è¦æ±‚äº‹é …7.5ã€Œæ–‡æ›¸åŒ–ã—ãŸæƒ…å ±ã€ã«å¯¾å¿œã™ã‚‹æ–‡æ›¸ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚</p>

        <div class="example-box">
            <div class="example-title">ä¾‹2: æ–‡æ›¸ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </div>
            <pre><code>import hashlib
from datetime import datetime
from typing import List, Dict, Optional
import os

class DocumentControlSystem:
    """ISO 9001å¯¾å¿œã®æ–‡æ›¸ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

    æ–‡æ›¸ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã€æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€æ”¹è¨‚å±¥æ­´ã€
    æœ‰åŠ¹æœŸé™ç®¡ç†ã‚’è¡Œã†ã€‚
    """

    def __init__(self):
        self.documents = []
        self.revision_history = []

    def create_document(self, doc_id: str, title: str, doc_type: str,
                       content: str, owner: str,
                       review_period_days: int = 365) -> Dict:
        """æ–°è¦æ–‡æ›¸ã‚’ä½œæˆ

        Args:
            doc_id: æ–‡æ›¸ç•ªå·ï¼ˆä¾‹: "QP-001"ï¼‰
            title: æ–‡æ›¸ã‚¿ã‚¤ãƒˆãƒ«
            doc_type: æ–‡æ›¸ç¨®åˆ¥ï¼ˆ"æ‰‹é †æ›¸", "æ§˜å¼", "è¨˜éŒ²"ï¼‰
            content: æ–‡æ›¸å†…å®¹
            owner: æ–‡æ›¸ç®¡ç†è²¬ä»»è€…
            review_period_days: è¦‹ç›´ã—å‘¨æœŸï¼ˆæ—¥æ•°ï¼‰

        Returns:
            ä½œæˆã•ã‚ŒãŸæ–‡æ›¸æƒ…å ±
        """
        # æ–‡æ›¸ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’è¨ˆç®—ï¼ˆæ”¹ã–ã‚“æ¤œçŸ¥ç”¨ï¼‰
        content_hash = hashlib.sha256(content.encode()).hexdigest()

        document = {
            "doc_id": doc_id,
            "title": title,
            "type": doc_type,
            "version": "1.0",
            "status": "Draft",  # Draft, Under Review, Approved, Obsolete
            "content_hash": content_hash,
            "owner": owner,
            "created_date": datetime.now(),
            "approved_date": None,
            "approved_by": None,
            "next_review_date": None,
            "review_period_days": review_period_days,
            "access_level": "Internal"  # Public, Internal, Confidential
        }

        self.documents.append(document)

        # æ”¹è¨‚å±¥æ­´ã«è¨˜éŒ²
        self._add_revision_history(
            doc_id, "1.0", "Draft", "æ–°è¦ä½œæˆ", owner
        )

        return document

    def approve_document(self, doc_id: str, approver: str) -> bool:
        """æ–‡æ›¸ã‚’æ‰¿èª

        Args:
            doc_id: æ–‡æ›¸ç•ªå·
            approver: æ‰¿èªè€…å

        Returns:
            æ‰¿èªæˆåŠŸã®å¯å¦
        """
        doc = self._find_document(doc_id)
        if not doc:
            print(f"æ–‡æ›¸ {doc_id} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
            return False

        if doc['status'] != 'Draft' and doc['status'] != 'Under Review':
            print(f"æ–‡æ›¸ {doc_id} ã¯æ‰¿èªã§ããªã„çŠ¶æ…‹ã§ã™: {doc['status']}")
            return False

        doc['status'] = 'Approved'
        doc['approved_date'] = datetime.now()
        doc['approved_by'] = approver
        doc['next_review_date'] = (
            datetime.now() +
            pd.Timedelta(days=doc['review_period_days'])
        )

        self._add_revision_history(
            doc_id, doc['version'], "Approved",
            f"{approver}ã«ã‚ˆã‚Šæ‰¿èª", approver
        )

        print(f"æ–‡æ›¸ {doc_id} v{doc['version']} ã‚’æ‰¿èªã—ã¾ã—ãŸ")
        return True

    def revise_document(self, doc_id: str, new_content: str,
                       revision_note: str, revised_by: str) -> Dict:
        """æ–‡æ›¸ã‚’æ”¹è¨‚ï¼ˆæ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä½œæˆï¼‰

        Args:
            doc_id: æ–‡æ›¸ç•ªå·
            new_content: æ–°ã—ã„æ–‡æ›¸å†…å®¹
            revision_note: æ”¹è¨‚ç†ç”±
            revised_by: æ”¹è¨‚è€…

        Returns:
            æ”¹è¨‚å¾Œã®æ–‡æ›¸æƒ…å ±
        """
        doc = self._find_document(doc_id)
        if not doc:
            raise ValueError(f"æ–‡æ›¸ {doc_id} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")

        # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·ã‚’æ›´æ–°
        major, minor = map(int, doc['version'].split('.'))
        doc['version'] = f"{major}.{minor + 1}"

        # æ–‡æ›¸ã‚’DraftçŠ¶æ…‹ã«æˆ»ã™
        doc['status'] = 'Draft'
        doc['content_hash'] = hashlib.sha256(new_content.encode()).hexdigest()
        doc['approved_date'] = None
        doc['approved_by'] = None

        # æ”¹è¨‚å±¥æ­´ã«è¨˜éŒ²
        self._add_revision_history(
            doc_id, doc['version'], "Draft", revision_note, revised_by
        )

        print(f"æ–‡æ›¸ {doc_id} ã‚’ v{doc['version']} ã«æ”¹è¨‚ã—ã¾ã—ãŸ")
        return doc

    def get_documents_for_review(self) -> List[Dict]:
        """è¦‹ç›´ã—ãŒå¿…è¦ãªæ–‡æ›¸ã®ãƒªã‚¹ãƒˆã‚’å–å¾—

        Returns:
            è¦‹ç›´ã—æœŸé™ãŒè¿‘ã„ã€ã¾ãŸã¯éããŸæ–‡æ›¸ã®ãƒªã‚¹ãƒˆ
        """
        now = datetime.now()
        review_needed = []

        for doc in self.documents:
            if doc['status'] != 'Approved':
                continue

            if doc['next_review_date'] and doc['next_review_date'] <= now:
                days_overdue = (now - doc['next_review_date']).days
                review_needed.append({
                    **doc,
                    "days_overdue": days_overdue,
                    "priority": "High" if days_overdue > 30 else "Medium"
                })

        return sorted(review_needed, key=lambda x: x['days_overdue'], reverse=True)

    def get_revision_history(self, doc_id: str) -> pd.DataFrame:
        """æ–‡æ›¸ã®æ”¹è¨‚å±¥æ­´ã‚’å–å¾—

        Args:
            doc_id: æ–‡æ›¸ç•ªå·

        Returns:
            æ”¹è¨‚å±¥æ­´ã®DataFrame
        """
        history = [
            h for h in self.revision_history if h['doc_id'] == doc_id
        ]

        if not history:
            return pd.DataFrame()

        return pd.DataFrame(history)

    def _find_document(self, doc_id: str) -> Optional[Dict]:
        """æ–‡æ›¸IDã§æ–‡æ›¸ã‚’æ¤œç´¢ï¼ˆå†…éƒ¨ç”¨ï¼‰"""
        for doc in self.documents:
            if doc['doc_id'] == doc_id:
                return doc
        return None

    def _add_revision_history(self, doc_id: str, version: str,
                             status: str, note: str, user: str):
        """æ”¹è¨‚å±¥æ­´ã‚’è¿½åŠ ï¼ˆå†…éƒ¨ç”¨ï¼‰"""
        self.revision_history.append({
            "doc_id": doc_id,
            "version": version,
            "status": status,
            "note": note,
            "user": user,
            "timestamp": datetime.now()
        })


# ä½¿ç”¨ä¾‹
import pandas as pd

dcs = DocumentControlSystem()

# å“è³ªæ‰‹é †æ›¸ã‚’ä½œæˆ
doc = dcs.create_document(
    doc_id="QP-001",
    title="å†…éƒ¨ç›£æŸ»æ‰‹é †æ›¸",
    doc_type="æ‰‹é †æ›¸",
    content="1. ç›®çš„\n2. é©ç”¨ç¯„å›²\n3. æ‰‹é †...",
    owner="å“è³ªç®¡ç†éƒ¨é•·",
    review_period_days=365
)

print(f"æ–‡æ›¸ä½œæˆ: {doc['doc_id']} - {doc['title']}")

# æ–‡æ›¸ã‚’æ‰¿èª
dcs.approve_document("QP-001", "å·¥å ´é•·")

# æ–‡æ›¸ã‚’æ”¹è¨‚
dcs.revise_document(
    doc_id="QP-001",
    new_content="1. ç›®çš„\n2. é©ç”¨ç¯„å›²ï¼ˆæ›´æ–°ï¼‰\n3. æ‰‹é †ï¼ˆè¿½åŠ ï¼‰...",
    revision_note="é©ç”¨ç¯„å›²ã‚’æ‹¡å¤§ã€æ‰‹é †ã‚’è©³ç´°åŒ–",
    revised_by="å“è³ªç®¡ç†éƒ¨é•·"
)

# æ”¹è¨‚å¾Œã«å†æ‰¿èª
dcs.approve_document("QP-001", "å·¥å ´é•·")

# æ”¹è¨‚å±¥æ­´ã‚’è¡¨ç¤º
print("\n=== æ”¹è¨‚å±¥æ­´ ===")
print(dcs.get_revision_history("QP-001"))</code></pre>
        </div>

        <h3>4.2.3 å†…éƒ¨ç›£æŸ»è¨ˆç”»ãƒ»è¿½è·¡ã‚·ã‚¹ãƒ†ãƒ </h3>

        <p>ISO 9001è¦æ±‚äº‹é …9.2ã€Œå†…éƒ¨ç›£æŸ»ã€ã«å¯¾å¿œã™ã‚‹ç›£æŸ»ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚</p>

        <div class="example-box">
            <div class="example-title">ä¾‹3: å†…éƒ¨ç›£æŸ»ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </div>
            <pre><code>from datetime import datetime, timedelta
import pandas as pd
from typing import List, Dict

class InternalAuditSystem:
    """å†…éƒ¨ç›£æŸ»ã®è¨ˆç”»ã€å®Ÿæ–½ã€ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã‚’ç®¡ç†

    å¹´é–“ç›£æŸ»è¨ˆç”»ã®ä½œæˆã€ç›£æŸ»ã®å®Ÿæ–½è¨˜éŒ²ã€ç™ºè¦‹äº‹é …ã®è¿½è·¡ã€
    æ˜¯æ­£å‡¦ç½®ã®ç¢ºèªã‚’è¡Œã†ã€‚
    """

    def __init__(self):
        self.audit_plan = []
        self.audit_findings = []
        self.corrective_actions = []

    def create_annual_audit_plan(self, year: int,
                                departments: List[str],
                                frequency: str = "Annual") -> List[Dict]:
        """å¹´é–“ç›£æŸ»è¨ˆç”»ã‚’ä½œæˆ

        Args:
            year: å¯¾è±¡å¹´
            departments: ç›£æŸ»å¯¾è±¡éƒ¨é–€ã®ãƒªã‚¹ãƒˆ
            frequency: ç›£æŸ»é »åº¦ï¼ˆ"Annual", "Semi-Annual", "Quarterly"ï¼‰

        Returns:
            ä½œæˆã•ã‚ŒãŸç›£æŸ»è¨ˆç”»ã®ãƒªã‚¹ãƒˆ
        """
        freq_map = {
            "Annual": 1,
            "Semi-Annual": 2,
            "Quarterly": 4
        }

        audits_per_year = freq_map.get(frequency, 1)

        for dept in departments:
            for i in range(audits_per_year):
                # ç›£æŸ»æ™‚æœŸã‚’å‡ç­‰ã«é…åˆ†
                month = (i * 12 // audits_per_year) + 1
                planned_date = datetime(year, month, 15)

                audit = {
                    "audit_id": f"IA-{year}-{dept[:3].upper()}-{i+1:02d}",
                    "department": dept,
                    "audit_type": "Internal",
                    "scope": f"{dept}éƒ¨é–€ã®å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ",
                    "planned_date": planned_date,
                    "status": "Planned",  # Planned, In Progress, Completed
                    "lead_auditor": None,
                    "audit_team": [],
                    "completion_date": None
                }

                self.audit_plan.append(audit)

        print(f"{year}å¹´åº¦ã®ç›£æŸ»è¨ˆç”»ã‚’ä½œæˆ: {len(self.audit_plan)}ä»¶")
        return self.audit_plan

    def assign_auditors(self, audit_id: str, lead_auditor: str,
                       team_members: List[str]):
        """ç›£æŸ»ãƒãƒ¼ãƒ ã‚’ã‚¢ã‚µã‚¤ãƒ³

        Args:
            audit_id: ç›£æŸ»ID
            lead_auditor: ä¸»ä»»ç›£æŸ»å“¡
            team_members: ç›£æŸ»ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼
        """
        audit = self._find_audit(audit_id)
        if audit:
            audit['lead_auditor'] = lead_auditor
            audit['audit_team'] = team_members
            print(f"ç›£æŸ» {audit_id} ã«ãƒãƒ¼ãƒ ã‚’ã‚¢ã‚µã‚¤ãƒ³ã—ã¾ã—ãŸ")

    def record_finding(self, audit_id: str, finding_type: str,
                      clause: str, description: str,
                      severity: str) -> Dict:
        """ç›£æŸ»ç™ºè¦‹äº‹é …ã‚’è¨˜éŒ²

        Args:
            audit_id: ç›£æŸ»ID
            finding_type: "Non-Conformance", "Observation", "Opportunity"
            clause: é–¢é€£ã™ã‚‹ISOæ¡é …
            description: ç™ºè¦‹äº‹é …ã®è©³ç´°
            severity: é‡å¤§åº¦ï¼ˆ"Major", "Minor"ï¼‰

        Returns:
            è¨˜éŒ²ã•ã‚ŒãŸç™ºè¦‹äº‹é …
        """
        finding = {
            "finding_id": f"F-{len(self.audit_findings) + 1:04d}",
            "audit_id": audit_id,
            "type": finding_type,
            "clause": clause,
            "description": description,
            "severity": severity,
            "recorded_date": datetime.now(),
            "status": "Open",  # Open, Under Review, Closed
            "ca_required": finding_type == "Non-Conformance"
        }

        self.audit_findings.append(finding)
        return finding

    def complete_audit(self, audit_id: str):
        """ç›£æŸ»ã‚’å®Œäº†

        Args:
            audit_id: ç›£æŸ»ID
        """
        audit = self._find_audit(audit_id)
        if audit:
            audit['status'] = 'Completed'
            audit['completion_date'] = datetime.now()

            # é–¢é€£ã™ã‚‹ç™ºè¦‹äº‹é …ã®æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
            findings = [f for f in self.audit_findings
                       if f['audit_id'] == audit_id]

            print(f"ç›£æŸ» {audit_id} ã‚’å®Œäº†ã—ã¾ã—ãŸ")
            print(f"  ç™ºè¦‹äº‹é …: {len(findings)}ä»¶")
            print(f"  ä¸é©åˆ: {sum(1 for f in findings if f['type'] == 'Non-Conformance')}ä»¶")

    def get_audit_dashboard(self) -> pd.DataFrame:
        """ç›£æŸ»ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

        Returns:
            ç›£æŸ»è¨ˆç”»ã®é€²æ—çŠ¶æ³ã‚’ç¤ºã™DataFrame
        """
        if not self.audit_plan:
            return pd.DataFrame()

        df = pd.DataFrame(self.audit_plan)

        # ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹åˆ¥é›†è¨ˆ
        status_summary = df['status'].value_counts()

        # ç™ºè¦‹äº‹é …ã®çµ±è¨ˆ
        findings_df = pd.DataFrame(self.audit_findings)
        if not findings_df.empty:
            nc_count = (findings_df['type'] == 'Non-Conformance').sum()
            open_findings = (findings_df['status'] == 'Open').sum()
        else:
            nc_count = 0
            open_findings = 0

        summary = pd.DataFrame({
            "æŒ‡æ¨™": ["è¨ˆç”»æ¸ˆ", "å®Œäº†", "é€²è¡Œä¸­", "ä¸é©åˆä»¶æ•°", "æœªè§£æ±ºç™ºè¦‹äº‹é …"],
            "å€¤": [
                (df['status'] == 'Planned').sum(),
                (df['status'] == 'Completed').sum(),
                (df['status'] == 'In Progress').sum(),
                nc_count,
                open_findings
            ]
        })

        return summary

    def get_overdue_audits(self) -> List[Dict]:
        """æœŸé™è¶…éã®ç›£æŸ»ã‚’å–å¾—

        Returns:
            å®Ÿæ–½äºˆå®šæ—¥ã‚’éããŸç›£æŸ»ã®ãƒªã‚¹ãƒˆ
        """
        now = datetime.now()
        overdue = []

        for audit in self.audit_plan:
            if (audit['status'] == 'Planned' and
                audit['planned_date'] < now):
                days_overdue = (now - audit['planned_date']).days
                overdue.append({
                    **audit,
                    "days_overdue": days_overdue
                })

        return sorted(overdue, key=lambda x: x['days_overdue'], reverse=True)

    def _find_audit(self, audit_id: str) -> Optional[Dict]:
        """ç›£æŸ»IDã§ç›£æŸ»ã‚’æ¤œç´¢ï¼ˆå†…éƒ¨ç”¨ï¼‰"""
        for audit in self.audit_plan:
            if audit['audit_id'] == audit_id:
                return audit
        return None


# ä½¿ç”¨ä¾‹
ias = InternalAuditSystem()

# å¹´é–“ç›£æŸ»è¨ˆç”»ã‚’ä½œæˆ
departments = ["è£½é€ ", "å“è³ªç®¡ç†", "è³¼è²·", "è¨­è¨ˆ", "å–¶æ¥­"]
ias.create_annual_audit_plan(2025, departments, frequency="Annual")

# ç›£æŸ»å“¡ã‚’ã‚¢ã‚µã‚¤ãƒ³
ias.assign_auditors(
    "IA-2025-è£½é€ -01",
    lead_auditor="ç”°ä¸­å¤ªéƒï¼ˆä¸»ä»»ç›£æŸ»å“¡ï¼‰",
    team_members=["ä½è—¤èŠ±å­", "éˆ´æœ¨ä¸€éƒ"]
)

# ç™ºè¦‹äº‹é …ã‚’è¨˜éŒ²
finding1 = ias.record_finding(
    audit_id="IA-2025-è£½é€ -01",
    finding_type="Non-Conformance",
    clause="8.5 è£½å“åŠã³ã‚µãƒ¼ãƒ“ã‚¹ã®æä¾›",
    description="ä½œæ¥­æ‰‹é †æ›¸ãŒæœ€æ–°ç‰ˆã«æ›´æ–°ã•ã‚Œã¦ã„ãªã„ï¼ˆ3å¹´å‰ã®ã¾ã¾ï¼‰",
    severity="Major"
)

finding2 = ias.record_finding(
    audit_id="IA-2025-è£½é€ -01",
    finding_type="Observation",
    clause="7.2 åŠ›é‡",
    description="æ•™è‚²è¨“ç·´è¨˜éŒ²ãŒä¸€éƒ¨ä¸å®Œå…¨",
    severity="Minor"
)

print(f"\nç™ºè¦‹äº‹é …ã‚’è¨˜éŒ²: {finding1['finding_id']}, {finding2['finding_id']}")

# ç›£æŸ»ã‚’å®Œäº†
ias.complete_audit("IA-2025-è£½é€ -01")

# ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º
print("\n=== ç›£æŸ»ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ ===")
print(ias.get_audit_dashboard())</code></pre>
        </div>

        <h3>4.2.4 ä¸é©åˆç®¡ç†ãƒ»CAPAï¼ˆæ˜¯æ­£å‡¦ç½®ãƒ»äºˆé˜²å‡¦ç½®ï¼‰ã‚·ã‚¹ãƒ†ãƒ </h3>

        <p>ISO 9001è¦æ±‚äº‹é …10.2ã€Œä¸é©åˆåŠã³æ˜¯æ­£å‡¦ç½®ã€ã«å¯¾å¿œã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚</p>

        <div class="example-box">
            <div class="example-title">ä¾‹4: CAPAç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </div>
            <pre><code>from datetime import datetime, timedelta
from typing import List, Dict, Optional
import pandas as pd

class CAPASystem:
    """æ˜¯æ­£å‡¦ç½®ãƒ»äºˆé˜²å‡¦ç½®ï¼ˆCAPAï¼‰ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

    ä¸é©åˆã®è¨˜éŒ²ã€æ ¹æœ¬åŸå› åˆ†æã€æ˜¯æ­£å‡¦ç½®ã®è¨ˆç”»ãƒ»å®Ÿæ–½ã€
    æœ‰åŠ¹æ€§ç¢ºèªã¾ã§ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã‚’ç®¡ç†ã€‚
    """

    def __init__(self):
        self.capas = []
        self.root_cause_analyses = []

    def create_capa(self, source: str, description: str,
                   category: str, severity: str,
                   reported_by: str) -> Dict:
        """CAPAï¼ˆæ˜¯æ­£å‡¦ç½®ãƒ»äºˆé˜²å‡¦ç½®ï¼‰ã‚’èµ·ç¥¨

        Args:
            source: ç™ºç”Ÿæºï¼ˆ"Internal Audit", "Customer Complaint",
                            "Process Monitoring", "Supplier Issue"ï¼‰
            description: ä¸é©åˆå†…å®¹ã®è©³ç´°
            category: åˆ†é¡ï¼ˆ"Product", "Process", "Documentation", "Training"ï¼‰
            severity: é‡å¤§åº¦ï¼ˆ"Critical", "Major", "Minor"ï¼‰
            reported_by: å ±å‘Šè€…

        Returns:
            ä½œæˆã•ã‚ŒãŸCAPAæƒ…å ±
        """
        capa_id = f"CAPA-{datetime.now().strftime('%Y%m%d')}-{len(self.capas) + 1:03d}"

        # é‡å¤§åº¦ã«å¿œã˜ãŸå¯¾å¿œæœŸé™ã‚’è¨­å®š
        due_days = {"Critical": 7, "Major": 30, "Minor": 60}

        capa = {
            "capa_id": capa_id,
            "source": source,
            "description": description,
            "category": category,
            "severity": severity,
            "reported_by": reported_by,
            "reported_date": datetime.now(),
            "status": "Open",  # Open, Investigation, Action, Verification, Closed
            "assigned_to": None,
            "due_date": datetime.now() + timedelta(days=due_days[severity]),
            "root_cause": None,
            "corrective_action": None,
            "preventive_action": None,
            "effectiveness_verified": False,
            "closed_date": None
        }

        self.capas.append(capa)
        print(f"CAPAèµ·ç¥¨: {capa_id} (æœŸé™: {capa['due_date'].strftime('%Y-%m-%d')})")
        return capa

    def assign_capa(self, capa_id: str, assignee: str):
        """CAPAã‚’æ‹…å½“è€…ã«ã‚¢ã‚µã‚¤ãƒ³

        Args:
            capa_id: CAPAç•ªå·
            assignee: æ‹…å½“è€…å
        """
        capa = self._find_capa(capa_id)
        if capa:
            capa['assigned_to'] = assignee
            capa['status'] = 'Investigation'
            print(f"CAPA {capa_id} ã‚’ {assignee} ã«ã‚¢ã‚µã‚¤ãƒ³ã—ã¾ã—ãŸ")

    def record_root_cause_analysis(self, capa_id: str,
                                   method: str, findings: str,
                                   root_cause: str, analyst: str) -> Dict:
        """æ ¹æœ¬åŸå› åˆ†æã‚’è¨˜éŒ²

        Args:
            capa_id: CAPAç•ªå·
            method: åˆ†ææ‰‹æ³•ï¼ˆ"5 Whys", "Fishbone", "FTA", "FMEA"ï¼‰
            findings: åˆ†æçµæœ
            root_cause: ç‰¹å®šã•ã‚ŒãŸæ ¹æœ¬åŸå› 
            analyst: åˆ†æè€…

        Returns:
            è¨˜éŒ²ã•ã‚ŒãŸåˆ†ææƒ…å ±
        """
        analysis = {
            "capa_id": capa_id,
            "method": method,
            "findings": findings,
            "root_cause": root_cause,
            "analyst": analyst,
            "analysis_date": datetime.now()
        }

        self.root_cause_analyses.append(analysis)

        # CAPAã«æ ¹æœ¬åŸå› ã‚’è¨˜éŒ²
        capa = self._find_capa(capa_id)
        if capa:
            capa['root_cause'] = root_cause

        return analysis

    def define_corrective_action(self, capa_id: str,
                                corrective_action: str,
                                preventive_action: str = ""):
        """æ˜¯æ­£å‡¦ç½®ãƒ»äºˆé˜²å‡¦ç½®ã‚’å®šç¾©

        Args:
            capa_id: CAPAç•ªå·
            corrective_action: æ˜¯æ­£å‡¦ç½®ï¼ˆç™ºç”Ÿã—ãŸå•é¡Œã¸ã®å¯¾å¿œï¼‰
            preventive_action: äºˆé˜²å‡¦ç½®ï¼ˆå†ç™ºé˜²æ­¢ç­–ï¼‰
        """
        capa = self._find_capa(capa_id)
        if not capa:
            print(f"CAPA {capa_id} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
            return

        capa['corrective_action'] = corrective_action
        capa['preventive_action'] = preventive_action
        capa['status'] = 'Action'

        print(f"CAPA {capa_id} ã®å‡¦ç½®ã‚’å®šç¾©ã—ã¾ã—ãŸ")

    def verify_effectiveness(self, capa_id: str,
                           verified_by: str,
                           is_effective: bool,
                           verification_note: str):
        """æ˜¯æ­£å‡¦ç½®ã®æœ‰åŠ¹æ€§ã‚’æ¤œè¨¼

        Args:
            capa_id: CAPAç•ªå·
            verified_by: æ¤œè¨¼è€…
            is_effective: æœ‰åŠ¹æ€§ç¢ºèªçµæœ
            verification_note: æ¤œè¨¼ãƒ¡ãƒ¢
        """
        capa = self._find_capa(capa_id)
        if not capa:
            print(f"CAPA {capa_id} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
            return

        capa['effectiveness_verified'] = is_effective
        capa['status'] = 'Closed' if is_effective else 'Action'

        if is_effective:
            capa['closed_date'] = datetime.now()
            print(f"CAPA {capa_id} ã‚’å®Œäº†ã—ã¾ã—ãŸï¼ˆæœ‰åŠ¹æ€§ç¢ºèªæ¸ˆã¿ï¼‰")
        else:
            print(f"CAPA {capa_id} ã®æœ‰åŠ¹æ€§ãŒä¸ååˆ†ã§ã™ã€‚è¿½åŠ å‡¦ç½®ãŒå¿…è¦ã§ã™")
            print(f"  ç†ç”±: {verification_note}")

    def get_open_capas(self) -> pd.DataFrame:
        """æœªå®Œäº†CAPAã®ãƒªã‚¹ãƒˆã‚’å–å¾—

        Returns:
            æœªå®Œäº†CAPAã®DataFrame
        """
        open_capas = [c for c in self.capas if c['status'] != 'Closed']

        if not open_capas:
            return pd.DataFrame()

        df = pd.DataFrame(open_capas)
        df['days_open'] = df['reported_date'].apply(
            lambda x: (datetime.now() - x).days
        )
        df['overdue'] = df['due_date'] < datetime.now()

        return df[['capa_id', 'severity', 'category', 'status',
                  'assigned_to', 'due_date', 'days_open', 'overdue']]

    def get_capa_metrics(self) -> Dict:
        """CAPAãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’å–å¾—

        Returns:
            ä¸»è¦CAPAãƒ¡ãƒˆãƒªã‚¯ã‚¹
        """
        if not self.capas:
            return {}

        df = pd.DataFrame(self.capas)

        # å¹³å‡è§£æ±ºæ—¥æ•°ï¼ˆå®Œäº†æ¸ˆã¿ã®ã¿ï¼‰
        closed_capas = df[df['status'] == 'Closed'].copy()
        if not closed_capas.empty:
            closed_capas['resolution_days'] = (
                closed_capas['closed_date'] - closed_capas['reported_date']
            ).dt.days
            avg_resolution_days = closed_capas['resolution_days'].mean()
        else:
            avg_resolution_days = 0

        # æœŸé™è¶…éç‡
        now = datetime.now()
        overdue_count = sum(1 for c in self.capas
                           if c['status'] != 'Closed' and c['due_date'] < now)

        metrics = {
            "ç·CAPAæ•°": len(self.capas),
            "æœªå®Œäº†": (df['status'] != 'Closed').sum(),
            "å®Œäº†": (df['status'] == 'Closed').sum(),
            "æœŸé™è¶…é": overdue_count,
            "å¹³å‡è§£æ±ºæ—¥æ•°": round(avg_resolution_days, 1),
            "å®Œäº†ç‡(%)": round((df['status'] == 'Closed').sum() / len(self.capas) * 100, 1)
        }

        return metrics

    def _find_capa(self, capa_id: str) -> Optional[Dict]:
        """CAPA IDã§CAPAã‚’æ¤œç´¢ï¼ˆå†…éƒ¨ç”¨ï¼‰"""
        for capa in self.capas:
            if capa['capa_id'] == capa_id:
                return capa
        return None


# ä½¿ç”¨ä¾‹
capa_system = CAPASystem()

# CAPAã‚’èµ·ç¥¨
capa1 = capa_system.create_capa(
    source="Internal Audit",
    description="è£½é€ ãƒ©ã‚¤ãƒ³Aã§ä½œæ¥­æ‰‹é †æ›¸ã®ä¸éµå®ˆãŒç™ºè¦‹ã•ã‚ŒãŸã€‚æ‰‹é †3ã®ã‚¹ãƒ†ãƒƒãƒ—ãŒçœç•¥ã•ã‚Œã¦ã„ã‚‹ã€‚",
    category="Process",
    severity="Major",
    reported_by="ç›£æŸ»å“¡ ç”°ä¸­"
)

# æ‹…å½“è€…ã«ã‚¢ã‚µã‚¤ãƒ³
capa_system.assign_capa(capa1['capa_id'], "è£½é€ éƒ¨é•· ä½è—¤")

# æ ¹æœ¬åŸå› åˆ†æã‚’å®Ÿæ–½
capa_system.record_root_cause_analysis(
    capa_id=capa1['capa_id'],
    method="5 Whys",
    findings="""
    ãªãœæ‰‹é †ãŒçœç•¥ã•ã‚ŒãŸ? â†’ æ™‚é–“ãŒã‹ã‹ã‚‹ã‹ã‚‰
    ãªãœæ™‚é–“ãŒã‹ã‹ã‚‹? â†’ è¨­å‚™ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«æ™‚é–“ã‚’è¦ã™ã‚‹
    ãªãœã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã«æ™‚é–“ãŒã‹ã‹ã‚‹? â†’ æ²»å…·ã®æº–å‚™ãŒç…©é›‘
    ãªãœæ²»å…·ã®æº–å‚™ãŒç…©é›‘? â†’ æ•´ç†æ•´é “ã•ã‚Œã¦ã„ãªã„
    ãªãœæ•´ç†æ•´é “ã•ã‚Œã¦ã„ãªã„? â†’ 5Sæ´»å‹•ãŒå½¢éª¸åŒ–ã—ã¦ã„ã‚‹
    """,
    root_cause="5Sæ´»å‹•ã®å½¢éª¸åŒ–ã«ã‚ˆã‚Šã€æ²»å…·ç®¡ç†ãŒä¸ååˆ†ã€‚ä½œæ¥­è€…ãŒæ‰‹é †çœç•¥ã‚’é¸æŠã€‚",
    analyst="å“è³ªç®¡ç†éƒ¨ éˆ´æœ¨"
)

# æ˜¯æ­£å‡¦ç½®ãƒ»äºˆé˜²å‡¦ç½®ã‚’å®šç¾©
capa_system.define_corrective_action(
    capa_id=capa1['capa_id'],
    corrective_action="æ²»å…·ã®æ•´ç†æ•´é “ã‚’å³åº§ã«å®Ÿæ–½ã€‚æ‰‹é †æ›¸éµå®ˆã‚’å†æ•™è‚²ã€‚",
    preventive_action="5Sæ´»å‹•ã‚’å†æ´»æ€§åŒ–ã€‚æœˆæ¬¡ç›£æŸ»ã‚’å®Ÿæ–½ã€‚æ²»å…·ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’å°å…¥ã€‚"
)

# æœ‰åŠ¹æ€§ã‚’æ¤œè¨¼
capa_system.verify_effectiveness(
    capa_id=capa1['capa_id'],
    verified_by="å“è³ªç®¡ç†éƒ¨é•·",
    is_effective=True,
    verification_note="1ãƒ¶æœˆå¾Œã«å†ç›£æŸ»ã‚’å®Ÿæ–½ã€‚æ‰‹é †éµå®ˆç‡100%ã‚’ç¢ºèªã€‚æ²»å…·ç®¡ç†ã‚‚æ”¹å–„ã€‚"
)

# ãƒ¡ãƒˆãƒªã‚¯ã‚¹è¡¨ç¤º
print("\n=== CAPAãƒ¡ãƒˆãƒªã‚¯ã‚¹ ===")
metrics = capa_system.get_capa_metrics()
for key, value in metrics.items():
    print(f"{key}: {value}")</code></pre>
        </div>

        <h2>4.3 ãƒªã‚¹ã‚¯ãƒ™ãƒ¼ã‚¹æ€è€ƒã¨FMEA</h2>

        <h3>4.3.1 FMEAï¼ˆæ•…éšœãƒ¢ãƒ¼ãƒ‰å½±éŸ¿è§£æï¼‰ã®å®Ÿè£…</h3>

        <p>ISO 9001:2015ã®6.1ã€Œãƒªã‚¹ã‚¯åŠã³æ©Ÿä¼šã¸ã®å–çµ„ã¿ã€ã§ã¯ã€ãƒªã‚¹ã‚¯ãƒ™ãƒ¼ã‚¹æ€è€ƒãŒæ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚FMEAï¼ˆFailure Mode and Effects Analysisï¼‰ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚„è£½å“ã®æ½œåœ¨çš„ãªæ•…éšœãƒ¢ãƒ¼ãƒ‰ã‚’ç‰¹å®šã—ã€å„ªå…ˆé †ä½ä»˜ã‘ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚</p>

        <div class="example-box">
            <div class="example-title">ä¾‹5: FMEAå®Ÿè£…ã‚·ã‚¹ãƒ†ãƒ </div>
            <pre><code>import pandas as pd
from typing import List, Dict
import numpy as np

class FMEASystem:
    """FMEAï¼ˆæ•…éšœãƒ¢ãƒ¼ãƒ‰å½±éŸ¿è§£æï¼‰å®Ÿè£…ã‚·ã‚¹ãƒ†ãƒ 

    ãƒ—ãƒ­ã‚»ã‚¹FMEAã¾ãŸã¯è¨­è¨ˆFMEAã‚’å®Ÿæ–½ã—ã€RPNï¼ˆRisk Priority Numberï¼‰
    ã«åŸºã¥ã„ã¦ãƒªã‚¹ã‚¯ã‚’å„ªå…ˆé †ä½ä»˜ã‘ã€‚
    """

    def __init__(self, fmea_type: str = "Process"):
        """
        Args:
            fmea_type: FMEAã‚¿ã‚¤ãƒ—ï¼ˆ"Process" or "Design"ï¼‰
        """
        self.fmea_type = fmea_type
        self.failure_modes = []

    def add_failure_mode(self, process_step: str,
                        potential_failure: str,
                        effects: str, severity: int,
                        causes: str, occurrence: int,
                        current_controls: str, detection: int,
                        responsible_person: str = "") -> Dict:
        """æ•…éšœãƒ¢ãƒ¼ãƒ‰ã‚’è¿½åŠ 

        Args:
            process_step: ãƒ—ãƒ­ã‚»ã‚¹ã‚¹ãƒ†ãƒƒãƒ—/æ©Ÿèƒ½
            potential_failure: æ½œåœ¨çš„æ•…éšœãƒ¢ãƒ¼ãƒ‰
            effects: æ•…éšœã®å½±éŸ¿
            severity: æ·±åˆ»åº¦ï¼ˆ1-10, 10ãŒæœ€ã‚‚æ·±åˆ»ï¼‰
            causes: æ•…éšœã®åŸå› 
            occurrence: ç™ºç”Ÿé »åº¦ï¼ˆ1-10, 10ãŒæœ€ã‚‚é »ç¹ï¼‰
            current_controls: ç¾åœ¨ã®ç®¡ç†æ–¹æ³•
            detection: æ¤œå‡ºåº¦ï¼ˆ1-10, 10ãŒæœ€ã‚‚æ¤œå‡ºå›°é›£ï¼‰
            responsible_person: è²¬ä»»è€…

        Returns:
            è¿½åŠ ã•ã‚ŒãŸæ•…éšœãƒ¢ãƒ¼ãƒ‰æƒ…å ±
        """
        # RPNï¼ˆRisk Priority Numberï¼‰ã‚’è¨ˆç®—
        rpn = severity * occurrence * detection

        failure_mode = {
            "process_step": process_step,
            "potential_failure": potential_failure,
            "effects": effects,
            "severity": severity,
            "causes": causes,
            "occurrence": occurrence,
            "current_controls": current_controls,
            "detection": detection,
            "rpn": rpn,
            "responsible_person": responsible_person,
            "recommended_actions": "",
            "actions_taken": "",
            "new_severity": None,
            "new_occurrence": None,
            "new_detection": None,
            "new_rpn": None
        }

        self.failure_modes.append(failure_mode)
        return failure_mode

    def prioritize_risks(self, threshold: int = 100) -> pd.DataFrame:
        """ãƒªã‚¹ã‚¯ã‚’å„ªå…ˆé †ä½ä»˜ã‘

        Args:
            threshold: å¯¾å¿œãŒå¿…è¦ãªRPNé–¾å€¤

        Returns:
            RPNã§ã‚½ãƒ¼ãƒˆã•ã‚ŒãŸDataFrame
        """
        if not self.failure_modes:
            return pd.DataFrame()

        df = pd.DataFrame(self.failure_modes)

        # RPNã§ã‚½ãƒ¼ãƒˆ
        df = df.sort_values('rpn', ascending=False)

        # ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«ã‚’åˆ†é¡
        df['risk_level'] = df['rpn'].apply(lambda x:
            'High' if x >= 200 else
            'Medium' if x >= 100 else
            'Low'
        )

        # å¯¾å¿œãŒå¿…è¦ãªé …ç›®ã‚’ãƒ•ãƒ©ã‚°
        df['action_required'] = df['rpn'] >= threshold

        return df

    def recommend_actions(self, index: int, actions: str):
        """æ¨å¥¨å‡¦ç½®ã‚’è¨˜éŒ²

        Args:
            index: æ•…éšœãƒ¢ãƒ¼ãƒ‰ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
            actions: æ¨å¥¨å‡¦ç½®ã®å†…å®¹
        """
        if 0 <= index < len(self.failure_modes):
            self.failure_modes[index]['recommended_actions'] = actions

    def record_actions_taken(self, index: int, actions: str,
                           new_severity: int, new_occurrence: int,
                           new_detection: int):
        """å®Ÿæ–½ã—ãŸå‡¦ç½®ã¨æ”¹å–„å¾Œã®è©•ä¾¡ã‚’è¨˜éŒ²

        Args:
            index: æ•…éšœãƒ¢ãƒ¼ãƒ‰ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹
            actions: å®Ÿæ–½ã—ãŸå‡¦ç½®
            new_severity: æ”¹å–„å¾Œã®æ·±åˆ»åº¦
            new_occurrence: æ”¹å–„å¾Œã®ç™ºç”Ÿé »åº¦
            new_detection: æ”¹å–„å¾Œã®æ¤œå‡ºåº¦
        """
        if 0 <= index < len(self.failure_modes):
            fm = self.failure_modes[index]
            fm['actions_taken'] = actions
            fm['new_severity'] = new_severity
            fm['new_occurrence'] = new_occurrence
            fm['new_detection'] = new_detection
            fm['new_rpn'] = new_severity * new_occurrence * new_detection

            print(f"RPNæ”¹å–„: {fm['rpn']} â†’ {fm['new_rpn']} "
                  f"({(1 - fm['new_rpn']/fm['rpn'])*100:.1f}%å‰Šæ¸›)")

    def generate_fmea_report(self, filename: str):
        """FMEAãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ

        Args:
            filename: å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆExcelå½¢å¼ï¼‰
        """
        df = self.prioritize_risks()

        # Excelå‡ºåŠ›
        with pd.ExcelWriter(filename, engine='openpyxl') as writer:
            df.to_excel(writer, sheet_name='FMEA', index=False)

            # ã‚µãƒãƒªãƒ¼ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
            summary = pd.DataFrame({
                'é …ç›®': [
                    'ç·æ•…éšœãƒ¢ãƒ¼ãƒ‰æ•°',
                    'é«˜ãƒªã‚¹ã‚¯é …ç›®ï¼ˆRPNâ‰¥200ï¼‰',
                    'ä¸­ãƒªã‚¹ã‚¯é …ç›®ï¼ˆ100â‰¤RPN<200ï¼‰',
                    'ä½ãƒªã‚¹ã‚¯é …ç›®ï¼ˆRPN<100ï¼‰',
                    'å¹³å‡RPN',
                    'æœ€å¤§RPN'
                ],
                'å€¤': [
                    len(df),
                    (df['rpn'] >= 200).sum(),
                    ((df['rpn'] >= 100) & (df['rpn'] < 200)).sum(),
                    (df['rpn'] < 100).sum(),
                    round(df['rpn'].mean(), 1),
                    df['rpn'].max()
                ]
            })

            summary.to_excel(writer, sheet_name='ã‚µãƒãƒªãƒ¼', index=False)

        print(f"FMEAãƒ¬ãƒãƒ¼ãƒˆã‚’ {filename} ã«å‡ºåŠ›ã—ã¾ã—ãŸ")


# ä½¿ç”¨ä¾‹
fmea = FMEASystem(fmea_type="Process")

# æ•…éšœãƒ¢ãƒ¼ãƒ‰ã‚’è¿½åŠ ï¼ˆè£½é€ ãƒ—ãƒ­ã‚»ã‚¹ã®ä¾‹ï¼‰
fmea.add_failure_mode(
    process_step="åŸææ–™å—å…¥æ¤œæŸ»",
    potential_failure="ä¸é©åˆåŸææ–™ã®å—å…¥",
    effects="ä¸è‰¯å“ã®è£½é€ ã€é¡§å®¢ã‚¯ãƒ¬ãƒ¼ãƒ ã€ãƒªã‚³ãƒ¼ãƒ«",
    severity=9,  # éå¸¸ã«æ·±åˆ»
    causes="æ¤œæŸ»åŸºæº–ã®ä¸æ˜ç¢ºã€æ¤œæŸ»å“¡ã®åŠ›é‡ä¸è¶³",
    occurrence=4,  # æ™‚ã€…ç™ºç”Ÿ
    current_controls="ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ¤œæŸ»",
    detection=5,  # æ¤œå‡ºã¯ã‚„ã‚„å›°é›£
    responsible_person="å“è³ªç®¡ç†éƒ¨"
)

fmea.add_failure_mode(
    process_step="æˆå½¢åŠ å·¥",
    potential_failure="å¯¸æ³•ä¸è‰¯",
    effects="çµ„ç«‹ä¸è‰¯ã€æ€§èƒ½ä½ä¸‹",
    severity=7,
    causes="é‡‘å‹ã®æ‘©è€—ã€æ¸©åº¦ç®¡ç†ä¸è‰¯",
    occurrence=6,
    current_controls="åˆå“æ¤œæŸ»ã€å®šæœŸæ¸¬å®š",
    detection=3,  # æ¯”è¼ƒçš„æ¤œå‡ºå®¹æ˜“
    responsible_person="è£½é€ éƒ¨"
)

fmea.add_failure_mode(
    process_step="æœ€çµ‚æ¤œæŸ»",
    potential_failure="æ¤œæŸ»æ¼ã‚Œ",
    effects="ä¸è‰¯å“ã®å‡ºè·",
    severity=10,  # æœ€ã‚‚æ·±åˆ»
    causes="æ¤œæŸ»é …ç›®ã®å¤šã•ã€æ™‚é–“çš„ãƒ—ãƒ¬ãƒƒã‚·ãƒ£ãƒ¼",
    occurrence=2,  # ç¨€ã«ç™ºç”Ÿ
    current_controls="ãƒ€ãƒ–ãƒ«ãƒã‚§ãƒƒã‚¯",
    detection=7,  # æ¤œå‡ºå›°é›£
    responsible_person="å“è³ªä¿è¨¼éƒ¨"
)

# ãƒªã‚¹ã‚¯å„ªå…ˆé †ä½ä»˜ã‘
print("=== FMEAãƒªã‚¹ã‚¯åˆ†æ ===")
risk_df = fmea.prioritize_risks(threshold=100)
print(risk_df[['process_step', 'potential_failure', 'rpn', 'risk_level']])

# æ¨å¥¨å‡¦ç½®ã‚’è¨˜éŒ²ï¼ˆæœ€é«˜RPNã®é …ç›®ã«å¯¾ã—ã¦ï¼‰
fmea.recommend_actions(
    index=2,  # æœ€çµ‚æ¤œæŸ»ã®æ¤œæŸ»æ¼ã‚Œ
    actions="è‡ªå‹•æ¤œæŸ»è£…ç½®ã®å°å…¥ã€æ¤œæŸ»æ‰‹é †ã®ç°¡ç´ åŒ–ã€ãƒªã‚¹ãƒˆã«ã‚ˆã‚‹ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ç¢ºä¿"
)

# å‡¦ç½®å®Ÿæ–½å¾Œã®è©•ä¾¡
fmea.record_actions_taken(
    index=2,
    actions="è‡ªå‹•å¤–è¦³æ¤œæŸ»è£…ç½®ã‚’å°å…¥ã€‚æ¤œæŸ»é …ç›®ã‚’é‡è¦åº¦ã§åˆ†é¡ã€‚",
    new_severity=10,  # æ·±åˆ»åº¦ã¯å¤‰ã‚ã‚‰ãš
    new_occurrence=1,  # ç™ºç”Ÿé »åº¦ãŒå¤§å¹…æ¸›å°‘
    new_detection=2    # æ¤œå‡ºåº¦ãŒæ”¹å–„ï¼ˆè‡ªå‹•åŒ–ã«ã‚ˆã‚Šï¼‰
)

# ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
fmea.generate_fmea_report("fmea_report.xlsx")</code></pre>
        </div>

        <div class="info-box">
            <h4>ğŸ“Š RPNã®è©•ä¾¡åŸºæº–</h4>
            <table>
                <thead>
                    <tr>
                        <th>RPNç¯„å›²</th>
                        <th>ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«</th>
                        <th>å¯¾å¿œ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>200-1000</td>
                        <td>é«˜ãƒªã‚¹ã‚¯</td>
                        <td>å³åº§ã«å‡¦ç½®ãŒå¿…è¦</td>
                    </tr>
                    <tr>
                        <td>100-199</td>
                        <td>ä¸­ãƒªã‚¹ã‚¯</td>
                        <td>è¨ˆç”»çš„ã«å‡¦ç½®ã‚’å®Ÿæ–½</td>
                    </tr>
                    <tr>
                        <td>1-99</td>
                        <td>ä½ãƒªã‚¹ã‚¯</td>
                        <td>ç›£è¦–ã‚’ç¶™ç¶š</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>4.3.2 ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å“è³ªè©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ </h3>

        <p>ISO 9001è¦æ±‚äº‹é …8.4ã€Œå¤–éƒ¨ã‹ã‚‰æä¾›ã•ã‚Œã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã€è£½å“åŠã³ã‚µãƒ¼ãƒ“ã‚¹ã®ç®¡ç†ã€ã«å¯¾å¿œã—ã¾ã™ã€‚</p>

        <div class="example-box">
            <div class="example-title">ä¾‹6: ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å“è³ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </div>
            <pre><code>import pandas as pd
from datetime import datetime
from typing import List, Dict
import numpy as np

class SupplierQualitySystem:
    """ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å“è³ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

    ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã®è©•ä¾¡ã€å“è³ªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®è¿½è·¡ã€
    æ”¹å–„æ´»å‹•ã®ç®¡ç†ã‚’è¡Œã†ã€‚
    """

    def __init__(self):
        self.suppliers = []
        self.quality_records = []

    def register_supplier(self, supplier_id: str, name: str,
                         product_category: str,
                         criticality: str = "Medium") -> Dict:
        """ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã‚’ç™»éŒ²

        Args:
            supplier_id: ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ID
            name: ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼å
            product_category: ä¾›çµ¦å“ç›®ã‚«ãƒ†ã‚´ãƒª
            criticality: é‡è¦åº¦ï¼ˆ"Critical", "High", "Medium", "Low"ï¼‰

        Returns:
            ç™»éŒ²ã•ã‚ŒãŸã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼æƒ…å ±
        """
        supplier = {
            "supplier_id": supplier_id,
            "name": name,
            "product_category": product_category,
            "criticality": criticality,
            "registration_date": datetime.now(),
            "status": "Approved",  # Approved, Conditional, Suspended
            "quality_score": None,
            "delivery_score": None,
            "overall_rating": None
        }

        self.suppliers.append(supplier)
        print(f"ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ç™»éŒ²: {name} ({supplier_id})")
        return supplier

    def record_quality_data(self, supplier_id: str,
                           delivery_date: datetime,
                           lot_number: str,
                           quantity_received: int,
                           quantity_accepted: int,
                           defect_count: int,
                           defect_types: str = "") -> Dict:
        """å“è³ªãƒ‡ãƒ¼ã‚¿ã‚’è¨˜éŒ²

        Args:
            supplier_id: ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ID
            delivery_date: ç´å“æ—¥
            lot_number: ãƒ­ãƒƒãƒˆç•ªå·
            quantity_received: å—é ˜æ•°é‡
            quantity_accepted: åˆæ ¼æ•°é‡
            defect_count: ä¸è‰¯æ•°
            defect_types: ä¸è‰¯ã®ç¨®é¡

        Returns:
            è¨˜éŒ²ã•ã‚ŒãŸå“è³ªãƒ‡ãƒ¼ã‚¿
        """
        # PPMï¼ˆParts Per Millionï¼‰ã‚’è¨ˆç®—
        ppm = (defect_count / quantity_received * 1_000_000) if quantity_received > 0 else 0

        record = {
            "supplier_id": supplier_id,
            "delivery_date": delivery_date,
            "lot_number": lot_number,
            "quantity_received": quantity_received,
            "quantity_accepted": quantity_accepted,
            "defect_count": defect_count,
            "defect_types": defect_types,
            "ppm": ppm,
            "acceptance_rate": (quantity_accepted / quantity_received * 100)
                               if quantity_received > 0 else 0
        }

        self.quality_records.append(record)
        return record

    def calculate_supplier_rating(self, supplier_id: str,
                                 months: int = 6) -> Dict:
        """ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã®è©•ä¾¡ã‚’è¨ˆç®—

        Args:
            supplier_id: ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ID
            months: è©•ä¾¡æœŸé–“ï¼ˆæœˆæ•°ï¼‰

        Returns:
            è©•ä¾¡çµæœ
        """
        # æœŸé–“å†…ã®å“è³ªè¨˜éŒ²ã‚’å–å¾—
        cutoff_date = datetime.now() - pd.Timedelta(days=months * 30)
        records = [
            r for r in self.quality_records
            if r['supplier_id'] == supplier_id and r['delivery_date'] >= cutoff_date
        ]

        if not records:
            return {"error": "è©•ä¾¡æœŸé–“å†…ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“"}

        df = pd.DataFrame(records)

        # å“è³ªã‚¹ã‚³ã‚¢ï¼ˆ0-100ï¼‰
        avg_ppm = df['ppm'].mean()
        quality_score = max(0, 100 - (avg_ppm / 100))  # 10,000 PPM = 0ç‚¹

        # ç·åˆè©•ä¾¡ï¼ˆA-Dï¼‰
        if quality_score >= 95:
            overall_rating = "A"
        elif quality_score >= 85:
            overall_rating = "B"
        elif quality_score >= 70:
            overall_rating = "C"
        else:
            overall_rating = "D"

        rating = {
            "supplier_id": supplier_id,
            "evaluation_period": f"{months}ãƒ¶æœˆ",
            "total_deliveries": len(records),
            "total_quantity": df['quantity_received'].sum(),
            "total_defects": df['defect_count'].sum(),
            "avg_ppm": round(avg_ppm, 2),
            "quality_score": round(quality_score, 2),
            "overall_rating": overall_rating
        }

        # ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼æƒ…å ±ã‚’æ›´æ–°
        supplier = self._find_supplier(supplier_id)
        if supplier:
            supplier['quality_score'] = quality_score
            supplier['overall_rating'] = overall_rating

        return rating

    def get_supplier_performance_summary(self) -> pd.DataFrame:
        """å…¨ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚µãƒãƒªãƒ¼ã‚’å–å¾—

        Returns:
            ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼åˆ¥ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹DataFrame
        """
        if not self.suppliers:
            return pd.DataFrame()

        # å„ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã®è©•ä¾¡ã‚’è¨ˆç®—
        for supplier in self.suppliers:
            self.calculate_supplier_rating(supplier['supplier_id'])

        df = pd.DataFrame(self.suppliers)

        # é‡è¦åº¦ã§ã‚½ãƒ¼ãƒˆ
        criticality_order = {"Critical": 0, "High": 1, "Medium": 2, "Low": 3}
        df['criticality_rank'] = df['criticality'].map(criticality_order)
        df = df.sort_values(['criticality_rank', 'quality_score'], ascending=[True, False])

        return df[['supplier_id', 'name', 'criticality',
                  'quality_score', 'overall_rating', 'status']]

    def identify_improvement_targets(self, threshold_rating: str = "C") -> List[Dict]:
        """æ”¹å–„å¯¾è±¡ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã‚’ç‰¹å®š

        Args:
            threshold_rating: æ”¹å–„å¯¾è±¡ã¨ã™ã‚‹è©•ä¾¡é–¾å€¤

        Returns:
            æ”¹å–„å¯¾è±¡ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã®ãƒªã‚¹ãƒˆ
        """
        rating_map = {"A": 4, "B": 3, "C": 2, "D": 1}
        threshold_value = rating_map.get(threshold_rating, 2)

        targets = []
        for supplier in self.suppliers:
            if supplier['overall_rating']:
                rating_value = rating_map.get(supplier['overall_rating'], 0)
                if rating_value <= threshold_value:
                    targets.append({
                        "supplier_id": supplier['supplier_id'],
                        "name": supplier['name'],
                        "rating": supplier['overall_rating'],
                        "quality_score": supplier['quality_score'],
                        "action": "å“è³ªæ”¹å–„è¨ˆç”»ã®ç­–å®šã¨å®Ÿæ–½ãŒå¿…è¦"
                    })

        return targets

    def _find_supplier(self, supplier_id: str) -> Optional[Dict]:
        """ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼IDã§ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã‚’æ¤œç´¢ï¼ˆå†…éƒ¨ç”¨ï¼‰"""
        for supplier in self.suppliers:
            if supplier['supplier_id'] == supplier_id:
                return supplier
        return None


# ä½¿ç”¨ä¾‹
sqs = SupplierQualitySystem()

# ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã‚’ç™»éŒ²
sqs.register_supplier("SUP-001", "ABCéƒ¨å“å·¥æ¥­", "é›»å­éƒ¨å“", criticality="Critical")
sqs.register_supplier("SUP-002", "XYZæ¨¹è„‚", "æ¨¹è„‚ææ–™", criticality="High")
sqs.register_supplier("SUP-003", "123æ¢±åŒ…è³‡æ", "æ¢±åŒ…æ", criticality="Low")

# å“è³ªãƒ‡ãƒ¼ã‚¿ã‚’è¨˜éŒ²
sqs.record_quality_data(
    supplier_id="SUP-001",
    delivery_date=datetime(2025, 1, 15),
    lot_number="LOT-20250115-001",
    quantity_received=10000,
    quantity_accepted=9950,
    defect_count=50,
    defect_types="å¯¸æ³•ä¸è‰¯"
)

sqs.record_quality_data(
    supplier_id="SUP-001",
    delivery_date=datetime(2025, 2, 20),
    lot_number="LOT-20250220-002",
    quantity_received=15000,
    quantity_accepted=14800,
    defect_count=200,
    defect_types="å¤–è¦³ä¸è‰¯ã€å¯¸æ³•ä¸è‰¯"
)

sqs.record_quality_data(
    supplier_id="SUP-002",
    delivery_date=datetime(2025, 1, 10),
    lot_number="LOT-20250110-001",
    quantity_received=5000,
    quantity_accepted=4990,
    defect_count=10,
    defect_types="è‰²ãƒ ãƒ©"
)

# ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼è©•ä¾¡
print("=== ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼è©•ä¾¡ ===")
rating = sqs.calculate_supplier_rating("SUP-001", months=6)
for key, value in rating.items():
    print(f"{key}: {value}")

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚µãƒãƒªãƒ¼
print("\n=== ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚µãƒãƒªãƒ¼ ===")
print(sqs.get_supplier_performance_summary())

# æ”¹å–„å¯¾è±¡ã®ç‰¹å®š
print("\n=== æ”¹å–„å¯¾è±¡ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ ===")
targets = sqs.identify_improvement_targets(threshold_rating="B")
for target in targets:
    print(f"{target['name']} - è©•ä¾¡: {target['rating']}, ã‚¹ã‚³ã‚¢: {target['quality_score']}")
    print(f"  â†’ {target['action']}")</code></pre>
        </div>

        <h3>4.3.3 å“è³ªç›®æ¨™KPIè¿½è·¡ã‚·ã‚¹ãƒ†ãƒ </h3>

        <p>ISO 9001è¦æ±‚äº‹é …6.2ã€Œå“è³ªç›®æ¨™åŠã³ãã‚Œã‚’é”æˆã™ã‚‹ãŸã‚ã®è¨ˆç”»ç­–å®šã€ã«å¯¾å¿œã—ã¾ã™ã€‚</p>

        <div class="example-box">
            <div class="example-title">ä¾‹7: å“è³ªç›®æ¨™KPIç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </div>
            <pre><code>import pandas as pd
from datetime import datetime
from typing import List, Dict, Optional
import matplotlib.pyplot as plt

class QualityKPISystem:
    """å“è³ªç›®æ¨™ã¨KPIã®ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 

    å“è³ªç›®æ¨™ã®è¨­å®šã€KPIã®è¿½è·¡ã€é”æˆçŠ¶æ³ã®å¯è¦–åŒ–ã‚’è¡Œã†ã€‚
    """

    def __init__(self, fiscal_year: int):
        self.fiscal_year = fiscal_year
        self.objectives = []
        self.kpi_data = []

    def define_objective(self, objective_id: str, title: str,
                        kpi_name: str, target_value: float,
                        unit: str, measurement_frequency: str,
                        responsible_dept: str) -> Dict:
        """å“è³ªç›®æ¨™ã‚’å®šç¾©

        Args:
            objective_id: ç›®æ¨™ID
            title: ç›®æ¨™ã‚¿ã‚¤ãƒˆãƒ«
            kpi_name: KPIåç§°
            target_value: ç›®æ¨™å€¤
            unit: å˜ä½
            measurement_frequency: æ¸¬å®šé »åº¦ï¼ˆ"Daily", "Weekly", "Monthly"ï¼‰
            responsible_dept: è²¬ä»»éƒ¨é–€

        Returns:
            å®šç¾©ã•ã‚ŒãŸç›®æ¨™æƒ…å ±
        """
        objective = {
            "objective_id": objective_id,
            "title": title,
            "kpi_name": kpi_name,
            "target_value": target_value,
            "unit": unit,
            "measurement_frequency": measurement_frequency,
            "responsible_dept": responsible_dept,
            "fiscal_year": self.fiscal_year,
            "status": "Active"  # Active, Achieved, At Risk, Not Achieved
        }

        self.objectives.append(objective)
        print(f"å“è³ªç›®æ¨™è¨­å®š: {title} (ç›®æ¨™å€¤: {target_value}{unit})")
        return objective

    def record_kpi_data(self, objective_id: str,
                       measurement_date: datetime,
                       actual_value: float,
                       notes: str = "") -> Dict:
        """KPIå®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿ã‚’è¨˜éŒ²

        Args:
            objective_id: ç›®æ¨™ID
            measurement_date: æ¸¬å®šæ—¥
            actual_value: å®Ÿç¸¾å€¤
            notes: å‚™è€ƒ

        Returns:
            è¨˜éŒ²ã•ã‚ŒãŸKPIãƒ‡ãƒ¼ã‚¿
        """
        objective = self._find_objective(objective_id)
        if not objective:
            raise ValueError(f"ç›®æ¨™ {objective_id} ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")

        # ç›®æ¨™é”æˆç‡ã‚’è¨ˆç®—
        achievement_rate = (actual_value / objective['target_value'] * 100)

        kpi_record = {
            "objective_id": objective_id,
            "measurement_date": measurement_date,
            "actual_value": actual_value,
            "target_value": objective['target_value'],
            "achievement_rate": achievement_rate,
            "notes": notes
        }

        self.kpi_data.append(kpi_record)
        return kpi_record

    def get_kpi_trend(self, objective_id: str) -> pd.DataFrame:
        """KPIã®ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

        Args:
            objective_id: ç›®æ¨™ID

        Returns:
            ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ‡ãƒ¼ã‚¿ã®DataFrame
        """
        records = [
            r for r in self.kpi_data if r['objective_id'] == objective_id
        ]

        if not records:
            return pd.DataFrame()

        df = pd.DataFrame(records)
        df = df.sort_values('measurement_date')

        return df

    def evaluate_objective_status(self, objective_id: str) -> str:
        """ç›®æ¨™ã®é”æˆçŠ¶æ³ã‚’è©•ä¾¡

        Args:
            objective_id: ç›®æ¨™ID

        Returns:
            ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆ"Achieved", "On Track", "At Risk", "Not Achieved"ï¼‰
        """
        df = self.get_kpi_trend(objective_id)

        if df.empty:
            return "No Data"

        # ç›´è¿‘3å›ã®å¹³å‡é”æˆç‡ã‚’è©•ä¾¡
        recent_achievement = df.tail(3)['achievement_rate'].mean()

        if recent_achievement >= 100:
            status = "Achieved"
        elif recent_achievement >= 90:
            status = "On Track"
        elif recent_achievement >= 70:
            status = "At Risk"
        else:
            status = "Not Achieved"

        # ç›®æ¨™æƒ…å ±ã‚’æ›´æ–°
        objective = self._find_objective(objective_id)
        if objective:
            objective['status'] = status

        return status

    def get_objectives_dashboard(self) -> pd.DataFrame:
        """å“è³ªç›®æ¨™ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’å–å¾—

        Returns:
            å…¨ç›®æ¨™ã®é”æˆçŠ¶æ³ã‚’ç¤ºã™DataFrame
        """
        if not self.objectives:
            return pd.DataFrame()

        # å„ç›®æ¨™ã®çŠ¶æ³ã‚’è©•ä¾¡
        for obj in self.objectives:
            self.evaluate_objective_status(obj['objective_id'])

        df = pd.DataFrame(self.objectives)

        # æœ€æ–°ã®å®Ÿç¸¾å€¤ã‚’è¿½åŠ 
        for idx, obj in df.iterrows():
            trend_df = self.get_kpi_trend(obj['objective_id'])
            if not trend_df.empty:
                latest = trend_df.iloc[-1]
                df.at[idx, 'latest_value'] = latest['actual_value']
                df.at[idx, 'latest_achievement_rate'] = latest['achievement_rate']
            else:
                df.at[idx, 'latest_value'] = None
                df.at[idx, 'latest_achievement_rate'] = None

        return df[['objective_id', 'title', 'target_value', 'unit',
                  'latest_value', 'latest_achievement_rate', 'status',
                  'responsible_dept']]

    def generate_kpi_report(self, objective_id: str, filename: str):
        """KPIãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰ã‚°ãƒ©ãƒ•ä»˜ãï¼‰

        Args:
            objective_id: ç›®æ¨™ID
            filename: å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆPNGå½¢å¼ï¼‰
        """
        df = self.get_kpi_trend(objective_id)
        objective = self._find_objective(objective_id)

        if df.empty or not objective:
            print("ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã¾ã™")
            return

        # ã‚°ãƒ©ãƒ•ä½œæˆ
        fig, ax = plt.subplots(figsize=(10, 6))

        # å®Ÿç¸¾å€¤ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
        ax.plot(df['measurement_date'], df['actual_value'],
               marker='o', label='å®Ÿç¸¾å€¤', linewidth=2)

        # ç›®æ¨™å€¤ã®ãƒ©ã‚¤ãƒ³ã‚’è¿½åŠ 
        ax.axhline(y=objective['target_value'], color='r',
                  linestyle='--', label='ç›®æ¨™å€¤')

        ax.set_xlabel('æ¸¬å®šæ—¥')
        ax.set_ylabel(f"{objective['kpi_name']} ({objective['unit']})")
        ax.set_title(f"{objective['title']} - KPIãƒˆãƒ¬ãƒ³ãƒ‰")
        ax.legend()
        ax.grid(True, alpha=0.3)

        plt.xticks(rotation=45)
        plt.tight_layout()
        plt.savefig(filename, dpi=300)
        plt.close()

        print(f"KPIãƒ¬ãƒãƒ¼ãƒˆã‚’ {filename} ã«å‡ºåŠ›ã—ã¾ã—ãŸ")

    def _find_objective(self, objective_id: str) -> Optional[Dict]:
        """ç›®æ¨™IDã§ç›®æ¨™ã‚’æ¤œç´¢ï¼ˆå†…éƒ¨ç”¨ï¼‰"""
        for obj in self.objectives:
            if obj['objective_id'] == objective_id:
                return obj
        return None


# ä½¿ç”¨ä¾‹
kpi_system = QualityKPISystem(fiscal_year=2025)

# å“è³ªç›®æ¨™ã‚’å®šç¾©
kpi_system.define_objective(
    objective_id="OBJ-2025-001",
    title="é¡§å®¢ã‚¯ãƒ¬ãƒ¼ãƒ å‰Šæ¸›",
    kpi_name="é¡§å®¢ã‚¯ãƒ¬ãƒ¼ãƒ ä»¶æ•°",
    target_value=10,
    unit="ä»¶/æœˆ",
    measurement_frequency="Monthly",
    responsible_dept="å“è³ªä¿è¨¼éƒ¨"
)

kpi_system.define_objective(
    objective_id="OBJ-2025-002",
    title="å·¥ç¨‹å†…ä¸è‰¯ç‡å‰Šæ¸›",
    kpi_name="å·¥ç¨‹å†…ä¸è‰¯ç‡",
    target_value=0.5,
    unit="%",
    measurement_frequency="Monthly",
    responsible_dept="è£½é€ éƒ¨"
)

# KPIå®Ÿç¸¾ã‚’è¨˜éŒ²
for month in range(1, 7):
    kpi_system.record_kpi_data(
        objective_id="OBJ-2025-001",
        measurement_date=datetime(2025, month, 1),
        actual_value=15 - month,  # æ”¹å–„å‚¾å‘
        notes=f"{month}æœˆå®Ÿç¸¾"
    )

    kpi_system.record_kpi_data(
        objective_id="OBJ-2025-002",
        measurement_date=datetime(2025, month, 1),
        actual_value=1.0 - (month * 0.08),  # æ”¹å–„å‚¾å‘
        notes=f"{month}æœˆå®Ÿç¸¾"
    )

# ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º
print("=== å“è³ªç›®æ¨™ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ ===")
print(kpi_system.get_objectives_dashboard())

# ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è©•ä¾¡
print("\n=== é”æˆçŠ¶æ³è©•ä¾¡ ===")
for obj_id in ["OBJ-2025-001", "OBJ-2025-002"]:
    status = kpi_system.evaluate_objective_status(obj_id)
    print(f"{obj_id}: {status}")</code></pre>
        </div>

        <h3>4.3.4 ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼å ±å‘Šæ›¸ç”Ÿæˆ</h3>

        <p>ISO 9001è¦æ±‚äº‹é …9.3ã€Œãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ã€ã«å¯¾å¿œã™ã‚‹å ±å‘Šæ›¸ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚</p>

        <div class="example-box">
            <div class="example-title">ä¾‹8: ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼å ±å‘Šæ›¸ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ </div>
            <pre><code>from datetime import datetime
import pandas as pd
from typing import Dict, List
import json

class ManagementReviewSystem:
    """ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼å ±å‘Šæ›¸ç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 

    ISO 9001è¦æ±‚äº‹é …9.3ã«åŸºã¥ãã€QMSã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨
    æ”¹å–„æ©Ÿä¼šã‚’çµŒå–¶å±¤ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼ã™ã‚‹ãŸã‚ã®å ±å‘Šæ›¸ã‚’ç”Ÿæˆã€‚
    """

    def __init__(self, review_date: datetime, review_period: str):
        """
        Args:
            review_date: ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½æ—¥
            review_period: ãƒ¬ãƒ“ãƒ¥ãƒ¼æœŸé–“ï¼ˆä¾‹: "2024å¹´åº¦ ä¸‹åŠæœŸ"ï¼‰
        """
        self.review_date = review_date
        self.review_period = review_period
        self.review_data = {
            "basic_info": {
                "review_date": review_date.strftime("%Y-%m-%d"),
                "review_period": review_period,
                "attendees": []
            },
            "inputs": {},
            "decisions": [],
            "action_items": []
        }

    def add_attendee(self, name: str, position: str):
        """å‡ºå¸­è€…ã‚’è¿½åŠ 

        Args:
            name: æ°å
            position: å½¹è·
        """
        self.review_data["basic_info"]["attendees"].append({
            "name": name,
            "position": position
        })

    def add_customer_feedback(self, satisfaction_score: float,
                             complaint_count: int,
                             positive_feedback: str,
                             improvement_areas: str):
        """é¡§å®¢ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’è¿½åŠ ï¼ˆISO 9001 9.3.2 aï¼‰

        Args:
            satisfaction_score: é¡§å®¢æº€è¶³åº¦ã‚¹ã‚³ã‚¢ï¼ˆ0-100ï¼‰
            complaint_count: ã‚¯ãƒ¬ãƒ¼ãƒ ä»¶æ•°
            positive_feedback: è‚¯å®šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            improvement_areas: æ”¹å–„ãŒå¿…è¦ãªé ˜åŸŸ
        """
        self.review_data["inputs"]["customer_feedback"] = {
            "satisfaction_score": satisfaction_score,
            "complaint_count": complaint_count,
            "positive_feedback": positive_feedback,
            "improvement_areas": improvement_areas
        }

    def add_conformity_status(self, audit_results: str,
                             nc_count: int,
                             capa_completion_rate: float):
        """é©åˆæ€§ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è¿½åŠ ï¼ˆISO 9001 9.3.2 b, cï¼‰

        Args:
            audit_results: ç›£æŸ»çµæœã‚µãƒãƒªãƒ¼
            nc_count: ä¸é©åˆä»¶æ•°
            capa_completion_rate: CAPAå®Œäº†ç‡ï¼ˆ%ï¼‰
        """
        self.review_data["inputs"]["conformity_status"] = {
            "audit_results": audit_results,
            "nc_count": nc_count,
            "capa_completion_rate": capa_completion_rate
        }

    def add_process_performance(self, kpi_summary: Dict[str, float],
                               process_efficiency: float):
        """ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’è¿½åŠ ï¼ˆISO 9001 9.3.2 dï¼‰

        Args:
            kpi_summary: KPIã‚µãƒãƒªãƒ¼ï¼ˆKPIå: é”æˆç‡ï¼‰
            process_efficiency: ãƒ—ãƒ­ã‚»ã‚¹åŠ¹ç‡ï¼ˆ%ï¼‰
        """
        self.review_data["inputs"]["process_performance"] = {
            "kpi_summary": kpi_summary,
            "process_efficiency": process_efficiency
        }

    def add_resource_adequacy(self, resource_status: str,
                             training_completion: float,
                             infrastructure_issues: str):
        """è³‡æºã®å¦¥å½“æ€§ã‚’è¿½åŠ ï¼ˆISO 9001 9.3.2 eï¼‰

        Args:
            resource_status: è³‡æºçŠ¶æ³ã®è©•ä¾¡
            training_completion: æ•™è‚²è¨“ç·´å®Œäº†ç‡ï¼ˆ%ï¼‰
            infrastructure_issues: ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£ã®èª²é¡Œ
        """
        self.review_data["inputs"]["resource_adequacy"] = {
            "resource_status": resource_status,
            "training_completion": training_completion,
            "infrastructure_issues": infrastructure_issues
        }

    def add_improvement_actions(self, actions_planned: int,
                               actions_completed: int,
                               effectiveness_rate: float):
        """æ”¹å–„å‡¦ç½®ã®æœ‰åŠ¹æ€§ã‚’è¿½åŠ ï¼ˆISO 9001 9.3.2 fï¼‰

        Args:
            actions_planned: è¨ˆç”»ã•ã‚ŒãŸæ”¹å–„å‡¦ç½®æ•°
            actions_completed: å®Œäº†ã—ãŸæ”¹å–„å‡¦ç½®æ•°
            effectiveness_rate: æœ‰åŠ¹æ€§ç¢ºèªç‡ï¼ˆ%ï¼‰
        """
        self.review_data["inputs"]["improvement_actions"] = {
            "actions_planned": actions_planned,
            "actions_completed": actions_completed,
            "completion_rate": (actions_completed / actions_planned * 100)
                               if actions_planned > 0 else 0,
            "effectiveness_rate": effectiveness_rate
        }

    def add_changes_impact(self, internal_changes: str,
                          external_changes: str,
                          impact_assessment: str):
        """å¤‰æ›´ã®å½±éŸ¿ã‚’è¿½åŠ ï¼ˆISO 9001 9.3.2 gï¼‰

        Args:
            internal_changes: å†…éƒ¨å¤‰æ›´
            external_changes: å¤–éƒ¨å¤‰æ›´
            impact_assessment: å½±éŸ¿è©•ä¾¡
        """
        self.review_data["inputs"]["changes_impact"] = {
            "internal_changes": internal_changes,
            "external_changes": external_changes,
            "impact_assessment": impact_assessment
        }

    def add_decision(self, decision_type: str, decision: str,
                    responsible: str, due_date: str):
        """çµŒå–¶å±¤ã®æ±ºå®šäº‹é …ã‚’è¿½åŠ ï¼ˆISO 9001 9.3.3ï¼‰

        Args:
            decision_type: "QMS Improvement", "Product/Service Improvement",
                          "Resource Needs"
            decision: æ±ºå®šå†…å®¹
            responsible: è²¬ä»»è€…
            due_date: æœŸé™
        """
        self.review_data["decisions"].append({
            "type": decision_type,
            "decision": decision,
            "responsible": responsible,
            "due_date": due_date
        })

    def add_action_item(self, action: str, responsible: str,
                       due_date: str, priority: str):
        """ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ 

        Args:
            action: ã‚¢ã‚¯ã‚·ãƒ§ãƒ³å†…å®¹
            responsible: è²¬ä»»è€…
            due_date: æœŸé™
            priority: å„ªå…ˆåº¦ï¼ˆ"High", "Medium", "Low"ï¼‰
        """
        self.review_data["action_items"].append({
            "action": action,
            "responsible": responsible,
            "due_date": due_date,
            "priority": priority,
            "status": "Open"
        })

    def generate_report(self, filename: str):
        """ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼å ±å‘Šæ›¸ã‚’ç”Ÿæˆ

        Args:
            filename: å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆJSONå½¢å¼ï¼‰
        """
        # ç·åˆè©•ä¾¡ã‚’è¿½åŠ 
        self.review_data["overall_assessment"] = self._calculate_overall_assessment()

        with open(filename, 'w', encoding='utf-8') as f:
            json.dump(self.review_data, f, indent=2, ensure_ascii=False)

        print(f"ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼å ±å‘Šæ›¸ã‚’ {filename} ã«å‡ºåŠ›ã—ã¾ã—ãŸ")

        # ã‚µãƒãƒªãƒ¼ã‚’è¡¨ç¤º
        self._print_summary()

    def _calculate_overall_assessment(self) -> Dict:
        """ç·åˆè©•ä¾¡ã‚’è¨ˆç®—ï¼ˆå†…éƒ¨ç”¨ï¼‰"""
        inputs = self.review_data["inputs"]

        # ã‚¹ã‚³ã‚¢è¨ˆç®—
        scores = []

        if "customer_feedback" in inputs:
            scores.append(inputs["customer_feedback"]["satisfaction_score"])

        if "conformity_status" in inputs:
            scores.append(inputs["conformity_status"]["capa_completion_rate"])

        if "process_performance" in inputs:
            scores.append(inputs["process_performance"]["process_efficiency"])

        if "resource_adequacy" in inputs:
            scores.append(inputs["resource_adequacy"]["training_completion"])

        if "improvement_actions" in inputs:
            scores.append(inputs["improvement_actions"]["completion_rate"])

        avg_score = sum(scores) / len(scores) if scores else 0

        # è©•ä¾¡ãƒ©ãƒ³ã‚¯
        if avg_score >= 90:
            rank = "Excellent"
        elif avg_score >= 80:
            rank = "Good"
        elif avg_score >= 70:
            rank = "Acceptable"
        else:
            rank = "Needs Improvement"

        return {
            "average_score": round(avg_score, 2),
            "rank": rank,
            "total_decisions": len(self.review_data["decisions"]),
            "total_actions": len(self.review_data["action_items"])
        }

    def _print_summary(self):
        """ã‚µãƒãƒªãƒ¼ã‚’è¡¨ç¤ºï¼ˆå†…éƒ¨ç”¨ï¼‰"""
        assessment = self.review_data["overall_assessment"]

        print("\n" + "="*60)
        print("ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ ã‚µãƒãƒªãƒ¼")
        print("="*60)
        print(f"ãƒ¬ãƒ“ãƒ¥ãƒ¼æœŸé–“: {self.review_period}")
        print(f"å®Ÿæ–½æ—¥: {self.review_date.strftime('%Yå¹´%mæœˆ%dæ—¥')}")
        print(f"å‡ºå¸­è€…: {len(self.review_data['basic_info']['attendees'])}å")
        print(f"\nç·åˆè©•ä¾¡: {assessment['rank']} ({assessment['average_score']}ç‚¹)")
        print(f"æ±ºå®šäº‹é …: {assessment['total_decisions']}ä»¶")
        print(f"ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ : {assessment['total_actions']}ä»¶")
        print("="*60)


# ä½¿ç”¨ä¾‹
mr_system = ManagementReviewSystem(
    review_date=datetime(2025, 3, 15),
    review_period="2024å¹´åº¦ ä¸‹åŠæœŸ"
)

# å‡ºå¸­è€…ã‚’è¿½åŠ 
mr_system.add_attendee("å±±ç”°å¤ªéƒ", "ä»£è¡¨å–ç· å½¹ç¤¾é•·")
mr_system.add_attendee("ä½è—¤èŠ±å­", "å“è³ªç®¡ç†éƒ¨é•·")
mr_system.add_attendee("éˆ´æœ¨ä¸€éƒ", "è£½é€ éƒ¨é•·")

# ã‚¤ãƒ³ãƒ—ãƒƒãƒˆæƒ…å ±ã‚’è¿½åŠ 
mr_system.add_customer_feedback(
    satisfaction_score=85.5,
    complaint_count=12,
    positive_feedback="ç´æœŸéµå®ˆç‡ãŒæ”¹å–„ã€‚è£½å“å“è³ªãŒå®‰å®šã€‚",
    improvement_areas="æŠ€è¡“ã‚µãƒãƒ¼ãƒˆå¯¾å¿œã®è¿…é€ŸåŒ–"
)

mr_system.add_conformity_status(
    audit_results="å†…éƒ¨ç›£æŸ»5å›å®Ÿæ–½ã€‚Major NC 0ä»¶ã€Minor NC 3ä»¶ã€‚",
    nc_count=3,
    capa_completion_rate=92.0
)

mr_system.add_process_performance(
    kpi_summary={
        "é¡§å®¢ã‚¯ãƒ¬ãƒ¼ãƒ å‰Šæ¸›": 95.0,
        "å·¥ç¨‹å†…ä¸è‰¯ç‡å‰Šæ¸›": 88.0,
        "ç´æœŸéµå®ˆç‡": 98.0
    },
    process_efficiency=91.5
)

mr_system.add_resource_adequacy(
    resource_status="æ¦‚ã­é©åˆ‡ã€‚ä¸€éƒ¨è¨­å‚™ã®è€æœ½åŒ–ãŒèª²é¡Œã€‚",
    training_completion=87.0,
    infrastructure_issues="æ¸¬å®šæ©Ÿå™¨ã®æ ¡æ­£ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ æ›´æ–°ãŒå¿…è¦"
)

mr_system.add_improvement_actions(
    actions_planned=15,
    actions_completed=13,
    effectiveness_rate=85.0
)

mr_system.add_changes_impact(
    internal_changes="æ–°è£½é€ ãƒ©ã‚¤ãƒ³ã®å°å…¥ã€å“è³ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–",
    external_changes="ISO 9001:2015æ”¹è¨‚ç‰ˆã¸ã®ç§»è¡Œæº–å‚™",
    impact_assessment="ãƒã‚¸ãƒ†ã‚£ãƒ–ãªå½±éŸ¿ã€‚è¿½åŠ ãƒªã‚½ãƒ¼ã‚¹ãŒå¿…è¦ã€‚"
)

# æ±ºå®šäº‹é …ã‚’è¿½åŠ 
mr_system.add_decision(
    decision_type="QMS Improvement",
    decision="å“è³ªç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–ã‚’2025å¹´åº¦ç¬¬2å››åŠæœŸã¾ã§ã«å®Œäº†",
    responsible="å“è³ªç®¡ç†éƒ¨é•·",
    due_date="2025-09-30"
)

mr_system.add_decision(
    decision_type="Resource Needs",
    decision="æ¸¬å®šæ©Ÿå™¨ã®æ›´æ–°äºˆç®—ã‚’ç¢ºä¿ï¼ˆ500ä¸‡å††ï¼‰",
    responsible="çµŒå–¶ä¼ç”»éƒ¨é•·",
    due_date="2025-06-30"
)

# ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ 
mr_system.add_action_item(
    action="æŠ€è¡“ã‚µãƒãƒ¼ãƒˆå¯¾å¿œæ™‚é–“ã‚’24æ™‚é–“ä»¥å†…ã«çŸ­ç¸®ã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ§‹ç¯‰",
    responsible="å–¶æ¥­éƒ¨é•·",
    due_date="2025-05-31",
    priority="High"
)

mr_system.add_action_item(
    action="å†…éƒ¨ç›£æŸ»å“¡ã®åŠ›é‡å‘ä¸Šç ”ä¿®ã‚’å®Ÿæ–½",
    responsible="å“è³ªç®¡ç†éƒ¨é•·",
    due_date="2025-04-30",
    priority="Medium"
)

# å ±å‘Šæ›¸ã‚’ç”Ÿæˆ
mr_system.generate_report("management_review_2024H2.json")</code></pre>
        </div>

        <h2>ã¾ã¨ã‚</h2>

        <p>ã“ã®ç« ã§ã¯ã€ISO 9001å“è³ªãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆã‚·ã‚¹ãƒ†ãƒ ã®è¦æ±‚äº‹é …ã¨ã€Pythonã‚’ä½¿ã£ãŸå®Ÿè·µçš„ãªå®Ÿè£…æ–¹æ³•ã‚’å­¦ã³ã¾ã—ãŸã€‚</p>

        <div class="info-box">
            <h4>ğŸ“š é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h4>
            <ul>
                <li><strong>ISO 9001ã®7åŸå‰‡</strong>: é¡§å®¢é‡è¦–ã€ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€äººã€…ã®å‚åŠ ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã€æ”¹å–„ã€å®¢è¦³çš„äº‹å®Ÿã€é–¢ä¿‚æ€§ç®¡ç†</li>
                <li><strong>æ–‡æ›¸ç®¡ç†</strong>: ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã€æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€å®šæœŸè¦‹ç›´ã—</li>
                <li><strong>å†…éƒ¨ç›£æŸ»</strong>: è¨ˆç”»çš„ãªå®Ÿæ–½ã€ç™ºè¦‹äº‹é …ã®è¿½è·¡ã€æ˜¯æ­£å‡¦ç½®</li>
                <li><strong>CAPA</strong>: æ ¹æœ¬åŸå› åˆ†æã€æ˜¯æ­£å‡¦ç½®ã€æœ‰åŠ¹æ€§ç¢ºèª</li>
                <li><strong>ãƒªã‚¹ã‚¯ãƒ™ãƒ¼ã‚¹æ€è€ƒ</strong>: FMEAã«ã‚ˆã‚‹ãƒªã‚¹ã‚¯è©•ä¾¡ã¨RPNè¨ˆç®—</li>
                <li><strong>ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ç®¡ç†</strong>: å“è³ªè©•ä¾¡ã€PPMç®¡ç†ã€æ”¹å–„æ´»å‹•</li>
                <li><strong>KPIç®¡ç†</strong>: å“è³ªç›®æ¨™ã®è¨­å®šã€è¿½è·¡ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰åŒ–</li>
                <li><strong>ãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼</strong>: QMSãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®å®šæœŸçš„è©•ä¾¡</li>
            </ul>
        </div>

        <div class="nav-links">
            <a href="chapter-3.html">â† ç¬¬3ç« ï¼šçµ±è¨ˆçš„å“è³ªç®¡ç†ï¼ˆSQCï¼‰</a>
            <a href="chapter-5.html">ç¬¬5ç« ï¼šPythonã«ã‚ˆã‚‹å“è³ªç®¡ç†ã®è‡ªå‹•åŒ– â†’</a>
        </div>
    </div>
</body>
</html>