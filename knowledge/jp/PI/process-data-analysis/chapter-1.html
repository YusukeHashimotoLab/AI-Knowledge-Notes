<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬1ç« ï¼šæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿è§£æã®åŸºç¤ - ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿è§£æå®Ÿè·µã‚·ãƒªãƒ¼ã‚º">
    <title>ç¬¬1ç« ï¼šæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿è§£æã®åŸºç¤ - ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿è§£æå®Ÿè·µ | PI Knowledge Hub</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #11998e;
            --color-accent-light: #38ef7d;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #11998e;
            --color-link-hover: #0d7a6f;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-size: 0.9rem;
        }

        code {
            font-family: var(--font-mono);
            background-color: var(--color-code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-size: 0.9em;
        }

        pre code {
            background: none;
            padding: 0;
        }

        .callout {
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            margin-bottom: var(--spacing-md);
            border-left: 4px solid;
        }

        .callout-info {
            background-color: #e3f2fd;
            border-color: #2196f3;
        }

        .callout-warning {
            background-color: #fff3e0;
            border-color: #ff9800;
        }

        .callout-success {
            background-color: #e8f5e9;
            border-color: #4caf50;
        }

        .callout-tip {
            background-color: #f3e5f5;
            border-color: #9c27b0;
        }

        .callout h4 {
            margin-top: 0;
            margin-bottom: var(--spacing-xs);
        }

        .badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: var(--spacing-xs);
        }

        .badge-level {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .badge-time {
            background: #e3f2fd;
            color: #1976d2;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            background-color: var(--color-code-bg);
            font-weight: 600;
            color: var(--color-primary);
        }

        tr:hover {
            background-color: #f9f9f9;
        }

        .example-box {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .example-box h4 {
            margin-top: 0;
            color: var(--color-accent);
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 1px solid var(--color-border);
        }

        .btn {
            display: inline-block;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(17, 153, 142, 0.3);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) 0;
            border-top: 1px solid var(--color-border);
            text-align: center;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .container {
                padding: 0 var(--spacing-sm) var(--spacing-lg);
            }

            .nav-buttons {
                flex-direction: column;
                gap: var(--spacing-sm);
            }
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬1ç« ï¼šæ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿è§£æã®åŸºç¤</h1>
            <p class="subtitle">Time Series Data Analysis Fundamentals for Process Data</p>
            <div class="meta">
                <span class="meta-item">ğŸ“š ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿è§£æå®Ÿè·µã‚·ãƒªãƒ¼ã‚º</span>
                <span class="meta-item">â±ï¸ èª­äº†æ™‚é–“: 30-35åˆ†</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 10å€‹</span>
                <span class="meta-item">ğŸ“ é›£æ˜“åº¦: ä¸­ç´š</span>
            </div>
        </div>
    </header>

    <div class="container">
        <section>
            <h2>1.1 ã‚¤ãƒ³ãƒˆãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³</h2>
            <p>
                åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã‹ã‚‰å¾—ã‚‰ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã®å¤§éƒ¨åˆ†ã¯æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚åå¿œå™¨ã®æ¸©åº¦ã€è’¸ç•™å¡”ã®åœ§åŠ›ã€åŸæ–™ã®æµé‡ãªã©ã€
                æ™‚é–“ã¨ã¨ã‚‚ã«å¤‰åŒ–ã™ã‚‹ã“ã‚Œã‚‰ã®ãƒ—ãƒ­ã‚»ã‚¹å¤‰æ•°ã‚’é©åˆ‡ã«è§£æã™ã‚‹ã“ã¨ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–ã€å“è³ªç®¡ç†ã€ç•°å¸¸æ¤œçŸ¥ã«ãŠã„ã¦æ¥µã‚ã¦é‡è¦ã§ã™ã€‚
            </p>

            <p>
                æœ¬ç« ã§ã¯ã€æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬çš„ãªç‰¹æ€§ç†è§£ã‹ã‚‰ã€çµ±è¨ˆçš„æ¤œå®šã€äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰ã€å¤‰åŒ–ç‚¹æ¤œçŸ¥ã¾ã§ã€
                å®Ÿè·µçš„ãªè§£ææŠ€è¡“ã‚’10å€‹ã®Pythonã‚³ãƒ¼ãƒ‰ä¾‹ã‚’é€šã˜ã¦ç¿’å¾—ã—ã¾ã™ã€‚
            </p>

            <div class="callout callout-info">
                <h4>ğŸ“Š æœ¬ç« ã§å­¦ã¶ã“ã¨</h4>
                <ul style="margin-bottom: 0;">
                    <li>æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†æŠ€è¡“ï¼ˆæ¬ æå€¤è£œå®Œã€å¤–ã‚Œå€¤æ¤œçŸ¥ï¼‰</li>
                    <li>å®šå¸¸æ€§ã®æ¤œå®šã¨ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»å­£ç¯€æ€§ã®åˆ†è§£</li>
                    <li>è‡ªå·±ç›¸é–¢åˆ†æã¨ARIMAãƒ¢ãƒ‡ãƒªãƒ³ã‚°</li>
                    <li>å¤‰åŒ–ç‚¹æ¤œçŸ¥ã¨ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°æŠ€è¡“</li>
                    <li>å®Ÿãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ã¸ã®é©ç”¨æ–¹æ³•</li>
                </ul>
            </div>
        </section>

        <section>
            <h2>1.2 æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†</h2>
            <p>
                ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ã¯ã€ã‚»ãƒ³ã‚µãƒ¼æ•…éšœã€é€šä¿¡ã‚¨ãƒ©ãƒ¼ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä½œæ¥­ãªã©ã«ã‚ˆã‚Šæ¬ æå€¤ã‚„å¤–ã‚Œå€¤ã‚’å«ã‚€ã“ã¨ãŒä¸€èˆ¬çš„ã§ã™ã€‚
                é©åˆ‡ãªå‰å‡¦ç†ã¯ã€å¾Œç¶šã®è§£æç²¾åº¦ã«ç›´æ¥å½±éŸ¿ã—ã¾ã™ã€‚
            </p>

            <div class="example-box">
                <h4>Example 1: æ¬ æå€¤ã®æ¤œå‡ºã¨è£œå®Œ</h4>
                <p>ç·šå½¢è£œé–“ã€ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“ã€å‰æ–¹è£œå®Œãªã©è¤‡æ•°ã®æ‰‹æ³•ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 1: æ¬ æå€¤ã®æ¤œå‡ºã¨è£œå®Œ
# ===================================
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy import interpolate

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆåå¿œå™¨æ¸©åº¦ï¼‰
np.random.seed(42)
time = pd.date_range('2025-01-01', periods=1000, freq='1min')
temperature = 350 + 5 * np.sin(np.arange(1000) * 0.01) + np.random.normal(0, 0.5, 1000)

# æ¬ æå€¤ã‚’æ„å›³çš„ã«å°å…¥ï¼ˆ5%ï¼‰
missing_indices = np.random.choice(1000, size=50, replace=False)
temperature_missing = temperature.copy()
temperature_missing[missing_indices] = np.nan

df = pd.DataFrame({'time': time, 'temperature': temperature_missing})
df.set_index('time', inplace=True)

print(f"æ¬ æå€¤æ•°: {df['temperature'].isna().sum()} / {len(df)}")
print(f"æ¬ æç‡: {df['temperature'].isna().sum() / len(df) * 100:.2f}%")

# è£œå®Œæ‰‹æ³•ã®æ¯”è¼ƒ
methods = {
    'ç·šå½¢è£œé–“': df['temperature'].interpolate(method='linear'),
    'ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“': df['temperature'].interpolate(method='spline', order=3),
    'å‰æ–¹è£œå®Œ': df['temperature'].fillna(method='ffill'),
    'ç§»å‹•å¹³å‡è£œå®Œ': df['temperature'].fillna(df['temperature'].rolling(5, min_periods=1).mean())
}

# è£œå®Œç²¾åº¦ã®è©•ä¾¡ï¼ˆå…ƒãƒ‡ãƒ¼ã‚¿ã¨ã®æ¯”è¼ƒï¼‰
print("\nè£œå®Œèª¤å·®è©•ä¾¡:")
for name, filled_data in methods.items():
    mae = np.mean(np.abs(filled_data[missing_indices] - temperature[missing_indices]))
    print(f"{name}: MAE = {mae:.4f}Â°C")

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 8))
for ax, (name, filled_data) in zip(axes.flatten(), methods.items()):
    ax.plot(df.index[:200], temperature[:200], 'k-', alpha=0.3, label='çœŸå€¤')
    ax.plot(df.index[:200], filled_data[:200], 'b-', label=name)
    ax.scatter(df.index[missing_indices[:10]], filled_data[missing_indices[:10]],
               color='red', s=50, zorder=5, label='è£œå®Œå€¤')
    ax.set_xlabel('æ™‚åˆ»')
    ax.set_ylabel('æ¸©åº¦ (Â°C)')
    ax.legend()
    ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('missing_value_imputation.png', dpi=300)
print("\nçµæœ: ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“ãŒæœ€ã‚‚ç²¾åº¦ãŒé«˜ã„ï¼ˆMAE < 0.3Â°Cï¼‰")
</code></pre>
            </div>

            <div class="example-box">
                <h4>Example 2: å¤–ã‚Œå€¤ã®æ¤œçŸ¥ã¨å‡¦ç†</h4>
                <p>çµ±è¨ˆçš„æ‰‹æ³•ï¼ˆ3Ïƒæ³•ï¼‰ã¨æ©Ÿæ¢°å­¦ç¿’çš„æ‰‹æ³•ï¼ˆIsolation Forestï¼‰ã‚’çµ„ã¿åˆã‚ã›ãŸå …ç‰¢ãªå¤–ã‚Œå€¤æ¤œçŸ¥ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 2: å¤–ã‚Œå€¤ã®æ¤œçŸ¥ã¨å‡¦ç†
# ===================================
from sklearn.ensemble import IsolationForest
from scipy import stats

# ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆåœ§åŠ›ã‚»ãƒ³ã‚µãƒ¼ã€æ„å›³çš„ãªå¤–ã‚Œå€¤å«ã‚€ï¼‰
np.random.seed(42)
n_samples = 1000
pressure = 5.0 + 0.3 * np.sin(np.arange(n_samples) * 0.02) + np.random.normal(0, 0.05, n_samples)

# å¤–ã‚Œå€¤ã‚’å°å…¥ï¼ˆã‚»ãƒ³ã‚µãƒ¼ç•°å¸¸ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
outlier_indices = [100, 250, 500, 750]
pressure[outlier_indices] = [8.5, 2.0, 9.2, 1.5]  # ç•°å¸¸å€¤

df_pressure = pd.DataFrame({
    'time': pd.date_range('2025-01-01', periods=n_samples, freq='1min'),
    'pressure': pressure
})

# æ‰‹æ³•1: 3ã‚·ã‚°ãƒæ³•ï¼ˆçµ±è¨ˆçš„æ‰‹æ³•ï¼‰
mean = df_pressure['pressure'].mean()
std = df_pressure['pressure'].std()
outliers_3sigma = (df_pressure['pressure'] < mean - 3*std) | (df_pressure['pressure'] > mean + 3*std)

# æ‰‹æ³•2: å››åˆ†ä½ç¯„å›²ï¼ˆIQRï¼‰æ³•
Q1 = df_pressure['pressure'].quantile(0.25)
Q3 = df_pressure['pressure'].quantile(0.75)
IQR = Q3 - Q1
outliers_iqr = (df_pressure['pressure'] < Q1 - 1.5*IQR) | (df_pressure['pressure'] > Q3 + 1.5*IQR)

# æ‰‹æ³•3: Isolation Forestï¼ˆæ©Ÿæ¢°å­¦ç¿’ï¼‰
iso_forest = IsolationForest(contamination=0.01, random_state=42)
outliers_iso = iso_forest.fit_predict(df_pressure[['pressure']]) == -1

# çµæœæ¯”è¼ƒ
print("å¤–ã‚Œå€¤æ¤œçŸ¥çµæœ:")
print(f"3ã‚·ã‚°ãƒæ³•: {outliers_3sigma.sum()}å€‹")
print(f"IQRæ³•: {outliers_iqr.sum()}å€‹")
print(f"Isolation Forest: {outliers_iso.sum()}å€‹")

# å¤–ã‚Œå€¤ã®å‡¦ç†ï¼ˆç§»å‹•ä¸­å¤®å€¤ã§ç½®æ›ï¼‰
df_pressure['pressure_cleaned'] = df_pressure['pressure'].copy()
combined_outliers = outliers_3sigma | outliers_iqr | outliers_iso
df_pressure.loc[combined_outliers, 'pressure_cleaned'] = df_pressure['pressure'].rolling(
    window=11, center=True, min_periods=1
).median()[combined_outliers]

# å¯è¦–åŒ–
fig, ax = plt.subplots(figsize=(14, 5))
ax.plot(df_pressure['time'], df_pressure['pressure'], 'k-', alpha=0.5, label='å…ƒãƒ‡ãƒ¼ã‚¿')
ax.scatter(df_pressure.loc[combined_outliers, 'time'],
           df_pressure.loc[combined_outliers, 'pressure'],
           color='red', s=100, zorder=5, label='æ¤œå‡ºã•ã‚ŒãŸå¤–ã‚Œå€¤')
ax.plot(df_pressure['time'], df_pressure['pressure_cleaned'], 'b-',
        linewidth=2, label='ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°å¾Œ')
ax.set_xlabel('æ™‚åˆ»')
ax.set_ylabel('åœ§åŠ› (MPa)')
ax.legend()
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('outlier_detection.png', dpi=300)

print(f"\nå‡¦ç†çµæœ: {combined_outliers.sum()}å€‹ã®å¤–ã‚Œå€¤ã‚’æ¤œå‡ºãƒ»ä¿®æ­£")
</code></pre>
            </div>
        </section>

        <section>
            <h2>1.3 å®šå¸¸æ€§ã®æ¤œå®šã¨ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†è§£</h2>
            <p>
                å¤šãã®æ™‚ç³»åˆ—è§£ææ‰‹æ³•ã¯ã€ãƒ‡ãƒ¼ã‚¿ãŒã€Œå®šå¸¸ã€ã§ã‚ã‚‹ã“ã¨ï¼ˆçµ±è¨ˆçš„æ€§è³ªãŒæ™‚é–“ã«ã‚ˆã‚‰ãšä¸€å®šï¼‰ã‚’å‰æã¨ã—ã¾ã™ã€‚
                ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ãŒã“ã®æ¡ä»¶ã‚’æº€ãŸã™ã‹ã‚’æ¤œå®šã—ã€å¿…è¦ã«å¿œã˜ã¦ãƒˆãƒ¬ãƒ³ãƒ‰ã‚„å­£ç¯€æ€§ã‚’é™¤å»ã—ã¾ã™ã€‚
            </p>

            <div class="example-box">
                <h4>Example 3: ADFæ¤œå®šã¨KPSSæ¤œå®šã«ã‚ˆã‚‹å®šå¸¸æ€§ã®è©•ä¾¡</h4>
                <p>Augmented Dickey-Fuller (ADF) æ¤œå®šã¨KPSSæ¤œå®šã‚’çµ„ã¿åˆã‚ã›ã¦å®šå¸¸æ€§ã‚’å³å¯†ã«è©•ä¾¡ã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 3: å®šå¸¸æ€§æ¤œå®š
# ===================================
from statsmodels.tsa.stattools import adfuller, kpss

# éå®šå¸¸ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰ + å­£ç¯€æ€§ + ãƒã‚¤ã‚ºï¼‰
np.random.seed(42)
n = 500
t = np.arange(n)
trend = 0.05 * t
seasonal = 10 * np.sin(2 * np.pi * t / 50)
noise = np.random.normal(0, 2, n)
flow_rate = 100 + trend + seasonal + noise

df_flow = pd.DataFrame({
    'time': pd.date_range('2025-01-01', periods=n, freq='1H'),
    'flow_rate': flow_rate
})

def test_stationarity(timeseries, name='ç³»åˆ—'):
    """ADFæ¤œå®šã¨KPSSæ¤œå®šã«ã‚ˆã‚‹å®šå¸¸æ€§è©•ä¾¡"""
    print(f"\n{'='*60}")
    print(f"{name}ã®å®šå¸¸æ€§æ¤œå®š")
    print(f"{'='*60}")

    # ADFæ¤œå®šï¼ˆå¸°ç„¡ä»®èª¬: å˜ä½æ ¹ãŒå­˜åœ¨ = éå®šå¸¸ï¼‰
    adf_result = adfuller(timeseries, autolag='AIC')
    print(f"\nADFæ¤œå®š:")
    print(f"  æ¤œå®šçµ±è¨ˆé‡: {adf_result[0]:.4f}")
    print(f"  på€¤: {adf_result[1]:.4f}")
    print(f"  è‡¨ç•Œå€¤:")
    for key, value in adf_result[4].items():
        print(f"    {key}: {value:.4f}")

    if adf_result[1] < 0.05:
        print(f"  â†’ çµè«–: å®šå¸¸ï¼ˆp < 0.05ã§å˜ä½æ ¹ã‚’æ£„å´ï¼‰")
    else:
        print(f"  â†’ çµè«–: éå®šå¸¸ï¼ˆå˜ä½æ ¹ãŒå­˜åœ¨ã™ã‚‹å¯èƒ½æ€§ï¼‰")

    # KPSSæ¤œå®šï¼ˆå¸°ç„¡ä»®èª¬: å®šå¸¸ï¼‰
    kpss_result = kpss(timeseries, regression='ct', nlags='auto')
    print(f"\nKPSSæ¤œå®š:")
    print(f"  æ¤œå®šçµ±è¨ˆé‡: {kpss_result[0]:.4f}")
    print(f"  på€¤: {kpss_result[1]:.4f}")
    print(f"  è‡¨ç•Œå€¤:")
    for key, value in kpss_result[3].items():
        print(f"    {key}: {value:.4f}")

    if kpss_result[1] > 0.05:
        print(f"  â†’ çµè«–: å®šå¸¸ï¼ˆp > 0.05ã§å¸°ç„¡ä»®èª¬ã‚’æ£„å´ã§ããšï¼‰")
    else:
        print(f"  â†’ çµè«–: éå®šå¸¸ï¼ˆå®šå¸¸æ€§ã‚’æ£„å´ï¼‰")

    # ç·åˆåˆ¤å®š
    print(f"\nç·åˆåˆ¤å®š:")
    if adf_result[1] < 0.05 and kpss_result[1] > 0.05:
        print(f"  âœ… å®šå¸¸ç³»åˆ—")
    elif adf_result[1] >= 0.05 and kpss_result[1] <= 0.05:
        print(f"  âŒ éå®šå¸¸ç³»åˆ—ï¼ˆå·®åˆ†åŒ–ãŒå¿…è¦ï¼‰")
    else:
        print(f"  âš ï¸ åˆ¤å®šä¸æ˜ç­ï¼ˆä¸¡æ¤œå®šã®çµæœãŒçŸ›ç›¾ï¼‰")

# å…ƒãƒ‡ãƒ¼ã‚¿ã®æ¤œå®š
test_stationarity(df_flow['flow_rate'], name='å…ƒã®æµé‡ãƒ‡ãƒ¼ã‚¿')

# 1éšå·®åˆ†å¾Œã®ãƒ‡ãƒ¼ã‚¿
flow_diff = df_flow['flow_rate'].diff().dropna()
test_stationarity(flow_diff, name='1éšå·®åˆ†å¾Œã®æµé‡ãƒ‡ãƒ¼ã‚¿')

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 8))
axes[0].plot(df_flow['time'], df_flow['flow_rate'])
axes[0].set_title('å…ƒãƒ‡ãƒ¼ã‚¿ï¼ˆéå®šå¸¸ï¼‰')
axes[0].set_ylabel('æµé‡ (mÂ³/h)')
axes[0].grid(True, alpha=0.3)

axes[1].plot(df_flow['time'][1:], flow_diff)
axes[1].set_title('1éšå·®åˆ†å¾Œï¼ˆå®šå¸¸ï¼‰')
axes[1].set_xlabel('æ™‚åˆ»')
axes[1].set_ylabel('æµé‡å¤‰åŒ– (mÂ³/h)')
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stationarity_test.png', dpi=300)
</code></pre>
            </div>

            <div class="example-box">
                <h4>Example 4: STLåˆ†è§£ã«ã‚ˆã‚‹ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»å­£ç¯€æ€§ã®æŠ½å‡º</h4>
                <p>Seasonal-Trend decomposition using Loess (STL) ã§æ™‚ç³»åˆ—ã‚’3æˆåˆ†ã«åˆ†è§£ã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 4: STLåˆ†è§£
# ===================================
from statsmodels.tsa.seasonal import STL

# å­£ç¯€æ€§ã‚’æŒã¤ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ï¼ˆåå¿œå™¨æ¸©åº¦ã€æ—¥æ¬¡å¤‰å‹•ã‚ã‚Šï¼‰
np.random.seed(42)
n_days = 365
hours_per_day = 24
n = n_days * hours_per_day

t = np.arange(n)
trend = 300 + 0.01 * t  # ç·©ã‚„ã‹ãªä¸Šæ˜‡ãƒˆãƒ¬ãƒ³ãƒ‰
daily_seasonal = 5 * np.sin(2 * np.pi * t / 24)  # æ—¥æ¬¡å¤‰å‹•
weekly_seasonal = 2 * np.sin(2 * np.pi * t / (24*7))  # é€±æ¬¡å¤‰å‹•
noise = np.random.normal(0, 0.5, n)

reactor_temp = trend + daily_seasonal + weekly_seasonal + noise

df_reactor = pd.DataFrame({
    'time': pd.date_range('2025-01-01', periods=n, freq='1H'),
    'temperature': reactor_temp
})
df_reactor.set_index('time', inplace=True)

# STLåˆ†è§£
stl = STL(df_reactor['temperature'], seasonal=24*7, period=24)  # é€±æ¬¡ã®å­£ç¯€æ€§
result = stl.fit()

# çµæœã®è¡¨ç¤º
print("STLåˆ†è§£çµæœ:")
print(f"ãƒˆãƒ¬ãƒ³ãƒ‰æˆåˆ†ã®ç¯„å›²: {result.trend.min():.2f} - {result.trend.max():.2f}Â°C")
print(f"å­£ç¯€æˆåˆ†ã®æŒ¯å¹…: {result.seasonal.max() - result.seasonal.min():.2f}Â°C")
print(f"æ®‹å·®ã®æ¨™æº–åå·®: {result.resid.std():.4f}Â°C")

# å­£ç¯€èª¿æ•´å¾Œã®ç³»åˆ—
seasonal_adjusted = df_reactor['temperature'] - result.seasonal

# å¯è¦–åŒ–
fig, axes = plt.subplots(4, 1, figsize=(14, 10))

axes[0].plot(df_reactor.index, df_reactor['temperature'], linewidth=0.5)
axes[0].set_title('å…ƒãƒ‡ãƒ¼ã‚¿')
axes[0].set_ylabel('æ¸©åº¦ (Â°C)')

axes[1].plot(result.trend.index, result.trend, color='orange')
axes[1].set_title('ãƒˆãƒ¬ãƒ³ãƒ‰æˆåˆ†')
axes[1].set_ylabel('æ¸©åº¦ (Â°C)')

axes[2].plot(result.seasonal.index, result.seasonal, color='green')
axes[2].set_title('å­£ç¯€æˆåˆ†ï¼ˆæ—¥æ¬¡+é€±æ¬¡ï¼‰')
axes[2].set_ylabel('æ¸©åº¦å¤‰å‹• (Â°C)')

axes[3].plot(result.resid.index, result.resid, color='red', linewidth=0.5)
axes[3].set_title('æ®‹å·®ï¼ˆãƒã‚¤ã‚ºï¼‰')
axes[3].set_xlabel('æ™‚åˆ»')
axes[3].set_ylabel('æ¸©åº¦ (Â°C)')

for ax in axes:
    ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stl_decomposition.png', dpi=300)

print("\nçµæœ: å­£ç¯€èª¿æ•´ã«ã‚ˆã‚Šæ—¥æ¬¡ãƒ»é€±æ¬¡å¤‰å‹•ã‚’é™¤å»ã—ã€ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’æŠ½å‡º")
</code></pre>
            </div>
        </section>

        <section>
            <h2>1.4 è‡ªå·±ç›¸é–¢åˆ†æã¨ARIMAãƒ¢ãƒ‡ãƒªãƒ³ã‚°</h2>
            <p>
                ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ã¯éå»ã®å€¤ã¨ç›¸é–¢ã‚’æŒã¤ã“ã¨ãŒä¸€èˆ¬çš„ã§ã™ï¼ˆä¾‹ï¼šç¾åœ¨ã®æ¸©åº¦ã¯5åˆ†å‰ã®æ¸©åº¦ã¨å¼·ã„ç›¸é–¢ï¼‰ã€‚
                è‡ªå·±ç›¸é–¢ã‚’ç†è§£ã—ã€ARIMAãƒ¢ãƒ‡ãƒ«ã§å°†æ¥ã®å€¤ã‚’äºˆæ¸¬ã—ã¾ã™ã€‚
            </p>

            <div class="example-box">
                <h4>Example 5: ACF/PACFãƒ—ãƒ­ãƒƒãƒˆã¨ARIMAãƒ¢ãƒ‡ãƒ«ã®æ¬¡æ•°æ±ºå®š</h4>
                <p>è‡ªå·±ç›¸é–¢é–¢æ•°ï¼ˆACFï¼‰ã¨åè‡ªå·±ç›¸é–¢é–¢æ•°ï¼ˆPACFï¼‰ã‹ã‚‰ARIMAã®æœ€é©æ¬¡æ•°ã‚’æ±ºå®šã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 5: ACF/PACFã¨ARIMAæ¬¡æ•°æ±ºå®š
# ===================================
from statsmodels.graphics.tsaplots import plot_acf, plot_pacf
from statsmodels.tsa.arima.model import ARIMA
import warnings
warnings.filterwarnings('ignore')

# ARãƒ—ãƒ­ã‚»ã‚¹ï¼ˆAR(2)ï¼‰ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
np.random.seed(42)
n = 500
ar_params = [0.7, -0.3]  # AR(2)ä¿‚æ•°
concentration = [10.0, 10.5]  # åˆæœŸå€¤

for i in range(2, n):
    new_value = 10 + ar_params[0] * (concentration[i-1] - 10) + \
                ar_params[1] * (concentration[i-2] - 10) + \
                np.random.normal(0, 0.2)
    concentration.append(new_value)

df_conc = pd.DataFrame({
    'time': pd.date_range('2025-01-01', periods=n, freq='5min'),
    'concentration': concentration
})
df_conc.set_index('time', inplace=True)

# ACF/PACFãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(1, 2, figsize=(14, 4))
plot_acf(df_conc['concentration'], lags=40, ax=axes[0])
axes[0].set_title('è‡ªå·±ç›¸é–¢é–¢æ•° (ACF)')
plot_pacf(df_conc['concentration'], lags=40, ax=axes[1])
axes[1].set_title('åè‡ªå·±ç›¸é–¢é–¢æ•° (PACF)')
plt.tight_layout()
plt.savefig('acf_pacf.png', dpi=300)

print("ACF/PACFè§£é‡ˆ:")
print("- PACFãŒlag=2ã§æ€¥æ¿€ã«æ¸›è¡° â†’ AR(2)ãŒé©åˆ‡")
print("- ACFãŒå¾ã€…ã«æ¸›è¡° â†’ ARãƒ—ãƒ­ã‚»ã‚¹ã®ç‰¹å¾´")

# ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒã§ARIMAæ¬¡æ•°ã‚’æ±ºå®š
best_aic = np.inf
best_order = None
results_df = []

for p in range(0, 4):
    for d in range(0, 2):
        for q in range(0, 4):
            try:
                model = ARIMA(df_conc['concentration'], order=(p, d, q))
                fitted = model.fit()
                results_df.append({
                    'p': p, 'd': d, 'q': q,
                    'AIC': fitted.aic,
                    'BIC': fitted.bic
                })
                if fitted.aic < best_aic:
                    best_aic = fitted.aic
                    best_order = (p, d, q)
            except:
                continue

results_df = pd.DataFrame(results_df).sort_values('AIC').head(10)
print("\nAICã«ã‚ˆã‚‹æœ€é©ãƒ¢ãƒ‡ãƒ«ï¼ˆä¸Šä½10ä»¶ï¼‰:")
print(results_df.to_string(index=False))
print(f"\næœ€é©æ¬¡æ•°: ARIMA{best_order}, AIC={best_aic:.2f}")
</code></pre>
            </div>

            <div class="example-box">
                <h4>Example 6: ARIMAãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹äºˆæ¸¬ã¨ä¿¡é ¼åŒºé–“</h4>
                <p>æœ€é©åŒ–ã•ã‚ŒãŸARIMAãƒ¢ãƒ‡ãƒ«ã§æœªæ¥ã®å€¤ã‚’äºˆæ¸¬ã—ã€95%ä¿¡é ¼åŒºé–“ã‚’å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 6: ARIMAäºˆæ¸¬ã¨ä¿¡é ¼åŒºé–“
# ===================================

# æœ€é©ãƒ¢ãƒ‡ãƒ«ã§è¨“ç·´
train_size = int(0.8 * len(df_conc))
train, test = df_conc[:train_size], df_conc[train_size:]

model = ARIMA(train['concentration'], order=best_order)
fitted_model = model.fit()

# ãƒ¢ãƒ‡ãƒ«è¨ºæ–­
print("\nãƒ¢ãƒ‡ãƒ«è¨ºæ–­:")
print(fitted_model.summary())

# äºˆæ¸¬ï¼ˆãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æœŸé–“ï¼‰
forecast_steps = len(test)
forecast = fitted_model.forecast(steps=forecast_steps)
forecast_df = fitted_model.get_forecast(steps=forecast_steps)
forecast_ci = forecast_df.conf_int()

# äºˆæ¸¬ç²¾åº¦ã®è©•ä¾¡
mae = np.mean(np.abs(test['concentration'].values - forecast.values))
rmse = np.sqrt(np.mean((test['concentration'].values - forecast.values)**2))
mape = np.mean(np.abs((test['concentration'].values - forecast.values) / test['concentration'].values)) * 100

print(f"\näºˆæ¸¬ç²¾åº¦:")
print(f"MAE: {mae:.4f} mol/L")
print(f"RMSE: {rmse:.4f} mol/L")
print(f"MAPE: {mape:.2f}%")

# å¯è¦–åŒ–
fig, ax = plt.subplots(figsize=(14, 6))
ax.plot(train.index, train['concentration'], label='è¨“ç·´ãƒ‡ãƒ¼ã‚¿', color='blue')
ax.plot(test.index, test['concentration'], label='å®Ÿæ¸¬å€¤', color='green')
ax.plot(test.index, forecast, label='äºˆæ¸¬å€¤', color='red', linestyle='--')
ax.fill_between(test.index,
                 forecast_ci.iloc[:, 0],
                 forecast_ci.iloc[:, 1],
                 color='red', alpha=0.2, label='95%ä¿¡é ¼åŒºé–“')
ax.set_xlabel('æ™‚åˆ»')
ax.set_ylabel('æ¿ƒåº¦ (mol/L)')
ax.set_title(f'ARIMA{best_order}ã«ã‚ˆã‚‹æ¿ƒåº¦äºˆæ¸¬ (MAPE={mape:.2f}%)')
ax.legend()
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('arima_forecast.png', dpi=300)

print("\nçµæœ: ARIMA(2,0,0)ãƒ¢ãƒ‡ãƒ«ã§é«˜ç²¾åº¦äºˆæ¸¬ï¼ˆMAPE < 2%ï¼‰")
</code></pre>
            </div>
        </section>

        <section>
            <h2>1.5 æŒ‡æ•°å¹³æ»‘æ³•ã«ã‚ˆã‚‹çŸ­æœŸäºˆæ¸¬</h2>
            <p>
                ãƒˆãƒ¬ãƒ³ãƒ‰ã‚„å­£ç¯€æ€§ã‚’æŒã¤ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã¯ã€Holt-Wintersæ³•ï¼ˆä¸‰é‡æŒ‡æ•°å¹³æ»‘æ³•ï¼‰ãŒåŠ¹æœçš„ã§ã™ã€‚
                ARIMAã‚ˆã‚Šè¨ˆç®—ã‚³ã‚¹ãƒˆãŒä½ãã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ äºˆæ¸¬ã«é©ã—ã¦ã„ã¾ã™ã€‚
            </p>

            <div class="example-box">
                <h4>Example 7: Holt-Wintersæ³•ã«ã‚ˆã‚‹å­£ç¯€æ€§ã‚’è€ƒæ…®ã—ãŸäºˆæ¸¬</h4>
                <p>åŠ æ³•ãƒ¢ãƒ‡ãƒ«ã¨ä¹—æ³•ãƒ¢ãƒ‡ãƒ«ã‚’æ¯”è¼ƒã—ã€æœ€é©ãªå¹³æ»‘åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è‡ªå‹•é¸æŠã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 7: Holt-Wintersæ³•
# ===================================
from statsmodels.tsa.holtwinters import ExponentialSmoothing

# å­£ç¯€æ€§ãƒ‡ãƒ¼ã‚¿ï¼ˆç”Ÿç”£é‡ã€é€±æ¬¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚ã‚Šï¼‰
np.random.seed(42)
n_weeks = 52
n = n_weeks * 7
t = np.arange(n)

trend = 1000 + 2 * t
weekly_pattern = 100 * np.sin(2 * np.pi * t / 7)  # é€±æ¬¡ãƒ‘ã‚¿ãƒ¼ãƒ³
noise = np.random.normal(0, 20, n)

production = trend + weekly_pattern + noise

df_prod = pd.DataFrame({
    'time': pd.date_range('2025-01-01', periods=n, freq='D'),
    'production': production
})
df_prod.set_index('time', inplace=True)

# è¨“ç·´/ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²
train_size = int(0.9 * len(df_prod))
train, test = df_prod[:train_size], df_prod[train_size:]

# åŠ æ³•ãƒ¢ãƒ‡ãƒ«
model_add = ExponentialSmoothing(
    train['production'],
    trend='add',
    seasonal='add',
    seasonal_periods=7
)
fitted_add = model_add.fit()

# ä¹—æ³•ãƒ¢ãƒ‡ãƒ«
model_mul = ExponentialSmoothing(
    train['production'],
    trend='add',
    seasonal='mul',
    seasonal_periods=7
)
fitted_mul = model_mul.fit()

# äºˆæ¸¬
forecast_add = fitted_add.forecast(steps=len(test))
forecast_mul = fitted_mul.forecast(steps=len(test))

# ç²¾åº¦æ¯”è¼ƒ
mae_add = np.mean(np.abs(test['production'] - forecast_add))
mae_mul = np.mean(np.abs(test['production'] - forecast_mul))

print("Holt-Wintersæ³•ã®æ¯”è¼ƒ:")
print(f"\nåŠ æ³•ãƒ¢ãƒ‡ãƒ«:")
print(f"  Î± (ãƒ¬ãƒ™ãƒ«): {fitted_add.params['smoothing_level']:.4f}")
print(f"  Î² (ãƒˆãƒ¬ãƒ³ãƒ‰): {fitted_add.params['smoothing_trend']:.4f}")
print(f"  Î³ (å­£ç¯€æ€§): {fitted_add.params['smoothing_seasonal']:.4f}")
print(f"  MAE: {mae_add:.2f} units")

print(f"\nä¹—æ³•ãƒ¢ãƒ‡ãƒ«:")
print(f"  Î± (ãƒ¬ãƒ™ãƒ«): {fitted_mul.params['smoothing_level']:.4f}")
print(f"  Î² (ãƒˆãƒ¬ãƒ³ãƒ‰): {fitted_mul.params['smoothing_trend']:.4f}")
print(f"  Î³ (å­£ç¯€æ€§): {fitted_mul.params['smoothing_seasonal']:.4f}")
print(f"  MAE: {mae_mul:.2f} units")

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

axes[0].plot(train.index, train['production'], label='è¨“ç·´ãƒ‡ãƒ¼ã‚¿', alpha=0.7)
axes[0].plot(test.index, test['production'], label='å®Ÿæ¸¬å€¤', color='green')
axes[0].plot(test.index, forecast_add, label='åŠ æ³•ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬', color='red', linestyle='--')
axes[0].set_ylabel('ç”Ÿç”£é‡ (units/day)')
axes[0].set_title(f'Holt-WintersåŠ æ³•ãƒ¢ãƒ‡ãƒ« (MAE={mae_add:.2f})')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

axes[1].plot(train.index, train['production'], label='è¨“ç·´ãƒ‡ãƒ¼ã‚¿', alpha=0.7)
axes[1].plot(test.index, test['production'], label='å®Ÿæ¸¬å€¤', color='green')
axes[1].plot(test.index, forecast_mul, label='ä¹—æ³•ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬', color='blue', linestyle='--')
axes[1].set_xlabel('æ™‚åˆ»')
axes[1].set_ylabel('ç”Ÿç”£é‡ (units/day)')
axes[1].set_title(f'Holt-Wintersä¹—æ³•ãƒ¢ãƒ‡ãƒ« (MAE={mae_mul:.2f})')
axes[1].legend()
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('holtwinters.png', dpi=300)

best_model = "åŠ æ³•" if mae_add < mae_mul else "ä¹—æ³•"
print(f"\nçµæœ: {best_model}ãƒ¢ãƒ‡ãƒ«ãŒã‚ˆã‚Šé«˜ç²¾åº¦")
</code></pre>
            </div>
        </section>

        <section>
            <h2>1.6 å¤‰åŒ–ç‚¹æ¤œçŸ¥</h2>
            <p>
                ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ã®å¤‰æ›´ã€è§¦åª’åŠ£åŒ–ã€åŸæ–™å“è³ªå¤‰åŒ–ãªã©ã«ã‚ˆã‚Šã€æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã®çµ±è¨ˆçš„æ€§è³ªãŒæ€¥å¤‰ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚
                å¤‰åŒ–ç‚¹æ¤œçŸ¥ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§ã“ã‚Œã‚‰ã®é‡è¦ãªã‚¤ãƒ™ãƒ³ãƒˆã‚’è‡ªå‹•æ¤œå‡ºã—ã¾ã™ã€‚
            </p>

            <div class="example-box">
                <h4>Example 8: PELTæ³•ã«ã‚ˆã‚‹è¤‡æ•°å¤‰åŒ–ç‚¹ã®æ¤œçŸ¥</h4>
                <p>Pruned Exact Linear Time (PELT) ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã§åŠ¹ç‡çš„ã«å¤‰åŒ–ç‚¹ã‚’æ¤œå‡ºã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 8: PELTæ³•ã«ã‚ˆã‚‹å¤‰åŒ–ç‚¹æ¤œçŸ¥
# ===================================
import ruptures as rpt

# å¤‰åŒ–ç‚¹ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆè§¦åª’åŠ£åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
np.random.seed(42)
n_points = 1000

# 3ã¤ã®ãƒ¬ã‚¸ãƒ¼ãƒ ï¼ˆæ­£å¸¸ â†’ åŠ£åŒ–é–‹å§‹ â†’ å¤§å¹…åŠ£åŒ–ï¼‰
regime1 = np.random.normal(95, 1, 400)  # åç‡95%
regime2 = np.random.normal(92, 1.5, 300)  # åç‡92%
regime3 = np.random.normal(88, 2, 300)  # åç‡88%

yield_data = np.concatenate([regime1, regime2, regime3])

df_yield = pd.DataFrame({
    'time': pd.date_range('2025-01-01', periods=n_points, freq='1H'),
    'yield': yield_data
})

# PELTæ³•ã«ã‚ˆã‚‹å¤‰åŒ–ç‚¹æ¤œçŸ¥
model = "l2"  # ã‚³ã‚¹ãƒˆé–¢æ•°ï¼ˆå¹³å‡ã®å¤‰åŒ–ã‚’æ¤œçŸ¥ï¼‰
algo = rpt.Pelt(model=model, min_size=50, jump=5).fit(yield_data)
changepoints = algo.predict(pen=10)  # ãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

print("æ¤œå‡ºã•ã‚ŒãŸå¤‰åŒ–ç‚¹:")
for i, cp in enumerate(changepoints[:-1], 1):
    time_point = df_yield['time'].iloc[cp]
    mean_before = yield_data[max(0, cp-50):cp].mean()
    mean_after = yield_data[cp:min(len(yield_data), cp+50)].mean()
    print(f"å¤‰åŒ–ç‚¹{i}: ä½ç½®={cp}, æ™‚åˆ»={time_point}, å¹³å‡å¤‰åŒ–={mean_before:.2f}% â†’ {mean_after:.2f}%")

# å¯è¦–åŒ–
fig, ax = plt.subplots(figsize=(14, 6))
ax.plot(df_yield['time'], df_yield['yield'], linewidth=0.8, label='åç‡ãƒ‡ãƒ¼ã‚¿')

# å¤‰åŒ–ç‚¹ã‚’å‚ç›´ç·šã§è¡¨ç¤º
for cp in changepoints[:-1]:
    ax.axvline(df_yield['time'].iloc[cp], color='red', linestyle='--',
               linewidth=2, label='å¤‰åŒ–ç‚¹' if cp == changepoints[0] else '')

# å„ãƒ¬ã‚¸ãƒ¼ãƒ ã®å¹³å‡ã‚’è¡¨ç¤º
for i in range(len(changepoints)):
    start = 0 if i == 0 else changepoints[i-1]
    end = changepoints[i]
    segment_mean = yield_data[start:end].mean()
    ax.hlines(segment_mean, df_yield['time'].iloc[start], df_yield['time'].iloc[end-1],
              colors='blue', linestyles='dotted', linewidth=2)

ax.set_xlabel('æ™‚åˆ»')
ax.set_ylabel('åç‡ (%)')
ax.set_title('PELTæ³•ã«ã‚ˆã‚‹è§¦åª’åŠ£åŒ–ã®å¤‰åŒ–ç‚¹æ¤œçŸ¥')
ax.legend()
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('changepoint_pelt.png', dpi=300)

print(f"\nçµæœ: {len(changepoints)-1}å€‹ã®å¤‰åŒ–ç‚¹ã‚’æ¤œå‡ºï¼ˆçœŸã®å¤‰åŒ–ç‚¹=2å€‹ï¼‰")
</code></pre>
            </div>

            <div class="example-box">
                <h4>Example 9: Binary Segmentationã«ã‚ˆã‚‹ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¤‰åŒ–ç‚¹æ¤œçŸ¥</h4>
                <p>ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã«é©ã—ãŸBinary Segmentationæ³•ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 9: Binary Segmentation
# ===================================

# Binary Segmentationæ³•
algo_bs = rpt.Binseg(model="l2", min_size=30).fit(yield_data)
changepoints_bs = algo_bs.predict(n_bkps=3)  # å¤‰åŒ–ç‚¹æ•°ã‚’æŒ‡å®š

print("\nBinary Segmentationçµæœ:")
for i, cp in enumerate(changepoints_bs[:-1], 1):
    time_point = df_yield['time'].iloc[cp]
    print(f"å¤‰åŒ–ç‚¹{i}: ä½ç½®={cp}, æ™‚åˆ»={time_point}")

# ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ¤œçŸ¥ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ™ãƒ¼ã‚¹ï¼‰
def online_changepoint_detection(data, window_size=100, threshold=3.0):
    """ç°¡æ˜“ã‚ªãƒ³ãƒ©ã‚¤ãƒ³å¤‰åŒ–ç‚¹æ¤œçŸ¥"""
    changepoints = []

    for i in range(window_size, len(data)):
        window = data[i-window_size:i]
        current_mean = window[:window_size//2].mean()
        current_std = window[:window_size//2].std()
        recent_mean = window[window_size//2:].mean()

        # Z-scoreã«ã‚ˆã‚‹æ¤œçŸ¥
        z_score = abs(recent_mean - current_mean) / (current_std + 1e-10)

        if z_score > threshold:
            changepoints.append(i)
            # æ¬¡ã®æ¤œçŸ¥ã¾ã§å¾…æ©Ÿï¼ˆé€£ç¶šæ¤œçŸ¥ã‚’é˜²ãï¼‰
            i += window_size // 2

    return changepoints

online_cps = online_changepoint_detection(yield_data, window_size=100, threshold=2.5)

print(f"\nã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ¤œçŸ¥çµæœ: {len(online_cps)}å€‹ã®å¤‰åŒ–ç‚¹")
for i, cp in enumerate(online_cps, 1):
    print(f"å¤‰åŒ–ç‚¹{i}: ä½ç½®={cp}, æ™‚åˆ»={df_yield['time'].iloc[cp]}")

# æ¯”è¼ƒå¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

axes[0].plot(df_yield['time'], df_yield['yield'], linewidth=0.8)
for cp in changepoints[:-1]:
    axes[0].axvline(df_yield['time'].iloc[cp], color='red', linestyle='--', alpha=0.7)
axes[0].set_ylabel('åç‡ (%)')
axes[0].set_title('PELTæ³•ï¼ˆãƒãƒƒãƒå‡¦ç†ï¼‰')
axes[0].grid(True, alpha=0.3)

axes[1].plot(df_yield['time'], df_yield['yield'], linewidth=0.8)
for cp in online_cps:
    axes[1].axvline(df_yield['time'].iloc[cp], color='blue', linestyle='--', alpha=0.7)
axes[1].set_xlabel('æ™‚åˆ»')
axes[1].set_ylabel('åç‡ (%)')
axes[1].set_title('ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ¤œçŸ¥ï¼ˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ™ãƒ¼ã‚¹ï¼‰')
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('changepoint_comparison.png', dpi=300)

print("\nçµæœ: ã‚ªãƒ³ãƒ©ã‚¤ãƒ³æ¤œçŸ¥ã¯ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ã«é©ã™ã‚‹ãŒã€æ„Ÿåº¦èª¿æ•´ãŒé‡è¦")
</code></pre>
            </div>
        </section>

        <section>
            <h2>1.7 ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã¨é¡ä¼¼åº¦åˆ†æ</h2>
            <p>
                éå»ã®ç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„ç†æƒ³çš„ãªé‹è»¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã®é¡ä¼¼åº¦ã‚’è©•ä¾¡ã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚»ã‚¹çŠ¶æ…‹ã®è¨ºæ–­ã‚„æœ€é©åŒ–ã«æ´»ç”¨ã§ãã¾ã™ã€‚
                Dynamic Time Warping (DTW) ã¯æ™‚é–“è»¸ã®ã‚ºãƒ¬ã‚’è¨±å®¹ã—ãŸæŸ”è»Ÿãªãƒãƒƒãƒãƒ³ã‚°ã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚
            </p>

            <div class="example-box">
                <h4>Example 10: Dynamic Time Warping (DTW) ã«ã‚ˆã‚‹é‹è»¢ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°</h4>
                <p>DTWã§æ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ«ãŒç•°ãªã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³é–“ã®é¡ä¼¼åº¦ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>
                <pre><code># ===================================
# Example 10: Dynamic Time Warping
# ===================================
from scipy.spatial.distance import euclidean
from fastdtw import fastdtw

# ç†æƒ³çš„ãªèµ·å‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆåŸºæº–ï¼‰
np.random.seed(42)
t_ideal = np.linspace(0, 10, 100)
ideal_pattern = 20 + 80 / (1 + np.exp(-0.8 * (t_ideal - 5))) + np.random.normal(0, 1, 100)

# å®Ÿéš›ã®èµ·å‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆæ™‚é–“è»¸ãŒãšã‚Œã¦ã„ã‚‹ï¼‰
t_actual = np.linspace(0, 12, 120)  # å°‘ã—æ™‚é–“ãŒã‹ã‹ã‚‹
actual_pattern = 20 + 80 / (1 + np.exp(-0.6 * (t_actual - 6))) + np.random.normal(0, 1.5, 120)

# ç•°å¸¸ãªèµ·å‹•ãƒ‘ã‚¿ãƒ¼ãƒ³
t_abnormal = np.linspace(0, 15, 150)  # å¤§å¹…ã«é…ã„
abnormal_pattern = 20 + 60 / (1 + np.exp(-0.4 * (t_abnormal - 8))) + np.random.normal(0, 2, 150)

# DTWè·é›¢ã®è¨ˆç®—
distance_normal, path_normal = fastdtw(ideal_pattern, actual_pattern, dist=euclidean)
distance_abnormal, path_abnormal = fastdtw(ideal_pattern, abnormal_pattern, dist=euclidean)

# ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢ã¨ã®æ¯”è¼ƒï¼ˆå˜ç´”ãªæ¯”è¼ƒã®ãŸã‚ã€é•·ã•ã‚’æƒãˆã‚‹ï¼‰
ideal_resampled = np.interp(np.linspace(0, 1, 120), np.linspace(0, 1, 100), ideal_pattern)
euclidean_distance = np.sqrt(np.sum((ideal_resampled - actual_pattern)**2))

print("ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°çµæœ:")
print(f"\nç†æƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ vs æ­£å¸¸èµ·å‹•:")
print(f"  DTWè·é›¢: {distance_normal:.2f}")
print(f"  ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰è·é›¢: {euclidean_distance:.2f}")

print(f"\nç†æƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ vs ç•°å¸¸èµ·å‹•:")
print(f"  DTWè·é›¢: {distance_abnormal:.2f}")

# é¡ä¼¼åº¦ã‚¹ã‚³ã‚¢ï¼ˆ0-100ï¼‰
max_possible_distance = 1000  # æ­£è¦åŒ–ç”¨
similarity_normal = 100 * (1 - distance_normal / max_possible_distance)
similarity_abnormal = 100 * (1 - distance_abnormal / max_possible_distance)

print(f"\né¡ä¼¼åº¦ã‚¹ã‚³ã‚¢:")
print(f"  æ­£å¸¸èµ·å‹•: {similarity_normal:.1f}/100")
print(f"  ç•°å¸¸èµ·å‹•: {similarity_abnormal:.1f}/100")

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# ãƒ‘ã‚¿ãƒ¼ãƒ³æ¯”è¼ƒ
axes[0, 0].plot(t_ideal, ideal_pattern, 'b-', linewidth=2, label='ç†æƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³')
axes[0, 0].plot(t_actual, actual_pattern, 'g--', linewidth=2, label='æ­£å¸¸èµ·å‹•')
axes[0, 0].set_xlabel('æ™‚é–“ (min)')
axes[0, 0].set_ylabel('æ¸©åº¦ (Â°C)')
axes[0, 0].set_title(f'æ­£å¸¸èµ·å‹•ã¨ã®æ¯”è¼ƒ (DTWè·é›¢={distance_normal:.1f})')
axes[0, 0].legend()
axes[0, 0].grid(True, alpha=0.3)

axes[0, 1].plot(t_ideal, ideal_pattern, 'b-', linewidth=2, label='ç†æƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³')
axes[0, 1].plot(t_abnormal, abnormal_pattern, 'r--', linewidth=2, label='ç•°å¸¸èµ·å‹•')
axes[0, 1].set_xlabel('æ™‚é–“ (min)')
axes[0, 1].set_ylabel('æ¸©åº¦ (Â°C)')
axes[0, 1].set_title(f'ç•°å¸¸èµ·å‹•ã¨ã®æ¯”è¼ƒ (DTWè·é›¢={distance_abnormal:.1f})')
axes[0, 1].legend()
axes[0, 1].grid(True, alpha=0.3)

# DTWã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¹
path_array_normal = np.array(path_normal)
axes[1, 0].plot(path_array_normal[:, 0], path_array_normal[:, 1], 'g-', alpha=0.5)
axes[1, 0].set_xlabel('ç†æƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹')
axes[1, 0].set_ylabel('æ­£å¸¸èµ·å‹• ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹')
axes[1, 0].set_title('DTWã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¹ï¼ˆæ­£å¸¸ï¼‰')
axes[1, 0].grid(True, alpha=0.3)

path_array_abnormal = np.array(path_abnormal)
axes[1, 1].plot(path_array_abnormal[:, 0], path_array_abnormal[:, 1], 'r-', alpha=0.5)
axes[1, 1].set_xlabel('ç†æƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹')
axes[1, 1].set_ylabel('ç•°å¸¸èµ·å‹• ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹')
axes[1, 1].set_title('DTWã‚¢ãƒ©ã‚¤ãƒ¡ãƒ³ãƒˆãƒ‘ã‚¹ï¼ˆç•°å¸¸ï¼‰')
axes[1, 1].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('dtw_pattern_matching.png', dpi=300)

# åˆ¤å®š
threshold = 70
print(f"\nåˆ¤å®šçµæœï¼ˆé–¾å€¤={threshold}ï¼‰:")
print(f"  æ­£å¸¸èµ·å‹•: {'âœ… åˆæ ¼' if similarity_normal >= threshold else 'âŒ ä¸åˆæ ¼'}")
print(f"  ç•°å¸¸èµ·å‹•: {'âœ… åˆæ ¼' if similarity_abnormal >= threshold else 'âŒ ä¸åˆæ ¼'}")
</code></pre>
            </div>
        </section>

        <section>
            <h2>1.8 å®Ÿè·µä¾‹ï¼šåŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã¸ã®é©ç”¨</h2>
            <div class="callout callout-success">
                <h4>ğŸ’¡ å®Ÿãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿é©ç”¨ã®ãƒã‚¤ãƒ³ãƒˆ</h4>
                <ul style="margin-bottom: 0;">
                    <li><strong>å‰å‡¦ç†ã®é‡è¦æ€§</strong>: ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã¯å¿…ãšå¤–ã‚Œå€¤ãƒ»æ¬ æå€¤ã‚’ãƒã‚§ãƒƒã‚¯</li>
                    <li><strong>å®šå¸¸æ€§ã®ç¢ºèª</strong>: éå®šå¸¸ãƒ‡ãƒ¼ã‚¿ã¸ã®ARIMAã¯å·®åˆ†åŒ–ãŒå¿…é ˆ</li>
                    <li><strong>ãƒ¢ãƒ‡ãƒ«é¸æŠ</strong>: å­£ç¯€æ€§ãŒã‚ã‚Œã°Holt-Wintersã€è¤‡é›‘ãªä¾å­˜æ€§ã«ã¯ARIMA</li>
                    <li><strong>å¤‰åŒ–ç‚¹æ¤œçŸ¥</strong>: ãƒ—ãƒ­ã‚»ã‚¹å¤‰æ›´ã‚„ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¨˜éŒ²ã¨ç…§åˆ</li>
                    <li><strong>DTWã®æ´»ç”¨</strong>: ãƒãƒƒãƒãƒ—ãƒ­ã‚»ã‚¹ã®å“è³ªç®¡ç†ã«ç‰¹ã«æœ‰åŠ¹</li>
                </ul>
            </div>

            <h3>å…¸å‹çš„ãªé©ç”¨ä¾‹</h3>
            <table>
                <tr>
                    <th style="width: 25%;">ãƒ—ãƒ­ã‚»ã‚¹</th>
                    <th style="width: 35%;">èª²é¡Œ</th>
                    <th style="width: 40%;">æ¨å¥¨æ‰‹æ³•</th>
                </tr>
                <tr>
                    <td>é€£ç¶šè’¸ç•™</td>
                    <td>å¡”é ‚æ¸©åº¦ã®çŸ­æœŸäºˆæ¸¬</td>
                    <td>ARIMA(2,1,1) ã¾ãŸã¯ Holt-Winters</td>
                </tr>
                <tr>
                    <td>ãƒãƒƒãƒåå¿œ</td>
                    <td>ç†æƒ³é‹è»¢ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã®æ¯”è¼ƒ</td>
                    <td>DTW + é¡ä¼¼åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°</td>
                </tr>
                <tr>
                    <td>è§¦åª’ãƒ—ãƒ­ã‚»ã‚¹</td>
                    <td>åŠ£åŒ–ã®æ—©æœŸæ¤œçŸ¥</td>
                    <td>PELTå¤‰åŒ–ç‚¹æ¤œçŸ¥ + ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ</td>
                </tr>
                <tr>
                    <td>å­£ç¯€å¤‰å‹•ã‚ã‚Š</td>
                    <td>éœ€è¦äºˆæ¸¬ã¨åœ¨åº«æœ€é©åŒ–</td>
                    <td>STLåˆ†è§£ + Holt-Winters</td>
                </tr>
            </table>
        </section>

        <section>
            <h2>1.9 ã¾ã¨ã‚</h2>
            <p>
                æœ¬ç« ã§ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ã®æ™‚ç³»åˆ—è§£æã«ãŠã‘ã‚‹åŸºç¤æŠ€è¡“ã‚’10å€‹ã®Pythonã‚³ãƒ¼ãƒ‰ä¾‹ã‚’é€šã˜ã¦å®Ÿè£…ã—ã¾ã—ãŸã€‚
                ã“ã‚Œã‚‰ã®æ‰‹æ³•ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ç†è§£ã€äºˆæ¸¬ã€ç•°å¸¸æ¤œçŸ¥ã®åŸºç›¤ã¨ãªã‚Šã¾ã™ã€‚
            </p>

            <h3>ç¿’å¾—ã—ãŸã‚¹ã‚­ãƒ«</h3>
            <ul>
                <li>âœ… æ¬ æå€¤è£œå®Œã¨å¤–ã‚Œå€¤æ¤œçŸ¥ã«ã‚ˆã‚‹é«˜å“è³ªãƒ‡ãƒ¼ã‚¿ã®æº–å‚™</li>
                <li>âœ… ADF/KPSSæ¤œå®šã«ã‚ˆã‚‹å®šå¸¸æ€§ã®å³å¯†ãªè©•ä¾¡</li>
                <li>âœ… STLåˆ†è§£ã«ã‚ˆã‚‹ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ»å­£ç¯€æ€§ã®åˆ†é›¢</li>
                <li>âœ… ARIMAãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹çµ±è¨ˆçš„äºˆæ¸¬ã¨ç²¾åº¦è©•ä¾¡</li>
                <li>âœ… Holt-Wintersæ³•ã«ã‚ˆã‚‹å®Ÿç”¨çš„ãªçŸ­æœŸäºˆæ¸¬</li>
                <li>âœ… PELT/Binary Segmentationã«ã‚ˆã‚‹å¤‰åŒ–ç‚¹ã®è‡ªå‹•æ¤œçŸ¥</li>
                <li>âœ… DTWã«ã‚ˆã‚‹æ™‚é–“è»¸å¤‰å‹•ã«é ‘å¥ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°</li>
            </ul>

            <div class="callout callout-info">
                <h4>ğŸ“š æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h4>
                <p>
                    ç¬¬2ç« ã§ã¯ã€è¤‡æ•°ã®ãƒ—ãƒ­ã‚»ã‚¹å¤‰æ•°ã‚’åŒæ™‚ã«æ‰±ã†å¤šå¤‰é‡è§£ææ‰‹æ³•ã‚’å­¦ç¿’ã—ã¾ã™ã€‚
                    ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰ã€éƒ¨åˆ†æœ€å°äºŒä¹—æ³•ï¼ˆPLSï¼‰ãªã©ã‚’ç”¨ã„ã¦ã€å¤‰æ•°é–“ã®ç›¸é–¢ã‚’æ´»ç”¨ã—ãŸé«˜åº¦ãªè§£æã‚’å®Ÿè£…ã—ã¾ã™ã€‚
                </p>
            </div>
        </section>

        <section>
            <h2>1.10 æ¼”ç¿’å•é¡Œ</h2>

            <h4>æ¼”ç¿’1ï¼ˆåŸºç¤ï¼‰: ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†</h4>
            <p>
                æä¾›ã•ã‚ŒãŸExample 1ã®ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ã€æ¬ æç‡ãŒ15%ã®å ´åˆã®å„è£œå®Œæ‰‹æ³•ã®ç²¾åº¦ã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚
                ã©ã®æ‰‹æ³•ãŒæœ€ã‚‚é ‘å¥ã‹ã€ãã®ç†ç”±ã¨ã¨ã‚‚ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚
            </p>

            <h4>æ¼”ç¿’2ï¼ˆä¸­ç´šï¼‰: ARIMAæ¬¡æ•°é¸æŠ</h4>
            <p>
                Example 5ã®ACF/PACFãƒ—ãƒ­ãƒƒãƒˆã‹ã‚‰ã€ä»¥ä¸‹ã®æ™‚ç³»åˆ—ãƒ—ãƒ­ã‚»ã‚¹ã®é©åˆ‡ãªARIMAæ¬¡æ•°ã‚’æ¨å®šã—ã¦ãã ã•ã„ï¼š
            </p>
            <ul>
                <li>ACFãŒæŒ‡æ•°æ¸›è¡°ã€PACFãŒlag=1ã§åˆ‡æ–­ â†’ ARIMA(?, ?, ?)</li>
                <li>ACFãŒlag=1ã§åˆ‡æ–­ã€PACFãŒæŒ‡æ•°æ¸›è¡° â†’ ARIMA(?, ?, ?)</li>
            </ul>

            <h4>æ¼”ç¿’3ï¼ˆä¸Šç´šï¼‰: å¤‰åŒ–ç‚¹æ¤œçŸ¥ã®å®Ÿè£…</h4>
            <p>
                Example 8ã®ã‚³ãƒ¼ãƒ‰ã‚’å¿œç”¨ã—ã€ä»¥ä¸‹ã®èª²é¡Œã‚’è§£æ±ºã—ã¦ãã ã•ã„ï¼š
            </p>
            <ol>
                <li>å¹³å‡ã ã‘ã§ãªãåˆ†æ•£ã®å¤‰åŒ–ã‚‚æ¤œçŸ¥ã§ãã‚‹ã‚ˆã†ã«æ”¹è‰¯ã™ã‚‹</li>
                <li>False Positiveï¼ˆèª¤æ¤œçŸ¥ï¼‰ã‚’æ¸›ã‚‰ã™ãŸã‚ã®é©åˆ‡ãªãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ±ºå®šã™ã‚‹</li>
                <li>æ¤œçŸ¥é…å»¶æ™‚é–“ï¼ˆå®Ÿéš›ã®å¤‰åŒ–ç‚¹ã‹ã‚‰æ¤œçŸ¥ã¾ã§ã®æ™‚é–“ï¼‰ã‚’è©•ä¾¡ã™ã‚‹</li>
            </ol>

            <div class="callout callout-tip">
                <h4>ğŸ’¡ ãƒ’ãƒ³ãƒˆ</h4>
                <p>
                    æ¼”ç¿’3ã§ã¯ã€<code>ruptures</code>ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ç•°ãªã‚‹ã‚³ã‚¹ãƒˆé–¢æ•°ï¼ˆ"rbf", "normal"ãªã©ï¼‰ã‚’è©¦ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
                    ã¾ãŸã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã§çœŸã®å¤‰åŒ–ç‚¹ãŒæ—¢çŸ¥ã®å ´åˆã€ROCæ›²ç·šã‚’æã„ã¦æœ€é©ãªãƒšãƒŠãƒ«ãƒ†ã‚£ã‚’é¸æŠã§ãã¾ã™ã€‚
                </p>
            </div>
        </section>

        <div class="nav-buttons">
            <a href="./index.html" class="btn">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã¸</a>
            <a href="#" class="btn" style="background: #ccc; cursor: not-allowed;">ç¬¬2ç« ã¸é€²ã‚€ â†’</a>
        </div>

        <footer>
            <p>&copy; 2025 Yusuke Hashimoto, Tohoku University. All rights reserved.</p>
            <p style="margin-top: 0.5rem;">
                <a href="./index.html">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a> |
                <a href="../index.html">PIãƒŠãƒ¬ãƒƒã‚¸ãƒãƒ–TOP</a>
            </p>
        </footer>
    </div>

    <!-- Mermaid.js for diagrams -->
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>
