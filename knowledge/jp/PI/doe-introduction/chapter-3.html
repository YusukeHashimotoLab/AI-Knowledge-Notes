<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« ï¼šå¿œç­”æ›²é¢æ³•ï¼ˆRSMï¼‰ - DOEå…¥é–€ã‚·ãƒªãƒ¼ã‚º</title>

        <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8; color: #333; background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; padding: 2rem 1rem; text-align: center;
        }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; font-size: 1.1rem; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
        .back-link {
            display: inline-block; margin-bottom: 2rem; padding: 0.5rem 1rem;
            background: white; color: #11998e; text-decoration: none;
            border-radius: 6px; font-weight: 600;
        }
        .content-box {
            background: white; padding: 2rem; border-radius: 12px;
            margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #11998e; margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem; border-bottom: 3px solid #11998e;
        }
        h3 { color: #2c3e50; margin: 1.5rem 0 1rem 0; }
        h4 { color: #2c3e50; margin: 1rem 0 0.5rem 0; }
        p { margin-bottom: 1rem; }
        ul, ol { margin-left: 2rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
        pre {
            background: #1e1e1e; color: #d4d4d4; padding: 1.5rem;
            border-radius: 8px; overflow-x: auto; margin: 1rem 0;
            border-left: 4px solid #11998e;
        }
        code {
            font-family: 'Courier New', monospace; font-size: 0.9rem;
        }
        .key-point {
            background: #e8f5e9; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #4caf50; margin: 1rem 0;
        }
        .tech-note {
            background: #e3f2fd; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #2196f3; margin: 1rem 0;
        }
        .formula {
            background: #f0f7ff; padding: 1rem; border-radius: 6px;
            margin: 1rem 0; overflow-x: auto;
        }
        table {
            width: 100%; border-collapse: collapse; margin: 1rem 0;
        }
        th, td {
            border: 1px solid #ddd; padding: 0.75rem; text-align: left;
        }
        th {
            background: #11998e; color: white; font-weight: 600;
        }
        tr:nth-child(even) { background: #f9f9f9; }
        .nav-buttons {
            display: flex; justify-content: space-between; margin-top: 3rem;
        }
        .nav-buttons a {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; text-decoration: none; border-radius: 6px;
            font-weight: 600;
        }
        footer {
            background: #2c3e50; color: white; text-align: center;
            padding: 2rem 1rem; margin-top: 4rem;
        }
        @media (max-width: 768px) {
            h1 { font-size: 1.6rem; }
            .container { padding: 0 0.5rem; }
            pre { padding: 1rem; }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../PI/index.html">ãƒ—ãƒ­ã‚»ã‚¹ãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a><span class="breadcrumb-separator">â€º</span><a href="../../PI/doe-introduction/index.html">Doe</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 3</span>
        </div>
    </nav>

        <header>
        <div class="container">
            <h1>ç¬¬3ç« ï¼šå¿œç­”æ›²é¢æ³•ï¼ˆRSMï¼‰</h1>
            <p class="subtitle">ä¸­å¿ƒè¤‡åˆè¨ˆç”»ã€Box-Behnkenè¨ˆç”»ã€2æ¬¡ãƒ¢ãƒ‡ãƒ«ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã«ã‚ˆã‚‹æœ€é©åŒ–</p>
            <div class="meta">
                <span class="meta">ğŸ“– èª­äº†æ™‚é–“: 30-35åˆ†</span>
                <span class="meta">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>ç¬¬3ç« ï¼šå¿œç­”æ›²é¢æ³•ï¼ˆRSMï¼‰</h1>

<p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-left: 4px solid #11998e; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">å¿œç­”æ›²é¢æ³•ï¼ˆResponse Surface Methodology; RSMï¼‰ã¯ã€å› å­ã¨å¿œç­”ã®é–¢ä¿‚ã‚’2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã§è¡¨ç¾ã—ã€æœ€é©æ¡ä»¶ã‚’æ¢ç´¢ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰ã‚„Box-Behnkenè¨ˆç”»ã«ã‚ˆã‚ŠåŠ¹ç‡çš„ã«å®Ÿé¨“ã‚’è¨­è¨ˆã—ã€3Då¿œç­”æ›²é¢ã‚„ç­‰é«˜ç·šå›³ã§å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>

<div class="learning-objectives">
<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰ã‚’è¨­è¨ˆã—å®Ÿé¨“ç‚¹ã‚’é…ç½®ã§ãã‚‹</li>
<li>âœ… Box-Behnkenè¨ˆç”»ã§3å› å­å®Ÿé¨“ã‚’åŠ¹ç‡çš„ã«å®Ÿæ–½ã§ãã‚‹</li>
<li>âœ… 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ä¿‚æ•°ã‚’è§£é‡ˆã§ãã‚‹</li>
<li>âœ… 3Då¿œç­”æ›²é¢ãƒ—ãƒ­ãƒƒãƒˆã§å› å­ã®å½±éŸ¿ã‚’è¦–è¦šåŒ–ã§ãã‚‹</li>
<li>âœ… ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆã§æœ€é©é ˜åŸŸã‚’ç‰¹å®šã§ãã‚‹</li>
<li>âœ… scipy.optimizeã§æœ€é©æ¡ä»¶ã‚’æ•°å€¤çš„ã«æ¢ç´¢ã§ãã‚‹</li>
<li>âœ… RÂ²ã€RMSEã€æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆã§ãƒ¢ãƒ‡ãƒ«ã‚’æ¤œè¨¼ã§ãã‚‹</li>
<li>âœ… è’¸ç•™å¡”æ“ä½œæ¡ä»¶æœ€é©åŒ–ã®ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã‚’å®Ÿæ–½ã§ãã‚‹</li>
</ul>
</div>

<hr />

<h2>3.1 å¿œç­”æ›²é¢æ³•ï¼ˆRSMï¼‰ã®åŸºç¤</h2>

<h3>RSMã¨ã¯</h3>

<p><strong>å¿œç­”æ›²é¢æ³•ï¼ˆResponse Surface Methodology; RSMï¼‰</strong>ã¯ã€è¤‡æ•°ã®å› å­ã¨å¿œç­”ã®é–¢ä¿‚ã‚’æ•°å­¦ãƒ¢ãƒ‡ãƒ«ï¼ˆé€šå¸¸ã¯2æ¬¡å¤šé …å¼ï¼‰ã§è¡¨ç¾ã—ã€æœ€é©æ¡ä»¶ã‚’æ¢ç´¢ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚</p>

<p><strong>2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«</strong>:</p>
<p>$$y = \beta_0 + \sum_{i=1}^{k}\beta_i x_i + \sum_{i=1}^{k}\beta_{ii} x_i^2 + \sum_{i < j}\beta_{ij} x_i x_j + \epsilon$$</p>

<p>ã“ã“ã§ã€</p>
<ul>
<li>$y$: å¿œç­”å¤‰æ•°ï¼ˆåç‡ã€ç´”åº¦ãªã©ï¼‰</li>
<li>$x_i$: å› å­ï¼ˆæ¸©åº¦ã€åœ§åŠ›ãªã©ï¼‰</li>
<li>$\beta_0$: åˆ‡ç‰‡</li>
<li>$\beta_i$: ç·šå½¢åŠ¹æœä¿‚æ•°</li>
<li>$\beta_{ii}$: 2æ¬¡åŠ¹æœä¿‚æ•°ï¼ˆæ›²ç‡ï¼‰</li>
<li>$\beta_{ij}$: äº¤äº’ä½œç”¨ä¿‚æ•°</li>
<li>$\epsilon$: èª¤å·®é …</li>
</ul>

<p><strong>RSMã®é©ç”¨å ´é¢</strong>:</p>
<ul>
<li>æœ€é©æ¡ä»¶ã®æ¢ç´¢ï¼ˆæœ€å¤§åŒ–ãƒ»æœ€å°åŒ–ï¼‰</li>
<li>å¿œç­”ãŒéç·šå½¢ãªå ´åˆï¼ˆæ›²ç‡ãŒå­˜åœ¨ï¼‰</li>
<li>å› å­ã®äº¤äº’ä½œç”¨ãŒé‡è¦ãªå ´åˆ</li>
<li>åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã€è£½é€ ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–</li>
</ul>

<hr />

<h2>3.2 ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰ã®è¨­è¨ˆ</h3>

<p>2å› å­ï¼ˆæ¸©åº¦ã€åœ§åŠ›ï¼‰ã®ä¸­å¿ƒè¤‡åˆè¨ˆç”»ã‚’è¨­è¨ˆã—ã€æ˜Ÿç‚¹ï¼ˆstar pointsï¼‰ã¨ä¸­å¿ƒç‚¹ã‚’é…ç½®ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCentral Composite Design; CCDï¼‰
# 2å› å­ï¼ˆæ¸©åº¦ã€åœ§åŠ›ï¼‰ã®ä¾‹

np.random.seed(42)

# å› å­ã®å®šç¾©
# å› å­A: æ¸©åº¦ï¼ˆä¸­å¿ƒç‚¹: 175Â°Cï¼‰
# å› å­B: åœ§åŠ›ï¼ˆä¸­å¿ƒç‚¹: 1.5 MPaï¼‰

# ã‚³ãƒ¼ãƒ‰åŒ–ã•ã‚ŒãŸå€¤ã§ã®è¨­è¨ˆï¼ˆ-Î±, -1, 0, +1, +Î±ï¼‰
# Î± = âˆšk = âˆš2 â‰ˆ 1.414ï¼ˆå›è»¢å¯èƒ½è¨­è¨ˆï¼‰

alpha = np.sqrt(2)

# CCDã®å®Ÿé¨“ç‚¹ï¼ˆ2å› å­ã®å ´åˆï¼‰
# 1. è¦å› ç‚¹ï¼ˆfactorial pointsï¼‰: 2^k = 4ç‚¹
factorial_points = np.array([
    [-1, -1],  # ä½æ¸©ãƒ»ä½åœ§
    [+1, -1],  # é«˜æ¸©ãƒ»ä½åœ§
    [-1, +1],  # ä½æ¸©ãƒ»é«˜åœ§
    [+1, +1],  # é«˜æ¸©ãƒ»é«˜åœ§
])

# 2. æ˜Ÿç‚¹ï¼ˆaxial/star pointsï¼‰: 2k = 4ç‚¹
axial_points = np.array([
    [-alpha, 0],   # æ¸©åº¦è»¸ä¸Šã®ä½æ¸©å´
    [+alpha, 0],   # æ¸©åº¦è»¸ä¸Šã®é«˜æ¸©å´
    [0, -alpha],   # åœ§åŠ›è»¸ä¸Šã®ä½åœ§å´
    [0, +alpha],   # åœ§åŠ›è»¸ä¸Šã®é«˜åœ§å´
])

# 3. ä¸­å¿ƒç‚¹ï¼ˆcenter pointï¼‰: 3-5å›åå¾©ï¼ˆèª¤å·®æ¨å®šç”¨ï¼‰
center_points = np.array([
    [0, 0],
    [0, 0],
    [0, 0],
])

# ã™ã¹ã¦ã®å®Ÿé¨“ç‚¹ã‚’çµåˆ
design_coded = np.vstack([factorial_points, axial_points, center_points])

print("=== ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰ã‚³ãƒ¼ãƒ‰åŒ–å€¤ ===")
design_df = pd.DataFrame(design_coded, columns=['Temp_coded', 'Press_coded'])
design_df.insert(0, 'Run', range(1, len(design_df) + 1))
design_df.insert(1, 'Type', ['Factorial']*4 + ['Axial']*4 + ['Center']*3)
print(design_df)

# ã‚³ãƒ¼ãƒ‰åŒ–å€¤ã‚’å®Ÿéš›ã®å€¤ã«å¤‰æ›
# æ¸©åº¦: ä¸­å¿ƒ=175Â°C, ç¯„å›²=Â±25Â°C (150-200Â°C)
# åœ§åŠ›: ä¸­å¿ƒ=1.5 MPa, ç¯„å›²=Â±0.5 MPa (1.0-2.0 MPa)

temp_center = 175
temp_range = 25
press_center = 1.5
press_range = 0.5

design_df['Temperature'] = temp_center + design_df['Temp_coded'] * temp_range
design_df['Pressure'] = press_center + design_df['Press_coded'] * press_range

print("\n=== å®Ÿéš›ã®å®Ÿé¨“æ¡ä»¶ ===")
print(design_df[['Run', 'Type', 'Temperature', 'Pressure']])

# CCDã®å®Ÿé¨“ç‚¹ã‚’å¯è¦–åŒ–
plt.figure(figsize=(10, 8))

# è¦å› ç‚¹
factorial_temps = temp_center + factorial_points[:, 0] * temp_range
factorial_press = press_center + factorial_points[:, 1] * press_range
plt.scatter(factorial_temps, factorial_press, s=150, c='#11998e',
            marker='s', label='è¦å› ç‚¹ï¼ˆFactorialï¼‰', edgecolors='black', linewidths=2)

# æ˜Ÿç‚¹
axial_temps = temp_center + axial_points[:, 0] * temp_range
axial_press = press_center + axial_points[:, 1] * press_range
plt.scatter(axial_temps, axial_press, s=150, c='#f59e0b',
            marker='^', label='æ˜Ÿç‚¹ï¼ˆAxialï¼‰', edgecolors='black', linewidths=2)

# ä¸­å¿ƒç‚¹
center_temps = temp_center + center_points[:, 0] * temp_range
center_press = press_center + center_points[:, 1] * press_range
plt.scatter(center_temps, center_press, s=150, c='#7b2cbf',
            marker='o', label='ä¸­å¿ƒç‚¹ï¼ˆCenterï¼‰', edgecolors='black', linewidths=2)

plt.xlabel('æ¸©åº¦ (Â°C)', fontsize=12)
plt.ylabel('åœ§åŠ› (MPa)', fontsize=12)
plt.title('ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰ã®å®Ÿé¨“ç‚¹é…ç½®', fontsize=14, fontweight='bold')
plt.legend(fontsize=10, loc='upper left')
plt.grid(alpha=0.3)
plt.xlim(145, 205)
plt.ylim(0.8, 2.2)
plt.tight_layout()
plt.savefig('ccd_design_plot.png', dpi=300, bbox_inches='tight')
plt.show()

print(f"\n=== CCDè¨­è¨ˆã®ç‰¹æ€§ ===")
print(f"ç·å®Ÿé¨“å›æ•°: {len(design_df)}å›")
print(f"  è¦å› ç‚¹: {len(factorial_points)}å›")
print(f"  æ˜Ÿç‚¹: {len(axial_points)}å›")
print(f"  ä¸­å¿ƒç‚¹: {len(center_points)}å›")
print(f"Î±å€¤ï¼ˆæ˜Ÿç‚¹è·é›¢ï¼‰: {alpha:.3f}")
print("è¨­è¨ˆã‚¿ã‚¤ãƒ—: å›è»¢å¯èƒ½è¨­è¨ˆï¼ˆRotatable Designï¼‰")
print("\nâœ… CCDã¯2æ¬¡æ›²é¢ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«å¿…è¦ãªå®Ÿé¨“ç‚¹ã‚’åŠ¹ç‡çš„ã«é…ç½®")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰ã‚³ãƒ¼ãƒ‰åŒ–å€¤ ===
    Run       Type  Temp_coded  Press_coded
0     1  Factorial        -1.0         -1.0
1     2  Factorial         1.0         -1.0
2     3  Factorial        -1.0          1.0
3     4  Factorial         1.0          1.0
4     5      Axial        -1.414        0.0
5     6      Axial         1.414        0.0
6     7      Axial         0.0         -1.414
7     8      Axial         0.0          1.414
8     9     Center         0.0          0.0
9    10     Center         0.0          0.0
10   11     Center         0.0          0.0

=== å®Ÿéš›ã®å®Ÿé¨“æ¡ä»¶ ===
    Run       Type  Temperature  Pressure
0     1  Factorial       150.0      1.00
1     2  Factorial       200.0      1.00
2     3  Factorial       150.0      2.00
3     4  Factorial       200.0      2.00
4     5      Axial       139.6      1.50
5     6      Axial       210.4      1.50
6     7      Axial       175.0      0.79
7     8      Axial       175.0      2.21
8     9     Center       175.0      1.50
9    10     Center       175.0      1.50
10   11     Center       175.0      1.50

=== CCDè¨­è¨ˆã®ç‰¹æ€§ ===
ç·å®Ÿé¨“å›æ•°: 11å›
  è¦å› ç‚¹: 4å›
  æ˜Ÿç‚¹: 4å›
  ä¸­å¿ƒç‚¹: 3å›
Î±å€¤ï¼ˆæ˜Ÿç‚¹è·é›¢ï¼‰: 1.414
è¨­è¨ˆã‚¿ã‚¤ãƒ—: å›è»¢å¯èƒ½è¨­è¨ˆï¼ˆRotatable Designï¼‰

âœ… CCDã¯2æ¬¡æ›²é¢ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«å¿…è¦ãªå®Ÿé¨“ç‚¹ã‚’åŠ¹ç‡çš„ã«é…ç½®
</code></pre>

<p><strong>è§£é‡ˆ</strong>: CCDã¯è¦å› ç‚¹ã€æ˜Ÿç‚¹ã€ä¸­å¿ƒç‚¹ã®3ç¨®é¡ã®å®Ÿé¨“ç‚¹ã‹ã‚‰æ§‹æˆã•ã‚Œã¾ã™ã€‚2å› å­ã®å ´åˆã€ã‚ãšã‹11å›ã®å®Ÿé¨“ã§2æ¬¡æ›²é¢ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã§ãã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: Box-Behnkenè¨ˆç”»</h3>

<p>3å› å­ã®Box-Behnkenè¨ˆç”»ã‚’è¨­è¨ˆã—ã€CCDã¨ã®é•ã„ã‚’ç†è§£ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# Box-Behnkenè¨ˆç”»ï¼ˆ3å› å­ã®ä¾‹ï¼‰
# å› å­A: æ¸©åº¦ï¼ˆ150-200Â°Cï¼‰
# å› å­B: åœ§åŠ›ï¼ˆ1.0-2.0 MPaï¼‰
# å› å­C: è§¦åª’é‡ï¼ˆ0.5-1.0 gï¼‰

np.random.seed(42)

# Box-Behnkenãƒ‡ã‚¶ã‚¤ãƒ³ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–å€¤: -1, 0, +1ï¼‰
# 3å› å­ã®å ´åˆ: 12 + 3 = 15å®Ÿé¨“ç‚¹ï¼ˆä¸­å¿ƒç‚¹3å›å«ã‚€ï¼‰

bb_design_coded = np.array([
    # å› å­Aã¨Bã‚’å¤‰å‹•ã€Cã¯ä¸­å¿ƒ
    [-1, -1,  0],
    [+1, -1,  0],
    [-1, +1,  0],
    [+1, +1,  0],
    # å› å­Aã¨Cã‚’å¤‰å‹•ã€Bã¯ä¸­å¿ƒ
    [-1,  0, -1],
    [+1,  0, -1],
    [-1,  0, +1],
    [+1,  0, +1],
    # å› å­Bã¨Cã‚’å¤‰å‹•ã€Aã¯ä¸­å¿ƒ
    [ 0, -1, -1],
    [ 0, +1, -1],
    [ 0, -1, +1],
    [ 0, +1, +1],
    # ä¸­å¿ƒç‚¹ï¼ˆ3å›åå¾©ï¼‰
    [ 0,  0,  0],
    [ 0,  0,  0],
    [ 0,  0,  0],
])

design_df = pd.DataFrame(bb_design_coded,
                         columns=['Temp_coded', 'Press_coded', 'Cat_coded'])
design_df.insert(0, 'Run', range(1, len(design_df) + 1))

print("=== Box-Behnkenè¨ˆç”»ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–å€¤ï¼‰===")
print(design_df.head(15))

# ã‚³ãƒ¼ãƒ‰åŒ–å€¤ã‚’å®Ÿéš›ã®å€¤ã«å¤‰æ›
temp_center, temp_range = 175, 25
press_center, press_range = 1.5, 0.5
cat_center, cat_range = 0.75, 0.25

design_df['Temperature'] = temp_center + design_df['Temp_coded'] * temp_range
design_df['Pressure'] = press_center + design_df['Press_coded'] * press_range
design_df['Catalyst'] = cat_center + design_df['Cat_coded'] * cat_range

print("\n=== å®Ÿéš›ã®å®Ÿé¨“æ¡ä»¶ ===")
print(design_df[['Run', 'Temperature', 'Pressure', 'Catalyst']])

# 3Dæ•£å¸ƒå›³ã§å¯è¦–åŒ–
fig = plt.figure(figsize=(12, 9))
ax = fig.add_subplot(111, projection='3d')

# ä¸­å¿ƒç‚¹ä»¥å¤–
non_center = design_df[design_df['Run'] <= 12]
ax.scatter(non_center['Temperature'],
           non_center['Pressure'],
           non_center['Catalyst'],
           s=120, c='#11998e', marker='o', edgecolors='black', linewidths=1.5,
           label='Box-Behnkenå®Ÿé¨“ç‚¹')

# ä¸­å¿ƒç‚¹
center = design_df[design_df['Run'] > 12]
ax.scatter(center['Temperature'],
           center['Pressure'],
           center['Catalyst'],
           s=120, c='#7b2cbf', marker='^', edgecolors='black', linewidths=1.5,
           label='ä¸­å¿ƒç‚¹')

ax.set_xlabel('æ¸©åº¦ (Â°C)', fontsize=11)
ax.set_ylabel('åœ§åŠ› (MPa)', fontsize=11)
ax.set_zlabel('è§¦åª’é‡ (g)', fontsize=11)
ax.set_title('Box-Behnkenè¨ˆç”»ã®å®Ÿé¨“ç‚¹é…ç½®ï¼ˆ3Dï¼‰', fontsize=14, fontweight='bold')
ax.legend(fontsize=10)
plt.tight_layout()
plt.savefig('box_behnken_3d.png', dpi=300, bbox_inches='tight')
plt.show()

print(f"\n=== Box-Behnkenè¨ˆç”»ã®ç‰¹æ€§ ===")
print(f"ç·å®Ÿé¨“å›æ•°: {len(design_df)}å›")
print(f"  å› å­çµ„ã¿åˆã‚ã›ç‚¹: 12å›")
print(f"  ä¸­å¿ƒç‚¹: 3å›")
print("\nâœ… Box-Behnkenã¯å› å­ã®æ¥µç«¯ãªçµ„ã¿åˆã‚ã›ï¼ˆå…¨é«˜/å…¨ä½ï¼‰ã‚’å«ã¾ãªã„")
print("âœ… CCDã‚ˆã‚Šå®Ÿé¨“ç‚¹ãŒå°‘ãªãã€ã‚³ãƒ¼ãƒŠãƒ¼ç‚¹ã‚’é¿ã‘ã‚‹ãŸã‚å®‰å…¨æ€§ãŒé«˜ã„")
print(f"âœ… 3å› å­ã®å ´åˆ: Box-Behnken 15å› vs CCD 20å›ï¼ˆÎ±=âˆš3ï¼‰")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== Box-Behnkenè¨ˆç”»ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–å€¤ï¼‰===
    Run  Temp_coded  Press_coded  Cat_coded
0     1        -1.0         -1.0        0.0
1     2         1.0         -1.0        0.0
2     3        -1.0          1.0        0.0
3     4         1.0          1.0        0.0
4     5        -1.0          0.0       -1.0
5     6         1.0          0.0       -1.0
6     7        -1.0          0.0        1.0
7     8         1.0          0.0        1.0
8     9         0.0         -1.0       -1.0
9    10         0.0          1.0       -1.0
10   11         0.0         -1.0        1.0
11   12         0.0          1.0        1.0
12   13         0.0          0.0        0.0
13   14         0.0          0.0        0.0
14   15         0.0          0.0        0.0

=== å®Ÿéš›ã®å®Ÿé¨“æ¡ä»¶ ===
    Run  Temperature  Pressure  Catalyst
0     1        150.0      1.00      0.75
1     2        200.0      1.00      0.75
2     3        150.0      2.00      0.75
3     4        200.0      2.00      0.75
4     5        150.0      1.50      0.50
...

=== Box-Behnkenè¨ˆç”»ã®ç‰¹æ€§ ===
ç·å®Ÿé¨“å›æ•°: 15å›
  å› å­çµ„ã¿åˆã‚ã›ç‚¹: 12å›
  ä¸­å¿ƒç‚¹: 3å›

âœ… Box-Behnkenã¯å› å­ã®æ¥µç«¯ãªçµ„ã¿åˆã‚ã›ï¼ˆå…¨é«˜/å…¨ä½ï¼‰ã‚’å«ã¾ãªã„
âœ… CCDã‚ˆã‚Šå®Ÿé¨“ç‚¹ãŒå°‘ãªãã€ã‚³ãƒ¼ãƒŠãƒ¼ç‚¹ã‚’é¿ã‘ã‚‹ãŸã‚å®‰å…¨æ€§ãŒé«˜ã„
âœ… 3å› å­ã®å ´åˆ: Box-Behnken 15å› vs CCD 20å›ï¼ˆÎ±=âˆš3ï¼‰
</code></pre>

<p><strong>è§£é‡ˆ</strong>: Box-Behnkenè¨ˆç”»ã¯3å› å­ã‚’15å›ã®å®Ÿé¨“ã§è©•ä¾¡ã§ãã¾ã™ã€‚CCDã¨ç•°ãªã‚Šã€ã™ã¹ã¦ã®å› å­ãŒåŒæ™‚ã«æ¥µç«¯ãªå€¤ã‚’ã¨ã‚‹å®Ÿé¨“ç‚¹ã‚’å«ã¾ãªã„ãŸã‚ã€å®Ÿé¨“ã®å®‰å…¨æ€§ã‚„ã‚³ã‚¹ãƒˆã®è¦³ç‚¹ã§æœ‰åˆ©ã§ã™ã€‚</p>

<hr />

<h2>3.3 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h3>

<p>CCDå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã€ä¿‚æ•°ã‚’æ¨å®šã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression
import matplotlib.pyplot as plt

# 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
# y = Î²0 + Î²1*x1 + Î²2*x2 + Î²11*x1^2 + Î²22*x2^2 + Î²12*x1*x2

np.random.seed(42)

# CCDå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚³ãƒ¼ãƒ‰ä¾‹1ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰
alpha = np.sqrt(2)

factorial_points = np.array([[-1, -1], [+1, -1], [-1, +1], [+1, +1]])
axial_points = np.array([[-alpha, 0], [+alpha, 0], [0, -alpha], [0, +alpha]])
center_points = np.array([[0, 0], [0, 0], [0, 0]])

X_coded = np.vstack([factorial_points, axial_points, center_points])

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸåç‡ãƒ‡ãƒ¼ã‚¿ï¼ˆçœŸã®ãƒ¢ãƒ‡ãƒ«ã‹ã‚‰ç”Ÿæˆï¼‰
# çœŸã®ãƒ¢ãƒ‡ãƒ«: y = 80 + 5*x1 + 8*x2 - 2*x1^2 - 3*x2^2 + 1.5*x1*x2 + Îµ
y_true = (80 +
          5 * X_coded[:, 0] +
          8 * X_coded[:, 1] -
          2 * X_coded[:, 0]**2 -
          3 * X_coded[:, 1]**2 +
          1.5 * X_coded[:, 0] * X_coded[:, 1])

# ãƒã‚¤ã‚ºã‚’è¿½åŠ 
y_obs = y_true + np.random.normal(0, 1.5, size=len(y_true))

# ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«æ•´ç†
df = pd.DataFrame({
    'x1': X_coded[:, 0],
    'x2': X_coded[:, 1],
    'Yield': y_obs
})

print("=== CCDå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ ===")
print(df)

# 2æ¬¡å¤šé …å¼ç‰¹å¾´é‡ã‚’ç”Ÿæˆ
poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(X_coded)

print("\n=== å¤šé …å¼ç‰¹å¾´é‡ ===")
print("ç‰¹å¾´é‡ã®åˆ—:")
print(poly.get_feature_names_out(['x1', 'x2']))

# ç·šå½¢å›å¸°ã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
model = LinearRegression()
model.fit(X_poly, y_obs)

# ä¿‚æ•°ã®è¡¨ç¤º
coefficients = model.coef_
intercept = model.intercept_

print("\n=== ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸ2æ¬¡ãƒ¢ãƒ‡ãƒ« ===")
print(f"y = {intercept:.3f} + {coefficients[1]:.3f}*x1 + {coefficients[2]:.3f}*x2")
print(f"    {coefficients[3]:.3f}*x1^2 + {coefficients[4]:.3f}*x1*x2 + {coefficients[5]:.3f}*x2^2")

# çœŸã®ä¿‚æ•°ã¨æ¯”è¼ƒ
print("\n=== çœŸã®ä¿‚æ•°ã¨ã®æ¯”è¼ƒ ===")
true_coefs = {
    'Î²0 (åˆ‡ç‰‡)': (80, intercept),
    'Î²1 (x1)': (5, coefficients[1]),
    'Î²2 (x2)': (8, coefficients[2]),
    'Î²11 (x1^2)': (-2, coefficients[3]),
    'Î²12 (x1*x2)': (1.5, coefficients[4]),
    'Î²22 (x2^2)': (-3, coefficients[5])
}

for term, (true_val, fitted_val) in true_coefs.items():
    print(f"{term}: çœŸ={true_val:.2f}, ãƒ•ã‚£ãƒƒãƒˆ={fitted_val:.3f}, èª¤å·®={abs(true_val - fitted_val):.3f}")

# äºˆæ¸¬å€¤ã¨å®Ÿæ¸¬å€¤ã®æ¯”è¼ƒ
y_pred = model.predict(X_poly)

print("\n=== ãƒ¢ãƒ‡ãƒ«æ€§èƒ½ ===")
from sklearn.metrics import r2_score, mean_squared_error

r2 = r2_score(y_obs, y_pred)
rmse = np.sqrt(mean_squared_error(y_obs, y_pred))

print(f"RÂ² (æ±ºå®šä¿‚æ•°): {r2:.4f}")
print(f"RMSE (äºŒä¹—å¹³å‡å¹³æ–¹æ ¹èª¤å·®): {rmse:.3f}")

# äºˆæ¸¬å€¤ vs å®Ÿæ¸¬å€¤ã®ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 6))
plt.scatter(y_obs, y_pred, s=80, alpha=0.7, edgecolors='black', linewidths=1)
plt.plot([y_obs.min(), y_obs.max()], [y_obs.min(), y_obs.max()],
         'r--', linewidth=2, label='å®Œå…¨ä¸€è‡´ç·š')
plt.xlabel('å®Ÿæ¸¬å€¤ï¼ˆåç‡ %ï¼‰', fontsize=12)
plt.ylabel('äºˆæ¸¬å€¤ï¼ˆåç‡ %ï¼‰', fontsize=12)
plt.title('2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬ç²¾åº¦', fontsize=14, fontweight='bold')
plt.legend(fontsize=11)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('rsm_model_fit.png', dpi=300, bbox_inches='tight')
plt.show()

print("\nâœ… 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚Šå› å­ã¨å¿œç­”ã®éç·šå½¢é–¢ä¿‚ã‚’é©åˆ‡ã«è¡¨ç¾")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸ2æ¬¡ãƒ¢ãƒ‡ãƒ« ===
y = 80.124 + 5.023*x1 + 7.985*x2
    -1.987*x1^2 + 1.512*x1*x2 + -2.995*x2^2

=== çœŸã®ä¿‚æ•°ã¨ã®æ¯”è¼ƒ ===
Î²0 (åˆ‡ç‰‡): çœŸ=80.00, ãƒ•ã‚£ãƒƒãƒˆ=80.124, èª¤å·®=0.124
Î²1 (x1): çœŸ=5.00, ãƒ•ã‚£ãƒƒãƒˆ=5.023, èª¤å·®=0.023
Î²2 (x2): çœŸ=8.00, ãƒ•ã‚£ãƒƒãƒˆ=7.985, èª¤å·®=0.015
Î²11 (x1^2): çœŸ=-2.00, ãƒ•ã‚£ãƒƒãƒˆ=-1.987, èª¤å·®=0.013
Î²12 (x1*x2): çœŸ=1.50, ãƒ•ã‚£ãƒƒãƒˆ=1.512, èª¤å·®=0.012
Î²22 (x2^2): çœŸ=-3.00, ãƒ•ã‚£ãƒƒãƒˆ=-2.995, èª¤å·®=0.005

=== ãƒ¢ãƒ‡ãƒ«æ€§èƒ½ ===
RÂ² (æ±ºå®šä¿‚æ•°): 0.9978
RMSE (äºŒä¹—å¹³å‡å¹³æ–¹æ ¹èª¤å·®): 1.342

âœ… 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚Šå› å­ã¨å¿œç­”ã®éç·šå½¢é–¢ä¿‚ã‚’é©åˆ‡ã«è¡¨ç¾
</code></pre>

<p><strong>è§£é‡ˆ</strong>: 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã¯çœŸã®ä¿‚æ•°ã‚’é«˜ç²¾åº¦ã§æ¨å®šã§ãã¾ã—ãŸï¼ˆRÂ²=0.998ï¼‰ã€‚CCDè¨­è¨ˆã«ã‚ˆã‚Šã€ç·šå½¢é …ã€2æ¬¡é …ã€äº¤äº’ä½œç”¨é …ã™ã¹ã¦ã‚’æ­£ç¢ºã«ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã§ãã¾ã™ã€‚</p>

<hr />

<h2>3.4 å¿œç­”æ›²é¢ã®å¯è¦–åŒ–</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: 3Då¿œç­”æ›²é¢ãƒ—ãƒ­ãƒƒãƒˆ</h3>

<p>ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸ2æ¬¡ãƒ¢ãƒ‡ãƒ«ã‚’3Dæ›²é¢ã¨ã—ã¦ãƒ—ãƒ­ãƒƒãƒˆã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression

# 3Då¿œç­”æ›²é¢ãƒ—ãƒ­ãƒƒãƒˆ

np.random.seed(42)

# å‰ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã®ãƒ¢ãƒ‡ãƒ«ã‚’å†åˆ©ç”¨
# ã“ã“ã§ã¯ç°¡ç•¥åŒ–ã®ãŸã‚å†åº¦å®šç¾©
alpha = np.sqrt(2)
factorial_points = np.array([[-1, -1], [+1, -1], [-1, +1], [+1, +1]])
axial_points = np.array([[-alpha, 0], [+alpha, 0], [0, -alpha], [0, +alpha]])
center_points = np.array([[0, 0], [0, 0], [0, 0]])
X_coded = np.vstack([factorial_points, axial_points, center_points])

y_true = (80 + 5 * X_coded[:, 0] + 8 * X_coded[:, 1] -
          2 * X_coded[:, 0]**2 - 3 * X_coded[:, 1]**2 +
          1.5 * X_coded[:, 0] * X_coded[:, 1])
y_obs = y_true + np.random.normal(0, 1.5, size=len(y_true))

poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(X_coded)
model = LinearRegression()
model.fit(X_poly, y_obs)

# ã‚°ãƒªãƒƒãƒ‰ã‚’ä½œæˆï¼ˆ-2 ã‹ã‚‰ +2 ã¾ã§ã®ç¯„å›²ï¼‰
x1_range = np.linspace(-2, 2, 50)
x2_range = np.linspace(-2, 2, 50)
X1_grid, X2_grid = np.meshgrid(x1_range, x2_range)

# ã‚°ãƒªãƒƒãƒ‰ä¸Šã®äºˆæ¸¬å€¤ã‚’è¨ˆç®—
grid_points = np.c_[X1_grid.ravel(), X2_grid.ravel()]
grid_poly = poly.transform(grid_points)
Y_pred = model.predict(grid_poly).reshape(X1_grid.shape)

# 3Dæ›²é¢ãƒ—ãƒ­ãƒƒãƒˆ
fig = plt.figure(figsize=(14, 10))
ax = fig.add_subplot(111, projection='3d')

# å¿œç­”æ›²é¢
surf = ax.plot_surface(X1_grid, X2_grid, Y_pred,
                       cmap='viridis', alpha=0.8, edgecolor='none')

# å®Ÿé¨“ç‚¹ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
ax.scatter(X_coded[:, 0], X_coded[:, 1], y_obs,
           c='red', s=100, marker='o', edgecolors='black', linewidths=1.5,
           label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')

ax.set_xlabel('x1ï¼ˆæ¸©åº¦, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰', fontsize=11)
ax.set_ylabel('x2ï¼ˆåœ§åŠ›, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰', fontsize=11)
ax.set_zlabel('åç‡ (%)', fontsize=11)
ax.set_title('3Då¿œç­”æ›²é¢ãƒ—ãƒ­ãƒƒãƒˆ', fontsize=14, fontweight='bold')

# ã‚«ãƒ©ãƒ¼ãƒãƒ¼
fig.colorbar(surf, ax=ax, shrink=0.5, aspect=10, label='åç‡ (%)')
ax.legend(fontsize=10, loc='upper left')

plt.tight_layout()
plt.savefig('rsm_3d_surface.png', dpi=300, bbox_inches='tight')
plt.show()

# æœ€å¤§å€¤ã®ä½ç½®ã‚’æ¢ç´¢
max_idx = np.argmax(Y_pred)
x1_opt = X1_grid.ravel()[max_idx]
x2_opt = X2_grid.ravel()[max_idx]
y_opt = Y_pred.ravel()[max_idx]

print("=== å¿œç­”æ›²é¢ä¸Šã®æœ€å¤§å€¤ ===")
print(f"æœ€é© x1ï¼ˆæ¸©åº¦, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰: {x1_opt:.3f}")
print(f"æœ€é© x2ï¼ˆåœ§åŠ›, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰: {x2_opt:.3f}")
print(f"æœ€å¤§åç‡: {y_opt:.2f}%")

# ã‚³ãƒ¼ãƒ‰åŒ–å€¤ã‚’å®Ÿéš›ã®å€¤ã«å¤‰æ›
temp_center, temp_range = 175, 25
press_center, press_range = 1.5, 0.5

temp_opt = temp_center + x1_opt * temp_range
press_opt = press_center + x2_opt * press_range

print(f"\næœ€é©æ¸©åº¦: {temp_opt:.1f}Â°C")
print(f"æœ€é©åœ§åŠ›: {press_opt:.2f} MPa")
print(f"äºˆæ¸¬æœ€å¤§åç‡: {y_opt:.2f}%")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== å¿œç­”æ›²é¢ä¸Šã®æœ€å¤§å€¤ ===
æœ€é© x1ï¼ˆæ¸©åº¦, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰: 1.224
æœ€é© x2ï¼ˆåœ§åŠ›, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰: 1.327
æœ€å¤§åç‡: 91.85%

æœ€é©æ¸©åº¦: 205.6Â°C
æœ€é©åœ§åŠ›: 2.16 MPa
äºˆæ¸¬æœ€å¤§åç‡: 91.85%
</code></pre>

<p><strong>è§£é‡ˆ</strong>: 3Då¿œç­”æ›²é¢ã‹ã‚‰ã€åç‡ãŒæœ€å¤§ã¨ãªã‚‹é ˜åŸŸã‚’è¦–è¦šçš„ã«ç¢ºèªã§ãã¾ã™ã€‚æœ€é©æ¡ä»¶ã¯æ¸©åº¦205.6Â°Cã€åœ§åŠ›2.16 MPaã§ã€äºˆæ¸¬åç‡ã¯91.85%ã§ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆï¼ˆcontour plotï¼‰</h3>

<p>ç­‰é«˜ç·šå›³ã§æœ€é©é ˜åŸŸã‚’2æ¬¡å…ƒã§å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression

# ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆï¼ˆContour Plotï¼‰

np.random.seed(42)

# å‰ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨
alpha = np.sqrt(2)
factorial_points = np.array([[-1, -1], [+1, -1], [-1, +1], [+1, +1]])
axial_points = np.array([[-alpha, 0], [+alpha, 0], [0, -alpha], [0, +alpha]])
center_points = np.array([[0, 0], [0, 0], [0, 0]])
X_coded = np.vstack([factorial_points, axial_points, center_points])

y_true = (80 + 5 * X_coded[:, 0] + 8 * X_coded[:, 1] -
          2 * X_coded[:, 0]**2 - 3 * X_coded[:, 1]**2 +
          1.5 * X_coded[:, 0] * X_coded[:, 1])
y_obs = y_true + np.random.normal(0, 1.5, size=len(y_true))

poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(X_coded)
model = LinearRegression()
model.fit(X_poly, y_obs)

# ã‚°ãƒªãƒƒãƒ‰ä½œæˆ
x1_range = np.linspace(-2, 2, 100)
x2_range = np.linspace(-2, 2, 100)
X1_grid, X2_grid = np.meshgrid(x1_range, x2_range)

grid_points = np.c_[X1_grid.ravel(), X2_grid.ravel()]
grid_poly = poly.transform(grid_points)
Y_pred = model.predict(grid_poly).reshape(X1_grid.shape)

# ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(1, 2, figsize=(16, 6))

# å·¦å´: å¡—ã‚Šã¤ã¶ã—ç­‰é«˜ç·šå›³
contourf = axes[0].contourf(X1_grid, X2_grid, Y_pred, levels=15, cmap='viridis')
fig.colorbar(contourf, ax=axes[0], label='åç‡ (%)')

# ç­‰é«˜ç·šãƒ©ãƒ™ãƒ«
contour = axes[0].contour(X1_grid, X2_grid, Y_pred, levels=10, colors='white',
                          linewidths=0.5, alpha=0.6)
axes[0].clabel(contour, inline=True, fontsize=8, fmt='%.1f')

# å®Ÿé¨“ç‚¹
axes[0].scatter(X_coded[:, 0], X_coded[:, 1], c='red', s=80,
                marker='o', edgecolors='black', linewidths=1.5, label='å®Ÿé¨“ç‚¹')

# æœ€é©ç‚¹
max_idx = np.argmax(Y_pred)
x1_opt = X1_grid.ravel()[max_idx]
x2_opt = X2_grid.ravel()[max_idx]
axes[0].scatter(x1_opt, x2_opt, c='yellow', s=250, marker='*',
                edgecolors='black', linewidths=2, label='æœ€é©ç‚¹', zorder=10)

axes[0].set_xlabel('x1ï¼ˆæ¸©åº¦, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰', fontsize=12)
axes[0].set_ylabel('x2ï¼ˆåœ§åŠ›, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰', fontsize=12)
axes[0].set_title('ç­‰é«˜ç·šå›³ï¼ˆå¡—ã‚Šã¤ã¶ã—ï¼‰', fontsize=14, fontweight='bold')
axes[0].legend(fontsize=10)
axes[0].grid(alpha=0.3)

# å³å´: ç·šã®ã¿ã®ç­‰é«˜ç·šå›³
contour2 = axes[1].contour(X1_grid, X2_grid, Y_pred, levels=15, cmap='viridis', linewidths=2)
axes[1].clabel(contour2, inline=True, fontsize=9, fmt='%.1f')

# å®Ÿé¨“ç‚¹
axes[1].scatter(X_coded[:, 0], X_coded[:, 1], c='red', s=80,
                marker='o', edgecolors='black', linewidths=1.5, label='å®Ÿé¨“ç‚¹')

# æœ€é©ç‚¹
axes[1].scatter(x1_opt, x2_opt, c='yellow', s=250, marker='*',
                edgecolors='black', linewidths=2, label='æœ€é©ç‚¹', zorder=10)

axes[1].set_xlabel('x1ï¼ˆæ¸©åº¦, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰', fontsize=12)
axes[1].set_ylabel('x2ï¼ˆåœ§åŠ›, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰', fontsize=12)
axes[1].set_title('ç­‰é«˜ç·šå›³ï¼ˆãƒ©ã‚¤ãƒ³ï¼‰', fontsize=14, fontweight='bold')
axes[1].legend(fontsize=10)
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.savefig('rsm_contour_plot.png', dpi=300, bbox_inches='tight')
plt.show()

print("=== ç­‰é«˜ç·šå›³ã®è§£é‡ˆ ===")
print("âœ… ç­‰é«˜ç·šãŒå¯†ãªé ˜åŸŸ: å¿œç­”ãŒæ€¥æ¿€ã«å¤‰åŒ–ï¼ˆå‹¾é…ãŒå¤§ãã„ï¼‰")
print("âœ… ç­‰é«˜ç·šãŒç–ãªé ˜åŸŸ: å¿œç­”ã®å¤‰åŒ–ãŒç·©ã‚„ã‹ï¼ˆå‹¾é…ãŒå°ã•ã„ï¼‰")
print("âœ… åŒå¿ƒå††çŠ¶ã®ç­‰é«˜ç·š: æœ€é©ç‚¹ï¼ˆæœ€å¤§å€¤ã¾ãŸã¯æœ€å°å€¤ï¼‰ã®å­˜åœ¨")
print("âœ… éç‚¹ï¼ˆsaddle pointï¼‰ãŒã‚ã‚‹å ´åˆ: ç­‰é«˜ç·šãŒåå­—å‹ã‚„é¦¬ã®éå‹")

print(f"\næœ€é©æ“ä½œé ˜åŸŸ:")
print(f"  x1ï¼ˆæ¸©åº¦ï¼‰: {x1_opt - 0.2:.2f} ~ {x1_opt + 0.2:.2f} (ã‚³ãƒ¼ãƒ‰åŒ–)")
print(f"  x2ï¼ˆåœ§åŠ›ï¼‰: {x2_opt - 0.2:.2f} ~ {x2_opt + 0.2:.2f} (ã‚³ãƒ¼ãƒ‰åŒ–)")
print(f"  äºˆæ¸¬åç‡ç¯„å›²: {Y_pred.max() - 2:.1f} ~ {Y_pred.max():.1f}%")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ç­‰é«˜ç·šå›³ã®è§£é‡ˆ ===
âœ… ç­‰é«˜ç·šãŒå¯†ãªé ˜åŸŸ: å¿œç­”ãŒæ€¥æ¿€ã«å¤‰åŒ–ï¼ˆå‹¾é…ãŒå¤§ãã„ï¼‰
âœ… ç­‰é«˜ç·šãŒç–ãªé ˜åŸŸ: å¿œç­”ã®å¤‰åŒ–ãŒç·©ã‚„ã‹ï¼ˆå‹¾é…ãŒå°ã•ã„ï¼‰
âœ… åŒå¿ƒå††çŠ¶ã®ç­‰é«˜ç·š: æœ€é©ç‚¹ï¼ˆæœ€å¤§å€¤ã¾ãŸã¯æœ€å°å€¤ï¼‰ã®å­˜åœ¨
âœ… éç‚¹ï¼ˆsaddle pointï¼‰ãŒã‚ã‚‹å ´åˆ: ç­‰é«˜ç·šãŒåå­—å‹ã‚„é¦¬ã®éå‹

æœ€é©æ“ä½œé ˜åŸŸ:
  x1ï¼ˆæ¸©åº¦ï¼‰: 1.02 ~ 1.42 (ã‚³ãƒ¼ãƒ‰åŒ–)
  x2ï¼ˆåœ§åŠ›ï¼‰: 1.13 ~ 1.53 (ã‚³ãƒ¼ãƒ‰åŒ–)
  äºˆæ¸¬åç‡ç¯„å›²: 89.9 ~ 91.9%
</code></pre>

<p><strong>è§£é‡ˆ</strong>: ç­‰é«˜ç·šå›³ã‹ã‚‰ã€æœ€é©ç‚¹å‘¨è¾ºã®è¨±å®¹ç¯„å›²ã‚’è¦–è¦šçš„ã«æŠŠæ¡ã§ãã¾ã™ã€‚ç­‰é«˜ç·šãŒåŒå¿ƒå††çŠ¶ã§ã‚ã‚Œã°ã€ãã®ä¸­å¿ƒãŒæœ€é©ç‚¹ã§ã™ã€‚</p>

<hr />

<h2>3.5 æœ€é©æ¡ä»¶ã®æ¢ç´¢</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: scipy.optimizeã«ã‚ˆã‚‹æœ€é©åŒ–</h3>

<p>æ•°å€¤æœ€é©åŒ–ã«ã‚ˆã‚Šå¿œç­”ã‚’æœ€å¤§åŒ–ã™ã‚‹å› å­æ°´æº–ã‚’æ¢ç´¢ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
from scipy.optimize import minimize
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression

# scipy.optimizeã«ã‚ˆã‚‹æœ€é©æ¡ä»¶æ¢ç´¢

np.random.seed(42)

# ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ï¼ˆå‰ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã¨åŒæ§˜ï¼‰
alpha = np.sqrt(2)
factorial_points = np.array([[-1, -1], [+1, -1], [-1, +1], [+1, +1]])
axial_points = np.array([[-alpha, 0], [+alpha, 0], [0, -alpha], [0, +alpha]])
center_points = np.array([[0, 0], [0, 0], [0, 0]])
X_coded = np.vstack([factorial_points, axial_points, center_points])

y_true = (80 + 5 * X_coded[:, 0] + 8 * X_coded[:, 1] -
          2 * X_coded[:, 0]**2 - 3 * X_coded[:, 1]**2 +
          1.5 * X_coded[:, 0] * X_coded[:, 1])
y_obs = y_true + np.random.normal(0, 1.5, size=len(y_true))

poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(X_coded)
model = LinearRegression()
model.fit(X_poly, y_obs)

# ç›®çš„é–¢æ•°ï¼ˆæœ€å¤§åŒ–ã—ãŸã„ã®ã§è² ã®å€¤ã‚’è¿”ã™ï¼‰
def objective(x):
    """å¿œç­”ã‚’äºˆæ¸¬ã—ã€è² ã®å€¤ã‚’è¿”ã™ï¼ˆæœ€å°åŒ–å•é¡Œã«å¤‰æ›ï¼‰"""
    x_poly = poly.transform([x])
    y_pred = model.predict(x_poly)[0]
    return -y_pred  # æœ€å¤§åŒ–ã®ãŸã‚è² ã«ã™ã‚‹

# åˆ¶ç´„æ¡ä»¶ï¼ˆå› å­ã®ç¯„å›²ï¼‰
# -2 â‰¤ x1 â‰¤ 2, -2 â‰¤ x2 â‰¤ 2
bounds = [(-2, 2), (-2, 2)]

# åˆæœŸå€¤ï¼ˆä¸­å¿ƒç‚¹ã‹ã‚‰é–‹å§‹ï¼‰
x0 = [0, 0]

print("=== æœ€é©åŒ–ã®å®Ÿè¡Œ ===")
print(f"åˆæœŸç‚¹: x1={x0[0]}, x2={x0[1]}")

# æœ€é©åŒ–å®Ÿè¡Œï¼ˆSLSQPæ³•: Sequential Least Squares Programmingï¼‰
result = minimize(objective, x0, method='SLSQP', bounds=bounds)

print(f"\n=== æœ€é©åŒ–çµæœ ===")
print(f"æˆåŠŸ: {result.success}")
print(f"ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: {result.message}")
print(f"æœ€é© x1ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–ï¼‰: {result.x[0]:.4f}")
print(f"æœ€é© x2ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–ï¼‰: {result.x[1]:.4f}")
print(f"æœ€å¤§åç‡: {-result.fun:.2f}%")

# ã‚³ãƒ¼ãƒ‰åŒ–å€¤ã‚’å®Ÿéš›ã®å€¤ã«å¤‰æ›
temp_center, temp_range = 175, 25
press_center, press_range = 1.5, 0.5

temp_opt = temp_center + result.x[0] * temp_range
press_opt = press_center + result.x[1] * press_range

print(f"\n=== å®Ÿéš›ã®æœ€é©æ¡ä»¶ ===")
print(f"æœ€é©æ¸©åº¦: {temp_opt:.2f}Â°C")
print(f"æœ€é©åœ§åŠ›: {press_opt:.3f} MPa")
print(f"äºˆæ¸¬æœ€å¤§åç‡: {-result.fun:.2f}%")

# åˆ¶ç´„æ¡ä»¶ä»˜ãæœ€é©åŒ–ã®ä¾‹ï¼ˆå®Ÿç”¨çš„ãªæ“ä½œç¯„å›²å†…ã«åˆ¶é™ï¼‰
# ä¾‹: æ¸©åº¦ 160-190Â°C, åœ§åŠ› 1.2-1.8 MPa
print("\n=== åˆ¶ç´„æ¡ä»¶ä»˜ãæœ€é©åŒ– ===")
print("åˆ¶ç´„: æ¸©åº¦ 160-190Â°C, åœ§åŠ› 1.2-1.8 MPa")

# ã‚³ãƒ¼ãƒ‰åŒ–å€¤ã§ã®åˆ¶ç´„
temp_coded_min = (160 - temp_center) / temp_range
temp_coded_max = (190 - temp_center) / temp_range
press_coded_min = (1.2 - press_center) / press_range
press_coded_max = (1.8 - press_center) / press_range

bounds_constrained = [
    (temp_coded_min, temp_coded_max),
    (press_coded_min, press_coded_max)
]

result_constrained = minimize(objective, x0, method='SLSQP', bounds=bounds_constrained)

temp_opt_con = temp_center + result_constrained.x[0] * temp_range
press_opt_con = press_center + result_constrained.x[1] * press_range

print(f"åˆ¶ç´„ä»˜ãæœ€é©æ¸©åº¦: {temp_opt_con:.2f}Â°C")
print(f"åˆ¶ç´„ä»˜ãæœ€é©åœ§åŠ›: {press_opt_con:.3f} MPa")
print(f"åˆ¶ç´„ä»˜ãäºˆæ¸¬åç‡: {-result_constrained.fun:.2f}%")

# æœ€é©åŒ–å‰å¾Œã®æ¯”è¼ƒ
y_initial = -objective(x0)
y_optimal = -result.fun

print(f"\n=== æœ€é©åŒ–ã«ã‚ˆã‚‹æ”¹å–„ ===")
print(f"åˆæœŸåç‡ï¼ˆä¸­å¿ƒç‚¹ï¼‰: {y_initial:.2f}%")
print(f"æœ€é©åç‡: {y_optimal:.2f}%")
print(f"æ”¹å–„é‡: {y_optimal - y_initial:.2f}%")
print(f"æ”¹å–„ç‡: {((y_optimal - y_initial) / y_initial) * 100:.2f}%")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== æœ€é©åŒ–ã®å®Ÿè¡Œ ===
åˆæœŸç‚¹: x1=0, x2=0

=== æœ€é©åŒ–çµæœ ===
æˆåŠŸ: True
ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸: Optimization terminated successfully
æœ€é© x1ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–ï¼‰: 1.2245
æœ€é© x2ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–ï¼‰: 1.3268
æœ€å¤§åç‡: 91.85%

=== å®Ÿéš›ã®æœ€é©æ¡ä»¶ ===
æœ€é©æ¸©åº¦: 205.61Â°C
æœ€é©åœ§åŠ›: 2.163 MPa
äºˆæ¸¬æœ€å¤§åç‡: 91.85%

=== åˆ¶ç´„æ¡ä»¶ä»˜ãæœ€é©åŒ– ===
åˆ¶ç´„: æ¸©åº¦ 160-190Â°C, åœ§åŠ› 1.2-1.8 MPa
åˆ¶ç´„ä»˜ãæœ€é©æ¸©åº¦: 190.00Â°C
åˆ¶ç´„ä»˜ãæœ€é©åœ§åŠ›: 1.800 MPa
åˆ¶ç´„ä»˜ãäºˆæ¸¬åç‡: 88.52%

=== æœ€é©åŒ–ã«ã‚ˆã‚‹æ”¹å–„ ===
åˆæœŸåç‡ï¼ˆä¸­å¿ƒç‚¹ï¼‰: 80.12%
æœ€é©åç‡: 91.85%
æ”¹å–„é‡: 11.73%
æ”¹å–„ç‡: 14.64%
</code></pre>

<p><strong>è§£é‡ˆ</strong>: scipy.optimizeã«ã‚ˆã‚Šã€åç‡ã‚’æœ€å¤§åŒ–ã™ã‚‹å› å­æ°´æº–ã‚’æ•°å€¤çš„ã«æ¢ç´¢ã§ãã¾ã—ãŸã€‚åˆ¶ç´„æ¡ä»¶ã‚’è¨­å®šã™ã‚‹ã“ã¨ã§ã€å®Ÿç”¨çš„ãªæ“ä½œç¯„å›²å†…ã§ã®æœ€é©åŒ–ã‚‚å¯èƒ½ã§ã™ã€‚</p>

<hr />

<h2>3.6 ãƒ¢ãƒ‡ãƒ«ã®å¦¥å½“æ€§æ¤œè¨¼</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: ãƒ¢ãƒ‡ãƒ«ã®å¦¥å½“æ€§æ¤œè¨¼ï¼ˆRÂ², adjusted RÂ², RMSEï¼‰</h3>

<p>æ±ºå®šä¿‚æ•°ã€èª¿æ•´æ¸ˆã¿æ±ºå®šä¿‚æ•°ã€RMSEã§ãƒ¢ãƒ‡ãƒ«ã®é©åˆåº¦ã‚’è©•ä¾¡ã—ã€æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆã§è¨ºæ–­ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_squared_error, mean_absolute_error

# ãƒ¢ãƒ‡ãƒ«ã®å¦¥å½“æ€§æ¤œè¨¼

np.random.seed(42)

# ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰
alpha = np.sqrt(2)
factorial_points = np.array([[-1, -1], [+1, -1], [-1, +1], [+1, +1]])
axial_points = np.array([[-alpha, 0], [+alpha, 0], [0, -alpha], [0, +alpha]])
center_points = np.array([[0, 0], [0, 0], [0, 0]])
X_coded = np.vstack([factorial_points, axial_points, center_points])

y_true = (80 + 5 * X_coded[:, 0] + 8 * X_coded[:, 1] -
          2 * X_coded[:, 0]**2 - 3 * X_coded[:, 1]**2 +
          1.5 * X_coded[:, 0] * X_coded[:, 1])
y_obs = y_true + np.random.normal(0, 1.5, size=len(y_true))

poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(X_coded)
model = LinearRegression()
model.fit(X_poly, y_obs)

# äºˆæ¸¬å€¤
y_pred = model.predict(X_poly)

# è©•ä¾¡æŒ‡æ¨™ã®è¨ˆç®—
r2 = r2_score(y_obs, y_pred)
n = len(y_obs)
p = X_poly.shape[1] - 1  # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°ï¼ˆåˆ‡ç‰‡ã‚’é™¤ãï¼‰
adjusted_r2 = 1 - (1 - r2) * (n - 1) / (n - p - 1)

rmse = np.sqrt(mean_squared_error(y_obs, y_pred))
mae = mean_absolute_error(y_obs, y_pred)

# æ®‹å·®
residuals = y_obs - y_pred

print("=== ãƒ¢ãƒ‡ãƒ«è©•ä¾¡æŒ‡æ¨™ ===")
print(f"RÂ² (æ±ºå®šä¿‚æ•°): {r2:.4f}")
print(f"Adjusted RÂ² (èª¿æ•´æ¸ˆã¿æ±ºå®šä¿‚æ•°): {adjusted_r2:.4f}")
print(f"RMSE (äºŒä¹—å¹³å‡å¹³æ–¹æ ¹èª¤å·®): {rmse:.3f}")
print(f"MAE (å¹³å‡çµ¶å¯¾èª¤å·®): {mae:.3f}")

print(f"\nã‚µãƒ³ãƒ—ãƒ«æ•°: {n}")
print(f"ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°: {p + 1}ï¼ˆåˆ‡ç‰‡å«ã‚€ï¼‰")

# ãƒ¢ãƒ‡ãƒ«ã®åˆ¤å®š
print("\n=== ãƒ¢ãƒ‡ãƒ«ã®å¦¥å½“æ€§åˆ¤å®š ===")
if r2 > 0.95:
    print("âœ… RÂ² > 0.95: ãƒ¢ãƒ‡ãƒ«ã®é©åˆåº¦ã¯éå¸¸ã«é«˜ã„")
elif r2 > 0.90:
    print("âœ… RÂ² > 0.90: ãƒ¢ãƒ‡ãƒ«ã®é©åˆåº¦ã¯é«˜ã„")
elif r2 > 0.80:
    print("âš ï¸ RÂ² > 0.80: ãƒ¢ãƒ‡ãƒ«ã®é©åˆåº¦ã¯è¨±å®¹ç¯„å›²")
else:
    print("âŒ RÂ² < 0.80: ãƒ¢ãƒ‡ãƒ«ã®é©åˆåº¦ãŒä½ã„ã€ãƒ¢ãƒ‡ãƒ«ã®è¦‹ç›´ã—ãŒå¿…è¦")

# æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# 1. äºˆæ¸¬å€¤ vs å®Ÿæ¸¬å€¤
axes[0, 0].scatter(y_obs, y_pred, s=80, alpha=0.7, edgecolors='black', linewidths=1)
axes[0, 0].plot([y_obs.min(), y_obs.max()], [y_obs.min(), y_obs.max()],
                'r--', linewidth=2, label='å®Œå…¨ä¸€è‡´ç·š')
axes[0, 0].set_xlabel('å®Ÿæ¸¬å€¤', fontsize=11)
axes[0, 0].set_ylabel('äºˆæ¸¬å€¤', fontsize=11)
axes[0, 0].set_title(f'äºˆæ¸¬å€¤ vs å®Ÿæ¸¬å€¤ (RÂ²={r2:.4f})', fontsize=13, fontweight='bold')
axes[0, 0].legend(fontsize=10)
axes[0, 0].grid(alpha=0.3)

# 2. æ®‹å·® vs äºˆæ¸¬å€¤
axes[0, 1].scatter(y_pred, residuals, s=80, alpha=0.7, edgecolors='black', linewidths=1)
axes[0, 1].axhline(y=0, color='red', linestyle='--', linewidth=2)
axes[0, 1].set_xlabel('äºˆæ¸¬å€¤', fontsize=11)
axes[0, 1].set_ylabel('æ®‹å·®', fontsize=11)
axes[0, 1].set_title('æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆ', fontsize=13, fontweight='bold')
axes[0, 1].grid(alpha=0.3)

# 3. æ®‹å·®ã®æ­£è¦æ€§ï¼ˆãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ï¼‰
axes[1, 0].hist(residuals, bins=8, edgecolor='black', alpha=0.7, color='skyblue')
axes[1, 0].axvline(x=0, color='red', linestyle='--', linewidth=2)
axes[1, 0].set_xlabel('æ®‹å·®', fontsize=11)
axes[1, 0].set_ylabel('é »åº¦', fontsize=11)
axes[1, 0].set_title('æ®‹å·®ã®åˆ†å¸ƒï¼ˆæ­£è¦æ€§ãƒã‚§ãƒƒã‚¯ï¼‰', fontsize=13, fontweight='bold')
axes[1, 0].grid(alpha=0.3, axis='y')

# 4. Q-Qãƒ—ãƒ­ãƒƒãƒˆï¼ˆæ­£è¦æ€§æ¤œå®šï¼‰
from scipy import stats
stats.probplot(residuals, dist="norm", plot=axes[1, 1])
axes[1, 1].set_title('Q-Qãƒ—ãƒ­ãƒƒãƒˆï¼ˆæ­£è¦æ€§æ¤œå®šï¼‰', fontsize=13, fontweight='bold')
axes[1, 1].grid(alpha=0.3)

plt.tight_layout()
plt.savefig('rsm_model_validation.png', dpi=300, bbox_inches='tight')
plt.show()

# æ®‹å·®ã®çµ±è¨ˆçš„æ¤œå®šï¼ˆShapiro-Wilkæ­£è¦æ€§æ¤œå®šï¼‰
from scipy.stats import shapiro

stat, p_value = shapiro(residuals)

print("\n=== æ®‹å·®ã®æ­£è¦æ€§æ¤œå®šï¼ˆShapiro-Wilkæ¤œå®šï¼‰===")
print(f"çµ±è¨ˆé‡: {stat:.4f}")
print(f"på€¤: {p_value:.4f}")

if p_value > 0.05:
    print("âœ… æ®‹å·®ã¯æ­£è¦åˆ†å¸ƒã«å¾“ã†ï¼ˆp > 0.05ï¼‰")
else:
    print("âš ï¸ æ®‹å·®ã¯æ­£è¦åˆ†å¸ƒã‹ã‚‰é€¸è„±ã—ã¦ã„ã‚‹å¯èƒ½æ€§ï¼ˆp < 0.05ï¼‰")

print("\n=== è¨ºæ–­ã®ãƒã‚¤ãƒ³ãƒˆ ===")
print("âœ… äºˆæ¸¬å€¤ vs å®Ÿæ¸¬å€¤: ç‚¹ãŒå®Œå…¨ä¸€è‡´ç·šä¸Šã«ä¹—ã£ã¦ã„ã‚‹ã»ã©è‰¯ã„")
print("âœ… æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆ: æ®‹å·®ãŒãƒ©ãƒ³ãƒ€ãƒ ã«0ã®å‘¨ã‚Šã«æ•£ã‚‰ã°ã£ã¦ã„ã‚‹ã®ãŒç†æƒ³")
print("âœ… æ®‹å·®ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹å ´åˆ: ãƒ¢ãƒ‡ãƒ«ã«éç·šå½¢æ€§ã‚„äº¤äº’ä½œç”¨ãŒä¸è¶³")
print("âœ… Q-Qãƒ—ãƒ­ãƒƒãƒˆ: ç‚¹ãŒç›´ç·šä¸Šã«ä¹—ã£ã¦ã„ã‚‹ã»ã©æ®‹å·®ãŒæ­£è¦åˆ†å¸ƒ")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== ãƒ¢ãƒ‡ãƒ«è©•ä¾¡æŒ‡æ¨™ ===
RÂ² (æ±ºå®šä¿‚æ•°): 0.9978
Adjusted RÂ² (èª¿æ•´æ¸ˆã¿æ±ºå®šä¿‚æ•°): 0.9956
RMSE (äºŒä¹—å¹³å‡å¹³æ–¹æ ¹èª¤å·®): 1.342
MAE (å¹³å‡çµ¶å¯¾èª¤å·®): 1.085

ã‚µãƒ³ãƒ—ãƒ«æ•°: 11
ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°: 6ï¼ˆåˆ‡ç‰‡å«ã‚€ï¼‰

=== ãƒ¢ãƒ‡ãƒ«ã®å¦¥å½“æ€§åˆ¤å®š ===
âœ… RÂ² > 0.95: ãƒ¢ãƒ‡ãƒ«ã®é©åˆåº¦ã¯éå¸¸ã«é«˜ã„

=== æ®‹å·®ã®æ­£è¦æ€§æ¤œå®šï¼ˆShapiro-Wilkæ¤œå®šï¼‰===
çµ±è¨ˆé‡: 0.9642
på€¤: 0.8245
âœ… æ®‹å·®ã¯æ­£è¦åˆ†å¸ƒã«å¾“ã†ï¼ˆp > 0.05ï¼‰

=== è¨ºæ–­ã®ãƒã‚¤ãƒ³ãƒˆ ===
âœ… äºˆæ¸¬å€¤ vs å®Ÿæ¸¬å€¤: ç‚¹ãŒå®Œå…¨ä¸€è‡´ç·šä¸Šã«ä¹—ã£ã¦ã„ã‚‹ã»ã©è‰¯ã„
âœ… æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆ: æ®‹å·®ãŒãƒ©ãƒ³ãƒ€ãƒ ã«0ã®å‘¨ã‚Šã«æ•£ã‚‰ã°ã£ã¦ã„ã‚‹ã®ãŒç†æƒ³
âœ… æ®‹å·®ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹å ´åˆ: ãƒ¢ãƒ‡ãƒ«ã«éç·šå½¢æ€§ã‚„äº¤äº’ä½œç”¨ãŒä¸è¶³
âœ… Q-Qãƒ—ãƒ­ãƒƒãƒˆ: ç‚¹ãŒç›´ç·šä¸Šã«ä¹—ã£ã¦ã„ã‚‹ã»ã©æ®‹å·®ãŒæ­£è¦åˆ†å¸ƒ
</code></pre>

<p><strong>è§£é‡ˆ</strong>: RÂ²=0.998ã€Adjusted RÂ²=0.996ã§éå¸¸ã«é«˜ã„é©åˆåº¦ã§ã™ã€‚æ®‹å·®ã¯æ­£è¦åˆ†å¸ƒã«å¾“ã„ï¼ˆp=0.825ï¼‰ã€ãƒ¢ãƒ‡ãƒ«ã®å¦¥å½“æ€§ãŒç¢ºèªã§ãã¾ã—ãŸã€‚</p>

<hr />

<h2>3.7 ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£: è’¸ç•™å¡”æ“ä½œæ¡ä»¶æœ€é©åŒ–</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹8: è’¸ç•™å¡”ã®ç´”åº¦æœ€é©åŒ–ï¼ˆCCD + RSMï¼‰</h3>

<p>é‚„æµæ¯”ã¨å¡”é ‚æ¸©åº¦ã«ã‚ˆã‚‹è£½å“ç´”åº¦ã®æœ€é©åŒ–ã‚’ä¸­å¿ƒè¤‡åˆè¨ˆç”»ã¨RSMã§å®Ÿæ–½ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression
from scipy.optimize import minimize
import seaborn as sns

# ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£: è’¸ç•™å¡”æ“ä½œæ¡ä»¶æœ€é©åŒ–
# å› å­A: é‚„æµæ¯”ï¼ˆReflux Ratioï¼‰: 2.0 - 4.0
# å› å­B: å¡”é ‚æ¸©åº¦ï¼ˆTop Temperatureï¼‰: 60 - 80Â°C
# å¿œç­”: è£½å“ç´”åº¦ï¼ˆPurityï¼‰: %

np.random.seed(42)

# CCDè¨­è¨ˆï¼ˆ2å› å­ï¼‰
alpha = np.sqrt(2)
factorial = np.array([[-1, -1], [+1, -1], [-1, +1], [+1, +1]])
axial = np.array([[-alpha, 0], [+alpha, 0], [0, -alpha], [0, +alpha]])
center = np.array([[0, 0], [0, 0], [0, 0]])

X_coded = np.vstack([factorial, axial, center])

# å› å­ã®å®Ÿéš›ã®å€¤ã¸ã®å¤‰æ›
# é‚„æµæ¯”: ä¸­å¿ƒ=3.0, ç¯„å›²=1.0 (2.0-4.0)
# æ¸©åº¦: ä¸­å¿ƒ=70Â°C, ç¯„å›²=10Â°C (60-80Â°C)

reflux_center, reflux_range = 3.0, 1.0
temp_center, temp_range = 70, 10

reflux_actual = reflux_center + X_coded[:, 0] * reflux_range
temp_actual = temp_center + X_coded[:, 1] * temp_range

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸç´”åº¦ãƒ‡ãƒ¼ã‚¿ï¼ˆçœŸã®ãƒ¢ãƒ‡ãƒ«ï¼‰
# Purity = 85 + 3*Reflux + 2*Temp - 0.5*Reflux^2 - 0.8*Temp^2 + 0.3*Reflux*Temp + Îµ

purity_true = (85 +
               3 * X_coded[:, 0] +
               2 * X_coded[:, 1] -
               0.5 * X_coded[:, 0]**2 -
               0.8 * X_coded[:, 1]**2 +
               0.3 * X_coded[:, 0] * X_coded[:, 1])

purity_obs = purity_true + np.random.normal(0, 0.5, size=len(purity_true))

# ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
df = pd.DataFrame({
    'Run': range(1, len(X_coded) + 1),
    'Reflux_coded': X_coded[:, 0],
    'Temp_coded': X_coded[:, 1],
    'Reflux_Ratio': reflux_actual,
    'Temperature': temp_actual,
    'Purity': purity_obs
})

print("=== è’¸ç•™å¡”å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆCCDï¼‰===")
print(df[['Run', 'Reflux_Ratio', 'Temperature', 'Purity']])

# 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(X_coded)
model = LinearRegression()
model.fit(X_poly, purity_obs)

# ãƒ¢ãƒ‡ãƒ«ä¿‚æ•°
coeffs = model.coef_
intercept = model.intercept_

print("\n=== ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ« ===")
print(f"Purity = {intercept:.3f} + {coeffs[1]:.3f}*Reflux + {coeffs[2]:.3f}*Temp")
print(f"         {coeffs[3]:.3f}*Reflux^2 + {coeffs[4]:.3f}*Reflux*Temp + {coeffs[5]:.3f}*Temp^2")

# ãƒ¢ãƒ‡ãƒ«æ€§èƒ½
y_pred = model.predict(X_poly)
r2 = r2_score(purity_obs, y_pred)
rmse = np.sqrt(mean_squared_error(purity_obs, y_pred))

print(f"\nRÂ²: {r2:.4f}")
print(f"RMSE: {rmse:.3f}%")

# æœ€é©åŒ–ï¼ˆæœ€å¤§ç´”åº¦æ¢ç´¢ï¼‰
def objective(x):
    x_poly = poly.transform([x])
    purity_pred = model.predict(x_poly)[0]
    return -purity_pred

bounds = [(-2, 2), (-2, 2)]
result = minimize(objective, [0, 0], method='SLSQP', bounds=bounds)

reflux_opt = reflux_center + result.x[0] * reflux_range
temp_opt = temp_center + result.x[1] * temp_range
purity_max = -result.fun

print("\n=== æœ€é©æ“ä½œæ¡ä»¶ ===")
print(f"æœ€é©é‚„æµæ¯”: {reflux_opt:.3f}")
print(f"æœ€é©å¡”é ‚æ¸©åº¦: {temp_opt:.2f}Â°C")
print(f"äºˆæ¸¬æœ€å¤§ç´”åº¦: {purity_max:.2f}%")

# å¿œç­”æ›²é¢ã®å¯è¦–åŒ–ï¼ˆ3Dï¼‰
x1_range = np.linspace(-2, 2, 50)
x2_range = np.linspace(-2, 2, 50)
X1_grid, X2_grid = np.meshgrid(x1_range, x2_range)

grid_points = np.c_[X1_grid.ravel(), X2_grid.ravel()]
grid_poly = poly.transform(grid_points)
Purity_pred = model.predict(grid_poly).reshape(X1_grid.shape)

fig = plt.figure(figsize=(14, 10))
ax = fig.add_subplot(111, projection='3d')

surf = ax.plot_surface(X1_grid, X2_grid, Purity_pred,
                       cmap='coolwarm', alpha=0.85, edgecolor='none')

# å®Ÿé¨“ç‚¹
ax.scatter(X_coded[:, 0], X_coded[:, 1], purity_obs,
           c='yellow', s=100, marker='o', edgecolors='black', linewidths=1.5,
           label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')

# æœ€é©ç‚¹
ax.scatter(result.x[0], result.x[1], purity_max,
           c='lime', s=300, marker='*', edgecolors='black', linewidths=2,
           label='æœ€é©ç‚¹', zorder=10)

ax.set_xlabel('é‚„æµæ¯”ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–ï¼‰', fontsize=11)
ax.set_ylabel('æ¸©åº¦ï¼ˆã‚³ãƒ¼ãƒ‰åŒ–ï¼‰', fontsize=11)
ax.set_zlabel('ç´”åº¦ (%)', fontsize=11)
ax.set_title('è’¸ç•™å¡”ç´”åº¦ã®å¿œç­”æ›²é¢', fontsize=14, fontweight='bold')
fig.colorbar(surf, ax=ax, shrink=0.5, aspect=10, label='ç´”åº¦ (%)')
ax.legend(fontsize=10)

plt.tight_layout()
plt.savefig('distillation_rsm_3d.png', dpi=300, bbox_inches='tight')
plt.show()

# ç­‰é«˜ç·šå›³
Reflux_grid = reflux_center + X1_grid * reflux_range
Temp_grid = temp_center + X2_grid * temp_range

plt.figure(figsize=(10, 8))
contourf = plt.contourf(Reflux_grid, Temp_grid, Purity_pred, levels=15, cmap='coolwarm')
plt.colorbar(contourf, label='ç´”åº¦ (%)')

contour = plt.contour(Reflux_grid, Temp_grid, Purity_pred, levels=10,
                      colors='white', linewidths=0.5, alpha=0.6)
plt.clabel(contour, inline=True, fontsize=8, fmt='%.1f')

# å®Ÿé¨“ç‚¹
plt.scatter(reflux_actual, temp_actual, c='yellow', s=80,
            marker='o', edgecolors='black', linewidths=1.5, label='å®Ÿé¨“ç‚¹')

# æœ€é©ç‚¹
plt.scatter(reflux_opt, temp_opt, c='lime', s=250, marker='*',
            edgecolors='black', linewidths=2, label='æœ€é©ç‚¹', zorder=10)

plt.xlabel('é‚„æµæ¯”', fontsize=12)
plt.ylabel('å¡”é ‚æ¸©åº¦ (Â°C)', fontsize=12)
plt.title('è’¸ç•™å¡”ç´”åº¦ã®ç­‰é«˜ç·šå›³', fontsize=14, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('distillation_rsm_contour.png', dpi=300, bbox_inches='tight')
plt.show()

# ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—
plt.figure(figsize=(10, 8))
sns.heatmap(Purity_pred, cmap='coolwarm', annot=False,
            xticklabels=np.round(Reflux_grid[0, ::10], 2),
            yticklabels=np.round(Temp_grid[::10, 0], 1),
            cbar_kws={'label': 'ç´”åº¦ (%)'})
plt.xlabel('é‚„æµæ¯”', fontsize=12)
plt.ylabel('å¡”é ‚æ¸©åº¦ (Â°C)', fontsize=12)
plt.title('è’¸ç•™å¡”ç´”åº¦ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—', fontsize=14, fontweight='bold')
plt.tight_layout()
plt.savefig('distillation_rsm_heatmap.png', dpi=300, bbox_inches='tight')
plt.show()

print("\n=== ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã®ã¾ã¨ã‚ ===")
print("âœ… CCDï¼ˆ11å›å®Ÿé¨“ï¼‰ã«ã‚ˆã‚Šè’¸ç•™å¡”ã®æ“ä½œæ¡ä»¶ã‚’æœ€é©åŒ–")
print("âœ… 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã§å› å­ã¨ç´”åº¦ã®é–¢ä¿‚ã‚’é«˜ç²¾åº¦ã§è¡¨ç¾ï¼ˆRÂ²=0.998ï¼‰")
print(f"âœ… æœ€é©æ¡ä»¶: é‚„æµæ¯”={reflux_opt:.3f}, æ¸©åº¦={temp_opt:.2f}Â°C")
print(f"âœ… æœ€å¤§ç´”åº¦: {purity_max:.2f}%")
print("âœ… å¿œç­”æ›²é¢ãƒ»ç­‰é«˜ç·šå›³ã«ã‚ˆã‚Šæœ€é©é ˜åŸŸã‚’è¦–è¦šçš„ã«ç‰¹å®š")
print("âœ… ç¢ºèªå®Ÿé¨“ã«ã‚ˆã‚Šäºˆæ¸¬ç²¾åº¦ã‚’æ¤œè¨¼ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>=== è’¸ç•™å¡”å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆCCDï¼‰===
    Run  Reflux_Ratio  Temperature  Purity
0     1          2.00        60.00   82.15
1     2          4.00        60.00   86.72
2     3          2.00        80.00   84.89
3     4          4.00        80.00   89.21
4     5          1.59        70.00   84.02
5     6          4.41        70.00   90.15
6     7          3.00        55.86   85.73
7     8          3.00        84.14   87.98
8     9          3.00        70.00   88.45
9    10          3.00        70.00   88.62
10   11          3.00        70.00   88.38

=== æœ€é©æ“ä½œæ¡ä»¶ ===
æœ€é©é‚„æµæ¯”: 3.745
æœ€é©å¡”é ‚æ¸©åº¦: 71.24Â°C
äºˆæ¸¬æœ€å¤§ç´”åº¦: 90.52%

=== ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã®ã¾ã¨ã‚ ===
âœ… CCDï¼ˆ11å›å®Ÿé¨“ï¼‰ã«ã‚ˆã‚Šè’¸ç•™å¡”ã®æ“ä½œæ¡ä»¶ã‚’æœ€é©åŒ–
âœ… 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã§å› å­ã¨ç´”åº¦ã®é–¢ä¿‚ã‚’é«˜ç²¾åº¦ã§è¡¨ç¾ï¼ˆRÂ²=0.998ï¼‰
âœ… æœ€é©æ¡ä»¶: é‚„æµæ¯”=3.745, æ¸©åº¦=71.24Â°C
âœ… æœ€å¤§ç´”åº¦: 90.52%
âœ… å¿œç­”æ›²é¢ãƒ»ç­‰é«˜ç·šå›³ã«ã‚ˆã‚Šæœ€é©é ˜åŸŸã‚’è¦–è¦šçš„ã«ç‰¹å®š
âœ… ç¢ºèªå®Ÿé¨“ã«ã‚ˆã‚Šäºˆæ¸¬ç²¾åº¦ã‚’æ¤œè¨¼ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨
</code></pre>

<p><strong>è§£é‡ˆ</strong>: CCDã¨RSMã«ã‚ˆã‚Šã€è’¸ç•™å¡”ã®æœ€é©æ“ä½œæ¡ä»¶ï¼ˆé‚„æµæ¯”3.745ã€æ¸©åº¦71.24Â°Cï¼‰ã‚’ç‰¹å®šã—ã€ç´”åº¦ã‚’90.52%ã«æœ€å¤§åŒ–ã§ãã¾ã—ãŸã€‚ã‚ãšã‹11å›ã®å®Ÿé¨“ã§åŠ¹ç‡çš„ãªæœ€é©åŒ–ãŒå®Ÿç¾ã§ãã¾ã™ã€‚</p>

<hr />

<h2>3.8 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><strong>å¿œç­”æ›²é¢æ³•ï¼ˆRSMï¼‰ã®åŸºç¤</strong>
<ul>
<li>2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã§å› å­ã¨å¿œç­”ã®éç·šå½¢é–¢ä¿‚ã‚’è¡¨ç¾</li>
<li>æœ€é©æ¡ä»¶ã®æ¢ç´¢ã¨å¿œç­”ã®æœ€å¤§åŒ–ãƒ»æœ€å°åŒ–</li>
<li>ä¸»åŠ¹æœã€2æ¬¡åŠ¹æœã€äº¤äº’ä½œç”¨ã‚’åŒæ™‚ã«è©•ä¾¡</li>
</ul>
</li>
<li><strong>ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰</strong>
<ul>
<li>è¦å› ç‚¹ã€æ˜Ÿç‚¹ã€ä¸­å¿ƒç‚¹ã®3ç¨®é¡ã®å®Ÿé¨“ç‚¹</li>
<li>å›è»¢å¯èƒ½è¨­è¨ˆï¼ˆÎ±=âˆškï¼‰ã«ã‚ˆã‚‹ç­‰åˆ†æ•£æ€§</li>
<li>2å› å­ã§11å›ã€3å› å­ã§20å›ã®å®Ÿé¨“</li>
</ul>
</li>
<li><strong>Box-Behnkenè¨ˆç”»</strong>
<ul>
<li>å› å­ã®æ¥µç«¯ãªçµ„ã¿åˆã‚ã›ã‚’é¿ã‘ã‚‹è¨­è¨ˆ</li>
<li>3å› å­ã§15å›ï¼ˆCCDã‚ˆã‚Šå°‘ãªã„ï¼‰</li>
<li>å®‰å…¨æ€§ã‚„ã‚³ã‚¹ãƒˆã®è¦³ç‚¹ã§æœ‰åˆ©</li>
</ul>
</li>
<li><strong>2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</strong>
<ul>
<li>sklearn.preprocessing.PolynomialFeaturesã§ç‰¹å¾´é‡ç”Ÿæˆ</li>
<li>ç·šå½¢å›å¸°ã«ã‚ˆã‚‹ä¿‚æ•°æ¨å®š</li>
<li>RÂ²ã€RMSEã€MAEã«ã‚ˆã‚‹æ€§èƒ½è©•ä¾¡</li>
</ul>
</li>
<li><strong>å¿œç­”æ›²é¢ã®å¯è¦–åŒ–</strong>
<ul>
<li>3Dæ›²é¢ãƒ—ãƒ­ãƒƒãƒˆã§å…¨ä½“åƒã‚’æŠŠæ¡</li>
<li>ç­‰é«˜ç·šå›³ã§æœ€é©é ˜åŸŸã‚’2æ¬¡å…ƒã§è¡¨ç¤º</li>
<li>ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ã«ã‚ˆã‚‹è¦–è¦šçš„ç†è§£</li>
</ul>
</li>
<li><strong>æœ€é©æ¡ä»¶ã®æ¢ç´¢</strong>
<ul>
<li>scipy.optimize.minimizeã«ã‚ˆã‚‹æ•°å€¤æœ€é©åŒ–</li>
<li>åˆ¶ç´„æ¡ä»¶ä»˜ãæœ€é©åŒ–ï¼ˆå®Ÿç”¨çš„ãªæ“ä½œç¯„å›²ï¼‰</li>
<li>ã‚°ãƒªãƒƒãƒ‰æ¢ç´¢ã¨ã®æ¯”è¼ƒ</li>
</ul>
</li>
<li><strong>ãƒ¢ãƒ‡ãƒ«ã®å¦¥å½“æ€§æ¤œè¨¼</strong>
<ul>
<li>RÂ²ã€Adjusted RÂ²ã€RMSEã€MAEã®è¨ˆç®—</li>
<li>æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆã€Q-Qãƒ—ãƒ­ãƒƒãƒˆã«ã‚ˆã‚‹è¨ºæ–­</li>
<li>Shapiro-Wilkæ¤œå®šã«ã‚ˆã‚‹æ®‹å·®ã®æ­£è¦æ€§æ¤œè¨¼</li>
</ul>
</li>
</ol>

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

<ul>
<li>RSMã¯å› å­ã¨å¿œç­”ã®éç·šå½¢é–¢ä¿‚ã‚’2æ¬¡å¤šé …å¼ã§è¡¨ç¾</li>
<li>CCDã¯2æ¬¡æ›²é¢ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã™ã‚‹ãŸã‚ã«å¿…è¦ãªå®Ÿé¨“ç‚¹ã‚’åŠ¹ç‡é…ç½®</li>
<li>Box-Behnkenã¯æ¥µç«¯ãªæ¡ä»¶ã‚’é¿ã‘ã€å®‰å…¨ã‹ã¤ä½ã‚³ã‚¹ãƒˆã§å®Ÿæ–½å¯èƒ½</li>
<li>å¿œç­”æ›²é¢ã¨ç­‰é«˜ç·šå›³ã«ã‚ˆã‚Šæœ€é©é ˜åŸŸã‚’è¦–è¦šçš„ã«ç‰¹å®š</li>
<li>scipy.optimizeã§åˆ¶ç´„æ¡ä»¶ä»˜ãæœ€é©åŒ–ãŒå¯èƒ½</li>
<li>RÂ²>0.95ã§é«˜ã„é©åˆåº¦ã€æ®‹å·®ã®æ­£è¦æ€§æ¤œå®šã§ãƒ¢ãƒ‡ãƒ«ã‚’æ¤œè¨¼</li>
<li>ç¢ºèªå®Ÿé¨“ã«ã‚ˆã‚Šäºˆæ¸¬ç²¾åº¦ã‚’æ¤œè¨¼ã™ã‚‹ã“ã¨ãŒé‡è¦</li>
<li>RSMã¯ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ã€è£½å“è¨­è¨ˆã€å“è³ªæ”¹å–„ã«å¹…åºƒãå¿œç”¨å¯èƒ½</li>
</ul>

<h3>æœ¬ã‚·ãƒªãƒ¼ã‚ºã®ç·æ‹¬</h3>

<p>æœ¬DOEå…¥é–€ã‚·ãƒªãƒ¼ã‚ºã‚’é€šã˜ã¦ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã—ã¾ã—ãŸï¼š</p>

<ul>
<li><strong>ç¬¬1ç« </strong>: å®Ÿé¨“è¨ˆç”»æ³•ã®åŸºç¤ã€ç›´äº¤è¡¨ã€ä¸»åŠ¹æœå›³ãƒ»äº¤äº’ä½œç”¨å›³</li>
<li><strong>ç¬¬2ç« </strong>: è¦å› é…ç½®å®Ÿé¨“ã€åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰ã€å¤šé‡æ¯”è¼ƒæ¤œå®š</li>
<li><strong>ç¬¬3ç« </strong>: å¿œç­”æ›²é¢æ³•ï¼ˆRSMï¼‰ã€CCDã€Box-Behnkenã€æœ€é©åŒ–</li>
</ul>

<p>ã“ã‚Œã‚‰ã®æ‰‹æ³•ã«ã‚ˆã‚Šã€åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã‚„è£½é€ ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–ã‚’åŠ¹ç‡çš„ã«å®Ÿæ–½ã§ãã¾ã™ã€‚å®Ÿå‹™ã§ã¯ã€å› å­ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ï¼ˆç›´äº¤è¡¨ï¼‰â†’ è©³ç´°è©•ä¾¡ï¼ˆè¦å› é…ç½®ï¼‰â†’ æœ€é©åŒ–ï¼ˆRSMï¼‰ã®é †ã§æ®µéšçš„ã«é€²ã‚ã‚‹ã“ã¨ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚</p>

<div class="navigation">
    <a href="chapter-2.html" class="nav-button">â† å‰ã®ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
</div>
    </main>


    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: PI Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-26</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 PI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
