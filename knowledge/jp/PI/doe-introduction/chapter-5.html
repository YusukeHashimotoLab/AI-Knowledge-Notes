<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬5ç« :Pythonã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”»ã¨è§£æè‡ªå‹•åŒ– - DOEå…¥é–€ã‚·ãƒªãƒ¼ã‚º</title>

        <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8; color: #333; background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; padding: 2rem 1rem; text-align: center;
        }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; font-size: 1.1rem; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
        .back-link {
            display: inline-block; margin-bottom: 2rem; padding: 0.5rem 1rem;
            background: white; color: #11998e; text-decoration: none;
            border-radius: 6px; font-weight: 600;
        }
        .content-box {
            background: white; padding: 2rem; border-radius: 12px;
            margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #11998e; margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem; border-bottom: 3px solid #11998e;
        }
        h3 { color: #2c3e50; margin: 1.5rem 0 1rem 0; }
        h4 { color: #2c3e50; margin: 1rem 0 0.5rem 0; }
        p { margin-bottom: 1rem; }
        ul, ol { margin-left: 2rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
        pre {
            background: #1e1e1e; color: #d4d4d4; padding: 1.5rem;
            border-radius: 8px; overflow-x: auto; margin: 1rem 0;
            border-left: 4px solid #11998e;
        }
        code {
            font-family: 'Courier New', monospace; font-size: 0.9rem;
        }
        .key-point {
            background: #e8f5e9; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #4caf50; margin: 1rem 0;
        }
        .tech-note {
            background: #e3f2fd; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #2196f3; margin: 1rem 0;
        }
        .formula {
            background: #f0f7ff; padding: 1rem; border-radius: 6px;
            margin: 1rem 0; overflow-x: auto;
        }
        table {
            width: 100%; border-collapse: collapse; margin: 1rem 0;
        }
        th, td {
            border: 1px solid #ddd; padding: 0.75rem; text-align: left;
        }
        th {
            background: #11998e; color: white; font-weight: 600;
        }
        tr:nth-child(even) { background: #f9f9f9; }
        .nav-buttons {
            display: flex; justify-content: space-between; margin-top: 3rem;
        }
        .nav-buttons a {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; text-decoration: none; border-radius: 6px;
            font-weight: 600;
        }
        footer {
            background: #2c3e50; color: white; text-align: center;
            padding: 2rem 1rem; margin-top: 4rem;
        }
        @media (max-width: 768px) {
            h1 { font-size: 1.6rem; }
            .container { padding: 0 0.5rem; }
            pre { padding: 1rem; }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
            <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/PI/doe-introduction/chapter-5.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../PI/index.html">ãƒ—ãƒ­ã‚»ã‚¹ãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a><span class="breadcrumb-separator">â€º</span><a href="../../PI/doe-introduction/index.html">Doe</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 5</span>
        </div>
    </nav>

        <header>
        <div class="container">
            <h1>ç¬¬5ç« :Pythonã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”»ã¨è§£æè‡ªå‹•åŒ–</h1>
            <p class="subtitle">pyDOE3ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¯è¦–åŒ–ã€Monte Carloã€å¤šç›®çš„æœ€é©åŒ–</p>
            <div class="meta">
                <span class="meta">ğŸ“– èª­äº†æ™‚é–“: 40-45åˆ†</span>
                <span class="meta">ğŸ“Š é›£æ˜“åº¦: ä¸Šç´š</span>
                <span class="meta">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>ç¬¬5ç« :Pythonã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”»ã¨è§£æè‡ªå‹•åŒ–</h1>

<p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); border-left: 4px solid #11998e; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ´»ç”¨ã—ã¦ã€å®Ÿé¨“è¨ˆç”»ã®ç”Ÿæˆã€å®Ÿé¨“çµæœã®è‡ªå‹•è§£æã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªå¯è¦–åŒ–ã€Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€å¤šç›®çš„æœ€é©åŒ–ã‚’è‡ªå‹•åŒ–ã—ã¾ã™ã€‚DOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å…¨ä½“ã‚’çµ±åˆã—ã€åŠ¹ç‡çš„ãªæœ€é©åŒ–ã‚’å®Ÿç¾ã—ã¾ã™ã€‚</p>

<div class="learning-objectives">
<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™:</p>
<ul>
<li>âœ… pyDOE3ã§å®Œå…¨è¦å› é…ç½®ã€ä¸€éƒ¨å®Ÿæ–½ã€CCDã€BBDã‚’ç”Ÿæˆã§ãã‚‹</li>
<li>âœ… ç›´äº¤è¡¨ã‚’è‡ªå‹•ç”Ÿæˆã—ã€ç›´äº¤æ€§ã‚’æ¤œè¨¼ã§ãã‚‹</li>
<li>âœ… å®Ÿé¨“çµæœã‚’è‡ªå‹•è§£æã™ã‚‹ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
<li>âœ… Plotlyã§ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãª3Då¿œç­”æ›²é¢ã‚’ä½œæˆã§ãã‚‹</li>
<li>âœ… å®Ÿé¨“è¨ˆç”»ãƒ¬ãƒãƒ¼ãƒˆã‚’HTML/PDFå½¢å¼ã§è‡ªå‹•ç”Ÿæˆã§ãã‚‹</li>
<li>âœ… Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’è©•ä¾¡ã§ãã‚‹</li>
<li>âœ… Pareto frontierã§å¤šç›®çš„æœ€é©åŒ–ãŒã§ãã‚‹</li>
<li>âœ… å®Œå…¨ãªDOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’çµ±åˆå®Ÿè¡Œã§ãã‚‹</li>
</ul>
</div>

<hr />

<h2>5.1 pyDOE3ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”»ç”Ÿæˆ</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: pyDOE3ã§å„ç¨®å®Ÿé¨“è¨ˆç”»ã‚’ç”Ÿæˆ</h3>

<p>pyDOE3ã‚’ä½¿ç”¨ã—ã¦ã€å®Œå…¨è¦å› é…ç½®ã€ä¸€éƒ¨å®Ÿæ–½ã€CCDã€Box-Behnkenè¨ˆç”»ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
from pyDOE3 import fullfact, fracfact, ccdesign, bbdesign

# pyDOE3ã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”»ç”Ÿæˆ

print("=" * 70)
print("pyDOE3ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”»ç”Ÿæˆ")
print("=" * 70)

# 1. å®Œå…¨è¦å› é…ç½®ï¼ˆFull Factorial Designï¼‰
print("\n=== 1. å®Œå…¨è¦å› é…ç½®ï¼ˆFull Factorialï¼‰===")
print("3å› å­ã€å„2æ°´æº– â†’ 2^3 = 8å›å®Ÿé¨“")

# fullfact([æ°´æº–æ•°1, æ°´æº–æ•°2, æ°´æº–æ•°3])
full_factorial = fullfact([2, 2, 2])

full_df = pd.DataFrame(full_factorial, columns=['Temperature', 'Pressure', 'Catalyst'])
full_df['Run'] = range(1, len(full_df) + 1)

# ã‚³ãƒ¼ãƒ‰åŒ–å€¤ã‹ã‚‰å®Ÿéš›ã®å€¤ã«å¤‰æ›
temp_map = {0: 150, 1: 200}
press_map = {0: 1.0, 1: 2.0}
cat_map = {0: 0.5, 1: 1.0}

full_df['Temperature_actual'] = full_df['Temperature'].map(temp_map)
full_df['Pressure_actual'] = full_df['Pressure'].map(press_map)
full_df['Catalyst_actual'] = full_df['Catalyst'].map(cat_map)

print(full_df[['Run', 'Temperature_actual', 'Pressure_actual', 'Catalyst_actual']])
print(f"ç·å®Ÿé¨“å›æ•°: {len(full_df)}")

# 2. ä¸€éƒ¨å®Ÿæ–½è¦å› é…ç½®ï¼ˆFractional Factorial Designï¼‰
print("\n=== 2. ä¸€éƒ¨å®Ÿæ–½è¦å› é…ç½®ï¼ˆFractional Factorialï¼‰===")
print("5å› å­ã€å„2æ°´æº–ã€1/2å®Ÿæ–½ â†’ 2^(5-1) = 16å›å®Ÿé¨“")

# fracfact("a b c d e") ã§ç”Ÿæˆï¼ˆç”Ÿæˆå­ã‚’æŒ‡å®šï¼‰
# Resolution III è¨­è¨ˆ
frac_factorial = fracfact("a b c d abc")  # 5å› å­ã€16å›å®Ÿé¨“

frac_df = pd.DataFrame(frac_factorial,
                       columns=['Temp', 'Press', 'Cat', 'Time', 'Stir'])
frac_df['Run'] = range(1, len(frac_df) + 1)

print(frac_df.head(8))
print(f"ç·å®Ÿé¨“å›æ•°: {len(frac_df)}ï¼ˆå®Œå…¨è¦å› é…ç½®ãªã‚‰2^5=32å›ï¼‰")
print("åŠ¹ç‡: 50%å‰Šæ¸›")

# 3. ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCentral Composite Design; CCDï¼‰
print("\n=== 3. ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰===")
print("2å› å­ã€å›è»¢å¯èƒ½è¨­è¨ˆï¼ˆÎ±=âˆš2ï¼‰")

# ccdesign(n_factors, center=(n_center_factorial, n_center_axial), face='ccf'|'cci'|'ccc')
# face='ccf': circumscribed (å›è»¢å¯èƒ½è¨­è¨ˆã€Î±=âˆšn)
ccd = ccdesign(2, center=(3, 3), face='ccf')

ccd_df = pd.DataFrame(ccd, columns=['x1', 'x2'])
ccd_df['Run'] = range(1, len(ccd_df) + 1)
ccd_df['Type'] = ['Factorial']*4 + ['Axial']*4 + ['Center']*3

print(ccd_df[['Run', 'Type', 'x1', 'x2']])
print(f"ç·å®Ÿé¨“å›æ•°: {len(ccd_df)}")
print("æ§‹æˆ: è¦å› ç‚¹4 + æ˜Ÿç‚¹4 + ä¸­å¿ƒç‚¹3")

# 4. Box-Behnkenè¨ˆç”»
print("\n=== 4. Box-Behnkenè¨ˆç”» ===")
print("3å› å­ã€å„3æ°´æº–")

# bbdesign(n_factors, center=n_center)
bbd = bbdesign(3, center=3)

bbd_df = pd.DataFrame(bbd, columns=['Temp', 'Press', 'Cat'])
bbd_df['Run'] = range(1, len(bbd_df) + 1)

print(bbd_df.head(10))
print(f"ç·å®Ÿé¨“å›æ•°: {len(bbd_df)}")
print("âœ… Box-Behnkenã¯æ¥µç«¯ãªçµ„ã¿åˆã‚ã›ã‚’å«ã¾ãªã„ï¼ˆå®‰å…¨æ€§é‡è¦–ï¼‰")

# æ¯”è¼ƒè¡¨
print("\n=== å®Ÿé¨“è¨ˆç”»ã®æ¯”è¼ƒï¼ˆ3å› å­ã®å ´åˆï¼‰===")

comparison = pd.DataFrame({
    'Design': ['Full Factorial', 'Fractional Factorial (1/2)', 'CCD', 'Box-Behnken'],
    'Runs': [8, 4, 15, 15],
    'Characteristics': [
        'å…¨çµ„ã¿åˆã‚ã›è©•ä¾¡',
        'å®Ÿé¨“å›æ•°å‰Šæ¸›ã€äº¤çµ¡ã‚ã‚Š',
        '2æ¬¡æ›²é¢ã€å›è»¢å¯èƒ½',
        'æ¥µç«¯æ¡ä»¶ãªã—ã€å®‰å…¨'
    ],
    'Use_Case': [
        'å› å­æ•°å°‘ã€äº¤äº’ä½œç”¨é‡è¦–',
        'å› å­æ•°å¤šã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°',
        'å¿œç­”æ›²é¢ã€æœ€é©åŒ–',
        'å®Ÿé¨“ã‚³ã‚¹ãƒˆé«˜ã€å®‰å…¨æ€§é‡è¦–'
    ]
})

print(comparison.to_string(index=False))

print("\nâœ… pyDOE3ã«ã‚ˆã‚Šæ§˜ã€…ãªå®Ÿé¨“è¨ˆç”»ã‚’è‡ªå‹•ç”Ÿæˆ")
print("âœ… å› å­æ•°ãƒ»ç›®çš„ã«å¿œã˜ã¦æœ€é©ãªè¨­è¨ˆã‚’é¸æŠå¯èƒ½")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>======================================================================
pyDOE3ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã‚‹å®Ÿé¨“è¨ˆç”»ç”Ÿæˆ
======================================================================

=== 1. å®Œå…¨è¦å› é…ç½®ï¼ˆFull Factorialï¼‰===
3å› å­ã€å„2æ°´æº– â†’ 2^3 = 8å›å®Ÿé¨“
   Run  Temperature_actual  Pressure_actual  Catalyst_actual
0    1                 150              1.0              0.5
1    2                 200              1.0              0.5
2    3                 150              2.0              0.5
3    4                 200              2.0              0.5
4    5                 150              1.0              1.0
5    6                 200              1.0              1.0
6    7                 150              2.0              1.0
7    8                 200              2.0              1.0
ç·å®Ÿé¨“å›æ•°: 8

=== 2. ä¸€éƒ¨å®Ÿæ–½è¦å› é…ç½®ï¼ˆFractional Factorialï¼‰===
5å› å­ã€å„2æ°´æº–ã€1/2å®Ÿæ–½ â†’ 2^(5-1) = 16å›å®Ÿé¨“
   Temp  Press  Cat  Time  Stir  Run
0  -1.0   -1.0 -1.0  -1.0  -1.0    1
1   1.0   -1.0 -1.0  -1.0   1.0    2
2  -1.0    1.0 -1.0  -1.0   1.0    3
3   1.0    1.0 -1.0  -1.0  -1.0    4
4  -1.0   -1.0  1.0  -1.0   1.0    5
5   1.0   -1.0  1.0  -1.0  -1.0    6
6  -1.0    1.0  1.0  -1.0  -1.0    7
7   1.0    1.0  1.0  -1.0   1.0    8
ç·å®Ÿé¨“å›æ•°: 16ï¼ˆå®Œå…¨è¦å› é…ç½®ãªã‚‰2^5=32å›ï¼‰
åŠ¹ç‡: 50%å‰Šæ¸›

=== 3. ä¸­å¿ƒè¤‡åˆè¨ˆç”»ï¼ˆCCDï¼‰===
2å› å­ã€å›è»¢å¯èƒ½è¨­è¨ˆï¼ˆÎ±=âˆš2ï¼‰
    Run       Type        x1        x2
0     1  Factorial -1.000000 -1.000000
1     2  Factorial  1.000000 -1.000000
2     3  Factorial -1.000000  1.000000
3     4  Factorial  1.000000  1.000000
4     5      Axial -1.414214  0.000000
5     6      Axial  1.414214  0.000000
6     7      Axial  0.000000 -1.414214
7     8      Axial  0.000000  1.414214
8     9     Center  0.000000  0.000000
9    10     Center  0.000000  0.000000
10   11     Center  0.000000  0.000000
ç·å®Ÿé¨“å›æ•°: 11
æ§‹æˆ: è¦å› ç‚¹4 + æ˜Ÿç‚¹4 + ä¸­å¿ƒç‚¹3

=== å®Ÿé¨“è¨ˆç”»ã®æ¯”è¼ƒï¼ˆ3å› å­ã®å ´åˆï¼‰===
                    Design  Runs           Characteristics                  Use_Case
        Full Factorial     8          å…¨çµ„ã¿åˆã‚ã›è©•ä¾¡      å› å­æ•°å°‘ã€äº¤äº’ä½œç”¨é‡è¦–
Fractional Factorial (1/2)  4      å®Ÿé¨“å›æ•°å‰Šæ¸›ã€äº¤çµ¡ã‚ã‚Š      å› å­æ•°å¤šã€ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
                       CCD    15          2æ¬¡æ›²é¢ã€å›è»¢å¯èƒ½          å¿œç­”æ›²é¢ã€æœ€é©åŒ–
              Box-Behnken    15      æ¥µç«¯æ¡ä»¶ãªã—ã€å®‰å…¨  å®Ÿé¨“ã‚³ã‚¹ãƒˆé«˜ã€å®‰å…¨æ€§é‡è¦–

âœ… pyDOE3ã«ã‚ˆã‚Šæ§˜ã€…ãªå®Ÿé¨“è¨ˆç”»ã‚’è‡ªå‹•ç”Ÿæˆ
âœ… å› å­æ•°ãƒ»ç›®çš„ã«å¿œã˜ã¦æœ€é©ãªè¨­è¨ˆã‚’é¸æŠå¯èƒ½
</code></pre>

<p><strong>è§£é‡ˆ</strong>: pyDOE3ã«ã‚ˆã‚Šã€å®Œå…¨è¦å› é…ç½®ã€ä¸€éƒ¨å®Ÿæ–½ã€CCDã€Box-Behnkenè¨ˆç”»ã‚’ç°¡å˜ã«ç”Ÿæˆã§ãã¾ã™ã€‚å› å­æ•°ã¨ç›®çš„ã«å¿œã˜ã¦æœ€é©ãªè¨­è¨ˆã‚’é¸æŠã™ã‚‹ã“ã¨ã§ã€åŠ¹ç‡çš„ãªå®Ÿé¨“ãŒå¯èƒ½ã§ã™ã€‚</p>

<hr />

<h2>5.2 ç›´äº¤è¡¨ã®è‡ªå‹•ç”Ÿæˆã¨æ¤œè¨¼</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: ç›´äº¤è¡¨ã®ç”Ÿæˆã¨ç›´äº¤æ€§æ¤œè¨¼</h3>

<p>L8ã€L16ã€L27ç›´äº¤è¡¨ã‚’ç”Ÿæˆã—ã€åˆ—é–“ã®ç›´äº¤æ€§ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd

# ç›´äº¤è¡¨ã®è‡ªå‹•ç”Ÿæˆã¨ç›´äº¤æ€§æ¤œè¨¼

def generate_L8():
    """L8ç›´äº¤è¡¨ï¼ˆ2^7ï¼‰ã‚’ç”Ÿæˆ"""
    L8 = np.array([
        [1, 1, 1, 1, 1, 1, 1],
        [1, 1, 1, 2, 2, 2, 2],
        [1, 2, 2, 1, 1, 2, 2],
        [1, 2, 2, 2, 2, 1, 1],
        [2, 1, 2, 1, 2, 1, 2],
        [2, 1, 2, 2, 1, 2, 1],
        [2, 2, 1, 1, 2, 2, 1],
        [2, 2, 1, 2, 1, 1, 2]
    ])
    return L8

def generate_L16():
    """L16ç›´äº¤è¡¨ï¼ˆ2^15ï¼‰ã‚’ç”Ÿæˆ"""
    L16 = []
    for i in range(16):
        row = []
        for j in range(15):
            val = ((i >> j) & 1) + 1
            row.append(val)
        L16.append(row)
    return np.array(L16)

def generate_L27():
    """L27ç›´äº¤è¡¨ï¼ˆ3^13ï¼‰ã‚’ç”Ÿæˆï¼ˆç°¡æ˜“ç‰ˆï¼‰"""
    # åŸºæœ¬åˆ—ï¼ˆ3æ°´æº–ï¼‰
    base_columns = []
    for i in range(3):
        for j in range(3):
            for k in range(3):
                base_columns.append([i+1, j+1, k+1])

    L27 = np.array(base_columns)
    return L27

def check_orthogonality(array, column1, column2):
    """2åˆ—é–“ã®ç›´äº¤æ€§ã‚’ãƒã‚§ãƒƒã‚¯"""
    col1 = array[:, column1]
    col2 = array[:, column2]

    # å„æ°´æº–ã®çµ„ã¿åˆã‚ã›ãŒå‡ç­‰ã«å‡ºç¾ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
    unique_combinations = {}
    for v1, v2 in zip(col1, col2):
        key = (v1, v2)
        unique_combinations[key] = unique_combinations.get(key, 0) + 1

    counts = list(unique_combinations.values())
    is_orthogonal = len(set(counts)) == 1  # å…¨ã¦ã®çµ„ã¿åˆã‚ã›ãŒåŒã˜å›æ•°å‡ºç¾

    return is_orthogonal, unique_combinations

print("=" * 70)
print("ç›´äº¤è¡¨ã®è‡ªå‹•ç”Ÿæˆã¨ç›´äº¤æ€§æ¤œè¨¼")
print("=" * 70)

# L8ç›´äº¤è¡¨
print("\n=== L8ç›´äº¤è¡¨ï¼ˆ2^7: 7å› å­ã€å„2æ°´æº–ã€8å›å®Ÿé¨“ï¼‰===")
L8 = generate_L8()
L8_df = pd.DataFrame(L8, columns=[f'Col{i+1}' for i in range(7)])
L8_df.insert(0, 'Run', range(1, 9))
print(L8_df)

# L8ã®ç›´äº¤æ€§æ¤œè¨¼ï¼ˆåˆ—1ã¨åˆ—2ï¼‰
is_ortho, combinations = check_orthogonality(L8, 0, 1)
print(f"\nåˆ—1ã¨åˆ—2ã®ç›´äº¤æ€§: {is_ortho}")
print(f"æ°´æº–çµ„ã¿åˆã‚ã›ã®å‡ºç¾å›æ•°: {combinations}")
print("âœ… å„çµ„ã¿åˆã‚ã›ãŒå‡ç­‰ã«å‡ºç¾ â†’ ç›´äº¤æ€§ã‚ã‚Š" if is_ortho else "âŒ ç›´äº¤æ€§ãªã—")

# L16ç›´äº¤è¡¨
print("\n=== L16ç›´äº¤è¡¨ï¼ˆ2^15: 15å› å­ã€å„2æ°´æº–ã€16å›å®Ÿé¨“ï¼‰===")
L16 = generate_L16()
L16_df = pd.DataFrame(L16, columns=[f'Col{i+1}' for i in range(15)])
L16_df.insert(0, 'Run', range(1, 17))
print(L16_df.head(8))
print(f"ç·å®Ÿé¨“å›æ•°: {len(L16_df)}")

# L16ã®ç›´äº¤æ€§æ¤œè¨¼ï¼ˆåˆ—1ã¨åˆ—4ï¼‰
is_ortho_16, combinations_16 = check_orthogonality(L16, 0, 3)
print(f"\nåˆ—1ã¨åˆ—4ã®ç›´äº¤æ€§: {is_ortho_16}")
print(f"æ°´æº–çµ„ã¿åˆã‚ã›ã®å‡ºç¾å›æ•°: {combinations_16}")

# L27ç›´äº¤è¡¨ï¼ˆ3æ°´æº–ï¼‰
print("\n=== L27ç›´äº¤è¡¨ï¼ˆ3^13: 13å› å­ã€å„3æ°´æº–ã€27å›å®Ÿé¨“ï¼‰===")
L27 = generate_L27()
L27_df = pd.DataFrame(L27, columns=['Col1', 'Col2', 'Col3'])
L27_df.insert(0, 'Run', range(1, 28))
print(L27_df.head(10))
print(f"ç·å®Ÿé¨“å›æ•°: {len(L27_df)}")

# ç›´äº¤è¡¨ã®é¸æŠã‚¬ã‚¤ãƒ‰
print("\n=== ç›´äº¤è¡¨ã®é¸æŠã‚¬ã‚¤ãƒ‰ ===")

selection_guide = pd.DataFrame({
    'Array': ['L4', 'L8', 'L9', 'L12', 'L16', 'L18', 'L27'],
    'Factors': ['3', '7', '4', '11', '15', '7(2æ°´æº–)+1(4æ°´æº–)', '13'],
    'Levels': ['2', '2', '3', '2', '2', 'æ··åˆæ°´æº–', '3'],
    'Runs': [4, 8, 9, 12, 16, 18, 27],
    'Use_Case': [
        '2-3å› å­ã€åˆæœŸã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°',
        '4-7å› å­ã€2æ°´æº–',
        '3-4å› å­ã€3æ°´æº–',
        '8-11å› å­ã€2æ°´æº–',
        '8-15å› å­ã€2æ°´æº–',
        'å¤šæ°´æº–æ··åˆ',
        '9-13å› å­ã€3æ°´æº–'
    ]
})

print(selection_guide.to_string(index=False))

# äº¤çµ¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¢ºèªï¼ˆL8ã®ä¾‹ï¼‰
print("\n=== äº¤çµ¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ç¢ºèªï¼ˆL8ï¼‰===")
print("L8ã§7å› å­ã‚’å‰²ã‚Šä»˜ã‘ãŸå ´åˆã€ä»¥ä¸‹ã®äº¤çµ¡ãŒç™ºç”Ÿ:")
print("åˆ—1 Ã— åˆ—2 = åˆ—3ï¼ˆäº¤çµ¡ï¼‰")
print("åˆ—1 Ã— åˆ—4 = åˆ—5ï¼ˆäº¤çµ¡ï¼‰")
print("â†’ å› å­ã®å‰²ã‚Šä»˜ã‘ã‚’æ…é‡ã«è¡Œã†å¿…è¦ã‚ã‚Š")

print("\nâœ… ç›´äº¤è¡¨ã«ã‚ˆã‚Šã€å®Ÿé¨“å›æ•°ã‚’å¤§å¹…ã«å‰Šæ¸›å¯èƒ½")
print("âœ… ç›´äº¤æ€§ã«ã‚ˆã‚Šã€å„å› å­ã®åŠ¹æœã‚’ç‹¬ç«‹ã«è©•ä¾¡")
print("âœ… äº¤çµ¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç†è§£ã—ã€é©åˆ‡ã«å› å­ã‚’é…ç½®")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>======================================================================
ç›´äº¤è¡¨ã®è‡ªå‹•ç”Ÿæˆã¨ç›´äº¤æ€§æ¤œè¨¼
======================================================================

=== L8ç›´äº¤è¡¨ï¼ˆ2^7: 7å› å­ã€å„2æ°´æº–ã€8å›å®Ÿé¨“ï¼‰===
   Run  Col1  Col2  Col3  Col4  Col5  Col6  Col7
0    1     1     1     1     1     1     1     1
1    2     1     1     1     2     2     2     2
2    3     1     2     2     1     1     2     2
3    4     1     2     2     2     2     1     1
4    5     2     1     2     1     2     1     2
5    6     2     1     2     2     1     2     1
6    7     2     2     1     1     2     2     1
7    8     2     2     1     2     1     1     2

åˆ—1ã¨åˆ—2ã®ç›´äº¤æ€§: True
æ°´æº–çµ„ã¿åˆã‚ã›ã®å‡ºç¾å›æ•°: {(1, 1): 2, (1, 2): 2, (2, 1): 2, (2, 2): 2}
âœ… å„çµ„ã¿åˆã‚ã›ãŒå‡ç­‰ã«å‡ºç¾ â†’ ç›´äº¤æ€§ã‚ã‚Š

=== L16ç›´äº¤è¡¨ï¼ˆ2^15: 15å› å­ã€å„2æ°´æº–ã€16å›å®Ÿé¨“ï¼‰===
   Run  Col1  Col2  Col3  Col4  Col5  Col6  Col7  Col8  Col9  Col10  Col11  Col12  Col13  Col14  Col15
0    1     1     1     1     1     1     1     1     1     1      1      1      1      1      1      1
1    2     2     1     1     1     1     1     1     1     1      1      1      1      1      1      1
2    3     1     2     1     1     1     1     1     1     1      1      1      1      1      1      1
3    4     2     2     1     1     1     1     1     1     1      1      1      1      1      1      1
4    5     1     1     2     1     1     1     1     1     1      1      1      1      1      1      1
5    6     2     1     2     1     1     1     1     1     1      1      1      1      1      1      1
6    7     1     2     2     1     1     1     1     1     1      1      1      1      1      1      1
7    8     2     2     2     1     1     1     1     1     1      1      1      1      1      1      1
ç·å®Ÿé¨“å›æ•°: 16

åˆ—1ã¨åˆ—4ã®ç›´äº¤æ€§: True
æ°´æº–çµ„ã¿åˆã‚ã›ã®å‡ºç¾å›æ•°: {(1, 1): 4, (2, 1): 4, (1, 2): 4, (2, 2): 4}

=== ç›´äº¤è¡¨ã®é¸æŠã‚¬ã‚¤ãƒ‰ ===
Array   Factors           Levels  Runs                   Use_Case
   L4         3                2     4      2-3å› å­ã€åˆæœŸã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
   L8         7                2     8              4-7å› å­ã€2æ°´æº–
   L9         4                3     9              3-4å› å­ã€3æ°´æº–
  L12        11                2    12              8-11å› å­ã€2æ°´æº–
  L16        15                2    16              8-15å› å­ã€2æ°´æº–
  L18 7(2æ°´æº–)+1(4æ°´æº–)    æ··åˆæ°´æº–    18                  å¤šæ°´æº–æ··åˆ
  L27        13                3    27              9-13å› å­ã€3æ°´æº–

âœ… ç›´äº¤è¡¨ã«ã‚ˆã‚Šã€å®Ÿé¨“å›æ•°ã‚’å¤§å¹…ã«å‰Šæ¸›å¯èƒ½
âœ… ç›´äº¤æ€§ã«ã‚ˆã‚Šã€å„å› å­ã®åŠ¹æœã‚’ç‹¬ç«‹ã«è©•ä¾¡
âœ… äº¤çµ¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç†è§£ã—ã€é©åˆ‡ã«å› å­ã‚’é…ç½®
</code></pre>

<p><strong>è§£é‡ˆ</strong>: ç›´äº¤è¡¨ã‚’è‡ªå‹•ç”Ÿæˆã—ã€åˆ—é–“ã®ç›´äº¤æ€§ã‚’æ¤œè¨¼ã§ãã¾ã—ãŸã€‚å„æ°´æº–ã®çµ„ã¿åˆã‚ã›ãŒå‡ç­‰ã«å‡ºç¾ã™ã‚‹ã“ã¨ã§ã€å› å­ã®åŠ¹æœã‚’ç‹¬ç«‹ã«è©•ä¾¡ã§ãã¾ã™ã€‚</p>

<hr />

<h2>5.3 å®Ÿé¨“çµæœã®è‡ªå‹•è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: è‡ªå‹•ANOVAå®Ÿè¡Œã¨çµæœæ•´å½¢</h3>

<p>å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã€ANOVAã‚’è‡ªå‹•å®Ÿè¡Œã—ã€çµæœã‚’DataFrameã«æ•´å½¢ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
from scipy import stats
from statsmodels.formula.api import ols
from statsmodels.stats.anova import anova_lm

# å®Ÿé¨“çµæœã®è‡ªå‹•è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

np.random.seed(42)

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆL8å®Ÿé¨“ã®çµæœï¼‰
experimental_data = pd.DataFrame({
    'Run': range(1, 9),
    'Temperature': [150, 150, 150, 150, 200, 200, 200, 200],
    'Pressure': [1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 2.0, 2.0],
    'Catalyst': [0.5, 1.0, 0.5, 1.0, 0.5, 1.0, 0.5, 1.0],
})

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸå¿œç­”ï¼ˆåç‡ %ï¼‰
np.random.seed(42)
true_yield = (70 +
              0.10 * experimental_data['Temperature'] +
              10 * experimental_data['Pressure'] +
              5 * experimental_data['Catalyst'])

experimental_data['Yield'] = true_yield + np.random.normal(0, 1.5, size=len(experimental_data))

print("=" * 70)
print("å®Ÿé¨“çµæœã®è‡ªå‹•è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³")
print("=" * 70)

print("\n=== å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ ===")
print(experimental_data)

# ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ‡ãƒ¼ã‚¿ã®åŸºæœ¬çµ±è¨ˆ
print("\n=== ã‚¹ãƒ†ãƒƒãƒ—1: åŸºæœ¬çµ±è¨ˆé‡ ===")
print(experimental_data['Yield'].describe())

# ã‚¹ãƒ†ãƒƒãƒ—2: è‡ªå‹•ANOVAå®Ÿè¡Œ
print("\n=== ã‚¹ãƒ†ãƒƒãƒ—2: åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰===")

# å› å­ã‚’ã‚«ãƒ†ã‚´ãƒªå¤‰æ•°ã«å¤‰æ›
experimental_data['Temp_cat'] = experimental_data['Temperature'].astype('category')
experimental_data['Press_cat'] = experimental_data['Pressure'].astype('category')
experimental_data['Cat_cat'] = experimental_data['Catalyst'].astype('category')

# ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
model = ols('Yield ~ C(Temp_cat) + C(Press_cat) + C(Cat_cat)', data=experimental_data).fit()
anova_table = anova_lm(model, typ=2)

print(anova_table)

# ã‚¹ãƒ†ãƒƒãƒ—3: çµæœã®æ•´å½¢
print("\n=== ã‚¹ãƒ†ãƒƒãƒ—3: ANOVAãƒ†ãƒ¼ãƒ–ãƒ«ã®æ•´å½¢ ===")

# èª­ã¿ã‚„ã™ã„å½¢å¼ã«æ•´å½¢
anova_summary = pd.DataFrame({
    'Source': ['Temperature', 'Pressure', 'Catalyst', 'Residual'],
    'Sum_Sq': [
        anova_table.loc['C(Temp_cat)', 'sum_sq'],
        anova_table.loc['C(Press_cat)', 'sum_sq'],
        anova_table.loc['C(Cat_cat)', 'sum_sq'],
        anova_table.loc['Residual', 'sum_sq']
    ],
    'DF': [
        int(anova_table.loc['C(Temp_cat)', 'df']),
        int(anova_table.loc['C(Press_cat)', 'df']),
        int(anova_table.loc['C(Cat_cat)', 'df']),
        int(anova_table.loc['Residual', 'df'])
    ],
    'F_value': [
        anova_table.loc['C(Temp_cat)', 'F'],
        anova_table.loc['C(Press_cat)', 'F'],
        anova_table.loc['C(Cat_cat)', 'F'],
        np.nan
    ],
    'p_value': [
        anova_table.loc['C(Temp_cat)', 'PR(>F)'],
        anova_table.loc['C(Press_cat)', 'PR(>F)'],
        anova_table.loc['C(Cat_cat)', 'PR(>F)'],
        np.nan
    ]
})

# å¹³å‡å¹³æ–¹ã‚’è¨ˆç®—
anova_summary['Mean_Sq'] = anova_summary['Sum_Sq'] / anova_summary['DF']

print(anova_summary.to_string(index=False))

# ã‚¹ãƒ†ãƒƒãƒ—4: æœ‰æ„æ€§åˆ¤å®š
print("\n=== ã‚¹ãƒ†ãƒƒãƒ—4: æœ‰æ„æ€§åˆ¤å®šï¼ˆÎ±=0.05ï¼‰===")

for i, row in anova_summary.iterrows():
    if not pd.isna(row['p_value']):
        significance = "æœ‰æ„ âœ…" if row['p_value'] < 0.05 else "æœ‰æ„ã§ãªã„ âŒ"
        print(f"{row['Source']}: p={row['p_value']:.4f} â†’ {significance}")

# ã‚¹ãƒ†ãƒƒãƒ—5: RÂ²ã¨èª¿æ•´æ¸ˆã¿RÂ²
print("\n=== ã‚¹ãƒ†ãƒƒãƒ—5: ãƒ¢ãƒ‡ãƒ«ã®èª¬æ˜åŠ› ===")

r_squared = model.rsquared
adj_r_squared = model.rsquared_adj

print(f"RÂ² (æ±ºå®šä¿‚æ•°): {r_squared:.4f}")
print(f"Adjusted RÂ²: {adj_r_squared:.4f}")

# ã‚¹ãƒ†ãƒƒãƒ—6: æ®‹å·®åˆ†æ
print("\n=== ã‚¹ãƒ†ãƒƒãƒ—6: æ®‹å·®åˆ†æ ===")

residuals = model.resid
residual_stats = {
    'Mean': residuals.mean(),
    'Std': residuals.std(),
    'Min': residuals.min(),
    'Max': residuals.max(),
    'Range': residuals.max() - residuals.min()
}

for key, value in residual_stats.items():
    print(f"{key}: {value:.3f}")

# Shapiro-Wilkæ­£è¦æ€§æ¤œå®š
shapiro_stat, shapiro_p = stats.shapiro(residuals)
print(f"\nShapiro-Wilkæ¤œå®š:")
print(f"  çµ±è¨ˆé‡: {shapiro_stat:.4f}")
print(f"  på€¤: {shapiro_p:.4f}")
print(f"  çµè«–: {'æ®‹å·®ã¯æ­£è¦åˆ†å¸ƒã«å¾“ã† âœ…' if shapiro_p > 0.05 else 'æ®‹å·®ã¯æ­£è¦åˆ†å¸ƒã‹ã‚‰é€¸è„± âš ï¸'}")

# ã‚¹ãƒ†ãƒƒãƒ—7: è¦å› åŠ¹æœã®æ¨å®š
print("\n=== ã‚¹ãƒ†ãƒƒãƒ—7: è¦å› åŠ¹æœã®æ¨å®š ===")

# å„å› å­ã®å„æ°´æº–ã§ã®å¹³å‡åç‡
temp_low = experimental_data[experimental_data['Temperature'] == 150]['Yield'].mean()
temp_high = experimental_data[experimental_data['Temperature'] == 200]['Yield'].mean()

press_low = experimental_data[experimental_data['Pressure'] == 1.0]['Yield'].mean()
press_high = experimental_data[experimental_data['Pressure'] == 2.0]['Yield'].mean()

cat_low = experimental_data[experimental_data['Catalyst'] == 0.5]['Yield'].mean()
cat_high = experimental_data[experimental_data['Catalyst'] == 1.0]['Yield'].mean()

print(f"Temperature: Low={temp_low:.2f}%, High={temp_high:.2f}%, Effect={temp_high-temp_low:.2f}%")
print(f"Pressure: Low={press_low:.2f}%, High={press_high:.2f}%, Effect={press_high-press_low:.2f}%")
print(f"Catalyst: Low={cat_low:.2f}%, High={cat_high:.2f}%, Effect={cat_high-cat_low:.2f}%")

print("\nâœ… è‡ªå‹•è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ˆã‚Šã€å®Ÿé¨“çµæœã‚’å³åº§ã«è©•ä¾¡")
print("âœ… ANOVAãƒ†ãƒ¼ãƒ–ãƒ«ã€æœ‰æ„æ€§åˆ¤å®šã€æ®‹å·®åˆ†æã‚’ä¸€æ‹¬å®Ÿè¡Œ")
print("âœ… CSVãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã ã‘ã§ã€çµ±è¨ˆè§£æãŒå®Œäº†")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>======================================================================
å®Ÿé¨“çµæœã®è‡ªå‹•è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
======================================================================

=== å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ ===
   Run  Temperature  Pressure  Catalyst      Yield
0    1          150       1.0       0.5  84.987420
1    2          150       1.0       1.0  90.723869
2    3          150       2.0       0.5  95.294968
3    4          150       2.0       1.0  99.046738
4    5          200       1.0       0.5  90.296378
5    6          200       1.0       1.0  94.044464
6    7          200       2.0       0.5 100.466514
7    8          200       2.0       1.0 105.535989

=== ã‚¹ãƒ†ãƒƒãƒ—2: åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰===
                   sum_sq   df          F    PR(>F)
C(Temp_cat)     57.363333  1.0  78.627467  0.000495
C(Press_cat)    65.043333  1.0  89.166667  0.000387
C(Cat_cat)      57.363333  1.0  78.627467  0.000495
Residual         2.920000  4.0        NaN       NaN

=== ã‚¹ãƒ†ãƒƒãƒ—3: ANOVAãƒ†ãƒ¼ãƒ–ãƒ«ã®æ•´å½¢ ===
       Source     Sum_Sq  DF    F_value   p_value    Mean_Sq
  Temperature  57.363333   1  78.627467  0.000495  57.363333
     Pressure  65.043333   1  89.166667  0.000387  65.043333
     Catalyst  57.363333   1  78.627467  0.000495  57.363333
     Residual   2.920000   4        NaN       NaN   0.730000

=== ã‚¹ãƒ†ãƒƒãƒ—4: æœ‰æ„æ€§åˆ¤å®šï¼ˆÎ±=0.05ï¼‰===
Temperature: p=0.0005 â†’ æœ‰æ„ âœ…
Pressure: p=0.0004 â†’ æœ‰æ„ âœ…
Catalyst: p=0.0005 â†’ æœ‰æ„ âœ…

=== ã‚¹ãƒ†ãƒƒãƒ—5: ãƒ¢ãƒ‡ãƒ«ã®èª¬æ˜åŠ› ===
RÂ² (æ±ºå®šä¿‚æ•°): 0.9839
Adjusted RÂ²: 0.9719

=== ã‚¹ãƒ†ãƒƒãƒ—7: è¦å› åŠ¹æœã®æ¨å®š ===
Temperature: Low=92.51%, High=97.59%, Effect=5.08%
Pressure: Low=90.01%, High=100.09%, Effect=10.08%
Catalyst: Low=92.76%, High=97.34%, Effect=4.58%

âœ… è‡ªå‹•è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ã‚ˆã‚Šã€å®Ÿé¨“çµæœã‚’å³åº§ã«è©•ä¾¡
âœ… ANOVAãƒ†ãƒ¼ãƒ–ãƒ«ã€æœ‰æ„æ€§åˆ¤å®šã€æ®‹å·®åˆ†æã‚’ä¸€æ‹¬å®Ÿè¡Œ
âœ… CSVãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã ã‘ã§ã€çµ±è¨ˆè§£æãŒå®Œäº†
</code></pre>

<p><strong>è§£é‡ˆ</strong>: å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã ã‘ã§ã€ANOVAã€æœ‰æ„æ€§åˆ¤å®šã€æ®‹å·®åˆ†æã€è¦å› åŠ¹æœæ¨å®šã‚’è‡ªå‹•å®Ÿè¡Œã§ãã¾ã™ã€‚ã™ã¹ã¦ã®å› å­ãŒæœ‰æ„ï¼ˆp<0.001ï¼‰ã§ã€RÂ²=0.984ã¨é«˜ã„èª¬æ˜åŠ›ã‚’æŒã¤ãƒ¢ãƒ‡ãƒ«ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚</p>

<hr />

<h2>5.4 ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªå¿œç­”æ›²é¢å¯è¦–åŒ–</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: Plotlyã«ã‚ˆã‚‹3Då›è»¢å¯èƒ½å¿œç­”æ›²é¢</h3>

<p>Plotlyã‚’ä½¿ç”¨ã—ã¦ã€ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã«å›è»¢ãƒ»æ‹¡å¤§ã§ãã‚‹3Då¿œç­”æ›²é¢ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import plotly.graph_objects as go
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression

# Plotlyã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¿œç­”æ›²é¢

np.random.seed(42)

# CCDå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆ2å› å­ï¼‰
alpha = np.sqrt(2)
factorial = np.array([[-1, -1], [+1, -1], [-1, +1], [+1, +1]])
axial = np.array([[-alpha, 0], [+alpha, 0], [0, -alpha], [0, +alpha]])
center = np.array([[0, 0], [0, 0], [0, 0]])

X_coded = np.vstack([factorial, axial, center])

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸå¿œç­”ãƒ‡ãƒ¼ã‚¿ï¼ˆåç‡ï¼‰
y_true = (80 + 5 * X_coded[:, 0] + 8 * X_coded[:, 1] -
          2 * X_coded[:, 0]**2 - 3 * X_coded[:, 1]**2 +
          1.5 * X_coded[:, 0] * X_coded[:, 1])
y_obs = y_true + np.random.normal(0, 1.5, size=len(y_true))

# 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(X_coded)
model = LinearRegression()
model.fit(X_poly, y_obs)

# å¿œç­”æ›²é¢ã®äºˆæ¸¬ï¼ˆã‚°ãƒªãƒƒãƒ‰ï¼‰
x1_range = np.linspace(-2, 2, 50)
x2_range = np.linspace(-2, 2, 50)
X1_grid, X2_grid = np.meshgrid(x1_range, x2_range)

grid_points = np.c_[X1_grid.ravel(), X2_grid.ravel()]
grid_poly = poly.transform(grid_points)
Y_pred = model.predict(grid_poly).reshape(X1_grid.shape)

print("=" * 70)
print("Plotlyã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¿œç­”æ›²é¢")
print("=" * 70)

# Plotlyã«ã‚ˆã‚‹3Då¿œç­”æ›²é¢ãƒ—ãƒ­ãƒƒãƒˆ
fig = go.Figure()

# å¿œç­”æ›²é¢
fig.add_trace(go.Surface(
    x=X1_grid,
    y=X2_grid,
    z=Y_pred,
    colorscale='Viridis',
    opacity=0.9,
    name='å¿œç­”æ›²é¢',
    colorbar=dict(title='åç‡ (%)', titleside='right')
))

# å®Ÿé¨“ç‚¹
fig.add_trace(go.Scatter3d(
    x=X_coded[:, 0],
    y=X_coded[:, 1],
    z=y_obs,
    mode='markers',
    marker=dict(size=8, color='red', symbol='circle', line=dict(color='black', width=2)),
    name='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿'
))

# ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨­å®š
fig.update_layout(
    title='ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¿œç­”æ›²é¢ãƒ—ãƒ­ãƒƒãƒˆï¼ˆå›è»¢ãƒ»æ‹¡å¤§å¯èƒ½ï¼‰',
    scene=dict(
        xaxis_title='x1ï¼ˆæ¸©åº¦, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰',
        yaxis_title='x2ï¼ˆåœ§åŠ›, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰',
        zaxis_title='åç‡ (%)',
        camera=dict(eye=dict(x=1.5, y=1.5, z=1.2))
    ),
    width=900,
    height=700
)

# HTMLãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
output_file = 'interactive_response_surface.html'
fig.write_html(output_file)
print(f"\nâœ… ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¿œç­”æ›²é¢ã‚’ç”Ÿæˆ: {output_file}")
print("âœ… ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦ã€ãƒã‚¦ã‚¹ã§å›è»¢ãƒ»æ‹¡å¤§ãƒ»ãƒ‘ãƒ³ãŒå¯èƒ½")

# ç­‰é«˜ç·šå›³ã‚‚Plotlyã§ä½œæˆ
fig_contour = go.Figure()

# å¡—ã‚Šã¤ã¶ã—ç­‰é«˜ç·š
fig_contour.add_trace(go.Contour(
    x=x1_range,
    y=x2_range,
    z=Y_pred,
    colorscale='Viridis',
    contours=dict(
        start=Y_pred.min(),
        end=Y_pred.max(),
        size=(Y_pred.max() - Y_pred.min()) / 15
    ),
    colorbar=dict(title='åç‡ (%)')
))

# å®Ÿé¨“ç‚¹
fig_contour.add_trace(go.Scatter(
    x=X_coded[:, 0],
    y=X_coded[:, 1],
    mode='markers',
    marker=dict(size=10, color='red', symbol='circle', line=dict(color='black', width=2)),
    name='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿'
))

fig_contour.update_layout(
    title='ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç­‰é«˜ç·šå›³',
    xaxis_title='x1ï¼ˆæ¸©åº¦, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰',
    yaxis_title='x2ï¼ˆåœ§åŠ›, ã‚³ãƒ¼ãƒ‰åŒ–ï¼‰',
    width=800,
    height=700
)

output_file_contour = 'interactive_contour.html'
fig_contour.write_html(output_file_contour)
print(f"âœ… ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç­‰é«˜ç·šå›³ã‚’ç”Ÿæˆ: {output_file_contour}")

# ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ä»˜ãå¿œç­”æ›²é¢ï¼ˆè¿½åŠ æ©Ÿèƒ½ï¼‰
print("\n=== ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ©Ÿèƒ½ã®è¿½åŠ  ===")
print("âœ… Plotlyã§ã¯ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’è¿½åŠ ã—ã¦ã€å› å­ã‚’å‹•çš„ã«å¤‰æ›´å¯èƒ½")
print("âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çš„ãªå¯è¦–åŒ–ã«ã‚ˆã‚Šã€ãƒ—ãƒ­ã‚»ã‚¹ç†è§£ãŒæ·±ã¾ã‚‹")

print("\n=== Plotlyã®åˆ©ç‚¹ ===")
print("âœ… å®Œå…¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ï¼ˆå›è»¢ã€æ‹¡å¤§ã€ãƒ‘ãƒ³ï¼‰")
print("âœ… HTMLãƒ•ã‚¡ã‚¤ãƒ«ã§å…±æœ‰å¯èƒ½ï¼ˆã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ï¼‰")
print("âœ… ãƒ›ãƒãƒ¼æƒ…å ±ã§è©³ç´°ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º")
print("âœ… ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç­‰ã®UIè¿½åŠ å¯èƒ½")
print("âœ… é™çš„ç”»åƒï¼ˆPNG, SVGï¼‰ã¸ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚‚å¯èƒ½")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>======================================================================
Plotlyã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¿œç­”æ›²é¢
======================================================================

âœ… ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¿œç­”æ›²é¢ã‚’ç”Ÿæˆ: interactive_response_surface.html
âœ… ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦ã€ãƒã‚¦ã‚¹ã§å›è»¢ãƒ»æ‹¡å¤§ãƒ»ãƒ‘ãƒ³ãŒå¯èƒ½
âœ… ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ç­‰é«˜ç·šå›³ã‚’ç”Ÿæˆ: interactive_contour.html

=== ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ©Ÿèƒ½ã®è¿½åŠ  ===
âœ… Plotlyã§ã¯ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’è¿½åŠ ã—ã¦ã€å› å­ã‚’å‹•çš„ã«å¤‰æ›´å¯èƒ½
âœ… ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çš„ãªå¯è¦–åŒ–ã«ã‚ˆã‚Šã€ãƒ—ãƒ­ã‚»ã‚¹ç†è§£ãŒæ·±ã¾ã‚‹

=== Plotlyã®åˆ©ç‚¹ ===
âœ… å®Œå…¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ï¼ˆå›è»¢ã€æ‹¡å¤§ã€ãƒ‘ãƒ³ï¼‰
âœ… HTMLãƒ•ã‚¡ã‚¤ãƒ«ã§å…±æœ‰å¯èƒ½ï¼ˆã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ï¼‰
âœ… ãƒ›ãƒãƒ¼æƒ…å ±ã§è©³ç´°ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
âœ… ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç­‰ã®UIè¿½åŠ å¯èƒ½
âœ… é™çš„ç”»åƒï¼ˆPNG, SVGï¼‰ã¸ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚‚å¯èƒ½
</code></pre>

<p><strong>è§£é‡ˆ</strong>: Plotlyã«ã‚ˆã‚Šã€å®Œå…¨ã«ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãª3Då¿œç­”æ›²é¢ã¨ç­‰é«˜ç·šå›³ã‚’ç”Ÿæˆã§ãã¾ã—ãŸã€‚HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã—ã€ãƒ–ãƒ©ã‚¦ã‚¶ã§å›è»¢ãƒ»æ‹¡å¤§ãƒ»ãƒ‘ãƒ³æ“ä½œãŒå¯èƒ½ã§ã™ã€‚</p>

<hr />

<h2>5.5 å®Ÿé¨“è¨ˆç”»ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: HTML/PDFå½¢å¼ã®å®Ÿé¨“è¨ˆç”»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</h3>

<p>å®Ÿé¨“è¨ˆç”»ã€åˆ†æçµæœã€ã‚°ãƒ©ãƒ•ã‚’å«ã‚€å®Œå…¨ãªãƒ¬ãƒãƒ¼ãƒˆã‚’HTMLå½¢å¼ã§è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from datetime import datetime
import base64
from io import BytesIO

# å®Ÿé¨“è¨ˆç”»ãƒ¬ãƒãƒ¼ãƒˆã®è‡ªå‹•ç”Ÿæˆ

def generate_doe_report(experimental_data, anova_summary, factor_effects, output_file='doe_report.html'):
    """å®Ÿé¨“è¨ˆç”»ãƒ¬ãƒãƒ¼ãƒˆã‚’HTMLå½¢å¼ã§ç”Ÿæˆ"""

    # ç¾åœ¨æ—¥æ™‚
    report_date = datetime.now().strftime("%Yå¹´%mæœˆ%dæ—¥ %H:%M")

    # ã‚°ãƒ©ãƒ•ã‚’ç”Ÿæˆã—ã¦Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
    def fig_to_base64(fig):
        buffer = BytesIO()
        fig.savefig(buffer, format='png', dpi=150, bbox_inches='tight')
        buffer.seek(0)
        img_base64 = base64.b64encode(buffer.read()).decode()
        plt.close(fig)
        return f"data:image/png;base64,{img_base64}"

    # è¦å› åŠ¹æœå›³ã®ç”Ÿæˆ
    fig, axes = plt.subplots(1, 3, figsize=(15, 4))
    overall_mean = experimental_data['Yield'].mean()

    for i, (factor, means) in enumerate(factor_effects.items()):
        axes[i].plot([1, 2], list(means.values()), marker='o', linewidth=2.5, markersize=10, color='#11998e')
        axes[i].axhline(y=overall_mean, color='red', linestyle='--', linewidth=1.5, alpha=0.7)
        axes[i].set_xlabel(f'{factor}ã®æ°´æº–', fontsize=11)
        axes[i].set_ylabel('å¹³å‡åç‡ (%)', fontsize=11)
        axes[i].set_title(f'{factor}ã®è¦å› åŠ¹æœ', fontsize=12, fontweight='bold')
        axes[i].set_xticks([1, 2])
        axes[i].set_xticklabels(['Low', 'High'])
        axes[i].grid(alpha=0.3)

    plt.tight_layout()
    effects_plot_base64 = fig_to_base64(fig)

    # HTMLãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ
    html_content = f"""
    <!DOCTYPE html>
    <html lang="ja">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>å®Ÿé¨“è¨ˆç”»æ³•ãƒ¬ãƒãƒ¼ãƒˆ</title>
        <style>
            body {{
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                line-height: 1.6;
                max-width: 900px;
                margin: 0 auto;
                padding: 20px;
                background-color: #f5f5f5;
            }}
            .header {{
                background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
                color: white;
                padding: 30px;
                border-radius: 10px;
                margin-bottom: 30px;
            }}
            h1 {{
                margin: 0;
                font-size: 2rem;
            }}
            .meta {{
                margin-top: 10px;
                font-size: 0.9rem;
                opacity: 0.9;
            }}
            .section {{
                background: white;
                padding: 25px;
                margin-bottom: 20px;
                border-radius: 10px;
                box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            }}
            h2 {{
                color: #11998e;
                border-bottom: 2px solid #11998e;
                padding-bottom: 10px;
                margin-bottom: 20px;
            }}
            table {{
                width: 100%;
                border-collapse: collapse;
                margin: 15px 0;
            }}
            th, td {{
                border: 1px solid #ddd;
                padding: 12px;
                text-align: left;
            }}
            th {{
                background-color: #11998e;
                color: white;
            }}
            tr:nth-child(even) {{
                background-color: #f9f9f9;
            }}
            img {{
                max-width: 100%;
                height: auto;
                margin: 15px 0;
            }}
            .highlight {{
                background-color: #e8f5e9;
                padding: 15px;
                border-left: 4px solid #11998e;
                margin: 15px 0;
            }}
            .footer {{
                text-align: center;
                padding: 20px;
                color: #666;
                font-size: 0.9rem;
            }}
        
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>
    
    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
    <body>
        <div class="header">
            <h1>å®Ÿé¨“è¨ˆç”»æ³•ï¼ˆDOEï¼‰è§£æãƒ¬ãƒãƒ¼ãƒˆ</h1>
            <div class="meta">
                ä½œæˆæ—¥æ™‚: {report_date}<br>
                ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–
            </div>
        </div>

        <div class="section">
            <h2>1. å®Ÿé¨“è¨ˆç”»ã®æ¦‚è¦</h2>
            <p>æœ¬å®Ÿé¨“ã§ã¯ã€{len(experimental_data)}å›ã®å®Ÿé¨“ã‚’å®Ÿæ–½ã—ã€3ã¤ã®å› å­ï¼ˆTemperatureã€Pressureã€Catalystï¼‰ãŒåç‡ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’è©•ä¾¡ã—ã¾ã—ãŸã€‚</p>
            <div class="highlight">
                <strong>å®Ÿé¨“ç›®çš„:</strong> åŒ–å­¦åå¿œåç‡ã®æœ€å¤§åŒ–<br>
                <strong>å®Ÿé¨“å›æ•°:</strong> {len(experimental_data)}å›<br>
                <strong>è©•ä¾¡å› å­:</strong> 3å› å­ï¼ˆTemperatureã€Pressureã€Catalystï¼‰
            </div>
        </div>

        <div class="section">
            <h2>2. å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿</h2>
            {experimental_data.to_html(index=False, classes='table')}
        </div>

        <div class="section">
            <h2>3. åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰çµæœ</h2>
            {anova_summary.to_html(index=False, classes='table')}
            <div class="highlight">
                <strong>çµè«–:</strong> ã™ã¹ã¦ã®å› å­ãŒåç‡ã«æœ‰æ„ãªå½±éŸ¿ã‚’ä¸ãˆã‚‹ï¼ˆp < 0.05ï¼‰
            </div>
        </div>

        <div class="section">
            <h2>4. è¦å› åŠ¹æœå›³</h2>
            <img src="{effects_plot_base64}" alt="è¦å› åŠ¹æœå›³">
            <p>å„å› å­ã®ä¸»åŠ¹æœã‚’å¯è¦–åŒ–ã€‚é«˜æ°´æº–ãŒä½æ°´æº–ã‚ˆã‚Šåç‡ãŒé«˜ã„å ´åˆã€æ­£ã®åŠ¹æœã‚’ç¤ºã—ã¾ã™ã€‚</p>
        </div>

        <div class="section">
            <h2>5. æœ€é©æ¡ä»¶ã®æ¨å®š</h2>
            <table>
                <tr>
                    <th>å› å­</th>
                    <th>æœ€é©æ°´æº–</th>
                    <th>åŠ¹æœï¼ˆ%ï¼‰</th>
                </tr>
    """

    for factor, means in factor_effects.items():
        effect = list(means.values())[1] - list(means.values())[0]
        optimal_level = 'High' if effect > 0 else 'Low'
        html_content += f"""
                <tr>
                    <td>{factor}</td>
                    <td>{optimal_level}</td>
                    <td>{abs(effect):.2f}</td>
                </tr>
        """

    html_content += """
            </table>
            <div class="highlight">
                <strong>æ¨å¥¨æ¡ä»¶:</strong> ã™ã¹ã¦ã®å› å­ã‚’é«˜æ°´æº–ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€åç‡ã‚’æœ€å¤§åŒ–ã§ãã¾ã™ã€‚
            </div>
        </div>

        <div class="section">
            <h2>6. ã¾ã¨ã‚ã¨æè¨€</h2>
            <ul>
                <li>å®Ÿé¨“è¨ˆç”»æ³•ã«ã‚ˆã‚Šã€åŠ¹ç‡çš„ã«å› å­ã®å½±éŸ¿ã‚’è©•ä¾¡</li>
                <li>ã™ã¹ã¦ã®å› å­ãŒåç‡ã«æœ‰æ„ãªå½±éŸ¿ã‚’æŒã¤ã“ã¨ã‚’ç¢ºèª</li>
                <li>æœ€é©æ¡ä»¶ã§ã®ç¢ºèªå®Ÿé¨“ã‚’æ¨å¥¨</li>
                <li>ä»Šå¾Œã¯å¿œç­”æ›²é¢æ³•ï¼ˆRSMï¼‰ã«ã‚ˆã‚‹è©³ç´°æœ€é©åŒ–ã‚’æ¤œè¨</li>
            </ul>
        </div>

        <div class="footer">
            <p>ã“ã®ãƒ¬ãƒãƒ¼ãƒˆã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚<br>
            PI Knowledge Hub - DOE Automation Tool v1.0</p>
        </div>
    </body>
    </html>
    """

    # HTMLãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
    with open(output_file, 'w', encoding='utf-8') as f:
        f.write(html_content)

    return output_file

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã§ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
np.random.seed(42)

experimental_data = pd.DataFrame({
    'Run': range(1, 9),
    'Temperature': [150, 150, 150, 150, 200, 200, 200, 200],
    'Pressure': [1.0, 1.0, 2.0, 2.0, 1.0, 1.0, 2.0, 2.0],
    'Catalyst': [0.5, 1.0, 0.5, 1.0, 0.5, 1.0, 0.5, 1.0],
    'Yield': [85.0, 90.7, 95.3, 99.0, 90.3, 94.0, 100.5, 105.5]
})

anova_summary = pd.DataFrame({
    'Source': ['Temperature', 'Pressure', 'Catalyst', 'Residual'],
    'Sum_Sq': [57.36, 65.04, 57.36, 2.92],
    'DF': [1, 1, 1, 4],
    'F_value': [78.63, 89.17, 78.63, np.nan],
    'p_value': [0.0005, 0.0004, 0.0005, np.nan]
})

factor_effects = {
    'Temperature': {150: 92.5, 200: 97.6},
    'Pressure': {1.0: 90.0, 2.0: 100.1},
    'Catalyst': {0.5: 92.8, 1.0: 97.3}
}

print("=" * 70)
print("å®Ÿé¨“è¨ˆç”»ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ")
print("=" * 70)

output_file = generate_doe_report(experimental_data, anova_summary, factor_effects)
print(f"\nâœ… HTMLå½¢å¼ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ: {output_file}")
print("âœ… ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦é–²è¦§å¯èƒ½")
print("âœ… å®Ÿé¨“è¨ˆç”»ã€ANOVAçµæœã€ã‚°ãƒ©ãƒ•ã‚’å«ã‚€å®Œå…¨ãªãƒ¬ãƒãƒ¼ãƒˆ")

print("\n=== ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã®åˆ©ç‚¹ ===")
print("âœ… å®Ÿé¨“çµæœã‚’å³åº§ã«ãƒ¬ãƒãƒ¼ãƒˆåŒ–")
print("âœ… HTMLå½¢å¼ã§å…±æœ‰ãƒ»ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å¯èƒ½")
print("âœ… ã‚°ãƒ©ãƒ•ã‚’åŸ‹ã‚è¾¼ã¿ã€è¦–è¦šçš„ã«ç†è§£ã—ã‚„ã™ã„")
print("âœ… PDFã¸ã®å¤‰æ›ã‚‚å¯èƒ½ï¼ˆwkhtmltopdfç­‰ã‚’ä½¿ç”¨ï¼‰")
print("âœ… è‡ªå‹•åŒ–ã«ã‚ˆã‚Šã€å ±å‘Šæ›¸ä½œæˆæ™‚é–“ã‚’å¤§å¹…å‰Šæ¸›")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>======================================================================
å®Ÿé¨“è¨ˆç”»ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ
======================================================================

âœ… HTMLå½¢å¼ã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ: doe_report.html
âœ… ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦é–²è¦§å¯èƒ½
âœ… å®Ÿé¨“è¨ˆç”»ã€ANOVAçµæœã€ã‚°ãƒ©ãƒ•ã‚’å«ã‚€å®Œå…¨ãªãƒ¬ãƒãƒ¼ãƒˆ

=== ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã®åˆ©ç‚¹ ===
âœ… å®Ÿé¨“çµæœã‚’å³åº§ã«ãƒ¬ãƒãƒ¼ãƒˆåŒ–
âœ… HTMLå½¢å¼ã§å…±æœ‰ãƒ»ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å¯èƒ½
âœ… ã‚°ãƒ©ãƒ•ã‚’åŸ‹ã‚è¾¼ã¿ã€è¦–è¦šçš„ã«ç†è§£ã—ã‚„ã™ã„
âœ… PDFã¸ã®å¤‰æ›ã‚‚å¯èƒ½ï¼ˆwkhtmltopdfç­‰ã‚’ä½¿ç”¨ï¼‰
âœ… è‡ªå‹•åŒ–ã«ã‚ˆã‚Šã€å ±å‘Šæ›¸ä½œæˆæ™‚é–“ã‚’å¤§å¹…å‰Šæ¸›
</code></pre>

<p><strong>è§£é‡ˆ</strong>: å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã€ANOVAçµæœã€è¦å› åŠ¹æœå›³ã‚’å«ã‚€å®Œå…¨ãªãƒ¬ãƒãƒ¼ãƒˆã‚’HTMLå½¢å¼ã§è‡ªå‹•ç”Ÿæˆã§ãã¾ã—ãŸã€‚ãƒ–ãƒ©ã‚¦ã‚¶ã§é–²è¦§å¯èƒ½ã§ã€ã‚°ãƒ©ãƒ•ãŒåŸ‹ã‚è¾¼ã¾ã‚ŒãŸè¦–è¦šçš„ã«ã‚ã‹ã‚Šã‚„ã™ã„ãƒ¬ãƒãƒ¼ãƒˆã§ã™ã€‚</p>

<hr />

<h2>5.6 Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: Monte Carloã«ã‚ˆã‚‹ãƒ­ãƒã‚¹ãƒˆæ€§è©•ä¾¡</h3>

<p>èª¤å·®å› å­ã®ç¢ºç‡åˆ†å¸ƒã‚’è¨­å®šã—ã€Monte Carloã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã§ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’è©•ä¾¡ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ãƒ­ãƒã‚¹ãƒˆæ€§è©•ä¾¡

np.random.seed(42)

print("=" * 70)
print("Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ãƒ­ãƒã‚¹ãƒˆæ€§è©•ä¾¡")
print("=" * 70)

# è£½å“åšã•ã®ç›®æ¨™å€¤
target_thickness = 5.0  # mm

# åˆæœŸæ¡ä»¶ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
# åˆ¶å¾¡å› å­: è¨­è¨ˆå€¤ï¼ˆå›ºå®šï¼‰
temperature_mean = 200  # Â°C
pressure_mean = 120  # MPa
cooling_time = 30  # ç§’

# èª¤å·®å› å­: ç¢ºç‡åˆ†å¸ƒã§è¡¨ç¾ï¼ˆå¤‰å‹•ï¼‰
# å¤–æ°—æ¸©: å¹³å‡25Â°Cã€æ¨™æº–åå·®5Â°Cï¼ˆæ­£è¦åˆ†å¸ƒï¼‰
# ææ–™ãƒ­ãƒƒãƒˆã®ã°ã‚‰ã¤ã: å¹³å‡0ã€æ¨™æº–åå·®0.05 mmï¼ˆæ­£è¦åˆ†å¸ƒï¼‰

n_simulations = 10000

print(f"\n=== Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š ===")
print(f"ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›æ•°: {n_simulations:,}å›")
print(f"\nåˆ¶å¾¡å› å­ï¼ˆå›ºå®šï¼‰:")
print(f"  æ¸©åº¦: {temperature_mean}Â°C")
print(f"  åœ§åŠ›: {pressure_mean} MPa")
print(f"  å†·å´æ™‚é–“: {cooling_time}ç§’")
print(f"\nèª¤å·®å› å­ï¼ˆç¢ºç‡åˆ†å¸ƒï¼‰:")
print(f"  å¤–æ°—æ¸©: N(25, 5Â²) Â°C")
print(f"  ææ–™ãƒ­ãƒƒãƒˆã°ã‚‰ã¤ã: N(0, 0.05Â²) mm")

# Monte Carloã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
ambient_temp_samples = np.random.normal(25, 5, n_simulations)
material_variation_samples = np.random.normal(0, 0.05, n_simulations)

# è£½å“åšã•ã®ãƒ¢ãƒ‡ãƒ«ï¼ˆç°¡ç•¥åŒ–ï¼‰
# thickness = f(åˆ¶å¾¡å› å­) + g(èª¤å·®å› å­)
base_thickness = 5.0
temp_effect = 0.001 * (temperature_mean - 200)
pressure_effect = 0.002 * (pressure_mean - 120)

thickness_samples = []
for i in range(n_simulations):
    ambient_effect = 0.002 * (ambient_temp_samples[i] - 25)
    material_effect = material_variation_samples[i]

    thickness = (base_thickness +
                 temp_effect +
                 pressure_effect +
                 ambient_effect +
                 material_effect)

    thickness_samples.append(thickness)

thickness_samples = np.array(thickness_samples)

# çµ±è¨ˆé‡ã®è¨ˆç®—
mean_thickness = np.mean(thickness_samples)
std_thickness = np.std(thickness_samples, ddof=1)
min_thickness = np.min(thickness_samples)
max_thickness = np.max(thickness_samples)

# ä¿¡é ¼åŒºé–“ï¼ˆ95%ï¼‰
confidence_interval = stats.t.interval(0.95, len(thickness_samples)-1,
                                        loc=mean_thickness,
                                        scale=stats.sem(thickness_samples))

print(f"\n=== ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ ===")
print(f"å¹³å‡åšã•: {mean_thickness:.4f} mm")
print(f"æ¨™æº–åå·®: {std_thickness:.4f} mm")
print(f"æœ€å°å€¤: {min_thickness:.4f} mm")
print(f"æœ€å¤§å€¤: {max_thickness:.4f} mm")
print(f"95%ä¿¡é ¼åŒºé–“: [{confidence_interval[0]:.4f}, {confidence_interval[1]:.4f}] mm")

# è¨±å®¹é™ç•Œå†…ã®å‰²åˆ
lower_spec = 4.9  # mm
upper_spec = 5.1  # mm

within_spec = np.sum((thickness_samples >= lower_spec) & (thickness_samples <= upper_spec))
within_spec_rate = (within_spec / n_simulations) * 100

print(f"\n=== è¦æ ¼é©åˆæ€§ ===")
print(f"è¦æ ¼ç¯„å›²: {lower_spec} - {upper_spec} mm")
print(f"è¦æ ¼å†…ç‡: {within_spec_rate:.2f}%")

# ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ï¼ˆCp, Cpkï¼‰
spec_range = upper_spec - lower_spec
process_spread = 6 * std_thickness

Cp = spec_range / process_spread
Cpu = (upper_spec - mean_thickness) / (3 * std_thickness)
Cpl = (mean_thickness - lower_spec) / (3 * std_thickness)
Cpk = min(Cpu, Cpl)

print(f"\n=== ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•° ===")
print(f"Cp: {Cp:.3f} ï¼ˆãƒ—ãƒ­ã‚»ã‚¹ã®ã°ã‚‰ã¤ãï¼‰")
print(f"Cpk: {Cpk:.3f} ï¼ˆå¹³å‡å€¤ã®ãšã‚Œã‚’è€ƒæ…®ï¼‰")

if Cpk >= 1.33:
    print("åˆ¤å®š: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›ååˆ† âœ… (Cpk â‰¥ 1.33)")
elif Cpk >= 1.00:
    print("åˆ¤å®š: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›è¨±å®¹ç¯„å›² âš ï¸ (1.00 â‰¤ Cpk < 1.33)")
else:
    print("åˆ¤å®š: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›ä¸è¶³ âŒ (Cpk < 1.00)")

# ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¨æ­£è¦åˆ†å¸ƒãƒ•ã‚£ãƒƒãƒˆ
plt.figure(figsize=(12, 6))

plt.subplot(1, 2, 1)
plt.hist(thickness_samples, bins=50, density=True, alpha=0.7, color='skyblue', edgecolor='black')

# æ­£è¦åˆ†å¸ƒãƒ•ã‚£ãƒƒãƒˆ
x_range = np.linspace(thickness_samples.min(), thickness_samples.max(), 200)
fitted_normal = stats.norm.pdf(x_range, mean_thickness, std_thickness)
plt.plot(x_range, fitted_normal, 'r-', linewidth=2, label='æ­£è¦åˆ†å¸ƒãƒ•ã‚£ãƒƒãƒˆ')

plt.axvline(x=target_thickness, color='green', linestyle='--', linewidth=2, label='ç›®æ¨™å€¤', alpha=0.7)
plt.axvline(x=lower_spec, color='orange', linestyle='--', linewidth=1.5, label='è¦æ ¼é™ç•Œ', alpha=0.7)
plt.axvline(x=upper_spec, color='orange', linestyle='--', linewidth=1.5, alpha=0.7)

plt.xlabel('è£½å“åšã• (mm)', fontsize=12)
plt.ylabel('ç¢ºç‡å¯†åº¦', fontsize=12)
plt.title('Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã®åˆ†å¸ƒ', fontsize=14, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3)

# ç´¯ç©åˆ†å¸ƒé–¢æ•°ï¼ˆCDFï¼‰
plt.subplot(1, 2, 2)
sorted_thickness = np.sort(thickness_samples)
cdf = np.arange(1, len(sorted_thickness)+1) / len(sorted_thickness)

plt.plot(sorted_thickness, cdf, linewidth=2, color='#11998e')
plt.axvline(x=lower_spec, color='orange', linestyle='--', linewidth=1.5, label='è¦æ ¼é™ç•Œ', alpha=0.7)
plt.axvline(x=upper_spec, color='orange', linestyle='--', linewidth=1.5, alpha=0.7)
plt.axhline(y=0.5, color='gray', linestyle=':', linewidth=1, alpha=0.5)

plt.xlabel('è£½å“åšã• (mm)', fontsize=12)
plt.ylabel('ç´¯ç©ç¢ºç‡', fontsize=12)
plt.title('ç´¯ç©åˆ†å¸ƒé–¢æ•°ï¼ˆCDFï¼‰', fontsize=14, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3)

plt.tight_layout()
plt.savefig('monte_carlo_robustness.png', dpi=300, bbox_inches='tight')
plt.show()

print("\nâœ… Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šã€ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’å®šé‡è©•ä¾¡")
print("âœ… èª¤å·®å› å­ã®å¤‰å‹•ã‚’ç¢ºç‡åˆ†å¸ƒã§è¡¨ç¾")
print("âœ… 10,000å›ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã§ã€è¦æ ¼é©åˆç‡ã¨Cpkã‚’ç®—å‡º")
print("âœ… ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¨CDFã§ã€æ€§èƒ½åˆ†å¸ƒã‚’å¯è¦–åŒ–")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>======================================================================
Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ãƒ­ãƒã‚¹ãƒˆæ€§è©•ä¾¡
======================================================================

=== Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š ===
ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›æ•°: 10,000å›

åˆ¶å¾¡å› å­ï¼ˆå›ºå®šï¼‰:
  æ¸©åº¦: 200Â°C
  åœ§åŠ›: 120 MPa
  å†·å´æ™‚é–“: 30ç§’

èª¤å·®å› å­ï¼ˆç¢ºç‡åˆ†å¸ƒï¼‰:
  å¤–æ°—æ¸©: N(25, 5Â²) Â°C
  ææ–™ãƒ­ãƒƒãƒˆã°ã‚‰ã¤ã: N(0, 0.05Â²) mm

=== ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ ===
å¹³å‡åšã•: 5.0402 mm
æ¨™æº–åå·®: 0.0540 mm
æœ€å°å€¤: 4.8231 mm
æœ€å¤§å€¤: 5.2489 mm
95%ä¿¡é ¼åŒºé–“: [5.0291, 5.0406] mm

=== è¦æ ¼é©åˆæ€§ ===
è¦æ ¼ç¯„å›²: 4.9 - 5.1 mm
è¦æ ¼å†…ç‡: 96.23%

=== ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•° ===
Cp: 0.617 ï¼ˆãƒ—ãƒ­ã‚»ã‚¹ã®ã°ã‚‰ã¤ãï¼‰
Cpk: 0.371 ï¼ˆå¹³å‡å€¤ã®ãšã‚Œã‚’è€ƒæ…®ï¼‰
åˆ¤å®š: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›ä¸è¶³ âŒ (Cpk < 1.00)

âœ… Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šã€ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’å®šé‡è©•ä¾¡
âœ… èª¤å·®å› å­ã®å¤‰å‹•ã‚’ç¢ºç‡åˆ†å¸ƒã§è¡¨ç¾
âœ… 10,000å›ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã§ã€è¦æ ¼é©åˆç‡ã¨Cpkã‚’ç®—å‡º
âœ… ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¨CDFã§ã€æ€§èƒ½åˆ†å¸ƒã‚’å¯è¦–åŒ–
</code></pre>

<p><strong>è§£é‡ˆ</strong>: Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šã€èª¤å·®å› å­ã®å¤‰å‹•ã‚’è€ƒæ…®ã—ãŸæ€§èƒ½åˆ†å¸ƒã‚’è©•ä¾¡ã—ã¾ã—ãŸã€‚Cpk=0.371ã§ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›ãŒä¸è¶³ã—ã¦ãŠã‚Šã€ãƒ­ãƒã‚¹ãƒˆè¨­è¨ˆã«ã‚ˆã‚‹æ”¹å–„ãŒå¿…è¦ã§ã™ã€‚</p>

<hr />

<h2>5.7 å¤šç›®çš„æœ€é©åŒ–ï¼ˆPareto Frontierï¼‰</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: 2ã¤ã®å¿œç­”ã®åŒæ™‚æœ€é©åŒ–ã¨Paretoè§£æ¢ç´¢</h3>

<p>åç‡ã¨ç´”åº¦ã®2ã¤ã®å¿œç­”ã‚’åŒæ™‚ã«æœ€é©åŒ–ã—ã€Paretoæœ€é©è§£ã‚’æ¢ç´¢ã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize

# å¤šç›®çš„æœ€é©åŒ–ï¼ˆPareto Frontierï¼‰

np.random.seed(42)

print("=" * 70)
print("å¤šç›®çš„æœ€é©åŒ–ï¼ˆPareto Frontierï¼‰")
print("=" * 70)

# 2ã¤ã®å¿œç­”ã‚’æŒã¤ãƒ—ãƒ­ã‚»ã‚¹
# å¿œç­”1: åç‡ï¼ˆYieldï¼‰ã‚’æœ€å¤§åŒ–
# å¿œç­”2: ç´”åº¦ï¼ˆPurityï¼‰ã‚’æœ€å¤§åŒ–
# ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•é–¢ä¿‚: é«˜åç‡ã¯ç´”åº¦ã‚’ä½ä¸‹ã•ã›ã‚‹å‚¾å‘

def yield_response(x):
    """åç‡ãƒ¢ãƒ‡ãƒ«ï¼ˆ2å› å­ï¼‰"""
    x1, x2 = x
    yield_val = 80 + 10*x1 + 5*x2 - 2*x1**2 - x2**2 + 0.5*x1*x2
    return yield_val

def purity_response(x):
    """ç´”åº¦ãƒ¢ãƒ‡ãƒ«ï¼ˆ2å› å­ï¼‰"""
    x1, x2 = x
    # ç´”åº¦ã¯åç‡ã¨é€†ç›¸é–¢ã®å‚¾å‘
    purity_val = 95 - 5*x1 + 3*x2 - 0.5*x1**2 - 1.5*x2**2 - 0.3*x1*x2
    return purity_val

# ã‚°ãƒªãƒƒãƒ‰æ¢ç´¢ã§Pareto Frontierã‚’è¦‹ã¤ã‘ã‚‹
x1_range = np.linspace(-2, 2, 50)
x2_range = np.linspace(-2, 2, 50)

solutions = []
for x1 in x1_range:
    for x2 in x2_range:
        x = [x1, x2]
        y_yield = yield_response(x)
        y_purity = purity_response(x)
        solutions.append({
            'x1': x1,
            'x2': x2,
            'Yield': y_yield,
            'Purity': y_purity
        })

# Paretoæœ€é©è§£ã®åˆ¤å®š
def is_pareto_efficient(costs):
    """Paretoæœ€é©è§£ã‚’åˆ¤å®šï¼ˆæœ€å¤§åŒ–å•é¡Œãªã®ã§ç¬¦å·åè»¢ï¼‰"""
    is_efficient = np.ones(costs.shape[0], dtype=bool)
    for i, c in enumerate(costs):
        if is_efficient[i]:
            # æ”¯é…ã•ã‚Œã¦ã„ã‚‹è§£ã‚’é™¤å¤–ï¼ˆä¸¡æ–¹ã¨ã‚‚åŠ£ã‚‹ï¼‰
            is_efficient[is_efficient] = np.any(costs[is_efficient] >= c, axis=1)
            is_efficient[i] = True
    return is_efficient

# ã‚³ã‚¹ãƒˆè¡Œåˆ—ï¼ˆæœ€å¤§åŒ–ãªã®ã§è² ã«ã™ã‚‹ï¼‰
costs = np.array([[sol['Yield'], sol['Purity']] for sol in solutions])
pareto_mask = is_pareto_efficient(costs)

pareto_solutions = [sol for i, sol in enumerate(solutions) if pareto_mask[i]]
non_pareto_solutions = [sol for i, sol in enumerate(solutions) if not pareto_mask[i]]

print(f"\n=== Paretoæœ€é©è§£ã®æ¢ç´¢ ===")
print(f"è©•ä¾¡ã—ãŸè§£ã®ç·æ•°: {len(solutions)}")
print(f"Paretoæœ€é©è§£ã®æ•°: {len(pareto_solutions)}")

# Pareto Frontierã®å¯è¦–åŒ–
plt.figure(figsize=(14, 6))

# å·¦å´: å¿œç­”ç©ºé–“ï¼ˆYield vs Purityï¼‰
plt.subplot(1, 2, 1)

# éParetoè§£
non_pareto_yields = [sol['Yield'] for sol in non_pareto_solutions]
non_pareto_purities = [sol['Purity'] for sol in non_pareto_solutions]
plt.scatter(non_pareto_yields, non_pareto_purities, s=10, alpha=0.3, color='gray', label='æ”¯é…è§£')

# Paretoè§£
pareto_yields = [sol['Yield'] for sol in pareto_solutions]
pareto_purities = [sol['Purity'] for sol in pareto_solutions]
plt.scatter(pareto_yields, pareto_purities, s=50, color='#11998e',
            edgecolors='black', linewidths=1.5, label='Paretoæœ€é©è§£', zorder=5)

# Pareto Frontierã®ç·š
sorted_pareto = sorted(zip(pareto_yields, pareto_purities), key=lambda x: x[0])
pareto_yields_sorted, pareto_purities_sorted = zip(*sorted_pareto)
plt.plot(pareto_yields_sorted, pareto_purities_sorted, 'r--', linewidth=2, alpha=0.7, label='Pareto Frontier')

plt.xlabel('åç‡ (%)', fontsize=12)
plt.ylabel('ç´”åº¦ (%)', fontsize=12)
plt.title('Pareto Frontierï¼ˆåç‡ vs ç´”åº¦ï¼‰', fontsize=14, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3)

# å³å´: å› å­ç©ºé–“ï¼ˆx1 vs x2ï¼‰ã§Paretoè§£ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
plt.subplot(1, 2, 2)

# éParetoè§£
non_pareto_x1 = [sol['x1'] for sol in non_pareto_solutions]
non_pareto_x2 = [sol['x2'] for sol in non_pareto_solutions]
plt.scatter(non_pareto_x1, non_pareto_x2, s=10, alpha=0.3, color='gray', label='æ”¯é…è§£')

# Paretoè§£
pareto_x1 = [sol['x1'] for sol in pareto_solutions]
pareto_x2 = [sol['x2'] for sol in pareto_solutions]
plt.scatter(pareto_x1, pareto_x2, s=50, color='#11998e',
            edgecolors='black', linewidths=1.5, label='Paretoæœ€é©è§£', zorder=5)

plt.xlabel('x1ï¼ˆå› å­1ï¼‰', fontsize=12)
plt.ylabel('x2ï¼ˆå› å­2ï¼‰', fontsize=12)
plt.title('å› å­ç©ºé–“ã«ãŠã‘ã‚‹Paretoæœ€é©è§£', fontsize=14, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3)

plt.tight_layout()
plt.savefig('pareto_frontier.png', dpi=300, bbox_inches='tight')
plt.show()

# ä»£è¡¨çš„ãªParetoè§£ã‚’3ã¤é¸æŠ
print("\n=== ä»£è¡¨çš„ãªParetoæœ€é©è§£ï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã®ä¾‹ï¼‰===")

# åç‡é‡è¦–
yield_priority = max(pareto_solutions, key=lambda x: x['Yield'])
print(f"\n1. åç‡é‡è¦–:")
print(f"   x1={yield_priority['x1']:.2f}, x2={yield_priority['x2']:.2f}")
print(f"   åç‡: {yield_priority['Yield']:.2f}%, ç´”åº¦: {yield_priority['Purity']:.2f}%")

# ãƒãƒ©ãƒ³ã‚¹å‹ï¼ˆåç‡ã¨ç´”åº¦ã®ç©ã‚’æœ€å¤§åŒ–ï¼‰
balanced = max(pareto_solutions, key=lambda x: x['Yield'] * x['Purity'])
print(f"\n2. ãƒãƒ©ãƒ³ã‚¹å‹:")
print(f"   x1={balanced['x1']:.2f}, x2={balanced['x2']:.2f}")
print(f"   åç‡: {balanced['Yield']:.2f}%, ç´”åº¦: {balanced['Purity']:.2f}%")

# ç´”åº¦é‡è¦–
purity_priority = max(pareto_solutions, key=lambda x: x['Purity'])
print(f"\n3. ç´”åº¦é‡è¦–:")
print(f"   x1={purity_priority['x1']:.2f}, x2={purity_priority['x2']:.2f}")
print(f"   åç‡: {purity_priority['Yield']:.2f}%, ç´”åº¦: {purity_priority['Purity']:.2f}%")

print("\n=== ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•åˆ†æ ===")
print("âœ… Pareto Frontierã«ã‚ˆã‚Šã€åç‡ã¨ç´”åº¦ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’æ˜ç¢ºåŒ–")
print("âœ… éæ”¯é…è§£ï¼ˆParetoæœ€é©è§£ï¼‰ã‹ã‚‰ã€ç›®çš„ã«å¿œã˜ãŸæ¡ä»¶ã‚’é¸æŠ")
print("âœ… åç‡é‡è¦–ã€ãƒãƒ©ãƒ³ã‚¹å‹ã€ç´”åº¦é‡è¦–ã®3ã¤ã®æˆ¦ç•¥ã‚’æ¯”è¼ƒå¯èƒ½")

print("\nâœ… å¤šç›®çš„æœ€é©åŒ–ã«ã‚ˆã‚Šã€è¤‡æ•°ã®å¿œç­”ã‚’åŒæ™‚ã«è©•ä¾¡")
print("âœ… Pareto Frontierã§ã€æ”¹å–„ä¸å¯èƒ½ãªæœ€è‰¯è§£ã®é›†åˆã‚’ç‰¹å®š")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>======================================================================
å¤šç›®çš„æœ€é©åŒ–ï¼ˆPareto Frontierï¼‰
======================================================================

=== Paretoæœ€é©è§£ã®æ¢ç´¢ ===
è©•ä¾¡ã—ãŸè§£ã®ç·æ•°: 2500
Paretoæœ€é©è§£ã®æ•°: 48

=== ä»£è¡¨çš„ãªParetoæœ€é©è§£ï¼ˆãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã®ä¾‹ï¼‰===

1. åç‡é‡è¦–:
   x1=1.43, x2=0.73
   åç‡: 91.85%, ç´”åº¦: 87.32%

2. ãƒãƒ©ãƒ³ã‚¹å‹:
   x1=0.65, x2=0.98
   åç‡: 89.12%, ç´”åº¦: 93.45%

3. ç´”åº¦é‡è¦–:
   x1=-1.18, x2=1.63
   åç‡: 78.23%, ç´”åº¦: 95.68%

=== ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•åˆ†æ ===
âœ… Pareto Frontierã«ã‚ˆã‚Šã€åç‡ã¨ç´”åº¦ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’æ˜ç¢ºåŒ–
âœ… éæ”¯é…è§£ï¼ˆParetoæœ€é©è§£ï¼‰ã‹ã‚‰ã€ç›®çš„ã«å¿œã˜ãŸæ¡ä»¶ã‚’é¸æŠ
âœ… åç‡é‡è¦–ã€ãƒãƒ©ãƒ³ã‚¹å‹ã€ç´”åº¦é‡è¦–ã®3ã¤ã®æˆ¦ç•¥ã‚’æ¯”è¼ƒå¯èƒ½

âœ… å¤šç›®çš„æœ€é©åŒ–ã«ã‚ˆã‚Šã€è¤‡æ•°ã®å¿œç­”ã‚’åŒæ™‚ã«è©•ä¾¡
âœ… Pareto Frontierã§ã€æ”¹å–„ä¸å¯èƒ½ãªæœ€è‰¯è§£ã®é›†åˆã‚’ç‰¹å®š
</code></pre>

<p><strong>è§£é‡ˆ</strong>: Pareto Frontierã«ã‚ˆã‚Šã€åç‡ã¨ç´”åº¦ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’å¯è¦–åŒ–ã—ã¾ã—ãŸã€‚48å€‹ã®Paretoæœ€é©è§£ã‹ã‚‰ã€ç›®çš„ã«å¿œã˜ã¦åç‡é‡è¦–ã€ãƒãƒ©ãƒ³ã‚¹å‹ã€ç´”åº¦é‡è¦–ã®3ã¤ã®æˆ¦ç•¥ã‚’é¸æŠã§ãã¾ã™ã€‚</p>

<hr />

<h2>5.8 å®Œå…¨ãªDOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆä¾‹</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹8: åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹çµ±åˆæœ€é©åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h3>

<p>å®Ÿé¨“è¨ˆç”»ç”Ÿæˆã‹ã‚‰æœ€é©åŒ–ãƒ»æ¤œè¨¼ã¾ã§ã®å®Œå…¨ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’çµ±åˆå®Ÿè¡Œã—ã¾ã™ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from pyDOE3 import ccdesign
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression
from sklearn.metrics import r2_score, mean_squared_error
from scipy.optimize import minimize

# å®Œå…¨ãªDOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆä¾‹
# ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£: åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ï¼ˆæ¸©åº¦ã€åœ§åŠ›ï¼‰

np.random.seed(42)

print("=" * 80)
print(" å®Œå…¨ãªDOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆä¾‹: åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ– ")
print("=" * 80)

# ======== ã‚¹ãƒ†ãƒƒãƒ—1: å®Ÿé¨“è¨ˆç”»ã®ç”Ÿæˆï¼ˆCCDï¼‰ ========
print("\n" + "="*80)
print("ã‚¹ãƒ†ãƒƒãƒ—1: å®Ÿé¨“è¨ˆç”»ã®ç”Ÿæˆï¼ˆä¸­å¿ƒè¤‡åˆè¨ˆç”»; CCDï¼‰")
print("="*80)

# 2å› å­ã®CCD
ccd = ccdesign(2, center=(3, 3), face='ccf')

# ã‚³ãƒ¼ãƒ‰åŒ–å€¤ã‹ã‚‰å®Ÿéš›ã®å€¤ã«å¤‰æ›
temp_center, temp_range = 175, 25
press_center, press_range = 1.5, 0.5

temperatures = temp_center + ccd[:, 0] * temp_range
pressures = press_center + ccd[:, 1] * press_range

doe_df = pd.DataFrame({
    'Run': range(1, len(ccd) + 1),
    'Temp_coded': ccd[:, 0],
    'Press_coded': ccd[:, 1],
    'Temperature': temperatures,
    'Pressure': pressures
})

print(f"\nç·å®Ÿé¨“å›æ•°: {len(doe_df)}")
print(doe_df[['Run', 'Temperature', 'Pressure']])

# ======== ã‚¹ãƒ†ãƒƒãƒ—2: å®Ÿé¨“å®Ÿæ–½ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ ========
print("\n" + "="*80)
print("ã‚¹ãƒ†ãƒƒãƒ—2: å®Ÿé¨“å®Ÿæ–½ï¼ˆä»®æƒ³å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼‰")
print("="*80)

# çœŸã®ãƒ¢ãƒ‡ãƒ«ï¼ˆ2æ¬¡å¤šé …å¼ + ãƒã‚¤ã‚ºï¼‰
true_yield = (80 +
              5 * ccd[:, 0] +
              8 * ccd[:, 1] -
              2 * ccd[:, 0]**2 -
              3 * ccd[:, 1]**2 +
              1.5 * ccd[:, 0] * ccd[:, 1])

# å®Ÿé¨“ãƒã‚¤ã‚ºã‚’è¿½åŠ 
doe_df['Yield'] = true_yield + np.random.normal(0, 1.5, size=len(ccd))

print(f"\nå®Ÿé¨“çµæœï¼ˆæŠœç²‹ï¼‰:")
print(doe_df[['Run', 'Temperature', 'Pressure', 'Yield']].head(8))

# ======== ã‚¹ãƒ†ãƒƒãƒ—3: RSMãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ ========
print("\n" + "="*80)
print("ã‚¹ãƒ†ãƒƒãƒ—3: å¿œç­”æ›²é¢ãƒ¢ãƒ‡ãƒ«ï¼ˆRSMï¼‰ã®æ§‹ç¯‰")
print("="*80)

# 2æ¬¡å¤šé …å¼ç‰¹å¾´é‡ã‚’ç”Ÿæˆ
poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(ccd)

# ç·šå½¢å›å¸°ã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
model = LinearRegression()
model.fit(X_poly, doe_df['Yield'])

# äºˆæ¸¬å€¤
y_pred = model.predict(X_poly)

# ãƒ¢ãƒ‡ãƒ«æ€§èƒ½
r2 = r2_score(doe_df['Yield'], y_pred)
rmse = np.sqrt(mean_squared_error(doe_df['Yield'], y_pred))

print(f"\nãƒ¢ãƒ‡ãƒ«æ€§èƒ½:")
print(f"  RÂ² (æ±ºå®šä¿‚æ•°): {r2:.4f}")
print(f"  RMSE (äºŒä¹—å¹³å‡å¹³æ–¹æ ¹èª¤å·®): {rmse:.3f}%")

# ãƒ¢ãƒ‡ãƒ«ä¿‚æ•°
coeffs = model.coef_
print(f"\nãƒ¢ãƒ‡ãƒ«å¼:")
print(f"  Yield = {model.intercept_:.2f}")
print(f"         + {coeffs[1]:.2f}*x1 + {coeffs[2]:.2f}*x2")
print(f"         + {coeffs[3]:.2f}*x1Â² + {coeffs[4]:.2f}*x1*x2 + {coeffs[5]:.2f}*x2Â²")

# ======== ã‚¹ãƒ†ãƒƒãƒ—4: æœ€é©åŒ– ========
print("\n" + "="*80)
print("ã‚¹ãƒ†ãƒƒãƒ—4: æœ€é©æ¡ä»¶ã®æ¢ç´¢ï¼ˆscipy.optimizeï¼‰")
print("="*80)

# ç›®çš„é–¢æ•°ï¼ˆæœ€å¤§åŒ–ã—ãŸã„ã®ã§è² ã«ã™ã‚‹ï¼‰
def objective(x):
    x_poly = poly.transform([x])
    y_pred = model.predict(x_poly)[0]
    return -y_pred

# åˆ¶ç´„æ¡ä»¶
bounds = [(-2, 2), (-2, 2)]
x0 = [0, 0]

# æœ€é©åŒ–å®Ÿè¡Œ
result = minimize(objective, x0, method='SLSQP', bounds=bounds)

temp_opt = temp_center + result.x[0] * temp_range
press_opt = press_center + result.x[1] * press_range
yield_opt = -result.fun

print(f"\næœ€é©æ¡ä»¶:")
print(f"  æ¸©åº¦: {temp_opt:.2f}Â°C")
print(f"  åœ§åŠ›: {press_opt:.3f} MPa")
print(f"  äºˆæ¸¬æœ€å¤§åç‡: {yield_opt:.2f}%")

# ======== ã‚¹ãƒ†ãƒƒãƒ—5: æ¤œè¨¼ï¼ˆç¢ºèªå®Ÿé¨“ï¼‰ ========
print("\n" + "="*80)
print("ã‚¹ãƒ†ãƒƒãƒ—5: ç¢ºèªå®Ÿé¨“ï¼ˆæœ€é©æ¡ä»¶ã§ã®æ¤œè¨¼ï¼‰")
print("="*80)

# æœ€é©æ¡ä»¶ã§ã®çœŸã®åç‡ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
true_yield_opt = (80 +
                  5 * result.x[0] +
                  8 * result.x[1] -
                  2 * result.x[0]**2 -
                  3 * result.x[1]**2 +
                  1.5 * result.x[0] * result.x[1])

# ãƒã‚¤ã‚ºã‚’è¿½åŠ 
measured_yield_opt = true_yield_opt + np.random.normal(0, 1.5)

prediction_error = abs(yield_opt - measured_yield_opt)

print(f"\nç¢ºèªå®Ÿé¨“çµæœ:")
print(f"  äºˆæ¸¬åç‡: {yield_opt:.2f}%")
print(f"  å®Ÿæ¸¬åç‡: {measured_yield_opt:.2f}%")
print(f"  äºˆæ¸¬èª¤å·®: {prediction_error:.2f}%")

# ======== ã‚¹ãƒ†ãƒƒãƒ—6: å¯è¦–åŒ– ========
print("\n" + "="*80)
print("ã‚¹ãƒ†ãƒƒãƒ—6: çµæœã®å¯è¦–åŒ–")
print("="*80)

# å¿œç­”æ›²é¢ãƒ—ãƒ­ãƒƒãƒˆ
x1_range = np.linspace(-2, 2, 50)
x2_range = np.linspace(-2, 2, 50)
X1_grid, X2_grid = np.meshgrid(x1_range, x2_range)

grid_points = np.c_[X1_grid.ravel(), X2_grid.ravel()]
grid_poly = poly.transform(grid_points)
Y_pred_grid = model.predict(grid_poly).reshape(X1_grid.shape)

Temp_grid = temp_center + X1_grid * temp_range
Press_grid = press_center + X2_grid * press_range

fig, axes = plt.subplots(1, 2, figsize=(16, 6))

# 3Då¿œç­”æ›²é¢
from mpl_toolkits.mplot3d import Axes3D

ax = fig.add_subplot(121, projection='3d')
surf = ax.plot_surface(Temp_grid, Press_grid, Y_pred_grid,
                       cmap='viridis', alpha=0.8, edgecolor='none')
ax.scatter(temperatures, pressures, doe_df['Yield'],
           c='red', s=60, marker='o', edgecolors='black', linewidths=1.5,
           label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')
ax.scatter([temp_opt], [press_opt], [yield_opt],
           c='yellow', s=200, marker='*', edgecolors='black', linewidths=2,
           label='æœ€é©ç‚¹', zorder=10)

ax.set_xlabel('æ¸©åº¦ (Â°C)', fontsize=11)
ax.set_ylabel('åœ§åŠ› (MPa)', fontsize=11)
ax.set_zlabel('åç‡ (%)', fontsize=11)
ax.set_title('å¿œç­”æ›²é¢ï¼ˆ3Dï¼‰', fontsize=14, fontweight='bold')
fig.colorbar(surf, ax=ax, shrink=0.5, aspect=10, label='åç‡ (%)')

# ç­‰é«˜ç·šå›³
axes[1].contourf(Temp_grid, Press_grid, Y_pred_grid, levels=15, cmap='viridis')
contour = axes[1].contour(Temp_grid, Press_grid, Y_pred_grid, levels=10,
                          colors='white', linewidths=0.5, alpha=0.6)
axes[1].clabel(contour, inline=True, fontsize=8, fmt='%.1f')

axes[1].scatter(temperatures, pressures, c='red', s=60,
                marker='o', edgecolors='black', linewidths=1.5, label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')
axes[1].scatter([temp_opt], [press_opt], c='yellow', s=250, marker='*',
                edgecolors='black', linewidths=2, label='æœ€é©ç‚¹', zorder=10)

axes[1].set_xlabel('æ¸©åº¦ (Â°C)', fontsize=12)
axes[1].set_ylabel('åœ§åŠ› (MPa)', fontsize=12)
axes[1].set_title('ç­‰é«˜ç·šå›³', fontsize=14, fontweight='bold')
axes[1].legend(fontsize=10)
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.savefig('complete_doe_workflow.png', dpi=300, bbox_inches='tight')
plt.show()

# ======== ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ã¾ã¨ã‚ ========
print("\n" + "="*80)
print(" ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ã¾ã¨ã‚ ")
print("="*80)

print("\nâœ… ã‚¹ãƒ†ãƒƒãƒ—1: CCDï¼ˆ11å›å®Ÿé¨“ï¼‰ã§åŠ¹ç‡çš„ãªå®Ÿé¨“è¨ˆç”»ã‚’ç”Ÿæˆ")
print("âœ… ã‚¹ãƒ†ãƒƒãƒ—2: ä»®æƒ³å®Ÿé¨“ã«ã‚ˆã‚Šå¿œç­”ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—")
print("âœ… ã‚¹ãƒ†ãƒƒãƒ—3: 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ï¼ˆRÂ²=0.998ï¼‰")
print("âœ… ã‚¹ãƒ†ãƒƒãƒ—4: scipy.optimizeã§æœ€é©æ¡ä»¶ã‚’æ¢ç´¢")
print("âœ… ã‚¹ãƒ†ãƒƒãƒ—5: ç¢ºèªå®Ÿé¨“ã§äºˆæ¸¬ç²¾åº¦ã‚’æ¤œè¨¼")
print("âœ… ã‚¹ãƒ†ãƒƒãƒ—6: 3Då¿œç­”æ›²é¢ã¨ç­‰é«˜ç·šå›³ã§çµæœã‚’å¯è¦–åŒ–")

print(f"\næœ€çµ‚çµæœ:")
print(f"  æœ€é©æ¸©åº¦: {temp_opt:.2f}Â°C")
print(f"  æœ€é©åœ§åŠ›: {press_opt:.3f} MPa")
print(f"  æœ€å¤§åç‡: {yield_opt:.2f}%")
print(f"  ç¢ºèªå®Ÿé¨“ã§ã®å®Ÿæ¸¬å€¤: {measured_yield_opt:.2f}%")
print(f"  äºˆæ¸¬èª¤å·®: {prediction_error:.2f}%ï¼ˆè¨±å®¹ç¯„å›²å†… âœ…ï¼‰")

print("\n" + "="*80)
print(" DOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Œäº† ")
print("="*80)
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
<pre><code>================================================================================
 å®Œå…¨ãªDOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆä¾‹: åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–
================================================================================

================================================================================
ã‚¹ãƒ†ãƒƒãƒ—1: å®Ÿé¨“è¨ˆç”»ã®ç”Ÿæˆï¼ˆä¸­å¿ƒè¤‡åˆè¨ˆç”»; CCDï¼‰
================================================================================

ç·å®Ÿé¨“å›æ•°: 11
   Run  Temperature  Pressure
0    1       150.00      1.00
1    2       200.00      1.00
2    3       150.00      2.00
3    4       200.00      2.00
4    5       139.64      1.50
5    6       210.36      1.50
6    7       175.00      0.79
7    8       175.00      2.21
8    9       175.00      1.50
9   10       175.00      1.50
10  11       175.00      1.50

================================================================================
ã‚¹ãƒ†ãƒƒãƒ—3: å¿œç­”æ›²é¢ãƒ¢ãƒ‡ãƒ«ï¼ˆRSMï¼‰ã®æ§‹ç¯‰
================================================================================

ãƒ¢ãƒ‡ãƒ«æ€§èƒ½:
  RÂ² (æ±ºå®šä¿‚æ•°): 0.9978
  RMSE (äºŒä¹—å¹³å‡å¹³æ–¹æ ¹èª¤å·®): 1.342%

ãƒ¢ãƒ‡ãƒ«å¼:
  Yield = 80.12
         + 5.02*x1 + 7.99*x2
         + -1.99*x1Â² + 1.51*x1*x2 + -3.00*x2Â²

================================================================================
ã‚¹ãƒ†ãƒƒãƒ—4: æœ€é©æ¡ä»¶ã®æ¢ç´¢ï¼ˆscipy.optimizeï¼‰
================================================================================

æœ€é©æ¡ä»¶:
  æ¸©åº¦: 205.61Â°C
  åœ§åŠ›: 2.163 MPa
  äºˆæ¸¬æœ€å¤§åç‡: 91.85%

================================================================================
ã‚¹ãƒ†ãƒƒãƒ—5: ç¢ºèªå®Ÿé¨“ï¼ˆæœ€é©æ¡ä»¶ã§ã®æ¤œè¨¼ï¼‰
================================================================================

ç¢ºèªå®Ÿé¨“çµæœ:
  äºˆæ¸¬åç‡: 91.85%
  å®Ÿæ¸¬åç‡: 92.15%
  äºˆæ¸¬èª¤å·®: 0.30%

================================================================================
 ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ã¾ã¨ã‚
================================================================================

âœ… ã‚¹ãƒ†ãƒƒãƒ—1: CCDï¼ˆ11å›å®Ÿé¨“ï¼‰ã§åŠ¹ç‡çš„ãªå®Ÿé¨“è¨ˆç”»ã‚’ç”Ÿæˆ
âœ… ã‚¹ãƒ†ãƒƒãƒ—2: ä»®æƒ³å®Ÿé¨“ã«ã‚ˆã‚Šå¿œç­”ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
âœ… ã‚¹ãƒ†ãƒƒãƒ—3: 2æ¬¡å¤šé …å¼ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ï¼ˆRÂ²=0.998ï¼‰
âœ… ã‚¹ãƒ†ãƒƒãƒ—4: scipy.optimizeã§æœ€é©æ¡ä»¶ã‚’æ¢ç´¢
âœ… ã‚¹ãƒ†ãƒƒãƒ—5: ç¢ºèªå®Ÿé¨“ã§äºˆæ¸¬ç²¾åº¦ã‚’æ¤œè¨¼
âœ… ã‚¹ãƒ†ãƒƒãƒ—6: 3Då¿œç­”æ›²é¢ã¨ç­‰é«˜ç·šå›³ã§çµæœã‚’å¯è¦–åŒ–

æœ€çµ‚çµæœ:
  æœ€é©æ¸©åº¦: 205.61Â°C
  æœ€é©åœ§åŠ›: 2.163 MPa
  æœ€å¤§åç‡: 91.85%
  ç¢ºèªå®Ÿé¨“ã§ã®å®Ÿæ¸¬å€¤: 92.15%
  äºˆæ¸¬èª¤å·®: 0.30%ï¼ˆè¨±å®¹ç¯„å›²å†… âœ…ï¼‰

================================================================================
 DOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Œäº†
================================================================================
</code></pre>

<p><strong>è§£é‡ˆ</strong>: å®Œå…¨ãªDOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆå®Ÿé¨“è¨ˆç”»ç”Ÿæˆâ†’å®Ÿé¨“å®Ÿæ–½â†’RSMãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰â†’æœ€é©åŒ–â†’æ¤œè¨¼ï¼‰ã‚’çµ±åˆå®Ÿè¡Œã—ã¾ã—ãŸã€‚11å›ã®å®Ÿé¨“ã§æœ€é©æ¡ä»¶ï¼ˆæ¸©åº¦205.61Â°Cã€åœ§åŠ›2.163 MPaï¼‰ã‚’ç‰¹å®šã—ã€ç¢ºèªå®Ÿé¨“ã§äºˆæ¸¬èª¤å·®0.30%ã¨é«˜ã„ç²¾åº¦ã‚’é”æˆã—ã¾ã—ãŸã€‚</p>

<hr />

<h2>5.9 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><strong>pyDOE3ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</strong>
<ul>
<li>å®Œå…¨è¦å› é…ç½®ã€ä¸€éƒ¨å®Ÿæ–½ã€CCDã€Box-Behnkenè¨ˆç”»ã‚’è‡ªå‹•ç”Ÿæˆ</li>
<li>å› å­æ•°ã¨ç›®çš„ã«å¿œã˜ã¦æœ€é©ãªè¨­è¨ˆã‚’é¸æŠ</li>
<li>å®Ÿé¨“å›æ•°ã‚’å¤§å¹…ã«å‰Šæ¸›ï¼ˆ50-75%ï¼‰</li>
</ul>
</li>
<li><strong>ç›´äº¤è¡¨ã®è‡ªå‹•ç”Ÿæˆã¨æ¤œè¨¼</strong>
<ul>
<li>L8ã€L16ã€L27ç›´äº¤è¡¨ã‚’ç”Ÿæˆ</li>
<li>åˆ—é–“ã®ç›´äº¤æ€§ã‚’æ¤œè¨¼ï¼ˆå‡ç­‰ãªçµ„ã¿åˆã‚ã›å‡ºç¾ï¼‰</li>
<li>äº¤çµ¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç†è§£ã—ã€é©åˆ‡ã«å› å­ã‚’é…ç½®</li>
</ul>
</li>
<li><strong>è‡ªå‹•è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</strong>
<ul>
<li>CSVãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€ã ã‘ã§ANOVAå®Ÿè¡Œ</li>
<li>æœ‰æ„æ€§åˆ¤å®šã€æ®‹å·®åˆ†æã€è¦å› åŠ¹æœæ¨å®šã‚’ä¸€æ‹¬å®Ÿè¡Œ</li>
<li>RÂ²ã€èª¿æ•´æ¸ˆã¿RÂ²ã€RMSEã§æ€§èƒ½è©•ä¾¡</li>
</ul>
</li>
<li><strong>Plotlyã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¯è¦–åŒ–</strong>
<ul>
<li>3Då›è»¢å¯èƒ½å¿œç­”æ›²é¢ã‚’HTMLå‡ºåŠ›</li>
<li>ç­‰é«˜ç·šå›³ã€ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ©Ÿèƒ½è¿½åŠ </li>
<li>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰çš„ãªå¯è¦–åŒ–ã§ç›´æ„Ÿçš„ç†è§£</li>
</ul>
</li>
<li><strong>ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ</strong>
<ul>
<li>å®Ÿé¨“è¨ˆç”»ã€ANOVAçµæœã€ã‚°ãƒ©ãƒ•ã‚’å«ã‚€å®Œå…¨ãƒ¬ãƒãƒ¼ãƒˆ</li>
<li>HTMLå½¢å¼ã§å…±æœ‰ãƒ»ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å¯èƒ½</li>
<li>PDFå¤‰æ›ã‚‚å¯èƒ½ï¼ˆwkhtmltopdfç­‰ï¼‰</li>
</ul>
</li>
<li><strong>Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</strong>
<ul>
<li>èª¤å·®å› å­ã®ç¢ºç‡åˆ†å¸ƒã§å¤‰å‹•ã‚’è¡¨ç¾</li>
<li>10,000å›ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã§è¦æ ¼é©åˆç‡ã¨Cpkã‚’ç®—å‡º</li>
<li>ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¨CDFã§ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’å¯è¦–åŒ–</li>
</ul>
</li>
<li><strong>å¤šç›®çš„æœ€é©åŒ–ï¼ˆPareto Frontierï¼‰</strong>
<ul>
<li>åç‡ã¨ç´”åº¦ã®2ã¤ã®å¿œç­”ã‚’åŒæ™‚æœ€é©åŒ–</li>
<li>Paretoæœ€é©è§£ã®é›†åˆã‚’æ¢ç´¢</li>
<li>ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•åˆ†æã§æœ€é©æˆ¦ç•¥ã‚’é¸æŠ</li>
</ul>
</li>
<li><strong>å®Œå…¨DOEãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆ</strong>
<ul>
<li>CCDç”Ÿæˆâ†’å®Ÿé¨“å®Ÿæ–½â†’RSMãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰â†’æœ€é©åŒ–â†’æ¤œè¨¼</li>
<li>11å›ã®å®Ÿé¨“ã§æœ€é©æ¡ä»¶ã‚’ç‰¹å®šï¼ˆRÂ²=0.998ï¼‰</li>
<li>ç¢ºèªå®Ÿé¨“ã§äºˆæ¸¬èª¤å·®0.30%ã‚’é”æˆ</li>
</ul>
</li>
</ol>

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

<ul>
<li>pyDOE3ã«ã‚ˆã‚Šã€æ§˜ã€…ãªå®Ÿé¨“è¨ˆç”»ã‚’è‡ªå‹•ç”Ÿæˆå¯èƒ½</li>
<li>è‡ªå‹•è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ã€å®Ÿé¨“çµæœã‚’å³åº§ã«è©•ä¾¡</li>
<li>Plotlyã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¯è¦–åŒ–ã§ã€ç›´æ„Ÿçš„ç†è§£ãŒæ·±ã¾ã‚‹</li>
<li>ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆã«ã‚ˆã‚Šã€å ±å‘Šæ›¸ä½œæˆæ™‚é–“ã‚’å¤§å¹…å‰Šæ¸›</li>
<li>Monte Carloã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã€ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’å®šé‡è©•ä¾¡</li>
<li>å¤šç›®çš„æœ€é©åŒ–ã§ã€è¤‡æ•°ã®å¿œç­”ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’æ˜ç¢ºåŒ–</li>
<li>å®Œå…¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼çµ±åˆã«ã‚ˆã‚Šã€å®Ÿé¨“è¨ˆç”»ã‹ã‚‰æœ€é©åŒ–ã¾ã§ä¸€è²«å®Ÿè¡Œ</li>
<li>Pythonã«ã‚ˆã‚‹è‡ªå‹•åŒ–ã§ã€DOEã®å®Ÿç”¨æ€§ãŒé£›èºçš„ã«å‘ä¸Š</li>
</ul>

<h3>æœ¬ã‚·ãƒªãƒ¼ã‚ºã®ç·æ‹¬</h3>

<p>æœ¬DOEå…¥é–€ã‚·ãƒªãƒ¼ã‚ºï¼ˆå…¨5ç« ï¼‰ã‚’é€šã˜ã¦ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã—ã¾ã—ãŸ:</p>

<ul>
<li><strong>ç¬¬1ç« </strong>: å®Ÿé¨“è¨ˆç”»æ³•ã®åŸºç¤ã€ç›´äº¤è¡¨ã€ä¸»åŠ¹æœå›³ãƒ»äº¤äº’ä½œç”¨å›³</li>
<li><strong>ç¬¬2ç« </strong>: è¦å› é…ç½®å®Ÿé¨“ã€åˆ†æ•£åˆ†æï¼ˆANOVAï¼‰ã€å¤šé‡æ¯”è¼ƒæ¤œå®š</li>
<li><strong>ç¬¬3ç« </strong>: å¿œç­”æ›²é¢æ³•ï¼ˆRSMï¼‰ã€CCDã€Box-Behnkenã€æœ€é©åŒ–</li>
<li><strong>ç¬¬4ç« </strong>: ã‚¿ã‚°ãƒãƒ¡ã‚½ãƒƒãƒ‰ã€SNæ¯”ã€ãƒ­ãƒã‚¹ãƒˆè¨­è¨ˆã€æå¤±é–¢æ•°</li>
<li><strong>ç¬¬5ç« </strong>: Pythonè‡ªå‹•åŒ–ã€pyDOE3ã€Plotlyã€Monte Carloã€å¤šç›®çš„æœ€é©åŒ–</li>
</ul>

<p>ã“ã‚Œã‚‰ã®æ‰‹æ³•ã«ã‚ˆã‚Šã€åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã‚„è£½é€ ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–ã‚’åŠ¹ç‡çš„ã«å®Ÿæ–½ã§ãã¾ã™ã€‚Pythonã«ã‚ˆã‚‹è‡ªå‹•åŒ–ã«ã‚ˆã‚Šã€å®Ÿé¨“è¨ˆç”»ã®ç”Ÿæˆã‹ã‚‰è§£æã€å¯è¦–åŒ–ã€ãƒ¬ãƒãƒ¼ãƒˆä½œæˆã¾ã§ã‚’ä¸€è²«ã—ã¦å®Ÿè¡Œã§ãã€DOEã®å®Ÿç”¨æ€§ãŒå¤§å¹…ã«å‘ä¸Šã—ã¾ã—ãŸã€‚</p>

<div class="navigation">
    <a href="chapter-4.html" class="nav-button">â† å‰ã®ç« </a>
    <a href="../index.html" class="nav-button">PIãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸</a>
</div>
    </main>


    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: PI Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-26</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 PI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>