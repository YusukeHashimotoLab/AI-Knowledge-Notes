<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬5ç« ï¼šã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ - åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©é‹è»¢æ¡ä»¶æ¢ç´¢ - ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–å…¥é–€ã‚·ãƒªãƒ¼ã‚º">
    <title>ç¬¬5ç« ï¼šã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ - åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©é‹è»¢æ¡ä»¶æ¢ç´¢ - ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–å…¥é–€ | PI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #11998e;
            --color-accent-light: #38ef7d;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #11998e;
            --color-link-hover: #0d7a6f;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.2rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-sm);
            line-height: 1.8;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        li {
            margin-bottom: 0.4rem;
            line-height: 1.7;
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s ease;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        code {
            font-family: var(--font-mono);
            background-color: var(--color-code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
            color: #c7254e;
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            line-height: 1.5;
        }

        pre code {
            background-color: transparent;
            color: var(--color-text);
            padding: 0;
            font-size: 0.9rem;
        }

        .warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .info {
            background-color: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .success {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .tip {
            background-color: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            font-style: italic;
            color: var(--color-text-light);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            overflow-x: auto;
            display: block;
        }

        table thead {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        table tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        th, td {
            padding: var(--spacing-sm);
            text-align: left;
            border: 1px solid var(--color-border);
        }

        th {
            background-color: var(--color-primary);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background-color: var(--color-bg-alt);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: white;
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            border: 1px solid var(--color-border);
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xl);
            gap: var(--spacing-md);
            flex-wrap: wrap;
        }

        .nav-button {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(17, 153, 142, 0.3);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) 0;
            border-top: 2px solid var(--color-border);
            text-align: center;
            color: var(--color-text-light);
            font-size: 0.9rem;
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        details {
            margin: var(--spacing-md) 0;
            padding: var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-radius: var(--border-radius);
            border: 1px solid var(--color-border);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            padding: var(--spacing-xs);
            user-select: none;
        }

        summary:hover {
            color: var(--color-accent);
        }

        @media (max-width: 768px) {
            body {
                font-size: 15px;
            }

            h1 {
                font-size: 1.6rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .container {
                padding: 0 var(--spacing-sm) var(--spacing-lg);
            }

            pre {
                padding: var(--spacing-sm);
                font-size: 0.85rem;
            }

            table {
                font-size: 0.9rem;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .nav-button {
                width: 100%;
                text-align: center;
            }
        }
    </style>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mermaidCodeBlocks = document.querySelectorAll('pre.codehilite code.language-mermaid, pre code.language-mermaid');

            mermaidCodeBlocks.forEach(function(codeBlock) {
                const pre = codeBlock.parentElement;
                const mermaidCode = codeBlock.textContent;

                const mermaidDiv = document.createElement('div');
                mermaidDiv.className = 'mermaid';
                mermaidDiv.textContent = mermaidCode.trim();

                pre.parentNode.replaceChild(mermaidDiv, pre);
            });

            if (typeof mermaid !== 'undefined') {
                mermaid.initialize({ startOnLoad: true, theme: 'default' });
                mermaid.init(undefined, document.querySelectorAll('.mermaid'));
            }
        });
    </script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬5ç« ï¼šã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ - åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©é‹è»¢æ¡ä»¶æ¢ç´¢</h1>
            <p class="subtitle">å®Œå…¨ãªç”£æ¥­æœ€é©åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼šçµŒæ¸ˆçš„ç›®çš„é–¢æ•°ã€ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã€ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–ã€å®Ÿæ™‚é–“æœ€é©åŒ–</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 30-40åˆ†</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 9å€‹</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´šã€œä¸Šç´š</span>
            </div>
        </div>
    </header>

    <main class="container">
        <h2 id="introduction">ã¯ã˜ã‚ã«</h2>

        <p>ã“ã®æœ€çµ‚ç« ã§ã¯ã€ã“ã‚Œã¾ã§å­¦ã‚“ã ã™ã¹ã¦ã®æŠ€è¡“ã‚’çµ±åˆã—ã¦ã€å®Ÿéš›ã®åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©é‹è»¢æ¡ä»¶æ¢ç´¢ã«å–ã‚Šçµ„ã¿ã¾ã™ã€‚å®Œå…¨ãªæœ€é©åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã€çµŒæ¸ˆçš„ç›®çš„é–¢æ•°ã®è¨­è¨ˆã€æ„Ÿåº¦åˆ†æã€ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–ã€ãã—ã¦å®Ÿæ™‚é–“æœ€é©åŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¾ã§ã€ç”£æ¥­å®Ÿå‹™ã«ç›´çµã™ã‚‹å†…å®¹ã‚’æ‰±ã„ã¾ã™ã€‚</p>

        <div class="info">
            <h4>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h4>
            <ul>
                <li><strong>å®Œå…¨ãªæœ€é©åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</strong>: å•é¡Œå®šç¾©ã‹ã‚‰çµæœæ¤œè¨¼ã¾ã§</li>
                <li><strong>CSTRæœ€é©åŒ–ã®å®Œå…¨å®Ÿè£…</strong>: å¤šå¤‰æ•°æœ€é©åŒ–ã¨çµŒæ¸ˆçš„ç›®çš„é–¢æ•°</li>
                <li><strong>æ„Ÿåº¦åˆ†æ</strong>: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰å‹•ã«å¯¾ã™ã‚‹æœ€é©è§£ã®é ‘å¥æ€§è©•ä¾¡</li>
                <li><strong>ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–</strong>: ä¸ç¢ºå®Ÿæ€§ä¸‹ã§ã®æœ€é©åŒ–</li>
                <li><strong>å®Ÿæ™‚é–“æœ€é©åŒ–</strong>: ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãé©å¿œçš„æœ€é©åŒ–</li>
                <li><strong>è’¸ç•™å¡”æœ€é©åŒ–</strong>: ç·åˆã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£</li>
            </ul>
        </div>

        <h2 id="workflow">5.1 å®Œå…¨ãªæœ€é©åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h2>

        <p>ç”£æ¥­ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–ã¯ã€ä»¥ä¸‹ã®ä½“ç³»çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«å¾“ã£ã¦å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚</p>

        <pre><code class="language-mermaid">flowchart TD
    A[1. å•é¡Œå®šç¾©ã¨ã‚´ãƒ¼ãƒ«è¨­å®š] --> B[2. ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«ã®é–‹ç™º]
    B --> C[3. åˆ¶ç´„æ¡ä»¶ã®å®šç¾©]
    C --> D[4. æœ€é©åŒ–å•é¡Œã®å®šå¼åŒ–]
    D --> E[5. ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ é¸æŠã¨å®Ÿè¡Œ]
    E --> F[6. çµæœã®æ¤œè¨¼ã¨è§£é‡ˆ]
    F --> G{ç›®æ¨™é”æˆ?}
    G -->|No| H[7. ãƒ¢ãƒ‡ãƒ«æ”¹å–„]
    H --> B
    G -->|Yes| I[8. æ„Ÿåº¦åˆ†æ]
    I --> J[9. å®Ÿè£…ã¨ç›£è¦–]

    style A fill:#e8f5e9
    style D fill:#fff9c4
    style E fill:#ffe0b2
    style F fill:#f8bbd0
    style I fill:#c5cae9
    style J fill:#b2dfdb
</code></pre>

        <h3 id="workflow-steps">å„ã‚¹ãƒ†ãƒƒãƒ—ã®è©³ç´°</h3>

        <p><strong>ã‚¹ãƒ†ãƒƒãƒ—1: å•é¡Œå®šç¾©ã¨ã‚´ãƒ¼ãƒ«è¨­å®š</strong></p>
        <ul>
            <li>æœ€é©åŒ–ã®ç›®çš„ã‚’æ˜ç¢ºåŒ–ï¼ˆã‚³ã‚¹ãƒˆå‰Šæ¸›ã€åç‡å‘ä¸Šã€ã‚¨ãƒãƒ«ã‚®ãƒ¼åŠ¹ç‡æ”¹å–„ç­‰ï¼‰</li>
            <li>KPIï¼ˆKey Performance Indicatorï¼‰ã®å®šç¾©</li>
            <li>ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ€§èƒ½ã®æ¸¬å®š</li>
            <li>ç›®æ¨™å€¤ã®è¨­å®šï¼ˆå®šé‡çš„ã‹ã¤é”æˆå¯èƒ½ãªç›®æ¨™ï¼‰</li>
        </ul>

        <p><strong>ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«ã®é–‹ç™º</strong></p>
        <ul>
            <li>ç¬¬ä¸€åŸç†ãƒ¢ãƒ‡ãƒ«ï¼ˆç‰©è³ªåæ”¯ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼åæ”¯ã€åå¿œé€Ÿåº¦å¼ï¼‰</li>
            <li>ãƒ‡ãƒ¼ã‚¿é§†å‹•ãƒ¢ãƒ‡ãƒ«ï¼ˆæ©Ÿæ¢°å­¦ç¿’ã€çµ±è¨ˆãƒ¢ãƒ‡ãƒ«ï¼‰</li>
            <li>ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒ¢ãƒ‡ãƒ«ï¼ˆç¬¬ä¸€åŸç†+ãƒ‡ãƒ¼ã‚¿é§†å‹•ï¼‰</li>
            <li>ãƒ¢ãƒ‡ãƒ«ã®æ¤œè¨¼ã¨å¦¥å½“æ€§ç¢ºèª</li>
        </ul>

        <p><strong>ã‚¹ãƒ†ãƒƒãƒ—3: åˆ¶ç´„æ¡ä»¶ã®å®šç¾©</strong></p>
        <ul>
            <li>å®‰å…¨åˆ¶ç´„ï¼ˆæ¸©åº¦ã€åœ§åŠ›ã€æµé‡ã®ä¸Šä¸‹é™ï¼‰</li>
            <li>è£½å“è¦æ ¼åˆ¶ç´„ï¼ˆç´”åº¦ã€å“è³ªæŒ‡æ¨™ï¼‰</li>
            <li>ç’°å¢ƒåˆ¶ç´„ï¼ˆæ’å‡ºåŸºæº–ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ä½¿ç”¨é‡ï¼‰</li>
            <li>é‹è»¢åˆ¶ç´„ï¼ˆè¨­å‚™èƒ½åŠ›ã€ç‰©ç†çš„é™ç•Œï¼‰</li>
        </ul>

        <p><strong>ã‚¹ãƒ†ãƒƒãƒ—4-9</strong>: æ®‹ã‚Šã®ã‚¹ãƒ†ãƒƒãƒ—ã¯ä»¥é™ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚</p>

        <h2 id="cstr-case">5.2 CSTRæœ€é©åŒ–ã®å®Œå…¨å®Ÿè£…</h2>

        <p>é€£ç¶šæ’¹æ‹Œæ§½å‹åå¿œå™¨ï¼ˆCSTRï¼‰ã®æœ€é©é‹è»¢æ¡ä»¶æ¢ç´¢ã‚’ã€å®Œå…¨ãªå®Ÿè£…ä¾‹ã§å­¦ã³ã¾ã™ã€‚</p>

        <h3 id="cstr-problem">å•é¡Œè¨­å®š</h3>

        <p><strong>åå¿œã‚·ã‚¹ãƒ†ãƒ </strong>: å˜ç´”ãªå¯é€†åå¿œ A â†’ Bï¼ˆã‚¨ã‚­ã‚½ã‚µãƒ¼ãƒŸãƒƒã‚¯åå¿œï¼‰</p>

        <p><strong>ç›®çš„</strong>: åˆ©ç›Šã‚’æœ€å¤§åŒ–ï¼ˆè£½å“åç›Š - åŸæ–™ã‚³ã‚¹ãƒˆ - ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆï¼‰</p>

        <p><strong>æ±ºå®šå¤‰æ•°</strong>:</p>
        <ul>
            <li><strong>T</strong>: åå¿œæ¸©åº¦ [Â°C] (50-300)</li>
            <li><strong>Ï„</strong>: æ»ç•™æ™‚é–“ [min] (30-180)</li>
            <li><strong>C<sub>A0</sub></strong>: ä¾›çµ¦æ¿ƒåº¦ [mol/L] (1-5)</li>
        </ul>

        <p><strong>åˆ¶ç´„æ¡ä»¶</strong>:</p>
        <ul>
            <li>å®‰å…¨åˆ¶ç´„: T â‰¤ 350Â°C</li>
            <li>ç´”åº¦åˆ¶ç´„: X<sub>A</sub> (è»¢åŒ–ç‡) â‰¥ 0.95</li>
            <li>æµé‡åˆ¶ç´„: 100 â‰¤ F â‰¤ 400 L/h</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: CSTRå•é¡Œã®å®Œå…¨å®šå¼åŒ–</h4>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize
import pandas as pd

class CSTROptimization:
    """
    é€£ç¶šæ’¹æ‹Œæ§½å‹åå¿œå™¨ï¼ˆCSTRï¼‰ã®æœ€é©åŒ–ã‚¯ãƒ©ã‚¹

    åå¿œ: A â†’ B (ã‚¨ã‚­ã‚½ã‚µãƒ¼ãƒŸãƒƒã‚¯åå¿œ)
    ç›®çš„: åˆ©ç›Šæœ€å¤§åŒ–ï¼ˆåç›Š - åŸæ–™ã‚³ã‚¹ãƒˆ - ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆï¼‰
    """

    def __init__(self):
        # çµŒæ¸ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆç¾å®Ÿçš„ãªä¾¡æ ¼è¨­å®šï¼‰
        self.price_B = 1200.0      # è£½å“Bä¾¡æ ¼ [Â¥/kg]
        self.price_A = 600.0       # åŸæ–™Aä¾¡æ ¼ [Â¥/kg]
        self.energy_cost = 12.0    # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ [Â¥/kWh]

        # ç‰©æ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.MW_A = 60.0           # åˆ†å­é‡A [g/mol]
        self.MW_B = 60.0           # åˆ†å­é‡B [g/mol]
        self.rho = 1000.0          # å¯†åº¦ [kg/mÂ³]
        self.Cp = 4.18             # æ¯”ç†± [kJ/kgÂ·K]

        # åå¿œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆArrheniuså¼ï¼‰
        self.k0 = 1e10             # é »åº¦å› å­ [1/min]
        self.Ea = 80000.0          # æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ [J/mol]
        self.R = 8.314             # ã‚¬ã‚¹å®šæ•° [J/molÂ·K]
        self.delta_H = -50000.0    # åå¿œç†± [J/mol] (ç™ºç†±åå¿œ)

        # åˆ¶ç´„æ¡ä»¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.T_max = 350.0         # æœ€å¤§è¨±å®¹æ¸©åº¦ [Â°C]
        self.X_min = 0.95          # æœ€å°è»¢åŒ–ç‡ [-]
        self.F_min = 100.0         # æœ€å°æµé‡ [L/h]
        self.F_max = 400.0         # æœ€å¤§æµé‡ [L/h]

    def reaction_rate_constant(self, T_celsius):
        """
        åå¿œé€Ÿåº¦å®šæ•°ã‚’è¨ˆç®—ï¼ˆArrheniuså¼ï¼‰

        Parameters:
        -----------
        T_celsius : float
            æ¸©åº¦ [Â°C]

        Returns:
        --------
        k : float
            åå¿œé€Ÿåº¦å®šæ•° [1/min]
        """
        T_K = T_celsius + 273.15
        k = self.k0 * np.exp(-self.Ea / (self.R * T_K))
        return k

    def conversion(self, T, tau):
        """
        CSTRè»¢åŒ–ç‡ã‚’è¨ˆç®—

        Parameters:
        -----------
        T : float
            æ¸©åº¦ [Â°C]
        tau : float
            æ»ç•™æ™‚é–“ [min]

        Returns:
        --------
        X_A : float
            è»¢åŒ–ç‡ [-]
        """
        k = self.reaction_rate_constant(T)
        X_A = (k * tau) / (1 + k * tau)  # CSTRè»¢åŒ–ç‡å¼
        return X_A

    def profit(self, x):
        """
        åˆ©ç›Šé–¢æ•°ï¼ˆæœ€å¤§åŒ–å¯¾è±¡ï¼‰

        Parameters:
        -----------
        x : array_like
            [T, tau, C_A0]
            T: æ¸©åº¦ [Â°C]
            tau: æ»ç•™æ™‚é–“ [min]
            C_A0: ä¾›çµ¦æ¿ƒåº¦ [mol/L]

        Returns:
        --------
        profit : float
            åˆ©ç›Š [Â¥/h]ï¼ˆè² ã®å€¤ã‚’è¿”ã™ç†ç”±ï¼šscipy.minimizeã¯æœ€å°åŒ–ã™ã‚‹ãŸã‚ï¼‰
        """
        T, tau, C_A0 = x

        # è»¢åŒ–ç‡ã‚’è¨ˆç®—
        X_A = self.conversion(T, tau)

        # åå¿œå™¨ä½“ç©ã¨æµé‡
        V = 1000.0  # å›ºå®šä½“ç© [L]ï¼ˆ1 mÂ³ï¼‰
        F = V / tau  # ä½“ç©æµé‡ [L/h]

        # ç”Ÿç”£é€Ÿåº¦ [mol/h]
        production_rate_B = F * C_A0 * X_A

        # åç›Š [Â¥/h]
        revenue = production_rate_B * (self.MW_B / 1000.0) * self.price_B

        # åŸæ–™ã‚³ã‚¹ãƒˆ [Â¥/h]
        raw_material_cost = F * C_A0 * (self.MW_A / 1000.0) * self.price_A

        # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ [Â¥/h]ï¼ˆåå¿œç†±é™¤å»ã®ãŸã‚ã®å†·å´ï¼‰
        Q_reaction = abs(self.delta_H) * production_rate_B  # [J/h]
        energy_cost = (Q_reaction / 3.6e6) * self.energy_cost  # [Â¥/h]ï¼ˆJâ†’kWhã«å¤‰æ›ï¼‰

        # åˆ©ç›Š = åç›Š - åŸæ–™ã‚³ã‚¹ãƒˆ - ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ
        profit = revenue - raw_material_cost - energy_cost

        # æœ€å°åŒ–ã®ãŸã‚è² ã®å€¤ã‚’è¿”ã™
        return -profit

    def constraints(self, x):
        """
        åˆ¶ç´„æ¡ä»¶ã‚’å®šç¾©

        Returns:
        --------
        constraints : list of dict
            scipy.optimizeã®åˆ¶ç´„æ¡ä»¶å½¢å¼
        """
        T, tau, C_A0 = x
        V = 1000.0
        F = V / tau
        X_A = self.conversion(T, tau)

        cons = [
            {'type': 'ineq', 'fun': lambda x: self.T_max - x[0]},           # T â‰¤ 350Â°C
            {'type': 'ineq', 'fun': lambda x: self.conversion(x[0], x[1]) - self.X_min},  # X_A â‰¥ 0.95
            {'type': 'ineq', 'fun': lambda x: V / x[1] - self.F_min},       # F â‰¥ 100 L/h
            {'type': 'ineq', 'fun': lambda x: self.F_max - V / x[1]}        # F â‰¤ 400 L/h
        ]

        return cons

# ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã¨ãƒ†ã‚¹ãƒˆ
cstr = CSTROptimization()

# é‹è»¢æ¡ä»¶ã®ä¾‹ï¼šT=200Â°C, Ï„=60min, C_A0=3.0 mol/L
test_conditions = [200.0, 60.0, 3.0]
profit_value = -cstr.profit(test_conditions)
conversion_value = cstr.conversion(test_conditions[0], test_conditions[1])

print("=" * 60)
print("CSTRæœ€é©åŒ–å•é¡Œã®å®šå¼åŒ–")
print("=" * 60)
print(f"\né‹è»¢æ¡ä»¶: T={test_conditions[0]:.1f}Â°C, Ï„={test_conditions[1]:.1f}min, C_A0={test_conditions[2]:.1f}mol/L")
print(f"è»¢åŒ–ç‡: {conversion_value:.3f} ({conversion_value*100:.1f}%)")
print(f"åˆ©ç›Š: Â¥{profit_value:,.0f}/h")
print("\nç›®çš„: åˆ©ç›Šã‚’æœ€å¤§åŒ–")
print("åˆ¶ç´„: Tâ‰¤350Â°C, X_Aâ‰¥0.95, 100â‰¤Fâ‰¤400 L/h")
</code></pre>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«ã®é–‹ç™ºï¼ˆåå¿œé€Ÿåº¦å¼ã¨ç‰©è³ªåæ”¯ï¼‰</h4>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

class CSTRProcessModel:
    """
    CSTRãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«: åå¿œé€Ÿåº¦å¼ã¨ç‰©è³ªåæ”¯

    ãƒ¢ãƒ‡ãƒ«:
    - Arrheniusé€Ÿåº¦å¼: k(T) = k0 * exp(-Ea/RT)
    - CSTRç‰©è³ªåæ”¯: X_A = (k*Ï„) / (1 + k*Ï„)
    - ã‚¨ãƒãƒ«ã‚®ãƒ¼åæ”¯: Q_reaction + Q_cooling = 0
    """

    def __init__(self):
        self.k0 = 1e10
        self.Ea = 80000.0
        self.R = 8.314

    def k(self, T_celsius):
        """åå¿œé€Ÿåº¦å®šæ•° [1/min]"""
        T_K = T_celsius + 273.15
        return self.k0 * np.exp(-self.Ea / (self.R * T_K))

    def conversion_vs_temperature(self, tau=60.0):
        """æ¸©åº¦ vs è»¢åŒ–ç‡ã®ãƒ—ãƒ­ãƒƒãƒˆ"""
        T_range = np.linspace(50, 300, 100)
        X_A = np.array([self.k(T) * tau / (1 + self.k(T) * tau) for T in T_range])

        plt.figure(figsize=(10, 6))
        plt.plot(T_range, X_A * 100, 'b-', linewidth=2, label=f'Ï„ = {tau} min')
        plt.axhline(y=95, color='r', linestyle='--', linewidth=1.5, label='ç›®æ¨™è»¢åŒ–ç‡ 95%')
        plt.axvline(x=350, color='orange', linestyle='--', linewidth=1.5, label='æœ€å¤§æ¸©åº¦ 350Â°C')

        plt.xlabel('æ¸©åº¦ T [Â°C]', fontsize=12, fontweight='bold')
        plt.ylabel('è»¢åŒ–ç‡ X_A [%]', fontsize=12, fontweight='bold')
        plt.title('CSTRè»¢åŒ–ç‡ vs åå¿œæ¸©åº¦', fontsize=14, fontweight='bold')
        plt.grid(True, alpha=0.3)
        plt.legend(fontsize=10)
        plt.tight_layout()
        plt.savefig('cstr_conversion_vs_temp.png', dpi=150, bbox_inches='tight')
        plt.show()

    def conversion_surface(self):
        """æ¸©åº¦ãƒ»æ»ç•™æ™‚é–“ vs è»¢åŒ–ç‡ã®3Dã‚µãƒ¼ãƒ•ã‚§ã‚¹"""
        T_range = np.linspace(50, 300, 50)
        tau_range = np.linspace(30, 180, 50)
        T_grid, tau_grid = np.meshgrid(T_range, tau_range)

        X_A_grid = np.zeros_like(T_grid)
        for i in range(len(T_range)):
            for j in range(len(tau_range)):
                k_val = self.k(T_grid[j, i])
                X_A_grid[j, i] = (k_val * tau_grid[j, i]) / (1 + k_val * tau_grid[j, i])

        fig = plt.figure(figsize=(12, 8))
        ax = fig.add_subplot(111, projection='3d')

        surf = ax.plot_surface(T_grid, tau_grid, X_A_grid * 100, cmap='viridis',
                               alpha=0.9, edgecolor='none')

        # è»¢åŒ–ç‡95%ã®ç­‰å€¤é¢
        contour = ax.contour(T_grid, tau_grid, X_A_grid * 100, levels=[95],
                             colors='red', linewidths=3)

        ax.set_xlabel('æ¸©åº¦ T [Â°C]', fontsize=12, fontweight='bold')
        ax.set_ylabel('æ»ç•™æ™‚é–“ Ï„ [min]', fontsize=12, fontweight='bold')
        ax.set_zlabel('è»¢åŒ–ç‡ X_A [%]', fontsize=12, fontweight='bold')
        ax.set_title('CSTRè»¢åŒ–ç‡ã®3Dè¡¨é¢ãƒ—ãƒ­ãƒƒãƒˆ', fontsize=14, fontweight='bold')

        fig.colorbar(surf, ax=ax, shrink=0.5, aspect=10, label='è»¢åŒ–ç‡ [%]')
        plt.tight_layout()
        plt.savefig('cstr_conversion_3d.png', dpi=150, bbox_inches='tight')
        plt.show()

        print("=" * 60)
        print("CSTRãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«å¯è¦–åŒ–")
        print("=" * 60)
        print("\nè»¢åŒ–ç‡95%ã‚’é”æˆã™ã‚‹é‹è»¢æ¡ä»¶:")
        print("- é«˜æ¸© + çŸ­æ»ç•™æ™‚é–“")
        print("- ä½æ¸© + é•·æ»ç•™æ™‚é–“")
        print("\næœ€é©åŒ–ã§ã¯çµŒæ¸ˆæ€§ã‚‚è€ƒæ…®ã—ã¦æœ€é©ç‚¹ã‚’é¸æŠ")

# å®Ÿè¡Œ
model = CSTRProcessModel()
model.conversion_vs_temperature(tau=60.0)
model.conversion_surface()
</code></pre>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: å¤šå¤‰æ•°æœ€é©åŒ–ã®å®Ÿè¡Œ</h4>

        <pre><code class="language-python">from scipy.optimize import minimize
import numpy as np

class CSTRMultivariableOptimization:
    """
    CSTRå¤šå¤‰æ•°æœ€é©åŒ–ã®å®Ÿè¡Œã¨çµæœè§£é‡ˆ

    æ±ºå®šå¤‰æ•°:
    - T: æ¸©åº¦ [Â°C]
    - Ï„: æ»ç•™æ™‚é–“ [min]
    - C_A0: ä¾›çµ¦æ¿ƒåº¦ [mol/L]
    """

    def __init__(self):
        self.cstr = CSTROptimization()

    def optimize(self):
        """æœ€é©åŒ–ã‚’å®Ÿè¡Œ"""

        # åˆæœŸæ¨å®šå€¤
        x0 = np.array([200.0, 60.0, 3.0])  # [T, tau, C_A0]

        # å¤‰æ•°ã®å¢ƒç•Œ
        bounds = [
            (50.0, 300.0),    # T [Â°C]
            (30.0, 180.0),    # tau [min]
            (1.0, 5.0)        # C_A0 [mol/L]
        ]

        # åˆ¶ç´„æ¡ä»¶
        constraints = self.cstr.constraints(x0)

        print("=" * 60)
        print("CSTRå¤šå¤‰æ•°æœ€é©åŒ–ã®å®Ÿè¡Œ")
        print("=" * 60)
        print(f"\nåˆæœŸæ¨å®šå€¤:")
        print(f"  T   = {x0[0]:.1f} Â°C")
        print(f"  Ï„   = {x0[1]:.1f} min")
        print(f"  C_A0 = {x0[2]:.2f} mol/L")
        print(f"\nåˆæœŸåˆ©ç›Š: Â¥{-self.cstr.profit(x0):,.0f}/h")

        # SLSQPæ³•ã§æœ€é©åŒ–
        result = minimize(
            self.cstr.profit,
            x0,
            method='SLSQP',
            bounds=bounds,
            constraints=constraints,
            options={'disp': True, 'maxiter': 100}
        )

        # çµæœã®è§£é‡ˆ
        self.interpret_results(result)

        return result

    def interpret_results(self, result):
        """æœ€é©åŒ–çµæœã®è§£é‡ˆã¨å‡ºåŠ›"""

        print("\n" + "=" * 60)
        print("æœ€é©åŒ–çµæœ")
        print("=" * 60)

        if result.success:
            print("\nâœ“ æœ€é©åŒ–æˆåŠŸï¼")
        else:
            print("\nâœ— æœ€é©åŒ–å¤±æ•—")
            print(f"ç†ç”±: {result.message}")
            return

        T_opt, tau_opt, C_A0_opt = result.x
        profit_opt = -result.fun
        X_A_opt = self.cstr.conversion(T_opt, tau_opt)
        V = 1000.0
        F_opt = V / tau_opt

        print(f"\nã€æœ€é©é‹è»¢æ¡ä»¶ã€‘")
        print(f"  æ¸©åº¦ T*        : {T_opt:.2f} Â°C")
        print(f"  æ»ç•™æ™‚é–“ Ï„*    : {tau_opt:.2f} min")
        print(f"  ä¾›çµ¦æ¿ƒåº¦ C_A0* : {C_A0_opt:.3f} mol/L")
        print(f"  æµé‡ F*        : {F_opt:.2f} L/h")

        print(f"\nã€ãƒ—ãƒ­ã‚»ã‚¹æ€§èƒ½ã€‘")
        print(f"  è»¢åŒ–ç‡ X_A     : {X_A_opt:.4f} ({X_A_opt*100:.2f}%)")
        print(f"  æœ€å¤§åˆ©ç›Š       : Â¥{profit_opt:,.0f}/h")

        # å¹´é–“åˆ©ç›Šæ›ç®—
        annual_profit = profit_opt * 24 * 365
        print(f"  å¹´é–“åˆ©ç›Šæ›ç®—   : Â¥{annual_profit:,.0f}/year")

        # åˆ¶ç´„æ¡ä»¶ã®ãƒãƒ¼ã‚¸ãƒ³ç¢ºèª
        print(f"\nã€åˆ¶ç´„æ¡ä»¶ãƒãƒ¼ã‚¸ãƒ³ã€‘")
        print(f"  æ¸©åº¦åˆ¶ç´„   : T* = {T_opt:.1f}Â°C â‰¤ {self.cstr.T_max}Â°C (ãƒãƒ¼ã‚¸ãƒ³: {self.cstr.T_max - T_opt:.1f}Â°C)")
        print(f"  è»¢åŒ–ç‡åˆ¶ç´„ : X_A* = {X_A_opt:.3f} â‰¥ {self.cstr.X_min} (ãƒãƒ¼ã‚¸ãƒ³: {X_A_opt - self.cstr.X_min:.4f})")
        print(f"  æµé‡åˆ¶ç´„   : F* = {F_opt:.1f} L/h âˆˆ [{self.cstr.F_min}, {self.cstr.F_max}]")

        # åå¾©å›æ•°
        print(f"\nã€æœ€é©åŒ–çµ±è¨ˆã€‘")
        print(f"  åå¾©å›æ•°       : {result.nit}")
        print(f"  é–¢æ•°è©•ä¾¡å›æ•°   : {result.nfev}")

# å®Ÿè¡Œ
optimizer = CSTRMultivariableOptimization()
result_optimal = optimizer.optimize()
</code></pre>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: åŒ…æ‹¬çš„ãªåˆ¶ç´„æ¡ä»¶ã®å®Ÿè£…</h4>

        <pre><code class="language-python">import numpy as np
from scipy.optimize import minimize

class CSTRComprehensiveConstraints:
    """
    åŒ…æ‹¬çš„ãªåˆ¶ç´„æ¡ä»¶ã‚’æŒã¤CSTRæœ€é©åŒ–

    åˆ¶ç´„:
    1. å®‰å…¨åˆ¶ç´„: æ¸©åº¦ä¸Šé™ã€åœ§åŠ›ä¸Šé™
    2. ç´”åº¦åˆ¶ç´„: è£½å“ç´”åº¦ã€è»¢åŒ–ç‡
    3. æµé‡åˆ¶ç´„: æœ€å°ãƒ»æœ€å¤§æµé‡
    4. ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ¶ç´„: å†·å´èƒ½åŠ›
    5. ç’°å¢ƒåˆ¶ç´„: æ’å‡ºåŸºæº–
    """

    def __init__(self):
        self.cstr = CSTROptimization()

        # è¿½åŠ åˆ¶ç´„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.Q_cooling_max = 500000.0  # æœ€å¤§å†·å´èƒ½åŠ› [J/h]
        self.emission_limit = 10.0     # CO2æ’å‡ºä¸Šé™ [kg/h]
        self.purity_min = 0.98         # è£½å“ç´”åº¦ä¸‹é™ [-]

    def comprehensive_constraints(self, x):
        """åŒ…æ‹¬çš„ãªåˆ¶ç´„æ¡ä»¶"""
        T, tau, C_A0 = x
        V = 1000.0
        F = V / tau
        X_A = self.cstr.conversion(T, tau)

        # ç”Ÿç”£é€Ÿåº¦
        production_rate_B = F * C_A0 * X_A

        # åå¿œç†±
        Q_reaction = abs(self.cstr.delta_H) * production_rate_B

        # CO2æ’å‡ºé‡ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ä½¿ç”¨ã«æ¯”ä¾‹ã™ã‚‹ã¨ä»®å®šï¼‰
        CO2_emission = (Q_reaction / 3.6e6) * 0.5  # [kg/h]ï¼ˆä»®å®š: 0.5 kg-CO2/kWhï¼‰

        # è£½å“ç´”åº¦ï¼ˆç°¡ç•¥åŒ–: è»¢åŒ–ç‡ã«æ¯”ä¾‹ï¼‰
        purity = 0.90 + 0.10 * X_A  # X_A=1.0ã§ç´”åº¦100%

        constraints = [
            # æ—¢å­˜ã®åˆ¶ç´„
            {'type': 'ineq', 'fun': lambda x: self.cstr.T_max - x[0]},
            {'type': 'ineq', 'fun': lambda x: self.cstr.conversion(x[0], x[1]) - self.cstr.X_min},
            {'type': 'ineq', 'fun': lambda x: V / x[1] - self.cstr.F_min},
            {'type': 'ineq', 'fun': lambda x: self.cstr.F_max - V / x[1]},

            # è¿½åŠ åˆ¶ç´„
            {'type': 'ineq', 'fun': lambda x: self.Q_cooling_max - abs(self.cstr.delta_H) * V / x[1] * x[2] * self.cstr.conversion(x[0], x[1])},  # å†·å´èƒ½åŠ›
            {'type': 'ineq', 'fun': lambda x: self.emission_limit - (abs(self.cstr.delta_H) * V / x[1] * x[2] * self.cstr.conversion(x[0], x[1])) / 3.6e6 * 0.5},  # CO2æ’å‡º
            {'type': 'ineq', 'fun': lambda x: (0.90 + 0.10 * self.cstr.conversion(x[0], x[1])) - self.purity_min}  # è£½å“ç´”åº¦
        ]

        return constraints

    def optimize_with_comprehensive_constraints(self):
        """åŒ…æ‹¬çš„åˆ¶ç´„ä¸‹ã§ã®æœ€é©åŒ–"""

        x0 = np.array([200.0, 60.0, 3.0])
        bounds = [(50.0, 300.0), (30.0, 180.0), (1.0, 5.0)]

        constraints = self.comprehensive_constraints(x0)

        print("=" * 60)
        print("åŒ…æ‹¬çš„åˆ¶ç´„æ¡ä»¶ä¸‹ã§ã®CSTRæœ€é©åŒ–")
        print("=" * 60)
        print("\nåˆ¶ç´„æ¡ä»¶:")
        print("  1. å®‰å…¨åˆ¶ç´„: T â‰¤ 350Â°C")
        print("  2. è»¢åŒ–ç‡åˆ¶ç´„: X_A â‰¥ 0.95")
        print("  3. æµé‡åˆ¶ç´„: 100 â‰¤ F â‰¤ 400 L/h")
        print("  4. å†·å´èƒ½åŠ›åˆ¶ç´„: Q_reaction â‰¤ 500,000 J/h")
        print("  5. ç’°å¢ƒåˆ¶ç´„: CO2æ’å‡º â‰¤ 10 kg/h")
        print("  6. ç´”åº¦åˆ¶ç´„: è£½å“ç´”åº¦ â‰¥ 0.98")

        result = minimize(
            self.cstr.profit,
            x0,
            method='SLSQP',
            bounds=bounds,
            constraints=constraints,
            options={'maxiter': 200}
        )

        if result.success:
            T_opt, tau_opt, C_A0_opt = result.x
            profit_opt = -result.fun
            X_A_opt = self.cstr.conversion(T_opt, tau_opt)
            purity_opt = 0.90 + 0.10 * X_A_opt
            V = 1000.0
            F_opt = V / tau_opt
            Q_reaction = abs(self.cstr.delta_H) * F_opt * C_A0_opt * X_A_opt
            CO2 = (Q_reaction / 3.6e6) * 0.5

            print(f"\nâœ“ æœ€é©åŒ–æˆåŠŸ")
            print(f"\nã€æœ€é©é‹è»¢æ¡ä»¶ã€‘")
            print(f"  æ¸©åº¦: {T_opt:.2f}Â°C, æ»ç•™æ™‚é–“: {tau_opt:.2f}min, ä¾›çµ¦æ¿ƒåº¦: {C_A0_opt:.3f}mol/L")
            print(f"\nã€æ€§èƒ½æŒ‡æ¨™ã€‘")
            print(f"  åˆ©ç›Š: Â¥{profit_opt:,.0f}/h")
            print(f"  è»¢åŒ–ç‡: {X_A_opt*100:.2f}%")
            print(f"  è£½å“ç´”åº¦: {purity_opt*100:.2f}%")
            print(f"  CO2æ’å‡º: {CO2:.2f} kg/h")
            print(f"  å†·å´è² è·: {Q_reaction:,.0f} J/h ({Q_reaction/self.Q_cooling_max*100:.1f}% of max)")
        else:
            print(f"\nâœ— æœ€é©åŒ–å¤±æ•—: {result.message}")

        return result

# å®Ÿè¡Œ
comprehensive_opt = CSTRComprehensiveConstraints()
result_comp = comprehensive_opt.optimize_with_comprehensive_constraints()
</code></pre>

        <h2 id="sensitivity">5.3 æ„Ÿåº¦åˆ†æã¨ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–</h2>

        <p>å®Ÿãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆåŸæ–™ä¾¡æ ¼ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆç­‰ï¼‰ãŒå¤‰å‹•ã—ã¾ã™ã€‚æ„Ÿåº¦åˆ†æã«ã‚ˆã‚Šã€æœ€é©è§£ãŒã“ã‚Œã‚‰ã®å¤‰å‹•ã«å¯¾ã—ã¦ã©ã®ç¨‹åº¦é ‘å¥ã‹ã‚’è©•ä¾¡ã—ã¾ã™ã€‚</p>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: æœ€é©åŒ–å®Ÿè¡Œã¨çµæœè§£é‡ˆ</h4>

        <p>ï¼ˆã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã‚³ãƒ¼ãƒ‰ä¾‹3ã§æ—¢ã«å®Ÿè£…æ¸ˆã¿ï¼‰</p>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: æ„Ÿåº¦åˆ†æï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ‘‚å‹•ï¼‰</h4>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

class SensitivityAnalysis:
    """
    æœ€é©è§£ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ„Ÿåº¦åˆ†æ

    åˆ†æå¯¾è±¡:
    - åŸæ–™ä¾¡æ ¼ã®å¤‰å‹•ï¼ˆÂ±10%ï¼‰
    - ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã®å¤‰å‹•ï¼ˆÂ±20%ï¼‰
    - åå¿œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ä¸ç¢ºå®Ÿæ€§ï¼ˆÂ±15%ï¼‰
    """

    def __init__(self):
        self.cstr = CSTROptimization()
        self.base_price_A = self.cstr.price_A
        self.base_energy_cost = self.cstr.energy_cost
        self.base_k0 = self.cstr.k0

    def sensitivity_raw_material_price(self, optimal_x):
        """åŸæ–™ä¾¡æ ¼ã®æ„Ÿåº¦åˆ†æ"""

        # ä¾¡æ ¼å¤‰å‹•ç¯„å›²: Â±10%
        price_variation = np.linspace(0.90, 1.10, 21)
        profits = []

        for factor in price_variation:
            self.cstr.price_A = self.base_price_A * factor
            profit = -self.cstr.profit(optimal_x)
            profits.append(profit)

        # ãƒªã‚»ãƒƒãƒˆ
        self.cstr.price_A = self.base_price_A

        return price_variation, profits

    def sensitivity_energy_cost(self, optimal_x):
        """ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã®æ„Ÿåº¦åˆ†æ"""

        # ã‚³ã‚¹ãƒˆå¤‰å‹•ç¯„å›²: Â±20%
        cost_variation = np.linspace(0.80, 1.20, 21)
        profits = []

        for factor in cost_variation:
            self.cstr.energy_cost = self.base_energy_cost * factor
            profit = -self.cstr.profit(optimal_x)
            profits.append(profit)

        # ãƒªã‚»ãƒƒãƒˆ
        self.cstr.energy_cost = self.base_energy_cost

        return cost_variation, profits

    def sensitivity_reaction_rate(self, optimal_x):
        """åå¿œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ„Ÿåº¦åˆ†æ"""

        # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰å‹•ç¯„å›²: Â±15%
        k0_variation = np.linspace(0.85, 1.15, 21)
        profits = []
        conversions = []

        for factor in k0_variation:
            self.cstr.k0 = self.base_k0 * factor
            profit = -self.cstr.profit(optimal_x)
            X_A = self.cstr.conversion(optimal_x[0], optimal_x[1])
            profits.append(profit)
            conversions.append(X_A)

        # ãƒªã‚»ãƒƒãƒˆ
        self.cstr.k0 = self.base_k0

        return k0_variation, profits, conversions

    def run_sensitivity_analysis(self):
        """æ„Ÿåº¦åˆ†æã®å®Ÿè¡Œã¨å¯è¦–åŒ–"""

        # ã¾ãšæœ€é©åŒ–ã‚’å®Ÿè¡Œã—ã¦æœ€é©è§£ã‚’å–å¾—
        optimizer = CSTRMultivariableOptimization()
        result = optimizer.optimize()

        if not result.success:
            print("æœ€é©åŒ–å¤±æ•—ã®ãŸã‚æ„Ÿåº¦åˆ†æã‚’å®Ÿè¡Œã§ãã¾ã›ã‚“")
            return

        optimal_x = result.x
        base_profit = -result.fun

        print("\n" + "=" * 60)
        print("æ„Ÿåº¦åˆ†æ")
        print("=" * 60)
        print(f"\nãƒ™ãƒ¼ã‚¹æœ€é©è§£: T={optimal_x[0]:.1f}Â°C, Ï„={optimal_x[1]:.1f}min, C_A0={optimal_x[2]:.2f}mol/L")
        print(f"ãƒ™ãƒ¼ã‚¹åˆ©ç›Š: Â¥{base_profit:,.0f}/h")

        # å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ„Ÿåº¦åˆ†æ
        price_var, price_profits = self.sensitivity_raw_material_price(optimal_x)
        energy_var, energy_profits = self.sensitivity_energy_cost(optimal_x)
        k0_var, k0_profits, k0_conversions = self.sensitivity_reaction_rate(optimal_x)

        # å¯è¦–åŒ–
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))

        # 1. åŸæ–™ä¾¡æ ¼æ„Ÿåº¦
        ax1 = axes[0, 0]
        ax1.plot((price_var - 1) * 100, price_profits, 'b-', linewidth=2, marker='o', markersize=4)
        ax1.axhline(y=base_profit, color='r', linestyle='--', linewidth=1.5, label='ãƒ™ãƒ¼ã‚¹åˆ©ç›Š')
        ax1.axvline(x=0, color='gray', linestyle=':', linewidth=1)
        ax1.set_xlabel('åŸæ–™ä¾¡æ ¼å¤‰å‹• [%]', fontsize=11, fontweight='bold')
        ax1.set_ylabel('åˆ©ç›Š [Â¥/h]', fontsize=11, fontweight='bold')
        ax1.set_title('åŸæ–™ä¾¡æ ¼ã®æ„Ÿåº¦åˆ†æ', fontsize=12, fontweight='bold')
        ax1.grid(True, alpha=0.3)
        ax1.legend()

        # 2. ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆæ„Ÿåº¦
        ax2 = axes[0, 1]
        ax2.plot((energy_var - 1) * 100, energy_profits, 'g-', linewidth=2, marker='s', markersize=4)
        ax2.axhline(y=base_profit, color='r', linestyle='--', linewidth=1.5, label='ãƒ™ãƒ¼ã‚¹åˆ©ç›Š')
        ax2.axvline(x=0, color='gray', linestyle=':', linewidth=1)
        ax2.set_xlabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆå¤‰å‹• [%]', fontsize=11, fontweight='bold')
        ax2.set_ylabel('åˆ©ç›Š [Â¥/h]', fontsize=11, fontweight='bold')
        ax2.set_title('ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã®æ„Ÿåº¦åˆ†æ', fontsize=12, fontweight='bold')
        ax2.grid(True, alpha=0.3)
        ax2.legend()

        # 3. åå¿œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ„Ÿåº¦ï¼ˆåˆ©ç›Šï¼‰
        ax3 = axes[1, 0]
        ax3.plot((k0_var - 1) * 100, k0_profits, 'm-', linewidth=2, marker='^', markersize=4)
        ax3.axhline(y=base_profit, color='r', linestyle='--', linewidth=1.5, label='ãƒ™ãƒ¼ã‚¹åˆ©ç›Š')
        ax3.axvline(x=0, color='gray', linestyle=':', linewidth=1)
        ax3.set_xlabel('åå¿œé€Ÿåº¦å®šæ•°k0å¤‰å‹• [%]', fontsize=11, fontweight='bold')
        ax3.set_ylabel('åˆ©ç›Š [Â¥/h]', fontsize=11, fontweight='bold')
        ax3.set_title('åå¿œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ„Ÿåº¦ï¼ˆåˆ©ç›Šï¼‰', fontsize=12, fontweight='bold')
        ax3.grid(True, alpha=0.3)
        ax3.legend()

        # 4. åå¿œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ„Ÿåº¦ï¼ˆè»¢åŒ–ç‡ï¼‰
        ax4 = axes[1, 1]
        ax4.plot((k0_var - 1) * 100, np.array(k0_conversions) * 100, 'c-', linewidth=2, marker='d', markersize=4)
        ax4.axhline(y=95, color='r', linestyle='--', linewidth=1.5, label='æœ€å°è»¢åŒ–ç‡ 95%')
        ax4.axvline(x=0, color='gray', linestyle=':', linewidth=1)
        ax4.set_xlabel('åå¿œé€Ÿåº¦å®šæ•°k0å¤‰å‹• [%]', fontsize=11, fontweight='bold')
        ax4.set_ylabel('è»¢åŒ–ç‡ [%]', fontsize=11, fontweight='bold')
        ax4.set_title('åå¿œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ„Ÿåº¦ï¼ˆè»¢åŒ–ç‡ï¼‰', fontsize=12, fontweight='bold')
        ax4.grid(True, alpha=0.3)
        ax4.legend()

        plt.tight_layout()
        plt.savefig('cstr_sensitivity_analysis.png', dpi=150, bbox_inches='tight')
        plt.show()

        # æ„Ÿåº¦ä¿‚æ•°ã®è¨ˆç®—
        print("\nã€æ„Ÿåº¦ä¿‚æ•°ã€‘ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿1%å¤‰å‹•ã‚ãŸã‚Šã®åˆ©ç›Šå¤‰å‹•ï¼‰")

        # åŸæ–™ä¾¡æ ¼æ„Ÿåº¦
        d_profit_price = (price_profits[11] - price_profits[9]) / (2 * 0.01 * base_profit)
        print(f"  åŸæ–™ä¾¡æ ¼: {d_profit_price:.3f} (1%ä¸Šæ˜‡ â†’ åˆ©ç›Š{abs(d_profit_price):.2f}%æ¸›å°‘)")

        # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆæ„Ÿåº¦
        d_profit_energy = (energy_profits[11] - energy_profits[9]) / (2 * 0.01 * base_profit)
        print(f"  ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ: {d_profit_energy:.3f} (1%ä¸Šæ˜‡ â†’ åˆ©ç›Š{abs(d_profit_energy):.2f}%æ¸›å°‘)")

        # åå¿œé€Ÿåº¦æ„Ÿåº¦
        d_profit_k0 = (k0_profits[11] - k0_profits[9]) / (2 * 0.01 * base_profit)
        print(f"  åå¿œé€Ÿåº¦å®šæ•°: {d_profit_k0:.3f} (1%ä¸Šæ˜‡ â†’ åˆ©ç›Š{d_profit_k0:.2f}%å¢—åŠ )")

        print("\nçµè«–:")
        print("  - æœ€ã‚‚å½±éŸ¿ãŒå¤§ãã„ã®ã¯åŸæ–™ä¾¡æ ¼")
        print("  - ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã®å½±éŸ¿ã¯æ¯”è¼ƒçš„å°ã•ã„")
        print("  - åå¿œé€Ÿåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ä¸ç¢ºå®Ÿæ€§ã«æ³¨æ„ãŒå¿…è¦")

# å®Ÿè¡Œ
sensitivity = SensitivityAnalysis()
sensitivity.run_sensitivity_analysis()
</code></pre>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–ï¼ˆä¸ç¢ºå®Ÿæ€§ä¸‹ã§ã®æœ€é©åŒ–ï¼‰</h4>

        <pre><code class="language-python">import numpy as np
from scipy.optimize import minimize
import matplotlib.pyplot as plt

class RobustOptimization:
    """
    ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–: ä¸ç¢ºå®Ÿæ€§ä¸‹ã§ã®æœ€é©åŒ–

    ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:
    - ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æœ€é©åŒ–
    - æœŸå¾…å€¤æœ€é©åŒ–ï¼ˆãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æ³•ï¼‰
    - ç¢ºç‡çš„åˆ¶ç´„ã®æ‰±ã„
    """

    def __init__(self, n_samples=100):
        self.cstr = CSTROptimization()
        self.n_samples = n_samples

        # ä¸ç¢ºå®Ÿæ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆæ¨™æº–åå·®ï¼‰
        self.sigma_price_A = 0.05 * self.cstr.price_A      # åŸæ–™ä¾¡æ ¼ã®ä¸ç¢ºå®Ÿæ€§ Â±5%
        self.sigma_energy = 0.10 * self.cstr.energy_cost   # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã®ä¸ç¢ºå®Ÿæ€§ Â±10%
        self.sigma_k0 = 0.10 * self.cstr.k0                # åå¿œé€Ÿåº¦ã®ä¸ç¢ºå®Ÿæ€§ Â±10%

    def expected_profit(self, x):
        """
        æœŸå¾…åˆ©ç›Šï¼ˆãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æ³•ï¼‰

        Parameters:
        -----------
        x : array_like
            [T, tau, C_A0]

        Returns:
        --------
        expected_profit : float
            æœŸå¾…åˆ©ç›Šã®è² å€¤ï¼ˆæœ€å°åŒ–ã®ãŸã‚ï¼‰
        """
        np.random.seed(42)  # å†ç¾æ€§ã®ãŸã‚

        profits = []

        for _ in range(self.n_samples):
            # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ï¼ˆæ­£è¦åˆ†å¸ƒï¼‰
            price_A_sample = np.random.normal(self.cstr.price_A, self.sigma_price_A)
            energy_cost_sample = np.random.normal(self.cstr.energy_cost, self.sigma_energy)
            k0_sample = np.random.normal(self.cstr.k0, self.sigma_k0)

            # ä¸€æ™‚çš„ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°
            original_price_A = self.cstr.price_A
            original_energy_cost = self.cstr.energy_cost
            original_k0 = self.cstr.k0

            self.cstr.price_A = max(0, price_A_sample)
            self.cstr.energy_cost = max(0, energy_cost_sample)
            self.cstr.k0 = max(0, k0_sample)

            # åˆ©ç›Šã‚’è¨ˆç®—
            profit = -self.cstr.profit(x)
            profits.append(profit)

            # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ
            self.cstr.price_A = original_price_A
            self.cstr.energy_cost = original_energy_cost
            self.cstr.k0 = original_k0

        # æœŸå¾…å€¤ã‚’è¨ˆç®—
        expected_profit_value = np.mean(profits)

        return -expected_profit_value  # æœ€å°åŒ–ã®ãŸã‚è² å€¤

    def worst_case_profit(self, x):
        """
        ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹åˆ©ç›Š

        ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæœ€æ‚ªã®çµ„ã¿åˆã‚ã›ï¼ˆåˆ©ç›Šæœ€å°ï¼‰ã¨ãªã‚‹å ´åˆã‚’æƒ³å®š
        """
        # ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: åŸæ–™ä¾¡æ ¼â†‘ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆâ†‘ã€åå¿œé€Ÿåº¦â†“
        original_price_A = self.cstr.price_A
        original_energy_cost = self.cstr.energy_cost
        original_k0 = self.cstr.k0

        self.cstr.price_A = self.cstr.price_A + 2 * self.sigma_price_A
        self.cstr.energy_cost = self.cstr.energy_cost + 2 * self.sigma_energy
        self.cstr.k0 = self.cstr.k0 - 2 * self.sigma_k0

        profit_worst = -self.cstr.profit(x)

        # ãƒªã‚»ãƒƒãƒˆ
        self.cstr.price_A = original_price_A
        self.cstr.energy_cost = original_energy_cost
        self.cstr.k0 = original_k0

        return -profit_worst  # æœ€å°åŒ–ã®ãŸã‚è² å€¤

    def optimize_robust(self, method='expected'):
        """
        ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–ã®å®Ÿè¡Œ

        Parameters:
        -----------
        method : str
            'expected' or 'worst_case'
        """

        x0 = np.array([200.0, 60.0, 3.0])
        bounds = [(50.0, 300.0), (30.0, 180.0), (1.0, 5.0)]

        constraints = self.cstr.constraints(x0)

        print("=" * 60)
        print(f"ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–: {method}æ³•")
        print("=" * 60)
        print(f"\nä¸ç¢ºå®Ÿæ€§:")
        print(f"  åŸæ–™ä¾¡æ ¼: Â±{self.sigma_price_A/self.cstr.price_A*100:.1f}%")
        print(f"  ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ: Â±{self.sigma_energy/self.cstr.energy_cost*100:.1f}%")
        print(f"  åå¿œé€Ÿåº¦å®šæ•°: Â±{self.sigma_k0/self.cstr.k0*100:.1f}%")

        if method == 'expected':
            objective = self.expected_profit
            print(f"\nç›®çš„: æœŸå¾…åˆ©ç›Šã‚’æœ€å¤§åŒ–ï¼ˆãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã‚µãƒ³ãƒ—ãƒ«æ•°: {self.n_samples}ï¼‰")
        elif method == 'worst_case':
            objective = self.worst_case_profit
            print(f"\nç›®çš„: ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹åˆ©ç›Šã‚’æœ€å¤§åŒ–")
        else:
            raise ValueError("method must be 'expected' or 'worst_case'")

        result = minimize(
            objective,
            x0,
            method='SLSQP',
            bounds=bounds,
            constraints=constraints,
            options={'maxiter': 100}
        )

        if result.success:
            T_opt, tau_opt, C_A0_opt = result.x

            # å„ç¨®ã‚·ãƒŠãƒªã‚ªã§ã®åˆ©ç›Šã‚’è©•ä¾¡
            profit_nominal = -self.cstr.profit(result.x)
            profit_expected = -self.expected_profit(result.x)
            profit_worst = -self.worst_case_profit(result.x)

            print(f"\nâœ“ ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–æˆåŠŸ")
            print(f"\nã€ãƒ­ãƒã‚¹ãƒˆæœ€é©é‹è»¢æ¡ä»¶ã€‘")
            print(f"  æ¸©åº¦: {T_opt:.2f}Â°C")
            print(f"  æ»ç•™æ™‚é–“: {tau_opt:.2f}min")
            print(f"  ä¾›çµ¦æ¿ƒåº¦: {C_A0_opt:.3f}mol/L")

            print(f"\nã€å„ã‚·ãƒŠãƒªã‚ªã§ã®åˆ©ç›Šã€‘")
            print(f"  ãƒãƒŸãƒŠãƒ«ã‚±ãƒ¼ã‚¹: Â¥{profit_nominal:,.0f}/h")
            print(f"  æœŸå¾…å€¤: Â¥{profit_expected:,.0f}/h")
            print(f"  ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹: Â¥{profit_worst:,.0f}/h")

            profit_range = profit_nominal - profit_worst
            print(f"\n  åˆ©ç›Šå¤‰å‹•å¹…: Â¥{profit_range:,.0f}/h ({profit_range/profit_nominal*100:.1f}%)")
        else:
            print(f"\nâœ— æœ€é©åŒ–å¤±æ•—: {result.message}")

        return result

    def compare_robust_strategies(self):
        """ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–æˆ¦ç•¥ã®æ¯”è¼ƒ"""

        print("\n" + "=" * 60)
        print("ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–æˆ¦ç•¥ã®æ¯”è¼ƒ")
        print("=" * 60)

        # é€šå¸¸ã®æœ€é©åŒ–ï¼ˆä¸ç¢ºå®Ÿæ€§ã‚’è€ƒæ…®ã—ãªã„ï¼‰
        optimizer_nominal = CSTRMultivariableOptimization()
        result_nominal = optimizer_nominal.optimize()

        # æœŸå¾…å€¤ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–
        result_expected = self.optimize_robust(method='expected')

        # ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–
        result_worst = self.optimize_robust(method='worst_case')

        # æ¯”è¼ƒè¡¨ã‚’ä½œæˆ
        strategies = ['é€šå¸¸æœ€é©åŒ–', 'æœŸå¾…å€¤ãƒ­ãƒã‚¹ãƒˆ', 'ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãƒ­ãƒã‚¹ãƒˆ']
        results = [result_nominal, result_expected, result_worst]

        comparison_data = []
        for strategy, result in zip(strategies, results):
            if result.success:
                T, tau, C_A0 = result.x
                profit_nom = -self.cstr.profit(result.x)
                profit_exp = -self.expected_profit(result.x)
                profit_worst = -self.worst_case_profit(result.x)

                comparison_data.append({
                    'æˆ¦ç•¥': strategy,
                    'T [Â°C]': f"{T:.1f}",
                    'Ï„ [min]': f"{tau:.1f}",
                    'C_A0 [mol/L]': f"{C_A0:.2f}",
                    'ãƒãƒŸãƒŠãƒ«åˆ©ç›Š [Â¥/h]': f"{profit_nom:,.0f}",
                    'æœŸå¾…åˆ©ç›Š [Â¥/h]': f"{profit_exp:,.0f}",
                    'ãƒ¯ãƒ¼ã‚¹ãƒˆåˆ©ç›Š [Â¥/h]': f"{profit_worst:,.0f}"
                })

        df_comparison = pd.DataFrame(comparison_data)
        print("\n")
        print(df_comparison.to_string(index=False))

        print("\nã€æ¨å¥¨ã€‘")
        print("  - å®‰å®šé‹è»¢ã‚’é‡è¦–: ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–")
        print("  - å¹³å‡åˆ©ç›Šã‚’é‡è¦–: æœŸå¾…å€¤ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–")
        print("  - ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæ­£ç¢º: é€šå¸¸æœ€é©åŒ–")

# å®Ÿè¡Œ
robust_opt = RobustOptimization(n_samples=100)
robust_opt.compare_robust_strategies()
</code></pre>

        <h2 id="real-time">5.4 å®Ÿæ™‚é–“æœ€é©åŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</h2>

        <p>å®Ÿæ™‚é–“æœ€é©åŒ–ï¼ˆReal-Time Optimization, RTOï¼‰ã¯ã€ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§å–å¾—ã•ã‚Œã‚‹ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°ã—ã€å®šæœŸçš„ã«æœ€é©åŒ–ã‚’å†å®Ÿè¡Œã™ã‚‹é©å¿œçš„ãªæœ€é©åŒ–æ‰‹æ³•ã§ã™ã€‚</p>

        <pre><code class="language-mermaid">flowchart LR
    A[ãƒ—ãƒ­ã‚»ã‚¹é‹è»¢] -->|æ¸¬å®šãƒ‡ãƒ¼ã‚¿| B[ãƒ‡ãƒ¼ã‚¿åé›†]
    B --> C[ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°]
    C --> D[æœ€é©åŒ–å®Ÿè¡Œ]
    D --> E[æœ€é©é‹è»¢æ¡ä»¶]
    E -->|åˆ¶å¾¡æŒ‡ä»¤| A

    D --> F{ç›®æ¨™é”æˆ?}
    F -->|No| G[ãƒ¢ãƒ‡ãƒ«å†è©•ä¾¡]
    G --> C
    F -->|Yes| H[æ¬¡ã®ã‚µã‚¤ã‚¯ãƒ«ã¸]
    H --> B

    style A fill:#e8f5e9
    style D fill:#fff9c4
    style E fill:#ffe0b2
    style C fill:#f8bbd0
</code></pre>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹8: å®Ÿæ™‚é–“æœ€é©åŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</h4>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize
import time

class RealTimeOptimization:
    """
    å®Ÿæ™‚é–“æœ€é©åŒ–ï¼ˆRTOï¼‰ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

    æ©Ÿèƒ½:
    1. ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿å–å¾—
    2. ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°
    3. æœ€é©åŒ–å†å®Ÿè¡Œ
    4. åˆ¶å¾¡æŒ‡ä»¤ç”Ÿæˆ
    """

    def __init__(self):
        self.cstr = CSTROptimization()

        # RTOãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.update_interval = 60  # æ›´æ–°é–“éš” [min]
        self.n_iterations = 10     # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³åå¾©å›æ•°

        # ãƒ‡ãƒ¼ã‚¿å±¥æ­´
        self.time_history = []
        self.profit_history = []
        self.T_history = []
        self.tau_history = []
        self.C_A0_history = []
        self.X_A_history = []

        # ç¾åœ¨ã®é‹è»¢æ¡ä»¶
        self.current_x = np.array([200.0, 60.0, 3.0])

    def simulate_online_data(self, iteration):
        """
        ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ

        å®Ÿãƒ—ãƒ­ã‚»ã‚¹ã§ã¯:
        - DCSï¼ˆåˆ†æ•£åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ï¼‰ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
        - ã‚»ãƒ³ã‚µãƒ¼æ¸¬å®šå€¤ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        - ç•°å¸¸å€¤ã®æ¤œå‡ºã¨é™¤å»
        """
        # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ•ãƒˆã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
        # å®Ÿéš›ã«ã¯çµŒå¹´åŠ£åŒ–ã€è§¦åª’æ´»æ€§ä½ä¸‹ç­‰ã§åå¿œé€Ÿåº¦ãŒå¤‰åŒ–
        k0_drift = 1.0 - 0.05 * (iteration / self.n_iterations)  # 5%ã®åŠ£åŒ–

        # ãƒã‚¤ã‚ºã‚’è¿½åŠ ï¼ˆæ¸¬å®šèª¤å·®ï¼‰
        noise = np.random.normal(0, 0.02)
        k0_measured = self.cstr.k0 * k0_drift * (1 + noise)

        return {'k0': k0_measured, 'drift_factor': k0_drift}

    def update_model_parameters(self, online_data):
        """
        ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°

        å®Ÿè£…:
        - ç§»å‹•çª“æ¨å®šï¼ˆMoving Horizon Estimation, MHEï¼‰
        - å†å¸°æœ€å°äºŒä¹—æ³•ï¼ˆRecursive Least Squares, RLSï¼‰
        - ã‚«ãƒ«ãƒãƒ³ãƒ•ã‚£ãƒ«ã‚¿
        """
        # ç°¡ç•¥åŒ–: æ¸¬å®šå€¤ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç›´æ¥æ›´æ–°
        self.cstr.k0 = online_data['k0']

        print(f"  ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°: k0 = {self.cstr.k0:.3e} (åŠ£åŒ–ç‡: {(1-online_data['drift_factor'])*100:.1f}%)")

    def optimize_current_conditions(self):
        """ç¾åœ¨ã®æ¡ä»¶ã§æœ€é©åŒ–ã‚’å®Ÿè¡Œ"""

        x0 = self.current_x
        bounds = [(50.0, 300.0), (30.0, 180.0), (1.0, 5.0)]
        constraints = self.cstr.constraints(x0)

        result = minimize(
            self.cstr.profit,
            x0,
            method='SLSQP',
            bounds=bounds,
            constraints=constraints,
            options={'maxiter': 50}
        )

        if result.success:
            return result.x
        else:
            print(f"  è­¦å‘Š: æœ€é©åŒ–å¤±æ•— ({result.message}), å‰å›ã®æ¡ä»¶ã‚’ç¶­æŒ")
            return self.current_x

    def run_rto_cycle(self, iteration):
        """RTOã‚µã‚¤ã‚¯ãƒ«ã‚’1å›å®Ÿè¡Œ"""

        print(f"\n--- RTO Cycle {iteration+1}/{self.n_iterations} (æ™‚åˆ»: {iteration*self.update_interval}åˆ†) ---")

        # ã‚¹ãƒ†ãƒƒãƒ—1: ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿å–å¾—
        online_data = self.simulate_online_data(iteration)

        # ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ¢ãƒ‡ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°
        self.update_model_parameters(online_data)

        # ã‚¹ãƒ†ãƒƒãƒ—3: æœ€é©åŒ–å®Ÿè¡Œ
        optimal_x = self.optimize_current_conditions()

        # ã‚¹ãƒ†ãƒƒãƒ—4: åˆ¶å¾¡æŒ‡ä»¤ç”Ÿæˆï¼ˆå®Ÿè£…ã§ã¯å¾ã€…ã«ç§»è¡Œï¼‰
        # å®Ÿéš›ã«ã¯MPCã‚„PIDã§ç·©ã‚„ã‹ã«è¨­å®šå€¤å¤‰æ›´
        self.current_x = optimal_x

        # ã‚¹ãƒ†ãƒƒãƒ—5: æ€§èƒ½è©•ä¾¡
        profit = -self.cstr.profit(optimal_x)
        X_A = self.cstr.conversion(optimal_x[0], optimal_x[1])

        print(f"  æœ€é©é‹è»¢æ¡ä»¶: T={optimal_x[0]:.1f}Â°C, Ï„={optimal_x[1]:.1f}min, C_A0={optimal_x[2]:.2f}mol/L")
        print(f"  æ€§èƒ½: åˆ©ç›Š=Â¥{profit:,.0f}/h, è»¢åŒ–ç‡={X_A*100:.2f}%")

        # å±¥æ­´ã«è¨˜éŒ²
        self.time_history.append(iteration * self.update_interval)
        self.profit_history.append(profit)
        self.T_history.append(optimal_x[0])
        self.tau_history.append(optimal_x[1])
        self.C_A0_history.append(optimal_x[2])
        self.X_A_history.append(X_A)

    def run_rto_simulation(self):
        """RTOå…¨ä½“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""

        print("=" * 60)
        print("å®Ÿæ™‚é–“æœ€é©åŒ–ï¼ˆRTOï¼‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³")
        print("=" * 60)
        print(f"\nè¨­å®š:")
        print(f"  æ›´æ–°é–“éš”: {self.update_interval}åˆ†")
        print(f"  ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å›æ•°: {self.n_iterations}")
        print(f"  ç·é‹è»¢æ™‚é–“: {self.n_iterations * self.update_interval}åˆ†")

        for iteration in range(self.n_iterations):
            self.run_rto_cycle(iteration)

        # çµæœã®å¯è¦–åŒ–
        self.visualize_rto_results()

    def visualize_rto_results(self):
        """RTOçµæœã®å¯è¦–åŒ–"""

        fig, axes = plt.subplots(3, 2, figsize=(14, 12))

        # 1. åˆ©ç›Šã®æ¨ç§»
        ax1 = axes[0, 0]
        ax1.plot(self.time_history, self.profit_history, 'b-o', linewidth=2, markersize=5)
        ax1.set_xlabel('æ™‚é–“ [min]', fontsize=11, fontweight='bold')
        ax1.set_ylabel('åˆ©ç›Š [Â¥/h]', fontsize=11, fontweight='bold')
        ax1.set_title('åˆ©ç›Šã®æ™‚é–“æ¨ç§»', fontsize=12, fontweight='bold')
        ax1.grid(True, alpha=0.3)

        # 2. è»¢åŒ–ç‡ã®æ¨ç§»
        ax2 = axes[0, 1]
        ax2.plot(self.time_history, np.array(self.X_A_history) * 100, 'g-o', linewidth=2, markersize=5)
        ax2.axhline(y=95, color='r', linestyle='--', linewidth=1.5, label='æœ€å°è»¢åŒ–ç‡ 95%')
        ax2.set_xlabel('æ™‚é–“ [min]', fontsize=11, fontweight='bold')
        ax2.set_ylabel('è»¢åŒ–ç‡ [%]', fontsize=11, fontweight='bold')
        ax2.set_title('è»¢åŒ–ç‡ã®æ™‚é–“æ¨ç§»', fontsize=12, fontweight='bold')
        ax2.grid(True, alpha=0.3)
        ax2.legend()

        # 3. æ¸©åº¦ã®æ¨ç§»
        ax3 = axes[1, 0]
        ax3.plot(self.time_history, self.T_history, 'm-o', linewidth=2, markersize=5)
        ax3.set_xlabel('æ™‚é–“ [min]', fontsize=11, fontweight='bold')
        ax3.set_ylabel('æ¸©åº¦ [Â°C]', fontsize=11, fontweight='bold')
        ax3.set_title('åå¿œæ¸©åº¦ã®æ™‚é–“æ¨ç§»', fontsize=12, fontweight='bold')
        ax3.grid(True, alpha=0.3)

        # 4. æ»ç•™æ™‚é–“ã®æ¨ç§»
        ax4 = axes[1, 1]
        ax4.plot(self.time_history, self.tau_history, 'c-o', linewidth=2, markersize=5)
        ax4.set_xlabel('æ™‚é–“ [min]', fontsize=11, fontweight='bold')
        ax4.set_ylabel('æ»ç•™æ™‚é–“ [min]', fontsize=11, fontweight='bold')
        ax4.set_title('æ»ç•™æ™‚é–“ã®æ™‚é–“æ¨ç§»', fontsize=12, fontweight='bold')
        ax4.grid(True, alpha=0.3)

        # 5. ä¾›çµ¦æ¿ƒåº¦ã®æ¨ç§»
        ax5 = axes[2, 0]
        ax5.plot(self.time_history, self.C_A0_history, 'y-o', linewidth=2, markersize=5)
        ax5.set_xlabel('æ™‚é–“ [min]', fontsize=11, fontweight='bold')
        ax5.set_ylabel('ä¾›çµ¦æ¿ƒåº¦ [mol/L]', fontsize=11, fontweight='bold')
        ax5.set_title('ä¾›çµ¦æ¿ƒåº¦ã®æ™‚é–“æ¨ç§»', fontsize=12, fontweight='bold')
        ax5.grid(True, alpha=0.3)

        # 6. åˆ©ç›Šç´¯ç©
        ax6 = axes[2, 1]
        cumulative_profit = np.cumsum(self.profit_history) * (self.update_interval / 60)  # [Â¥]
        ax6.plot(self.time_history, cumulative_profit, 'r-o', linewidth=2, markersize=5)
        ax6.set_xlabel('æ™‚é–“ [min]', fontsize=11, fontweight='bold')
        ax6.set_ylabel('ç´¯ç©åˆ©ç›Š [Â¥]', fontsize=11, fontweight='bold')
        ax6.set_title('ç´¯ç©åˆ©ç›Š', fontsize=12, fontweight='bold')
        ax6.grid(True, alpha=0.3)

        plt.tight_layout()
        plt.savefig('rto_simulation_results.png', dpi=150, bbox_inches='tight')
        plt.show()

        print("\n" + "=" * 60)
        print("RTOã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã‚µãƒãƒªãƒ¼")
        print("=" * 60)
        print(f"\nåˆæœŸåˆ©ç›Š: Â¥{self.profit_history[0]:,.0f}/h")
        print(f"æœ€çµ‚åˆ©ç›Š: Â¥{self.profit_history[-1]:,.0f}/h")
        print(f"å¹³å‡åˆ©ç›Š: Â¥{np.mean(self.profit_history):,.0f}/h")
        print(f"åˆ©ç›Šå¤‰å‹•: {(self.profit_history[-1] - self.profit_history[0]) / self.profit_history[0] * 100:.1f}%")
        print(f"\nç·ç´¯ç©åˆ©ç›Š: Â¥{cumulative_profit[-1]:,.0f}")
        print(f"\nçµè«–: RTOã«ã‚ˆã‚Šè§¦åª’åŠ£åŒ–ã«é©å¿œã—ã€æœ€é©é‹è»¢æ¡ä»¶ã‚’ç¶­æŒ")

# å®Ÿè¡Œ
rto = RealTimeOptimization()
rto.run_rto_simulation()
</code></pre>

        <h2 id="distillation">5.5 ç·åˆã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£: å¤šæˆåˆ†è’¸ç•™å¡”ã®æœ€é©åŒ–</h2>

        <p>æœ€å¾Œã«ã€ã‚ˆã‚Šè¤‡é›‘ãªè’¸ç•™å¡”ã®æœ€é©åŒ–ã‚’ç·åˆã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ã¨ã—ã¦å–ã‚Šçµ„ã¿ã¾ã™ã€‚</p>

        <h3 id="distillation-problem">å•é¡Œè¨­å®š</h3>

        <p><strong>ã‚·ã‚¹ãƒ†ãƒ </strong>: 5æˆåˆ†æ··åˆç‰©ã®é€£ç¶šè’¸ç•™å¡”</p>

        <p><strong>ç›®çš„</strong>: ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã‚’æœ€å°åŒ–ã—ã¤ã¤ã€è£½å“ç´”åº¦è¦æ ¼ã‚’æº€ãŸã™</p>

        <p><strong>æ±ºå®šå¤‰æ•°</strong>:</p>
        <ul>
            <li><strong>R</strong>: é‚„æµæ¯”ï¼ˆReflux Ratioï¼‰ [-] (1.5-4.0)</li>
            <li><strong>Q<sub>R</sub></strong>: ãƒªãƒœã‚¤ãƒ©ãƒ¼ç†±è² è· [kW] (500-2000)</li>
            <li><strong>N<sub>stages</sub></strong>: æ®µæ•° [-] (20-50, æ•´æ•°)</li>
        </ul>

        <p><strong>åˆ¶ç´„æ¡ä»¶</strong>:</p>
        <ul>
            <li>è£½å“ç´”åº¦: x<sub>product</sub> â‰¥ 0.98</li>
            <li>å›åç‡: recovery â‰¥ 0.95</li>
            <li>åœ§åŠ›æå¤±: Î”P â‰¤ 50 kPa</li>
            <li>ç‰©è³ªåæ”¯: F = D + B</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹9: è’¸ç•™å¡”æœ€é©åŒ–ã®å®Œå…¨å®Ÿè£…</h4>

        <pre><code class="language-python">import numpy as np
from scipy.optimize import minimize, differential_evolution
import matplotlib.pyplot as plt

class DistillationColumnOptimization:
    """
    å¤šæˆåˆ†è’¸ç•™å¡”ã®æœ€é©åŒ–

    ç›®çš„: ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã‚’æœ€å°åŒ–
    åˆ¶ç´„: è£½å“ç´”åº¦ã€å›åç‡ã€åœ§åŠ›æå¤±
    """

    def __init__(self):
        # çµŒæ¸ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.energy_cost = 15.0         # ã‚¹ãƒãƒ¼ãƒ ã‚³ã‚¹ãƒˆ [Â¥/kWh]
        self.cooling_cost = 3.0         # å†·å´æ°´ã‚³ã‚¹ãƒˆ [Â¥/kWh]
        self.product_price = 2000.0     # è£½å“ä¾¡æ ¼ [Â¥/kg]

        # ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.F = 1000.0                 # ä¾›çµ¦æµé‡ [kg/h]
        self.x_F = 0.50                 # ä¾›çµ¦çµ„æˆï¼ˆè»½è³ªæˆåˆ†ï¼‰ [-]
        self.MW_avg = 80.0              # å¹³å‡åˆ†å­é‡ [g/mol]

        # ç‰©æ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆç°¡ç•¥åŒ–ï¼‰
        self.lambda_vap = 300.0         # è’¸ç™ºæ½œç†± [kJ/kg]
        self.Cp = 2.5                   # æ¯”ç†± [kJ/kgÂ·K]

        # åˆ¶ç´„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        self.purity_min = 0.98          # æœ€å°è£½å“ç´”åº¦ [-]
        self.recovery_min = 0.95        # æœ€å°å›åç‡ [-]
        self.dP_max = 50.0              # æœ€å¤§åœ§åŠ›æå¤± [kPa]

    def column_model(self, R, Q_R, N_stages):
        """
        è’¸ç•™å¡”ãƒ¢ãƒ‡ãƒ«ï¼ˆç°¡ç•¥åŒ–ï¼‰

        å®Ÿéš›ã«ã¯:
        - MESHæ–¹ç¨‹å¼ï¼ˆMaterial, Equilibrium, Summation, Heat balanceï¼‰
        - çŠ¶æ…‹æ–¹ç¨‹å¼ï¼ˆVLE: Vapor-Liquid Equilibriumï¼‰
        - Aspenãªã©ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã§è¨ˆç®—

        ã“ã“ã§ã¯ç°¡ç•¥åŒ–ã—ãŸã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆæ³•ã‚’ä½¿ç”¨
        """
        # Fenske-Underwood-Gillilandæ³•ã«åŸºã¥ãç°¡ç•¥è¨ˆç®—

        # æœ€å°é‚„æµæ¯”ï¼ˆUnderwoodå¼ã®ç°¡ç•¥ç‰ˆï¼‰
        alpha = 2.5  # æ¯”æ®ç™ºåº¦ï¼ˆç°¡ç•¥åŒ–ï¼‰
        R_min = (alpha - 1) / alpha

        # æ®µåŠ¹ç‡ï¼ˆçµŒé¨“å¼ï¼‰
        efficiency = 0.60 + 0.008 * N_stages  # æ®µæ•°ãŒå¤šã„ã»ã©åŠ¹ç‡å‘ä¸Š
        efficiency = min(efficiency, 0.85)

        # å®ŸåŠ¹æ®µæ•°
        N_eff = N_stages * efficiency

        # è£½å“ç´”åº¦ï¼ˆçµŒé¨“å¼ã€å®Ÿéš›ã«ã¯MESHæ–¹ç¨‹å¼ã§è¨ˆç®—ï¼‰
        purity = 1.0 - np.exp(-(N_eff / 30.0) * (R / R_min - 1.0))
        purity = min(purity, 0.995)  # ç‰©ç†çš„ä¸Šé™

        # å›åç‡
        recovery = 0.85 + 0.10 * (R / (R + 1))
        recovery = min(recovery, 0.98)

        # ç•™å‡ºé‡ï¼ˆç‰©è³ªåæ”¯ï¼‰
        D = self.F * self.x_F * recovery / purity  # [kg/h]
        B = self.F - D  # [kg/h]

        # åœ§åŠ›æå¤±ï¼ˆçµŒé¨“å¼ï¼‰
        dP = 0.5 * N_stages + 10.0  # [kPa]

        # ã‚³ãƒ³ãƒ‡ãƒ³ã‚µãƒ¼ç†±è² è·
        Q_C = (R + 1) * D * self.lambda_vap / 3600.0  # [kW]ï¼ˆkg/hâ†’kg/sã®å¤‰æ›ï¼‰

        return {
            'purity': purity,
            'recovery': recovery,
            'D': D,
            'B': B,
            'Q_C': Q_C,
            'Q_R': Q_R,
            'dP': dP
        }

    def objective(self, x):
        """
        ç›®çš„é–¢æ•°: ç·é‹è»¢ã‚³ã‚¹ãƒˆã‚’æœ€å°åŒ–

        ã‚³ã‚¹ãƒˆ = ãƒªãƒœã‚¤ãƒ©ãƒ¼ã‚³ã‚¹ãƒˆ + ã‚³ãƒ³ãƒ‡ãƒ³ã‚µãƒ¼ã‚³ã‚¹ãƒˆ
        """
        R, Q_R, N_stages = x
        N_stages = int(round(N_stages))  # æ•´æ•°åŒ–

        # ãƒ¢ãƒ‡ãƒ«è¨ˆç®—
        results = self.column_model(R, Q_R, N_stages)

        # é‹è»¢ã‚³ã‚¹ãƒˆ [Â¥/h]
        reboiler_cost = Q_R * self.energy_cost
        condenser_cost = results['Q_C'] * self.cooling_cost

        total_cost = reboiler_cost + condenser_cost

        return total_cost

    def constraints_func(self, x):
        """åˆ¶ç´„æ¡ä»¶"""
        R, Q_R, N_stages = x
        N_stages = int(round(N_stages))

        results = self.column_model(R, Q_R, N_stages)

        # ä¸ç­‰å¼åˆ¶ç´„ï¼ˆâ‰¥0ã¨ãªã‚‹ã‚ˆã†ã«å®šç¾©ï¼‰
        constraints = []

        # ç´”åº¦åˆ¶ç´„
        constraints.append(results['purity'] - self.purity_min)

        # å›åç‡åˆ¶ç´„
        constraints.append(results['recovery'] - self.recovery_min)

        # åœ§åŠ›æå¤±åˆ¶ç´„
        constraints.append(self.dP_max - results['dP'])

        # ç‰©ç†çš„åˆ¶ç´„: Q_Rã¯ç•™å‡ºé‡ã«å¯¾ã—ã¦ååˆ†ã§ã‚ã‚‹ã“ã¨
        Q_R_min = results['D'] * self.lambda_vap / 3600.0 * 0.5
        constraints.append(Q_R - Q_R_min)

        return constraints

    def optimize_distillation(self):
        """è’¸ç•™å¡”æœ€é©åŒ–ã®å®Ÿè¡Œ"""

        print("=" * 60)
        print("å¤šæˆåˆ†è’¸ç•™å¡”ã®æœ€é©åŒ–")
        print("=" * 60)
        print(f"\nç›®çš„: ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆæœ€å°åŒ–")
        print(f"\nä¾›çµ¦æ¡ä»¶:")
        print(f"  æµé‡: {self.F:.0f} kg/h")
        print(f"  çµ„æˆï¼ˆè»½è³ªæˆåˆ†ï¼‰: {self.x_F*100:.0f}%")

        print(f"\nåˆ¶ç´„æ¡ä»¶:")
        print(f"  è£½å“ç´”åº¦ â‰¥ {self.purity_min*100:.0f}%")
        print(f"  å›åç‡ â‰¥ {self.recovery_min*100:.0f}%")
        print(f"  åœ§åŠ›æå¤± â‰¤ {self.dP_max:.0f} kPa")

        # åˆæœŸæ¨å®šå€¤
        x0 = np.array([2.5, 1000.0, 30.0])

        # å¤‰æ•°ã®å¢ƒç•Œ
        bounds = [
            (1.5, 4.0),       # R
            (500.0, 2000.0),  # Q_R [kW]
            (20, 50)          # N_stages
        ]

        # åˆ¶ç´„æ¡ä»¶ï¼ˆscipyå½¢å¼ï¼‰
        constraints = [
            {'type': 'ineq', 'fun': lambda x: self.constraints_func(x)[i]}
            for i in range(4)
        ]

        print(f"\næœ€é©åŒ–é–‹å§‹...")

        # æ··åˆæ•´æ•°éç·šå½¢è¨ˆç”»å•é¡Œï¼ˆMINLPï¼‰
        # N_stagesãŒæ•´æ•°ã®ãŸã‚ã€differential_evolutionã‚’ä½¿ç”¨ï¼ˆå¤§åŸŸçš„æœ€é©åŒ–ï¼‰
        result = differential_evolution(
            self.objective,
            bounds,
            strategy='best1bin',
            maxiter=100,
            popsize=15,
            constraints=constraints,
            seed=42
        )

        # çµæœã®è§£é‡ˆ
        self.interpret_distillation_results(result)

        return result

    def interpret_distillation_results(self, result):
        """è’¸ç•™å¡”æœ€é©åŒ–çµæœã®è§£é‡ˆ"""

        print("\n" + "=" * 60)
        print("è’¸ç•™å¡”æœ€é©åŒ–çµæœ")
        print("=" * 60)

        if result.success:
            print("\nâœ“ æœ€é©åŒ–æˆåŠŸ")
        else:
            print(f"\nâœ— æœ€é©åŒ–å¤±æ•—: {result.message}")
            return

        R_opt, Q_R_opt, N_stages_opt = result.x
        N_stages_opt = int(round(N_stages_opt))

        results = self.column_model(R_opt, Q_R_opt, N_stages_opt)

        total_cost = result.fun
        reboiler_cost = Q_R_opt * self.energy_cost
        condenser_cost = results['Q_C'] * self.cooling_cost

        print(f"\nã€æœ€é©è¨­è¨ˆãƒ»é‹è»¢æ¡ä»¶ã€‘")
        print(f"  é‚„æµæ¯” R*: {R_opt:.3f}")
        print(f"  ãƒªãƒœã‚¤ãƒ©ãƒ¼ç†±è² è· Q_R*: {Q_R_opt:.1f} kW")
        print(f"  æ®µæ•° N*: {N_stages_opt}")

        print(f"\nã€ãƒ—ãƒ­ã‚»ã‚¹æ€§èƒ½ã€‘")
        print(f"  è£½å“ç´”åº¦: {results['purity']*100:.2f}% (è¦æ±‚: â‰¥{self.purity_min*100:.0f}%)")
        print(f"  å›åç‡: {results['recovery']*100:.2f}% (è¦æ±‚: â‰¥{self.recovery_min*100:.0f}%)")
        print(f"  ç•™å‡ºé‡: {results['D']:.1f} kg/h")
        print(f"  ç¼¶å‡ºé‡: {results['B']:.1f} kg/h")
        print(f"  åœ§åŠ›æå¤±: {results['dP']:.1f} kPa (ä¸Šé™: {self.dP_max:.0f} kPa)")

        print(f"\nã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã€‘")
        print(f"  ãƒªãƒœã‚¤ãƒ©ãƒ¼ã‚³ã‚¹ãƒˆ: Â¥{reboiler_cost:,.0f}/h")
        print(f"  ã‚³ãƒ³ãƒ‡ãƒ³ã‚µãƒ¼ã‚³ã‚¹ãƒˆ: Â¥{condenser_cost:,.0f}/h")
        print(f"  ç·é‹è»¢ã‚³ã‚¹ãƒˆ: Â¥{total_cost:,.0f}/h")

        # å¹´é–“ã‚³ã‚¹ãƒˆ
        annual_cost = total_cost * 24 * 365
        print(f"  å¹´é–“é‹è»¢ã‚³ã‚¹ãƒˆ: Â¥{annual_cost:,.0f}/year")

        # è£½å“ä¾¡å€¤
        annual_product_value = results['D'] * 24 * 365 * self.product_price
        annual_profit = annual_product_value - annual_cost

        print(f"\nã€çµŒæ¸ˆæ€§è©•ä¾¡ã€‘")
        print(f"  å¹´é–“è£½å“ä¾¡å€¤: Â¥{annual_product_value:,.0f}/year")
        print(f"  å¹´é–“åˆ©ç›Šï¼ˆç²—åˆ©ï¼‰: Â¥{annual_profit:,.0f}/year")

        # æ„Ÿåº¦åˆ†æã®ãƒ’ãƒ³ãƒˆ
        print(f"\nã€æœ€é©åŒ–ã«é–¢ã™ã‚‹è€ƒå¯Ÿã€‘")
        print(f"  - é‚„æµæ¯”R*={R_opt:.2f}: ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã¨åˆ†é›¢æ€§èƒ½ã®ãƒãƒ©ãƒ³ã‚¹")
        print(f"  - æ®µæ•°N*={N_stages_opt}: è¨­å‚™æŠ•è³‡ï¼ˆCAPEXï¼‰ã¨é‹è»¢ã‚³ã‚¹ãƒˆï¼ˆOPEXï¼‰ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•")
        print(f"  - ã•ã‚‰ãªã‚‹æ”¹å–„: ç†±çµ±åˆã€ä¸­é–“ç†±ä¾›çµ¦ã€åœ§åŠ›æœ€é©åŒ–")

        # å¯è¦–åŒ–
        self.visualize_optimization_landscape(R_opt, Q_R_opt, N_stages_opt)

    def visualize_optimization_landscape(self, R_opt, Q_R_opt, N_stages_opt):
        """æœ€é©åŒ–ãƒ©ãƒ³ãƒ‰ã‚¹ã‚±ãƒ¼ãƒ—ã®å¯è¦–åŒ–"""

        # é‚„æµæ¯” vs ã‚³ã‚¹ãƒˆã®ãƒ—ãƒ­ãƒƒãƒˆï¼ˆQ_Rã¨N_stagesã¯æœ€é©å€¤ã§å›ºå®šï¼‰
        R_range = np.linspace(1.5, 4.0, 30)
        costs_R = []
        purities_R = []

        for R in R_range:
            try:
                cost = self.objective([R, Q_R_opt, N_stages_opt])
                results = self.column_model(R, Q_R_opt, int(N_stages_opt))
                costs_R.append(cost)
                purities_R.append(results['purity'] * 100)
            except:
                costs_R.append(np.nan)
                purities_R.append(np.nan)

        fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

        # 1. é‚„æµæ¯” vs ã‚³ã‚¹ãƒˆ
        ax1.plot(R_range, costs_R, 'b-', linewidth=2)
        ax1.axvline(x=R_opt, color='r', linestyle='--', linewidth=2, label=f'æœ€é©å€¤ R*={R_opt:.2f}')
        ax1.set_xlabel('é‚„æµæ¯” R [-]', fontsize=12, fontweight='bold')
        ax1.set_ylabel('ç·é‹è»¢ã‚³ã‚¹ãƒˆ [Â¥/h]', fontsize=12, fontweight='bold')
        ax1.set_title('é‚„æµæ¯” vs é‹è»¢ã‚³ã‚¹ãƒˆ', fontsize=13, fontweight='bold')
        ax1.grid(True, alpha=0.3)
        ax1.legend()

        # 2. é‚„æµæ¯” vs è£½å“ç´”åº¦
        ax2.plot(R_range, purities_R, 'g-', linewidth=2)
        ax2.axhline(y=self.purity_min*100, color='r', linestyle='--', linewidth=2, label=f'æœ€å°ç´”åº¦ {self.purity_min*100:.0f}%')
        ax2.axvline(x=R_opt, color='orange', linestyle='--', linewidth=2, label=f'æœ€é©å€¤ R*={R_opt:.2f}')
        ax2.set_xlabel('é‚„æµæ¯” R [-]', fontsize=12, fontweight='bold')
        ax2.set_ylabel('è£½å“ç´”åº¦ [%]', fontsize=12, fontweight='bold')
        ax2.set_title('é‚„æµæ¯” vs è£½å“ç´”åº¦', fontsize=13, fontweight='bold')
        ax2.grid(True, alpha=0.3)
        ax2.legend()

        plt.tight_layout()
        plt.savefig('distillation_optimization_landscape.png', dpi=150, bbox_inches='tight')
        plt.show()

        print("\nå¯è¦–åŒ–å®Œäº†: distillation_optimization_landscape.png")

# å®Ÿè¡Œ
distillation_opt = DistillationColumnOptimization()
result_distillation = distillation_opt.optimize_distillation()
</code></pre>

        <h2 id="summary">ã¾ã¨ã‚</h2>

        <div class="success">
            <h4>ç¬¬5ç« ã§å­¦ã‚“ã ã“ã¨</h4>
            <ul>
                <li><strong>å®Œå…¨ãªæœ€é©åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</strong>: å•é¡Œå®šç¾©ã‹ã‚‰ãƒ¢ãƒ‡ãƒ«é–‹ç™ºã€æœ€é©åŒ–å®Ÿè¡Œã€çµæœæ¤œè¨¼ã¾ã§ã®ä½“ç³»çš„ãƒ—ãƒ­ã‚»ã‚¹</li>
                <li><strong>CSTRæœ€é©åŒ–</strong>: çµŒæ¸ˆçš„ç›®çš„é–¢æ•°ã€å¤šå¤‰æ•°æœ€é©åŒ–ã€åŒ…æ‹¬çš„åˆ¶ç´„æ¡ä»¶ã®å®Ÿè£…</li>
                <li><strong>æ„Ÿåº¦åˆ†æ</strong>: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰å‹•ã«å¯¾ã™ã‚‹æœ€é©è§£ã®é ‘å¥æ€§è©•ä¾¡</li>
                <li><strong>ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–</strong>: ä¸ç¢ºå®Ÿæ€§ä¸‹ã§ã®æœŸå¾…å€¤æœ€é©åŒ–ã¨ãƒ¯ãƒ¼ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æœ€é©åŒ–</li>
                <li><strong>å®Ÿæ™‚é–“æœ€é©åŒ–</strong>: ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãé©å¿œçš„æœ€é©åŒ–ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</li>
                <li><strong>è’¸ç•™å¡”æœ€é©åŒ–</strong>: è¤‡é›‘ãªå¤šå¤‰æ•°ãƒ»åˆ¶ç´„ä»˜ãæœ€é©åŒ–ã®ç·åˆã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£</li>
            </ul>
        </div>

        <h3 id="key-takeaways">é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

        <ol>
            <li><strong>çµŒæ¸ˆçš„ç›®çš„é–¢æ•°ã®è¨­è¨ˆ</strong>: åˆ©ç›Šæœ€å¤§åŒ– = åç›Š - åŸæ–™ã‚³ã‚¹ãƒˆ - ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ</li>
            <li><strong>ç¾å®Ÿçš„ãªåˆ¶ç´„æ¡ä»¶</strong>: å®‰å…¨åˆ¶ç´„ã€è£½å“è¦æ ¼ã€ç’°å¢ƒåŸºæº–ã€é‹è»¢åˆ¶ç´„ã®åŒ…æ‹¬çš„å®Ÿè£…</li>
            <li><strong>æ„Ÿåº¦åˆ†æã®é‡è¦æ€§</strong>: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¸ç¢ºå®Ÿæ€§ãŒæœ€é©è§£ã«ä¸ãˆã‚‹å½±éŸ¿ã®å®šé‡è©•ä¾¡</li>
            <li><strong>ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–</strong>: ä¸ç¢ºå®Ÿæ€§ä¸‹ã§ã‚‚æ€§èƒ½ã‚’ä¿è¨¼ã™ã‚‹é‹è»¢æ¡ä»¶ã®æ¢ç´¢</li>
            <li><strong>å®Ÿæ™‚é–“æœ€é©åŒ–ï¼ˆRTOï¼‰</strong>: ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ã«é©å¿œã™ã‚‹å‹•çš„ãªæœ€é©åŒ–ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</li>
        </ol>

        <h3 id="practical-implementation">å®Ÿå‹™ã¸ã®é©ç”¨</h3>

        <p><strong>çŸ­æœŸçš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ1-3ãƒ¶æœˆï¼‰</strong></p>
        <ul>
            <li>è‡ªç¤¾ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–æ©Ÿä¼šã‚’è©•ä¾¡ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã€åç‡ã€å“è³ªï¼‰</li>
            <li>ç°¡å˜ãªå˜å¤‰æ•°æœ€é©åŒ–ã‹ã‚‰é–‹å§‹ï¼ˆæ¸©åº¦ã€åœ§åŠ›ã€æµé‡ã®èª¿æ•´ï¼‰</li>
            <li>DCS/PLCãƒ‡ãƒ¼ã‚¿ã‚’æ´»ç”¨ã—ãŸç¾çŠ¶æ€§èƒ½ã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ¸¬å®š</li>
        </ul>

        <p><strong>ä¸­æœŸçš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ3-12ãƒ¶æœˆï¼‰</strong></p>
        <ul>
            <li>ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«ã®é–‹ç™ºï¼ˆç¬¬ä¸€åŸç†ãƒ¢ãƒ‡ãƒ«ã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿é§†å‹•ãƒ¢ãƒ‡ãƒ«ï¼‰</li>
            <li>å¤šå¤‰æ•°æœ€é©åŒ–ã®å®Ÿè£…ã¨æ¤œè¨¼ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒï¼‰</li>
            <li>æ„Ÿåº¦åˆ†æã¨ãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–ã®å®Ÿè·µ</li>
        </ul>

        <p><strong>é•·æœŸçš„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆ1-2å¹´ï¼‰</strong></p>
        <ul>
            <li>å®Ÿæ™‚é–“æœ€é©åŒ–ï¼ˆRTOï¼‰ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã¨å®Ÿè£…</li>
            <li>ãƒ—ãƒ©ãƒ³ãƒˆå…¨ä½“ã®çµ±åˆæœ€é©åŒ–ï¼ˆè¤‡æ•°ãƒ¦ãƒ‹ãƒƒãƒˆã®é€£æºï¼‰</li>
            <li>ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬åˆ¶å¾¡ï¼ˆMPCï¼‰ã¨ã®çµ±åˆ</li>
        </ul>

        <h3 id="further-learning">ã•ã‚‰ãªã‚‹å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹</h3>

        <p><strong>æ¨å¥¨æ›¸ç±</strong></p>
        <ul>
            <li><strong>Biegler, L.T. (2010)</strong>: "Nonlinear Programming: Concepts, Algorithms, and Applications to Chemical Processes"</li>
            <li><strong>Edgar, T.F., et al. (2001)</strong>: "Optimization of Chemical Processes"</li>
            <li><strong>Seborg, D.E., et al. (2016)</strong>: "Process Dynamics and Control" (MPCé–¢é€£)</li>
        </ul>

        <p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</strong></p>
        <ul>
            <li><strong>å‹•çš„æœ€é©åŒ–</strong>: ãƒãƒƒãƒãƒ—ãƒ­ã‚»ã‚¹ã€ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—æœ€é©åŒ–</li>
            <li><strong>ãƒ¢ãƒ‡ãƒ«äºˆæ¸¬åˆ¶å¾¡ï¼ˆMPCï¼‰</strong>: å®Ÿæ™‚é–“åˆ¶å¾¡ã¨æœ€é©åŒ–ã®çµ±åˆ</li>
            <li><strong>ãƒ™ã‚¤ã‚ºæœ€é©åŒ–</strong>: ãƒ–ãƒ©ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–</li>
            <li><strong>æ©Ÿæ¢°å­¦ç¿’çµ±åˆ</strong>: ã‚µãƒ­ã‚²ãƒ¼ãƒˆãƒ¢ãƒ‡ãƒ«ã€å¼·åŒ–å­¦ç¿’</li>
        </ul>

        <div class="tip">
            <h4>å®Ÿè£…ã®ãƒ’ãƒ³ãƒˆ</h4>
            <p><strong>æ®µéšçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</strong>: ã¾ãšã‚ªãƒ•ãƒ©ã‚¤ãƒ³æœ€é©åŒ–ã§åŠ¹æœã‚’æ¤œè¨¼ â†’ å°è¦æ¨¡ãƒ‘ã‚¤ãƒ­ãƒƒãƒˆè©¦é¨“ â†’ æ®µéšçš„ãªæœ¬æ ¼å®Ÿè£…</p>
            <p><strong>å®‰å…¨ç¬¬ä¸€</strong>: ã™ã¹ã¦ã®æœ€é©åŒ–ã¯å®‰å…¨åˆ¶ç´„ã‚’æœ€å„ªå…ˆã—ã€ç·Šæ€¥åœæ­¢ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…</p>
            <p><strong>ç¶™ç¶šçš„æ”¹å–„</strong>: å®šæœŸçš„ãªãƒ¢ãƒ‡ãƒ«æ›´æ–°ã¨æœ€é©åŒ–çµæœã®æ¤œè¨¼ã‚’ç¿’æ…£åŒ–</p>
        </div>

        <h2 id="conclusion">ãŠã‚ã‚Šã«</h2>

        <p>ã“ã®ã€Œãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–å…¥é–€ã‚·ãƒªãƒ¼ã‚ºã€å…¨5ç« ã‚’é€šã˜ã¦ã€æœ€é©åŒ–å•é¡Œã®å®šå¼åŒ–ã‹ã‚‰å®Ÿéš›ã®åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©é‹è»¢æ¡ä»¶æ¢ç´¢ã¾ã§ã€åŒ…æ‹¬çš„ãªçŸ¥è­˜ã¨ã‚¹ã‚­ãƒ«ã‚’ç¿’å¾—ã—ã¾ã—ãŸã€‚</p>

        <p>æœ€é©åŒ–ã¯å˜ãªã‚‹æ•°å­¦çš„æŠ€æ³•ã§ã¯ãªãã€ãƒ—ãƒ­ã‚»ã‚¹ç”£æ¥­ã®ç«¶äº‰åŠ›ã‚’é«˜ã‚ã€æŒç¶šå¯èƒ½æ€§ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚æœ¬ã‚·ãƒªãƒ¼ã‚ºã§å­¦ã‚“ã æŠ€è¡“ã‚’å®Ÿå‹™ã«é©ç”¨ã—ã€ãƒ—ãƒ­ã‚»ã‚¹ã®çµŒæ¸ˆæ€§å‘ä¸Šã€ã‚¨ãƒãƒ«ã‚®ãƒ¼åŠ¹ç‡æ”¹å–„ã€ç’°å¢ƒè² è·ä½æ¸›ã«è²¢çŒ®ã•ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã™ã€‚</p>

        <p><strong>æœ€é©åŒ–ã®æ—…ã¯ã“ã“ã§çµ‚ã‚ã‚Šã§ã¯ãªãã€å§‹ã¾ã‚Šã§ã™ï¼</strong></p>

        <div class="nav-buttons">
            <a href="./chapter-4.html" class="nav-button">â† ç¬¬4ç« ï¼šåˆ¶ç´„æ¡ä»¶ä¸‹ã§ã®æœ€é©åŒ–</a>
            <a href="./index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºãƒˆãƒƒãƒ—ã«æˆ»ã‚‹ â†’</a>
        </div>

    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <div class="container">
            <p>&copy; 2025 PI Knowledge Hub - Dr. Yusuke Hashimoto, Tohoku University</p>
            <p>Licensed under CC BY 4.0 | Process Optimization Series v1.0</p>
        </div>
    </footer>
</body>
</html>
