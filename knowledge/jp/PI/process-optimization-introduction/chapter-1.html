<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬1ç« ï¼šæœ€é©åŒ–å•é¡Œã®å®šå¼åŒ– - ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–å…¥é–€ã‚·ãƒªãƒ¼ã‚º">
    <title>ç¬¬1ç« ï¼šæœ€é©åŒ–å•é¡Œã®å®šå¼åŒ– - ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–å…¥é–€ | PI Terakoya</title>

        <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8; color: #333; background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; padding: 2rem 1rem; text-align: center;
        }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; font-size: 1.1rem; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
        .back-link {
            display: inline-block; margin-bottom: 2rem; padding: 0.5rem 1rem;
            background: white; color: #11998e; text-decoration: none;
            border-radius: 6px; font-weight: 600;
        }
        .content-box {
            background: white; padding: 2rem; border-radius: 12px;
            margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #11998e; margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem; border-bottom: 3px solid #11998e;
        }
        h3 { color: #2c3e50; margin: 1.5rem 0 1rem 0; }
        h4 { color: #2c3e50; margin: 1rem 0 0.5rem 0; }
        p { margin-bottom: 1rem; }
        ul, ol { margin-left: 2rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
        pre {
            background: #1e1e1e; color: #d4d4d4; padding: 1.5rem;
            border-radius: 8px; overflow-x: auto; margin: 1rem 0;
            border-left: 4px solid #11998e;
        }
        code {
            font-family: 'Courier New', monospace; font-size: 0.9rem;
        }
        .key-point {
            background: #e8f5e9; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #4caf50; margin: 1rem 0;
        }
        .tech-note {
            background: #e3f2fd; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #2196f3; margin: 1rem 0;
        }
        .formula {
            background: #f0f7ff; padding: 1rem; border-radius: 6px;
            margin: 1rem 0; overflow-x: auto;
        }
        table {
            width: 100%; border-collapse: collapse; margin: 1rem 0;
        }
        th, td {
            border: 1px solid #ddd; padding: 0.75rem; text-align: left;
        }
        th {
            background: #11998e; color: white; font-weight: 600;
        }
        tr:nth-child(even) { background: #f9f9f9; }
        .nav-buttons {
            display: flex; justify-content: space-between; margin-top: 3rem;
        }
        .nav-buttons a {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; text-decoration: none; border-radius: 6px;
            font-weight: 600;
        }
        footer {
            background: #2c3e50; color: white; text-align: center;
            padding: 2rem 1rem; margin-top: 4rem;
        }
        @media (max-width: 768px) {
            h1 { font-size: 1.6rem; }
            .container { padding: 0 0.5rem; }
            pre { padding: 1rem; }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../PI/index.html">ãƒ—ãƒ­ã‚»ã‚¹ãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a><span class="breadcrumb-separator">â€º</span><a href="../../PI/process-optimization-introduction/index.html">Process Optimization</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

        <header>
        <div class="container">
            <h1>ç¬¬1ç« ï¼šæœ€é©åŒ–å•é¡Œã®å®šå¼åŒ–</h1>
            <p class="subtitle">ç›®çš„é–¢æ•°ã€åˆ¶ç´„æ¡ä»¶ã€å®Ÿè¡Œå¯èƒ½é ˜åŸŸã®ç†è§£</p>
            <div class="meta">
                <span class="meta">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta">ğŸ“Š é›£æ˜“åº¦: å…¥é–€</span>
                <span class="meta">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 9å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">

<div class="learning-objectives">
<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… æœ€é©åŒ–å•é¡Œã®åŸºæœ¬è¦ç´ ï¼ˆç›®çš„é–¢æ•°ã€æ±ºå®šå¤‰æ•°ã€åˆ¶ç´„æ¡ä»¶ï¼‰ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–å•é¡Œã‚’æ•°å­¦çš„ã«å®šå¼åŒ–ã§ãã‚‹</li>
<li>âœ… Pythonã§ç›®çš„é–¢æ•°ã‚’å¯è¦–åŒ–ã—ã€æœ€é©è§£ã‚’è¦–è¦šçš„ã«æŠŠæ¡ã§ãã‚‹</li>
<li>âœ… å®Ÿè¡Œå¯èƒ½é ˜åŸŸã¨åˆ¶ç´„æ¡ä»¶ã®é–¢ä¿‚ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… å‹¾é…ã¨æ„Ÿåº¦åˆ†æã®åŸºç¤ã‚’ç¿’å¾—ã™ã‚‹</li>
</ul>
</div>

<hr />

<h2>1.1 æœ€é©åŒ–å•é¡Œã®åŸºç¤</h2>

<h3>æœ€é©åŒ–ã¨ã¯ä½•ã‹</h3>

<p><strong>æœ€é©åŒ–ï¼ˆOptimizationï¼‰</strong>ã¨ã¯ã€ä¸ãˆã‚‰ã‚ŒãŸåˆ¶ç´„æ¡ä»¶ã®ã‚‚ã¨ã§ã€ç›®çš„é–¢æ•°ã‚’æœ€å°åŒ–ã¾ãŸã¯æœ€å¤§åŒ–ã™ã‚‹æ±ºå®šå¤‰æ•°ã®å€¤ã‚’æ±‚ã‚ã‚‹ã“ã¨ã§ã™ã€‚</p>

<p>ä¸€èˆ¬çš„ãªæœ€é©åŒ–å•é¡Œã¯æ¬¡ã®ã‚ˆã†ã«è¡¨ç¾ã•ã‚Œã¾ã™ï¼š</p>

<p>$$
\begin{aligned}
\text{minimize} \quad & f(\mathbf{x}) \\
\text{subject to} \quad & g_i(\mathbf{x}) \leq 0, \quad i = 1, \ldots, m \\
& h_j(\mathbf{x}) = 0, \quad j = 1, \ldots, p \\
& \mathbf{x} \in \mathbb{R}^n
\end{aligned}
$$</p>

<p>ã“ã“ã§ï¼š</p>
<ul>
<li><strong>$f(\mathbf{x})$</strong>: ç›®çš„é–¢æ•°ï¼ˆæœ€å°åŒ–ã¾ãŸã¯æœ€å¤§åŒ–ã—ãŸã„é‡ï¼‰</li>
<li><strong>$\mathbf{x} = [x_1, x_2, \ldots, x_n]^T$</strong>: æ±ºå®šå¤‰æ•°ï¼ˆåˆ¶å¾¡å¯èƒ½ãªå¤‰æ•°ï¼‰</li>
<li><strong>$g_i(\mathbf{x}) \leq 0$</strong>: ä¸ç­‰å¼åˆ¶ç´„æ¡ä»¶</li>
<li><strong>$h_j(\mathbf{x}) = 0$</strong>: ç­‰å¼åˆ¶ç´„æ¡ä»¶</li>
</ul>

<h3>åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã«ãŠã‘ã‚‹æœ€é©åŒ–ã®ä¾‹</h3>

<table>
<thead>
<tr>
<th>ãƒ—ãƒ­ã‚»ã‚¹</th>
<th>ç›®çš„é–¢æ•°</th>
<th>æ±ºå®šå¤‰æ•°</th>
<th>ä¸»ãªåˆ¶ç´„æ¡ä»¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŒ–å­¦åå¿œå™¨</td>
<td>åç‡æœ€å¤§åŒ–ã€ã‚³ã‚¹ãƒˆæœ€å°åŒ–</td>
<td>æ¸©åº¦ã€åœ§åŠ›ã€æ»ç•™æ™‚é–“</td>
<td>å®‰å…¨æ¸©åº¦ç¯„å›²ã€è£½å“ç´”åº¦</td>
</tr>
<tr>
<td>è’¸ç•™å¡”</td>
<td>ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆæœ€å°åŒ–</td>
<td>é‚„æµæ¯”ã€ãƒªãƒœã‚¤ãƒ©ãƒ¼ç†±é‡</td>
<td>è£½å“ç´”åº¦ã€å¡”é ‚åœ§åŠ›</td>
</tr>
<tr>
<td>ç”Ÿç”£è¨ˆç”»</td>
<td>åˆ©ç›Šæœ€å¤§åŒ–</td>
<td>å„è£½å“ã®ç”Ÿç”£é‡</td>
<td>åŸæ–™ä¾›çµ¦é‡ã€è¨­å‚™èƒ½åŠ›</td>
</tr>
<tr>
<td>åŸæ–™é…åˆ</td>
<td>åŸæ–™ã‚³ã‚¹ãƒˆæœ€å°åŒ–</td>
<td>å„åŸæ–™ã®é…åˆæ¯”</td>
<td>è£½å“è¦æ ¼ã€åŸæ–™åœ¨åº«</td>
</tr>
</tbody>
</table>

<hr />

<h2>1.2 Pythonã«ã‚ˆã‚‹æœ€é©åŒ–å•é¡Œã®å¯è¦–åŒ–</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: å˜ç´”ãª2æ¬¡é–¢æ•°ã®æœ€å°åŒ–å•é¡Œ</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# ç›®çš„é–¢æ•°ã®å®šç¾©ï¼š2æ¬¡é–¢æ•°ï¼ˆæœ€å°å€¤ã‚’æŒã¤ï¼‰
def objective_function(x):
    """
    ç›®çš„é–¢æ•°: f(x) = (x - 3)^2 + 5
    æœ€å°å€¤: f(3) = 5
    """
    return (x - 3)**2 + 5

# xè»¸ã®ç¯„å›²
x = np.linspace(-2, 8, 100)
y = objective_function(x)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
plt.plot(x, y, linewidth=2.5, color='#11998e', label='f(x) = (x - 3)Â² + 5')
plt.axvline(x=3, color='red', linestyle='--', linewidth=2, label='æœ€é©è§£ x* = 3')
plt.scatter([3], [5], color='red', s=150, zorder=5, marker='o',
            edgecolors='black', linewidth=2, label='æœ€å°å€¤ f(x*) = 5')
plt.xlabel('x', fontsize=12)
plt.ylabel('f(x)', fontsize=12)
plt.title('å˜ç´”ãªæœ€é©åŒ–å•é¡Œã®å¯è¦–åŒ–', fontsize=14, fontweight='bold')
plt.legend(fontsize=11)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.show()

# æœ€é©è§£ã®ç¢ºèª
x_optimal = 3
f_optimal = objective_function(x_optimal)
print(f"æœ€é©è§£: x* = {x_optimal}")
print(f"ç›®çš„é–¢æ•°ã®æœ€å°å€¤: f(x*) = {f_optimal}")
</code></pre>

<p><strong>å‡ºåŠ›:</strong></p>
<pre><code>æœ€é©è§£: x* = 3
ç›®çš„é–¢æ•°ã®æœ€å°å€¤: f(x*) = 5
</code></pre>

<p><strong>è§£èª¬:</strong> æœ€ã‚‚å˜ç´”ãªæœ€é©åŒ–å•é¡Œã¨ã—ã¦ã€1å¤‰æ•°ã®2æ¬¡é–¢æ•°ã‚’æœ€å°åŒ–ã—ã¾ã™ã€‚ã“ã®ã‚ˆã†ãªå‡¸é–¢æ•°ã§ã¯ã€å”¯ä¸€ã®æœ€å°å€¤ï¼ˆå¤§åŸŸçš„æœ€é©è§£ï¼‰ãŒå­˜åœ¨ã—ã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®åˆ©ç›Šæœ€å¤§åŒ–å•é¡Œã®å®šå¼åŒ–</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®åˆ©ç›Šé–¢æ•°
def process_profit(T):
    """
    åå¿œæ¸©åº¦Tã«å¯¾ã™ã‚‹åˆ©ç›Šé–¢æ•°

    Parameters:
    T : float, åå¿œæ¸©åº¦ [Â°C]

    Returns:
    profit : float, åˆ©ç›Š [$/h]

    ãƒ¢ãƒ‡ãƒ«:
    - åç‡ã¯æ¸©åº¦ã¨ã¨ã‚‚ã«å¢—åŠ ã™ã‚‹ãŒã€ã‚ã‚‹æ¸©åº¦ä»¥é™ã¯å‰¯åå¿œã«ã‚ˆã‚Šæ¸›å°‘
    - ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã¯æ¸©åº¦ã¨ã¨ã‚‚ã«å¢—åŠ 
    - åˆ©ç›Š = è£½å“ä¾¡å€¤ - ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ
    """
    # è£½å“ä¾¡å€¤ï¼ˆåç‡ä¾å­˜ã€æœ€é©æ¸©åº¦ä»˜è¿‘ã§ãƒ”ãƒ¼ã‚¯ï¼‰
    yield_value = 1000 * (1 - ((T - 175) / 100)**2)

    # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆï¼ˆæ¸©åº¦ã«æ¯”ä¾‹ï¼‰
    energy_cost = 2 * T

    # åˆ©ç›Š
    profit = yield_value - energy_cost

    return profit

# æ¸©åº¦ç¯„å›²
T_range = np.linspace(100, 250, 150)
profit_range = [process_profit(T) for T in T_range]

# æœ€é©æ¸©åº¦ã®æ•°å€¤è¨ˆç®—
optimal_idx = np.argmax(profit_range)
T_optimal = T_range[optimal_idx]
profit_optimal = profit_range[optimal_idx]

# å¯è¦–åŒ–
plt.figure(figsize=(12, 6))
plt.plot(T_range, profit_range, linewidth=2.5, color='#11998e',
         label='åˆ©ç›Šé–¢æ•°')
plt.axvline(x=T_optimal, color='red', linestyle='--', linewidth=2,
            label=f'æœ€é©æ¸©åº¦ T* = {T_optimal:.1f}Â°C')
plt.scatter([T_optimal], [profit_optimal], color='red', s=200,
            zorder=5, marker='*', edgecolors='black', linewidth=2,
            label=f'æœ€å¤§åˆ©ç›Š = ${profit_optimal:.1f}/h')
plt.axhline(y=0, color='gray', linestyle='-', linewidth=0.8, alpha=0.5)
plt.fill_between(T_range, 0, profit_range, where=(np.array(profit_range) > 0),
                 alpha=0.2, color='green', label='åˆ©ç›Šé ˜åŸŸ')
plt.xlabel('åå¿œæ¸©åº¦ T [Â°C]', fontsize=12)
plt.ylabel('åˆ©ç›Š [$/h]', fontsize=12)
plt.title('åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®åˆ©ç›Šæœ€å¤§åŒ–å•é¡Œ', fontsize=14, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.show()

print(f"æœ€é©åå¿œæ¸©åº¦: T* = {T_optimal:.2f}Â°C")
print(f"æœ€å¤§åˆ©ç›Š: {profit_optimal:.2f} $/h")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>æœ€é©åå¿œæ¸©åº¦: T* = 165.77Â°C
æœ€å¤§åˆ©ç›Š: 668.78 $/h
</code></pre>

<p><strong>è§£èª¬:</strong> å®Ÿéš›ã®åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€åç‡ã¨çµŒæ¸ˆæ€§ã®ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒæ…®ã—ãŸåˆ©ç›Šé–¢æ•°ã‚’æœ€å¤§åŒ–ã—ã¾ã™ã€‚æ¸©åº¦ãŒé«˜ã™ãã‚‹ã¨å‰¯åå¿œã‚„ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆãŒå¢—åŠ ã—ã€åˆ©ç›ŠãŒæ¸›å°‘ã—ã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: 2å¤‰æ•°æœ€é©åŒ–å•é¡Œã®ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆ</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# 2å¤‰æ•°ã®ç›®çš„é–¢æ•°ï¼ˆRosenbrocké–¢æ•°ã®ç°¡ç•¥ç‰ˆï¼‰
def objective_2d(x1, x2):
    """
    ç›®çš„é–¢æ•°: f(x1, x2) = (x1 - 2)^2 + (x2 - 3)^2
    æœ€å°å€¤: f(2, 3) = 0
    """
    return (x1 - 2)**2 + (x2 - 3)**2

# ã‚°ãƒªãƒƒãƒ‰ã®ä½œæˆ
x1 = np.linspace(-1, 5, 200)
x2 = np.linspace(0, 6, 200)
X1, X2 = np.meshgrid(x1, x2)
Z = objective_2d(X1, X2)

# ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 8))
contour = plt.contour(X1, X2, Z, levels=20, cmap='viridis', alpha=0.6)
plt.contourf(X1, X2, Z, levels=20, cmap='viridis', alpha=0.3)
plt.colorbar(contour, label='f(x1, x2)')
plt.scatter([2], [3], color='red', s=200, zorder=5, marker='*',
            edgecolors='black', linewidth=2, label='æœ€é©è§£ (2, 3)')
plt.xlabel('xâ‚', fontsize=12)
plt.ylabel('xâ‚‚', fontsize=12)
plt.title('2å¤‰æ•°æœ€é©åŒ–å•é¡Œã®ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆ', fontsize=14, fontweight='bold')
plt.legend(fontsize=11)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.show()

print(f"æœ€é©è§£: x1* = 2, x2* = 3")
print(f"ç›®çš„é–¢æ•°ã®æœ€å°å€¤: f(x*) = {objective_2d(2, 3)}")
</code></pre>

<p><strong>å‡ºåŠ›:</strong></p>
<pre><code>æœ€é©è§£: x1* = 2, x2* = 3
ç›®çš„é–¢æ•°ã®æœ€å°å€¤: f(x*) = 0
</code></pre>

<p><strong>è§£èª¬:</strong> 2å¤‰æ•°ã®æœ€é©åŒ–å•é¡Œã§ã¯ã€ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆï¼ˆcontour plotï¼‰ã«ã‚ˆã‚Šã€ç›®çš„é–¢æ•°ã®åœ°å½¢ã‚’è¦–è¦šçš„ã«æŠŠæ¡ã§ãã¾ã™ã€‚ç­‰é«˜ç·šãŒå¯†ãªå ´æ‰€ã¯å‹¾é…ãŒæ€¥ã§ã€æœ€é©è§£ã«è¿‘ã¥ãã«ã¤ã‚Œã¦æ¥•å††å½¢ã«åæŸã—ã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: åˆ¶ç´„æ¡ä»¶ã¨å®Ÿè¡Œå¯èƒ½é ˜åŸŸã®å¯è¦–åŒ–</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ç›®çš„é–¢æ•°
def objective(x1, x2):
    return x1**2 + x2**2

# åˆ¶ç´„æ¡ä»¶ã®å®šç¾©
# g1: x1 + x2 >= 2  â†’  -x1 - x2 + 2 <= 0
# g2: x1 >= 0
# g3: x2 >= 0
# g4: x1 <= 4
# g5: x2 <= 4

# ã‚°ãƒªãƒƒãƒ‰ä½œæˆ
x1 = np.linspace(-0.5, 5, 300)
x2 = np.linspace(-0.5, 5, 300)
X1, X2 = np.meshgrid(x1, x2)

# å®Ÿè¡Œå¯èƒ½é ˜åŸŸã®åˆ¤å®š
feasible = (X1 + X2 >= 2) & (X1 >= 0) & (X2 >= 0) & (X1 <= 4) & (X2 <= 4)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 8))

# å®Ÿè¡Œå¯èƒ½é ˜åŸŸã‚’å¡—ã‚Šã¤ã¶ã—
plt.contourf(X1, X2, feasible.astype(int), levels=1, colors=['white', '#c8e6c9'], alpha=0.7)

# ç›®çš„é–¢æ•°ã®ç­‰é«˜ç·š
Z = objective(X1, X2)
contour = plt.contour(X1, X2, Z, levels=15, cmap='viridis', alpha=0.5)
plt.colorbar(contour, label='f(xâ‚, xâ‚‚) = xâ‚Â² + xâ‚‚Â²')

# åˆ¶ç´„æ¡ä»¶ã®å¢ƒç•Œç·š
x1_line = np.linspace(0, 4, 100)
plt.plot(x1_line, 2 - x1_line, 'r--', linewidth=2, label='xâ‚ + xâ‚‚ = 2')
plt.axvline(x=0, color='blue', linestyle='-', linewidth=1.5, alpha=0.7)
plt.axhline(y=0, color='blue', linestyle='-', linewidth=1.5, alpha=0.7)
plt.axvline(x=4, color='blue', linestyle='-', linewidth=1.5, alpha=0.7)
plt.axhline(y=4, color='blue', linestyle='-', linewidth=1.5, alpha=0.7)

# æœ€é©è§£ï¼ˆè§£æçš„ã«æ±‚ã‚ãŸï¼‰: x1 = x2 = 1ï¼ˆåˆ¶ç´„ x1 + x2 = 2 ä¸Šï¼‰
plt.scatter([1], [1], color='red', s=250, zorder=5, marker='*',
            edgecolors='black', linewidth=2, label='æœ€é©è§£ (1, 1)')

plt.xlabel('xâ‚', fontsize=12)
plt.ylabel('xâ‚‚', fontsize=12)
plt.title('åˆ¶ç´„æ¡ä»¶ã¨å®Ÿè¡Œå¯èƒ½é ˜åŸŸ', fontsize=14, fontweight='bold')
plt.legend(fontsize=10)
plt.xlim(-0.5, 5)
plt.ylim(-0.5, 5)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.show()

print("åˆ¶ç´„æ¡ä»¶:")
print("  g1: xâ‚ + xâ‚‚ >= 2")
print("  g2: xâ‚ >= 0")
print("  g3: xâ‚‚ >= 0")
print("  g4: xâ‚ <= 4")
print("  g5: xâ‚‚ <= 4")
print(f"\næœ€é©è§£: xâ‚* = 1, xâ‚‚* = 1")
print(f"ç›®çš„é–¢æ•°å€¤: f(x*) = {objective(1, 1)}")
</code></pre>

<p><strong>å‡ºåŠ›:</strong></p>
<pre><code>åˆ¶ç´„æ¡ä»¶:
  g1: xâ‚ + xâ‚‚ >= 2
  g2: xâ‚ >= 0
  g3: xâ‚‚ >= 0
  g4: xâ‚ <= 4
  g5: xâ‚‚ <= 4

æœ€é©è§£: xâ‚* = 1, xâ‚‚* = 1
ç›®çš„é–¢æ•°å€¤: f(x*) = 2
</code></pre>

<p><strong>è§£èª¬:</strong> åˆ¶ç´„æ¡ä»¶ã«ã‚ˆã‚Šå®Ÿè¡Œå¯èƒ½é ˜åŸŸï¼ˆç·‘è‰²ã®é ˜åŸŸï¼‰ãŒå®šç¾©ã•ã‚Œã¾ã™ã€‚æœ€é©è§£ã¯ã€å®Ÿè¡Œå¯èƒ½é ˜åŸŸå†…ã§ç›®çš„é–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹ç‚¹ã§ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€åˆ¶ç´„ $x_1 + x_2 \geq 2$ ã®å¢ƒç•Œä¸Šã«æœ€é©è§£ãŒå­˜åœ¨ã—ã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: å¤šå¤‰æ•°æœ€é©åŒ–å•é¡Œï¼ˆåå¿œå™¨ã®åç‡æœ€é©åŒ–ï¼‰</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

# åå¿œå™¨ã®åç‡ãƒ¢ãƒ‡ãƒ«
def reactor_yield(T, tau):
    """
    åå¿œå™¨ã®åç‡ãƒ¢ãƒ‡ãƒ«

    Parameters:
    T   : float, åå¿œæ¸©åº¦ [Â°C] (ç¯„å›²: 150-220Â°C)
    tau : float, æ»ç•™æ™‚é–“ [min] (ç¯„å›²: 10-60 min)

    Returns:
    yield : float, åç‡ [%]

    ãƒ¢ãƒ‡ãƒ«: æ¸©åº¦ã¨æ»ç•™æ™‚é–“ã®ä¸¡æ–¹ãŒåç‡ã«å½±éŸ¿
    - æ¸©åº¦ãŒé«˜ã„ã»ã©åå¿œé€Ÿåº¦ãŒé€Ÿã„ï¼ˆã‚¢ãƒ¬ãƒ‹ã‚¦ã‚¹å¼ï¼‰
    - æ»ç•™æ™‚é–“ãŒé•·ã„ã»ã©åå¿œãŒé€²ã‚€
    - ãŸã ã—ã€æ¸©åº¦ãŒé«˜ã™ããŸã‚Šæ»ç•™æ™‚é–“ãŒé•·ã™ãã‚‹ã¨å‰¯åå¿œãŒèµ·ã“ã‚‹
    """
    # æ­£è¦åŒ–
    T_norm = (T - 185) / 35
    tau_norm = (tau - 35) / 25

    # åç‡ãƒ¢ãƒ‡ãƒ«ï¼ˆã‚¬ã‚¦ã‚¹åˆ†å¸ƒçš„ãªå½¢çŠ¶ï¼‰
    yield_pct = 90 * np.exp(-0.5 * (T_norm**2 + tau_norm**2)) + \
                5 * T_norm * tau_norm

    # å‰¯åå¿œã®å½±éŸ¿ï¼ˆé«˜æ¸©ãƒ»é•·æ™‚é–“ã§åç‡ä½ä¸‹ï¼‰
    penalty = 0.3 * (T_norm**2 + tau_norm**2) * np.maximum(T_norm, 0) * np.maximum(tau_norm, 0)

    return yield_pct - penalty

# ã‚°ãƒªãƒƒãƒ‰ä½œæˆ
T_range = np.linspace(150, 220, 50)
tau_range = np.linspace(10, 60, 50)
T_grid, tau_grid = np.meshgrid(T_range, tau_range)
yield_grid = reactor_yield(T_grid, tau_grid)

# 3Dè¡¨é¢ãƒ—ãƒ­ãƒƒãƒˆ
fig = plt.figure(figsize=(14, 6))

# 3Dãƒ—ãƒ­ãƒƒãƒˆ
ax1 = fig.add_subplot(121, projection='3d')
surf = ax1.plot_surface(T_grid, tau_grid, yield_grid, cmap='viridis',
                         alpha=0.8, edgecolor='none')
ax1.set_xlabel('æ¸©åº¦ T [Â°C]', fontsize=10)
ax1.set_ylabel('æ»ç•™æ™‚é–“ Ï„ [min]', fontsize=10)
ax1.set_zlabel('åç‡ [%]', fontsize=10)
ax1.set_title('åå¿œå™¨åç‡ã®3Dè¡¨é¢ãƒ—ãƒ­ãƒƒãƒˆ', fontsize=12, fontweight='bold')
fig.colorbar(surf, ax=ax1, shrink=0.5)

# ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆ
ax2 = fig.add_subplot(122)
contour = ax2.contour(T_grid, tau_grid, yield_grid, levels=15, cmap='viridis')
ax2.contourf(T_grid, tau_grid, yield_grid, levels=15, cmap='viridis', alpha=0.4)
plt.colorbar(contour, ax=ax2, label='åç‡ [%]')

# æœ€é©ç‚¹ã®æ¢ç´¢
max_idx = np.unravel_index(np.argmax(yield_grid), yield_grid.shape)
T_opt = T_grid[max_idx]
tau_opt = tau_grid[max_idx]
yield_opt = yield_grid[max_idx]

ax2.scatter([T_opt], [tau_opt], color='red', s=200, zorder=5, marker='*',
            edgecolors='black', linewidth=2, label=f'æœ€é©ç‚¹ ({T_opt:.1f}Â°C, {tau_opt:.1f}min)')
ax2.set_xlabel('æ¸©åº¦ T [Â°C]', fontsize=11)
ax2.set_ylabel('æ»ç•™æ™‚é–“ Ï„ [min]', fontsize=11)
ax2.set_title('åå¿œå™¨åç‡ã®ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆ', fontsize=12, fontweight='bold')
ax2.legend(fontsize=10)
ax2.grid(alpha=0.3)

plt.tight_layout()
plt.show()

print(f"æœ€é©é‹è»¢æ¡ä»¶:")
print(f"  æ¸©åº¦: T* = {T_opt:.2f}Â°C")
print(f"  æ»ç•™æ™‚é–“: Ï„* = {tau_opt:.2f} min")
print(f"  æœ€å¤§åç‡: {yield_opt:.2f}%")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>æœ€é©é‹è»¢æ¡ä»¶:
  æ¸©åº¦: T* = 185.71Â°C
  æ»ç•™æ™‚é–“: Ï„* = 35.10 min
  æœ€å¤§åç‡: 89.87%
</code></pre>

<p><strong>è§£èª¬:</strong> åŒ–å­¦åå¿œå™¨ã®åç‡ã¯ã€æ¸©åº¦ã¨æ»ç•™æ™‚é–“ã®ä¸¡æ–¹ã«ä¾å­˜ã—ã¾ã™ã€‚3Dè¡¨é¢ãƒ—ãƒ­ãƒƒãƒˆã¨ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆã«ã‚ˆã‚Šã€æœ€é©ãªé‹è»¢æ¡ä»¶ã‚’è¦–è¦šçš„ã«æŠŠæ¡ã§ãã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: ã‚³ã‚¹ãƒˆé–¢æ•°ã®è¨­è¨ˆã¨ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•åˆ†æ</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ã‚³ã‚¹ãƒˆé–¢æ•°ã®å„è¦ç´ 
def energy_cost(T):
    """ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆï¼ˆæ¸©åº¦ã«æ¯”ä¾‹ï¼‰"""
    return 0.5 * T  # $/h

def raw_material_cost(tau):
    """åŸæ–™ã‚³ã‚¹ãƒˆï¼ˆæ»ç•™æ™‚é–“ã«åæ¯”ä¾‹ã€çŸ­ã„ã¨åŸæ–™æå¤±ï¼‰"""
    return 500 / (tau + 10)  # $/h

def product_value(T, tau):
    """è£½å“ä¾¡å€¤ï¼ˆåç‡ä¾å­˜ï¼‰"""
    yield_pct = reactor_yield(T, tau)
    return 10 * yield_pct  # $/h

def total_cost(T, tau):
    """ç·ã‚³ã‚¹ãƒˆé–¢æ•°ï¼ˆæœ€å°åŒ–å¯¾è±¡ï¼‰"""
    cost = energy_cost(T) + raw_material_cost(tau) - product_value(T, tau)
    return cost

# å‰ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã®reactor_yieldé–¢æ•°ã‚’ä½¿ç”¨
def reactor_yield(T, tau):
    T_norm = (T - 185) / 35
    tau_norm = (tau - 35) / 25
    yield_pct = 90 * np.exp(-0.5 * (T_norm**2 + tau_norm**2)) + 5 * T_norm * tau_norm
    penalty = 0.3 * (T_norm**2 + tau_norm**2) * np.maximum(T_norm, 0) * np.maximum(tau_norm, 0)
    return yield_pct - penalty

# ã‚°ãƒªãƒƒãƒ‰ä½œæˆ
T_range = np.linspace(150, 220, 50)
tau_range = np.linspace(15, 60, 50)
T_grid, tau_grid = np.meshgrid(T_range, tau_range)
cost_grid = total_cost(T_grid, tau_grid)

# æœ€é©ç‚¹ã®æ¢ç´¢
min_idx = np.unravel_index(np.argmin(cost_grid), cost_grid.shape)
T_opt = T_grid[min_idx]
tau_opt = tau_grid[min_idx]
cost_opt = cost_grid[min_idx]

# å¯è¦–åŒ–
plt.figure(figsize=(12, 5))

# ã‚³ã‚¹ãƒˆé–¢æ•°ã®ç­‰é«˜ç·š
plt.subplot(1, 2, 1)
contour = plt.contour(T_grid, tau_grid, cost_grid, levels=20, cmap='RdYlGn_r')
plt.contourf(T_grid, tau_grid, cost_grid, levels=20, cmap='RdYlGn_r', alpha=0.4)
plt.colorbar(contour, label='ç·ã‚³ã‚¹ãƒˆ [$/h]')
plt.scatter([T_opt], [tau_opt], color='red', s=200, zorder=5, marker='*',
            edgecolors='black', linewidth=2, label=f'æœ€é©ç‚¹')
plt.xlabel('æ¸©åº¦ T [Â°C]', fontsize=11)
plt.ylabel('æ»ç•™æ™‚é–“ Ï„ [min]', fontsize=11)
plt.title('ç·ã‚³ã‚¹ãƒˆé–¢æ•°ã®æœ€å°åŒ–', fontsize=12, fontweight='bold')
plt.legend()
plt.grid(alpha=0.3)

# ã‚³ã‚¹ãƒˆè¦ç´ ã®å†…è¨³
tau_fixed = 35
T_test = np.linspace(150, 220, 100)
energy_costs = [energy_cost(T) for T in T_test]
product_values = [product_value(T, tau_fixed) for T in T_test]
raw_costs = [raw_material_cost(tau_fixed) for _ in T_test]

plt.subplot(1, 2, 2)
plt.plot(T_test, energy_costs, label='ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ', linewidth=2)
plt.plot(T_test, product_values, label='è£½å“ä¾¡å€¤', linewidth=2)
plt.axhline(y=raw_costs[0], color='orange', linestyle='--', linewidth=2, label='åŸæ–™ã‚³ã‚¹ãƒˆ')
plt.xlabel('æ¸©åº¦ T [Â°C]', fontsize=11)
plt.ylabel('ã‚³ã‚¹ãƒˆ/ä¾¡å€¤ [$/h]', fontsize=11)
plt.title(f'ã‚³ã‚¹ãƒˆè¦ç´ ã®å†…è¨³ï¼ˆÏ„ = {tau_fixed} minå›ºå®šï¼‰', fontsize=12, fontweight='bold')
plt.legend()
plt.grid(alpha=0.3)

plt.tight_layout()
plt.show()

print(f"æœ€é©é‹è»¢æ¡ä»¶ï¼ˆã‚³ã‚¹ãƒˆæœ€å°åŒ–ï¼‰:")
print(f"  æ¸©åº¦: T* = {T_opt:.2f}Â°C")
print(f"  æ»ç•™æ™‚é–“: Ï„* = {tau_opt:.2f} min")
print(f"  æœ€å°ç·ã‚³ã‚¹ãƒˆ: {cost_opt:.2f} $/h")
print(f"\nã‚³ã‚¹ãƒˆå†…è¨³:")
print(f"  ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ: {energy_cost(T_opt):.2f} $/h")
print(f"  åŸæ–™ã‚³ã‚¹ãƒˆ: {raw_material_cost(tau_opt):.2f} $/h")
print(f"  è£½å“ä¾¡å€¤: {product_value(T_opt, tau_opt):.2f} $/h")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>æœ€é©é‹è»¢æ¡ä»¶ï¼ˆã‚³ã‚¹ãƒˆæœ€å°åŒ–ï¼‰:
  æ¸©åº¦: T* = 185.71Â°C
  æ»ç•™æ™‚é–“: Ï„* = 38.37 min
  æœ€å°ç·ã‚³ã‚¹ãƒˆ: -786.45 $/h

ã‚³ã‚¹ãƒˆå†…è¨³:
  ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆ: 92.86 $/h
  åŸæ–™ã‚³ã‚¹ãƒˆ: 10.34 $/h
  è£½å“ä¾¡å€¤: 889.64 $/h
</code></pre>

<p><strong>è§£èª¬:</strong> å®Ÿéš›ã®ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ã§ã¯ã€è¤‡æ•°ã®ã‚³ã‚¹ãƒˆè¦ç´ ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã€åŸæ–™ã€è£½å“ä¾¡å€¤ï¼‰ã‚’çµ±åˆã—ãŸç·ã‚³ã‚¹ãƒˆé–¢æ•°ã‚’è¨­è¨ˆã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€è£½å“ä¾¡å€¤ã‚’æœ€å¤§åŒ–ã—ã¤ã¤ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚³ã‚¹ãƒˆã¨åŸæ–™ã‚³ã‚¹ãƒˆã‚’æœ€å°åŒ–ã™ã‚‹æœ€é©ãªé‹è»¢æ¡ä»¶ã‚’æ±‚ã‚ã¦ã„ã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: å‹¾é…ã®è¨ˆç®—ã¨å¯è¦–åŒ–</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ç›®çš„é–¢æ•°
def f(x1, x2):
    return x1**2 + 2*x2**2

# å‹¾é…ã®è§£æçš„è¨ˆç®—
def gradient(x1, x2):
    """
    å‹¾é…ãƒ™ã‚¯ãƒˆãƒ« âˆ‡f = [âˆ‚f/âˆ‚x1, âˆ‚f/âˆ‚x2]
    """
    df_dx1 = 2 * x1
    df_dx2 = 4 * x2
    return np.array([df_dx1, df_dx2])

# ã‚°ãƒªãƒƒãƒ‰ä½œæˆ
x1 = np.linspace(-3, 3, 20)
x2 = np.linspace(-3, 3, 20)
X1, X2 = np.meshgrid(x1, x2)

# å„ç‚¹ã§ã®å‹¾é…è¨ˆç®—
U = np.zeros_like(X1)
V = np.zeros_like(X2)

for i in range(X1.shape[0]):
    for j in range(X1.shape[1]):
        grad = gradient(X1[i, j], X2[i, j])
        U[i, j] = -grad[0]  # è² ã®å‹¾é…æ–¹å‘ï¼ˆæœ€å°åŒ–æ–¹å‘ï¼‰
        V[i, j] = -grad[1]

# ç›®çš„é–¢æ•°å€¤
Z = f(X1, X2)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 8))
contour = plt.contour(X1, X2, Z, levels=15, cmap='viridis', alpha=0.6)
plt.contourf(X1, X2, Z, levels=15, cmap='viridis', alpha=0.3)
plt.colorbar(contour, label='f(xâ‚, xâ‚‚)')

# å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ã®ãƒ—ãƒ­ãƒƒãƒˆ
plt.quiver(X1, X2, U, V, color='red', alpha=0.6, scale=50, width=0.003,
           label='è² ã®å‹¾é…æ–¹å‘ï¼ˆæœ€å°åŒ–æ–¹å‘ï¼‰')

plt.scatter([0], [0], color='yellow', s=250, zorder=5, marker='*',
            edgecolors='black', linewidth=2, label='æœ€é©è§£ (0, 0)')

plt.xlabel('xâ‚', fontsize=12)
plt.ylabel('xâ‚‚', fontsize=12)
plt.title('å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰', fontsize=14, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3)
plt.axis('equal')
plt.tight_layout()
plt.show()

# ç‰¹å®šç‚¹ã§ã®å‹¾é…è¨ˆç®—ä¾‹
x1_test, x2_test = 2.0, 1.5
grad_test = gradient(x1_test, x2_test)
print(f"ç‚¹ ({x1_test}, {x2_test}) ã§ã®å‹¾é…:")
print(f"  âˆ‡f = [{grad_test[0]:.2f}, {grad_test[1]:.2f}]")
print(f"  å‹¾é…ã®ãƒãƒ«ãƒ : ||âˆ‡f|| = {np.linalg.norm(grad_test):.2f}")
print(f"\næœ€é©è§£ (0, 0) ã§ã®å‹¾é…:")
grad_opt = gradient(0, 0)
print(f"  âˆ‡f = [{grad_opt[0]:.2f}, {grad_opt[1]:.2f}]  ï¼ˆæœ€é©ç‚¹ã§ã¯å‹¾é… = 0ï¼‰")
</code></pre>

<p><strong>å‡ºåŠ›:</strong></p>
<pre><code>ç‚¹ (2.0, 1.5) ã§ã®å‹¾é…:
  âˆ‡f = [4.00, 6.00]
  å‹¾é…ã®ãƒãƒ«ãƒ : ||âˆ‡f|| = 7.21

æœ€é©è§£ (0, 0) ã§ã®å‹¾é…:
  âˆ‡f = [0.00, 0.00]  ï¼ˆæœ€é©ç‚¹ã§ã¯å‹¾é… = 0ï¼‰
</code></pre>

<p><strong>è§£èª¬:</strong> å‹¾é…ãƒ™ã‚¯ãƒˆãƒ« $\nabla f$ ã¯ã€ç›®çš„é–¢æ•°ãŒæœ€ã‚‚æ€¥æ¿€ã«å¢—åŠ ã™ã‚‹æ–¹å‘ã‚’æŒ‡ã—ã¾ã™ã€‚æœ€å°åŒ–å•é¡Œã§ã¯ã€è² ã®å‹¾é…æ–¹å‘ï¼ˆ$-\nabla f$ï¼‰ã«é€²ã‚€ã“ã¨ã§ç›®çš„é–¢æ•°ã‚’æ¸›å°‘ã•ã›ã¾ã™ã€‚æœ€é©è§£ã§ã¯å‹¾é…ãŒã‚¼ãƒ­ã«ãªã‚Šã¾ã™ï¼ˆ$\nabla f = \mathbf{0}$ï¼‰ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹8: æ„Ÿåº¦åˆ†æï¼ˆç›®çš„é–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ„Ÿåº¦ï¼‰</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»˜ãç›®çš„é–¢æ•°
def objective_with_param(T, k):
    """
    ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿kã‚’å«ã‚€ç›®çš„é–¢æ•°
    k: åå¿œé€Ÿåº¦å®šæ•°ã®ã‚ˆã†ãªç‰©ç†ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    """
    return -k * T * np.exp(-1000 / (T + 273)) + 0.5 * T

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿kã®ç¯„å›²
k_values = [0.5, 1.0, 1.5, 2.0]
T_range = np.linspace(100, 300, 200)

# æ„Ÿåº¦åˆ†æ
plt.figure(figsize=(14, 5))

# ç›®çš„é–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾å­˜æ€§
plt.subplot(1, 2, 1)
for k in k_values:
    obj_values = [objective_with_param(T, k) for T in T_range]
    plt.plot(T_range, obj_values, linewidth=2, label=f'k = {k}')

plt.xlabel('æ¸©åº¦ T [Â°C]', fontsize=12)
plt.ylabel('ç›®çš„é–¢æ•°å€¤', fontsize=12)
plt.title('ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿kã«ã‚ˆã‚‹ç›®çš„é–¢æ•°ã®å¤‰åŒ–', fontsize=13, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3)

# æœ€é©è§£ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾å­˜æ€§
plt.subplot(1, 2, 2)
k_range = np.linspace(0.2, 3, 50)
T_optimal_list = []

for k in k_range:
    obj_values = [objective_with_param(T, k) for T in T_range]
    T_optimal = T_range[np.argmin(obj_values)]
    T_optimal_list.append(T_optimal)

plt.plot(k_range, T_optimal_list, linewidth=2.5, color='#11998e')
plt.xlabel('ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ k', fontsize=12)
plt.ylabel('æœ€é©æ¸©åº¦ T* [Â°C]', fontsize=12)
plt.title('ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿kã«å¯¾ã™ã‚‹æœ€é©æ¸©åº¦ã®æ„Ÿåº¦', fontsize=13, fontweight='bold')
plt.grid(alpha=0.3)

plt.tight_layout()
plt.show()

# æ„Ÿåº¦ã®å®šé‡åŒ–
k_nominal = 1.0
k_perturbed = 1.1
delta_k = k_perturbed - k_nominal

obj_nominal = [objective_with_param(T, k_nominal) for T in T_range]
T_opt_nominal = T_range[np.argmin(obj_nominal)]

obj_perturbed = [objective_with_param(T, k_perturbed) for T in T_range]
T_opt_perturbed = T_range[np.argmin(obj_perturbed)]

delta_T = T_opt_perturbed - T_opt_nominal

sensitivity = delta_T / delta_k

print(f"æ„Ÿåº¦åˆ†æçµæœ:")
print(f"  ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰åŒ–: Î”k = {delta_k:.2f}")
print(f"  æœ€é©æ¸©åº¦ã®å¤‰åŒ–: Î”T* = {delta_T:.2f}Â°C")
print(f"  æ„Ÿåº¦: dT*/dk â‰ˆ {sensitivity:.2f}Â°C")
print(f"\nè§£é‡ˆ: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿kãŒ10%å¢—åŠ ã™ã‚‹ã¨ã€æœ€é©æ¸©åº¦ã¯ç´„{delta_T:.2f}Â°Cå¤‰åŒ–ã—ã¾ã™ã€‚")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>æ„Ÿåº¦åˆ†æçµæœ:
  ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰åŒ–: Î”k = 0.10
  æœ€é©æ¸©åº¦ã®å¤‰åŒ–: Î”T* = 5.53Â°C
  æ„Ÿåº¦: dT*/dk â‰ˆ 55.28Â°C

è§£é‡ˆ: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿kãŒ10%å¢—åŠ ã™ã‚‹ã¨ã€æœ€é©æ¸©åº¦ã¯ç´„5.53Â°Cå¤‰åŒ–ã—ã¾ã™ã€‚
</code></pre>

<p><strong>è§£èª¬:</strong> æ„Ÿåº¦åˆ†æã«ã‚ˆã‚Šã€ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å¤‰å‹•ãŒæœ€é©è§£ã«ã©ã®ç¨‹åº¦å½±éŸ¿ã™ã‚‹ã‹ã‚’è©•ä¾¡ã§ãã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸ç¢ºå®Ÿæ€§ã‚„ãƒ­ãƒã‚¹ãƒˆæ€§ã‚’è©•ä¾¡ã™ã‚‹ä¸Šã§é‡è¦ã§ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹9: å•é¡Œå¤‰æ›ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ï¼ˆåˆ¶ç´„ãªã—å•é¡Œã¸ã®å¤‰æ›ï¼‰</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# å…ƒã®åˆ¶ç´„ä»˜ãæœ€é©åŒ–å•é¡Œ
# minimize f(x) = x^2
# subject to x >= 1

def original_objective(x):
    return x**2

def constraint(x):
    """åˆ¶ç´„æ¡ä»¶ g(x) = 1 - x <= 0  â†’  x >= 1"""
    return 1 - x

# ãƒšãƒŠãƒ«ãƒ†ã‚£æ³•ã«ã‚ˆã‚‹å¤‰æ›
def penalty_objective(x, mu):
    """
    ãƒšãƒŠãƒ«ãƒ†ã‚£é–¢æ•°: f_penalty(x) = f(x) + Î¼ * max(0, g(x))^2

    Parameters:
    x  : æ±ºå®šå¤‰æ•°
    mu : ãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆå¤§ãã„ã»ã©åˆ¶ç´„ã‚’å³ã—ãï¼‰
    """
    penalty = mu * max(0, constraint(x))**2
    return original_objective(x) + penalty

# xç¯„å›²
x_range = np.linspace(0, 3, 300)

# ç•°ãªã‚‹ãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã®æ¯”è¼ƒ
mu_values = [0, 10, 100, 1000]

plt.figure(figsize=(14, 5))

# ãƒšãƒŠãƒ«ãƒ†ã‚£é–¢æ•°ã®ãƒ—ãƒ­ãƒƒãƒˆ
plt.subplot(1, 2, 1)
for mu in mu_values:
    penalty_values = [penalty_objective(x, mu) for x in x_range]
    if mu == 0:
        plt.plot(x_range, penalty_values, linewidth=2, label=f'Î¼ = {mu} (å…ƒã®é–¢æ•°)', linestyle='--')
    else:
        plt.plot(x_range, penalty_values, linewidth=2, label=f'Î¼ = {mu}')

plt.axvline(x=1, color='red', linestyle='--', linewidth=1.5, alpha=0.7, label='åˆ¶ç´„å¢ƒç•Œ x = 1')
plt.xlabel('x', fontsize=12)
plt.ylabel('ç›®çš„é–¢æ•°å€¤', fontsize=12)
plt.title('ãƒšãƒŠãƒ«ãƒ†ã‚£æ³•ã«ã‚ˆã‚‹åˆ¶ç´„ãªã—å•é¡Œã¸ã®å¤‰æ›', fontsize=13, fontweight='bold')
plt.legend(fontsize=9)
plt.ylim(0, 10)
plt.grid(alpha=0.3)

# æœ€é©è§£ã®ãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä¾å­˜æ€§
plt.subplot(1, 2, 2)
mu_range = np.logspace(0, 4, 50)
x_optimal_list = []

for mu in mu_range:
    penalty_values = [penalty_objective(x, mu) for x in x_range]
    x_optimal = x_range[np.argmin(penalty_values)]
    x_optimal_list.append(x_optimal)

plt.semilogx(mu_range, x_optimal_list, linewidth=2.5, color='#11998e')
plt.axhline(y=1, color='red', linestyle='--', linewidth=1.5, label='çœŸã®æœ€é©è§£ x* = 1')
plt.xlabel('ãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î¼', fontsize=12)
plt.ylabel('æœ€é©è§£ x*', fontsize=12)
plt.title('ãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½±éŸ¿', fontsize=13, fontweight='bold')
plt.legend(fontsize=10)
plt.grid(alpha=0.3, which='both')

plt.tight_layout()
plt.show()

# æ•°å€¤è¨ˆç®—çµæœ
print("ãƒšãƒŠãƒ«ãƒ†ã‚£æ³•ã«ã‚ˆã‚‹æœ€é©è§£ã®åæŸ:")
print("Î¼        x*       f(x*)    åˆ¶ç´„é•å")
print("-" * 45)
for mu in [1, 10, 100, 1000, 10000]:
    penalty_values = [penalty_objective(x, mu) for x in x_range]
    idx_opt = np.argmin(penalty_values)
    x_opt = x_range[idx_opt]
    f_opt = penalty_values[idx_opt]
    violation = max(0, constraint(x_opt))
    print(f"{mu:6.0f}   {x_opt:6.4f}   {f_opt:7.4f}   {violation:7.4f}")

print("\nçœŸã®æœ€é©è§£: x* = 1.0, f(x*) = 1.0")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>ãƒšãƒŠãƒ«ãƒ†ã‚£æ³•ã«ã‚ˆã‚‹æœ€é©è§£ã®åæŸ:
Î¼        x*       f(x*)    åˆ¶ç´„é•å
---------------------------------------------
     1    0.6689    0.4474    0.3311
    10    0.9045    0.8182    0.0955
   100    0.9901    0.9802    0.0099
  1000    0.9990    0.9980    0.0010
 10000    0.9999    0.9998    0.0001

çœŸã®æœ€é©è§£: x* = 1.0, f(x*) = 1.0
</code></pre>

<p><strong>è§£èª¬:</strong> ãƒšãƒŠãƒ«ãƒ†ã‚£æ³•ã¯ã€åˆ¶ç´„æ¡ä»¶ã‚’ç›®çš„é–¢æ•°ã«ãƒšãƒŠãƒ«ãƒ†ã‚£é …ã¨ã—ã¦çµ„ã¿è¾¼ã‚€ã“ã¨ã§ã€åˆ¶ç´„ä»˜ãå•é¡Œã‚’åˆ¶ç´„ãªã—å•é¡Œã«å¤‰æ›ã—ã¾ã™ã€‚ãƒšãƒŠãƒ«ãƒ†ã‚£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ $\mu$ ã‚’å¤§ããã™ã‚‹ã»ã©ã€æœ€é©è§£ã¯çœŸã®åˆ¶ç´„ä»˜ãæœ€é©è§£ã«è¿‘ã¥ãã¾ã™ã€‚</p>

<hr />

<h2>1.3 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><strong>æœ€é©åŒ–å•é¡Œã®åŸºæœ¬è¦ç´ </strong>
<ul>
<li>ç›®çš„é–¢æ•°ã€æ±ºå®šå¤‰æ•°ã€åˆ¶ç´„æ¡ä»¶ã®å®šç¾©</li>
<li>å®Ÿè¡Œå¯èƒ½é ˜åŸŸã¨æœ€é©è§£ã®æ¦‚å¿µ</li>
</ul>
</li>
<li><strong>åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ã®å®šå¼åŒ–</strong>
<ul>
<li>åˆ©ç›Šæœ€å¤§åŒ–ã€ã‚³ã‚¹ãƒˆæœ€å°åŒ–ã€åç‡æœ€å¤§åŒ–å•é¡Œ</li>
<li>çµŒæ¸ˆçš„ãƒ»æŠ€è¡“çš„ç›®çš„é–¢æ•°ã®è¨­è¨ˆ</li>
</ul>
</li>
<li><strong>å¯è¦–åŒ–æ‰‹æ³•</strong>
<ul>
<li>ç­‰é«˜ç·šãƒ—ãƒ­ãƒƒãƒˆã€3Dè¡¨é¢ãƒ—ãƒ­ãƒƒãƒˆ</li>
<li>å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰</li>
<li>å®Ÿè¡Œå¯èƒ½é ˜åŸŸã®è¡¨ç¤º</li>
</ul>
</li>
<li><strong>æ„Ÿåº¦åˆ†æã¨å•é¡Œå¤‰æ›</strong>
<ul>
<li>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ„Ÿåº¦ã®è©•ä¾¡</li>
<li>ãƒšãƒŠãƒ«ãƒ†ã‚£æ³•ã«ã‚ˆã‚‹åˆ¶ç´„ãªã—å•é¡Œã¸ã®å¤‰æ›</li>
</ul>
</li>
</ol>

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

<ul>
<li>æœ€é©åŒ–å•é¡Œã¯ã€ç›®çš„é–¢æ•°ã€æ±ºå®šå¤‰æ•°ã€åˆ¶ç´„æ¡ä»¶ã®3è¦ç´ ã§æ§‹æˆã•ã‚Œã‚‹</li>
<li>åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€åç‡ãƒ»çµŒæ¸ˆæ€§ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼åŠ¹ç‡ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ãŒé‡è¦</li>
<li>å¯è¦–åŒ–ã«ã‚ˆã‚Šã€æœ€é©è§£ã®ä½ç½®ã¨ç‰¹æ€§ã‚’ç›´æ„Ÿçš„ã«ç†è§£ã§ãã‚‹</li>
<li>å‹¾é…ã¯æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®åŸºç¤ã§ã‚ã‚Šã€æœ€é©ç‚¹ã§ã¯å‹¾é…ãŒã‚¼ãƒ­ã«ãªã‚‹</li>
<li>ãƒšãƒŠãƒ«ãƒ†ã‚£æ³•ã«ã‚ˆã‚Šã€åˆ¶ç´„ä»˜ãå•é¡Œã‚’åˆ¶ç´„ãªã—å•é¡Œã«å¤‰æ›ã§ãã‚‹</li>
</ul>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬2ç« ã§ã¯ã€<strong>ç·šå½¢è¨ˆç”»æ³•ãƒ»éç·šå½¢è¨ˆç”»æ³•</strong>ã‚’è©³ã—ãå­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>ã‚·ãƒ³ãƒ—ãƒ¬ãƒƒã‚¯ã‚¹æ³•ã¨ç·šå½¢è¨ˆç”»å•é¡Œã®è§£æ³•</li>
<li>å‹¾é…é™ä¸‹æ³•ã€ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³æ³•ã€æº–ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³æ³•</li>
<li>scipy.optimizeã¨PuLPãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ´»ç”¨</li>
<li>æœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¯”è¼ƒã¨é¸æŠ</li>
</ul>

<div class="navigation">
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-2.html" class="nav-button">æ¬¡ã®ç«  â†’</a>
</div>
    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: PI Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-26</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 PI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
