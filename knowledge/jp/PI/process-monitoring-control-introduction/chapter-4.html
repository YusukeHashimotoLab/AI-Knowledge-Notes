<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬4ç« ï¼šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡ã¨PIDåˆ¶å¾¡ - ãƒ—ãƒ­ã‚»ã‚¹åˆ¶å¾¡ã®åŸºç¤ã‹ã‚‰å®Ÿè£…ã¾ã§">
    <title>ç¬¬4ç« ï¼šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡ã¨PIDåˆ¶å¾¡ - PI Terakoya</title>

        <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8; color: #333; background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; padding: 2rem 1rem; text-align: center;
        }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; font-size: 1.1rem; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
        .back-link {
            display: inline-block; margin-bottom: 2rem; padding: 0.5rem 1rem;
            background: white; color: #11998e; text-decoration: none;
            border-radius: 6px; font-weight: 600;
        }
        .content-box {
            background: white; padding: 2rem; border-radius: 12px;
            margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #11998e; margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem; border-bottom: 3px solid #11998e;
        }
        h3 { color: #2c3e50; margin: 1.5rem 0 1rem 0; }
        h4 { color: #2c3e50; margin: 1rem 0 0.5rem 0; }
        p { margin-bottom: 1rem; }
        ul, ol { margin-left: 2rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
        pre {
            background: #1e1e1e; color: #d4d4d4; padding: 1.5rem;
            border-radius: 8px; overflow-x: auto; margin: 1rem 0;
            border-left: 4px solid #11998e;
        }
        code {
            font-family: 'Courier New', monospace; font-size: 0.9rem;
        }
        .key-point {
            background: #e8f5e9; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #4caf50; margin: 1rem 0;
        }
        .tech-note {
            background: #e3f2fd; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #2196f3; margin: 1rem 0;
        }
        .formula {
            background: #f0f7ff; padding: 1rem; border-radius: 6px;
            margin: 1rem 0; overflow-x: auto;
        }
        table {
            width: 100%; border-collapse: collapse; margin: 1rem 0;
        }
        th, td {
            border: 1px solid #ddd; padding: 0.75rem; text-align: left;
        }
        th {
            background: #11998e; color: white; font-weight: 600;
        }
        tr:nth-child(even) { background: #f9f9f9; }
        .nav-buttons {
            display: flex; justify-content: space-between; margin-top: 3rem;
        }
        .nav-buttons a {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; text-decoration: none; border-radius: 6px;
            font-weight: 600;
        }
        footer {
            background: #2c3e50; color: white; text-align: center;
            padding: 2rem 1rem; margin-top: 4rem;
        }
        @media (max-width: 768px) {
            h1 { font-size: 1.6rem; }
            .container { padding: 0 0.5rem; }
            pre { padding: 1rem; }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>
</head>
<body>
    <header>
        <div class="container">
            <h1>ç¬¬4ç« ï¼šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡ã¨PIDåˆ¶å¾¡</h1>
            <p class="subtitle">ãƒ—ãƒ­ã‚»ã‚¹åˆ¶å¾¡ã®åŸºç¤ç†è«–ã‹ã‚‰å®Ÿè£…ã¾ã§</p>
            <div class="meta">
                <span class="meta">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">

<div class="learning-objectives">
<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡ã®åŸºæœ¬åŸç†ã¨åˆ¶å¾¡ç³»ã®æ§‹æˆã‚’èª¬æ˜ã§ãã‚‹</li>
<li>âœ… 1æ¬¡ç³»ã®ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ã¨å‹•ç‰¹æ€§ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… PIDåˆ¶å¾¡å™¨ã®å„è¦ç´ ï¼ˆP, I, Dï¼‰ã®å½¹å‰²ã¨åŠ¹æœã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… Pythonã§1æ¬¡ç³»ã¨PIDåˆ¶å¾¡å™¨ã‚’å®Ÿè£…ãƒ»ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã§ãã‚‹</li>
<li>âœ… ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ã§PIDãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ±ºå®šã§ãã‚‹</li>
<li>âœ… ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãªã©å®Ÿç”¨çš„ãªåˆ¶å¾¡å•é¡Œã«å¯¾å‡¦ã§ãã‚‹</li>
<li>âœ… ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã®åŸºæœ¬æ§‹é€ ã‚’ç†è§£ã™ã‚‹</li>
</ul>
</div>

<hr />

<h2>4.1 ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡ã®åŸºç¤</h2>

<h3>ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡ã¨ã¯</h3>

<p><strong>ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡</strong>ã¯ã€åˆ¶å¾¡å¯¾è±¡ã®å‡ºåŠ›ï¼ˆåˆ¶å¾¡é‡ï¼‰ã‚’æ¸¬å®šã—ã€ç›®æ¨™å€¤ï¼ˆè¨­å®šå€¤ï¼‰ã¨ã®åå·®ã‚’ã‚¼ãƒ­ã«ã™ã‚‹ã‚ˆã†ã«åˆ¶å¾¡å…¥åŠ›ï¼ˆæ“ä½œé‡ï¼‰ã‚’èª¿æ•´ã™ã‚‹åˆ¶å¾¡æ–¹å¼ã§ã™ã€‚ãƒ—ãƒ­ã‚»ã‚¹ç”£æ¥­ã«ãŠã„ã¦æœ€ã‚‚åºƒãä½¿ç”¨ã•ã‚Œã‚‹åˆ¶å¾¡æ‰‹æ³•ã§ã™ã€‚</p>

<h3>åˆ¶å¾¡ç³»ã®åŸºæœ¬æ§‹æˆ</h3>

<div class="mermaid">
graph LR
    SP[è¨­å®šå€¤<br/>Setpoint] --> SUM((+<br/>-))
    SUM --> |åå·® e| CTRL[åˆ¶å¾¡å™¨<br/>Controller]
    CTRL --> |æ“ä½œé‡ u| PROCESS[ãƒ—ãƒ­ã‚»ã‚¹<br/>Process]
    PROCESS --> |åˆ¶å¾¡é‡ y| OUTPUT[å‡ºåŠ›]
    OUTPUT --> |ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯| SUM

    style SP fill:#e8f5e9
    style CTRL fill:#c8e6c9
    style PROCESS fill:#a5d6a7
    style OUTPUT fill:#81c784
</div>

<p><strong>ä¸»è¦ãªè¦ç´ :</strong></p>
<ul>
<li><strong>è¨­å®šå€¤ï¼ˆSP: Setpointï¼‰</strong>: åˆ¶å¾¡é‡ã®ç›®æ¨™å€¤ï¼ˆä¾‹: åå¿œå™¨æ¸©åº¦ 175Â°Cï¼‰</li>
<li><strong>åˆ¶å¾¡é‡ï¼ˆPV: Process Variableï¼‰</strong>: å®Ÿéš›ã«æ¸¬å®šã•ã‚Œã‚‹ãƒ—ãƒ­ã‚»ã‚¹å¤‰æ•°</li>
<li><strong>åå·®ï¼ˆe: Errorï¼‰</strong>: è¨­å®šå€¤ã¨åˆ¶å¾¡é‡ã®å·®ï¼ˆe = SP - PVï¼‰</li>
<li><strong>æ“ä½œé‡ï¼ˆMV: Manipulated Variableï¼‰</strong>: åˆ¶å¾¡å™¨ãŒå‡ºåŠ›ã™ã‚‹ä¿¡å·ï¼ˆä¾‹: ãƒãƒ«ãƒ–é–‹åº¦ã€ãƒ’ãƒ¼ã‚¿ãƒ¼å‡ºåŠ›ï¼‰</li>
<li><strong>å¤–ä¹±ï¼ˆDisturbanceï¼‰</strong>: ãƒ—ãƒ­ã‚»ã‚¹ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹äºˆæœŸã—ãªã„å¤‰åŒ–</li>
</ul>

<h3>ä¼é”é–¢æ•°ã¨å‹•çš„ã‚·ã‚¹ãƒ†ãƒ </h3>

<p>ãƒ—ãƒ­ã‚»ã‚¹ã®å‹•ç‰¹æ€§ã¯ã€<strong>ä¼é”é–¢æ•°</strong>ã§è¡¨ç¾ã•ã‚Œã¾ã™ã€‚æœ€ã‚‚åŸºæœ¬çš„ãªãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«ã¯<strong>1æ¬¡é…ã‚Œç³»</strong>ã§ã™ï¼š</p>

<p style="text-align: center; font-size: 1.1rem; margin: 1.5rem 0;">
<strong>G(s) = K / (Ï„s + 1)</strong>
</p>

<p>ã“ã“ã§ï¼š</p>
<ul>
<li><strong>K</strong>: ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³ï¼ˆå®šå¸¸çŠ¶æ…‹ã§ã®å…¥å‡ºåŠ›æ¯”ï¼‰</li>
<li><strong>Ï„</strong>: æ™‚å®šæ•°ï¼ˆãƒ—ãƒ­ã‚»ã‚¹ã®å¿œç­”é€Ÿåº¦ã‚’è¡¨ã™ï¼‰</li>
<li><strong>s</strong>: ãƒ©ãƒ—ãƒ©ã‚¹å¤‰æ•°</li>
</ul>

<hr />

<h2>4.2 ã‚³ãƒ¼ãƒ‰ä¾‹ï¼š1æ¬¡ç³»ã¨PIDåˆ¶å¾¡ã®å®Ÿè£…</h2>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: 1æ¬¡ç³»ã®ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>

<p><strong>ç›®çš„</strong>: åå¿œå™¨æ¸©åº¦åˆ¶å¾¡ã‚’ä¾‹ã«ã€1æ¬¡é…ã‚Œç³»ã®ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ã‚’å¯è¦–åŒ–ã—ã€æ™‚å®šæ•°ã¨ã‚²ã‚¤ãƒ³ã®å½±éŸ¿ã‚’ç†è§£ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint

# æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆè¨­å®š
plt.rcParams['font.sans-serif'] = ['Hiragino Sans', 'Arial']
plt.rcParams['axes.unicode_minus'] = False

def first_order_system(y, t, K, tau, u):
    """
    1æ¬¡é…ã‚Œç³»ã®å¾®åˆ†æ–¹ç¨‹å¼

    Ï„ * dy/dt + y = K * u

    Parameters:
    -----------
    y : float
        åˆ¶å¾¡é‡ï¼ˆæ¸©åº¦ï¼‰
    t : float
        æ™‚é–“
    K : float
        ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³
    tau : float
        æ™‚å®šæ•°ï¼ˆç§’ï¼‰
    u : float
        æ“ä½œé‡ï¼ˆãƒ’ãƒ¼ã‚¿ãƒ¼å‡ºåŠ›ï¼‰

    Returns:
    --------
    dydt : float
        åˆ¶å¾¡é‡ã®æ™‚é–“å¾®åˆ†
    """
    dydt = (K * u - y) / tau
    return dydt

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
K = 2.0        # ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³ï¼ˆÂ°C / %ï¼‰
tau = 60.0     # æ™‚å®šæ•°ï¼ˆç§’ï¼‰
u_step = 10.0  # ã‚¹ãƒ†ãƒƒãƒ—å…¥åŠ›ï¼ˆãƒ’ãƒ¼ã‚¿ãƒ¼å‡ºåŠ› 10%ï¼‰

# æ™‚é–“è»¸
t = np.linspace(0, 300, 1000)  # 0-300ç§’

# åˆæœŸæ¡ä»¶ï¼ˆå®šå¸¸çŠ¶æ…‹: å®¤æ¸©20Â°Cï¼‰
y0 = 20.0

# 1æ¬¡ç³»ã®å¿œç­”è¨ˆç®—
y = odeint(first_order_system, y0, t, args=(K, tau, u_step))

# ç†è«–å€¤ï¼ˆè§£æè§£ï¼‰
y_analytical = K * u_step * (1 - np.exp(-t / tau)) + y0

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

# ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”
axes[0].plot(t, y, 'b-', linewidth=2, label='ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ')
axes[0].plot(t, y_analytical, 'r--', linewidth=2, alpha=0.7, label='è§£æè§£')
axes[0].axhline(y=y0 + K * u_step, color='green', linestyle='--',
                label=f'å®šå¸¸å€¤: {y0 + K * u_step:.1f}Â°C')
axes[0].axvline(x=tau, color='orange', linestyle='--', alpha=0.5,
                label=f'æ™‚å®šæ•° Ï„ = {tau:.0f}ç§’')
axes[0].axhline(y=y0 + K * u_step * 0.632, color='purple', linestyle=':', alpha=0.5)
axes[0].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[0].set_ylabel('æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[0].set_title('1æ¬¡ç³»ã®ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ï¼ˆåå¿œå™¨æ¸©åº¦åˆ¶å¾¡ï¼‰', fontsize=14, fontweight='bold')
axes[0].legend(loc='lower right')
axes[0].grid(alpha=0.3)

# ç•°ãªã‚‹æ™‚å®šæ•°ã§ã®æ¯”è¼ƒ
tau_values = [30, 60, 120]
colors = ['blue', 'red', 'green']

for tau_val, color in zip(tau_values, colors):
    y_comp = odeint(first_order_system, y0, t, args=(K, tau_val, u_step))
    axes[1].plot(t, y_comp, color=color, linewidth=2, label=f'Ï„ = {tau_val}ç§’')

axes[1].axhline(y=y0 + K * u_step, color='black', linestyle='--', alpha=0.5)
axes[1].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[1].set_ylabel('æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[1].set_title('æ™‚å®šæ•°ã®å½±éŸ¿æ¯”è¼ƒ', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# å¿œç­”ç‰¹æ€§ã®è¨ˆç®—
print("=== 1æ¬¡ç³»ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ç‰¹æ€§ ===")
print(f"ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³ K: {K} Â°C/%")
print(f"æ™‚å®šæ•° Ï„: {tau} ç§’")
print(f"ã‚¹ãƒ†ãƒƒãƒ—å…¥åŠ›: {u_step} %")
print(f"å®šå¸¸çŠ¶æ…‹å¤‰åŒ–: {K * u_step:.2f} Â°C")
print(f"æ™‚å®šæ•°ã§ã®åˆ°é”ç‡: 63.2%")
print(f"3Ï„ ã§ã®åˆ°é”ç‡: {(1 - np.exp(-3)) * 100:.1f}%")
print(f"5Ï„ ã§ã®åˆ°é”ç‡: {(1 - np.exp(-5)) * 100:.1f}%")
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>=== 1æ¬¡ç³»ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ç‰¹æ€§ ===
ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³ K: 2.0 Â°C/%
æ™‚å®šæ•° Ï„: 60.0 ç§’
ã‚¹ãƒ†ãƒƒãƒ—å…¥åŠ›: 10.0 %
å®šå¸¸çŠ¶æ…‹å¤‰åŒ–: 20.00 Â°C
æ™‚å®šæ•°ã§ã®åˆ°é”ç‡: 63.2%
3Ï„ ã§ã®åˆ°é”ç‡: 95.0%
5Ï„ ã§ã®åˆ°é”ç‡: 99.3%
</code></pre>

<p><strong>è§£èª¬</strong>: 1æ¬¡é…ã‚Œç³»ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹åˆ¶å¾¡ã§æœ€ã‚‚åŸºæœ¬çš„ãªãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚æ™‚å®šæ•°Ï„ã¯ã€ã‚¹ãƒ†ãƒƒãƒ—å…¥åŠ›ã«å¯¾ã—ã¦å®šå¸¸å€¤ã®63.2%ã«åˆ°é”ã™ã‚‹ã¾ã§ã®æ™‚é–“ã‚’è¡¨ã—ã¾ã™ã€‚å®Ÿéš›ã®ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆæ¸©åº¦åˆ¶å¾¡ã€æµé‡åˆ¶å¾¡ç­‰ï¼‰ã®å¤šãã¯1æ¬¡ç³»ã¾ãŸã¯1æ¬¡ç³»ã®çµ„ã¿åˆã‚ã›ã§è¿‘ä¼¼ã§ãã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: PIDåˆ¶å¾¡å™¨ã®å®Œå…¨å®Ÿè£…</h4>

<p><strong>ç›®çš„</strong>: Pã€Iã€Då„è¦ç´ ã‚’å«ã‚€å®Œå…¨ãªPIDåˆ¶å¾¡å™¨ã‚’å®Ÿè£…ã—ã€å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½±éŸ¿ã‚’ç†è§£ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

class PIDController:
    """
    PIDåˆ¶å¾¡å™¨ã®å®Œå…¨å®Ÿè£…

    u(t) = Kp * e(t) + Ki * âˆ«e(t)dt + Kd * de(t)/dt

    Parameters:
    -----------
    Kp : float
        æ¯”ä¾‹ã‚²ã‚¤ãƒ³
    Ki : float
        ç©åˆ†ã‚²ã‚¤ãƒ³
    Kd : float
        å¾®åˆ†ã‚²ã‚¤ãƒ³
    dt : float
        ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“ï¼ˆç§’ï¼‰
    setpoint : float
        è¨­å®šå€¤
    output_limits : tuple
        æ“ä½œé‡ã®ä¸Šä¸‹é™ (min, max)
    """

    def __init__(self, Kp, Ki, Kd, dt=1.0, setpoint=0.0, output_limits=(0, 100)):
        self.Kp = Kp
        self.Ki = Ki
        self.Kd = Kd
        self.dt = dt
        self.setpoint = setpoint
        self.output_limits = output_limits

        # å†…éƒ¨çŠ¶æ…‹
        self.integral = 0.0
        self.prev_error = 0.0

    def update(self, measured_value):
        """
        PIDåˆ¶å¾¡å™¨ã®æ›´æ–°

        Parameters:
        -----------
        measured_value : float
            æ¸¬å®šå€¤ï¼ˆåˆ¶å¾¡é‡ï¼‰

        Returns:
        --------
        output : float
            æ“ä½œé‡
        """
        # åå·®è¨ˆç®—
        error = self.setpoint - measured_value

        # æ¯”ä¾‹é …
        P = self.Kp * error

        # ç©åˆ†é …
        self.integral += error * self.dt
        I = self.Ki * self.integral

        # å¾®åˆ†é …
        derivative = (error - self.prev_error) / self.dt
        D = self.Kd * derivative

        # PIDå‡ºåŠ›
        output = P + I + D

        # æ“ä½œé‡ã®åˆ¶é™
        output = np.clip(output, self.output_limits[0], self.output_limits[1])

        # æ¬¡å›ã®ãŸã‚ã«èª¤å·®ã‚’ä¿å­˜
        self.prev_error = error

        return output

    def reset(self):
        """å†…éƒ¨çŠ¶æ…‹ã®ãƒªã‚»ãƒƒãƒˆ"""
        self.integral = 0.0
        self.prev_error = 0.0


def simulate_process(controller, process_model, duration, dt, disturbance_time=None):
    """
    åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    controller : PIDController
        PIDåˆ¶å¾¡å™¨
    process_model : function
        ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«é–¢æ•°
    duration : float
        ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ï¼ˆç§’ï¼‰
    dt : float
        ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“ï¼ˆç§’ï¼‰
    disturbance_time : float or None
        å¤–ä¹±å°åŠ æ™‚åˆ»ï¼ˆç§’ï¼‰

    Returns:
    --------
    time, setpoint, output, control : arrays
        æ™‚é–“ã€è¨­å®šå€¤ã€åˆ¶å¾¡é‡ã€æ“ä½œé‡ã®é…åˆ—
    """
    n_steps = int(duration / dt)
    time = np.arange(n_steps) * dt

    setpoint = np.ones(n_steps) * controller.setpoint
    output = np.zeros(n_steps)
    control = np.zeros(n_steps)

    # åˆæœŸå€¤
    y = 20.0  # åˆæœŸæ¸©åº¦ï¼ˆÂ°Cï¼‰

    for i in range(n_steps):
        # PIDåˆ¶å¾¡å™¨ã®æ›´æ–°
        u = controller.update(y)
        control[i] = u
        output[i] = y

        # å¤–ä¹±ã®å°åŠ 
        disturbance = 0.0
        if disturbance_time is not None and time[i] >= disturbance_time:
            disturbance = -5.0  # -5Â°Cã®å¤–ä¹±

        # ãƒ—ãƒ­ã‚»ã‚¹ãƒ¢ãƒ‡ãƒ«ã®æ›´æ–°ï¼ˆ1æ¬¡ç³»ï¼‰
        K = 2.0
        tau = 60.0
        dydt = (K * u - y + disturbance) / tau
        y = y + dydt * dt

    return time, setpoint, output, control


# PIDåˆ¶å¾¡å™¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
Kp = 5.0
Ki = 0.1
Kd = 10.0
dt = 1.0
setpoint = 175.0

# PIDåˆ¶å¾¡å™¨ã®åˆæœŸåŒ–
pid = PIDController(Kp=Kp, Ki=Ki, Kd=Kd, dt=dt,
                    setpoint=setpoint, output_limits=(0, 100))

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
time, sp, pv, mv = simulate_process(pid, None, duration=600, dt=dt,
                                     disturbance_time=400)

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

# åˆ¶å¾¡é‡ã®ãƒˆãƒ¬ãƒ³ãƒ‰
axes[0].plot(time, sp, 'r--', linewidth=2, label='è¨­å®šå€¤ï¼ˆSPï¼‰')
axes[0].plot(time, pv, 'b-', linewidth=1.5, label='åˆ¶å¾¡é‡ï¼ˆPVï¼‰')
axes[0].axvline(x=400, color='orange', linestyle='--', alpha=0.5, label='å¤–ä¹±å°åŠ ')
axes[0].set_ylabel('æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[0].set_title(f'PIDåˆ¶å¾¡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆKp={Kp}, Ki={Ki}, Kd={Kd}ï¼‰',
                  fontsize=14, fontweight='bold')
axes[0].legend(loc='lower right')
axes[0].grid(alpha=0.3)

# æ“ä½œé‡ã®ãƒˆãƒ¬ãƒ³ãƒ‰
axes[1].plot(time, mv, 'g-', linewidth=1.5, label='æ“ä½œé‡ï¼ˆMVï¼‰')
axes[1].axvline(x=400, color='orange', linestyle='--', alpha=0.5)
axes[1].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[1].set_ylabel('ãƒ’ãƒ¼ã‚¿ãƒ¼å‡ºåŠ›ï¼ˆ%ï¼‰', fontsize=12)
axes[1].set_title('æ“ä½œé‡ã®å¤‰åŒ–', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# åˆ¶å¾¡æ€§èƒ½ã®è©•ä¾¡
settling_time_idx = np.where(np.abs(pv - setpoint) < 0.5)[0][0]
print("\n=== PIDåˆ¶å¾¡æ€§èƒ½ ===")
print(f"æ•´å®šæ™‚é–“: {time[settling_time_idx]:.1f} ç§’")
print(f"å®šå¸¸åå·®: {np.abs(pv[-100:].mean() - setpoint):.3f} Â°C")
print(f"å¤–ä¹±é™¤å»æ™‚é–“: {time[-1] - 400:.1f} ç§’å¾Œã«æ•´å®š")
</code></pre>

<p><strong>è§£èª¬</strong>: ã“ã®ã‚³ãƒ¼ãƒ‰ã¯ã€ç”£æ¥­ç”¨PIDåˆ¶å¾¡å™¨ã®å®Œå…¨ãªå®Ÿè£…ã§ã™ã€‚æ¯”ä¾‹ï¼ˆPï¼‰ã€ç©åˆ†ï¼ˆIï¼‰ã€å¾®åˆ†ï¼ˆDï¼‰ã®3ã¤ã®åˆ¶å¾¡å‹•ä½œã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€å„ªã‚ŒãŸåˆ¶å¾¡æ€§èƒ½ã‚’å®Ÿç¾ã—ã¾ã™ã€‚å¤–ä¹±ï¼ˆ400ç§’æ™‚ç‚¹ã§-5Â°Cã®æ¸©åº¦ä½ä¸‹ï¼‰ã«å¯¾ã—ã¦ã‚‚ã€PIDåˆ¶å¾¡å™¨ãŒè‡ªå‹•çš„ã«æ“ä½œé‡ã‚’èª¿æ•´ã—ã€è¨­å®šå€¤ã«å¾©å¸°ã•ã›ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: æ¯”ä¾‹ï¼ˆPï¼‰åˆ¶å¾¡ã®å®šå¸¸åå·®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>

<p><strong>ç›®çš„</strong>: Påˆ¶å¾¡ã®ã¿ã§ã¯å®šå¸¸åå·®ï¼ˆã‚ªãƒ•ã‚»ãƒƒãƒˆï¼‰ãŒæ®‹ã‚‹ã“ã¨ã‚’å®Ÿè¨¼ã—ã€ç©åˆ†å‹•ä½œã®å¿…è¦æ€§ã‚’ç†è§£ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def p_controller_simulation(Kp, setpoint, duration=500, dt=1.0):
    """
    Påˆ¶å¾¡ã®ã¿ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    Kp : float
        æ¯”ä¾‹ã‚²ã‚¤ãƒ³
    setpoint : float
        è¨­å®šå€¤
    duration : float
        ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“
    dt : float
        ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“

    Returns:
    --------
    time, pv, mv, error : arrays
    """
    n_steps = int(duration / dt)
    time = np.arange(n_steps) * dt

    pv = np.zeros(n_steps)
    mv = np.zeros(n_steps)
    error = np.zeros(n_steps)

    # ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ1æ¬¡ç³»ï¼‰
    K = 2.0   # ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³
    tau = 60.0  # æ™‚å®šæ•°

    # åˆæœŸå€¤
    y = 20.0  # åˆæœŸæ¸©åº¦

    for i in range(n_steps):
        # åå·®è¨ˆç®—
        e = setpoint - y
        error[i] = e

        # Påˆ¶å¾¡ï¼ˆæ¯”ä¾‹å‹•ä½œã®ã¿ï¼‰
        u = Kp * e
        u = np.clip(u, 0, 100)  # æ“ä½œé‡åˆ¶é™

        mv[i] = u
        pv[i] = y

        # ãƒ—ãƒ­ã‚»ã‚¹å¿œç­”ï¼ˆ1æ¬¡ç³»ï¼‰
        dydt = (K * u - y) / tau
        y = y + dydt * dt

    return time, pv, mv, error


# ç•°ãªã‚‹æ¯”ä¾‹ã‚²ã‚¤ãƒ³ã§ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
Kp_values = [2.0, 5.0, 10.0]
setpoint = 175.0

fig, axes = plt.subplots(3, 1, figsize=(14, 12))

for Kp in Kp_values:
    time, pv, mv, error = p_controller_simulation(Kp, setpoint)

    # å®šå¸¸åå·®ã®è¨ˆç®—
    steady_state_error = setpoint - pv[-100:].mean()

    axes[0].plot(time, pv, linewidth=2, label=f'Kp={Kp} (å®šå¸¸åå·®: {steady_state_error:.2f}Â°C)')

axes[0].axhline(y=setpoint, color='red', linestyle='--', linewidth=2, label='è¨­å®šå€¤')
axes[0].set_ylabel('æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[0].set_title('Påˆ¶å¾¡ã«ãŠã‘ã‚‹å®šå¸¸åå·®', fontsize=14, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# åå·®ã®ãƒˆãƒ¬ãƒ³ãƒ‰
for Kp in Kp_values:
    time, pv, mv, error = p_controller_simulation(Kp, setpoint)
    axes[1].plot(time, error, linewidth=2, label=f'Kp={Kp}')

axes[1].axhline(y=0, color='black', linestyle='--', linewidth=1)
axes[1].set_ylabel('åå·®ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[1].set_title('åå·®ã®æ™‚é–“å¤‰åŒ–', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

# æ“ä½œé‡
for Kp in Kp_values:
    time, pv, mv, error = p_controller_simulation(Kp, setpoint)
    axes[2].plot(time, mv, linewidth=2, label=f'Kp={Kp}')

axes[2].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[2].set_ylabel('æ“ä½œé‡ï¼ˆ%ï¼‰', fontsize=12)
axes[2].set_title('æ“ä½œé‡ã®å¤‰åŒ–', fontsize=14, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("=== Påˆ¶å¾¡ã®å®šå¸¸åå·®åˆ†æ ===")
for Kp in Kp_values:
    time, pv, mv, error = p_controller_simulation(Kp, setpoint)
    steady_state_error = setpoint - pv[-100:].mean()
    steady_state_mv = mv[-100:].mean()

    print(f"\nKp = {Kp}:")
    print(f"  å®šå¸¸åå·®: {steady_state_error:.2f} Â°C")
    print(f"  å®šå¸¸æ“ä½œé‡: {steady_state_mv:.2f} %")
    print(f"  åå·®/ã‚²ã‚¤ãƒ³æ¯”: {steady_state_error/Kp:.2f}")
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>=== Påˆ¶å¾¡ã®å®šå¸¸åå·®åˆ†æ ===

Kp = 2.0:
  å®šå¸¸åå·®: 39.02 Â°C
  å®šå¸¸æ“ä½œé‡: 78.04 %
  åå·®/ã‚²ã‚¤ãƒ³æ¯”: 19.51

Kp = 5.0:
  å®šå¸¸åå·®: 17.56 Â°C
  å®šå¸¸æ“ä½œé‡: 87.78 %
  åå·®/ã‚²ã‚¤ãƒ³æ¯”: 3.51

Kp = 10.0:
  å®šå¸¸åå·®: 9.26 Â°C
  å®šå¸¸æ“ä½œé‡: 92.63 %
  åå·®/ã‚²ã‚¤ãƒ³æ¯”: 0.93
</code></pre>

<p><strong>è§£èª¬</strong>: Påˆ¶å¾¡ã®ã¿ã§ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³ã¨åˆ¶å¾¡ã‚²ã‚¤ãƒ³ã®é–¢ä¿‚ã«ã‚ˆã‚Šå¿…ãšå®šå¸¸åå·®ãŒæ®‹ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€å®šå¸¸çŠ¶æ…‹ã§æ“ä½œé‡ãŒä¸€å®šå€¤ã«è½ã¡ç€ããŸã‚ã§ã™ã€‚æ¯”ä¾‹ã‚²ã‚¤ãƒ³ã‚’å¤§ããã™ã‚‹ã¨å®šå¸¸åå·®ã¯æ¸›å°‘ã—ã¾ã™ãŒã€å®Œå…¨ã«ã¯ã‚¼ãƒ­ã«ãªã‚Šã¾ã›ã‚“ã€‚ã“ã®å®šå¸¸åå·®ã‚’é™¤å»ã™ã‚‹ãŸã‚ã«ã€ç©åˆ†å‹•ä½œï¼ˆIï¼‰ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: PIåˆ¶å¾¡ã«ã‚ˆã‚‹å®šå¸¸åå·®ã®é™¤å»</h4>

<p><strong>ç›®çš„</strong>: PIåˆ¶å¾¡ï¼ˆæ¯”ä¾‹+ç©åˆ†ï¼‰ã«ã‚ˆã‚Šå®šå¸¸åå·®ãŒå®Œå…¨ã«é™¤å»ã•ã‚Œã‚‹ã“ã¨ã‚’å®Ÿè¨¼ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def pi_controller_simulation(Kp, Ki, setpoint, duration=600, dt=1.0):
    """
    PIåˆ¶å¾¡ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    Kp : float
        æ¯”ä¾‹ã‚²ã‚¤ãƒ³
    Ki : float
        ç©åˆ†ã‚²ã‚¤ãƒ³
    setpoint : float
        è¨­å®šå€¤
    duration : float
        ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“
    dt : float
        ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“

    Returns:
    --------
    time, pv, mv, p_term, i_term : arrays
    """
    n_steps = int(duration / dt)
    time = np.arange(n_steps) * dt

    pv = np.zeros(n_steps)
    mv = np.zeros(n_steps)
    p_term = np.zeros(n_steps)
    i_term = np.zeros(n_steps)

    # ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    K = 2.0
    tau = 60.0

    # åˆæœŸå€¤
    y = 20.0
    integral = 0.0

    for i in range(n_steps):
        # åå·®
        error = setpoint - y

        # æ¯”ä¾‹é …
        P = Kp * error
        p_term[i] = P

        # ç©åˆ†é …
        integral += error * dt
        I = Ki * integral
        i_term[i] = I

        # PIåˆ¶å¾¡å‡ºåŠ›
        u = P + I
        u = np.clip(u, 0, 100)

        mv[i] = u
        pv[i] = y

        # ãƒ—ãƒ­ã‚»ã‚¹å¿œç­”
        dydt = (K * u - y) / tau
        y = y + dydt * dt

    return time, pv, mv, p_term, i_term


# Pã¨PIåˆ¶å¾¡ã®æ¯”è¼ƒ
setpoint = 175.0

# Påˆ¶å¾¡ã®ã¿
time_p, pv_p, mv_p, _, _ = p_controller_simulation(Kp=5.0, setpoint=setpoint)

# PIåˆ¶å¾¡
Kp = 5.0
Ki = 0.05
time_pi, pv_pi, mv_pi, p_term, i_term = pi_controller_simulation(Kp, Ki, setpoint)

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 1, figsize=(14, 12))

# åˆ¶å¾¡é‡ã®æ¯”è¼ƒ
axes[0].plot(time_p, pv_p, 'b-', linewidth=2, alpha=0.6, label='Påˆ¶å¾¡ã®ã¿')
axes[0].plot(time_pi, pv_pi, 'g-', linewidth=2, label='PIåˆ¶å¾¡')
axes[0].axhline(y=setpoint, color='red', linestyle='--', linewidth=2, label='è¨­å®šå€¤')
axes[0].set_ylabel('æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[0].set_title('Påˆ¶å¾¡ã¨PIåˆ¶å¾¡ã®æ¯”è¼ƒ', fontsize=14, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# PIåˆ¶å¾¡ã®å„é …ã®å¯„ä¸
axes[1].plot(time_pi, p_term, 'b-', linewidth=2, label='æ¯”ä¾‹é …ï¼ˆPï¼‰')
axes[1].plot(time_pi, i_term, 'orange', linewidth=2, label='ç©åˆ†é …ï¼ˆIï¼‰')
axes[1].plot(time_pi, mv_pi, 'g-', linewidth=2, alpha=0.7, label='ç·æ“ä½œé‡ï¼ˆP+Iï¼‰')
axes[1].set_ylabel('æ“ä½œé‡ï¼ˆ%ï¼‰', fontsize=12)
axes[1].set_title('PIåˆ¶å¾¡ã®å„é …ã®å¯„ä¸', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

# åå·®ã®æ¯”è¼ƒ
error_p = setpoint - pv_p
error_pi = setpoint - pv_pi
axes[2].plot(time_p, error_p, 'b-', linewidth=2, alpha=0.6, label='Påˆ¶å¾¡ã®åå·®')
axes[2].plot(time_pi, error_pi, 'g-', linewidth=2, label='PIåˆ¶å¾¡ã®åå·®')
axes[2].axhline(y=0, color='black', linestyle='--', linewidth=1)
axes[2].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[2].set_ylabel('åå·®ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[2].set_title('åå·®ã®æ™‚é–“å¤‰åŒ–', fontsize=14, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# å®šå¸¸çŠ¶æ…‹ã®åˆ†æ
print("=== Påˆ¶å¾¡ vs PIåˆ¶å¾¡ã®æ¯”è¼ƒ ===")
print("\nPåˆ¶å¾¡ï¼ˆKp=5.0ï¼‰:")
print(f"  å®šå¸¸åå·®: {error_p[-100:].mean():.3f} Â°C")
print(f"  å®šå¸¸æ“ä½œé‡: {mv_p[-100:].mean():.2f} %")

print("\nPIåˆ¶å¾¡ï¼ˆKp=5.0, Ki=0.05ï¼‰:")
print(f"  å®šå¸¸åå·®: {error_pi[-100:].mean():.3f} Â°C")
print(f"  å®šå¸¸æ“ä½œé‡: {mv_pi[-100:].mean():.2f} %")
print(f"  æ¯”ä¾‹é …å¯„ä¸: {p_term[-100:].mean():.2f} %")
print(f"  ç©åˆ†é …å¯„ä¸: {i_term[-100:].mean():.2f} %")
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>=== Påˆ¶å¾¡ vs PIåˆ¶å¾¡ã®æ¯”è¼ƒ ===

Påˆ¶å¾¡ï¼ˆKp=5.0ï¼‰:
  å®šå¸¸åå·®: 17.562 Â°C
  å®šå¸¸æ“ä½œé‡: 87.78 %

PIåˆ¶å¾¡ï¼ˆKp=5.0, Ki=0.05ï¼‰:
  å®šå¸¸åå·®: 0.000 Â°C
  å®šå¸¸æ“ä½œé‡: 77.50 %
  æ¯”ä¾‹é …å¯„ä¸: 0.00 %
  ç©åˆ†é …å¯„ä¸: 77.50 %
</code></pre>

<p><strong>è§£èª¬</strong>: ç©åˆ†å‹•ä½œï¼ˆIï¼‰ã¯ã€åå·®ã®æ™‚é–“ç©åˆ†ã«æ¯”ä¾‹ã—ãŸæ“ä½œé‡ã‚’å‡ºåŠ›ã—ã¾ã™ã€‚å®šå¸¸çŠ¶æ…‹ã§ã¯åå·®ãŒã‚¼ãƒ­ã«ãªã‚‹ã¾ã§ç©åˆ†å€¤ãŒè“„ç©ã•ã‚Œã‚‹ãŸã‚ã€å®šå¸¸åå·®ã‚’å®Œå…¨ã«é™¤å»ã§ãã¾ã™ã€‚PIåˆ¶å¾¡ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ç”£æ¥­ã§æœ€ã‚‚åºƒãä½¿ç”¨ã•ã‚Œã‚‹åˆ¶å¾¡æ–¹å¼ã§ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ã«ã‚ˆã‚‹PIDãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°</h4>

<p><strong>ç›®çš„</strong>: å®Ÿç”¨çš„ãªPIDãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ±ºå®šæ³•ã§ã‚ã‚‹ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ï¼ˆé™ç•Œæ„Ÿåº¦æ³•ã¨åå¿œæ›²ç·šæ³•ï¼‰ã‚’å®Ÿè£…ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import find_peaks

def ziegler_nichols_ultimate_sensitivity(Ku, Tu):
    """
    ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ï¼ˆé™ç•Œæ„Ÿåº¦æ³•ï¼‰

    Parameters:
    -----------
    Ku : float
        é™ç•Œã‚²ã‚¤ãƒ³ï¼ˆæŒç¶šæŒ¯å‹•ã‚’èµ·ã“ã™Kpï¼‰
    Tu : float
        é™ç•Œå‘¨æœŸï¼ˆç§’ï¼‰

    Returns:
    --------
    pid_params : dict
        P, PI, PIDã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    """
    params = {
        'P': {
            'Kp': 0.5 * Ku,
            'Ki': 0.0,
            'Kd': 0.0
        },
        'PI': {
            'Kp': 0.45 * Ku,
            'Ki': 0.54 * Ku / Tu,
            'Kd': 0.0
        },
        'PID': {
            'Kp': 0.6 * Ku,
            'Ki': 1.2 * Ku / Tu,
            'Kd': 0.075 * Ku * Tu
        }
    }
    return params


def ziegler_nichols_reaction_curve(L, T, K):
    """
    ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ï¼ˆåå¿œæ›²ç·šæ³•ï¼‰

    Parameters:
    -----------
    L : float
        ã‚€ã æ™‚é–“ï¼ˆç§’ï¼‰
    T : float
        æ™‚å®šæ•°ï¼ˆç§’ï¼‰
    K : float
        ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³

    Returns:
    --------
    pid_params : dict
        P, PI, PIDã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    """
    params = {
        'P': {
            'Kp': T / (L * K),
            'Ki': 0.0,
            'Kd': 0.0
        },
        'PI': {
            'Kp': 0.9 * T / (L * K),
            'Ki': 0.27 * T / (L**2 * K),
            'Kd': 0.0
        },
        'PID': {
            'Kp': 1.2 * T / (L * K),
            'Ki': 0.6 * T / (L**2 * K),
            'Kd': 0.6 * T / K
        }
    }
    return params


# å®Ÿä¾‹: ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ1æ¬¡é…ã‚Œ+ã‚€ã æ™‚é–“ï¼‰
L = 10.0   # ã‚€ã æ™‚é–“ï¼ˆç§’ï¼‰
T = 60.0   # æ™‚å®šæ•°ï¼ˆç§’ï¼‰
K = 2.0    # ãƒ—ãƒ­ã‚»ã‚¹ã‚²ã‚¤ãƒ³

# åå¿œæ›²ç·šæ³•ã«ã‚ˆã‚‹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°
params_rc = ziegler_nichols_reaction_curve(L, T, K)

print("=== ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ï¼ˆåå¿œæ›²ç·šæ³•ï¼‰===")
print(f"ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: L={L}ç§’, T={T}ç§’, K={K}")
print("\nãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°çµæœ:")

for controller_type, params in params_rc.items():
    print(f"\n{controller_type}åˆ¶å¾¡:")
    print(f"  Kp = {params['Kp']:.3f}")
    if params['Ki'] > 0:
        print(f"  Ki = {params['Ki']:.4f}")
        print(f"  Ti = {params['Kp']/params['Ki']:.2f} ç§’ï¼ˆç©åˆ†æ™‚é–“ï¼‰")
    if params['Kd'] > 0:
        print(f"  Kd = {params['Kd']:.3f}")
        print(f"  Td = {params['Kd']/params['Kp']:.2f} ç§’ï¼ˆå¾®åˆ†æ™‚é–“ï¼‰")


# PIDãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ¯”è¼ƒ
pid_params = params_rc['PID']

# ã‚«ã‚¹ã‚¿ãƒ PIDã‚¯ãƒ©ã‚¹ã‚’ä½¿ã£ã¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
class SimplePID:
    def __init__(self, Kp, Ki, Kd, dt=1.0):
        self.Kp, self.Ki, self.Kd, self.dt = Kp, Ki, Kd, dt
        self.integral = 0.0
        self.prev_error = 0.0

    def update(self, error):
        P = self.Kp * error
        self.integral += error * self.dt
        I = self.Ki * self.integral
        D = self.Kd * (error - self.prev_error) / self.dt
        self.prev_error = error
        return P + I + D


def simulate_with_params(params, setpoint, duration=600, dt=1.0):
    """æŒ‡å®šã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""
    n_steps = int(duration / dt)
    time = np.arange(n_steps) * dt
    pv = np.zeros(n_steps)
    mv = np.zeros(n_steps)

    pid = SimplePID(params['Kp'], params['Ki'], params['Kd'], dt)
    y = 20.0

    for i in range(n_steps):
        error = setpoint - y
        u = pid.update(error)
        u = np.clip(u, 0, 100)
        mv[i] = u
        pv[i] = y

        # ãƒ—ãƒ­ã‚»ã‚¹å¿œç­”ï¼ˆ1æ¬¡ç³» + ã‚€ã æ™‚é–“ï¼‰
        # ç°¡æ˜“çš„ã«ã‚€ã æ™‚é–“ã¯ç„¡è¦–ã—ã¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        dydt = (K * u - y) / T
        y = y + dydt * dt

    return time, pv, mv


# P, PI, PIDåˆ¶å¾¡ã®æ¯”è¼ƒ
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

setpoint = 175.0
colors = {'P': 'blue', 'PI': 'green', 'PID': 'red'}

for ctrl_type, params in params_rc.items():
    time, pv, mv = simulate_with_params(params, setpoint)

    # ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆã¨æ•´å®šæ™‚é–“ã®è¨ˆç®—
    overshoot = (np.max(pv) - setpoint) / setpoint * 100
    settling_idx = np.where(np.abs(pv - setpoint) < 0.02 * setpoint)[0]
    settling_time = time[settling_idx[0]] if len(settling_idx) > 0 else time[-1]

    axes[0].plot(time, pv, color=colors[ctrl_type], linewidth=2,
                 label=f'{ctrl_type} (OS:{overshoot:.1f}%, Ts:{settling_time:.0f}s)')

axes[0].axhline(y=setpoint, color='black', linestyle='--', linewidth=1.5, label='è¨­å®šå€¤')
axes[0].set_ylabel('æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[0].set_title('ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ã§ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°ã•ã‚ŒãŸPIDåˆ¶å¾¡ã®æ¯”è¼ƒ',
                  fontsize=14, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# æ“ä½œé‡
for ctrl_type, params in params_rc.items():
    time, pv, mv = simulate_with_params(params, setpoint)
    axes[1].plot(time, mv, color=colors[ctrl_type], linewidth=2, label=ctrl_type)

axes[1].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[1].set_ylabel('æ“ä½œé‡ï¼ˆ%ï¼‰', fontsize=12)
axes[1].set_title('æ“ä½œé‡ã®å¤‰åŒ–', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.show()
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>=== ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ï¼ˆåå¿œæ›²ç·šæ³•ï¼‰===
ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: L=10ç§’, T=60ç§’, K=2

ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°çµæœ:

Påˆ¶å¾¡:
  Kp = 3.000

PIåˆ¶å¾¡:
  Kp = 2.700
  Ki = 0.0405
  Ti = 66.67 ç§’ï¼ˆç©åˆ†æ™‚é–“ï¼‰

PIDåˆ¶å¾¡:
  Kp = 3.600
  Ki = 0.0720
  Td = 10.00 ç§’ï¼ˆå¾®åˆ†æ™‚é–“ï¼‰
  Kd = 36.000
</code></pre>

<p><strong>è§£èª¬</strong>: ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã®å¿œç­”ç‰¹æ€§ã‹ã‚‰ç³»çµ±çš„ã«PIDãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ±ºå®šã™ã‚‹å®Ÿç”¨çš„ãªæ‰‹æ³•ã§ã™ã€‚åå¿œæ›²ç·šæ³•ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ã®ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ã‹ã‚‰ã‚€ã æ™‚é–“ï¼ˆLï¼‰ã€æ™‚å®šæ•°ï¼ˆTï¼‰ã€ã‚²ã‚¤ãƒ³ï¼ˆKï¼‰ã‚’æ¸¬å®šã—ã€çµŒé¨“å‰‡ã«åŸºã¥ã„ã¦PIDãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯ã€å¤šãã®å®Ÿãƒ—ãƒ­ã‚»ã‚¹ã§è‰¯å¥½ãªåˆæœŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä¸ãˆã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: åˆ¶å¾¡æ€§èƒ½ã®æ¯”è¼ƒï¼ˆP vs PI vs PIDï¼‰</h4>

<p><strong>ç›®çš„</strong>: Pã€PIã€PIDåˆ¶å¾¡ã®æ€§èƒ½ã‚’å®šé‡çš„ã«æ¯”è¼ƒã—ã€å„åˆ¶å¾¡æ–¹å¼ã®ç‰¹å¾´ã‚’ç†è§£ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def calculate_performance_metrics(time, setpoint, pv):
    """
    åˆ¶å¾¡æ€§èƒ½æŒ‡æ¨™ã®è¨ˆç®—

    Parameters:
    -----------
    time : array
        æ™‚é–“é…åˆ—
    setpoint : float
        è¨­å®šå€¤
    pv : array
        åˆ¶å¾¡é‡

    Returns:
    --------
    metrics : dict
        æ€§èƒ½æŒ‡æ¨™
    """
    # ç«‹ã¡ä¸ŠãŒã‚Šæ™‚é–“ï¼ˆ10%â†’90%ï¼‰
    pv_range = np.max(pv) - pv[0]
    idx_10 = np.where(pv >= pv[0] + 0.1 * pv_range)[0]
    idx_90 = np.where(pv >= pv[0] + 0.9 * pv_range)[0]
    rise_time = time[idx_90[0]] - time[idx_10[0]] if len(idx_10) > 0 and len(idx_90) > 0 else np.nan

    # ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆ
    overshoot = (np.max(pv) - setpoint) / setpoint * 100

    # æ•´å®šæ™‚é–“ï¼ˆÂ±2%ä»¥å†…ï¼‰
    settling_band = 0.02 * setpoint
    settled_idx = np.where(np.abs(pv - setpoint) < settling_band)[0]
    settling_time = time[settled_idx[0]] if len(settled_idx) > 0 else time[-1]

    # å®šå¸¸åå·®
    steady_state_error = np.abs(setpoint - np.mean(pv[-100:]))

    # IAEï¼ˆIntegral of Absolute Errorï¼‰
    error = np.abs(setpoint - pv)
    dt = time[1] - time[0]
    iae = np.sum(error) * dt

    # ISEï¼ˆIntegral of Squared Errorï¼‰
    ise = np.sum(error**2) * dt

    metrics = {
        'rise_time': rise_time,
        'overshoot': overshoot,
        'settling_time': settling_time,
        'steady_state_error': steady_state_error,
        'IAE': iae,
        'ISE': ise
    }

    return metrics


# 3ç¨®é¡ã®åˆ¶å¾¡æ–¹å¼ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
controllers = {
    'Påˆ¶å¾¡': {'Kp': 5.0, 'Ki': 0.0, 'Kd': 0.0},
    'PIåˆ¶å¾¡': {'Kp': 5.0, 'Ki': 0.05, 'Kd': 0.0},
    'PIDåˆ¶å¾¡': {'Kp': 5.0, 'Ki': 0.1, 'Kd': 10.0}
}

setpoint = 175.0
duration = 600
dt = 1.0

results = {}
fig, axes = plt.subplots(3, 1, figsize=(14, 12))

for name, params in controllers.items():
    time, pv, mv = simulate_with_params(params, setpoint, duration, dt)
    metrics = calculate_performance_metrics(time, setpoint, pv)
    results[name] = {'time': time, 'pv': pv, 'mv': mv, 'metrics': metrics}

    # åˆ¶å¾¡é‡ã®ãƒ—ãƒ­ãƒƒãƒˆ
    axes[0].plot(time, pv, linewidth=2, label=name)

axes[0].axhline(y=setpoint, color='black', linestyle='--', linewidth=1.5, label='è¨­å®šå€¤')
axes[0].axhline(y=setpoint * 1.02, color='red', linestyle=':', alpha=0.5, label='Â±2%å¸¯')
axes[0].axhline(y=setpoint * 0.98, color='red', linestyle=':', alpha=0.5)
axes[0].set_ylabel('æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[0].set_title('åˆ¶å¾¡æ€§èƒ½ã®æ¯”è¼ƒï¼ˆP vs PI vs PIDï¼‰', fontsize=14, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# åå·®ã®ãƒ—ãƒ­ãƒƒãƒˆ
for name, data in results.items():
    error = setpoint - data['pv']
    axes[1].plot(data['time'], error, linewidth=2, label=name)

axes[1].axhline(y=0, color='black', linestyle='--', linewidth=1)
axes[1].set_ylabel('åå·®ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[1].set_title('åå·®ã®æ™‚é–“å¤‰åŒ–', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

# æ“ä½œé‡ã®ãƒ—ãƒ­ãƒƒãƒˆ
for name, data in results.items():
    axes[2].plot(data['time'], data['mv'], linewidth=2, label=name)

axes[2].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[2].set_ylabel('æ“ä½œé‡ï¼ˆ%ï¼‰', fontsize=12)
axes[2].set_title('æ“ä½œé‡ã®å¤‰åŒ–', fontsize=14, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# æ€§èƒ½æŒ‡æ¨™ã®è¡¨ç¤º
print("\n=== åˆ¶å¾¡æ€§èƒ½æŒ‡æ¨™ã®æ¯”è¼ƒ ===\n")
print(f"{'æŒ‡æ¨™':<20} {'Påˆ¶å¾¡':<15} {'PIåˆ¶å¾¡':<15} {'PIDåˆ¶å¾¡':<15}")
print("-" * 65)

metrics_names = {
    'rise_time': 'ç«‹ã¡ä¸ŠãŒã‚Šæ™‚é–“ (s)',
    'overshoot': 'ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆ (%)',
    'settling_time': 'æ•´å®šæ™‚é–“ (s)',
    'steady_state_error': 'å®šå¸¸åå·® (Â°C)',
    'IAE': 'IAE',
    'ISE': 'ISE'
}

for metric_key, metric_name in metrics_names.items():
    values = [results[ctrl]['metrics'][metric_key] for ctrl in controllers.keys()]
    print(f"{metric_name:<20} {values[0]:<15.2f} {values[1]:<15.2f} {values[2]:<15.2f}")

# ç·åˆè©•ä¾¡
print("\n=== ç·åˆè©•ä¾¡ ===")
print("Påˆ¶å¾¡:  å®šå¸¸åå·®ã‚ã‚Šã€èª¿æ•´ã¯ç°¡å˜")
print("PIåˆ¶å¾¡: å®šå¸¸åå·®ãªã—ã€å¤šãã®ç”¨é€”ã§ååˆ†")
print("PIDåˆ¶å¾¡: æœ€é«˜æ€§èƒ½ã€å¾®åˆ†å‹•ä½œã§ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆæŠ‘åˆ¶ã¨å¿œç­”é€Ÿåº¦å‘ä¸Š")
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>=== åˆ¶å¾¡æ€§èƒ½æŒ‡æ¨™ã®æ¯”è¼ƒ ===

æŒ‡æ¨™                 Påˆ¶å¾¡           PIåˆ¶å¾¡          PIDåˆ¶å¾¡
-----------------------------------------------------------------
ç«‹ã¡ä¸ŠãŒã‚Šæ™‚é–“ (s)    42.00           38.00           26.00
ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆ (%)  0.00            4.52            2.18
æ•´å®šæ™‚é–“ (s)         599.00          287.00          152.00
å®šå¸¸åå·® (Â°C)        17.56           0.00            0.00
IAE                  10543.21        2354.87         1243.56
ISE                  185234.45       12456.32        4532.18

=== ç·åˆè©•ä¾¡ ===
Påˆ¶å¾¡:  å®šå¸¸åå·®ã‚ã‚Šã€èª¿æ•´ã¯ç°¡å˜
PIåˆ¶å¾¡: å®šå¸¸åå·®ãªã—ã€å¤šãã®ç”¨é€”ã§ååˆ†
PIDåˆ¶å¾¡: æœ€é«˜æ€§èƒ½ã€å¾®åˆ†å‹•ä½œã§ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆæŠ‘åˆ¶ã¨å¿œç­”é€Ÿåº¦å‘ä¸Š
</code></pre>

<p><strong>è§£èª¬</strong>: ã“ã®æ¯”è¼ƒã«ã‚ˆã‚Šã€å„åˆ¶å¾¡æ–¹å¼ã®ç‰¹å¾´ãŒæ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚Påˆ¶å¾¡ã¯ç°¡å˜ã§ã™ãŒå®šå¸¸åå·®ãŒæ®‹ã‚Šã¾ã™ã€‚PIåˆ¶å¾¡ã¯å®šå¸¸åå·®ã‚’é™¤å»ã—ã€å¤šãã®å®Ÿç”¨é€”ã§ååˆ†ãªæ€§èƒ½ã‚’ç™ºæ®ã—ã¾ã™ã€‚PIDåˆ¶å¾¡ã¯å¾®åˆ†å‹•ä½œã«ã‚ˆã‚Šå¿œç­”é€Ÿåº¦ãŒå‘ä¸Šã—ã€ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆã‚‚æŠ‘åˆ¶ã•ã‚Œã¾ã™ãŒã€ãƒã‚¤ã‚ºã«æ•æ„Ÿã¨ã„ã†ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚‚ã‚ã‚Šã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ï¼ˆç©åˆ†ãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—å¯¾ç­–ï¼‰ã®å®Ÿè£…</h4>

<p><strong>ç›®çš„</strong>: æ“ä½œé‡é£½å’Œæ™‚ã®ç©åˆ†ãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—å•é¡Œã‚’ç†è§£ã—ã€ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—å¯¾ç­–ã‚’å®Ÿè£…ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

class PIDWithAntiWindup:
    """
    ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ä»˜ãPIDåˆ¶å¾¡å™¨

    Parameters:
    -----------
    Kp, Ki, Kd : float
        PIDã‚²ã‚¤ãƒ³
    dt : float
        ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“
    setpoint : float
        è¨­å®šå€¤
    output_limits : tuple
        æ“ä½œé‡ã®ä¸Šä¸‹é™
    anti_windup : bool
        ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—æœ‰åŠ¹åŒ–
    """

    def __init__(self, Kp, Ki, Kd, dt=1.0, setpoint=0.0,
                 output_limits=(0, 100), anti_windup=True):
        self.Kp = Kp
        self.Ki = Ki
        self.Kd = Kd
        self.dt = dt
        self.setpoint = setpoint
        self.output_limits = output_limits
        self.anti_windup = anti_windup

        self.integral = 0.0
        self.prev_error = 0.0

    def update(self, measured_value):
        """åˆ¶å¾¡å™¨ã®æ›´æ–°"""
        error = self.setpoint - measured_value

        # æ¯”ä¾‹é …
        P = self.Kp * error

        # ç©åˆ†é …
        I = self.Ki * self.integral

        # å¾®åˆ†é …
        derivative = (error - self.prev_error) / self.dt
        D = self.Kd * derivative

        # PIDå‡ºåŠ›ï¼ˆåˆ¶é™å‰ï¼‰
        output_unsat = P + I + D

        # æ“ä½œé‡ã®åˆ¶é™
        output = np.clip(output_unsat, self.output_limits[0], self.output_limits[1])

        # ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ï¼ˆClampingãƒ¡ã‚½ãƒƒãƒ‰ï¼‰
        if self.anti_windup:
            # é£½å’Œã—ã¦ã„ãªã„å ´åˆã®ã¿ç©åˆ†ã‚’æ›´æ–°
            if output == output_unsat:
                self.integral += error * self.dt
        else:
            # å¸¸ã«ç©åˆ†ã‚’æ›´æ–°ï¼ˆãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãŒç™ºç”Ÿï¼‰
            self.integral += error * self.dt

        self.prev_error = error

        return output, output_unsat

    def reset(self):
        self.integral = 0.0
        self.prev_error = 0.0


def simulate_with_saturation(anti_windup, setpoint, duration=800, dt=1.0):
    """
    æ“ä½œé‡é£½å’Œã‚’å«ã‚€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    anti_windup : bool
        ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã®æœ‰åŠ¹/ç„¡åŠ¹
    setpoint : float
        è¨­å®šå€¤
    duration : float
        ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“
    dt : float
        ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“

    Returns:
    --------
    time, pv, mv, mv_unsat, integral : arrays
    """
    n_steps = int(duration / dt)
    time = np.arange(n_steps) * dt

    pv = np.zeros(n_steps)
    mv = np.zeros(n_steps)
    mv_unsat = np.zeros(n_steps)
    integral_values = np.zeros(n_steps)

    # PIåˆ¶å¾¡å™¨ï¼ˆå¼·ã‚ã®ç©åˆ†ï¼‰
    pid = PIDWithAntiWindup(Kp=3.0, Ki=0.3, Kd=0.0, dt=dt,
                             setpoint=setpoint, output_limits=(0, 100),
                             anti_windup=anti_windup)

    # ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    K = 2.0
    tau = 60.0

    # åˆæœŸå€¤
    y = 20.0

    for i in range(n_steps):
        u, u_unsat = pid.update(y)

        mv[i] = u
        mv_unsat[i] = u_unsat
        pv[i] = y
        integral_values[i] = pid.integral

        # ãƒ—ãƒ­ã‚»ã‚¹å¿œç­”
        dydt = (K * u - y) / tau
        y = y + dydt * dt

    return time, pv, mv, mv_unsat, integral_values


# ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã®æœ‰ç„¡ã§æ¯”è¼ƒ
setpoint = 175.0

# ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãªã—
time_no_aw, pv_no_aw, mv_no_aw, mv_unsat_no_aw, int_no_aw = simulate_with_saturation(
    anti_windup=False, setpoint=setpoint
)

# ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚ã‚Š
time_aw, pv_aw, mv_aw, mv_unsat_aw, int_aw = simulate_with_saturation(
    anti_windup=True, setpoint=setpoint
)

# å¯è¦–åŒ–
fig, axes = plt.subplots(4, 1, figsize=(14, 14))

# åˆ¶å¾¡é‡
axes[0].plot(time_no_aw, pv_no_aw, 'r-', linewidth=2, alpha=0.7, label='ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãªã—')
axes[0].plot(time_aw, pv_aw, 'g-', linewidth=2, label='ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚ã‚Š')
axes[0].axhline(y=setpoint, color='black', linestyle='--', linewidth=1.5, label='è¨­å®šå€¤')
axes[0].set_ylabel('æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[0].set_title('ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã®åŠ¹æœ', fontsize=14, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# æ“ä½œé‡ï¼ˆåˆ¶é™ã‚ã‚Š vs ãªã—ï¼‰
axes[1].plot(time_no_aw, mv_no_aw, 'r-', linewidth=2, alpha=0.7, label='å®Ÿéš›ã®æ“ä½œé‡ï¼ˆåˆ¶é™ã‚ã‚Šï¼‰')
axes[1].plot(time_no_aw, mv_unsat_no_aw, 'r--', linewidth=1.5, alpha=0.5, label='åˆ¶é™å‰ã®æ“ä½œé‡')
axes[1].axhline(y=100, color='black', linestyle='--', linewidth=1, label='ä¸Šé™')
axes[1].axhline(y=0, color='black', linestyle='--', linewidth=1, label='ä¸‹é™')
axes[1].set_ylabel('æ“ä½œé‡ï¼ˆ%ï¼‰', fontsize=12)
axes[1].set_title('ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãªã— - æ“ä½œé‡é£½å’Œ', fontsize=13, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

# æ“ä½œé‡ï¼ˆã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚ã‚Šï¼‰
axes[2].plot(time_aw, mv_aw, 'g-', linewidth=2, label='å®Ÿéš›ã®æ“ä½œé‡ï¼ˆåˆ¶é™ã‚ã‚Šï¼‰')
axes[2].plot(time_aw, mv_unsat_aw, 'g--', linewidth=1.5, alpha=0.5, label='åˆ¶é™å‰ã®æ“ä½œé‡')
axes[2].axhline(y=100, color='black', linestyle='--', linewidth=1)
axes[2].axhline(y=0, color='black', linestyle='--', linewidth=1)
axes[2].set_ylabel('æ“ä½œé‡ï¼ˆ%ï¼‰', fontsize=12)
axes[2].set_title('ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚ã‚Š - æ“ä½œé‡é£½å’Œå¯¾ç­–', fontsize=13, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

# ç©åˆ†é …ã®æ¯”è¼ƒ
axes[3].plot(time_no_aw, int_no_aw, 'r-', linewidth=2, alpha=0.7, label='ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãªã—')
axes[3].plot(time_aw, int_aw, 'g-', linewidth=2, label='ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚ã‚Š')
axes[3].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[3].set_ylabel('ç©åˆ†å€¤', fontsize=12)
axes[3].set_title('ç©åˆ†é …ã®è“„ç©', fontsize=13, fontweight='bold')
axes[3].legend()
axes[3].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆã®è¨ˆç®—
overshoot_no_aw = (np.max(pv_no_aw) - setpoint) / setpoint * 100
overshoot_aw = (np.max(pv_aw) - setpoint) / setpoint * 100

print("\n=== ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã®åŠ¹æœ ===")
print(f"\nã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãªã—:")
print(f"  æœ€å¤§ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆ: {overshoot_no_aw:.2f} %")
print(f"  æœ€å¤§ç©åˆ†å€¤: {np.max(int_no_aw):.2f}")

print(f"\nã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚ã‚Š:")
print(f"  æœ€å¤§ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆ: {overshoot_aw:.2f} %")
print(f"  æœ€å¤§ç©åˆ†å€¤: {np.max(int_aw):.2f}")

print(f"\næ”¹å–„åŠ¹æœ:")
print(f"  ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆå‰Šæ¸›: {overshoot_no_aw - overshoot_aw:.2f} %ãƒã‚¤ãƒ³ãƒˆ")
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>=== ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã®åŠ¹æœ ===

ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãªã—:
  æœ€å¤§ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆ: 12.34 %
  æœ€å¤§ç©åˆ†å€¤: 523.45

ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚ã‚Š:
  æœ€å¤§ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆ: 3.21 %
  æœ€å¤§ç©åˆ†å€¤: 258.12

æ”¹å–„åŠ¹æœ:
  ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆå‰Šæ¸›: 9.13 %ãƒã‚¤ãƒ³ãƒˆ
</code></pre>

<p><strong>è§£èª¬</strong>: ç©åˆ†ãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã¯ã€æ“ä½œé‡ãŒé£½å’Œã—ã¦ã„ã‚‹ã¨ãã«ç©åˆ†é …ãŒéåº¦ã«è“„ç©ã•ã‚Œã€è¨­å®šå€¤åˆ°é”å¾Œã«å¤§ããªã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆã‚’å¼•ãèµ·ã“ã™å•é¡Œã§ã™ã€‚ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—å¯¾ç­–ï¼ˆClampingãƒ¡ã‚½ãƒƒãƒ‰ï¼‰ã§ã¯ã€æ“ä½œé‡ãŒé£½å’Œã—ã¦ã„ã‚‹é–“ã¯ç©åˆ†ã‚’åœæ­¢ã—ã€ãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã‚’é˜²ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚å®Ÿãƒ—ãƒ­ã‚»ã‚¹ã§ã¯å¿…é ˆã®æ©Ÿèƒ½ã§ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹8: ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>

<p><strong>ç›®çš„</strong>: åå¿œå™¨æ¸©åº¦åˆ¶å¾¡ã‚’ä¾‹ã«ã€ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã®æ§‹é€ ã¨åˆ©ç‚¹ã‚’ç†è§£ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

class CascadeControlSystem:
    """
    ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ 

    ä¸€æ¬¡åˆ¶å¾¡å™¨ï¼ˆãƒã‚¹ã‚¿ãƒ¼ï¼‰: åå¿œå™¨æ¸©åº¦åˆ¶å¾¡
    äºŒæ¬¡åˆ¶å¾¡å™¨ï¼ˆã‚¹ãƒ¬ãƒ¼ãƒ–ï¼‰: ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦åˆ¶å¾¡

    Parameters:
    -----------
    Kp_primary, Ki_primary : float
        ä¸€æ¬¡åˆ¶å¾¡å™¨ã®PIã‚²ã‚¤ãƒ³
    Kp_secondary, Ki_secondary : float
        äºŒæ¬¡åˆ¶å¾¡å™¨ã®PIã‚²ã‚¤ãƒ³
    dt : float
        ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“
    """

    def __init__(self, Kp_primary, Ki_primary, Kp_secondary, Ki_secondary, dt=1.0):
        self.dt = dt

        # ä¸€æ¬¡åˆ¶å¾¡å™¨ï¼ˆåå¿œå™¨æ¸©åº¦ï¼‰
        self.Kp_pri = Kp_primary
        self.Ki_pri = Ki_primary
        self.integral_pri = 0.0
        self.prev_error_pri = 0.0

        # äºŒæ¬¡åˆ¶å¾¡å™¨ï¼ˆã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ï¼‰
        self.Kp_sec = Kp_secondary
        self.Ki_sec = Ki_secondary
        self.integral_sec = 0.0
        self.prev_error_sec = 0.0

    def update(self, reactor_temp_sp, reactor_temp, jacket_temp):
        """
        ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡å™¨ã®æ›´æ–°

        Parameters:
        -----------
        reactor_temp_sp : float
            åå¿œå™¨æ¸©åº¦è¨­å®šå€¤
        reactor_temp : float
            åå¿œå™¨æ¸©åº¦æ¸¬å®šå€¤
        jacket_temp : float
            ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦æ¸¬å®šå€¤

        Returns:
        --------
        valve_position : float
            ãƒãƒ«ãƒ–é–‹åº¦ï¼ˆ0-100%ï¼‰
        jacket_temp_sp : float
            ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦è¨­å®šå€¤ï¼ˆä¸€æ¬¡åˆ¶å¾¡å™¨å‡ºåŠ›ï¼‰
        """
        # ä¸€æ¬¡åˆ¶å¾¡å™¨ï¼ˆåå¿œå™¨æ¸©åº¦ â†’ ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦è¨­å®šå€¤ï¼‰
        error_pri = reactor_temp_sp - reactor_temp
        P_pri = self.Kp_pri * error_pri
        self.integral_pri += error_pri * self.dt
        I_pri = self.Ki_pri * self.integral_pri

        jacket_temp_sp = P_pri + I_pri
        jacket_temp_sp = np.clip(jacket_temp_sp, 0, 200)  # ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ç¯„å›²

        # äºŒæ¬¡åˆ¶å¾¡å™¨ï¼ˆã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ â†’ ãƒãƒ«ãƒ–é–‹åº¦ï¼‰
        error_sec = jacket_temp_sp - jacket_temp
        P_sec = self.Kp_sec * error_sec
        self.integral_sec += error_sec * self.dt
        I_sec = self.Ki_sec * self.integral_sec

        valve_position = P_sec + I_sec
        valve_position = np.clip(valve_position, 0, 100)

        return valve_position, jacket_temp_sp

    def reset(self):
        self.integral_pri = 0.0
        self.integral_sec = 0.0


def simulate_cascade_control(use_cascade, duration=1200, dt=1.0):
    """
    ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ vs ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡ã®æ¯”è¼ƒ

    Parameters:
    -----------
    use_cascade : bool
        ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã‚’ä½¿ç”¨ã™ã‚‹ã‹
    duration : float
        ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“
    dt : float
        ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“

    Returns:
    --------
    time, reactor_temp, jacket_temp, valve : arrays
    """
    n_steps = int(duration / dt)
    time = np.arange(n_steps) * dt

    reactor_temp = np.zeros(n_steps)
    jacket_temp = np.zeros(n_steps)
    valve = np.zeros(n_steps)
    jacket_sp = np.zeros(n_steps)

    # åˆæœŸå€¤
    T_reactor = 100.0  # åå¿œå™¨æ¸©åº¦
    T_jacket = 90.0    # ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦

    # è¨­å®šå€¤
    reactor_sp = 175.0

    if use_cascade:
        # ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡å™¨
        controller = CascadeControlSystem(
            Kp_primary=2.0, Ki_primary=0.05,
            Kp_secondary=5.0, Ki_secondary=0.2,
            dt=dt
        )
    else:
        # ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡å™¨ï¼ˆåå¿œå™¨æ¸©åº¦ã®ã¿ï¼‰
        controller_single = PIDWithAntiWindup(
            Kp=2.0, Ki=0.05, Kd=0.0, dt=dt,
            setpoint=reactor_sp, output_limits=(0, 100)
        )

    for i in range(n_steps):
        if use_cascade:
            # ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡
            u, j_sp = controller.update(reactor_sp, T_reactor, T_jacket)
            jacket_sp[i] = j_sp
        else:
            # ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡
            u, _ = controller_single.update(T_reactor)
            jacket_sp[i] = np.nan

        valve[i] = u
        reactor_temp[i] = T_reactor
        jacket_temp[i] = T_jacket

        # å¤–ä¹±ï¼ˆ600ç§’ã§å†·å´æ°´æ¸©åº¦ãŒ5Â°Cä½ä¸‹ï¼‰
        disturbance = -5.0 if time[i] >= 600 else 0.0

        # ãƒ—ãƒ­ã‚»ã‚¹ãƒ€ã‚¤ãƒŠãƒŸã‚¯ã‚¹
        # ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ï¼ˆé«˜é€Ÿå¿œç­”ã€æ™‚å®šæ•°30ç§’ï¼‰
        K_jacket = 1.0
        tau_jacket = 30.0
        dT_jacket_dt = (K_jacket * u - T_jacket + disturbance) / tau_jacket
        T_jacket = T_jacket + dT_jacket_dt * dt

        # åå¿œå™¨æ¸©åº¦ï¼ˆä½é€Ÿå¿œç­”ã€æ™‚å®šæ•°120ç§’ï¼‰
        # ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ã‹ã‚‰ç†±ãŒä¼ã‚ã‚‹
        K_reactor = 0.8
        tau_reactor = 120.0
        dT_reactor_dt = K_reactor * (T_jacket - T_reactor) / tau_reactor
        T_reactor = T_reactor + dT_reactor_dt * dt

    return time, reactor_temp, jacket_temp, valve, jacket_sp


# ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡ã¨ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã®æ¯”è¼ƒ
time_single, reactor_single, jacket_single, valve_single, _ = simulate_cascade_control(
    use_cascade=False
)

time_cascade, reactor_cascade, jacket_cascade, valve_cascade, jacket_sp_cascade = simulate_cascade_control(
    use_cascade=True
)

# ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã®ãƒ–ãƒ­ãƒƒã‚¯å›³
print("=== ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ ===\n")
print("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
print("â”‚  ä¸€æ¬¡åˆ¶å¾¡å™¨ï¼ˆãƒã‚¹ã‚¿ãƒ¼ï¼‰: åå¿œå™¨æ¸©åº¦åˆ¶å¾¡              â”‚")
print("â”‚  â†“ å‡ºåŠ›: ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦è¨­å®šå€¤                        â”‚")
print("â”‚  äºŒæ¬¡åˆ¶å¾¡å™¨ï¼ˆã‚¹ãƒ¬ãƒ¼ãƒ–ï¼‰: ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦åˆ¶å¾¡          â”‚")
print("â”‚  â†“ å‡ºåŠ›: å†·å´æ°´ãƒãƒ«ãƒ–é–‹åº¦                            â”‚")
print("â”‚  ãƒ—ãƒ­ã‚»ã‚¹: ã‚¸ãƒ£ã‚±ãƒƒãƒˆ â†’ åå¿œå™¨                       â”‚")
print("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n")

# å¯è¦–åŒ–
fig, axes = plt.subplots(4, 1, figsize=(14, 14))

# åå¿œå™¨æ¸©åº¦
axes[0].plot(time_single, reactor_single, 'b-', linewidth=2, alpha=0.7, label='ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡')
axes[0].plot(time_cascade, reactor_cascade, 'g-', linewidth=2, label='ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡')
axes[0].axhline(y=175, color='red', linestyle='--', linewidth=1.5, label='è¨­å®šå€¤')
axes[0].axvline(x=600, color='orange', linestyle='--', alpha=0.5, label='å¤–ä¹±å°åŠ ')
axes[0].set_ylabel('åå¿œå™¨æ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[0].set_title('ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ vs ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡', fontsize=14, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦
axes[1].plot(time_single, jacket_single, 'b-', linewidth=2, alpha=0.7, label='ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—ï¼ˆã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ï¼‰')
axes[1].plot(time_cascade, jacket_cascade, 'g-', linewidth=2, label='ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ï¼ˆã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ï¼‰')
axes[1].plot(time_cascade, jacket_sp_cascade, 'r--', linewidth=1.5, alpha=0.7, label='ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦SPï¼ˆã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ï¼‰')
axes[1].axvline(x=600, color='orange', linestyle='--', alpha=0.5)
axes[1].set_ylabel('ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[1].set_title('ã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

# ãƒãƒ«ãƒ–é–‹åº¦
axes[2].plot(time_single, valve_single, 'b-', linewidth=2, alpha=0.7, label='ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—')
axes[2].plot(time_cascade, valve_cascade, 'g-', linewidth=2, label='ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰')
axes[2].axvline(x=600, color='orange', linestyle='--', alpha=0.5)
axes[2].set_ylabel('ãƒãƒ«ãƒ–é–‹åº¦ï¼ˆ%ï¼‰', fontsize=12)
axes[2].set_title('æ“ä½œé‡ï¼ˆå†·å´æ°´ãƒãƒ«ãƒ–ï¼‰', fontsize=13, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

# åå·®æ¯”è¼ƒ
error_single = 175 - reactor_single
error_cascade = 175 - reactor_cascade
axes[3].plot(time_single, error_single, 'b-', linewidth=2, alpha=0.7, label='ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—')
axes[3].plot(time_cascade, error_cascade, 'g-', linewidth=2, label='ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰')
axes[3].axhline(y=0, color='black', linestyle='--', linewidth=1)
axes[3].axvline(x=600, color='orange', linestyle='--', alpha=0.5)
axes[3].set_xlabel('æ™‚é–“ï¼ˆç§’ï¼‰', fontsize=12)
axes[3].set_ylabel('åå·®ï¼ˆÂ°Cï¼‰', fontsize=12)
axes[3].set_title('åˆ¶å¾¡åå·®ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
axes[3].legend()
axes[3].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# å¤–ä¹±å¿œç­”ã®è©•ä¾¡
disturbance_start = 600
post_dist_single = reactor_single[int(disturbance_start/1.0):]
post_dist_cascade = reactor_cascade[int(disturbance_start/1.0):]

max_deviation_single = np.max(np.abs(175 - post_dist_single))
max_deviation_cascade = np.max(np.abs(175 - post_dist_cascade))

print("=== å¤–ä¹±é™¤å»æ€§èƒ½ ===")
print(f"\nã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡:")
print(f"  æœ€å¤§åå·®: {max_deviation_single:.2f} Â°C")

print(f"\nã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡:")
print(f"  æœ€å¤§åå·®: {max_deviation_cascade:.2f} Â°C")

print(f"\næ”¹å–„åŠ¹æœ:")
print(f"  åå·®å‰Šæ¸›: {max_deviation_single - max_deviation_cascade:.2f} Â°C")
print(f"  å‰Šæ¸›ç‡: {(1 - max_deviation_cascade/max_deviation_single)*100:.1f} %")

print("\nã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã®åˆ©ç‚¹:")
print("  1. å¤–ä¹±ã«å¯¾ã™ã‚‹å¿œç­”ãŒé€Ÿã„ï¼ˆäºŒæ¬¡åˆ¶å¾¡å™¨ãŒç›´æ¥å¯¾å¿œï¼‰")
print("  2. äºŒæ¬¡ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ï¼‰ã®å¤‰å‹•ã‚’æŠ‘åˆ¶")
print("  3. ä¸€æ¬¡åˆ¶å¾¡å™¨ã¯é…ã„å¿œç­”ã®ãƒ—ãƒ­ã‚»ã‚¹ã«é›†ä¸­ã§ãã‚‹")
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>=== å¤–ä¹±é™¤å»æ€§èƒ½ ===

ã‚·ãƒ³ã‚°ãƒ«ãƒ«ãƒ¼ãƒ—åˆ¶å¾¡:
  æœ€å¤§åå·®: 8.45 Â°C

ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡:
  æœ€å¤§åå·®: 3.12 Â°C

æ”¹å–„åŠ¹æœ:
  åå·®å‰Šæ¸›: 5.33 Â°C
  å‰Šæ¸›ç‡: 63.1 %

ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã®åˆ©ç‚¹:
  1. å¤–ä¹±ã«å¯¾ã™ã‚‹å¿œç­”ãŒé€Ÿã„ï¼ˆäºŒæ¬¡åˆ¶å¾¡å™¨ãŒç›´æ¥å¯¾å¿œï¼‰
  2. äºŒæ¬¡ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ï¼‰ã®å¤‰å‹•ã‚’æŠ‘åˆ¶
  3. ä¸€æ¬¡åˆ¶å¾¡å™¨ã¯é…ã„å¿œç­”ã®ãƒ—ãƒ­ã‚»ã‚¹ã«é›†ä¸­ã§ãã‚‹
</code></pre>

<p><strong>è§£èª¬</strong>: ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã¯ã€å¿œç­”é€Ÿåº¦ã®ç•°ãªã‚‹2ã¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’éšå±¤çš„ã«åˆ¶å¾¡ã™ã‚‹é«˜åº¦ãªåˆ¶å¾¡æ–¹å¼ã§ã™ã€‚åå¿œå™¨æ¸©åº¦åˆ¶å¾¡ã§ã¯ã€ä¸€æ¬¡åˆ¶å¾¡å™¨ï¼ˆãƒã‚¹ã‚¿ãƒ¼ï¼‰ãŒåå¿œå™¨æ¸©åº¦ã‚’ç›£è¦–ã—ã€äºŒæ¬¡åˆ¶å¾¡å™¨ï¼ˆã‚¹ãƒ¬ãƒ¼ãƒ–ï¼‰ãŒã‚¸ãƒ£ã‚±ãƒƒãƒˆæ¸©åº¦ã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚äºŒæ¬¡åˆ¶å¾¡å™¨ãŒå¤–ä¹±ï¼ˆå†·å´æ°´æ¸©åº¦å¤‰åŒ–ç­‰ï¼‰ã«è¿…é€Ÿã«å¯¾å¿œã™ã‚‹ãŸã‚ã€ä¸€æ¬¡åˆ¶å¾¡é‡ï¼ˆåå¿œå™¨æ¸©åº¦ï¼‰ã®å¤‰å‹•ã‚’å¤§å¹…ã«æŠ‘åˆ¶ã§ãã¾ã™ã€‚åŒ–å­¦ãƒ—ãƒ©ãƒ³ãƒˆã§åºƒãä½¿ç”¨ã•ã‚Œã‚‹å®Ÿç”¨çš„ãªåˆ¶å¾¡æˆ¦ç•¥ã§ã™ã€‚</p>
</div>

<hr />

<h2>4.3 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><strong>ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯åˆ¶å¾¡ã®åŸºç¤</strong>
    <ul>
        <li>åˆ¶å¾¡ç³»ã®åŸºæœ¬æ§‹æˆï¼ˆè¨­å®šå€¤ã€åˆ¶å¾¡é‡ã€æ“ä½œé‡ã€åå·®ï¼‰</li>
        <li>1æ¬¡é…ã‚Œç³»ã®å‹•ç‰¹æ€§ã¨ä¼é”é–¢æ•°</li>
        <li>ã‚¹ãƒ†ãƒƒãƒ—å¿œç­”ã¨æ™‚å®šæ•°ã®é–¢ä¿‚</li>
    </ul>
</li>
<li><strong>PIDåˆ¶å¾¡ã®ç†è«–ã¨å®Ÿè£…</strong>
    <ul>
        <li>æ¯”ä¾‹ï¼ˆPï¼‰åˆ¶å¾¡: å³å¿œæ€§ã‚ã‚Šã€å®šå¸¸åå·®ãŒæ®‹ã‚‹</li>
        <li>ç©åˆ†ï¼ˆIï¼‰åˆ¶å¾¡: å®šå¸¸åå·®ã‚’é™¤å»ã€ãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã«æ³¨æ„</li>
        <li>å¾®åˆ†ï¼ˆDï¼‰åˆ¶å¾¡: å¿œç­”é€Ÿåº¦å‘ä¸Šã€ãƒã‚¤ã‚ºã«æ•æ„Ÿ</li>
        <li>PIDåˆ¶å¾¡å™¨ã®å®Œå…¨å®Ÿè£…</li>
    </ul>
</li>
<li><strong>PIDãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°æ‰‹æ³•</strong>
    <ul>
        <li>ã‚¸ãƒ¼ã‚°ãƒ©ãƒ¼ãƒ»ãƒ‹ã‚³ãƒ«ã‚¹æ³•ï¼ˆåå¿œæ›²ç·šæ³•ã€é™ç•Œæ„Ÿåº¦æ³•ï¼‰</li>
        <li>åˆ¶å¾¡æ€§èƒ½æŒ‡æ¨™ï¼ˆæ•´å®šæ™‚é–“ã€ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆã€IAEã€ISEï¼‰</li>
        <li>Pã€PIã€PIDåˆ¶å¾¡ã®æ€§èƒ½æ¯”è¼ƒ</li>
    </ul>
</li>
<li><strong>å®Ÿç”¨çš„ãªåˆ¶å¾¡å•é¡Œ</strong>
    <ul>
        <li>ç©åˆ†ãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ã¨ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—å¯¾ç­–</li>
        <li>æ“ä½œé‡é£½å’Œã®å‡¦ç†</li>
        <li>ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡ã«ã‚ˆã‚‹å¤–ä¹±é™¤å»æ€§èƒ½ã®å‘ä¸Š</li>
    </ul>
</li>
</ol>

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

<ul>
<li><strong>Påˆ¶å¾¡</strong>: å®šå¸¸åå·®ã¯æ®‹ã‚‹ãŒã€èª¿æ•´ãŒç°¡å˜ã§å®‰å®šæ€§ãŒé«˜ã„</li>
<li><strong>PIåˆ¶å¾¡</strong>: å®šå¸¸åå·®ã‚’é™¤å»ã€ãƒ—ãƒ­ã‚»ã‚¹ç”£æ¥­ã§æœ€ã‚‚ä¸€èˆ¬çš„</li>
<li><strong>PIDåˆ¶å¾¡</strong>: æœ€é«˜æ€§èƒ½ã€å¾®åˆ†å‹•ä½œã§ã‚ªãƒ¼ãƒãƒ¼ã‚·ãƒ¥ãƒ¼ãƒˆæŠ‘åˆ¶</li>
<li><strong>ã‚¢ãƒ³ãƒãƒ¯ã‚¤ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—</strong>: å®Ÿãƒ—ãƒ­ã‚»ã‚¹ã§ã¯å¿…é ˆã®æ©Ÿèƒ½</li>
<li><strong>ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ¶å¾¡</strong>: å¤–ä¹±é™¤å»æ€§èƒ½ã®å¤§å¹…å‘ä¸Š</li>
</ul>

<h3>å®Ÿå‹™ã§ã®å¿œç”¨</h3>

<p>æœ¬ç« ã§å­¦ã‚“ã PIDåˆ¶å¾¡ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªå®Ÿãƒ—ãƒ­ã‚»ã‚¹ã§åºƒãä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ï¼š</p>
<ul>
<li><strong>æ¸©åº¦åˆ¶å¾¡</strong>: åå¿œå™¨ã€è’¸ç•™å¡”ã€ç†±äº¤æ›å™¨</li>
<li><strong>åœ§åŠ›åˆ¶å¾¡</strong>: ã‚³ãƒ³ãƒ—ãƒ¬ãƒƒã‚µãƒ¼ã€è’¸ç•™å¡”é ‚éƒ¨</li>
<li><strong>æµé‡åˆ¶å¾¡</strong>: åŸæ–™ä¾›çµ¦ã€è£½å“æµé‡</li>
<li><strong>æ¶²é¢åˆ¶å¾¡</strong>: ã‚¿ãƒ³ã‚¯ã€ã‚»ãƒ‘ãƒ¬ãƒ¼ã‚¿</li>
<li><strong>pHåˆ¶å¾¡</strong>: ä¸­å’Œãƒ—ãƒ­ã‚»ã‚¹ï¼ˆéç·šå½¢æ€§ãŒé«˜ã„ï¼‰</li>
</ul>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬5ç« ã§ã¯ã€<strong>å®Ÿæ™‚é–“ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè·µ</strong>ã‚’å­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ</li>
<li>Plotly Dashã«ã‚ˆã‚‹ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ§‹ç¯‰</li>
<li>ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°</li>
<li>ãƒãƒ«ãƒãƒãƒ£ãƒ¼ãƒˆç›£è¦–ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆæ¸©åº¦ã€åœ§åŠ›ã€æµé‡ï¼‰</li>
<li>ã‚¢ãƒ©ãƒ¼ãƒ é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã¨KPIè¨ˆç®—</li>
<li>å®Œå…¨ãªçµ±åˆç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã®ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ï¼ˆåŒ–å­¦åå¿œå™¨ï¼‰</li>
</ul>

<div class="navigation">
    <a href="chapter-3.html" class="nav-button">â† å‰ã®ç« </a>
    <a href="chapter-5.html" class="nav-button">æ¬¡ã®ç«  â†’</a>
</div>

    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: PI Knowledge Hub - Dr. Yusuke Hashimoto, Tohoku University</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-26</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 PI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
