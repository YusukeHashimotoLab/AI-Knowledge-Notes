<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬2ç« ï¼šçµ±è¨ˆçš„ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ï¼ˆSPCï¼‰ - ç®¡ç†å›³ã¨ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›åˆ†æã®å®Ÿè·µ">
    <title>ç¬¬2ç« ï¼šçµ±è¨ˆçš„ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ï¼ˆSPCï¼‰ - PI Terakoya</title>

        <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8; color: #333; background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; padding: 2rem 1rem; text-align: center;
        }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; font-size: 1.1rem; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 1rem; }
        .back-link {
            display: inline-block; margin-bottom: 2rem; padding: 0.5rem 1rem;
            background: white; color: #11998e; text-decoration: none;
            border-radius: 6px; font-weight: 600;
        }
        .content-box {
            background: white; padding: 2rem; border-radius: 12px;
            margin-bottom: 2rem; box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #11998e; margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem; border-bottom: 3px solid #11998e;
        }
        h3 { color: #2c3e50; margin: 1.5rem 0 1rem 0; }
        h4 { color: #2c3e50; margin: 1rem 0 0.5rem 0; }
        p { margin-bottom: 1rem; }
        ul, ol { margin-left: 2rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
        pre {
            background: #1e1e1e; color: #d4d4d4; padding: 1.5rem;
            border-radius: 8px; overflow-x: auto; margin: 1rem 0;
            border-left: 4px solid #11998e;
        }
        code {
            font-family: 'Courier New', monospace; font-size: 0.9rem;
        }
        .key-point {
            background: #e8f5e9; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #4caf50; margin: 1rem 0;
        }
        .tech-note {
            background: #e3f2fd; padding: 1rem; border-radius: 6px;
            border-left: 4px solid #2196f3; margin: 1rem 0;
        }
        .formula {
            background: #f0f7ff; padding: 1rem; border-radius: 6px;
            margin: 1rem 0; overflow-x: auto;
        }
        table {
            width: 100%; border-collapse: collapse; margin: 1rem 0;
        }
        th, td {
            border: 1px solid #ddd; padding: 0.75rem; text-align: left;
        }
        th {
            background: #11998e; color: white; font-weight: 600;
        }
        tr:nth-child(even) { background: #f9f9f9; }
        .nav-buttons {
            display: flex; justify-content: space-between; margin-top: 3rem;
        }
        .nav-buttons a {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white; text-decoration: none; border-radius: 6px;
            font-weight: 600;
        }
        footer {
            background: #2c3e50; color: white; text-align: center;
            padding: 2rem 1rem; margin-top: 4rem;
        }
        @media (max-width: 768px) {
            h1 { font-size: 1.6rem; }
            .container { padding: 0 0.5rem; }
            pre { padding: 1rem; }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/PI/index.html">ãƒ—ãƒ­ã‚»ã‚¹ãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/PI/process-monitoring-control-introduction/index.html">Process Monitoring Control</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 2</span>
        </div>
    </nav>

        <header>
        <div class="container">
            <h1>ç¬¬2ç« ï¼šçµ±è¨ˆçš„ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ï¼ˆSPCï¼‰</h1>
            <p class="subtitle">ç®¡ç†å›³ã®ä½œæˆã¨ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›è©•ä¾¡ã®å®Ÿè·µ</p>
            <div class="meta">
                <span class="meta">ğŸ“– èª­äº†æ™‚é–“: 25-30åˆ†</span>
                <span class="meta">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">

<div class="learning-objectives">
<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… çµ±è¨ˆçš„ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ï¼ˆSPCï¼‰ã®åŸºç¤ç†è«–ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆç®¡ç†å›³ï¼ˆXÌ„-R, I-MRï¼‰ã‚’ä½œæˆã—è§£é‡ˆã§ãã‚‹</li>
<li>âœ… ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ï¼ˆCp, Cpkï¼‰ã‚’è¨ˆç®—ã—è©•ä¾¡ã§ãã‚‹</li>
<li>âœ… é«˜åº¦ãªSPCæ‰‹æ³•ï¼ˆCUSUM, EWMA, Hotelling's TÂ²ï¼‰ã‚’å®Ÿè£…ã§ãã‚‹</li>
<li>âœ… ç®¡ç†å›³ã®ç•°å¸¸åˆ¤å®šãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã§ãã‚‹</li>
</ul>
</div>

<hr />

<h2>2.1 çµ±è¨ˆçš„ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ï¼ˆSPCï¼‰ã®åŸºç¤</h2>

<h3>SPCã¨ã¯</h3>

<p><strong>çµ±è¨ˆçš„ãƒ—ãƒ­ã‚»ã‚¹ç®¡ç†ï¼ˆSPC: Statistical Process Controlï¼‰</strong>ã¯ã€çµ±è¨ˆçš„æ‰‹æ³•ã‚’ç”¨ã„ã¦ãƒ—ãƒ­ã‚»ã‚¹ã®å¤‰å‹•ã‚’ç›£è¦–ã—ã€ç•°å¸¸ã‚’æ—©æœŸã«æ¤œå‡ºã—ã¦ãƒ—ãƒ­ã‚»ã‚¹ã‚’ç®¡ç†çŠ¶æ…‹ã«ä¿ã¤ãŸã‚ã®æ‰‹æ³•ã§ã™ã€‚</p>

<p><strong>SPCã®ä¸»ãªç›®çš„:</strong></p>
<ul>
<li><strong>ãƒ—ãƒ­ã‚»ã‚¹ã®å®‰å®šæ€§ç¢ºèª</strong>: çµ±è¨ˆçš„ç®¡ç†çŠ¶æ…‹ã«ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª</li>
<li><strong>ç•°å¸¸ã®æ—©æœŸæ¤œå‡º</strong>: ç‰¹æ®ŠåŸå› ã«ã‚ˆã‚‹å¤‰å‹•ã‚’è¿…é€Ÿã«ç™ºè¦‹</li>
<li><strong>ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›è©•ä¾¡</strong>: è¦æ ¼ã‚’æº€ãŸã™èƒ½åŠ›ãŒã‚ã‚‹ã‹ã‚’å®šé‡è©•ä¾¡</li>
<li><strong>ç¶™ç¶šçš„æ”¹å–„</strong>: ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãæ”¹å–„æ´»å‹•ã®æ¨é€²</li>
<li><strong>äºˆé˜²ä¿å…¨</strong>: å•é¡ŒãŒç™ºç”Ÿã™ã‚‹å‰ã«å¯¾å‡¦</li>
</ul>

<h3>å¤‰å‹•ã®2ã¤ã®ã‚¿ã‚¤ãƒ—</h3>

<table>
<thead>
<tr>
<th>å¤‰å‹•ã®ã‚¿ã‚¤ãƒ—</th>
<th>åˆ¥å</th>
<th>ç‰¹å¾´</th>
<th>åŸå› ä¾‹</th>
<th>å¯¾å¿œ</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å¶ç„¶åŸå› ï¼ˆCommon Causeï¼‰</strong></td>
<td>ã‚·ã‚¹ãƒ†ãƒ å†…å¤‰å‹•</td>
<td>äºˆæ¸¬å¯èƒ½ã€å¸¸æ™‚å­˜åœ¨</td>
<td>æ¸¬å®šèª¤å·®ã€åŸæ–™ã®ã°ã‚‰ã¤ãã€ç’°å¢ƒå¤‰å‹•</td>
<td>ã‚·ã‚¹ãƒ†ãƒ æ”¹å–„</td>
</tr>
<tr>
<td><strong>ç‰¹æ®ŠåŸå› ï¼ˆSpecial Causeï¼‰</strong></td>
<td>ã‚·ã‚¹ãƒ†ãƒ å¤–å¤‰å‹•</td>
<td>äºˆæ¸¬ä¸èƒ½ã€çªç™ºçš„</td>
<td>è¨­å‚™æ•…éšœã€æ“ä½œãƒŸã‚¹ã€åŸæ–™ç•°å¸¸</td>
<td>å³åº§ã«å¯¾å‡¦</td>
</tr>
</tbody>
</table>

<h3>ç®¡ç†å›³ã®åŸºæœ¬æ§‹é€ </h3>

<div class="mermaid">
graph TD
    A[ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿] --> B[ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°]
    B --> C[çµ±è¨ˆé‡è¨ˆç®—]
    C --> D[ç®¡ç†å›³ãƒ—ãƒ­ãƒƒãƒˆ]
    D --> E{ç®¡ç†é™ç•Œå†…ï¼Ÿ}
    E -->|Yes| F[ãƒ—ãƒ­ã‚»ã‚¹å®‰å®š]
    E -->|No| G[ç•°å¸¸æ¤œçŸ¥]
    G --> H[åŸå› èª¿æŸ»ã¨å¯¾ç­–]
    H --> A

    style F fill:#c8e6c9
    style G fill:#ffcdd2
    style D fill:#b3e5fc
</div>

<p><strong>ç®¡ç†å›³ã®åŸºæœ¬è¦ç´ :</strong></p>
<ul>
<li><strong>ä¸­å¿ƒç·šï¼ˆCL: Center Lineï¼‰</strong>: ãƒ—ãƒ­ã‚»ã‚¹ã®å¹³å‡å€¤</li>
<li><strong>ä¸Šæ–¹ç®¡ç†é™ç•Œï¼ˆUCL: Upper Control Limitï¼‰</strong>: CL + 3Ïƒ</li>
<li><strong>ä¸‹æ–¹ç®¡ç†é™ç•Œï¼ˆLCL: Lower Control Limitï¼‰</strong>: CL - 3Ïƒ</li>
<li><strong>ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆ</strong>: æ™‚ç³»åˆ—ã«ãƒ—ãƒ­ãƒƒãƒˆã•ã‚ŒãŸçµ±è¨ˆé‡</li>
</ul>

<hr />

<h2>2.2 ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šç®¡ç†å›³ã¨ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›åˆ†æ</h2>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: XÌ„-Rç®¡ç†å›³ï¼ˆå¹³å‡å€¤ã¨ç¯„å›²ã®ç®¡ç†å›³ï¼‰ã®å®Ÿè£…</h4>

<p><strong>ç›®çš„</strong>: ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰XÌ„-Rç®¡ç†å›³ã‚’ä½œæˆã—ã€ãƒ—ãƒ­ã‚»ã‚¹ã®å®‰å®šæ€§ã‚’è©•ä¾¡ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

# æ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆè¨­å®š
plt.rcParams['font.sans-serif'] = ['Hiragino Sans', 'Arial']
plt.rcParams['axes.unicode_minus'] = False

np.random.seed(42)

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
# 25ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ã€å„ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—5å€‹ã®ã‚µãƒ³ãƒ—ãƒ«
n_subgroups = 25
subgroup_size = 5

# ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ï¼ˆè£½å“ã®é‡é‡ã€ç›®æ¨™å€¤: 100gï¼‰
data = []
for i in range(n_subgroups):
    # æ­£å¸¸ãªãƒ—ãƒ­ã‚»ã‚¹ï¼ˆæœ€åˆã®20ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰
    if i < 20:
        subgroup = np.random.normal(100, 2, subgroup_size)
    # ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ãŒ2gã‚·ãƒ•ãƒˆï¼ˆæœ€å¾Œã®5ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ï¼‰
    else:
        subgroup = np.random.normal(102, 2, subgroup_size)
    data.append(subgroup)

data = np.array(data)

# çµ±è¨ˆé‡ã®è¨ˆç®—
xbar = np.mean(data, axis=1)  # ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—å¹³å‡
R = np.max(data, axis=1) - np.min(data, axis=1)  # ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ç¯„å›²

# ç®¡ç†å›³å®šæ•°ï¼ˆn=5ã®å ´åˆï¼‰
# ã“ã‚Œã‚‰ã®å®šæ•°ã¯çµ±è¨ˆçš„ã«å°å‡ºã•ã‚ŒãŸå€¤
A2 = 0.577  # XÌ„ç®¡ç†å›³ç”¨
D3 = 0.0    # Rç®¡ç†å›³ä¸‹é™ç”¨
D4 = 2.115  # Rç®¡ç†å›³ä¸Šé™ç”¨

# XÌ„ç®¡ç†å›³ã®ç®¡ç†é™ç•Œ
xbar_center = np.mean(xbar)
R_bar = np.mean(R)
xbar_UCL = xbar_center + A2 * R_bar
xbar_LCL = xbar_center - A2 * R_bar

# Rç®¡ç†å›³ã®ç®¡ç†é™ç•Œ
R_center = R_bar
R_UCL = D4 * R_bar
R_LCL = D3 * R_bar

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

# XÌ„ç®¡ç†å›³
axes[0].plot(range(1, n_subgroups + 1), xbar, 'o-', color='#11998e',
             markersize=6, linewidth=1.5, label='ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—å¹³å‡')
axes[0].axhline(y=xbar_center, color='blue', linestyle='-', linewidth=2, label=f'ä¸­å¿ƒç·š (CL={xbar_center:.2f})')
axes[0].axhline(y=xbar_UCL, color='red', linestyle='--', linewidth=2, label=f'UCL={xbar_UCL:.2f}')
axes[0].axhline(y=xbar_LCL, color='red', linestyle='--', linewidth=2, label=f'LCL={xbar_LCL:.2f}')

# ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆã‚’å¼·èª¿
out_of_control = (xbar > xbar_UCL) | (xbar < xbar_LCL)
if out_of_control.any():
    axes[0].scatter(np.where(out_of_control)[0] + 1, xbar[out_of_control],
                   color='red', s=100, marker='o', zorder=5, label='ç®¡ç†é™ç•Œå¤–')

axes[0].set_xlabel('ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ç•ªå·', fontsize=12)
axes[0].set_ylabel('å¹³å‡å€¤ XÌ„ (g)', fontsize=12)
axes[0].set_title('XÌ„ç®¡ç†å›³ï¼ˆå¹³å‡å€¤ç®¡ç†å›³ï¼‰', fontsize=14, fontweight='bold')
axes[0].legend(loc='upper left')
axes[0].grid(alpha=0.3)

# Rç®¡ç†å›³
axes[1].plot(range(1, n_subgroups + 1), R, 'o-', color='#f59e0b',
             markersize=6, linewidth=1.5, label='ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ç¯„å›²')
axes[1].axhline(y=R_center, color='blue', linestyle='-', linewidth=2, label=f'ä¸­å¿ƒç·š (CL={R_center:.2f})')
axes[1].axhline(y=R_UCL, color='red', linestyle='--', linewidth=2, label=f'UCL={R_UCL:.2f}')
if R_LCL > 0:
    axes[1].axhline(y=R_LCL, color='red', linestyle='--', linewidth=2, label=f'LCL={R_LCL:.2f}')

# ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆã‚’å¼·èª¿
out_of_control_R = (R > R_UCL) | (R < R_LCL)
if out_of_control_R.any():
    axes[1].scatter(np.where(out_of_control_R)[0] + 1, R[out_of_control_R],
                   color='red', s=100, marker='o', zorder=5, label='ç®¡ç†é™ç•Œå¤–')

axes[1].set_xlabel('ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ç•ªå·', fontsize=12)
axes[1].set_ylabel('ç¯„å›² R (g)', fontsize=12)
axes[1].set_title('Rç®¡ç†å›³ï¼ˆç¯„å›²ç®¡ç†å›³ï¼‰', fontsize=14, fontweight='bold')
axes[1].legend(loc='upper left')
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# çµ±è¨ˆã‚µãƒãƒªãƒ¼
print("=== XÌ„-Rç®¡ç†å›³ çµ±è¨ˆã‚µãƒãƒªãƒ¼ ===")
print(f"\nã€XÌ„ç®¡ç†å›³ã€‘")
print(f"  ä¸­å¿ƒç·šï¼ˆCLï¼‰: {xbar_center:.3f} g")
print(f"  ä¸Šæ–¹ç®¡ç†é™ç•Œï¼ˆUCLï¼‰: {xbar_UCL:.3f} g")
print(f"  ä¸‹æ–¹ç®¡ç†é™ç•Œï¼ˆLCLï¼‰: {xbar_LCL:.3f} g")
print(f"  ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆæ•°: {out_of_control.sum()}/{n_subgroups}")

print(f"\nã€Rç®¡ç†å›³ã€‘")
print(f"  ä¸­å¿ƒç·šï¼ˆCLï¼‰: {R_center:.3f} g")
print(f"  ä¸Šæ–¹ç®¡ç†é™ç•Œï¼ˆUCLï¼‰: {R_UCL:.3f} g")
print(f"  ä¸‹æ–¹ç®¡ç†é™ç•Œï¼ˆLCLï¼‰: {R_LCL:.3f} g")
print(f"  ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆæ•°: {out_of_control_R.sum()}/{n_subgroups}")

# åˆ¤å®š
if out_of_control.any():
    print(f"\nâš ï¸ è­¦å‘Š: ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ— {np.where(out_of_control)[0] + 1} ã§ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ç•°å¸¸ã‚’æ¤œå‡º")
if out_of_control_R.any():
    print(f"âš ï¸ è­¦å‘Š: ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ— {np.where(out_of_control_R)[0] + 1} ã§ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ã®ç•°å¸¸ã‚’æ¤œå‡º")
if not (out_of_control.any() or out_of_control_R.any()):
    print("\nâœ… ãƒ—ãƒ­ã‚»ã‚¹ã¯çµ±è¨ˆçš„ç®¡ç†çŠ¶æ…‹ã«ã‚ã‚Šã¾ã™")
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre><code>=== XÌ„-Rç®¡ç†å›³ çµ±è¨ˆã‚µãƒãƒªãƒ¼ ===

ã€XÌ„ç®¡ç†å›³ã€‘
  ä¸­å¿ƒç·šï¼ˆCLï¼‰: 100.405 g
  ä¸Šæ–¹ç®¡ç†é™ç•Œï¼ˆUCLï¼‰: 103.088 g
  ä¸‹æ–¹ç®¡ç†é™ç•Œï¼ˆLCLï¼‰: 97.722 g
  ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆæ•°: 3/25

ã€Rç®¡ç†å›³ã€‘
  ä¸­å¿ƒç·šï¼ˆCLï¼‰: 4.651 g
  ä¸Šæ–¹ç®¡ç†é™ç•Œï¼ˆUCLï¼‰: 9.836 g
  ä¸‹æ–¹ç®¡ç†é™ç•Œï¼ˆLCLï¼‰: 0.000 g
  ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆæ•°: 0/25

âš ï¸ è­¦å‘Š: ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ— [22 23 25] ã§ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ç•°å¸¸ã‚’æ¤œå‡º
</code></pre>

<p><strong>è§£èª¬</strong>: XÌ„-Rç®¡ç†å›³ã¯ã€ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ãƒ‡ãƒ¼ã‚¿ã®ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ï¼ˆXÌ„ç®¡ç†å›³ï¼‰ã¨ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ï¼ˆRç®¡ç†å›³ï¼‰ã‚’åŒæ™‚ã«ç›£è¦–ã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—21ä»¥é™ã§ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ãŒ2gã‚·ãƒ•ãƒˆã—ã¦ãŠã‚Šã€XÌ„ç®¡ç†å›³ãŒã“ã‚Œã‚’æ¤œå‡ºã—ã¦ã„ã¾ã™ã€‚XÌ„ç®¡ç†å›³ã¨Rç®¡ç†å›³ã¯å¸¸ã«ãƒšã‚¢ã§ä½¿ç”¨ã—ã€ä¸¡æ–¹ãŒç®¡ç†çŠ¶æ…‹ã«ã‚ã‚‹å ´åˆã®ã¿ã€Œãƒ—ãƒ­ã‚»ã‚¹ãŒå®‰å®šã€ã¨åˆ¤æ–­ã—ã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: I-MRç®¡ç†å›³ï¼ˆå€‹åˆ¥å€¤ã¨ç§»å‹•ç¯„å›²ã®ç®¡ç†å›³ï¼‰</h4>

<p><strong>ç›®çš„</strong>: å€‹åˆ¥æ¸¬å®šå€¤ã‹ã‚‰I-MRç®¡ç†å›³ã‚’ä½œæˆã™ã‚‹ï¼ˆã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã§ããªã„å ´åˆï¼‰ã€‚</p>

<pre><code class="language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)

# å€‹åˆ¥æ¸¬å®šå€¤ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆ1æ—¥1å›ã®æ¸¬å®šã€30æ—¥é–“ï¼‰
n_observations = 30
individual_values = np.random.normal(50, 3, n_observations)

# 15æ—¥ç›®ä»¥é™ã«ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ãŒå¢—åŠ 
individual_values[15:] += np.random.normal(0, 5, n_observations - 15)

# ç§»å‹•ç¯„å›²ï¼ˆMoving Rangeï¼‰ã®è¨ˆç®—
# mR = |X_i - X_{i-1}|
moving_range = np.abs(np.diff(individual_values))

# çµ±è¨ˆé‡ã®è¨ˆç®—
I_bar = np.mean(individual_values)
mR_bar = np.mean(moving_range)

# ç®¡ç†å›³å®šæ•°ï¼ˆç§»å‹•ç¯„å›² n=2ï¼‰
d2 = 1.128  # ç§»å‹•ç¯„å›²ã®æœŸå¾…å€¤ã®å®šæ•°
E2 = 2.66   # Iç®¡ç†å›³ç”¨
D3 = 0.0    # mRç®¡ç†å›³ä¸‹é™ç”¨
D4 = 3.267  # mRç®¡ç†å›³ä¸Šé™ç”¨

# Iç®¡ç†å›³ã®ç®¡ç†é™ç•Œ
I_UCL = I_bar + E2 * mR_bar
I_LCL = I_bar - E2 * mR_bar

# mRç®¡ç†å›³ã®ç®¡ç†é™ç•Œ
mR_center = mR_bar
mR_UCL = D4 * mR_bar
mR_LCL = D3 * mR_bar

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

# Iç®¡ç†å›³ï¼ˆå€‹åˆ¥å€¤ç®¡ç†å›³ï¼‰
axes[0].plot(range(1, n_observations + 1), individual_values, 'o-',
             color='#11998e', markersize=6, linewidth=1.5, label='å€‹åˆ¥æ¸¬å®šå€¤')
axes[0].axhline(y=I_bar, color='blue', linestyle='-', linewidth=2,
                label=f'ä¸­å¿ƒç·š (CL={I_bar:.2f})')
axes[0].axhline(y=I_UCL, color='red', linestyle='--', linewidth=2,
                label=f'UCL={I_UCL:.2f}')
axes[0].axhline(y=I_LCL, color='red', linestyle='--', linewidth=2,
                label=f'LCL={I_LCL:.2f}')

# ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆã‚’æ¤œå‡º
out_of_control_I = (individual_values > I_UCL) | (individual_values < I_LCL)
if out_of_control_I.any():
    axes[0].scatter(np.where(out_of_control_I)[0] + 1,
                   individual_values[out_of_control_I],
                   color='red', s=100, marker='o', zorder=5, label='ç®¡ç†é™ç•Œå¤–')

axes[0].set_xlabel('è¦³æ¸¬ç•ªå·', fontsize=12)
axes[0].set_ylabel('æ¸¬å®šå€¤ (å˜ä½)', fontsize=12)
axes[0].set_title('Iç®¡ç†å›³ï¼ˆå€‹åˆ¥å€¤ç®¡ç†å›³ï¼‰', fontsize=14, fontweight='bold')
axes[0].legend(loc='upper left')
axes[0].grid(alpha=0.3)

# mRç®¡ç†å›³ï¼ˆç§»å‹•ç¯„å›²ç®¡ç†å›³ï¼‰
axes[1].plot(range(2, n_observations + 1), moving_range, 'o-',
             color='#f59e0b', markersize=6, linewidth=1.5, label='ç§»å‹•ç¯„å›²')
axes[1].axhline(y=mR_center, color='blue', linestyle='-', linewidth=2,
                label=f'ä¸­å¿ƒç·š (CL={mR_center:.2f})')
axes[1].axhline(y=mR_UCL, color='red', linestyle='--', linewidth=2,
                label=f'UCL={mR_UCL:.2f}')
if mR_LCL > 0:
    axes[1].axhline(y=mR_LCL, color='red', linestyle='--', linewidth=2,
                    label=f'LCL={mR_LCL:.2f}')

# ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆã‚’æ¤œå‡º
out_of_control_mR = (moving_range > mR_UCL) | (moving_range < mR_LCL)
if out_of_control_mR.any():
    axes[1].scatter(np.where(out_of_control_mR)[0] + 2,
                   moving_range[out_of_control_mR],
                   color='red', s=100, marker='o', zorder=5, label='ç®¡ç†é™ç•Œå¤–')

axes[1].set_xlabel('è¦³æ¸¬ç•ªå·', fontsize=12)
axes[1].set_ylabel('ç§»å‹•ç¯„å›² mR (å˜ä½)', fontsize=12)
axes[1].set_title('mRç®¡ç†å›³ï¼ˆç§»å‹•ç¯„å›²ç®¡ç†å›³ï¼‰', fontsize=14, fontweight='bold')
axes[1].legend(loc='upper left')
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("=== I-MRç®¡ç†å›³ çµ±è¨ˆã‚µãƒãƒªãƒ¼ ===")
print(f"\nã€Iç®¡ç†å›³ã€‘")
print(f"  ä¸­å¿ƒç·šï¼ˆCLï¼‰: {I_bar:.3f}")
print(f"  ä¸Šæ–¹ç®¡ç†é™ç•Œï¼ˆUCLï¼‰: {I_UCL:.3f}")
print(f"  ä¸‹æ–¹ç®¡ç†é™ç•Œï¼ˆLCLï¼‰: {I_LCL:.3f}")
print(f"  ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆæ•°: {out_of_control_I.sum()}/{n_observations}")

print(f"\nã€mRç®¡ç†å›³ã€‘")
print(f"  ä¸­å¿ƒç·šï¼ˆCLï¼‰: {mR_center:.3f}")
print(f"  ä¸Šæ–¹ç®¡ç†é™ç•Œï¼ˆUCLï¼‰: {mR_UCL:.3f}")
print(f"  ä¸‹æ–¹ç®¡ç†é™ç•Œï¼ˆLCLï¼‰: {mR_LCL:.3f}")
print(f"  ç®¡ç†é™ç•Œå¤–ã®ãƒã‚¤ãƒ³ãƒˆæ•°: {out_of_control_mR.sum()}/{len(moving_range)}")

if out_of_control_mR.any():
    print(f"\nâš ï¸ è­¦å‘Š: ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ã®å¢—åŠ ã‚’æ¤œå‡ºï¼ˆè¦³æ¸¬ {np.where(out_of_control_mR)[0] + 2}ï¼‰")
</code></pre>

<p><strong>è§£èª¬</strong>: I-MRç®¡ç†å›³ã¯ã€ã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã§ããªã„å€‹åˆ¥æ¸¬å®šå€¤ï¼ˆä¾‹ï¼š1æ—¥1å›ã®æ¤œæŸ»ã€ãƒãƒƒãƒãƒ—ãƒ­ã‚»ã‚¹ã€é«˜ä¾¡ãªç ´å£Šè©¦é¨“ï¼‰ã«ä½¿ç”¨ã—ã¾ã™ã€‚ç§»å‹•ç¯„å›²ï¼ˆé€£ç¶šã™ã‚‹2ã¤ã®æ¸¬å®šå€¤ã®å·®ã®çµ¶å¯¾å€¤ï¼‰ã‚’ä½¿ã£ã¦ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ã‚’æ¨å®šã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€15æ—¥ç›®ä»¥é™ã§ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ãŒå¢—åŠ ã—ã¦ãŠã‚Šã€mRç®¡ç†å›³ãŒã“ã‚Œã‚’æ¤œå‡ºã—ã¦ã„ã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ï¼ˆCp, Cpkï¼‰ã®è¨ˆç®—ã¨è§£é‡ˆ</h4>

<p><strong>ç›®çš„</strong>: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ã‚’è¨ˆç®—ã—ã€ãƒ—ãƒ­ã‚»ã‚¹ãŒè¦æ ¼ã‚’æº€ãŸã™èƒ½åŠ›ã‚’è©•ä¾¡ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

np.random.seed(42)

# ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆè£½å“å¯¸æ³•ã€å˜ä½: mmï¼‰
n_samples = 200
process_data = np.random.normal(10.0, 0.15, n_samples)

# è¦æ ¼é™ç•Œ
USL = 10.5  # ä¸Šå´è¦æ ¼é™ç•Œï¼ˆUpper Specification Limitï¼‰
LSL = 9.5   # ä¸‹å´è¦æ ¼é™ç•Œï¼ˆLower Specification Limitï¼‰
target = 10.0  # ç›®æ¨™å€¤

# ãƒ—ãƒ­ã‚»ã‚¹çµ±è¨ˆé‡ã®è¨ˆç®—
process_mean = np.mean(process_data)
process_std = np.std(process_data, ddof=1)  # ä¸åæ¨™æº–åå·®

# ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ã®è¨ˆç®—
# Cp: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ï¼ˆProcess Capabilityï¼‰
Cp = (USL - LSL) / (6 * process_std)

# Cpk: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ï¼ˆãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ãšã‚Œã‚’è€ƒæ…®ï¼‰
Cpk_upper = (USL - process_mean) / (3 * process_std)
Cpk_lower = (process_mean - LSL) / (3 * process_std)
Cpk = min(Cpk_upper, Cpk_lower)

# Cpm: ç›®æ¨™å€¤ã‹ã‚‰ã®ãšã‚Œã‚’è€ƒæ…®ã—ãŸãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°
Cpm = (USL - LSL) / (6 * np.sqrt(process_std**2 + (process_mean - target)**2))

# è¦æ ¼å¤–ç‡ã®è¨ˆç®—ï¼ˆç†è«–å€¤ï¼‰
# ãƒ—ãƒ­ã‚»ã‚¹ãŒæ­£è¦åˆ†å¸ƒã«å¾“ã†ã¨ä»®å®š
ppm_below_LSL = stats.norm.cdf(LSL, loc=process_mean, scale=process_std) * 1e6
ppm_above_USL = (1 - stats.norm.cdf(USL, loc=process_mean, scale=process_std)) * 1e6
total_ppm = ppm_below_LSL + ppm_above_USL

# å®Ÿéš›ã®è¦æ ¼å¤–æ•°ï¼ˆã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼‰
actual_out_of_spec = np.sum((process_data < LSL) | (process_data > USL))

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(16, 6))

# ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¨è¦æ ¼é™ç•Œ
axes[0].hist(process_data, bins=30, density=True, alpha=0.6, color='#11998e',
             edgecolor='black', label='ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿')

# æ­£è¦åˆ†å¸ƒã®ç†è«–æ›²ç·š
x = np.linspace(process_data.min(), process_data.max(), 100)
axes[0].plot(x, stats.norm.pdf(x, loc=process_mean, scale=process_std),
             'r-', linewidth=2, label='æ­£è¦åˆ†å¸ƒï¼ˆç†è«–ï¼‰')

# è¦æ ¼é™ç•Œã¨ç›®æ¨™å€¤
axes[0].axvline(x=LSL, color='red', linestyle='--', linewidth=2, label=f'LSL = {LSL}')
axes[0].axvline(x=USL, color='red', linestyle='--', linewidth=2, label=f'USL = {USL}')
axes[0].axvline(x=target, color='green', linestyle='--', linewidth=2, label=f'ç›®æ¨™å€¤ = {target}')
axes[0].axvline(x=process_mean, color='blue', linestyle='-', linewidth=2,
                label=f'ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ = {process_mean:.3f}')

axes[0].set_xlabel('æ¸¬å®šå€¤ (mm)', fontsize=12)
axes[0].set_ylabel('ç¢ºç‡å¯†åº¦', fontsize=12)
axes[0].set_title('ãƒ—ãƒ­ã‚»ã‚¹åˆ†å¸ƒã¨è¦æ ¼é™ç•Œ', fontsize=14, fontweight='bold')
axes[0].legend(fontsize=9)
axes[0].grid(alpha=0.3)

# ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ã®å¯è¦–åŒ–
capability_indices = {
    'Cp': Cp,
    'Cpk': Cpk,
    'Cpm': Cpm
}

colors = ['#11998e', '#f59e0b', '#7b2cbf']
bars = axes[1].bar(capability_indices.keys(), capability_indices.values(),
                   color=colors, alpha=0.7, edgecolor='black')

# èƒ½åŠ›è©•ä¾¡åŸºæº–ç·š
axes[1].axhline(y=1.33, color='orange', linestyle='--', linewidth=2,
                label='è‰¯å¥½åŸºæº– (1.33)')
axes[1].axhline(y=1.67, color='green', linestyle='--', linewidth=2,
                label='å„ªç§€åŸºæº– (1.67)')

# å„ãƒãƒ¼ã«æ•°å€¤ã‚’è¡¨ç¤º
for bar in bars:
    height = bar.get_height()
    axes[1].text(bar.get_x() + bar.get_width()/2., height,
                f'{height:.3f}',
                ha='center', va='bottom', fontsize=12, fontweight='bold')

axes[1].set_ylabel('èƒ½åŠ›æŒ‡æ•°', fontsize=12)
axes[1].set_title('ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ã®æ¯”è¼ƒ', fontsize=14, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3, axis='y')
axes[1].set_ylim(0, max(capability_indices.values()) * 1.2)

plt.tight_layout()
plt.show()

# çµæœã‚µãƒãƒªãƒ¼
print("=== ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›åˆ†æ ===")
print(f"\nã€ãƒ—ãƒ­ã‚»ã‚¹çµ±è¨ˆé‡ã€‘")
print(f"  ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡: {process_mean:.4f} mm")
print(f"  ãƒ—ãƒ­ã‚»ã‚¹æ¨™æº–åå·®: {process_std:.4f} mm")
print(f"  ã‚µãƒ³ãƒ—ãƒ«æ•°: {n_samples}")

print(f"\nã€è¦æ ¼æƒ…å ±ã€‘")
print(f"  ä¸Šå´è¦æ ¼é™ç•Œï¼ˆUSLï¼‰: {USL} mm")
print(f"  ä¸‹å´è¦æ ¼é™ç•Œï¼ˆLSLï¼‰: {LSL} mm")
print(f"  ç›®æ¨™å€¤: {target} mm")
print(f"  è¦æ ¼å¹…: {USL - LSL} mm")

print(f"\nã€ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ã€‘")
print(f"  Cp  = {Cp:.3f}  ï¼ˆè¦æ ¼å¹…ã¨ãƒ—ãƒ­ã‚»ã‚¹å¹…ã®æ¯”ï¼‰")
print(f"  Cpk = {Cpk:.3f}  ï¼ˆãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ãšã‚Œã‚’è€ƒæ…®ï¼‰")
print(f"  Cpm = {Cpm:.3f}  ï¼ˆç›®æ¨™å€¤ã‹ã‚‰ã®ãšã‚Œã‚’è€ƒæ…®ï¼‰")

print(f"\nã€è¦æ ¼å¤–ç‡ï¼ˆç†è«–å€¤ï¼‰ã€‘")
print(f"  ä¸‹å´è¦æ ¼å¤–: {ppm_below_LSL:.2f} ppm")
print(f"  ä¸Šå´è¦æ ¼å¤–: {ppm_above_USL:.2f} ppm")
print(f"  åˆè¨ˆè¦æ ¼å¤–: {total_ppm:.2f} ppm ({total_ppm/1e4:.4f}%)")

print(f"\nã€å®Ÿéš›ã®è¦æ ¼å¤–æ•°ã€‘")
print(f"  è¦æ ¼å¤–ã‚µãƒ³ãƒ—ãƒ«æ•°: {actual_out_of_spec}/{n_samples} ({actual_out_of_spec/n_samples*100:.2f}%)")

# èƒ½åŠ›åˆ¤å®š
print(f"\nã€ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›åˆ¤å®šã€‘")
if Cpk >= 1.67:
    print("  âœ… å„ªç§€: ãƒ—ãƒ­ã‚»ã‚¹ã¯ååˆ†ãªèƒ½åŠ›ãŒã‚ã‚Šã¾ã™ï¼ˆCpk â‰¥ 1.67ï¼‰")
elif Cpk >= 1.33:
    print("  âœ… è‰¯å¥½: ãƒ—ãƒ­ã‚»ã‚¹ã¯é©åˆ‡ãªèƒ½åŠ›ãŒã‚ã‚Šã¾ã™ï¼ˆCpk â‰¥ 1.33ï¼‰")
elif Cpk >= 1.0:
    print("  âš ï¸  æœ€ä½é™: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›ã¯æœ€ä½é™ã§ã™ï¼ˆCpk â‰¥ 1.0ï¼‰ã€æ”¹å–„ã‚’æ¨å¥¨")
else:
    print("  âŒ ä¸ååˆ†: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›ãŒä¸è¶³ã—ã¦ã„ã¾ã™ï¼ˆCpk < 1.0ï¼‰ã€æ—©æ€¥ãªæ”¹å–„ãŒå¿…è¦")
</code></pre>

<p><strong>è§£èª¬</strong>: ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›æŒ‡æ•°ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹ãŒè¦æ ¼ã‚’æº€ãŸã™èƒ½åŠ›ã‚’å®šé‡è©•ä¾¡ã—ã¾ã™ã€‚<strong>Cp</strong>ã¯ãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ã®ã¿ã‚’è€ƒæ…®ã—ã€<strong>Cpk</strong>ã¯ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ãšã‚Œã‚‚è€ƒæ…®ã—ã¾ã™ã€‚ä¸€èˆ¬çš„ã«ã€Cpk â‰¥ 1.33ãŒã€Œè‰¯å¥½ã€ã€Cpk â‰¥ 1.67ãŒã€Œå„ªç§€ã€ã¨ã•ã‚Œã¾ã™ã€‚CpkãŒ1.0æœªæº€ã®å ´åˆã€è¦æ ¼å¤–å“ãŒå¤šãç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ãŒé«˜ã„ãŸã‚ã€ãƒ—ãƒ­ã‚»ã‚¹æ”¹å–„ãŒå¿…è¦ã§ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: CUSUMç®¡ç†å›³ï¼ˆç´¯ç©å’Œç®¡ç†å›³ï¼‰ã®å®Ÿè£…</h4>

<p><strong>ç›®çš„</strong>: CUSUMç®¡ç†å›³ã§å°ã•ãªãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ã‚·ãƒ•ãƒˆã‚’æ¤œå‡ºã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)

# ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
n_samples = 100
target_mean = 50.0
process_std = 2.0

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆ40ã‚µãƒ³ãƒ—ãƒ«ç›®ã‹ã‚‰ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ãŒ0.5Ïƒã‚·ãƒ•ãƒˆï¼‰
data = np.zeros(n_samples)
data[:40] = np.random.normal(target_mean, process_std, 40)
data[40:] = np.random.normal(target_mean + 0.5 * process_std, process_std, 60)

# CUSUM ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
# K: å‚ç…§å€¤ï¼ˆæ¤œå‡ºã—ãŸã„ã‚·ãƒ•ãƒˆã®åŠåˆ†ï¼‰
# H: æ±ºå®šåŒºé–“ï¼ˆã‚¢ãƒ©ãƒ¼ãƒ ã‚’å‡ºã™é–¾å€¤ï¼‰
shift_to_detect = 0.5 * process_std  # 0.5Ïƒã®ã‚·ãƒ•ãƒˆã‚’æ¤œå‡º
K = shift_to_detect / 2
H = 5 * process_std  # ä¸€èˆ¬çš„ã«ã¯4Ïƒ~5Ïƒ

# CUSUMè¨ˆç®—
# ä¸Šå´CUSUM (ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®å¢—åŠ ã‚’æ¤œå‡º)
Cp = np.zeros(n_samples)
# ä¸‹å´CUSUM (ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®æ¸›å°‘ã‚’æ¤œå‡º)
Cn = np.zeros(n_samples)

for i in range(1, n_samples):
    Cp[i] = max(0, Cp[i-1] + (data[i] - target_mean) - K)
    Cn[i] = max(0, Cn[i-1] - (data[i] - target_mean) - K)

# ã‚¢ãƒ©ãƒ¼ãƒ æ¤œå‡º
alarm_high = Cp > H
alarm_low = Cn > H

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 1, figsize=(14, 12))

# å…ƒãƒ‡ãƒ¼ã‚¿ã®ãƒ—ãƒ­ãƒƒãƒˆ
axes[0].plot(range(n_samples), data, 'o-', color='#11998e',
             markersize=4, linewidth=1, alpha=0.7, label='æ¸¬å®šå€¤')
axes[0].axhline(y=target_mean, color='blue', linestyle='-', linewidth=2,
                label=f'ç›®æ¨™å€¤ = {target_mean}')
axes[0].axvline(x=40, color='red', linestyle='--', alpha=0.5,
                label='ãƒ—ãƒ­ã‚»ã‚¹å¤‰åŒ–ç‚¹')
axes[0].set_ylabel('æ¸¬å®šå€¤', fontsize=11)
axes[0].set_title('ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ï¼ˆ40ã‚µãƒ³ãƒ—ãƒ«ç›®ã‹ã‚‰0.5Ïƒã‚·ãƒ•ãƒˆï¼‰',
                  fontsize=13, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# ä¸Šå´CUSUM
axes[1].plot(range(n_samples), Cp, 'o-', color='#f59e0b',
             markersize=4, linewidth=1.5, label='ä¸Šå´CUSUM (C+)')
axes[1].axhline(y=H, color='red', linestyle='--', linewidth=2,
                label=f'æ±ºå®šåŒºé–“ H = {H:.1f}')
axes[1].axhline(y=0, color='gray', linestyle='-', linewidth=1)
if alarm_high.any():
    first_alarm = np.where(alarm_high)[0][0]
    axes[1].scatter(np.where(alarm_high)[0], Cp[alarm_high],
                   color='red', s=80, marker='o', zorder=5, label='ã‚¢ãƒ©ãƒ¼ãƒ ')
    axes[1].axvline(x=first_alarm, color='red', linestyle=':', alpha=0.7)
axes[1].set_ylabel('CUSUM C+', fontsize=11)
axes[1].set_title('ä¸Šå´CUSUMç®¡ç†å›³ï¼ˆãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®å¢—åŠ æ¤œå‡ºï¼‰',
                  fontsize=13, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

# ä¸‹å´CUSUM
axes[2].plot(range(n_samples), Cn, 'o-', color='#7b2cbf',
             markersize=4, linewidth=1.5, label='ä¸‹å´CUSUM (C-)')
axes[2].axhline(y=H, color='red', linestyle='--', linewidth=2,
                label=f'æ±ºå®šåŒºé–“ H = {H:.1f}')
axes[2].axhline(y=0, color='gray', linestyle='-', linewidth=1)
if alarm_low.any():
    first_alarm_low = np.where(alarm_low)[0][0]
    axes[2].scatter(np.where(alarm_low)[0], Cn[alarm_low],
                   color='red', s=80, marker='o', zorder=5, label='ã‚¢ãƒ©ãƒ¼ãƒ ')
    axes[2].axvline(x=first_alarm_low, color='red', linestyle=':', alpha=0.7)
axes[2].set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ç•ªå·', fontsize=11)
axes[2].set_ylabel('CUSUM C-', fontsize=11)
axes[2].set_title('ä¸‹å´CUSUMç®¡ç†å›³ï¼ˆãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®æ¸›å°‘æ¤œå‡ºï¼‰',
                  fontsize=13, fontweight='bold')
axes[2].legend()
axes[2].grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("=== CUSUMç®¡ç†å›³ åˆ†æçµæœ ===")
print(f"\nãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š:")
print(f"  ç›®æ¨™å€¤ï¼ˆÎ¼â‚€ï¼‰: {target_mean}")
print(f"  æ¨™æº–åå·®ï¼ˆÏƒï¼‰: {process_std}")
print(f"  å‚ç…§å€¤ï¼ˆKï¼‰: {K:.2f} (æ¤œå‡ºã‚·ãƒ•ãƒˆã®åŠåˆ†)")
print(f"  æ±ºå®šåŒºé–“ï¼ˆHï¼‰: {H:.2f}")

print(f"\nãƒ—ãƒ­ã‚»ã‚¹çµ±è¨ˆ:")
print(f"  å‰åŠï¼ˆ1-40ï¼‰å¹³å‡: {np.mean(data[:40]):.2f}")
print(f"  å¾ŒåŠï¼ˆ41-100ï¼‰å¹³å‡: {np.mean(data[40:]):.2f}")
print(f"  å®Ÿéš›ã®ã‚·ãƒ•ãƒˆ: {np.mean(data[40:]) - np.mean(data[:40]):.2f}")

if alarm_high.any():
    first_alarm = np.where(alarm_high)[0][0]
    detection_delay = first_alarm - 40
    print(f"\nâœ… ä¸Šå´ã‚¢ãƒ©ãƒ¼ãƒ æ¤œå‡º:")
    print(f"  æœ€åˆã®ã‚¢ãƒ©ãƒ¼ãƒ : ã‚µãƒ³ãƒ—ãƒ« {first_alarm + 1}")
    print(f"  æ¤œå‡ºé…ã‚Œ: {detection_delay} ã‚µãƒ³ãƒ—ãƒ«")
else:
    print("\nâŒ ä¸Šå´ã‚¢ãƒ©ãƒ¼ãƒ : æ¤œå‡ºãªã—")

if alarm_low.any():
    first_alarm_low = np.where(alarm_low)[0][0]
    print(f"\nâœ… ä¸‹å´ã‚¢ãƒ©ãƒ¼ãƒ æ¤œå‡º: ã‚µãƒ³ãƒ—ãƒ« {first_alarm_low + 1}")
else:
    print("\nâŒ ä¸‹å´ã‚¢ãƒ©ãƒ¼ãƒ : æ¤œå‡ºãªã—")
</code></pre>

<p><strong>è§£èª¬</strong>: CUSUMï¼ˆCumulative Sumï¼‰ç®¡ç†å›³ã¯ã€ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆç®¡ç†å›³ã§ã¯æ¤œå‡ºãŒé›£ã—ã„å°ã•ãªãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ã‚·ãƒ•ãƒˆï¼ˆ0.5Ïƒã€œ2Ïƒï¼‰ã‚’åŠ¹ç‡çš„ã«æ¤œå‡ºã—ã¾ã™ã€‚ç´¯ç©å’Œã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã§ã€æŒç¶šçš„ãªå°ã•ãªå¤‰åŒ–ã‚’å¢—å¹…ã—ã¦æ¤œå‡ºã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€40ã‚µãƒ³ãƒ—ãƒ«ç›®ã‹ã‚‰ã®0.5Ïƒã‚·ãƒ•ãƒˆã‚’ã€å¾“æ¥ã®XÌ„ç®¡ç†å›³ã‚ˆã‚Šæ—©ãæ¤œå‡ºã§ãã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: EWMAç®¡ç†å›³ï¼ˆæŒ‡æ•°åŠ é‡ç§»å‹•å¹³å‡ç®¡ç†å›³ï¼‰ã®å®Ÿè£…</h4>

<p><strong>ç›®çš„</strong>: EWMAç®¡ç†å›³ã§æ™‚ç³»åˆ—ã®é‡ã¿ä»˜ã‘ã«ã‚ˆã‚Šç•°å¸¸ã‚’æ¤œå‡ºã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)

# ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
n_samples = 100
target_mean = 100.0
process_std = 3.0

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆ50ã‚µãƒ³ãƒ—ãƒ«ç›®ã‹ã‚‰ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ãŒ1Ïƒã‚·ãƒ•ãƒˆï¼‰
data = np.zeros(n_samples)
data[:50] = np.random.normal(target_mean, process_std, 50)
data[50:] = np.random.normal(target_mean + 1.0 * process_std, process_std, 50)

# EWMAãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
# Î» (lambda): é‡ã¿ä»˜ã‘å®šæ•° (0 < Î» â‰¤ 1)
# Î»ãŒå°ã•ã„: éå»ã®ãƒ‡ãƒ¼ã‚¿ã«é‡ãã‚’ç½®ãï¼ˆå°ã•ãªå¤‰åŒ–ã«æ•æ„Ÿï¼‰
# Î»ãŒå¤§ãã„: ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã«é‡ãã‚’ç½®ãï¼ˆå¤§ããªå¤‰åŒ–ã«æ•æ„Ÿï¼‰
lambda_param = 0.2
L = 3  # ç®¡ç†é™ç•Œã®ä¿‚æ•°ï¼ˆé€šå¸¸2.7ï½3ï¼‰

# EWMAè¨ˆç®—
z = np.zeros(n_samples)
z[0] = target_mean  # åˆæœŸå€¤ã¯ç›®æ¨™å€¤

for i in range(1, n_samples):
    z[i] = lambda_param * data[i] + (1 - lambda_param) * z[i-1]

# ç®¡ç†é™ç•Œã®è¨ˆç®—
# å„æ™‚ç‚¹ã§ã®ç®¡ç†é™ç•Œï¼ˆæ™‚é–“ã¨ã¨ã‚‚ã«åæŸï¼‰
ucl = np.zeros(n_samples)
lcl = np.zeros(n_samples)

for i in range(n_samples):
    # ç®¡ç†é™ç•Œã®æ¨™æº–åå·®
    std_z = process_std * np.sqrt(lambda_param / (2 - lambda_param) *
                                   (1 - (1 - lambda_param)**(2 * (i + 1))))
    ucl[i] = target_mean + L * std_z
    lcl[i] = target_mean - L * std_z

# ã‚¢ãƒ©ãƒ¼ãƒ æ¤œå‡º
alarm = (z > ucl) | (z < lcl)

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(14, 10))

# å…ƒãƒ‡ãƒ¼ã‚¿
axes[0].plot(range(n_samples), data, 'o', color='lightgray',
             markersize=4, alpha=0.5, label='å€‹åˆ¥æ¸¬å®šå€¤')
axes[0].axhline(y=target_mean, color='blue', linestyle='-', linewidth=2,
                label=f'ç›®æ¨™å€¤ = {target_mean}')
axes[0].axvline(x=50, color='red', linestyle='--', alpha=0.5,
                label='ãƒ—ãƒ­ã‚»ã‚¹å¤‰åŒ–ç‚¹')
axes[0].set_ylabel('æ¸¬å®šå€¤', fontsize=11)
axes[0].set_title('ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ï¼ˆ50ã‚µãƒ³ãƒ—ãƒ«ç›®ã‹ã‚‰1Ïƒã‚·ãƒ•ãƒˆï¼‰',
                  fontsize=13, fontweight='bold')
axes[0].legend()
axes[0].grid(alpha=0.3)

# EWMAç®¡ç†å›³
axes[1].plot(range(n_samples), z, 'o-', color='#11998e',
             markersize=5, linewidth=1.5, label=f'EWMA (Î»={lambda_param})')
axes[1].plot(range(n_samples), ucl, 'r--', linewidth=2, label=f'UCL (L={L})')
axes[1].plot(range(n_samples), lcl, 'r--', linewidth=2, label=f'LCL (L={L})')
axes[1].axhline(y=target_mean, color='blue', linestyle='-', linewidth=2,
                label=f'ä¸­å¿ƒç·š = {target_mean}')

# ã‚¢ãƒ©ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆã‚’å¼·èª¿
if alarm.any():
    first_alarm = np.where(alarm)[0][0]
    axes[1].scatter(np.where(alarm)[0], z[alarm],
                   color='red', s=100, marker='o', zorder=5, label='ã‚¢ãƒ©ãƒ¼ãƒ ')
    axes[1].axvline(x=first_alarm, color='red', linestyle=':', alpha=0.7)

axes[1].set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ç•ªå·', fontsize=11)
axes[1].set_ylabel('EWMAçµ±è¨ˆé‡', fontsize=11)
axes[1].set_title('EWMAç®¡ç†å›³', fontsize=13, fontweight='bold')
axes[1].legend()
axes[1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("=== EWMAç®¡ç†å›³ åˆ†æçµæœ ===")
print(f"\nãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š:")
print(f"  ç›®æ¨™å€¤ï¼ˆÎ¼â‚€ï¼‰: {target_mean}")
print(f"  æ¨™æº–åå·®ï¼ˆÏƒï¼‰: {process_std}")
print(f"  é‡ã¿ä»˜ã‘å®šæ•°ï¼ˆÎ»ï¼‰: {lambda_param}")
print(f"  ç®¡ç†é™ç•Œä¿‚æ•°ï¼ˆLï¼‰: {L}")

print(f"\nãƒ—ãƒ­ã‚»ã‚¹çµ±è¨ˆ:")
print(f"  å‰åŠï¼ˆ1-50ï¼‰å¹³å‡: {np.mean(data[:50]):.2f}")
print(f"  å¾ŒåŠï¼ˆ51-100ï¼‰å¹³å‡: {np.mean(data[50:]):.2f}")
print(f"  å®Ÿéš›ã®ã‚·ãƒ•ãƒˆ: {np.mean(data[50:]) - target_mean:.2f}")

print(f"\nEWMAçµ±è¨ˆ:")
print(f"  å‰åŠEWMAå¹³å‡: {np.mean(z[:50]):.2f}")
print(f"  å¾ŒåŠEWMAå¹³å‡: {np.mean(z[50:]):.2f}")

if alarm.any():
    first_alarm = np.where(alarm)[0][0]
    detection_delay = first_alarm - 50
    print(f"\nâœ… ã‚¢ãƒ©ãƒ¼ãƒ æ¤œå‡º:")
    print(f"  æœ€åˆã®ã‚¢ãƒ©ãƒ¼ãƒ : ã‚µãƒ³ãƒ—ãƒ« {first_alarm + 1}")
    print(f"  æ¤œå‡ºé…ã‚Œ: {detection_delay} ã‚µãƒ³ãƒ—ãƒ«")
    print(f"  ã‚¢ãƒ©ãƒ¼ãƒ ç·æ•°: {alarm.sum()}")
else:
    print("\nâŒ ã‚¢ãƒ©ãƒ¼ãƒ : æ¤œå‡ºãªã—")

# Î»ã®å½±éŸ¿ã‚’æ¯”è¼ƒ
print(f"\nã€Î»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½±éŸ¿ã€‘")
print(f"  Î» = 0.1 : éå»20ã‚µãƒ³ãƒ—ãƒ«ã‚’é‡è¦–ï¼ˆå°ã•ãªã‚·ãƒ•ãƒˆã«æ•æ„Ÿï¼‰")
print(f"  Î» = 0.2 : éå»10ã‚µãƒ³ãƒ—ãƒ«ã‚’é‡è¦–ï¼ˆãƒãƒ©ãƒ³ã‚¹å‹ï¼‰â† ä»Šå›")
print(f"  Î» = 0.5 : éå»4ã‚µãƒ³ãƒ—ãƒ«ã‚’é‡è¦–ï¼ˆå¤§ããªã‚·ãƒ•ãƒˆã«æ•æ„Ÿï¼‰")
print(f"  Î» = 1.0 : ç¾åœ¨ã®ã‚µãƒ³ãƒ—ãƒ«ã®ã¿ï¼ˆã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆç®¡ç†å›³ã¨åŒç­‰ï¼‰")
</code></pre>

<p><strong>è§£èª¬</strong>: EWMAï¼ˆExponentially Weighted Moving Averageï¼‰ç®¡ç†å›³ã¯ã€éå»ã®ãƒ‡ãƒ¼ã‚¿ã«æŒ‡æ•°çš„ã«æ¸›è¡°ã™ã‚‹é‡ã¿ã‚’ä»˜ã‘ã¦å¹³å‡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚Î»ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã‚Šã€å°ã•ãªã‚·ãƒ•ãƒˆã¸ã®æ„Ÿåº¦ã‚’èª¿æ•´ã§ãã¾ã™ã€‚Î»ãŒå°ã•ã„ã»ã©å°ã•ãªã‚·ãƒ•ãƒˆã®æ¤œå‡ºã«å„ªã‚Œã€Î»ãŒå¤§ãã„ã»ã©å¤§ããªã‚·ãƒ•ãƒˆã®æ¤œå‡ºã«å„ªã‚Œã¾ã™ã€‚ä¸€èˆ¬çš„ã«Î»=0.2ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: Hotelling's TÂ²ç®¡ç†å›³ï¼ˆå¤šå¤‰é‡ç®¡ç†å›³ï¼‰</h4>

<p><strong>ç›®çš„</strong>: è¤‡æ•°ã®å¤‰æ•°ã‚’åŒæ™‚ã«ç›£è¦–ã™ã‚‹å¤šå¤‰é‡ç®¡ç†å›³ã‚’å®Ÿè£…ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

np.random.seed(42)

# 2å¤‰æ•°ã®å¤šå¤‰é‡ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
n_samples = 100

# ç›¸é–¢ã®ã‚ã‚‹2å¤‰æ•°ï¼ˆæ¸©åº¦ã¨åœ§åŠ›ï¼‰
mean_vector = np.array([100, 50])  # æ¸©åº¦100Â°Cã€åœ§åŠ›50kPa
# å…±åˆ†æ•£è¡Œåˆ—ï¼ˆæ­£ã®ç›¸é–¢ï¼‰
cov_matrix = np.array([[9, 4],
                       [4, 4]])

# æ­£å¸¸ãƒ‡ãƒ¼ã‚¿ï¼ˆæœ€åˆã®70ã‚µãƒ³ãƒ—ãƒ«ï¼‰
data_normal = np.random.multivariate_normal(mean_vector, cov_matrix, 70)

# ç•°å¸¸ãƒ‡ãƒ¼ã‚¿ï¼ˆæœ€å¾Œã®30ã‚µãƒ³ãƒ—ãƒ«ï¼šæ¸©åº¦ãŒä¸Šæ˜‡ï¼‰
mean_abnormal = np.array([105, 51])
data_abnormal = np.random.multivariate_normal(mean_abnormal, cov_matrix, 30)

# ãƒ‡ãƒ¼ã‚¿ã®çµåˆ
data = np.vstack([data_normal, data_abnormal])

# Hotelling's TÂ²çµ±è¨ˆé‡ã®è¨ˆç®—
# TÂ² = (x - Î¼)áµ€ Î£â»Â¹ (x - Î¼)
# ã“ã“ã§ã€Î¼ã¯å¹³å‡ãƒ™ã‚¯ãƒˆãƒ«ã€Î£ã¯å…±åˆ†æ•£è¡Œåˆ—

# æ­£å¸¸ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¹³å‡ã¨å…±åˆ†æ•£ã‚’æ¨å®šï¼ˆæœ€åˆã®70ã‚µãƒ³ãƒ—ãƒ«ï¼‰
mean_est = np.mean(data_normal, axis=0)
cov_est = np.cov(data_normal, rowvar=False)
cov_inv = np.linalg.inv(cov_est)

# å„ã‚µãƒ³ãƒ—ãƒ«ã®TÂ²çµ±è¨ˆé‡ã‚’è¨ˆç®—
T2_values = np.zeros(n_samples)
for i in range(n_samples):
    diff = data[i] - mean_est
    T2_values[i] = diff @ cov_inv @ diff

# ç®¡ç†é™ç•Œã®è¨ˆç®—
# ãƒ•ã‚§ãƒ¼ã‚ºIï¼ˆéå»ãƒ‡ãƒ¼ã‚¿ã®è©•ä¾¡ï¼‰ã®ç®¡ç†é™ç•Œ
p = 2  # å¤‰æ•°ã®æ•°
m = 70  # æ­£å¸¸ãƒ‡ãƒ¼ã‚¿ã®ã‚µãƒ³ãƒ—ãƒ«æ•°
alpha = 0.01  # æœ‰æ„æ°´æº–

# ãƒ™ãƒ¼ã‚¿åˆ†å¸ƒã«åŸºã¥ãç®¡ç†é™ç•Œ
UCL = (p * (m + 1) * (m - 1) / (m * (m - p))) * \
      stats.f.ppf(1 - alpha, p, m - p)

# ã‚¢ãƒ©ãƒ¼ãƒ æ¤œå‡º
alarm = T2_values > UCL

# å¯è¦–åŒ–
fig = plt.figure(figsize=(16, 10))

# 2å¤‰æ•°ã®æ•£å¸ƒå›³
ax1 = plt.subplot(2, 2, 1)
ax1.scatter(data_normal[:, 0], data_normal[:, 1], c='#11998e', s=40,
           alpha=0.6, label='æ­£å¸¸ãƒ‡ãƒ¼ã‚¿ (1-70)')
ax1.scatter(data_abnormal[:, 0], data_abnormal[:, 1], c='orange', s=40,
           alpha=0.6, label='ç•°å¸¸ãƒ‡ãƒ¼ã‚¿ (71-100)')

# ç®¡ç†é™ç•Œæ¥•å††ã‚’æç”»
from matplotlib.patches import Ellipse

# TÂ²=UCLã®æ¥•å††
eigenvalues, eigenvectors = np.linalg.eig(cov_est)
angle = np.arctan2(eigenvectors[1, 0], eigenvectors[0, 0])
width, height = 2 * np.sqrt(UCL * eigenvalues)

ellipse = Ellipse(mean_est, width, height, angle=np.degrees(angle),
                 facecolor='none', edgecolor='red', linewidth=2,
                 linestyle='--', label='ç®¡ç†é™ç•Œ (TÂ²=UCL)')
ax1.add_patch(ellipse)

ax1.scatter(mean_est[0], mean_est[1], c='blue', s=100, marker='x',
           linewidths=3, label='ãƒ—ãƒ­ã‚»ã‚¹ä¸­å¿ƒ')
ax1.set_xlabel('æ¸©åº¦ (Â°C)', fontsize=11)
ax1.set_ylabel('åœ§åŠ› (kPa)', fontsize=11)
ax1.set_title('2å¤‰æ•°æ•£å¸ƒå›³ã¨ç®¡ç†é™ç•Œæ¥•å††', fontsize=13, fontweight='bold')
ax1.legend()
ax1.grid(alpha=0.3)

# TÂ²ç®¡ç†å›³
ax2 = plt.subplot(2, 2, 2)
ax2.plot(range(1, n_samples + 1), T2_values, 'o-', color='#11998e',
        markersize=5, linewidth=1.5, label='TÂ²çµ±è¨ˆé‡')
ax2.axhline(y=UCL, color='red', linestyle='--', linewidth=2,
           label=f'UCL = {UCL:.2f}')
ax2.axvline(x=70, color='gray', linestyle='--', alpha=0.5,
           label='ãƒ—ãƒ­ã‚»ã‚¹å¤‰åŒ–ç‚¹')

# ã‚¢ãƒ©ãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆã‚’å¼·èª¿
if alarm.any():
    ax2.scatter(np.where(alarm)[0] + 1, T2_values[alarm],
               color='red', s=100, marker='o', zorder=5, label='ã‚¢ãƒ©ãƒ¼ãƒ ')

ax2.set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ç•ªå·', fontsize=11)
ax2.set_ylabel('TÂ²çµ±è¨ˆé‡', fontsize=11)
ax2.set_title('Hotelling\'s TÂ²ç®¡ç†å›³', fontsize=13, fontweight='bold')
ax2.legend()
ax2.grid(alpha=0.3)

# æ¸©åº¦ã®æ™‚ç³»åˆ—
ax3 = plt.subplot(2, 2, 3)
ax3.plot(range(1, n_samples + 1), data[:, 0], 'o-', color='#f59e0b',
        markersize=4, linewidth=1, label='æ¸©åº¦')
ax3.axhline(y=mean_est[0], color='blue', linestyle='-', linewidth=2,
           label=f'å¹³å‡ = {mean_est[0]:.1f}Â°C')
ax3.axvline(x=70, color='gray', linestyle='--', alpha=0.5)
ax3.set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ç•ªå·', fontsize=11)
ax3.set_ylabel('æ¸©åº¦ (Â°C)', fontsize=11)
ax3.set_title('æ¸©åº¦ã®æ™‚ç³»åˆ—', fontsize=13, fontweight='bold')
ax3.legend()
ax3.grid(alpha=0.3)

# åœ§åŠ›ã®æ™‚ç³»åˆ—
ax4 = plt.subplot(2, 2, 4)
ax4.plot(range(1, n_samples + 1), data[:, 1], 'o-', color='#7b2cbf',
        markersize=4, linewidth=1, label='åœ§åŠ›')
ax4.axhline(y=mean_est[1], color='blue', linestyle='-', linewidth=2,
           label=f'å¹³å‡ = {mean_est[1]:.1f}kPa')
ax4.axvline(x=70, color='gray', linestyle='--', alpha=0.5)
ax4.set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ç•ªå·', fontsize=11)
ax4.set_ylabel('åœ§åŠ› (kPa)', fontsize=11)
ax4.set_title('åœ§åŠ›ã®æ™‚ç³»åˆ—', fontsize=13, fontweight='bold')
ax4.legend()
ax4.grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("=== Hotelling's TÂ²ç®¡ç†å›³ åˆ†æçµæœ ===")
print(f"\nãƒ—ãƒ­ã‚»ã‚¹è¨­å®š:")
print(f"  å¤‰æ•°æ•° (p): {p}")
print(f"  ã‚µãƒ³ãƒ—ãƒ«æ•°: {n_samples}")
print(f"  æ­£å¸¸ãƒ‡ãƒ¼ã‚¿æ•°: {m}")

print(f"\nãƒ—ãƒ­ã‚»ã‚¹çµ±è¨ˆï¼ˆæ­£å¸¸ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ¨å®šï¼‰:")
print(f"  å¹³å‡ãƒ™ã‚¯ãƒˆãƒ«:")
print(f"    æ¸©åº¦: {mean_est[0]:.2f} Â°C")
print(f"    åœ§åŠ›: {mean_est[1]:.2f} kPa")
print(f"  å…±åˆ†æ•£è¡Œåˆ—:")
print(f"{cov_est}")
print(f"  ç›¸é–¢ä¿‚æ•°: {cov_est[0,1] / (np.sqrt(cov_est[0,0]) * np.sqrt(cov_est[1,1])):.3f}")

print(f"\nç®¡ç†é™ç•Œ:")
print(f"  UCL (Î±={alpha}): {UCL:.2f}")

print(f"\nTÂ²çµ±è¨ˆé‡:")
print(f"  æ­£å¸¸ãƒ‡ãƒ¼ã‚¿å¹³å‡TÂ²: {np.mean(T2_values[:70]):.2f}")
print(f"  ç•°å¸¸ãƒ‡ãƒ¼ã‚¿å¹³å‡TÂ²: {np.mean(T2_values[70:]):.2f}")

if alarm.any():
    first_alarm = np.where(alarm)[0][0]
    detection_delay = first_alarm - 70 if first_alarm >= 70 else 0
    print(f"\nâœ… ã‚¢ãƒ©ãƒ¼ãƒ æ¤œå‡º:")
    print(f"  æœ€åˆã®ã‚¢ãƒ©ãƒ¼ãƒ : ã‚µãƒ³ãƒ—ãƒ« {first_alarm + 1}")
    if first_alarm >= 70:
        print(f"  æ¤œå‡ºé…ã‚Œ: {detection_delay} ã‚µãƒ³ãƒ—ãƒ«")
    print(f"  ã‚¢ãƒ©ãƒ¼ãƒ ç·æ•°: {alarm.sum()}/{n_samples}")
else:
    print("\nâŒ ã‚¢ãƒ©ãƒ¼ãƒ : æ¤œå‡ºãªã—")
</code></pre>

<p><strong>è§£èª¬</strong>: Hotelling's TÂ²ç®¡ç†å›³ã¯ã€è¤‡æ•°ã®å¤‰æ•°ã‚’åŒæ™‚ã«ç›£è¦–ã™ã‚‹å¤šå¤‰é‡ç®¡ç†å›³ã§ã™ã€‚å¤‰æ•°é–“ã®ç›¸é–¢é–¢ä¿‚ã‚’è€ƒæ…®ã—ãªãŒã‚‰ã€å¤šæ¬¡å…ƒç©ºé–“ã§ã®ç•°å¸¸ã‚’æ¤œå‡ºã—ã¾ã™ã€‚å˜å¤‰é‡ç®¡ç†å›³ã§ã¯è¦‹é€ƒã™å¯èƒ½æ€§ã®ã‚ã‚‹ã€è¤‡æ•°å¤‰æ•°ã®çµ„ã¿åˆã‚ã›ã«ã‚ˆã‚‹ç•°å¸¸ã‚’æ¤œå‡ºã§ãã¾ã™ã€‚ãƒ—ãƒ­ã‚»ã‚¹ç”£æ¥­ã§ã¯ã€æ¸©åº¦ã€åœ§åŠ›ã€æµé‡ãªã©ã®ç›¸é–¢ã®ã‚ã‚‹å¤‰æ•°ã‚’åŒæ™‚ã«ç›£è¦–ã™ã‚‹å ´åˆã«æœ‰ç”¨ã§ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: Western Electric ãƒ«ãƒ¼ãƒ«ï¼ˆç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡ºï¼‰ã®å®Ÿè£…</h4>

<p><strong>ç›®çš„</strong>: ç®¡ç†å›³ä¸Šã®ç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡ºã™ã‚‹8ã¤ã®ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)

# ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆæ§˜ã€…ãªç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å«ã‚€ï¼‰
n_samples = 100
target_mean = 100
sigma = 3

data = np.random.normal(target_mean, sigma, n_samples)

# æ„å›³çš„ãªç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŒ¿å…¥
# ãƒ‘ã‚¿ãƒ¼ãƒ³1: ç®¡ç†é™ç•Œå¤–ï¼ˆã‚µãƒ³ãƒ—ãƒ«15ï¼‰
data[15] = target_mean + 3.5 * sigma

# ãƒ‘ã‚¿ãƒ¼ãƒ³2: é€£ç¶š9ç‚¹ãŒä¸­å¿ƒç·šã®åŒã˜å´ï¼ˆã‚µãƒ³ãƒ—ãƒ«30-38ï¼‰
data[30:39] = np.random.normal(target_mean + 0.8 * sigma, sigma * 0.5, 9)

# ãƒ‘ã‚¿ãƒ¼ãƒ³3: é€£ç¶š6ç‚¹ãŒå¢—åŠ å‚¾å‘ï¼ˆã‚µãƒ³ãƒ—ãƒ«50-55ï¼‰
data[50:56] = target_mean + np.linspace(-sigma, 2*sigma, 6)

# ãƒ‘ã‚¿ãƒ¼ãƒ³4: é€£ç¶š14ç‚¹ãŒäº¤äº’ã«ä¸Šä¸‹ï¼ˆã‚µãƒ³ãƒ—ãƒ«70-83ï¼‰
for i in range(70, 84):
    if i % 2 == 0:
        data[i] = target_mean + sigma * 0.8
    else:
        data[i] = target_mean - sigma * 0.8

# ç®¡ç†é™ç•Œã®è¨ˆç®—
UCL = target_mean + 3 * sigma
LCL = target_mean - 3 * sigma
UCL_2sigma = target_mean + 2 * sigma
LCL_2sigma = target_mean - 2 * sigma
UCL_1sigma = target_mean + 1 * sigma
LCL_1sigma = target_mean - 1 * sigma

# Western Electric ãƒ«ãƒ¼ãƒ«ã®å®Ÿè£…
def apply_western_electric_rules(data, mean, sigma):
    """
    Western Electric ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨ã—ã¦ç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º

    8ã¤ã®ãƒ«ãƒ¼ãƒ«:
    1. ç®¡ç†é™ç•Œå¤–ã®ç‚¹ï¼ˆ3Ïƒè¶…ï¼‰
    2. é€£ç¶š9ç‚¹ãŒä¸­å¿ƒç·šã®åŒã˜å´
    3. é€£ç¶š6ç‚¹ãŒå¢—åŠ ã¾ãŸã¯æ¸›å°‘å‚¾å‘
    4. é€£ç¶š14ç‚¹ãŒäº¤äº’ã«ä¸Šä¸‹
    5. é€£ç¶š3ç‚¹ã®ã†ã¡2ç‚¹ãŒ2Ïƒè¶…ï¼ˆä¸­å¿ƒç·šã®åŒã˜å´ï¼‰
    6. é€£ç¶š5ç‚¹ã®ã†ã¡4ç‚¹ãŒ1Ïƒè¶…ï¼ˆä¸­å¿ƒç·šã®åŒã˜å´ï¼‰
    7. é€£ç¶š15ç‚¹ãŒ1Ïƒä»¥å†…ï¼ˆä¸­å¿ƒç·šã®ä¸¡å´ï¼‰
    8. é€£ç¶š8ç‚¹ãŒ1Ïƒè¶…ï¼ˆä¸­å¿ƒç·šã®ä¸¡å´ï¼‰
    """
    n = len(data)
    violations = {f'Rule{i}': [] for i in range(1, 9)}

    UCL = mean + 3 * sigma
    LCL = mean - 3 * sigma

    for i in range(n):
        # Rule 1: ç®¡ç†é™ç•Œå¤–
        if data[i] > UCL or data[i] < LCL:
            violations['Rule1'].append(i)

        # Rule 2: é€£ç¶š9ç‚¹ãŒä¸­å¿ƒç·šã®åŒã˜å´
        if i >= 8:
            if all(data[i-j] > mean for j in range(9)) or \
               all(data[i-j] < mean for j in range(9)):
                violations['Rule2'].append(i)

        # Rule 3: é€£ç¶š6ç‚¹ãŒå¢—åŠ ã¾ãŸã¯æ¸›å°‘å‚¾å‘
        if i >= 5:
            if all(data[i-j] < data[i-j-1] for j in range(5)) or \
               all(data[i-j] > data[i-j-1] for j in range(5)):
                violations['Rule3'].append(i)

        # Rule 4: é€£ç¶š14ç‚¹ãŒäº¤äº’ã«ä¸Šä¸‹
        if i >= 13:
            alternating = True
            for j in range(13):
                if (data[i-j] - data[i-j-1]) * (data[i-j-1] - data[i-j-2]) >= 0:
                    alternating = False
                    break
            if alternating:
                violations['Rule4'].append(i)

        # Rule 5: é€£ç¶š3ç‚¹ã®ã†ã¡2ç‚¹ãŒ2Ïƒè¶…ï¼ˆåŒã˜å´ï¼‰
        if i >= 2:
            above_2sigma = sum(1 for j in range(3) if data[i-j] > mean + 2*sigma)
            below_2sigma = sum(1 for j in range(3) if data[i-j] < mean - 2*sigma)
            if above_2sigma >= 2 or below_2sigma >= 2:
                violations['Rule5'].append(i)

        # Rule 6: é€£ç¶š5ç‚¹ã®ã†ã¡4ç‚¹ãŒ1Ïƒè¶…ï¼ˆåŒã˜å´ï¼‰
        if i >= 4:
            above_1sigma = sum(1 for j in range(5) if data[i-j] > mean + 1*sigma)
            below_1sigma = sum(1 for j in range(5) if data[i-j] < mean - 1*sigma)
            if above_1sigma >= 4 or below_1sigma >= 4:
                violations['Rule6'].append(i)

        # Rule 7: é€£ç¶š15ç‚¹ãŒ1Ïƒä»¥å†…
        if i >= 14:
            if all(abs(data[i-j] - mean) < sigma for j in range(15)):
                violations['Rule7'].append(i)

        # Rule 8: é€£ç¶š8ç‚¹ãŒ1Ïƒè¶…ï¼ˆä¸¡å´ï¼‰
        if i >= 7:
            if all(abs(data[i-j] - mean) > sigma for j in range(8)):
                violations['Rule8'].append(i)

    return violations

# ãƒ«ãƒ¼ãƒ«ã®é©ç”¨
violations = apply_western_electric_rules(data, target_mean, sigma)

# å¯è¦–åŒ–
fig, ax = plt.subplots(figsize=(16, 8))

# ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒƒãƒˆ
ax.plot(range(n_samples), data, 'o-', color='#11998e',
        markersize=4, linewidth=1, alpha=0.6, label='æ¸¬å®šå€¤')

# ç®¡ç†é™ç•Œ
ax.axhline(y=target_mean, color='blue', linestyle='-', linewidth=2,
           label=f'ä¸­å¿ƒç·š = {target_mean}')
ax.axhline(y=UCL, color='red', linestyle='--', linewidth=2, label='Â±3Ïƒ (UCL/LCL)')
ax.axhline(y=LCL, color='red', linestyle='--', linewidth=2)
ax.axhline(y=UCL_2sigma, color='orange', linestyle='--', linewidth=1,
           alpha=0.5, label='Â±2Ïƒ')
ax.axhline(y=LCL_2sigma, color='orange', linestyle='--', linewidth=1, alpha=0.5)
ax.axhline(y=UCL_1sigma, color='green', linestyle='--', linewidth=1,
           alpha=0.5, label='Â±1Ïƒ')
ax.axhline(y=LCL_1sigma, color='green', linestyle='--', linewidth=1, alpha=0.5)

# ç•°å¸¸ãƒã‚¤ãƒ³ãƒˆã‚’è‰²åˆ†ã‘ã—ã¦å¼·èª¿
colors = ['red', 'orange', 'purple', 'brown', 'pink', 'cyan', 'magenta', 'yellow']
for idx, (rule, indices) in enumerate(violations.items()):
    if indices:
        ax.scatter(indices, data[indices], color=colors[idx], s=80,
                  marker='o', zorder=5, label=f'{rule} æ¤œå‡º')

ax.set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ç•ªå·', fontsize=12)
ax.set_ylabel('æ¸¬å®šå€¤', fontsize=12)
ax.set_title('Western Electric ãƒ«ãƒ¼ãƒ«ã«ã‚ˆã‚‹ç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º',
             fontsize=14, fontweight='bold')
ax.legend(loc='upper right', fontsize=9)
ax.grid(alpha=0.3)

plt.tight_layout()
plt.show()

# çµæœã‚µãƒãƒªãƒ¼
print("=== Western Electric ãƒ«ãƒ¼ãƒ« æ¤œå‡ºçµæœ ===\n")
total_violations = 0
for rule, indices in violations.items():
    if indices:
        print(f"{rule}: {len(indices)}å€‹ã®é•åã‚’æ¤œå‡º")
        print(f"  ä½ç½®: ã‚µãƒ³ãƒ—ãƒ« {[i+1 for i in indices]}")
        total_violations += len(indices)
    else:
        print(f"{rule}: é•åãªã—")

print(f"\nåˆè¨ˆé•åæ•°: {total_violations}")
print(f"é•åç‡: {total_violations/n_samples*100:.1f}%")

# ãƒ«ãƒ¼ãƒ«ã®èª¬æ˜
print("\nã€Western Electric ãƒ«ãƒ¼ãƒ«èª¬æ˜ã€‘")
print("Rule 1: ç®¡ç†é™ç•Œå¤–ã®ç‚¹ï¼ˆ3Ïƒè¶…ï¼‰â†’ æ¥µç«¯ãªç•°å¸¸")
print("Rule 2: é€£ç¶š9ç‚¹ãŒä¸­å¿ƒç·šã®åŒã˜å´ â†’ ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ã‚·ãƒ•ãƒˆ")
print("Rule 3: é€£ç¶š6ç‚¹ãŒå¢—åŠ /æ¸›å°‘å‚¾å‘ â†’ ãƒˆãƒ¬ãƒ³ãƒ‰")
print("Rule 4: é€£ç¶š14ç‚¹ãŒäº¤äº’ã«ä¸Šä¸‹ â†’ ã‚·ã‚¹ãƒ†ãƒãƒ†ã‚£ãƒƒã‚¯ãªå¤‰å‹•")
print("Rule 5: é€£ç¶š3ç‚¹ã®ã†ã¡2ç‚¹ãŒ2Ïƒè¶… â†’ ä¸­ç¨‹åº¦ã®ç•°å¸¸")
print("Rule 6: é€£ç¶š5ç‚¹ã®ã†ã¡4ç‚¹ãŒ1Ïƒè¶… â†’ å°ã•ãªã‚·ãƒ•ãƒˆ")
print("Rule 7: é€£ç¶š15ç‚¹ãŒ1Ïƒä»¥å†… â†’ å¤‰å‹•ä¸è¶³ï¼ˆãƒ‡ãƒ¼ã‚¿æ”¹ã–ã‚“ã®å¯èƒ½æ€§ï¼‰")
print("Rule 8: é€£ç¶š8ç‚¹ãŒ1Ïƒè¶… â†’ å¤‰å‹•éå¤šã¾ãŸã¯2ã¤ã®åˆ†å¸ƒã®æ··åœ¨")
</code></pre>

<p><strong>è§£èª¬</strong>: Western Electric ãƒ«ãƒ¼ãƒ«ï¼ˆã¾ãŸã¯ Nelson ãƒ«ãƒ¼ãƒ«ï¼‰ã¯ã€ç®¡ç†é™ç•Œå†…ã§ã‚ã£ã¦ã‚‚ç•°å¸¸ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡ºã™ã‚‹8ã¤ã®åˆ¤å®šãƒ«ãƒ¼ãƒ«ã§ã™ã€‚å˜ã«ç®¡ç†é™ç•Œã‚’è¶…ãˆã‚‹ã‹ã©ã†ã‹ã ã‘ã§ãªãã€é€£ç¶šæ€§ã€ãƒˆãƒ¬ãƒ³ãƒ‰ã€å‘¨æœŸæ€§ãªã©ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡ºã™ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚»ã‚¹ç•°å¸¸ã®æ—©æœŸç™ºè¦‹ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ«ãƒ¼ãƒ«ã¯ã€å®Ÿéš›ã®ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã§åºƒãä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚</p>
</div>

<div class="code-example">
<h4>ã‚³ãƒ¼ãƒ‰ä¾‹8: SPCçµ±åˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆã‚¢ãƒ©ãƒ¼ãƒ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼‰</h4>

<p><strong>ç›®çš„</strong>: è¤‡æ•°ã®SPCæ‰‹æ³•ã‚’çµ±åˆã—ã€ã‚¢ãƒ©ãƒ¼ãƒ ç”Ÿæˆã¨å„ªå…ˆé †ä½ä»˜ã‘ã‚’è¡Œã†å®Ÿè·µçš„ãªã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã™ã‚‹ã€‚</p>

<pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from datetime import datetime, timedelta

np.random.seed(42)

class SPCMonitoringSystem:
    """çµ±åˆSPCãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ """

    def __init__(self, target_mean, target_std, spec_limits=None):
        """
        Parameters:
        -----------
        target_mean : float
            ç›®æ¨™ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡
        target_std : float
            ç›®æ¨™ãƒ—ãƒ­ã‚»ã‚¹æ¨™æº–åå·®
        spec_limits : tuple
            è¦æ ¼é™ç•Œ (LSL, USL)
        """
        self.target_mean = target_mean
        self.target_std = target_std
        self.spec_limits = spec_limits

        # ç®¡ç†é™ç•Œ
        self.UCL = target_mean + 3 * target_std
        self.LCL = target_mean - 3 * target_std

        # ã‚¢ãƒ©ãƒ¼ãƒ ãƒ­ã‚°
        self.alarm_log = []

    def check_shewhart(self, value, sample_id):
        """ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆç®¡ç†å›³ã«ã‚ˆã‚‹æ¤œæŸ»"""
        if value > self.UCL:
            self.alarm_log.append({
                'sample_id': sample_id,
                'timestamp': datetime.now(),
                'method': 'Shewhart',
                'severity': 'HIGH',
                'message': f'å€¤ {value:.2f} ãŒ UCL {self.UCL:.2f} ã‚’è¶…é'
            })
            return False
        elif value < self.LCL:
            self.alarm_log.append({
                'sample_id': sample_id,
                'timestamp': datetime.now(),
                'method': 'Shewhart',
                'severity': 'HIGH',
                'message': f'å€¤ {value:.2f} ãŒ LCL {self.LCL:.2f} ã‚’ä¸‹å›ã‚‹'
            })
            return False
        return True

    def check_specification(self, value, sample_id):
        """è¦æ ¼é™ç•Œãƒã‚§ãƒƒã‚¯"""
        if self.spec_limits is None:
            return True

        LSL, USL = self.spec_limits
        if value > USL:
            self.alarm_log.append({
                'sample_id': sample_id,
                'timestamp': datetime.now(),
                'method': 'Specification',
                'severity': 'CRITICAL',
                'message': f'è¦æ ¼å¤–: å€¤ {value:.2f} ãŒ USL {USL} ã‚’è¶…é'
            })
            return False
        elif value < LSL:
            self.alarm_log.append({
                'sample_id': sample_id,
                'timestamp': datetime.now(),
                'method': 'Specification',
                'severity': 'CRITICAL',
                'message': f'è¦æ ¼å¤–: å€¤ {value:.2f} ãŒ LSL {LSL} ã‚’ä¸‹å›ã‚‹'
            })
            return False
        return True

    def check_trend(self, recent_data, sample_id, window=6):
        """ãƒˆãƒ¬ãƒ³ãƒ‰æ¤œå‡ºï¼ˆé€£ç¶š6ç‚¹ã®å¢—åŠ /æ¸›å°‘ï¼‰"""
        if len(recent_data) < window:
            return True

        last_window = recent_data[-window:]
        increasing = all(last_window[i] < last_window[i+1]
                        for i in range(len(last_window)-1))
        decreasing = all(last_window[i] > last_window[i+1]
                        for i in range(len(last_window)-1))

        if increasing or decreasing:
            trend_type = 'å¢—åŠ ' if increasing else 'æ¸›å°‘'
            self.alarm_log.append({
                'sample_id': sample_id,
                'timestamp': datetime.now(),
                'method': 'Trend',
                'severity': 'MEDIUM',
                'message': f'é€£ç¶š{window}ç‚¹ã®{trend_type}ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’æ¤œå‡º'
            })
            return False
        return True

    def monitor_process(self, data):
        """ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã®ç›£è¦–"""
        results = []
        recent_data = []

        for i, value in enumerate(data):
            sample_id = i + 1
            recent_data.append(value)

            # å„ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ
            shewhart_ok = self.check_shewhart(value, sample_id)
            spec_ok = self.check_specification(value, sample_id)
            trend_ok = self.check_trend(recent_data, sample_id)

            status = 'OK' if (shewhart_ok and spec_ok and trend_ok) else 'ALARM'
            results.append(status)

        return results

    def get_alarm_summary(self):
        """ã‚¢ãƒ©ãƒ¼ãƒ ã‚µãƒãƒªãƒ¼ã‚’å–å¾—"""
        if not self.alarm_log:
            return "ã‚¢ãƒ©ãƒ¼ãƒ ãªã—"

        df_alarms = pd.DataFrame(self.alarm_log)
        summary = df_alarms.groupby(['severity', 'method']).size().reset_index(name='count')
        return summary

    def generate_report(self):
        """ç›£è¦–ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ"""
        if not self.alarm_log:
            print("âœ… ãƒ—ãƒ­ã‚»ã‚¹ã¯æ­£å¸¸ã«é‹è»¢ã•ã‚Œã¦ã„ã¾ã™ã€‚ã‚¢ãƒ©ãƒ¼ãƒ ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚")
            return

        print("=" * 70)
        print("SPCç›£è¦–ã‚·ã‚¹ãƒ†ãƒ  - ã‚¢ãƒ©ãƒ¼ãƒ ãƒ¬ãƒãƒ¼ãƒˆ")
        print("=" * 70)

        # é‡è¦åº¦åˆ¥ã‚«ã‚¦ãƒ³ãƒˆ
        df_alarms = pd.DataFrame(self.alarm_log)
        severity_counts = df_alarms['severity'].value_counts()

        print(f"\nã€ã‚¢ãƒ©ãƒ¼ãƒ çµ±è¨ˆã€‘")
        print(f"ç·ã‚¢ãƒ©ãƒ¼ãƒ æ•°: {len(self.alarm_log)}")
        for severity, count in severity_counts.items():
            print(f"  {severity}: {count}ä»¶")

        # æ‰‹æ³•åˆ¥ã‚«ã‚¦ãƒ³ãƒˆ
        print(f"\nã€æ¤œå‡ºæ‰‹æ³•åˆ¥ã€‘")
        method_counts = df_alarms['method'].value_counts()
        for method, count in method_counts.items():
            print(f"  {method}: {count}ä»¶")

        # ç›´è¿‘ã®ã‚¢ãƒ©ãƒ¼ãƒ ï¼ˆæœ€å¤§5ä»¶ï¼‰
        print(f"\nã€æœ€æ–°ã‚¢ãƒ©ãƒ¼ãƒ ï¼ˆæœ€å¤§5ä»¶ï¼‰ã€‘")
        for alarm in self.alarm_log[-5:]:
            print(f"\n  ã‚µãƒ³ãƒ—ãƒ« {alarm['sample_id']} | "
                  f"{alarm['severity']} | {alarm['method']}")
            print(f"  â†’ {alarm['message']}")

        print("\n" + "=" * 70)

# ã‚·ã‚¹ãƒ†ãƒ ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
print("=== SPCçµ±åˆç›£è¦–ã‚·ã‚¹ãƒ†ãƒ  ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ ===\n")

# ãƒ—ãƒ­ã‚»ã‚¹è¨­å®š
target_mean = 50.0
target_std = 2.0
LSL, USL = 44, 56  # è¦æ ¼é™ç•Œï¼ˆÂ±3Ïƒï¼‰

# ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
spc_system = SPCMonitoringSystem(target_mean, target_std,
                                 spec_limits=(LSL, USL))

# ãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆ100ã‚µãƒ³ãƒ—ãƒ«ï¼‰
n_samples = 100
data = np.random.normal(target_mean, target_std, n_samples)

# æ„å›³çš„ãªç•°å¸¸ã‚’æŒ¿å…¥
data[30] = 58  # è¦æ ¼å¤–ï¼ˆUCLè¶…éï¼‰
data[60:66] = target_mean + np.linspace(0, 4, 6)  # ãƒˆãƒ¬ãƒ³ãƒ‰
data[80] = 42  # è¦æ ¼å¤–ï¼ˆLCLæœªæº€ï¼‰

# ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–å®Ÿè¡Œ
print("ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–ã‚’é–‹å§‹...\n")
statuses = spc_system.monitor_process(data)

# ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
spc_system.generate_report()

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 1, figsize=(16, 10))

# ãƒ—ãƒ­ã‚»ã‚¹ãƒˆãƒ¬ãƒ³ãƒ‰
alarm_samples = [i for i, s in enumerate(statuses) if s == 'ALARM']
ok_samples = [i for i, s in enumerate(statuses) if s == 'OK']

axes[0].plot(ok_samples, data[ok_samples], 'o', color='#11998e',
            markersize=5, label='æ­£å¸¸', alpha=0.6)
axes[0].plot(alarm_samples, data[alarm_samples], 'o', color='red',
            markersize=8, label='ã‚¢ãƒ©ãƒ¼ãƒ ', zorder=5)

# ç®¡ç†é™ç•Œã¨è¦æ ¼é™ç•Œ
axes[0].axhline(y=target_mean, color='blue', linestyle='-', linewidth=2,
               label='ç›®æ¨™å€¤')
axes[0].axhline(y=spc_system.UCL, color='orange', linestyle='--', linewidth=2,
               label='ç®¡ç†é™ç•Œ (UCL/LCL)')
axes[0].axhline(y=spc_system.LCL, color='orange', linestyle='--', linewidth=2)
axes[0].axhline(y=USL, color='red', linestyle='--', linewidth=2,
               label='è¦æ ¼é™ç•Œ (USL/LSL)')
axes[0].axhline(y=LSL, color='red', linestyle='--', linewidth=2)

axes[0].set_xlabel('ã‚µãƒ³ãƒ—ãƒ«ç•ªå·', fontsize=12)
axes[0].set_ylabel('æ¸¬å®šå€¤', fontsize=12)
axes[0].set_title('SPCçµ±åˆç›£è¦– - ãƒ—ãƒ­ã‚»ã‚¹ãƒˆãƒ¬ãƒ³ãƒ‰', fontsize=14, fontweight='bold')
axes[0].legend(loc='upper left')
axes[0].grid(alpha=0.3)

# ã‚¢ãƒ©ãƒ¼ãƒ åˆ†å¸ƒ
if spc_system.alarm_log:
    df_alarms = pd.DataFrame(spc_system.alarm_log)

    # é‡è¦åº¦åˆ¥ã®ã‚¢ãƒ©ãƒ¼ãƒ æ•°
    severity_order = ['CRITICAL', 'HIGH', 'MEDIUM', 'LOW']
    severity_counts = df_alarms['severity'].value_counts()
    severity_counts = severity_counts.reindex(severity_order, fill_value=0)

    colors_severity = {'CRITICAL': 'red', 'HIGH': 'orange',
                      'MEDIUM': 'yellow', 'LOW': 'green'}
    bar_colors = [colors_severity[s] for s in severity_counts.index]

    bars = axes[1].bar(severity_counts.index, severity_counts.values,
                      color=bar_colors, alpha=0.7, edgecolor='black')

    for bar in bars:
        height = bar.get_height()
        axes[1].text(bar.get_x() + bar.get_width()/2., height,
                    f'{int(height)}',
                    ha='center', va='bottom', fontsize=12, fontweight='bold')

    axes[1].set_ylabel('ã‚¢ãƒ©ãƒ¼ãƒ ä»¶æ•°', fontsize=12)
    axes[1].set_title('ã‚¢ãƒ©ãƒ¼ãƒ é‡è¦åº¦åˆ¥åˆ†å¸ƒ', fontsize=14, fontweight='bold')
    axes[1].grid(alpha=0.3, axis='y')

plt.tight_layout()
plt.show()

# ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›è©•ä¾¡
process_mean = np.mean(data)
process_std = np.std(data, ddof=1)
Cp = (USL - LSL) / (6 * process_std)
Cpk = min((USL - process_mean) / (3 * process_std),
          (process_mean - LSL) / (3 * process_std))

print(f"\nã€ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›è©•ä¾¡ã€‘")
print(f"  Cp  = {Cp:.3f}")
print(f"  Cpk = {Cpk:.3f}")
if Cpk >= 1.33:
    print("  âœ… ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›: è‰¯å¥½")
elif Cpk >= 1.0:
    print("  âš ï¸  ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›: æœ€ä½é™ï¼ˆæ”¹å–„æ¨å¥¨ï¼‰")
else:
    print("  âŒ ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›: ä¸ååˆ†ï¼ˆæ—©æ€¥ãªæ”¹å–„ãŒå¿…è¦ï¼‰")
</code></pre>

<p><strong>è§£èª¬</strong>: ã“ã®çµ±åˆSPCã‚·ã‚¹ãƒ†ãƒ ã¯ã€è¤‡æ•°ã®æ¤œå‡ºæ‰‹æ³•ï¼ˆã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆç®¡ç†å›³ã€è¦æ ¼é™ç•Œãƒã‚§ãƒƒã‚¯ã€ãƒˆãƒ¬ãƒ³ãƒ‰æ¤œå‡ºï¼‰ã‚’çµ„ã¿åˆã‚ã›ã€ã‚¢ãƒ©ãƒ¼ãƒ ã‚’é‡è¦åº¦åˆ¥ã«åˆ†é¡ãƒ»ç®¡ç†ã—ã¾ã™ã€‚å®Ÿéš›ã®ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ã“ã®ã‚ˆã†ãªçµ±åˆçš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«ã‚ˆã‚Šã€ç•°å¸¸ã®æ—©æœŸæ¤œå‡ºã¨é©åˆ‡ãªå¯¾å¿œãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚ã‚¢ãƒ©ãƒ¼ãƒ ã®å„ªå…ˆé †ä½ä»˜ã‘ï¼ˆCRITICAL > HIGH > MEDIUM > LOWï¼‰ã«ã‚ˆã‚Šã€ã‚ªãƒšãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯é‡è¦ãªç•°å¸¸ã«é›†ä¸­ã§ãã¾ã™ã€‚</p>
</div>

<hr />

<h2>2.3 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><strong>SPCã®åŸºç¤ç†è«–</strong>
    <ul>
        <li>å¶ç„¶åŸå› ã¨ç‰¹æ®ŠåŸå› ã®é•ã„</li>
        <li>ç®¡ç†å›³ã®åŸºæœ¬æ§‹é€ ï¼ˆCL, UCL, LCLï¼‰</li>
        <li>3ã‚·ã‚°ãƒç®¡ç†é™ç•Œã®çµ±è¨ˆçš„æ ¹æ‹ </li>
    </ul>
</li>
<li><strong>ã‚·ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆç®¡ç†å›³</strong>
    <ul>
        <li>XÌ„-Rç®¡ç†å›³ï¼šã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†</li>
        <li>I-MRç®¡ç†å›³ï¼šå€‹åˆ¥æ¸¬å®šå€¤ã®ç®¡ç†</li>
        <li>ç®¡ç†å›³ã®ä½œæˆæ‰‹é †ã¨è§£é‡ˆ</li>
    </ul>
</li>
<li><strong>ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›è©•ä¾¡</strong>
    <ul>
        <li>Cpï¼šãƒ—ãƒ­ã‚»ã‚¹å¤‰å‹•ã®è©•ä¾¡</li>
        <li>Cpkï¼šãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ãšã‚Œã‚’è€ƒæ…®ã—ãŸè©•ä¾¡</li>
        <li>Cpmï¼šç›®æ¨™å€¤ã‹ã‚‰ã®ãšã‚Œã‚’è€ƒæ…®ã—ãŸè©•ä¾¡</li>
        <li>èƒ½åŠ›æŒ‡æ•°ã®åˆ¤å®šåŸºæº–ï¼ˆ1.33, 1.67ï¼‰</li>
    </ul>
</li>
<li><strong>é«˜åº¦ãªSPCæ‰‹æ³•</strong>
    <ul>
        <li>CUSUMï¼šå°ã•ãªã‚·ãƒ•ãƒˆã®æ—©æœŸæ¤œå‡º</li>
        <li>EWMAï¼šæ™‚ç³»åˆ—é‡ã¿ä»˜ã‘ã«ã‚ˆã‚‹ç›£è¦–</li>
        <li>Hotelling's TÂ²ï¼šå¤šå¤‰é‡ãƒ—ãƒ­ã‚»ã‚¹ã®ç›£è¦–</li>
    </ul>
</li>
<li><strong>ç•°å¸¸ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º</strong>
    <ul>
        <li>Western Electric ãƒ«ãƒ¼ãƒ«ï¼ˆ8ã¤ã®åˆ¤å®šãƒ«ãƒ¼ãƒ«ï¼‰</li>
        <li>ãƒˆãƒ¬ãƒ³ãƒ‰ã€å‘¨æœŸæ€§ã€å¤‰å‹•ã®ç•°å¸¸æ¤œå‡º</li>
        <li>çµ±åˆçš„ãªã‚¢ãƒ©ãƒ¼ãƒ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </li>
    </ul>
</li>
</ol>

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

<ul>
<li><strong>ç®¡ç†å›³ã®é¸æŠ</strong>: ãƒ‡ãƒ¼ã‚¿ã®ç‰¹æ€§ï¼ˆã‚µãƒ–ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã®å¯å¦ã€å¤‰æ•°ã®æ•°ï¼‰ã«å¿œã˜ã¦é©åˆ‡ãªç®¡ç†å›³ã‚’é¸æŠ</li>
<li><strong>ãƒ—ãƒ­ã‚»ã‚¹èƒ½åŠ›</strong>: Cpã¨Cpkã®é•ã„ã‚’ç†è§£ã—ã€ãƒ—ãƒ­ã‚»ã‚¹å¹³å‡ã®ãšã‚Œã‚‚è€ƒæ…®ã—ãŸè©•ä¾¡ãŒé‡è¦</li>
<li><strong>æ„Ÿåº¦ã¨èª¤å ±</strong>: CUSUM/EWMAã¯å°ã•ãªã‚·ãƒ•ãƒˆã«æ•æ„Ÿã ãŒã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®šã«ã‚ˆã‚Šèª¤å ±ç‡ã‚‚å¤‰åŒ–</li>
<li><strong>å¤šå¤‰é‡ç›£è¦–</strong>: ç›¸é–¢ã®ã‚ã‚‹å¤‰æ•°ã¯ã€Hotelling's TÂ²ã§åŒæ™‚ç›£è¦–ã™ã‚‹ã“ã¨ã§æ¤œå‡ºåŠ›å‘ä¸Š</li>
<li><strong>çµ±åˆçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</strong>: è¤‡æ•°ã®æ‰‹æ³•ã‚’çµ„ã¿åˆã‚ã›ã€é‡è¦åº¦åˆ¥ã«ã‚¢ãƒ©ãƒ¼ãƒ ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ãŒå®Ÿè·µçš„</li>
</ul>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬3ç« ã§ã¯ã€<strong>ç•°å¸¸æ¤œçŸ¥ã¨ãƒ—ãƒ­ã‚»ã‚¹ç›£è¦–</strong>ã‚’å­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ç•°å¸¸æ¤œçŸ¥ï¼ˆé–¾å€¤ãƒ™ãƒ¼ã‚¹ï¼‰</li>
<li>çµ±è¨ˆçš„ç•°å¸¸æ¤œçŸ¥ï¼ˆZ-score, ä¿®æ­£Z-scoreï¼‰</li>
<li>æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹ç•°å¸¸æ¤œçŸ¥ï¼ˆIsolation Forest, One-Class SVMï¼‰</li>
<li>æ™‚ç³»åˆ—ç•°å¸¸æ¤œçŸ¥ï¼ˆLSTM Autoencoderï¼‰</li>
<li>ã‚¢ãƒ©ãƒ¼ãƒ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®è¨­è¨ˆã¨èª¤å ±å‰Šæ¸›</li>
</ul>

<div class="navigation">
    <a href="chapter-1.html" class="nav-button">â† å‰ã®ç« </a>
    <a href="chapter-3.html" class="nav-button">æ¬¡ã®ç«  â†’</a>
</div>

    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: PI Knowledge Hub - Dr. Yusuke Hashimoto, Tohoku University</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-25</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 PI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
