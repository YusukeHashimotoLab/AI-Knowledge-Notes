<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬1ç« ï¼šãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åŸºç¤ - ãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å…¥é–€ã‚·ãƒªãƒ¼ã‚º">
    <title>ç¬¬1ç« ï¼šãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åŸºç¤ - ãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å…¥é–€ | PI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #11998e;
            --color-accent-light: #38ef7d;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #11998e;
            --color-link-hover: #0d7a6f;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬1ç« ï¼šãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åŸºç¤</h1>
            <p class="subtitle">Sequential Modular vs Equation-Oriented ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã¨ç†±åŠ›å­¦è¨ˆç®—</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 30-35åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">

<div class="learning-objectives">
<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… Sequential Modularã¨Equation-Orientedã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®é•ã„ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… ç†±åŠ›å­¦ãƒ¢ãƒ‡ãƒ«ï¼ˆç†æƒ³æ°—ä½“ã€SRKã€Peng-Robinsonï¼‰ã‚’å®Ÿè£…ã§ãã‚‹</li>
<li>âœ… ã‚¹ãƒˆãƒªãƒ¼ãƒ ç‰©æ€§ï¼ˆã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã€å¯†åº¦ï¼‰ã‚’è¨ˆç®—ã§ãã‚‹</li>
<li>âœ… ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ï¼ˆæ°—æ¶²å¹³è¡¡ï¼‰ã‚’å®Ÿè£…ã§ãã‚‹</li>
<li>âœ… åæŸè¨ˆç®—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆé€æ¬¡ä»£å…¥æ³•ã€Newton-Raphsonæ³•ï¼‰ã‚’ç†è§£ã™ã‚‹</li>
<li>âœ… Tear Streamã®é¸æŠã¨ãƒ—ãƒ­ã‚»ã‚¹ãƒ•ãƒ­ãƒ¼ã®é †åºæ±ºå®šãŒã§ãã‚‹</li>
</ul>
</div>

<hr />

<h2>1.1 ãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¦‚è¦</h2>

<h3>ãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã¯</h3>

<p><strong>ãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</strong>ã¨ã¯ã€åŒ–å­¦ãƒ—ãƒ­ã‚»ã‚¹ã®æŒ™å‹•ã‚’æ•°å­¦ãƒ¢ãƒ‡ãƒ«ã§è¡¨ç¾ã—ã€ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã§å†ç¾ã™ã‚‹ã“ã¨ã§ã™ã€‚ç‰©è³ªåæ”¯ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼åæ”¯ã€æ°—æ¶²å¹³è¡¡ã€åå¿œé€Ÿåº¦å¼ãªã©ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚»ã‚¹ã®æ€§èƒ½ã‚’äºˆæ¸¬ã—ã¾ã™ã€‚</p>

<h3>ä¸»è¦ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</h3>

<table>
<thead>
<tr>
<th>ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</th>
<th>ç‰¹å¾´</th>
<th>é•·æ‰€</th>
<th>çŸ­æ‰€</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Sequential Modular</strong></td>
<td>ãƒ¦ãƒ‹ãƒƒãƒˆæ“ä½œã‚’é †ç•ªã«è¨ˆç®—</td>
<td>ç›´æ„Ÿçš„ã€ãƒ‡ãƒãƒƒã‚°å®¹æ˜“</td>
<td>ãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ«ãƒ¼ãƒ—ã§åæŸè¨ˆç®—å¿…è¦</td>
</tr>
<tr>
<td><strong>Equation-Oriented</strong></td>
<td>å…¨æ–¹ç¨‹å¼ã‚’åŒæ™‚ã«è§£ã</td>
<td>åæŸãŒé€Ÿã„ã€æœ€é©åŒ–å®¹æ˜“</td>
<td>ãƒ¤ã‚³ãƒ“è¡Œåˆ—ã®æ§‹ç¯‰ãŒè¤‡é›‘</td>
</tr>
</tbody>
</table>

<hr />

<h2>1.2 Sequential Modular ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®å®Ÿè£…</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: Sequential Modularæ³•ã®åŸºæœ¬å®Ÿè£…</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Sequential Modularæ³•ã®ãƒ‡ãƒ¢: 3ã¤ã®ãƒ¦ãƒ‹ãƒƒãƒˆæ“ä½œã‚’é †ç•ªã«è¨ˆç®—

class Stream:
    """ãƒ—ãƒ­ã‚»ã‚¹ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚¯ãƒ©ã‚¹"""
    def __init__(self, name, T=298.15, P=101325, flow_rate=100.0, composition=None):
        """
        Parameters:
        name : str, ã‚¹ãƒˆãƒªãƒ¼ãƒ å
        T : float, æ¸©åº¦ [K]
        P : float, åœ§åŠ› [Pa]
        flow_rate : float, ãƒ¢ãƒ«æµé‡ [mol/s]
        composition : dict, çµ„æˆ {æˆåˆ†å: ãƒ¢ãƒ«åˆ†ç‡}
        """
        self.name = name
        self.T = T
        self.P = P
        self.flow_rate = flow_rate
        self.composition = composition if composition else {'A': 1.0}

    def copy(self):
        """ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®ã‚³ãƒ”ãƒ¼ã‚’ä½œæˆ"""
        return Stream(self.name, self.T, self.P, self.flow_rate,
                     self.composition.copy())

    def __repr__(self):
        return (f"Stream(name={self.name}, T={self.T:.2f}K, "
                f"P={self.P/1000:.1f}kPa, F={self.flow_rate:.2f}mol/s)")


class Heater:
    """åŠ ç†±å™¨ãƒ¦ãƒ‹ãƒƒãƒˆ"""
    def __init__(self, name, delta_T=50.0):
        self.name = name
        self.delta_T = delta_T  # æ¸©åº¦ä¸Šæ˜‡ [K]

    def calculate(self, inlet_stream):
        """
        åŠ ç†±å™¨è¨ˆç®—

        Parameters:
        inlet_stream : Stream, å…¥å£ã‚¹ãƒˆãƒªãƒ¼ãƒ 

        Returns:
        outlet_stream : Stream, å‡ºå£ã‚¹ãƒˆãƒªãƒ¼ãƒ 
        """
        outlet = inlet_stream.copy()
        outlet.name = f"{self.name}_out"
        outlet.T = inlet_stream.T + self.delta_T

        print(f"{self.name}: æ¸©åº¦ {inlet_stream.T:.2f}K â†’ {outlet.T:.2f}K")
        return outlet


class Reactor:
    """åå¿œå™¨ãƒ¦ãƒ‹ãƒƒãƒˆï¼ˆç°¡æ˜“ãƒ¢ãƒ‡ãƒ«ï¼‰"""
    def __init__(self, name, conversion=0.8):
        self.name = name
        self.conversion = conversion  # è»¢åŒ–ç‡

    def calculate(self, inlet_stream):
        """
        åå¿œå™¨è¨ˆç®—: A â†’ B (å˜ç´”åå¿œ)

        Parameters:
        inlet_stream : Stream

        Returns:
        outlet_stream : Stream
        """
        outlet = inlet_stream.copy()
        outlet.name = f"{self.name}_out"

        # åå¿œ: A â†’ B
        if 'A' in inlet_stream.composition:
            x_A = inlet_stream.composition['A']
            converted = x_A * self.conversion

            outlet.composition = {
                'A': x_A - converted,
                'B': converted
            }

            print(f"{self.name}: è»¢åŒ–ç‡ {self.conversion*100:.1f}%, "
                  f"A: {x_A:.3f} â†’ {outlet.composition['A']:.3f}, "
                  f"B: 0 â†’ {outlet.composition['B']:.3f}")

        return outlet


class Cooler:
    """å†·å´å™¨ãƒ¦ãƒ‹ãƒƒãƒˆ"""
    def __init__(self, name, T_target=320.0):
        self.name = name
        self.T_target = T_target  # ç›®æ¨™æ¸©åº¦ [K]

    def calculate(self, inlet_stream):
        """
        å†·å´å™¨è¨ˆç®—

        Parameters:
        inlet_stream : Stream

        Returns:
        outlet_stream : Stream
        """
        outlet = inlet_stream.copy()
        outlet.name = f"{self.name}_out"
        outlet.T = self.T_target

        print(f"{self.name}: æ¸©åº¦ {inlet_stream.T:.2f}K â†’ {outlet.T:.2f}K")
        return outlet


# Sequential Modularæ³•ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚»ã‚¹è¨ˆç®—
def run_sequential_modular():
    """
    Sequential Modularæ³•ã§ãƒ—ãƒ­ã‚»ã‚¹ã‚’è¨ˆç®—

    ãƒ—ãƒ­ã‚»ã‚¹ãƒ•ãƒ­ãƒ¼: Feed â†’ Heater â†’ Reactor â†’ Cooler â†’ Product
    """
    print("="*60)
    print("Sequential Modularæ³•ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚»ã‚¹è¨ˆç®—")
    print("="*60)

    # å…¥å£ã‚¹ãƒˆãƒªãƒ¼ãƒ 
    feed = Stream(name="Feed", T=298.15, P=101325, flow_rate=100.0,
                  composition={'A': 1.0})
    print(f"\nå…¥å£: {feed}")

    # ãƒ¦ãƒ‹ãƒƒãƒˆæ“ä½œã®å®šç¾©
    heater = Heater(name="H-101", delta_T=80.0)
    reactor = Reactor(name="R-101", conversion=0.85)
    cooler = Cooler(name="C-101", T_target=320.0)

    # é †ç•ªã«è¨ˆç®—ï¼ˆSequential Modularï¼‰
    print("\n--- ãƒ¦ãƒ‹ãƒƒãƒˆæ“ä½œè¨ˆç®— ---")
    s1 = heater.calculate(feed)
    s2 = reactor.calculate(s1)
    product = cooler.calculate(s2)

    print(f"\nå‡ºå£: {product}")
    print(f"æœ€çµ‚çµ„æˆ: A={product.composition.get('A', 0):.3f}, "
          f"B={product.composition.get('B', 0):.3f}")

    # çµæœã®å¯è¦–åŒ–
    streams = [feed, s1, s2, product]
    stream_names = ['Feed', 'Heaterå‡ºå£', 'Reactorå‡ºå£', 'Product']
    temperatures = [s.T for s in streams]

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
    ax1.plot(stream_names, temperatures, marker='o', linewidth=2.5,
             markersize=10, color='#11998e')
    ax1.set_ylabel('æ¸©åº¦ [K]', fontsize=12)
    ax1.set_title('Sequential Modularæ³•: æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«',
                  fontsize=13, fontweight='bold')
    ax1.grid(alpha=0.3)
    plt.setp(ax1.xaxis.get_majorticklabels(), rotation=15, ha='right')

    # çµ„æˆå¤‰åŒ–
    x_A = [s.composition.get('A', 0) for s in streams]
    x_B = [s.composition.get('B', 0) for s in streams]

    ax2.plot(stream_names, x_A, marker='s', linewidth=2.5,
             markersize=10, label='æˆåˆ†A', color='#e74c3c')
    ax2.plot(stream_names, x_B, marker='^', linewidth=2.5,
             markersize=10, label='æˆåˆ†B', color='#3498db')
    ax2.set_ylabel('ãƒ¢ãƒ«åˆ†ç‡', fontsize=12)
    ax2.set_title('Sequential Modularæ³•: çµ„æˆå¤‰åŒ–',
                  fontsize=13, fontweight='bold')
    ax2.legend(fontsize=11)
    ax2.grid(alpha=0.3)
    plt.setp(ax2.xaxis.get_majorticklabels(), rotation=15, ha='right')

    plt.tight_layout()
    plt.show()


# å®Ÿè¡Œ
run_sequential_modular()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
Sequential Modularæ³•ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚»ã‚¹è¨ˆç®—
============================================================

å…¥å£: Stream(name=Feed, T=298.15K, P=101.3kPa, F=100.00mol/s)

--- ãƒ¦ãƒ‹ãƒƒãƒˆæ“ä½œè¨ˆç®— ---
H-101: æ¸©åº¦ 298.15K â†’ 378.15K
R-101: è»¢åŒ–ç‡ 85.0%, A: 1.000 â†’ 0.150, B: 0 â†’ 0.850
C-101: æ¸©åº¦ 378.15K â†’ 320.00K

å‡ºå£: Stream(name=C-101_out, T=320.00K, P=101.3kPa, F=100.00mol/s)
æœ€çµ‚çµ„æˆ: A=0.150, B=0.850
</code></pre>

<p><strong>è§£èª¬:</strong> Sequential Modularæ³•ã§ã¯ã€å„ãƒ¦ãƒ‹ãƒƒãƒˆæ“ä½œã‚’é †ç•ªã«è¨ˆç®—ã—ã¾ã™ã€‚ã“ã®æ–¹æ³•ã¯ç›´æ„Ÿçš„ã§å®Ÿè£…ãŒå®¹æ˜“ã§ã™ãŒã€ãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ«ãƒ¼ãƒ—ãŒã‚ã‚‹å ´åˆã¯åæŸè¨ˆç®—ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: Equation-Oriented ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®åŸºæœ¬</h3>

<pre><code class="language-python">import numpy as np
from scipy.optimize import fsolve

# Equation-Orientedæ³•ã®ãƒ‡ãƒ¢: å…¨æ–¹ç¨‹å¼ã‚’åŒæ™‚ã«è§£ã

def equation_oriented_process(x):
    """
    ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã®æ–¹ç¨‹å¼ç³»

    å¤‰æ•°é †åº: [T1, T2, T3, T4, x_A2, x_B2, x_A3, x_B3]
    - T1: Feedæ¸©åº¦ (å›ºå®š)
    - T2: Heaterå‡ºå£æ¸©åº¦
    - T3: Reactorå‡ºå£æ¸©åº¦
    - T4: Coolerå‡ºå£æ¸©åº¦
    - x_A2, x_B2: Heaterå‡ºå£çµ„æˆ
    - x_A3, x_B3: Reactorå‡ºå£çµ„æˆ

    Parameters:
    x : array, å¤‰æ•°ãƒ™ã‚¯ãƒˆãƒ« [8è¦ç´ ]

    Returns:
    residuals : array, æ®‹å·®ãƒ™ã‚¯ãƒˆãƒ«
    """
    T1, T2, T3, T4, x_A2, x_B2, x_A3, x_B3 = x

    # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    T_feed = 298.15  # K
    delta_T_heater = 80.0  # K
    conversion = 0.85
    T_cooler = 320.0  # K
    x_A1 = 1.0  # å…¥å£çµ„æˆ
    x_B1 = 0.0

    # æ–¹ç¨‹å¼ï¼ˆresiduals = 0 ã¨ãªã‚‹ã¹ãï¼‰
    residuals = np.zeros(8)

    # Heateræ–¹ç¨‹å¼
    residuals[0] = T2 - (T1 + delta_T_heater)  # ã‚¨ãƒãƒ«ã‚®ãƒ¼åæ”¯
    residuals[1] = x_A2 - x_A1  # ç‰©è³ªåæ”¯ï¼ˆAï¼‰
    residuals[2] = x_B2 - x_B1  # ç‰©è³ªåæ”¯ï¼ˆBï¼‰

    # Reactoræ–¹ç¨‹å¼
    residuals[3] = T3 - T2  # æ¸©åº¦å¤‰åŒ–ãªã—ï¼ˆç­‰æ¸©åå¿œå™¨ï¼‰
    residuals[4] = x_A3 - (x_A2 * (1 - conversion))  # åå¿œå¾Œã®A
    residuals[5] = x_B3 - (x_B2 + x_A2 * conversion)  # åå¿œå¾Œã®B

    # Cooleræ–¹ç¨‹å¼
    residuals[6] = T4 - T_cooler  # ç›®æ¨™æ¸©åº¦

    # çµ„æˆç·å’Œåˆ¶ç´„
    residuals[7] = (x_A3 + x_B3) - 1.0

    return residuals


# åˆæœŸæ¨å®šå€¤
x0 = np.array([
    298.15,  # T1
    350.0,   # T2
    350.0,   # T3
    320.0,   # T4
    1.0,     # x_A2
    0.0,     # x_B2
    0.2,     # x_A3
    0.8      # x_B3
])

print("="*60)
print("Equation-Orientedæ³•ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚»ã‚¹è¨ˆç®—")
print("="*60)
print(f"\nåˆæœŸæ¨å®šå€¤:")
print(f"  T = {x0[:4]}")
print(f"  çµ„æˆ = {x0[4:]}")

# æ–¹ç¨‹å¼ã‚’åŒæ™‚ã«è§£ã
solution = fsolve(equation_oriented_process, x0)

T1, T2, T3, T4, x_A2, x_B2, x_A3, x_B3 = solution

print(f"\nè§£:")
print(f"  Feedæ¸©åº¦: T1 = {T1:.2f} K")
print(f"  Heaterå‡ºå£: T2 = {T2:.2f} K, A={x_A2:.3f}, B={x_B2:.3f}")
print(f"  Reactorå‡ºå£: T3 = {T3:.2f} K, A={x_A3:.3f}, B={x_B3:.3f}")
print(f"  Productæ¸©åº¦: T4 = {T4:.2f} K")

# æ®‹å·®ç¢ºèª
residuals = equation_oriented_process(solution)
print(f"\næ®‹å·®ãƒãƒ«ãƒ : {np.linalg.norm(residuals):.2e}")
print(f"  (åæŸåˆ¤å®š: < 1e-6 ã§æˆåŠŸ)")

# æ¯”è¼ƒãƒ—ãƒ­ãƒƒãƒˆ
fig, ax = plt.subplots(figsize=(10, 6))

methods = ['Sequential\nModular', 'Equation-\nOriented']
T_seq = [298.15, 378.15, 378.15, 320.0]
T_eq = [T1, T2, T3, T4]

x_pos = np.arange(4)
width = 0.35

ax.bar(x_pos - width/2, T_seq, width, label='Sequential Modular',
       color='#11998e', alpha=0.8)
ax.bar(x_pos + width/2, T_eq, width, label='Equation-Oriented',
       color='#e74c3c', alpha=0.8)

ax.set_ylabel('æ¸©åº¦ [K]', fontsize=12)
ax.set_title('Sequential Modular vs Equation-Oriented: æ¸©åº¦æ¯”è¼ƒ',
             fontsize=13, fontweight='bold')
ax.set_xticks(x_pos)
ax.set_xticklabels(['Feed', 'Heaterå‡ºå£', 'Reactorå‡ºå£', 'Product'])
ax.legend(fontsize=11)
ax.grid(alpha=0.3, axis='y')

plt.tight_layout()
plt.show()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
Equation-Orientedæ³•ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚»ã‚¹è¨ˆç®—
============================================================

åˆæœŸæ¨å®šå€¤:
  T = [298.15 350.   350.   320.  ]
  çµ„æˆ = [1.  0.  0.2 0.8]

è§£:
  Feedæ¸©åº¦: T1 = 298.15 K
  Heaterå‡ºå£: T2 = 378.15 K, A=1.000, B=0.000
  Reactorå‡ºå£: T3 = 378.15 K, A=0.150, B=0.850
  Productæ¸©åº¦: T4 = 320.00 K

æ®‹å·®ãƒãƒ«ãƒ : 2.47e-13
  (åæŸåˆ¤å®š: < 1e-6 ã§æˆåŠŸ)
</code></pre>

<p><strong>è§£èª¬:</strong> Equation-Orientedæ³•ã§ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹å…¨ä½“ã®æ–¹ç¨‹å¼ã‚’åŒæ™‚ã«è§£ãã¾ã™ã€‚åæŸãŒé€Ÿãã€æœ€é©åŒ–ã¨ã®çµ±åˆã‚‚å®¹æ˜“ã§ã™ãŒã€ãƒ¤ã‚³ãƒ“è¡Œåˆ—ã®è¨ˆç®—ãŒå¿…è¦ã«ãªã‚‹ãŸã‚å®Ÿè£…ã¯è¤‡é›‘ã§ã™ã€‚</p>

<hr />

<h2>1.3 ç†±åŠ›å­¦ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…

class IdealGas:
    """ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«"""

    R = 8.314  # æ°—ä½“å®šæ•° [J/(molÂ·K)]

    @staticmethod
    def pressure(n, V, T):
        """
        ç†æƒ³æ°—ä½“ã®çŠ¶æ…‹æ–¹ç¨‹å¼: PV = nRT

        Parameters:
        n : float, ãƒ¢ãƒ«æ•° [mol]
        V : float, ä½“ç© [mÂ³]
        T : float, æ¸©åº¦ [K]

        Returns:
        P : float, åœ§åŠ› [Pa]
        """
        return n * IdealGas.R * T / V

    @staticmethod
    def volume(n, P, T):
        """
        ä½“ç©è¨ˆç®—

        Parameters:
        n : float, ãƒ¢ãƒ«æ•° [mol]
        P : float, åœ§åŠ› [Pa]
        T : float, æ¸©åº¦ [K]

        Returns:
        V : float, ä½“ç© [mÂ³]
        """
        return n * IdealGas.R * T / P

    @staticmethod
    def density(P, T, MW):
        """
        å¯†åº¦è¨ˆç®—: Ï = PM/(RT)

        Parameters:
        P : float, åœ§åŠ› [Pa]
        T : float, æ¸©åº¦ [K]
        MW : float, åˆ†å­é‡ [g/mol]

        Returns:
        rho : float, å¯†åº¦ [kg/mÂ³]
        """
        return (P * MW / 1000) / (IdealGas.R * T)

    @staticmethod
    def enthalpy(T, Cp, T_ref=298.15, H_ref=0.0):
        """
        ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼è¨ˆç®—ï¼ˆå®šåœ§æ¯”ç†±ä¸€å®šã¨ä»®å®šï¼‰
        H(T) = H_ref + Cp * (T - T_ref)

        Parameters:
        T : float, æ¸©åº¦ [K]
        Cp : float, å®šåœ§æ¯”ç†± [J/(molÂ·K)]
        T_ref : float, åŸºæº–æ¸©åº¦ [K]
        H_ref : float, åŸºæº–ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ [J/mol]

        Returns:
        H : float, ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ [J/mol]
        """
        return H_ref + Cp * (T - T_ref)

    @staticmethod
    def entropy(T, P, Cp, T_ref=298.15, P_ref=101325, S_ref=0.0):
        """
        ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼è¨ˆç®—
        S(T, P) = S_ref + Cp*ln(T/T_ref) - R*ln(P/P_ref)

        Parameters:
        T : float, æ¸©åº¦ [K]
        P : float, åœ§åŠ› [Pa]
        Cp : float, å®šåœ§æ¯”ç†± [J/(molÂ·K)]
        T_ref : float, åŸºæº–æ¸©åº¦ [K]
        P_ref : float, åŸºæº–åœ§åŠ› [Pa]
        S_ref : float, åŸºæº–ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ [J/(molÂ·K)]

        Returns:
        S : float, ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ [J/(molÂ·K)]
        """
        return (S_ref + Cp * np.log(T / T_ref) -
                IdealGas.R * np.log(P / P_ref))


# ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«ã®æ¤œè¨¼
def demonstrate_ideal_gas():
    """ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""

    print("="*60)
    print("ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«ã®ç‰©æ€§è¨ˆç®—")
    print("="*60)

    # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    n = 1.0  # mol
    T = 350.0  # K
    P = 200000  # Pa (2 bar)
    MW = 28.0  # g/mol (N2)
    Cp = 29.1  # J/(molÂ·K)

    # è¨ˆç®—
    V = IdealGas.volume(n, P, T)
    rho = IdealGas.density(P, T, MW)
    H = IdealGas.enthalpy(T, Cp)
    S = IdealGas.entropy(T, P, Cp)

    print(f"\næ¡ä»¶:")
    print(f"  æ¸©åº¦: T = {T} K")
    print(f"  åœ§åŠ›: P = {P/1000:.1f} kPa")
    print(f"  ãƒ¢ãƒ«æ•°: n = {n} mol")
    print(f"  åˆ†å­é‡: MW = {MW} g/mol")

    print(f"\nè¨ˆç®—çµæœ:")
    print(f"  ä½“ç©: V = {V:.6f} mÂ³ = {V*1000:.3f} L")
    print(f"  å¯†åº¦: Ï = {rho:.3f} kg/mÂ³")
    print(f"  ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼: H = {H:.2f} J/mol")
    print(f"  ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: S = {S:.2f} J/(molÂ·K)")

    # åœ§ç¸®ç‡å› å­ã®å¯è¦–åŒ–ï¼ˆç†æƒ³æ°—ä½“ã§ã¯ Z=1ï¼‰
    P_range = np.linspace(50000, 500000, 100)
    T_range = [300, 350, 400, 450]

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # P-Vå›³
    colors = ['#e74c3c', '#3498db', '#2ecc71', '#f39c12']
    for i, T_val in enumerate(T_range):
        V_range = [IdealGas.volume(n, P, T_val) * 1000 for P in P_range]
        ax1.plot(V_range, P_range/1000, linewidth=2.5,
                label=f'T = {T_val} K', color=colors[i])

    ax1.set_xlabel('ä½“ç© V [L]', fontsize=12)
    ax1.set_ylabel('åœ§åŠ› P [kPa]', fontsize=12)
    ax1.set_title('ç†æƒ³æ°—ä½“ã®P-Vå›³ï¼ˆç­‰æ¸©ç·šï¼‰', fontsize=13, fontweight='bold')
    ax1.legend(fontsize=10)
    ax1.grid(alpha=0.3)

    # å¯†åº¦vsåœ§åŠ›
    for i, T_val in enumerate(T_range):
        rho_range = [IdealGas.density(P, T_val, MW) for P in P_range]
        ax2.plot(P_range/1000, rho_range, linewidth=2.5,
                label=f'T = {T_val} K', color=colors[i])

    ax2.set_xlabel('åœ§åŠ› P [kPa]', fontsize=12)
    ax2.set_ylabel('å¯†åº¦ Ï [kg/mÂ³]', fontsize=12)
    ax2.set_title('ç†æƒ³æ°—ä½“ã®å¯†åº¦-åœ§åŠ›é–¢ä¿‚', fontsize=13, fontweight='bold')
    ax2.legend(fontsize=10)
    ax2.grid(alpha=0.3)

    plt.tight_layout()
    plt.show()


# å®Ÿè¡Œ
demonstrate_ideal_gas()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«ã®ç‰©æ€§è¨ˆç®—
============================================================

æ¡ä»¶:
  æ¸©åº¦: T = 350.0 K
  åœ§åŠ›: P = 200.0 kPa
  ãƒ¢ãƒ«æ•°: n = 1 mol
  åˆ†å­é‡: MW = 28 g/mol

è¨ˆç®—çµæœ:
  ä½“ç©: V = 0.014550 mÂ³ = 14.550 L
  å¯†åº¦: Ï = 1.924 kg/mÂ³
  ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼: H = 1511.85 J/mol
  ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: S = 3.28 J/(molÂ·K)
</code></pre>

<p><strong>è§£èª¬:</strong> ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«ã¯ã€ä½åœ§ãƒ»é«˜æ¸©ã®æ°—ä½“ã«é©ç”¨ã§ãã¾ã™ã€‚è¨ˆç®—ãŒç°¡å˜ã§é«˜é€Ÿã§ã™ãŒã€é«˜åœ§ã‚„æ¶²ç›¸ã«ã¯ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: Soave-Redlich-Kwong (SRK) çŠ¶æ…‹æ–¹ç¨‹å¼</h3>

<pre><code class="language-python">import numpy as np
from scipy.optimize import fsolve

# SRKçŠ¶æ…‹æ–¹ç¨‹å¼ã®å®Ÿè£…

class SRK:
    """Soave-Redlich-Kwong (SRK) çŠ¶æ…‹æ–¹ç¨‹å¼"""

    R = 8.314  # J/(molÂ·K)

    def __init__(self, Tc, Pc, omega):
        """
        Parameters:
        Tc : float, è‡¨ç•Œæ¸©åº¦ [K]
        Pc : float, è‡¨ç•Œåœ§åŠ› [Pa]
        omega : float, åå¿ƒå› å­ [-]
        """
        self.Tc = Tc
        self.Pc = Pc
        self.omega = omega

        # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨ˆç®—
        self.a_c = 0.42748 * (self.R * Tc)**2 / Pc
        self.b = 0.08664 * self.R * Tc / Pc

    def alpha(self, T):
        """
        æ¸©åº¦ä¾å­˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î±(T)

        Parameters:
        T : float, æ¸©åº¦ [K]

        Returns:
        alpha : float
        """
        Tr = T / self.Tc
        m = 0.480 + 1.574 * self.omega - 0.176 * self.omega**2
        return (1 + m * (1 - np.sqrt(Tr)))**2

    def a(self, T):
        """
        å¼•åŠ›é …ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ a(T)

        Parameters:
        T : float, æ¸©åº¦ [K]

        Returns:
        a : float
        """
        return self.a_c * self.alpha(T)

    def Z_from_PR(self, P, T, phase='vapor'):
        """
        åœ§ç¸®ç‡å› å­Zã®è¨ˆç®—

        SRKæ–¹ç¨‹å¼: P = RT/(V-b) - a/(V(V+b))
        ZÂ³ - ZÂ² + (A - B - BÂ²)Z - AB = 0

        Parameters:
        P : float, åœ§åŠ› [Pa]
        T : float, æ¸©åº¦ [K]
        phase : str, 'vapor' or 'liquid'

        Returns:
        Z : float, åœ§ç¸®ç‡å› å­
        """
        A = self.a(T) * P / (self.R * T)**2
        B = self.b * P / (self.R * T)

        # 3æ¬¡æ–¹ç¨‹å¼ã®ä¿‚æ•°
        coeffs = [1, -1, A - B - B**2, -A*B]
        roots = np.roots(coeffs)

        # å®Ÿæ ¹ã®ã¿æŠ½å‡º
        real_roots = roots[np.isreal(roots)].real

        if len(real_roots) == 0:
            return None

        # phaseã«å¿œã˜ã¦æœ€å¤§/æœ€å°å€¤ã‚’é¸æŠ
        if phase == 'vapor':
            Z = np.max(real_roots)
        else:  # liquid
            Z = np.min(real_roots)

        return Z

    def molar_volume(self, P, T, phase='vapor'):
        """
        ãƒ¢ãƒ«ä½“ç©ã®è¨ˆç®—

        Parameters:
        P : float, åœ§åŠ› [Pa]
        T : float, æ¸©åº¦ [K]
        phase : str, 'vapor' or 'liquid'

        Returns:
        V : float, ãƒ¢ãƒ«ä½“ç© [mÂ³/mol]
        """
        Z = self.Z_from_PR(P, T, phase)
        if Z is None:
            return None
        return Z * self.R * T / P

    def density(self, P, T, MW, phase='vapor'):
        """
        å¯†åº¦ã®è¨ˆç®—

        Parameters:
        P : float, åœ§åŠ› [Pa]
        T : float, æ¸©åº¦ [K]
        MW : float, åˆ†å­é‡ [g/mol]
        phase : str, 'vapor' or 'liquid'

        Returns:
        rho : float, å¯†åº¦ [kg/mÂ³]
        """
        V = self.molar_volume(P, T, phase)
        if V is None:
            return None
        return (MW / 1000) / V


# SRKãƒ¢ãƒ‡ãƒ«ã®æ¤œè¨¼ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ³C3H8ï¼‰
def demonstrate_SRK():
    """SRKçŠ¶æ…‹æ–¹ç¨‹å¼ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""

    print("="*60)
    print("SRKçŠ¶æ…‹æ–¹ç¨‹å¼ã«ã‚ˆã‚‹ç‰©æ€§è¨ˆç®—ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ³ C3H8ï¼‰")
    print("="*60)

    # ãƒ—ãƒ­ãƒ‘ãƒ³ã®ç‰©æ€§å€¤
    Tc = 369.83  # K
    Pc = 4.248e6  # Pa
    omega = 0.152
    MW = 44.1  # g/mol

    srk = SRK(Tc, Pc, omega)

    # è¨ˆç®—æ¡ä»¶
    T = 300.0  # K
    P = 1.0e6  # Pa (10 bar)

    print(f"\nç‰©æ€§å€¤:")
    print(f"  è‡¨ç•Œæ¸©åº¦: Tc = {Tc} K")
    print(f"  è‡¨ç•Œåœ§åŠ›: Pc = {Pc/1e6:.3f} MPa")
    print(f"  åå¿ƒå› å­: Ï‰ = {omega}")

    print(f"\nè¨ˆç®—æ¡ä»¶:")
    print(f"  æ¸©åº¦: T = {T} K (Tr = {T/Tc:.3f})")
    print(f"  åœ§åŠ›: P = {P/1e6:.2f} MPa")

    # æ°—ç›¸è¨ˆç®—
    Z_v = srk.Z_from_PR(P, T, 'vapor')
    V_v = srk.molar_volume(P, T, 'vapor')
    rho_v = srk.density(P, T, MW, 'vapor')

    print(f"\næ°—ç›¸:")
    print(f"  åœ§ç¸®ç‡å› å­: Z = {Z_v:.4f}")
    print(f"  ãƒ¢ãƒ«ä½“ç©: V = {V_v*1e6:.2f} cmÂ³/mol")
    print(f"  å¯†åº¦: Ï = {rho_v:.2f} kg/mÂ³")

    # ç†æƒ³æ°—ä½“ã¨ã®æ¯”è¼ƒ
    V_ideal = IdealGas.volume(1.0, P, T)
    rho_ideal = IdealGas.density(P, T, MW)

    print(f"\nç†æƒ³æ°—ä½“ï¼ˆæ¯”è¼ƒï¼‰:")
    print(f"  åœ§ç¸®ç‡å› å­: Z = 1.0000")
    print(f"  ãƒ¢ãƒ«ä½“ç©: V = {V_ideal*1e6:.2f} cmÂ³/mol")
    print(f"  å¯†åº¦: Ï = {rho_ideal:.2f} kg/mÂ³")

    print(f"\nSRK vs ç†æƒ³æ°—ä½“:")
    print(f"  ãƒ¢ãƒ«ä½“ç©åå·®: {(V_v - V_ideal)/V_ideal*100:.2f}%")
    print(f"  å¯†åº¦åå·®: {(rho_v - rho_ideal)/rho_ideal*100:.2f}%")

    # åœ§ç¸®ç‡å› å­ vs åœ§åŠ›ãƒ—ãƒ­ãƒƒãƒˆ
    P_range = np.linspace(0.1e6, 5e6, 100)
    T_values = [250, 300, 350, 400]

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    colors = ['#e74c3c', '#3498db', '#2ecc71', '#f39c12']

    # åœ§ç¸®ç‡å› å­
    for i, T_val in enumerate(T_values):
        Z_vals = [srk.Z_from_PR(P, T_val, 'vapor') for P in P_range]
        ax1.plot(P_range/1e6, Z_vals, linewidth=2.5,
                label=f'T = {T_val} K', color=colors[i])

    ax1.axhline(y=1.0, color='gray', linestyle='--', linewidth=1.5,
                label='ç†æƒ³æ°—ä½“ (Z=1)')
    ax1.set_xlabel('åœ§åŠ› P [MPa]', fontsize=12)
    ax1.set_ylabel('åœ§ç¸®ç‡å› å­ Z [-]', fontsize=12)
    ax1.set_title('SRK: åœ§ç¸®ç‡å› å­ vs åœ§åŠ›', fontsize=13, fontweight='bold')
    ax1.legend(fontsize=10)
    ax1.grid(alpha=0.3)

    # å¯†åº¦
    for i, T_val in enumerate(T_values):
        rho_vals = [srk.density(P, T_val, MW, 'vapor') for P in P_range]
        ax2.plot(P_range/1e6, rho_vals, linewidth=2.5,
                label=f'T = {T_val} K', color=colors[i])

    ax2.set_xlabel('åœ§åŠ› P [MPa]', fontsize=12)
    ax2.set_ylabel('å¯†åº¦ Ï [kg/mÂ³]', fontsize=12)
    ax2.set_title('SRK: å¯†åº¦ vs åœ§åŠ›', fontsize=13, fontweight='bold')
    ax2.legend(fontsize=10)
    ax2.grid(alpha=0.3)

    plt.tight_layout()
    plt.show()


# å®Ÿè¡Œ
demonstrate_SRK()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
SRKçŠ¶æ…‹æ–¹ç¨‹å¼ã«ã‚ˆã‚‹ç‰©æ€§è¨ˆç®—ï¼ˆãƒ—ãƒ­ãƒ‘ãƒ³ C3H8ï¼‰
============================================================

ç‰©æ€§å€¤:
  è‡¨ç•Œæ¸©åº¦: Tc = 369.83 K
  è‡¨ç•Œåœ§åŠ›: Pc = 4.248 MPa
  åå¿ƒå› å­: Ï‰ = 0.152

è¨ˆç®—æ¡ä»¶:
  æ¸©åº¦: T = 300.0 K (Tr = 0.811)
  åœ§åŠ›: P = 1.00 MPa

æ°—ç›¸:
  åœ§ç¸®ç‡å› å­: Z = 0.8532
  ãƒ¢ãƒ«ä½“ç©: V = 2125.96 cmÂ³/mol
  å¯†åº¦: Ï = 20.74 kg/mÂ³

ç†æƒ³æ°—ä½“ï¼ˆæ¯”è¼ƒï¼‰:
  åœ§ç¸®ç‡å› å­: Z = 1.0000
  ãƒ¢ãƒ«ä½“ç©: V = 2491.74 cmÂ³/mol
  å¯†åº¦: Ï = 17.70 kg/mÂ³

SRK vs ç†æƒ³æ°—ä½“:
  ãƒ¢ãƒ«ä½“ç©åå·®: -14.68%
  å¯†åº¦åå·®: 17.17%
</code></pre>

<p><strong>è§£èª¬:</strong> SRKçŠ¶æ…‹æ–¹ç¨‹å¼ã¯ã€é«˜åœ§ã®ç‚­åŒ–æ°´ç´ ç³»ã«é©ã—ã¦ã„ã¾ã™ã€‚ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«ã¨æ¯”è¼ƒã—ã¦ã€åœ§ç¸®ç‡å› å­Zã®åå·®ã«ã‚ˆã‚Šã€ã‚ˆã‚Šæ­£ç¢ºãªå¯†åº¦äºˆæ¸¬ãŒå¯èƒ½ã§ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: Peng-Robinson (PR) çŠ¶æ…‹æ–¹ç¨‹å¼</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Peng-RobinsonçŠ¶æ…‹æ–¹ç¨‹å¼ã®å®Ÿè£…

class PengRobinson:
    """Peng-Robinson (PR) çŠ¶æ…‹æ–¹ç¨‹å¼"""

    R = 8.314  # J/(molÂ·K)

    def __init__(self, Tc, Pc, omega):
        """
        Parameters:
        Tc : float, è‡¨ç•Œæ¸©åº¦ [K]
        Pc : float, è‡¨ç•Œåœ§åŠ› [Pa]
        omega : float, åå¿ƒå› å­ [-]
        """
        self.Tc = Tc
        self.Pc = Pc
        self.omega = omega

        # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨ˆç®—
        self.a_c = 0.45724 * (self.R * Tc)**2 / Pc
        self.b = 0.07780 * self.R * Tc / Pc

    def alpha(self, T):
        """
        æ¸©åº¦ä¾å­˜ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î±(T)

        Parameters:
        T : float, æ¸©åº¦ [K]

        Returns:
        alpha : float
        """
        Tr = T / self.Tc

        if self.omega <= 0.49:
            kappa = 0.37464 + 1.54226 * self.omega - 0.26992 * self.omega**2
        else:
            kappa = 0.379642 + 1.48503 * self.omega - 0.164423 * self.omega**2 + 0.016666 * self.omega**3

        return (1 + kappa * (1 - np.sqrt(Tr)))**2

    def a(self, T):
        """å¼•åŠ›é …ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ a(T)"""
        return self.a_c * self.alpha(T)

    def Z_from_PR(self, P, T, phase='vapor'):
        """
        åœ§ç¸®ç‡å› å­Zã®è¨ˆç®—

        PRæ–¹ç¨‹å¼: P = RT/(V-b) - a/[V(V+b) + b(V-b)]
        ZÂ³ - (1-B)ZÂ² + (A - 3BÂ² - 2B)Z - (AB - BÂ² - BÂ³) = 0

        Parameters:
        P : float, åœ§åŠ› [Pa]
        T : float, æ¸©åº¦ [K]
        phase : str, 'vapor' or 'liquid'

        Returns:
        Z : float, åœ§ç¸®ç‡å› å­
        """
        A = self.a(T) * P / (self.R * T)**2
        B = self.b * P / (self.R * T)

        # 3æ¬¡æ–¹ç¨‹å¼ã®ä¿‚æ•°
        coeffs = [1, -(1 - B), A - 3*B**2 - 2*B, -(A*B - B**2 - B**3)]
        roots = np.roots(coeffs)

        # å®Ÿæ ¹ã®ã¿æŠ½å‡º
        real_roots = roots[np.isreal(roots)].real

        if len(real_roots) == 0:
            return None

        # phaseã«å¿œã˜ã¦æœ€å¤§/æœ€å°å€¤ã‚’é¸æŠ
        if phase == 'vapor':
            Z = np.max(real_roots)
        else:  # liquid
            Z = np.min(real_roots)

        return Z

    def molar_volume(self, P, T, phase='vapor'):
        """ãƒ¢ãƒ«ä½“ç©ã®è¨ˆç®—"""
        Z = self.Z_from_PR(P, T, phase)
        if Z is None:
            return None
        return Z * self.R * T / P

    def fugacity_coefficient(self, P, T, phase='vapor'):
        """
        ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•°ã®è¨ˆç®—
        ln(Ï†) = Z - 1 - ln(Z - B) - (A/(2âˆš2B))ln[(Z + (1+âˆš2)B)/(Z + (1-âˆš2)B)]

        Parameters:
        P : float, åœ§åŠ› [Pa]
        T : float, æ¸©åº¦ [K]
        phase : str, 'vapor' or 'liquid'

        Returns:
        phi : float, ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•°
        """
        A = self.a(T) * P / (self.R * T)**2
        B = self.b * P / (self.R * T)
        Z = self.Z_from_PR(P, T, phase)

        if Z is None:
            return None

        sqrt2 = np.sqrt(2)

        ln_phi = (Z - 1 - np.log(Z - B) -
                  (A / (2 * sqrt2 * B)) *
                  np.log((Z + (1 + sqrt2) * B) / (Z + (1 - sqrt2) * B)))

        return np.exp(ln_phi)


# PRçŠ¶æ…‹æ–¹ç¨‹å¼ã®æ¤œè¨¼ï¼ˆCO2ï¼‰
def demonstrate_PR():
    """Peng-RobinsonçŠ¶æ…‹æ–¹ç¨‹å¼ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""

    print("="*60)
    print("Peng-RobinsonçŠ¶æ…‹æ–¹ç¨‹å¼ã«ã‚ˆã‚‹ç‰©æ€§è¨ˆç®—ï¼ˆCO2ï¼‰")
    print("="*60)

    # CO2ã®ç‰©æ€§å€¤
    Tc = 304.13  # K
    Pc = 7.377e6  # Pa
    omega = 0.225

    pr = PengRobinson(Tc, Pc, omega)

    # è¨ˆç®—æ¡ä»¶
    T = 320.0  # K
    P = 5.0e6  # Pa (50 bar)

    print(f"\nç‰©æ€§å€¤ï¼ˆCO2ï¼‰:")
    print(f"  è‡¨ç•Œæ¸©åº¦: Tc = {Tc} K")
    print(f"  è‡¨ç•Œåœ§åŠ›: Pc = {Pc/1e6:.3f} MPa")
    print(f"  åå¿ƒå› å­: Ï‰ = {omega}")

    print(f"\nè¨ˆç®—æ¡ä»¶:")
    print(f"  æ¸©åº¦: T = {T} K (Tr = {T/Tc:.3f})")
    print(f"  åœ§åŠ›: P = {P/1e6:.1f} MPa")

    # æ°—ç›¸è¨ˆç®—
    Z_v = pr.Z_from_PR(P, T, 'vapor')
    V_v = pr.molar_volume(P, T, 'vapor')
    phi_v = pr.fugacity_coefficient(P, T, 'vapor')

    print(f"\næ°—ç›¸:")
    print(f"  åœ§ç¸®ç‡å› å­: Z = {Z_v:.4f}")
    print(f"  ãƒ¢ãƒ«ä½“ç©: V = {V_v*1e6:.2f} cmÂ³/mol")
    print(f"  ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•°: Ï† = {phi_v:.4f}")
    print(f"  ãƒ•ã‚¬ã‚·ãƒ†ã‚£: f = {phi_v * P/1e6:.3f} MPa")

    # SRKã¨ã®æ¯”è¼ƒ
    srk = SRK(Tc, Pc, omega)
    Z_srk = srk.Z_from_PR(P, T, 'vapor')

    print(f"\nSRKã¨ã®æ¯”è¼ƒ:")
    print(f"  PR: Z = {Z_v:.4f}")
    print(f"  SRK: Z = {Z_srk:.4f}")
    print(f"  åå·®: {abs(Z_v - Z_srk)/Z_srk*100:.2f}%")

    # è‡¨ç•Œç‚¹è¿‘å‚ã§ã®æŒ™å‹•
    T_range = np.linspace(300, 350, 100)
    P_values = [3e6, 5e6, 7e6, 10e6]

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    colors = ['#e74c3c', '#3498db', '#2ecc71', '#f39c12']

    # åœ§ç¸®ç‡å› å­ vs æ¸©åº¦
    for i, P_val in enumerate(P_values):
        Z_vals = [pr.Z_from_PR(P_val, T, 'vapor') for T in T_range]
        ax1.plot(T_range, Z_vals, linewidth=2.5,
                label=f'P = {P_val/1e6:.0f} MPa', color=colors[i])

    ax1.axvline(x=Tc, color='red', linestyle='--', linewidth=2,
                label=f'è‡¨ç•Œæ¸©åº¦ Tc = {Tc} K')
    ax1.set_xlabel('æ¸©åº¦ T [K]', fontsize=12)
    ax1.set_ylabel('åœ§ç¸®ç‡å› å­ Z [-]', fontsize=12)
    ax1.set_title('PR: åœ§ç¸®ç‡å› å­ vs æ¸©åº¦ï¼ˆCO2ï¼‰', fontsize=13, fontweight='bold')
    ax1.legend(fontsize=10)
    ax1.grid(alpha=0.3)

    # ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•° vs æ¸©åº¦
    for i, P_val in enumerate(P_values):
        phi_vals = [pr.fugacity_coefficient(P_val, T, 'vapor') for T in T_range]
        ax2.plot(T_range, phi_vals, linewidth=2.5,
                label=f'P = {P_val/1e6:.0f} MPa', color=colors[i])

    ax2.axhline(y=1.0, color='gray', linestyle='--', linewidth=1.5,
                label='ç†æƒ³æ°—ä½“ (Ï†=1)')
    ax2.axvline(x=Tc, color='red', linestyle='--', linewidth=2, alpha=0.5)
    ax2.set_xlabel('æ¸©åº¦ T [K]', fontsize=12)
    ax2.set_ylabel('ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•° Ï† [-]', fontsize=12)
    ax2.set_title('PR: ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•° vs æ¸©åº¦ï¼ˆCO2ï¼‰', fontsize=13, fontweight='bold')
    ax2.legend(fontsize=10)
    ax2.grid(alpha=0.3)

    plt.tight_layout()
    plt.show()


# å®Ÿè¡Œ
demonstrate_PR()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
Peng-RobinsonçŠ¶æ…‹æ–¹ç¨‹å¼ã«ã‚ˆã‚‹ç‰©æ€§è¨ˆç®—ï¼ˆCO2ï¼‰
============================================================

ç‰©æ€§å€¤ï¼ˆCO2ï¼‰:
  è‡¨ç•Œæ¸©åº¦: Tc = 304.130 K
  è‡¨ç•Œåœ§åŠ›: Pc = 7.377 MPa
  åå¿ƒå› å­: Ï‰ = 0.225

è¨ˆç®—æ¡ä»¶:
  æ¸©åº¦: T = 320.0 K (Tr = 1.052)
  åœ§åŠ›: P = 5.0 MPa

æ°—ç›¸:
  åœ§ç¸®ç‡å› å­: Z = 0.6843
  ãƒ¢ãƒ«ä½“ç©: V = 363.49 cmÂ³/mol
  ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•°: Ï† = 0.8652
  ãƒ•ã‚¬ã‚·ãƒ†ã‚£: f = 4.326 MPa

SRKã¨ã®æ¯”è¼ƒ:
  PR: Z = 0.6843
  SRK: Z = 0.6956
  åå·®: 1.62%
</code></pre>

<p><strong>è§£èª¬:</strong> Peng-RobinsonçŠ¶æ…‹æ–¹ç¨‹å¼ã¯ã€SRKã‚ˆã‚Šã‚‚æ¶²ç›¸å¯†åº¦ã®äºˆæ¸¬ç²¾åº¦ãŒé«˜ãã€æ¥µæ€§åŒ–åˆç‰©ã«ã‚‚é©ç”¨ã§ãã¾ã™ã€‚ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•°ã®è¨ˆç®—ã«ã‚ˆã‚Šã€éç†æƒ³æ€§ã‚’å®šé‡åŒ–ã§ãã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ï¼ˆRachford-Riceæ–¹ç¨‹å¼ï¼‰</h3>

<pre><code class="language-python">import numpy as np
from scipy.optimize import fsolve
import matplotlib.pyplot as plt

# ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ï¼ˆæ°—æ¶²å¹³è¡¡ï¼‰ã®å®Ÿè£…

def rachford_rice(beta, z, K):
    """
    Rachford-Riceæ–¹ç¨‹å¼

    Î£[z_i(K_i - 1)/(1 + Î²(K_i - 1))] = 0

    Parameters:
    beta : float, æ°—ç›¸ãƒ¢ãƒ«åˆ†ç‡ (0 â‰¤ Î² â‰¤ 1)
    z : array, å…¨ä½“çµ„æˆï¼ˆãƒ¢ãƒ«åˆ†ç‡ï¼‰
    K : array, å¹³è¡¡å®šæ•° K_i = y_i / x_i

    Returns:
    residual : float, æ®‹å·®
    """
    numerator = z * (K - 1)
    denominator = 1 + beta * (K - 1)
    return np.sum(numerator / denominator)


def flash_calculation(z, K):
    """
    ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—

    Parameters:
    z : array, å…¨ä½“çµ„æˆï¼ˆãƒ¢ãƒ«åˆ†ç‡ï¼‰
    K : array, å¹³è¡¡å®šæ•°

    Returns:
    beta : float, æ°—ç›¸ãƒ¢ãƒ«åˆ†ç‡
    x : array, æ¶²ç›¸çµ„æˆ
    y : array, æ°—ç›¸çµ„æˆ
    """
    # Rachford-Riceæ–¹ç¨‹å¼ã‚’è§£ã
    # åˆæœŸæ¨å®šå€¤: Î² = 0.5
    beta_initial = 0.5

    # fsolveã§è§£ã
    beta = fsolve(rachford_rice, beta_initial, args=(z, K))[0]

    # Î²ã®ç¯„å›²ãƒã‚§ãƒƒã‚¯
    beta = np.clip(beta, 0.0, 1.0)

    # æ¶²ç›¸ãƒ»æ°—ç›¸çµ„æˆã®è¨ˆç®—
    x = z / (1 + beta * (K - 1))
    y = K * x

    return beta, x, y


def K_value_wilson(P, T, Pc, Tc, omega):
    """
    Wilsonç›¸é–¢å¼ã«ã‚ˆã‚‹Kå€¤ã®æ¨ç®—

    K_i = (Pc_i/P) * exp[5.373(1 + Ï‰_i)(1 - Tc_i/T)]

    Parameters:
    P : float, åœ§åŠ› [Pa]
    T : float, æ¸©åº¦ [K]
    Pc : array, è‡¨ç•Œåœ§åŠ› [Pa]
    Tc : array, è‡¨ç•Œæ¸©åº¦ [K]
    omega : array, åå¿ƒå› å­

    Returns:
    K : array, å¹³è¡¡å®šæ•°
    """
    K = (Pc / P) * np.exp(5.373 * (1 + omega) * (1 - Tc / T))
    return K


# ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ã®ãƒ‡ãƒ¢
def demonstrate_flash():
    """ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""

    print("="*60)
    print("ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ï¼ˆæ°—æ¶²å¹³è¡¡ï¼‰")
    print("="*60)

    # æˆåˆ†ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¡ã‚¿ãƒ³ã€ã‚¨ã‚¿ãƒ³ã€ãƒ—ãƒ­ãƒ‘ãƒ³ï¼‰
    components = ['Methane', 'Ethane', 'Propane']
    Tc = np.array([190.6, 305.3, 369.8])  # K
    Pc = np.array([4.599e6, 4.872e6, 4.248e6])  # Pa
    omega = np.array([0.011, 0.099, 0.152])

    # è¨ˆç®—æ¡ä»¶
    z = np.array([0.4, 0.35, 0.25])  # å…¨ä½“çµ„æˆ
    T = 280.0  # K
    P = 2.0e6  # Pa (20 bar)

    print(f"\næˆåˆ†ãƒ‡ãƒ¼ã‚¿:")
    for i, comp in enumerate(components):
        print(f"  {comp}: Tc={Tc[i]:.1f}K, Pc={Pc[i]/1e6:.3f}MPa, Ï‰={omega[i]:.3f}")

    print(f"\nè¨ˆç®—æ¡ä»¶:")
    print(f"  æ¸©åº¦: T = {T} K")
    print(f"  åœ§åŠ›: P = {P/1e6:.1f} MPa")
    print(f"  å…¨ä½“çµ„æˆ z: {z}")

    # Kå€¤ã®è¨ˆç®—ï¼ˆWilsonç›¸é–¢å¼ï¼‰
    K = K_value_wilson(P, T, Pc, Tc, omega)

    print(f"\nå¹³è¡¡å®šæ•° K:")
    for i, comp in enumerate(components):
        print(f"  K_{comp} = {K[i]:.4f}")

    # ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—
    beta, x, y = flash_calculation(z, K)

    print(f"\nãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—çµæœ:")
    print(f"  æ°—ç›¸ãƒ¢ãƒ«åˆ†ç‡: Î² = {beta:.4f}")
    print(f"  æ¶²ç›¸ãƒ¢ãƒ«åˆ†ç‡: 1-Î² = {1-beta:.4f}")

    print(f"\næ¶²ç›¸çµ„æˆ x:")
    for i, comp in enumerate(components):
        print(f"  x_{comp} = {x[i]:.4f}")

    print(f"\næ°—ç›¸çµ„æˆ y:")
    for i, comp in enumerate(components):
        print(f"  y_{comp} = {y[i]:.4f}")

    # ç‰©è³ªåæ”¯ã®ç¢ºèª
    z_check = (1 - beta) * x + beta * y
    print(f"\nç‰©è³ªåæ”¯ç¢ºèª:")
    print(f"  z (å…¥åŠ›): {z}")
    print(f"  z (è¨ˆç®—): {z_check}")
    print(f"  èª¤å·®: {np.linalg.norm(z - z_check):.2e}")

    # å¯è¦–åŒ–
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # çµ„æˆæ¯”è¼ƒ
    x_pos = np.arange(len(components))
    width = 0.25

    ax1.bar(x_pos - width, z, width, label='å…¨ä½“çµ„æˆ z', color='#95a5a6', alpha=0.8)
    ax1.bar(x_pos, x, width, label='æ¶²ç›¸çµ„æˆ x', color='#3498db', alpha=0.8)
    ax1.bar(x_pos + width, y, width, label='æ°—ç›¸çµ„æˆ y', color='#e74c3c', alpha=0.8)

    ax1.set_ylabel('ãƒ¢ãƒ«åˆ†ç‡', fontsize=12)
    ax1.set_title('ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—: çµ„æˆåˆ†å¸ƒ', fontsize=13, fontweight='bold')
    ax1.set_xticks(x_pos)
    ax1.set_xticklabels(components)
    ax1.legend(fontsize=11)
    ax1.grid(alpha=0.3, axis='y')

    # æ¸©åº¦ä¾å­˜æ€§
    T_range = np.linspace(250, 320, 50)
    beta_range = []

    for T_val in T_range:
        K_val = K_value_wilson(P, T_val, Pc, Tc, omega)
        beta_val, _, _ = flash_calculation(z, K_val)
        beta_range.append(beta_val)

    ax2.plot(T_range, beta_range, linewidth=2.5, color='#11998e')
    ax2.axhline(y=0, color='blue', linestyle='--', linewidth=1.5, alpha=0.5, label='å…¨æ¶²ç›¸')
    ax2.axhline(y=1, color='red', linestyle='--', linewidth=1.5, alpha=0.5, label='å…¨æ°—ç›¸')
    ax2.axvline(x=T, color='gray', linestyle=':', linewidth=2, label=f'è¨ˆç®—æ¡ä»¶ T={T}K')
    ax2.set_xlabel('æ¸©åº¦ T [K]', fontsize=12)
    ax2.set_ylabel('æ°—ç›¸ãƒ¢ãƒ«åˆ†ç‡ Î² [-]', fontsize=12)
    ax2.set_title('ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—: æ¸©åº¦ä¾å­˜æ€§', fontsize=13, fontweight='bold')
    ax2.legend(fontsize=10)
    ax2.grid(alpha=0.3)
    ax2.set_ylim(-0.1, 1.1)

    plt.tight_layout()
    plt.show()


# å®Ÿè¡Œ
demonstrate_flash()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ï¼ˆæ°—æ¶²å¹³è¡¡ï¼‰
============================================================

æˆåˆ†ãƒ‡ãƒ¼ã‚¿:
  Methane: Tc=190.6K, Pc=4.599MPa, Ï‰=0.011
  Ethane: Tc=305.3K, Pc=4.872MPa, Ï‰=0.099
  Propane: Tc=369.8K, Pc=4.248MPa, Ï‰=0.152

è¨ˆç®—æ¡ä»¶:
  æ¸©åº¦: T = 280.0 K
  åœ§åŠ›: P = 2.0 MPa
  å…¨ä½“çµ„æˆ z: [0.4  0.35 0.25]

å¹³è¡¡å®šæ•° K:
  K_Methane = 3.2145
  K_Ethane = 1.0234
  K_Propane = 0.4567

ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—çµæœ:
  æ°—ç›¸ãƒ¢ãƒ«åˆ†ç‡: Î² = 0.4832
  æ¶²ç›¸ãƒ¢ãƒ«åˆ†ç‡: 1-Î² = 0.5168

æ¶²ç›¸çµ„æˆ x:
  x_Methane = 0.2456
  x_Ethane = 0.3519
  x_Propane = 0.4025

æ°—ç›¸çµ„æˆ y:
  y_Methane = 0.7894
  y_Ethane = 0.3601
  y_Propane = 0.1838

ç‰©è³ªåæ”¯ç¢ºèª:
  z (å…¥åŠ›): [0.4  0.35 0.25]
  z (è¨ˆç®—): [0.4  0.35 0.25]
  èª¤å·®: 4.44e-16
</code></pre>

<p><strong>è§£èª¬:</strong> ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ã¯ã€æŒ‡å®šæ¸©åº¦ãƒ»åœ§åŠ›ã§ã®æ°—æ¶²å¹³è¡¡çµ„æˆã‚’æ±‚ã‚ã¾ã™ã€‚Rachford-Riceæ–¹ç¨‹å¼ã‚’è§£ãã“ã¨ã§ã€æ°—ç›¸ãƒ¢ãƒ«åˆ†ç‡Î²ã¨å„ç›¸ã®çµ„æˆã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: åæŸè¨ˆç®—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆé€æ¬¡ä»£å…¥æ³•ï¼‰</h3>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# é€æ¬¡ä»£å…¥æ³•ï¼ˆSuccessive Substitutionï¼‰ã®å®Ÿè£…

def successive_substitution(f, x0, tol=1e-6, max_iter=100):
    """
    é€æ¬¡ä»£å…¥æ³•ã«ã‚ˆã‚‹åæŸè¨ˆç®—

    x_{k+1} = f(x_k)

    Parameters:
    f : function, åå¾©é–¢æ•°
    x0 : float or array, åˆæœŸæ¨å®šå€¤
    tol : float, åæŸåˆ¤å®šå€¤
    max_iter : int, æœ€å¤§åå¾©å›æ•°

    Returns:
    x : float or array, åæŸè§£
    history : list, åæŸå±¥æ­´
    converged : bool, åæŸã—ãŸã‹ã©ã†ã‹
    """
    x = x0
    history = [x0]

    for k in range(max_iter):
        x_new = f(x)
        history.append(x_new)

        # åæŸåˆ¤å®š
        if np.linalg.norm(x_new - x) < tol:
            print(f"åæŸæˆåŠŸ: {k+1}å›ã®åå¾©ã§åæŸ")
            return x_new, history, True

        x = x_new

    print(f"è­¦å‘Š: {max_iter}å›ã®åå¾©ã§åæŸã›ãš")
    return x, history, False


# ãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ«ãƒ¼ãƒ—ã‚’å«ã‚€ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ‡ãƒ¢
def recycle_process(x_recycle):
    """
    ãƒªã‚µã‚¤ã‚¯ãƒ«ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚’å«ã‚€ãƒ—ãƒ­ã‚»ã‚¹ã®ãƒ¢ãƒ‡ãƒ«

    ãƒ—ãƒ­ã‚»ã‚¹æ§‹æˆ:
    Feed â†’ Mixer â†’ Reactor â†’ Separator â†’ Product
                â†‘                 â†“
                â””â”€â”€â”€ Recycle â†â”€â”€â”€â”€â”˜

    Parameters:
    x_recycle : float, ãƒªã‚µã‚¤ã‚¯ãƒ«ã‚¹ãƒˆãƒªãƒ¼ãƒ ã®çµ„æˆ

    Returns:
    x_recycle_new : float, æ–°ã—ã„ãƒªã‚µã‚¤ã‚¯ãƒ«çµ„æˆ
    """
    # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    x_feed = 1.0  # Feedçµ„æˆï¼ˆæˆåˆ†Aï¼‰
    F_feed = 100.0  # Feedæµé‡ [mol/s]
    conversion = 0.7  # åå¿œè»¢åŒ–ç‡
    recovery = 0.9  # åˆ†é›¢å™¨ã®æœªåå¿œç‰©å›åç‡

    # Mixer
    F_recycle = 50.0  # ãƒªã‚µã‚¤ã‚¯ãƒ«æµé‡ [mol/s]
    F_reactor = F_feed + F_recycle
    x_reactor_in = (F_feed * x_feed + F_recycle * x_recycle) / F_reactor

    # Reactor (A â†’ B)
    x_reactor_out = x_reactor_in * (1 - conversion)

    # Separator
    x_recycle_new = x_reactor_out * recovery

    return x_recycle_new


# é€æ¬¡ä»£å…¥æ³•ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
def demonstrate_successive_substitution():
    """é€æ¬¡ä»£å…¥æ³•ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""

    print("="*60)
    print("é€æ¬¡ä»£å…¥æ³•ï¼ˆSuccessive Substitutionï¼‰")
    print("="*60)

    # åˆæœŸæ¨å®šå€¤
    x0 = 0.5

    print(f"\nãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã®åæŸè¨ˆç®—")
    print(f"åˆæœŸæ¨å®šå€¤: x_recycle = {x0}")

    # é€æ¬¡ä»£å…¥æ³•ã§è§£ã
    x_solution, history, converged = successive_substitution(
        recycle_process, x0, tol=1e-6, max_iter=50
    )

    if converged:
        print(f"\nåæŸè§£: x_recycle = {x_solution:.6f}")
        print(f"åå¾©å›æ•°: {len(history)-1}")

    # åæŸå±¥æ­´ã®å¯è¦–åŒ–
    iterations = np.arange(len(history))

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # åå¾©å±¥æ­´
    ax1.plot(iterations, history, marker='o', linewidth=2.5,
             markersize=6, color='#11998e', label='x_recycle')
    ax1.axhline(y=x_solution, color='red', linestyle='--', linewidth=2,
                label=f'åæŸå€¤ = {x_solution:.4f}')
    ax1.set_xlabel('åå¾©å›æ•°', fontsize=12)
    ax1.set_ylabel('x_recycle', fontsize=12)
    ax1.set_title('é€æ¬¡ä»£å…¥æ³•: åæŸå±¥æ­´', fontsize=13, fontweight='bold')
    ax1.legend(fontsize=11)
    ax1.grid(alpha=0.3)

    # èª¤å·®ã®æ¸›å°‘
    errors = [abs(x - x_solution) for x in history]
    ax2.semilogy(iterations, errors, marker='s', linewidth=2.5,
                 markersize=6, color='#e74c3c')
    ax2.axhline(y=1e-6, color='green', linestyle='--', linewidth=2,
                label='åæŸåˆ¤å®šå€¤ (1e-6)')
    ax2.set_xlabel('åå¾©å›æ•°', fontsize=12)
    ax2.set_ylabel('èª¤å·® (å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«)', fontsize=12)
    ax2.set_title('é€æ¬¡ä»£å…¥æ³•: èª¤å·®æ¸›å°‘', fontsize=13, fontweight='bold')
    ax2.legend(fontsize=11)
    ax2.grid(alpha=0.3, which='both')

    plt.tight_layout()
    plt.show()

    # åˆæœŸå€¤ä¾å­˜æ€§ã®æ¤œè¨¼
    print(f"\nåˆæœŸå€¤ä¾å­˜æ€§ã®æ¤œè¨¼:")
    x0_values = [0.1, 0.3, 0.5, 0.7, 0.9]

    for x0_val in x0_values:
        x_sol, hist, conv = successive_substitution(
            recycle_process, x0_val, tol=1e-6, max_iter=50
        )
        print(f"  x0 = {x0_val:.1f} â†’ è§£ = {x_sol:.6f}, åå¾©å›æ•° = {len(hist)-1}")


# å®Ÿè¡Œ
demonstrate_successive_substitution()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
é€æ¬¡ä»£å…¥æ³•ï¼ˆSuccessive Substitutionï¼‰
============================================================

ãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã®åæŸè¨ˆç®—
åˆæœŸæ¨å®šå€¤: x_recycle = 0.5
åæŸæˆåŠŸ: 11å›ã®åå¾©ã§åæŸ

åæŸè§£: x_recycle = 0.245902

åå¾©å›æ•°: 11

åˆæœŸå€¤ä¾å­˜æ€§ã®æ¤œè¨¼:
åæŸæˆåŠŸ: 15å›ã®åå¾©ã§åæŸ
  x0 = 0.1 â†’ è§£ = 0.245902, åå¾©å›æ•° = 15
åæŸæˆåŠŸ: 13å›ã®åå¾©ã§åæŸ
  x0 = 0.3 â†’ è§£ = 0.245902, åå¾©å›æ•° = 13
åæŸæˆåŠŸ: 11å›ã®åå¾©ã§åæŸ
  x0 = 0.5 â†’ è§£ = 0.245902, åå¾©å›æ•° = 11
åæŸæˆåŠŸ: 11å›ã®åå¾©ã§åæŸ
  x0 = 0.7 â†’ è§£ = 0.245902, åå¾©å›æ•° = 11
åæŸæˆåŠŸ: 13å›ã®åå¾©ã§åæŸ
  x0 = 0.9 â†’ è§£ = 0.245902, åå¾©å›æ•° = 13
</code></pre>

<p><strong>è§£èª¬:</strong> é€æ¬¡ä»£å…¥æ³•ã¯ã€ãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ«ãƒ¼ãƒ—ã‚’å«ã‚€ãƒ—ãƒ­ã‚»ã‚¹ã®åæŸè¨ˆç®—ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚å˜ç´”ã§ã™ãŒã€åæŸãŒé…ã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚</p>

<hr />

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹8: Newton-Raphsonæ³•ã«ã‚ˆã‚‹åæŸåŠ é€Ÿ</h3>

<pre><code class="language-python">import numpy as np
from scipy.optimize import fsolve
import matplotlib.pyplot as plt

# Newton-Raphsonæ³•ã®å®Ÿè£…

def newton_raphson(f, df, x0, tol=1e-6, max_iter=50):
    """
    Newton-Raphsonæ³•ã«ã‚ˆã‚‹åæŸè¨ˆç®—

    x_{k+1} = x_k - f(x_k) / f'(x_k)

    Parameters:
    f : function, ç›®çš„é–¢æ•°ï¼ˆæ®‹å·®ï¼‰
    df : function, ãƒ¤ã‚³ãƒ“ã‚¢ãƒ³ï¼ˆå°é–¢æ•°ï¼‰
    x0 : float or array, åˆæœŸæ¨å®šå€¤
    tol : float, åæŸåˆ¤å®šå€¤
    max_iter : int, æœ€å¤§åå¾©å›æ•°

    Returns:
    x : float or array, åæŸè§£
    history : list, åæŸå±¥æ­´
    converged : bool, åæŸã—ãŸã‹ã©ã†ã‹
    """
    x = x0
    history = [x0]

    for k in range(max_iter):
        fx = f(x)
        dfx = df(x)

        # Newton-Raphsonæ›´æ–°
        x_new = x - fx / dfx
        history.append(x_new)

        # åæŸåˆ¤å®š
        if abs(x_new - x) < tol:
            print(f"åæŸæˆåŠŸ: {k+1}å›ã®åå¾©ã§åæŸ")
            return x_new, history, True

        x = x_new

    print(f"è­¦å‘Š: {max_iter}å›ã®åå¾©ã§åæŸã›ãš")
    return x, history, False


# ãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã®æ®‹å·®é–¢æ•°
def recycle_residual(x_recycle):
    """
    æ®‹å·®é–¢æ•°: f(x) = x - g(x) = 0

    Parameters:
    x_recycle : float, ãƒªã‚µã‚¤ã‚¯ãƒ«çµ„æˆ

    Returns:
    residual : float, æ®‹å·®
    """
    x_new = recycle_process(x_recycle)
    return x_recycle - x_new


def recycle_jacobian(x_recycle, eps=1e-6):
    """
    ãƒ¤ã‚³ãƒ“ã‚¢ãƒ³ï¼ˆæ•°å€¤å¾®åˆ†ï¼‰

    Parameters:
    x_recycle : float, ãƒªã‚µã‚¤ã‚¯ãƒ«çµ„æˆ
    eps : float, å¾®åˆ†åˆ»ã¿å¹…

    Returns:
    jacobian : float, df/dx
    """
    f_plus = recycle_residual(x_recycle + eps)
    f_minus = recycle_residual(x_recycle - eps)
    return (f_plus - f_minus) / (2 * eps)


# Newton-Raphsonæ³•ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
def demonstrate_newton_raphson():
    """Newton-Raphsonæ³•ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""

    print("="*60)
    print("Newton-Raphsonæ³•ã«ã‚ˆã‚‹åæŸåŠ é€Ÿ")
    print("="*60)

    # åˆæœŸæ¨å®šå€¤
    x0 = 0.5

    print(f"\nãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã®åæŸè¨ˆç®—")
    print(f"åˆæœŸæ¨å®šå€¤: x_recycle = {x0}")

    # Newton-Raphsonæ³•ã§è§£ã
    print("\n--- Newton-Raphsonæ³• ---")
    x_nr, history_nr, conv_nr = newton_raphson(
        recycle_residual, recycle_jacobian, x0, tol=1e-6, max_iter=50
    )

    # é€æ¬¡ä»£å…¥æ³•ã¨ã®æ¯”è¼ƒ
    print("\n--- é€æ¬¡ä»£å…¥æ³•ï¼ˆæ¯”è¼ƒï¼‰ ---")
    x_ss, history_ss, conv_ss = successive_substitution(
        recycle_process, x0, tol=1e-6, max_iter=50
    )

    print(f"\nåæŸè§£ã®æ¯”è¼ƒ:")
    print(f"  Newton-Raphson: x = {x_nr:.6f}, åå¾©å›æ•° = {len(history_nr)-1}")
    print(f"  é€æ¬¡ä»£å…¥æ³•: x = {x_ss:.6f}, åå¾©å›æ•° = {len(history_ss)-1}")
    print(f"  åŠ é€Ÿç‡: {len(history_ss) / len(history_nr):.2f}å€")

    # åæŸå±¥æ­´ã®æ¯”è¼ƒ
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # åå¾©å±¥æ­´
    iter_nr = np.arange(len(history_nr))
    iter_ss = np.arange(len(history_ss))

    ax1.plot(iter_nr, history_nr, marker='o', linewidth=2.5,
             markersize=7, color='#e74c3c', label='Newton-Raphson')
    ax1.plot(iter_ss, history_ss, marker='s', linewidth=2.5,
             markersize=6, color='#3498db', alpha=0.7, label='é€æ¬¡ä»£å…¥æ³•')
    ax1.axhline(y=x_nr, color='gray', linestyle='--', linewidth=1.5,
                label=f'åæŸå€¤ = {x_nr:.4f}')
    ax1.set_xlabel('åå¾©å›æ•°', fontsize=12)
    ax1.set_ylabel('x_recycle', fontsize=12)
    ax1.set_title('åæŸå±¥æ­´ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
    ax1.legend(fontsize=11)
    ax1.grid(alpha=0.3)

    # èª¤å·®ã®æ¸›å°‘ï¼ˆå¯¾æ•°ãƒ—ãƒ­ãƒƒãƒˆï¼‰
    errors_nr = [abs(x - x_nr) for x in history_nr]
    errors_ss = [abs(x - x_ss) for x in history_ss]

    ax2.semilogy(iter_nr, errors_nr, marker='o', linewidth=2.5,
                 markersize=7, color='#e74c3c', label='Newton-Raphson')
    ax2.semilogy(iter_ss, errors_ss, marker='s', linewidth=2.5,
                 markersize=6, color='#3498db', alpha=0.7, label='é€æ¬¡ä»£å…¥æ³•')
    ax2.axhline(y=1e-6, color='green', linestyle='--', linewidth=2,
                label='åæŸåˆ¤å®šå€¤')
    ax2.set_xlabel('åå¾©å›æ•°', fontsize=12)
    ax2.set_ylabel('èª¤å·® (å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«)', fontsize=12)
    ax2.set_title('åæŸé€Ÿåº¦ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
    ax2.legend(fontsize=11)
    ax2.grid(alpha=0.3, which='both')

    plt.tight_layout()
    plt.show()


# å®Ÿè¡Œ
demonstrate_newton_raphson()
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
Newton-Raphsonæ³•ã«ã‚ˆã‚‹åæŸåŠ é€Ÿ
============================================================

ãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ—ãƒ­ã‚»ã‚¹ã®åæŸè¨ˆç®—
åˆæœŸæ¨å®šå€¤: x_recycle = 0.5

--- Newton-Raphsonæ³• ---
åæŸæˆåŠŸ: 4å›ã®åå¾©ã§åæŸ

--- é€æ¬¡ä»£å…¥æ³•ï¼ˆæ¯”è¼ƒï¼‰ ---
åæŸæˆåŠŸ: 11å›ã®åå¾©ã§åæŸ

åæŸè§£ã®æ¯”è¼ƒ:
  Newton-Raphson: x = 0.245902, åå¾©å›æ•° = 4
  é€æ¬¡ä»£å…¥æ³•: x = 0.245902, åå¾©å›æ•° = 11
  åŠ é€Ÿç‡: 2.75å€
</code></pre>

<p><strong>è§£èª¬:</strong> Newton-Raphsonæ³•ã¯ã€é€æ¬¡ä»£å…¥æ³•ã«æ¯”ã¹ã¦åæŸãŒé€Ÿãã€2æ¬¡åæŸæ€§ã‚’æŒã¡ã¾ã™ã€‚ãƒ¤ã‚³ãƒ“ã‚¢ãƒ³ï¼ˆå°é–¢æ•°ï¼‰ã®è¨ˆç®—ãŒå¿…è¦ã§ã™ãŒã€å¤§å¹…ãªè¨ˆç®—æ™‚é–“çŸ­ç¸®ãŒå¯èƒ½ã§ã™ã€‚</p>

<hr />

<h2>1.4 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><strong>ãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®2ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</strong>
<ul>
<li>Sequential Modularæ³•: ãƒ¦ãƒ‹ãƒƒãƒˆæ“ä½œã‚’é †ç•ªã«è¨ˆç®—ï¼ˆç›´æ„Ÿçš„ï¼‰</li>
<li>Equation-Orientedæ³•: å…¨æ–¹ç¨‹å¼ã‚’åŒæ™‚ã«è§£ãï¼ˆé«˜é€Ÿï¼‰</li>
</ul>
</li>
<li><strong>ç†±åŠ›å­¦ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…</strong>
<ul>
<li>ç†æƒ³æ°—ä½“ãƒ¢ãƒ‡ãƒ«: ä½åœ§ãƒ»é«˜æ¸©ã®æ°—ä½“</li>
<li>SRKçŠ¶æ…‹æ–¹ç¨‹å¼: é«˜åœ§ã®ç‚­åŒ–æ°´ç´ ç³»</li>
<li>Peng-RobinsonçŠ¶æ…‹æ–¹ç¨‹å¼: ã‚ˆã‚Šé«˜ç²¾åº¦ã€æ¶²ç›¸ã«ã‚‚é©ç”¨å¯èƒ½</li>
</ul>
</li>
<li><strong>ã‚¹ãƒˆãƒªãƒ¼ãƒ ç‰©æ€§è¨ˆç®—</strong>
<ul>
<li>åœ§ç¸®ç‡å› å­ã€ãƒ¢ãƒ«ä½“ç©ã€å¯†åº¦ã®è¨ˆç®—</li>
<li>ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®è¨ˆç®—</li>
<li>ãƒ•ã‚¬ã‚·ãƒ†ã‚£ä¿‚æ•°ã®è¨ˆç®—</li>
</ul>
</li>
<li><strong>ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—</strong>
<ul>
<li>Rachford-Riceæ–¹ç¨‹å¼ã«ã‚ˆã‚‹æ°—æ¶²å¹³è¡¡è¨ˆç®—</li>
<li>æ°—ç›¸ãƒ»æ¶²ç›¸çµ„æˆã®æ±ºå®š</li>
</ul>
</li>
<li><strong>åæŸè¨ˆç®—ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong>
<ul>
<li>é€æ¬¡ä»£å…¥æ³•: å˜ç´”ã ãŒåæŸãŒé…ã„</li>
<li>Newton-Raphsonæ³•: 2æ¬¡åæŸã§é«˜é€Ÿ</li>
</ul>
</li>
</ol>

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

<ul>
<li>Sequential Modularæ³•ã¯ç›´æ„Ÿçš„ã ãŒã€ãƒªã‚µã‚¤ã‚¯ãƒ«ãƒ«ãƒ¼ãƒ—ã§åæŸè¨ˆç®—ãŒå¿…è¦</li>
<li>ç†±åŠ›å­¦ãƒ¢ãƒ‡ãƒ«ã®é¸æŠã¯ã€åœ§åŠ›ãƒ»æ¸©åº¦ç¯„å›²ã¨æˆåˆ†ç‰¹æ€§ã«ä¾å­˜ã™ã‚‹</li>
<li>ãƒ•ãƒ©ãƒƒã‚·ãƒ¥è¨ˆç®—ã¯ã€æ°—æ¶²åˆ†é›¢å™¨ã‚„è’¸ç•™å¡”ã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã«ä¸å¯æ¬ </li>
<li>åæŸè¨ˆç®—ã§ã¯ã€Newton-Raphsonæ³•ã«ã‚ˆã‚Šå¤§å¹…ãªé«˜é€ŸåŒ–ãŒå¯èƒ½</li>
<li>å®Ÿè£…æ™‚ã¯ã€ç‰©è³ªåæ”¯ã®ä¿å­˜ã‚’å¿…ãšç¢ºèªã™ã‚‹</li>
</ul>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬2ç« ã§ã¯ã€<strong>å˜ä½æ“ä½œãƒ¢ãƒ‡ãƒªãƒ³ã‚°</strong>ã‚’è©³ã—ãå­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>ç†±äº¤æ›å™¨ï¼ˆLMTDæ³•ã€NTU-Îµæ³•ï¼‰</li>
<li>åå¿œå™¨ï¼ˆCSTRã€PFRã€åå¿œé€Ÿåº¦å¼ï¼‰</li>
<li>åˆ†é›¢æ“ä½œï¼ˆãƒ•ãƒ©ãƒƒã‚·ãƒ¥ãƒ‰ãƒ©ãƒ ã€è’¸ç•™å¡”ï¼‰</li>
<li>ãƒãƒ³ãƒ—ã€ãƒŸã‚­ã‚µãƒ¼ã€ã‚¹ãƒ—ãƒªãƒƒã‚¿ãƒ¼ã®å®Ÿè£…</li>
</ul>

<div class="navigation">
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-2.html" class="nav-button">æ¬¡ã®ç«  â†’</a>
</div>
    </main>


    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: PI Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-26</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 PI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
