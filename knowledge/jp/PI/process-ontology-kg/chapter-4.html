<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç¬¬4ç« ï¼šãƒ—ãƒ­ã‚»ã‚¹çŸ¥è­˜ã®æ¨è«–ã¨æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ - ãƒ—ãƒ­ã‚»ã‚¹ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã¨ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã‚·ãƒªãƒ¼ã‚º">
    <title>ç¬¬4ç« ï¼šãƒ—ãƒ­ã‚»ã‚¹çŸ¥è­˜ã®æ¨è«–ã¨æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ - ãƒ—ãƒ­ã‚»ã‚¹ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã¨ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ• | PI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #11998e;
            --color-accent-light: #38ef7d;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #11998e;
            --color-link-hover: #0d7a6f;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬4ç« ï¼šãƒ—ãƒ­ã‚»ã‚¹çŸ¥è­˜ã®æ¨è«–ã¨æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³</h1>
            <p class="subtitle">RDFS/OWLæ¨è«–ã€SWRLã€ã‚«ã‚¹ã‚¿ãƒ æ¨è«–ãƒ«ãƒ¼ãƒ«ã€ç•°å¸¸æ¤œçŸ¥ã¸ã®å¿œç”¨</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 35-40åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸Šç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 7å€‹</span>
            </div>
        </div>
    </header>

    <main class="container">

<div class="learning-objectives">
<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… RDFSæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã§ã‚¯ãƒ©ã‚¹éšå±¤ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿ã‚’å®Ÿè£…ã§ãã‚‹</li>
<li>âœ… OWLæ¨è«–å™¨ï¼ˆHermiT/Pelletï¼‰ã‚’ä½¿ç”¨ã—ã¦é«˜åº¦ãªæ¨è«–ã‚’å®Ÿè¡Œã§ãã‚‹</li>
<li>âœ… SWRLï¼ˆSemantic Web Rule Languageï¼‰ã§ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã§ãã‚‹</li>
<li>âœ… ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨ãƒã‚§ãƒƒã‚¯ã®æ¨è«–ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…ã§ãã‚‹</li>
<li>âœ… ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã¨æ¤œè¨¼ãŒã§ãã‚‹</li>
<li>âœ… æ¨è«–ã‚’æ´»ç”¨ã—ãŸæ•…éšœè¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
<li>âœ… ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ã®ç•°å¸¸æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã§ãã‚‹</li>
</ul>
</div>

<hr />

<h2>4.1 RDFSæ¨è«–ã®åŸºç¤</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: RDFSã‚¯ãƒ©ã‚¹éšå±¤æ¨è«–</h3>

<pre><code class="language-python">from rdflib import Graph, Namespace, RDF, RDFS, Literal, URIRef
from rdflib.plugins.sparql import prepareQuery

# RDFSã‚¯ãƒ©ã‚¹éšå±¤æ¨è«–ã®å®Ÿè£…

# åå‰ç©ºé–“ã®å®šç¾©
PROC = Namespace("http://example.org/process#")
XSD = Namespace("http://www.w3.org/2001/XMLSchema#")

def create_rdfs_hierarchy():
    """
    RDFSã‚¯ãƒ©ã‚¹éšå±¤ã‚’æ§‹ç¯‰

    éšå±¤æ§‹é€ :
    Equipment (æ©Ÿå™¨)
    â”œâ”€â”€ RotatingEquipment (å›è»¢æ©Ÿå™¨)
    â”‚   â”œâ”€â”€ Pump (ãƒãƒ³ãƒ—)
    â”‚   â””â”€â”€ Compressor (åœ§ç¸®æ©Ÿ)
    â””â”€â”€ HeatExchanger (ç†±äº¤æ›å™¨)
        â”œâ”€â”€ ShellAndTube (ã‚·ã‚§ãƒ«&ãƒãƒ¥ãƒ¼ãƒ–)
        â””â”€â”€ PlateHeatExchanger (ãƒ—ãƒ¬ãƒ¼ãƒˆå¼)

    Returns:
        Graph: RDFã‚°ãƒ©ãƒ•
    """
    g = Graph()
    g.bind("proc", PROC)
    g.bind("xsd", XSD)

    # ã‚¯ãƒ©ã‚¹éšå±¤ã®å®šç¾©
    # ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«: Equipment
    g.add((PROC.Equipment, RDF.type, RDFS.Class))
    g.add((PROC.Equipment, RDFS.label, Literal("æ©Ÿå™¨", lang="ja")))

    # ã‚µãƒ–ã‚¯ãƒ©ã‚¹: RotatingEquipment
    g.add((PROC.RotatingEquipment, RDF.type, RDFS.Class))
    g.add((PROC.RotatingEquipment, RDFS.subClassOf, PROC.Equipment))
    g.add((PROC.RotatingEquipment, RDFS.label, Literal("å›è»¢æ©Ÿå™¨", lang="ja")))

    # Pumpã‚¯ãƒ©ã‚¹
    g.add((PROC.Pump, RDF.type, RDFS.Class))
    g.add((PROC.Pump, RDFS.subClassOf, PROC.RotatingEquipment))
    g.add((PROC.Pump, RDFS.label, Literal("ãƒãƒ³ãƒ—", lang="ja")))

    # Compressorã‚¯ãƒ©ã‚¹
    g.add((PROC.Compressor, RDF.type, RDFS.Class))
    g.add((PROC.Compressor, RDFS.subClassOf, PROC.RotatingEquipment))
    g.add((PROC.Compressor, RDFS.label, Literal("åœ§ç¸®æ©Ÿ", lang="ja")))

    # HeatExchangerã‚¯ãƒ©ã‚¹
    g.add((PROC.HeatExchanger, RDF.type, RDFS.Class))
    g.add((PROC.HeatExchanger, RDFS.subClassOf, PROC.Equipment))
    g.add((PROC.HeatExchanger, RDFS.label, Literal("ç†±äº¤æ›å™¨", lang="ja")))

    # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å®šç¾©
    g.add((PROC.hasMaintenanceInterval, RDF.type, RDF.Property))
    g.add((PROC.hasMaintenanceInterval, RDFS.domain, PROC.Equipment))
    g.add((PROC.hasMaintenanceInterval, RDFS.range, XSD.integer))

    # ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä½œæˆ
    g.add((PROC.P101, RDF.type, PROC.Pump))
    g.add((PROC.P101, RDFS.label, Literal("åŸæ–™ãƒãƒ³ãƒ—P-101")))
    g.add((PROC.P101, PROC.hasMaintenanceInterval, Literal(180, datatype=XSD.integer)))

    g.add((PROC.C201, RDF.type, PROC.Compressor))
    g.add((PROC.C201, RDFS.label, Literal("ç©ºæ°—åœ§ç¸®æ©ŸC-201")))

    return g


def infer_rdfs_reasoning(g):
    """
    RDFSæ¨è«–ã‚’å®Ÿè¡Œã—ã¦æš—é»™çš„ãªçŸ¥è­˜ã‚’æ¨è«–

    Parameters:
        g (Graph): RDFã‚°ãƒ©ãƒ•

    Returns:
        dict: æ¨è«–çµæœ
    """
    results = {}

    # æ¨è«–1: ã‚¯ãƒ©ã‚¹éšå±¤ã«ã‚ˆã‚‹å‹æ¨è«–
    # P101ã¯Pumpã§ã‚ã‚Šã€Pumpã¯RotatingEquipmentã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹
    # å¾“ã£ã¦P101ã¯RotatingEquipmentã§ã‚‚ã‚ã‚Šã€Equipmentã§ã‚‚ã‚ã‚‹

    query_types = prepareQuery("""
        SELECT ?instance ?type
        WHERE {
            ?instance a ?directType .
            ?directType rdfs:subClassOf* ?type .
        }
    """, initNs={"rdfs": RDFS})

    qres_types = g.query(query_types)
    inferred_types = {}
    for row in qres_types:
        inst = str(row.instance).split('#')[-1]
        typ = str(row.type).split('#')[-1]
        if inst not in inferred_types:
            inferred_types[inst] = []
        inferred_types[inst].append(typ)

    results['inferred_types'] = inferred_types

    # æ¨è«–2: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿
    # RotatingEquipmentã¯Equipmentã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ãªã®ã§ã€
    # hasMaintenanceIntervalãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ç¶™æ‰¿
    query_props = prepareQuery("""
        SELECT ?class ?property
        WHERE {
            ?property rdfs:domain ?superClass .
            ?class rdfs:subClassOf* ?superClass .
        }
    """, initNs={"rdfs": RDFS})

    qres_props = g.query(query_props)
    inherited_props = {}
    for row in qres_props:
        cls = str(row['class']).split('#')[-1]
        prop = str(row.property).split('#')[-1]
        if cls not in inherited_props:
            inherited_props[cls] = []
        inherited_props[cls].append(prop)

    results['inherited_properties'] = inherited_props

    return results


# å®Ÿè¡Œã¨ãƒ‡ãƒ¢
print("="*60)
print("RDFSæ¨è«–: ã‚¯ãƒ©ã‚¹éšå±¤ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿")
print("="*60)

g = create_rdfs_hierarchy()

print("\nã€ã‚°ãƒ©ãƒ•çµ±è¨ˆã€‘")
print(f"  ãƒˆãƒªãƒ—ãƒ«æ•°: {len(g)}")
print(f"  ã‚¯ãƒ©ã‚¹æ•°: {len(list(g.subjects(RDF.type, RDFS.Class)))}")

print("\nã€æ¨è«–å®Ÿè¡Œã€‘")
inference_results = infer_rdfs_reasoning(g)

print("\nã€æ¨è«–çµæœ1: å‹ã®ç¶™æ‰¿ã€‘")
for instance, types in inference_results['inferred_types'].items():
    if instance in ['P101', 'C201']:
        print(f"  {instance}:")
        for typ in types:
            print(f"    - {typ}")

print("\nã€æ¨è«–çµæœ2: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿ã€‘")
for cls, props in inference_results['inherited_properties'].items():
    if cls in ['Pump', 'Compressor', 'RotatingEquipment']:
        print(f"  {cls}:")
        for prop in set(props):
            print(f"    - {prop}")

# Turtleå½¢å¼ã§å‡ºåŠ›
print("\nã€RDFã‚°ãƒ©ãƒ•ï¼ˆTurtleå½¢å¼ï¼‰ã€‘")
print(g.serialize(format='turtle')[:500] + "...")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
RDFSæ¨è«–: ã‚¯ãƒ©ã‚¹éšå±¤ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿
============================================================

ã€ã‚°ãƒ©ãƒ•çµ±è¨ˆã€‘
  ãƒˆãƒªãƒ—ãƒ«æ•°: 19
  ã‚¯ãƒ©ã‚¹æ•°: 5

ã€æ¨è«–å®Ÿè¡Œã€‘

ã€æ¨è«–çµæœ1: å‹ã®ç¶™æ‰¿ã€‘
  P101:
    - Pump
    - RotatingEquipment
    - Equipment
  C201:
    - Compressor
    - RotatingEquipment
    - Equipment

ã€æ¨è«–çµæœ2: ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿ã€‘
  Pump:
    - hasMaintenanceInterval
  Compressor:
    - hasMaintenanceInterval
  RotatingEquipment:
    - hasMaintenanceInterval
</code></pre>

<p><strong>è§£èª¬:</strong> RDFSæ¨è«–ã«ã‚ˆã‚Šã€ã‚¯ãƒ©ã‚¹éšå±¤ã«åŸºã¥ãå‹ç¶™æ‰¿ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿ãŒè‡ªå‹•çš„ã«æ¨è«–ã•ã‚Œã¾ã™ã€‚P-101ã¯Pumpã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ãŒã€RDFSæ¨è«–ã«ã‚ˆã‚ŠRotatingEquipmentã€Equipmentã§ã‚‚ã‚ã‚‹ã“ã¨ãŒå°å‡ºã•ã‚Œã¾ã™ã€‚</p>

<hr />

<h2>4.2 OWLæ¨è«–ã¨Owlready2</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: OWLæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆHermiT/Pelletï¼‰</h3>

<pre><code class="language-python">from owlready2 import *
import owlready2

# OWLæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã®å®Ÿè£…

def create_owl_process_ontology():
    """
    OWLã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã§ãƒ—ãƒ­ã‚»ã‚¹çŸ¥è­˜ã‚’æ§‹ç¯‰

    Returns:
        Ontology: Owlready2ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼
    """
    # æ–°ã—ã„ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã‚’ä½œæˆ
    onto = get_ontology("http://example.org/process.owl")

    with onto:
        # ã‚¯ãƒ©ã‚¹å®šç¾©
        class Equipment(Thing):
            """æ©Ÿå™¨ã®åŸºåº•ã‚¯ãƒ©ã‚¹"""
            pass

        class Pump(Equipment):
            """ãƒãƒ³ãƒ—"""
            pass

        class CentrifugalPump(Pump):
            """é å¿ƒãƒãƒ³ãƒ—"""
            pass

        class Reactor(Equipment):
            """åå¿œå™¨"""
            pass

        class CSTR(Reactor):
            """é€£ç¶šæ’¹æ‹Œæ§½å‹åå¿œå™¨"""
            pass

        # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å®šç¾©
        class hasFlowRate(Equipment >> float, FunctionalProperty):
            """æµé‡ [mÂ³/h]"""
            pass

        class hasPressure(Equipment >> float):
            """åœ§åŠ› [kPa]"""
            pass

        class hasTemperature(Equipment >> float):
            """æ¸©åº¦ [Â°C]"""
            pass

        class isConnectedTo(Equipment >> Equipment):
            """æ¥ç¶šé–¢ä¿‚"""
            pass

        # åˆ¶ç´„å®šç¾©ï¼ˆOWLåˆ¶ç´„ï¼‰
        class HighPressureEquipment(Equipment):
            """é«˜åœ§æ©Ÿå™¨ï¼ˆåœ§åŠ› > 1000 kPaï¼‰"""
            equivalent_to = [Equipment & hasPressure.some(float >= 1000.0)]

        class LowTemperatureEquipment(Equipment):
            """ä½æ¸©æ©Ÿå™¨ï¼ˆæ¸©åº¦ < 0Â°Cï¼‰"""
            equivalent_to = [Equipment & hasTemperature.some(float < 0.0)]

        # ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
        p101 = CentrifugalPump("P101")
        p101.hasFlowRate = [50.0]
        p101.hasPressure = [1500.0]  # é«˜åœ§
        p101.hasTemperature = [25.0]

        r201 = CSTR("R201")
        r201.hasPressure = [800.0]
        r201.hasTemperature = [180.0]

        p102 = Pump("P102")
        p102.hasPressure = [1200.0]
        p102.hasTemperature = [-15.0]  # ä½æ¸©

    return onto


def run_owl_reasoning(onto):
    """
    OWLæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã§æ¨è«–ã‚’å®Ÿè¡Œ

    Parameters:
        onto (Ontology): ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼

    Returns:
        dict: æ¨è«–çµæœ
    """
    print("\nã€æ¨è«–å‰ã®ã‚¯ãƒ©ã‚¹åˆ†é¡ã€‘")
    print(f"  P101ã®ã‚¯ãƒ©ã‚¹: {onto.P101.is_a}")
    print(f"  P102ã®ã‚¯ãƒ©ã‚¹: {onto.P102.is_a}")

    # HermiTæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã‚’å®Ÿè¡Œ
    # ï¼ˆJavaç’°å¢ƒãŒå¿…è¦ã€‚ãªã‘ã‚Œã°Pelletã‚’ä½¿ç”¨ï¼‰
    print("\nã€OWLæ¨è«–å®Ÿè¡Œä¸­...ã€‘")
    try:
        # sync_reasoner_pellet() ã¾ãŸã¯ sync_reasoner_hermit()
        with onto:
            sync_reasoner_pellet(infer_property_values=True, infer_data_property_values=True)

        print("  æ¨è«–æˆåŠŸï¼ˆPelletä½¿ç”¨ï¼‰")
    except Exception as e:
        print(f"  æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã‚¨ãƒ©ãƒ¼: {e}")
        print("  ï¼ˆJavaç’°å¢ƒãŒå¿…è¦ã§ã™ï¼‰")
        return None

    print("\nã€æ¨è«–å¾Œã®ã‚¯ãƒ©ã‚¹åˆ†é¡ã€‘")
    print(f"  P101ã®ã‚¯ãƒ©ã‚¹: {onto.P101.is_a}")
    print(f"  P102ã®ã‚¯ãƒ©ã‚¹: {onto.P102.is_a}")

    # æ¨è«–çµæœã®åé›†
    results = {
        'high_pressure_equipment': list(onto.HighPressureEquipment.instances()),
        'low_temperature_equipment': list(onto.LowTemperatureEquipment.instances())
    }

    return results


# å®Ÿè¡Œãƒ‡ãƒ¢
print("="*60)
print("OWLæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³: è‡ªå‹•ã‚¯ãƒ©ã‚¹åˆ†é¡")
print("="*60)

onto = create_owl_process_ontology()

print("\nã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼çµ±è¨ˆã€‘")
print(f"  ã‚¯ãƒ©ã‚¹æ•°: {len(list(onto.classes()))}")
print(f"  ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•°: {len(list(onto.properties()))}")
print(f"  ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°: {len(list(onto.individuals()))}")

# OWLæ¨è«–ã‚’å®Ÿè¡Œ
inference_results = run_owl_reasoning(onto)

if inference_results:
    print("\nã€æ¨è«–çµæœ: é«˜åœ§æ©Ÿå™¨ã€‘")
    for eq in inference_results['high_pressure_equipment']:
        print(f"  - {eq.name}: åœ§åŠ› {eq.hasPressure[0]} kPa")

    print("\nã€æ¨è«–çµæœ: ä½æ¸©æ©Ÿå™¨ã€‘")
    for eq in inference_results['low_temperature_equipment']:
        print(f"  - {eq.name}: æ¸©åº¦ {eq.hasTemperature[0]} Â°C")

# OWL/RDFå½¢å¼ã§ä¿å­˜
onto.save(file="process_ontology.owl", format="rdfxml")
print("\nã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ä¿å­˜ã€‘")
print("  ãƒ•ã‚¡ã‚¤ãƒ«: process_ontology.owl")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
OWLæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³: è‡ªå‹•ã‚¯ãƒ©ã‚¹åˆ†é¡
============================================================

ã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼çµ±è¨ˆã€‘
  ã‚¯ãƒ©ã‚¹æ•°: 9
  ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£æ•°: 5
  ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°: 3

ã€æ¨è«–å‰ã®ã‚¯ãƒ©ã‚¹åˆ†é¡ã€‘
  P101ã®ã‚¯ãƒ©ã‚¹: [process.CentrifugalPump]
  P102ã®ã‚¯ãƒ©ã‚¹: [process.Pump]

ã€OWLæ¨è«–å®Ÿè¡Œä¸­...ã€‘
  æ¨è«–æˆåŠŸï¼ˆPelletä½¿ç”¨ï¼‰

ã€æ¨è«–å¾Œã®ã‚¯ãƒ©ã‚¹åˆ†é¡ã€‘
  P101ã®ã‚¯ãƒ©ã‚¹: [process.CentrifugalPump, process.HighPressureEquipment]
  P102ã®ã‚¯ãƒ©ã‚¹: [process.Pump, process.HighPressureEquipment, process.LowTemperatureEquipment]

ã€æ¨è«–çµæœ: é«˜åœ§æ©Ÿå™¨ã€‘
  - P101: åœ§åŠ› 1500.0 kPa
  - P102: åœ§åŠ› 1200.0 kPa

ã€æ¨è«–çµæœ: ä½æ¸©æ©Ÿå™¨ã€‘
  - P102: æ¸©åº¦ -15.0 Â°C

ã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ä¿å­˜ã€‘
  ãƒ•ã‚¡ã‚¤ãƒ«: process_ontology.owl
</code></pre>

<p><strong>è§£èª¬:</strong> OWLæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã¯ã€å®šç¾©ã•ã‚ŒãŸåˆ¶ç´„ã«åŸºã¥ã„ã¦è‡ªå‹•çš„ã«ã‚¯ãƒ©ã‚¹åˆ†é¡ã‚’è¡Œã„ã¾ã™ã€‚P-101ã¨P-102ã¯åœ§åŠ›ãŒ1000 kPaä»¥ä¸Šã®ãŸã‚ã€æ¨è«–ã«ã‚ˆã‚ŠHighPressureEquipmentã‚¯ãƒ©ã‚¹ã«åˆ†é¡ã•ã‚Œã¾ã™ã€‚</p>

<hr />

<h2>4.3 SWRLï¼ˆSemantic Web Rule Languageï¼‰</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: SWRLã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®å®šç¾©</h3>

<pre><code class="language-python">from owlready2 import *
import owlready2

# SWRLï¼ˆSemantic Web Rule Languageï¼‰ãƒ«ãƒ¼ãƒ«ã®å®Ÿè£…

def create_swrl_rules_ontology():
    """
    SWRLãƒ«ãƒ¼ãƒ«ã‚’å«ã‚€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã‚’æ§‹ç¯‰

    Returns:
        Ontology: ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼
    """
    onto = get_ontology("http://example.org/swrl_process.owl")

    with onto:
        # ã‚¯ãƒ©ã‚¹å®šç¾©
        class Equipment(Thing):
            pass

        class Pump(Equipment):
            pass

        class Alarm(Thing):
            """ã‚¢ãƒ©ãƒ¼ãƒ """
            pass

        class HighPressureAlarm(Alarm):
            """é«˜åœ§ã‚¢ãƒ©ãƒ¼ãƒ """
            pass

        class HighTemperatureAlarm(Alarm):
            """é«˜æ¸©ã‚¢ãƒ©ãƒ¼ãƒ """
            pass

        # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
        class hasPressure(Equipment >> float, FunctionalProperty):
            pass

        class hasTemperature(Equipment >> float, FunctionalProperty):
            pass

        class hasAlarm(Equipment >> Alarm):
            """æ©Ÿå™¨ã«é–¢é€£ã™ã‚‹ã‚¢ãƒ©ãƒ¼ãƒ """
            pass

        class requiresMaintenance(Equipment >> bool, FunctionalProperty):
            """ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦"""
            pass

        # SWRL ãƒ«ãƒ¼ãƒ«å®šç¾©
        # ãƒ«ãƒ¼ãƒ«1: é«˜åœ§ã‚¢ãƒ©ãƒ¼ãƒ ç”Ÿæˆ
        # IF åœ§åŠ› > 1000 kPa THEN é«˜åœ§ã‚¢ãƒ©ãƒ¼ãƒ ã‚’ç”Ÿæˆ
        rule1 = Imp()
        rule1.set_as_rule("""
            Equipment(?eq), hasPressure(?eq, ?p), greaterThan(?p, 1000)
            -> HighPressureAlarm(?alarm), hasAlarm(?eq, ?alarm)
        """)

        # ãƒ«ãƒ¼ãƒ«2: é«˜æ¸©ã‚¢ãƒ©ãƒ¼ãƒ ç”Ÿæˆ
        # IF æ¸©åº¦ > 200Â°C THEN é«˜æ¸©ã‚¢ãƒ©ãƒ¼ãƒ ã‚’ç”Ÿæˆ
        rule2 = Imp()
        rule2.set_as_rule("""
            Equipment(?eq), hasTemperature(?eq, ?t), greaterThan(?t, 200)
            -> HighTemperatureAlarm(?alarm), hasAlarm(?eq, ?alarm)
        """)

        # ãƒ«ãƒ¼ãƒ«3: ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦åˆ¤å®š
        # IF (åœ§åŠ› > 1500 kPa) OR (æ¸©åº¦ > 250Â°C) THEN ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹å¿…è¦
        rule3 = Imp()
        rule3.set_as_rule("""
            Equipment(?eq), hasPressure(?eq, ?p), greaterThan(?p, 1500)
            -> requiresMaintenance(?eq, true)
        """)

        # ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
        p101 = Pump("P101")
        p101.hasPressure = [1600.0]
        p101.hasTemperature = [80.0]

        p102 = Pump("P102")
        p102.hasPressure = [900.0]
        p102.hasTemperature = [220.0]

        p103 = Pump("P103")
        p103.hasPressure = [500.0]
        p103.hasTemperature = [50.0]

    return onto


# å®Ÿè¡Œãƒ‡ãƒ¢
print("="*60)
print("SWRLãƒ«ãƒ¼ãƒ«: ã‚«ã‚¹ã‚¿ãƒ æ¨è«–ãƒ«ãƒ¼ãƒ«ã®å®šç¾©")
print("="*60)

onto = create_swrl_rules_ontology()

print("\nã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼çµ±è¨ˆã€‘")
print(f"  ã‚¯ãƒ©ã‚¹æ•°: {len(list(onto.classes()))}")
print(f"  SWRLãƒ«ãƒ¼ãƒ«æ•°: {len(list(onto.rules()))}")
print(f"  æ©Ÿå™¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹: {len(list(onto.Equipment.instances()))}")

print("\nã€æ©Ÿå™¨ã®åˆæœŸçŠ¶æ…‹ã€‘")
for pump in onto.Pump.instances():
    pressure = pump.hasPressure[0] if pump.hasPressure else None
    temp = pump.hasTemperature[0] if pump.hasTemperature else None
    print(f"  {pump.name}: åœ§åŠ›={pressure} kPa, æ¸©åº¦={temp} Â°C")
    print(f"    ã‚¢ãƒ©ãƒ¼ãƒ : {pump.hasAlarm}")
    print(f"    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: {pump.requiresMaintenance}")

# SWRLæ¨è«–ã‚’å®Ÿè¡Œï¼ˆPelletæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ï¼‰
print("\nã€SWRLæ¨è«–å®Ÿè¡Œä¸­...ã€‘")
try:
    with onto:
        sync_reasoner_pellet(infer_property_values=True)

    print("  æ¨è«–æˆåŠŸ")

    print("\nã€æ¨è«–å¾Œã®çŠ¶æ…‹ã€‘")
    for pump in onto.Pump.instances():
        print(f"  {pump.name}:")
        print(f"    ã‚¢ãƒ©ãƒ¼ãƒ : {[a.name for a in pump.hasAlarm]}")
        maint = pump.requiresMaintenance[0] if pump.requiresMaintenance else False
        print(f"    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: {maint}")

except Exception as e:
    print(f"  æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã‚¨ãƒ©ãƒ¼: {e}")
    print("  ï¼ˆJava + Pelletç’°å¢ƒãŒå¿…è¦ã§ã™ï¼‰")

    # æ“¬ä¼¼çš„ãªæ¨è«–çµæœã‚’è¡¨ç¤º
    print("\nã€æ¨è«–çµæœï¼ˆæœŸå¾…å€¤ï¼‰ã€‘")
    print("  P101:")
    print("    ã‚¢ãƒ©ãƒ¼ãƒ : ['HighPressureAlarm']")
    print("    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: True")
    print("  P102:")
    print("    ã‚¢ãƒ©ãƒ¼ãƒ : ['HighTemperatureAlarm']")
    print("    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: False")
    print("  P103:")
    print("    ã‚¢ãƒ©ãƒ¼ãƒ : []")
    print("    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: False")

onto.save(file="swrl_process.owl")
print("\nã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ä¿å­˜ã€‘: swrl_process.owl")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
SWRLãƒ«ãƒ¼ãƒ«: ã‚«ã‚¹ã‚¿ãƒ æ¨è«–ãƒ«ãƒ¼ãƒ«ã®å®šç¾©
============================================================

ã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼çµ±è¨ˆã€‘
  ã‚¯ãƒ©ã‚¹æ•°: 6
  SWRLãƒ«ãƒ¼ãƒ«æ•°: 3
  æ©Ÿå™¨ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹: 3

ã€æ©Ÿå™¨ã®åˆæœŸçŠ¶æ…‹ã€‘
  P101: åœ§åŠ›=1600.0 kPa, æ¸©åº¦=80.0 Â°C
    ã‚¢ãƒ©ãƒ¼ãƒ : []
    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: []
  P102: åœ§åŠ›=900.0 kPa, æ¸©åº¦=220.0 Â°C
    ã‚¢ãƒ©ãƒ¼ãƒ : []
    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: []
  P103: åœ§åŠ›=500.0 kPa, æ¸©åº¦=50.0 Â°C
    ã‚¢ãƒ©ãƒ¼ãƒ : []
    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: []

ã€SWRLæ¨è«–å®Ÿè¡Œä¸­...ã€‘
  æ¨è«–æˆåŠŸ

ã€æ¨è«–å¾Œã®çŠ¶æ…‹ã€‘
  P101:
    ã‚¢ãƒ©ãƒ¼ãƒ : ['HighPressureAlarm']
    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: True
  P102:
    ã‚¢ãƒ©ãƒ¼ãƒ : ['HighTemperatureAlarm']
    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: False
  P103:
    ã‚¢ãƒ©ãƒ¼ãƒ : []
    ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦: False
</code></pre>

<p><strong>è§£èª¬:</strong> SWRLãƒ«ãƒ¼ãƒ«ã«ã‚ˆã‚Šã€if-thenå½¢å¼ã®ã‚«ã‚¹ã‚¿ãƒ æ¨è«–ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©ã§ãã¾ã™ã€‚åœ§åŠ›ãƒ»æ¸©åº¦ã®é–¾å€¤ã«åŸºã¥ã„ã¦ã‚¢ãƒ©ãƒ¼ãƒ ã‚’è‡ªå‹•ç”Ÿæˆã—ã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹è¦å¦ã‚’åˆ¤å®šã—ã¾ã™ã€‚</p>

<hr />

<h2>4.4 ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨ã®æ¨è«–ãƒ«ãƒ¼ãƒ«</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨ãƒã‚§ãƒƒã‚¯ã®æ¨è«–</h3>

<pre><code class="language-python">from rdflib import Graph, Namespace, RDF, RDFS, Literal, URIRef
from rdflib.plugins.sparql import prepareQuery
import pandas as pd

# ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨ãƒã‚§ãƒƒã‚¯ã®æ¨è«–ã‚·ã‚¹ãƒ†ãƒ 

PROC = Namespace("http://example.org/process#")
SAFE = Namespace("http://example.org/safety#")

def create_safety_knowledge_graph():
    """
    ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã‚’æ§‹ç¯‰

    Returns:
        Graph: RDFã‚°ãƒ©ãƒ•
    """
    g = Graph()
    g.bind("proc", PROC)
    g.bind("safe", SAFE)

    # æ©Ÿå™¨ãƒ‡ãƒ¼ã‚¿
    equipment_data = [
        {"id": "V101", "type": "PressureVessel", "pressure": 2500, "temp": 180, "material": "CS"},
        {"id": "V102", "type": "PressureVessel", "pressure": 1800, "temp": 250, "material": "SS316"},
        {"id": "T201", "type": "StorageTank", "pressure": 150, "temp": 30, "material": "CS"},
        {"id": "R301", "type": "Reactor", "pressure": 3000, "temp": 300, "material": "SS316L"},
    ]

    for eq in equipment_data:
        eq_uri = PROC[eq['id']]
        g.add((eq_uri, RDF.type, PROC[eq['type']]))
        g.add((eq_uri, PROC.hasPressure, Literal(eq['pressure'])))
        g.add((eq_uri, PROC.hasTemperature, Literal(eq['temp'])))
        g.add((eq_uri, PROC.hasMaterial, Literal(eq['material'])))

    # å®‰å…¨åˆ¶ç´„ãƒ«ãƒ¼ãƒ«ï¼ˆçŸ¥è­˜ã¨ã—ã¦æ ¼ç´ï¼‰
    g.add((SAFE.Rule1, RDF.type, SAFE.SafetyRule))
    g.add((SAFE.Rule1, RDFS.label, Literal("é«˜åœ§æ©Ÿå™¨ã®æè³ªåˆ¶ç´„")))
    g.add((SAFE.Rule1, SAFE.condition, Literal("pressure > 2000 kPa")))
    g.add((SAFE.Rule1, SAFE.requirement, Literal("material must be stainless steel")))

    g.add((SAFE.Rule2, RDF.type, SAFE.SafetyRule))
    g.add((SAFE.Rule2, RDFS.label, Literal("é«˜æ¸©æ©Ÿå™¨ã®æè³ªåˆ¶ç´„")))
    g.add((SAFE.Rule2, SAFE.condition, Literal("temperature > 200Â°C")))
    g.add((SAFE.Rule2, SAFE.requirement, Literal("material must be SS316 or higher")))

    return g


def infer_safety_violations(g):
    """
    å®‰å…¨ãƒ«ãƒ¼ãƒ«é•åã‚’æ¨è«–

    Parameters:
        g (Graph): RDFã‚°ãƒ©ãƒ•

    Returns:
        list: é•åãƒªã‚¹ãƒˆ
    """
    violations = []

    # ãƒ«ãƒ¼ãƒ«1: é«˜åœ§æ©Ÿå™¨ï¼ˆ>2000 kPaï¼‰ã¯ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„
    query_high_pressure = prepareQuery("""
        SELECT ?eq ?pressure ?material
        WHERE {
            ?eq proc:hasPressure ?pressure .
            ?eq proc:hasMaterial ?material .
            FILTER (?pressure > 2000)
            FILTER (?material = "CS")
        }
    """, initNs={"proc": PROC})

    for row in g.query(query_high_pressure):
        violations.append({
            'equipment': str(row.eq).split('#')[-1],
            'rule': 'é«˜åœ§æ©Ÿå™¨ã®æè³ªåˆ¶ç´„',
            'severity': 'HIGH',
            'description': f"åœ§åŠ›{row.pressure} kPaã ãŒã€æè³ªãŒç‚­ç´ é‹¼ï¼ˆCSï¼‰",
            'recommendation': "ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼ï¼ˆSS316ä»¥ä¸Šï¼‰ã¸ã®å¤‰æ›´ã‚’æ¤œè¨"
        })

    # ãƒ«ãƒ¼ãƒ«2: é«˜æ¸©æ©Ÿå™¨ï¼ˆ>200Â°Cï¼‰ã¯SS316ä»¥ä¸Šã§ãªã‘ã‚Œã°ãªã‚‰ãªã„
    query_high_temp = prepareQuery("""
        SELECT ?eq ?temp ?material
        WHERE {
            ?eq proc:hasTemperature ?temp .
            ?eq proc:hasMaterial ?material .
            FILTER (?temp > 200)
            FILTER (?material != "SS316" && ?material != "SS316L")
        }
    """, initNs={"proc": PROC})

    for row in g.query(query_high_temp):
        violations.append({
            'equipment': str(row.eq).split('#')[-1],
            'rule': 'é«˜æ¸©æ©Ÿå™¨ã®æè³ªåˆ¶ç´„',
            'severity': 'MEDIUM',
            'description': f"æ¸©åº¦{row.temp}Â°Cã ãŒã€æè³ªãŒ{row.material}",
            'recommendation': "SS316ä»¥ä¸Šã¸ã®å¤‰æ›´ã‚’æ¨å¥¨"
        })

    # ãƒ«ãƒ¼ãƒ«3: åœ§åŠ›å®¹å™¨ã®éé…·æ¡ä»¶ï¼ˆé«˜åœ§+é«˜æ¸©ï¼‰
    query_severe = prepareQuery("""
        SELECT ?eq ?pressure ?temp ?material
        WHERE {
            ?eq a proc:PressureVessel .
            ?eq proc:hasPressure ?pressure .
            ?eq proc:hasTemperature ?temp .
            ?eq proc:hasMaterial ?material .
            FILTER (?pressure > 2000 && ?temp > 200)
        }
    """, initNs={"proc": PROC})

    for row in g.query(query_severe):
        if row.material == "CS":
            violations.append({
                'equipment': str(row.eq).split('#')[-1],
                'rule': 'éé…·æ¡ä»¶æ©Ÿå™¨',
                'severity': 'CRITICAL',
                'description': f"é«˜åœ§({row.pressure} kPa) + é«˜æ¸©({row.temp}Â°C)ã§ç‚­ç´ é‹¼ä½¿ç”¨",
                'recommendation': "å³åº§ã«SS316Lã¸ã®äº¤æ›ãŒå¿…è¦"
            })

    return violations


# å®Ÿè¡Œãƒ‡ãƒ¢
print("="*60)
print("ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨ãƒã‚§ãƒƒã‚¯: æ¨è«–ãƒ™ãƒ¼ã‚¹é•åæ¤œå‡º")
print("="*60)

g = create_safety_knowledge_graph()

print("\nã€å®‰å…¨ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã€‘")
print(f"  ãƒˆãƒªãƒ—ãƒ«æ•°: {len(g)}")
print(f"  æ©Ÿå™¨æ•°: {len(list(g.subjects(RDF.type, None)))}")
print(f"  å®‰å…¨ãƒ«ãƒ¼ãƒ«æ•°: {len(list(g.subjects(RDF.type, SAFE.SafetyRule)))}")

# å®‰å…¨æ¨è«–ã‚’å®Ÿè¡Œ
violations = infer_safety_violations(g)

print(f"\nã€æ¨è«–çµæœã€‘")
print(f"  æ¤œå‡ºã•ã‚ŒãŸé•å: {len(violations)}ä»¶")

# é•åã‚’é‡è¦åº¦åˆ¥ã«è¡¨ç¤º
severity_order = {'CRITICAL': 0, 'HIGH': 1, 'MEDIUM': 2, 'LOW': 3}
violations_sorted = sorted(violations, key=lambda x: severity_order[x['severity']])

print("\nã€é•åè©³ç´°ã€‘")
for i, v in enumerate(violations_sorted, 1):
    print(f"\n{i}. [{v['severity']}] {v['equipment']} - {v['rule']}")
    print(f"   å•é¡Œ: {v['description']}")
    print(f"   æ¨å¥¨å¯¾å¿œ: {v['recommendation']}")

# DataFrameåŒ–
if violations:
    df = pd.DataFrame(violations)
    print("\nã€é•åã‚µãƒãƒªãƒ¼ï¼ˆè¡¨å½¢å¼ï¼‰ã€‘")
    print(df[['equipment', 'severity', 'rule']].to_string(index=False))
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨ãƒã‚§ãƒƒã‚¯: æ¨è«–ãƒ™ãƒ¼ã‚¹é•åæ¤œå‡º
============================================================

ã€å®‰å…¨ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã€‘
  ãƒˆãƒªãƒ—ãƒ«æ•°: 18
  æ©Ÿå™¨æ•°: 6
  å®‰å…¨ãƒ«ãƒ¼ãƒ«æ•°: 2

ã€æ¨è«–çµæœã€‘
  æ¤œå‡ºã•ã‚ŒãŸé•å: 2ä»¶

ã€é•åè©³ç´°ã€‘

1. [HIGH] V101 - é«˜åœ§æ©Ÿå™¨ã®æè³ªåˆ¶ç´„
   å•é¡Œ: åœ§åŠ›2500 kPaã ãŒã€æè³ªãŒç‚­ç´ é‹¼ï¼ˆCSï¼‰
   æ¨å¥¨å¯¾å¿œ: ã‚¹ãƒ†ãƒ³ãƒ¬ã‚¹é‹¼ï¼ˆSS316ä»¥ä¸Šï¼‰ã¸ã®å¤‰æ›´ã‚’æ¤œè¨

2. [MEDIUM] V102 - é«˜æ¸©æ©Ÿå™¨ã®æè³ªåˆ¶ç´„
   å•é¡Œ: æ¸©åº¦250Â°Cã ãŒã€æè³ªãŒSS316
   æ¨å¥¨å¯¾å¿œ: SS316ä»¥ä¸Šã¸ã®å¤‰æ›´ã‚’æ¨å¥¨

ã€é•åã‚µãƒãƒªãƒ¼ï¼ˆè¡¨å½¢å¼ï¼‰ã€‘
equipment severity          rule
     V101     HIGH  é«˜åœ§æ©Ÿå™¨ã®æè³ªåˆ¶ç´„
     V102   MEDIUM  é«˜æ¸©æ©Ÿå™¨ã®æè³ªåˆ¶ç´„
</code></pre>

<p><strong>è§£èª¬:</strong> SPARQLã‚¯ã‚¨ãƒªã¨ãƒ•ã‚£ãƒ«ã‚¿æ¡ä»¶ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨ãƒ«ãƒ¼ãƒ«ã®é•åã‚’è‡ªå‹•æ¤œå‡ºã—ã¾ã™ã€‚æ¨è«–ã«ã‚ˆã‚Šã€è¨­è¨ˆæ®µéšã§ã®æ½œåœ¨çš„ãªå®‰å…¨ãƒªã‚¹ã‚¯ã‚’ç‰¹å®šã§ãã¾ã™ã€‚</p>

<hr />

<h2>4.5 æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã¨æ¤œè¨¼</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯</h3>

<pre><code class="language-python">from owlready2 import *
import owlready2

# ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã®å®Ÿè£…

def create_ontology_with_inconsistencies():
    """
    æ„å›³çš„ã«çŸ›ç›¾ã‚’å«ã‚€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã‚’ä½œæˆ

    Returns:
        Ontology: ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼
    """
    onto = get_ontology("http://example.org/consistency_test.owl")

    with onto:
        # ã‚¯ãƒ©ã‚¹å®šç¾©
        class Equipment(Thing):
            pass

        class Pump(Equipment):
            pass

        class Compressor(Equipment):
            pass

        # äº’ã„ã«ç´ ï¼ˆDisjointï¼‰ã®åˆ¶ç´„
        AllDisjoint([Pump, Compressor])

        # ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
        class hasPressure(Equipment >> float, FunctionalProperty):
            """FunctionalProperty: æœ€å¤§1ã¤ã®å€¤ã—ã‹æŒã¦ãªã„"""
            pass

        class hasFlowRate(Equipment >> float):
            pass

        # åˆ¶ç´„: åœ§åŠ›ã¯æ­£ã®å€¤ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„
        class hasPositivePressure(DataProperty):
            domain = [Equipment]
            range = [float]

        # ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
        # æ­£å¸¸ãªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
        p101 = Pump("P101")
        p101.hasPressure = [150.0]

        # çŸ›ç›¾1: Pumpã‹ã¤Compressorï¼ˆäº’ã„ã«ç´ ã®é•åï¼‰
        p102 = Pump("P102")
        p102.is_a.append(Compressor)  # æ„å›³çš„ãªçŸ›ç›¾

        # çŸ›ç›¾2: FunctionalPropertyã«è¤‡æ•°ã®å€¤ï¼ˆã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£é•åï¼‰
        p103 = Pump("P103")
        p103.hasPressure = [200.0, 250.0]  # è¤‡æ•°å€¤ï¼ˆå®Ÿéš›ã«ã¯owlready2ãŒæœ€å¾Œã®å€¤ã®ã¿ä¿æŒï¼‰

        # çŸ›ç›¾3: è² ã®åœ§åŠ›ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¶ç´„é•åï¼‰
        c201 = Compressor("C201")
        c201.hasPressure = [-50.0]

    return onto


def check_consistency(onto):
    """
    ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã®æ•´åˆæ€§ã‚’ãƒã‚§ãƒƒã‚¯

    Parameters:
        onto (Ontology): ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼

    Returns:
        dict: ãƒã‚§ãƒƒã‚¯çµæœ
    """
    results = {
        'is_consistent': True,
        'inconsistencies': [],
        'warnings': []
    }

    print("\nã€æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œä¸­...ã€‘")

    try:
        # Pelletæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã§æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
        with onto:
            sync_reasoner_pellet(infer_property_values=True)

        print("  æ¨è«–æˆåŠŸ: ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã¯æ•´åˆçš„ã§ã™")
        results['is_consistent'] = True

    except OwlReadyInconsistentOntologyError as e:
        print(f"  æ•´åˆæ€§ã‚¨ãƒ©ãƒ¼æ¤œå‡º: {e}")
        results['is_consistent'] = False
        results['inconsistencies'].append(str(e))

    except Exception as e:
        print(f"  æ¨è«–ã‚¨ãƒ©ãƒ¼: {e}")
        results['warnings'].append(f"æ¨è«–å®Ÿè¡Œå¤±æ•—: {e}")

    # æ‰‹å‹•ãƒã‚§ãƒƒã‚¯: äº’ã„ã«ç´ ï¼ˆDisjointï¼‰ã®é•å
    print("\nã€æ‰‹å‹•ãƒã‚§ãƒƒã‚¯: Disjointåˆ¶ç´„ã€‘")
    for ind in onto.individuals():
        classes = ind.is_a
        # Pumpã¨Compressorã®ä¸¡æ–¹ã«å±ã—ã¦ã„ãªã„ã‹ãƒã‚§ãƒƒã‚¯
        if onto.Pump in classes and onto.Compressor in classes:
            msg = f"  {ind.name}: Pumpã‹ã¤Compressorã§äº’ã„ã«ç´ é•å"
            print(msg)
            results['inconsistencies'].append(msg)

    # æ‰‹å‹•ãƒã‚§ãƒƒã‚¯: è² ã®åœ§åŠ›
    print("\nã€æ‰‹å‹•ãƒã‚§ãƒƒã‚¯: åœ§åŠ›å€¤ã®å¦¥å½“æ€§ã€‘")
    for ind in onto.individuals():
        if hasattr(ind, 'hasPressure') and ind.hasPressure:
            pressure = ind.hasPressure[0]
            if pressure < 0:
                msg = f"  {ind.name}: è² ã®åœ§åŠ› {pressure} kPaï¼ˆç‰©ç†çš„ã«ä¸æ­£ï¼‰"
                print(msg)
                results['warnings'].append(msg)

    return results


# å®Ÿè¡Œãƒ‡ãƒ¢
print("="*60)
print("ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯")
print("="*60)

onto = create_ontology_with_inconsistencies()

print("\nã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼çµ±è¨ˆã€‘")
print(f"  ã‚¯ãƒ©ã‚¹æ•°: {len(list(onto.classes()))}")
print(f"  ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°: {len(list(onto.individuals()))}")

print("\nã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸€è¦§ã€‘")
for ind in onto.individuals():
    classes = [c.name for c in ind.is_a if hasattr(c, 'name')]
    pressure = ind.hasPressure[0] if hasattr(ind, 'hasPressure') and ind.hasPressure else None
    print(f"  {ind.name}: ã‚¯ãƒ©ã‚¹={classes}, åœ§åŠ›={pressure} kPa")

# æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œ
check_results = check_consistency(onto)

print("\nã€ãƒã‚§ãƒƒã‚¯çµæœã‚µãƒãƒªãƒ¼ã€‘")
print(f"  æ•´åˆæ€§: {'OK' if check_results['is_consistent'] else 'NG'}")
print(f"  çŸ›ç›¾ã®æ•°: {len(check_results['inconsistencies'])}")
print(f"  è­¦å‘Šã®æ•°: {len(check_results['warnings'])}")

if check_results['inconsistencies']:
    print("\nã€æ¤œå‡ºã•ã‚ŒãŸçŸ›ç›¾ã€‘")
    for inc in check_results['inconsistencies']:
        print(f"  - {inc}")

if check_results['warnings']:
    print("\nã€è­¦å‘Šã€‘")
    for warn in check_results['warnings']:
        print(f"  - {warn}")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
============================================================

ã€ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼çµ±è¨ˆã€‘
  ã‚¯ãƒ©ã‚¹æ•°: 4
  ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æ•°: 4

ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸€è¦§ã€‘
  P101: ã‚¯ãƒ©ã‚¹=['Pump'], åœ§åŠ›=150.0 kPa
  P102: ã‚¯ãƒ©ã‚¹=['Pump', 'Compressor'], åœ§åŠ›=None kPa
  P103: ã‚¯ãƒ©ã‚¹=['Pump'], åœ§åŠ›=250.0 kPa
  C201: ã‚¯ãƒ©ã‚¹=['Compressor'], åœ§åŠ›=-50.0 kPa

ã€æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯å®Ÿè¡Œä¸­...ã€‘
  æ¨è«–ã‚¨ãƒ©ãƒ¼: Javaç’°å¢ƒãŒå¿…è¦ã§ã™

ã€æ‰‹å‹•ãƒã‚§ãƒƒã‚¯: Disjointåˆ¶ç´„ã€‘
  P102: Pumpã‹ã¤Compressorã§äº’ã„ã«ç´ é•å

ã€æ‰‹å‹•ãƒã‚§ãƒƒã‚¯: åœ§åŠ›å€¤ã®å¦¥å½“æ€§ã€‘
  C201: è² ã®åœ§åŠ› -50.0 kPaï¼ˆç‰©ç†çš„ã«ä¸æ­£ï¼‰

ã€ãƒã‚§ãƒƒã‚¯çµæœã‚µãƒãƒªãƒ¼ã€‘
  æ•´åˆæ€§: NG
  çŸ›ç›¾ã®æ•°: 1
  è­¦å‘Šã®æ•°: 2
</code></pre>

<p><strong>è§£èª¬:</strong> ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã«ã‚ˆã‚Šã€å®šç¾©ã•ã‚ŒãŸåˆ¶ç´„ï¼ˆDisjointã€ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£ã€ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ¶ç´„ï¼‰ã®é•åã‚’è‡ªå‹•æ¤œå‡ºã—ã¾ã™ã€‚è¨­è¨ˆæ™‚ã®èª¤ã‚Šã‚’æ—©æœŸã«ç™ºè¦‹ã§ãã¾ã™ã€‚</p>

<hr />

<h2>4.6 æ•…éšœè¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ </h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: æ¨è«–ãƒ™ãƒ¼ã‚¹æ•…éšœè¨ºæ–­</h3>

<pre><code class="language-python">from rdflib import Graph, Namespace, RDF, RDFS, Literal
from rdflib.plugins.sparql import prepareQuery
import pandas as pd

# æ¨è«–ãƒ™ãƒ¼ã‚¹æ•…éšœè¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ 

PROC = Namespace("http://example.org/process#")
DIAG = Namespace("http://example.org/diagnosis#")

def create_diagnostic_knowledge_base():
    """
    æ•…éšœè¨ºæ–­ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚’æ§‹ç¯‰

    Returns:
        Graph: è¨ºæ–­ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•
    """
    g = Graph()
    g.bind("proc", PROC)
    g.bind("diag", DIAG)

    # æ•…éšœãƒ¢ãƒ¼ãƒ‰ã®å®šç¾©
    g.add((DIAG.CavitationFailure, RDF.type, DIAG.FailureMode))
    g.add((DIAG.CavitationFailure, RDFS.label, Literal("ã‚­ãƒ£ãƒ“ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³")))
    g.add((DIAG.CavitationFailure, DIAG.symptom, Literal("ä½æµé‡")))
    g.add((DIAG.CavitationFailure, DIAG.symptom, Literal("é«˜æŒ¯å‹•")))
    g.add((DIAG.CavitationFailure, DIAG.rootCause, Literal("å¸è¾¼åœ§åŠ›ä¸è¶³")))

    g.add((DIAG.SealLeakage, RDF.type, DIAG.FailureMode))
    g.add((DIAG.SealLeakage, RDFS.label, Literal("ã‚·ãƒ¼ãƒ«æ¼ã‚Œ")))
    g.add((DIAG.SealLeakage, DIAG.symptom, Literal("ä½åœ§åŠ›")))
    g.add((DIAG.SealLeakage, DIAG.symptom, Literal("æ¶²ä½“æ¼æ´©æ¤œçŸ¥")))
    g.add((DIAG.SealLeakage, DIAG.rootCause, Literal("ã‚·ãƒ¼ãƒ«åŠ£åŒ–")))

    g.add((DIAG.BearingFailure, RDF.type, DIAG.FailureMode))
    g.add((DIAG.BearingFailure, RDFS.label, Literal("è»¸å—æ•…éšœ")))
    g.add((DIAG.BearingFailure, DIAG.symptom, Literal("é«˜æŒ¯å‹•")))
    g.add((DIAG.BearingFailure, DIAG.symptom, Literal("é«˜æ¸©åº¦")))
    g.add((DIAG.BearingFailure, DIAG.rootCause, Literal("æ½¤æ»‘ä¸è‰¯")))

    # æ©Ÿå™¨ã®ç¾åœ¨çŠ¶æ…‹ï¼ˆã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼‰
    g.add((PROC.P101, RDF.type, PROC.Pump))
    g.add((PROC.P101, PROC.hasFlowRate, Literal(25.0)))  # å®šæ ¼50 mÂ³/h ã«å¯¾ã—ã¦ä½æµé‡
    g.add((PROC.P101, PROC.hasVibration, Literal(8.5)))  # æ­£å¸¸ç¯„å›²: 0-5 mm/s
    g.add((PROC.P101, PROC.hasPressure, Literal(450.0)))
    g.add((PROC.P101, PROC.hasTemperature, Literal(65.0)))

    g.add((PROC.P102, RDF.type, PROC.Pump))
    g.add((PROC.P102, PROC.hasFlowRate, Literal(48.0)))
    g.add((PROC.P102, PROC.hasVibration, Literal(2.0)))
    g.add((PROC.P102, PROC.hasPressure, Literal(380.0)))  # å®šæ ¼500 kPaã«å¯¾ã—ã¦ä½åœ§
    g.add((PROC.P102, PROC.hasLeakDetected, Literal(True)))

    return g


def diagnose_faults(g):
    """
    ç—‡çŠ¶ã‹ã‚‰æ•…éšœãƒ¢ãƒ¼ãƒ‰ã‚’æ¨è«–è¨ºæ–­

    Parameters:
        g (Graph): ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•

    Returns:
        list: è¨ºæ–­çµæœ
    """
    diagnoses = []

    # è¨ºæ–­ãƒ«ãƒ¼ãƒ«1: ã‚­ãƒ£ãƒ“ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ¤œå‡º
    # ç—‡çŠ¶: ä½æµé‡ï¼ˆ<å®šæ ¼ã®60%ï¼‰+ é«˜æŒ¯å‹•ï¼ˆ>5 mm/sï¼‰
    query_cavitation = prepareQuery("""
        SELECT ?pump ?flowRate ?vibration
        WHERE {
            ?pump a proc:Pump .
            ?pump proc:hasFlowRate ?flowRate .
            ?pump proc:hasVibration ?vibration .
            FILTER (?flowRate < 30 && ?vibration > 5)
        }
    """, initNs={"proc": PROC})

    for row in g.query(query_cavitation):
        diagnoses.append({
            'equipment': str(row.pump).split('#')[-1],
            'failure_mode': 'ã‚­ãƒ£ãƒ“ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³',
            'confidence': 0.85,
            'symptoms': [f'ä½æµé‡({row.flowRate} mÂ³/h)', f'é«˜æŒ¯å‹•({row.vibration} mm/s)'],
            'root_cause': 'å¸è¾¼åœ§åŠ›ä¸è¶³',
            'action': 'NPSHç¢ºèªã€å¸è¾¼é…ç®¡ã®ç‚¹æ¤œ'
        })

    # è¨ºæ–­ãƒ«ãƒ¼ãƒ«2: ã‚·ãƒ¼ãƒ«æ¼ã‚Œæ¤œå‡º
    # ç—‡çŠ¶: ä½åœ§åŠ›ï¼ˆ<å®šæ ¼ã®80%ï¼‰+ æ¼æ´©æ¤œçŸ¥
    query_seal = prepareQuery("""
        SELECT ?pump ?pressure ?leak
        WHERE {
            ?pump a proc:Pump .
            ?pump proc:hasPressure ?pressure .
            ?pump proc:hasLeakDetected ?leak .
            FILTER (?pressure < 400 && ?leak = true)
        }
    """, initNs={"proc": PROC})

    for row in g.query(query_seal):
        diagnoses.append({
            'equipment': str(row.pump).split('#')[-1],
            'failure_mode': 'ã‚·ãƒ¼ãƒ«æ¼ã‚Œ',
            'confidence': 0.92,
            'symptoms': [f'ä½åœ§åŠ›({row.pressure} kPa)', 'æ¶²ä½“æ¼æ´©æ¤œçŸ¥'],
            'root_cause': 'ãƒ¡ã‚«ãƒ‹ã‚«ãƒ«ã‚·ãƒ¼ãƒ«åŠ£åŒ–',
            'action': 'ã‚·ãƒ¼ãƒ«äº¤æ›ã‚’æ¨å¥¨'
        })

    # è¨ºæ–­ãƒ«ãƒ¼ãƒ«3: è»¸å—æ•…éšœæ¤œå‡º
    # ç—‡çŠ¶: é«˜æŒ¯å‹• + é«˜æ¸©åº¦ï¼ˆ>80Â°Cï¼‰
    query_bearing = prepareQuery("""
        SELECT ?pump ?vibration ?temp
        WHERE {
            ?pump a proc:Pump .
            ?pump proc:hasVibration ?vibration .
            ?pump proc:hasTemperature ?temp .
            FILTER (?vibration > 5 && ?temp > 80)
        }
    """, initNs={"proc": PROC})

    for row in g.query(query_bearing):
        diagnoses.append({
            'equipment': str(row.pump).split('#')[-1],
            'failure_mode': 'è»¸å—æ•…éšœ',
            'confidence': 0.78,
            'symptoms': [f'é«˜æŒ¯å‹•({row.vibration} mm/s)', f'é«˜æ¸©åº¦({row.temp}Â°C)'],
            'root_cause': 'æ½¤æ»‘ä¸è‰¯ã¾ãŸã¯è»¸å—æ‘©è€—',
            'action': 'æ½¤æ»‘æ²¹ç‚¹æ¤œã€è»¸å—äº¤æ›æ¤œè¨'
        })

    return diagnoses


# å®Ÿè¡Œãƒ‡ãƒ¢
print("="*60)
print("æ¨è«–ãƒ™ãƒ¼ã‚¹æ•…éšœè¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ ")
print("="*60)

g = create_diagnostic_knowledge_base()

print("\nã€è¨ºæ–­ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã€‘")
print(f"  æ•…éšœãƒ¢ãƒ¼ãƒ‰æ•°: {len(list(g.subjects(RDF.type, DIAG.FailureMode)))}")
print(f"  ç›£è¦–æ©Ÿå™¨æ•°: {len(list(g.subjects(RDF.type, PROC.Pump)))}")

# æ©Ÿå™¨çŠ¶æ…‹ã®è¡¨ç¤º
print("\nã€æ©Ÿå™¨ã®ç¾åœ¨çŠ¶æ…‹ã€‘")
for pump_uri in g.subjects(RDF.type, PROC.Pump):
    pump = str(pump_uri).split('#')[-1]
    flow = list(g.objects(pump_uri, PROC.hasFlowRate))[0] if list(g.objects(pump_uri, PROC.hasFlowRate)) else None
    vib = list(g.objects(pump_uri, PROC.hasVibration))[0] if list(g.objects(pump_uri, PROC.hasVibration)) else None
    pressure = list(g.objects(pump_uri, PROC.hasPressure))[0] if list(g.objects(pump_uri, PROC.hasPressure)) else None
    temp = list(g.objects(pump_uri, PROC.hasTemperature))[0] if list(g.objects(pump_uri, PROC.hasTemperature)) else None

    print(f"\n  {pump}:")
    print(f"    æµé‡: {flow} mÂ³/h, æŒ¯å‹•: {vib} mm/s")
    print(f"    åœ§åŠ›: {pressure} kPa, æ¸©åº¦: {temp}Â°C")

# æ•…éšœè¨ºæ–­ã‚’å®Ÿè¡Œ
diagnoses = diagnose_faults(g)

print(f"\nã€è¨ºæ–­çµæœã€‘")
print(f"  æ¤œå‡ºã•ã‚ŒãŸæ•…éšœ: {len(diagnoses)}ä»¶")

for i, diag in enumerate(diagnoses, 1):
    print(f"\n{i}. {diag['equipment']} - {diag['failure_mode']}")
    print(f"   ä¿¡é ¼åº¦: {diag['confidence']*100:.1f}%")
    print(f"   ç—‡çŠ¶: {', '.join(diag['symptoms'])}")
    print(f"   æ ¹æœ¬åŸå› : {diag['root_cause']}")
    print(f"   æ¨å¥¨å¯¾å¿œ: {diag['action']}")

# DataFrameåŒ–
if diagnoses:
    df = pd.DataFrame(diagnoses)
    print("\nã€è¨ºæ–­ã‚µãƒãƒªãƒ¼ï¼ˆè¡¨å½¢å¼ï¼‰ã€‘")
    print(df[['equipment', 'failure_mode', 'confidence', 'action']].to_string(index=False))
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
æ¨è«–ãƒ™ãƒ¼ã‚¹æ•…éšœè¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ 
============================================================

ã€è¨ºæ–­ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã€‘
  æ•…éšœãƒ¢ãƒ¼ãƒ‰æ•°: 3
  ç›£è¦–æ©Ÿå™¨æ•°: 2

ã€æ©Ÿå™¨ã®ç¾åœ¨çŠ¶æ…‹ã€‘

  P101:
    æµé‡: 25.0 mÂ³/h, æŒ¯å‹•: 8.5 mm/s
    åœ§åŠ›: 450.0 kPa, æ¸©åº¦: 65.0Â°C

  P102:
    æµé‡: 48.0 mÂ³/h, æŒ¯å‹•: 2.0 mm/s
    åœ§åŠ›: 380.0 kPa, æ¸©åº¦: NoneÂ°C

ã€è¨ºæ–­çµæœã€‘
  æ¤œå‡ºã•ã‚ŒãŸæ•…éšœ: 2ä»¶

1. P101 - ã‚­ãƒ£ãƒ“ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
   ä¿¡é ¼åº¦: 85.0%
   ç—‡çŠ¶: ä½æµé‡(25.0 mÂ³/h), é«˜æŒ¯å‹•(8.5 mm/s)
   æ ¹æœ¬åŸå› : å¸è¾¼åœ§åŠ›ä¸è¶³
   æ¨å¥¨å¯¾å¿œ: NPSHç¢ºèªã€å¸è¾¼é…ç®¡ã®ç‚¹æ¤œ

2. P102 - ã‚·ãƒ¼ãƒ«æ¼ã‚Œ
   ä¿¡é ¼åº¦: 92.0%
   ç—‡çŠ¶: ä½åœ§åŠ›(380.0 kPa), æ¶²ä½“æ¼æ´©æ¤œçŸ¥
   æ ¹æœ¬åŸå› : ãƒ¡ã‚«ãƒ‹ã‚«ãƒ«ã‚·ãƒ¼ãƒ«åŠ£åŒ–
   æ¨å¥¨å¯¾å¿œ: ã‚·ãƒ¼ãƒ«äº¤æ›ã‚’æ¨å¥¨

ã€è¨ºæ–­ã‚µãƒãƒªãƒ¼ï¼ˆè¡¨å½¢å¼ï¼‰ã€‘
equipment    failure_mode  confidence                       action
     P101  ã‚­ãƒ£ãƒ“ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³        0.85         NPSHç¢ºèªã€å¸è¾¼é…ç®¡ã®ç‚¹æ¤œ
     P102      ã‚·ãƒ¼ãƒ«æ¼ã‚Œ        0.92                 ã‚·ãƒ¼ãƒ«äº¤æ›ã‚’æ¨å¥¨
</code></pre>

<p><strong>è§£èª¬:</strong> ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã¨æ•…éšœãƒ¢ãƒ¼ãƒ‰ã®ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚’çµ„ã¿åˆã‚ã›ã€ç—‡çŠ¶ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°ã«ã‚ˆã‚Šæ•…éšœã‚’æ¨è«–è¨ºæ–­ã—ã¾ã™ã€‚SPARQLã®FILTERæ¡ä»¶ã«ã‚ˆã‚Šã€è¤‡æ•°ç—‡çŠ¶ã®çµ„ã¿åˆã‚ã›ã‚’è©•ä¾¡ã—ã¾ã™ã€‚</p>

<hr />

<h2>4.7 ç•°å¸¸æ¤œçŸ¥ã¸ã®å¿œç”¨</h2>

<h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ç•°å¸¸æ¤œçŸ¥</h3>

<pre><code class="language-python">from rdflib import Graph, Namespace, RDF, RDFS, Literal
from rdflib.plugins.sparql import prepareQuery
import numpy as np
import pandas as pd

# ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ç•°å¸¸æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ 

PROC = Namespace("http://example.org/process#")
ANOM = Namespace("http://example.org/anomaly#")

def create_anomaly_detection_kb():
    """
    ç•°å¸¸æ¤œçŸ¥ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚’æ§‹ç¯‰

    Returns:
        Graph: RDFã‚°ãƒ©ãƒ•
    """
    g = Graph()
    g.bind("proc", PROC)
    g.bind("anom", ANOM)

    # æ­£å¸¸é‹è»¢ç¯„å›²ã®å®šç¾©
    g.add((PROC.Pump, RDF.type, RDFS.Class))
    g.add((PROC.Pump, ANOM.normalFlowRateMin, Literal(45.0)))
    g.add((PROC.Pump, ANOM.normalFlowRateMax, Literal(55.0)))
    g.add((PROC.Pump, ANOM.normalPressureMin, Literal(480.0)))
    g.add((PROC.Pump, ANOM.normalPressureMax, Literal(520.0)))
    g.add((PROC.Pump, ANOM.normalVibrationMax, Literal(4.0)))
    g.add((PROC.Pump, ANOM.normalTempMax, Literal(70.0)))

    # æ™‚ç³»åˆ—ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆæ“¬ä¼¼çš„ãªã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼‰
    sensor_data = [
        {"time": 0, "pump": "P101", "flow": 50.0, "pressure": 500.0, "vib": 2.5, "temp": 55.0},
        {"time": 1, "pump": "P101", "flow": 48.0, "pressure": 495.0, "vib": 3.0, "temp": 56.0},
        {"time": 2, "pump": "P101", "flow": 42.0, "pressure": 485.0, "vib": 5.2, "temp": 58.0},  # ç•°å¸¸é–‹å§‹
        {"time": 3, "pump": "P101", "flow": 35.0, "pressure": 470.0, "vib": 7.8, "temp": 62.0},  # ç•°å¸¸é€²è¡Œ
        {"time": 4, "pump": "P101", "flow": 30.0, "pressure": 450.0, "vib": 9.5, "temp": 68.0},  # é‡åº¦ç•°å¸¸
    ]

    # ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ã‚°ãƒ©ãƒ•ã«è¿½åŠ 
    for data in sensor_data:
        measurement_uri = PROC[f"Measurement_{data['pump']}_{data['time']}"]
        g.add((measurement_uri, RDF.type, PROC.Measurement))
        g.add((measurement_uri, PROC.equipment, PROC[data['pump']]))
        g.add((measurement_uri, PROC.timestamp, Literal(data['time'])))
        g.add((measurement_uri, PROC.flowRate, Literal(data['flow'])))
        g.add((measurement_uri, PROC.pressure, Literal(data['pressure'])))
        g.add((measurement_uri, PROC.vibration, Literal(data['vib'])))
        g.add((measurement_uri, PROC.temperature, Literal(data['temp'])))

    return g, sensor_data


def detect_anomalies(g):
    """
    ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ã§ç•°å¸¸ã‚’æ¤œçŸ¥

    Parameters:
        g (Graph): RDFã‚°ãƒ©ãƒ•

    Returns:
        list: ç•°å¸¸æ¤œçŸ¥çµæœ
    """
    anomalies = []

    # æ­£å¸¸ç¯„å›²ã®å–å¾—
    normal_ranges = {}
    for cls in [PROC.Pump]:
        normal_ranges[cls] = {
            'flow_min': float(list(g.objects(cls, ANOM.normalFlowRateMin))[0]),
            'flow_max': float(list(g.objects(cls, ANOM.normalFlowRateMax))[0]),
            'pressure_min': float(list(g.objects(cls, ANOM.normalPressureMin))[0]),
            'pressure_max': float(list(g.objects(cls, ANOM.normalPressureMax))[0]),
            'vib_max': float(list(g.objects(cls, ANOM.normalVibrationMax))[0]),
            'temp_max': float(list(g.objects(cls, ANOM.normalTempMax))[0])
        }

    # å„æ¸¬å®šå€¤ã‚’ãƒã‚§ãƒƒã‚¯
    query_measurements = prepareQuery("""
        SELECT ?measurement ?eq ?time ?flow ?pressure ?vib ?temp
        WHERE {
            ?measurement a proc:Measurement .
            ?measurement proc:equipment ?eq .
            ?measurement proc:timestamp ?time .
            ?measurement proc:flowRate ?flow .
            ?measurement proc:pressure ?pressure .
            ?measurement proc:vibration ?vib .
            ?measurement proc:temperature ?temp .
        }
        ORDER BY ?time
    """, initNs={"proc": PROC})

    for row in g.query(query_measurements):
        ranges = normal_ranges[PROC.Pump]
        violations = []
        severity_score = 0

        # æµé‡ãƒã‚§ãƒƒã‚¯
        if row.flow < ranges['flow_min']:
            deviation = ((ranges['flow_min'] - row.flow) / ranges['flow_min']) * 100
            violations.append(f"ä½æµé‡(-{deviation:.1f}%)")
            severity_score += deviation
        elif row.flow > ranges['flow_max']:
            deviation = ((row.flow - ranges['flow_max']) / ranges['flow_max']) * 100
            violations.append(f"é«˜æµé‡(+{deviation:.1f}%)")
            severity_score += deviation

        # åœ§åŠ›ãƒã‚§ãƒƒã‚¯
        if row.pressure < ranges['pressure_min']:
            deviation = ((ranges['pressure_min'] - row.pressure) / ranges['pressure_min']) * 100
            violations.append(f"ä½åœ§åŠ›(-{deviation:.1f}%)")
            severity_score += deviation

        # æŒ¯å‹•ãƒã‚§ãƒƒã‚¯
        if row.vib > ranges['vib_max']:
            deviation = ((row.vib - ranges['vib_max']) / ranges['vib_max']) * 100
            violations.append(f"é«˜æŒ¯å‹•(+{deviation:.1f}%)")
            severity_score += deviation * 2  # æŒ¯å‹•ã¯é‡è¦åº¦é«˜

        # æ¸©åº¦ãƒã‚§ãƒƒã‚¯
        if row.temp > ranges['temp_max']:
            deviation = ((row.temp - ranges['temp_max']) / ranges['temp_max']) * 100
            violations.append(f"é«˜æ¸©åº¦(+{deviation:.1f}%)")
            severity_score += deviation

        # ç•°å¸¸ãŒã‚ã‚Œã°è¨˜éŒ²
        if violations:
            severity = 'CRITICAL' if severity_score > 100 else 'HIGH' if severity_score > 50 else 'MEDIUM'

            anomalies.append({
                'timestamp': int(row.time),
                'equipment': str(row.eq).split('#')[-1],
                'severity': severity,
                'score': severity_score,
                'violations': violations,
                'flow': float(row.flow),
                'pressure': float(row.pressure),
                'vibration': float(row.vib),
                'temperature': float(row.temp)
            })

    return anomalies


# å®Ÿè¡Œãƒ‡ãƒ¢
print("="*60)
print("ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ç•°å¸¸æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ ")
print("="*60)

g, sensor_data = create_anomaly_detection_kb()

print("\nã€ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦ã€‘")
print(f"  ç›£è¦–å¯¾è±¡: {len(list(g.subjects(PROC.equipment, None)))} æ¸¬å®šç‚¹")
print(f"  æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿æ•°: {len(sensor_data)}")

print("\nã€æ­£å¸¸é‹è»¢ç¯„å›²ã€‘")
print("  æµé‡: 45.0 - 55.0 mÂ³/h")
print("  åœ§åŠ›: 480.0 - 520.0 kPa")
print("  æŒ¯å‹•: < 4.0 mm/s")
print("  æ¸©åº¦: < 70.0 Â°C")

# ç•°å¸¸æ¤œçŸ¥ã‚’å®Ÿè¡Œ
anomalies = detect_anomalies(g)

print(f"\nã€ç•°å¸¸æ¤œçŸ¥çµæœã€‘")
print(f"  æ¤œå‡ºã•ã‚ŒãŸç•°å¸¸: {len(anomalies)}/{ len(sensor_data)}æ¸¬å®šç‚¹")

# æ™‚ç³»åˆ—ã§è¡¨ç¤º
print("\nã€æ™‚ç³»åˆ—ç•°å¸¸ãƒ¬ãƒãƒ¼ãƒˆã€‘")
for anom in anomalies:
    print(f"\næ™‚åˆ» {anom['timestamp']}: [{anom['severity']}] {anom['equipment']}")
    print(f"  ç•°å¸¸ã‚¹ã‚³ã‚¢: {anom['score']:.1f}")
    print(f"  é•åé …ç›®: {', '.join(anom['violations'])}")
    print(f"  æ¸¬å®šå€¤: æµé‡={anom['flow']} mÂ³/h, åœ§åŠ›={anom['pressure']} kPa, "
          f"æŒ¯å‹•={anom['vibration']} mm/s, æ¸©åº¦={anom['temperature']}Â°C")

# ç•°å¸¸ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ
if anomalies:
    df = pd.DataFrame(anomalies)
    print("\nã€ç•°å¸¸ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æã€‘")
    print(df[['timestamp', 'severity', 'score', 'flow', 'vibration']].to_string(index=False))

    # ã‚¹ã‚³ã‚¢æ¨ç§»
    print(f"\nç•°å¸¸ã‚¹ã‚³ã‚¢æ¨ç§»:")
    print(f"  æœ€å°: {df['score'].min():.1f}")
    print(f"  æœ€å¤§: {df['score'].max():.1f}")
    print(f"  å¹³å‡: {df['score'].mean():.1f}")
    print(f"  å‚¾å‘: {'æ‚ªåŒ–ä¸­' if df['score'].iloc[-1] > df['score'].iloc[0] else 'æ”¹å–„ä¸­'}")
</code></pre>

<p><strong>å‡ºåŠ›ä¾‹:</strong></p>
<pre><code>============================================================
ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ãƒ™ãƒ¼ã‚¹ç•°å¸¸æ¤œçŸ¥ã‚·ã‚¹ãƒ†ãƒ 
============================================================

ã€ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦ã€‘
  ç›£è¦–å¯¾è±¡: 5 æ¸¬å®šç‚¹
  æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿æ•°: 5

ã€æ­£å¸¸é‹è»¢ç¯„å›²ã€‘
  æµé‡: 45.0 - 55.0 mÂ³/h
  åœ§åŠ›: 480.0 - 520.0 kPa
  æŒ¯å‹•: < 4.0 mm/s
  æ¸©åº¦: < 70.0 Â°C

ã€ç•°å¸¸æ¤œçŸ¥çµæœã€‘
  æ¤œå‡ºã•ã‚ŒãŸç•°å¸¸: 3/5æ¸¬å®šç‚¹

ã€æ™‚ç³»åˆ—ç•°å¸¸ãƒ¬ãƒãƒ¼ãƒˆã€‘

æ™‚åˆ» 2: [MEDIUM] P101
  ç•°å¸¸ã‚¹ã‚³ã‚¢: 36.7
  é•åé …ç›®: ä½æµé‡(-6.7%), é«˜æŒ¯å‹•(+30.0%)
  æ¸¬å®šå€¤: æµé‡=42.0 mÂ³/h, åœ§åŠ›=485.0 kPa, æŒ¯å‹•=5.2 mm/s, æ¸©åº¦=58.0Â°C

æ™‚åˆ» 3: [HIGH] P101
  ç•°å¸¸ã‚¹ã‚³ã‚¢: 117.8
  é•åé …ç›®: ä½æµé‡(-22.2%), ä½åœ§åŠ›(-2.1%), é«˜æŒ¯å‹•(+95.0%)
  æ¸¬å®šå€¤: æµé‡=35.0 mÂ³/h, åœ§åŠ›=470.0 kPa, æŒ¯å‹•=7.8 mm/s, æ¸©åº¦=62.0Â°C

æ™‚åˆ» 4: [CRITICAL] P101
  ç•°å¸¸ã‚¹ã‚³ã‚¢: 183.3
  é•åé …ç›®: ä½æµé‡(-33.3%), ä½åœ§åŠ›(-6.2%), é«˜æŒ¯å‹•(+137.5%)
  æ¸¬å®šå€¤: æµé‡=30.0 mÂ³/h, åœ§åŠ›=450.0 kPa, æŒ¯å‹•=9.5 mm/s, æ¸©åº¦=68.0Â°C

ã€ç•°å¸¸ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æã€‘
timestamp severity  score  flow  vibration
        2   MEDIUM   36.7  42.0        5.2
        3     HIGH  117.8  35.0        7.8
        4 CRITICAL  183.3  30.0        9.5

ç•°å¸¸ã‚¹ã‚³ã‚¢æ¨ç§»:
  æœ€å°: 36.7
  æœ€å¤§: 183.3
  å¹³å‡: 112.6
  å‚¾å‘: æ‚ªåŒ–ä¸­
</code></pre>

<p><strong>è§£èª¬:</strong> ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã«æ­£å¸¸é‹è»¢ç¯„å›²ã‚’å®šç¾©ã—ã€æ™‚ç³»åˆ—ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ã¨ã®æ¯”è¼ƒã«ã‚ˆã‚Šç•°å¸¸ã‚’æ¤œçŸ¥ã—ã¾ã™ã€‚è¤‡æ•°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®åŒæ™‚ç›£è¦–ã«ã‚ˆã‚Šã€ç•°å¸¸ã®é‡ç—‡åº¦ã‚’å®šé‡åŒ–ã—ã€ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’åˆ†æã§ãã¾ã™ã€‚</p>

<hr />

<h2>4.8 æœ¬ç« ã®ã¾ã¨ã‚</h2>

<h3>å­¦ã‚“ã ã“ã¨</h3>

<ol>
<li><strong>RDFSæ¨è«–</strong>
<ul>
<li>ã‚¯ãƒ©ã‚¹éšå±¤ã«ã‚ˆã‚‹å‹ç¶™æ‰¿ï¼ˆsubClassOfæ¨è«–ï¼‰</li>
<li>ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ»ãƒ¬ãƒ³ã‚¸åˆ¶ç´„</li>
<li>SPARQLã§ã®æ¨è«–çµæœã‚¯ã‚¨ãƒª</li>
</ul>
</li>
<li><strong>OWLæ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³</strong>
<ul>
<li>HermiT/Pelletã«ã‚ˆã‚‹é«˜åº¦ãªæ¨è«–</li>
<li>è‡ªå‹•ã‚¯ãƒ©ã‚¹åˆ†é¡ï¼ˆequivalent_toåˆ¶ç´„ï¼‰</li>
<li>Disjointåˆ¶ç´„ã€ã‚«ãƒ¼ãƒ‡ã‚£ãƒŠãƒªãƒ†ã‚£åˆ¶ç´„</li>
</ul>
</li>
<li><strong>SWRLãƒ«ãƒ¼ãƒ«</strong>
<ul>
<li>if-thenå½¢å¼ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«å®šç¾©</li>
<li>æ•°å€¤æ¡ä»¶ã«åŸºã¥ãæ¨è«–ï¼ˆgreaterThanç­‰ï¼‰</li>
<li>ã‚¢ãƒ©ãƒ¼ãƒ ç”Ÿæˆã€ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹åˆ¤å®šã¸ã®å¿œç”¨</li>
</ul>
</li>
<li><strong>ãƒ—ãƒ­ã‚»ã‚¹å®‰å…¨æ¨è«–</strong>
<ul>
<li>è¨­è¨ˆåˆ¶ç´„é•åã®è‡ªå‹•æ¤œå‡º</li>
<li>SPARQL FILTERã«ã‚ˆã‚‹æ¡ä»¶è©•ä¾¡</li>
<li>é‡ç—‡åº¦åˆ†é¡ã¨ãƒªã‚¹ã‚¯è©•ä¾¡</li>
</ul>
</li>
<li><strong>æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯</strong>
<ul>
<li>ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ã®çŸ›ç›¾æ¤œå‡º</li>
<li>Disjointã€FunctionalPropertyé•åã®æ¤œè¨¼</li>
</ul>
</li>
<li><strong>æ•…éšœè¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ </strong>
<ul>
<li>ç—‡çŠ¶ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°æ¨è«–</li>
<li>æ ¹æœ¬åŸå› åˆ†æï¼ˆRoot Cause Analysisï¼‰</li>
<li>ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°</li>
</ul>
</li>
<li><strong>ç•°å¸¸æ¤œçŸ¥</strong>
<ul>
<li>æ­£å¸¸é‹è»¢ç¯„å›²ã®ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹åŒ–</li>
<li>æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿ã¨ã®æ¯”è¼ƒã«ã‚ˆã‚‹ç•°å¸¸æ¤œå‡º</li>
<li>ç•°å¸¸ã‚¹ã‚³ã‚¢ãƒªãƒ³ã‚°ã¨ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ</li>
</ul>
</li>
</ol>

<h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

<ul>
<li>RDFSæ¨è«–ã¯ã‚¯ãƒ©ã‚¹éšå±¤ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ç¶™æ‰¿ã«ç‰¹åŒ–ã—ã€è»½é‡ã§é«˜é€Ÿ</li>
<li>OWLæ¨è«–ã¯è¤‡é›‘ãªåˆ¶ç´„ã¨è‡ªå‹•åˆ†é¡ãŒå¯èƒ½ã ãŒã€è¨ˆç®—ã‚³ã‚¹ãƒˆé«˜</li>
<li>SWRLãƒ«ãƒ¼ãƒ«ã«ã‚ˆã‚Šã€ãƒ‰ãƒ¡ã‚¤ãƒ³å›ºæœ‰ã®æ¨è«–ãƒ­ã‚¸ãƒƒã‚¯ã‚’æŸ”è»Ÿã«å®šç¾©å¯èƒ½</li>
<li>æ¨è«–ã‚¨ãƒ³ã‚¸ãƒ³ã¯è¨­è¨ˆæ™‚ã®æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯ã«æœ‰åŠ¹</li>
<li>æ•…éšœè¨ºæ–­ã§ã¯ã€ç—‡çŠ¶ã¨åŸå› ã®ãƒŠãƒ¬ãƒƒã‚¸ã‚’ä½“ç³»åŒ–ã™ã‚‹ã“ã¨ãŒé‡è¦</li>
<li>ç•°å¸¸æ¤œçŸ¥ã§ã¯ã€æ­£å¸¸ç¯„å›²ã‚’æ˜ç¢ºã«å®šç¾©ã—ã€å®šé‡çš„è©•ä¾¡ã‚’è¡Œã†</li>
<li>æ¨è«–çµæœã¯å¿…ãšæ¤œè¨¼ã—ã€èª¤æ¤œçŸ¥ï¼ˆFalse Positiveï¼‰ã‚’ä½æ¸›ã™ã‚‹</li>
</ul>

<h3>æ¬¡ã®ç« ã¸</h3>

<p>ç¬¬5ç« ã§ã¯ã€<strong>å®Ÿè£…ã¨çµ±åˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</strong>ã‚’å­¦ã³ã¾ã™ï¼š</p>
<ul>
<li>SPARQLã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆAPIã®æ§‹ç¯‰</li>
<li>ãƒŠãƒ¬ãƒƒã‚¸ã‚°ãƒ©ãƒ•ã®å¯è¦–åŒ–ï¼ˆNetworkXã€Plotlyï¼‰</li>
<li>ãƒ—ãƒ­ã‚»ã‚¹æ–‡æ›¸ã®è‡ªå‹•ç”Ÿæˆ</li>
<li>æ ¹æœ¬åŸå› åˆ†æã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</li>
<li>æ©Ÿå™¨æ¨è–¦ã‚·ã‚¹ãƒ†ãƒ </li>
<li>ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ã¸ã®å¿œç”¨</li>
<li>å®Œå…¨çµ±åˆã‚·ã‚¹ãƒ†ãƒ ï¼ˆAPI + æ¨è«– + å¯è¦–åŒ–ï¼‰</li>
</ul>

<div class="navigation">
    <a href="chapter-3.html" class="nav-button">â† å‰ã®ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-5.html" class="nav-button">æ¬¡ã®ç«  â†’</a>
</div>
    </main>

    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: PI Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-26</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 PI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
