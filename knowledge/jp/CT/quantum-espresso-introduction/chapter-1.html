<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« : Quantum ESPRESSOã®åŸºç¤ã¨ç’°å¢ƒæ§‹ç¯‰ - Quantum ESPRESSOå…¥é–€ - CT Dojo</title>
    <meta name="description" content="Quantum ESPRESSOï¼ˆQEï¼‰ã®åŸºç¤ã€DFTç†è«–ã€å¹³é¢æ³¢åŸºåº•ã€æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã€å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã‚’å­¦ã¶ã€‚Siã®ç°¡å˜ãªSCFè¨ˆç®—ã§å‹•ä½œç¢ºèªã€‚">

    <!-- Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <!-- MathJax for mathematical expressions -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        :root {
            --accent-green: #11998e;
            --accent-lime: #38ef7d;
            --primary-dark: #2c3e50;
            --secondary-dark: #34495e;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --bg-light: #ecf0f1;
            --white: #ffffff;
            --code-bg: #2d2d2d;
            --border-light: #bdc3c7;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.8;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        header {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%);
            color: white;
            padding: 3rem 1.5rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        nav {
            background: var(--white);
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
        }

        nav a {
            text-decoration: none;
            color: var(--text-dark);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            font-weight: 500;
        }

        nav a:hover {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%);
            color: white;
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        section {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-dark);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--accent-green), var(--accent-lime)) 1;
        }

        h3 {
            color: var(--secondary-dark);
            font-size: 1.4rem;
            margin: 2rem 0 1rem;
        }

        h4 {
            color: var(--secondary-dark);
            font-size: 1.2rem;
            margin: 1.5rem 0 1rem;
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(17, 153, 142, 0.1) 0%, rgba(56, 239, 125, 0.1) 100%);
            border-left: 4px solid var(--accent-green);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box strong {
            color: var(--accent-green);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .warning-box {
            background: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box strong {
            color: var(--warning);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .exercise-box {
            background: rgba(39, 174, 96, 0.05);
            border: 2px solid var(--success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .exercise-box h4 {
            color: var(--success);
            margin-top: 0;
        }

        .difficulty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .difficulty.easy {
            background: #d4edda;
            color: #155724;
        }

        .difficulty.medium {
            background: #fff3cd;
            color: #856404;
        }

        .difficulty.hard {
            background: #f8d7da;
            color: #721c24;
        }

        .mermaid {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }

        th {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(17, 153, 142, 0.05);
        }

        footer {
            background: var(--primary-dark);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        footer a {
            color: var(--accent-green);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--accent-lime);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5rem;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            section {
                padding: 1.5rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }
        }



        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #11998e;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #0e7c74;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }

        details {
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(17, 153, 142, 0.05);
            border-radius: 4px;
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--accent-green);
            user-select: none;
        }

        summary:hover {
            color: var(--accent-lime);
        }
    </style>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/CT/index.html">è¨ˆç®—å·¥å­¦</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/CT/quantum-espresso-introduction/index.html">Quantum ESPRESSO</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

        <header>
        <h1>ç¬¬1ç« : Quantum ESPRESSOã®åŸºç¤ã¨ç’°å¢ƒæ§‹ç¯‰</h1>
        <p>DFTç†è«–ãƒ»å¹³é¢æ³¢åŸºåº•ãƒ»æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ </p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">ãƒˆãƒƒãƒ—</a></li>
            <li><a href="#intro">æœ¬ç« ã®æ¦‚è¦</a></li>
            <li><a href="#dft-basics">DFTåŸºç¤</a></li>
            <li><a href="#qe-features">QEã®ç‰¹å¾´</a></li>
            <li><a href="#installation">ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
            <li><a href="#input-structure">å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«</a></li>
            <li><a href="#first-calculation">åˆã‚ã¦ã®è¨ˆç®—</a></li>
            <li><a href="#learning-objectives">å­¦ç¿’ç›®æ¨™</a></li>
            <li><a href="#exercises">æ¼”ç¿’å•é¡Œ</a></li>
            <li><a href="#references">å‚è€ƒæ–‡çŒ®</a></li>
            <li><a href="chapter-2.html">æ¬¡ã®ç« ã¸ â†’</a></li>
        </ul>
    </nav>

    <main>
        <section id="intro">
            <h2>1.1 æœ¬ç« ã®æ¦‚è¦</h2>

            <p>
                Quantum ESPRESSOï¼ˆopEn-Source Package for Research in Electronic Structure, Simulation, and Optimizationï¼‰ã¯ã€å¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰ã«åŸºã¥ãç¬¬ä¸€åŸç†è¨ˆç®—ã‚’è¡Œã†ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚ææ–™ç§‘å­¦ã«ãŠã‘ã‚‹é›»å­æ§‹é€ è¨ˆç®—ã€æ§‹é€ æœ€é©åŒ–ã€ãƒ•ã‚©ãƒãƒ³è¨ˆç®—ã€åˆ†å­å‹•åŠ›å­¦ãªã©ã€å¹…åºƒã„ç”¨é€”ã«ä½¿ã‚ã‚Œã¦ã„ã¾ã™ã€‚
            </p>

            <div class="info-box">
                <strong>æœ¬ç« ã®å­¦ç¿’ç›®æ¨™</strong>
                <ul>
                    <li><strong>ãƒ¬ãƒ™ãƒ«1ï¼ˆåŸºæœ¬ç†è§£ï¼‰</strong>: DFTã®åŸºæœ¬åŸç†ï¼ˆKohn-Shamæ–¹ç¨‹å¼ã€äº¤æ›ç›¸é–¢æ±é–¢æ•°ï¼‰ã€å¹³é¢æ³¢åŸºåº•ã¨æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å½¹å‰²ã€QEå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬æ§‹é€ ã‚’èª¬æ˜ã§ãã‚‹</li>
                    <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: Quantum ESPRESSOã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã€pw.xå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã§ãã€ç°¡å˜ãªSCFè¨ˆç®—ï¼ˆSiçµæ™¶ï¼‰ã‚’å®Ÿè¡Œã§ãã‚‹</li>
                    <li><strong>ãƒ¬ãƒ™ãƒ«3ï¼ˆå¿œç”¨åŠ›ï¼‰</strong>: DFTè¨ˆç®—ã®å¦¥å½“æ€§ã‚’åˆ¤æ–­ã§ãã€æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’é©åˆ‡ã«é¸æŠã§ãã€ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨kç‚¹ã®åæŸæ€§ã‚’è©•ä¾¡ã§ãã‚‹</li>
                </ul>
            </div>

            <div class="warning-box">
                <strong>å‰æçŸ¥è­˜</strong>
                <p>æœ¬ç« ã§ã¯ã€é‡å­åŠ›å­¦ã®åŸºç¤ï¼ˆæ³¢å‹•é–¢æ•°ã€Schrodingeræ–¹ç¨‹å¼ï¼‰ã€å›ºä½“ç‰©ç†å­¦ã®å…¥é–€ï¼ˆçµæ™¶æ§‹é€ ã€é€†æ ¼å­ï¼‰ã€LinuxåŸºæœ¬æ“ä½œï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚³ãƒãƒ³ãƒ‰ã€ç’°å¢ƒå¤‰æ•°ï¼‰ã‚’å‰æã¨ã—ã¾ã™ã€‚</p>
            </div>
        </section>

        <section id="dft-basics">
            <h2>1.2 å¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰ã®åŸºç¤</h2>

            <h3>Schrodingeræ–¹ç¨‹å¼ã®å¤šä½“å•é¡Œ</h3>
            <p>
                å›ºä½“ä¸­ã®é›»å­ç³»ã‚’è¨˜è¿°ã™ã‚‹Schrodingeræ–¹ç¨‹å¼ã¯ã€åŸå­æ ¸ã¨é›»å­ã®å¤šä½“å•é¡Œã§ã™ã€‚Nå€‹ã®é›»å­ã‚’æŒã¤ç³»ã®æ³¢å‹•é–¢æ•°ã¯3Næ¬¡å…ƒã®é–¢æ•°ã¨ãªã‚Šã€ç›´æ¥è§£ãã“ã¨ã¯å®Ÿè³ªçš„ã«ä¸å¯èƒ½ã§ã™ã€‚
            </p>

            <p>å¤šä½“Schrodingeræ–¹ç¨‹å¼:</p>
            <p style="text-align: center;">
                \[
                \hat{H}\Psi(\mathbf{r}_1, \mathbf{r}_2, \ldots, \mathbf{r}_N) = E\Psi(\mathbf{r}_1, \mathbf{r}_2, \ldots, \mathbf{r}_N)
                \]
            </p>

            <h3>Hohenberg-Kohnã®å®šç†ï¼ˆ1964å¹´ï¼‰</h3>
            <p>
                DFTã®åŸºç¤ã¨ãªã‚‹2ã¤ã®å®šç†:
            </p>
            <ol>
                <li><strong>ç¬¬1å®šç†</strong>: å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« \(v_{\text{ext}}(\mathbf{r})\) ã¯ã€åŸºåº•çŠ¶æ…‹ã®é›»å­å¯†åº¦ \(n(\mathbf{r})\) ã«ã‚ˆã£ã¦ä¸€æ„ã«æ±ºã¾ã‚‹ï¼ˆå¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¨é›»å­å¯†åº¦ã¯1å¯¾1å¯¾å¿œï¼‰</li>
                <li><strong>ç¬¬2å®šç†</strong>: å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•° \(E[n]\) ã‚’æœ€å°åŒ–ã™ã‚‹é›»å­å¯†åº¦ãŒã€æ­£ã—ã„åŸºåº•çŠ¶æ…‹ã®é›»å­å¯†åº¦ã§ã‚ã‚‹ï¼ˆå¤‰åˆ†åŸç†ï¼‰</li>
            </ol>

            <p>
                ã“ã‚Œã«ã‚ˆã‚Šã€å¤šä½“æ³¢å‹•é–¢æ•° \(\Psi(\mathbf{r}_1, \ldots, \mathbf{r}_N)\)ï¼ˆ3Næ¬¡å…ƒï¼‰ã®ä»£ã‚ã‚Šã«ã€é›»å­å¯†åº¦ \(n(\mathbf{r})\)ï¼ˆ3æ¬¡å…ƒï¼‰ã‚’åŸºæœ¬å¤‰æ•°ã¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
            </p>

            <h3>Kohn-Shamæ–¹ç¨‹å¼ï¼ˆ1965å¹´ï¼‰</h3>
            <p>
                å®Ÿéš›ã®ç›¸äº’ä½œç”¨ã™ã‚‹é›»å­ç³»ã‚’ã€ã€ŒåŒã˜é›»å­å¯†åº¦ã‚’æŒã¤ç‹¬ç«‹ç²’å­ç³»ã€ã«ç½®ãæ›ãˆã¾ã™ã€‚
            </p>

            <p>Kohn-Shamæ–¹ç¨‹å¼:</p>
            <p style="text-align: center;">
                \[
                \left[ -\frac{\hbar^2}{2m}\nabla^2 + V_{\text{eff}}(\mathbf{r}) \right] \psi_i(\mathbf{r}) = \epsilon_i \psi_i(\mathbf{r})
                \]
            </p>

            <p>ã“ã“ã§æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¯:</p>
            <p style="text-align: center;">
                \[
                V_{\text{eff}}(\mathbf{r}) = V_{\text{ext}}(\mathbf{r}) + V_{\text{H}}(\mathbf{r}) + V_{\text{xc}}(\mathbf{r})
                \]
            </p>

            <ul>
                <li>\(V_{\text{ext}}(\mathbf{r})\): å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆåŸå­æ ¸ã‹ã‚‰ã®ã‚¯ãƒ¼ãƒ­ãƒ³ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼‰</li>
                <li>\(V_{\text{H}}(\mathbf{r})\): Hartreeãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆé›»å­é–“ã®å¤å…¸çš„ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨ï¼‰</li>
                <li>\(V_{\text{xc}}(\mathbf{r})\): äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆé‡å­åŠ›å­¦çš„åŠ¹æœã‚’å«ã‚€ï¼‰</li>
            </ul>

            <h3>äº¤æ›ç›¸é–¢æ±é–¢æ•°ã®è¿‘ä¼¼</h3>
            <p>
                DFTã®å³å¯†ãªå½¢å¼è«–ã§ã¯ã€äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(E_{\text{xc}}[n]\) ã®æ­£ç¢ºãªé–¢æ•°å½¢ã¯æœªçŸ¥ã§ã™ã€‚å®Ÿç”¨çš„ã«ã¯ä»¥ä¸‹ã®è¿‘ä¼¼ãŒä½¿ã‚ã‚Œã¾ã™ã€‚
            </p>

            <table>
                <thead>
                    <tr>
                        <th>è¿‘ä¼¼</th>
                        <th>ç•¥ç§°</th>
                        <th>ç‰¹å¾´</th>
                        <th>ç²¾åº¦</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Local Density Approximation</td>
                        <td>LDA</td>
                        <td>å„ç‚¹ã§ä¸€æ§˜é›»å­ã‚¬ã‚¹ã®äº¤æ›ç›¸é–¢ã‚’ä½¿ç”¨</td>
                        <td>æ ¼å­å®šæ•°ã‚’1-2%éå°è©•ä¾¡</td>
                    </tr>
                    <tr>
                        <td>Generalized Gradient Approximation</td>
                        <td>GGA (PBE, PW91)</td>
                        <td>é›»å­å¯†åº¦ã®å‹¾é…ã‚‚è€ƒæ…®</td>
                        <td>LDAã‚ˆã‚Šæ”¹å–„ã€æ¨™æº–çš„é¸æŠ</td>
                    </tr>
                    <tr>
                        <td>Meta-GGA</td>
                        <td>SCAN, TPSS</td>
                        <td>é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼å¯†åº¦ã‚‚ä½¿ç”¨</td>
                        <td>GGAã‚ˆã‚Šé«˜ç²¾åº¦</td>
                    </tr>
                    <tr>
                        <td>Hybrid Functional</td>
                        <td>HSE06, PBE0</td>
                        <td>Hartree-Fockäº¤æ›ã‚’æ··åˆ</td>
                        <td>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ç²¾åº¦å‘ä¸Šï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆé«˜ï¼‰</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <strong>ğŸ’¡ Pro Tip: æ±é–¢æ•°ã®é¸ã³æ–¹</strong>
                <p>
                    <strong>é‡‘å±ãƒ»åˆé‡‘</strong>: GGA (PBE)ãŒæ¨™æº–ã€‚LDAã‚‚å¯ã€‚<br>
                    <strong>åŠå°ä½“ãƒ»çµ¶ç¸ä½“</strong>: GGA (PBE)ã§æ§‹é€ ã€HSE06ã§ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—è£œæ­£ã€‚<br>
                    <strong>åˆ†å­</strong>: GGA (PBE)ã¾ãŸã¯Meta-GGA (SCAN)ã€‚<br>
                    <strong>å¼·ç›¸é–¢ç³»</strong>: DFT+Uã‚„ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ±é–¢æ•°ãŒå¿…è¦ã€‚
                </p>
            </div>

            <h3>è‡ªå·±ç„¡æ’ç€è¨ˆç®—ï¼ˆSCF: Self-Consistent Fieldï¼‰</h3>
            <p>
                Kohn-Shamæ–¹ç¨‹å¼ã¯æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãŒé›»å­å¯†åº¦ã«ä¾å­˜ã™ã‚‹ãŸã‚ã€è‡ªå·±ç„¡æ’ç€ã«è§£ãå¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
            </p>

            <div class="mermaid">
flowchart TD
    A[åˆæœŸé›»å­å¯†åº¦ n_in ã‚’æ¨æ¸¬] --> B[æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« V_eff ã‚’è¨ˆç®—]
    B --> C[Kohn-Shamæ–¹ç¨‹å¼ã‚’è§£ã]
    C --> D[æ–°ã—ã„é›»å­å¯†åº¦ n_out ã‚’è¨ˆç®—]
    D --> E{|n_out - n_in| < åæŸåˆ¤å®š?}
    E -->|No| F[n_in ã‚’æ›´æ–°<br/>æ··åˆ: n_in_new = Î±Â·n_in + 1-Î±Â·n_out]
    F --> B
    E -->|Yes| G[åæŸå®Œäº†<br/>å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»é›»å­æ§‹é€ ã‚’å‡ºåŠ›]

    style A fill:#ffd6d6
    style G fill:#d6f5d6
    style E fill:#fff3cd
            </div>
        </section>

        <section id="qe-features">
            <h2>1.3 Quantum ESPRESSOã®ç‰¹å¾´</h2>

            <h3>å¹³é¢æ³¢åŸºåº•ï¼ˆPlane Wave Basisï¼‰</h3>
            <p>
                Quantum ESPRESSOã¯ã€å‘¨æœŸç³»ï¼ˆçµæ™¶ï¼‰ã®æ³¢å‹•é–¢æ•°ã‚’å¹³é¢æ³¢ã®é‡ã­åˆã‚ã›ã§è¡¨ç¾ã—ã¾ã™ã€‚
            </p>

            <p style="text-align: center;">
                \[
                \psi_i(\mathbf{r}) = \sum_{\mathbf{G}} c_{i,\mathbf{G}} e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}}
                \]
            </p>

            <p>
                ã“ã“ã§ \(\mathbf{G}\) ã¯é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã€\(\mathbf{k}\) ã¯Blochæ³¢æ•°ãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚
            </p>

            <h4>å¹³é¢æ³¢åŸºåº•ã®åˆ©ç‚¹</h4>
            <ul>
                <li>âœ… <strong>ç³»çµ±çš„åæŸ</strong>: ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¢—ã‚„ã›ã°ç²¾åº¦ãŒå‘ä¸Šï¼ˆåŸºåº•æ•°ã«ä¾å­˜ã—ãªã„ï¼‰</li>
                <li>âœ… <strong>å‘¨æœŸç³»ã«æœ€é©</strong>: Blochã®å®šç†ã‚’è‡ªç„¶ã«æº€ãŸã™</li>
                <li>âœ… <strong>ãƒ•ã‚©ãƒ¼ã‚¹è¨ˆç®—ãŒæ­£ç¢º</strong>: Hellmann-Feynmanå®šç†ã§è§£æçš„ã«è¨ˆç®—å¯èƒ½</li>
                <li>âœ… <strong>FFTé«˜é€ŸåŒ–</strong>: Fast Fourier Transformã§å®Ÿç©ºé–“â‡„é€†ç©ºé–“ã®å¤‰æ›ãŒé«˜é€Ÿ</li>
            </ul>

            <h4>ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼</h4>
            <p>
                å®Ÿéš›ã®è¨ˆç®—ã§ã¯ã€é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒä¸€å®šå€¤ï¼ˆã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(E_{\text{cut}}\)ï¼‰ä»¥ä¸‹ã®å¹³é¢æ³¢ã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
            </p>

            <p style="text-align: center;">
                \[
                \frac{\hbar^2}{2m}|\mathbf{k}+\mathbf{G}|^2 \leq E_{\text{cut}}
                \]
            </p>

            <p>
                å…¸å‹çš„ãªã‚«ãƒƒãƒˆã‚ªãƒ•: 30-80 Ryï¼ˆãƒªãƒ¥ãƒ¼ãƒ‰ãƒ™ãƒªã€1 Ry = 13.6 eVï¼‰ã€‚æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ç¨®é¡ã«ã‚ˆã£ã¦å¿…è¦ãªã‚«ãƒƒãƒˆã‚ªãƒ•ãŒç•°ãªã‚Šã¾ã™ã€‚
            </p>

            <h3>æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆPseudopotentialï¼‰</h3>
            <p>
                å†…æ®»é›»å­ï¼ˆåŒ–å­¦çš„ã«ä¸æ´»æ€§ï¼‰ã‚’æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã§ç½®ãæ›ãˆã€ä¾¡é›»å­ã®ã¿ã‚’æ˜ç¤ºçš„ã«æ‰±ã„ã¾ã™ã€‚
            </p>

            <div class="mermaid">
flowchart LR
    A[å…¨é›»å­è¨ˆç®—] --> B[å†…æ®»: 1s, 2s, 2p<br/>ä¾¡é›»å­: 3s, 3p]
    B --> C[å¹³é¢æ³¢åŸºåº•ã§ã¯<br/>å†…æ®»è»Œé“ã®è¨˜è¿°ã«<br/>å¤§é‡ã®å¹³é¢æ³¢ãŒå¿…è¦]

    D[æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«] --> E[ä¾¡é›»å­ã®ã¿: 3s, 3p]
    E --> F[å†…æ®»ã¯æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã§è¿‘ä¼¼<br/>â†’ å°‘ãªã„å¹³é¢æ³¢ã§è¨˜è¿°å¯èƒ½]

    style C fill:#ffd6d6
    style F fill:#d6f5d6
            </div>

            <h4>æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ç¨®é¡</h4>
            <table>
                <thead>
                    <tr>
                        <th>ç¨®é¡</th>
                        <th>ç‰¹å¾´</th>
                        <th>ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼</th>
                        <th>æ¨å¥¨ç”¨é€”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>ãƒãƒ«ãƒ ä¿å­˜ï¼ˆNCPPï¼‰</td>
                        <td>å…¨é›»å­æ³¢å‹•é–¢æ•°ã«è¿‘ã„</td>
                        <td>é«˜ã„ï¼ˆ60-100 Ryï¼‰</td>
                        <td>é«˜ç²¾åº¦è¨ˆç®—ã€è»½å…ƒç´ </td>
                    </tr>
                    <tr>
                        <td>ã‚¦ãƒ«ãƒˆãƒ©ã‚½ãƒ•ãƒˆï¼ˆUSPPï¼‰</td>
                        <td>ä½ã‚«ãƒƒãƒˆã‚ªãƒ•ã§é«˜ç²¾åº¦</td>
                        <td>ä¸­ç¨‹åº¦ï¼ˆ30-50 Ryï¼‰</td>
                        <td>æ¨™æº–çš„é¸æŠã€é·ç§»é‡‘å±</td>
                    </tr>
                    <tr>
                        <td>PAWï¼ˆProjector Augmented Waveï¼‰</td>
                        <td>USPPã®æ”¹è‰¯ç‰ˆ</td>
                        <td>ä¸­ç¨‹åº¦ï¼ˆ30-50 Ryï¼‰</td>
                        <td>ç£æ€§ã€d/fé›»å­ç³»</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <strong>ğŸ’¡ æ¨å¥¨æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</strong>
                <ul>
                    <li><strong>SSSP (Standard Solid-State Pseudopotentials)</strong>: ç²¾åº¦æ¤œè¨¼æ¸ˆã¿ã€Materials Projectã§ä½¿ç”¨</li>
                    <li><strong>PseudoDojo</strong>: ç³»çµ±çš„æ¤œè¨¼ã€ç²¾åº¦ãƒ»åŠ¹ç‡ã®ãƒãƒ©ãƒ³ã‚¹</li>
                    <li><strong>pslibrary</strong>: QEå…¬å¼ã€å¤šæ§˜ãªå…ƒç´ ãƒ»æ±é–¢æ•°</li>
                </ul>
            </div>

            <h3>Quantum ESPRESSOã®ä¸»è¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ </h3>
            <table>
                <thead>
                    <tr>
                        <th>ãƒ—ãƒ­ã‚°ãƒ©ãƒ </th>
                        <th>ç”¨é€”</th>
                        <th>å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>pw.x</code></td>
                        <td>SCFè¨ˆç®—ã€æ§‹é€ æœ€é©åŒ–ã€ãƒãƒ³ãƒ‰è¨ˆç®—</td>
                        <td>*.in</td>
                    </tr>
                    <tr>
                        <td><code>ph.x</code></td>
                        <td>ãƒ•ã‚©ãƒãƒ³è¨ˆç®—ã€èª˜é›»ç‡ã€Bornæœ‰åŠ¹é›»è·</td>
                        <td>*.ph.in</td>
                    </tr>
                    <tr>
                        <td><code>pp.x</code></td>
                        <td>é›»è·å¯†åº¦ãƒ»ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ãƒã‚¹ãƒˆãƒ—ãƒ­ã‚»ã‚¹</td>
                        <td>*.pp.in</td>
                    </tr>
                    <tr>
                        <td><code>dos.x</code></td>
                        <td>çŠ¶æ…‹å¯†åº¦ï¼ˆDOSï¼‰è¨ˆç®—</td>
                        <td>*.dos.in</td>
                    </tr>
                    <tr>
                        <td><code>bands.x</code></td>
                        <td>ãƒãƒ³ãƒ‰æ§‹é€ ãƒ‡ãƒ¼ã‚¿æ•´å½¢</td>
                        <td>*.bands.in</td>
                    </tr>
                    <tr>
                        <td><code>projwfc.x</code></td>
                        <td>å°„å½±çŠ¶æ…‹å¯†åº¦ï¼ˆPDOSï¼‰ã€Lowdiné›»è·</td>
                        <td>*.projwfc.in</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="installation">
            <h2>1.4 Quantum ESPRESSOã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼ˆLinuxï¼‰</h3>
            <pre><code class="language-bash">#!/bin/bash
# ===================================
# Quantum ESPRESSO 7.2ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# ===================================

# å‰æãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆUbuntu/Debianï¼‰
sudo apt-get update
sudo apt-get install -y build-essential gfortran mpich libopenmpi-dev \
    libfftw3-dev libblas-dev liblapack-dev wget git

# ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
cd /tmp
wget https://github.com/QEF/q-e/releases/download/qe-7.2/qe-7.2-ReleasePack.tar.gz
tar xzf qe-7.2-ReleasePack.tar.gz
cd qe-7.2

# ç’°å¢ƒè¨­å®šã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
./configure --prefix=$HOME/qe-7.2 \
            --enable-parallel \
            --with-scalapack=no

# ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼ˆä¸¦åˆ—ãƒ“ãƒ«ãƒ‰: -j4 ã¯4ã‚³ã‚¢ä½¿ç”¨ï¼‰
make all -j4

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
make install

# ç’°å¢ƒå¤‰æ•°ã®è¨­å®šï¼ˆ~/.bashrcã«è¿½åŠ ï¼‰
echo 'export PATH=$HOME/qe-7.2/bin:$PATH' >> ~/.bashrc
source ~/.bashrc

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
pw.x -v
# å‡ºåŠ›ä¾‹: Program PWSCF v.7.2 starts on  1Nov2025 at 12:00:00

echo "Quantum ESPRESSO 7.2ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¾ã—ãŸã€‚"
</code></pre>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: Condaã§ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæ¨å¥¨: ç°¡å˜ï¼‰</h3>
            <pre><code class="language-bash"># ===================================
# Condaç’°å¢ƒã§ã®Quantum ESPRESSOã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
# ===================================

# Condaç’°å¢ƒä½œæˆ
conda create -n qe python=3.10 -y
conda activate qe

# Quantum ESPRESSOã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
conda install -c conda-forge qe -y

# ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
pw.x -v

# ASEï¼ˆæ§‹é€ æ“ä½œç”¨ï¼‰ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
conda install -c conda-forge ase -y
pip install pymatgen

# ç’°å¢ƒã®ä¿å­˜
conda env export > qe_environment.yml

echo "Condaç’°å¢ƒã§ã®QEã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¾ã—ãŸã€‚"
echo "æ¬¡å›ã‹ã‚‰ã¯: conda activate qe"
</code></pre>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèªã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>
            <pre><code class="language-bash">#!/bin/bash
# ===================================
# Quantum ESPRESSOã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
# ===================================

echo "=== Quantum ESPRESSOã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª ==="

# ä¸»è¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç¢ºèª
for prog in pw.x ph.x pp.x dos.x bands.x projwfc.x; do
    if command -v $prog &> /dev/null; then
        echo "âœ… $prog: $(which $prog)"
    else
        echo "âŒ $prog: NOT FOUND"
    fi
done

# ä¸¦åˆ—å®Ÿè¡Œã®ç¢ºèª
if command -v mpirun &> /dev/null; then
    echo "âœ… MPI: $(which mpirun)"
    mpirun --version | head -1
else
    echo "âš ï¸ MPI: NOT FOUNDï¼ˆã‚·ãƒªã‚¢ãƒ«å®Ÿè¡Œã®ã¿ï¼‰"
fi

# æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç¢ºèª
if [ -d "$HOME/pseudo" ]; then
    echo "âœ… æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«: $HOME/pseudo"
    echo "   ãƒ•ã‚¡ã‚¤ãƒ«æ•°: $(ls $HOME/pseudo/*.UPF 2>/dev/null | wc -l)"
else
    echo "âš ï¸ æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæœªè¨­å®š"
    echo "   æ¨å¥¨: mkdir -p $HOME/pseudo"
fi

echo ""
echo "=== ã‚·ã‚¹ãƒ†ãƒ æƒ…å ± ==="
echo "OS: $(uname -s)"
echo "CPU cores: $(nproc)"
echo "Total RAM: $(free -h | awk '/^Mem:/{print $2}')"
</code></pre>

            <h3>æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h3>
            <pre><code class="language-bash">#!/bin/bash
# ===================================
# SSSPæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
# ===================================

# æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ä¿å­˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
mkdir -p $HOME/pseudo
cd $HOME/pseudo

# SSSP efficiency libraryï¼ˆPBEï¼‰ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
wget https://legacy-archive.materialscloud.org/file/2018.0001/v4/SSSP_1.1.2_PBE_efficiency.tar.gz
tar xzf SSSP_1.1.2_PBE_efficiency.tar.gz
mv SSSP_1.1.2_PBE_efficiency/*.UPF .
rm -rf SSSP_1.1.2_PBE_efficiency*

# SSSP precision libraryï¼ˆé«˜ç²¾åº¦ç‰ˆã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
# wget https://legacy-archive.materialscloud.org/file/2018.0001/v4/SSSP_1.1.2_PBE_precision.tar.gz

echo "æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã—ã¾ã—ãŸã€‚"
echo "ä¿å­˜å…ˆ: $HOME/pseudo"
ls -lh *.UPF | head -5
</code></pre>

            <div class="warning-box">
                <strong>âš ï¸ ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</strong>
                <ul>
                    <li><strong>configureå¤±æ•—</strong>: ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ï¼ˆgfortranï¼‰ã¨MPIï¼ˆmpich/openmpiï¼‰ãŒå¿…è¦</li>
                    <li><strong>BLAS/LAPACK not found</strong>: <code>sudo apt-get install libblas-dev liblapack-dev</code></li>
                    <li><strong>FFTW not found</strong>: <code>sudo apt-get install libfftw3-dev</code></li>
                    <li><strong>ä¸¦åˆ—åŒ–ã‚¨ãƒ©ãƒ¼</strong>: <code>./configure --disable-parallel</code> ã§ã‚·ãƒªã‚¢ãƒ«ç‰ˆã‚’ãƒ“ãƒ«ãƒ‰</li>
                </ul>
            </div>
        </section>

        <section id="input-structure">
            <h2>1.5 Quantum ESPRESSOå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹é€ </h2>

            <h3>pw.xå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬æ§‹é€ </h3>
            <p>
                pw.xï¼ˆPWscf: Plane-Wave Self-Consistent Fieldï¼‰ã®å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ä»¥ä¸‹ã®<strong>ãƒŠãƒ ãƒªã‚¹ãƒˆ</strong>ã¨<strong>ã‚«ãƒ¼ãƒ‰</strong>ã‹ã‚‰æ§‹æˆã•ã‚Œã¾ã™ã€‚
            </p>

            <pre><code class="language-fortran">&CONTROL
  ! è¨ˆç®—ã‚¿ã‚¤ãƒ—ã€ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®š
/

&SYSTEM
  ! ç³»ã®å®šç¾©ï¼ˆåŸå­æ•°ã€ã‚»ãƒ«ã€é›»å­æ•°ç­‰ï¼‰
/

&ELECTRONS
  ! SCFè¨ˆç®—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
/

&IONS       ! æ§‹é€ æœ€é©åŒ–æ™‚ã®ã¿
  ! ã‚¤ã‚ªãƒ³ç·©å’Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
/

&CELL       ! ã‚»ãƒ«æœ€é©åŒ–æ™‚ã®ã¿
  ! ã‚»ãƒ«ç·©å’Œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
/

ATOMIC_SPECIES
 ! å…ƒç´ ã€è³ªé‡ã€æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«

ATOMIC_POSITIONS {alat | bohr | angstrom | crystal}
 ! åŸå­åº§æ¨™

K_POINTS {automatic | gamma | tpiba | crystal | tpiba_b}
 ! kç‚¹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°

CELL_PARAMETERS {alat | bohr | angstrom}
 ! ã‚»ãƒ«æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«
</code></pre>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: Siçµæ™¶ã®SCFè¨ˆç®—å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«</h3>
            <pre><code class="language-fortran">! ===================================
! Siçµæ™¶ã®SCFè¨ˆç®—ï¼ˆDiamondæ§‹é€ ã€fccæ ¼å­ï¼‰
! ===================================

&CONTROL
  calculation = 'scf'           ! Self-Consistent Fieldè¨ˆç®—
  prefix = 'si'                 ! å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®æ¥é ­è¾
  outdir = './tmp'              ! ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜å…ˆ
  pseudo_dir = '$HOME/pseudo'   ! æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
  verbosity = 'high'            ! å‡ºåŠ›ã®è©³ç´°åº¦
/

&SYSTEM
  ibrav = 2                     ! fcc Bravaisæ ¼å­
  celldm(1) = 10.26             ! æ ¼å­å®šæ•° a0 [Bohr]ï¼ˆSi: 5.43 Ã…ï¼‰
  nat = 2                       ! å˜ä½ã‚»ãƒ«å†…ã®åŸå­æ•°
  ntyp = 1                      ! å…ƒç´ ã®ç¨®é¡æ•°
  ecutwfc = 40.0                ! æ³¢å‹•é–¢æ•°ã®ã‚«ãƒƒãƒˆã‚ªãƒ• [Ry]
  ecutrho = 320.0               ! é›»è·å¯†åº¦ã®ã‚«ãƒƒãƒˆã‚ªãƒ• [Ry]ï¼ˆ= 8 Ã— ecutwfcï¼‰
/

&ELECTRONS
  conv_thr = 1.0d-8             ! SCFåæŸåˆ¤å®šé–¾å€¤ [Ry]
  mixing_beta = 0.7             ! é›»è·å¯†åº¦æ··åˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
/

ATOMIC_SPECIES
  Si  28.085  Si.pbe-n-kjpaw_psl.1.0.0.UPF  ! å…ƒç´ ã€è³ªé‡ã€æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«

ATOMIC_POSITIONS (alat)
  Si  0.00  0.00  0.00          ! ç¬¬1åŸå­: (0, 0, 0)
  Si  0.25  0.25  0.25          ! ç¬¬2åŸå­: (a/4, a/4, a/4)

K_POINTS automatic
  8 8 8  0 0 0                  ! Monkhorst-Pack: 8Ã—8Ã—8ãƒ¡ãƒƒã‚·ãƒ¥ã€ã‚·ãƒ•ãƒˆãªã—
</code></pre>

            <h3>ä¸»è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¬æ˜</h3>
            <table>
                <thead>
                    <tr>
                        <th>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</th>
                        <th>æ„å‘³</th>
                        <th>å…¸å‹çš„ãªå€¤</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>calculation</code></td>
                        <td>è¨ˆç®—ã‚¿ã‚¤ãƒ—</td>
                        <td>'scf', 'relax', 'vc-relax', 'bands', 'nscf'</td>
                    </tr>
                    <tr>
                        <td><code>ibrav</code></td>
                        <td>Bravaisæ ¼å­ã‚¿ã‚¤ãƒ—</td>
                        <td>0: è‡ªç”±ã€1: scã€2: fccã€3: bccã€4: hexç­‰</td>
                    </tr>
                    <tr>
                        <td><code>celldm(1)</code></td>
                        <td>æ ¼å­å®šæ•° a [Bohr]</td>
                        <td>5-30 Bohrï¼ˆ1 Bohr = 0.529177 Ã…ï¼‰</td>
                    </tr>
                    <tr>
                        <td><code>ecutwfc</code></td>
                        <td>æ³¢å‹•é–¢æ•°ã‚«ãƒƒãƒˆã‚ªãƒ• [Ry]</td>
                        <td>30-80 Ryï¼ˆæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ä¾å­˜ï¼‰</td>
                    </tr>
                    <tr>
                        <td><code>ecutrho</code></td>
                        <td>é›»è·å¯†åº¦ã‚«ãƒƒãƒˆã‚ªãƒ• [Ry]</td>
                        <td>NCPP: 4Ã—ecutwfcã€USPP: 8Ã—ecutwfc</td>
                    </tr>
                    <tr>
                        <td><code>conv_thr</code></td>
                        <td>SCFåæŸé–¾å€¤ [Ry]</td>
                        <td>1e-6ï¼ˆç·©ã„ï¼‰ã€œ 1e-10ï¼ˆå³ã—ã„ï¼‰</td>
                    </tr>
                    <tr>
                        <td><code>mixing_beta</code></td>
                        <td>é›»è·å¯†åº¦æ··åˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</td>
                        <td>0.3-0.7ï¼ˆé‡‘å±: å°ã•ã‚ã€åŠå°ä½“: å¤§ãã‚ï¼‰</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="first-calculation">
            <h2>1.6 åˆã‚ã¦ã®Quantum ESPRESSOè¨ˆç®—</h2>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: Si SCFè¨ˆç®—ã®å®Ÿè¡Œ</h3>
            <pre><code class="language-bash">#!/bin/bash
# ===================================
# Siçµæ™¶ã®SCFè¨ˆç®—å®Ÿè¡Œã‚¹ã‚¯ãƒªãƒ—ãƒˆ
# ===================================

# ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p si_scf
cd si_scf

# å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼ˆä¸Šè¨˜ã®si.inã‚’ä¿å­˜ï¼‰
cat > si.in << 'EOF'
&CONTROL
  calculation = 'scf'
  prefix = 'si'
  outdir = './tmp'
  pseudo_dir = '$HOME/pseudo'
/
&SYSTEM
  ibrav = 2
  celldm(1) = 10.26
  nat = 2
  ntyp = 1
  ecutwfc = 40.0
  ecutrho = 320.0
/
&ELECTRONS
  conv_thr = 1.0d-8
  mixing_beta = 0.7
/
ATOMIC_SPECIES
  Si  28.085  Si.pbe-n-kjpaw_psl.1.0.0.UPF
ATOMIC_POSITIONS (alat)
  Si  0.00  0.00  0.00
  Si  0.25  0.25  0.25
K_POINTS automatic
  8 8 8  0 0 0
EOF

# tmpãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p tmp

# ã‚·ãƒªã‚¢ãƒ«å®Ÿè¡Œ
pw.x < si.in > si.out

# ä¸¦åˆ—å®Ÿè¡Œï¼ˆ4ãƒ—ãƒ­ã‚»ã‚¹ï¼‰ã®å ´åˆ
# mpirun -np 4 pw.x < si.in > si.out

# çµæœç¢ºèª
echo "=== SCFè¨ˆç®—å®Œäº† ==="
echo "ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼:"
grep "!    total energy" si.out

echo ""
echo "Fermiã‚¨ãƒãƒ«ã‚®ãƒ¼:"
grep "Fermi energy" si.out

echo ""
echo "ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ï¼ˆåŠå°ä½“ã®å ´åˆï¼‰:"
grep "highest occupied" si.out
grep "lowest unoccupied" si.out
</code></pre>

            <h3>å‡ºåŠ›ã®è§£é‡ˆ</h3>
            <p>
                SCFè¨ˆç®—ã®ä¸»è¦ãªå‡ºåŠ›é …ç›®:
            </p>

            <pre><code class="language-text">!    total energy              =     -15.85623041 Ry
     Harris-Foulkes estimate   =     -15.85623041 Ry
     estimated scf accuracy    <       0.00000001 Ry

     The total energy is the sum of the following terms:

     one-electron contribution =       4.76543210 Ry
     hartree contribution      =       1.23456789 Ry
     xc contribution           =      -4.98765432 Ry
     ewald contribution        =     -16.87654321 Ry

     convergence has been achieved in   5 iterations
</code></pre>

            <ul>
                <li><strong>total energy</strong>: ç³»ã®å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆæœ€ã‚‚é‡è¦ãªå‡ºåŠ›ï¼‰</li>
                <li><strong>estimated scf accuracy</strong>: SCFåæŸç²¾åº¦ï¼ˆconv_thrä»¥ä¸‹ã§ã‚ã‚Œã°åæŸï¼‰</li>
                <li><strong>convergence achieved in N iterations</strong>: SCFåå¾©å›æ•°</li>
            </ul>

            <div class="info-box">
                <strong>ğŸ’¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®çµ¶å¯¾å€¤ã¯ç„¡æ„å‘³</strong>
                <p>
                    DFTè¨ˆç®—ã®å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®çµ¶å¯¾å€¤ã¯ã€æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å‚ç…§ç‚¹ã«ä¾å­˜ã™ã‚‹ãŸã‚ç‰©ç†çš„æ„å‘³ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚é‡è¦ãªã®ã¯<strong>ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®</strong>ã§ã™ï¼ˆä¾‹: æ§‹é€ æœ€é©åŒ–å‰å¾Œã€ç•°ãªã‚‹æ§‹é€ é–“ï¼‰ã€‚
                </p>
            </div>

            <h3>è¨ˆç®—æ™‚é–“ã¨ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã®ç¢ºèª</h3>
            <pre><code class="language-bash">#!/bin/bash
# ===================================
# è¨ˆç®—ãƒªã‚½ãƒ¼ã‚¹ä½¿ç”¨é‡ã®ç¢ºèª
# ===================================

# è¨ˆç®—æ™‚é–“
grep "PWSCF        :" si.out

# ä¾‹: PWSCF        :      5.23s CPU      5.45s WALL

# ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
grep "Estimated max" si.out

# ä¾‹: Estimated max dynamical RAM per process >      12.34 MB

# ä¸¦åˆ—åŠ¹ç‡ï¼ˆä¸¦åˆ—å®Ÿè¡Œæ™‚ï¼‰
grep "Parallel routines" si.out -A 10
</code></pre>
        </section>

        <section id="learning-objectives">
            <h2>1.7 å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

            <p>ã“ã®ç« ã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’èª¬æ˜ãƒ»å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p>

            <h3>åŸºæœ¬ç†è§£</h3>
            <ul>
                <li>âœ… DFTã®åŸºæœ¬åŸç†ï¼ˆKohn-Shamæ–¹ç¨‹å¼ã€äº¤æ›ç›¸é–¢æ±é–¢æ•°ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… å¹³é¢æ³¢åŸºåº•ã¨æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å½¹å‰²ã¨åˆ©ç‚¹ã‚’ç†è§£ã§ãã‚‹</li>
                <li>âœ… SCFè¨ˆç®—ã®è‡ªå·±ç„¡æ’ç€ã‚µã‚¤ã‚¯ãƒ«ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨kç‚¹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã®æ„å‘³ã‚’èª¬æ˜ã§ãã‚‹</li>
            </ul>

            <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
            <ul>
                <li>âœ… Quantum ESPRESSOã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã‚‹</li>
                <li>âœ… pw.xå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®åŸºæœ¬æ§‹é€ ã‚’ç†è§£ã—ã€ä½œæˆã§ãã‚‹</li>
                <li>âœ… Siçµæ™¶ã®SCFè¨ˆç®—ã‚’å®Ÿè¡Œã§ãã‚‹</li>
                <li>âœ… å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€åæŸæƒ…å ±ã‚’èª­ã¿å–ã‚Œã‚‹</li>
                <li>âœ… æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€é©åˆ‡ã«é…ç½®ã§ãã‚‹</li>
            </ul>

            <h3>å¿œç”¨åŠ›</h3>
            <ul>
                <li>âœ… ç•°ãªã‚‹çµæ™¶ç³»ï¼ˆbcc, hcpç­‰ï¼‰ã®å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã§ãã‚‹</li>
                <li>âœ… SCFåæŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆconv_thr, mixing_betaï¼‰ã‚’èª¿æ•´ã§ãã‚‹</li>
                <li>âœ… è¨ˆç®—çµæœã®å¦¥å½“æ€§ã‚’åˆ¤æ–­ã§ãã‚‹ï¼ˆåæŸç¢ºèªã€ã‚¨ãƒãƒ«ã‚®ãƒ¼å˜ä½ï¼‰</li>
                <li>âœ… äº¤æ›ç›¸é–¢æ±é–¢æ•°ï¼ˆLDA, GGA, HSE06ï¼‰ã®é¸æŠãŒã§ãã‚‹</li>
            </ul>
        </section>

        <section id="exercises">
            <h2>1.8 æ¼”ç¿’å•é¡Œ</h2>

            <div class="exercise-box">
                <h4>Easy 1: DFTåŸºç¤ç†è«–<span class="difficulty easy">åŸºç¤</span></h4>
                <p><strong>å•é¡Œ</strong>: Hohenberg-Kohnã®ç¬¬1å®šç†ãŒç¤ºã™ã€Œé›»å­å¯†åº¦ã¨å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®é–¢ä¿‚ã€ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>: å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« \(v_{\text{ext}}(\mathbf{r})\) ã¯ã€åŸºåº•çŠ¶æ…‹ã®é›»å­å¯†åº¦ \(n(\mathbf{r})\) ã«ã‚ˆã£ã¦ä¸€æ„ã«æ±ºã¾ã‚‹ï¼ˆ1å¯¾1å¯¾å¿œï¼‰ã€‚</p>
                    <p><strong>è§£èª¬</strong>: ã“ã‚Œã«ã‚ˆã‚Šã€å¤šä½“æ³¢å‹•é–¢æ•°ï¼ˆ3Næ¬¡å…ƒï¼‰ã®ä»£ã‚ã‚Šã«é›»å­å¯†åº¦ï¼ˆ3æ¬¡å…ƒï¼‰ã‚’åŸºæœ¬å¤‰æ•°ã¨ã—ã¦æ‰±ã†ã“ã¨ãŒã§ãã€è¨ˆç®—ã‚³ã‚¹ãƒˆãŒå¤§å¹…ã«å‰Šæ¸›ã•ã‚Œã¾ã™ã€‚DFTã®åŸºç¤ã¨ãªã‚‹é‡è¦ãªå®šç†ã§ã™ã€‚</p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Easy 2: æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ç¨®é¡<span class="difficulty easy">åŸºç¤</span></h4>
                <p><strong>å•é¡Œ</strong>: ã‚¦ãƒ«ãƒˆãƒ©ã‚½ãƒ•ãƒˆæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆUSPPï¼‰ã¨ãƒãƒ«ãƒ ä¿å­˜æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆNCPPï¼‰ã®é•ã„ã‚’ã€ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>: USPPã¯ä½ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆ30-50 Ryï¼‰ã§é«˜ç²¾åº¦ã‚’é”æˆã§ãã‚‹ãŒã€NCPPã¯é«˜ã‚«ãƒƒãƒˆã‚ªãƒ•ï¼ˆ60-100 Ryï¼‰ãŒå¿…è¦ã€‚</p>
                    <p><strong>è§£èª¬</strong>: NCPPã¯å…¨é›»å­æ³¢å‹•é–¢æ•°ã®ãƒãƒ«ãƒ ã‚’ä¿å­˜ã™ã‚‹ãŸã‚ç²¾åº¦ã¯é«˜ã„ãŒã€å¤šãã®å¹³é¢æ³¢ãŒå¿…è¦ã§ã™ã€‚USPPã¯ãƒãƒ«ãƒ ä¿å­˜æ¡ä»¶ã‚’ç·©ã‚ã‚‹ã“ã¨ã§ã€å°‘ãªã„å¹³é¢æ³¢ã§åŒç­‰ã®ç²¾åº¦ã‚’å®Ÿç¾ã—ã¾ã™ã€‚è¨ˆç®—ã‚³ã‚¹ãƒˆã®è¦³ç‚¹ã‹ã‚‰USPPãŒæ¨™æº–çš„é¸æŠã§ã™ã€‚</p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Medium 1: å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ<span class="difficulty medium">å¿œç”¨</span></h4>
                <p><strong>å•é¡Œ</strong>: Alï¼ˆaluminumï¼‰é‡‘å±ã®SCFè¨ˆç®—å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚Alã¯fccæ§‹é€ ã€æ ¼å­å®šæ•° a = 4.05 Ã… ã§ã™ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <pre><code class="language-fortran">&CONTROL
  calculation = 'scf'
  prefix = 'al'
  outdir = './tmp'
  pseudo_dir = '$HOME/pseudo'
/
&SYSTEM
  ibrav = 2                     ! fcc
  celldm(1) = 7.65              ! 4.05 Ã… Ã— 1.88973 = 7.65 Bohr
  nat = 1                       ! fccã®å˜ä½ã‚»ãƒ«ã¯1åŸå­
  ntyp = 1
  ecutwfc = 40.0
  ecutrho = 320.0
  occupations = 'smearing'      ! é‡‘å±ã«ã¯smearingå¿…é ˆ
  smearing = 'mv'               ! Marzari-Vanderbilt
  degauss = 0.02                ! ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°å¹… [Ry]
/
&ELECTRONS
  conv_thr = 1.0d-8
  mixing_beta = 0.3             ! é‡‘å±ã¯å°ã•ã‚
/
ATOMIC_SPECIES
  Al  26.982  Al.pbe-n-kjpaw_psl.1.0.0.UPF
ATOMIC_POSITIONS (alat)
  Al  0.00  0.00  0.00
K_POINTS automatic
  12 12 12  0 0 0               ! é‡‘å±ã¯é«˜å¯†åº¦kç‚¹ãŒå¿…è¦
</code></pre>
                    <p><strong>é‡è¦ãƒã‚¤ãƒ³ãƒˆ</strong>:</p>
                    <ul>
                        <li>é‡‘å±ã«ã¯ <code>occupations = 'smearing'</code> ãŒå¿…é ˆï¼ˆFermié¢ã®è¨˜è¿°ï¼‰</li>
                        <li><code>mixing_beta</code> ã¯å°ã•ã‚ï¼ˆ0.3ç¨‹åº¦ï¼‰ã«ã—ã¦åæŸæ€§ã‚’å‘ä¸Š</li>
                        <li>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã¯åŠå°ä½“ã‚ˆã‚Šå¯†ã«ã™ã‚‹ï¼ˆ12Ã—12Ã—12ç¨‹åº¦ï¼‰</li>
                    </ul>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Medium 2: å˜ä½æ›ç®—<span class="difficulty medium">å¿œç”¨</span></h4>
                <p><strong>å•é¡Œ</strong>: GaNï¼ˆçª’åŒ–ã‚¬ãƒªã‚¦ãƒ ï¼‰ã®wurtziteæ§‹é€ ã®æ ¼å­å®šæ•°ã¯ a = 3.19 Ã…ã€c = 5.19 Ã… ã§ã™ã€‚ã“ã‚Œã‚’Bohrå˜ä½ã«å¤‰æ›ã—ã€<code>celldm(1)</code> ã¨ <code>celldm(3)</code> ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ï¼ˆ1 Bohr = 0.529177 Ã…ï¼‰ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è¨ˆç®—</strong>:</p>
                    <ul>
                        <li><code>celldm(1)</code> = a [Ã…] / 0.529177 = 3.19 / 0.529177 = 6.029 Bohr</li>
                        <li><code>celldm(3)</code> = c / a = 5.19 / 3.19 = 1.627</li>
                    </ul>
                    <p><strong>å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ä¾‹</strong>:</p>
                    <pre><code class="language-fortran">&SYSTEM
  ibrav = 4                     ! hexagonal (wurtzite)
  celldm(1) = 6.029             ! a [Bohr]
  celldm(3) = 1.627             ! c/a ratio
  nat = 4
  ntyp = 2
  ...
/
</code></pre>
                    <p><strong>æ³¨æ„</strong>: ibrav=4ï¼ˆhexagonalï¼‰ã§ã¯ã€<code>celldm(3)</code> ã¯ c/a ã®æ¯”ç‡ã‚’æŒ‡å®šã—ã¾ã™ã€‚</p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Hard 1: ã‚«ãƒƒãƒˆã‚ªãƒ•åæŸãƒ†ã‚¹ãƒˆ<span class="difficulty hard">ç™ºå±•</span></h4>
                <p><strong>å•é¡Œ</strong>: Siçµæ™¶ã®SCFè¨ˆç®—ã§ã€ecutwfc ã‚’ 20, 30, 40, 50, 60 Ry ã¨å¤‰ãˆã¦å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åæŸã‚’ç¢ºèªã™ã‚‹ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <pre><code class="language-bash">#!/bin/bash
# ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸãƒ†ã‚¹ãƒˆ

for ecut in 20 30 40 50 60; do
    echo "=== ecutwfc = $ecut Ry ==="

    # å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼ˆecutwfcã®ã¿å¤‰æ›´ï¼‰
    cat > si_ecut_${ecut}.in << EOF
&CONTROL
  calculation = 'scf'
  prefix = 'si_ecut_${ecut}'
  outdir = './tmp'
  pseudo_dir = '\$HOME/pseudo'
/
&SYSTEM
  ibrav = 2
  celldm(1) = 10.26
  nat = 2
  ntyp = 1
  ecutwfc = ${ecut}.0
  ecutrho = $(echo "$ecut * 8" | bc).0
/
&ELECTRONS
  conv_thr = 1.0d-8
/
ATOMIC_SPECIES
  Si  28.085  Si.pbe-n-kjpaw_psl.1.0.0.UPF
ATOMIC_POSITIONS (alat)
  Si  0.00  0.00  0.00
  Si  0.25  0.25  0.25
K_POINTS automatic
  8 8 8  0 0 0
EOF

    # è¨ˆç®—å®Ÿè¡Œ
    pw.x < si_ecut_${ecut}.in > si_ecut_${ecut}.out

    # ã‚¨ãƒãƒ«ã‚®ãƒ¼æŠ½å‡º
    energy=$(grep "!    total energy" si_ecut_${ecut}.out | awk '{print $5}')
    echo "Total energy: $energy Ry"
done

# çµæœã¾ã¨ã‚
echo ""
echo "=== åæŸãƒ†ã‚¹ãƒˆçµæœ ==="
for ecut in 20 30 40 50 60; do
    energy=$(grep "!    total energy" si_ecut_${ecut}.out | awk '{print $5}')
    printf "ecutwfc = %2d Ry: E = %15.8f Ry\n" $ecut $energy
done
</code></pre>
                    <p><strong>æœŸå¾…ã•ã‚Œã‚‹çµæœ</strong>: ecutwfc = 40 Ry ä»¥ä¸Šã§ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒ <1 meV/atom ã®ç¯„å›²ã«åæŸã€‚</p>
                    <p><strong>å­¦ã³</strong>: å®Ÿéš›ã®ç ”ç©¶ã§ã¯ã€å¿…ãšã‚«ãƒƒãƒˆã‚ªãƒ•ãƒ»kç‚¹ãƒ»ã‚»ãƒ«ã‚µã‚¤ã‚ºã®åæŸãƒ†ã‚¹ãƒˆã‚’è¡Œã„ã¾ã™ã€‚</p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Hard 2: äº¤æ›ç›¸é–¢æ±é–¢æ•°ã®æ¯”è¼ƒ<span class="difficulty hard">ç™ºå±•</span></h4>
                <p><strong>å•é¡Œ</strong>: Siçµæ™¶ã®æ ¼å­å®šæ•°ã‚’ã€LDAã¨GGAï¼ˆPBEï¼‰ã®2ã¤ã®æ±é–¢æ•°ã§è¨ˆç®—ã—ã€å®Ÿé¨“å€¤ï¼ˆ5.43 Ã…ï¼‰ã¨æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚ã©ã¡ã‚‰ãŒå®Ÿé¨“å€¤ã«è¿‘ã„ã§ã™ã‹ï¼Ÿ</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>ç†è«–äºˆæ¸¬</strong>:</p>
                    <ul>
                        <li>LDA: æ ¼å­å®šæ•°ã‚’1-2%éå°è©•ä¾¡ï¼ˆçµåˆãŒå¼·ã™ãã‚‹ï¼‰</li>
                        <li>GGA (PBE): LDAã‚ˆã‚Šæ”¹å–„ã€å®Ÿé¨“å€¤ã«è¿‘ã„ï¼ˆã‚„ã‚„éå¤§è©•ä¾¡å‚¾å‘ï¼‰</li>
                    </ul>
                    <p><strong>è¨ˆç®—æ–¹æ³•</strong>:</p>
                    <ol>
                        <li>LDAç”¨æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆSi.pz-*.UPFï¼‰ã¨PBEç”¨ï¼ˆSi.pbe-*.UPFï¼‰ã‚’ç”¨æ„</li>
                        <li>calculation='vc-relax'ã§æ ¼å­å®šæ•°ã‚’æœ€é©åŒ–</li>
                        <li>æœ€é©åŒ–å¾Œã® celldm(1) ã‹ã‚‰æ ¼å­å®šæ•°ã‚’è¨ˆç®—</li>
                    </ol>
                    <p><strong>å…¸å‹çš„ãªçµæœ</strong>:</p>
                    <ul>
                        <li>LDA: a â‰ˆ 5.38 Ã…ï¼ˆ-0.9%ï¼‰</li>
                        <li>GGA (PBE): a â‰ˆ 5.47 Ã…ï¼ˆ+0.7%ï¼‰</li>
                        <li>å®Ÿé¨“å€¤: a = 5.43 Ã…</li>
                    </ul>
                    <p><strong>çµè«–</strong>: GGA (PBE)ã®æ–¹ãŒå®Ÿé¨“å€¤ã«è¿‘ãã€æ¨™æº–çš„é¸æŠã¨ã—ã¦æ¨å¥¨ã•ã‚Œã¾ã™ã€‚</p>
                </details>
            </div>
        </section>

        <section id="references">
            <h2>1.9 å‚è€ƒæ–‡çŒ®</h2>

            <ol>
                <li>Giannozzi, P., et al. (2009). "QUANTUM ESPRESSO: a modular and open-source software project for quantum simulations of materials." <em>Journal of Physics: Condensed Matter</em>, 21(39), 395502. <a href="https://doi.org/10.1088/0953-8984/21/39/395502" target="_blank">DOI</a></li>
                <li>Giannozzi, P., et al. (2017). "Advanced capabilities for materials modelling with Quantum ESPRESSO." <em>Journal of Physics: Condensed Matter</em>, 29(46), 465901. <a href="https://doi.org/10.1088/1361-648X/aa8f79" target="_blank">DOI</a></li>
                <li>Hohenberg, P., & Kohn, W. (1964). "Inhomogeneous Electron Gas." <em>Physical Review</em>, 136(3B), B864-B871. ï¼ˆpp. B864-B871ï¼‰</li>
                <li>Kohn, W., & Sham, L. J. (1965). "Self-Consistent Equations Including Exchange and Correlation Effects." <em>Physical Review</em>, 140(4A), A1133-A1138. ï¼ˆpp. A1133-A1138ï¼‰</li>
                <li>Perdew, J. P., Burke, K., & Ernzerhof, M. (1996). "Generalized Gradient Approximation Made Simple." <em>Physical Review Letters</em>, 77(18), 3865-3868. ï¼ˆpp. 3865-3868ã€PBEæ±é–¢æ•°ã®åŸè«–æ–‡ï¼‰</li>
                <li>Prandini, G., et al. (2018). "Precision and efficiency in solid-state pseudopotential calculations." <em>npj Computational Materials</em>, 4(1), 72. ï¼ˆSSSPæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰</li>
                <li>Quantum ESPRESSO Foundation. (2024). <em>Quantum ESPRESSO Documentation</em>. <a href="https://www.quantum-espresso.org/documentation/" target="_blank">https://www.quantum-espresso.org/documentation/</a></li>
            </ol>
        </section>

        <section id="navigation">
            <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>
            <p>æœ¬ç« ã§ã€Quantum ESPRESSOã®åŸºç¤ã¨DFTç†è«–ã€ç’°å¢ƒæ§‹ç¯‰ã‚’ç†è§£ã—ã¾ã—ãŸã€‚æ¬¡ç« ã§ã¯ã€å®Ÿéš›ã®è¨ˆç®—ã«å¿…è¦ãªçµæ™¶æ§‹é€ ã®æº–å‚™ã€kç‚¹ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã€æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é¸æŠã€ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±ºå®šã‚’å®Ÿè·µã—ã¾ã™ã€‚</p>
            <div style="display: flex; justify-content: space-between; margin-top: 2rem; padding-top: 1rem; border-top: 2px solid var(--border-light);">
                <a href="index.html" style="padding: 1rem 2rem; background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%); color: white; border-radius: 8px; text-decoration: none; font-weight: 600;">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a>
                <a href="chapter-2.html" style="padding: 1rem 2rem; background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%); color: white; border-radius: 8px; text-decoration: none; font-weight: 600;">ç¬¬2ç« : çµæ™¶æ§‹é€ ã®æº–å‚™ã¨å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ« â†’</a>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 CT Dojo. All rights reserved.</p>
        <p><a href="https://github.com/yourusername/quantum-espresso-tutorial">GitHub Repository</a> | <a href="mailto:yusuke.hashimoto.b8@tohoku.ac.jp">Contact</a></p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-fortran.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>
</body>
</html>
