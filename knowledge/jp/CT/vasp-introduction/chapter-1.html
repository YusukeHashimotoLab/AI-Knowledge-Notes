<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« : VASPã®åŸºç¤ã¨ç’°å¢ƒæ§‹ç¯‰ - VASP DFTè¨ˆç®—å…¥é–€ - CT Dojo</title>
    <meta name="description" content="å¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰ã®åŸºç¤ã€Kohn-Shamæ–¹ç¨‹å¼ã€VASPã®æ¦‚è¦ã¨ç‰¹å¾´ã€ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å–å¾—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€åŸºæœ¬çš„ãªå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æˆã‚’pymatgenã§å®Ÿè·µã€‚">

    <!-- Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <!-- MathJax for mathematical expressions -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        :root {
            --accent-green: #11998e;
            --accent-lime: #38ef7d;
            --primary-dark: #2c3e50;
            --secondary-dark: #34495e;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --bg-light: #ecf0f1;
            --white: #ffffff;
            --code-bg: #2d2d2d;
            --border-light: #bdc3c7;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.8;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        header {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%);
            color: white;
            padding: 3rem 1.5rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        nav {
            background: var(--white);
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
        }

        nav a {
            text-decoration: none;
            color: var(--text-dark);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            font-weight: 500;
        }

        nav a:hover {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%);
            color: white;
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        section {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-dark);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--accent-green), var(--accent-lime)) 1;
        }

        h3 {
            color: var(--secondary-dark);
            font-size: 1.4rem;
            margin: 2rem 0 1rem;
        }

        h4 {
            color: var(--secondary-dark);
            font-size: 1.2rem;
            margin: 1.5rem 0 1rem;
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(17, 153, 142, 0.1) 0%, rgba(56, 239, 125, 0.1) 100%);
            border-left: 4px solid var(--accent-green);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box strong {
            color: var(--accent-green);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .warning-box {
            background: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box strong {
            color: var(--warning);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .exercise-box {
            background: rgba(39, 174, 96, 0.05);
            border: 2px solid var(--success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .exercise-box h4 {
            color: var(--success);
            margin-top: 0;
        }

        .difficulty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .difficulty.easy {
            background: #d4edda;
            color: #155724;
        }

        .difficulty.medium {
            background: #fff3cd;
            color: #856404;
        }

        .difficulty.hard {
            background: #f8d7da;
            color: #721c24;
        }

        .mermaid {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }

        th {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(17, 153, 142, 0.05);
        }

        footer {
            background: var(--primary-dark);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        footer a {
            color: var(--accent-green);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--accent-lime);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5rem;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            section {
                padding: 1.5rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }
        }

        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #11998e;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #0e7c74;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/CT/index.html">è¨ˆç®—å·¥å­¦</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/CT/vasp-introduction/index.html">VASP DFTå…¥é–€</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

    <header>
        <h1>ç¬¬1ç« : VASPã®åŸºç¤ã¨ç’°å¢ƒæ§‹ç¯‰</h1>
        <p>å¯†åº¦æ±é–¢æ•°ç†è«–ãƒ»Kohn-Shamæ–¹ç¨‹å¼ãƒ»VASPã®ç‰¹å¾´ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãƒ»ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">ãƒˆãƒƒãƒ—</a></li>
            <li><a href="#intro">æœ¬ç« ã®æ¦‚è¦</a></li>
            <li><a href="#dft-basics">DFTã®åŸºç¤</a></li>
            <li><a href="#vasp-overview">VASPã®æ¦‚è¦</a></li>
            <li><a href="#license">ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</a></li>
            <li><a href="#input-files">åŸºæœ¬çš„ãªå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«</a></li>
            <li><a href="#first-calculation">æœ€åˆã®VASPè¨ˆç®—</a></li>
            <li><a href="#results">è¨ˆç®—çµæœã®ç¢ºèª</a></li>
            <li><a href="#learning-objectives">å­¦ç¿’ç›®æ¨™</a></li>
            <li><a href="#exercises">æ¼”ç¿’å•é¡Œ</a></li>
            <li><a href="#references">å‚è€ƒæ–‡çŒ®</a></li>
            <li><a href="chapter-2.html">æ¬¡ã®ç« ã¸ â†’</a></li>
        </ul>
    </nav>

    <main>
        <section id="intro">
            <h2>1.1 æœ¬ç« ã®æ¦‚è¦</h2>

            <p>
                VASPï¼ˆVienna Ab initio Simulation Packageï¼‰ã¯ã€å¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰ã«åŸºã¥ãç¬¬ä¸€åŸç†è¨ˆç®—ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚ææ–™ã®é›»å­çŠ¶æ…‹ã€æ§‹é€ å®‰å®šæ€§ã€åŠ›å­¦ç‰¹æ€§ã€å…‰å­¦ç‰¹æ€§ãªã©ã‚’é‡å­åŠ›å­¦çš„ã«è¨ˆç®—ã§ãã€å®Ÿé¨“å‰ã®ææ–™è¨­è¨ˆã‚„ç‰©æ€§äºˆæ¸¬ã«ä¸å¯æ¬ ãªãƒ„ãƒ¼ãƒ«ã¨ãªã£ã¦ã„ã¾ã™ã€‚æœ¬ç« ã§ã¯ã€DFTã®åŸºç¤ç†è«–ã‹ã‚‰VASPã®ç’°å¢ƒæ§‹ç¯‰ã€æœ€åˆã®è¨ˆç®—å®Ÿè¡Œã¾ã§ã‚’å­¦ã³ã¾ã™ã€‚
            </p>

            <div class="info-box">
                <strong>æœ¬ç« ã®å­¦ç¿’ç›®æ¨™</strong>
                <ul>
                    <li><strong>ãƒ¬ãƒ™ãƒ«1ï¼ˆåŸºæœ¬ç†è§£ï¼‰</strong>: DFTè¨ˆç®—ã®åŸºæœ¬åŸç†ã‚’èª¬æ˜ã§ãã‚‹ã€VASPã®4ã¤ã®ä¸»è¦å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²ã‚’ç†è§£ã—ã¦ã„ã‚‹ã€PAWæ³•ã®æ¦‚è¦ã‚’èª¬æ˜ã§ãã‚‹</li>
                    <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: pymatgenã‚’ä½¿ã£ã¦INCAR/POSCARã‚’ä½œæˆã§ãã‚‹ã€ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦VASPè¨ˆç®—ã‚’å®Ÿè¡Œã§ãã‚‹ã€OUTCAR/vasprun.xmlã‹ã‚‰çµæœã‚’èª­ã¿å–ã‚Œã‚‹</li>
                    <li><strong>ãƒ¬ãƒ™ãƒ«3ï¼ˆå¿œç”¨åŠ›ï¼‰</strong>: ææ–™ã«å¿œã˜ãŸé©åˆ‡ãªè¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã§ãã‚‹ã€åæŸã—ãªã„è¨ˆç®—ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒã§ãã‚‹ã€Pythonã§è¨ˆç®—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è‡ªå‹•åŒ–ã§ãã‚‹</li>
                </ul>
            </div>

            <div class="warning-box">
                <strong>âš ï¸ å‰æçŸ¥è­˜</strong>
                <p>æœ¬ç« ã§ã¯ã€é‡å­åŠ›å­¦åŸºç¤ï¼ˆSchrÃ¶dingeræ–¹ç¨‹å¼ã€æ³¢å‹•é–¢æ•°ã€å›ºæœ‰å€¤å•é¡Œï¼‰ã€PythonåŸºç¤ï¼ˆNumPyã€é–¢æ•°å®šç¾©ï¼‰ã€LinuxåŸºæœ¬æ“ä½œï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚³ãƒãƒ³ãƒ‰ï¼‰ã‚’å‰æã¨ã—ã¾ã™ã€‚</p>
            </div>
        </section>

        <section id="dft-basics">
            <h2>1.2 å¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰ã®åŸºç¤</h2>

            <h3>1.2.1 SchrÃ¶dingerã®å¤šä½“å•é¡Œ</h3>

            <p>
                ææ–™ä¸­ã®é›»å­ã¯ã€åŸå­æ ¸ã¨ã®ç›¸äº’ä½œç”¨ã¨é›»å­é–“ç›¸äº’ä½œç”¨ã«ã‚ˆã‚Šè¤‡é›‘ãªé‡å­å¤šä½“ç³»ã‚’å½¢æˆã—ã¾ã™ã€‚æ™‚é–“ã«ä¾å­˜ã—ãªã„SchrÃ¶dingeræ–¹ç¨‹å¼ã¯ä»¥ä¸‹ã®å½¢ã§ã™ï¼š
            </p>

            <p>\[
            \hat{H}\Psi = E\Psi
            \]</p>

            <p>
                ã“ã“ã§ã€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ \(\hat{H}\) ã¯ä»¥ä¸‹ã®é …ã‹ã‚‰æˆã‚Šã¾ã™ï¼š
            </p>

            <p>\[
            \hat{H} = \hat{T}_e + \hat{V}_{e-n} + \hat{V}_{e-e} + \hat{T}_n + \hat{V}_{n-n}
            \]</p>

            <ul>
                <li>\(\hat{T}_e\): é›»å­ã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼</li>
                <li>\(\hat{V}_{e-n}\): é›»å­-åŸå­æ ¸é–“ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨</li>
                <li>\(\hat{V}_{e-e}\): é›»å­-é›»å­é–“ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨ï¼ˆé›£ã—ã„ï¼ï¼‰</li>
                <li>\(\hat{T}_n\): åŸå­æ ¸ã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼</li>
                <li>\(\hat{V}_{n-n}\): åŸå­æ ¸-åŸå­æ ¸é–“ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨</li>
            </ul>

            <p>
                ã“ã®æ–¹ç¨‹å¼ã‚’æ­£ç¢ºã«è§£ãã“ã¨ã¯ã€é›»å­æ•°NãŒå¢—ãˆã‚‹ã¨è¨ˆç®—é‡ãŒæŒ‡æ•°é–¢æ•°çš„ã«å¢—åŠ ã™ã‚‹ãŸã‚ã€å®Ÿè³ªçš„ã«ä¸å¯èƒ½ã§ã™ã€‚DFTã¯ã€ã“ã®å¤šä½“å•é¡Œã‚’åŠ¹ç‡çš„ã«è§£ãæ çµ„ã¿ã‚’æä¾›ã—ã¾ã™ã€‚
            </p>

            <h3>1.2.2 Hohenberg-Kohnã®å®šç†</h3>

            <p>
                DFTã®ç†è«–åŸºç›¤ã¯ã€1964å¹´ã«Hohenbergã¨Kohnã«ã‚ˆã£ã¦ç¢ºç«‹ã•ã‚Œã¾ã—ãŸã€‚2ã¤ã®åŸºæœ¬å®šç†ãŒã‚ã‚Šã¾ã™ï¼š
            </p>

            <div class="info-box">
                <strong>ç¬¬1å®šç†ï¼ˆä¸€æ„æ€§ï¼‰</strong>
                <p>åŸºåº•çŠ¶æ…‹ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€é›»å­å¯†åº¦ \(n(\mathbf{r})\) ã®æ±é–¢æ•°ã¨ã—ã¦ä¸€æ„ã«æ±ºã¾ã‚‹ã€‚</p>
            </div>

            <div class="info-box">
                <strong>ç¬¬2å®šç†ï¼ˆå¤‰åˆ†åŸç†ï¼‰</strong>
                <p>æ­£ã—ã„é›»å­å¯†åº¦ \(n(\mathbf{r})\) ã¯ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•° \(E[n]\) ã‚’æœ€å°åŒ–ã™ã‚‹ã€‚</p>
            </div>

            <p>
                ã“ã®å®šç†ã«ã‚ˆã‚Šã€3Næ¬¡å…ƒã®æ³¢å‹•é–¢æ•°å•é¡ŒãŒã€3æ¬¡å…ƒã®é›»å­å¯†åº¦å•é¡Œã«å¸°ç€ã•ã‚Œã¾ã™ã€‚ã“ã‚ŒãŒè¨ˆç®—é‡å‰Šæ¸›ã®éµã§ã™ã€‚
            </p>

            <h3>1.2.3 Kohn-Shamæ–¹ç¨‹å¼</h3>

            <p>
                1965å¹´ã€Kohnã¨Shamã¯å®Ÿç”¨çš„ãªè¨ˆç®—æ–¹æ³•ã‚’ææ¡ˆã—ã¾ã—ãŸã€‚éç›¸äº’ä½œç”¨é›»å­ç³»ã®å›ºæœ‰å€¤å•é¡Œã¨ã—ã¦å®šå¼åŒ–ã•ã‚Œã¾ã™ï¼š
            </p>

            <p>\[
            \left[-\frac{\hbar^2}{2m}\nabla^2 + V_{\text{eff}}(\mathbf{r})\right]\psi_i(\mathbf{r}) = \varepsilon_i \psi_i(\mathbf{r})
            \]</p>

            <p>
                æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« \(V_{\text{eff}}(\mathbf{r})\) ã¯ä»¥ä¸‹ã®æˆåˆ†ã‹ã‚‰æˆã‚Šã¾ã™ï¼š
            </p>

            <p>\[
            V_{\text{eff}}(\mathbf{r}) = V_{\text{ext}}(\mathbf{r}) + V_{\text{H}}(\mathbf{r}) + V_{\text{xc}}(\mathbf{r})
            \]</p>

            <ul>
                <li>\(V_{\text{ext}}\): å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆåŸå­æ ¸ã¨ã®ç›¸äº’ä½œç”¨ï¼‰</li>
                <li>\(V_{\text{H}}\): Hartreeãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆå¤å…¸çš„ãªé›»å­é–“é™é›»ç›¸äº’ä½œç”¨ï¼‰</li>
                <li>\(V_{\text{xc}}\): äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆé‡å­åŠ›å­¦çš„åŠ¹æœï¼‰</li>
            </ul>

            <p>
                é›»å­å¯†åº¦ã¯ä»¥ä¸‹ã§æ±‚ã¾ã‚Šã¾ã™ï¼š
            </p>

            <p>\[
            n(\mathbf{r}) = \sum_{i=1}^{N} |\psi_i(\mathbf{r})|^2
            \]</p>

            <p>
                ã“ã®æ–¹ç¨‹å¼ã¯è‡ªå·±ç„¡æ’ç€å ´ï¼ˆSCF: Self-Consistent Fieldï¼‰æ³•ã§åå¾©çš„ã«è§£ãã¾ã™ã€‚
            </p>

            <div class="mermaid">
flowchart TD
    A[åˆæœŸé›»å­å¯†åº¦ n0] --> B[æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« Veffè¨ˆç®—]
    B --> C[Kohn-Shamæ–¹ç¨‹å¼ã‚’è§£ã]
    C --> D[æ–°ã—ã„é›»å­å¯†åº¦ n'è¨ˆç®—]
    D --> E{åæŸåˆ¤å®š<br/>|n' - n| < Îµ?}
    E -->|No| F[é›»å­å¯†åº¦ã‚’æ›´æ–° n = n']
    F --> B
    E -->|Yes| G[å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ Eè¨ˆç®—]
    G --> H[å®Œäº†]

    style A fill:#e3f2fd
    style G fill:#e8f5e9
    style E fill:#fff3e0
            </div>

            <h3>1.2.4 äº¤æ›ç›¸é–¢æ±é–¢æ•°</h3>

            <p>
                DFTè¨ˆç®—ã®ç²¾åº¦ã¯ã€äº¤æ›ç›¸é–¢æ±é–¢æ•° \(E_{\text{xc}}[n]\) ã®è¿‘ä¼¼ã«å¤§ããä¾å­˜ã—ã¾ã™ã€‚ä¸»è¦ãªè¿‘ä¼¼æ–¹æ³•ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚
            </p>

            <table>
                <thead>
                    <tr>
                        <th>æ±é–¢æ•°</th>
                        <th>è¿‘ä¼¼ãƒ¬ãƒ™ãƒ«</th>
                        <th>ç‰¹å¾´</th>
                        <th>é©ç”¨ä¾‹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>LDA</strong></td>
                        <td>å±€æ‰€å¯†åº¦è¿‘ä¼¼</td>
                        <td>è¨ˆç®—é«˜é€Ÿã€çµåˆé•·ã‚’éå°è©•ä¾¡</td>
                        <td>é‡‘å±ã€é«˜å¯†åº¦ç³»</td>
                    </tr>
                    <tr>
                        <td><strong>GGA (PBE)</strong></td>
                        <td>ä¸€èˆ¬åŒ–å‹¾é…è¿‘ä¼¼</td>
                        <td>LDAã‚ˆã‚Šç²¾åº¦å‘ä¸Šã€æ¨™æº–çš„é¸æŠ</td>
                        <td>ã»ã¨ã‚“ã©ã®ææ–™</td>
                    </tr>
                    <tr>
                        <td><strong>meta-GGA</strong></td>
                        <td>å¯†åº¦ã®2æ¬¡å¾®åˆ†åˆ©ç”¨</td>
                        <td>é«˜ç²¾åº¦ã ãŒè¨ˆç®—ã‚³ã‚¹ãƒˆå¢—</td>
                        <td>ç²¾å¯†è¨ˆç®—</td>
                    </tr>
                    <tr>
                        <td><strong>Hybrid (HSE06)</strong></td>
                        <td>Hartree-Fockæ··åˆ</td>
                        <td>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ç²¾åº¦å‘ä¸Šã€é«˜ã‚³ã‚¹ãƒˆ</td>
                        <td>åŠå°ä½“ã€çµ¶ç¸ä½“</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <strong>ğŸ’¡ æ¨å¥¨æ±é–¢æ•°</strong>
                <p>ä¸€èˆ¬çš„ãªææ–™ç§‘å­¦è¨ˆç®—ã§ã¯ã€PBEï¼ˆGGAï¼‰ãŒæ¨™æº–çš„ãªé¸æŠã§ã™ã€‚è¨ˆç®—ã‚³ã‚¹ãƒˆã¨ç²¾åº¦ã®ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ãã€Materials Projectã§ã‚‚æ¡ç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®—ã‚„ç£æ€§ä½“ã§ã¯ã€HSE06ãªã©ã®ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ±é–¢æ•°ãŒå¿…è¦ãªå ´åˆãŒã‚ã‚Šã¾ã™ï¼ˆç¬¬6ç« ã§è©³è¿°ï¼‰ã€‚</p>
            </div>

            <h3>1.2.5 DFTè¨ˆç®—ã®ç²¾åº¦ã¨é™ç•Œ</h3>

            <p>
                DFTã¯å¼·åŠ›ãªæ‰‹æ³•ã§ã™ãŒã€ã„ãã¤ã‹ã®æ—¢çŸ¥ã®é™ç•ŒãŒã‚ã‚Šã¾ã™ï¼š
            </p>

            <ul>
                <li><strong>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®éå°è©•ä¾¡</strong>: GGAã¯åŠå°ä½“ã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’30-50%éå°è©•ä¾¡ã—ã¾ã™ï¼ˆGWè¿‘ä¼¼ã‚„ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ±é–¢æ•°ã§æ”¹å–„å¯èƒ½ï¼‰</li>
                <li><strong>van der Waalsç›¸äº’ä½œç”¨</strong>: æ¨™æº–DFTã¯åˆ†æ•£åŠ›ã‚’é©åˆ‡ã«è¨˜è¿°ã§ãã¾ã›ã‚“ï¼ˆDFT-D3è£œæ­£ã§å¯¾å¿œï¼‰</li>
                <li><strong>å¼·ç›¸é–¢ç³»</strong>: é·ç§»é‡‘å±é…¸åŒ–ç‰©ãªã©å¼·ã„é›»å­ç›¸é–¢ãŒã‚ã‚‹ç³»ã§ã¯ç²¾åº¦ãŒä½ä¸‹ã—ã¾ã™ï¼ˆDFT+Uã§æ”¹å–„ï¼‰</li>
                <li><strong>åŠ±èµ·çŠ¶æ…‹</strong>: DFTã¯åŸºåº•çŠ¶æ…‹ç†è«–ã§ã™ã€‚åŠ±èµ·çŠ¶æ…‹ã«ã¯æ™‚é–“ä¾å­˜DFTï¼ˆTD-DFTï¼‰ã‚„BSEæ³•ãŒå¿…è¦ã§ã™</li>
            </ul>

            <p>
                ãã‚Œã§ã‚‚ã€é©åˆ‡ãªæ±é–¢æ•°ã¨è£œæ­£ã‚’ä½¿ãˆã°ã€å¤šãã®ææ–™ç‰©æ€§ï¼ˆæ ¼å­å®šæ•°Â±1%ã€å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼Â±0.1 eV/atomï¼‰ã‚’å®Ÿé¨“ã«è¿‘ã„ç²¾åº¦ã§äºˆæ¸¬ã§ãã¾ã™ã€‚
            </p>
        </section>

        <section id="vasp-overview">
            <h2>1.3 VASPã®æ¦‚è¦ã¨ç‰¹å¾´</h2>

            <h3>1.3.1 VASPã¨ã¯</h3>

            <p>
                VASPï¼ˆVienna Ab initio Simulation Packageï¼‰ã¯ã€ã‚¦ã‚£ãƒ¼ãƒ³å¤§å­¦ã§é–‹ç™ºã•ã‚ŒãŸç¬¬ä¸€åŸç†è¨ˆç®—ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™ã€‚1990å¹´ä»£åˆé ­ã«Georg Kresseæ°ã¨JÃ¼rgen FurthmÃ¼lleræ°ã«ã‚ˆã£ã¦é–‹ç™ºãŒå§‹ã¾ã‚Šã€ç¾åœ¨ã§ã¯ä¸–ç•Œä¸­ã®ç ”ç©¶æ©Ÿé–¢ã§æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹DFTã‚³ãƒ¼ãƒ‰ã®1ã¤ã§ã™ã€‚
            </p>

            <div class="info-box">
                <strong>VASPã®ä¸»è¦ãªç‰¹å¾´</strong>
                <ul>
                    <li><strong>å¹³é¢æ³¢åŸºåº•</strong>: å‘¨æœŸç³»ã®è¨ˆç®—ã«æœ€é©åŒ–</li>
                    <li><strong>PAWæ³•</strong>: é«˜ç²¾åº¦ã¨è¨ˆç®—åŠ¹ç‡ã®ä¸¡ç«‹</li>
                    <li><strong>ä¸¦åˆ—è¨ˆç®—</strong>: MPI/OpenMPã«ã‚ˆã‚‹å¤§è¦æ¨¡ä¸¦åˆ—åŒ–</li>
                    <li><strong>è±Šå¯Œãªæ©Ÿèƒ½</strong>: æ§‹é€ æœ€é©åŒ–ã€MDã€ãƒãƒ³ãƒ‰è¨ˆç®—ã€å…‰å­¦ç‰¹æ€§ãªã©</li>
                    <li><strong>é«˜ã„ä¿¡é ¼æ€§</strong>: 20å¹´ä»¥ä¸Šã®é–‹ç™ºå®Ÿç¸¾ã€10ä¸‡æœ¬ä»¥ä¸Šã®è«–æ–‡å¼•ç”¨</li>
                </ul>
            </div>

            <h3>1.3.2 å¹³é¢æ³¢åŸºåº•ã¨æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æ³•</h3>

            <p>
                VASPã¯ã€å‘¨æœŸçš„å¢ƒç•Œæ¡ä»¶ã‚’æŒã¤ç³»ã‚’å¹³é¢æ³¢åŸºåº•ã§å±•é–‹ã—ã¾ã™ã€‚æ³¢å‹•é–¢æ•°ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™ï¼š
            </p>

            <p>\[
            \psi_i(\mathbf{r}) = \sum_{\mathbf{G}} c_{i,\mathbf{G}} e^{i(\mathbf{k}+\mathbf{G})\cdot\mathbf{r}}
            \]</p>

            <p>
                ã“ã“ã§ã€\(\mathbf{G}\)ã¯é€†æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã€\(\mathbf{k}\)ã¯Blochã®å®šç†ã«ã‚ˆã‚‹kç‚¹ã§ã™ã€‚ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(E_{\text{cut}}\) ã«ã‚ˆã‚Šã€æ³¢æ•°ãƒ™ã‚¯ãƒˆãƒ«ã®ä¸Šé™ãŒæ±ºã¾ã‚Šã¾ã™ï¼š
            </p>

            <p>\[
            \frac{\hbar^2}{2m}|\mathbf{k}+\mathbf{G}|^2 < E_{\text{cut}}
            \]</p>

            <p>
                å†…æ®»é›»å­ï¼ˆåŒ–å­¦çµåˆã«å¯„ä¸ã—ãªã„ï¼‰ã¯æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã§ç½®ãæ›ãˆã‚‹ã“ã¨ã§ã€è¨ˆç®—åŠ¹ç‡ã‚’å¤§å¹…ã«å‘ä¸Šã•ã›ã¾ã™ã€‚
            </p>

            <h3>1.3.3 PAWæ³•ï¼ˆProjector Augmented Wave methodï¼‰</h3>

            <p>
                PAWæ³•ã¯ã€Peter BlÃ¶chlã«ã‚ˆã£ã¦1994å¹´ã«ææ¡ˆã•ã‚ŒãŸæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æ³•ã®ä¸€ç¨®ã§ã™ã€‚å…¨é›»å­æ³¢å‹•é–¢æ•°ã¨æ“¬æ³¢å‹•é–¢æ•°ã®é–“ã®ç·šå½¢å¤‰æ›ã‚’å°å…¥ã™ã‚‹ã“ã¨ã§ã€ä»¥ä¸‹ã®åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ï¼š
            </p>

            <ul>
                <li><strong>é«˜ç²¾åº¦</strong>: å…¨é›»å­æ³•ã«è¿‘ã„ç²¾åº¦ã‚’ä¿æŒ</li>
                <li><strong>åŠ¹ç‡æ€§</strong>: å¹³é¢æ³¢åŸºåº•ã§ã®é«˜é€Ÿè¨ˆç®—</li>
                <li><strong>ç‰©ç†é‡ã®æ­£ç¢ºãªè¨ˆç®—</strong>: é›»è·å¯†åº¦ã€ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãªã©ã‚’æ­£ç¢ºã«è©•ä¾¡</li>
                <li><strong>æ±ç”¨æ€§</strong>: è»½å…ƒç´ ã‹ã‚‰é·ç§»é‡‘å±ã€fé›»å­ç³»ã¾ã§å¹…åºƒãé©ç”¨å¯èƒ½</li>
            </ul>

            <div class="info-box">
                <strong>ğŸ’¡ PAW vs Ultrasoftæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</strong>
                <p>VASPã§ã¯PAWãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚Ultrasoftæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆUSPPï¼‰ã‚ˆã‚Šç²¾åº¦ãŒé«˜ãã€ç‰¹ã«ç£æ€§ä½“ã‚„é…¸åŒ–ç‰©ã§é‡è¦ã§ã™ã€‚è¨ˆç®—ã‚³ã‚¹ãƒˆã¯ã»ã¼åŒç­‰ã§ã™ãŒã€PAWã¯ç‰©ç†é‡ã®ä¿¡é ¼æ€§ãŒé«˜ã„ãŸã‚ã€æ–°è¦è¨ˆç®—ã§ã¯PAWã‚’é¸æŠã™ã¹ãã§ã™ã€‚</p>
            </div>

            <h3>1.3.4 VASPã¨ä»–ã®DFTã‚³ãƒ¼ãƒ‰ã®æ¯”è¼ƒ</h3>

            <table>
                <thead>
                    <tr>
                        <th>ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</th>
                        <th>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</th>
                        <th>åŸºåº•é–¢æ•°</th>
                        <th>ç‰¹å¾´</th>
                        <th>æ¨å¥¨ç”¨é€”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>VASP</strong></td>
                        <td>å•†ç”¨</td>
                        <td>å¹³é¢æ³¢ + PAW</td>
                        <td>é«˜é€Ÿã€å®‰å®šã€Materials Projectæ¨™æº–</td>
                        <td>å›ºä½“ç‰©ç†å…¨èˆ¬</td>
                    </tr>
                    <tr>
                        <td><strong>Quantum ESPRESSO</strong></td>
                        <td>ç„¡å„Ÿï¼ˆGPLï¼‰</td>
                        <td>å¹³é¢æ³¢ + USPP/PAW</td>
                        <td>ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã€æ©Ÿèƒ½è±Šå¯Œ</td>
                        <td>VASPä»£æ›¿ã€ãƒ•ã‚©ãƒãƒ³è¨ˆç®—</td>
                    </tr>
                    <tr>
                        <td><strong>GPAW</strong></td>
                        <td>ç„¡å„Ÿï¼ˆGPLï¼‰</td>
                        <td>å¹³é¢æ³¢/å®Ÿç©ºé–“ã‚°ãƒªãƒƒãƒ‰</td>
                        <td>Pythonçµ±åˆã€ä½¿ã„ã‚„ã™ã•</td>
                        <td>Pythoné–‹ç™ºè€…å‘ã‘</td>
                    </tr>
                    <tr>
                        <td><strong>CASTEP</strong></td>
                        <td>å•†ç”¨</td>
                        <td>å¹³é¢æ³¢ + USPP</td>
                        <td>GUIãƒ„ãƒ¼ãƒ«å……å®Ÿ</td>
                        <td>ææ–™è¨­è¨ˆã€ç”£æ¥­å¿œç”¨</td>
                    </tr>
                    <tr>
                        <td><strong>Gaussian</strong></td>
                        <td>å•†ç”¨</td>
                        <td>ã‚¬ã‚¦ã‚¹åŸºåº•</td>
                        <td>åˆ†å­è¨ˆç®—ã«ç‰¹åŒ–</td>
                        <td>æœ‰æ©ŸåŒ–åˆç‰©ã€ç”Ÿä½“åˆ†å­</td>
                    </tr>
                </tbody>
            </table>

            <h3>1.3.5 Materials Projectã§ã®åˆ©ç”¨ä¾‹</h3>

            <p>
                Materials Projectã¯ã€VASPã§è¨ˆç®—ã—ãŸ150,000ä»¥ä¸Šã®ææ–™ç‰©æ€§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã™ã€‚æ¨™æº–çš„ãªè¨ˆç®—è¨­å®šï¼ˆPBEæ±é–¢æ•°ã€PAW-PBEæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã€å³æ ¼ãªåæŸåˆ¤å®šï¼‰ã‚’ä½¿ã„ã€é«˜ã„ä¿¡é ¼æ€§ã‚’ç¢ºä¿ã—ã¦ã„ã¾ã™ã€‚æœ¬ã‚·ãƒªãƒ¼ã‚ºã§ã‚‚ã“ã®æ¨™æº–è¨­å®šã‚’åŸºæœ¬ã¨ã—ã¾ã™ã€‚
            </p>

            <p>
                Materials Projectã®ãƒ‡ãƒ¼ã‚¿ã¯ã€pymatgenãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’é€šã˜ã¦ç°¡å˜ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã€è‡ªåˆ†ã®è¨ˆç®—çµæœã¨æ¯”è¼ƒãƒ»æ¤œè¨¼ã§ãã¾ã™ã€‚
            </p>
        </section>

        <section id="license">
            <h2>1.4 ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>

            <h3>1.4.1 VASPãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®å–å¾—æ–¹æ³•</h3>

            <div class="warning-box">
                <strong>âš ï¸ VASPã¯å•†ç”¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã™</strong>
                <p>ä½¿ç”¨ã«ã¯æœ‰å„Ÿãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒå¿…è¦ã§ã™ã€‚ç„¡æ–­ä½¿ç”¨ã¯é•æ³•ã§ã™ã€‚</p>
            </div>

            <p>
                VASPã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«ã¯ä»¥ä¸‹ã®ç¨®é¡ãŒã‚ã‚Šã¾ã™ï¼š
            </p>

            <ul>
                <li><strong>æ©Ÿé–¢ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: å¤§å­¦ãƒ»ç ”ç©¶æ©Ÿé–¢å…¨ä½“ã§åˆ©ç”¨å¯èƒ½ã€‚å¹´é–“æ•°åƒãƒ¦ãƒ¼ãƒ­ã€‚è¤‡æ•°ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§å…±æœ‰ã§ãã‚‹ãŸã‚ã€æ‰€å±æ©Ÿé–¢ã«æ—¢å­˜ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒãªã„ã‹ç¢ºèªã—ã¦ãã ã•ã„</li>
                <li><strong>ç ”ç©¶ã‚°ãƒ«ãƒ¼ãƒ—ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: ç‰¹å®šã®ç ”ç©¶å®¤å†…ã§åˆ©ç”¨ã€‚å¹´é–“1,000-2,000ãƒ¦ãƒ¼ãƒ­ç¨‹åº¦</li>
                <li><strong>å€‹äººãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: å€‹äººåˆ©ç”¨ã€‚ä¾¡æ ¼ã¯æ©Ÿé–¢ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã‚ˆã‚Šé«˜é¡</li>
            </ul>

            <p>
                ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ç”³è«‹æ‰‹é †ï¼š
            </p>

            <ol>
                <li>VASPå…¬å¼ã‚µã‚¤ãƒˆï¼ˆ<a href="https://www.vasp.at" target="_blank">https://www.vasp.at</a>ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹</li>
                <li>ã€ŒLicenseã€ãƒšãƒ¼ã‚¸ã‹ã‚‰ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ãƒ•ã‚©ãƒ¼ãƒ ã«è¨˜å…¥</li>
                <li>æ‰€å±æ©Ÿé–¢ã®è¨¼æ˜ï¼ˆå…¬å¼ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã€æ‰€å±è¨¼æ˜æ›¸ï¼‰ã‚’æå‡º</li>
                <li>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å¥‘ç´„æ›¸ã«ã‚µã‚¤ãƒ³</li>
                <li>æ”¯æ‰•ã„å®Œäº†å¾Œã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ãŒé€ä»˜ã•ã‚Œã‚‹</li>
            </ol>

            <h3>1.4.2 ç„¡æ–™ã®ä»£æ›¿ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</h3>

            <p>
                VASPã®ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ãŒå–å¾—ã§ããªã„å ´åˆã€ä»¥ä¸‹ã®ç„¡å„ŸDFTã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§å­¦ç¿’ãƒ»ç ”ç©¶ãŒå¯èƒ½ã§ã™ï¼š
            </p>

            <table>
                <thead>
                    <tr>
                        <th>ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</th>
                        <th>URL</th>
                        <th>ç‰¹å¾´</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Quantum ESPRESSO</strong></td>
                        <td><a href="https://www.quantum-espresso.org" target="_blank">quantum-espresso.org</a></td>
                        <td>VASPã«æœ€ã‚‚è¿‘ã„æ©Ÿèƒ½ã€æ´»ç™ºãªã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</td>
                    </tr>
                    <tr>
                        <td><strong>GPAW</strong></td>
                        <td><a href="https://wiki.fysik.dtu.dk/gpaw" target="_blank">wiki.fysik.dtu.dk/gpaw</a></td>
                        <td>Pythonçµ±åˆã€åˆå­¦è€…å‘ã‘</td>
                    </tr>
                    <tr>
                        <td><strong>Abinit</strong></td>
                        <td><a href="https://www.abinit.org" target="_blank">www.abinit.org</a></td>
                        <td>å¤šé›»å­åŠ±èµ·ã€GWè¨ˆç®—ã«å¼·ã„</td>
                    </tr>
                    <tr>
                        <td><strong>CP2K</strong></td>
                        <td><a href="https://www.cp2k.org" target="_blank">www.cp2k.org</a></td>
                        <td>å¤§è¦æ¨¡ç³»ã€åˆ†å­å‹•åŠ›å­¦ã«æœ€é©</td>
                    </tr>
                </tbody>
            </table>

            <h3>1.4.3 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †ï¼ˆLinuxï¼‰</h3>

            <p>
                VASPã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã§é…å¸ƒã•ã‚Œã‚‹ãŸã‚ã€ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒå¿…è¦ã§ã™ã€‚ä»¥ä¸‹ã¯Linuxç’°å¢ƒã§ã®æ¨™æº–çš„ãªæ‰‹é †ã§ã™ã€‚
            </p>

            <h4>å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª</h4>

<pre><code class="language-bash"># Intel oneAPIï¼ˆæ¨å¥¨ï¼‰ã¾ãŸã¯gccã‚³ãƒ³ãƒ‘ã‚¤ãƒ©
sudo apt-get install build-essential

# MPIï¼ˆä¸¦åˆ—è¨ˆç®—ç”¨ï¼‰
sudo apt-get install openmpi-bin libopenmpi-dev

# æ•°å€¤è¨ˆç®—ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
sudo apt-get install libblas-dev liblapack-dev libfftw3-dev

# Intel MKLï¼ˆæ¨å¥¨ã€é«˜é€Ÿï¼‰
# oneAPIã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«: https://www.intel.com/content/www/us/en/developer/tools/oneapi/
</code></pre>

            <h4>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</h4>

<pre><code class="language-bash"># VASPã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å±•é–‹
tar -xvf vasp.6.4.0.tar.gz
cd vasp.6.4.0

# makefileã‚’ã‚³ãƒ”ãƒ¼
cp arch/makefile.include.intel makefile.include

# å¿…è¦ã«å¿œã˜ã¦makefile.includeã‚’ç·¨é›†
# - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãƒ‘ã‚¹ï¼ˆFC, CCï¼‰
# - ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ‘ã‚¹ï¼ˆBLAS, LAPACK, FFTWï¼‰

# ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼ˆæ¨™æº–ç‰ˆï¼‰
make std

# ä¸¦åˆ—ç‰ˆ
make gam  # Gammaç‚¹ã®ã¿
make ncl  # Non-collinearç£æ€§

# å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‘ã‚¹ã«è¿½åŠ 
sudo cp bin/vasp_std /usr/local/bin/
</code></pre>

            <h4>å‹•ä½œç¢ºèª</h4>

<pre><code class="language-python">#!/usr/bin/env python3
"""VASP installation verification script"""

import subprocess
import os
import sys

def check_vasp_installation():
    """VASPã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®ç¢ºèª"""

    # VASPãƒã‚¤ãƒŠãƒªã®å€™è£œãƒ‘ã‚¹
    vasp_paths = [
        '/usr/local/bin/vasp_std',
        '/opt/vasp/bin/vasp_std',
        os.path.expanduser('~/bin/vasp_std')
    ]

    vasp_found = False

    print("VASP Installation Check")
    print("=" * 50)

    for path in vasp_paths:
        if os.path.exists(path):
            print(f"âœ“ VASP found: {path}")
            vasp_found = True

            # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªï¼ˆå®Ÿè¡Œã¯å±é™ºãªã®ã§å­˜åœ¨ç¢ºèªã®ã¿ï¼‰
            file_size = os.path.getsize(path) / (1024 * 1024)  # MB
            print(f"  File size: {file_size:.1f} MB")

            # å®Ÿè¡Œæ¨©é™ç¢ºèª
            if os.access(path, os.X_OK):
                print(f"  Executable: Yes")
            else:
                print(f"  Executable: No (check permissions)")

            break

    if not vasp_found:
        print("âœ— VASP not found in common locations")
        print("\nPlease ensure VASP is installed and in your PATH.")
        return False

    # MPIç¢ºèª
    print("\nMPI Check:")
    try:
        result = subprocess.run(['mpirun', '--version'],
                               capture_output=True,
                               text=True,
                               timeout=5)
        if result.returncode == 0:
            print(f"âœ“ MPI available")
            print(f"  {result.stdout.split()[0:3]}")
        else:
            print("âœ— MPI not available")
    except FileNotFoundError:
        print("âœ— mpirun not found")
    except Exception as e:
        print(f"âœ— Error checking MPI: {e}")

    # Pythonç’°å¢ƒç¢ºèª
    print("\nPython Libraries Check:")
    required_libs = ['numpy', 'pymatgen', 'ase', 'matplotlib']

    for lib in required_libs:
        try:
            __import__(lib)
            print(f"âœ“ {lib} installed")
        except ImportError:
            print(f"âœ— {lib} not installed (pip install {lib})")

    print("\n" + "=" * 50)
    print("Installation check complete.")

    return vasp_found

if __name__ == "__main__":
    success = check_vasp_installation()
    sys.exit(0 if success else 1)
</code></pre>

            <p>
                ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã¦VASPã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š
            </p>

<pre><code class="language-bash">python check_vasp.py
</code></pre>
        </section>

        <section id="input-files">
            <h2>1.5 åŸºæœ¬çš„ãªå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æˆ</h2>

            <p>
                VASPè¨ˆç®—ã«ã¯4ã¤ã®å¿…é ˆå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚Šã¾ã™ã€‚å„ãƒ•ã‚¡ã‚¤ãƒ«ã®å½¹å‰²ã‚’ç†è§£ã™ã‚‹ã“ã¨ãŒã€VASPä½¿ã„ã“ãªã—ã®ç¬¬ä¸€æ­©ã§ã™ã€‚
            </p>

            <table>
                <thead>
                    <tr>
                        <th>ãƒ•ã‚¡ã‚¤ãƒ«å</th>
                        <th>å½¹å‰²</th>
                        <th>ä¾‹</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>INCAR</strong></td>
                        <td>è¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¨­å®š</td>
                        <td>ENCUT=520, EDIFF=1E-6</td>
                    </tr>
                    <tr>
                        <td><strong>POSCAR</strong></td>
                        <td>çµæ™¶æ§‹é€ æƒ…å ±</td>
                        <td>æ ¼å­å®šæ•°ã€åŸå­åº§æ¨™</td>
                    </tr>
                    <tr>
                        <td><strong>KPOINTS</strong></td>
                        <td>kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥è¨­å®š</td>
                        <td>Monkhorst-Pack 8Ã—8Ã—8</td>
                    </tr>
                    <tr>
                        <td><strong>POTCAR</strong></td>
                        <td>æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«</td>
                        <td>PAW-PBE Si, PAW-PBE O</td>
                    </tr>
                </tbody>
            </table>

            <h3>1.5.1 POSCAR: çµæ™¶æ§‹é€ ã®è¨˜è¿°</h3>

            <p>
                pymatgenã‚’ä½¿ã£ã¦Siçµæ™¶ã®POSCARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š
            </p>

<pre><code class="language-python">#!/usr/bin/env python3
"""POSCARãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆä¾‹ - Siçµæ™¶"""

from pymatgen.core import Structure, Lattice
import numpy as np

# Siçµæ™¶æ§‹é€ ã®ä½œæˆï¼ˆãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼‰
lattice = Lattice.cubic(5.43)  # æ ¼å­å®šæ•° 5.43 Ã…

si_structure = Structure(
    lattice,
    ["Si", "Si"],  # å…ƒç´ 
    [[0, 0, 0], [0.25, 0.25, 0.25]],  # åˆ†æ•°åº§æ¨™
    coords_are_cartesian=False
)

# POSCARãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›
si_structure.to(filename="POSCAR", fmt="poscar")

print("POSCAR created for Si")
print(si_structure)

# å‡ºåŠ›:
# POSCAR created for Si
# Full Formula (Si2)
# Reduced Formula: Si
# abc   :   5.430000   5.430000   5.430000
# angles:  90.000000  90.000000  90.000000
# Sites (2)
#   #  SP       a     b     c
# ---  ----  ----  ----  ----
#   0  Si    0.00  0.00  0.00
#   1  Si    0.25  0.25  0.25
</code></pre>

            <p>
                ç”Ÿæˆã•ã‚ŒãŸPOSCARãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ï¼š
            </p>

<pre><code>Si2
1.0
5.430000 0.000000 0.000000
0.000000 5.430000 0.000000
0.000000 0.000000 5.430000
Si
2
direct
0.000000 0.000000 0.000000 Si
0.250000 0.250000 0.250000 Si
</code></pre>

            <h3>1.5.2 INCAR: è¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¨­å®š</h3>

            <p>
                INCARãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯è¨ˆç®—ã®è©³ç´°è¨­å®šã‚’è¨˜è¿°ã—ã¾ã™ã€‚æ§‹é€ æœ€é©åŒ–ã®åŸºæœ¬çš„ãªINCARã‚’pymatgenã§ä½œæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š
            </p>

<pre><code class="language-python">#!/usr/bin/env python3
"""INCARãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆä¾‹ - æ§‹é€ æœ€é©åŒ–"""

from pymatgen.io.vasp.inputs import Incar

# æ§‹é€ æœ€é©åŒ–ç”¨ã®INCARè¨­å®š
incar = Incar({
    # ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±
    'SYSTEM': 'Si bulk',

    # è¨ˆç®—é–‹å§‹è¨­å®š
    'ISTART': 0,       # 0: æ–°è¦è¨ˆç®—
    'ICHARG': 2,       # 2: é‡ã­åˆã‚ã›åŸå­é›»è·

    # é›»å­è¨ˆç®—
    'ENCUT': 520,      # å¹³é¢æ³¢ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰
    'EDIFF': 1e-6,     # é›»å­SCFåæŸåˆ¤å®šï¼ˆeVï¼‰
    'PREC': 'Accurate',  # ç²¾åº¦è¨­å®š
    'LREAL': False,    # False: é€†ç©ºé–“ã€True: å®Ÿç©ºé–“ï¼ˆå¤§è¦æ¨¡ç³»ï¼‰

    # ã‚¤ã‚ªãƒ³ç·©å’Œ
    'NSW': 100,        # æœ€å¤§ã‚¤ã‚ªãƒ³ã‚¹ãƒ†ãƒƒãƒ—æ•°
    'IBRION': 2,       # 2: CGæ³•ã€1: RMM-DIIS
    'ISIF': 3,         # 3: åŸå­åº§æ¨™+æ ¼å­å®šæ•°æœ€é©åŒ–
    'EDIFFG': -0.01,   # ã‚¤ã‚ªãƒ³åæŸåˆ¤å®šï¼ˆeV/Ã…ã€è² ãªã‚‰åŠ›ã®é–¾å€¤ï¼‰

    # é›»å­ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°
    'ISMEAR': 0,       # 0: Gaussianã€-5: tetrahedronï¼ˆDOSç”¨ï¼‰
    'SIGMA': 0.05,     # ã‚¹ãƒ¡ã‚¢ãƒªãƒ³ã‚°å¹…ï¼ˆeVï¼‰
})

# ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿
incar.write_file('INCAR')

print("INCAR created")
print(incar)

# å‡ºåŠ›:
# INCAR created
# SYSTEM = Si bulk
# ISTART = 0
# ICHARG = 2
# ENCUT = 520
# EDIFF = 1e-06
# ...
</code></pre>

            <h3>1.5.3 KPOINTS: kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã®è¨­å®š</h3>

            <p>
                kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã¯Brillouin zoneç©åˆ†ã®ç²¾åº¦ã‚’æ±ºå®šã—ã¾ã™ã€‚pymatgenã§è‡ªå‹•ç”Ÿæˆã§ãã¾ã™ï¼š
            </p>

<pre><code class="language-python">#!/usr/bin/env python3
"""KPOINTSãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆä¾‹"""

from pymatgen.io.vasp.inputs import Kpoints
from pymatgen.core import Structure

# æ§‹é€ ã‚’èª­ã¿è¾¼ã¿ï¼ˆå…ˆã»ã©ä½œæˆã—ãŸPOSCARã‹ã‚‰ï¼‰
structure = Structure.from_file("POSCAR")

# è‡ªå‹•kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ç”Ÿæˆï¼ˆkç‚¹å¯†åº¦æŒ‡å®šï¼‰
kpoints = Kpoints.automatic_density(structure, kppa=1000)
# kppa: k-points per reciprocal atomï¼ˆåŸå­ã‚ãŸã‚Škç‚¹æ•°ï¼‰

kpoints.write_file("KPOINTS")

print(f"KPOINTS created: {kpoints.kpts[0]} mesh")

# å‡ºåŠ›ä¾‹:
# KPOINTS created: [8 8 8] mesh

# ã¾ãŸã¯ã€æ˜ç¤ºçš„ã«Monkhorst-Packæ³•ã§æŒ‡å®š
kpoints_manual = Kpoints.monkhorst_automatic(kpts=(8, 8, 8), shift=(0, 0, 0))
kpoints_manual.write_file("KPOINTS_manual")
</code></pre>

            <h3>1.5.4 POTCAR: æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«</h3>

            <div class="warning-box">
                <strong>âš ï¸ POTCARãƒ•ã‚¡ã‚¤ãƒ«ã®é…å¸ƒã«ã¤ã„ã¦</strong>
                <p>POTCARãƒ•ã‚¡ã‚¤ãƒ«ã¯VASPãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«å«ã¾ã‚Œã‚‹æ©Ÿå¯†ãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚å…¬é–‹ãƒªãƒã‚¸ãƒˆãƒªã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚„å†é…å¸ƒã¯ç¦æ­¢ã•ã‚Œã¦ã„ã¾ã™ã€‚ãƒ©ã‚¤ã‚»ãƒ³ã‚¹å–å¾—å¾Œã€VASPé…å¸ƒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰é©åˆ‡ãªPOTCARã‚’é¸æŠã—ã¦ãã ã•ã„ã€‚</p>
            </div>

            <p>
                POTCARã¯VASPã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®<code>potpaw_PBE/</code>ãªã©ã«ã‚ã‚Šã¾ã™ã€‚ä½¿ç”¨ã™ã‚‹å…ƒç´ ã®POTCARã‚’é€£çµã—ã¾ã™ï¼š
            </p>

<pre><code class="language-bash"># Siå˜ä½“ã®å ´åˆ
cat $VASP_POTCAR_DIR/Si/POTCAR > POTCAR

# åŒ–åˆç‰©ï¼ˆä¾‹: SiO2ï¼‰ã®å ´åˆã€POSCARã®å…ƒç´ é †ã«é€£çµ
cat $VASP_POTCAR_DIR/Si/POTCAR $VASP_POTCAR_DIR/O/POTCAR > POTCAR
</code></pre>

            <p>
                pymatgenã§POTCARãƒ‘ã‚¹ã‚’è¨­å®šã™ã‚Œã°ã€è‡ªå‹•ç”Ÿæˆã‚‚å¯èƒ½ã§ã™ï¼š
            </p>

<pre><code class="language-python"># ~/.pmgrc.yaml ã«è¨­å®š
PMG_VASP_PSP_DIR: /path/to/vasp/potpaw_PBE

# Pythonã§è‡ªå‹•ç”Ÿæˆ
from pymatgen.io.vasp.inputs import PotcarSingle
potcar = PotcarSingle.from_symbol_and_functional("Si", "PBE")
</code></pre>
        </section>

        <section id="first-calculation">
            <h2>1.6 æœ€åˆã®VASPè¨ˆç®—å®Ÿè¡Œ</h2>

            <h3>1.6.1 ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®ä½œæˆ</h3>

            <p>
                VASPè¨ˆç®—ã¯é€šå¸¸ã€MPIã‚’ä½¿ã£ãŸä¸¦åˆ—å®Ÿè¡Œã§è¡Œã„ã¾ã™ã€‚ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’Pythonã§ç”Ÿæˆã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š
            </p>

<pre><code class="language-python">#!/usr/bin/env python3
"""VASP job script generator"""

def create_job_script(
    job_name='vasp_job',
    nodes=1,
    cores_per_node=16,
    walltime='24:00:00',
    partition='standard',
    vasp_executable='vasp_std'
):
    """SLURMã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ç”Ÿæˆ

    Args:
        job_name (str): ã‚¸ãƒ§ãƒ–å
        nodes (int): ãƒãƒ¼ãƒ‰æ•°
        cores_per_node (int): ãƒãƒ¼ãƒ‰ã‚ãŸã‚Šã®ã‚³ã‚¢æ•°
        walltime (str): æœ€å¤§å®Ÿè¡Œæ™‚é–“ï¼ˆHH:MM:SSï¼‰
        partition (str): ãƒ‘ãƒ¼ãƒ†ã‚£ã‚·ãƒ§ãƒ³å
        vasp_executable (str): VASPå®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«å

    Returns:
        str: ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†…å®¹
    """

    script = f"""#!/bin/bash
#SBATCH --job-name={job_name}
#SBATCH --nodes={nodes}
#SBATCH --ntasks-per-node={cores_per_node}
#SBATCH --time={walltime}
#SBATCH --partition={partition}

# ç’°å¢ƒå¤‰æ•°è¨­å®š
export OMP_NUM_THREADS=1

# ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒ­ãƒ¼ãƒ‰ï¼ˆç’°å¢ƒã«å¿œã˜ã¦èª¿æ•´ï¼‰
module load intel/2023
module load impi/2023
module load vasp/6.4.0

# è¨ˆç®—é–‹å§‹
echo "Job started at $(date)"
echo "Running on $(hostname)"
echo "Number of MPI tasks: $SLURM_NTASKS"

# VASPå®Ÿè¡Œ
mpirun -n $SLURM_NTASKS {vasp_executable} > vasp.out

# è¨ˆç®—çµ‚äº†
echo "Job completed at $(date)"

# çµæœãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚§ãƒƒã‚¯
if [ -f CONTCAR ]; then
    echo "CONTCAR created successfully"
fi

if [ -f OUTCAR ]; then
    echo "OUTCAR created successfully"
    # åæŸç¢ºèª
    tail -20 OUTCAR
fi
"""

    return script


# ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆä½œæˆ
script_content = create_job_script(
    job_name='si_relax',
    nodes=1,
    cores_per_node=32,
    walltime='12:00:00'
)

# ãƒ•ã‚¡ã‚¤ãƒ«ã«æ›¸ãè¾¼ã¿
with open('submit.sh', 'w') as f:
    f.write(script_content)

print("Job script created: submit.sh")
print(f"Submit with: sbatch submit.sh")
</code></pre>

            <h3>1.6.2 è¨ˆç®—ã®æŠ•å…¥ã¨ç›£è¦–</h3>

            <p>
                ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’æŠ•å…¥ã—ã€è¨ˆç®—ã®é€²è¡ŒçŠ¶æ³ã‚’ç›£è¦–ã—ã¾ã™ï¼š
            </p>

<pre><code class="language-bash"># ã‚¸ãƒ§ãƒ–æŠ•å…¥
sbatch submit.sh

# ã‚¸ãƒ§ãƒ–çŠ¶æ…‹ç¢ºèª
squeue -u $USER

# è¨ˆç®—ãƒ­ã‚°ã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–
tail -f vasp.out

# åæŸçŠ¶æ³ã®ç¢ºèªï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰åŒ–ï¼‰
grep "TOTEN" OSZICAR

# è¨ˆç®—ãŒå®Œäº†ã—ãŸã‚‰ã€æœ€çµ‚æ§‹é€ ã‚’ç¢ºèª
grep "TOTEN" OUTCAR | tail -1
</code></pre>

            <h3>1.6.3 ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®èª­ã¿æ–¹</h3>

            <p>
                VASPè¨ˆç®—ã§ã‚ˆãé­é‡ã™ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•ï¼š
            </p>

            <table>
                <thead>
                    <tr>
                        <th>ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</th>
                        <th>åŸå› </th>
                        <th>å¯¾å‡¦æ³•</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>Error EDDDAV: Call to ZHEGV failed</code></td>
                        <td>é›»å­SCFãŒåæŸã—ãªã„</td>
                        <td>ALGO=Fast â†’ Normal/Allã€NELMå¢—åŠ </td>
                    </tr>
                    <tr>
                        <td><code>ZBRENT: fatal error in bracketing</code></td>
                        <td>ã‚¤ã‚ªãƒ³ç·©å’Œã§ã®ç·šå½¢æ¢ç´¢å¤±æ•—</td>
                        <td>IBRION=2 â†’ 1ã€POTIMæ¸›å°‘ï¼ˆ0.1-0.3ï¼‰</td>
                    </tr>
                    <tr>
                        <td><code>POSMAP internal error</code></td>
                        <td>åŸå­é–“è·é›¢ãŒè¿‘ã™ãã‚‹</td>
                        <td>åˆæœŸæ§‹é€ ã‚’ä¿®æ­£</td>
                    </tr>
                    <tr>
                        <td><code>VERY BAD NEWS! internal error</code></td>
                        <td>æ•°å€¤ä¸å®‰å®šæ€§</td>
                        <td>PREC=Normalã€ENCUTå¢—åŠ ã€POTIMæ¸›å°‘</td>
                    </tr>
                    <tr>
                        <td><code>Error reading POTCAR</code></td>
                        <td>POTCARãŒä¸æ­£ã¾ãŸã¯æ¬ è½</td>
                        <td>POTCARå†ç”Ÿæˆã€å…ƒç´ é †ç¢ºèª</td>
                    </tr>
                </tbody>
            </table>

            <div class="info-box">
                <strong>ğŸ’¡ ãƒ‡ãƒãƒƒã‚°ã®ãƒ’ãƒ³ãƒˆ</strong>
                <ul>
                    <li><strong>æ®µéšçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ</strong>: ã¾ãšä½ç²¾åº¦ï¼ˆPREC=Normal, ENCUTä½ã‚ï¼‰ã§è¨ˆç®—ã—ã€åæŸã‚’ç¢ºèªã—ã¦ã‹ã‚‰ç²¾åº¦ã‚’ä¸Šã’ã‚‹</li>
                    <li><strong>ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ç¢ºèª</strong>: OUTCARã€OSZICARã€stdoutï¼ˆvasp.outï¼‰ã‚’å…¨ã¦ç¢ºèª</li>
                    <li><strong>åˆæœŸæ§‹é€ ãƒã‚§ãƒƒã‚¯</strong>: VESTAç­‰ã§æ§‹é€ ã‚’å¯è¦–åŒ–ã—ã€åŸå­è¡çªãŒãªã„ã‹ç¢ºèª</li>
                    <li><strong>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰æ›´ã¯1ã¤ãšã¤</strong>: è¤‡æ•°åŒæ™‚å¤‰æ›´ã¯åŸå› ç‰¹å®šã‚’å›°é›£ã«ã™ã‚‹</li>
                </ul>
            </div>
        </section>

        <section id="results">
            <h2>1.7 è¨ˆç®—çµæœã®ç¢ºèªã¨å¯è¦–åŒ–</h2>

            <h3>1.7.1 å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¨®é¡</h3>

            <table>
                <thead>
                    <tr>
                        <th>ãƒ•ã‚¡ã‚¤ãƒ«å</th>
                        <th>å†…å®¹</th>
                        <th>ç”¨é€”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>OUTCAR</strong></td>
                        <td>è©³ç´°ãªè¨ˆç®—ãƒ­ã‚°</td>
                        <td>ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€åŠ›ã€å¿œåŠ›ã€ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆç­‰</td>
                    </tr>
                    <tr>
                        <td><strong>OSZICAR</strong></td>
                        <td>SCFåæŸå±¥æ­´ï¼ˆç°¡æ˜“ç‰ˆï¼‰</td>
                        <td>åæŸç¢ºèªã€ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰åŒ–ã®è¿½è·¡</td>
                    </tr>
                    <tr>
                        <td><strong>CONTCAR</strong></td>
                        <td>æœ€çµ‚æ§‹é€ </td>
                        <td>æ¬¡ã®è¨ˆç®—ã®åˆæœŸæ§‹é€ ã¨ã—ã¦ä½¿ç”¨</td>
                    </tr>
                    <tr>
                        <td><strong>vasprun.xml</strong></td>
                        <td>XMLå½¢å¼ã®å…¨çµæœ</td>
                        <td>Pythonã§ã®è§£æã«æœ€é©</td>
                    </tr>
                    <tr>
                        <td><strong>CHG/CHGCAR</strong></td>
                        <td>é›»è·å¯†åº¦</td>
                        <td>å¯è¦–åŒ–ã€æ¬¡ã®è¨ˆç®—ã®åˆæœŸé›»è·</td>
                    </tr>
                    <tr>
                        <td><strong>WAVECAR</strong></td>
                        <td>æ³¢å‹•é–¢æ•°</td>
                        <td>è¨ˆç®—å†é–‹ã€ãƒãƒ³ãƒ‰è¨ˆç®—</td>
                    </tr>
                </tbody>
            </table>

            <h3>1.7.2 OUTCAR/OSZICARã®èª­ã¿æ–¹</h3>

            <p>
                æœ€çµ‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€åŠ›ã€å¿œåŠ›ã‚’OUTCARã‹ã‚‰æŠ½å‡ºã—ã¾ã™ï¼š
            </p>

<pre><code class="language-bash"># æœ€çµ‚å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼
grep "TOTEN" OUTCAR | tail -1
# energy  without entropy=     -10.843210  energy(sigma->0) =     -10.843210

# æœ€çµ‚çš„ãªåŸå­ã«åƒãåŠ›
grep -A 10 "TOTAL-FORCE" OUTCAR | tail -10

# å¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ«
grep -A 5 "Total" OUTCAR | grep -A 5 "in kB"
</code></pre>

            <h3>1.7.3 pymatgenã§ã®è§£æ</h3>

            <p>
                pymatgenã‚’ä½¿ã£ã¦è¨ˆç®—çµæœã‚’è§£æã—ã¦ã¿ã¾ã—ã‚‡ã†ï¼š
            </p>

<pre><code class="language-python">#!/usr/bin/env python3
"""VASPè¨ˆç®—çµæœã®è§£æï¼ˆpymatgenä½¿ç”¨ï¼‰"""

from pymatgen.io.vasp.outputs import Vasprun, Outcar
import matplotlib.pyplot as plt
import numpy as np

# vasprun.xmlã‚’èª­ã¿è¾¼ã¿ï¼ˆå…¨çµæœãŒæ ¼ç´ï¼‰
vasprun = Vasprun("vasprun.xml")

# æœ€çµ‚æ§‹é€ ã¨å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼
final_structure = vasprun.final_structure
final_energy = vasprun.final_energy

print(f"Final Energy: {final_energy:.6f} eV")
print(f"Final Structure:")
print(final_structure)

# æ§‹é€ æœ€é©åŒ–ã®å±¥æ­´
ionic_steps = vasprun.ionic_steps
n_steps = len(ionic_steps)

# ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸã®å¯è¦–åŒ–
energies = [step['e_0_energy'] for step in ionic_steps]

plt.figure(figsize=(10, 6))
plt.plot(range(1, n_steps+1), energies, 'o-', linewidth=2, markersize=6)
plt.xlabel('Ionic Step', fontsize=12)
plt.ylabel('Energy (eV)', fontsize=12)
plt.title('Energy Convergence', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('energy_convergence.png', dpi=300, bbox_inches='tight')
print(f"Energy convergence plot saved: energy_convergence.png")

# åŠ›ã®åæŸç¢ºèª
forces = []
for step in ionic_steps:
    # å„åŸå­ã®åŠ›ã®æœ€å¤§å€¤
    max_force = max([np.linalg.norm(f) for f in step['forces']])
    forces.append(max_force)

plt.figure(figsize=(10, 6))
plt.plot(range(1, n_steps+1), forces, 's-', linewidth=2, markersize=6, color='orange')
plt.axhline(y=0.01, color='red', linestyle='--', label='Convergence threshold')
plt.xlabel('Ionic Step', fontsize=12)
plt.ylabel('Max Force on Atoms (eV/Ã…)', fontsize=12)
plt.title('Force Convergence', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.yscale('log')
plt.tight_layout()
plt.savefig('force_convergence.png', dpi=300, bbox_inches='tight')
print(f"Force convergence plot saved: force_convergence.png")

# OUTCARã‹ã‚‰ã®è©³ç´°æƒ…å ±èª­ã¿å–ã‚Š
outcar = Outcar("OUTCAR")

# æœ€çµ‚çš„ãªåŠ›ï¼ˆå…¨åŸå­ï¼‰
print(f"\nFinal forces on atoms:")
final_forces = ionic_steps[-1]['forces']
for i, force in enumerate(final_forces):
    f_magnitude = np.linalg.norm(force)
    print(f"  Atom {i+1}: |F| = {f_magnitude:.6f} eV/Ã…, F = {force}")

# å¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ«ï¼ˆkBarå˜ä½ï¼‰
if hasattr(outcar, 'final_stress'):
    stress = outcar.final_stress  # 3x3è¡Œåˆ—ï¼ˆkBarï¼‰
    print(f"\nFinal stress tensor (kBar):")
    print(stress)

# åæŸåˆ¤å®š
converged = final_energy is not None and forces[-1] < 0.01
print(f"\nConvergence status: {'âœ“ Converged' if converged else 'âœ— Not converged'}")

# å®Ÿè¡Œæ™‚é–“ã®å–å¾—
elapsed_time = outcar.run_stats.get('Total CPU time used (sec)', 0)
print(f"Total CPU time: {elapsed_time:.2f} seconds ({elapsed_time/3600:.2f} hours)")
</code></pre>

            <p>
                ã“ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä»¥ä¸‹ã‚’å‡ºåŠ›ã—ã¾ã™ï¼š
            </p>

            <ul>
                <li>æœ€çµ‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨æ§‹é€ </li>
                <li>ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸã‚°ãƒ©ãƒ•ï¼ˆenergy_convergence.pngï¼‰</li>
                <li>åŠ›ã®åæŸã‚°ãƒ©ãƒ•ï¼ˆforce_convergence.pngï¼‰</li>
                <li>å„åŸå­ã«åƒãåŠ›</li>
                <li>å¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ«</li>
                <li>åæŸåˆ¤å®šã¨è¨ˆç®—æ™‚é–“</li>
            </ul>

            <h3>1.7.4 çµæ™¶æ§‹é€ ã®å¯è¦–åŒ–</h3>

            <p>
                VESTAã¯çµæ™¶æ§‹é€ å¯è¦–åŒ–ã«æœ€é©ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚POSCAR/CONTCARã‚’ç›´æ¥èª­ã¿è¾¼ã‚ã¾ã™ï¼š
            </p>

<pre><code class="language-bash"># VESTAã§é–‹ãï¼ˆGUIãƒ„ãƒ¼ãƒ«ï¼‰
vesta CONTCAR

# ã¾ãŸã¯ã€ASEã§Pythonå†…ã§å¯è¦–åŒ–
python -c "from ase.io import read, write; \
           atoms = read('CONTCAR'); \
           write('structure.png', atoms)"
</code></pre>

            <p>
                pymatgenã§ã‚‚ç°¡æ˜“çš„ãªå¯è¦–åŒ–ãŒã§ãã¾ã™ï¼š
            </p>

<pre><code class="language-python">from pymatgen.core import Structure
from pymatgen.analysis.structure_analyzer import SpacegroupAnalyzer

structure = Structure.from_file("CONTCAR")

# ç©ºé–“ç¾¤è§£æ
sga = SpacegroupAnalyzer(structure)
print(f"Space group: {sga.get_space_group_symbol()}")
print(f"Space group number: {sga.get_space_group_number()}")

# åŸå§‹ã‚»ãƒ«ã¸ã®å¤‰æ›
primitive = sga.find_primitive()
print(f"Primitive cell: {len(primitive)} atoms")
</code></pre>
        </section>

        <section id="learning-objectives">
            <h2>1.8 å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

            <div class="info-box">
                <strong>ã“ã®chapterã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’èª¬æ˜ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</strong>
            </div>

            <h3>ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬ç†è§£</h3>
            <ul>
                <li>âœ… DFTè¨ˆç®—ã®åŸºæœ¬åŸç†ï¼ˆHohenberg-Kohnã®å®šç†ã€Kohn-Shamæ–¹ç¨‹å¼ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… VASPã®4ã¤ã®ä¸»è¦å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆINCAR, POSCAR, KPOINTS, POTCARï¼‰ã®å½¹å‰²ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                <li>âœ… PAWæ³•ã®æ¦‚è¦ã¨Ultrasoftæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¨ã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… äº¤æ›ç›¸é–¢æ±é–¢æ•°ï¼ˆLDA, GGA, meta-GGA, Hybridï¼‰ã®ç‰¹å¾´ã‚’èª¬æ˜ã§ãã‚‹</li>
            </ul>

            <h3>ãƒ¬ãƒ™ãƒ«2: å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
            <ul>
                <li>âœ… pymatgenã‚’ä½¿ã£ã¦INCAR/POSCARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã§ãã‚‹</li>
                <li>âœ… ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ä½œæˆã—ã¦VASPè¨ˆç®—ã‚’å®Ÿè¡Œã§ãã‚‹</li>
                <li>âœ… OUTCAR/vasprun.xmlã‹ã‚‰è¨ˆç®—çµæœï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã€åŠ›ã€å¿œåŠ›ï¼‰ã‚’èª­ã¿å–ã‚Œã‚‹</li>
                <li>âœ… ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»åŠ›ã®åæŸã‚°ãƒ©ãƒ•ã‚’Pythonã§ä½œæˆã§ãã‚‹</li>
                <li>âœ… è¨ˆç®—ã‚¨ãƒ©ãƒ¼ã®åŸå› ã‚’ç‰¹å®šã—ã€å¯¾å‡¦æ³•ã‚’é¸æŠã§ãã‚‹</li>
            </ul>

            <h3>ãƒ¬ãƒ™ãƒ«3: å¿œç”¨åŠ›</h3>
            <ul>
                <li>âœ… ææ–™ã«å¿œã˜ãŸé©åˆ‡ãªè¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆENCUT, kç‚¹, æ±é–¢æ•°ï¼‰ã‚’è¨­å®šã§ãã‚‹</li>
                <li>âœ… åæŸã—ãªã„è¨ˆç®—ã®ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãŒã§ãã‚‹ï¼ˆALGOã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ å¤‰æ›´ã€POTIMèª¿æ•´ç­‰ï¼‰</li>
                <li>âœ… Pythonã§è¨ˆç®—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆâ†’å®Ÿè¡Œâ†’è§£æï¼‰ã‚’è‡ªå‹•åŒ–ã§ãã‚‹</li>
                <li>âœ… Materials Projectã®ãƒ‡ãƒ¼ã‚¿ã¨VASPè¨ˆç®—çµæœã‚’æ¯”è¼ƒãƒ»æ¤œè¨¼ã§ãã‚‹</li>
            </ul>
        </section>

        <section id="exercises">
            <h2>1.9 æ¼”ç¿’å•é¡Œ</h2>

            <div class="exercise-box">
                <h4>Easy - åŸºç¤ç¢ºèª <span class="difficulty easy">Easy</span></h4>

                <p><strong>Q1</strong>: DFTè¨ˆç®—ã§ä½¿ã‚ã‚Œã‚‹Kohn-Shamæ–¹ç¨‹å¼ã®ç‰©ç†çš„æ„å‘³ã‚’èª¬æ˜ã—ãªã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>: Kohn-Shamæ–¹ç¨‹å¼ã¯ã€é›»å­é–“ç›¸äº’ä½œç”¨ã‚’å«ã‚€å¤šä½“å•é¡Œã‚’ã€æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ä¸­ã®éç›¸äº’ä½œç”¨é›»å­ç³»ã®å•é¡Œã«ç½®ãæ›ãˆãŸã‚‚ã®ã§ã™ã€‚å„é›»å­ã¯ç‹¬ç«‹ã«å‹•ãã¾ã™ãŒã€æœ‰åŠ¹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆå¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« + Hartreeãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« + äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼‰ã‚’é€šã˜ã¦é–“æ¥çš„ã«ç›¸äº’ä½œç”¨ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€Né›»å­ç³»ã®3Næ¬¡å…ƒSchrÃ¶dingeræ–¹ç¨‹å¼ãŒã€Nå€‹ã®3æ¬¡å…ƒKohn-Shamæ–¹ç¨‹å¼ã«åˆ†è§£ã•ã‚Œã€è¨ˆç®—ãŒå®Ÿç”¨çš„ã«ãªã‚Šã¾ã™ã€‚</p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Easy - åŸºç¤ç¢ºèª <span class="difficulty easy">Easy</span></h4>

                <p><strong>Q2</strong>: VASPè¨ˆç®—ã«å¿…é ˆã®4ã¤ã®å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆINCAR, POSCAR, KPOINTS, POTCARï¼‰ã®å½¹å‰²ã‚’èª¬æ˜ã—ãªã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>:</p>
                    <ul>
                        <li><strong>INCAR</strong>: è¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆENCUT, EDIFF, NSW, IBRIONãªã©ï¼‰ã‚’è¨­å®šã€‚è¨ˆç®—ã®ç¨®é¡ï¼ˆSCF, æ§‹é€ æœ€é©åŒ–, MDï¼‰ã‚„ç²¾åº¦ã‚’æŒ‡å®š</li>
                        <li><strong>POSCAR</strong>: çµæ™¶æ§‹é€ æƒ…å ±ï¼ˆæ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã€åŸå­ç¨®ã€åŸå­åº§æ¨™ï¼‰ã‚’è¨˜è¿°ã€‚è¨ˆç®—å¯¾è±¡ã®ã‚¸ã‚ªãƒ¡ãƒˆãƒªã‚’å®šç¾©</li>
                        <li><strong>KPOINTS</strong>: Brillouin zoneç©åˆ†ã®ãŸã‚ã®kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã‚’è¨­å®šã€‚å¯†åº¦ãŒé«˜ã„ã»ã©ç²¾åº¦å‘ä¸Š</li>
                        <li><strong>POTCAR</strong>: æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆPAW-PBEãªã©ï¼‰ã‚’æ ¼ç´ã€‚å†…æ®»é›»å­ã‚’ç½®ãæ›ãˆã€è¨ˆç®—åŠ¹ç‡ã‚’å‘ä¸Š</li>
                    </ul>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Easy - åŸºç¤ç¢ºèª <span class="difficulty easy">Easy</span></h4>

                <p><strong>Q3</strong>: pymatgenã‚’ä½¿ã£ã¦NaClï¼ˆå²©å¡©å‹ï¼‰ã®çµæ™¶æ§‹é€ ã®POSCARãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãªã•ã„ã€‚æ ¼å­å®šæ•°ã¯5.64 Ã…ã§ã™ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
<pre><code class="language-python">from pymatgen.core import Structure, Lattice

# NaClå²©å¡©å‹æ§‹é€ ï¼ˆface-centered cubicï¼‰
lattice = Lattice.cubic(5.64)

nacl_structure = Structure(
    lattice,
    ["Na", "Cl"],
    [[0, 0, 0], [0.5, 0.5, 0.5]],  # åˆ†æ•°åº§æ¨™
    coords_are_cartesian=False
)

nacl_structure.to(filename="POSCAR_NaCl", fmt="poscar")
print(nacl_structure)

# å‡ºåŠ›:
# Full Formula (NaCl1)
# Reduced Formula: NaCl
# abc   :   5.640000   5.640000   5.640000
# angles:  90.000000  90.000000  90.000000
# Sites (2)
#   #  SP       a     b     c
# ---  ----  ----  ----  ----
#   0  Na    0.00  0.00  0.00
#   1  Cl    0.50  0.50  0.50
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Medium - å¿œç”¨å•é¡Œ <span class="difficulty medium">Medium</span></h4>

                <p><strong>Q4</strong>: LDAã€GGAã€meta-GGAã®é•ã„ã‚’èª¬æ˜ã—ã€ãã‚Œãã‚Œã®é©ç”¨ä¾‹ã‚’æŒ™ã’ãªã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>:</p>
                    <ul>
                        <li><strong>LDAï¼ˆLocal Density Approximationï¼‰</strong>: äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å±€æ‰€çš„ãªé›»å­å¯†åº¦ã®ã¿ã§è¿‘ä¼¼ã€‚è¨ˆç®—é«˜é€Ÿã ãŒã€çµåˆé•·ã‚’éå°è©•ä¾¡ã™ã‚‹å‚¾å‘ã‚ã‚Šã€‚é©ç”¨ä¾‹: é‡‘å±ã€é«˜å¯†åº¦ç³»</li>
                        <li><strong>GGAï¼ˆGeneralized Gradient Approximationã€ä¾‹: PBEï¼‰</strong>: é›»å­å¯†åº¦ã®å‹¾é…ã‚‚è€ƒæ…®ã€‚LDAã‚ˆã‚Šç²¾åº¦å‘ä¸Šã—ã€ã»ã¨ã‚“ã©ã®ææ–™ã«é©ç”¨å¯èƒ½ã€‚é©ç”¨ä¾‹: é‡‘å±ã€åŠå°ä½“ã€çµ¶ç¸ä½“ã€æœ‰æ©Ÿç‰©</li>
                        <li><strong>meta-GGAï¼ˆä¾‹: SCANï¼‰</strong>: é›»å­å¯†åº¦ã®2æ¬¡å¾®åˆ†ï¼ˆLaplacianï¼‰ã‚„é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼å¯†åº¦ã‚‚åˆ©ç”¨ã€‚é«˜ç²¾åº¦ã ãŒè¨ˆç®—ã‚³ã‚¹ãƒˆå¢—ã€‚é©ç”¨ä¾‹: æ ¼å­å®šæ•°ãƒ»å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ç²¾å¯†è¨ˆç®—</li>
                    </ul>
                    <p><strong>æ¨å¥¨</strong>: ä¸€èˆ¬çš„ã«ã¯PBEï¼ˆGGAï¼‰ãŒæ¨™æº–çš„é¸æŠã€‚ç²¾åº¦ã¨ã‚³ã‚¹ãƒˆã®ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ãã€Materials Projectã§ã‚‚æ¡ç”¨ã€‚</p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Medium - å¿œç”¨å•é¡Œ <span class="difficulty medium">Medium</span></h4>

                <p><strong>Q5</strong>: VASPã¨Quantum ESPRESSOã®é•ã„ã‚’3ã¤æŒ™ã’ã€ä½¿ã„åˆ†ã‘ã®åŸºæº–ã‚’è¿°ã¹ãªã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>:</p>
                    <table>
                        <thead>
                            <tr>
                                <th>é …ç›®</th>
                                <th>VASP</th>
                                <th>Quantum ESPRESSO</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</td>
                                <td>å•†ç”¨ï¼ˆæœ‰å„Ÿï¼‰</td>
                                <td>ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ï¼ˆGPLã€ç„¡å„Ÿï¼‰</td>
                            </tr>
                            <tr>
                                <td>è¨ˆç®—é€Ÿåº¦</td>
                                <td>é«˜é€Ÿï¼ˆæœ€é©åŒ–æ¸ˆã¿ï¼‰</td>
                                <td>ã‚„ã‚„é…ã„ï¼ˆãŸã ã—æ”¹å–„ä¸­ï¼‰</td>
                            </tr>
                            <tr>
                                <td>æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</td>
                                <td>PAWï¼ˆé«˜ç²¾åº¦ï¼‰</td>
                                <td>USPP/PAWï¼ˆä¸¡å¯¾å¿œï¼‰</td>
                            </tr>
                            <tr>
                                <td>ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</td>
                                <td>å•†ç”¨ã‚µãƒãƒ¼ãƒˆã€Materials Projectæ¨™æº–</td>
                                <td>æ´»ç™ºãªã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£</td>
                            </tr>
                        </tbody>
                    </table>
                    <p><strong>ä½¿ã„åˆ†ã‘åŸºæº–</strong>:</p>
                    <ul>
                        <li><strong>VASPã‚’é¸ã¶</strong>: è¨ˆç®—åŠ¹ç‡é‡è¦–ã€Materials Projectã¨ã®é€£æºã€ç”£æ¥­å¿œç”¨</li>
                        <li><strong>Quantum ESPRESSOã‚’é¸ã¶</strong>: ãƒ©ã‚¤ã‚»ãƒ³ã‚¹äºˆç®—ãªã—ã€ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§é‡è¦–ã€ãƒ•ã‚©ãƒãƒ³è¨ˆç®—</li>
                    </ul>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Medium - å®Ÿè£…å•é¡Œ <span class="difficulty medium">Medium</span></h4>

                <p><strong>Q6</strong>: Siçµæ™¶ã®æ§‹é€ æœ€é©åŒ–ã‚’è¡Œã†INCAR, POSCAR, KPOINTSãƒ•ã‚¡ã‚¤ãƒ«ã‚’pymatgenã§ä½œæˆã—ãªã•ã„ã€‚æ§‹é€ æœ€é©åŒ–ã®æ¡ä»¶ã¯ã€EDIFFG=-0.01ï¼ˆåŠ›ã®åæŸåˆ¤å®š0.01 eV/Ã…ï¼‰ã€Monkhorst-Pack 8Ã—8Ã—8 kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã¨ã—ã¾ã™ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
<pre><code class="language-python">from pymatgen.core import Structure, Lattice
from pymatgen.io.vasp.inputs import Incar, Kpoints

# 1. POSCARä½œæˆ
lattice = Lattice.cubic(5.43)
si_structure = Structure(
    lattice,
    ["Si", "Si"],
    [[0, 0, 0], [0.25, 0.25, 0.25]],
    coords_are_cartesian=False
)
si_structure.to(filename="POSCAR", fmt="poscar")
print("POSCAR created")

# 2. INCARä½œæˆ
incar = Incar({
    'SYSTEM': 'Si bulk relaxation',
    'ISTART': 0,
    'ICHARG': 2,
    'ENCUT': 520,      # Siæ¨å¥¨å€¤: 245.3 eVã®2å€
    'EDIFF': 1e-6,
    'EDIFFG': -0.01,   # åŠ›ã®åæŸåˆ¤å®šï¼ˆå•é¡ŒæŒ‡å®šï¼‰
    'NSW': 100,
    'IBRION': 2,       # CGæ³•
    'ISIF': 3,         # åŸå­+æ ¼å­æœ€é©åŒ–
    'ISMEAR': 0,
    'SIGMA': 0.05,
    'PREC': 'Accurate',
    'LREAL': False,
})
incar.write_file('INCAR')
print("INCAR created")

# 3. KPOINTSä½œæˆ
kpoints = Kpoints.monkhorst_automatic(kpts=(8, 8, 8), shift=(0, 0, 0))
kpoints.write_file('KPOINTS')
print("KPOINTS created: 8x8x8 mesh")

print("\nFiles created successfully!")
print("Next step: Prepare POTCAR and submit job")
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Medium - å®Ÿè£…å•é¡Œ <span class="difficulty medium">Medium</span></h4>

                <p><strong>Q7</strong>: vasprun.xmlã‹ã‚‰ã‚¨ãƒãƒ«ã‚®ãƒ¼åæŸã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã€åæŸæ€§ã‚’è©•ä¾¡ã—ãªã•ã„ã€‚åæŸåˆ¤å®šåŸºæº–ã¯ã€é€£ç¶š2ã‚¹ãƒ†ãƒƒãƒ—ã§ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰åŒ–ãŒ1 meV/atomä»¥ä¸‹ã¨ã—ã¾ã™ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
<pre><code class="language-python">from pymatgen.io.vasp.outputs import Vasprun
import matplotlib.pyplot as plt
import numpy as np

# vasprun.xmlèª­ã¿è¾¼ã¿
vasprun = Vasprun("vasprun.xml")

# æ§‹é€ æœ€é©åŒ–å±¥æ­´
ionic_steps = vasprun.ionic_steps
n_atoms = len(vasprun.final_structure)

# ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆatomå¹³å‡ï¼‰
energies = [step['e_0_energy'] / n_atoms for step in ionic_steps]
n_steps = len(energies)

# ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®ï¼ˆmeV/atomï¼‰
energy_diffs = [1000 * (energies[i] - energies[i-1]) for i in range(1, n_steps)]

# åæŸåˆ¤å®š
converged_step = None
for i in range(1, len(energy_diffs)):
    if abs(energy_diffs[i]) < 1.0 and abs(energy_diffs[i-1]) < 1.0:
        converged_step = i + 1  # ionic stepç•ªå·ï¼ˆ1-indexedï¼‰
        break

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(10, 10))

# ã‚¨ãƒãƒ«ã‚®ãƒ¼
ax1.plot(range(1, n_steps+1), energies, 'o-', linewidth=2)
ax1.set_xlabel('Ionic Step', fontsize=12)
ax1.set_ylabel('Energy per atom (eV)', fontsize=12)
ax1.set_title('Energy Convergence', fontsize=14, fontweight='bold')
ax1.grid(True, alpha=0.3)

if converged_step:
    ax1.axvline(x=converged_step, color='green', linestyle='--',
                label=f'Converged at step {converged_step}')
    ax1.legend()

# ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®
ax2.plot(range(2, n_steps+1), energy_diffs, 's-', linewidth=2, color='orange')
ax2.axhline(y=1.0, color='red', linestyle='--', label='Â±1 meV/atom threshold')
ax2.axhline(y=-1.0, color='red', linestyle='--')
ax2.set_xlabel('Ionic Step', fontsize=12)
ax2.set_ylabel('Energy change (meV/atom)', fontsize=12)
ax2.set_title('Energy Change per Step', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('energy_convergence_analysis.png', dpi=300)

# è©•ä¾¡çµæœ
print(f"Total ionic steps: {n_steps}")
print(f"Final energy: {energies[-1]:.6f} eV/atom")

if converged_step:
    print(f"âœ“ Converged at step {converged_step}")
    print(f"  Energy change in last 2 steps: {energy_diffs[-1]:.3f}, {energy_diffs[-2]:.3f} meV/atom")
else:
    print("âœ— Not converged within NSW steps")
    print(f"  Consider increasing NSW or checking structure stability")

print(f"\nPlot saved: energy_convergence_analysis.png")
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Hard - ç™ºå±•å•é¡Œ <span class="difficulty hard">Hard</span></h4>

                <p><strong>Q8</strong>: ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆENCUTï¼‰ã¨kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã‚’å¤‰åŒ–ã•ã›ã€å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åæŸæ€§ã‚’èª¿ã¹ãªã•ã„ã€‚Siçµæ™¶ã‚’ä¾‹ã«ã€ENCUT = 300, 400, 520, 600 eVã€kç‚¹ = 4Ã—4Ã—4, 6Ã—6Ã—6, 8Ã—8Ã—8, 10Ã—10Ã—10ã®16é€šã‚Šã®çµ„ã¿åˆã‚ã›ã§è¨ˆç®—ã—ã€åæŸåˆ¤å®šã‚’å®Ÿæ–½ã—ãªã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
<pre><code class="language-python">#!/usr/bin/env python3
"""ENCUT & k-points convergence test"""

import os
import subprocess
from pymatgen.core import Structure, Lattice
from pymatgen.io.vasp.inputs import Incar, Kpoints
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# Siæ§‹é€ 
lattice = Lattice.cubic(5.43)
structure = Structure(lattice, ["Si", "Si"],
                     [[0, 0, 0], [0.25, 0.25, 0.25]])

# åæŸãƒ†ã‚¹ãƒˆç¯„å›²
encut_values = [300, 400, 520, 600]  # eV
kpoint_values = [4, 6, 8, 10]  # k-mesh (uniform)

# çµæœä¿å­˜ç”¨
results = []

for encut in encut_values:
    for k in kpoint_values:
        job_dir = f"encut_{encut}_k_{k}"
        os.makedirs(job_dir, exist_ok=True)

        # POSCAR
        structure.to(filename=f"{job_dir}/POSCAR", fmt="poscar")

        # INCARï¼ˆSCFè¨ˆç®—ã®ã¿ã€æ§‹é€ å›ºå®šï¼‰
        incar = Incar({
            'SYSTEM': f'Si ENCUT={encut} k={k}',
            'ISTART': 0,
            'ICHARG': 2,
            'ENCUT': encut,
            'EDIFF': 1e-7,  # å³æ ¼ãªåæŸåˆ¤å®š
            'NSW': 0,       # æ§‹é€ å›ºå®šï¼ˆSCFã®ã¿ï¼‰
            'ISMEAR': 0,
            'SIGMA': 0.05,
            'PREC': 'Accurate',
            'LREAL': False,
        })
        incar.write_file(f"{job_dir}/INCAR")

        # KPOINTS
        kpoints = Kpoints.monkhorst_automatic(kpts=(k, k, k), shift=(0, 0, 0))
        kpoints.write_file(f"{job_dir}/KPOINTS")

        # POTCARï¼ˆæ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼å¿…è¦ï¼‰
        # subprocess.run(['cp', 'POTCAR_Si', f'{job_dir}/POTCAR'])

        print(f"Setup complete: {job_dir}")

        # å®Ÿéš›ã®è¨ˆç®—å®Ÿè¡Œï¼ˆã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆçµŒç”±ï¼‰
        # os.chdir(job_dir)
        # subprocess.run(['sbatch', 'submit.sh'])
        # os.chdir('..')

# çµæœè§£æï¼ˆå…¨è¨ˆç®—å®Œäº†å¾Œï¼‰
print("\n=== Convergence Analysis ===")
results_df = pd.DataFrame(columns=['ENCUT', 'k-mesh', 'Energy (eV/atom)',
                                   'Delta E (meV/atom)'])

# å„è¨ˆç®—çµæœã‚’èª­ã¿è¾¼ã¿ï¼ˆvasprun.xmlï¼‰
for encut in encut_values:
    for k in kpoint_values:
        job_dir = f"encut_{encut}_k_{k}"
        vasprun_path = f"{job_dir}/vasprun.xml"

        if os.path.exists(vasprun_path):
            from pymatgen.io.vasp.outputs import Vasprun
            vr = Vasprun(vasprun_path)
            energy_per_atom = vr.final_energy / len(structure)

            results.append({
                'ENCUT': encut,
                'k-mesh': k,
                'Energy': energy_per_atom
            })

# DataFrameåŒ–
df = pd.DataFrame(results)

# æœ€ã‚‚åæŸã—ãŸå€¤ï¼ˆENCUT=600, k=10ï¼‰ã‚’åŸºæº–
ref_energy = df[(df['ENCUT']==600) & (df['k-mesh']==10)]['Energy'].values[0]

# ç›¸å¯¾ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®ï¼ˆmeV/atomï¼‰
df['Delta E (meV/atom)'] = 1000 * (df['Energy'] - ref_energy)

print(df)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# ENCUTåæŸï¼ˆk=8å›ºå®šï¼‰
encut_conv = df[df['k-mesh'] == 8]
ax1.plot(encut_conv['ENCUT'], encut_conv['Delta E (meV/atom)'], 'o-', linewidth=2)
ax1.axhline(y=1.0, color='red', linestyle='--', label='1 meV/atom threshold')
ax1.axhline(y=-1.0, color='red', linestyle='--')
ax1.set_xlabel('ENCUT (eV)', fontsize=12)
ax1.set_ylabel('Energy difference (meV/atom)', fontsize=12)
ax1.set_title('ENCUT Convergence (k=8x8x8)', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)

# kç‚¹åæŸï¼ˆENCUT=520å›ºå®šï¼‰
k_conv = df[df['ENCUT'] == 520]
ax2.plot(k_conv['k-mesh'], k_conv['Delta E (meV/atom)'], 's-', linewidth=2, color='orange')
ax2.axhline(y=1.0, color='red', linestyle='--', label='1 meV/atom threshold')
ax2.axhline(y=-1.0, color='red', linestyle='--')
ax2.set_xlabel('k-mesh', fontsize=12)
ax2.set_ylabel('Energy difference (meV/atom)', fontsize=12)
ax2.set_title('k-point Convergence (ENCUT=520 eV)', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('convergence_test.png', dpi=300)

print("\nâœ“ Convergence analysis complete")
print("Recommended settings:")
print(f"  ENCUT >= 520 eV (converged within 1 meV/atom)")
print(f"  k-mesh >= 8x8x8 (converged within 1 meV/atom)")
</code></pre>
                    <p><strong>è©•ä¾¡</strong>: ä¸€èˆ¬çš„ã«Siã§ã¯ENCUT=520 eVï¼ˆæ¨å¥¨å€¤ã®2å€ï¼‰ã€kç‚¹8Ã—8Ã—8ã§1 meV/atomä»¥å†…ã®ç²¾åº¦ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚é«˜ç²¾åº¦è¨ˆç®—ã§ã¯ENCUT=600 eVã€kç‚¹10Ã—10Ã—10ãŒæ¨å¥¨ã•ã‚Œã¾ã™ã€‚</p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Hard - ç™ºå±•å•é¡Œ <span class="difficulty hard">Hard</span></h4>

                <p><strong>Q9</strong>: PAWæ³•ãŒUltrasoftæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚ˆã‚Šç²¾åº¦ãŒé«˜ã„ç†ç”±ã‚’ã€æ³¢å‹•é–¢æ•°ã®å–ã‚Šæ‰±ã„ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã—ãªã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è§£ç­”</strong>:</p>

                    <p><strong>PAWæ³•ã®åŸç†</strong>:</p>
                    <ul>
                        <li>å…¨é›»å­æ³¢å‹•é–¢æ•° \(\psi\) ã¨æ“¬æ³¢å‹•é–¢æ•° \(\tilde{\psi}\) ã®é–“ã«ç·šå½¢å¤‰æ› \(\hat{T}\) ã‚’å®šç¾©: \(|\psi\rangle = \hat{T}|\tilde{\psi}\rangle\)</li>
                        <li>åŸå­æ ¸è¿‘å‚ã§ã¯å…¨é›»å­æ³¢å‹•é–¢æ•°ã‚’å†æ§‹æˆã—ã€å¤–å´ã§ã¯æ“¬æ³¢å‹•é–¢æ•°ã‚’ä½¿ç”¨</li>
                        <li>é›»è·å¯†åº¦ãƒ»ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãªã©ã®ç‰©ç†é‡ã‚’æ­£ç¢ºã«è¨ˆç®—å¯èƒ½</li>
                    </ul>

                    <p><strong>Ultrasoftæ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¨ã®é•ã„</strong>:</p>
                    <ul>
                        <li><strong>USPP</strong>: æ“¬æ³¢å‹•é–¢æ•°ã®ã¿ã‚’æ‰±ã„ã€å†…æ®»é ˜åŸŸã®è©³ç´°æƒ…å ±ã‚’å¤±ã†ã€‚ãƒãƒ«ãƒ ä¿å­˜æ¡ä»¶ã‚’ç·©å’Œ</li>
                        <li><strong>PAW</strong>: å…¨é›»å­æ³¢å‹•é–¢æ•°ã‚’ä¿æŒã—ã€å†…æ®»é ˜åŸŸã®æƒ…å ±ã‚‚æ­£ç¢ºã€‚ãƒãƒ«ãƒ ä¿å­˜æ¡ä»¶ã‚’æº€ãŸã™</li>
                    </ul>

                    <p><strong>ç²¾åº¦å‘ä¸Šã®ç†ç”±</strong>:</p>
                    <ol>
                        <li><strong>å…¨é›»å­å¯†åº¦ã®æ­£ç¢ºãªå†æ§‹æˆ</strong>: åŸå­æ ¸è¿‘å‚ã®é›»è·å¯†åº¦ã‚’ç²¾å¯†ã«è¨ˆç®—</li>
                        <li><strong>ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®ç²¾åº¦</strong>: ã‚¹ãƒ”ãƒ³å¯†åº¦ãŒãƒãƒ¼ãƒ‰æ§‹é€ ã‚’æŒã¤é·ç§»é‡‘å±ã§é‡è¦</li>
                        <li><strong>è¶…å¾®ç´°ç›¸äº’ä½œç”¨</strong>: NMRã€MÃ¶ssbauerãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¨ˆç®—ç²¾åº¦ãŒå‘ä¸Š</li>
                        <li><strong>é›»å ´å‹¾é…</strong>: æ ¸å››é‡æ¥µç›¸äº’ä½œç”¨ã®æ­£ç¢ºãªè©•ä¾¡</li>
                    </ol>

                    <p><strong>å®Ÿç”¨çš„å½±éŸ¿</strong>:</p>
                    <ul>
                        <li>é·ç§»é‡‘å±é…¸åŒ–ç‰©: ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã€é…¸åŒ–çŠ¶æ…‹ã®æ­£ç¢ºãªæ±ºå®š</li>
                        <li>fé›»å­ç³»: å±€åœ¨é›»å­ã®è¨˜è¿°ç²¾åº¦å‘ä¸Š</li>
                        <li>è¨ˆç®—ã‚³ã‚¹ãƒˆ: USPPã¨ã»ã¼åŒç­‰ï¼ˆPAWã®è¿½åŠ ã‚³ã‚¹ãƒˆã¯æ•°%ä»¥å†…ï¼‰</li>
                    </ul>

                    <p><strong>çµè«–</strong>: PAWæ³•ã¯å…¨é›»å­æ³•ã®ç²¾åº¦ã‚’ä¿ã¡ã¤ã¤ã€å¹³é¢æ³¢åŸºåº•ã®è¨ˆç®—åŠ¹ç‡ã‚’å®Ÿç¾ã™ã‚‹ã€Œã„ã„ã¨ã“å–ã‚Šã€ã®æ‰‹æ³•ã§ã™ã€‚VASPã§ã¯PAWãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æ¨å¥¨ã•ã‚Œã¦ãŠã‚Šã€ç‰¹åˆ¥ãªç†ç”±ãŒãªã„é™ã‚ŠPAWã‚’ä½¿ç”¨ã™ã¹ãã§ã™ã€‚</p>
                </details>
            </div>

            <div class="exercise-box">
                <h4>Hard - ç·åˆå•é¡Œ <span class="difficulty hard">Hard</span></h4>

                <p><strong>Q10</strong>: pymatgenã‚’ä½¿ã£ã¦ã€è¤‡æ•°ã®ææ–™ï¼ˆSi, GaAs, NaCl, Feï¼‰ã®æ§‹é€ æœ€é©åŒ–ã‚’è‡ªå‹•åŒ–ã™ã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è¨­è¨ˆã—ã€å®Ÿè£…ã—ãªã•ã„ã€‚å„ææ–™ã«é©ã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆENCUT, kç‚¹, ISMEARï¼‰ã‚’è‡ªå‹•è¨­å®šã™ã‚‹æ©Ÿèƒ½ã‚’å«ã‚ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¦‹ã‚‹</summary>
<pre><code class="language-python">#!/usr/bin/env python3
"""Automated VASP workflow for multiple materials"""

import os
from pymatgen.core import Structure
from pymatgen.io.vasp.inputs import Incar, Kpoints, PotcarSingle
from pymatgen.io.vasp.outputs import Vasprun
from pymatgen.ext.matproj import MPRester
import json

class VASPWorkflow:
    """VASPè¨ˆç®—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®è‡ªå‹•åŒ–ã‚¯ãƒ©ã‚¹"""

    def __init__(self, base_dir='vasp_calculations'):
        self.base_dir = base_dir
        os.makedirs(base_dir, exist_ok=True)

    def get_material_params(self, structure):
        """ææ–™ã«å¿œã˜ãŸæ¨å¥¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è‡ªå‹•è¨­å®š"""

        # é‡‘å±åˆ¤å®šï¼ˆç°¡æ˜“ç‰ˆ: Feç­‰ã®é·ç§»é‡‘å±ã€ã‚¢ãƒ«ã‚«ãƒªé‡‘å±ï¼‰
        metallic_elements = ['Fe', 'Co', 'Ni', 'Cu', 'Ag', 'Au',
                            'Na', 'K', 'Li', 'Al', 'Mg']
        is_metal = any(el.symbol in metallic_elements
                      for el in structure.composition.elements)

        # ENCUTæ¨å¥¨å€¤ï¼ˆå„å…ƒç´ ã®MAXIMALã®æœ€å¤§å€¤ Ã— 1.3ï¼‰
        encut_recommendations = {
            'Si': 245.3 * 1.3,
            'Ga': 134.6 * 1.3,
            'As': 208.7 * 1.3,
            'Na': 102.1 * 1.3,
            'Cl': 241.4 * 1.3,
            'Fe': 267.9 * 1.3,
        }

        max_encut = max(
            encut_recommendations.get(el.symbol, 400)
            for el in structure.composition.elements
        )
        encut = int(max_encut)

        # ISMEARã¨SIGMAï¼ˆé‡‘å±ã‹çµ¶ç¸ä½“ã‹ï¼‰
        if is_metal:
            ismear = 1  # Methfessel-Paxton
            sigma = 0.2
        else:
            ismear = 0  # Gaussian
            sigma = 0.05

        # kç‚¹å¯†åº¦ï¼ˆåŸå­æ•°ã«å¿œã˜ã¦èª¿æ•´ï¼‰
        n_atoms = len(structure)
        if n_atoms < 10:
            kppa = 1000  # é«˜å¯†åº¦
        elif n_atoms < 50:
            kppa = 500
        else:
            kppa = 200  # å¤§è¦æ¨¡ç³»ã¯ä½å¯†åº¦

        return {
            'ENCUT': encut,
            'ISMEAR': ismear,
            'SIGMA': sigma,
            'kppa': kppa,
            'is_metal': is_metal
        }

    def setup_calculation(self, material_name, structure):
        """å˜ä¸€ææ–™ã®è¨ˆç®—ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—"""

        job_dir = os.path.join(self.base_dir, material_name)
        os.makedirs(job_dir, exist_ok=True)

        # ææ–™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å–å¾—
        params = self.get_material_params(structure)

        # POSCAR
        structure.to(filename=f"{job_dir}/POSCAR", fmt="poscar")

        # INCAR
        incar = Incar({
            'SYSTEM': material_name,
            'ISTART': 0,
            'ICHARG': 2,
            'ENCUT': params['ENCUT'],
            'EDIFF': 1e-6,
            'EDIFFG': -0.01,
            'NSW': 100,
            'IBRION': 2,
            'ISIF': 3,
            'ISMEAR': params['ISMEAR'],
            'SIGMA': params['SIGMA'],
            'PREC': 'Accurate',
            'LREAL': False,
            'LORBIT': 11,  # DOSã¨PDOSå‡ºåŠ›
        })

        # ç£æ€§ä½“ã®å ´åˆã¯ã‚¹ãƒ”ãƒ³åˆ†æ¥µã‚’æœ‰åŠ¹åŒ–
        if params['is_metal'] and 'Fe' in [el.symbol for el in structure.composition.elements]:
            incar['ISPIN'] = 2
            incar['MAGMOM'] = [5.0 if el.symbol == 'Fe' else 0.0
                              for el in structure.composition.elements]

        incar.write_file(f"{job_dir}/INCAR")

        # KPOINTS
        kpoints = Kpoints.automatic_density(structure, kppa=params['kppa'])
        kpoints.write_file(f"{job_dir}/KPOINTS")

        # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æƒ…å ±ã‚’ä¿å­˜
        with open(f"{job_dir}/params.json", 'w') as f:
            json.dump(params, f, indent=2)

        print(f"âœ“ Setup complete: {material_name}")
        print(f"  ENCUT: {params['ENCUT']} eV")
        print(f"  k-mesh: {kpoints.kpts[0]}")
        print(f"  ISMEAR: {params['ISMEAR']} ({'metal' if params['is_metal'] else 'insulator'})")

    def run_workflow(self, materials_dict):
        """è¤‡æ•°ææ–™ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œ

        Args:
            materials_dict (dict): {material_name: Structure} ã®è¾æ›¸
        """

        for name, structure in materials_dict.items():
            print(f"\n{'='*50}")
            print(f"Processing: {name}")
            print(f"{'='*50}")

            self.setup_calculation(name, structure)

            # å®Ÿéš›ã®è¨ˆç®—å®Ÿè¡Œã¯ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆçµŒç”±
            # job_dir = os.path.join(self.base_dir, name)
            # os.chdir(job_dir)
            # subprocess.run(['sbatch', 'submit.sh'])
            # os.chdir('../..')

        print(f"\n{'='*50}")
        print(f"All setups complete!")
        print(f"Results will be saved in: {self.base_dir}/")
        print(f"{'='*50}")

    def analyze_results(self):
        """å…¨ææ–™ã®çµæœè§£æ"""

        results = []

        for material_dir in os.listdir(self.base_dir):
            vasprun_path = os.path.join(self.base_dir, material_dir, 'vasprun.xml')

            if os.path.exists(vasprun_path):
                vr = Vasprun(vasprun_path)

                results.append({
                    'Material': material_dir,
                    'Energy (eV/atom)': vr.final_energy / len(vr.final_structure),
                    'Volume (Ã…Â³/atom)': vr.final_structure.volume / len(vr.final_structure),
                    'Lattice a (Ã…)': vr.final_structure.lattice.a,
                    'Converged': vr.converged
                })

        import pandas as pd
        df = pd.DataFrame(results)
        print("\n=== Results Summary ===")
        print(df.to_string(index=False))

        df.to_csv(f"{self.base_dir}/summary.csv", index=False)
        print(f"\nResults saved: {self.base_dir}/summary.csv")

        return df


# ===========================
# ä½¿ç”¨ä¾‹
# ===========================

if __name__ == "__main__":
    # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼åˆæœŸåŒ–
    workflow = VASPWorkflow(base_dir='multi_material_workflow')

    # Materials Projectã‹ã‚‰æ§‹é€ å–å¾—ï¼ˆã¾ãŸã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§å®šç¾©ï¼‰
    # api_key = "YOUR_MP_API_KEY"
    # mpr = MPRester(api_key)

    # ã“ã“ã§ã¯ãƒ­ãƒ¼ã‚«ãƒ«ã§æ§‹é€ ã‚’å®šç¾©
    from pymatgen.core import Lattice

    materials = {
        'Si': Structure(
            Lattice.cubic(5.43),
            ["Si", "Si"],
            [[0, 0, 0], [0.25, 0.25, 0.25]]
        ),
        'GaAs': Structure(
            Lattice.cubic(5.65),
            ["Ga", "As"],
            [[0, 0, 0], [0.25, 0.25, 0.25]]
        ),
        'NaCl': Structure(
            Lattice.cubic(5.64),
            ["Na", "Cl"],
            [[0, 0, 0], [0.5, 0.5, 0.5]]
        ),
        'Fe': Structure(
            Lattice.cubic(2.87),
            ["Fe", "Fe"],
            [[0, 0, 0], [0.5, 0.5, 0.5]]  # BCCæ§‹é€ 
        ),
    }

    # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œ
    workflow.run_workflow(materials)

    # çµæœè§£æï¼ˆå…¨è¨ˆç®—å®Œäº†å¾Œï¼‰
    # workflow.analyze_results()
</code></pre>
                    <p><strong>ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ç‰¹å¾´</strong>:</p>
                    <ul>
                        <li>ææ–™ã®åŒ–å­¦çµ„æˆã‹ã‚‰è‡ªå‹•çš„ã«é‡‘å±/çµ¶ç¸ä½“ã‚’åˆ¤å®š</li>
                        <li>å„å…ƒç´ ã®æ¨å¥¨ENCUTã‚’è€ƒæ…®ã—ã¦æœ€é©å€¤ã‚’è¨­å®š</li>
                        <li>åŸå­æ•°ã«å¿œã˜ã¦kç‚¹å¯†åº¦ã‚’èª¿æ•´ï¼ˆå¤§è¦æ¨¡ç³»ã¯è‡ªå‹•çš„ã«ç²—ãï¼‰</li>
                        <li>ç£æ€§ä½“ï¼ˆFeç­‰ï¼‰ã¯è‡ªå‹•çš„ã«ã‚¹ãƒ”ãƒ³åˆ†æ¥µè¨ˆç®—ã‚’æœ‰åŠ¹åŒ–</li>
                        <li>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’JSONå½¢å¼ã§ä¿å­˜ã—ã€å†ç¾æ€§ã‚’ç¢ºä¿</li>
                        <li>çµæœè§£ææ©Ÿèƒ½ã§å…¨ææ–™ã®æ¯”è¼ƒã‚’è‡ªå‹•åŒ–</li>
                    </ul>
                    <p><strong>æ‹¡å¼µå¯èƒ½æ€§</strong>: ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¯ã€Materials Project APIã¨ã®é€£æºã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆCustodianï¼‰ã€ã‚¸ãƒ§ãƒ–æŠ•å…¥ã®è‡ªå‹•åŒ–ï¼ˆFireWorksï¼‰ãªã©ã€ã•ã‚‰ãªã‚‹æ‹¡å¼µãŒå¯èƒ½ã§ã™ï¼ˆç¬¬7ç« ã§è©³è¿°ï¼‰ã€‚</p>
                </details>
            </div>
        </section>

        <section id="references">
            <h2>1.10 å‚è€ƒæ–‡çŒ®</h2>

            <ol>
                <li>Kresse, G., & Hafner, J. (1993). "Ab initio molecular dynamics for liquid metals." <em>Physical Review B</em>, 47(1), 558-561. https://doi.org/10.1103/PhysRevB.47.558</li>

                <li>Kresse, G., & FurthmÃ¼ller, J. (1996). "Efficient iterative schemes for ab initio total-energy calculations using a plane-wave basis set." <em>Physical Review B</em>, 54(16), 11169-11186. https://doi.org/10.1103/PhysRevB.54.11169</li>

                <li>BlÃ¶chl, P. E. (1994). "Projector augmented-wave method." <em>Physical Review B</em>, 50(24), 17953-17979. https://doi.org/10.1103/PhysRevB.50.17953</li>

                <li>Hohenberg, P., & Kohn, W. (1964). "Inhomogeneous Electron Gas." <em>Physical Review</em>, 136(3B), B864-B871. https://doi.org/10.1103/PhysRev.136.B864</li>

                <li>Kohn, W., & Sham, L. J. (1965). "Self-Consistent Equations Including Exchange and Correlation Effects." <em>Physical Review</em>, 140(4A), A1133-A1138. https://doi.org/10.1103/PhysRev.140.A1133</li>

                <li>Perdew, J. P., Burke, K., & Ernzerhof, M. (1996). "Generalized Gradient Approximation Made Simple." <em>Physical Review Letters</em>, 77(18), 3865-3868. https://doi.org/10.1103/PhysRevLett.77.3865</li>

                <li>Sholl, D., & Steckel, J. A. (2022). <em>Density Functional Theory: A Practical Introduction</em> (2nd ed.). Wiley. (ç‰¹ã«ç¬¬3-5ç« )</li>

                <li>Martin, R. M. (2020). <em>Electronic Structure: Basic Theory and Practical Methods</em> (2nd ed.). Cambridge University Press. (åŒ…æ‹¬çš„ãªDFTç†è«–)</li>

                <li>Ong, S. P., et al. (2013). "Python Materials Genomics (pymatgen): A robust, open-source python library for materials analysis." <em>Computational Materials Science</em>, 68, 314-319. https://doi.org/10.1016/j.commatsci.2012.10.028</li>

                <li>Jain, A., et al. (2013). "Commentary: The Materials Project: A materials genome approach to accelerating materials innovation." <em>APL Materials</em>, 1(1), 011002. https://doi.org/10.1063/1.4812323</li>

                <li>VASPå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: <a href="https://www.vasp.at/wiki/index.php/The_VASP_Manual" target="_blank">https://www.vasp.at/wiki/</a> (æœ€æ–°ã®ä½¿ç”¨æ–¹æ³•ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¬æ˜)</li>

                <li>å¸¸è¡ŒçœŸå¸ (2018). ã€è¨ˆç®—æ©Ÿãƒãƒ†ãƒªã‚¢ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³å…¥é–€ã€. æ£®åŒ—å‡ºç‰ˆ. (æ—¥æœ¬èªã®æ¨™æº–çš„æ•™ç§‘æ›¸)</li>
            </ol>
        </section>

        <section style="text-align: center; margin-top: 3rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; max-width: 600px; margin: 0 auto;">
                <a href="index.html" style="color: var(--accent-green); text-decoration: none; font-weight: 600;">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
                <a href="chapter-2.html" style="padding: 1rem 2rem; background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%); color: white; border-radius: 8px; text-decoration: none; font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">ç¬¬2ç« ã¸é€²ã‚€ â†’</a>
            </div>
        </section>
    </main>

    <footer>
        <p><strong>è‘—è€…</strong>: CT Knowledge Hub Content Team</p>
        <p><strong>æœ€çµ‚æ›´æ–°</strong>: 2025-10-31</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a></p>
        <p>&copy; 2025 CT Terakoya. All rights reserved.</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>
</body>
</html>
