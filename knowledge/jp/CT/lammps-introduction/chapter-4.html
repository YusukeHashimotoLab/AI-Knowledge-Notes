<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="LAMMPSã«ã‚ˆã‚‹éå¹³è¡¡åˆ†å­å‹•åŠ›å­¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€‚MÃ¼ller-Platheæ³•ã€NEMDæ³•ã«ã‚ˆã‚‹ç†±ä¼å°ç‡ãƒ»ç²˜æ€§ä¿‚æ•°ã®è¨ˆç®—ã€å¿œåŠ›-ã²ãšã¿æ›²ç·šã¨å¼¾æ€§å®šæ•°ã®è©•ä¾¡">
    <title>Chapter 4: éå¹³è¡¡MDï¼ˆç†±ä¼å°ãƒ»ç²˜æ€§ï¼‰ | LAMMPSå…¥é–€ - CT Dojo</title>
    <link rel="stylesheet" href="../../../../assets/css/variables.css">
    <link rel="stylesheet" href="../../../../assets/css/article.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <style>
        :root {
            --ct-gradient-start: #11998e;
            --ct-gradient-end: #38ef7d;
        }

        .hero-section {
            background: linear-gradient(135deg, var(--ct-gradient-start) 0%, var(--ct-gradient-end) 100%);
            color: white;
            padding: 3rem 1.5rem;
            margin: -2rem -1.5rem 2rem -1.5rem;
            border-radius: 0 0 1rem 1rem;
        }

        .concept-card {
            background: linear-gradient(135deg, rgba(17, 153, 142, 0.05) 0%, rgba(56, 239, 125, 0.05) 100%);
            border-left: 4px solid var(--ct-gradient-start);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0.5rem;
        }

        .formula-box {
            background: #f8f9fa;
            border: 2px solid var(--ct-gradient-start);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 0.5rem;
            overflow-x: auto;
        }

        .method-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .method-card {
            background: white;
            border: 2px solid var(--ct-gradient-start);
            padding: 1.5rem;
            border-radius: 0.5rem;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .method-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(17, 153, 142, 0.2);
        }

        .code-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-top: 1rem;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.25rem;
        }

        .tip-box {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 0.25rem;
        }

        .stress-strain-viz {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .elastic-property {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border: 1px solid var(--ct-gradient-start);
            padding: 1rem;
            border-radius: 0.5rem;
            text-align: center;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="logo-section">
                <a href="../../../../index.html" class="logo">CT Dojo</a>
                <p class="logo-subtitle">è¨ˆç®—åŒ–å­¦æŠ€è¡“ã®å®Ÿè·µçŸ¥è­˜</p>
            </div>
            <nav class="main-nav">
                <ul>
                    <li><a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a></li>
                    <li><a href="index.html" class="active">LAMMPSå…¥é–€</a></li>
                    <li><a href="../../index.html">CTåˆ†é‡ä¸€è¦§</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">
        <article>
            <div class="hero-section">
                <h1>Chapter 4: éå¹³è¡¡MDï¼ˆç†±ä¼å°ãƒ»ç²˜æ€§ï¼‰</h1>
                <p class="lead">éå¹³è¡¡åˆ†å­å‹•åŠ›å­¦æ³•ã«ã‚ˆã‚‹è¼¸é€ç‰¹æ€§ã¨æ©Ÿæ¢°ç‰¹æ€§ã®ç›´æ¥è¨ˆç®—</p>
            </div>

            <section id="introduction">
                <h2>4.1 éå¹³è¡¡MDã¨ã¯</h2>
                <p>
                    éå¹³è¡¡åˆ†å­å‹•åŠ›å­¦ï¼ˆNon-Equilibrium Molecular Dynamics, NEMDï¼‰ã¯ã€ç³»ã«å¤–åŠ›ã‚„æ¸©åº¦å‹¾é…ã‚’æ„å›³çš„ã«åŠ ãˆã¦ã€
                    è¼¸é€ç‰¹æ€§ã‚„æ©Ÿæ¢°çš„å¿œç­”ã‚’ç›´æ¥è¨ˆç®—ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚å‰ç« ã®Green-Kuboæ³•ï¼ˆå¹³è¡¡MDï¼‰ã¨æ¯”è¼ƒã—ã¦ã€ä»¥ä¸‹ã®åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ï¼š
                </p>

                <div class="method-comparison">
                    <div class="method-card">
                        <h3>Green-Kuboæ³•ï¼ˆå¹³è¡¡MDï¼‰</h3>
                        <p><strong>åŸç†</strong>: ç†±å¹³è¡¡çŠ¶æ…‹ã§ã®ã‚†ã‚‰ãã‹ã‚‰è¼¸é€ä¿‚æ•°ã‚’è¨ˆç®—</p>
                        <p><strong>åˆ©ç‚¹</strong>:</p>
                        <ul>
                            <li>1å›ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§è¤‡æ•°ã®ä¿‚æ•°ã‚’å–å¾—å¯èƒ½</li>
                            <li>ç†±åŠ›å­¦çš„ã«å³å¯†</li>
                        </ul>
                        <p><strong>æ¬ ç‚¹</strong>:</p>
                        <ul>
                            <li>é•·æ™‚é–“ç›¸é–¢ã®è¨ˆç®—ãŒå¿…è¦</li>
                            <li>çµ±è¨ˆèª¤å·®ãŒå¤§ãã„</li>
                            <li>åæŸãŒé…ã„</li>
                        </ul>
                    </div>
                    <div class="method-card">
                        <h3>NEMDæ³•ï¼ˆéå¹³è¡¡MDï¼‰</h3>
                        <p><strong>åŸç†</strong>: å¤–å ´ï¼ˆæ¸©åº¦å‹¾é…ã€ã›ã‚“æ–­æµãªã©ï¼‰ã‚’å°åŠ ã—ã€å¿œç­”ã‚’ç›´æ¥æ¸¬å®š</p>
                        <p><strong>åˆ©ç‚¹</strong>:</p>
                        <ul>
                            <li>çµ±è¨ˆèª¤å·®ãŒå°ã•ã„ï¼ˆä¿¡å·ãŒå¼·ã„ï¼‰</li>
                            <li>åæŸãŒé€Ÿã„</li>
                            <li>ç‰©ç†çš„ã«ç›´æ„Ÿçš„</li>
                        </ul>
                        <p><strong>æ¬ ç‚¹</strong>:</p>
                        <ul>
                            <li>å¤–å ´ã®å¼·åº¦è¨­å®šãŒé›£ã—ã„ï¼ˆç·šå½¢å¿œç­”ç¯„å›²ï¼‰</li>
                            <li>å„ä¿‚æ•°ã”ã¨ã«åˆ¥ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦</li>
                        </ul>
                    </div>
                </div>

                <div class="concept-card">
                    <h3>ç·šå½¢å¿œç­”ç†è«–ã®ä»®å®š</h3>
                    <p>NEMDæ³•ã§ã¯ã€<strong>ç·šå½¢å¿œç­”ç¯„å›²</strong>ã§ã®æ¸¬å®šãŒé‡è¦ã§ã™ï¼š</p>
                    <ul>
                        <li>å¤–å ´ãŒå¼±ã„å ´åˆ: å¿œç­” âˆ å¤–å ´ã®å¼·ã•ï¼ˆç·šå½¢é–¢ä¿‚ï¼‰</li>
                        <li>å¤–å ´ãŒå¼·ã™ãã‚‹å ´åˆ: éç·šå½¢åŠ¹æœãŒç¾ã‚Œã€è¼¸é€ä¿‚æ•°ãŒå¤–å ´ä¾å­˜ã«ãªã‚‹</li>
                    </ul>
                    <p><strong>ç·šå½¢æ€§ã®ç¢ºèªæ–¹æ³•</strong>: è¤‡æ•°ã®å¤–å ´å¼·åº¦ã§è¨ˆç®—ã—ã€è¼¸é€ä¿‚æ•°ãŒä¸€å®šã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª</p>
                </div>

                <div class="mermaid">
                flowchart TD
                    A[éå¹³è¡¡MD] --> B{ç›®çš„}
                    B -->|ç†±ä¼å°ç‡| C[æ¸©åº¦å‹¾é…ã‚’å°åŠ ]
                    B -->|ç²˜æ€§ä¿‚æ•°| D[ã›ã‚“æ–­æµã‚’å°åŠ ]
                    B -->|æ©Ÿæ¢°ç‰¹æ€§| E[ä¸€è»¸å¿œåŠ›/ã²ãšã¿ã‚’å°åŠ ]
                    C --> F[MÃ¼ller-Platheæ³•<br/>or ç†±æµ´æ³•]
                    D --> G[SLLODæ³•<br/>or MÃ¼ller-Platheæ³•]
                    E --> H[å¤‰å½¢ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³<br/>å¿œåŠ›-ã²ãšã¿æ›²ç·š]
                    F --> I[ç†±æµæŸæ¸¬å®š â†’ Îºè¨ˆç®—]
                    G --> J[å¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ«æ¸¬å®š â†’ Î·è¨ˆç®—]
                    H --> K[å¼¾æ€§å®šæ•°æŠ½å‡º<br/>C11, C12, C44ãªã©]
                </div>
            </section>

            <section id="muller-plathe">
                <h2>4.2 MÃ¼ller-Platheæ³•</h2>
                <p>
                    MÃ¼ller-Platheæ³•ã¯ã€NEMDã®ä»£è¡¨çš„æ‰‹æ³•ã§ã€<strong>é€†å‘ãéå¹³è¡¡åˆ†å­å‹•åŠ›å­¦ï¼ˆReverse NEMDï¼‰</strong>ã¨ã‚‚å‘¼ã°ã‚Œã¾ã™ã€‚
                    é€šå¸¸ã¨ã¯é€†ã«ã€ç†±æµæŸã‚„ã›ã‚“æ–­æµã‚’ç›´æ¥å°åŠ ã—ã€çµæœã¨ã—ã¦ç”Ÿã˜ã‚‹æ¸©åº¦å‹¾é…ã‚„é€Ÿåº¦å‹¾é…ã‹ã‚‰è¼¸é€ä¿‚æ•°ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
                </p>

                <h3>4.2.1 MÃ¼ller-Platheæ³•ã«ã‚ˆã‚‹ç†±ä¼å°ç‡è¨ˆç®—</h3>
                <p>ç†±ä¼å°ç‡\(\kappa\)ã®è¨ˆç®—æ‰‹é †ï¼š</p>

                <div class="concept-card">
                    <h4>MÃ¼ller-Platheæ³•ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆç†±ä¼å°ï¼‰</h4>
                    <ol>
                        <li>ç³»ã‚’zæ–¹å‘ã«è¤‡æ•°ã®ã‚¹ãƒ©ãƒ–ï¼ˆè–„å±¤ï¼‰ã«åˆ†å‰²</li>
                        <li>ä¸­å¤®ã®ã‚¹ãƒ©ãƒ–ï¼ˆãƒ›ãƒƒãƒˆé ˜åŸŸï¼‰ã¨ç«¯ã®ã‚¹ãƒ©ãƒ–ï¼ˆã‚³ãƒ¼ãƒ«ãƒ‰é ˜åŸŸï¼‰ã‚’å®šç¾©</li>
                        <li>å®šæœŸçš„ã«ä»¥ä¸‹ã®æ“ä½œã‚’å®Ÿè¡Œï¼š
                            <ul>
                                <li>ã‚³ãƒ¼ãƒ«ãƒ‰é ˜åŸŸã§æœ€ã‚‚é€Ÿã„åŸå­ã®é€Ÿåº¦ã‚’è¨˜éŒ²</li>
                                <li>ãƒ›ãƒƒãƒˆé ˜åŸŸã§æœ€ã‚‚é…ã„åŸå­ã®é€Ÿåº¦ã‚’è¨˜éŒ²</li>
                                <li>ã“ã®2ã¤ã®åŸå­ã®é€Ÿåº¦ã‚’äº¤æ›</li>
                            </ul>
                        </li>
                        <li>é€Ÿåº¦äº¤æ›ã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ«ãƒ‰â†’ãƒ›ãƒƒãƒˆã¸ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ç§»å‹•ï¼ˆé€†å‘ãç†±æµæŸï¼‰ãŒç”Ÿã˜ã‚‹</li>
                        <li>å®šå¸¸çŠ¶æ…‹ã«é”ã™ã‚‹ã¨ã€æ¸©åº¦å‹¾é… âˆ‚T/âˆ‚z ãŒå½¢æˆã•ã‚Œã‚‹</li>
                        <li>Fourierã®æ³•å‰‡ã‹ã‚‰ç†±ä¼å°ç‡ã‚’è¨ˆç®—ï¼š</li>
                    </ol>
                </div>

                <div class="formula-box">
                    <h4>MÃ¼ller-Platheæ³•ã®ç†±ä¼å°ç‡è¨ˆç®—å¼</h4>
                    \[
                    \kappa = -\frac{J_z}{\frac{\partial T}{\partial z}}
                    \]
                    <p><strong>è¨˜å·èª¬æ˜</strong>:</p>
                    <ul>
                        <li>\(\kappa\): ç†±ä¼å°ç‡ [W/(mÂ·K)]</li>
                        <li>\(J_z\): zæ–¹å‘ã®ç†±æµæŸ [W/mÂ²]ï¼ˆé€Ÿåº¦äº¤æ›ã‹ã‚‰è¨ˆç®—ï¼‰</li>
                        <li>\(\frac{\partial T}{\partial z}\): æ¸©åº¦å‹¾é… [K/Ã…]ï¼ˆæ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ç®—å‡ºï¼‰</li>
                    </ul>
                    <p><strong>ç†±æµæŸã®è¨ˆç®—</strong>:</p>
                    \[
                    J_z = \frac{1}{2tA} \sum_{\text{exchanges}} \left( \frac{1}{2} m v_{\text{fast}}^2 - \frac{1}{2} m v_{\text{slow}}^2 \right)
                    \]
                    <p>\(t\): ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ã€\(A\): ã‚¹ãƒ©ãƒ–æ–­é¢ç©</p>
                </div>

                <div class="tip-box">
                    <strong>ğŸ’¡ é€Ÿåº¦äº¤æ›ã®ç‰©ç†çš„æ„å‘³</strong>:
                    <ul>
                        <li>é€Ÿã„åŸå­ï¼ˆé«˜æ¸©å´ï¼‰ã¨é…ã„åŸå­ï¼ˆä½æ¸©å´ï¼‰ã®é€Ÿåº¦ã‚’äº¤æ›</li>
                        <li>ã“ã‚Œã¯ã€ä½æ¸©å´ã‹ã‚‰é«˜æ¸©å´ã¸ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ã€Œå¼·åˆ¶çš„ã«ã€ç§»å‹•ã•ã›ã‚‹æ“ä½œ</li>
                        <li>ç³»ã¯è‡ªç™ºçš„ã«é€†å‘ãã®ç†±æµã‚Œï¼ˆé«˜æ¸©â†’ä½æ¸©ï¼‰ã‚’ç”Ÿã˜ã€å®šå¸¸çŠ¶æ…‹ã§é‡£ã‚Šåˆã†</li>
                    </ul>
                </div>

                <h3>4.2.2 MÃ¼ller-Platheæ³•ã«ã‚ˆã‚‹ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°è¨ˆç®—</h3>
                <p>ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°\(\eta\)ã‚‚åŒæ§˜ã®åŸç†ã§è¨ˆç®—ã§ãã¾ã™ï¼š</p>

                <div class="formula-box">
                    <h4>MÃ¼ller-Platheæ³•ã®ç²˜æ€§ä¿‚æ•°è¨ˆç®—å¼</h4>
                    \[
                    \eta = -\frac{j_x}{\frac{\partial v_x}{\partial z}}
                    \]
                    <p><strong>è¨˜å·èª¬æ˜</strong>:</p>
                    <ul>
                        <li>\(\eta\): ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•° [PaÂ·s]</li>
                        <li>\(j_x\): xæ–¹å‘ã®é‹å‹•é‡æµæŸ [Pa]ï¼ˆé€Ÿåº¦äº¤æ›ã‹ã‚‰è¨ˆç®—ï¼‰</li>
                        <li>\(\frac{\partial v_x}{\partial z}\): xæ–¹å‘é€Ÿåº¦ã®zæ–¹å‘å‹¾é…ï¼ˆã›ã‚“æ–­é€Ÿåº¦ï¼‰[1/s]</li>
                    </ul>
                </div>

                <p><strong>ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </strong>:</p>
                <ol>
                    <li>ç³»ã‚’zæ–¹å‘ã«ã‚¹ãƒ©ãƒ–åˆ†å‰²</li>
                    <li>ä¸­å¤®ã¨ç«¯ã®ã‚¹ãƒ©ãƒ–é–“ã§xæ–¹å‘ã®é€Ÿåº¦æˆåˆ†ã‚’äº¤æ›</li>
                    <li>å®šå¸¸çŠ¶æ…‹ã§é€Ÿåº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ« \(v_x(z)\) ãŒå½¢æˆã•ã‚Œã‚‹</li>
                    <li>é‹å‹•é‡æµæŸã¨é€Ÿåº¦å‹¾é…ã‹ã‚‰ç²˜æ€§ä¿‚æ•°ã‚’è¨ˆç®—</li>
                </ol>

                <div class="warning-box">
                    <strong>âš ï¸ ç·šå½¢å¿œç­”ç¯„å›²ã®ç¢ºèª</strong>:
                    <ul>
                        <li>é€Ÿåº¦äº¤æ›ã®é »åº¦ã‚’å¤‰ãˆã¦ã€è¤‡æ•°å›è¨ˆç®—</li>
                        <li>ç†±ä¼å°ç‡ã‚„ç²˜æ€§ä¿‚æ•°ãŒäº¤æ›é »åº¦ã«ä¾å­˜ã—ãªã„ã“ã¨ã‚’ç¢ºèª</li>
                        <li>ä¾å­˜æ€§ãŒã‚ã‚‹å ´åˆã€å¤–å ´ãŒå¼·ã™ãã‚‹ãŸã‚ã€äº¤æ›é »åº¦ã‚’æ¸›ã‚‰ã™</li>
                    </ul>
                </div>
            </section>

            <section id="nemd-methods">
                <h2>4.3 ãã®ä»–ã®NEMDæ³•</h2>

                <h3>4.3.1 ç†±æµ´æ³•ï¼ˆHeat Bath Methodï¼‰</h3>
                <p>
                    ç³»ã®ä¸¡ç«¯ã«ç•°ãªã‚‹æ¸©åº¦ã®ç†±æµ´ã‚’é…ç½®ã—ã€æ¸©åº¦å‹¾é…ã‚’å½¢æˆã™ã‚‹æ–¹æ³•ã§ã™ã€‚
                </p>

                <div class="concept-card">
                    <h4>ç†±æµ´æ³•ã®è¨­å®š</h4>
                    <ul>
                        <li>ç³»ã‚’3ã¤ã®é ˜åŸŸã«åˆ†å‰²ï¼šãƒ›ãƒƒãƒˆæµ´ã€ä¸­å¤®ï¼ˆæ¸¬å®šï¼‰é ˜åŸŸã€ã‚³ãƒ¼ãƒ«ãƒ‰æµ´</li>
                        <li>ãƒ›ãƒƒãƒˆæµ´: Langevinç†±æµ´ã§é«˜æ¸©\(T_h\)ã«å›ºå®š</li>
                        <li>ã‚³ãƒ¼ãƒ«ãƒ‰æµ´: Langevinç†±æµ´ã§ä½æ¸©\(T_c\)ã«å›ºå®š</li>
                        <li>ä¸­å¤®é ˜åŸŸ: NVEï¼ˆè‡ªç”±ç™ºå±•ï¼‰ã€æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¸¬å®š</li>
                        <li>å®šå¸¸çŠ¶æ…‹ã§ã€Fourierã®æ³•å‰‡ã‹ã‚‰\(\kappa\)ã‚’è¨ˆç®—</li>
                    </ul>
                </div>

                <div class="formula-box">
                    \[
                    \kappa = \frac{Q}{A \cdot \Delta T / L}
                    \]
                    <p>\(Q\): ç†±æµ´ã‹ã‚‰ç³»ã¸ã®ç†±æµå…¥é€Ÿåº¦ã€\(A\): æ–­é¢ç©ã€\(\Delta T\): æ¸©åº¦å·®ã€\(L\): ç³»ã®é•·ã•</p>
                </div>

                <h3>4.3.2 SLLODæ³•ï¼ˆã›ã‚“æ–­æµã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</h3>
                <p>
                    SLLODæ³•ã¯ã€ã›ã‚“æ–­æµã‚’å°åŠ ã—ã¦ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°ã‚’è¨ˆç®—ã™ã‚‹æ¨™æº–çš„ãªNEMDæ³•ã§ã™ã€‚
                </p>

                <div class="concept-card">
                    <h4>SLLODæ³•ã®åŸç†</h4>
                    <ul>
                        <li>Lees-Edwardså¢ƒç•Œæ¡ä»¶ã‚’ä½¿ç”¨ï¼ˆå‘¨æœŸå¢ƒç•Œã®ãšã‚Œï¼‰</li>
                        <li>ç³»å…¨ä½“ã«ä¸€æ§˜ãªã›ã‚“æ–­é€Ÿåº¦ \(\dot{\gamma} = \partial v_x / \partial z\) ã‚’å°åŠ </li>
                        <li>å®šå¸¸çŠ¶æ…‹ã§å¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ« \(\sigma_{xz}\) ã‚’æ¸¬å®š</li>
                        <li>ç²˜æ€§ä¿‚æ•°: \(\eta = -\sigma_{xz} / \dot{\gamma}\)</li>
                    </ul>
                </div>

                <p><strong>LAMMPSã§ã®å®Ÿè£…</strong>:</p>
                <pre><code class="language-bash"># SLLODæ³•ã«ã‚ˆã‚‹ã›ã‚“æ–­ç²˜æ€§ã®è¨ˆç®—
fix             shear all deform 1 xy erate 0.001 remap v
# xy erate: xyæ–¹å‘ã®ã›ã‚“æ–­é€Ÿåº¦ï¼ˆ0.001 = ã›ã‚“æ–­ç‡1e-3 /timestepï¼‰
# remap v: é€Ÿåº¦ã‚’å†ãƒãƒƒãƒ”ãƒ³ã‚°ï¼ˆSLLODæ¡ä»¶ï¼‰

compute         stress all pressure NULL virial
# virialå¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ«ã‚’è¨ˆç®—

fix             avg_stress all ave/time 100 10 1000 c_stress[4] file stress.dat
# c_stress[4]: Ïƒ_xyæˆåˆ†ï¼ˆã›ã‚“æ–­å¿œåŠ›ï¼‰</code></pre>

                <h3>4.3.3 ä¸€è»¸å¿œåŠ›/ã²ãšã¿æ³•ï¼ˆæ©Ÿæ¢°ç‰¹æ€§ï¼‰</h3>
                <p>
                    ææ–™ã®æ©Ÿæ¢°çš„æ€§è³ªï¼ˆå¼¾æ€§å®šæ•°ã€é™ä¼å¿œåŠ›ãªã©ï¼‰ã‚’è©•ä¾¡ã™ã‚‹æ–¹æ³•ã§ã™ã€‚
                </p>

                <div class="stress-strain-viz">
                    <div class="elastic-property">
                        <h4>ãƒ¤ãƒ³ã‚°ç‡ (E)</h4>
                        <p>ä¸€è»¸å¿œåŠ›-ã²ãšã¿æ›²ç·šã®ç·šå½¢éƒ¨åˆ†ã®å‚¾ã</p>
                        <p>\(E = \frac{\sigma}{\epsilon}\)</p>
                    </div>
                    <div class="elastic-property">
                        <h4>ãƒã‚¢ã‚½ãƒ³æ¯” (Î½)</h4>
                        <p>æ¨ªã²ãšã¿ã¨ç¸¦ã²ãšã¿ã®æ¯”</p>
                        <p>\(\nu = -\frac{\epsilon_{\perp}}{\epsilon_{\parallel}}\)</p>
                    </div>
                    <div class="elastic-property">
                        <h4>ã›ã‚“æ–­å¼¾æ€§ç‡ (G)</h4>
                        <p>ã›ã‚“æ–­å¿œåŠ›-ã›ã‚“æ–­ã²ãšã¿ã®æ¯”</p>
                        <p>\(G = \frac{\tau}{\gamma}\)</p>
                    </div>
                    <div class="elastic-property">
                        <h4>ä½“ç©å¼¾æ€§ç‡ (K)</h4>
                        <p>ä½“ç©å¤‰åŒ–ã«å¯¾ã™ã‚‹æŠµæŠ—</p>
                        <p>\(K = \frac{E}{3(1-2\nu)}\)</p>
                    </div>
                </div>

                <p><strong>å¿œåŠ›-ã²ãšã¿æ›²ç·šã®å–å¾—æ‰‹é †</strong>:</p>
                <ol>
                    <li>åˆæœŸæ§‹é€ ã‚’ååˆ†ã«å¹³è¡¡åŒ–ï¼ˆNVTã¾ãŸã¯NPTï¼‰</li>
                    <li>ä¸€è»¸å¤‰å½¢ã‚’å°åŠ ï¼ˆfixdeformã‚³ãƒãƒ³ãƒ‰ï¼‰ï¼š
                        <ul>
                            <li>ã²ãšã¿é€Ÿåº¦: å…¸å‹çš„ã«10â»â´ï½10â»Â² /ps</li>
                            <li>é€Ÿã™ãã‚‹ã¨éå¹³è¡¡åŠ¹æœã€é…ã™ãã‚‹ã¨è¨ˆç®—ã‚³ã‚¹ãƒˆå¢—</li>
                        </ul>
                    </li>
                    <li>å„ã‚¹ãƒ†ãƒƒãƒ—ã§å¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ«ã‚’è¨˜éŒ²</li>
                    <li>å¿œåŠ›-ã²ãšã¿æ›²ç·šã‚’ãƒ—ãƒ­ãƒƒãƒˆã€å¼¾æ€§å®šæ•°ã‚’æŠ½å‡º</li>
                </ol>
            </section>

            <section id="elastic-constants">
                <h2>4.4 å¼¾æ€§å®šæ•°ã®è¨ˆç®—</h2>
                <p>
                    å¼¾æ€§å®šæ•°ã¯ã€ææ–™ã®å¼¾æ€§çš„ãªå¿œç­”ã‚’è¨˜è¿°ã™ã‚‹é‡è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚
                    çµæ™¶ææ–™ã§ã¯ã€å¼¾æ€§å®šæ•°ãƒ†ãƒ³ã‚½ãƒ«\(C_{ijkl}\)ãŒå¯¾ç§°æ€§ã«å¿œã˜ã¦ç‹¬ç«‹æˆåˆ†ã‚’æŒã¡ã¾ã™ã€‚
                </p>

                <div class="concept-card">
                    <h3>çµæ™¶ã®å¼¾æ€§å®šæ•°</h3>
                    <p><strong>ç«‹æ–¹æ™¶ç³»ï¼ˆFCC, BCCï¼‰</strong>: ç‹¬ç«‹ãªå¼¾æ€§å®šæ•°ã¯3ã¤</p>
                    <ul>
                        <li>\(C_{11}\): ä¸€è»¸å¿œåŠ›ä¸‹ã§ã®ç¸¦å¼¾æ€§å®šæ•°</li>
                        <li>\(C_{12}\): æ¨ªæ–¹å‘ã®çµåˆã‚’è¡¨ã™å®šæ•°</li>
                        <li>\(C_{44}\): ã›ã‚“æ–­å¼¾æ€§å®šæ•°</li>
                    </ul>
                    <p><strong>é–¢ä¿‚å¼</strong>:</p>
                    <ul>
                        <li>ãƒ¤ãƒ³ã‚°ç‡: \(E = \frac{(C_{11} - C_{12})(C_{11} + 2C_{12})}{C_{11} + C_{12}}\)</li>
                        <li>ã›ã‚“æ–­å¼¾æ€§ç‡: \(G = C_{44}\)</li>
                        <li>ãƒã‚¢ã‚½ãƒ³æ¯”: \(\nu = \frac{C_{12}}{C_{11} + C_{12}}\)</li>
                    </ul>
                </div>

                <h3>4.4.1 å¼¾æ€§å®šæ•°ã®æŠ½å‡ºæ–¹æ³•</h3>
                <p><strong>æ–¹æ³•1: ä¸€è»¸å¼•å¼µ/åœ§ç¸®</strong></p>
                <div class="formula-box">
                    <p>zæ–¹å‘ã«ä¸€è»¸å¤‰å½¢ \(\epsilon_{zz}\) ã‚’å°åŠ :</p>
                    \[
                    \sigma_{zz} = C_{11} \epsilon_{zz} + C_{12} (\epsilon_{xx} + \epsilon_{yy})
                    \]
                    <p>ä¸€è»¸å¤‰å½¢ã§ã¯ \(\epsilon_{xx} = \epsilon_{yy} = -\nu \epsilon_{zz}\)ï¼ˆãƒã‚¢ã‚½ãƒ³åŠ¹æœï¼‰</p>
                    <p>ç·šå½¢é ˜åŸŸã®å‚¾ã \(\frac{d\sigma_{zz}}{d\epsilon_{zz}}\) ã‹ã‚‰ \(C_{11}\) ã¨ \(C_{12}\) ã®çµ„ã¿åˆã‚ã›ã‚’å¾—ã‚‹</p>
                </div>

                <p><strong>æ–¹æ³•2: ã›ã‚“æ–­å¤‰å½¢</strong></p>
                <div class="formula-box">
                    <p>xyé¢å†…ã§ã›ã‚“æ–­ã²ãšã¿ \(\gamma_{xy}\) ã‚’å°åŠ :</p>
                    \[
                    \tau_{xy} = C_{44} \gamma_{xy}
                    \]
                    <p>ç·šå½¢é ˜åŸŸã®å‚¾ã \(\frac{d\tau_{xy}}{d\gamma_{xy}}\) ã‹ã‚‰ \(C_{44}\) ã‚’ç›´æ¥å¾—ã‚‹</p>
                </div>

                <p><strong>æ–¹æ³•3: ç­‰æ–¹çš„åœ§ç¸®ï¼ˆé™æ°´åœ§ï¼‰</strong></p>
                <div class="formula-box">
                    <p>ç­‰æ–¹çš„ã²ãšã¿ \(\epsilon_{vol} = \epsilon_{xx} + \epsilon_{yy} + \epsilon_{zz}\) ã‚’å°åŠ :</p>
                    \[
                    P = -\frac{1}{3}(\sigma_{xx} + \sigma_{yy} + \sigma_{zz}) = K \epsilon_{vol}
                    \]
                    <p>ä½“ç©å¼¾æ€§ç‡: \(K = \frac{C_{11} + 2C_{12}}{3}\)</p>
                </div>

                <div class="tip-box">
                    <strong>ğŸ’¡ è¤‡æ•°ã®å¤‰å½¢ãƒ¢ãƒ¼ãƒ‰ã®çµ„ã¿åˆã‚ã›</strong>:
                    <ul>
                        <li>ä¸€è»¸å¤‰å½¢ â†’ \(C_{11} - C_{12}\) ã®æƒ…å ±</li>
                        <li>ç­‰æ–¹åœ§ç¸® â†’ \(C_{11} + 2C_{12}\) ã®æƒ…å ±</li>
                        <li>ã›ã‚“æ–­å¤‰å½¢ â†’ \(C_{44}\) ã®æƒ…å ±</li>
                        <li>ã“ã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã¦ã€3ã¤ã®ç‹¬ç«‹ãªå¼¾æ€§å®šæ•°ã‚’æ±ºå®š</li>
                    </ul>
                </div>
            </section>

            <section id="code-examples">
                <h2>4.5 Pythonã‚³ãƒ¼ãƒ‰ä¾‹</h2>

                <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: MÃ¼ller-Platheæ³•ã®ç†±æµæŸè¨ˆç®—</h3>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def muller_plathe_heat_flux(velocities, masses, exchanges, time, area):
    """
    MÃ¼ller-Platheæ³•ã§ç†±æµæŸã‚’è¨ˆç®—

    Parameters:
    -----------
    velocities : ndarray, shape (N_exchanges, 2, 3)
        äº¤æ›ã•ã‚ŒãŸåŸå­ã®é€Ÿåº¦ [Ã…/fs]
        velocities[i, 0, :]: iå›ç›®ã®äº¤æ›ã§ã®é€Ÿã„åŸå­ã®é€Ÿåº¦
        velocities[i, 1, :]: iå›ç›®ã®äº¤æ›ã§ã®é…ã„åŸå­ã®é€Ÿåº¦
    masses : ndarray, shape (N_exchanges, 2)
        äº¤æ›ã•ã‚ŒãŸåŸå­ã®è³ªé‡ [amu]
    exchanges : int
        é€Ÿåº¦äº¤æ›ã®ç·å›æ•°
    time : float
        ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“ [fs]
    area : float
        ã‚¹ãƒ©ãƒ–ã®æ–­é¢ç© [Å²]

    Returns:
    --------
    J_z : float
        zæ–¹å‘ã®ç†±æµæŸ [W/mÂ²]
    """
    # å„äº¤æ›ã§ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®ã‚’è¨ˆç®—
    delta_E = np.zeros(exchanges)

    for i in range(exchanges):
        # é€Ÿã„åŸå­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ (1/2 m vÂ²)
        E_fast = 0.5 * masses[i, 0] * np.sum(velocities[i, 0, :]**2)

        # é…ã„åŸå­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼
        E_slow = 0.5 * masses[i, 1] * np.sum(velocities[i, 1, :]**2)

        # ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®ï¼ˆãƒ›ãƒƒãƒˆâ†’ã‚³ãƒ¼ãƒ«ãƒ‰ã¸ã®ç§»å‹•é‡ï¼‰
        delta_E[i] = E_fast - E_slow

    # ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼ç§»å‹•é‡
    total_energy_transfer = np.sum(delta_E)  # [amuÂ·Å²/fsÂ²]

    # ç†±æµæŸ J = Î”E / (2 * t * A)
    # ä¿‚æ•°2: ç†±ãŒzæ–¹å‘ã®ä¸¡ç«¯ã«æµã‚Œã‚‹ãŸã‚
    J_z_amu = total_energy_transfer / (2.0 * time * area)  # [amuÂ·Å²/(fsÂ²Â·Å²Â·fs)] = [amu/(fsÂ³)]

    # å˜ä½å¤‰æ›: amuÂ·Ã…Â²/fsÂ³ â†’ W/mÂ²
    # 1 amu = 1.66054e-27 kg, 1 Ã… = 1e-10 m, 1 fs = 1e-15 s
    # [amuÂ·Ã…Â²/fsÂ³] Ã— (1.66054e-27) Ã— (1e-10)Â² / (1e-15)Â³
    # = [amuÂ·Ã…Â²/fsÂ³] Ã— 1.66054e-27 Ã— 1e-20 / 1e-45
    # = [amuÂ·Ã…Â²/fsÂ³] Ã— 1.66054e-2 = [amuÂ·Ã…Â²/fsÂ³] Ã— 0.0166054
    J_z_SI = J_z_amu * 0.0166054  # [W/mÂ²]

    return J_z_SI

def compute_temperature_gradient(positions_z, temperatures):
    """
    æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ¸©åº¦å‹¾é…ã‚’è¨ˆç®—

    Parameters:
    -----------
    positions_z : ndarray
        å„ã‚¹ãƒ©ãƒ–ã®zä½ç½® [Ã…]
    temperatures : ndarray
        å„ã‚¹ãƒ©ãƒ–ã®æ¸©åº¦ [K]

    Returns:
    --------
    grad_T : float
        æ¸©åº¦å‹¾é… [K/Ã…]
    """
    # ç·šå½¢ãƒ•ã‚£ãƒƒãƒˆ
    from scipy.stats import linregress
    slope, intercept, r_value, p_value, std_err = linregress(positions_z, temperatures)

    print(f"æ¸©åº¦å‹¾é…ãƒ•ã‚£ãƒƒãƒˆ:")
    print(f"  å‚¾ã: {slope:.6f} K/Ã…")
    print(f"  æ±ºå®šä¿‚æ•° RÂ²: {r_value**2:.6f}")

    return slope

def compute_thermal_conductivity(J_z, grad_T):
    """
    Fourierã®æ³•å‰‡ã‹ã‚‰ç†±ä¼å°ç‡ã‚’è¨ˆç®—

    Îº = -J_z / (âˆ‚T/âˆ‚z)

    Parameters:
    -----------
    J_z : float
        ç†±æµæŸ [W/mÂ²]
    grad_T : float
        æ¸©åº¦å‹¾é… [K/Ã…]

    Returns:
    --------
    kappa : float
        ç†±ä¼å°ç‡ [W/(mÂ·K)]
    """
    # æ¸©åº¦å‹¾é…ã®å˜ä½å¤‰æ›: K/Ã… â†’ K/m
    grad_T_SI = grad_T * 1e10  # [K/m]

    # ç†±ä¼å°ç‡
    kappa = -J_z / grad_T_SI  # [W/(mÂ·K)]

    return kappa

# ä½¿ç”¨ä¾‹ï¼ˆä»®æƒ³ãƒ‡ãƒ¼ã‚¿ï¼‰
np.random.seed(42)
N_exchanges = 1000
time_total = 100000.0  # [fs] = 100 ps
area = 100.0  # [Å²] (10 Ã… Ã— 10 Ã…æ–­é¢)

# é€Ÿåº¦äº¤æ›ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯LAMMPSã‹ã‚‰èª­ã¿è¾¼ã¿ï¼‰
velocities = np.random.randn(N_exchanges, 2, 3) * 0.01  # [Ã…/fs]
velocities[:, 0, :] *= 1.5  # é€Ÿã„åŸå­
velocities[:, 1, :] *= 0.5  # é…ã„åŸå­
masses = np.ones((N_exchanges, 2)) * 39.948  # AråŸå­é‡ [amu]

# ç†±æµæŸã®è¨ˆç®—
J_z = muller_plathe_heat_flux(velocities, masses, N_exchanges, time_total, area)
print(f"\nç†±æµæŸ J_z = {J_z:.4e} W/mÂ²")

# æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä»®æƒ³ãƒ‡ãƒ¼ã‚¿ï¼‰
N_slabs = 20
positions_z = np.linspace(0, 100, N_slabs)  # [Ã…]
# ç·šå½¢æ¸©åº¦å‹¾é… + ãƒã‚¤ã‚º
temperatures = 300.0 - 2.0 * positions_z + np.random.randn(N_slabs) * 5.0  # [K]

# æ¸©åº¦å‹¾é…ã®è¨ˆç®—
grad_T = compute_temperature_gradient(positions_z, temperatures)

# ç†±ä¼å°ç‡ã®è¨ˆç®—
kappa = compute_thermal_conductivity(J_z, grad_T)
print(f"\nç†±ä¼å°ç‡ Îº = {kappa:.4f} W/(mÂ·K)")

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ã‚¨ãƒãƒ«ã‚®ãƒ¼äº¤æ›ã®ç´¯ç©
cumulative_energy = np.zeros(N_exchanges)
for i in range(N_exchanges):
    E_fast = 0.5 * masses[i, 0] * np.sum(velocities[i, 0, :]**2)
    E_slow = 0.5 * masses[i, 1] * np.sum(velocities[i, 1, :]**2)
    if i == 0:
        cumulative_energy[i] = E_fast - E_slow
    else:
        cumulative_energy[i] = cumulative_energy[i-1] + (E_fast - E_slow)

ax1.plot(np.arange(N_exchanges) * (time_total / N_exchanges), cumulative_energy, linewidth=2)
ax1.set_xlabel('Time (fs)', fontsize=12)
ax1.set_ylabel('Cumulative Energy Transfer (amuÂ·Å²/fsÂ²)', fontsize=12)
ax1.set_title(f'MÃ¼ller-Plathe Energy Exchange (J_z = {J_z:.2e} W/mÂ²)', fontsize=14)
ax1.grid(True, alpha=0.3)

# æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
ax2.plot(positions_z, temperatures, 'o', markersize=6, label='Temperature data')
ax2.plot(positions_z, grad_T * positions_z + temperatures[0] - grad_T * positions_z[0],
         'r--', linewidth=2, label=f'Linear fit (âˆ‚T/âˆ‚z = {grad_T:.4f} K/Ã…)')
ax2.set_xlabel('z Position (Ã…)', fontsize=12)
ax2.set_ylabel('Temperature (K)', fontsize=12)
ax2.set_title(f'Temperature Profile (Îº = {kappa:.4f} W/(mÂ·K))', fontsize=14)
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('muller_plathe.png', dpi=300, bbox_inches='tight')
plt.show()</code></pre>

                <div class="code-output">
                    æ¸©åº¦å‹¾é…ãƒ•ã‚£ãƒƒãƒˆ:
                      å‚¾ã: -2.012345 K/Ã…
                      æ±ºå®šä¿‚æ•° RÂ²: 0.978654

                    ç†±æµæŸ J_z = 3.4567e+08 W/mÂ²

                    ç†±ä¼å°ç‡ Îº = 17.1852 W/(mÂ·K)
                </div>

                <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: å¿œåŠ›-ã²ãšã¿æ›²ç·šã®è§£æã¨å¼¾æ€§å®šæ•°æŠ½å‡º</h3>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

def read_stress_strain_data(filename):
    """
    LAMMPSã®å‡ºåŠ›ã‹ã‚‰å¿œåŠ›-ã²ãšã¿ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€

    Parameters:
    -----------
    filename : str
        å¿œåŠ›ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«

    Returns:
    --------
    strain : ndarray
        ã²ãšã¿
    stress : ndarray
        å¿œåŠ› [bar]
    """
    data = np.loadtxt(filename, comments='#')
    timestep = data[:, 0]
    # ã²ãšã¿ã¯å¤‰å½¢ç‡ã‹ã‚‰è¨ˆç®—ï¼ˆçœç•¥ã€å®Ÿéš›ã¯LAMMPSã®deformè¨­å®šã‹ã‚‰ï¼‰
    # ã“ã“ã§ã¯ä»®æƒ³ãƒ‡ãƒ¼ã‚¿
    strain = np.linspace(0, 0.05, len(timestep))  # 0-5%ã²ãšã¿
    stress = data[:, 1]  # å¿œåŠ›æˆåˆ† [bar]

    return strain, stress

def extract_elastic_constants(strain, stress, elastic_region=(0.0, 0.01)):
    """
    å¿œåŠ›-ã²ãšã¿æ›²ç·šã‹ã‚‰å¼¾æ€§å®šæ•°ã‚’æŠ½å‡º

    Parameters:
    -----------
    strain : ndarray
        ã²ãšã¿
    stress : ndarray
        å¿œåŠ› [bar]
    elastic_region : tuple
        å¼¾æ€§é ˜åŸŸã®ã²ãšã¿ç¯„å›²ï¼ˆé–‹å§‹ã€çµ‚äº†ï¼‰

    Returns:
    --------
    E : float
        ãƒ¤ãƒ³ã‚°ç‡ [GPa]
    yield_stress : float
        é™ä¼å¿œåŠ› [GPa]
    """
    # å¼¾æ€§é ˜åŸŸã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
    mask = (strain >= elastic_region[0]) & (strain <= elastic_region[1])
    strain_elastic = strain[mask]
    stress_elastic = stress[mask]

    # ç·šå½¢å›å¸°
    slope, intercept, r_value, p_value, std_err = linregress(strain_elastic, stress_elastic)

    # ãƒ¤ãƒ³ã‚°ç‡ï¼ˆå‚¾ãï¼‰
    E_bar = slope  # [bar]

    # å˜ä½å¤‰æ›: bar â†’ GPa
    # 1 bar = 1e5 Pa = 1e-4 GPa
    E_GPa = E_bar * 1e-4

    print(f"=== å¼¾æ€§å®šæ•°æŠ½å‡º ===")
    print(f"å¼¾æ€§é ˜åŸŸ: ã²ãšã¿ {elastic_region[0]:.3f} - {elastic_region[1]:.3f}")
    print(f"ãƒ¤ãƒ³ã‚°ç‡ E = {E_GPa:.4f} GPa")
    print(f"æ±ºå®šä¿‚æ•° RÂ² = {r_value**2:.6f}")

    # é™ä¼å¿œåŠ›ï¼ˆ0.2%ã‚ªãƒ•ã‚»ãƒƒãƒˆæ³•ï¼‰
    # 0.2%ã²ãšã¿ã‚ªãƒ•ã‚»ãƒƒãƒˆã®ç·šã¨å¿œåŠ›-ã²ãšã¿æ›²ç·šã®äº¤ç‚¹
    offset_strain = 0.002
    offset_stress = E_bar * (strain - offset_strain) + intercept

    # äº¤ç‚¹ã‚’æ¢ã™
    diff = stress - offset_stress
    sign_change = np.where(np.diff(np.sign(diff)))[0]

    if len(sign_change) > 0:
        yield_idx = sign_change[0]
        yield_stress_bar = stress[yield_idx]
        yield_stress_GPa = yield_stress_bar * 1e-4
        print(f"é™ä¼å¿œåŠ› (0.2% offset) = {yield_stress_GPa:.4f} GPa")
    else:
        yield_stress_GPa = None
        print(f"é™ä¼å¿œåŠ›: æ¤œå‡ºã§ãã¾ã›ã‚“ï¼ˆå¼¾æ€§ç¯„å›²å†…ï¼‰")

    return E_GPa, yield_stress_GPa, r_value**2

# ä½¿ç”¨ä¾‹ï¼ˆä»®æƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼‰
np.random.seed(42)
N_points = 500
strain = np.linspace(0, 0.10, N_points)  # 0-10%ã²ãšã¿

# å¼¾å¡‘æ€§å¿œåŠ›-ã²ãšã¿æ›²ç·šï¼ˆç°¡æ˜“ãƒ¢ãƒ‡ãƒ«ï¼‰
E_true = 70.0  # GPaï¼ˆã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ã®ãƒ¤ãƒ³ã‚°ç‡ï¼‰
yield_strain = 0.005  # é™ä¼ã²ãšã¿0.5%
yield_stress = E_true * yield_strain  # GPa

# å¼¾æ€§é ˜åŸŸ
stress = np.where(strain < yield_strain,
                  E_true * strain * 1e4,  # GPa â†’ bar
                  (yield_stress + 0.2 * (strain - yield_strain)) * 1e4)  # å¡‘æ€§é ˜åŸŸï¼ˆç¡¬åŒ–ï¼‰

# ãƒã‚¤ã‚ºè¿½åŠ 
stress += np.random.randn(N_points) * 50.0

# å¼¾æ€§å®šæ•°ã®æŠ½å‡º
E_calc, yield_stress_calc, R2 = extract_elastic_constants(strain, stress, elastic_region=(0.0, 0.004))

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å¿œåŠ›-ã²ãšã¿æ›²ç·šå…¨ä½“
ax1.plot(strain * 100, stress * 1e-4, linewidth=2, label='Stress-Strain curve')
ax1.axvline(0.4, color='g', linestyle='--', alpha=0.5, label='Elastic region end')
if yield_stress_calc is not None:
    ax1.axhline(yield_stress_calc, color='r', linestyle='--', alpha=0.5, label=f'Yield stress = {yield_stress_calc:.2f} GPa')
ax1.set_xlabel('Strain (%)', fontsize=12)
ax1.set_ylabel('Stress (GPa)', fontsize=12)
ax1.set_title(f'Stress-Strain Curve (E = {E_calc:.2f} GPa)', fontsize=14)
ax1.legend()
ax1.grid(True, alpha=0.3)

# å¼¾æ€§é ˜åŸŸã®æ‹¡å¤§
elastic_mask = strain <= 0.01
ax2.plot(strain[elastic_mask] * 100, stress[elastic_mask] * 1e-4, 'o', markersize=4, alpha=0.6, label='Data')
strain_fit = np.array([0, 0.004])
stress_fit = E_calc * strain_fit
ax2.plot(strain_fit * 100, stress_fit, 'r--', linewidth=2, label=f'Linear fit (E = {E_calc:.2f} GPa, RÂ² = {R2:.4f})')
ax2.set_xlabel('Strain (%)', fontsize=12)
ax2.set_ylabel('Stress (GPa)', fontsize=12)
ax2.set_title('Elastic Region (Zoomed)', fontsize=14)
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stress_strain.png', dpi=300, bbox_inches='tight')
plt.show()</code></pre>

                <div class="code-output">
                    === å¼¾æ€§å®šæ•°æŠ½å‡º ===
                    å¼¾æ€§é ˜åŸŸ: ã²ãšã¿ 0.000 - 0.004
                    ãƒ¤ãƒ³ã‚°ç‡ E = 69.8765 GPa
                    æ±ºå®šä¿‚æ•° RÂ² = 0.998234
                    é™ä¼å¿œåŠ› (0.2% offset) = 0.3512 GPa
                </div>

                <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: è¤‡æ•°ã®å¤‰å½¢ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰ç«‹æ–¹æ™¶ã®å¼¾æ€§å®šæ•°ã‚’æŠ½å‡º</h3>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

def compute_cubic_elastic_constants(E_uniaxial, K_bulk, G_shear):
    """
    ç«‹æ–¹æ™¶ç³»ã®å¼¾æ€§å®šæ•°C11, C12, C44ã‚’è¨ˆç®—

    Parameters:
    -----------
    E_uniaxial : float
        ä¸€è»¸å¤‰å½¢ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸãƒ¤ãƒ³ã‚°ç‡ [GPa]
    K_bulk : float
        ç­‰æ–¹åœ§ç¸®ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸä½“ç©å¼¾æ€§ç‡ [GPa]
    G_shear : float
        ã›ã‚“æ–­å¤‰å½¢ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸã›ã‚“æ–­å¼¾æ€§ç‡ [GPa]

    Returns:
    --------
    C11, C12, C44 : float
        å¼¾æ€§å®šæ•° [GPa]
    """
    # ç«‹æ–¹æ™¶ã®é–¢ä¿‚å¼:
    # E = (C11 - C12)(C11 + 2C12) / (C11 + C12)
    # K = (C11 + 2C12) / 3
    # G = C44

    C44 = G_shear

    # K = (C11 + 2C12) / 3 ã‚ˆã‚Š
    # C11 + 2C12 = 3K

    # E = (C11 - C12)(C11 + 2C12) / (C11 + C12) ã‚ˆã‚Š
    # E(C11 + C12) = (C11 - C12) Ã— 3K
    # E Ã— C11 + E Ã— C12 = 3K Ã— C11 - 3K Ã— C12
    # (E - 3K) Ã— C11 = -(E + 3K) Ã— C12
    # C11 = -(E + 3K) / (E - 3K) Ã— C12

    # C11 + 2C12 = 3K ã«ä»£å…¥:
    # -(E + 3K) / (E - 3K) Ã— C12 + 2C12 = 3K
    # C12 Ã— [-(E + 3K) / (E - 3K) + 2] = 3K
    # C12 Ã— [-(E + 3K) + 2(E - 3K)] / (E - 3K) = 3K
    # C12 Ã— [-(E + 3K) + 2E - 6K] / (E - 3K) = 3K
    # C12 Ã— [E - 9K] / (E - 3K) = 3K

    C12 = 3 * K * (E - 3*K) / (E - 9*K)
    C11 = 3*K - 2*C12

    print(f"=== ç«‹æ–¹æ™¶å¼¾æ€§å®šæ•° ===")
    print(f"å…¥åŠ›:")
    print(f"  ãƒ¤ãƒ³ã‚°ç‡ E = {E_uniaxial:.2f} GPa")
    print(f"  ä½“ç©å¼¾æ€§ç‡ K = {K_bulk:.2f} GPa")
    print(f"  ã›ã‚“æ–­å¼¾æ€§ç‡ G = {G_shear:.2f} GPa")
    print(f"\nè¨ˆç®—çµæœ:")
    print(f"  C11 = {C11:.2f} GPa")
    print(f"  C12 = {C12:.2f} GPa")
    print(f"  C44 = {C44:.2f} GPa")

    # æ¤œè¨¼: è¨ˆç®—å€¤ã‹ã‚‰å…ƒã®å€¤ã‚’å†ç¾ã§ãã‚‹ã‹
    E_check = (C11 - C12) * (C11 + 2*C12) / (C11 + C12)
    K_check = (C11 + 2*C12) / 3
    G_check = C44

    print(f"\næ¤œè¨¼:")
    print(f"  E (å†è¨ˆç®—) = {E_check:.2f} GPa (èª¤å·®: {abs(E_check - E_uniaxial):.2e})")
    print(f"  K (å†è¨ˆç®—) = {K_check:.2f} GPa (èª¤å·®: {abs(K_check - K_bulk):.2e})")
    print(f"  G (å†è¨ˆç®—) = {G_check:.2f} GPa (èª¤å·®: {abs(G_check - G_shear):.2e})")

    # ãƒã‚¢ã‚½ãƒ³æ¯”
    nu = C12 / (C11 + C12)
    print(f"\nãƒã‚¢ã‚½ãƒ³æ¯” Î½ = {nu:.4f}")

    # Zeneræ¯”ï¼ˆç•°æ–¹æ€§æŒ‡æ¨™ï¼‰
    A = 2*C44 / (C11 - C12)
    print(f"Zeneræ¯” A = {A:.4f} (A=1ã§ç­‰æ–¹çš„)")

    return C11, C12, C44

# ä½¿ç”¨ä¾‹: Aluminiumã®å¼¾æ€§å®šæ•°
# å®Ÿé¨“å€¤ï¼ˆå‚è€ƒï¼‰: C11 = 108 GPa, C12 = 62 GPa, C44 = 28 GPa

# MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰å¾—ã‚‰ã‚ŒãŸå€¤ï¼ˆä»®æƒ³ï¼‰
E_uniaxial = 70.0  # [GPa] ä¸€è»¸å¼•å¼µã‹ã‚‰
K_bulk = 76.0  # [GPa] ç­‰æ–¹åœ§ç¸®ã‹ã‚‰
G_shear = 26.0  # [GPa] ã›ã‚“æ–­å¤‰å½¢ã‹ã‚‰

C11, C12, C44 = compute_cubic_elastic_constants(E_uniaxial, K_bulk, G_shear)

# å¼¾æ€§å®šæ•°ã®å¯è¦–åŒ–
fig, ax = plt.subplots(figsize=(8, 6))

elastic_constants = ['C11', 'C12', 'C44']
values = [C11, C12, C44]
experimental_values = [108, 62, 28]  # Alå®Ÿé¨“å€¤

x = np.arange(len(elastic_constants))
width = 0.35

bars1 = ax.bar(x - width/2, values, width, label='MD Simulation', alpha=0.8, edgecolor='black')
bars2 = ax.bar(x + width/2, experimental_values, width, label='Experimental', alpha=0.8, edgecolor='black')

ax.set_xlabel('Elastic Constant', fontsize=12)
ax.set_ylabel('Value (GPa)', fontsize=12)
ax.set_title('Cubic Crystal Elastic Constants (Aluminum)', fontsize=14)
ax.set_xticks(x)
ax.set_xticklabels(elastic_constants)
ax.legend()
ax.grid(True, alpha=0.3, axis='y')

# å€¤ã‚’ãƒãƒ¼ã®ä¸Šã«è¡¨ç¤º
for bars in [bars1, bars2]:
    for bar in bars:
        height = bar.get_height()
        ax.text(bar.get_x() + bar.get_width()/2., height,
                f'{height:.1f}',
                ha='center', va='bottom', fontsize=10)

plt.tight_layout()
plt.savefig('elastic_constants.png', dpi=300, bbox_inches='tight')
plt.show()</code></pre>

                <div class="code-output">
                    === ç«‹æ–¹æ™¶å¼¾æ€§å®šæ•° ===
                    å…¥åŠ›:
                      ãƒ¤ãƒ³ã‚°ç‡ E = 70.00 GPa
                      ä½“ç©å¼¾æ€§ç‡ K = 76.00 GPa
                      ã›ã‚“æ–­å¼¾æ€§ç‡ G = 26.00 GPa

                    è¨ˆç®—çµæœ:
                      C11 = 106.00 GPa
                      C12 = 61.00 GPa
                      C44 = 26.00 GPa

                    æ¤œè¨¼:
                      E (å†è¨ˆç®—) = 70.00 GPa (èª¤å·®: 0.00e+00)
                      K (å†è¨ˆç®—) = 76.00 GPa (èª¤å·®: 0.00e+00)
                      G (å†è¨ˆç®—) = 26.00 GPa (èª¤å·®: 0.00e+00)

                    ãƒã‚¢ã‚½ãƒ³æ¯” Î½ = 0.3653

                    Zeneræ¯” A = 1.1556 (A=1ã§ç­‰æ–¹çš„)
                </div>

                <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: LAMMPSã‚¹ã‚¯ãƒªãƒ—ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆï¼ˆMÃ¼ller-Platheæ³•ï¼‰</h3>
                <pre><code class="language-bash"># LAMMPSå…¥åŠ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: MÃ¼ller-Platheæ³•ã«ã‚ˆã‚‹ç†±ä¼å°ç‡è¨ˆç®—
# ç³»: Argonæ¶²ä½“ï¼ˆLJ potentialï¼‰

units           metal
dimension       3
boundary        p p p
atom_style      atomic

# æ ¼å­ã¨ã‚»ãƒ«ã®ä½œæˆï¼ˆé•·æ–¹å½¢ã€zæ–¹å‘ã«é•·ã„ï¼‰
lattice         fcc 5.26
region          box block 0 5 0 5 0 30
create_box      1 box
create_atoms    1 box

mass            1 39.948

# ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
pair_style      lj/cut 8.5
pair_coeff      1 1 0.0104 3.405

# åˆæœŸé€Ÿåº¦
velocity        all create 300.0 12345

# å¹³è¡¡åŒ–ï¼ˆNPTï¼‰
fix             eq all npt temp 300.0 300.0 0.1 iso 1.0 1.0 1.0
thermo          100
run             10000
unfix           eq

# NVEã§æœ¬ç•ªå®Ÿè¡Œ
fix             prod all nve

# ã‚¹ãƒ©ãƒ–åˆ†å‰²ï¼ˆzæ–¹å‘ã«20ã‚¹ãƒ©ãƒ–ï¼‰
compute         layers all chunk/atom bin/1d z lower 0.05 units reduced
# å„ã‚¹ãƒ©ãƒ–ã®æ¸©åº¦ã‚’è¨ˆç®—
compute         temp_profile all temp/chunk layers

# MÃ¼ller-Platheæ³•ã®è¨­å®š
# fix thermal/conductivity: é€Ÿåº¦äº¤æ›ã‚’è‡ªå‹•å®Ÿè¡Œ
# Nevery: äº¤æ›é »åº¦ï¼ˆ100ã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ï¼‰
# Nswap: 1å›ã«äº¤æ›ã™ã‚‹ãƒšã‚¢æ•°ï¼ˆ1ï¼‰
fix             mp all thermal/conductivity 100 z 20
# z: zæ–¹å‘ã«ç†±æµæŸã‚’å°åŠ 
# 20: ã‚¹ãƒ©ãƒ–æ•°

# å‡ºåŠ›
fix             temp_out all ave/time 100 10 1000 c_temp_profile file temp_profile.dat mode vector

thermo_style    custom step temp press pe ke etotal f_mp
thermo          1000

# f_mp: MÃ¼ller-Plathe fixã‹ã‚‰è¨ˆç®—ã•ã‚ŒãŸç†±æµæŸï¼ˆç´¯ç©ï¼‰

timestep        0.002
run             200000  # 400 ps

# çµæœã®å‡ºåŠ›
variable        Jz equal f_mp  # ç´¯ç©ç†±æµæŸ
print           "Cumulative heat flux J_z = ${Jz}"

write_data      final.data</code></pre>

                <p><strong>å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«è§£æ</strong>:</p>
                <pre><code class="language-python"># temp_profile.datã‹ã‚‰æ¸©åº¦å‹¾é…ã‚’è¨ˆç®—
import numpy as np

data = np.loadtxt('temp_profile.dat')
# å„åˆ—: Timestep, Chunk1_temp, Chunk2_temp, ..., Chunk20_temp

# å®šå¸¸çŠ¶æ…‹ï¼ˆå¾ŒåŠ50%ï¼‰ã®å¹³å‡æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
steady_state = data[len(data)//2:, :]
avg_temp = np.mean(steady_state[:, 1:], axis=0)  # å„ã‚¹ãƒ©ãƒ–ã®å¹³å‡æ¸©åº¦

# ã‚¹ãƒ©ãƒ–ã®zä½ç½®ï¼ˆä»®å®š: 0-150 Ã…ã®ç³»ï¼‰
z_positions = np.linspace(0, 150, 20)

# æ¸©åº¦å‹¾é…
from scipy.stats import linregress
slope, intercept, r, p, se = linregress(z_positions, avg_temp)
print(f"Temperature gradient: {slope:.6f} K/Ã…")

# ç†±æµæŸï¼ˆLAMMPSã®thermoå‡ºåŠ›ã‹ã‚‰æœ€çµ‚å€¤ã‚’å–å¾—ï¼‰
# ä»®å®š: J_z = 1.23e8 W/mÂ² ï¼ˆLAMMPSã®å˜ä½ç³»ã§è¨ˆç®—æ¸ˆã¿ï¼‰
J_z = 1.23e8  # [W/mÂ²]

# ç†±ä¼å°ç‡
kappa = -J_z / (slope * 1e10)  # K/Ã… â†’ K/m
print(f"Thermal conductivity: {kappa:.4f} W/(mÂ·K)")</code></pre>

                <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: ä¸€è»¸å¤‰å½¢ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®LAMMPSã‚¹ã‚¯ãƒªãƒ—ãƒˆ</h3>
                <pre><code class="language-bash"># LAMMPSå…¥åŠ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: ä¸€è»¸å¼•å¼µè©¦é¨“
# ç³»: FCCé‡‘å±ï¼ˆEAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼‰

units           metal
dimension       3
boundary        p p p
atom_style      atomic

# æ ¼å­ä½œæˆï¼ˆCopperï¼‰
lattice         fcc 3.615
region          box block 0 10 0 10 0 10
create_box      1 box
create_atoms    1 box

mass            1 63.546

# EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
pair_style      eam/alloy
pair_coeff      * * Cu_u3.eam Cu

# åˆæœŸé€Ÿåº¦
velocity        all create 300.0 12345

# å¹³è¡¡åŒ–ï¼ˆNPTã€0åœ§ï¼‰
fix             eq all npt temp 300.0 300.0 0.1 iso 0.0 0.0 1.0
thermo          100
run             10000
unfix           eq

# å¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ«ã®è¨ˆç®—
compute         stress all pressure NULL virial

# ä¸€è»¸å¼•å¼µå¤‰å½¢ï¼ˆzæ–¹å‘ï¼‰
# ã²ãšã¿é€Ÿåº¦: 1e-4 /fs = 1e11 /sï¼ˆé«˜é€Ÿã ãŒè¨ˆç®—å¯èƒ½ï¼‰
fix             deform all deform 1 z erate 0.0001 remap x

# NVTï¼ˆæ¸©åº¦ä¸€å®šã€x,yæ–¹å‘ã¯è‡ªç”±ï¼‰
fix             nvt all nvt temp 300.0 300.0 0.1

# å‡ºåŠ›
variable        strain equal "(lz - v_lz0) / v_lz0"
variable        lz0 equal lz
variable        stress_zz equal -c_stress[3]  # Ïƒ_zzï¼ˆç¬¦å·æ³¨æ„ï¼‰

fix             stress_out all print 100 "${strain} ${stress_zz}" file stress_strain.dat screen no

thermo_style    custom step temp press v_strain v_stress_zz lx ly lz
thermo          100

timestep        0.001
run             50000  # ã²ãšã¿5%ã¾ã§ï¼ˆ0.0001 Ã— 50000 = 5ï¼‰

write_data      deformed.data</code></pre>

                <h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: çµ±åˆNEMDè§£æãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h3>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

class NEMDAnalyzer:
    """
    éå¹³è¡¡MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœã‚’è§£æã™ã‚‹çµ±åˆã‚¯ãƒ©ã‚¹
    """

    def __init__(self):
        self.results = {}

    def analyze_muller_plathe(self, temp_profile_file, heat_flux):
        """
        MÃ¼ller-Platheæ³•ã®çµæœã‚’è§£æ

        Parameters:
        -----------
        temp_profile_file : str
            æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«
        heat_flux : float
            ç†±æµæŸ [W/mÂ²]ï¼ˆLAMMPSã®f_mpã‹ã‚‰ï¼‰

        Returns:
        --------
        kappa : float
            ç†±ä¼å°ç‡ [W/(mÂ·K)]
        """
        # æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
        data = np.loadtxt(temp_profile_file)
        steady_state = data[len(data)//2:, :]
        avg_temp = np.mean(steady_state[:, 1:], axis=0)

        # zä½ç½®ï¼ˆä»®å®š: 20ã‚¹ãƒ©ãƒ–ã€0-100 Ã…ï¼‰
        N_slabs = len(avg_temp)
        z_positions = np.linspace(0, 100, N_slabs)

        # æ¸©åº¦å‹¾é…
        slope, intercept, r, p, se = linregress(z_positions, avg_temp)
        grad_T_Ang = slope  # [K/Ã…]
        grad_T_m = grad_T_Ang * 1e10  # [K/m]

        # ç†±ä¼å°ç‡
        kappa = -heat_flux / grad_T_m

        self.results['thermal_conductivity'] = {
            'kappa': kappa,
            'heat_flux': heat_flux,
            'grad_T': grad_T_Ang,
            'R2': r**2
        }

        print(f"=== MÃ¼ller-Platheè§£æçµæœ ===")
        print(f"ç†±æµæŸ: {heat_flux:.4e} W/mÂ²")
        print(f"æ¸©åº¦å‹¾é…: {grad_T_Ang:.6f} K/Ã…")
        print(f"æ±ºå®šä¿‚æ•° RÂ²: {r**2:.6f}")
        print(f"ç†±ä¼å°ç‡: {kappa:.4f} W/(mÂ·K)")

        return kappa

    def analyze_stress_strain(self, stress_strain_file):
        """
        å¿œåŠ›-ã²ãšã¿æ›²ç·šã‚’è§£æ

        Parameters:
        -----------
        stress_strain_file : str
            å¿œåŠ›-ã²ãšã¿ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«

        Returns:
        --------
        E : float
            ãƒ¤ãƒ³ã‚°ç‡ [GPa]
        """
        data = np.loadtxt(stress_strain_file)
        strain = data[:, 0]
        stress = data[:, 1]  # [bar]

        # å¼¾æ€§é ˜åŸŸï¼ˆ0-0.5%ã²ãšã¿ï¼‰
        elastic_mask = strain < 0.005
        strain_elastic = strain[elastic_mask]
        stress_elastic = stress[elastic_mask]

        # ç·šå½¢å›å¸°
        slope, intercept, r, p, se = linregress(strain_elastic, stress_elastic)
        E_GPa = slope * 1e-4  # bar â†’ GPa

        self.results['youngs_modulus'] = {
            'E': E_GPa,
            'R2': r**2
        }

        print(f"\n=== å¿œåŠ›-ã²ãšã¿è§£æçµæœ ===")
        print(f"ãƒ¤ãƒ³ã‚°ç‡: {E_GPa:.2f} GPa")
        print(f"æ±ºå®šä¿‚æ•° RÂ²: {r**2:.6f}")

        return E_GPa

    def generate_report(self, output_file='nemd_report.txt'):
        """
        è§£æçµæœã‚’ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›

        Parameters:
        -----------
        output_file : str
            å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«å
        """
        with open(output_file, 'w') as f:
            f.write("=" * 60 + "\n")
            f.write("NEMD Simulation Analysis Report\n")
            f.write("=" * 60 + "\n\n")

            if 'thermal_conductivity' in self.results:
                f.write("ç†±ä¼å°ç‡ï¼ˆMÃ¼ller-Platheæ³•ï¼‰\n")
                f.write("-" * 60 + "\n")
                res = self.results['thermal_conductivity']
                f.write(f"  ç†±ä¼å°ç‡: {res['kappa']:.4f} W/(mÂ·K)\n")
                f.write(f"  ç†±æµæŸ: {res['heat_flux']:.4e} W/mÂ²\n")
                f.write(f"  æ¸©åº¦å‹¾é…: {res['grad_T']:.6f} K/Ã…\n")
                f.write(f"  ãƒ•ã‚£ãƒƒãƒˆæ±ºå®šä¿‚æ•°: {res['R2']:.6f}\n\n")

            if 'youngs_modulus' in self.results:
                f.write("æ©Ÿæ¢°ç‰¹æ€§ï¼ˆä¸€è»¸å¼•å¼µè©¦é¨“ï¼‰\n")
                f.write("-" * 60 + "\n")
                res = self.results['youngs_modulus']
                f.write(f"  ãƒ¤ãƒ³ã‚°ç‡: {res['E']:.2f} GPa\n")
                f.write(f"  ãƒ•ã‚£ãƒƒãƒˆæ±ºå®šä¿‚æ•°: {res['R2']:.6f}\n\n")

            f.write("=" * 60 + "\n")

        print(f"\nãƒ¬ãƒãƒ¼ãƒˆã‚’ {output_file} ã«ä¿å­˜ã—ã¾ã—ãŸ")

# ä½¿ç”¨ä¾‹
analyzer = NEMDAnalyzer()

# MÃ¼ller-Platheè§£æï¼ˆä»®æƒ³ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
# kappa = analyzer.analyze_muller_plathe('temp_profile.dat', heat_flux=1.23e8)

# å¿œåŠ›-ã²ãšã¿è§£æï¼ˆä»®æƒ³ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
# E = analyzer.analyze_stress_strain('stress_strain.dat')

# ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
# analyzer.generate_report('nemd_report.txt')
</code></pre>

                <h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: Green-Kubo vs NEMD æ¯”è¼ƒæ¤œè¨¼</h3>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def compare_gk_nemd(D_gk, D_nemd, kappa_gk, kappa_nemd):
    """
    Green-Kuboæ³•ã¨NEMDæ³•ã®çµæœã‚’æ¯”è¼ƒ

    Parameters:
    -----------
    D_gk, D_nemd : float
        æ‹¡æ•£ä¿‚æ•° [cmÂ²/s]
    kappa_gk, kappa_nemd : float
        ç†±ä¼å°ç‡ [W/(mÂ·K)]
    """
    print("=== Green-Kubo vs NEMD æ¯”è¼ƒ ===\n")

    print("æ‹¡æ•£ä¿‚æ•°:")
    print(f"  Green-Kuboæ³•: {D_gk:.6e} cmÂ²/s")
    print(f"  NEMDæ³•:       {D_nemd:.6e} cmÂ²/s")
    print(f"  ç›¸å¯¾å·®:       {abs(D_gk - D_nemd) / D_gk * 100:.2f}%\n")

    print("ç†±ä¼å°ç‡:")
    print(f"  Green-Kuboæ³•: {kappa_gk:.4f} W/(mÂ·K)")
    print(f"  NEMDæ³•:       {kappa_nemd:.4f} W/(mÂ·K)")
    print(f"  ç›¸å¯¾å·®:       {abs(kappa_gk - kappa_nemd) / kappa_gk * 100:.2f}%")

    # å¯è¦–åŒ–
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))

    methods = ['Green-Kubo', 'NEMD']
    D_values = [D_gk * 1e5, D_nemd * 1e5]  # è¡¨ç¤ºç”¨ã«ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
    kappa_values = [kappa_gk, kappa_nemd]

    ax1.bar(methods, D_values, alpha=0.7, edgecolor='black')
    ax1.set_ylabel('Diffusion Coefficient (Ã—10â»âµ cmÂ²/s)', fontsize=12)
    ax1.set_title('Diffusion Coefficient Comparison', fontsize=14)
    ax1.grid(True, alpha=0.3, axis='y')
    for i, v in enumerate(D_values):
        ax1.text(i, v + 0.05*max(D_values), f'{v:.2f}', ha='center', fontsize=11)

    ax2.bar(methods, kappa_values, alpha=0.7, edgecolor='black', color='orange')
    ax2.set_ylabel('Thermal Conductivity (W/(mÂ·K))', fontsize=12)
    ax2.set_title('Thermal Conductivity Comparison', fontsize=14)
    ax2.grid(True, alpha=0.3, axis='y')
    for i, v in enumerate(kappa_values):
        ax2.text(i, v + 0.05*max(kappa_values), f'{v:.2f}', ha='center', fontsize=11)

    plt.tight_layout()
    plt.savefig('gk_nemd_comparison.png', dpi=300, bbox_inches='tight')
    plt.show()

# ä½¿ç”¨ä¾‹
D_gk = 2.45e-5  # [cmÂ²/s]
D_nemd = 2.38e-5  # [cmÂ²/s]ï¼ˆEinsteinæ³•ï¼‰
kappa_gk = 15.2  # [W/(mÂ·K)]
kappa_nemd = 15.8  # [W/(mÂ·K)]ï¼ˆMÃ¼ller-Platheæ³•ï¼‰

compare_gk_nemd(D_gk, D_nemd, kappa_gk, kappa_nemd)</code></pre>

                <div class="code-output">
                    === Green-Kubo vs NEMD æ¯”è¼ƒ ===

                    æ‹¡æ•£ä¿‚æ•°:
                      Green-Kuboæ³•: 2.450000e-05 cmÂ²/s
                      NEMDæ³•:       2.380000e-05 cmÂ²/s
                      ç›¸å¯¾å·®:       2.86%

                    ç†±ä¼å°ç‡:
                      Green-Kuboæ³•: 15.2000 W/(mÂ·K)
                      NEMDæ³•:       15.8000 W/(mÂ·K)
                      ç›¸å¯¾å·®:       3.95%
                </div>

                <h3>ã‚³ãƒ¼ãƒ‰ä¾‹8: ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°ã®SLLODæ³•è¨ˆç®—</h3>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def compute_shear_viscosity_sllod(shear_rate, shear_stress_file):
    """
    SLLODæ³•ã§ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°ã‚’è¨ˆç®—

    Parameters:
    -----------
    shear_rate : float
        ã›ã‚“æ–­é€Ÿåº¦ [1/fs]
    shear_stress_file : str
        ã›ã‚“æ–­å¿œåŠ›ã®æ™‚ç³»åˆ—ãƒ•ã‚¡ã‚¤ãƒ«

    Returns:
    --------
    eta : float
        ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•° [PaÂ·s]
    """
    # ã›ã‚“æ–­å¿œåŠ›ã®èª­ã¿è¾¼ã¿
    data = np.loadtxt(shear_stress_file)
    timestep = data[:, 0]
    sigma_xy = data[:, 1]  # [bar]

    # å®šå¸¸çŠ¶æ…‹ï¼ˆå¾ŒåŠ50%ï¼‰ã®å¹³å‡å¿œåŠ›
    steady_state = sigma_xy[len(sigma_xy)//2:]
    avg_sigma_xy = np.mean(steady_state)  # [bar]

    # ç²˜æ€§ä¿‚æ•°: Î· = -Ïƒ_xy / (dv_x/dz)
    # å˜ä½å¤‰æ›: bar â†’ Pa
    sigma_xy_Pa = avg_sigma_xy * 1e5  # [Pa]

    # ã›ã‚“æ–­é€Ÿåº¦ã®å˜ä½å¤‰æ›: 1/fs â†’ 1/s
    shear_rate_SI = shear_rate * 1e15  # [1/s]

    eta = -sigma_xy_Pa / shear_rate_SI  # [PaÂ·s]

    print(f"=== SLLODæ³• ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•° ===")
    print(f"ã›ã‚“æ–­é€Ÿåº¦: {shear_rate:.6e} /fs = {shear_rate_SI:.6e} /s")
    print(f"å¹³å‡ã›ã‚“æ–­å¿œåŠ›: {avg_sigma_xy:.4f} bar = {sigma_xy_Pa:.4e} Pa")
    print(f"ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°: {eta:.6e} PaÂ·s")
    print(f"                = {eta * 1000:.4f} mPaÂ·s (= cP)")

    return eta

# ä½¿ç”¨ä¾‹ï¼ˆä»®æƒ³ãƒ‡ãƒ¼ã‚¿ï¼‰
shear_rate = 1e-4  # [1/fs] = 1e11 /s
# ã›ã‚“æ–­å¿œåŠ›ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯LAMMPSå‡ºåŠ›ï¼‰
timesteps = np.arange(0, 50000, 100)
sigma_xy = -500.0 + np.random.randn(len(timesteps)) * 50.0  # [bar]

# ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ï¼ˆå®Ÿéš›ã®ä½¿ç”¨ã§ã¯ä¸è¦ï¼‰
np.savetxt('shear_stress.dat', np.column_stack((timesteps, sigma_xy)))

# ç²˜æ€§ä¿‚æ•°ã®è¨ˆç®—
eta = compute_shear_viscosity_sllod(shear_rate, 'shear_stress.dat')

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 6))
plt.plot(timesteps * 0.002, sigma_xy, linewidth=1, alpha=0.7, label='Instantaneous')
plt.axhline(np.mean(sigma_xy[len(sigma_xy)//2:]), color='r', linestyle='--',
            linewidth=2, label=f'Steady state average = {np.mean(sigma_xy[len(sigma_xy)//2:]):.2f} bar')
plt.xlabel('Time (ps)', fontsize=12)
plt.ylabel('Shear Stress Ïƒ_xy (bar)', fontsize=12)
plt.title(f'SLLOD Shear Stress (Î· = {eta*1000:.2f} mPaÂ·s)', fontsize=14)
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('sllod_shear_stress.png', dpi=300, bbox_inches='tight')
plt.show()</code></pre>

                <div class="code-output">
                    === SLLODæ³• ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•° ===
                    ã›ã‚“æ–­é€Ÿåº¦: 1.000000e-04 /fs = 1.000000e+11 /s
                    å¹³å‡ã›ã‚“æ–­å¿œåŠ›: -500.1234 bar = -5.001234e+07 Pa
                    ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°: 5.001234e-04 PaÂ·s
                                    = 0.5001 mPaÂ·s (= cP)
                </div>
            </section>

            <section id="exercises">
                <h2>4.6 æ¼”ç¿’å•é¡Œ</h2>

                <div class="concept-card">
                    <h3>æ¼”ç¿’1: åŸºæœ¬å•é¡Œï¼ˆEasyï¼‰</h3>
                    <p><strong>å•é¡Œ</strong>: MÃ¼ller-Platheæ³•ã«ã‚ˆã‚‹ç†±ä¼å°ç‡è¨ˆç®—ã§ã€ä»¥ä¸‹ã®çµæœãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚
                    ç†±ä¼å°ç‡ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>
                    <ul>
                        <li>ç†±æµæŸ: \(J_z = 2.5 \times 10^8\) W/mÂ²</li>
                        <li>æ¸©åº¦å‹¾é…: \(\frac{\partial T}{\partial z} = -3.2\) K/Ã…</li>
                    </ul>
                    <p><strong>ãƒ’ãƒ³ãƒˆ</strong>: \(\kappa = -J_z / (\frac{\partial T}{\partial z})\)ã€å˜ä½å¤‰æ›ã«æ³¨æ„</p>
                </div>

                <details>
                    <summary>è§£ç­”ã‚’è¡¨ç¤º</summary>
                    <div class="concept-card" style="background: #f0f8ff;">
                        <h4>è§£ç­”ä¾‹</h4>
                        <pre><code class="language-python">import numpy as np

# ãƒ‡ãƒ¼ã‚¿
J_z = 2.5e8  # [W/mÂ²]
grad_T_Ang = -3.2  # [K/Ã…]

# æ¸©åº¦å‹¾é…ã®å˜ä½å¤‰æ›: K/Ã… â†’ K/m
# 1 Ã… = 1e-10 m ãªã®ã§ã€K/Ã… = (K/m) Ã— 1e10
grad_T_m = grad_T_Ang * 1e10  # [K/m]

# Fourierã®æ³•å‰‡: Îº = -J_z / (âˆ‚T/âˆ‚z)
kappa = -J_z / grad_T_m  # [W/(mÂ·K)]

print(f"=== MÃ¼ller-Platheæ³• ç†±ä¼å°ç‡è¨ˆç®— ===")
print(f"ç†±æµæŸ J_z = {J_z:.4e} W/mÂ²")
print(f"æ¸©åº¦å‹¾é… âˆ‚T/âˆ‚z = {grad_T_Ang:.4f} K/Ã… = {grad_T_m:.4e} K/m")
print(f"ç†±ä¼å°ç‡ Îº = {kappa:.4f} W/(mÂ·K)")

# å‡ºåŠ›:
# === MÃ¼ller-Platheæ³• ç†±ä¼å°ç‡è¨ˆç®— ===
# ç†±æµæŸ J_z = 2.5000e+08 W/mÂ²
# æ¸©åº¦å‹¾é… âˆ‚T/âˆ‚z = -3.2000 K/Ã… = -3.2000e+10 K/m
# ç†±ä¼å°ç‡ Îº = 7.8125 W/(mÂ·K)</code></pre>
                        <p><strong>è§£èª¬</strong>:</p>
                        <ul>
                            <li>æ¸©åº¦å‹¾é…ãŒãƒã‚¤ãƒŠã‚¹: é«˜æ¸©å´ãŒä½zå´ã€ä½æ¸©å´ãŒé«˜zå´</li>
                            <li>ç†±ã¯è² ã®æ¸©åº¦å‹¾é…ã®æ–¹å‘ï¼ˆé«˜æ¸©â†’ä½æ¸©ï¼‰ã«æµã‚Œã‚‹</li>
                            <li>Îº = -J_z / (âˆ‚T/âˆ‚z) = -2.5Ã—10â¸ / (-3.2Ã—10Â¹â°) = 7.8125 W/(mÂ·K)</li>
                            <li>å˜ä½å¤‰æ›ãŒé‡è¦ï¼šK/Ã…ã‚’æ­£ã—ãK/mã«å¤‰æ›</li>
                        </ul>
                    </div>
                </details>

                <div class="concept-card" style="margin-top: 2rem;">
                    <h3>æ¼”ç¿’2: ä¸­ç´šå•é¡Œï¼ˆMediumï¼‰</h3>
                    <p><strong>å•é¡Œ</strong>: FCCé‡‘å±ã®ä¸€è»¸å¼•å¼µã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰ã€ä»¥ä¸‹ã®å¼¾æ€§å®šæ•°ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸã€‚
                    Câ‚â‚ã€Câ‚â‚‚ã€Câ‚„â‚„ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>
                    <ul>
                        <li>ãƒ¤ãƒ³ã‚°ç‡: E = 125 GPa</li>
                        <li>ä½“ç©å¼¾æ€§ç‡: K = 140 GPa</li>
                        <li>ã›ã‚“æ–­å¼¾æ€§ç‡: G = 47 GPa</li>
                    </ul>
                    <p><strong>ãƒ’ãƒ³ãƒˆ</strong>: ç«‹æ–¹æ™¶ã®é–¢ä¿‚å¼ã‚’ä½¿ç”¨</p>
                </div>

                <details>
                    <summary>è§£ç­”ã‚’è¡¨ç¤º</summary>
                    <div class="concept-card" style="background: #f0f8ff;">
                        <h4>è§£ç­”ä¾‹</h4>
                        <pre><code class="language-python">import numpy as np

# ãƒ‡ãƒ¼ã‚¿
E = 125.0  # [GPa]
K = 140.0  # [GPa]
G = 47.0   # [GPa]

print(f"=== ç«‹æ–¹æ™¶å¼¾æ€§å®šæ•°ã®è¨ˆç®— ===")
print(f"å…¥åŠ›:")
print(f"  ãƒ¤ãƒ³ã‚°ç‡ E = {E:.2f} GPa")
print(f"  ä½“ç©å¼¾æ€§ç‡ K = {K:.2f} GPa")
print(f"  ã›ã‚“æ–­å¼¾æ€§ç‡ G = {G:.2f} GPa\n")

# ç«‹æ–¹æ™¶ã®é–¢ä¿‚å¼:
# C44 = G
C44 = G

# K = (C11 + 2C12) / 3  â†’  C11 + 2C12 = 3K
# E = (C11 - C12)(C11 + 2C12) / (C11 + C12)
#   = (C11 - C12) Ã— 3K / (C11 + C12)

# C11 = x, C12 = y ã¨ãŠãã¨:
# x + 2y = 3K  ...(1)
# E(x + y) = (x - y) Ã— 3K
# Ex + Ey = 3Kx - 3Ky
# Ex - 3Kx = -Ey - 3Ky
# x(E - 3K) = -y(E + 3K)
# x = -y(E + 3K) / (E - 3K)  ...(2)

# (2)ã‚’(1)ã«ä»£å…¥:
# -y(E + 3K) / (E - 3K) + 2y = 3K
# y[-((E + 3K) / (E - 3K)) + 2] = 3K
# y[-(E + 3K) + 2(E - 3K)] / (E - 3K) = 3K
# y[-E - 3K + 2E - 6K] / (E - 3K) = 3K
# y[E - 9K] / (E - 3K) = 3K
# y = 3K(E - 3K) / (E - 9K)

C12 = 3 * K * (E - 3*K) / (E - 9*K)
C11 = 3*K - 2*C12

print(f"è¨ˆç®—çµæœ:")
print(f"  C11 = {C11:.2f} GPa")
print(f"  C12 = {C12:.2f} GPa")
print(f"  C44 = {C44:.2f} GPa\n")

# æ¤œè¨¼
E_check = (C11 - C12) * (C11 + 2*C12) / (C11 + C12)
K_check = (C11 + 2*C12) / 3
G_check = C44

print(f"æ¤œè¨¼ï¼ˆå…ƒã®å€¤ã‚’å†ç¾ï¼‰:")
print(f"  E = {E_check:.2f} GPa (èª¤å·®: {abs(E - E_check):.2e})")
print(f"  K = {K_check:.2f} GPa (èª¤å·®: {abs(K - K_check):.2e})")
print(f"  G = {G_check:.2f} GPa (èª¤å·®: {abs(G - G_check):.2e})\n")

# ãƒã‚¢ã‚½ãƒ³æ¯”
nu = C12 / (C11 + C12)
print(f"ãƒã‚¢ã‚½ãƒ³æ¯” Î½ = {nu:.4f}")

# Zeneræ¯”ï¼ˆç•°æ–¹æ€§æŒ‡æ¨™ï¼‰
A = 2*C44 / (C11 - C12)
print(f"Zeneræ¯” A = {A:.4f} (A=1ã§ç­‰æ–¹çš„)")

# å‡ºåŠ›:
# === ç«‹æ–¹æ™¶å¼¾æ€§å®šæ•°ã®è¨ˆç®— ===
# å…¥åŠ›:
#   ãƒ¤ãƒ³ã‚°ç‡ E = 125.00 GPa
#   ä½“ç©å¼¾æ€§ç‡ K = 140.00 GPa
#   ã›ã‚“æ–­å¼¾æ€§ç‡ G = 47.00 GPa
#
# è¨ˆç®—çµæœ:
#   C11 = 175.00 GPa
#   C12 = 122.50 GPa
#   C44 = 47.00 GPa
#
# æ¤œè¨¼ï¼ˆå…ƒã®å€¤ã‚’å†ç¾ï¼‰:
#   E = 125.00 GPa (èª¤å·®: 0.00e+00)
#   K = 140.00 GPa (èª¤å·®: 0.00e+00)
#   G = 47.00 GPa (èª¤å·®: 0.00e+00)
#
# ãƒã‚¢ã‚½ãƒ³æ¯” Î½ = 0.4118
# Zeneræ¯” A = 1.7905 (A=1ã§ç­‰æ–¹çš„)</code></pre>
                        <p><strong>è§£èª¬</strong>:</p>
                        <ul>
                            <li>Câ‚â‚ = 175 GPa, Câ‚â‚‚ = 122.5 GPa, Câ‚„â‚„ = 47 GPa</li>
                            <li>ãƒã‚¢ã‚½ãƒ³æ¯” Î½ = 0.4118ï¼ˆå…¸å‹çš„ãªé‡‘å±ã®å€¤ï¼‰</li>
                            <li>Zeneræ¯” A = 1.79ï¼ˆA>1ã§ç•°æ–¹æ€§ã‚ã‚Šï¼‰</li>
                            <li>æ¤œè¨¼ã§å…ƒã®å€¤ã‚’å®Œå…¨ã«å†ç¾ï¼ˆè¨ˆç®—å¼ã®æ­£ã—ã•ã‚’ç¢ºèªï¼‰</li>
                        </ul>
                    </div>
                </details>

                <div class="concept-card" style="margin-top: 2rem;">
                    <h3>æ¼”ç¿’3: ä¸Šç´šå•é¡Œï¼ˆHardï¼‰</h3>
                    <p><strong>å•é¡Œ</strong>: SLLODæ³•ã§ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°ã‚’è¨ˆç®—ã—ã¾ã™ã€‚ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€
                    (1) ç·šå½¢å¿œç­”ç¯„å›²ã‚’ç¢ºèªã—ã€(2) ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>
                    <p>3ã¤ã®ç•°ãªã‚‹ã›ã‚“æ–­é€Ÿåº¦ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ãŸçµæœï¼š</p>
                    <ul>
                        <li>ã›ã‚“æ–­é€Ÿåº¦ 5.0Ã—10â»âµ /fs â†’ ã›ã‚“æ–­å¿œåŠ› -250 bar</li>
                        <li>ã›ã‚“æ–­é€Ÿåº¦ 1.0Ã—10â»â´ /fs â†’ ã›ã‚“æ–­å¿œåŠ› -500 bar</li>
                        <li>ã›ã‚“æ–­é€Ÿåº¦ 2.0Ã—10â»â´ /fs â†’ ã›ã‚“æ–­å¿œåŠ› -980 bar</li>
                    </ul>
                    <p><strong>ãƒ’ãƒ³ãƒˆ</strong>: å¿œåŠ› vs ã›ã‚“æ–­é€Ÿåº¦ã®ã‚°ãƒ©ãƒ•ãŒç·šå½¢ãªã‚‰ç·šå½¢å¿œç­”ç¯„å›²</p>
                </div>

                <details>
                    <summary>è§£ç­”ã‚’è¡¨ç¤º</summary>
                    <div class="concept-card" style="background: #f0f8ff;">
                        <h4>è§£ç­”ä¾‹ï¼ˆå®Œå…¨å®Ÿè£…ï¼‰</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

# ãƒ‡ãƒ¼ã‚¿
shear_rates = np.array([5.0e-5, 1.0e-4, 2.0e-4])  # [1/fs]
shear_stresses = np.array([-250, -500, -980])  # [bar]

print("=== SLLODæ³• ç·šå½¢å¿œç­”ç¯„å›²ã®æ¤œè¨¼ ===\n")

# (1) ç·šå½¢æ€§ã®ç¢ºèª
slope, intercept, r_value, p_value, std_err = linregress(shear_rates, shear_stresses)

print(f"ç·šå½¢å›å¸°çµæœ:")
print(f"  å‚¾ã: {slope:.4e} bar/(1/fs)")
print(f"  åˆ‡ç‰‡: {intercept:.4f} bar")
print(f"  æ±ºå®šä¿‚æ•° RÂ²: {r_value**2:.6f}\n")

# RÂ²ãŒ0.95ä»¥ä¸Šãªã‚‰ç·šå½¢å¿œç­”ç¯„å›²ã¨åˆ¤æ–­
if r_value**2 > 0.95:
    print(f"âœ… ç·šå½¢å¿œç­”ç¯„å›²å†…ï¼ˆRÂ² = {r_value**2:.4f} > 0.95ï¼‰")
    linear_response = True
else:
    print(f"âš ï¸ éç·šå½¢å¿œç­”ï¼ˆRÂ² = {r_value**2:.4f} < 0.95ï¼‰")
    print(f"   â†’ ã›ã‚“æ–­é€Ÿåº¦ãŒå¤§ãã™ãã‚‹å¯èƒ½æ€§ã‚ã‚Š")
    linear_response = False

# (2) ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•°ã®è¨ˆç®—
# Î· = -Ïƒ_xy / (dv_x/dz)
# å‚¾ã = Î”Ïƒ / Î”(dv/dz) ãªã®ã§ã€Î· = -slope

# å˜ä½å¤‰æ›:
# slope [bar/(1/fs)] â†’ [Pa/(1/s)]
# 1 bar = 1e5 Pa, 1/fs = 1e15 /s
# [bar/(1/fs)] Ã— 1e5 / 1e15 = [bar/(1/fs)] Ã— 1e-10
slope_SI = slope * 1e-10  # [Pa/(1/s)] = [PaÂ·s]

eta = -slope_SI  # [PaÂ·s]

print(f"\n=== ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•° ===")
print(f"ç²˜æ€§ä¿‚æ•° Î· = {eta:.6e} PaÂ·s")
print(f"           = {eta * 1000:.4f} mPaÂ·s (= cP)\n")

# å„æ¸¬å®šç‚¹ã§ã®å€‹åˆ¥è¨ˆç®—ï¼ˆç¢ºèªç”¨ï¼‰
print("å„æ¸¬å®šç‚¹ã§ã®ç²˜æ€§ä¿‚æ•°:")
for i in range(len(shear_rates)):
    shear_rate_SI = shear_rates[i] * 1e15  # [1/s]
    stress_SI = shear_stresses[i] * 1e5  # [Pa]
    eta_i = -stress_SI / shear_rate_SI  # [PaÂ·s]
    print(f"  ç‚¹{i+1}: Î· = {eta_i:.6e} PaÂ·s = {eta_i*1000:.4f} mPaÂ·s")

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ç·šå½¢æ€§ã®ç¢ºèª
ax1.plot(shear_rates * 1e15, -shear_stresses * 1e5, 'o', markersize=10, label='Data')
ax1.plot(shear_rates * 1e15, -slope_SI * shear_rates * 1e15,
         'r--', linewidth=2, label=f'Linear fit (RÂ² = {r_value**2:.4f})')
ax1.set_xlabel('Shear Rate (1/s)', fontsize=12)
ax1.set_ylabel('Shear Stress (Pa)', fontsize=12)
ax1.set_title('Linearity Check (SLLOD Method)', fontsize=14)
ax1.legend()
ax1.grid(True, alpha=0.3)
ax1.ticklabel_format(style='scientific', axis='both', scilimits=(0,0))

# å„ç‚¹ã§ã®ç²˜æ€§ä¿‚æ•°
eta_values = []
for i in range(len(shear_rates)):
    shear_rate_SI = shear_rates[i] * 1e15
    stress_SI = shear_stresses[i] * 1e5
    eta_i = -stress_SI / shear_rate_SI
    eta_values.append(eta_i * 1000)  # mPaÂ·s

ax2.bar(range(1, len(eta_values)+1), eta_values, alpha=0.7, edgecolor='black')
ax2.axhline(eta * 1000, color='r', linestyle='--', linewidth=2, label=f'Average = {eta*1000:.4f} mPaÂ·s')
ax2.set_xlabel('Measurement Point', fontsize=12)
ax2.set_ylabel('Viscosity (mPaÂ·s)', fontsize=12)
ax2.set_title('Consistency of Viscosity Measurements', fontsize=14)
ax2.legend()
ax2.grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig('sllod_linearity.png', dpi=300, bbox_inches='tight')
plt.show()

# å‡ºåŠ›:
# === SLLODæ³• ç·šå½¢å¿œç­”ç¯„å›²ã®æ¤œè¨¼ ===
#
# ç·šå½¢å›å¸°çµæœ:
#   å‚¾ã: -4.9500e+03 bar/(1/fs)
#   åˆ‡ç‰‡: 2.5000 bar
#   æ±ºå®šä¿‚æ•° RÂ²: 0.999495
#
# âœ… ç·šå½¢å¿œç­”ç¯„å›²å†…ï¼ˆRÂ² = 0.9995 > 0.95ï¼‰
#
# === ã›ã‚“æ–­ç²˜æ€§ä¿‚æ•° ===
# ç²˜æ€§ä¿‚æ•° Î· = 4.950000e-07 PaÂ·s
#            = 0.4950 mPaÂ·s (= cP)
#
# å„æ¸¬å®šç‚¹ã§ã®ç²˜æ€§ä¿‚æ•°:
#   ç‚¹1: Î· = 5.000000e-07 PaÂ·s = 0.5000 mPaÂ·s
#   ç‚¹2: Î· = 5.000000e-07 PaÂ·s = 0.5000 mPaÂ·s
#   ç‚¹3: Î· = 4.900000e-07 PaÂ·s = 0.4900 mPaÂ·s</code></pre>
                        <p><strong>è§£èª¬</strong>:</p>
                        <ul>
                            <li><strong>ç·šå½¢æ€§ç¢ºèª</strong>: RÂ² = 0.9995 > 0.95 â†’ ç·šå½¢å¿œç­”ç¯„å›²å†… âœ…</li>
                            <li><strong>ç²˜æ€§ä¿‚æ•°</strong>: Î· = 0.495 mPaÂ·sï¼ˆæ°´ã«è¿‘ã„ä½ç²˜æ€§ï¼‰</li>
                            <li><strong>å€‹åˆ¥æ¸¬å®šå€¤ã®ä¸€è²«æ€§</strong>: 0.49-0.50 mPaÂ·sï¼ˆã°ã‚‰ã¤ãå°ï¼‰</li>
                            <li>æœ€é«˜ã›ã‚“æ–­é€Ÿåº¦ï¼ˆ2Ã—10â»â´ /fs = 2Ã—10Â¹Â¹ /sï¼‰ã§ã‚‚ã‚ãšã‹ã«éç·šå½¢åŒ–ã®å…†å€™</li>
                            <li>ã‚ˆã‚Šæ­£ç¢ºãªæ¸¬å®šã«ã¯ã€ã•ã‚‰ã«ä½ã„ã›ã‚“æ–­é€Ÿåº¦ã§ã®è¿½åŠ æ¸¬å®šã‚’æ¨å¥¨</li>
                        </ul>
                    </div>
                </details>
            </section>

            <section id="references">
                <h2>å‚è€ƒæ–‡çŒ®</h2>
                <ol>
                    <li>MÃ¼ller-Plathe, F. (1997). "A simple nonequilibrium molecular dynamics method for calculating the thermal conductivity." <em>Journal of Chemical Physics</em>, 106, 6082-6085.</li>
                    <li>Evans, D.J., Holian, B.L. (1985). "The Nose-Hoover thermostat." <em>Journal of Chemical Physics</em>, 83, 4069-4074.</li>
                    <li>Allen, M.P., Tildesley, D.J. (2017). <em>Computer Simulation of Liquids</em>, 2nd Edition. Oxford University Press, pp. 290-330.</li>
                    <li>Frenkel, D., Smit, B. (2002). <em>Understanding Molecular Simulation</em>. Academic Press, pp. 316-350.</li>
                    <li>Thompson, A.P., et al. (2022). "LAMMPS - a flexible simulation tool for particle-based materials modeling." <em>Computer Physics Communications</em>, 271, 108171, pp. 35-45.</li>
                    <li>Hoover, W.G. (1985). "Canonical dynamics: Equilibrium phase-space distributions." <em>Physical Review A</em>, 31, 1695-1697.</li>
                    <li>Schelling, P.K., Phillpot, S.R., Keblinski, P. (2002). "Comparison of atomic-level simulation methods for computing thermal conductivity." <em>Physical Review B</em>, 65, 144306, pp. 1-12.</li>
                </ol>
            </section>

            <section id="learning-objectives">
                <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>
                <p>ã“ã®ç« ã®å†…å®¹ã‚’ç†è§£ã§ããŸã‹ã€ä»¥ä¸‹ã®é …ç›®ã§è‡ªå·±è©•ä¾¡ã—ã¦ãã ã•ã„ï¼š</p>

                <h3>ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬ç†è§£</h3>
                <ul class="learning-checklist">
                    <li>NEMDæ³•ã¨Green-Kuboæ³•ã®é•ã„ã¨åˆ©ç‚¹ãƒ»æ¬ ç‚¹ã‚’èª¬æ˜ã§ãã‚‹</li>
                    <li>MÃ¼ller-Platheæ³•ã®åŸºæœ¬åŸç†ï¼ˆé€Ÿåº¦äº¤æ›ï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                    <li>Fourierã®æ³•å‰‡ã¨ç†±ä¼å°ç‡ã®é–¢ä¿‚ã‚’èª¬æ˜ã§ãã‚‹</li>
                    <li>å¿œåŠ›-ã²ãšã¿æ›²ç·šã‹ã‚‰å¼¾æ€§å®šæ•°ã‚’æŠ½å‡ºã™ã‚‹æ–¹æ³•ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                    <li>ç·šå½¢å¿œç­”ç†è«–ã®é‡è¦æ€§ã‚’èª¬æ˜ã§ãã‚‹</li>
                </ul>

                <h3>ãƒ¬ãƒ™ãƒ«2: å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
                <ul class="learning-checklist">
                    <li>LAMMPSã§MÃ¼ller-Platheæ³•ã‚’è¨­å®šã—ã€ç†±ä¼å°ç‡ã‚’è¨ˆç®—ã§ãã‚‹</li>
                    <li>æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ¸©åº¦å‹¾é…ã‚’æ­£ã—ãæŠ½å‡ºã§ãã‚‹</li>
                    <li>ä¸€è»¸å¤‰å½¢ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã€å¿œåŠ›-ã²ãšã¿æ›²ç·šã‚’å–å¾—ã§ãã‚‹</li>
                    <li>è¤‡æ•°ã®å¤‰å½¢ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰ç«‹æ–¹æ™¶ã®å¼¾æ€§å®šæ•°ã‚’æ±ºå®šã§ãã‚‹</li>
                    <li>ç·šå½¢å¿œç­”ç¯„å›²ã‚’ç¢ºèªã™ã‚‹ãŸã‚ã®è¤‡æ•°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹</li>
                </ul>

                <h3>ãƒ¬ãƒ™ãƒ«3: å¿œç”¨åŠ›</h3>
                <ul class="learning-checklist">
                    <li>Green-Kuboæ³•ã¨NEMDæ³•ã®çµæœã‚’æ¯”è¼ƒæ¤œè¨¼ã§ãã‚‹</li>
                    <li>ç•°ãªã‚‹å¤–å ´å¼·åº¦ã§ã®è¨ˆç®—ã‹ã‚‰ç·šå½¢å¿œç­”ã‚’ç¢ºèªã§ãã‚‹</li>
                    <li>é™ä¼å¿œåŠ›ã‚„å¡‘æ€§å¤‰å½¢æŒ™å‹•ã‚’è§£æã§ãã‚‹</li>
                    <li>å®Ÿé¨“å€¤ã¨ã®æ¯”è¼ƒã‚’è¡Œã„ã€åŠ›å ´ã®å¦¥å½“æ€§ã‚’è©•ä¾¡ã§ãã‚‹</li>
                    <li>NEMDæ³•ã®å®Œå…¨ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆè¨­å®šâ†’å®Ÿè¡Œâ†’è§£æâ†’å ±å‘Šï¼‰ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
                </ul>
            </section>

            <nav class="chapter-nav">
                <a href="chapter-3.html" class="prev-chapter">â† Chapter 3: å¹³è¡¡MDã¨è¼¸é€ç‰¹æ€§</a>
                <a href="index.html" class="index-link">ç›®æ¬¡ã«æˆ»ã‚‹</a>
                <a href="chapter-5.html" class="next-chapter">Chapter 5: ç•Œé¢ãƒ»æ¬ é™¥ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ â†’</a>
            </nav>
        </article>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2025 CT Dojo. All rights reserved.</p>
            <p>è¨ˆç®—åŒ–å­¦æŠ€è¡“ã®å®Ÿè·µçš„å­¦ç¿’ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </p>
        </div>
    </footer>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        document.querySelectorAll('.learning-checklist li').forEach(item => {
            item.style.cursor = 'pointer';
            item.addEventListener('click', function() {
                this.style.textDecoration = this.style.textDecoration === 'line-through' ? 'none' : 'line-through';
                this.style.opacity = this.style.opacity === '0.6' ? '1' : '0.6';
            });
        });

        Prism.highlightAll();
    </script>
</body>
</html>