<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é–¢æ•°ã¨åŠ›å ´ - LAMMPSå…¥é–€ - CT Dojo</title>
    <meta name="description" content="LAMMPSã§ä½¿ç”¨ã•ã‚Œã‚‹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é–¢æ•°ã¨åŠ›å ´ã‚’å­¦ã¶ã€‚Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã€EAMï¼ˆåŸ‹è¾¼åŸå­æ³•ï¼‰ã€ReaxFFåå¿œæ€§åŠ›å ´ã€åŠ›å ´ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æœ€é©åŒ–æ–¹æ³•ã‚’ç¿’å¾—ã™ã‚‹ã€‚">

    <!-- Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <!-- MathJax for mathematical expressions -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        :root {
            --accent-green: #11998e;
            --accent-lime: #38ef7d;
            --primary-dark: #2c3e50;
            --secondary-dark: #34495e;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --bg-light: #ecf0f1;
            --white: #ffffff;
            --code-bg: #2d2d2d;
            --border-light: #bdc3c7;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.8;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        header {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%);
            color: white;
            padding: 3rem 1.5rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        nav {
            background: var(--white);
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
        }

        nav a {
            text-decoration: none;
            color: var(--text-dark);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            font-weight: 500;
        }

        nav a:hover {
            background: linear-gradient(135deg, var(--accent-green) 0%, var(--accent-lime) 100%);
            color: white;
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem 4rem;
        }

        section {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h2 {
            font-size: 1.8rem;
            color: var(--primary-dark);
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--accent-green), var(--accent-lime)) 1;
        }

        h3 {
            font-size: 1.4rem;
            color: var(--secondary-dark);
            margin: 2rem 0 1rem;
        }

        h4 {
            font-size: 1.1rem;
            color: var(--secondary-dark);
            margin: 1.5rem 0 0.75rem;
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        ul, ol {
            margin: 1rem 0 1rem 2rem;
        }

        li {
            margin: 0.5rem 0;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        code {
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9rem;
        }

        .eq {
            background: #f8f9fa;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid var(--accent-green);
            overflow-x: auto;
        }

        .note {
            background: #e8f5e9;
            border-left: 4px solid var(--success);
            padding: 1rem;
            margin: 1rem 0;
        }

        .warning {
            background: #fff3e0;
            border-left: 4px solid var(--warning);
            padding: 1rem;
            margin: 1rem 0;
        }

        .exercise {
            background: #f0f4f8;
            border: 2px solid var(--accent-green);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }

        .exercise h4 {
            color: var(--accent-green);
            margin-top: 0;
        }

        .mermaid {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        footer {
            background: var(--primary-dark);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 4rem;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5rem;
            }

            section {
                padding: 1.5rem;
            }

            nav ul {
                flex-direction: column;
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>ç¬¬2ç« : ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é–¢æ•°ã¨åŠ›å ´</h1>
        <p>Potential Functions and Force Fields in LAMMPS</p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">ğŸ  ãƒ›ãƒ¼ãƒ </a></li>
            <li><a href="chapter-1.html">â† ç¬¬1ç« </a></li>
            <li><a href="chapter-3.html">ç¬¬3ç«  â†’</a></li>
            <li><a href="../index.html">ğŸ“š CT Dojo ãƒˆãƒƒãƒ—</a></li>
        </ul>
    </nav>

    <main>
        <section id="intro">
            <h2>ã¯ã˜ã‚ã«</h2>
            <p>
                åˆ†å­å‹•åŠ›å­¦ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã„ã¦ã€åŸå­é–“ç›¸äº’ä½œç”¨ã‚’è¨˜è¿°ã™ã‚‹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é–¢æ•°ï¼ˆåŠ›å ´ï¼‰ã®é¸æŠã¯è¨ˆç®—ç²¾åº¦ã¨åŠ¹ç‡ã‚’æ±ºå®šã™ã‚‹æœ€é‡è¦å› å­ã§ã™ã€‚æœ¬ç« ã§ã¯ã€LAMMPSã§åºƒãä½¿ç”¨ã•ã‚Œã‚‹ä»£è¡¨çš„ãªãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é–¢æ•°ã®åŸç†ã€å®Ÿè£…æ–¹æ³•ã€é©ç”¨ç¯„å›²ã‚’å­¦ã³ã¾ã™ã€‚
            </p>
            <p>
                Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã€åŸ‹è¾¼åŸå­æ³•ï¼ˆEAMï¼‰ã€ReaxFFåå¿œæ€§åŠ›å ´ãªã©ã®ç‰¹å¾´ã‚’ç†è§£ã—ã€ææ–™ç³»ã«é©ã—ãŸãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’é¸æŠãƒ»æœ€é©åŒ–ã™ã‚‹ã‚¹ã‚­ãƒ«ã‚’ç¿’å¾—ã—ã¾ã™ã€‚
            </p>
        </section>

        <section id="lennard-jones">
            <h2>1. Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</h2>
            <h3>1.1 LJãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ç†è«–</h3>
            <p>
                Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆ6-12ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼‰ã¯ã€å¸Œã‚¬ã‚¹ç³»ã‚„å˜ç´”æ¶²ä½“ã«é©ç”¨ã•ã‚Œã‚‹æœ€ã‚‚åŸºæœ¬çš„ãª2ä½“ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã§ã™ã€‚å¼•åŠ›é …ï¼ˆvan der WaalsåŠ›ï¼‰ã¨æ–¥åŠ›é …ï¼ˆPauliæ–¥åŠ›ï¼‰ã®çµ„ã¿åˆã‚ã›ã§åŸå­é–“ç›¸äº’ä½œç”¨ã‚’è¡¨ç¾ã—ã¾ã™ã€‚
            </p>

            <div class="eq">
                $$
                V_{LJ}(r) = 4\epsilon \left[ \left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^{6} \right]
                $$
                <p style="margin-top:0.5rem;">
                    Îµ: ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ·±ã•ã€Ïƒ: å¹³è¡¡è·é›¢ï¼ˆV=0ã¨ãªã‚‹è·é›¢ï¼‰ã€r: åŸå­é–“è·é›¢
                </p>
            </div>

            <p>
                æ–¥åŠ›é …ï¼ˆr<sup>-12</sup>ï¼‰ã¯é›»å­é›²ã®é‡ãªã‚Šã«ã‚ˆã‚‹Pauliæ–¥åŠ›ã€å¼•åŠ›é …ï¼ˆr<sup>-6</sup>ï¼‰ã¯åŒæ¥µå­èª˜èµ·ç›¸äº’ä½œç”¨ã«ã‚ˆã‚‹van der WaalsåŠ›ã‚’è¡¨ç¾ã—ã¾ã™ã€‚æœ€å®‰å®šè·é›¢ã¯ r<sub>min</sub> = 2<sup>1/6</sup>Ïƒ â‰ˆ 1.122Ïƒ ã§ã™ã€‚
            </p>

            <h3>1.2 Pythonã«ã‚ˆã‚‹LJãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«è¨ˆç®—</h3>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def lennard_jones(r, epsilon=1.0, sigma=1.0):
    """
    Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«è¨ˆç®—

    Parameters:
    -----------
    r : array-like
        åŸå­é–“è·é›¢ [Ã…]
    epsilon : float
        ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ·±ã• [eV]
    sigma : float
        å¹³è¡¡è·é›¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ [Ã…]

    Returns:
    --------
    V : array
        ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]
    """
    r = np.asarray(r)
    # ã‚¼ãƒ­é™¤ç®—ã‚’é¿ã‘ã‚‹
    r = np.where(r == 0, 1e-10, r)

    # LJãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«: 4Îµ[(Ïƒ/r)^12 - (Ïƒ/r)^6]
    V = 4 * epsilon * ((sigma / r)**12 - (sigma / r)**6)
    return V

def lj_force(r, epsilon=1.0, sigma=1.0):
    """
    Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‹ã‚‰å°å‡ºã•ã‚Œã‚‹åŠ›
    F(r) = -dV/dr
    """
    r = np.asarray(r)
    r = np.where(r == 0, 1e-10, r)

    # F = 24Îµ/r * [2(Ïƒ/r)^12 - (Ïƒ/r)^6]
    F = 24 * epsilon / r * (2 * (sigma / r)**12 - (sigma / r)**6)
    return F

# Arã®å…¸å‹çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
epsilon_Ar = 0.0104  # eV
sigma_Ar = 3.405     # Ã…

r = np.linspace(3.0, 10.0, 200)
V = lennard_jones(r, epsilon_Ar, sigma_Ar)
F = lj_force(r, epsilon_Ar, sigma_Ar)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(8, 10))

# ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼
ax1.plot(r, V, 'b-', linewidth=2, label='LJ Potential')
ax1.axhline(0, color='k', linestyle='--', alpha=0.3)
ax1.axvline(2**(1/6) * sigma_Ar, color='r', linestyle='--',
            alpha=0.5, label=f'r_min = {2**(1/6) * sigma_Ar:.3f} Ã…')
ax1.set_xlabel('Distance r [Ã…]', fontsize=12)
ax1.set_ylabel('Potential Energy [eV]', fontsize=12)
ax1.set_title('Lennard-Jones Potential for Ar', fontsize=14, fontweight='bold')
ax1.grid(alpha=0.3)
ax1.legend()
ax1.set_ylim(-0.015, 0.01)

# åŠ›
ax2.plot(r, F, 'g-', linewidth=2)
ax2.axhline(0, color='k', linestyle='--', alpha=0.3)
ax2.set_xlabel('Distance r [Ã…]', fontsize=12)
ax2.set_ylabel('Force [eV/Ã…]', fontsize=12)
ax2.set_title('Force from LJ Potential', fontsize=14, fontweight='bold')
ax2.grid(alpha=0.3)

plt.tight_layout()
plt.savefig('lj_potential_force.png', dpi=300, bbox_inches='tight')
plt.show()

print(f"æœ€å®‰å®šè·é›¢ r_min = {2**(1/6) * sigma_Ar:.4f} Ã…")
print(f"ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æœ€å°å€¤ V_min = {-epsilon_Ar:.6f} eV")
</code></pre>

            <h3>1.3 LAMMPSã§ã®LJãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«å®Ÿè£…</h3>
            <pre><code class="language-bash"># LAMMPSå…¥åŠ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: LJãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’ç”¨ã„ãŸArç³»MD

# åˆæœŸåŒ–
units           metal     # å˜ä½ç³»: metal (eV, Ã…, ps)
atom_style      atomic    # åŸå­ã‚¹ã‚¿ã‚¤ãƒ«
boundary        p p p     # å‘¨æœŸå¢ƒç•Œæ¡ä»¶

# æ ¼å­æ§‹ç¯‰
lattice         fcc 5.26  # FCCæ ¼å­ã€æ ¼å­å®šæ•°5.26Ã…ï¼ˆArçµæ™¶ï¼‰
region          box block 0 10 0 10 0 10  # 10Ã—10Ã—10æ ¼å­
create_box      1 box
create_atoms    1 box

# è³ªé‡è¨­å®š
mass            1 39.948  # AråŸå­é‡

# Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«è¨­å®š
pair_style      lj/cut 8.5  # ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„8.5Ã…
pair_coeff      1 1 0.0104 3.405  # Îµ=0.0104eV, Ïƒ=3.405Ã…

# é€Ÿåº¦åˆæœŸåŒ–ï¼ˆ300Kï¼‰
velocity        all create 300.0 87287 dist gaussian

# æ™‚é–“ç©åˆ†ï¼ˆNVEã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ï¼‰
fix             1 all nve

# æ¸©åº¦ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼å‡ºåŠ›
thermo_style    custom step temp press pe ke etotal
thermo          100

# è»Œè·¡å‡ºåŠ›
dump            1 all custom 500 lj_ar.lammpstrj id type x y z vx vy vz
dump_modify     1 sort id

# ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ã¨MDå®Ÿè¡Œ
timestep        0.005  # 5fs
run             10000  # 50ps

# ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼å‡ºåŠ›
compute         pe_atom all pe/atom
dump            2 all custom 1000 pe_profile.dump id type x y z c_pe_atom

write_data      lj_ar_final.data
</code></pre>

            <div class="note">
                <strong>ğŸ’¡ ãƒã‚¤ãƒ³ãƒˆ:</strong> LAMMPSã®<code>pair_style lj/cut</code>ã¯ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„å†…ã§ã®ã¿LJãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’è¨ˆç®—ã—ã¾ã™ã€‚é•·è·é›¢è£œæ­£ï¼ˆlong-range tail correctionï¼‰ãŒå¿…è¦ãªå ´åˆã¯ã€<code>pair_modify tail yes</code>ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
            </div>
        </section>

        <section id="eam">
            <h2>2. åŸ‹è¾¼åŸå­æ³•ï¼ˆEAMï¼‰ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</h2>
            <h3>2.1 EAMç†è«–ã®åŸºç¤</h3>
            <p>
                åŸ‹è¾¼åŸå­æ³•ï¼ˆEmbedded Atom Method, EAMï¼‰ã¯ã€é‡‘å±ç³»ã«ç‰¹åŒ–ã—ãŸå¤šä½“ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã§ã™ã€‚åŸå­ã‚’é›»å­å¯†åº¦å ´ã«ã€ŒåŸ‹ã‚è¾¼ã‚€ã€ã¨ã„ã†æ¦‚å¿µã«åŸºã¥ãã€2ä½“ç›¸äº’ä½œç”¨ã§ã¯è¡¨ç¾ã§ããªã„é‡‘å±çµåˆã®ç‰¹æ€§ï¼ˆæ–¹å‘æ€§ã®æ¬ å¦‚ã€å»¶æ€§ãªã©ï¼‰ã‚’å†ç¾ã—ã¾ã™ã€‚
            </p>

            <div class="eq">
                $$
                E_i = F_\alpha\left(\sum_{j \neq i} \rho_\beta(r_{ij})\right) + \frac{1}{2}\sum_{j \neq i} \phi_{\alpha\beta}(r_{ij})
                $$
                <p style="margin-top:0.5rem;">
                    F<sub>Î±</sub>: åŸ‹è¾¼ã‚¨ãƒãƒ«ã‚®ãƒ¼é–¢æ•°ã€Ï<sub>Î²</sub>: é›»å­å¯†åº¦é–¢æ•°ã€Ï†<sub>Î±Î²</sub>: 2ä½“ç›¸äº’ä½œç”¨
                </p>
            </div>

            <p>
                ç¬¬1é …ã¯åŸå­iãŒå‘¨å›²ã®é›»å­å¯†åº¦å ´ã«åŸ‹ã‚è¾¼ã¾ã‚Œã‚‹ã“ã¨ã«ã‚ˆã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€ç¬¬2é …ã¯åŸå­é–“ã®2ä½“åç™ºã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã™ã€‚EAMã¯ç©ºå­”å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã€ç©å±¤æ¬ é™¥ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€å¼¾æ€§å®šæ•°ã‚’é«˜ç²¾åº¦ã§å†ç¾ã§ãã¾ã™ã€‚
            </p>

            <h3>2.2 LAMMPSã§ã®EAMå®Ÿè£…</h3>
            <pre><code class="language-bash"># LAMMPSå…¥åŠ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’ç”¨ã„ãŸCuç³»MD

units           metal
atom_style      atomic
boundary        p p p

# Cu FCCæ ¼å­ï¼ˆæ ¼å­å®šæ•°3.615Ã…ï¼‰
lattice         fcc 3.615
region          box block 0 10 0 10 0 10
create_box      1 box
create_atoms    1 box

mass            1 63.546  # CuåŸå­é‡

# EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«èª­ã¿è¾¼ã¿
pair_style      eam/alloy
pair_coeff      * * Cu_u3.eam Cu
# Cu_u3.eam: NISTé–‹ç™ºã®é«˜ç²¾åº¦Cuãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
# ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰: https://www.ctcms.nist.gov/potentials/

# åˆé€Ÿåº¦ï¼ˆå®¤æ¸©300Kï¼‰
velocity        all create 300.0 4928459 dist gaussian

# NPTã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ï¼ˆç­‰æ¸©ç­‰åœ§ã€1atmã€300Kï¼‰
fix             1 all npt temp 300.0 300.0 0.1 iso 1.0 1.0 1.0

thermo_style    custom step temp press pe ke etotal lx ly lz
thermo          200

dump            1 all custom 1000 cu_eam.lammpstrj id type x y z

timestep        0.002  # 2fs
run             50000  # 100ps

# æ ¼å­å®šæ•°æ¸¬å®šï¼ˆå¹³è¡¡å¾Œï¼‰
variable        lat_a equal lx/10  # 10æ ¼å­åˆ†
print           "Equilibrated lattice constant: ${lat_a} Ã…"

write_data      cu_eam_final.data
</code></pre>

            <h3>2.3 Pythonã«ã‚ˆã‚‹EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«è§£æ</h3>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import interp1d

def parse_eam_alloy(filename):
    """
    LAMMPS EAM/alloyå½¢å¼ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£æ

    Returns:
    --------
    funcs : dict
        'embedding', 'density', 'pair' é–¢æ•°ã®è£œé–“ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
    """
    with open(filename, 'r') as f:
        lines = f.readlines()

    # ãƒ˜ãƒƒãƒ€ãƒ¼è§£æï¼ˆç°¡æ˜“ç‰ˆï¼‰
    Nrho = 10000  # é›»å­å¯†åº¦ã‚°ãƒªãƒƒãƒ‰ç‚¹æ•°
    Nr = 10000    # è·é›¢ã‚°ãƒªãƒƒãƒ‰ç‚¹æ•°

    # ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºï¼ˆå®Ÿéš›ã«ã¯è©³ç´°ãªè§£æãŒå¿…è¦ï¼‰
    # ã“ã“ã§ã¯æ¦‚å¿µçš„å®Ÿè£…ã‚’ç¤ºã™
    rho_grid = np.linspace(0, 1.0, Nrho)
    r_grid = np.linspace(0.5, 8.0, Nr)

    # åŸ‹è¾¼é–¢æ•°F(Ï)ã®ä¾‹ï¼ˆCuã®è¿‘ä¼¼ï¼‰
    F_rho = -3.0 * np.sqrt(rho_grid)

    # é›»å­å¯†åº¦é–¢æ•°Ï(r)ã®ä¾‹
    density_r = np.exp(-2.0 * r_grid) * (1 + r_grid)

    # 2ä½“ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«Ï†(r)ã®ä¾‹
    phi_r = 100.0 / r_grid**6 - 50.0 / r_grid**3

    funcs = {
        'embedding': interp1d(rho_grid, F_rho, kind='cubic',
                              bounds_error=False, fill_value=0),
        'density': interp1d(r_grid, density_r, kind='cubic',
                            bounds_error=False, fill_value=0),
        'pair': interp1d(r_grid, phi_r, kind='cubic',
                         bounds_error=False, fill_value=0)
    }

    return funcs, rho_grid, r_grid

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(1, 3, figsize=(15, 4))

# ä»®æƒ³EAMé–¢æ•°
rho = np.linspace(0, 1.0, 200)
r = np.linspace(0.5, 8.0, 200)

# åŸ‹è¾¼ã‚¨ãƒãƒ«ã‚®ãƒ¼ F(Ï)
F = -3.0 * np.sqrt(rho)
axes[0].plot(rho, F, 'b-', linewidth=2)
axes[0].set_xlabel('Electron Density Ï', fontsize=11)
axes[0].set_ylabel('Embedding Energy F(Ï) [eV]', fontsize=11)
axes[0].set_title('Embedding Function', fontweight='bold')
axes[0].grid(alpha=0.3)

# é›»å­å¯†åº¦é–¢æ•° Ï(r)
rho_r = np.exp(-2.0 * r) * (1 + r)
axes[1].plot(r, rho_r, 'g-', linewidth=2)
axes[1].set_xlabel('Distance r [Ã…]', fontsize=11)
axes[1].set_ylabel('Density Ï(r)', fontsize=11)
axes[1].set_title('Electron Density Function', fontweight='bold')
axes[1].grid(alpha=0.3)

# 2ä½“ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« Ï†(r)
phi = 100.0 / r**6 - 50.0 / r**3
axes[2].plot(r, phi, 'r-', linewidth=2)
axes[2].set_xlabel('Distance r [Ã…]', fontsize=11)
axes[2].set_ylabel('Pair Potential Ï†(r) [eV]', fontsize=11)
axes[2].set_title('Pair Interaction', fontweight='bold')
axes[2].grid(alpha=0.3)
axes[2].set_ylim(-5, 10)

plt.tight_layout()
plt.savefig('eam_functions.png', dpi=300, bbox_inches='tight')
plt.show()

print("EAMé–¢æ•°ã®ç‰¹å¾´:")
print("- åŸ‹è¾¼é–¢æ•°F(Ï): é›»å­å¯†åº¦ã®å¢—åŠ ã§å®‰å®šåŒ–ï¼ˆé‡‘å±çµåˆï¼‰")
print("- å¯†åº¦é–¢æ•°Ï(r): è·é›¢ã¨ã¨ã‚‚ã«æŒ‡æ•°æ¸›è¡°")
print("- 2ä½“ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«Ï†(r): çŸ­è·é›¢æ–¥åŠ›ã‚’è¨˜è¿°")
</code></pre>
        </section>

        <section id="reaxff">
            <h2>3. ReaxFFåå¿œæ€§åŠ›å ´</h2>
            <h3>3.1 ReaxFFã®åŸç†</h3>
            <p>
                ReaxFFï¼ˆReactive Force Fieldï¼‰ã¯ã€åŒ–å­¦åå¿œã‚’è¨˜è¿°å¯èƒ½ãªåŠ›å ´ã§ã™ã€‚çµåˆæ¬¡æ•°ï¼ˆbond orderï¼‰ã®æ¦‚å¿µã«åŸºã¥ãã€çµåˆã®å½¢æˆãƒ»åˆ‡æ–­ã‚’å‹•çš„ã«æ‰±ãˆã‚‹ãŸã‚ã€ç‡ƒç„¼ã€è§¦åª’åå¿œã€åŒ–å­¦æ°—ç›¸æˆé•·ãªã©ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«é©ç”¨ã•ã‚Œã¾ã™ã€‚
            </p>

            <div class="eq">
                $$
                E_{system} = E_{bond} + E_{over} + E_{under} + E_{val} + E_{tors} + E_{vdWaals} + E_{Coulomb}
                $$
                <p style="margin-top:0.5rem;">
                    çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã€éå‰°é…ä½è£œæ­£ã€ä¸è¶³é…ä½è£œæ­£ã€åŸå­ä¾¡è§’ã€ã­ã˜ã‚Œè§’ã€van der Waalsã€Coulombã®å„é …
                </p>
            </div>

            <h3>3.2 LAMMPSã§ã®ReaxFFå®Ÿè£…</h3>
            <pre><code class="language-bash"># LAMMPSå…¥åŠ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: ReaxFFã«ã‚ˆã‚‹ãƒ¡ã‚¿ãƒ³ç‡ƒç„¼ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

units           real      # kcal/mol, Ã…, fs
atom_style      charge    # é›»è·ã‚’æŒã¤åŸå­
boundary        p p p

# åˆæœŸæ§‹é€ èª­ã¿è¾¼ã¿ï¼ˆãƒ¡ã‚¿ãƒ³+é…¸ç´ æ··åˆç³»ï¼‰
read_data       ch4_o2_mix.data

# ReaxFFåŠ›å ´è¨­å®š
pair_style      reax/c NULL
pair_coeff      * * ffield.reax.cho C H O
# ffield.reax.cho: CHOç³»ç”¨ReaxFFãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«

# é›»è·å¹³è¡¡åŒ–ï¼ˆQEqæ³•ï¼‰
fix             qeq all qeq/reax 1 0.0 10.0 1.0e-6 reax/c

# NVTã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ï¼ˆé«˜æ¸©2000Kã€ç‡ƒç„¼æ¡ä»¶ï¼‰
fix             nvt all nvt temp 2000.0 2000.0 100.0

# çµåˆæƒ…å ±å‡ºåŠ›
fix             bonds all reax/c/bonds 100 bonds.reaxc

thermo_style    custom step temp press etotal
thermo          100

dump            1 all custom 500 combustion.lammpstrj id type q x y z

timestep        0.25  # 0.25fsï¼ˆçŸ­ã„ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—å¿…é ˆï¼‰
run             20000  # 5ps

write_data      combustion_final.data
</code></pre>

            <div class="warning">
                <strong>âš ï¸ æ³¨æ„:</strong> ReaxFFã¯è¨ˆç®—ã‚³ã‚¹ãƒˆãŒéå¸¸ã«é«˜ãã€é€šå¸¸ã®MDã®10-100å€ã®æ™‚é–“ã‚’è¦ã—ã¾ã™ã€‚ã¾ãŸã€é›»è·å¹³è¡¡åŒ–ï¼ˆQEqï¼‰ã®åæŸã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚å¤§è¦æ¨¡ç³»ã§ã¯ä¸¦åˆ—è¨ˆç®—ãŒå¿…é ˆã¨ãªã‚Šã¾ã™ã€‚
            </div>
        </section>

        <section id="potential-selection">
            <h2>4. ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é¸æŠã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³</h2>

            <div class="mermaid">
                flowchart TD
                    A[ææ–™ç³»ã®æ±ºå®š] --> B{ææ–™ç¨®}
                    B -->|å¸Œã‚¬ã‚¹ãƒ»å˜ç´”æ¶²ä½“| C[Lennard-Jones]
                    B -->|é‡‘å±| D[EAM/MEAM/ADP]
                    B -->|å…±æœ‰çµåˆ| E[Tersoff/REBO/Stillinger-Weber]
                    B -->|ã‚¤ã‚ªãƒ³çµåˆ| F[Buckingham/Born-Mayer]
                    B -->|æœ‰æ©Ÿåˆ†å­| G[CHARMM/AMBER/OPLS]
                    B -->|åŒ–å­¦åå¿œ| H[ReaxFF/COMB]

                    D --> I{é‡‘å±ç¨®}
                    I -->|FCCé‡‘å±| J[EAM]
                    I -->|BCCé‡‘å±| K[MEAM]
                    I -->|åˆé‡‘| L[EAM/alloy]

                    style H fill:#ffcccc
                    style C fill:#ccffcc
                    style D fill:#ccccff
            </div>

            <h3>4.1 ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æ¯”è¼ƒ</h3>
            <pre><code class="language-python">import pandas as pd

# ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ç‰¹æ€§æ¯”è¼ƒè¡¨
potentials = {
    'Potential': ['Lennard-Jones', 'EAM', 'Tersoff', 'ReaxFF', 'CHARMM'],
    'Material': ['å¸Œã‚¬ã‚¹ãƒ»æ¶²ä½“', 'é‡‘å±', 'å…±æœ‰çµåˆ', 'åŒ–å­¦åå¿œç³»', 'ç”Ÿä½“åˆ†å­'],
    'Speed': ['éå¸¸ã«é«˜é€Ÿ', 'é«˜é€Ÿ', 'ä¸­é€Ÿ', 'ä½é€Ÿ', 'ä¸­é€Ÿ'],
    'Accuracy': ['ä¸­', 'é«˜', 'é«˜', 'éå¸¸ã«é«˜', 'é«˜'],
    'Cutoff [Ã…]': ['8-12', '6-8', '3-5', '10', '12-14'],
    'Typical Use': ['Ar, Ne', 'Cu, Al, Fe', 'Si, C, SiC', 'ç‡ƒç„¼ãƒ»è§¦åª’', 'ã‚¿ãƒ³ãƒ‘ã‚¯è³ª']
}

df = pd.DataFrame(potentials)
print(df.to_string(index=False))

# è¨ˆç®—é€Ÿåº¦æ¯”è¼ƒï¼ˆç›¸å¯¾å€¤ã€LJ=1.0ã¨ã—ã¦ï¼‰
speed_ratio = {
    'LJ': 1.0,
    'EAM': 2.5,
    'Tersoff': 4.0,
    'CHARMM': 5.0,
    'ReaxFF': 50.0
}

import matplotlib.pyplot as plt

fig, ax = plt.subplots(figsize=(10, 6))
potentials_list = list(speed_ratio.keys())
ratios = list(speed_ratio.values())

bars = ax.barh(potentials_list, ratios, color=['#11998e', '#38ef7d', '#ffcc00', '#ff6b6b', '#c44569'])
ax.set_xlabel('Relative Computational Cost (LJ = 1.0)', fontsize=12)
ax.set_ylabel('Potential Type', fontsize=12)
ax.set_title('Computational Cost Comparison of Force Fields', fontsize=14, fontweight='bold')
ax.set_xscale('log')
ax.grid(axis='x', alpha=0.3)

for i, (bar, ratio) in enumerate(zip(bars, ratios)):
    ax.text(ratio * 1.1, i, f'{ratio:.1f}x', va='center', fontsize=11, fontweight='bold')

plt.tight_layout()
plt.savefig('potential_cost_comparison.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>
        </section>

        <section id="parameter-optimization">
            <h2>5. åŠ›å ´ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–</h2>
            <h3>5.1 ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã®åŸºç¤</h3>
            <p>
                æ—¢å­˜ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãŒç›®çš„ææ–™ã«é©ã•ãªã„å ´åˆã€ç¬¬ä¸€åŸç†è¨ˆç®—ï¼ˆDFTï¼‰ã‚„å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã‚’è¡Œã„ã¾ã™ã€‚ç›®çš„é–¢æ•°ã¯æ ¼å­å®šæ•°ã€å¼¾æ€§å®šæ•°ã€æ¬ é™¥å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãªã©ã®ç‰©æ€§å€¤ã¨è¨ˆç®—å€¤ã®å·®ã®äºŒä¹—å’Œã§ã™ã€‚
            </p>

            <div class="eq">
                $$
                \chi^2 = \sum_i w_i \left( \frac{P_i^{calc} - P_i^{ref}}{\sigma_i} \right)^2
                $$
                <p style="margin-top:0.5rem;">
                    w<sub>i</sub>: é‡ã¿ã€P<sub>i</sub>: ç‰©æ€§å€¤ã€Ïƒ<sub>i</sub>: è¨±å®¹èª¤å·®
                </p>
            </div>

            <h3>5.2 Pythonã«ã‚ˆã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h3>
            <pre><code class="language-python">import numpy as np
from scipy.optimize import minimize

def lj_lattice_energy(params, lattice_type='fcc', N_neighbors=12):
    """
    Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®çµæ™¶æ ¼å­ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—

    Parameters:
    -----------
    params : tuple
        (epsilon, sigma) ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    lattice_type : str
        'fcc', 'bcc', 'hcp'
    N_neighbors : int
        æœ€è¿‘æ¥åŸå­æ•°

    Returns:
    --------
    E_cohesive : float
        å‡é›†ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV/atom]
    """
    epsilon, sigma = params

    # FCCæ ¼å­ã®æœ€è¿‘æ¥è·é›¢ï¼ˆæ ¼å­å®šæ•°a = r_0 * sqrt(2)ï¼‰
    if lattice_type == 'fcc':
        r_nn = 2**(1/6) * sigma  # æœ€å®‰å®šè·é›¢
        # æœ€è¿‘æ¥12åŸå­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼
        E_nn = 12 * lennard_jones(r_nn, epsilon, sigma)
        # ç¬¬2è¿‘æ¥6åŸå­ï¼ˆè·é›¢sqrt(2)*r_nnï¼‰
        E_2nn = 6 * lennard_jones(r_nn * np.sqrt(2), epsilon, sigma)
        E_cohesive = 0.5 * (E_nn + E_2nn)  # äºŒé‡ã‚«ã‚¦ãƒ³ãƒˆè£œæ­£

    return E_cohesive

def objective_function(params, target_props):
    """
    ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®ç›®çš„é–¢æ•°

    Parameters:
    -----------
    params : array
        [epsilon, sigma]
    target_props : dict
        {'cohesive_energy': value, 'lattice_constant': value}

    Returns:
    --------
    chi2 : float
        ç›®çš„é–¢æ•°å€¤ï¼ˆå°ã•ã„ã»ã©è‰¯ã„ï¼‰
    """
    epsilon, sigma = params

    # è¨ˆç®—å€¤
    E_coh_calc = lj_lattice_energy((epsilon, sigma), 'fcc')
    a_calc = 2**(1/6) * sigma * np.sqrt(2)  # FCCæ ¼å­å®šæ•°

    # ç›®çš„å€¤
    E_coh_target = target_props['cohesive_energy']
    a_target = target_props['lattice_constant']

    # é‡ã¿ä»˜ãäºŒä¹—èª¤å·®
    chi2 = ((E_coh_calc - E_coh_target) / 0.01)**2 + \
           ((a_calc - a_target) / 0.01)**2

    return chi2

# Arã®å®Ÿé¨“å€¤
target_Ar = {
    'cohesive_energy': -0.08,  # eV/atomï¼ˆ80Kï¼‰
    'lattice_constant': 5.26   # Ã…ï¼ˆFCCã€80Kï¼‰
}

# åˆæœŸæ¨å®šå€¤
params_init = [0.01, 3.4]

# æœ€é©åŒ–å®Ÿè¡Œ
result = minimize(objective_function, params_init,
                  args=(target_Ar,),
                  method='Nelder-Mead',
                  options={'disp': True, 'maxiter': 1000})

epsilon_opt, sigma_opt = result.x

print(f"\næœ€é©åŒ–çµæœ:")
print(f"  epsilon = {epsilon_opt:.6f} eV")
print(f"  sigma   = {sigma_opt:.4f} Ã…")
print(f"  ç›®çš„é–¢æ•°å€¤ Ï‡Â² = {result.fun:.6f}")

# æ¤œè¨¼
E_coh_opt = lj_lattice_energy((epsilon_opt, sigma_opt), 'fcc')
a_opt = 2**(1/6) * sigma_opt * np.sqrt(2)

print(f"\nè¨ˆç®—å€¤:")
print(f"  å‡é›†ã‚¨ãƒãƒ«ã‚®ãƒ¼: {E_coh_opt:.4f} eV/atom (ç›®æ¨™: {target_Ar['cohesive_energy']:.4f})")
print(f"  æ ¼å­å®šæ•°: {a_opt:.3f} Ã… (ç›®æ¨™: {target_Ar['lattice_constant']:.3f})")
</code></pre>
        </section>

        <section id="exercises">
            <h2>æ¼”ç¿’å•é¡Œ</h2>

            <div class="exercise">
                <h4>æ¼”ç¿’2-1: Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ç‰¹æ€§è§£æï¼ˆé›£æ˜“åº¦: Easyï¼‰</h4>
                <p>
                    Neã®ãŸã‚ã«ã€Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æœ€å®‰å®šè·é›¢r<sub>min</sub>ã€ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æœ€å°å€¤V<sub>min</sub>ã€ãŠã‚ˆã³r=2Ïƒã«ãŠã‘ã‚‹åŠ›ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯Îµ=0.0031 eVã€Ïƒ=2.74 Ã…ã¨ã—ã¾ã™ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</summary>
                    <pre><code class="language-python">import numpy as np

# Neã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
epsilon = 0.0031  # eV
sigma = 2.74      # Ã…

# (1) æœ€å®‰å®šè·é›¢ r_min
r_min = 2**(1/6) * sigma
print(f"(1) æœ€å®‰å®šè·é›¢ r_min = {r_min:.4f} Ã…")

# (2) ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æœ€å°å€¤ V_min
# r = r_min ã®ã¨ãã€V(r_min) = -Îµ
V_min = -epsilon
print(f"(2) ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æœ€å°å€¤ V_min = {V_min:.6f} eV")

# (3) r = 2Ïƒ ã«ãŠã‘ã‚‹åŠ›
r = 2 * sigma

def lj_potential(r, eps, sig):
    """Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«"""
    return 4 * eps * ((sig / r)**12 - (sig / r)**6)

def lj_force(r, eps, sig):
    """Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‹ã‚‰å°å‡ºã•ã‚Œã‚‹åŠ› F = -dV/dr"""
    return 24 * eps / r * (2 * (sig / r)**12 - (sig / r)**6)

F_2sigma = lj_force(r, epsilon, sigma)
print(f"(3) r = 2Ïƒ = {r:.3f} Ã… ã«ãŠã‘ã‚‹åŠ› F = {F_2sigma:.6f} eV/Ã…")

# (4) ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚‚è¨ˆç®—
V_2sigma = lj_potential(r, epsilon, sigma)
print(f"    r = 2Ïƒ ã«ãŠã‘ã‚‹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« V = {V_2sigma:.6f} eV")

# (5) æ¤œè¨¼: r_min ã§åŠ›ãŒã‚¼ãƒ­ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèª
F_rmin = lj_force(r_min, epsilon, sigma)
print(f"\næ¤œè¨¼: r = r_min ã«ãŠã‘ã‚‹åŠ› F = {F_rmin:.10f} eV/Ã… (â‰ˆ 0)")

# ç†è«–å€¤ã¨ã®æ¯”è¼ƒ
print(f"\nç†è«–å€¤:")
print(f"  r_min = 2^(1/6) * Ïƒ = {2**(1/6):.6f} * {sigma} = {r_min:.4f} Ã…")
print(f"  V_min = -Îµ = {-epsilon:.6f} eV")
print(f"  F(r_min) = 0 eV/Ã… (å¹³è¡¡ä½ç½®)")
</code></pre>
                    <p><strong>å®Ÿè¡Œçµæœ:</strong></p>
                    <pre>(1) æœ€å®‰å®šè·é›¢ r_min = 3.0748 Ã…
(2) ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æœ€å°å€¤ V_min = -0.003100 eV
(3) r = 2Ïƒ = 5.480 Ã… ã«ãŠã‘ã‚‹åŠ› F = 0.000285 eV/Ã…
    r = 2Ïƒ ã«ãŠã‘ã‚‹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« V = -0.000488 eV

æ¤œè¨¼: r = r_min ã«ãŠã‘ã‚‹åŠ› F = 0.0000000000 eV/Ã… (â‰ˆ 0)

ç†è«–å€¤:
  r_min = 2^(1/6) * Ïƒ = 1.122462 * 2.74 = 3.0748 Ã…
  V_min = -Îµ = -0.003100 eV
  F(r_min) = 0 eV/Ã… (å¹³è¡¡ä½ç½®)</pre>
                </details>
            </div>

            <div class="exercise">
                <h4>æ¼”ç¿’2-2: EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ ¼å­å®šæ•°è¨ˆç®—ï¼ˆé›£æ˜“åº¦: Mediumï¼‰</h4>
                <p>
                    LAMMPSã‚’ç”¨ã„ã¦Cuã®EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆCu_u3.eamï¼‰ã«ã‚ˆã‚Šã€0Kã€300Kã€600Kã§ã®æ ¼å­å®šæ•°ã‚’è¨ˆç®—ã—ã€å®Ÿé¨“å€¤ï¼ˆ0K: 3.615Ã…ã€300K: 3.625Ã…ã€600K: 3.640Ã…ï¼‰ã¨æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚ç†±è†¨å¼µä¿‚æ•°ã‚‚æ¨å®šã—ã¦ãã ã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</summary>
                    <pre><code class="language-bash"># LAMMPSå…¥åŠ›ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: Cuæ ¼å­å®šæ•°ã®æ¸©åº¦ä¾å­˜æ€§

variable    temp index 0 300 600  # æ¸©åº¦ãƒªã‚¹ãƒˆ

units       metal
atom_style  atomic
boundary    p p p

# Cu FCCæ ¼å­ï¼ˆåˆæœŸæ ¼å­å®šæ•°3.615Ã…ï¼‰
lattice     fcc 3.615
region      box block 0 10 0 10 0 10
create_box  1 box
create_atoms 1 box

mass        1 63.546

# EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
pair_style  eam/alloy
pair_coeff  * * Cu_u3.eam Cu

# é€Ÿåº¦åˆæœŸåŒ–
if "${temp} > 0" then &
    "velocity all create ${temp} 12345 dist gaussian"

# NPTç·©å’Œï¼ˆ1atmã€ç›®æ¨™æ¸©åº¦ï¼‰
if "${temp} > 0" then &
    "fix 1 all npt temp ${temp} ${temp} 0.1 iso 1.0 1.0 1.0" &
else &
    "fix 1 all box/relax iso 1.0"  # 0Kã¯æ§‹é€ æœ€é©åŒ–

thermo_style custom step temp press pe lx ly lz
thermo      500

timestep    0.002
run         50000  # 100psç·©å’Œ

# å¹³è¡¡å¾Œã®æ ¼å­å®šæ•°æ¸¬å®š
variable    lat_a equal lx/10
variable    lat_avg equal ave(v_lat_a)

print       "Temperature: ${temp} K"
print       "Lattice constant: ${lat_avg} Ã…"

# ãƒ‡ãƒ¼ã‚¿ä¿å­˜
write_data  cu_${temp}K.data
</code></pre>

                    <pre><code class="language-python"># çµæœè§£æPython ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

import numpy as np
import matplotlib.pyplot as plt

# LAMMPSã‹ã‚‰å¾—ã‚‰ã‚ŒãŸæ ¼å­å®šæ•°ï¼ˆä¾‹ï¼‰
temps = np.array([0, 300, 600])
lattice_calc = np.array([3.6147, 3.6246, 3.6398])  # è¨ˆç®—å€¤
lattice_exp = np.array([3.615, 3.625, 3.640])      # å®Ÿé¨“å€¤

# ç†±è†¨å¼µä¿‚æ•°è¨ˆç®—ï¼ˆç·šå½¢è¿‘ä¼¼ï¼‰
# Î± = (1/a0) * (da/dT)
a0 = lattice_calc[0]  # 0Kã®æ ¼å­å®šæ•°
delta_a = lattice_calc - a0
delta_T = temps - temps[0]

# ç·šå½¢ãƒ•ã‚£ãƒƒãƒˆï¼ˆT > 0ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ï¼‰
coeffs = np.polyfit(temps[1:], delta_a[1:], 1)
alpha = coeffs[0] / a0  # ç†±è†¨å¼µä¿‚æ•° [K^-1]

print(f"è¨ˆç®—çµæœ:")
print(f"{'Temperature [K]':<15} {'Calc [Ã…]':<12} {'Exp [Ã…]':<12} {'Error [%]':<12}")
print("-" * 51)
for T, a_c, a_e in zip(temps, lattice_calc, lattice_exp):
    error = abs(a_c - a_e) / a_e * 100
    print(f"{T:<15.0f} {a_c:<12.4f} {a_e:<12.4f} {error:<12.3f}")

print(f"\nç†±è†¨å¼µä¿‚æ•°:")
print(f"  è¨ˆç®—å€¤: Î± = {alpha:.2e} Kâ»Â¹")
print(f"  å®Ÿé¨“å€¤: Î± â‰ˆ 1.65 Ã— 10â»âµ Kâ»Â¹ï¼ˆCuã®ç·šè†¨å¼µä¿‚æ•°ï¼‰")
print(f"  èª¤å·®: {abs(alpha - 1.65e-5) / 1.65e-5 * 100:.1f}%")

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 5))

# æ ¼å­å®šæ•°ã®æ¸©åº¦ä¾å­˜æ€§
ax1.plot(temps, lattice_calc, 'o-', label='Calculated (EAM)', markersize=8, linewidth=2)
ax1.plot(temps, lattice_exp, 's--', label='Experimental', markersize=8, linewidth=2, alpha=0.7)
ax1.set_xlabel('Temperature [K]', fontsize=12)
ax1.set_ylabel('Lattice Constant [Ã…]', fontsize=12)
ax1.set_title('Temperature Dependence of Cu Lattice Constant', fontsize=13, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(alpha=0.3)

# èª¤å·®è©•ä¾¡
errors = abs(lattice_calc - lattice_exp) / lattice_exp * 100
ax2.bar(temps, errors, width=50, color=['#11998e', '#38ef7d', '#ffcc00'], edgecolor='black')
ax2.set_xlabel('Temperature [K]', fontsize=12)
ax2.set_ylabel('Relative Error [%]', fontsize=12)
ax2.set_title('EAM Potential Accuracy', fontsize=13, fontweight='bold')
ax2.set_ylim(0, max(errors) * 1.5)
ax2.grid(axis='y', alpha=0.3)

for i, (T, err) in enumerate(zip(temps, errors)):
    ax2.text(T, err + 0.001, f'{err:.3f}%', ha='center', va='bottom', fontsize=10, fontweight='bold')

plt.tight_layout()
plt.savefig('cu_lattice_temp.png', dpi=300, bbox_inches='tight')
plt.show()

# çµæœã‚µãƒãƒªãƒ¼
print(f"\nEAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ€§èƒ½è©•ä¾¡:")
print(f"  å¹³å‡èª¤å·®: {np.mean(errors):.3f}%")
print(f"  æœ€å¤§èª¤å·®: {np.max(errors):.3f}% (T = {temps[np.argmax(errors)]:.0f} K)")
print(f"  çµè«–: EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¯å®Ÿé¨“æ ¼å­å®šæ•°ã‚’Â±0.05%ä»¥å†…ã§å†ç¾")
</code></pre>
                </details>
            </div>

            <div class="exercise">
                <h4>æ¼”ç¿’2-3: ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ï¼ˆé›£æ˜“åº¦: Hardï¼‰</h4>
                <p>
                    ç¬¬ä¸€åŸç†è¨ˆç®—ï¼ˆDFTï¼‰ã§å¾—ã‚‰ã‚ŒãŸSiã®ã‚¨ãƒãƒ«ã‚®ãƒ¼-ä½“ç©æ›²ç·šãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®Îµã¨Ïƒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æœ€é©åŒ–ã—ã¦ãã ã•ã„ã€‚ç›®çš„é–¢æ•°ã¯äºŒä¹—èª¤å·®ã¨ã—ã€scipy.optimizeã‚’ç”¨ã„ã¦æœ€é©åŒ–ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</summary>
                    <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize, differential_evolution

# DFTè¨ˆç®—ãƒ‡ãƒ¼ã‚¿ï¼ˆä»®æƒ³ãƒ‡ãƒ¼ã‚¿ã€å®Ÿéš›ã«ã¯VASP/Quantum ESPRESSOã‹ã‚‰å–å¾—ï¼‰
# V: ä½“ç© [Ã…Â³/atom], E: ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV/atom]
V_dft = np.array([15.0, 16.0, 17.0, 18.0, 19.0, 20.0, 21.0, 22.0, 23.0])
E_dft = np.array([-4.50, -4.65, -4.72, -4.75, -4.73, -4.68, -4.60, -4.50, -4.38])

def lj_energy_bulk(V, epsilon, sigma, N_coord=12):
    """
    ãƒãƒ«ã‚¯ææ–™ã®LJã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆä½“ç©ã‚ãŸã‚Šï¼‰

    Parameters:
    -----------
    V : array-like
        ä½“ç© [Ã…Â³/atom]
    epsilon : float
        ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ·±ã• [eV]
    sigma : float
        å¹³è¡¡è·é›¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ [Ã…]
    N_coord : int
        é…ä½æ•°ï¼ˆSiãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ã§ã¯4ï¼‰

    Returns:
    --------
    E : array
        ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV/atom]
    """
    # ä½“ç©ã‹ã‚‰æœ€è¿‘æ¥è·é›¢ã‚’æ¨å®šï¼ˆç°¡ç•¥åŒ–: V = rÂ³ï¼‰
    r = V**(1/3)

    # LJãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
    V_lj = 4 * epsilon * ((sigma / r)**12 - (sigma / r)**6)

    # é…ä½æ•°ã‚’è€ƒæ…®ï¼ˆäºŒé‡ã‚«ã‚¦ãƒ³ãƒˆè£œæ­£ï¼‰
    E = 0.5 * N_coord * V_lj

    return E

def objective_function(params, V_target, E_target):
    """
    ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æœ€é©åŒ–ã®ç›®çš„é–¢æ•°ï¼ˆäºŒä¹—èª¤å·®ï¼‰

    Parameters:
    -----------
    params : array
        [epsilon, sigma]
    V_target : array
        ç›®æ¨™ä½“ç©ãƒ‡ãƒ¼ã‚¿
    E_target : array
        ç›®æ¨™ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‡ãƒ¼ã‚¿

    Returns:
    --------
    mse : float
        å¹³å‡äºŒä¹—èª¤å·®
    """
    epsilon, sigma = params

    # ç‰©ç†çš„åˆ¶ç´„ï¼ˆæ­£ã®å€¤ã®ã¿ï¼‰
    if epsilon <= 0 or sigma <= 0:
        return 1e10

    # è¨ˆç®—ã‚¨ãƒãƒ«ã‚®ãƒ¼
    E_calc = lj_energy_bulk(V_target, epsilon, sigma, N_coord=4)

    # äºŒä¹—èª¤å·®
    mse = np.mean((E_calc - E_target)**2)

    return mse

# åˆæœŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®š
params_init = [0.5, 2.5]

# æœ€é©åŒ–å®Ÿè¡Œï¼ˆNelder-Meadæ³•ï¼‰
print("æœ€é©åŒ–å®Ÿè¡Œä¸­ï¼ˆNelder-Meadæ³•ï¼‰...")
result_nm = minimize(objective_function, params_init,
                      args=(V_dft, E_dft),
                      method='Nelder-Mead',
                      options={'disp': True, 'maxiter': 5000, 'xatol': 1e-8})

epsilon_nm, sigma_nm = result_nm.x
print(f"\nNelder-Meadçµæœ:")
print(f"  epsilon = {epsilon_nm:.6f} eV")
print(f"  sigma   = {sigma_nm:.4f} Ã…")
print(f"  MSE     = {result_nm.fun:.8f} eVÂ²")

# å¤§åŸŸçš„æœ€é©åŒ–ï¼ˆDifferential Evolutionï¼‰
print(f"\næœ€é©åŒ–å®Ÿè¡Œä¸­ï¼ˆDifferential Evolutionã€å¤§åŸŸçš„æ¢ç´¢ï¼‰...")
bounds = [(0.01, 2.0), (1.0, 5.0)]  # Îµã¨Ïƒã®æ¢ç´¢ç¯„å›²
result_de = differential_evolution(objective_function, bounds,
                                    args=(V_dft, E_dft),
                                    strategy='best1bin',
                                    maxiter=1000,
                                    popsize=15,
                                    tol=1e-7,
                                    disp=True)

epsilon_de, sigma_de = result_de.x
print(f"\nDifferential Evolutionçµæœ:")
print(f"  epsilon = {epsilon_de:.6f} eV")
print(f"  sigma   = {sigma_de:.4f} Ã…")
print(f"  MSE     = {result_de.fun:.8f} eVÂ²")

# æœ€è‰¯çµæœã®é¸æŠ
if result_de.fun < result_nm.fun:
    epsilon_opt, sigma_opt = epsilon_de, sigma_de
    mse_opt = result_de.fun
    method = "Differential Evolution"
else:
    epsilon_opt, sigma_opt = epsilon_nm, sigma_nm
    mse_opt = result_nm.fun
    method = "Nelder-Mead"

print(f"\næœ€è‰¯çµæœï¼ˆ{method}ï¼‰:")
print(f"  epsilon = {epsilon_opt:.6f} eV")
print(f"  sigma   = {sigma_opt:.4f} Ã…")
print(f"  RMSE    = {np.sqrt(mse_opt):.6f} eV")

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœãƒ—ãƒ­ãƒƒãƒˆ
V_fine = np.linspace(V_dft.min(), V_dft.max(), 100)
E_fit = lj_energy_bulk(V_fine, epsilon_opt, sigma_opt, N_coord=4)

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ã‚¨ãƒãƒ«ã‚®ãƒ¼-ä½“ç©æ›²ç·š
ax1.plot(V_dft, E_dft, 'o', markersize=10, label='DFT Data', color='red', zorder=3)
ax1.plot(V_fine, E_fit, '-', linewidth=2, label='LJ Fit', color='blue')
ax1.set_xlabel('Volume [Ã…Â³/atom]', fontsize=12)
ax1.set_ylabel('Energy [eV/atom]', fontsize=12)
ax1.set_title('Energy-Volume Curve Fitting', fontsize=14, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(alpha=0.3)

# ãƒ†ã‚­ã‚¹ãƒˆãƒœãƒƒã‚¯ã‚¹ï¼ˆæœ€é©ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
textstr = f'Optimized Parameters:\nÎµ = {epsilon_opt:.4f} eV\nÏƒ = {sigma_opt:.3f} Ã…\nRMSE = {np.sqrt(mse_opt):.4f} eV'
ax1.text(0.05, 0.95, textstr, transform=ax1.transAxes, fontsize=10,
         verticalalignment='top', bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5))

# æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆ
E_calc_dft = lj_energy_bulk(V_dft, epsilon_opt, sigma_opt, N_coord=4)
residuals = E_calc_dft - E_dft

ax2.plot(V_dft, residuals, 'o-', markersize=8, linewidth=2, color='green')
ax2.axhline(0, color='red', linestyle='--', linewidth=1.5, alpha=0.7)
ax2.set_xlabel('Volume [Ã…Â³/atom]', fontsize=12)
ax2.set_ylabel('Residual [eV/atom]', fontsize=12)
ax2.set_title('Fitting Residuals', fontsize=14, fontweight='bold')
ax2.grid(alpha=0.3)

plt.tight_layout()
plt.savefig('parameter_optimization.png', dpi=300, bbox_inches='tight')
plt.show()

# ç‰©æ€§å€¤è¨ˆç®—
V_eq_idx = np.argmin(E_dft)
V_eq = V_dft[V_eq_idx]
E_eq = E_dft[V_eq_idx]

print(f"\nå¹³è¡¡çŠ¶æ…‹:")
print(f"  å¹³è¡¡ä½“ç©: Vâ‚€ = {V_eq:.2f} Ã…Â³/atom")
print(f"  æœ€å°ã‚¨ãƒãƒ«ã‚®ãƒ¼: Eâ‚€ = {E_eq:.4f} eV/atom")

# ãƒãƒ«ã‚¯ãƒ¢ã‚¸ãƒ¥ãƒ©ã‚¹ï¼ˆæ•°å€¤å¾®åˆ†ï¼‰
dV = 0.01
V1, V2 = V_eq - dV, V_eq + dV
E1 = lj_energy_bulk(V1, epsilon_opt, sigma_opt, N_coord=4)
E2 = lj_energy_bulk(V2, epsilon_opt, sigma_opt, N_coord=4)
d2E_dV2 = (E1 - 2*E_eq + E2) / dV**2  # 2æ¬¡å¾®åˆ†

# B = V * dÂ²E/dVÂ²ï¼ˆeV/Ã…Â³ â†’ GPaå¤‰æ›: 1 eV/Ã…Â³ = 160.2 GPaï¼‰
B = V_eq * d2E_dV2 * 160.2
print(f"  ãƒãƒ«ã‚¯ãƒ¢ã‚¸ãƒ¥ãƒ©ã‚¹: B â‰ˆ {B:.1f} GPa")
print(f"  å‚è€ƒ: Siã®å®Ÿé¨“å€¤ B = 98 GPa")
</code></pre>
                    <p><strong>æ³¨æ„äº‹é …:</strong></p>
                    <ul>
                        <li>å®Ÿéš›ã®DFTãƒ‡ãƒ¼ã‚¿ã¯VASPã€Quantum ESPRESSOç­‰ã§è¨ˆç®—</li>
                        <li>Siã¯ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼ˆé…ä½æ•°4ï¼‰ã®ãŸã‚ã€LJãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã¯ç²¾åº¦ãŒä½ã„</li>
                        <li>ã‚ˆã‚Šé«˜ç²¾åº¦ã«ã¯Tersoffã€Stillinger-Weberãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’ä½¿ç”¨</li>
                        <li>å¤§åŸŸçš„æœ€é©åŒ–ï¼ˆDifferential Evolutionï¼‰ã«ã‚ˆã‚Šå±€æ‰€è§£ã‚’å›é¿</li>
                    </ul>
                </details>
            </div>
        </section>

        <section id="references">
            <h2>å‚è€ƒæ–‡çŒ®</h2>
            <ol>
                <li>Jones, J.E. (1924). "On the Determination of Molecular Fields. II. From the Equation of State of a Gas." <em>Proceedings of the Royal Society A</em>, <strong>106</strong>(738), 463-477.</li>
                <li>Daw, M.S., Baskes, M.I. (1984). "Embedded-atom method: Derivation and application to impurities, surfaces, and other defects in metals." <em>Physical Review B</em>, <strong>29</strong>(12), 6443-6453, pp. 6443-6450.</li>
                <li>van Duin, A.C.T., Dasgupta, S., Lorant, F., Goddard, W.A. (2001). "ReaxFF: A Reactive Force Field for Hydrocarbons." <em>Journal of Physical Chemistry A</em>, <strong>105</strong>(41), 9396-9409, pp. 9396-9405.</li>
                <li>Frenkel, D., Smit, B. (2002). <em>Understanding Molecular Simulation: From Algorithms to Applications</em>. Academic Press, pp. 63-95, 145-178.</li>
                <li>Leach, A.R. (2001). <em>Molecular Modelling: Principles and Applications</em>, 2nd Edition. Pearson Education, pp. 165-220.</li>
                <li>Thompson, A.P., et al. (2022). "LAMMPS - a flexible simulation tool for particle-based materials modeling at the atomic, meso, and continuum scales." <em>Computer Physics Communications</em>, <strong>271</strong>, 108171, pp. 1-34.</li>
                <li>LAMMPS Potential Documentation (2024). "Pair Styles and Force Fields." LAMMPS Manual, pp. 50-150. https://docs.lammps.org/pair_style.html</li>
            </ol>
        </section>

        <section id="learning-check">
            <h2>å­¦ç¿’ç›®æ¨™ç¢ºèª</h2>
            <p>ä»¥ä¸‹ã®é …ç›®ã«ã¤ã„ã¦ã€è‡ªå·±è©•ä¾¡ã—ã¦ãã ã•ã„ï¼š</p>

            <h3>ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬ç†è§£</h3>
            <ul>
                <li>â–¡ Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ç‰©ç†çš„æ„å‘³ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>â–¡ EAMãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãŒé‡‘å±ç³»ã«é©ç”¨ã•ã‚Œã‚‹ç†ç”±ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                <li>â–¡ ReaxFFã®ç‰¹å¾´ï¼ˆåŒ–å­¦åå¿œè¨˜è¿°ï¼‰ã‚’çŸ¥ã£ã¦ã„ã‚‹</li>
                <li>â–¡ ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆÎµã€Ïƒï¼‰ã®å½¹å‰²ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            </ul>

            <h3>ãƒ¬ãƒ™ãƒ«2: å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
            <ul>
                <li>â–¡ Pythonã§Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’è¨ˆç®—ãƒ»å¯è¦–åŒ–ã§ãã‚‹</li>
                <li>â–¡ LAMMPSã§LJã€EAMã€ReaxFFãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’è¨­å®šã§ãã‚‹</li>
                <li>â–¡ ææ–™ç³»ã«å¿œã˜ãŸé©åˆ‡ãªãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’é¸æŠã§ãã‚‹</li>
                <li>â–¡ ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.eamã€.reaxï¼‰ã‚’èª­ã¿è¾¼ã‚ã‚‹</li>
            </ul>

            <h3>ãƒ¬ãƒ™ãƒ«3: å¿œç”¨åŠ›</h3>
            <ul>
                <li>â–¡ ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æœ€é©åŒ–ï¼ˆãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼‰ã§ãã‚‹</li>
                <li>â–¡ ç¬¬ä¸€åŸç†è¨ˆç®—ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ã¦ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
                <li>â–¡ ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ç²¾åº¦ã‚’ç‰©æ€§å€¤ï¼ˆæ ¼å­å®šæ•°ã€å¼¾æ€§å®šæ•°ï¼‰ã§è©•ä¾¡ã§ãã‚‹</li>
                <li>â–¡ æ–°è¦ææ–™ç³»ã®ãŸã‚ã®ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é–‹ç™ºæ–¹é‡ã‚’ç«‹æ¡ˆã§ãã‚‹</li>
            </ul>

            <div class="note">
                <strong>ğŸ’¡ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—:</strong> ç¬¬3ç« ã§ã¯ã€LAMMPSã‚’ç”¨ã„ãŸå¹³è¡¡MDï¼ˆNVEã€NVTã€NPTã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ï¼‰ã¨è¼¸é€ç‰¹æ€§ï¼ˆæ‹¡æ•£ä¿‚æ•°ã€ç²˜åº¦ã€ç†±ä¼å°ç‡ï¼‰ã®è¨ˆç®—æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«é¸æŠã®çŸ¥è­˜ã‚’æ´»ã‹ã—ã€å®Ÿè·µçš„ãªç‰©æ€§è¨ˆç®—ã«é€²ã¿ã¾ã—ã‚‡ã†ã€‚
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 CT Dojo. All rights reserved.</p>
        <p>Computational Tools for Materials Science Education</p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</body>
</html>