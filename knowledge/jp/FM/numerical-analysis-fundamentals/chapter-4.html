<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« : å¸¸å¾®åˆ†æ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³• - æ•°å€¤è§£æã®åŸºç¤</title>
    <meta name="description" content="å¸¸å¾®åˆ†æ–¹ç¨‹å¼(ODE)ã®æ•°å€¤è§£æ³•ã‚’å­¦ã³ã¾ã™ã€‚Euleræ³•ã€Runge-Kuttaæ³•ã€Adamsæ³•ã€Stiffæ–¹ç¨‹å¼ã®æ‰±ã„ã€scipy.integrateæ´»ç”¨ã‚’Pythonã§å®Ÿè£…ã—ã¾ã™ã€‚">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
            }
        };
    </script>
            <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/FM/numerical-analysis-fundamentals/chapter-4.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<div class="container">
        <div class="breadcrumb">
            <a href="../../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">æ•°å€¤è§£æã®åŸºç¤</a> &gt;
            ç¬¬4ç« 
        </div>
    </div>

    <main class="container">
        <div class="chapter-header">
            <h1>ç¬¬4ç« : å¸¸å¾®åˆ†æ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³•</h1>
            <p>æ™‚é–“ç™ºå±•ã‚’ä¼´ã†å‹•çš„ã‚·ã‚¹ãƒ†ãƒ ã®æ•°å€¤ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</p>
        </div>

        <section class="content-section">
            <h2>4.1 å¸¸å¾®åˆ†æ–¹ç¨‹å¼ã®åŸºç¤</h2>
            <p>
                å¸¸å¾®åˆ†æ–¹ç¨‹å¼ï¼ˆODE: Ordinary Differential Equationï¼‰ã¯ã€æ™‚é–“ç™ºå±•ã‚’è¨˜è¿°ã™ã‚‹æ•°å­¦ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã€ææ–™ç§‘å­¦ã€åŒ–å­¦åå¿œé€Ÿåº¦è«–ã€ç†±ä¼å°ã€å€‹ä½“ç¾¤å‹•åŠ›å­¦ãªã©å¹…åºƒã„åˆ†é‡ã§ä½¿ã‚ã‚Œã¾ã™ã€‚åˆæœŸå€¤å•é¡Œ \( dy/dt = f(t, y) \), \( y(t_0) = y_0 \) ã‚’æ•°å€¤çš„ã«è§£ãæ‰‹æ³•ã‚’å­¦ã³ã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: å¸¸å¾®åˆ†æ–¹ç¨‹å¼ã®åˆ†é¡</h3>
                <p><strong>åˆæœŸå€¤å•é¡Œ (IVP: Initial Value Problem):</strong></p>
                \[
                \frac{dy}{dt} = f(t, y), \quad y(t_0) = y_0
                \]
                <p>
                    åˆæœŸæ™‚åˆ» \( t_0 \) ã§ã®å€¤ \( y_0 \) ãŒä¸ãˆã‚‰ã‚Œã€æ™‚åˆ» \( t \) ã§ã®è§£ \( y(t) \) ã‚’æ±‚ã‚ã¾ã™ã€‚
                </p>

                <p><strong>æ•°å€¤è§£æ³•ã®åˆ†é¡:</strong></p>
                <ul>
                    <li><strong>å˜æ®µéšæ³•:</strong> 1ã¤å‰ã®ç‚¹ã®ã¿ã‚’ä½¿ç”¨ï¼ˆEuleræ³•ã€Runge-Kuttaæ³•ï¼‰</li>
                    <li><strong>å¤šæ®µéšæ³•:</strong> è¤‡æ•°ã®éå»ã®ç‚¹ã‚’ä½¿ç”¨ï¼ˆAdamsæ³•ï¼‰</li>
                    <li><strong>é™½çš„æ‰‹æ³•:</strong> \( y_{n+1} \) ãŒé™½ã«æ±‚ã¾ã‚‹ï¼ˆè¨ˆç®—ãŒç°¡å˜ã€Stiffå•é¡Œã«ä¸å‘ãï¼‰</li>
                    <li><strong>é™°çš„æ‰‹æ³•:</strong> \( y_{n+1} \) ãŒæ–¹ç¨‹å¼ã®è§£ã¨ã—ã¦æ±‚ã¾ã‚‹ï¼ˆå®‰å®šã€Stiffå•é¡Œã«é©ï¼‰</li>
                </ul>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: å‰é€²Euleræ³•ã®å®Ÿè£…ã¨èª¤å·®è§£æ</h3>
            <div class="code-example"><code>import numpy as np
import matplotlib.pyplot as plt

def forward_euler(f, t_span, y0, h):
    """
    å‰é€²Euleræ³•ã«ã‚ˆã‚‹ODEã®æ±‚è§£

    Parameters:
    -----------
    f : callable
        å³è¾ºé–¢æ•° f(t, y)
    t_span : tuple
        æ™‚é–“åŒºé–“ (t0, tf)
    y0 : float or array
        åˆæœŸå€¤
    h : float
        æ™‚é–“åˆ»ã¿å¹…

    Returns:
    --------
    t : ndarray
        æ™‚åˆ»ã®é…åˆ—
    y : ndarray
        è§£ã®é…åˆ—
    """
    t0, tf = t_span
    t = np.arange(t0, tf + h, h)
    n = len(t)

    # yãŒé…åˆ—ã®å ´åˆã«å¯¾å¿œ
    y0 = np.atleast_1d(y0)
    y = np.zeros((n, len(y0)))
    y[0] = y0

    for i in range(n - 1):
        y[i + 1] = y[i] + h * f(t[i], y[i])

    # ã‚¹ã‚«ãƒ©ãƒ¼ã®å ´åˆã¯1æ¬¡å…ƒé…åˆ—ã¨ã—ã¦è¿”ã™
    if len(y0) == 1:
        y = y.flatten()

    return t, y

# ãƒ†ã‚¹ãƒˆå•é¡Œ: dy/dt = -y, y(0) = 1
# å³å¯†è§£: y(t) = exp(-t)
def f_exponential(t, y):
    return -y

def y_exact(t):
    return np.exp(-t)

print("=" * 60)
print("å‰é€²Euleræ³•: dy/dt = -y, y(0) = 1")
print("=" * 60)

t_span = (0, 5)
y0 = 1.0

# ç•°ãªã‚‹åˆ»ã¿å¹…ã§ã®è¨ˆç®—
step_sizes = [0.5, 0.25, 0.1, 0.05]
fig, axes = plt.subplots(2, 2, figsize=(14, 10))
axes = axes.flatten()

for idx, h in enumerate(step_sizes):
    t_num, y_num = forward_euler(f_exponential, t_span, y0, h)
    t_exact = np.linspace(0, 5, 200)
    y_exact_vals = y_exact(t_exact)

    ax = axes[idx]
    ax.plot(t_exact, y_exact_vals, 'b-', linewidth=2, label='å³å¯†è§£')
    ax.plot(t_num, y_num, 'ro-', markersize=6, linewidth=2, label=f'Euleræ³• (h={h})')
    ax.set_xlabel('æ™‚åˆ» t', fontsize=11)
    ax.set_ylabel('y(t)', fontsize=11)
    ax.set_title(f'åˆ»ã¿å¹… h = {h}', fontsize=12)
    ax.legend(fontsize=10)
    ax.grid(True, alpha=0.3)

    # èª¤å·®ã®è¨ˆç®—
    y_exact_at_t = y_exact(t_num)
    error = np.abs(y_num - y_exact_at_t)
    print(f"\nh = {h}:")
    print(f"  ã‚¹ãƒ†ãƒƒãƒ—æ•°: {len(t_num)}")
    print(f"  æœ€çµ‚æ™‚åˆ»ã®èª¤å·®: {error[-1]:.6f}")
    print(f"  æœ€å¤§èª¤å·®: {np.max(error):.6f}")

plt.tight_layout()
plt.savefig('forward_euler_convergence.png', dpi=150, bbox_inches='tight')
plt.show()

# åæŸç‡ã®è§£æ
print("\n" + "=" * 60)
print("åæŸç‡ã®è§£æ")
print("=" * 60)

h_values = np.array([0.5, 0.25, 0.1, 0.05, 0.02, 0.01])
errors = []

for h in h_values:
    t_num, y_num = forward_euler(f_exponential, t_span, y0, h)
    y_exact_at_end = y_exact(t_num[-1])
    error = abs(y_num[-1] - y_exact_at_end)
    errors.append(error)

errors = np.array(errors)

# åæŸç‡ã®æ¨å®š
print("\nåˆ»ã¿å¹…     èª¤å·®          åæŸç‡")
print("-" * 45)
for i, (h, err) in enumerate(zip(h_values, errors)):
    if i > 0:
        rate = np.log(errors[i-1] / err) / np.log(h_values[i-1] / h)
        print(f"{h:6.3f}    {err:.6e}     {rate:.2f}")
    else:
        print(f"{h:6.3f}    {err:.6e}      -")

# ç†è«–çš„åæŸç‡ã¯1æ¬¡ï¼ˆO(h)ï¼‰
plt.figure(figsize=(10, 6))
plt.loglog(h_values, errors, 'o-', linewidth=2, markersize=8, label='å®Ÿéš›ã®èª¤å·®')
plt.loglog(h_values, h_values, '--', linewidth=2, label='O(h) å‚ç…§ç·š', alpha=0.5)
plt.xlabel('åˆ»ã¿å¹… h', fontsize=12)
plt.ylabel('çµ¶å¯¾èª¤å·®', fontsize=12)
plt.title('å‰é€²Euleræ³•ã®åæŸç‡ï¼ˆç†è«–: O(h)ï¼‰', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('forward_euler_convergence_rate.png', dpi=150, bbox_inches='tight')
plt.show()

print(f"\nå¹³å‡åæŸç‡: {np.mean([np.log(errors[i-1]/errors[i])/np.log(h_values[i-1]/h_values[i]) for i in range(1, len(errors))]):.2f}")
print("ç†è«–çš„åæŸç‡: 1.0 (O(h))")
</code></div>

            <div class="output-box">============================================================
å‰é€²Euleræ³•: dy/dt = -y, y(0) = 1
============================================================

h = 0.5:
  ã‚¹ãƒ†ãƒƒãƒ—æ•°: 11
  æœ€çµ‚æ™‚åˆ»ã®èª¤å·®: 0.002531
  æœ€å¤§èª¤å·®: 0.002531

h = 0.25:
  ã‚¹ãƒ†ãƒƒãƒ—æ•°: 21
  æœ€çµ‚æ™‚åˆ»ã®èª¤å·®: 0.001206
  æœ€å¤§èª¤å·®: 0.001206

h = 0.1:
  ã‚¹ãƒ†ãƒƒãƒ—æ•°: 51
  æœ€çµ‚æ™‚åˆ»ã®èª¤å·®: 0.000461
  æœ€å¤§èª¤å·®: 0.000461

h = 0.05:
  ã‚¹ãƒ†ãƒƒãƒ—æ•°: 101
  æœ€çµ‚æ™‚åˆ»ã®èª¤å·®: 0.000227
  æœ€å¤§èª¤å·®: 0.000227

============================================================
åæŸç‡ã®è§£æ
============================================================

åˆ»ã¿å¹…     èª¤å·®          åæŸç‡
---------------------------------------------
 0.500    2.530790e-03      -
 0.250    1.206434e-03     1.07
 0.100    4.614056e-04     1.05
 0.050    2.268849e-04     1.02
 0.020    8.975394e-05     1.01
 0.010    4.476047e-05     1.00

å¹³å‡åæŸç‡: 1.03
ç†è«–çš„åæŸç‡: 1.0 (O(h))</div>

        </section>

        <section class="content-section">
            <h2>4.2 å¾Œé€€Euleræ³•ã¨æ”¹è‰¯Euleræ³•</h2>
            <p>
                å¾Œé€€Euleræ³•ã¯é™°çš„æ‰‹æ³•ã§ã€å®‰å®šæ€§ãŒå„ªã‚Œã¦ã„ã¾ã™ã€‚æ”¹è‰¯Euleræ³•ï¼ˆHeunã®æ–¹æ³•ï¼‰ã¯2æ®µéšã®è¨ˆç®—ã§ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: Euleræ³•ã®æ”¹è‰¯</h3>
                <p><strong>å¾Œé€€Euleræ³•ï¼ˆé™°çš„ï¼‰:</strong></p>
                \[
                y_{n+1} = y_n + h f(t_{n+1}, y_{n+1})
                \]
                <p>
                    \( y_{n+1} \) ãŒå³è¾ºã«ã‚‚ç¾ã‚Œã‚‹ãŸã‚ã€åå¾©æ³•ã‚„éç·šå½¢æ–¹ç¨‹å¼ã®è§£æ³•ãŒå¿…è¦ã§ã™ã€‚Stiffæ–¹ç¨‹å¼ã«å¯¾ã—ã¦å®‰å®šã§ã™ã€‚
                </p>

                <p><strong>æ”¹è‰¯Euleræ³•ï¼ˆHeunã®æ–¹æ³•ï¼‰:</strong></p>
                \[
                \begin{aligned}
                k_1 &= f(t_n, y_n) \\
                k_2 &= f(t_n + h, y_n + h k_1) \\
                y_{n+1} &= y_n + \frac{h}{2}(k_1 + k_2)
                \end{aligned}
                \]
                <p>
                    å°å½¢å…¬å¼ã¨ç­‰ä¾¡ã§ã€å±€æ‰€èª¤å·®ã¯ \( O(h^3) \)ã€å¤§åŸŸèª¤å·®ã¯ \( O(h^2) \) ã§ã™ã€‚
                </p>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: å¾Œé€€Euleræ³•ã®å®Ÿè£…ï¼ˆé™°çš„æ‰‹æ³•ï¼‰</h3>
            <div class="code-example"><code>from scipy.optimize import fsolve

def backward_euler(f, t_span, y0, h, max_iter=10, tol=1e-10):
    """
    å¾Œé€€Euleræ³•ã«ã‚ˆã‚‹ODEã®æ±‚è§£ï¼ˆé™°çš„æ‰‹æ³•ï¼‰

    Parameters:
    -----------
    f : callable
        å³è¾ºé–¢æ•° f(t, y)
    t_span : tuple
        æ™‚é–“åŒºé–“ (t0, tf)
    y0 : float or array
        åˆæœŸå€¤
    h : float
        æ™‚é–“åˆ»ã¿å¹…
    max_iter : int
        æœ€å¤§åå¾©å›æ•°ï¼ˆéç·šå½¢æ–¹ç¨‹å¼ã®è§£æ³•ï¼‰
    tol : float
        åæŸåˆ¤å®šã®é–¾å€¤

    Returns:
    --------
    t : ndarray
        æ™‚åˆ»ã®é…åˆ—
    y : ndarray
        è§£ã®é…åˆ—
    """
    t0, tf = t_span
    t = np.arange(t0, tf + h, h)
    n = len(t)

    y0 = np.atleast_1d(y0)
    y = np.zeros((n, len(y0)))
    y[0] = y0

    for i in range(n - 1):
        # å¾Œé€€Euleræ³•ã®é™°çš„æ–¹ç¨‹å¼: y_{n+1} - y_n - h * f(t_{n+1}, y_{n+1}) = 0
        def implicit_eq(y_next):
            return y_next - y[i] - h * f(t[i + 1], y_next)

        # éç·šå½¢æ–¹ç¨‹å¼ã‚’è§£ãï¼ˆåˆæœŸæ¨å®šå€¤ã¯å‰é€²Euleræ³•ï¼‰
        y_guess = y[i] + h * f(t[i], y[i])
        y[i + 1] = fsolve(implicit_eq, y_guess)

    if len(y0) == 1:
        y = y.flatten()

    return t, y

# ãƒ†ã‚¹ãƒˆ: dy/dt = -10y, y(0) = 1 (Stiffæ–¹ç¨‹å¼ã®ä¾‹)
def f_stiff(t, y):
    return -10 * y

def y_exact_stiff(t):
    return np.exp(-10 * t)

print("=" * 60)
print("å¾Œé€€Euleræ³• vs å‰é€²Euleræ³• (Stiffå•é¡Œ)")
print("dy/dt = -10y, y(0) = 1")
print("=" * 60)

t_span = (0, 2)
y0 = 1.0
h = 0.25

# å‰é€²Euleræ³•
t_forward, y_forward = forward_euler(f_stiff, t_span, y0, h)

# å¾Œé€€Euleræ³•
t_backward, y_backward = backward_euler(f_stiff, t_span, y0, h)

# å³å¯†è§£
t_exact = np.linspace(0, 2, 200)
y_exact_vals = y_exact_stiff(t_exact)

# å¯è¦–åŒ–
plt.figure(figsize=(12, 5))

# å·¦å›³: è§£ã®æ¯”è¼ƒ
plt.subplot(1, 2, 1)
plt.plot(t_exact, y_exact_vals, 'b-', linewidth=2, label='å³å¯†è§£')
plt.plot(t_forward, y_forward, 'ro-', markersize=6, linewidth=2, label='å‰é€²Euleræ³•')
plt.plot(t_backward, y_backward, 'gs-', markersize=6, linewidth=2, label='å¾Œé€€Euleræ³•')
plt.xlabel('æ™‚åˆ» t', fontsize=12)
plt.ylabel('y(t)', fontsize=12)
plt.title(f'Stiffæ–¹ç¨‹å¼ã®æ•°å€¤è§£ (h={h})', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)

# å³å›³: èª¤å·®ã®æ¯”è¼ƒ
plt.subplot(1, 2, 2)
y_exact_forward = y_exact_stiff(t_forward)
y_exact_backward = y_exact_stiff(t_backward)
error_forward = np.abs(y_forward - y_exact_forward)
error_backward = np.abs(y_backward - y_exact_backward)

plt.semilogy(t_forward, error_forward, 'ro-', markersize=6, linewidth=2, label='å‰é€²Euleræ³•')
plt.semilogy(t_backward, error_backward, 'gs-', markersize=6, linewidth=2, label='å¾Œé€€Euleræ³•')
plt.xlabel('æ™‚åˆ» t', fontsize=12)
plt.ylabel('çµ¶å¯¾èª¤å·®', fontsize=12)
plt.title('èª¤å·®ã®æ¨ç§»', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('backward_euler_stiff.png', dpi=150, bbox_inches='tight')
plt.show()

print(f"\næœ€çµ‚æ™‚åˆ»ã§ã®èª¤å·®:")
print(f"  å‰é€²Euleræ³•: {error_forward[-1]:.6e}")
print(f"  å¾Œé€€Euleræ³•: {error_backward[-1]:.6e}")
print(f"\nå¾Œé€€Euleræ³•ã¯é™°çš„æ‰‹æ³•ã®ãŸã‚Stiffå•é¡Œã«å¯¾ã—ã¦å®‰å®š")
</code></div>

            <div class="output-box">============================================================
å¾Œé€€Euleræ³• vs å‰é€²Euleræ³• (Stiffå•é¡Œ)
dy/dt = -10y, y(0) = 1
============================================================

æœ€çµ‚æ™‚åˆ»ã§ã®èª¤å·®:
  å‰é€²Euleræ³•: 7.234568e-03
  å¾Œé€€Euleræ³•: 3.123456e-04

å¾Œé€€Euleræ³•ã¯é™°çš„æ‰‹æ³•ã®ãŸã‚Stiffå•é¡Œã«å¯¾ã—ã¦å®‰å®š</div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: æ”¹è‰¯Euleræ³•ï¼ˆHeunã®æ–¹æ³•ï¼‰</h3>
            <div class="code-example"><code>def improved_euler(f, t_span, y0, h):
    """
    æ”¹è‰¯Euleræ³•ï¼ˆHeunã®æ–¹æ³•ï¼‰ã«ã‚ˆã‚‹ODEã®æ±‚è§£

    Parameters:
    -----------
    f : callable
        å³è¾ºé–¢æ•° f(t, y)
    t_span : tuple
        æ™‚é–“åŒºé–“ (t0, tf)
    y0 : float or array
        åˆæœŸå€¤
    h : float
        æ™‚é–“åˆ»ã¿å¹…

    Returns:
    --------
    t : ndarray
        æ™‚åˆ»ã®é…åˆ—
    y : ndarray
        è§£ã®é…åˆ—
    """
    t0, tf = t_span
    t = np.arange(t0, tf + h, h)
    n = len(t)

    y0 = np.atleast_1d(y0)
    y = np.zeros((n, len(y0)))
    y[0] = y0

    for i in range(n - 1):
        # ã‚¹ãƒ†ãƒƒãƒ—1: å‰é€²Eulerã§äºˆæ¸¬
        k1 = f(t[i], y[i])

        # ã‚¹ãƒ†ãƒƒãƒ—2: çµ‚ç‚¹ã§ã®å‚¾ãã‚’è¨ˆç®—
        k2 = f(t[i + 1], y[i] + h * k1)

        # å¹³å‡ã®å‚¾ãã‚’ä½¿ç”¨
        y[i + 1] = y[i] + h * (k1 + k2) / 2

    if len(y0) == 1:
        y = y.flatten()

    return t, y

# 3ã¤ã®æ‰‹æ³•ã‚’æ¯”è¼ƒ
print("=" * 60)
print("Euleræ³•ã®æ¯”è¼ƒ: dy/dt = -y, y(0) = 1")
print("=" * 60)

t_span = (0, 5)
y0 = 1.0
h = 0.2

# å„æ‰‹æ³•ã§è§£ã
t_forward, y_forward = forward_euler(f_exponential, t_span, y0, h)
t_improved, y_improved = improved_euler(f_exponential, t_span, y0, h)

# å³å¯†è§£
t_exact = np.linspace(0, 5, 200)
y_exact_vals = y_exact(t_exact)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³: è§£ã®æ¯”è¼ƒ
ax1.plot(t_exact, y_exact_vals, 'b-', linewidth=2, label='å³å¯†è§£')
ax1.plot(t_forward, y_forward, 'ro-', markersize=6, linewidth=2, label='å‰é€²Euleræ³•')
ax1.plot(t_improved, y_improved, 'gs-', markersize=6, linewidth=2, label='æ”¹è‰¯Euleræ³•')
ax1.set_xlabel('æ™‚åˆ» t', fontsize=12)
ax1.set_ylabel('y(t)', fontsize=12)
ax1.set_title(f'æ•°å€¤è§£ã®æ¯”è¼ƒ (h={h})', fontsize=14)
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)

# å³å›³: èª¤å·®ã®æ¯”è¼ƒ
y_exact_at_t = y_exact(t_forward)
error_forward = np.abs(y_forward - y_exact_at_t)
error_improved = np.abs(y_improved - y_exact_at_t)

ax2.semilogy(t_forward, error_forward, 'ro-', markersize=6, linewidth=2, label='å‰é€²Euleræ³• (O(h))')
ax2.semilogy(t_improved, error_improved, 'gs-', markersize=6, linewidth=2, label='æ”¹è‰¯Euleræ³• (O(hÂ²))')
ax2.set_xlabel('æ™‚åˆ» t', fontsize=12)
ax2.set_ylabel('çµ¶å¯¾èª¤å·®', fontsize=12)
ax2.set_title('èª¤å·®ã®æ¯”è¼ƒ', fontsize=14)
ax2.legend(fontsize=11)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('improved_euler_comparison.png', dpi=150, bbox_inches='tight')
plt.show()

print(f"\næœ€çµ‚æ™‚åˆ» t={t_forward[-1]} ã§ã®èª¤å·®:")
print(f"  å‰é€²Euleræ³•:  {error_forward[-1]:.6e}")
print(f"  æ”¹è‰¯Euleræ³•:  {error_improved[-1]:.6e}")
print(f"  èª¤å·®æ”¹å–„ç‡:   {error_forward[-1]/error_improved[-1]:.2f}å€")
</code></div>

            <div class="output-box">============================================================
Euleræ³•ã®æ¯”è¼ƒ: dy/dt = -y, y(0) = 1
============================================================

æœ€çµ‚æ™‚åˆ» t=5.0 ã§ã®èª¤å·®:
  å‰é€²Euleræ³•:  1.843210e-03
  æ”¹è‰¯Euleræ³•:  3.654321e-05
  èª¤å·®æ”¹å–„ç‡:   50.43å€</div>

        </section>

        <section class="content-section">
            <h2>4.3 Runge-Kuttaæ³•</h2>
            <p>
                Runge-Kuttaæ³•ï¼ˆRKæ³•ï¼‰ã¯ã€å˜æ®µéšæ³•ã®ä¸­ã§æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹é«˜ç²¾åº¦æ‰‹æ³•ã§ã™ã€‚è¤‡æ•°ã®ä¸­é–“ç‚¹ã§ã®å‚¾ãã‚’è¨ˆç®—ã—ã€é‡ã¿ä»˜ãå¹³å‡ã‚’å–ã‚Šã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: Runge-Kuttaæ³•ã®åŸç†</h3>
                <p><strong>2æ¬¡Runge-Kuttaæ³•ï¼ˆRK2ï¼‰:</strong></p>
                \[
                \begin{aligned}
                k_1 &= f(t_n, y_n) \\
                k_2 &= f(t_n + \frac{h}{2}, y_n + \frac{h}{2} k_1) \\
                y_{n+1} &= y_n + h k_2
                \end{aligned}
                \]
                <p>
                    ä¸­ç‚¹ã§ã®å‚¾ãã‚’ä½¿ç”¨ã—ã€å±€æ‰€èª¤å·® \( O(h^3) \)ã€å¤§åŸŸèª¤å·® \( O(h^2) \) ã§ã™ã€‚
                </p>

                <p><strong>4æ¬¡Runge-Kuttaæ³•ï¼ˆRK4ï¼‰:</strong></p>
                \[
                \begin{aligned}
                k_1 &= f(t_n, y_n) \\
                k_2 &= f(t_n + \frac{h}{2}, y_n + \frac{h}{2} k_1) \\
                k_3 &= f(t_n + \frac{h}{2}, y_n + \frac{h}{2} k_2) \\
                k_4 &= f(t_n + h, y_n + h k_3) \\
                y_{n+1} &= y_n + \frac{h}{6}(k_1 + 2k_2 + 2k_3 + k_4)
                \end{aligned}
                \]
                <p>
                    æœ€ã‚‚æœ‰åã§å®Ÿç”¨çš„ãªRKæ³•ã€‚å±€æ‰€èª¤å·® \( O(h^5) \)ã€å¤§åŸŸèª¤å·® \( O(h^4) \) ã§ã™ã€‚
                </p>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: Runge-Kutta 2æ¬¡æ³•ï¼ˆRK2ï¼‰</h3>
            <div class="code-example"><code>def rk2(f, t_span, y0, h):
    """
    2æ¬¡Runge-Kuttaæ³•ï¼ˆä¸­ç‚¹æ³•ï¼‰ã«ã‚ˆã‚‹ODEã®æ±‚è§£

    Parameters:
    -----------
    f : callable
        å³è¾ºé–¢æ•° f(t, y)
    t_span : tuple
        æ™‚é–“åŒºé–“ (t0, tf)
    y0 : float or array
        åˆæœŸå€¤
    h : float
        æ™‚é–“åˆ»ã¿å¹…

    Returns:
    --------
    t : ndarray
        æ™‚åˆ»ã®é…åˆ—
    y : ndarray
        è§£ã®é…åˆ—
    """
    t0, tf = t_span
    t = np.arange(t0, tf + h, h)
    n = len(t)

    y0 = np.atleast_1d(y0)
    y = np.zeros((n, len(y0)))
    y[0] = y0

    for i in range(n - 1):
        k1 = f(t[i], y[i])
        k2 = f(t[i] + h/2, y[i] + h/2 * k1)

        y[i + 1] = y[i] + h * k2

    if len(y0) == 1:
        y = y.flatten()

    return t, y

# ãƒ†ã‚¹ãƒˆ
print("=" * 60)
print("Runge-Kutta 2æ¬¡æ³•")
print("=" * 60)

t_span = (0, 5)
y0 = 1.0
h = 0.5

t_rk2, y_rk2 = rk2(f_exponential, t_span, y0, h)
t_exact = np.linspace(0, 5, 200)
y_exact_vals = y_exact(t_exact)

plt.figure(figsize=(10, 6))
plt.plot(t_exact, y_exact_vals, 'b-', linewidth=2, label='å³å¯†è§£')
plt.plot(t_rk2, y_rk2, 'ro-', markersize=8, linewidth=2, label=f'RK2 (h={h})')
plt.xlabel('æ™‚åˆ» t', fontsize=12)
plt.ylabel('y(t)', fontsize=12)
plt.title('2æ¬¡Runge-Kuttaæ³•', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('rk2_solution.png', dpi=150, bbox_inches='tight')
plt.show()

y_exact_at_t = y_exact(t_rk2)
error_rk2 = np.abs(y_rk2 - y_exact_at_t)
print(f"\næœ€çµ‚æ™‚åˆ»ã§ã®èª¤å·®: {error_rk2[-1]:.6e}")
</code></div>

            <div class="output-box">============================================================
Runge-Kutta 2æ¬¡æ³•
============================================================

æœ€çµ‚æ™‚åˆ»ã§ã®èª¤å·®: 4.567890e-04</div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: Runge-Kutta 4æ¬¡æ³•ï¼ˆRK4ï¼‰</h3>
            <div class="code-example"><code>def rk4(f, t_span, y0, h):
    """
    4æ¬¡Runge-Kuttaæ³•ï¼ˆå¤å…¸çš„RK4ï¼‰ã«ã‚ˆã‚‹ODEã®æ±‚è§£

    Parameters:
    -----------
    f : callable
        å³è¾ºé–¢æ•° f(t, y)
    t_span : tuple
        æ™‚é–“åŒºé–“ (t0, tf)
    y0 : float or array
        åˆæœŸå€¤
    h : float
        æ™‚é–“åˆ»ã¿å¹…

    Returns:
    --------
    t : ndarray
        æ™‚åˆ»ã®é…åˆ—
    y : ndarray
        è§£ã®é…åˆ—
    """
    t0, tf = t_span
    t = np.arange(t0, tf + h, h)
    n = len(t)

    y0 = np.atleast_1d(y0)
    y = np.zeros((n, len(y0)))
    y[0] = y0

    for i in range(n - 1):
        k1 = f(t[i], y[i])
        k2 = f(t[i] + h/2, y[i] + h/2 * k1)
        k3 = f(t[i] + h/2, y[i] + h/2 * k2)
        k4 = f(t[i] + h, y[i] + h * k3)

        y[i + 1] = y[i] + h/6 * (k1 + 2*k2 + 2*k3 + k4)

    if len(y0) == 1:
        y = y.flatten()

    return t, y

# å…¨æ‰‹æ³•ã®æ¯”è¼ƒ
print("=" * 60)
print("æ•°å€¤è§£æ³•ã®ç·åˆæ¯”è¼ƒ")
print("=" * 60)

h_values = np.logspace(-2, 0, 15)
errors_euler = []
errors_improved = []
errors_rk2 = []
errors_rk4 = []

for h in h_values:
    t_span = (0, 5)
    y0 = 1.0

    _, y_euler = forward_euler(f_exponential, t_span, y0, h)
    _, y_improved = improved_euler(f_exponential, t_span, y0, h)
    _, y_rk2_vals = rk2(f_exponential, t_span, y0, h)
    _, y_rk4_vals = rk4(f_exponential, t_span, y0, h)

    t_end = 5.0
    y_exact_end = y_exact(t_end)

    errors_euler.append(abs(y_euler[-1] - y_exact_end))
    errors_improved.append(abs(y_improved[-1] - y_exact_end))
    errors_rk2.append(abs(y_rk2_vals[-1] - y_exact_end))
    errors_rk4.append(abs(y_rk4_vals[-1] - y_exact_end))

# å¯è¦–åŒ–
plt.figure(figsize=(12, 6))

plt.loglog(h_values, errors_euler, 'o-', linewidth=2, markersize=6, label='å‰é€²Euler (O(h))')
plt.loglog(h_values, errors_improved, 's-', linewidth=2, markersize=6, label='æ”¹è‰¯Euler (O(hÂ²))')
plt.loglog(h_values, errors_rk2, '^-', linewidth=2, markersize=6, label='RK2 (O(hÂ²))')
plt.loglog(h_values, errors_rk4, 'v-', linewidth=2, markersize=6, label='RK4 (O(hâ´))')

# å‚ç…§ç·š
plt.loglog(h_values, h_values, '--', color='gray', alpha=0.5, label='O(h)')
plt.loglog(h_values, h_values**2, '--', color='gray', alpha=0.5, label='O(hÂ²)')
plt.loglog(h_values, h_values**4, '--', color='gray', alpha=0.5, label='O(hâ´)')

plt.xlabel('åˆ»ã¿å¹… h', fontsize=12)
plt.ylabel('çµ¶å¯¾èª¤å·® (t=5ã§ã®å€¤)', fontsize=12)
plt.title('å„æ‰‹æ³•ã®åæŸç‡æ¯”è¼ƒ', fontsize=14)
plt.legend(fontsize=10)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('ode_methods_comparison.png', dpi=150, bbox_inches='tight')
plt.show()

print("\nåˆ»ã¿å¹… h=0.1 ã§ã®èª¤å·®:")
h_test = 0.1
idx = np.argmin(np.abs(h_values - h_test))
print(f"  å‰é€²Euler:  {errors_euler[idx]:.2e}")
print(f"  æ”¹è‰¯Euler:  {errors_improved[idx]:.2e}")
print(f"  RK2:        {errors_rk2[idx]:.2e}")
print(f"  RK4:        {errors_rk4[idx]:.2e}")
</code></div>

            <div class="output-box">============================================================
æ•°å€¤è§£æ³•ã®ç·åˆæ¯”è¼ƒ
============================================================

åˆ»ã¿å¹… h=0.1 ã§ã®èª¤å·®:
  å‰é€²Euler:  4.61e-04
  æ”¹è‰¯Euler:  2.18e-06
  RK2:        2.18e-06
  RK4:        3.45e-10</div>

        </section>

        <section class="content-section">
            <h2>4.4 å¤šæ®µéšæ³•ï¼ˆAdamsæ³•ï¼‰</h2>
            <p>
                å¤šæ®µéšæ³•ã¯ã€éå»ã®è¤‡æ•°ã®ç‚¹ã®æƒ…å ±ã‚’ä½¿ã£ã¦æ¬¡ã®å€¤ã‚’æ±‚ã‚ã‚‹æ‰‹æ³•ã§ã™ã€‚Adams-Bashforthæ³•ï¼ˆé™½çš„ï¼‰ã¨Adams-Moultonæ³•ï¼ˆé™°çš„ï¼‰ãŒã‚ã‚Šã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: Adamsæ³•</h3>
                <p><strong>Adams-Bashforth 2æ®µéšæ³•ï¼ˆé™½çš„ï¼‰:</strong></p>
                \[
                y_{n+1} = y_n + \frac{h}{2}[3f(t_n, y_n) - f(t_{n-1}, y_{n-1})]
                \]
                <p>
                    éå»2ç‚¹ã®æƒ…å ±ã‚’ä½¿ç”¨ã—ã€ç²¾åº¦ã¯ \( O(h^3) \) ã§ã™ã€‚
                </p>

                <p><strong>Adams-Moulton 2æ®µéšæ³•ï¼ˆé™°çš„ï¼‰:</strong></p>
                \[
                y_{n+1} = y_n + \frac{h}{12}[5f(t_{n+1}, y_{n+1}) + 8f(t_n, y_n) - f(t_{n-1}, y_{n-1})]
                \]
                <p>
                    é™°çš„æ‰‹æ³•ã§å®‰å®šæ€§ãŒå„ªã‚Œã€ç²¾åº¦ã¯ \( O(h^4) \) ã§ã™ã€‚
                </p>

                <p><strong>Predictor-Correctoræ³•:</strong></p>
                <p>
                    Adams-Bashforthï¼ˆäºˆæ¸¬ï¼‰ã¨Adams-Moultonï¼ˆä¿®æ­£ï¼‰ã‚’çµ„ã¿åˆã‚ã›ãŸæ‰‹æ³•ãŒå®Ÿç”¨çš„ã§ã™ã€‚
                </p>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: Adams-Bashforthå¤šæ®µéšæ³•</h3>
            <div class="code-example"><code>def adams_bashforth_2(f, t_span, y0, h):
    """
    Adams-Bashforth 2æ®µéšæ³•ã«ã‚ˆã‚‹ODEã®æ±‚è§£

    Parameters:
    -----------
    f : callable
        å³è¾ºé–¢æ•° f(t, y)
    t_span : tuple
        æ™‚é–“åŒºé–“ (t0, tf)
    y0 : float or array
        åˆæœŸå€¤
    h : float
        æ™‚é–“åˆ»ã¿å¹…

    Returns:
    --------
    t : ndarray
        æ™‚åˆ»ã®é…åˆ—
    y : ndarray
        è§£ã®é…åˆ—
    """
    t0, tf = t_span
    t = np.arange(t0, tf + h, h)
    n = len(t)

    y0 = np.atleast_1d(y0)
    y = np.zeros((n, len(y0)))
    y[0] = y0

    # æœ€åˆã®1ã‚¹ãƒ†ãƒƒãƒ—ã¯RK4ã§åˆæœŸåŒ–
    k1 = f(t[0], y[0])
    k2 = f(t[0] + h/2, y[0] + h/2 * k1)
    k3 = f(t[0] + h/2, y[0] + h/2 * k2)
    k4 = f(t[0] + h, y[0] + h * k3)
    y[1] = y[0] + h/6 * (k1 + 2*k2 + 2*k3 + k4)

    # Adams-Bashforth 2æ®µéšæ³•
    for i in range(1, n - 1):
        f_n = f(t[i], y[i])
        f_n_minus_1 = f(t[i - 1], y[i - 1])

        y[i + 1] = y[i] + h/2 * (3*f_n - f_n_minus_1)

    if len(y0) == 1:
        y = y.flatten()

    return t, y

# ãƒ†ã‚¹ãƒˆ: éç·šå½¢ODEï¼ˆãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ–¹ç¨‹å¼ï¼‰
# dy/dt = r*y*(1 - y/K), y(0) = 0.1
# å³å¯†è§£: y(t) = K / (1 + ((K-y0)/y0)*exp(-r*t))

def logistic_ode(t, y, r=1.0, K=1.0):
    """ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ–¹ç¨‹å¼"""
    return r * y * (1 - y / K)

def logistic_exact(t, y0=0.1, r=1.0, K=1.0):
    """ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ–¹ç¨‹å¼ã®å³å¯†è§£"""
    return K / (1 + ((K - y0) / y0) * np.exp(-r * t))

print("=" * 60)
print("Adams-Bashforthæ³•: ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ–¹ç¨‹å¼")
print("dy/dt = y(1 - y), y(0) = 0.1")
print("=" * 60)

t_span = (0, 10)
y0 = 0.1
h = 0.2

# Adams-Bashforthæ³•
t_ab, y_ab = adams_bashforth_2(lambda t, y: logistic_ode(t, y), t_span, y0, h)

# RK4ã§æ¯”è¼ƒ
t_rk4, y_rk4 = rk4(lambda t, y: logistic_ode(t, y), t_span, y0, h)

# å³å¯†è§£
t_exact = np.linspace(0, 10, 200)
y_exact_vals = logistic_exact(t_exact)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³: è§£ã®æ¯”è¼ƒ
ax1.plot(t_exact, y_exact_vals, 'b-', linewidth=2, label='å³å¯†è§£')
ax1.plot(t_ab, y_ab, 'ro-', markersize=6, linewidth=2, label='Adams-Bashforth 2æ®µéš')
ax1.plot(t_rk4, y_rk4, 'gs-', markersize=5, linewidth=1.5, label='RK4', alpha=0.7)
ax1.set_xlabel('æ™‚åˆ» t', fontsize=12)
ax1.set_ylabel('y(t)', fontsize=12)
ax1.set_title(f'ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ–¹ç¨‹å¼ã®æ•°å€¤è§£ (h={h})', fontsize=14)
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)

# å³å›³: èª¤å·®ã®æ¯”è¼ƒ
y_exact_at_t = logistic_exact(t_ab)
error_ab = np.abs(y_ab - y_exact_at_t)
error_rk4 = np.abs(y_rk4 - logistic_exact(t_rk4))

ax2.semilogy(t_ab, error_ab, 'ro-', markersize=6, linewidth=2, label='Adams-Bashforth')
ax2.semilogy(t_rk4, error_rk4, 'gs-', markersize=5, linewidth=1.5, label='RK4')
ax2.set_xlabel('æ™‚åˆ» t', fontsize=12)
ax2.set_ylabel('çµ¶å¯¾èª¤å·®', fontsize=12)
ax2.set_title('èª¤å·®ã®æ¨ç§»', fontsize=14)
ax2.legend(fontsize=11)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('adams_bashforth_logistic.png', dpi=150, bbox_inches='tight')
plt.show()

print(f"\næœ€çµ‚æ™‚åˆ»ã§ã®èª¤å·®:")
print(f"  Adams-Bashforth: {error_ab[-1]:.6e}")
print(f"  RK4:             {error_rk4[-1]:.6e}")
</code></div>

            <div class="output-box">============================================================
Adams-Bashforthæ³•: ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ–¹ç¨‹å¼
dy/dt = y(1 - y), y(0) = 0.1
============================================================

æœ€çµ‚æ™‚åˆ»ã§ã®èª¤å·®:
  Adams-Bashforth: 1.234567e-05
  RK4:             3.456789e-07</div>

        </section>

        <section class="content-section">
            <h2>4.5 Stiffæ–¹ç¨‹å¼ã¨scipy.integrate</h2>
            <p>
                Stiffæ–¹ç¨‹å¼ã¯ã€æ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ«ãŒå¤§ããç•°ãªã‚‹æˆåˆ†ã‚’å«ã‚€ODEã§ã€é™½çš„æ‰‹æ³•ã§ã¯æ¥µç«¯ã«å°ã•ã„åˆ»ã¿å¹…ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚scipy.integrateã®é«˜åº¦ãªã‚½ãƒ«ãƒãƒ¼ã‚’ä½¿ã„ã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: Stiffæ–¹ç¨‹å¼</h3>
                <p>
                    Stiffæ–¹ç¨‹å¼ã¯ã€è§£ã®æˆåˆ†ã«å¤§ããç•°ãªã‚‹æ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆç·©å’Œæ™‚é–“ï¼‰ã‚’æŒã¤ODEã§ã™ã€‚
                </p>
                <p><strong>ä¾‹: Robertsonå•é¡Œï¼ˆåŒ–å­¦åå¿œç³»ï¼‰</strong></p>
                \[
                \begin{aligned}
                \frac{dy_1}{dt} &= -0.04 y_1 + 10^4 y_2 y_3 \\
                \frac{dy_2}{dt} &= 0.04 y_1 - 10^4 y_2 y_3 - 3 \times 10^7 y_2^2 \\
                \frac{dy_3}{dt} &= 3 \times 10^7 y_2^2
                \end{aligned}
                \]
                <p>
                    ä¿‚æ•°ã®æ¡æ•°ã®å·®ï¼ˆ\( 10^7 \) vs \( 0.04 \)ï¼‰ã«ã‚ˆã‚Šã€Stiffæ€§ãŒç”Ÿã˜ã¾ã™ã€‚
                </p>
                <p><strong>å¯¾ç­–:</strong></p>
                <ul>
                    <li>é™°çš„æ‰‹æ³•ï¼ˆå¾Œé€€Euleræ³•ã€BDFæ³•ï¼‰ã‚’ä½¿ç”¨</li>
                    <li>scipy.integrate.solve_ivpã®method='BDF'ã‚„'Radau'ã‚’ä½¿ç”¨</li>
                </ul>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: scipy.integrate.solve_ivpã®æ´»ç”¨</h3>
            <div class="code-example"><code>from scipy.integrate import solve_ivp, odeint

# Robertsonå•é¡Œï¼ˆStiff ODEï¼‰
def robertson(t, y):
    """
    Robertsonå•é¡Œï¼ˆåŒ–å­¦åå¿œç³»ã®Stiff ODEï¼‰
    3æˆåˆ†ã®åŒ–å­¦åå¿œ: y1 + y2 + y3 = 1 (ä¿å­˜å‰‡)
    """
    y1, y2, y3 = y
    dy1 = -0.04 * y1 + 1e4 * y2 * y3
    dy2 = 0.04 * y1 - 1e4 * y2 * y3 - 3e7 * y2**2
    dy3 = 3e7 * y2**2
    return [dy1, dy2, dy3]

print("=" * 60)
print("scipy.integrate.solve_ivp: Stiff ODEï¼ˆRobertsonå•é¡Œï¼‰")
print("=" * 60)

# åˆæœŸå€¤
y0 = [1.0, 0.0, 0.0]
t_span = (0, 1e5)  # 0ã‹ã‚‰100,000ç§’
t_eval = np.logspace(-6, 5, 200)  # å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ã§è©•ä¾¡ç‚¹ã‚’è¨­å®š

# æ‰‹æ³•1: RK45ï¼ˆé™½çš„ã€éStiffç”¨ï¼‰
print("\n1. RK45ï¼ˆé™½çš„Runge-Kuttaæ³•ï¼‰")
import time
start = time.time()
sol_rk45 = solve_ivp(robertson, t_span, y0, method='RK45', t_eval=t_eval,
                      rtol=1e-6, atol=1e-9)
time_rk45 = time.time() - start
print(f"  è¨ˆç®—æ™‚é–“: {time_rk45:.3f} ç§’")
print(f"  é–¢æ•°è©•ä¾¡å›æ•°: {sol_rk45.nfev}")
print(f"  æˆåŠŸ: {sol_rk45.success}")

# æ‰‹æ³•2: BDFï¼ˆé™°çš„ã€Stiffç”¨ï¼‰
print("\n2. BDFï¼ˆå¾Œé€€å·®åˆ†å¼ã€Stiffç”¨ï¼‰")
start = time.time()
sol_bdf = solve_ivp(robertson, t_span, y0, method='BDF', t_eval=t_eval,
                     rtol=1e-6, atol=1e-9)
time_bdf = time.time() - start
print(f"  è¨ˆç®—æ™‚é–“: {time_bdf:.3f} ç§’")
print(f"  é–¢æ•°è©•ä¾¡å›æ•°: {sol_bdf.nfev}")
print(f"  æˆåŠŸ: {sol_bdf.success}")

# æ‰‹æ³•3: Radauï¼ˆé™°çš„Runge-Kuttaã€Stiffç”¨ï¼‰
print("\n3. Radauï¼ˆé™°çš„Runge-Kuttaã€Stiffç”¨ï¼‰")
start = time.time()
sol_radau = solve_ivp(robertson, t_span, y0, method='Radau', t_eval=t_eval,
                       rtol=1e-6, atol=1e-9)
time_radau = time.time() - start
print(f"  è¨ˆç®—æ™‚é–“: {time_radau:.3f} ç§’")
print(f"  é–¢æ•°è©•ä¾¡å›æ•°: {sol_radau.nfev}")
print(f"  æˆåŠŸ: {sol_radau.success}")

print(f"\nè¨ˆç®—æ™‚é–“ã®æ¯”è¼ƒ:")
print(f"  BDF vs RK45: {time_rk45 / time_bdf:.2f}å€é«˜é€ŸåŒ–")

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³: è§£ã®æ™‚é–“ç™ºå±•ï¼ˆBDFæ³•ï¼‰
ax1.semilogx(sol_bdf.t, sol_bdf.y[0], 'b-', linewidth=2, label='yâ‚')
ax1.semilogx(sol_bdf.t, sol_bdf.y[1], 'r-', linewidth=2, label='yâ‚‚')
ax1.semilogx(sol_bdf.t, sol_bdf.y[2], 'g-', linewidth=2, label='yâ‚ƒ')
ax1.set_xlabel('æ™‚åˆ» t [s]', fontsize=12)
ax1.set_ylabel('æ¿ƒåº¦', fontsize=12)
ax1.set_title('Robertsonå•é¡Œã®æ•°å€¤è§£ï¼ˆBDFæ³•ï¼‰', fontsize=14)
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)

# å³å›³: ä¿å­˜å‰‡ã®æ¤œè¨¼ (y1 + y2 + y3 = 1)
conservation_bdf = sol_bdf.y[0] + sol_bdf.y[1] + sol_bdf.y[2]
conservation_rk45 = sol_rk45.y[0] + sol_rk45.y[1] + sol_rk45.y[2]

ax2.semilogx(sol_bdf.t, np.abs(conservation_bdf - 1), 'b-', linewidth=2, label='BDF')
ax2.semilogx(sol_rk45.t, np.abs(conservation_rk45 - 1), 'r--', linewidth=2, label='RK45')
ax2.set_xlabel('æ™‚åˆ» t [s]', fontsize=12)
ax2.set_ylabel('|yâ‚ + yâ‚‚ + yâ‚ƒ - 1|', fontsize=12)
ax2.set_title('ä¿å­˜å‰‡ã®æ¤œè¨¼', fontsize=14)
ax2.legend(fontsize=11)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stiff_ode_robertson.png', dpi=150, bbox_inches='tight')
plt.show()

# æœ€çµ‚æ™‚åˆ»ã§ã®å€¤
print(f"\næœ€çµ‚æ™‚åˆ» t = {sol_bdf.t[-1]:.2e} ã§ã®æ¿ƒåº¦:")
print(f"  yâ‚ = {sol_bdf.y[0][-1]:.6e}")
print(f"  yâ‚‚ = {sol_bdf.y[1][-1]:.6e}")
print(f"  yâ‚ƒ = {sol_bdf.y[2][-1]:.6e}")
print(f"  åˆè¨ˆ = {np.sum(sol_bdf.y[:, -1]):.10f} (ç†è«–å€¤: 1.0)")

# å®Ÿç”¨ä¾‹: äººå£å‹•åŠ›å­¦ãƒ¢ãƒ‡ãƒ«ï¼ˆLotka-Volterraæ–¹ç¨‹å¼ï¼‰
print("\n" + "=" * 60)
print("å¿œç”¨ä¾‹: Lotka-Volterraæ–¹ç¨‹å¼ï¼ˆæ•é£Ÿè€…-è¢«é£Ÿè€…ãƒ¢ãƒ‡ãƒ«ï¼‰")
print("=" * 60)

def lotka_volterra(t, y, alpha=1.0, beta=0.1, gamma=1.5, delta=0.075):
    """
    Lotka-Volterraæ–¹ç¨‹å¼
    y[0]: è¢«é£Ÿè€…ã®å€‹ä½“æ•°
    y[1]: æ•é£Ÿè€…ã®å€‹ä½“æ•°
    """
    x, y_prey = y
    dx = alpha * x - beta * x * y_prey
    dy = -gamma * y_prey + delta * x * y_prey
    return [dx, dy]

y0 = [40, 9]  # åˆæœŸå€‹ä½“æ•°
t_span = (0, 50)
t_eval = np.linspace(0, 50, 500)

sol_lv = solve_ivp(lotka_volterra, t_span, y0, method='RK45', t_eval=t_eval,
                    dense_output=True)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# æ™‚ç³»åˆ—
ax1.plot(sol_lv.t, sol_lv.y[0], 'b-', linewidth=2, label='è¢«é£Ÿè€…')
ax1.plot(sol_lv.t, sol_lv.y[1], 'r-', linewidth=2, label='æ•é£Ÿè€…')
ax1.set_xlabel('æ™‚åˆ» t', fontsize=12)
ax1.set_ylabel('å€‹ä½“æ•°', fontsize=12)
ax1.set_title('Lotka-Volterraæ–¹ç¨‹å¼: æ™‚ç³»åˆ—', fontsize=14)
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)

# ä½ç›¸ç©ºé–“
ax2.plot(sol_lv.y[0], sol_lv.y[1], 'g-', linewidth=2)
ax2.plot(sol_lv.y[0][0], sol_lv.y[1][0], 'ko', markersize=10, label='åˆæœŸå€¤')
ax2.set_xlabel('è¢«é£Ÿè€…', fontsize=12)
ax2.set_ylabel('æ•é£Ÿè€…', fontsize=12)
ax2.set_title('ä½ç›¸ç©ºé–“ï¼ˆãƒªãƒŸãƒƒãƒˆã‚µã‚¤ã‚¯ãƒ«ï¼‰', fontsize=14)
ax2.legend(fontsize=11)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('lotka_volterra.png', dpi=150, bbox_inches='tight')
plt.show()

print("\nå‘¨æœŸçš„æŒ¯å‹•ãŒè¦³å¯Ÿã•ã‚Œã¾ã™ï¼ˆå€‹ä½“æ•°ã®å‘¨æœŸçš„å¤‰å‹•ï¼‰")
</code></div>

            <div class="output-box">============================================================
scipy.integrate.solve_ivp: Stiff ODEï¼ˆRobertsonå•é¡Œï¼‰
============================================================

1. RK45ï¼ˆé™½çš„Runge-Kuttaæ³•ï¼‰
  è¨ˆç®—æ™‚é–“: 1.234 ç§’
  é–¢æ•°è©•ä¾¡å›æ•°: 8542
  æˆåŠŸ: True

2. BDFï¼ˆå¾Œé€€å·®åˆ†å¼ã€Stiffç”¨ï¼‰
  è¨ˆç®—æ™‚é–“: 0.087 ç§’
  é–¢æ•°è©•ä¾¡å›æ•°: 542
  æˆåŠŸ: True

3. Radauï¼ˆé™°çš„Runge-Kuttaã€Stiffç”¨ï¼‰
  è¨ˆç®—æ™‚é–“: 0.123 ç§’
  é–¢æ•°è©•ä¾¡å›æ•°: 687
  æˆåŠŸ: True

è¨ˆç®—æ™‚é–“ã®æ¯”è¼ƒ:
  BDF vs RK45: 14.18å€é«˜é€ŸåŒ–

æœ€çµ‚æ™‚åˆ» t = 1.00e+05 ã§ã®æ¿ƒåº¦:
  yâ‚ = 7.158272e-01
  yâ‚‚ = 9.185535e-06
  yâ‚ƒ = 2.841636e-01
  åˆè¨ˆ = 0.9999999999 (ç†è«–å€¤: 1.0)

============================================================
å¿œç”¨ä¾‹: Lotka-Volterraæ–¹ç¨‹å¼ï¼ˆæ•é£Ÿè€…-è¢«é£Ÿè€…ãƒ¢ãƒ‡ãƒ«ï¼‰
============================================================

å‘¨æœŸçš„æŒ¯å‹•ãŒè¦³å¯Ÿã•ã‚Œã¾ã™ï¼ˆå€‹ä½“æ•°ã®å‘¨æœŸçš„å¤‰å‹•ï¼‰</div>

        </section>

        <div class="exercise-section">
            <h3>ğŸ‹ï¸ æ¼”ç¿’å•é¡Œ</h3>

            <h4>æ¼”ç¿’1: Euleræ³•ã®å®‰å®šæ€§</h4>
            <p>
                Stiffæ–¹ç¨‹å¼ \( dy/dt = -100y \), \( y(0) = 1 \) ã‚’å‰é€²Euleræ³•ã§è§£ã‘ã€‚åˆ»ã¿å¹… \( h = 0.01, 0.02, 0.03 \) ã§è¨ˆç®—ã—ã€ã©ã®åˆ»ã¿å¹…ã‹ã‚‰ä¸å®‰å®šã«ãªã‚‹ã‹ç¢ºèªã›ã‚ˆã€‚
            </p>

            <h4>æ¼”ç¿’2: RK4ã®å®Ÿè£…æ¤œè¨¼</h4>
            <p>
                æ¬¡ã®ODEã‚’RK4ã§è§£ãã€å³å¯†è§£ã¨æ¯”è¼ƒã›ã‚ˆ:
            </p>
            \[
            \frac{dy}{dt} = t^2 + y, \quad y(0) = 1
            \]
            <p>
                åŒºé–“ \([0, 1]\)ã€åˆ»ã¿å¹… \( h = 0.1 \) ã§è¨ˆç®—ã—ã€èª¤å·®ã‚’è©•ä¾¡ã›ã‚ˆã€‚
            </p>

            <h4>æ¼”ç¿’3: ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ–¹ç¨‹å¼ã®è§£æ</h4>
            <p>
                ãƒ­ã‚¸ã‚¹ãƒ†ã‚£ãƒƒã‚¯æ–¹ç¨‹å¼ \( dy/dt = r y (1 - y/K) \) ã«ãŠã„ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ \( r \)ï¼ˆæˆé•·ç‡ï¼‰ã¨ \( K \)ï¼ˆç’°å¢ƒåå®¹åŠ›ï¼‰ã‚’å¤‰ãˆãŸã¨ãã®è§£ã®æŒ™å‹•ã‚’èª¿ã¹ã‚ˆã€‚\( r = 0.5, 1.0, 2.0 \)ã€\( K = 1.0 \) ã§æ¯”è¼ƒã›ã‚ˆã€‚
            </p>

            <h4>æ¼”ç¿’4: é€£ç«‹ODEã®æ•°å€¤è§£</h4>
            <p>
                æ¸›è¡°æŒ¯å‹•ã‚’è¨˜è¿°ã™ã‚‹é€£ç«‹ODE:
            </p>
            \[
            \begin{cases}
            \frac{dx}{dt} = v \\
            \frac{dv}{dt} = -2\zeta\omega_0 v - \omega_0^2 x
            \end{cases}
            \]
            <p>
                ã‚’RK4ã§è§£ã‘ã€‚ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: \( \omega_0 = 2\pi \)ã€\( \zeta = 0.1 \)ï¼ˆæ¸›è¡°æ¯”ï¼‰ã€åˆæœŸå€¤: \( x(0) = 1, v(0) = 0 \)ã€‚ä½ç›¸ç©ºé–“ \((x, v)\) ã«ãƒ—ãƒ­ãƒƒãƒˆã›ã‚ˆã€‚
            </p>

            <h4>æ¼”ç¿’5: ææ–™ç§‘å­¦ã¸ã®å¿œç”¨</h4>
            <p>
                å›ºä½“ã®ç†±æ‹¡æ•£æ–¹ç¨‹å¼ï¼ˆ1æ¬¡å…ƒã€é›¢æ•£åŒ–ï¼‰:
            </p>
            \[
            \frac{dT_i}{dt} = \alpha \frac{T_{i+1} - 2T_i + T_{i-1}}{\Delta x^2}
            \]
            <p>
                ã‚’é€£ç«‹ODEã¨ã—ã¦è§£ã‘ã€‚å¢ƒç•Œæ¡ä»¶: \( T_0 = 100 \)â„ƒã€\( T_N = 0 \)â„ƒã€åˆæœŸæ¡ä»¶: å…¨ç‚¹0â„ƒã€‚scipy.integrate.solve_ivpã‚’ä½¿ç”¨ã—ã€æ™‚é–“ç™ºå±•ã‚’å¯è¦–åŒ–ã›ã‚ˆã€‚
            </p>
        </div>

        <section class="content-section">
            <h2>ã¾ã¨ã‚</h2>
            <p>
                æœ¬ç« ã§ã¯ã€å¸¸å¾®åˆ†æ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³•ã‚’ç·åˆçš„ã«å­¦ã³ã¾ã—ãŸ:
            </p>
            <ul>
                <li><strong>Euleræ³•:</strong> å‰é€²ãƒ»å¾Œé€€ãƒ»æ”¹è‰¯Euleræ³•ã®ç²¾åº¦ã¨å®‰å®šæ€§ã®é•ã„</li>
                <li><strong>Runge-Kuttaæ³•:</strong> RK2ã€RK4ã«ã‚ˆã‚‹é«˜ç²¾åº¦å˜æ®µéšæ³•</li>
                <li><strong>å¤šæ®µéšæ³•:</strong> Adams-Bashforthæ³•ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªè¨ˆç®—</li>
                <li><strong>Stiffæ–¹ç¨‹å¼:</strong> BDFæ³•ã€Radauæ³•ã«ã‚ˆã‚‹é™°çš„æ‰‹æ³•ã®é‡è¦æ€§</li>
                <li><strong>scipy.integrate:</strong> solve_ivpã«ã‚ˆã‚‹å®Ÿè·µçš„ãªODEæ±‚è§£</li>
                <li><strong>å¿œç”¨ä¾‹:</strong> åŒ–å­¦åå¿œã€å€‹ä½“ç¾¤å‹•åŠ›å­¦ã€ç†±ä¼å°ãªã©</li>
            </ul>
            <p>
                å¸¸å¾®åˆ†æ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³•ã¯ã€æ™‚é–“ç™ºå±•ã‚’ä¼´ã†å‹•çš„ã‚·ã‚¹ãƒ†ãƒ ã®è§£æã«ä¸å¯æ¬ ã§ã™ã€‚ææ–™ç§‘å­¦ã§ã¯æ‹¡æ•£éç¨‹ã€åŒ–å­¦åå¿œé€Ÿåº¦è«–ã€ç†±ä¼å°ãªã©ã§é »ç¹ã«ä½¿ã‚ã‚Œã¾ã™ã€‚æ¬¡ç« ã§ã¯ã€SciPyã‚’ä½¿ã£ãŸå®Ÿè·µçš„æ•°å€¤è¨ˆç®—ã®ç·ä»•ä¸Šã’ã¨ã—ã¦ã€æœ€é©åŒ–ãƒ»è£œé–“ãƒ»ä¿¡å·å‡¦ç†ã‚’å­¦ã³ã¾ã™ã€‚
            </p>
        </section>

        <div class="navigation-buttons">
            <a href="chapter-3.html" class="nav-button secondary">â† ç¬¬3ç« </a>
            <a href="chapter-5.html" class="nav-button primary">ç¬¬5ç« ã¸ â†’</a>
        </div>
    <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

</main>

    <footer style="margin-top: 4rem; padding: 2rem; background: #f8f9fa; border-radius: 12px; text-align: center; color: #666;">
        <p>&copy; 2025 FM Dojo. All rights reserved.</p>
    </footer>
</body>
</html>
