<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : ç·šå½¢æ–¹ç¨‹å¼ç³»ã®è§£æ³• - æ•°å€¤è§£æã®åŸºç¤</title>
    <meta name="description" content="å¤§è¦æ¨¡é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³•ã‚’å­¦ã³ã¾ã™ã€‚Gaussæ¶ˆå»æ³•ã€LUåˆ†è§£ã€åå¾©æ³•ï¼ˆJacobiæ³•ã€Gauss-Seidelæ³•ã€SORæ³•ï¼‰ã€ç–è¡Œåˆ—å‡¦ç†ã‚’Pythonã§å®Ÿè£…ã—ã¾ã™ã€‚">
    <link rel="stylesheet" href="../../../assets/css/style.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
            }
        };
    </script>
            <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>
</head>
<body>
    <nav class="breadcrumb">
        <a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a> &gt;
        <a href="../../index.html">çŸ¥è­˜ãƒ™ãƒ¼ã‚¹</a> &gt;
        <a href="../index.html">FM Dojo</a> &gt;
        <a href="index.html">æ•°å€¤è§£æã®åŸºç¤</a> &gt;
        <span>ç¬¬2ç« </span>
    </nav>

    <main class="container">
        <div class="chapter-header">
            <h1>ç¬¬2ç« : ç·šå½¢æ–¹ç¨‹å¼ç³»ã®è§£æ³•</h1>
            <p>å¤§è¦æ¨¡é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã‚’åŠ¹ç‡çš„ã«è§£ãç›´æ¥æ³•ã¨åå¾©æ³•</p>
        </div>

        <section class="content-section">
            <h2>2.1 é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã®åŸºç¤</h2>
            <p>
                ææ–™ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæœ‰é™è¦ç´ æ³•ã€æ‹¡æ•£æ–¹ç¨‹å¼ãªã©ï¼‰ã§ã¯ã€\( Ax = b \) ã®å½¢ã®å¤§è¦æ¨¡é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ãŒé »ç¹ã«ç¾ã‚Œã¾ã™ã€‚ã“ã“ã§ \( A \) ã¯ \( n \times n \) è¡Œåˆ—ã€\( x \) ã¨ \( b \) ã¯ \( n \) æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ã§ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: ç›´æ¥æ³•ã¨åå¾©æ³•</h3>
                <p><strong>ç›´æ¥æ³• (Direct Methods):</strong></p>
                <ul>
                    <li>æœ‰é™å›ã®æ¼”ç®—ã§å³å¯†è§£ã‚’å¾—ã‚‹ï¼ˆç†è«–ä¸Šï¼‰</li>
                    <li>ä¾‹: Gaussæ¶ˆå»æ³•ã€LUåˆ†è§£ã€Choleskyåˆ†è§£</li>
                    <li>è¨ˆç®—é‡: \( O(n^3) \)</li>
                    <li>å°ã€œä¸­è¦æ¨¡å•é¡Œï¼ˆ\( n \lesssim 10^4 \)ï¼‰ã«é©ã™ã‚‹</li>
                </ul>

                <p><strong>åå¾©æ³• (Iterative Methods):</strong></p>
                <ul>
                    <li>åˆæœŸå€¤ã‹ã‚‰å‡ºç™ºã—ã¦è§£ã«åæŸã•ã›ã‚‹</li>
                    <li>ä¾‹: Jacobiæ³•ã€Gauss-Seidelæ³•ã€SORæ³•ã€å…±å½¹å‹¾é…æ³•</li>
                    <li>åå¾©1å›ã®è¨ˆç®—é‡: \( O(n^2) \) ã¾ãŸã¯ \( O(\text{nnz}) \)ï¼ˆç–è¡Œåˆ—ï¼‰</li>
                    <li>å¤§è¦æ¨¡ãƒ»ç–è¡Œåˆ—å•é¡Œï¼ˆ\( n \gtrsim 10^5 \)ï¼‰ã«é©ã™ã‚‹</li>
                </ul>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: Gaussæ¶ˆå»æ³•ã®å®Ÿè£…</h3>
            <div class="code-example"><code>import numpy as np

def gaussian_elimination(A, b):
    """
    Gaussæ¶ˆå»æ³•ã«ã‚ˆã‚‹é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã®æ±‚è§£

    Parameters:
    -----------
    A : ndarray (n, n)
        ä¿‚æ•°è¡Œåˆ—
    b : ndarray (n,)
        å³è¾ºãƒ™ã‚¯ãƒˆãƒ«

    Returns:
    --------
    x : ndarray (n,)
        è§£ãƒ™ã‚¯ãƒˆãƒ«
    """
    n = len(b)
    # æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—ã®ä½œæˆï¼ˆå…ƒã®è¡Œåˆ—ã‚’å¤‰æ›´ã—ãªã„ã‚ˆã†ã‚³ãƒ”ãƒ¼ï¼‰
    Ab = np.hstack([A.astype(float), b.reshape(-1, 1)])

    # å‰é€²æ¶ˆå» (Forward Elimination)
    for k in range(n - 1):
        # ãƒ”ãƒœãƒƒãƒˆé¸æŠï¼ˆéƒ¨åˆ†ãƒ”ãƒœãƒƒãƒˆé¸æŠï¼‰
        max_row = np.argmax(np.abs(Ab[k:n, k])) + k
        if max_row != k:
            Ab[[k, max_row]] = Ab[[max_row, k]]

        # kåˆ—ç›®ã®æ¶ˆå»
        for i in range(k + 1, n):
            if Ab[k, k] == 0:
                raise ValueError("ã‚¼ãƒ­ãƒ”ãƒœãƒƒãƒˆãŒç™ºç”Ÿã—ã¾ã—ãŸ")
            factor = Ab[i, k] / Ab[k, k]
            Ab[i, k:] -= factor * Ab[k, k:]

    # å¾Œé€€ä»£å…¥ (Back Substitution)
    x = np.zeros(n)
    for i in range(n - 1, -1, -1):
        x[i] = (Ab[i, -1] - np.dot(Ab[i, i+1:n], x[i+1:n])) / Ab[i, i]

    return x

# ãƒ†ã‚¹ãƒˆ: 3æ¬¡å…ƒé€£ç«‹æ–¹ç¨‹å¼
A = np.array([
    [3, -1, 2],
    [1, 2, 3],
    [2, -2, -1]
], dtype=float)

b = np.array([12, 11, 2], dtype=float)

print("=" * 60)
print("Gaussæ¶ˆå»æ³•ã«ã‚ˆã‚‹é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã®æ±‚è§£")
print("=" * 60)

print("\nä¿‚æ•°è¡Œåˆ— A:")
print(A)
print("\nå³è¾ºãƒ™ã‚¯ãƒˆãƒ« b:")
print(b)

# Gaussæ¶ˆå»æ³•ã§è§£ã
x_gauss = gaussian_elimination(A, b)

print("\nè§£ x (Gaussæ¶ˆå»æ³•):")
print(x_gauss)

# NumPyã®è§£ã¨æ¯”è¼ƒ
x_numpy = np.linalg.solve(A, b)
print("\nè§£ x (NumPy):")
print(x_numpy)

# æ¤œè¨¼: Ax = b
residual = A @ x_gauss - b
print(f"\næ®‹å·® ||Ax - b||: {np.linalg.norm(residual):.2e}")

# ç²¾åº¦æ¤œè¨¼
print(f"NumPyã¨ã®å·®: {np.linalg.norm(x_gauss - x_numpy):.2e}")
</code></div>

            <div class="output-box">============================================================
Gaussæ¶ˆå»æ³•ã«ã‚ˆã‚‹é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã®æ±‚è§£
============================================================

ä¿‚æ•°è¡Œåˆ— A:
[[ 3. -1.  2.]
 [ 1.  2.  3.]
 [ 2. -2. -1.]]

å³è¾ºãƒ™ã‚¯ãƒˆãƒ« b:
[12. 11.  2.]

è§£ x (Gaussæ¶ˆå»æ³•):
[3. 1. 2.]

è§£ x (NumPy):
[3. 1. 2.]

æ®‹å·® ||Ax - b||: 1.78e-15

NumPyã¨ã®å·®: 0.00e+00</div>

        </section>

        <section class="content-section">
            <h2>2.2 LUåˆ†è§£</h2>
            <p>
                LUåˆ†è§£ã¯ã€è¡Œåˆ— \( A \) ã‚’ä¸‹ä¸‰è§’è¡Œåˆ— \( L \) ã¨ä¸Šä¸‰è§’è¡Œåˆ— \( U \) ã®ç©ã«åˆ†è§£ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚ä¸€åº¦åˆ†è§£ã™ã‚Œã°ã€ç•°ãªã‚‹å³è¾º \( b \) ã«å¯¾ã—ã¦åŠ¹ç‡çš„ã«è§£ã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: LUåˆ†è§£ã®åŸç†</h3>
                <p>
                    \( A = LU \) ã¨åˆ†è§£ã™ã‚‹ã¨ã€\( Ax = b \) ã¯æ¬¡ã®2æ®µéšã§è§£ã‘ã¾ã™:
                </p>
                \[
                \begin{aligned}
                Ly &= b \quad \text{(å‰é€²ä»£å…¥)} \\
                Ux &= y \quad \text{(å¾Œé€€ä»£å…¥)}
                \end{aligned}
                \]
                <p>
                    è¨ˆç®—é‡: åˆ†è§£ \( O(n^3) \)ã€å„æ±‚è§£ \( O(n^2) \)ã€‚è¤‡æ•°ã®å³è¾ºãŒã‚ã‚‹å ´åˆã«åŠ¹ç‡çš„ã§ã™ã€‚
                </p>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: LUåˆ†è§£ã®å®Ÿè£…</h3>
            <div class="code-example"><code>def lu_decomposition(A):
    """
    LUåˆ†è§£ï¼ˆDoolittleæ³•ï¼‰

    Parameters:
    -----------
    A : ndarray (n, n)
        ä¿‚æ•°è¡Œåˆ—

    Returns:
    --------
    L : ndarray (n, n)
        ä¸‹ä¸‰è§’è¡Œåˆ—
    U : ndarray (n, n)
        ä¸Šä¸‰è§’è¡Œåˆ—
    """
    n = A.shape[0]
    L = np.eye(n)
    U = np.zeros((n, n))

    for i in range(n):
        # U ã® i è¡Œç›®ã‚’è¨ˆç®—
        for j in range(i, n):
            U[i, j] = A[i, j] - np.dot(L[i, :i], U[:i, j])

        # L ã® i åˆ—ç›®ã‚’è¨ˆç®—
        for j in range(i + 1, n):
            L[j, i] = (A[j, i] - np.dot(L[j, :i], U[:i, i])) / U[i, i]

    return L, U

def solve_lu(L, U, b):
    """
    LUåˆ†è§£ã‚’ä½¿ã£ãŸæ–¹ç¨‹å¼ã®æ±‚è§£

    Parameters:
    -----------
    L, U : ndarray
        LUåˆ†è§£ã•ã‚ŒãŸè¡Œåˆ—
    b : ndarray
        å³è¾ºãƒ™ã‚¯ãƒˆãƒ«

    Returns:
    --------
    x : ndarray
        è§£ãƒ™ã‚¯ãƒˆãƒ«
    """
    n = len(b)

    # å‰é€²ä»£å…¥: Ly = b
    y = np.zeros(n)
    for i in range(n):
        y[i] = b[i] - np.dot(L[i, :i], y[:i])

    # å¾Œé€€ä»£å…¥: Ux = y
    x = np.zeros(n)
    for i in range(n - 1, -1, -1):
        x[i] = (y[i] - np.dot(U[i, i+1:], x[i+1:])) / U[i, i]

    return x

# ãƒ†ã‚¹ãƒˆ
A = np.array([
    [4, 3, 0],
    [3, 4, -1],
    [0, -1, 4]
], dtype=float)

b1 = np.array([24, 30, -24], dtype=float)
b2 = np.array([1, 2, 3], dtype=float)

print("=" * 60)
print("LUåˆ†è§£ã«ã‚ˆã‚‹é€£ç«‹æ–¹ç¨‹å¼ã®æ±‚è§£")
print("=" * 60)

print("\nä¿‚æ•°è¡Œåˆ— A:")
print(A)

# LUåˆ†è§£
L, U = lu_decomposition(A)

print("\nä¸‹ä¸‰è§’è¡Œåˆ— L:")
print(L)
print("\nä¸Šä¸‰è§’è¡Œåˆ— U:")
print(U)

# LU ã®ç©ã‚’æ¤œè¨¼
print("\nLU ã®ç©ï¼ˆå…ƒã®è¡Œåˆ—ã¨ä¸€è‡´ã™ã‚‹ã¯ãšï¼‰:")
print(L @ U)
print(f"||A - LU||: {np.linalg.norm(A - L @ U):.2e}")

# è¤‡æ•°ã®å³è¾ºã«å¯¾ã—ã¦è§£ã
print("\n" + "=" * 60)
print("è¤‡æ•°ã®å³è¾ºãƒ™ã‚¯ãƒˆãƒ«ã«å¯¾ã™ã‚‹æ±‚è§£")
print("=" * 60)

x1 = solve_lu(L, U, b1)
print(f"\nb1 = {b1}")
print(f"è§£ x1 = {x1}")
print(f"æ®‹å·®: {np.linalg.norm(A @ x1 - b1):.2e}")

x2 = solve_lu(L, U, b2)
print(f"\nb2 = {b2}")
print(f"è§£ x2 = {x2}")
print(f"æ®‹å·®: {np.linalg.norm(A @ x2 - b2):.2e}")

# SciPyã®LUåˆ†è§£ã¨æ¯”è¼ƒ
from scipy.linalg import lu

P, L_scipy, U_scipy = lu(A)
print("\n" + "=" * 60)
print("SciPy ã® LUåˆ†è§£ã¨ã®æ¯”è¼ƒ")
print("=" * 60)
print(f"||L - L_scipy||: {np.linalg.norm(L - L_scipy):.2e}")
print(f"||U - U_scipy||: {np.linalg.norm(U - U_scipy):.2e}")
</code></div>

            <div class="output-box">============================================================
LUåˆ†è§£ã«ã‚ˆã‚‹é€£ç«‹æ–¹ç¨‹å¼ã®æ±‚è§£
============================================================

ä¿‚æ•°è¡Œåˆ— A:
[[ 4.  3.  0.]
 [ 3.  4. -1.]
 [ 0. -1.  4.]]

ä¸‹ä¸‰è§’è¡Œåˆ— L:
[[ 1.     0.     0.   ]
 [ 0.75   1.     0.   ]
 [ 0.    -0.571  1.   ]]

ä¸Šä¸‰è§’è¡Œåˆ— U:
[[ 4.     3.     0.   ]
 [ 0.     1.75  -1.   ]
 [ 0.     0.     3.429]]

LU ã®ç©(å…ƒã®è¡Œåˆ—ã¨ä¸€è‡´ã™ã‚‹ã¯ãš):
[[ 4.  3.  0.]
 [ 3.  4. -1.]
 [ 0. -1.  4.]]
||A - LU||: 4.44e-16

============================================================
è¤‡æ•°ã®å³è¾ºãƒ™ã‚¯ãƒˆãƒ«ã«å¯¾ã™ã‚‹æ±‚è§£
============================================================

b1 = [ 24.  30. -24.]
è§£ x1 = [ 3.  4. -5.]
æ®‹å·®: 3.20e-14

b2 = [1. 2. 3.]
è§£ x2 = [-1.071  1.286  1.143]
æ®‹å·®: 1.78e-15

============================================================
SciPy ã® LUåˆ†è§£ã¨ã®æ¯”è¼ƒ
============================================================
||L - L_scipy||: 2.22e-16
||U - U_scipy||: 0.00e+00</div>

        </section>

        <section class="content-section">
            <h2>2.3 åå¾©æ³•ã®åŸºç¤ - Jacobiæ³•</h2>
            <p>
                åå¾©æ³•ã¯åˆæœŸå€¤ã‹ã‚‰å‡ºç™ºã—ã€é€æ¬¡çš„ã«è§£ã«è¿‘ã¥ã‘ã¦ã„ãæ‰‹æ³•ã§ã™ã€‚å¤§è¦æ¨¡ãƒ»ç–è¡Œåˆ—å•é¡Œã§ã¯ç›´æ¥æ³•ã‚ˆã‚ŠåŠ¹ç‡çš„ã§ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: Jacobiæ³•ã®åŸç†</h3>
                <p>
                    \( A \) ã‚’å¯¾è§’æˆåˆ† \( D \)ã€ä¸‹ä¸‰è§’éƒ¨ \( L \)ã€ä¸Šä¸‰è§’éƒ¨ \( U \) ã«åˆ†è§£:
                </p>
                \[
                A = D + L + U
                \]
                <p>
                    Jacobiæ³•ã®åå¾©å¼:
                </p>
                \[
                x^{(k+1)} = D^{-1}(b - (L + U)x^{(k)})
                \]
                <p>
                    æˆåˆ†ã”ã¨ã«ã¯:
                </p>
                \[
                x_i^{(k+1)} = \frac{1}{a_{ii}} \left( b_i - \sum_{j \neq i} a_{ij} x_j^{(k)} \right)
                \]
                <p>
                    åæŸæ¡ä»¶: \( A \) ãŒå¯¾è§’å„ªä½ã§ã‚ã‚Œã°åæŸãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚
                </p>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: Jacobiæ³•ã®å®Ÿè£…</h3>
            <div class="code-example"><code>def jacobi_method(A, b, x0=None, max_iter=1000, tol=1e-10):
    """
    Jacobiæ³•ã«ã‚ˆã‚‹åå¾©æ±‚è§£

    Parameters:
    -----------
    A : ndarray (n, n)
        ä¿‚æ•°è¡Œåˆ—
    b : ndarray (n,)
        å³è¾ºãƒ™ã‚¯ãƒˆãƒ«
    x0 : ndarray (n,), optional
        åˆæœŸå€¤ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: ã‚¼ãƒ­ãƒ™ã‚¯ãƒˆãƒ«ï¼‰
    max_iter : int
        æœ€å¤§åå¾©å›æ•°
    tol : float
        åæŸåˆ¤å®šã®é–¾å€¤

    Returns:
    --------
    x : ndarray (n,)
        è§£ãƒ™ã‚¯ãƒˆãƒ«
    history : list
        å„åå¾©ã§ã®æ®‹å·®ãƒãƒ«ãƒ 
    """
    n = len(b)
    x = np.zeros(n) if x0 is None else x0.copy()
    x_new = np.zeros(n)
    history = []

    for k in range(max_iter):
        for i in range(n):
            # x_i ã®æ›´æ–°ï¼ˆä»–ã®æˆåˆ†ã¯å‰å›ã®å€¤ã‚’ä½¿ç”¨ï¼‰
            sigma = np.dot(A[i, :], x) - A[i, i] * x[i]
            x_new[i] = (b[i] - sigma) / A[i, i]

        # æ®‹å·®ã®è¨ˆç®—
        residual = np.linalg.norm(A @ x_new - b)
        history.append(residual)

        # åæŸåˆ¤å®š
        if residual < tol:
            print(f"Jacobiæ³•: {k+1}å›ã®åå¾©ã§åæŸ")
            return x_new, history

        x = x_new.copy()

    print(f"Jacobiæ³•: {max_iter}å›ã®åå¾©ã§åæŸã›ãšï¼ˆæ®‹å·®: {residual:.2e}ï¼‰")
    return x_new, history

# ãƒ†ã‚¹ãƒˆ: å¯¾è§’å„ªä½ãªè¡Œåˆ—
A = np.array([
    [10, -1, 2, 0],
    [-1, 11, -1, 3],
    [2, -1, 10, -1],
    [0, 3, -1, 8]
], dtype=float)

b = np.array([6, 25, -11, 15], dtype=float)

print("=" * 60)
print("Jacobiæ³•ã«ã‚ˆã‚‹åå¾©æ±‚è§£")
print("=" * 60)

print("\nä¿‚æ•°è¡Œåˆ— A:")
print(A)
print("\nå³è¾ºãƒ™ã‚¯ãƒˆãƒ« b:")
print(b)

# å¯¾è§’å„ªä½æ€§ã®ç¢ºèª
print("\nå¯¾è§’å„ªä½æ€§ã®ç¢ºèª:")
for i in range(len(A)):
    diag = abs(A[i, i])
    off_diag_sum = np.sum(np.abs(A[i, :])) - diag
    print(f"  è¡Œ{i+1}: |a_{i+1}{i+1}| = {diag:.1f} {'>' if diag > off_diag_sum else '<='} "
          f"Î£|a_{i+1}j| = {off_diag_sum:.1f} {'(å¯¾è§’å„ªä½)' if diag > off_diag_sum else ''}")

# Jacobiæ³•ã§è§£ã
x_jacobi, history_jacobi = jacobi_method(A, b, tol=1e-10)

print(f"\nè§£ x (Jacobiæ³•):")
print(x_jacobi)

# å³å¯†è§£ã¨æ¯”è¼ƒ
x_exact = np.linalg.solve(A, b)
print(f"\nè§£ x (å³å¯†è§£):")
print(x_exact)

print(f"\nèª¤å·®: {np.linalg.norm(x_jacobi - x_exact):.2e}")
print(f"æ®‹å·®: {np.linalg.norm(A @ x_jacobi - b):.2e}")

# åæŸå±¥æ­´ã®å¯è¦–åŒ–
import matplotlib.pyplot as plt

plt.figure(figsize=(10, 6))
plt.semilogy(history_jacobi, 'o-', linewidth=2, markersize=6)
plt.xlabel('åå¾©å›æ•°', fontsize=12)
plt.ylabel('æ®‹å·®ãƒãƒ«ãƒ  ||Ax - b||', fontsize=12)
plt.title('Jacobiæ³•ã®åæŸå±¥æ­´', fontsize=14)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('jacobi_convergence.png', dpi=150, bbox_inches='tight')
plt.show()

print(f"\nåæŸã«è¦ã—ãŸåå¾©å›æ•°: {len(history_jacobi)}")
</code></div>

            <div class="output-box">============================================================
Jacobiæ³•ã«ã‚ˆã‚‹åå¾©æ±‚è§£
============================================================

ä¿‚æ•°è¡Œåˆ— A:
[[10. -1.  2.  0.]
 [-1. 11. -1.  3.]
 [ 2. -1. 10. -1.]
 [ 0.  3. -1.  8.]]

å³è¾ºãƒ™ã‚¯ãƒˆãƒ« b:
[  6.  25. -11.  15.]

å¯¾è§’å„ªä½æ€§ã®ç¢ºèª:
  è¡Œ1: |a_11| = 10.0 > Î£|a_1j| = 3.0 (å¯¾è§’å„ªä½)
  è¡Œ2: |a_22| = 11.0 > Î£|a_2j| = 5.0 (å¯¾è§’å„ªä½)
  è¡Œ3: |a_33| = 10.0 > Î£|a_3j| = 4.0 (å¯¾è§’å„ªä½)
  è¡Œ4: |a_44| = 8.0 > Î£|a_4j| = 4.0 (å¯¾è§’å„ªä½)

Jacobiæ³•: 25å›ã®åå¾©ã§åæŸ

è§£ x (Jacobiæ³•):
[ 1.  2. -1.  1.]

è§£ x (å³å¯†è§£):
[ 1.  2. -1.  1.]

èª¤å·®: 5.45e-11
æ®‹å·®: 6.22e-11

åæŸã«è¦ã—ãŸåå¾©å›æ•°: 25</div>

        </section>

        <section class="content-section">
            <h2>2.4 Gauss-Seidelæ³•ã¨SORæ³•</h2>
            <p>
                Gauss-Seidelæ³•ã¯Jacobiæ³•ã‚’æ”¹è‰¯ã—ã€æ›´æ–°ã•ã‚ŒãŸå€¤ã‚’ã™ãã«ä½¿ã†ã“ã¨ã§åæŸã‚’é«˜é€ŸåŒ–ã—ã¾ã™ã€‚SORæ³•ã¯ã•ã‚‰ã«ç·©å’Œä¿‚æ•°ã‚’å°å…¥ã—ã¦åæŸã‚’åŠ é€Ÿã—ã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: Gauss-Seidelæ³•ã¨SORæ³•</h3>
                <p><strong>Gauss-Seidelæ³•:</strong></p>
                \[
                x_i^{(k+1)} = \frac{1}{a_{ii}} \left( b_i - \sum_{j < i} a_{ij} x_j^{(k+1)} - \sum_{j > i} a_{ij} x_j^{(k)} \right)
                \]
                <p>
                    æ›´æ–°æ¸ˆã¿ã® \( x_j^{(k+1)} \) ã‚’ã™ãã«ä½¿ç”¨ã™ã‚‹ãŸã‚ã€Jacobiæ³•ã‚ˆã‚ŠåæŸãŒé€Ÿã„ã“ã¨ãŒå¤šã„ã§ã™ã€‚
                </p>

                <p><strong>SORæ³• (Successive Over-Relaxation):</strong></p>
                \[
                x_i^{(k+1)} = (1 - \omega) x_i^{(k)} + \frac{\omega}{a_{ii}} \left( b_i - \sum_{j < i} a_{ij} x_j^{(k+1)} - \sum_{j > i} a_{ij} x_j^{(k)} \right)
                \]
                <p>
                    ç·©å’Œä¿‚æ•° \( \omega \) ã®æœ€é©å€¤ã¯å•é¡Œä¾å­˜ã§ã™ãŒã€é€šå¸¸ \( 1 < \omega < 2 \) ã§æœ€é€ŸåæŸã—ã¾ã™ã€‚
                </p>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: Gauss-Seidelæ³•ã®å®Ÿè£…</h3>
            <div class="code-example"><code>def gauss_seidel_method(A, b, x0=None, max_iter=1000, tol=1e-10):
    """
    Gauss-Seidelæ³•ã«ã‚ˆã‚‹åå¾©æ±‚è§£

    Parameters:
    -----------
    A : ndarray (n, n)
        ä¿‚æ•°è¡Œåˆ—
    b : ndarray (n,)
        å³è¾ºãƒ™ã‚¯ãƒˆãƒ«
    x0 : ndarray (n,), optional
        åˆæœŸå€¤
    max_iter : int
        æœ€å¤§åå¾©å›æ•°
    tol : float
        åæŸåˆ¤å®šã®é–¾å€¤

    Returns:
    --------
    x : ndarray (n,)
        è§£ãƒ™ã‚¯ãƒˆãƒ«
    history : list
        å„åå¾©ã§ã®æ®‹å·®ãƒãƒ«ãƒ 
    """
    n = len(b)
    x = np.zeros(n) if x0 is None else x0.copy()
    history = []

    for k in range(max_iter):
        x_old = x.copy()

        for i in range(n):
            # æ›´æ–°æ¸ˆã¿ã®å€¤ã‚’ã™ãã«ä½¿ç”¨
            sigma = np.dot(A[i, :i], x[:i]) + np.dot(A[i, i+1:], x[i+1:])
            x[i] = (b[i] - sigma) / A[i, i]

        # æ®‹å·®ã®è¨ˆç®—
        residual = np.linalg.norm(A @ x - b)
        history.append(residual)

        # åæŸåˆ¤å®š
        if residual < tol:
            print(f"Gauss-Seidelæ³•: {k+1}å›ã®åå¾©ã§åæŸ")
            return x, history

    print(f"Gauss-Seidelæ³•: {max_iter}å›ã®åå¾©ã§åæŸã›ãšï¼ˆæ®‹å·®: {residual:.2e}ï¼‰")
    return x, history

# åŒã˜å•é¡Œã§Jacobiæ³•ã¨æ¯”è¼ƒ
A = np.array([
    [10, -1, 2, 0],
    [-1, 11, -1, 3],
    [2, -1, 10, -1],
    [0, 3, -1, 8]
], dtype=float)

b = np.array([6, 25, -11, 15], dtype=float)

print("=" * 60)
print("Jacobiæ³• vs Gauss-Seidelæ³•ã®æ¯”è¼ƒ")
print("=" * 60)

# Jacobiæ³•
x_jacobi, history_jacobi = jacobi_method(A, b, tol=1e-10)

# Gauss-Seidelæ³•
x_gs, history_gs = gauss_seidel_method(A, b, tol=1e-10)

# çµæœã®æ¯”è¼ƒ
print(f"\nJacobiæ³•:")
print(f"  åå¾©å›æ•°: {len(history_jacobi)}")
print(f"  è§£: {x_jacobi}")

print(f"\nGauss-Seidelæ³•:")
print(f"  åå¾©å›æ•°: {len(history_gs)}")
print(f"  è§£: {x_gs}")

# åæŸé€Ÿåº¦ã®æ¯”è¼ƒ
plt.figure(figsize=(10, 6))
plt.semilogy(history_jacobi, 'o-', label='Jacobiæ³•', linewidth=2, markersize=6)
plt.semilogy(history_gs, 's-', label='Gauss-Seidelæ³•', linewidth=2, markersize=6)
plt.xlabel('åå¾©å›æ•°', fontsize=12)
plt.ylabel('æ®‹å·®ãƒãƒ«ãƒ  ||Ax - b||', fontsize=12)
plt.title('Jacobiæ³•ã¨Gauss-Seidelæ³•ã®åæŸé€Ÿåº¦æ¯”è¼ƒ', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('jacobi_vs_gauss_seidel.png', dpi=150, bbox_inches='tight')
plt.show()

print(f"\né«˜é€ŸåŒ–ç‡: {len(history_jacobi) / len(history_gs):.2f}å€")
</code></div>

            <div class="output-box">============================================================
Jacobiæ³• vs Gauss-Seidelæ³•ã®æ¯”è¼ƒ
============================================================
Jacobiæ³•: 25å›ã®åå¾©ã§åæŸ
Gauss-Seidelæ³•: 13å›ã®åå¾©ã§åæŸ

Jacobiæ³•:
  åå¾©å›æ•°: 25
  è§£: [ 1.  2. -1.  1.]

Gauss-Seidelæ³•:
  åå¾©å›æ•°: 13
  è§£: [ 1.  2. -1.  1.]

é«˜é€ŸåŒ–ç‡: 1.92å€</div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: SORæ³•ã®å®Ÿè£…ã¨æœ€é©ç·©å’Œä¿‚æ•°</h3>
            <div class="code-example"><code>def sor_method(A, b, omega, x0=None, max_iter=1000, tol=1e-10):
    """
    SORæ³•ã«ã‚ˆã‚‹åå¾©æ±‚è§£

    Parameters:
    -----------
    A : ndarray (n, n)
        ä¿‚æ•°è¡Œåˆ—
    b : ndarray (n,)
        å³è¾ºãƒ™ã‚¯ãƒˆãƒ«
    omega : float
        ç·©å’Œä¿‚æ•° (1 < omega < 2 ãŒæ¨å¥¨)
    x0 : ndarray (n,), optional
        åˆæœŸå€¤
    max_iter : int
        æœ€å¤§åå¾©å›æ•°
    tol : float
        åæŸåˆ¤å®šã®é–¾å€¤

    Returns:
    --------
    x : ndarray (n,)
        è§£ãƒ™ã‚¯ãƒˆãƒ«
    history : list
        å„åå¾©ã§ã®æ®‹å·®ãƒãƒ«ãƒ 
    """
    n = len(b)
    x = np.zeros(n) if x0 is None else x0.copy()
    history = []

    for k in range(max_iter):
        for i in range(n):
            sigma = np.dot(A[i, :i], x[:i]) + np.dot(A[i, i+1:], x[i+1:])
            x_gs = (b[i] - sigma) / A[i, i]
            # SORæ›´æ–°: ç·©å’Œä¿‚æ•°ã‚’é©ç”¨
            x[i] = (1 - omega) * x[i] + omega * x_gs

        residual = np.linalg.norm(A @ x - b)
        history.append(residual)

        if residual < tol:
            return x, history

    return x, history

# æœ€é©ç·©å’Œä¿‚æ•°ã®æ¢ç´¢
omega_values = np.linspace(1.0, 1.9, 19)
iterations = []

print("=" * 60)
print("SORæ³•: æœ€é©ç·©å’Œä¿‚æ•°ã®æ¢ç´¢")
print("=" * 60)

for omega in omega_values:
    x_sor, history_sor = sor_method(A, b, omega, tol=1e-10, max_iter=1000)
    iterations.append(len(history_sor))

# çµæœã®å¯è¦–åŒ–
plt.figure(figsize=(12, 5))

# å·¦å›³: ç·©å’Œä¿‚æ•°ã¨åå¾©å›æ•°ã®é–¢ä¿‚
plt.subplot(1, 2, 1)
plt.plot(omega_values, iterations, 'o-', linewidth=2, markersize=8)
plt.axvline(x=1.0, color='gray', linestyle='--', alpha=0.5, label='Gauss-Seidel (Ï‰=1)')
optimal_omega = omega_values[np.argmin(iterations)]
plt.axvline(x=optimal_omega, color='red', linestyle='--', alpha=0.7, label=f'æœ€é© Ï‰={optimal_omega:.2f}')
plt.xlabel('ç·©å’Œä¿‚æ•° Ï‰', fontsize=12)
plt.ylabel('åæŸã¾ã§ã®åå¾©å›æ•°', fontsize=12)
plt.title('SORæ³•: ç·©å’Œä¿‚æ•°ã®å½±éŸ¿', fontsize=14)
plt.legend(fontsize=10)
plt.grid(True, alpha=0.3)

# å³å›³: ç•°ãªã‚‹Ï‰ã§ã®åæŸå±¥æ­´
plt.subplot(1, 2, 2)
omega_test = [1.0, 1.2, optimal_omega, 1.8]
for omega in omega_test:
    _, history = sor_method(A, b, omega, tol=1e-10)
    label = f'Ï‰={omega:.2f}'
    if omega == 1.0:
        label += ' (Gauss-Seidel)'
    plt.semilogy(history, linewidth=2, label=label)
plt.xlabel('åå¾©å›æ•°', fontsize=12)
plt.ylabel('æ®‹å·®ãƒãƒ«ãƒ ', fontsize=12)
plt.title('ç•°ãªã‚‹ç·©å’Œä¿‚æ•°ã§ã®åæŸé€Ÿåº¦', fontsize=14)
plt.legend(fontsize=10)
plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('sor_optimization.png', dpi=150, bbox_inches='tight')
plt.show()

print(f"\næœ€é©ç·©å’Œä¿‚æ•°: Ï‰ = {optimal_omega:.2f}")
print(f"æœ€å°åå¾©å›æ•°: {min(iterations)}")
print(f"Gauss-Seidel (Ï‰=1.0): {iterations[0]} å›")
print(f"é«˜é€ŸåŒ–ç‡: {iterations[0] / min(iterations):.2f}å€")
</code></div>

            <div class="output-box">============================================================
SORæ³•: æœ€é©ç·©å’Œä¿‚æ•°ã®æ¢ç´¢
============================================================

æœ€é©ç·©å’Œä¿‚æ•°: Ï‰ = 1.25
æœ€å°åå¾©å›æ•°: 9
Gauss-Seidel (Ï‰=1.0): 13 å›
é«˜é€ŸåŒ–ç‡: 1.44å€</div>

        </section>

        <section class="content-section">
            <h2>2.5 ç–è¡Œåˆ—ã®æ‰±ã„</h2>
            <p>
                æœ‰é™è¦ç´ æ³•ã‚„æœ‰é™å·®åˆ†æ³•ã§ç”Ÿã˜ã‚‹è¡Œåˆ—ã¯ã€å¤šãã®è¦ç´ ãŒã‚¼ãƒ­ã§ã‚ã‚‹ç–è¡Œåˆ—ï¼ˆsparse matrixï¼‰ã§ã™ã€‚SciPyã®ç–è¡Œåˆ—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã“ã¨ã§ã€ãƒ¡ãƒ¢ãƒªã¨è¨ˆç®—æ™‚é–“ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚
            </p>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: SciPyç–è¡Œåˆ—ã‚½ãƒ«ãƒãƒ¼</h3>
            <div class="code-example"><code>from scipy.sparse import diags, csr_matrix
from scipy.sparse.linalg import spsolve, cg, gmres
import time

def create_laplacian_matrix(n):
    """
    1æ¬¡å…ƒLaplacianè¡Œåˆ—ã®ç”Ÿæˆï¼ˆæœ‰é™å·®åˆ†æ³•ï¼‰
    -u''(x) = f(x) ã®é›¢æ•£åŒ–ã«å¯¾å¿œ

    Parameters:
    -----------
    n : int
        æ ¼å­ç‚¹æ•°

    Returns:
    --------
    A : sparse matrix
        (n-2) x (n-2) ã®ä¸‰é‡å¯¾è§’è¡Œåˆ—
    """
    # ä¸‰é‡å¯¾è§’è¦ç´ 
    main_diag = 2 * np.ones(n - 2)
    off_diag = -1 * np.ones(n - 3)

    # ç–è¡Œåˆ—ã®ç”Ÿæˆ
    A = diags([off_diag, main_diag, off_diag], [-1, 0, 1], format='csr')

    return A

# å•é¡Œã‚µã‚¤ã‚º
n = 1000
print("=" * 60)
print(f"ç–è¡Œåˆ—ã‚½ãƒ«ãƒãƒ¼ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ (å•é¡Œã‚µã‚¤ã‚º: {n}x{n})")
print("=" * 60)

# Laplacianè¡Œåˆ—ã®ç”Ÿæˆ
A_sparse = create_laplacian_matrix(n)
A_dense = A_sparse.toarray()

# å³è¾ºãƒ™ã‚¯ãƒˆãƒ«
b = np.ones(n - 2)

print(f"\nè¡Œåˆ—ã®éã‚¼ãƒ­è¦ç´ æ•°: {A_sparse.nnz}")
print(f"è¡Œåˆ—ã®å…¨è¦ç´ æ•°: {(n-2)**2}")
print(f"ç–ç‡: {A_sparse.nnz / (n-2)**2 * 100:.2f}%")

# ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æ¯”è¼ƒ
memory_sparse = A_sparse.data.nbytes + A_sparse.indices.nbytes + A_sparse.indptr.nbytes
memory_dense = A_dense.nbytes
print(f"\nãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡:")
print(f"  ç–è¡Œåˆ—å½¢å¼: {memory_sparse / 1024:.2f} KB")
print(f"  å¯†è¡Œåˆ—å½¢å¼: {memory_dense / 1024:.2f} KB")
print(f"  å‰Šæ¸›ç‡: {(1 - memory_sparse / memory_dense) * 100:.1f}%")

# 1. ç–è¡Œåˆ—ç›´æ¥æ³• (spsolve)
print("\n" + "=" * 60)
print("1. ç–è¡Œåˆ—ç›´æ¥æ³• (spsolve)")
print("=" * 60)
start = time.time()
x_sparse = spsolve(A_sparse, b)
time_sparse = time.time() - start
print(f"è¨ˆç®—æ™‚é–“: {time_sparse * 1000:.2f} ms")
print(f"æ®‹å·®: {np.linalg.norm(A_sparse @ x_sparse - b):.2e}")

# 2. å¯†è¡Œåˆ—ç›´æ¥æ³• (np.linalg.solve)
print("\n" + "=" * 60)
print("2. å¯†è¡Œåˆ—ç›´æ¥æ³• (np.linalg.solve)")
print("=" * 60)
start = time.time()
x_dense = np.linalg.solve(A_dense, b)
time_dense = time.time() - start
print(f"è¨ˆç®—æ™‚é–“: {time_dense * 1000:.2f} ms")
print(f"æ®‹å·®: {np.linalg.norm(A_dense @ x_dense - b):.2e}")

print(f"\né«˜é€ŸåŒ–ç‡: {time_dense / time_sparse:.2f}å€")

# 3. å…±å½¹å‹¾é…æ³• (CGæ³• - å¯¾ç§°æ­£å®šå€¤è¡Œåˆ—ç”¨)
print("\n" + "=" * 60)
print("3. å…±å½¹å‹¾é…æ³• (CGæ³•)")
print("=" * 60)
start = time.time()
x_cg, info = cg(A_sparse, b, tol=1e-10)
time_cg = time.time() - start
print(f"è¨ˆç®—æ™‚é–“: {time_cg * 1000:.2f} ms")
print(f"åæŸæƒ…å ±: {info} (0ãªã‚‰æˆåŠŸ)")
print(f"æ®‹å·®: {np.linalg.norm(A_sparse @ x_cg - b):.2e}")

# 4. GMRESæ³•ï¼ˆä¸€èˆ¬çš„ãªè¡Œåˆ—ç”¨ï¼‰
print("\n" + "=" * 60)
print("4. GMRESæ³•")
print("=" * 60)
start = time.time()
x_gmres, info = gmres(A_sparse, b, tol=1e-10)
time_gmres = time.time() - start
print(f"è¨ˆç®—æ™‚é–“: {time_gmres * 1000:.2f} ms")
print(f"åæŸæƒ…å ±: {info} (0ãªã‚‰æˆåŠŸ)")
print(f"æ®‹å·®: {np.linalg.norm(A_sparse @ x_gmres - b):.2e}")

# æ€§èƒ½æ¯”è¼ƒã®å¯è¦–åŒ–
methods = ['ç–è¡Œåˆ—\nç›´æ¥æ³•', 'å¯†è¡Œåˆ—\nç›´æ¥æ³•', 'CGæ³•', 'GMRESæ³•']
times = [time_sparse * 1000, time_dense * 1000, time_cg * 1000, time_gmres * 1000]

plt.figure(figsize=(10, 6))
bars = plt.bar(methods, times, color=['#667eea', '#764ba2', '#48c774', '#3298dc'])
plt.ylabel('è¨ˆç®—æ™‚é–“ (ms)', fontsize=12)
plt.title(f'ç–è¡Œåˆ—ã‚½ãƒ«ãƒãƒ¼ã®æ€§èƒ½æ¯”è¼ƒ (è¡Œåˆ—ã‚µã‚¤ã‚º: {n-2}x{n-2})', fontsize=14)
plt.yscale('log')

# å„ãƒãƒ¼ã«å€¤ã‚’è¡¨ç¤º
for bar, time_val in zip(bars, times):
    height = bar.get_height()
    plt.text(bar.get_x() + bar.get_width()/2., height,
             f'{time_val:.2f}ms',
             ha='center', va='bottom', fontsize=10)

plt.grid(True, alpha=0.3, axis='y')
plt.tight_layout()
plt.savefig('sparse_solver_comparison.png', dpi=150, bbox_inches='tight')
plt.show()
</code></div>

            <div class="output-box">============================================================
ç–è¡Œåˆ—ã‚½ãƒ«ãƒãƒ¼ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ (å•é¡Œã‚µã‚¤ã‚º: 1000x1000)
============================================================

è¡Œåˆ—ã®éã‚¼ãƒ­è¦ç´ æ•°: 2994
è¡Œåˆ—ã®å…¨è¦ç´ æ•°: 998004
ç–ç‡: 0.30%

ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡:
  ç–è¡Œåˆ—å½¢å¼: 23.39 KB
  å¯†è¡Œåˆ—å½¢å¼: 7796.91 KB
  å‰Šæ¸›ç‡: 99.7%

============================================================
1. ç–è¡Œåˆ—ç›´æ¥æ³• (spsolve)
============================================================
è¨ˆç®—æ™‚é–“: 2.45 ms
æ®‹å·®: 1.58e-13

============================================================
2. å¯†è¡Œåˆ—ç›´æ¥æ³• (np.linalg.solve)
============================================================
è¨ˆç®—æ™‚é–“: 145.32 ms
æ®‹å·®: 2.84e-13

é«˜é€ŸåŒ–ç‡: 59.32å€

============================================================
3. å…±å½¹å‹¾é…æ³• (CGæ³•)
============================================================
è¨ˆç®—æ™‚é–“: 1.23 ms
åæŸæƒ…å ±: 0 (0ãªã‚‰æˆåŠŸ)
æ®‹å·®: 3.45e-11

============================================================
4. GMRESæ³•
============================================================
è¨ˆç®—æ™‚é–“: 2.87 ms
åæŸæƒ…å ±: 0 (0ãªã‚‰æˆåŠŸ)
æ®‹å·®: 4.21e-11</div>

        </section>

        <section class="content-section">
            <h2>2.6 æ¡ä»¶æ•°ã¨æ•°å€¤å®‰å®šæ€§</h2>
            <p>
                æ¡ä»¶æ•°ã¯è¡Œåˆ—ã®ã€Œè§£ãã«ãã•ã€ã‚’è¡¨ã™æŒ‡æ¨™ã§ã™ã€‚æ¡ä»¶æ•°ãŒå¤§ãã„ï¼ˆill-conditionedï¼‰è¡Œåˆ—ã§ã¯ã€ä¸¸ã‚èª¤å·®ãŒå¢—å¹…ã•ã‚Œã€æ•°å€¤è¨ˆç®—ã®ç²¾åº¦ãŒä½ä¸‹ã—ã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: æ¡ä»¶æ•°</h3>
                <p>
                    è¡Œåˆ— \( A \) ã®æ¡ä»¶æ•°ã¯æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™:
                </p>
                \[
                \kappa(A) = \|A\| \cdot \|A^{-1}\|
                \]
                <p>
                    æ¡ä»¶æ•°ã®è§£é‡ˆ:
                </p>
                <ul>
                    <li>\( \kappa(A) = 1 \): ç†æƒ³çš„ï¼ˆç›´äº¤è¡Œåˆ—ï¼‰</li>
                    <li>\( \kappa(A) < 10^3 \): è‰¯æ¡ä»¶</li>
                    <li>\( \kappa(A) > 10^6 \): æ‚ªæ¡ä»¶ï¼ˆæ³¨æ„ãŒå¿…è¦ï¼‰</li>
                    <li>\( \kappa(A) \to \infty \): ç‰¹ç•°è¡Œåˆ—ã«è¿‘ã„ï¼ˆæ•°å€¤è¨ˆç®—å›°é›£ï¼‰</li>
                </ul>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: æ¡ä»¶æ•°ã®è§£æã¨å‰å‡¦ç†</h3>
            <div class="code-example"><code>def create_hilbert_matrix(n):
    """
    Hilbertè¡Œåˆ—ã®ç”Ÿæˆï¼ˆæ‚ªæ¡ä»¶è¡Œåˆ—ã®å…¸å‹ä¾‹ï¼‰
    H[i,j] = 1/(i+j+1)
    """
    H = np.zeros((n, n))
    for i in range(n):
        for j in range(n):
            H[i, j] = 1.0 / (i + j + 1)
    return H

print("=" * 60)
print("æ¡ä»¶æ•°ã¨æ•°å€¤å®‰å®šæ€§ã®è§£æ")
print("=" * 60)

# 1. è‰¯æ¡ä»¶ãªè¡Œåˆ—
A_good = np.array([
    [4, 1],
    [1, 3]
], dtype=float)

# 2. æ‚ªæ¡ä»¶ãªè¡Œåˆ—ï¼ˆHilbertè¡Œåˆ—ï¼‰
n = 5
A_bad = create_hilbert_matrix(n)

# æ¡ä»¶æ•°ã®è¨ˆç®—
cond_good = np.linalg.cond(A_good)
cond_bad = np.linalg.cond(A_bad)

print("\n1. è‰¯æ¡ä»¶ãªè¡Œåˆ—:")
print(A_good)
print(f"æ¡ä»¶æ•°: {cond_good:.2e}")

print("\n2. æ‚ªæ¡ä»¶ãªè¡Œåˆ— (Hilbert 5x5):")
print(A_bad)
print(f"æ¡ä»¶æ•°: {cond_bad:.2e}")

# æ•°å€¤å®Ÿé¨“: å³è¾ºã‚’å¾®å°å¤‰åŒ–ã•ã›ãŸæ™‚ã®è§£ã®å¤‰åŒ–
print("\n" + "=" * 60)
print("æ•°å€¤å®Ÿé¨“: å³è¾ºã®æ‘‚å‹•ã«å¯¾ã™ã‚‹æ„Ÿåº¦")
print("=" * 60)

def test_sensitivity(A, name):
    """å³è¾ºã®å¾®å°å¤‰åŒ–ã«å¯¾ã™ã‚‹è§£ã®å¤‰åŒ–ã‚’èª¿ã¹ã‚‹"""
    n = A.shape[0]
    b = np.ones(n)
    x_exact = np.linalg.solve(A, b)

    # å³è¾ºã«1%ã®æ‘‚å‹•ã‚’åŠ ãˆã‚‹
    perturbation = 0.01
    b_perturbed = b * (1 + perturbation)
    x_perturbed = np.linalg.solve(A, b_perturbed)

    # è§£ã®ç›¸å¯¾å¤‰åŒ–
    relative_change = np.linalg.norm(x_perturbed - x_exact) / np.linalg.norm(x_exact)

    print(f"\n{name}:")
    print(f"  å³è¾ºã®ç›¸å¯¾å¤‰åŒ–: {perturbation * 100:.1f}%")
    print(f"  è§£ã®ç›¸å¯¾å¤‰åŒ–: {relative_change * 100:.2f}%")
    print(f"  å¢—å¹…ç‡: {relative_change / perturbation:.2f}å€")
    print(f"  ç†è«–ä¸Šé™ (æ¡ä»¶æ•°): {np.linalg.cond(A):.2e}")

test_sensitivity(A_good, "è‰¯æ¡ä»¶è¡Œåˆ—")
test_sensitivity(A_bad, "æ‚ªæ¡ä»¶è¡Œåˆ— (Hilbert)")

# æ§˜ã€…ãªã‚µã‚¤ã‚ºã®Hilbertè¡Œåˆ—ã®æ¡ä»¶æ•°
print("\n" + "=" * 60)
print("Hilbertè¡Œåˆ—ã®æ¡ä»¶æ•°ï¼ˆã‚µã‚¤ã‚ºä¾å­˜æ€§ï¼‰")
print("=" * 60)

sizes = range(2, 11)
condition_numbers = []

print("\nã‚µã‚¤ã‚º     æ¡ä»¶æ•°")
print("-" * 30)
for n in sizes:
    H = create_hilbert_matrix(n)
    cond = np.linalg.cond(H)
    condition_numbers.append(cond)
    print(f"{n:4d}      {cond:.2e}")

# å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
plt.semilogy(list(sizes), condition_numbers, 'o-', linewidth=2, markersize=8)
plt.axhline(y=1e3, color='green', linestyle='--', alpha=0.5, label='è‰¯æ¡ä»¶ã®ç›®å®‰ (10Â³)')
plt.axhline(y=1e6, color='orange', linestyle='--', alpha=0.5, label='æ‚ªæ¡ä»¶ã®ç›®å®‰ (10â¶)')
plt.axhline(y=1e12, color='red', linestyle='--', alpha=0.5, label='æ©Ÿæ¢°ç²¾åº¦ã®é™ç•Œ (10Â¹Â²)')
plt.xlabel('è¡Œåˆ—ã‚µã‚¤ã‚º n', fontsize=12)
plt.ylabel('æ¡ä»¶æ•° Îº(A)', fontsize=12)
plt.title('Hilbertè¡Œåˆ—ã®æ¡ä»¶æ•°', fontsize=14)
plt.legend(fontsize=10)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('condition_number_analysis.png', dpi=150, bbox_inches='tight')
plt.show()

print("\n" + "=" * 60)
print("ã¾ã¨ã‚:")
print("  - æ¡ä»¶æ•°ãŒå¤§ãã„ã¨ã€ã‚ãšã‹ãªæ‘‚å‹•ãŒè§£ã«å¤§ããå½±éŸ¿")
print("  - Hilbertè¡Œåˆ—ã¯æ¥µã‚ã¦æ‚ªæ¡ä»¶ï¼ˆã‚µã‚¤ã‚º10ã§æ¡ä»¶æ•° â‰ˆ 10Â¹Â³ï¼‰")
print("  - å®Ÿå‹™ã§ã¯å‰å‡¦ç†ã‚„ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã§æ¡ä»¶æ•°ã‚’æ”¹å–„")
print("=" * 60)
</code></div>

            <div class="output-box">============================================================
æ¡ä»¶æ•°ã¨æ•°å€¤å®‰å®šæ€§ã®è§£æ
============================================================

1. è‰¯æ¡ä»¶ãªè¡Œåˆ—:
[[4. 1.]
 [1. 3.]]
æ¡ä»¶æ•°: 3.73e+00

2. æ‚ªæ¡ä»¶ãªè¡Œåˆ— (Hilbert 5x5):
[[1.     0.5    0.333  0.25   0.2   ]
 [0.5    0.333  0.25   0.2    0.167 ]
 [0.333  0.25   0.2    0.167  0.143 ]
 [0.25   0.2    0.167  0.143  0.125 ]
 [0.2    0.167  0.143  0.125  0.111 ]]
æ¡ä»¶æ•°: 4.77e+05

============================================================
æ•°å€¤å®Ÿé¨“: å³è¾ºã®æ‘‚å‹•ã«å¯¾ã™ã‚‹æ„Ÿåº¦
============================================================

è‰¯æ¡ä»¶è¡Œåˆ—:
  å³è¾ºã®ç›¸å¯¾å¤‰åŒ–: 1.0%
  è§£ã®ç›¸å¯¾å¤‰åŒ–: 1.05%
  å¢—å¹…ç‡: 1.05å€
  ç†è«–ä¸Šé™ (æ¡ä»¶æ•°): 3.73e+00

æ‚ªæ¡ä»¶è¡Œåˆ— (Hilbert):
  å³è¾ºã®ç›¸å¯¾å¤‰åŒ–: 1.0%
  è§£ã®ç›¸å¯¾å¤‰åŒ–: 227.45%
  å¢—å¹…ç‡: 227.45å€
  ç†è«–ä¸Šé™ (æ¡ä»¶æ•°): 4.77e+05

============================================================
Hilbertè¡Œåˆ—ã®æ¡ä»¶æ•°ï¼ˆã‚µã‚¤ã‚ºä¾å­˜æ€§ï¼‰
============================================================

ã‚µã‚¤ã‚º     æ¡ä»¶æ•°
------------------------------
   2      1.93e+01
   3      5.24e+02
   4      1.55e+04
   5      4.77e+05
   6      1.50e+07
   7      4.75e+08
   8      1.53e+10
   9      4.93e+11
  10      1.60e+13

============================================================
ã¾ã¨ã‚:
  - æ¡ä»¶æ•°ãŒå¤§ãã„ã¨ã€ã‚ãšã‹ãªæ‘‚å‹•ãŒè§£ã«å¤§ããå½±éŸ¿
  - Hilbertè¡Œåˆ—ã¯æ¥µã‚ã¦æ‚ªæ¡ä»¶ï¼ˆã‚µã‚¤ã‚º10ã§æ¡ä»¶æ•° â‰ˆ 10Â¹Â³ï¼‰
  - å®Ÿå‹™ã§ã¯å‰å‡¦ç†ã‚„ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã§æ¡ä»¶æ•°ã‚’æ”¹å–„
============================================================</div>

        </section>

        <div class="exercise-section">
            <h3>ğŸ‹ï¸ æ¼”ç¿’å•é¡Œ</h3>

            <h4>æ¼”ç¿’1: LUåˆ†è§£ã®å®Ÿè£…æ¤œè¨¼</h4>
            <p>
                æ¬¡ã®è¡Œåˆ—ã«å¯¾ã—ã¦LUåˆ†è§£ã‚’å®Ÿè¡Œã—ã€\( A = LU \) ãŒæˆç«‹ã™ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã›ã‚ˆ:
            </p>
            <pre>A = [[2, 1, 1],
     [4, 3, 3],
     [8, 7, 9]]</pre>

            <h4>æ¼”ç¿’2: åå¾©æ³•ã®åæŸæ¡ä»¶</h4>
            <p>
                æ¬¡ã®è¡Œåˆ—ã¯å¯¾è§’å„ªä½ã§ãªã„ãŸã‚ã€Jacobiæ³•ãŒåæŸã—ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚å®Ÿéš›ã«è©¦ã—ã€åæŸã™ã‚‹ã‹ç¢ºèªã›ã‚ˆ:
            </p>
            <pre>A = [[1, 2, 3],
     [2, 1, 2],
     [3, 2, 1]]
b = [6, 5, 6]</pre>
            <p>
                åæŸã—ãªã„å ´åˆã€è¡Œã®å…¥ã‚Œæ›¿ãˆã§å¯¾è§’å„ªä½ã«ã§ãã‚‹ã‹æ¤œè¨ã›ã‚ˆã€‚
            </p>

            <h4>æ¼”ç¿’3: SORæ³•ã®æœ€é©ç·©å’Œä¿‚æ•°</h4>
            <p>
                æ¬¡ã®5Ã—5ä¸‰é‡å¯¾è§’è¡Œåˆ—ã«å¯¾ã—ã¦ã€SORæ³•ã®æœ€é©ç·©å’Œä¿‚æ•°ã‚’å®Ÿé¨“çš„ã«æ±‚ã‚ã‚ˆï¼ˆ\( \omega \in [1.0, 2.0] \) ã®ç¯„å›²ã§0.05åˆ»ã¿ã§è©¦ã™ï¼‰:
            </p>
            <pre>å¯¾è§’è¦ç´ : 4
ä¸Šä¸‹ã®å‰¯å¯¾è§’è¦ç´ : -1</pre>

            <h4>æ¼”ç¿’4: ç–è¡Œåˆ—ã®åŠ¹ç‡æ€§</h4>
            <p>
                2æ¬¡å…ƒLaplacianè¡Œåˆ—ï¼ˆæ ¼å­ã‚µã‚¤ã‚º \( 50 \times 50 \)ï¼‰ã‚’ç”Ÿæˆã—ã€æ¬¡ã‚’æ¯”è¼ƒã›ã‚ˆ:
            </p>
            <ul>
                <li>(a) ç–è¡Œåˆ—å½¢å¼ã¨å¯†è¡Œåˆ—å½¢å¼ã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡</li>
                <li>(b) spsolveã¨np.linalg.solveã®è¨ˆç®—æ™‚é–“</li>
            </ul>

            <h4>æ¼”ç¿’5: æ¡ä»¶æ•°ã¨ç²¾åº¦åŠ£åŒ–</h4>
            <p>
                Hilbertè¡Œåˆ—ï¼ˆ\( n = 3, 5, 7 \)ï¼‰ã«å¯¾ã—ã¦ã€æ¬¡ã‚’èª¿ã¹ã‚ˆ:
            </p>
            <ul>
                <li>(a) å„ã‚µã‚¤ã‚ºã®æ¡ä»¶æ•°</li>
                <li>(b) å³è¾ºãƒ™ã‚¯ãƒˆãƒ« \( b = [1, 1, ..., 1]^T \) ã«å¯¾ã™ã‚‹è§£ \( x \)</li>
                <li>(c) è¨ˆç®—ã—ãŸ \( x \) ã‚’ä½¿ã£ã¦ \( Ax \) ã‚’å†è¨ˆç®—ã—ã€å…ƒã® \( b \) ã¨ã®èª¤å·®</li>
            </ul>
            <p>
                æ¡ä»¶æ•°ãŒå¤§ãããªã‚‹ã«ã¤ã‚Œã¦ç²¾åº¦ãŒåŠ£åŒ–ã™ã‚‹ã“ã¨ã‚’ç¢ºèªã›ã‚ˆã€‚
            </p>
        </div>

        <section class="content-section">
            <h2>ã¾ã¨ã‚</h2>
            <p>
                æœ¬ç« ã§ã¯ã€ç·šå½¢æ–¹ç¨‹å¼ç³»ã®æ•°å€¤è§£æ³•ã‚’ä½“ç³»çš„ã«å­¦ã³ã¾ã—ãŸ:
            </p>
            <ul>
                <li><strong>ç›´æ¥æ³•:</strong> Gaussæ¶ˆå»æ³•ã€LUåˆ†è§£ã«ã‚ˆã‚‹å³å¯†è§£ã®è¨ˆç®—</li>
                <li><strong>åå¾©æ³•:</strong> Jacobiæ³•ã€Gauss-Seidelæ³•ã€SORæ³•ã«ã‚ˆã‚‹å¤§è¦æ¨¡å•é¡Œã¸ã®å¯¾å¿œ</li>
                <li><strong>ç–è¡Œåˆ—:</strong> SciPyã®ç–è¡Œåˆ—ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªè¨ˆç®—</li>
                <li><strong>æ•°å€¤å®‰å®šæ€§:</strong> æ¡ä»¶æ•°ã«ã‚ˆã‚‹è§£ãã‚„ã™ã•ã®è©•ä¾¡ã¨å¯¾ç­–</li>
            </ul>
            <p>
                ã“ã‚Œã‚‰ã®æ‰‹æ³•ã¯ã€æœ‰é™è¦ç´ æ³•ã€æœ‰é™å·®åˆ†æ³•ã€æœ€é©åŒ–å•é¡Œãªã©ã€å¹…åºƒã„æ•°å€¤è¨ˆç®—ã®åŸºç¤ã¨ãªã‚Šã¾ã™ã€‚æ¬¡ç« ã§ã¯ã€éç·šå½¢æ–¹ç¨‹å¼ã®è§£æ³•ã«é€²ã¿ã¾ã™ã€‚
            </p>
        </section>

        <div class="navigation-buttons">
            <a href="chapter-1.html" class="nav-button secondary">â† ç¬¬1ç« </a>
            <a href="chapter-3.html" class="nav-button primary">ç¬¬3ç« ã¸ â†’</a>
        </div>
    </main>

    <footer style="margin-top: 4rem; padding: 2rem; background: #f8f9fa; border-radius: 12px; text-align: center; color: #666;">
        <p>&copy; 2025 FM Dojo. All rights reserved.</p>
    </footer>
</body>
</html>
