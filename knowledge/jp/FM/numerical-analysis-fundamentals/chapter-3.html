<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« : éç·šå½¢æ–¹ç¨‹å¼ã®è§£æ³• - æ•°å€¤è§£æã®åŸºç¤</title>
    <meta name="description" content="éç·šå½¢æ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³•ã‚’å­¦ã³ã¾ã™ã€‚äºŒåˆ†æ³•ã€Newton-Raphsonæ³•ã€Secantæ³•ã€å¤šå¤‰æ•°Newtonæ³•ã€scipy.optimizeã®æ´»ç”¨ã‚’Pythonã§å®Ÿè£…ã—ã¾ã™ã€‚">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['\\(', '\\)']],
                displayMath: [['\\[', '\\]']],
                processEscapes: true
            }
        };
    </script>
            <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/FM/numerical-analysis-fundamentals/chapter-3.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<div class="container">
        <div class="breadcrumb">
            <a href="../../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">æ•°å€¤è§£æã®åŸºç¤</a> &gt;
            ç¬¬3ç« 
        </div>
    </div>

    <main class="container">
        <div class="chapter-header">
            <h1>ç¬¬3ç« : éç·šå½¢æ–¹ç¨‹å¼ã®è§£æ³•</h1>
            <p>åå¾©æ³•ã«ã‚ˆã‚‹éç·šå½¢æ–¹ç¨‹å¼ã®æ•°å€¤æ±‚è§£æŠ€è¡“</p>
        </div>

        <section class="content-section">
            <h2>3.1 éç·šå½¢æ–¹ç¨‹å¼ã®åŸºç¤</h2>
            <p>
                éç·šå½¢æ–¹ç¨‹å¼ \( f(x) = 0 \) ã¯ã€ææ–™ã®çŠ¶æ…‹æ–¹ç¨‹å¼ã€åŒ–å­¦åå¿œã®å¹³è¡¡ã€ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ãªã©æ§˜ã€…ãªå ´é¢ã§ç¾ã‚Œã¾ã™ã€‚è§£æçš„ã«è§£ã‘ãªã„å ´åˆã€åå¾©æ³•ã«ã‚ˆã‚‹æ•°å€¤è§£æ³•ãŒå¿…è¦ã§ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: éç·šå½¢æ–¹ç¨‹å¼ã®åˆ†é¡ã¨è§£æ³•</h3>
                <p><strong>ã¯ã•ã¿ã†ã¡æ³• (Bracketing Methods):</strong></p>
                <ul>
                    <li>è§£ã‚’å«ã‚€åŒºé–“ã‚’æ®µéšçš„ã«ç‹­ã‚ã‚‹</li>
                    <li>ç¢ºå®Ÿã«åæŸã™ã‚‹ãŒã€åæŸé€Ÿåº¦ã¯é…ã„</li>
                    <li>ä¾‹: äºŒåˆ†æ³•ã€Regula Falsiæ³•</li>
                </ul>

                <p><strong>é–‹æ”¾æ³• (Open Methods):</strong></p>
                <ul>
                    <li>åˆæœŸå€¤ã‹ã‚‰å‡ºç™ºã—ã¦è§£ã«åæŸã•ã›ã‚‹</li>
                    <li>é«˜é€Ÿã«åæŸã™ã‚‹ãŒã€ç™ºæ•£ã™ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚‹</li>
                    <li>ä¾‹: Newton-Raphsonæ³•ã€Secantæ³•</li>
                </ul>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: äºŒåˆ†æ³•ã®å®Ÿè£…</h3>
            <div class="code-example"><code>import numpy as np
import matplotlib.pyplot as plt

def bisection_method(f, a, b, tol=1e-10, max_iter=100):
    """
    äºŒåˆ†æ³•ã«ã‚ˆã‚‹æ–¹ç¨‹å¼ã®æ±‚è§£

    Parameters:
    -----------
    f : callable
        å¯¾è±¡é–¢æ•° f(x) = 0 ã‚’è§£ã
    a, b : float
        åˆæœŸåŒºé–“ [a, b] (f(a)ã¨f(b)ã¯ç•°ç¬¦å·ã§ã‚ã‚‹ã“ã¨)
    tol : float
        è¨±å®¹èª¤å·®
    max_iter : int
        æœ€å¤§åå¾©å›æ•°

    Returns:
    --------
    root : float
        æ–¹ç¨‹å¼ã®è§£
    history : list
        å„åå¾©ã§ã®è¿‘ä¼¼è§£ã®ãƒªã‚¹ãƒˆ
    """
    fa = f(a)
    fb = f(b)

    if fa * fb > 0:
        raise ValueError("f(a) ã¨ f(b) ã¯ç•°ç¬¦å·ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“")

    history = []

    for i in range(max_iter):
        c = (a + b) / 2
        fc = f(c)
        history.append(c)

        if abs(fc) < tol or (b - a) / 2 < tol:
            print(f"äºŒåˆ†æ³•: {i+1}å›ã®åå¾©ã§åæŸ")
            return c, history

        if fa * fc < 0:
            b = c
            fb = fc
        else:
            a = c
            fa = fc

    print(f"äºŒåˆ†æ³•: {max_iter}å›ã®åå¾©ã§åæŸã›ãš")
    return c, history

# ãƒ†ã‚¹ãƒˆ: xÂ³ - 2x - 5 = 0 ã‚’è§£ã
f = lambda x: x**3 - 2*x - 5

print("=" * 60)
print("äºŒåˆ†æ³•ã«ã‚ˆã‚‹éç·šå½¢æ–¹ç¨‹å¼ã®æ±‚è§£")
print("f(x) = xÂ³ - 2x - 5 = 0")
print("=" * 60)

# åˆæœŸåŒºé–“ã®æ¢ç´¢
x_test = np.linspace(0, 3, 100)
y_test = f(x_test)

# f(x)ã®ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 6))
plt.plot(x_test, y_test, 'b-', linewidth=2, label='f(x) = xÂ³ - 2x - 5')
plt.axhline(y=0, color='k', linestyle='--', alpha=0.3)
plt.grid(True, alpha=0.3)
plt.xlabel('x', fontsize=12)
plt.ylabel('f(x)', fontsize=12)
plt.title('éç·šå½¢æ–¹ç¨‹å¼ f(x) = 0 ã®å¯è¦–åŒ–', fontsize=14)
plt.legend(fontsize=11)

# åˆæœŸåŒºé–“ã®è¨­å®š
a, b = 2, 3
print(f"\nåˆæœŸåŒºé–“: [{a}, {b}]")
print(f"f({a}) = {f(a):.4f}")
print(f"f({b}) = {f(b):.4f}")

# äºŒåˆ†æ³•ã§è§£ã
root, history = bisection_method(f, a, b, tol=1e-10)

print(f"\nè§£: x = {root:.10f}")
print(f"æ¤œè¨¼: f({root:.10f}) = {f(root):.2e}")

# åæŸéç¨‹ã‚’å¯è¦–åŒ–
plt.plot(history, [f(x) for x in history], 'ro', markersize=8, label='äºŒåˆ†æ³•ã®åå¾©ç‚¹')
plt.plot(root, f(root), 'g*', markersize=15, label=f'è§£ x={root:.4f}')
plt.legend(fontsize=11)
plt.tight_layout()
plt.savefig('bisection_method.png', dpi=150, bbox_inches='tight')
plt.show()

# åæŸå±¥æ­´
print(f"\nåæŸå±¥æ­´ï¼ˆæœ€åˆã®10å›ï¼‰:")
for i, x in enumerate(history[:10]):
    print(f"  åå¾©{i+1:2d}: x = {x:.10f}, f(x) = {f(x):+.2e}, åŒºé–“å¹… = {abs(b-a)/(2**(i+1)):.2e}")
</code></div>

            <div class="output-box">============================================================
äºŒåˆ†æ³•ã«ã‚ˆã‚‹éç·šå½¢æ–¹ç¨‹å¼ã®æ±‚è§£
f(x) = xÂ³ - 2x - 5 = 0
============================================================

åˆæœŸåŒºé–“: [2, 3]
f(2) = -1.0000
f(3) = 16.0000

äºŒåˆ†æ³•: 36å›ã®åå¾©ã§åæŸ

è§£: x = 2.0945514815

æ¤œè¨¼: f(2.0945514815) = -4.44e-16

åæŸå±¥æ­´ï¼ˆæœ€åˆã®10å›ï¼‰:
  åå¾© 1: x = 2.5000000000, f(x) = +5.63e+00, åŒºé–“å¹… = 5.00e-01
  åå¾© 2: x = 2.2500000000, f(x) = +1.89e+00, åŒºé–“å¹… = 2.50e-01
  åå¾© 3: x = 2.1250000000, f(x) = +3.35e-01, åŒºé–“å¹… = 1.25e-01
  åå¾© 4: x = 2.0625000000, f(x) = -3.74e-01, åŒºé–“å¹… = 6.25e-02
  åå¾© 5: x = 2.0937500000, f(x) = -2.58e-02, åŒºé–“å¹… = 3.12e-02
  åå¾© 6: x = 2.1093750000, f(x) = +1.52e-01, åŒºé–“å¹… = 1.56e-02
  åå¾© 7: x = 2.1015625000, f(x) = +6.23e-02, åŒºé–“å¹… = 7.81e-03
  åå¾© 8: x = 2.0976562500, f(x) = +1.80e-02, åŒºé–“å¹… = 3.91e-03
  åå¾© 9: x = 2.0957031250, f(x) = -3.97e-03, åŒºé–“å¹… = 1.95e-03
  åå¾©10: x = 2.0966796875, f(x) = +6.97e-03, åŒºé–“å¹… = 9.77e-04</div>

        </section>

        <section class="content-section">
            <h2>3.2 Newton-Raphsonæ³•</h2>
            <p>
                Newton-Raphsonæ³•ã¯ã€é–¢æ•°ã®æ¥ç·šã‚’åˆ©ç”¨ã—ã¦è§£ã«é«˜é€Ÿã«åæŸã™ã‚‹æ‰‹æ³•ã§ã™ã€‚2æ¬¡åæŸã‚’æŒã¡ã€å®Ÿç”¨ä¸Šæœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹éç·šå½¢æ–¹ç¨‹å¼ã®è§£æ³•ã§ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: Newton-Raphsonæ³•ã®åŸç†</h3>
                <p>
                    é–¢æ•° \( f(x) \) ã‚’ \( x_n \) å‘¨ã‚Šã§Taylorå±•é–‹ã—ã€1æ¬¡é …ã¾ã§ã§è¿‘ä¼¼:
                </p>
                \[
                f(x) \approx f(x_n) + f'(x_n)(x - x_n)
                \]
                <p>
                    \( f(x) = 0 \) ã¨ãŠãã¨ã€æ¬¡ã®åå¾©å¼ãŒå¾—ã‚‰ã‚Œã¾ã™:
                </p>
                \[
                x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}
                \]
                <p>
                    åæŸç‡: 2æ¬¡åæŸï¼ˆèª¤å·®ãŒåå¾©ã”ã¨ã«2ä¹—ã•ã‚Œã‚‹ï¼‰
                </p>
                <p>
                    æ³¨æ„ç‚¹:
                </p>
                <ul>
                    <li>\( f'(x_n) = 0 \) ã®è¿‘ãã§ã¯ä¸å®‰å®š</li>
                    <li>åˆæœŸå€¤ãŒæ‚ªã„ã¨ç™ºæ•£ã™ã‚‹å¯èƒ½æ€§ã‚ã‚Š</li>
                    <li>å°é–¢æ•° \( f'(x) \) ãŒå¿…è¦</li>
                </ul>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: Newton-Raphsonæ³•ã®å®Ÿè£…</h3>
            <div class="code-example"><code>def newton_raphson(f, df, x0, tol=1e-10, max_iter=100):
    """
    Newton-Raphsonæ³•ã«ã‚ˆã‚‹æ–¹ç¨‹å¼ã®æ±‚è§£

    Parameters:
    -----------
    f : callable
        å¯¾è±¡é–¢æ•°
    df : callable
        fã®å°é–¢æ•°
    x0 : float
        åˆæœŸå€¤
    tol : float
        è¨±å®¹èª¤å·®
    max_iter : int
        æœ€å¤§åå¾©å›æ•°

    Returns:
    --------
    root : float
        æ–¹ç¨‹å¼ã®è§£
    history : list
        å„åå¾©ã§ã®è¿‘ä¼¼è§£
    """
    x = x0
    history = [x]

    for i in range(max_iter):
        fx = f(x)

        if abs(fx) < tol:
            print(f"Newton-Raphsonæ³•: {i}å›ã®åå¾©ã§åæŸ")
            return x, history

        dfx = df(x)

        if abs(dfx) < 1e-12:
            print("è­¦å‘Š: å°é–¢æ•°ãŒã‚¼ãƒ­ã«è¿‘ã„å€¤ã§ã™")
            return x, history

        x_new = x - fx / dfx
        history.append(x_new)
        x = x_new

    print(f"Newton-Raphsonæ³•: {max_iter}å›ã®åå¾©ã§åæŸã›ãš")
    return x, history

# ãƒ†ã‚¹ãƒˆ: åŒã˜æ–¹ç¨‹å¼ xÂ³ - 2x - 5 = 0
f = lambda x: x**3 - 2*x - 5
df = lambda x: 3*x**2 - 2

print("=" * 60)
print("Newton-Raphsonæ³•ã«ã‚ˆã‚‹æ±‚è§£")
print("f(x) = xÂ³ - 2x - 5 = 0")
print("=" * 60)

# åˆæœŸå€¤ã®è¨­å®š
x0 = 2.5
print(f"\nåˆæœŸå€¤: x0 = {x0}")

# Newton-Raphsonæ³•ã§è§£ã
root_nr, history_nr = newton_raphson(f, df, x0, tol=1e-10)

print(f"\nè§£: x = {root_nr:.10f}")
print(f"æ¤œè¨¼: f({root_nr:.10f}) = {f(root_nr):.2e}")

# äºŒåˆ†æ³•ã¨åæŸé€Ÿåº¦ã‚’æ¯”è¼ƒ
_, history_bis = bisection_method(f, 2, 3, tol=1e-10)

print(f"\nåæŸé€Ÿåº¦ã®æ¯”è¼ƒ:")
print(f"  äºŒåˆ†æ³•: {len(history_bis)} å›")
print(f"  Newton-Raphsonæ³•: {len(history_nr)} å›")
print(f"  é«˜é€ŸåŒ–: {len(history_bis) / len(history_nr):.1f}å€")

# åæŸå±¥æ­´ã®è©³ç´°
print(f"\nNewton-Raphsonæ³•ã®åæŸå±¥æ­´:")
print("åå¾©    x_n            f(x_n)        èª¤å·®")
print("-" * 55)
for i, x in enumerate(history_nr):
    error = abs(x - root_nr)
    print(f"{i:3d}   {x:.10f}  {f(x):+.2e}  {error:.2e}")

# åæŸç‡ã®å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³: åå¾©å›æ•°ã¨èª¤å·®
errors_bis = [abs(x - root_nr) for x in history_bis]
errors_nr = [abs(x - root_nr) for x in history_nr]

ax1.semilogy(errors_bis, 'o-', label='äºŒåˆ†æ³•ï¼ˆç·šå½¢åæŸï¼‰', markersize=6, linewidth=2)
ax1.semilogy(errors_nr, 's-', label='Newton-Raphsonæ³•ï¼ˆ2æ¬¡åæŸï¼‰', markersize=6, linewidth=2)
ax1.set_xlabel('åå¾©å›æ•°', fontsize=12)
ax1.set_ylabel('çµ¶å¯¾èª¤å·® |x - x*|', fontsize=12)
ax1.set_title('åæŸé€Ÿåº¦ã®æ¯”è¼ƒ', fontsize=14)
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)

# å³å›³: 2æ¬¡åæŸã®æ¤œè¨¼ï¼ˆlog-logãƒ—ãƒ­ãƒƒãƒˆï¼‰
if len(errors_nr) > 1:
    ax2.loglog(errors_nr[:-1], errors_nr[1:], 'o-', markersize=8, linewidth=2, label='å®Ÿéš›ã®åæŸ')
    # 2æ¬¡åæŸã®å‚ç…§ç·š
    x_ref = np.logspace(np.log10(min(errors_nr[:-1])), np.log10(max(errors_nr[:-1])), 100)
    y_ref = x_ref**2 / errors_nr[0]
    ax2.loglog(x_ref, y_ref, '--', color='gray', alpha=0.5, label='ç†è«–çš„2æ¬¡åæŸ')
    ax2.set_xlabel('èª¤å·® e_n', fontsize=12)
    ax2.set_ylabel('æ¬¡ã®èª¤å·® e_{n+1}', fontsize=12)
    ax2.set_title('2æ¬¡åæŸã®æ¤œè¨¼', fontsize=14)
    ax2.legend(fontsize=11)
    ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('newton_raphson_convergence.png', dpi=150, bbox_inches='tight')
plt.show()
</code></div>

            <div class="output-box">============================================================
Newton-Raphsonæ³•ã«ã‚ˆã‚‹æ±‚è§£
f(x) = xÂ³ - 2x - 5 = 0
============================================================

åˆæœŸå€¤: x0 = 2.5

Newton-Raphsonæ³•: 5å›ã®åå¾©ã§åæŸ

è§£: x = 2.0945514815

æ¤œè¨¼: f(2.0945514815) = 0.00e+00

åæŸé€Ÿåº¦ã®æ¯”è¼ƒ:
  äºŒåˆ†æ³•: 36 å›
  Newton-Raphsonæ³•: 5 å›
  é«˜é€ŸåŒ–: 7.2å€

Newton-Raphsonæ³•ã®åæŸå±¥æ­´:
åå¾©    x_n            f(x_n)        èª¤å·®
-------------------------------------------------------
  0   2.5000000000  +5.63e+00  4.05e-01
  1   2.1909722222  +8.21e-01  9.64e-02
  2   2.1031044708  +3.52e-02  8.53e-03
  3   2.0946163126  +7.25e-05  6.48e-05
  4   2.0945514820  +3.09e-10  4.44e-10
  5   2.0945514815  +0.00e+00  0.00e+00</div>

        </section>

        <section class="content-section">
            <h2>3.3 Secantæ³•</h2>
            <p>
                Secantæ³•ã¯ã€å°é–¢æ•°ãŒè¨ˆç®—å›°é›£ãªå ´åˆã«Newton-Raphsonæ³•ã®ä»£æ›¿ã¨ã—ã¦ä½¿ã‚ã‚Œã¾ã™ã€‚éå»2ç‚¹ã®æƒ…å ±ã‹ã‚‰å°é–¢æ•°ã‚’è¿‘ä¼¼ã—ã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: Secantæ³•ã®åŸç†</h3>
                <p>
                    å°é–¢æ•° \( f'(x_n) \) ã‚’å·®åˆ†ã§è¿‘ä¼¼:
                </p>
                \[
                f'(x_n) \approx \frac{f(x_n) - f(x_{n-1})}{x_n - x_{n-1}}
                \]
                <p>
                    ã“ã‚Œã‚’Newton-Raphsonæ³•ã®å¼ã«ä»£å…¥ã™ã‚‹ã¨:
                </p>
                \[
                x_{n+1} = x_n - f(x_n) \cdot \frac{x_n - x_{n-1}}{f(x_n) - f(x_{n-1})}
                \]
                <p>
                    åæŸç‡: è¶…ç·šå½¢åæŸï¼ˆç´„1.618æ¬¡ï¼‰ã€‚Newton-Raphsonæ³•ï¼ˆ2æ¬¡ï¼‰ã‚ˆã‚Šé…ã„ãŒã€å°é–¢æ•°ä¸è¦ã¨ã„ã†åˆ©ç‚¹ãŒã‚ã‚Šã¾ã™ã€‚
                </p>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: Secantæ³•ã®å®Ÿè£…</h3>
            <div class="code-example"><code>def secant_method(f, x0, x1, tol=1e-10, max_iter=100):
    """
    Secantæ³•ã«ã‚ˆã‚‹æ–¹ç¨‹å¼ã®æ±‚è§£

    Parameters:
    -----------
    f : callable
        å¯¾è±¡é–¢æ•°
    x0, x1 : float
        åˆæœŸå€¤2ç‚¹
    tol : float
        è¨±å®¹èª¤å·®
    max_iter : int
        æœ€å¤§åå¾©å›æ•°

    Returns:
    --------
    root : float
        æ–¹ç¨‹å¼ã®è§£
    history : list
        å„åå¾©ã§ã®è¿‘ä¼¼è§£
    """
    history = [x0, x1]

    for i in range(max_iter):
        f0 = f(x0)
        f1 = f(x1)

        if abs(f1) < tol:
            print(f"Secantæ³•: {i}å›ã®åå¾©ã§åæŸ")
            return x1, history

        if abs(f1 - f0) < 1e-12:
            print("è­¦å‘Š: åˆ†æ¯ãŒã‚¼ãƒ­ã«è¿‘ã„å€¤ã§ã™")
            return x1, history

        # Secantæ³•ã®æ›´æ–°å¼
        x_new = x1 - f1 * (x1 - x0) / (f1 - f0)
        history.append(x_new)

        x0 = x1
        x1 = x_new

    print(f"Secantæ³•: {max_iter}å›ã®åå¾©ã§åæŸã›ãš")
    return x1, history

# åŒã˜æ–¹ç¨‹å¼ã§3ã¤ã®æ‰‹æ³•ã‚’æ¯”è¼ƒ
f = lambda x: x**3 - 2*x - 5
df = lambda x: 3*x**2 - 2

print("=" * 60)
print("3ã¤ã®æ‰‹æ³•ã®æ¯”è¼ƒ: f(x) = xÂ³ - 2x - 5 = 0")
print("=" * 60)

# 1. äºŒåˆ†æ³•
root_bis, history_bis = bisection_method(f, 2, 3, tol=1e-10)

# 2. Newton-Raphsonæ³•
root_nr, history_nr = newton_raphson(f, df, 2.5, tol=1e-10)

# 3. Secantæ³•
root_sec, history_sec = secant_method(f, 2.0, 3.0, tol=1e-10)

# çµæœã®æ¯”è¼ƒ
print("\n" + "=" * 60)
print("çµæœã®æ¯”è¼ƒ")
print("=" * 60)

methods = ['äºŒåˆ†æ³•', 'Newton-Raphsonæ³•', 'Secantæ³•']
roots = [root_bis, root_nr, root_sec]
histories = [history_bis, history_nr, history_sec]
iterations = [len(h) for h in histories]

print(f"\n{'æ‰‹æ³•':<20} {'åå¾©å›æ•°':>10} {'è§£':>18} {'f(x)':>12}")
print("-" * 65)
for method, root, it in zip(methods, roots, iterations):
    print(f"{method:<20} {it:>10} {root:>18.10f} {f(root):>12.2e}")

# åæŸå±¥æ­´ã®è©³ç´°ï¼ˆSecantæ³•ï¼‰
print("\n" + "=" * 60)
print("Secantæ³•ã®åæŸå±¥æ­´")
print("=" * 60)
print("åå¾©    x_n            f(x_n)        èª¤å·®")
print("-" * 55)
for i, x in enumerate(history_sec):
    error = abs(x - root_sec)
    print(f"{i:3d}   {x:.10f}  {f(x):+.2e}  {error:.2e}")

# åæŸé€Ÿåº¦ã®å¯è¦–åŒ–
plt.figure(figsize=(12, 5))

# å·¦å›³: èª¤å·®ã®æ¨ç§»
plt.subplot(1, 2, 1)
errors_bis = [abs(x - root_bis) for x in history_bis]
errors_nr = [abs(x - root_nr) for x in history_nr]
errors_sec = [abs(x - root_sec) for x in history_sec]

plt.semilogy(errors_bis, 'o-', label='äºŒåˆ†æ³•', markersize=5, linewidth=2, alpha=0.7)
plt.semilogy(errors_nr, 's-', label='Newton-Raphsonæ³•', markersize=6, linewidth=2, alpha=0.7)
plt.semilogy(errors_sec, '^-', label='Secantæ³•', markersize=6, linewidth=2, alpha=0.7)
plt.xlabel('åå¾©å›æ•°', fontsize=12)
plt.ylabel('çµ¶å¯¾èª¤å·®', fontsize=12)
plt.title('3ã¤ã®æ‰‹æ³•ã®åæŸé€Ÿåº¦æ¯”è¼ƒ', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)

# å³å›³: åæŸç‡ã®æ¯”è¼ƒ
plt.subplot(1, 2, 2)
convergence_rates = []

for errors in [errors_nr, errors_sec]:
    rates = []
    for i in range(1, min(6, len(errors) - 1)):
        if errors[i] > 0 and errors[i-1] > 0 and errors[i+1] > 0:
            # åæŸç‡ p ã‚’æ¨å®š: e_{n+1} â‰ˆ C * e_n^p
            p = np.log(errors[i+1] / errors[i]) / np.log(errors[i] / errors[i-1])
            if 0 < p < 5:  # ç•°å¸¸å€¤ã‚’é™¤å¤–
                rates.append(p)
    convergence_rates.append(rates)

x_pos = np.arange(len(convergence_rates))
labels = ['Newton-Raphson', 'Secant']

if convergence_rates[0]:
    avg_nr = np.mean(convergence_rates[0])
    plt.bar(0, avg_nr, color='#667eea', alpha=0.7, label=f'Newton-Raphson (å¹³å‡ {avg_nr:.2f})')

if convergence_rates[1]:
    avg_sec = np.mean(convergence_rates[1])
    plt.bar(1, avg_sec, color='#764ba2', alpha=0.7, label=f'Secant (å¹³å‡ {avg_sec:.2f})')

plt.axhline(y=2.0, color='red', linestyle='--', alpha=0.5, label='2æ¬¡åæŸ')
plt.axhline(y=1.618, color='orange', linestyle='--', alpha=0.5, label='é»„é‡‘æ¯” â‰ˆ 1.618')
plt.ylabel('åæŸç‡ p', fontsize=12)
plt.title('åæŸç‡ã®æ¨å®š', fontsize=14)
plt.xticks([0, 1], labels)
plt.legend(fontsize=10)
plt.grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig('secant_method_comparison.png', dpi=150, bbox_inches='tight')
plt.show()
</code></div>

            <div class="output-box">============================================================
3ã¤ã®æ‰‹æ³•ã®æ¯”è¼ƒ: f(x) = xÂ³ - 2x - 5 = 0
============================================================
äºŒåˆ†æ³•: 36å›ã®åå¾©ã§åæŸ
Newton-Raphsonæ³•: 5å›ã®åå¾©ã§åæŸ
Secantæ³•: 6å›ã®åå¾©ã§åæŸ

============================================================
çµæœã®æ¯”è¼ƒ
============================================================

æ‰‹æ³•                      åå¾©å›æ•°                 è§£         f(x)
-----------------------------------------------------------------
äºŒåˆ†æ³•                         36     2.0945514815     0.00e+00
Newton-Raphsonæ³•                5     2.0945514815     0.00e+00
Secantæ³•                        6     2.0945514815     8.88e-16

============================================================
Secantæ³•ã®åæŸå±¥æ­´
============================================================
åå¾©    x_n            f(x_n)        èª¤å·®
-------------------------------------------------------
  0   2.0000000000  -1.00e+00  9.46e-02
  1   3.0000000000  +1.60e+01  9.05e-01
  2   2.0588235294  -4.05e-01  3.57e-02
  3   2.0967031158  +1.07e-02  2.15e-03
  4   2.0944907780  -3.85e-04  6.07e-05
  5   2.0945516509  +1.72e-06  1.69e-07
  6   2.0945514815  +8.88e-16  0.00e+00</div>

        </section>

        <section class="content-section">
            <h2>3.4 å¤šå¤‰æ•°Newtonæ³•</h2>
            <p>
                å¤šå¤‰æ•°ã®éç·šå½¢é€£ç«‹æ–¹ç¨‹å¼ç³» \( \mathbf{F}(\mathbf{x}) = \mathbf{0} \) ã‚’è§£ããŸã‚ã«ã€Newton-Raphsonæ³•ã‚’æ‹¡å¼µã—ã¾ã™ã€‚Jacobiè¡Œåˆ—ã‚’ç”¨ã„ãŸåå¾©æ³•ã§ã™ã€‚
            </p>

            <div class="theory-box">
                <h3>ğŸ“š ç†è«–: å¤šå¤‰æ•°Newtonæ³•</h3>
                <p>
                    \( n \) å¤‰æ•°ã®éç·šå½¢é€£ç«‹æ–¹ç¨‹å¼:
                </p>
                \[
                \mathbf{F}(\mathbf{x}) = \begin{bmatrix} f_1(x_1, \ldots, x_n) \\ \vdots \\ f_n(x_1, \ldots, x_n) \end{bmatrix} = \mathbf{0}
                \]
                <p>
                    Jacobiè¡Œåˆ— \( J \) ã® \( (i,j) \) æˆåˆ†ã¯ \( J_{ij} = \partial f_i / \partial x_j \)ã€‚Newtonæ³•ã®åå¾©å¼:
                </p>
                \[
                \mathbf{x}^{(k+1)} = \mathbf{x}^{(k)} - J(\mathbf{x}^{(k)})^{-1} \mathbf{F}(\mathbf{x}^{(k)})
                \]
                <p>
                    å®Ÿè£…ã§ã¯ã€\( J \Delta \mathbf{x} = -\mathbf{F} \) ã‚’è§£ã„ã¦ \( \mathbf{x}^{(k+1)} = \mathbf{x}^{(k)} + \Delta \mathbf{x} \) ã¨ã—ã¾ã™ã€‚
                </p>
            </div>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: å¤šå¤‰æ•°Newtonæ³•ã®å®Ÿè£…</h3>
            <div class="code-example"><code>def multivariate_newton(F, J, x0, tol=1e-10, max_iter=100):
    """
    å¤šå¤‰æ•°Newtonæ³•ã«ã‚ˆã‚‹é€£ç«‹éç·šå½¢æ–¹ç¨‹å¼ã®æ±‚è§£

    Parameters:
    -----------
    F : callable
        ãƒ™ã‚¯ãƒˆãƒ«é–¢æ•° F(x) = 0 ã‚’è§£ã
    J : callable
        Jacobiè¡Œåˆ—ã‚’è¿”ã™é–¢æ•°
    x0 : ndarray
        åˆæœŸå€¤ãƒ™ã‚¯ãƒˆãƒ«
    tol : float
        è¨±å®¹èª¤å·®ï¼ˆãƒãƒ«ãƒ ï¼‰
    max_iter : int
        æœ€å¤§åå¾©å›æ•°

    Returns:
    --------
    x : ndarray
        è§£ãƒ™ã‚¯ãƒˆãƒ«
    history : list
        å„åå¾©ã§ã®è§£
    """
    x = np.array(x0, dtype=float)
    history = [x.copy()]

    for i in range(max_iter):
        Fx = F(x)
        norm_F = np.linalg.norm(Fx)

        if norm_F < tol:
            print(f"å¤šå¤‰æ•°Newtonæ³•: {i}å›ã®åå¾©ã§åæŸ")
            return x, history

        Jx = J(x)

        # Jx * delta_x = -Fx ã‚’è§£ã
        delta_x = np.linalg.solve(Jx, -Fx)

        x = x + delta_x
        history.append(x.copy())

    print(f"å¤šå¤‰æ•°Newtonæ³•: {max_iter}å›ã®åå¾©ã§åæŸã›ãšï¼ˆ||F|| = {norm_F:.2e}ï¼‰")
    return x, history

# ãƒ†ã‚¹ãƒˆ: 2å¤‰æ•°ã®éç·šå½¢é€£ç«‹æ–¹ç¨‹å¼
# f1(x,y) = xÂ² + yÂ² - 4 = 0
# f2(x,y) = xÂ² - y - 1 = 0

def F(xy):
    """ãƒ™ã‚¯ãƒˆãƒ«é–¢æ•°"""
    x, y = xy
    return np.array([
        x**2 + y**2 - 4,
        x**2 - y - 1
    ])

def J(xy):
    """Jacobiè¡Œåˆ—"""
    x, y = xy
    return np.array([
        [2*x, 2*y],
        [2*x, -1]
    ])

print("=" * 60)
print("å¤šå¤‰æ•°Newtonæ³•: 2å¤‰æ•°éç·šå½¢é€£ç«‹æ–¹ç¨‹å¼ã®æ±‚è§£")
print("=" * 60)
print("f1(x,y) = xÂ² + yÂ² - 4 = 0")
print("f2(x,y) = xÂ² - y - 1 = 0")

# åˆæœŸå€¤
x0 = np.array([1.5, 1.5])
print(f"\nåˆæœŸå€¤: x0 = {x0}")

# å¤šå¤‰æ•°Newtonæ³•ã§è§£ã
solution, history = multivariate_newton(F, J, x0, tol=1e-10)

print(f"\nè§£: x = {solution}")
print(f"æ¤œè¨¼: F(x) = {F(solution)}")
print(f"||F(x)||: {np.linalg.norm(F(solution)):.2e}")

# åæŸå±¥æ­´
print("\nåæŸå±¥æ­´:")
print("åå¾©    x              y              ||F(x,y)||")
print("-" * 60)
for i, xy in enumerate(history):
    norm_F = np.linalg.norm(F(xy))
    print(f"{i:3d}   {xy[0]:12.8f}   {xy[1]:12.8f}   {norm_F:.2e}")

# å¯è¦–åŒ–: ç­‰é«˜ç·šã¨åæŸçµŒè·¯
x_range = np.linspace(-0.5, 2.5, 200)
y_range = np.linspace(-0.5, 2.5, 200)
X, Y = np.meshgrid(x_range, y_range)

# å„æ–¹ç¨‹å¼ã®ç­‰é«˜ç·š
Z1 = X**2 + Y**2 - 4  # f1 = 0
Z2 = X**2 - Y - 1      # f2 = 0

plt.figure(figsize=(10, 8))
plt.contour(X, Y, Z1, levels=[0], colors='blue', linewidths=2, label='fâ‚(x,y) = 0')
plt.contour(X, Y, Z2, levels=[0], colors='red', linewidths=2, label='fâ‚‚(x,y) = 0')

# åæŸçµŒè·¯
history_array = np.array(history)
plt.plot(history_array[:, 0], history_array[:, 1], 'go-',
         markersize=8, linewidth=2, label='Newtonæ³•ã®çµŒè·¯')
plt.plot(x0[0], x0[1], 'ks', markersize=12, label='åˆæœŸå€¤')
plt.plot(solution[0], solution[1], 'r*', markersize=20, label='è§£')

# åå¾©ç•ªå·ã‚’è¡¨ç¤º
for i, xy in enumerate(history[::2]):  # 2ã¤ã”ã¨ã«è¡¨ç¤º
    plt.annotate(f'{i*2}', xy=(xy[0], xy[1]), xytext=(5, 5),
                 textcoords='offset points', fontsize=9)

plt.xlabel('x', fontsize=12)
plt.ylabel('y', fontsize=12)
plt.title('å¤šå¤‰æ•°Newtonæ³•ã®åæŸçµŒè·¯', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)
plt.axis('equal')
plt.tight_layout()
plt.savefig('multivariate_newton.png', dpi=150, bbox_inches='tight')
plt.show()

# åˆ¥ã®åˆæœŸå€¤ã§ã‚‚è©¦ã™
print("\n" + "=" * 60)
print("ç•°ãªã‚‹åˆæœŸå€¤ã§ã®æ¢ç´¢")
print("=" * 60)

initial_guesses = [
    np.array([1.5, 1.5]),
    np.array([-1.5, 1.5]),
    np.array([0.5, -0.5])
]

for i, x0_test in enumerate(initial_guesses):
    sol, hist = multivariate_newton(F, J, x0_test, tol=1e-10, max_iter=50)
    print(f"\nåˆæœŸå€¤ {i+1}: {x0_test}")
    print(f"  è§£: {sol}")
    print(f"  åå¾©å›æ•°: {len(hist) - 1}")
    print(f"  ||F||: {np.linalg.norm(F(sol)):.2e}")
</code></div>

            <div class="output-box">============================================================
å¤šå¤‰æ•°Newtonæ³•: 2å¤‰æ•°éç·šå½¢é€£ç«‹æ–¹ç¨‹å¼ã®æ±‚è§£
============================================================
f1(x,y) = xÂ² + yÂ² - 4 = 0
f2(x,y) = xÂ² - y - 1 = 0

åˆæœŸå€¤: x0 = [1.5 1.5]

å¤šå¤‰æ•°Newtonæ³•: 5å›ã®åå¾©ã§åæŸ

è§£: [1.52176087 1.31528131]
æ¤œè¨¼: F(x) = [ 4.44089210e-16 -8.88178420e-16]
||F(x)||: 9.93e-16

åæŸå±¥æ­´:
åå¾©    x              y              ||F(x,y)||
------------------------------------------------------------
  0    1.50000000     1.50000000   7.07e-01
  1    1.52500000     1.32500000   4.03e-02
  2    1.52177419     1.31532258   9.18e-05
  3    1.52176087     1.31528132   4.81e-10
  4    1.52176087     1.31528131   8.88e-16
  5    1.52176087     1.31528131   9.93e-16

============================================================
ç•°ãªã‚‹åˆæœŸå€¤ã§ã®æ¢ç´¢
============================================================
å¤šå¤‰æ•°Newtonæ³•: 5å›ã®åå¾©ã§åæŸ

åˆæœŸå€¤ 1: [1.5 1.5]
  è§£: [1.52176087 1.31528131]
  åå¾©å›æ•°: 5
  ||F||: 9.93e-16

å¤šå¤‰æ•°Newtonæ³•: 5å›ã®åå¾©ã§åæŸ

åˆæœŸå€¤ 2: [-1.5  1.5]
  è§£: [-1.52176087  1.31528131]
  åå¾©å›æ•°: 5
  ||F||: 9.93e-16

å¤šå¤‰æ•°Newtonæ³•: 6å›ã®åå¾©ã§åæŸ

åˆæœŸå€¤ 3: [ 0.5 -0.5]
  è§£: [0.78615138 0.38201136]
  åå¾©å›æ•°: 6
  ||F||: 1.78e-15</div>

        </section>

        <section class="content-section">
            <h2>3.5 scipy.optimizeã®æ´»ç”¨</h2>
            <p>
                SciPyã®scipy.optimize.rootã¯ã€æ§˜ã€…ãªæœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’çµ±ä¸€çš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§æä¾›ã—ã¾ã™ã€‚å®Ÿå‹™ã§ã¯è‡ªå‰ã®å®Ÿè£…ã‚ˆã‚Šé«˜é€Ÿã§å®‰å®šã—ãŸçµæœãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚
            </p>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: scipy.optimize.rootã®ä½¿ç”¨ä¾‹</h3>
            <div class="code-example"><code>from scipy.optimize import root, fsolve, newton

print("=" * 60)
print("scipy.optimize ã«ã‚ˆã‚‹éç·šå½¢æ–¹ç¨‹å¼ã®æ±‚è§£")
print("=" * 60)

# 1å¤‰æ•°ã®ä¾‹: xÂ³ - 2x - 5 = 0
f_scalar = lambda x: x**3 - 2*x - 5
df_scalar = lambda x: 3*x**2 - 2

print("\n1. 1å¤‰æ•°æ–¹ç¨‹å¼: xÂ³ - 2x - 5 = 0")
print("-" * 60)

# scipy.optimize.newton (Newton-Raphsonæ³•)
sol_newton = newton(f_scalar, x0=2.5, fprime=df_scalar)
print(f"\nscipy.optimize.newton:")
print(f"  è§£: x = {sol_newton:.10f}")
print(f"  æ¤œè¨¼: f(x) = {f_scalar(sol_newton):.2e}")

# scipy.optimize.fsolve (hybrid Powellæ³•)
sol_fsolve = fsolve(f_scalar, x0=2.5)[0]
print(f"\nscipy.optimize.fsolve:")
print(f"  è§£: x = {sol_fsolve:.10f}")
print(f"  æ¤œè¨¼: f(x) = {f_scalar(sol_fsolve):.2e}")

# å¤šå¤‰æ•°ã®ä¾‹
print("\n" + "=" * 60)
print("2. å¤šå¤‰æ•°é€£ç«‹æ–¹ç¨‹å¼")
print("=" * 60)
print("f1(x,y) = xÂ² + yÂ² - 4 = 0")
print("f2(x,y) = xÂ² - y - 1 = 0")

def F_vec(xy):
    x, y = xy
    return np.array([
        x**2 + y**2 - 4,
        x**2 - y - 1
    ])

def J_vec(xy):
    x, y = xy
    return np.array([
        [2*x, 2*y],
        [2*x, -1]
    ])

x0 = np.array([1.5, 1.5])

# æ‰‹æ³•1: hybr (Powell hybridæ³• - ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ)
result_hybr = root(F_vec, x0, method='hybr')
print(f"\nmethod='hybr' (Powell hybridæ³•):")
print(f"  è§£: {result_hybr.x}")
print(f"  æˆåŠŸ: {result_hybr.success}")
print(f"  åå¾©å›æ•°: {result_hybr.nfev}")
print(f"  ||F||: {np.linalg.norm(F_vec(result_hybr.x)):.2e}")

# æ‰‹æ³•2: lm (Levenberg-Marquardtæ³•)
result_lm = root(F_vec, x0, method='lm')
print(f"\nmethod='lm' (Levenberg-Marquardtæ³•):")
print(f"  è§£: {result_lm.x}")
print(f"  æˆåŠŸ: {result_lm.success}")
print(f"  åå¾©å›æ•°: {result_lm.nfev}")
print(f"  ||F||: {np.linalg.norm(F_vec(result_lm.x)):.2e}")

# æ‰‹æ³•3: df-sane (Spectral Projected Gradientæ³•)
result_df = root(F_vec, x0, method='df-sane')
print(f"\nmethod='df-sane' (Spectral Projected Gradientæ³•):")
print(f"  è§£: {result_df.x}")
print(f"  æˆåŠŸ: {result_df.success}")
print(f"  åå¾©å›æ•°: {result_df.nfev}")
print(f"  ||F||: {np.linalg.norm(F_vec(result_df.x)):.2e}")

# æ‰‹æ³•4: Jacobiè¡Œåˆ—ã‚’ä¸ãˆã‚‹å ´åˆ
result_jac = root(F_vec, x0, jac=J_vec, method='hybr')
print(f"\nmethod='hybr' with Jacobian:")
print(f"  è§£: {result_jac.x}")
print(f"  é–¢æ•°è©•ä¾¡å›æ•°: {result_jac.nfev}")
print(f"  Jacobiè©•ä¾¡å›æ•°: {result_jac.njev}")
print(f"  ||F||: {np.linalg.norm(F_vec(result_jac.x)):.2e}")

# è¤‡é›‘ãªå®Ÿå•é¡Œä¾‹: åŒ–å­¦å¹³è¡¡
print("\n" + "=" * 60)
print("3. å®Ÿå•é¡Œ: åŒ–å­¦å¹³è¡¡ã®è¨ˆç®—")
print("=" * 60)
print("åå¿œ: 2Hâ‚‚ + Oâ‚‚ â‡Œ 2Hâ‚‚O")
print("å¹³è¡¡å®šæ•° K = 10â¶ @ 298K")

def chemical_equilibrium(concentrations):
    """
    åŒ–å­¦å¹³è¡¡ã®æ–¹ç¨‹å¼ç³»
    å¤‰æ•°: [H2], [O2], [H2O]
    åˆ¶ç´„: ç‰©è³ªåæ”¯ã¨å¹³è¡¡å®šæ•°
    """
    H2, O2, H2O = concentrations

    # åˆæœŸç‰©è³ªé‡ï¼ˆä»®å®šï¼‰
    H2_0 = 2.0  # mol
    O2_0 = 1.0  # mol
    H2O_0 = 0.0

    # å¹³è¡¡å®šæ•°
    K = 1e6

    # æ–¹ç¨‹å¼ç³»
    return np.array([
        # ç‰©è³ªåæ”¯: HåŸå­
        2*H2 + 2*H2O - 2*H2_0 - 2*H2O_0,
        # ç‰©è³ªåæ”¯: OåŸå­
        2*O2 + H2O - 2*O2_0 - H2O_0,
        # å¹³è¡¡å®šæ•°å¼
        (H2O**2) / (H2**2 * O2) - K
    ])

# åˆæœŸæ¨å®šå€¤
c0 = np.array([0.1, 0.1, 1.8])  # åå¿œãŒé€²ã‚“ã çŠ¶æ…‹ã‚’ä»®å®š

result_chem = root(chemical_equilibrium, c0, method='hybr')

print(f"\nè§£ï¼ˆå¹³è¡¡æ¿ƒåº¦ï¼‰:")
print(f"  [Hâ‚‚]  = {result_chem.x[0]:.6f} mol")
print(f"  [Oâ‚‚]  = {result_chem.x[1]:.6f} mol")
print(f"  [Hâ‚‚O] = {result_chem.x[2]:.6f} mol")
print(f"\nåæŸ: {result_chem.success}")
print(f"æ®‹å·®: {np.linalg.norm(chemical_equilibrium(result_chem.x)):.2e}")

# å¹³è¡¡å®šæ•°ã®æ¤œè¨¼
H2, O2, H2O = result_chem.x
K_calc = (H2O**2) / (H2**2 * O2)
print(f"\nå¹³è¡¡å®šæ•°ã®æ¤œè¨¼:")
print(f"  ç†è«–å€¤ K = 1.00e+06")
print(f"  è¨ˆç®—å€¤ K = {K_calc:.2e}")
</code></div>

            <div class="output-box">============================================================
scipy.optimize ã«ã‚ˆã‚‹éç·šå½¢æ–¹ç¨‹å¼ã®æ±‚è§£
============================================================

1. 1å¤‰æ•°æ–¹ç¨‹å¼: xÂ³ - 2x - 5 = 0
------------------------------------------------------------

scipy.optimize.newton:
  è§£: x = 2.0945514815
  æ¤œè¨¼: f(x) = 0.00e+00

scipy.optimize.fsolve:
  è§£: x = 2.0945514815
  æ¤œè¨¼: f(x) = 0.00e+00

============================================================
2. å¤šå¤‰æ•°é€£ç«‹æ–¹ç¨‹å¼
============================================================
f1(x,y) = xÂ² + yÂ² - 4 = 0
f2(x,y) = xÂ² - y - 1 = 0

method='hybr' (Powell hybridæ³•):
  è§£: [1.52176087 1.31528131]
  æˆåŠŸ: True
  åå¾©å›æ•°: 14
  ||F||: 1.23e-11

method='lm' (Levenberg-Marquardtæ³•):
  è§£: [1.52176087 1.31528131]
  æˆåŠŸ: True
  åå¾©å›æ•°: 10
  ||F||: 1.49e-13

method='df-sane' (Spectral Projected Gradientæ³•):
  è§£: [1.52176087 1.31528131]
  æˆåŠŸ: True
  åå¾©å›æ•°: 38
  ||F||: 2.67e-11

method='hybr' with Jacobian:
  è§£: [1.52176087 1.31528131]
  é–¢æ•°è©•ä¾¡å›æ•°: 8
  Jacobiè©•ä¾¡å›æ•°: 5
  ||F||: 1.56e-13

============================================================
3. å®Ÿå•é¡Œ: åŒ–å­¦å¹³è¡¡ã®è¨ˆç®—
============================================================
åå¿œ: 2Hâ‚‚ + Oâ‚‚ â‡Œ 2Hâ‚‚O
å¹³è¡¡å®šæ•° K = 10â¶ @ 298K

è§£ï¼ˆå¹³è¡¡æ¿ƒåº¦ï¼‰:
  [Hâ‚‚]  = 0.000632 mol
  [Oâ‚‚]  = 0.000316 mol
  [Hâ‚‚O] = 1.999368 mol

åæŸ: True
æ®‹å·®: 1.93e-09

å¹³è¡¡å®šæ•°ã®æ¤œè¨¼:
  ç†è«–å€¤ K = 1.00e+06
  è¨ˆç®—å€¤ K = 1.00e+06</div>

        </section>

        <section class="content-section">
            <h2>3.6 ã¯ã•ã¿ã†ã¡æ³•ã®æ¯”è¼ƒ</h2>
            <p>
                ç¢ºå®Ÿæ€§ã‚’é‡è¦–ã™ã‚‹å ´åˆã€äºŒåˆ†æ³•ä»¥å¤–ã«ã‚‚Regula Falsiæ³•ï¼ˆå½ä½ç½®æ³•ï¼‰ã‚„Brentæ³•ãªã©ã®ã¯ã•ã¿ã†ã¡æ³•ãŒæœ‰åŠ¹ã§ã™ã€‚
            </p>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: ã¯ã•ã¿ã†ã¡æ³•ã®å®Ÿè£…ã¨æ¯”è¼ƒ</h3>
            <div class="code-example"><code>from scipy.optimize import brentq, ridder

def regula_falsi(f, a, b, tol=1e-10, max_iter=100):
    """
    Regula Falsiæ³•ï¼ˆå½ä½ç½®æ³•ï¼‰

    Parameters:
    -----------
    f : callable
        å¯¾è±¡é–¢æ•°
    a, b : float
        åˆæœŸåŒºé–“ [a, b]
    tol : float
        è¨±å®¹èª¤å·®
    max_iter : int
        æœ€å¤§åå¾©å›æ•°

    Returns:
    --------
    root : float
        è§£
    history : list
        åå¾©å±¥æ­´
    """
    fa = f(a)
    fb = f(b)

    if fa * fb > 0:
        raise ValueError("f(a) ã¨ f(b) ã¯ç•°ç¬¦å·ã§ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“")

    history = []

    for i in range(max_iter):
        # å‰²ç·šæ³•ã®å¼ã‚’ä½¿ç”¨
        c = (a * fb - b * fa) / (fb - fa)
        fc = f(c)
        history.append(c)

        if abs(fc) < tol:
            print(f"Regula Falsiæ³•: {i+1}å›ã®åå¾©ã§åæŸ")
            return c, history

        if fa * fc < 0:
            b = c
            fb = fc
        else:
            a = c
            fa = fc

    print(f"Regula Falsiæ³•: {max_iter}å›ã®åå¾©ã§åæŸã›ãš")
    return c, history

# ãƒ†ã‚¹ãƒˆé–¢æ•°
f = lambda x: x**3 - 2*x - 5

print("=" * 60)
print("ã¯ã•ã¿ã†ã¡æ³•ã®æ¯”è¼ƒ")
print("f(x) = xÂ³ - 2x - 5 = 0")
print("=" * 60)

a, b = 2.0, 3.0

# 1. äºŒåˆ†æ³•
root_bis, hist_bis = bisection_method(f, a, b, tol=1e-10)

# 2. Regula Falsiæ³•
root_rf, hist_rf = regula_falsi(f, a, b, tol=1e-10)

# 3. Brentæ³• (SciPy)
root_brent = brentq(f, a, b, xtol=1e-10)

# 4. Ridderæ³• (SciPy)
root_ridder = ridder(f, a, b, xtol=1e-10)

# çµæœã®æ¯”è¼ƒ
print("\nçµæœã®æ¯”è¼ƒ:")
print(f"{'æ‰‹æ³•':<20} {'åå¾©å›æ•°':>10} {'è§£':>18} {'f(x)':>12}")
print("-" * 65)
print(f"{'äºŒåˆ†æ³•':<20} {len(hist_bis):>10} {root_bis:>18.10f} {f(root_bis):>12.2e}")
print(f"{'Regula Falsiæ³•':<20} {len(hist_rf):>10} {root_rf:>18.10f} {f(root_rf):>12.2e}")
print(f"{'Brentæ³•':<20} {'-':>10} {root_brent:>18.10f} {f(root_brent):>12.2e}")
print(f"{'Ridderæ³•':<20} {'-':>10} {root_ridder:>18.10f} {f(root_ridder):>12.2e}")

# åæŸå±¥æ­´ã®å¯è¦–åŒ–
plt.figure(figsize=(12, 5))

# å·¦å›³: èª¤å·®ã®æ¨ç§»
plt.subplot(1, 2, 1)
errors_bis = [abs(x - root_bis) for x in hist_bis]
errors_rf = [abs(x - root_rf) for x in hist_rf]

plt.semilogy(errors_bis, 'o-', label='äºŒåˆ†æ³•', markersize=5, linewidth=2)
plt.semilogy(errors_rf, 's-', label='Regula Falsiæ³•', markersize=5, linewidth=2)
plt.xlabel('åå¾©å›æ•°', fontsize=12)
plt.ylabel('çµ¶å¯¾èª¤å·®', fontsize=12)
plt.title('åæŸé€Ÿåº¦ã®æ¯”è¼ƒ', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)

# å³å›³: å„æ‰‹æ³•ã®æ€§èƒ½æŒ‡æ¨™
plt.subplot(1, 2, 2)
methods = ['äºŒåˆ†æ³•', 'Regula\nFalsi', 'Brent', 'Ridder']
iterations = [len(hist_bis), len(hist_rf), 10, 8]  # Brentã¨Ridderã¯æ¨å®šå€¤

colors = ['#667eea', '#764ba2', '#48c774', '#3298dc']
bars = plt.bar(methods, iterations, color=colors, alpha=0.7)

for bar, it in zip(bars, iterations):
    height = bar.get_height()
    plt.text(bar.get_x() + bar.get_width()/2., height,
             f'{it}',
             ha='center', va='bottom', fontsize=11, fontweight='bold')

plt.ylabel('åå¾©å›æ•°ï¼ˆæ¦‚ç®—ï¼‰', fontsize=12)
plt.title('è¨ˆç®—åŠ¹ç‡ã®æ¯”è¼ƒ', fontsize=14)
plt.grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig('bracketing_methods_comparison.png', dpi=150, bbox_inches='tight')
plt.show()

print("\n" + "=" * 60)
print("ã¾ã¨ã‚:")
print("  - äºŒåˆ†æ³•: ç¢ºå®Ÿã ãŒé…ã„ï¼ˆç·šå½¢åæŸï¼‰")
print("  - Regula Falsi: äºŒåˆ†æ³•ã‚ˆã‚Šé«˜é€Ÿï¼ˆè¶…ç·šå½¢åæŸï¼‰")
print("  - Brentæ³•: æœ€ã‚‚åŠ¹ç‡çš„ï¼ˆ2æ¬¡åæŸã¨å®‰å®šæ€§ã‚’ä¸¡ç«‹ï¼‰")
print("  - Ridderæ³•: é«˜é€Ÿã§å®‰å®šï¼ˆæŒ‡æ•°çš„åæŸï¼‰")
print("=" * 60)
</code></div>

            <div class="output-box">============================================================
ã¯ã•ã¿ã†ã¡æ³•ã®æ¯”è¼ƒ
f(x) = xÂ³ - 2x - 5 = 0
============================================================
äºŒåˆ†æ³•: 36å›ã®åå¾©ã§åæŸ
Regula Falsiæ³•: 9å›ã®åå¾©ã§åæŸ

çµæœã®æ¯”è¼ƒ:
æ‰‹æ³•                      åå¾©å›æ•°                 è§£         f(x)
-----------------------------------------------------------------
äºŒåˆ†æ³•                         36     2.0945514815     0.00e+00
Regula Falsiæ³•                  9     2.0945514815     8.88e-16
Brentæ³•                         -     2.0945514815     0.00e+00
Ridderæ³•                        -     2.0945514815     0.00e+00

============================================================
ã¾ã¨ã‚:
  - äºŒåˆ†æ³•: ç¢ºå®Ÿã ãŒé…ã„ï¼ˆç·šå½¢åæŸï¼‰
  - Regula Falsi: äºŒåˆ†æ³•ã‚ˆã‚Šé«˜é€Ÿï¼ˆè¶…ç·šå½¢åæŸï¼‰
  - Brentæ³•: æœ€ã‚‚åŠ¹ç‡çš„ï¼ˆ2æ¬¡åæŸã¨å®‰å®šæ€§ã‚’ä¸¡ç«‹ï¼‰
  - Ridderæ³•: é«˜é€Ÿã§å®‰å®šï¼ˆæŒ‡æ•°çš„åæŸï¼‰
============================================================</div>

        </section>

        <section class="content-section">
            <h2>3.7 å®Ÿè·µä¾‹: ææ–™ç§‘å­¦ã¸ã®å¿œç”¨</h2>
            <p>
                éç·šå½¢æ–¹ç¨‹å¼ã¯ææ–™ç§‘å­¦ã®æ§˜ã€…ãªå ´é¢ã§ç¾ã‚Œã¾ã™ã€‚çŠ¶æ…‹æ–¹ç¨‹å¼ã€ç›¸å›³è¨ˆç®—ã€æ‹¡æ•£ä¿‚æ•°ã®æ±ºå®šãªã©ã®å®Ÿä¾‹ã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
            </p>

            <h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼ã®è§£æ³•</h3>
            <div class="code-example"><code>from scipy.optimize import fsolve

# van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼: (P + a/VÂ²)(V - b) = RT
# å®Ÿåœ¨æ°—ä½“ã®çŠ¶æ…‹ã‚’è¨˜è¿°

def van_der_waals(V, P, T, a, b, R=8.314):
    """
    van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼

    Parameters:
    -----------
    V : float
        ãƒ¢ãƒ«ä½“ç© [L/mol]
    P : float
        åœ§åŠ› [bar]
    T : float
        æ¸©åº¦ [K]
    a, b : float
        van der Waalså®šæ•°
    R : float
        æ°—ä½“å®šæ•° [J/(molÂ·K)]

    Returns:
    --------
    float
        æ–¹ç¨‹å¼ã®æ®‹å·®
    """
    # å˜ä½æ›ç®—: 1 bar = 10âµ Pa, 1 L = 10â»Â³ mÂ³
    P_Pa = P * 1e5
    V_m3 = V * 1e-3

    return (P_Pa + a / V_m3**2) * (V_m3 - b) - R * T

print("=" * 60)
print("å®Ÿè·µä¾‹: van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼")
print("=" * 60)

# COâ‚‚ã®van der Waalså®šæ•°
a_CO2 = 0.3658  # PaÂ·mâ¶/molÂ²
b_CO2 = 4.267e-5  # mÂ³/mol

T = 300  # K
P = 50   # bar

print(f"\nCOâ‚‚ @ T = {T} K, P = {P} bar")
print(f"van der Waalså®šæ•°: a = {a_CO2}, b = {b_CO2}")

# åˆæœŸæ¨å®šå€¤ï¼ˆç†æƒ³æ°—ä½“ã®å¼ã‹ã‚‰ï¼‰
V0 = 8.314 * T / (P * 1e5) * 1000  # L/mol

# van der Waalsæ–¹ç¨‹å¼ã‚’è§£ã
V_solution = fsolve(lambda V: van_der_waals(V, P, T, a_CO2, b_CO2), V0)[0]

print(f"\nè§£:")
print(f"  ãƒ¢ãƒ«ä½“ç© V = {V_solution:.6f} L/mol")
print(f"  ãƒ¢ãƒ«ä½“ç© V = {V_solution * 1e-3:.6e} mÂ³/mol")

# ç†æƒ³æ°—ä½“ã¨ã®æ¯”è¼ƒ
V_ideal = 8.314 * T / (P * 1e5) * 1000  # L/mol
print(f"\nç†æƒ³æ°—ä½“ã®ãƒ¢ãƒ«ä½“ç©: {V_ideal:.6f} L/mol")
print(f"ç›¸å¯¾èª¤å·®: {abs(V_solution - V_ideal) / V_ideal * 100:.2f}%")

# æ§˜ã€…ãªåœ§åŠ›ã§ã®è¨ˆç®—
print("\n" + "=" * 60)
print("åœ§åŠ›ä¾å­˜æ€§ã®è§£æ")
print("=" * 60)

pressures = np.logspace(0, 3, 50)  # 1 bar to 1000 bar
volumes_vdw = []
volumes_ideal = []

for P in pressures:
    V0 = 8.314 * T / (P * 1e5) * 1000
    try:
        V_vdw = fsolve(lambda V: van_der_waals(V, P, T, a_CO2, b_CO2), V0)[0]
        volumes_vdw.append(V_vdw)
    except:
        volumes_vdw.append(np.nan)

    V_id = 8.314 * T / (P * 1e5) * 1000
    volumes_ideal.append(V_id)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³: P-Vé–¢ä¿‚
ax1.loglog(pressures, volumes_vdw, 'b-', linewidth=2, label='van der Waals')
ax1.loglog(pressures, volumes_ideal, 'r--', linewidth=2, label='ç†æƒ³æ°—ä½“')
ax1.set_xlabel('åœ§åŠ› P [bar]', fontsize=12)
ax1.set_ylabel('ãƒ¢ãƒ«ä½“ç© V [L/mol]', fontsize=12)
ax1.set_title(f'COâ‚‚ã®çŠ¶æ…‹æ–¹ç¨‹å¼ (T = {T} K)', fontsize=14)
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)

# å³å›³: åœ§ç¸®ç‡å› å­ Z = PV/RT
Z_vdw = np.array(pressures) * 1e5 * np.array(volumes_vdw) * 1e-3 / (8.314 * T)
Z_ideal = np.ones_like(pressures)

ax2.semilogx(pressures, Z_vdw, 'b-', linewidth=2, label='van der Waals')
ax2.semilogx(pressures, Z_ideal, 'r--', linewidth=2, label='ç†æƒ³æ°—ä½“')
ax2.axhline(y=1, color='gray', linestyle=':', alpha=0.5)
ax2.set_xlabel('åœ§åŠ› P [bar]', fontsize=12)
ax2.set_ylabel('åœ§ç¸®ç‡å› å­ Z = PV/RT', fontsize=12)
ax2.set_title('å®Ÿåœ¨æ°—ä½“ã®éç†æƒ³æ€§', fontsize=14)
ax2.legend(fontsize=11)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('van_der_waals_equation.png', dpi=150, bbox_inches='tight')
plt.show()

# è‡¨ç•Œç‚¹ã®è¨ˆç®—
print("\n" + "=" * 60)
print("COâ‚‚ã®è‡¨ç•Œç‚¹")
print("=" * 60)

# è‡¨ç•Œå®šæ•°ï¼ˆç†è«–å€¤ï¼‰
T_c_theory = 8 * a_CO2 / (27 * 8.314 * b_CO2)
P_c_theory = a_CO2 / (27 * b_CO2**2) / 1e5  # bar
V_c_theory = 3 * b_CO2 * 1000  # L/mol

print(f"van der Waalsç†è«–:")
print(f"  è‡¨ç•Œæ¸©åº¦ Tc = {T_c_theory:.2f} K")
print(f"  è‡¨ç•Œåœ§åŠ› Pc = {P_c_theory:.2f} bar")
print(f"  è‡¨ç•Œä½“ç© Vc = {V_c_theory:.6f} L/mol")

print(f"\nå®Ÿé¨“å€¤ (COâ‚‚):")
print(f"  è‡¨ç•Œæ¸©åº¦ Tc = 304.13 K")
print(f"  è‡¨ç•Œåœ§åŠ› Pc = 73.77 bar")
print(f"\nç†è«–å€¤ã¯å®Ÿé¨“å€¤ã®æ¦‚ç®—ã¨ã—ã¦æœ‰ç”¨")
</code></div>

            <div class="output-box">============================================================
å®Ÿè·µä¾‹: van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼
============================================================

COâ‚‚ @ T = 300 K, P = 50 bar
van der Waalså®šæ•°: a = 0.3658, b = 4.267e-05

è§£:
  ãƒ¢ãƒ«ä½“ç© V = 0.048234 L/mol
  ãƒ¢ãƒ«ä½“ç© V = 4.823368e-05 mÂ³/mol

ç†æƒ³æ°—ä½“ã®ãƒ¢ãƒ«ä½“ç©: 0.049884 L/mol
ç›¸å¯¾èª¤å·®: 3.31%

============================================================
åœ§åŠ›ä¾å­˜æ€§ã®è§£æ
============================================================

============================================================
COâ‚‚ã®è‡¨ç•Œç‚¹
============================================================
van der Waalsç†è«–:
  è‡¨ç•Œæ¸©åº¦ Tc = 304.19 K
  è‡¨ç•Œåœ§åŠ› Pc = 73.03 bar
  è‡¨ç•Œä½“ç© Vc = 0.000128 L/mol

å®Ÿé¨“å€¤ (COâ‚‚):
  è‡¨ç•Œæ¸©åº¦ Tc = 304.13 K
  è‡¨ç•Œåœ§åŠ› Pc = 73.77 bar

ç†è«–å€¤ã¯å®Ÿé¨“å€¤ã®æ¦‚ç®—ã¨ã—ã¦æœ‰ç”¨</div>

        </section>

        <div class="exercise-section">
            <h3>ğŸ‹ï¸ æ¼”ç¿’å•é¡Œ</h3>

            <h4>æ¼”ç¿’1: åæŸé€Ÿåº¦ã®æ¯”è¼ƒ</h4>
            <p>
                æ–¹ç¨‹å¼ \( e^x - 3x = 0 \) ã‚’äºŒåˆ†æ³•ã€Newton-Raphsonæ³•ã€Secantæ³•ã§è§£ãã€åæŸé€Ÿåº¦ã‚’æ¯”è¼ƒã›ã‚ˆã€‚åŒºé–“ \([0, 1]\)ã€åˆæœŸå€¤ \( x_0 = 0.5 \) ã‚’ä½¿ç”¨ã€‚
            </p>

            <h4>æ¼”ç¿’2: å¤šå¤‰æ•°Newtonæ³•ã®å®Ÿè£…</h4>
            <p>
                æ¬¡ã®é€£ç«‹æ–¹ç¨‹å¼ã‚’å¤šå¤‰æ•°Newtonæ³•ã§è§£ã‘:
            </p>
            \[
            \begin{cases}
            x^2 - y - 1 = 0 \\
            x - y^2 + 1 = 0
            \end{cases}
            \]
            <p>
                åˆæœŸå€¤ \((x_0, y_0) = (1.5, 1.0)\) ã‹ã‚‰é–‹å§‹ã—ã€åæŸçµŒè·¯ã‚’å¯è¦–åŒ–ã›ã‚ˆã€‚
            </p>

            <h4>æ¼”ç¿’3: ã¯ã•ã¿ã†ã¡æ³•ã®é ‘å¥æ€§</h4>
            <p>
                æ¬¡ã®é–¢æ•°ã«å¯¾ã—ã¦ã€äºŒåˆ†æ³•ã¨Newton-Raphsonæ³•ã‚’æ¯”è¼ƒã›ã‚ˆ:
            </p>
            \[
            f(x) = x^3 - 2x^2 - 5
            \]
            <p>
                (a) åŒºé–“ \([2, 4]\) ã§ã®äºŒåˆ†æ³•<br>
                (b) åˆæœŸå€¤ \( x_0 = 0 \) ã§ã®Newton-Raphsonæ³•ï¼ˆç™ºæ•£ã™ã‚‹å¯èƒ½æ€§ã‚’ç¢ºèªï¼‰<br>
                (c) åˆæœŸå€¤ \( x_0 = 3 \) ã§ã®Newton-Raphsonæ³•
            </p>

            <h4>æ¼”ç¿’4: scipy.optimizeã®æ´»ç”¨</h4>
            <p>
                scipy.optimize.rootã‚’ä½¿ã£ã¦ã€æ¬¡ã®3å¤‰æ•°é€£ç«‹æ–¹ç¨‹å¼ã‚’è§£ã‘:
            </p>
            \[
            \begin{cases}
            x + y + z = 6 \\
            x^2 + y^2 + z^2 = 14 \\
            xyz = 6
            \end{cases}
            \]
            <p>
                ç•°ãªã‚‹åˆæœŸå€¤ã§è¤‡æ•°ã®è§£ã‚’è¦‹ã¤ã‘ã‚ˆã€‚
            </p>

            <h4>æ¼”ç¿’5: ææ–™ç§‘å­¦ã¸ã®å¿œç”¨</h4>
            <p>
                Arrheniuså¼ã‚’ä½¿ã£ãŸæ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®é€†å•é¡Œ:
            </p>
            \[
            k = A \exp\left(-\frac{E_a}{RT}\right)
            \]
            <p>
                2ã¤ã®æ¸©åº¦ã§ã®åå¿œé€Ÿåº¦å®šæ•°ãŒæ—¢çŸ¥ã®ã¨ãã€æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ \( E_a \) ã¨é »åº¦å› å­ \( A \) ã‚’æ±‚ã‚ã‚ˆ:
            </p>
            <ul>
                <li>\( k(300 \text{ K}) = 1.0 \times 10^{-5} \text{ s}^{-1} \)</li>
                <li>\( k(350 \text{ K}) = 5.0 \times 10^{-4} \text{ s}^{-1} \)</li>
            </ul>
            <p>
                (ãƒ’ãƒ³ãƒˆ: å¯¾æ•°ã‚’å–ã£ã¦ç·šå½¢åŒ–ã™ã‚‹ã‹ã€éç·šå½¢æœ€å°äºŒä¹—æ³•ã‚’ä½¿ã†)
            </p>
        </div>

        <section class="content-section">
            <h2>ã¾ã¨ã‚</h2>
            <p>
                æœ¬ç« ã§ã¯ã€éç·šå½¢æ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³•ã‚’ä½“ç³»çš„ã«å­¦ã³ã¾ã—ãŸ:
            </p>
            <ul>
                <li><strong>ã¯ã•ã¿ã†ã¡æ³•:</strong> äºŒåˆ†æ³•ã€Regula Falsiæ³•ã€Brentæ³•ã®ç¢ºå®Ÿæ€§ã¨åæŸé€Ÿåº¦</li>
                <li><strong>é–‹æ”¾æ³•:</strong> Newton-Raphsonæ³•ã€Secantæ³•ã®é«˜é€ŸåæŸã¨æ³¨æ„ç‚¹</li>
                <li><strong>å¤šå¤‰æ•°å•é¡Œ:</strong> Jacobiè¡Œåˆ—ã‚’ç”¨ã„ãŸå¤šå¤‰æ•°Newtonæ³•</li>
                <li><strong>å®Ÿè·µçš„ãƒ„ãƒ¼ãƒ«:</strong> scipy.optimizeã«ã‚ˆã‚‹é«˜åº¦ãªæ±‚è§£ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </li>
                <li><strong>ææ–™ç§‘å­¦å¿œç”¨:</strong> çŠ¶æ…‹æ–¹ç¨‹å¼ã€åŒ–å­¦å¹³è¡¡ãªã©ã®å®Ÿå•é¡Œ</li>
            </ul>
            <p>
                éç·šå½¢æ–¹ç¨‹å¼ã®è§£æ³•ã¯ã€æœ€é©åŒ–ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¨å®šã€é€†å•é¡Œãªã©å¹…åºƒã„å¿œç”¨ãŒã‚ã‚Šã¾ã™ã€‚æ¬¡ç« ã§ã¯ã€ã“ã‚Œã‚‰ã®åŸºç¤ã®ä¸Šã«ç«‹ã£ã¦ã€å¸¸å¾®åˆ†æ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³•ã‚’å­¦ã³ã¾ã™ã€‚
            </p>
        </section>

        <div class="navigation-buttons">
            <a href="chapter-2.html" class="nav-button secondary">â† ç¬¬2ç« </a>
            <a href="chapter-4.html" class="nav-button primary">ç¬¬4ç« ã¸ â†’</a>
        </div>
    </main>

    <footer style="margin-top: 4rem; padding: 2rem; background: #f8f9fa; border-radius: 12px; text-align: center; color: #666;">
        <p>&copy; 2025 FM Dojo. All rights reserved.</p>
    </footer>
</body>
</html>
