<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« : è§’é‹å‹•é‡ã¨ã‚¹ãƒ”ãƒ³ | é‡å­åŠ›å­¦</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8;
            color: #333;
            background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 1rem;
            text-align: center;
        }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; font-size: 1.1rem; }
        .container {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .content-box {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #667eea;
            margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid #667eea;
        }
        h3 {
            color: #764ba2;
            margin: 1.5rem 0 1rem 0;
        }
        .theory-box {
            background: #f8f9ff;
            padding: 1.5rem;
            border-left: 4px solid #667eea;
            margin: 1.5rem 0;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
}
        .code-comment { color: #6a9955; }
        .code-keyword { color: #569cd6; }
        .code-string { color: #ce9178; }
        .code-function { color: #dcdcaa; }
        .code-number { color: #b5cea8; }
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin: 2rem 0;
        }
        .nav-button {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 600;
            transition: transform 0.3s;
        }
        .nav-button:hover { transform: translateY(-2px); }
        ul, ol { margin-left: 2rem; margin-bottom: 1rem; }
        li { margin-bottom: 0.5rem; }
        .exercise {
            background: #fff9e6;
            padding: 1.5rem;
            border-left: 4px solid #ffc107;
            margin: 1.5rem 0;
        }
        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 4rem;
        }
    </style>
</head>
<body>
    <header>
        <h1>ç¬¬3ç« : è§’é‹å‹•é‡ã¨ã‚¹ãƒ”ãƒ³</h1>
        <p class="subtitle">Angular Momentum and Spin</p>
    </header>

    <div class="container">
        <div class="nav-buttons">
            <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« : 3æ¬¡å…ƒé‡å­ç³»</a>
            <a href="chapter-4.html" class="nav-button">ç¬¬4ç« : æ‘‚å‹•è«– â†’</a>
        </div>

        <div class="content-box">
            <h2>3.1 è§’é‹å‹•é‡æ¼”ç®—å­ã¨äº¤æ›é–¢ä¿‚</h2>

            <div class="theory-box">
                <h3>ğŸ“š è§’é‹å‹•é‡ä»£æ•°</h3>
                <p><strong>è§’é‹å‹•é‡æ¼”ç®—å­</strong>: \(\hat{\mathbf{L}} = \hat{\mathbf{r}} \times \hat{\mathbf{p}}\)</p>
                <p><strong>åŸºæœ¬äº¤æ›é–¢ä¿‚</strong>:</p>
                <p>\[
                [\hat{L}_x, \hat{L}_y] = i\hbar\hat{L}_z, \quad [\hat{L}_y, \hat{L}_z] = i\hbar\hat{L}_x, \quad [\hat{L}_z, \hat{L}_x] = i\hbar\hat{L}_y
                \]</p>
                <p><strong>æ˜‡é™æ¼”ç®—å­</strong>:</p>
                <p>\[
                \hat{L}_\pm = \hat{L}_x \pm i\hat{L}_y
                \]</p>
                <p>\[
                \hat{L}_\pm |l,m\rangle = \hbar\sqrt{l(l+1) - m(m\pm 1)} |l, m\pm 1\rangle
                \]</p>
                <p><strong>å›ºæœ‰å€¤</strong>:</p>
                <p>\[
                \hat{L}^2 |l,m\rangle = \hbar^2 l(l+1) |l,m\rangle, \quad \hat{L}_z |l,m\rangle = \hbar m |l,m\rangle
                \]</p>
            </div>

            <h3>æ˜‡é™æ¼”ç®—å­ã®å¯è¦–åŒ–</h3>

            <div class="code-example">
<span class="code-keyword">import</span> numpy <span class="code-keyword">as</span> np
<span class="code-keyword">import</span> matplotlib.pyplot <span class="code-keyword">as</span> plt
<span class="code-keyword">from</span> mpl_toolkits.mplot3d <span class="code-keyword">import</span> Axes3D

<span class="code-keyword">def</span> <span class="code-function">angular_momentum_eigenvalue</span>(l, m):
    <span class="code-string">"""è§’é‹å‹•é‡ã®å¤§ãã•"""</span>
    <span class="code-keyword">return</span> np.sqrt(l * (l + <span class="code-number">1</span>))

<span class="code-keyword">def</span> <span class="code-function">ladder_coefficient</span>(l, m, direction=<span class="code-string">'up'</span>):
    <span class="code-string">"""æ˜‡é™æ¼”ç®—å­ã®ä¿‚æ•°"""</span>
    <span class="code-keyword">if</span> direction == <span class="code-string">'up'</span>:
        <span class="code-keyword">return</span> np.sqrt(l * (l + <span class="code-number">1</span>) - m * (m + <span class="code-number">1</span>))
    <span class="code-keyword">else</span>:  <span class="code-comment"># down</span>
        <span class="code-keyword">return</span> np.sqrt(l * (l + <span class="code-number">1</span>) - m * (m - <span class="code-number">1</span>))

l = <span class="code-number">2</span>
m_values = np.arange(-l, l + <span class="code-number">1</span>)

fig, axes = plt.subplots(<span class="code-number">2</span>, <span class="code-number">2</span>, figsize=(<span class="code-number">12</span>, <span class="code-number">10</span>))

<span class="code-comment"># (1) è§’é‹å‹•é‡ãƒ™ã‚¯ãƒˆãƒ«å›³</span>
ax = fig.add_subplot(<span class="code-number">2</span>, <span class="code-number">2</span>, <span class="code-number">1</span>, projection=<span class="code-string">'3d'</span>)
L_magnitude = angular_momentum_eigenvalue(l, <span class="code-number">0</span>)

<span class="code-keyword">for</span> m <span class="code-keyword">in</span> m_values:
    <span class="code-comment"># L_zæˆåˆ†</span>
    z = m
    <span class="code-comment"># L_x, L_yã¯ä¸ç¢ºå®šï¼ˆå††éŒä¸Šï¼‰</span>
    theta = np.linspace(<span class="code-number">0</span>, <span class="code-number">2</span>*np.pi, <span class="code-number">50</span>)
    L_perp = np.sqrt(L_magnitude**<span class="code-number">2</span> - z**<span class="code-number">2</span>)
    x = L_perp * np.cos(theta)
    y = L_perp * np.sin(theta)
    z_circle = np.full_like(theta, z)

    ax.plot(x, y, z_circle, alpha=<span class="code-number">0.5</span>, linewidth=<span class="code-number">2</span>)
    ax.plot([<span class="code-number">0</span>, <span class="code-number">0</span>], [<span class="code-number">0</span>, <span class="code-number">0</span>], [<span class="code-number">0</span>, z], <span class="code-string">'r-'</span>, linewidth=<span class="code-number">2</span>, alpha=<span class="code-number">0.7</span>)

ax.set_xlabel(<span class="code-string">'Lâ‚“/â„'</span>)
ax.set_ylabel(<span class="code-string">'Láµ§/â„'</span>)
ax.set_zlabel(<span class="code-string">'Lz/â„'</span>)
ax.set_title(<span class="code-string">f'Angular Momentum Cones (l={l})'</span>, fontweight=<span class="code-string">'bold'</span>)

<span class="code-comment"># (2) æ˜‡é™æ¼”ç®—å­ã®ä½œç”¨</span>
axes[<span class="code-number">0</span>,<span class="code-number">1</span>].scatter(m_values, m_values, s=<span class="code-number">200</span>, alpha=<span class="code-number">0.7</span>, label=<span class="code-string">'States |l,mâŸ©'</span>)

<span class="code-keyword">for</span> m <span class="code-keyword">in</span> m_values[:-<span class="code-number">1</span>]:
    coef = ladder_coefficient(l, m, <span class="code-string">'up'</span>)
    axes[<span class="code-number">0</span>,<span class="code-number">1</span>].annotate(<span class="code-string">''</span>, xy=(m+<span class="code-number">1</span>, m+<span class="code-number">1</span>), xytext=(m, m),
                        arrowprops=<span class="code-keyword">dict</span>(arrowstyle=<span class="code-string">'->'</span>, lw=<span class="code-number">2</span>, color=<span class="code-string">'green'</span>))
    axes[<span class="code-number">0</span>,<span class="code-number">1</span>].text(m+<span class="code-number">0.5</span>, m+<span class="code-number">0.3</span>, <span class="code-string">f'Lâ‚Š {coef:.2f}'</span>, fontsize=<span class="code-number">8</span>, color=<span class="code-string">'green'</span>)

<span class="code-keyword">for</span> m <span class="code-keyword">in</span> m_values[<span class="code-number">1</span>:]:
    coef = ladder_coefficient(l, m, <span class="code-string">'down'</span>)
    axes[<span class="code-number">0</span>,<span class="code-number">1</span>].annotate(<span class="code-string">''</span>, xy=(m-<span class="code-number">1</span>, m-<span class="code-number">1</span>), xytext=(m, m),
                        arrowprops=<span class="code-keyword">dict</span>(arrowstyle=<span class="code-string">'->'</span>, lw=<span class="code-number">2</span>, color=<span class="code-string">'red'</span>))
    axes[<span class="code-number">0</span>,<span class="code-number">1</span>].text(m-<span class="code-number">0.5</span>, m-<span class="code-number">0.7</span>, <span class="code-string">f'Lâ‚‹ {coef:.2f}'</span>, fontsize=<span class="code-number">8</span>, color=<span class="code-string">'red'</span>)

axes[<span class="code-number">0</span>,<span class="code-number">1</span>].set_xlabel(<span class="code-string">'Magnetic Quantum Number m'</span>, fontsize=<span class="code-number">12</span>)
axes[<span class="code-number">0</span>,<span class="code-number">1</span>].set_ylabel(<span class="code-string">'m'</span>, fontsize=<span class="code-number">12</span>)
axes[<span class="code-number">0</span>,<span class="code-number">1</span>].set_title(<span class="code-string">'Ladder Operators Lâ‚Š/Lâ‚‹'</span>, fontsize=<span class="code-number">14</span>, fontweight=<span class="code-string">'bold'</span>)
axes[<span class="code-number">0</span>,<span class="code-number">1</span>].grid(<span class="code-keyword">True</span>, alpha=<span class="code-number">0.3</span>)

<span class="code-comment"># (3) è§’é‹å‹•é‡ã®å¤§ãã• vs m</span>
l_range = np.arange(<span class="code-number">0</span>, <span class="code-number">5</span>)
<span class="code-keyword">for</span> l_val <span class="code-keyword">in</span> l_range:
    m_vals = np.arange(-l_val, l_val + <span class="code-number">1</span>)
    L_mag = [angular_momentum_eigenvalue(l_val, <span class="code-number">0</span>)] * len(m_vals)
    axes[<span class="code-number">1</span>,<span class="code-number">0</span>].plot(m_vals, L_mag, <span class="code-string">'o-'</span>, label=<span class="code-string">f'l={l_val}'</span>, markersize=<span class="code-number">8</span>)

axes[<span class="code-number">1</span>,<span class="code-number">0</span>].set_xlabel(<span class="code-string">'Magnetic Quantum Number m'</span>, fontsize=<span class="code-number">12</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].set_ylabel(<span class="code-string">'|L|/â„ = âˆš(l(l+1))'</span>, fontsize=<span class="code-number">12</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].set_title(<span class="code-string">'Angular Momentum Magnitude'</span>, fontsize=<span class="code-number">14</span>, fontweight=<span class="code-string">'bold'</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].legend()
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].grid(<span class="code-keyword">True</span>, alpha=<span class="code-number">0.3</span>)

<span class="code-comment"># (4) ã‚µãƒãƒªãƒ¼</span>
axes[<span class="code-number">1</span>,<span class="code-number">1</span>].axis(<span class="code-string">'off'</span>)
info = <span class="code-string">f"""
Angular Momentum Algebra

Commutation Relations:
  [Lâ‚“, Láµ§] = iâ„Lz (cyclic)

Ladder Operators:
  Lâ‚Š = Lâ‚“ + iLáµ§
  Lâ‚‹ = Lâ‚“ - iLáµ§

Action on States:
  Lâ‚Š|l,mâŸ© = â„âˆš(l(l+1)-m(m+1))|l,m+1âŸ©
  Lâ‚‹|l,mâŸ© = â„âˆš(l(l+1)-m(m-1))|l,m-1âŸ©

Eigenvalues:
  LÂ²|l,mâŸ© = â„Â²l(l+1)|l,mâŸ©
  Lz|l,mâŸ© = â„m|l,mâŸ©

Example (l={l}):
  |L| = {angular_momentum_eigenvalue(l, 0):.3f}â„
  m âˆˆ {{{-l}, ..., {l}}}
  2l+1 = {2*l+1} states
"""</span>
axes[<span class="code-number">1</span>,<span class="code-number">1</span>].text(<span class="code-number">0.1</span>, <span class="code-number">0.5</span>, info, fontsize=<span class="code-number">10</span>, family=<span class="code-string">'monospace'</span>,
                   verticalalignment=<span class="code-string">'center'</span>)

plt.tight_layout()
plt.savefig(<span class="code-string">'angular_momentum_algebra.png'</span>, dpi=<span class="code-number">150</span>, bbox_inches=<span class="code-string">'tight'</span>)
plt.show()
</div>

            <h2>3.2 ã‚¹ãƒ”ãƒ³è§’é‹å‹•é‡</h2>

            <div class="theory-box">
                <h3>ğŸ“š ã‚¹ãƒ”ãƒ³1/2ã¨Pauliè¡Œåˆ—</h3>
                <p><strong>ã‚¹ãƒ”ãƒ³æ¼”ç®—å­</strong>: \(\hat{\mathbf{S}} = \frac{\hbar}{2}\boldsymbol{\sigma}\)</p>
                <p><strong>Pauliè¡Œåˆ—</strong>:</p>
                <p>\[
                \sigma_x = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}, \quad
                \sigma_y = \begin{pmatrix} 0 & -i \\ i & 0 \end{pmatrix}, \quad
                \sigma_z = \begin{pmatrix} 1 & 0 \\ 0 & -1 \end{pmatrix}
                \]</p>
                <p><strong>ã‚¹ãƒ”ãƒ³çŠ¶æ…‹</strong>:</p>
                <p>\[
                |\uparrow\rangle = \begin{pmatrix} 1 \\ 0 \end{pmatrix}, \quad
                |\downarrow\rangle = \begin{pmatrix} 0 \\ 1 \end{pmatrix}
                \]</p>
            </div>

            <div class="code-example">
<span class="code-keyword">def</span> <span class="code-function">pauli_matrices</span>():
    <span class="code-string">"""Pauliè¡Œåˆ—"""</span>
    sigma_x = np.array([[<span class="code-number">0</span>, <span class="code-number">1</span>], [<span class="code-number">1</span>, <span class="code-number">0</span>]], dtype=complex)
    sigma_y = np.array([[<span class="code-number">0</span>, -<span class="code-number">1j</span>], [<span class="code-number">1j</span>, <span class="code-number">0</span>]], dtype=complex)
    sigma_z = np.array([[<span class="code-number">1</span>, <span class="code-number">0</span>], [<span class="code-number">0</span>, -<span class="code-number">1</span>]], dtype=complex)
    <span class="code-keyword">return</span> sigma_x, sigma_y, sigma_z

<span class="code-keyword">def</span> <span class="code-function">spin_state</span>(theta, phi):
    <span class="code-string">"""ä¸€èˆ¬çš„ãªã‚¹ãƒ”ãƒ³çŠ¶æ…‹ |Î¸,Ï†âŸ©"""</span>
    <span class="code-keyword">return</span> np.array([
        np.cos(theta/<span class="code-number">2</span>),
        np.sin(theta/<span class="code-number">2</span>) * np.exp(<span class="code-number">1j</span> * phi)
    ])

<span class="code-keyword">def</span> <span class="code-function">bloch_vector</span>(state):
    <span class="code-string">"""Blochãƒ™ã‚¯ãƒˆãƒ«ã®è¨ˆç®—"""</span>
    sigma_x, sigma_y, sigma_z = pauli_matrices()
    x = np.real(state.conj() @ sigma_x @ state)
    y = np.real(state.conj() @ sigma_y @ state)
    z = np.real(state.conj() @ sigma_z @ state)
    <span class="code-keyword">return</span> x, y, z

fig = plt.figure(figsize=(<span class="code-number">14</span>, <span class="code-number">10</span>))

<span class="code-comment"># (1) Blochçƒ</span>
ax = fig.add_subplot(<span class="code-number">2</span>, <span class="code-number">2</span>, <span class="code-number">1</span>, projection=<span class="code-string">'3d'</span>)

<span class="code-comment"># çƒé¢</span>
u = np.linspace(<span class="code-number">0</span>, <span class="code-number">2</span> * np.pi, <span class="code-number">50</span>)
v = np.linspace(<span class="code-number">0</span>, np.pi, <span class="code-number">50</span>)
x_sphere = np.outer(np.cos(u), np.sin(v))
y_sphere = np.outer(np.sin(u), np.sin(v))
z_sphere = np.outer(np.ones(np.size(u)), np.cos(v))
ax.plot_surface(x_sphere, y_sphere, z_sphere, alpha=<span class="code-number">0.1</span>, color=<span class="code-string">'cyan'</span>)

<span class="code-comment"># ä¸»è¦ãªçŠ¶æ…‹ãƒ™ã‚¯ãƒˆãƒ«</span>
states_info = [
    (<span class="code-number">0</span>, <span class="code-number">0</span>, <span class="code-string">'|â†‘âŸ©'</span>, <span class="code-string">'blue'</span>),
    (np.pi, <span class="code-number">0</span>, <span class="code-string">'|â†“âŸ©'</span>, <span class="code-string">'red'</span>),
    (np.pi/<span class="code-number">2</span>, <span class="code-number">0</span>, <span class="code-string">'|â†’âŸ©'</span>, <span class="code-string">'green'</span>),
    (np.pi/<span class="code-number">2</span>, np.pi/<span class="code-number">2</span>, <span class="code-string">'|âŠ™âŸ©'</span>, <span class="code-string">'orange'</span>),
]

<span class="code-keyword">for</span> theta, phi, label, color <span class="code-keyword">in</span> states_info:
    state = spin_state(theta, phi)
    bx, by, bz = bloch_vector(state)
    ax.quiver(<span class="code-number">0</span>, <span class="code-number">0</span>, <span class="code-number">0</span>, bx, by, bz, color=color, arrow_length_ratio=<span class="code-number">0.15</span>,
              linewidth=<span class="code-number">3</span>, label=label)

ax.set_xlabel(<span class="code-string">'âŸ¨Ïƒâ‚“âŸ©'</span>)
ax.set_ylabel(<span class="code-string">'âŸ¨Ïƒáµ§âŸ©'</span>)
ax.set_zlabel(<span class="code-string">'âŸ¨ÏƒzâŸ©'</span>)
ax.set_title(<span class="code-string">'Bloch Sphere'</span>, fontweight=<span class="code-string">'bold'</span>)
ax.legend()

<span class="code-comment"># (2) Pauliè¡Œåˆ—ã®å›ºæœ‰å€¤</span>
ax2 = fig.add_subplot(<span class="code-number">2</span>, <span class="code-number">2</span>, <span class="code-number">2</span>)
sigma_x, sigma_y, sigma_z = pauli_matrices()

<span class="code-keyword">for</span> idx, (sigma, name) <span class="code-keyword">in</span> enumerate([(sigma_x, <span class="code-string">'Ïƒâ‚“'</span>), (sigma_y, <span class="code-string">'Ïƒáµ§'</span>), (sigma_z, <span class="code-string">'Ïƒz'</span>)]):
    eigenvalues = np.linalg.eigvalsh(sigma)
    ax2.plot([idx, idx], eigenvalues, <span class="code-string">'o-'</span>, markersize=<span class="code-number">15</span>, linewidth=<span class="code-number">3</span>)
    ax2.text(idx, <span class="code-number">1.2</span>, name, ha=<span class="code-string">'center'</span>, fontsize=<span class="code-number">14</span>, fontweight=<span class="code-string">'bold'</span>)

ax2.axhline(<span class="code-number">0</span>, color=<span class="code-string">'k'</span>, linestyle=<span class="code-string">'--'</span>, alpha=<span class="code-number">0.3</span>)
ax2.set_xticks([])
ax2.set_ylabel(<span class="code-string">'Eigenvalue'</span>, fontsize=<span class="code-number">12</span>)
ax2.set_title(<span class="code-string">'Pauli Matrix Eigenvalues (Â±1)'</span>, fontsize=<span class="code-number">14</span>, fontweight=<span class="code-string">'bold'</span>)
ax2.set_ylim(-<span class="code-number">1.5</span>, <span class="code-number">1.5</span>)
ax2.grid(<span class="code-keyword">True</span>, alpha=<span class="code-number">0.3</span>)

<span class="code-comment"># (3) æ¸¬å®šç¢ºç‡</span>
ax3 = fig.add_subplot(<span class="code-number">2</span>, <span class="code-number">2</span>, <span class="code-number">3</span>)
theta_range = np.linspace(<span class="code-number">0</span>, np.pi, <span class="code-number">100</span>)

<span class="code-keyword">for</span> phi_val, label <span class="code-keyword">in</span> [(<span class="code-number">0</span>, <span class="code-string">'Ï†=0'</span>), (np.pi/<span class="code-number">2</span>, <span class="code-string">'Ï†=Ï€/2'</span>)]:
    prob_up = []
    <span class="code-keyword">for</span> theta <span class="code-keyword">in</span> theta_range:
        state = spin_state(theta, phi_val)
        p_up = np.abs(state[<span class="code-number">0</span>])**<span class="code-number">2</span>
        prob_up.append(p_up)

    ax3.plot(theta_range * <span class="code-number">180</span>/np.pi, prob_up, label=label, linewidth=<span class="code-number">2</span>)

ax3.set_xlabel(<span class="code-string">'Î¸ (degrees)'</span>, fontsize=<span class="code-number">12</span>)
ax3.set_ylabel(<span class="code-string">'P(â†‘) = |âŸ¨â†‘|ÏˆâŸ©|Â²'</span>, fontsize=<span class="code-number">12</span>)
ax3.set_title(<span class="code-string">'Measurement Probability'</span>, fontsize=<span class="code-number">14</span>, fontweight=<span class="code-string">'bold'</span>)
ax3.legend()
ax3.grid(<span class="code-keyword">True</span>, alpha=<span class="code-number">0.3</span>)

<span class="code-comment"># (4) äº¤æ›é–¢ä¿‚ã®æ¤œè¨¼</span>
ax4 = fig.add_subplot(<span class="code-number">2</span>, <span class="code-number">2</span>, <span class="code-number">4</span>)
ax4.axis(<span class="code-string">'off'</span>)

<span class="code-comment"># äº¤æ›å­ã®è¨ˆç®—</span>
comm_xy = sigma_x @ sigma_y - sigma_y @ sigma_x
comm_yz = sigma_y @ sigma_z - sigma_z @ sigma_y
comm_zx = sigma_z @ sigma_x - sigma_x @ sigma_z

info = <span class="code-string">"""
Spin-1/2 Properties

Pauli Matrices:
  Ïƒâ‚“, Ïƒáµ§, Ïƒz (2Ã—2 Hermitian)
  Eigenvalues: Â±1
  {Ïƒáµ¢, Ïƒâ±¼} = 2Î´áµ¢â±¼I

Commutation Relations:
  [Ïƒâ‚“, Ïƒáµ§] = 2iÏƒz
  [Ïƒáµ§, Ïƒz] = 2iÏƒâ‚“
  [Ïƒz, Ïƒâ‚“] = 2iÏƒáµ§

Spin Operator:
  Åœ = (â„/2)ÏƒÌ‚
  |S| = (âˆš3/2)â„

Bloch Sphere:
  Pure states: surface
  Mixed states: interior
  |ÏˆâŸ© = cos(Î¸/2)|â†‘âŸ© + e^(iÏ†)sin(Î¸/2)|â†“âŸ©
"""</span>

ax4.text(<span class="code-number">0.1</span>, <span class="code-number">0.5</span>, info, fontsize=<span class="code-number">10</span>, family=<span class="code-string">'monospace'</span>,
         verticalalignment=<span class="code-string">'center'</span>)

plt.tight_layout()
plt.savefig(<span class="code-string">'spin_pauli_matrices.png'</span>, dpi=<span class="code-number">150</span>, bbox_inches=<span class="code-string">'tight'</span>)
plt.show()
</div>

            <h2>3.3 è§’é‹å‹•é‡ã®åˆæˆ</h2>

            <div class="theory-box">
                <h3>ğŸ“š Clebsch-Gordanä¿‚æ•°</h3>
                <p>2ã¤ã®è§’é‹å‹•é‡ \(\mathbf{J}_1\) ã¨ \(\mathbf{J}_2\) ã®åˆæˆ:</p>
                <p>\[
                |j_1 j_2; j m\rangle = \sum_{m_1 m_2} C_{j_1 m_1 j_2 m_2}^{j m} |j_1 m_1\rangle |j_2 m_2\rangle
                \]</p>
                <p>ã“ã“ã§ \(C_{j_1 m_1 j_2 m_2}^{j m}\) ã¯<strong>Clebsch-Gordanä¿‚æ•°</strong>ã§ã™ã€‚</p>
                <p><strong>åˆæˆå‰‡</strong>:</p>
                <p>\[
                |j_1 - j_2| \leq j \leq j_1 + j_2, \quad m = m_1 + m_2
                \]</p>
            </div>

            <div class="code-example">
<span class="code-keyword">from</span> sympy.physics.quantum.cg <span class="code-keyword">import</span> CG
<span class="code-keyword">from</span> sympy <span class="code-keyword">import</span> S

<span class="code-keyword">def</span> <span class="code-function">clebsch_gordan</span>(j1, m1, j2, m2, j, m):
    <span class="code-string">"""Clebsch-Gordanä¿‚æ•°ã®è¨ˆç®—"""</span>
    <span class="code-keyword">return</span> <span class="code-keyword">float</span>(CG(S(j1), S(m1), S(j2), S(m2), S(j), S(m)).doit())

<span class="code-comment"># 2ã¤ã®ã‚¹ãƒ”ãƒ³1/2ã®åˆæˆ</span>
j1, j2 = <span class="code-number">1</span>/<span class="code-number">2</span>, <span class="code-number">1</span>/<span class="code-number">2</span>

fig, axes = plt.subplots(<span class="code-number">2</span>, <span class="code-number">2</span>, figsize=(<span class="code-number">12</span>, <span class="code-number">10</span>))

<span class="code-comment"># (1) ã‚¹ãƒ”ãƒ³ä¸‰é‡é …(j=1)ã¨ä¸€é‡é …(j=0)</span>
triplet_states = [
    (<span class="code-number">1</span>/<span class="code-number">2</span>, <span class="code-number">1</span>/<span class="code-number">2</span>, <span class="code-number">1</span>, <span class="code-number">1</span>, <span class="code-string">'|1,1âŸ© = |â†‘â†‘âŸ©'</span>),
    (<span class="code-number">1</span>/<span class="code-number">2</span>, <span class="code-number">1</span>/<span class="code-number">2</span>, <span class="code-number">1</span>, <span class="code-number">0</span>, <span class="code-string">'|1,0âŸ© = (|â†‘â†“âŸ©+|â†“â†‘âŸ©)/âˆš2'</span>),
    (-<span class="code-number">1</span>/<span class="code-number">2</span>, -<span class="code-number">1</span>/<span class="code-number">2</span>, <span class="code-number">1</span>, -<span class="code-number">1</span>, <span class="code-string">'|1,-1âŸ© = |â†“â†“âŸ©'</span>),
]

singlet = (<span class="code-number">1</span>/<span class="code-number">2</span>, <span class="code-number">1</span>/<span class="code-number">2</span>, <span class="code-number">0</span>, <span class="code-number">0</span>, <span class="code-string">'|0,0âŸ© = (|â†‘â†“âŸ©-|â†“â†‘âŸ©)/âˆš2'</span>)

y_pos = <span class="code-number">0</span>
axes[<span class="code-number">0</span>,<span class="code-number">0</span>].text(<span class="code-number">0.5</span>, y_pos, <span class="code-string">'Triplet (S=1):'</span>, fontsize=<span class="code-number">12</span>, fontweight=<span class="code-string">'bold'</span>,
                color=<span class="code-string">'blue'</span>, ha=<span class="code-string">'center'</span>)
y_pos -= <span class="code-number">0.15</span>

<span class="code-keyword">for</span> _, _, _, m, label <span class="code-keyword">in</span> triplet_states:
    axes[<span class="code-number">0</span>,<span class="code-number">0</span>].text(<span class="code-number">0.5</span>, y_pos, label, fontsize=<span class="code-number">10</span>, ha=<span class="code-string">'center'</span>, family=<span class="code-string">'monospace'</span>)
    y_pos -= <span class="code-number">0.12</span>

y_pos -= <span class="code-number">0.1</span>
axes[<span class="code-number">0</span>,<span class="code-number">0</span>].text(<span class="code-number">0.5</span>, y_pos, <span class="code-string">'Singlet (S=0):'</span>, fontsize=<span class="code-number">12</span>, fontweight=<span class="code-string">'bold'</span>,
                color=<span class="code-string">'red'</span>, ha=<span class="code-string">'center'</span>)
y_pos -= <span class="code-number">0.15</span>
axes[<span class="code-number">0</span>,<span class="code-number">0</span>].text(<span class="code-number">0.5</span>, y_pos, singlet[<span class="code-number">4</span>], fontsize=<span class="code-number">10</span>, ha=<span class="code-string">'center'</span>, family=<span class="code-string">'monospace'</span>)

axes[<span class="code-number">0</span>,<span class="code-number">0</span>].set_xlim(<span class="code-number">0</span>, <span class="code-number">1</span>)
axes[<span class="code-number">0</span>,<span class="code-number">0</span>].set_ylim(-<span class="code-number">1</span>, <span class="code-number">0.2</span>)
axes[<span class="code-number">0</span>,<span class="code-number">0</span>].axis(<span class="code-string">'off'</span>)
axes[<span class="code-number">0</span>,<span class="code-number">0</span>].set_title(<span class="code-string">'Two Spin-1/2 Coupling'</span>, fontsize=<span class="code-number">14</span>, fontweight=<span class="code-string">'bold'</span>)

<span class="code-comment"># (2) CGä¿‚æ•°ã®è¡¨</span>
axes[<span class="code-number">0</span>,<span class="code-number">1</span>].axis(<span class="code-string">'off'</span>)
cg_text = <span class="code-string">"Clebsch-Gordan Coefficients\n"</span>
cg_text += <span class="code-string">"âŸ¨jâ‚mâ‚jâ‚‚mâ‚‚|jmâŸ© (jâ‚=jâ‚‚=1/2)\n\n"</span>

<span class="code-keyword">for</span> j <span class="code-keyword">in</span> [<span class="code-number">1</span>, <span class="code-number">0</span>]:
    cg_text += <span class="code-string">f"\nj={j}:\n"</span>
    <span class="code-keyword">for</span> m <span class="code-keyword">in</span> [<span class="code-number">1</span>, <span class="code-number">0</span>, -<span class="code-number">1</span>]:
        <span class="code-keyword">if</span> abs(m) > j:
            <span class="code-keyword">continue</span>
        <span class="code-keyword">for</span> m1 <span class="code-keyword">in</span> [<span class="code-number">1</span>/<span class="code-number">2</span>, -<span class="code-number">1</span>/<span class="code-number">2</span>]:
            m2 = m - m1
            <span class="code-keyword">if</span> abs(m2) <= <span class="code-number">1</span>/<span class="code-number">2</span>:
                coef = clebsch_gordan(<span class="code-number">1</span>/<span class="code-number">2</span>, m1, <span class="code-number">1</span>/<span class="code-number">2</span>, m2, j, m)
                <span class="code-keyword">if</span> abs(coef) > <span class="code-number">1e-10</span>:
                    cg_text += <span class="code-string">f"  |{m1:+.1f},{m2:+.1f}âŸ©: {coef:+.3f}\n"</span>

axes[<span class="code-number">0</span>,<span class="code-number">1</span>].text(<span class="code-number">0.1</span>, <span class="code-number">0.5</span>, cg_text, fontsize=<span class="code-number">9</span>, family=<span class="code-string">'monospace'</span>,
                   verticalalignment=<span class="code-string">'center'</span>)
axes[<span class="code-number">0</span>,<span class="code-number">1</span>].set_title(<span class="code-string">'CG Coefficients Table'</span>, fontsize=<span class="code-number">14</span>, fontweight=<span class="code-string">'bold'</span>)

<span class="code-comment"># (3) è§’é‹å‹•é‡åˆæˆã®å›³è§£</span>
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].arrow(<span class="code-number">0</span>, <span class="code-number">0</span>, <span class="code-number">1</span>, <span class="code-number">0</span>, head_width=<span class="code-number">0.1</span>, head_length=<span class="code-number">0.1</span>, fc=<span class="code-string">'blue'</span>, ec=<span class="code-string">'blue'</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].text(<span class="code-number">0.5</span>, -<span class="code-number">0.3</span>, <span class="code-string">'Jâ‚'</span>, fontsize=<span class="code-number">14</span>, ha=<span class="code-string">'center'</span>, color=<span class="code-string">'blue'</span>)

axes[<span class="code-number">1</span>,<span class="code-number">0</span>].arrow(<span class="code-number">1</span>, <span class="code-number">0</span>, <span class="code-number">0.5</span>, <span class="code-number">0.866</span>, head_width=<span class="code-number">0.1</span>, head_length=<span class="code-number">0.1</span>, fc=<span class="code-string">'green'</span>, ec=<span class="code-string">'green'</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].text(<span class="code-number">1.4</span>, <span class="code-number">0.5</span>, <span class="code-string">'Jâ‚‚'</span>, fontsize=<span class="code-number">14</span>, ha=<span class="code-string">'center'</span>, color=<span class="code-string">'green'</span>)

axes[<span class="code-number">1</span>,<span class="code-number">0</span>].arrow(<span class="code-number">0</span>, <span class="code-number">0</span>, <span class="code-number">1.5</span>, <span class="code-number">0.866</span>, head_width=<span class="code-number">0.1</span>, head_length=<span class="code-number">0.1</span>, fc=<span class="code-string">'red'</span>, ec=<span class="code-string">'red'</span>, linewidth=<span class="code-number">2</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].text(<span class="code-number">1</span>, <span class="code-number">1.2</span>, <span class="code-string">'J = Jâ‚ + Jâ‚‚'</span>, fontsize=<span class="code-number">14</span>, ha=<span class="code-string">'center'</span>, color=<span class="code-string">'red'</span>, fontweight=<span class="code-string">'bold'</span>)

axes[<span class="code-number">1</span>,<span class="code-number">0</span>].set_xlim(-<span class="code-number">0.5</span>, <span class="code-number">2</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].set_ylim(-<span class="code-number">0.5</span>, <span class="code-number">1.5</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].set_aspect(<span class="code-string">'equal'</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].set_title(<span class="code-string">'Vector Addition J = Jâ‚ + Jâ‚‚'</span>, fontsize=<span class="code-number">14</span>, fontweight=<span class="code-string">'bold'</span>)
axes[<span class="code-number">1</span>,<span class="code-number">0</span>].grid(<span class="code-keyword">True</span>, alpha=<span class="code-number">0.3</span>)

<span class="code-comment"># (4) åˆæˆå‰‡ã®ã‚µãƒãƒªãƒ¼</span>
axes[<span class="code-number">1</span>,<span class="code-number">1</span>].axis(<span class="code-string">'off'</span>)
summary = <span class="code-string">"""
Angular Momentum Addition

Coupling Rule:
  |jâ‚ - jâ‚‚| â‰¤ j â‰¤ jâ‚ + jâ‚‚
  m = mâ‚ + mâ‚‚

Examples:
  1/2 âŠ— 1/2 = 1 âŠ• 0
    (triplet + singlet)

  1 âŠ— 1/2 = 3/2 âŠ• 1/2
    (quartet + doublet)

  1 âŠ— 1 = 2 âŠ• 1 âŠ• 0
    (quintet + triplet + singlet)

Total States:
  (2jâ‚+1)(2jâ‚‚+1) = Î£(2j+1)

Symmetry:
  Triplet (S=1): symmetric
  Singlet (S=0): antisymmetric
"""</span>
axes[<span class="code-number">1</span>,<span class="code-number">1</span>].text(<span class="code-number">0.1</span>, <span class="code-number">0.5</span>, summary, fontsize=<span class="code-number">10</span>, family=<span class="code-string">'monospace'</span>,
                   verticalalignment=<span class="code-string">'center'</span>)

plt.tight_layout()
plt.savefig(<span class="code-string">'angular_momentum_addition.png'</span>, dpi=<span class="code-number">150</span>, bbox_inches=<span class="code-string">'tight'</span>)
plt.show()
</div>

            <div class="exercise">
                <h3>ğŸ¯ æ¼”ç¿’å•é¡Œ</h3>
                <ol>
                    <li><strong>æ˜‡é™æ¼”ç®—å­</strong>: l=3ã®çŠ¶æ…‹ã«å¯¾ã—ã¦æ˜‡é™æ¼”ç®—å­ã‚’ç¹°ã‚Šè¿”ã—ä½œç”¨ã•ã›ã€å…¨ã¦ã®|3,mâŸ©çŠ¶æ…‹ã‚’ç”Ÿæˆã›ã‚ˆã€‚</li>
                    <li><strong>Pauliè¡Œåˆ—ã®æ€§è³ª</strong>: Ïƒâ‚“Ïƒáµ§Ïƒz = iI ã‚’æ•°å€¤çš„ã«ç¢ºèªã›ã‚ˆã€‚</li>
                    <li><strong>ã‚¹ãƒ”ãƒ³å›è»¢</strong>: zè»¸å‘¨ã‚Šã®å›è»¢æ¼”ç®—å­ exp(-iÎ¸Ïƒz/2) ã‚’è¨ˆç®—ã—ã€Blochçƒä¸Šã§ã®å›è»¢ã‚’å¯è¦–åŒ–ã›ã‚ˆã€‚</li>
                    <li><strong>ä¸‰é‡é …-ä¸€é‡é …</strong>: 2é›»å­ç³»ã®ä¸‰é‡é …ã¨ä¸€é‡é …ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼å·®ï¼ˆäº¤æ›ç›¸äº’ä½œç”¨ï¼‰ã‚’è¨ˆç®—ã›ã‚ˆã€‚</li>
                </ol>
            </div>

            <h2>ã¾ã¨ã‚</h2>
            <p>æœ¬ç« ã§ã¯ã€è§’é‹å‹•é‡ã¨ã‚¹ãƒ”ãƒ³ã‚’å­¦ã³ã¾ã—ãŸ:</p>
            <ul>
                <li><strong>è§’é‹å‹•é‡ä»£æ•°</strong>: äº¤æ›é–¢ä¿‚ã€æ˜‡é™æ¼”ç®—å­ã€å›ºæœ‰å€¤</li>
                <li><strong>ã‚¹ãƒ”ãƒ³1/2</strong>: Pauliè¡Œåˆ—ã€Blochçƒã€æ¸¬å®šç¢ºç‡</li>
                <li><strong>è§’é‹å‹•é‡åˆæˆ</strong>: Clebsch-Gordanä¿‚æ•°ã€ä¸‰é‡é …ãƒ»ä¸€é‡é …</li>
            </ul>
            <p>æ¬¡ç« ã§ã¯ã€<strong>æ‘‚å‹•è«–ã¨æ•£ä¹±ç†è«–</strong>ã‚’å­¦ã³ã¾ã™ã€‚</p>
        </div>

        <div class="nav-buttons">
            <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« : 3æ¬¡å…ƒé‡å­ç³»</a>
            <a href="chapter-4.html" class="nav-button">ç¬¬4ç« : æ‘‚å‹•è«– â†’</a>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - Quantum Mechanics for Physics & Materials Science</p>
        <p>åŸºç¤æ•°ç†é“å ´ (Fundamentals of Mathematics & Physics)</p>
    </footer>
</body>
</html>
