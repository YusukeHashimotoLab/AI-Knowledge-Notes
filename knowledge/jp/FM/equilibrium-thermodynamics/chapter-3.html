<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« : ç›¸å¹³è¡¡ã¨ç›¸å›³ | åŸºç¤æ•°ç†é“å ´ - å¹³è¡¡ç†±åŠ›å­¦ã¨ç›¸è»¢ç§»</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-container {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise-box { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theory-box { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example-box { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        .navigation-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .btn { padding: 0.8rem 1.5rem; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .btn-primary { background: #667eea; }
        .btn-primary:hover { background: #764ba2; }
        .btn-secondary { background: #6c757d; }
        .btn-secondary:hover { background: #5a6268; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>
</head>
<body>
    <header>
        <h1>ç¬¬3ç« : ç›¸å¹³è¡¡ã¨ç›¸å›³</h1>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">å¹³è¡¡ç†±åŠ›å­¦ã¨ç›¸è»¢ç§»</a> &gt;
            ç¬¬3ç« 
        </div>

        <div class="content">
            <h2>ğŸ¯ å­¦ç¿’ç›®æ¨™</h2>
            <ul>
                <li>Gibbsã®ç›¸å¾‹ \(F = C - P + 2\) ã‚’ç†è§£ã—é©ç”¨ã§ãã‚‹</li>
                <li>Clausius-Clapeyronå¼ã‚’å°å‡ºã—è’¸æ°—åœ§æ›²ç·šã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼ã¨Maxwellæ§‹æˆã‚’ç†è§£ã™ã‚‹</li>
                <li>äºŒå…ƒç³»ç›¸å›³ï¼ˆå…±æ™¶å‹ã€åŒ…æ™¶å‹ã€å›ºæº¶ä½“å‹ï¼‰ã‚’èª­ã‚ã‚‹</li>
                <li>Lever ruleï¼ˆã¦ã“ã®è¦å‰‡ï¼‰ã§ç›¸åˆ†ç‡ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>ä¸‰å…ƒç³»ç›¸å›³ã®åŸºç¤ã‚’ç†è§£ã™ã‚‹</li>
                <li>ææ–™ç§‘å­¦ã«ãŠã‘ã‚‹ç›¸å›³ã®é‡è¦æ€§ã‚’èª¬æ˜ã§ãã‚‹</li>
            </ul>
        </div>

        <div class="content">
            <h2>ğŸ“– ç›¸å¹³è¡¡ã®åŸºç¤</h2>

            <div class="definition">
                <h3>ç›¸å¹³è¡¡æ¡ä»¶</h3>
                <p>2ã¤ã®ç›¸ Î±, Î² ãŒå¹³è¡¡ã«ã‚ã‚‹ãŸã‚ã®æ¡ä»¶ï¼š</p>
                <ul>
                    <li><strong>ç†±å¹³è¡¡</strong>: \(T^\alpha = T^\beta\)</li>
                    <li><strong>åŠ›å­¦å¹³è¡¡</strong>: \(P^\alpha = P^\beta\)</li>
                    <li><strong>åŒ–å­¦å¹³è¡¡</strong>: \(\mu_i^\alpha = \mu_i^\beta\) ï¼ˆå„æˆåˆ† i ã«ã¤ã„ã¦ï¼‰</li>
                </ul>
                <p>ã“ã“ã§ \(\mu_i\) ã¯æˆåˆ† i ã®åŒ–å­¦ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã§ã™ã€‚</p>
            </div>

            <h3>Gibbsã®ç›¸å¾‹</h3>
            <p><strong>Gibbs phase rule</strong>ã¯ã€ç³»ã®è‡ªç”±åº¦ã‚’æ±ºå®šã—ã¾ã™ï¼š</p>
            <p>\[
            F = C - P + 2
            \]</p>
            <ul>
                <li>\(F\): è‡ªç”±åº¦ï¼ˆç‹¬ç«‹ã«å¤‰åŒ–ã•ã›ã‚‰ã‚Œã‚‹å¤‰æ•°ã®æ•°ï¼‰</li>
                <li>\(C\): æˆåˆ†æ•°ï¼ˆç‹¬ç«‹ãªåŒ–å­¦ç¨®ã®æ•°ï¼‰</li>
                <li>\(P\): ç›¸ã®æ•°</li>
                <li>\(2\): æ¸©åº¦ã¨åœ§åŠ›</li>
            </ul>

            <p><strong>ä¾‹</strong>ï¼š</p>
            <ul>
                <li>æ°´ã®ä¸‰é‡ç‚¹: \(C = 1\), \(P = 3\) (å›ºä½“ãƒ»æ¶²ä½“ãƒ»æ°—ä½“) â†’ \(F = 0\) ï¼ˆè‡ªç”±åº¦ãªã—ã€ä¸€ç‚¹ã§æ±ºã¾ã‚‹ï¼‰</li>
                <li>æ°´ã®æ²¸ç‚¹æ›²ç·š: \(C = 1\), \(P = 2\) (æ¶²ä½“ãƒ»æ°—ä½“) â†’ \(F = 1\) ï¼ˆæ¸©åº¦ã‚’æ±ºã‚ã‚‹ã¨åœ§åŠ›ãŒæ±ºã¾ã‚‹ï¼‰</li>
                <li>äºŒå…ƒå…±æ™¶ç‚¹: \(C = 2\), \(P = 3\) â†’ \(F = 1\) ï¼ˆåœ§åŠ›å›ºå®šãªã‚‰æ¸©åº¦ãŒæ±ºã¾ã‚‹ï¼‰</li>
            </ul>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ3.1: Clausius-Clapeyronå¼ã«ã‚ˆã‚‹è’¸æ°—åœ§æ›²ç·š</h2>

            <div class="definition">
                <h3>Clausius-Clapeyronå¼</h3>
                <p>ç›¸å¹³è¡¡æ›²ç·šä¸Šã§ã®åœ§åŠ›ã¨æ¸©åº¦ã®é–¢ä¿‚ï¼š</p>
                <p>\[
                \frac{dP}{dT} = \frac{L}{T \Delta V}
                \]</p>
                <p>ã“ã“ã§ \(L\) ã¯ç›¸è»¢ç§»ã®æ½œç†±ã€\(\Delta V\) ã¯ç›¸è»¢ç§»ã«ä¼´ã†ä½“ç©å¤‰åŒ–ã§ã™ã€‚</p>

                <p>æ¶²ä½“-æ°—ä½“å¹³è¡¡ã®å ´åˆï¼ˆ\(V_{\text{gas}} \gg V_{\text{liquid}}\) ã‹ã¤ç†æƒ³æ°—ä½“è¿‘ä¼¼ï¼‰ï¼š</p>
                <p>\[
                \frac{d \ln P}{dT} = \frac{L_{\text{vap}}}{RT^2}
                \]</p>
                <p>ç©åˆ†ã™ã‚‹ã¨ï¼š</p>
                <p>\[
                \ln P = -\frac{L_{\text{vap}}}{RT} + C
                \]</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: è’¸æ°—åœ§æ›²ç·šã®è¨ˆç®—</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import odeint
from scipy.optimize import fsolve

# Clausius-Clapeyronå¼ã®ç©åˆ†å½¢
def vapor_pressure_clausius_clapeyron(T, L_vap, R, P0, T0):
    """Clausius-Clapeyronå¼ã«ã‚ˆã‚‹è’¸æ°—åœ§"""
    return P0 * np.exp(-L_vap / R * (1/T - 1/T0))

# æ°´ã®è’¸æ°—åœ§ãƒ‡ãƒ¼ã‚¿
R = 8.314  # J/(molÂ·K)
L_vap_water = 40660  # J/molï¼ˆ100â„ƒã§ã®è’¸ç™ºç†±ï¼‰
T0_water = 373.15  # K (100â„ƒ)
P0_water = 101325  # Pa (1 atm)

# æ¸©åº¦ç¯„å›²
T_range = np.linspace(273.15, 473.15, 200)  # 0-200â„ƒ

# è’¸æ°—åœ§æ›²ç·š
P_vapor_water = vapor_pressure_clausius_clapeyron(T_range, L_vap_water, R, P0_water, T0_water)

# ä»–ã®ç‰©è³ªï¼ˆã‚¨ã‚¿ãƒãƒ¼ãƒ«ï¼‰
L_vap_ethanol = 38560  # J/mol
T0_ethanol = 351.5  # K (78.3â„ƒ)
P0_ethanol = 101325  # Pa
P_vapor_ethanol = vapor_pressure_clausius_clapeyron(T_range, L_vap_ethanol, R, P0_ethanol, T0_ethanol)

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# è’¸æ°—åœ§æ›²ç·šï¼ˆç·šå½¢ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰
ax1 = axes[0]
ax1.plot(T_range - 273.15, P_vapor_water / 1e5, 'b-', linewidth=2, label='Hâ‚‚O')
ax1.plot(T_range - 273.15, P_vapor_ethanol / 1e5, 'r-', linewidth=2, label='Câ‚‚Hâ‚…OH')
ax1.axhline(1.0, color='gray', linestyle='--', alpha=0.5, label='1 atm')
ax1.set_xlabel('Temperature (Â°C)')
ax1.set_ylabel('Vapor pressure (bar)')
ax1.set_title('è’¸æ°—åœ§æ›²ç·šï¼ˆClausius-Clapeyronï¼‰')
ax1.legend()
ax1.grid(True, alpha=0.3)

# è’¸æ°—åœ§æ›²ç·šï¼ˆå¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰
ax2 = axes[1]
ax2.semilogy(T_range - 273.15, P_vapor_water / 1e5, 'b-', linewidth=2, label='Hâ‚‚O')
ax2.semilogy(T_range - 273.15, P_vapor_ethanol / 1e5, 'r-', linewidth=2, label='Câ‚‚Hâ‚…OH')
ax2.axhline(1.0, color='gray', linestyle='--', alpha=0.5, label='1 atm')
ax2.set_xlabel('Temperature (Â°C)')
ax2.set_ylabel('Vapor pressure (bar, log scale)')
ax2.set_title('è’¸æ°—åœ§æ›²ç·šï¼ˆå¯¾æ•°ãƒ—ãƒ­ãƒƒãƒˆï¼‰')
ax2.legend()
ax2.grid(True, alpha=0.3, which='both')

plt.tight_layout()
plt.savefig('phase_vapor_pressure_clausius_clapeyron.png', dpi=300, bbox_inches='tight')
plt.show()

# æ²¸ç‚¹ã®è¨ˆç®—
def boiling_point(P_target, L_vap, R, P0, T0):
    """æŒ‡å®šåœ§åŠ›ã§ã®æ²¸ç‚¹ã‚’è¨ˆç®—"""
    # ln(P) = -L/(RT) + C ã‚’ T ã«ã¤ã„ã¦è§£ã
    T = 1 / (1/T0 - R/L_vap * np.log(P_target / P0))
    return T

# æ§˜ã€…ãªåœ§åŠ›ã§ã®æ²¸ç‚¹
pressures = [0.5e5, 1.0e5, 2.0e5, 5.0e5]  # Pa
print("=== Clausius-Clapeyronå¼ã«ã‚ˆã‚‹æ²¸ç‚¹äºˆæ¸¬ ===\n")
print(f"{'åœ§åŠ› (bar)':<15} {'æ°´ã®æ²¸ç‚¹ (Â°C)':<20} {'ã‚¨ã‚¿ãƒãƒ¼ãƒ«ã®æ²¸ç‚¹ (Â°C)':<25}")
print("-" * 60)

for P in pressures:
    T_bp_water = boiling_point(P, L_vap_water, R, P0_water, T0_water)
    T_bp_ethanol = boiling_point(P, L_vap_ethanol, R, P0_ethanol, T0_ethanol)
    print(f"{P/1e5:<15.1f} {T_bp_water - 273.15:<20.2f} {T_bp_ethanol - 273.15:<25.2f}")

# Antoineå¼ã¨ã®æ¯”è¼ƒ
print("\n=== å®Ÿé¨“å€¤ã¨ã®æ¯”è¼ƒï¼ˆæ°´ã€1 atmï¼‰===")
print(f"Clausius-Clapeyron: {boiling_point(101325, L_vap_water, R, P0_water, T0_water) - 273.15:.2f} Â°C")
print(f"å®Ÿé¨“å€¤: 100.00 Â°C")
print("\nClausius-Clapeyronå¼ã¯æ¸©åº¦ç¯„å›²ãŒç‹­ã„å ´åˆã«é«˜ç²¾åº¦")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ3.2: van der Waalsç­‰æ¸©ç·šã¨Maxwellæ§‹æˆ</h2>

            <div class="definition">
                <h3>van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼</h3>
                <p>\[
                \left(P + \frac{a}{V^2}\right)(V - b) = RT
                \]</p>
                <p>è‡¨ç•Œç‚¹ä»¥ä¸‹ã®æ¸©åº¦ã§ã¯ã€ç­‰æ¸©ç·šãŒéç‰©ç†çš„ãªé ˜åŸŸï¼ˆ\(\frac{\partial P}{\partial V} > 0\)ï¼‰ã‚’æŒã¡ã¾ã™ã€‚</p>

                <p><strong>Maxwellæ§‹æˆ</strong>: æ°—æ¶²å…±å­˜é ˜åŸŸã§ç­‰é¢ç©å‰‡ã«ã‚ˆã‚Šåœ§åŠ›ã‚’æ±ºå®š</p>
                <p>\[
                \int_{V_L}^{V_G} P_{\text{vdW}}(V) dV = P_{\text{eq}}(V_G - V_L)
                \]</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: van der Waalsç­‰æ¸©ç·šã¨Maxwellæ§‹æˆ</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import fsolve, minimize

# van der Waalsåœ§åŠ›
def P_vdw(V, T, a, b, R):
    """van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼"""
    return R * T / (V - b) - a / V**2

# COâ‚‚ã®van der Waalsãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
R = 8.314e-6  # MPaÂ·mÂ³/(molÂ·K)
a = 0.3658  # MPaÂ·mâ¶/molÂ²
b = 4.267e-5  # mÂ³/mol

# è‡¨ç•Œç‚¹
T_c = 8 * a / (27 * R * b)
P_c = a / (27 * b**2)
V_c = 3 * b

print(f"=== COâ‚‚ã®è‡¨ç•Œç‚¹ ===")
print(f"T_c = {T_c:.2f} K = {T_c - 273.15:.2f} Â°C")
print(f"P_c = {P_c:.4f} MPa")
print(f"V_c = {V_c * 1e6:.2f} cmÂ³/mol\n")

# Maxwellæ§‹æˆã®å®Ÿè£…
def maxwell_construction(T, a, b, R):
    """Maxwellæ§‹æˆã«ã‚ˆã‚Šå¹³è¡¡åœ§åŠ›ã‚’è¨ˆç®—"""
    # van der Waalsç­‰æ¸©ç·šã®æ¥µå€¤ã‚’æ±‚ã‚ã‚‹
    def dP_dV(V):
        return -R * T / (V - b)**2 + 2 * a / V**3

    # ã‚¹ãƒ”ãƒãƒ¼ãƒ€ãƒ«ç‚¹ï¼ˆdP/dV = 0ï¼‰
    V_range = np.linspace(b * 1.1, 10 * b, 1000)
    candidates = []

    for i in range(len(V_range) - 1):
        V1, V2 = V_range[i], V_range[i+1]
        if dP_dV(V1) * dP_dV(V2) < 0:
            V_spin = fsolve(dP_dV, (V1 + V2) / 2)[0]
            candidates.append(V_spin)

    if len(candidates) < 2:
        return None, None, None

    V_spin_min, V_spin_max = sorted(candidates)[:2]

    # Maxwellç­‰é¢ç©å‰‡
    def area_difference(P_eq):
        # P_eq ã‚ˆã‚Šä¸‹ã®é¢ç© - ä¸Šã®é¢ç©
        def integrand_lower(V):
            return P_vdw(V, T, a, b, R) - P_eq

        from scipy.integrate import quad
        area_lower, _ = quad(integrand_lower, V_spin_min, V_spin_max)
        return area_lower

    # P_eqã‚’æ¢ç´¢
    P_min = P_vdw(V_spin_max, T, a, b, R)
    P_max = P_vdw(V_spin_min, T, a, b, R)
    P_eq = fsolve(area_difference, (P_min + P_max) / 2)[0]

    # æ°—æ¶²ã®ä½“ç©ã‚’æ±‚ã‚ã‚‹
    def find_volumes(P_eq):
        V_liquid = fsolve(lambda V: P_vdw(V, T, a, b, R) - P_eq, V_spin_min)[0]
        V_gas = fsolve(lambda V: P_vdw(V, T, a, b, R) - P_eq, V_spin_max)[0]
        return V_liquid, V_gas

    V_L, V_G = find_volumes(P_eq)

    return P_eq, V_L, V_G

# è¤‡æ•°æ¸©åº¦ã§ã®ç­‰æ¸©ç·š
temperatures = [280, 300, T_c, 320, 350]  # K
colors = ['blue', 'green', 'red', 'orange', 'purple']

fig, ax = plt.subplots(figsize=(10, 8))

V_plot = np.linspace(b * 1.05, 10 * b, 1000)

for T, color in zip(temperatures, colors):
    P_plot = [P_vdw(V, T, a, b, R) for V in V_plot]

    if T < T_c:
        label = f'T = {T:.0f} K (< T_c)'
        ax.plot(V_plot * 1e6, P_plot, color=color, linestyle='--',
                linewidth=1.5, alpha=0.5)

        # Maxwellæ§‹æˆ
        P_eq, V_L, V_G = maxwell_construction(T, a, b, R)
        if P_eq is not None:
            ax.plot([V_L * 1e6, V_G * 1e6], [P_eq, P_eq],
                   color=color, linewidth=2.5, label=label)
    elif T == T_c:
        label = f'T = {T:.0f} K (= T_c)'
        ax.plot(V_plot * 1e6, P_plot, color=color, linewidth=2.5, label=label)
    else:
        label = f'T = {T:.0f} K (> T_c)'
        ax.plot(V_plot * 1e6, P_plot, color=color, linewidth=2, label=label)

# è‡¨ç•Œç‚¹ã‚’ãƒãƒ¼ã‚¯
ax.plot(V_c * 1e6, P_c, 'ko', markersize=10, label='è‡¨ç•Œç‚¹')

ax.set_xlabel('Molar volume (cmÂ³/mol)')
ax.set_ylabel('Pressure (MPa)')
ax.set_title('van der Waalsç­‰æ¸©ç·šã¨Maxwellæ§‹æˆï¼ˆCOâ‚‚ï¼‰')
ax.set_xlim([0, 500])
ax.set_ylim([0, 15])
ax.legend()
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('phase_vdw_maxwell_construction.png', dpi=300, bbox_inches='tight')
plt.show()

# Maxwellæ§‹æˆã®æ•°å€¤çµæœ
print("=== Maxwellæ§‹æˆã«ã‚ˆã‚‹æ°—æ¶²å¹³è¡¡ ===\n")
print(f"{'æ¸©åº¦ (K)':<12} {'å¹³è¡¡åœ§åŠ› (MPa)':<18} {'æ¶²ä½“V (cmÂ³/mol)':<20} {'æ°—ä½“V (cmÂ³/mol)':<20}")
print("-" * 70)
for T in [280, 290, 300]:
    P_eq, V_L, V_G = maxwell_construction(T, a, b, R)
    if P_eq is not None:
        print(f"{T:<12.0f} {P_eq:<18.4f} {V_L*1e6:<20.2f} {V_G*1e6:<20.2f}")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ3.3: äºŒå…ƒç³»ç›¸å›³ã®æç”»ï¼ˆå…±æ™¶å‹ï¼‰</h2>

            <div class="definition">
                <h3>äºŒå…ƒç³»ç›¸å›³ã®åˆ†é¡</h3>
                <ul>
                    <li><strong>å…±æ™¶å‹ï¼ˆEutecticï¼‰</strong>: æœ€ä½èç‚¹ã‚’æŒã¤å…±æ™¶ç‚¹ãŒå­˜åœ¨</li>
                    <li><strong>åŒ…æ™¶å‹ï¼ˆPeritecticï¼‰</strong>: æ¶²ç›¸ã‹ã‚‰2ã¤ã®å›ºç›¸ãŒç”Ÿæˆ</li>
                    <li><strong>å…¨ç‡å›ºæº¶ä½“å‹</strong>: å…¨çµ„æˆç¯„å›²ã§å›ºæº¶ä½“ã‚’å½¢æˆ</li>
                    <li><strong>åæ™¶å‹ï¼ˆMonotecticï¼‰</strong>: æ¶²ç›¸åˆ†é›¢ãŒèµ·ã“ã‚‹</li>
                </ul>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: å…±æ™¶å‹äºŒå…ƒç³»ç›¸å›³</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# Pb-Snç³»ã®ç°¡ç•¥ãƒ¢ãƒ‡ãƒ«ï¼ˆå…±æ™¶å‹ï¼‰
# å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãç°¡ç•¥åŒ–ã—ãŸç›¸å›³

def pb_sn_phase_diagram():
    """Pb-Snå…±æ™¶ç³»ã®ç›¸å›³ãƒ‡ãƒ¼ã‚¿"""
    # çµ„æˆï¼ˆSnåŸå­åˆ†ç‡ï¼‰
    x_Sn = np.array([0.0, 0.1, 0.183, 0.183, 0.5, 0.619, 0.619, 0.8, 1.0])

    # æ¶²ç›¸ç·šï¼ˆLiquidusï¼‰
    T_liquidus = np.array([327, 300, 183, 183, 220, 183, 183, 210, 232])  # Â°C

    # å›ºç›¸ç·šï¼ˆSolidusï¼‰- Î±ç›¸ï¼ˆPb-richï¼‰
    x_alpha = np.array([0.0, 0.05, 0.183])
    T_alpha = np.array([327, 250, 183])

    # å›ºç›¸ç·š - Î²ç›¸ï¼ˆSn-richï¼‰
    x_beta = np.array([0.619, 0.8, 1.0])
    T_beta = np.array([183, 210, 232])

    # å…±æ™¶æ¸©åº¦
    T_eutectic = 183  # Â°C
    x_eutectic = 0.619  # Sn 61.9%

    return {
        'liquidus': (x_Sn, T_liquidus),
        'alpha_solidus': (x_alpha, T_alpha),
        'beta_solidus': (x_beta, T_beta),
        'eutectic_T': T_eutectic,
        'eutectic_x': x_eutectic
    }

# ç›¸å›³ã®æç”»
phase_data = pb_sn_phase_diagram()

fig, ax = plt.subplots(figsize=(10, 8))

# æ¶²ç›¸ç·š
x_liq, T_liq = phase_data['liquidus']
ax.plot(x_liq * 100, T_liq, 'r-', linewidth=2.5, label='æ¶²ç›¸ç·šï¼ˆLiquidusï¼‰')

# Î±ç›¸å›ºç›¸ç·š
x_alpha, T_alpha = phase_data['alpha_solidus']
ax.plot(x_alpha * 100, T_alpha, 'b-', linewidth=2.5, label='Î±ç›¸å›ºç›¸ç·šï¼ˆPb-richï¼‰')

# Î²ç›¸å›ºç›¸ç·š
x_beta, T_beta = phase_data['beta_solidus']
ax.plot(x_beta * 100, T_beta, 'g-', linewidth=2.5, label='Î²ç›¸å›ºç›¸ç·šï¼ˆSn-richï¼‰')

# å…±æ™¶ç·š
T_e = phase_data['eutectic_T']
ax.axhline(T_e, color='orange', linestyle='--', linewidth=2, label=f'å…±æ™¶æ¸©åº¦ï¼ˆ{T_e}Â°Cï¼‰')

# å…±æ™¶ç‚¹
x_e = phase_data['eutectic_x']
ax.plot(x_e * 100, T_e, 'ko', markersize=12, label=f'å…±æ™¶ç‚¹ï¼ˆSn {x_e*100:.1f}%ï¼‰')

# é ˜åŸŸã®ãƒ©ãƒ™ãƒ«
ax.text(10, 280, 'Lï¼ˆæ¶²ç›¸ï¼‰', fontsize=14, ha='center', bbox=dict(boxstyle='round', facecolor='white', alpha=0.8))
ax.text(10, 210, 'L + Î±', fontsize=12, ha='center')
ax.text(70, 210, 'L + Î²', fontsize=12, ha='center')
ax.text(10, 150, 'Î±ï¼ˆPb-richå›ºæº¶ä½“ï¼‰', fontsize=12, ha='center')
ax.text(70, 150, 'Î²ï¼ˆSn-richå›ºæº¶ä½“ï¼‰', fontsize=12, ha='center')
ax.text(30, 170, 'Î± + Î²ï¼ˆå…±æ™¶çµ„ç¹”ï¼‰', fontsize=11, ha='center')

ax.set_xlabel('Snæ¿ƒåº¦ (at%)', fontsize=12)
ax.set_ylabel('æ¸©åº¦ (Â°C)', fontsize=12)
ax.set_title('Pb-SnäºŒå…ƒç³»ç›¸å›³ï¼ˆå…±æ™¶å‹ï¼‰', fontsize=14, fontweight='bold')
ax.set_xlim([0, 100])
ax.set_ylim([100, 350])
ax.legend(loc='upper right', fontsize=10)
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('phase_diagram_pb_sn_eutectic.png', dpi=300, bbox_inches='tight')
plt.show()

# ç›¸å›³æƒ…å ±ã®å‡ºåŠ›
print("=== Pb-Snå…±æ™¶ç³»ç›¸å›³ ===\n")
print(f"å…±æ™¶ç‚¹: Sn {x_e*100:.1f}%, æ¸©åº¦ {T_e}Â°C")
print(f"Pbèç‚¹: 327Â°C")
print(f"Snèç‚¹: 232Â°C")
print(f"æœ€ä½èç‚¹: {T_e}Â°Cï¼ˆå…±æ™¶æ¸©åº¦ï¼‰")
print("\nç”¨é€”: ãƒãƒ³ãƒ€ï¼ˆå…±æ™¶çµ„æˆã«è¿‘ã„ Sn-37Pb ãŒä¼çµ±çš„ï¼‰")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ3.4: Lever ruleï¼ˆã¦ã“ã®è¦å‰‡ï¼‰ã®è¨ˆç®—</h2>

            <div class="definition">
                <h3>Lever ruleï¼ˆã¦ã“ã®è¦å‰‡ï¼‰</h3>
                <p>2ç›¸å…±å­˜é ˜åŸŸã§å„ç›¸ã®é‡ã‚’æ±‚ã‚ã‚‹è¦å‰‡ï¼š</p>
                <p>çµ„æˆ \(x_0\) ã®åˆé‡‘ãŒæ¸©åº¦ \(T\) ã§ Î±ç›¸ï¼ˆçµ„æˆ \(x_\alpha\)ï¼‰ã¨ Î²ç›¸ï¼ˆçµ„æˆ \(x_\beta\)ï¼‰ã«åˆ†é›¢ã™ã‚‹ã¨ãï¼š</p>
                <p>\[
                \frac{f_\alpha}{f_\beta} = \frac{x_\beta - x_0}{x_0 - x_\alpha}
                \]</p>
                <p>ç›¸åˆ†ç‡:</p>
                <p>\[
                f_\alpha = \frac{x_\beta - x_0}{x_\beta - x_\alpha}, \quad f_\beta = \frac{x_0 - x_\alpha}{x_\beta - x_\alpha}
                \]</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: Lever ruleã®è¨ˆç®—ã¨å¯è¦–åŒ–</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

def lever_rule(x0, x_alpha, x_beta):
    """Lever ruleã«ã‚ˆã‚Šç›¸åˆ†ç‡ã‚’è¨ˆç®—

    Args:
        x0: å…¨ä½“çµ„æˆ
        x_alpha: Î±ç›¸çµ„æˆ
        x_beta: Î²ç›¸çµ„æˆ

    Returns:
        f_alpha, f_beta: å„ç›¸ã®åˆ†ç‡
    """
    f_beta = (x0 - x_alpha) / (x_beta - x_alpha)
    f_alpha = 1 - f_beta
    return f_alpha, f_beta

# Pb-Snç³»ã§ã®å…·ä½“ä¾‹
# å…¨ä½“çµ„æˆ: Sn 40%ã€æ¸©åº¦ 200Â°C ã§ã® Î± + Î² é ˜åŸŸ

x0 = 0.40  # Sn 40%
T = 200  # Â°C

# ã“ã®æ¸©åº¦ã§ã®å„ç›¸ã®çµ„æˆï¼ˆç›¸å›³ã‹ã‚‰èª­ã¿å–ã‚Šï¼‰
x_alpha = 0.15  # Î±ç›¸ï¼ˆPb-richï¼‰ã®Snæ¿ƒåº¦
x_beta = 0.90   # Î²ç›¸ï¼ˆSn-richï¼‰ã®Snæ¿ƒåº¦

# Lever ruleè¨ˆç®—
f_alpha, f_beta = lever_rule(x0, x_alpha, x_beta)

print("=== Lever ruleï¼ˆã¦ã“ã®è¦å‰‡ï¼‰ã®é©ç”¨ ===\n")
print(f"ç³»: Pb-Snåˆé‡‘ã€å…¨ä½“çµ„æˆ Sn {x0*100:.0f}%ã€æ¸©åº¦ {T}Â°C")
print(f"Î±ç›¸çµ„æˆ: Sn {x_alpha*100:.0f}% (Pb-rich)")
print(f"Î²ç›¸çµ„æˆ: Sn {x_beta*100:.0f}% (Sn-rich)")
print(f"\nç›¸åˆ†ç‡:")
print(f"  Î±ç›¸: {f_alpha*100:.2f}%")
print(f"  Î²ç›¸: {f_beta*100:.2f}%")
print(f"\næ¤œè¨¼: f_Î± + f_Î² = {f_alpha + f_beta:.4f} (should be 1.000)")

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# ã¦ã“ã®å›³è§£
ax1 = axes[0]
ax1.plot([x_alpha, x_beta], [1, 1], 'ko-', linewidth=2, markersize=10)
ax1.plot(x0, 1, 'r^', markersize=15, label=f'å…¨ä½“çµ„æˆ (Sn {x0*100:.0f}%)')

# ã¦ã“ã®è…•
ax1.plot([x_alpha, x0], [0.95, 0.95], 'b-', linewidth=3, label=f'Î²å´ã®è…• (L_Î²)')
ax1.plot([x0, x_beta], [0.95, 0.95], 'g-', linewidth=3, label=f'Î±å´ã®è…• (L_Î±)')

ax1.text(x_alpha, 1.05, f'Î±ç›¸\n(Sn {x_alpha*100:.0f}%)', ha='center', fontsize=11)
ax1.text(x_beta, 1.05, f'Î²ç›¸\n(Sn {x_beta*100:.0f}%)', ha='center', fontsize=11)
ax1.text(x0, 0.85, f'f_Î±/f_Î² = L_Î²/L_Î±', ha='center', fontsize=12, color='red')

ax1.set_xlim([0, 1])
ax1.set_ylim([0.7, 1.2])
ax1.set_xlabel('Snæ¿ƒåº¦ï¼ˆåŸå­åˆ†ç‡ï¼‰', fontsize=12)
ax1.set_title('ã¦ã“ã®è¦å‰‡ã®å›³è§£', fontsize=13, fontweight='bold')
ax1.legend(loc='lower center', fontsize=10)
ax1.axis('off')

# çµ„æˆå¤‰åŒ–ã«å¯¾ã™ã‚‹ç›¸åˆ†ç‡
ax2 = axes[1]
x0_range = np.linspace(x_alpha, x_beta, 100)
f_alpha_range = []
f_beta_range = []

for x in x0_range:
    f_a, f_b = lever_rule(x, x_alpha, x_beta)
    f_alpha_range.append(f_a)
    f_beta_range.append(f_b)

ax2.plot(x0_range * 100, np.array(f_alpha_range) * 100, 'b-',
         linewidth=2.5, label='Î±ç›¸åˆ†ç‡')
ax2.plot(x0_range * 100, np.array(f_beta_range) * 100, 'g-',
         linewidth=2.5, label='Î²ç›¸åˆ†ç‡')
ax2.axvline(x0 * 100, color='r', linestyle='--', linewidth=1.5,
           label=f'ä¾‹: Sn {x0*100:.0f}%')

ax2.set_xlabel('å…¨ä½“çµ„æˆ Sn (at%)', fontsize=12)
ax2.set_ylabel('ç›¸åˆ†ç‡ (%)', fontsize=12)
ax2.set_title(f'ç›¸åˆ†ç‡ã®çµ„æˆä¾å­˜æ€§ï¼ˆT = {T}Â°Cï¼‰', fontsize=13, fontweight='bold')
ax2.legend(fontsize=10)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('phase_lever_rule.png', dpi=300, bbox_inches='tight')
plt.show()

# è³ªé‡ä¿å­˜ã®ç¢ºèª
print("\n=== è³ªé‡ä¿å­˜ã®ç¢ºèª ===")
x_average = f_alpha * x_alpha + f_beta * x_beta
print(f"f_Î± Â· x_Î± + f_Î² Â· x_Î² = {f_alpha:.4f} Ã— {x_alpha:.2f} + {f_beta:.4f} Ã— {x_beta:.2f}")
print(f"                     = {x_average:.4f}")
print(f"å…¨ä½“çµ„æˆ xâ‚€           = {x0:.4f}")
print(f"èª¤å·®                 = {abs(x_average - x0):.6f}")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ3.5: å…±æ™¶ç‚¹ãƒ»åŒ…æ™¶ç‚¹ã®è§£æ</h2>

            <div class="code-title">Pythonå®Ÿè£…: å…±æ™¶ãƒ»åŒ…æ™¶åå¿œã®å¯è¦–åŒ–</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

def plot_eutectic_peritectic():
    """å…±æ™¶åå¿œã¨åŒ…æ™¶åå¿œã®æ¯”è¼ƒ"""

    fig, axes = plt.subplots(1, 2, figsize=(14, 6))

    # å…±æ™¶å‹ï¼ˆEutecticï¼‰
    ax1 = axes[0]

    # æ¶²ç›¸ç·š
    x_L_left = np.linspace(0, 0.4, 50)
    T_L_left = 400 - 200 * x_L_left
    x_L_right = np.linspace(0.4, 1.0, 50)
    T_L_right = 320 + 80 * (x_L_right - 0.4)

    ax1.plot(x_L_left * 100, T_L_left, 'r-', linewidth=2.5)
    ax1.plot(x_L_right * 100, T_L_right, 'r-', linewidth=2.5, label='æ¶²ç›¸ç·š')

    # å›ºç›¸ç·š
    ax1.plot([0, 20], [400, 320], 'b-', linewidth=2.5, label='Î±ç›¸å›ºç›¸ç·š')
    ax1.plot([70, 100], [320, 400], 'g-', linewidth=2.5, label='Î²ç›¸å›ºç›¸ç·š')

    # å…±æ™¶ç·š
    ax1.plot([0, 100], [320, 320], 'orange', linestyle='--', linewidth=2)

    # å…±æ™¶ç‚¹
    ax1.plot(40, 320, 'ko', markersize=12)
    ax1.text(40, 310, 'å…±æ™¶ç‚¹ E', ha='center', fontsize=12, fontweight='bold')

    # åå¿œå¼
    ax1.text(50, 380, 'L â†’ Î± + Î²', fontsize=14, ha='center',
            bbox=dict(boxstyle='round', facecolor='yellow', alpha=0.7))

    # é ˜åŸŸãƒ©ãƒ™ãƒ«
    ax1.text(20, 370, 'L', fontsize=14, ha='center')
    ax1.text(10, 340, 'L+Î±', fontsize=11, ha='center')
    ax1.text(60, 340, 'L+Î²', fontsize=11, ha='center')
    ax1.text(30, 290, 'Î±+Î²', fontsize=12, ha='center')

    ax1.set_xlabel('çµ„æˆ B (at%)', fontsize=12)
    ax1.set_ylabel('æ¸©åº¦ (Â°C)', fontsize=12)
    ax1.set_title('å…±æ™¶å‹ï¼ˆEutecticï¼‰', fontsize=14, fontweight='bold')
    ax1.set_xlim([0, 100])
    ax1.set_ylim([280, 420])
    ax1.legend(loc='upper right', fontsize=10)
    ax1.grid(True, alpha=0.3)

    # åŒ…æ™¶å‹ï¼ˆPeritecticï¼‰
    ax2 = axes[1]

    # æ¶²ç›¸ç·š
    x_L = np.linspace(0, 1.0, 100)
    T_L = 500 - 150 * x_L

    ax2.plot(x_L * 100, T_L, 'r-', linewidth=2.5, label='æ¶²ç›¸ç·š')

    # Î±ç›¸å›ºç›¸ç·š
    ax2.plot([0, 30], [500, 420], 'b-', linewidth=2.5, label='Î±ç›¸å›ºç›¸ç·š')

    # Î²ç›¸å›ºç›¸ç·š
    ax2.plot([50, 100], [420, 350], 'g-', linewidth=2.5, label='Î²ç›¸å›ºç›¸ç·š')

    # åŒ…æ™¶ç·š
    ax2.plot([0, 100], [420, 420], 'purple', linestyle='--', linewidth=2)

    # åŒ…æ™¶ç‚¹
    ax2.plot(40, 420, 'ko', markersize=12)
    ax2.text(40, 410, 'åŒ…æ™¶ç‚¹ P', ha='center', fontsize=12, fontweight='bold')

    # åå¿œå¼
    ax2.text(50, 470, 'L + Î± â†’ Î²', fontsize=14, ha='center',
            bbox=dict(boxstyle='round', facecolor='lightblue', alpha=0.7))

    # é ˜åŸŸãƒ©ãƒ™ãƒ«
    ax2.text(20, 460, 'L', fontsize=14, ha='center')
    ax2.text(15, 440, 'L+Î±', fontsize=11, ha='center')
    ax2.text(60, 440, 'L+Î²', fontsize=11, ha='center')
    ax2.text(15, 390, 'Î±', fontsize=12, ha='center')
    ax2.text(70, 390, 'Î²', fontsize=12, ha='center')
    ax2.text(35, 390, 'Î±+Î²', fontsize=11, ha='center')

    ax2.set_xlabel('çµ„æˆ B (at%)', fontsize=12)
    ax2.set_ylabel('æ¸©åº¦ (Â°C)', fontsize=12)
    ax2.set_title('åŒ…æ™¶å‹ï¼ˆPeritecticï¼‰', fontsize=14, fontweight='bold')
    ax2.set_xlim([0, 100])
    ax2.set_ylim([340, 520])
    ax2.legend(loc='upper right', fontsize=10)
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('phase_eutectic_peritectic_comparison.png', dpi=300, bbox_inches='tight')
    plt.show()

plot_eutectic_peritectic()

# åå¿œã®è§£èª¬
print("=== å…±æ™¶åå¿œã¨åŒ…æ™¶åå¿œã®æ¯”è¼ƒ ===\n")

print("ã€å…±æ™¶åå¿œï¼ˆEutecticï¼‰ã€‘")
print("  åå¿œ: L â†’ Î± + Î²")
print("  - æ¶²ç›¸ãŒå†·å´ã•ã‚Œã¦2ã¤ã®å›ºç›¸ã«åˆ†é›¢")
print("  - æœ€ä½èç‚¹ã‚’æŒã¤ï¼ˆèç‚¹é™ä¸‹ï¼‰")
print("  - ä¾‹: Pb-Sn (183Â°C), Al-Si (577Â°C)")
print("  - ç”¨é€”: ãƒãƒ³ãƒ€ã€é‹³é€ åˆé‡‘")
print()

print("ã€åŒ…æ™¶åå¿œï¼ˆPeritecticï¼‰ã€‘")
print("  åå¿œ: L + Î± â†’ Î²")
print("  - æ¶²ç›¸ã¨å›ºç›¸Î±ãŒåå¿œã—ã¦å›ºç›¸Î²ã‚’ç”Ÿæˆ")
print("  - éå¹³è¡¡å‡å›ºã§ã¯ Î± ãŒæ®‹ç•™ã—ã‚„ã™ã„")
print("  - ä¾‹: Fe-C (1493Â°C), Pt-Ag")
print("  - èª²é¡Œ: å‡è³ªåŒ–ãŒå›°é›£ã€åæãŒèµ·ã“ã‚Šã‚„ã™ã„")
print()

print("ã€Gibbsã®ç›¸å¾‹ã®ç¢ºèªã€‘")
print("  å…±æ™¶ç‚¹/åŒ…æ™¶ç‚¹: C = 2, P = 3 â†’ F = 2 - 3 + 2 = 1")
print("  åœ§åŠ›å›ºå®šãªã‚‰ F = 0 â†’ æ¸©åº¦ãƒ»çµ„æˆã¨ã‚‚ã«å›ºå®šï¼ˆä¸å¤‰ç³»ï¼‰")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ3.6: ä¸‰å…ƒç³»ç›¸å›³ã®å¯è¦–åŒ–</h2>

            <div class="code-title">Pythonå®Ÿè£…: ä¸‰å…ƒç³»ç›¸å›³ï¼ˆç­‰æ¸©æ–­é¢ï¼‰</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Polygon
from matplotlib.collections import PatchCollection

def ternary_to_cartesian(a, b, c):
    """ä¸‰å…ƒç³»çµ„æˆåº§æ¨™ã‚’ãƒ‡ã‚«ãƒ«ãƒˆåº§æ¨™ã«å¤‰æ›

    Args:
        a, b, c: å„æˆåˆ†ã®åŸå­åˆ†ç‡ï¼ˆa + b + c = 1ï¼‰

    Returns:
        x, y: ãƒ‡ã‚«ãƒ«ãƒˆåº§æ¨™
    """
    x = 0.5 * (2 * b + c) / (a + b + c)
    y = (np.sqrt(3) / 2) * c / (a + b + c)
    return x, y

def plot_ternary_diagram():
    """ä¸‰å…ƒç³»ç›¸å›³ã®åŸºæœ¬ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ"""

    fig, ax = plt.subplots(figsize=(10, 9))

    # ä¸‰è§’å½¢ã®é ‚ç‚¹
    vertices = np.array([
        [0, 0],           # A (å·¦ä¸‹)
        [1, 0],           # B (å³ä¸‹)
        [0.5, np.sqrt(3)/2]  # C (ä¸Š)
    ])

    # ä¸‰è§’å½¢ã®æ 
    triangle = Polygon(vertices, fill=False, edgecolor='black', linewidth=2)
    ax.add_patch(triangle)

    # ã‚°ãƒªãƒƒãƒ‰ç·šï¼ˆ10%åˆ»ã¿ï¼‰
    for i in range(1, 10):
        frac = i / 10

        # A-Bè»¸ã«å¹³è¡Œï¼ˆCã®å‰²åˆãŒä¸€å®šï¼‰
        x1, y1 = ternary_to_cartesian(1-frac, 0, frac)
        x2, y2 = ternary_to_cartesian(0, 1-frac, frac)
        ax.plot([x1, x2], [y1, y2], 'gray', linewidth=0.5, alpha=0.5)

        # B-Cè»¸ã«å¹³è¡Œï¼ˆAã®å‰²åˆãŒä¸€å®šï¼‰
        x1, y1 = ternary_to_cartesian(frac, 1-frac, 0)
        x2, y2 = ternary_to_cartesian(frac, 0, 1-frac)
        ax.plot([x1, x2], [y1, y2], 'gray', linewidth=0.5, alpha=0.5)

        # C-Aè»¸ã«å¹³è¡Œï¼ˆBã®å‰²åˆãŒä¸€å®šï¼‰
        x1, y1 = ternary_to_cartesian(1-frac, frac, 0)
        x2, y2 = ternary_to_cartesian(0, frac, 1-frac)
        ax.plot([x1, x2], [y1, y2], 'gray', linewidth=0.5, alpha=0.5)

    # é ‚ç‚¹ãƒ©ãƒ™ãƒ«
    ax.text(0, -0.05, 'A', fontsize=16, ha='center', fontweight='bold')
    ax.text(1, -0.05, 'B', fontsize=16, ha='center', fontweight='bold')
    ax.text(0.5, np.sqrt(3)/2 + 0.05, 'C', fontsize=16, ha='center', fontweight='bold')

    # è»¸ãƒ©ãƒ™ãƒ«
    for i in [0.2, 0.4, 0.6, 0.8]:
        # Aè»¸
        x, y = ternary_to_cartesian(1-i, i, 0)
        ax.text(x, y - 0.03, f'{int(i*100)}', fontsize=9, ha='center', color='blue')

        # Bè»¸
        x, y = ternary_to_cartesian(i, 0, 1-i)
        ax.text(x + 0.03, y, f'{int(i*100)}', fontsize=9, ha='left', color='green')

        # Cè»¸
        x, y = ternary_to_cartesian(0, 1-i, i)
        ax.text(x - 0.03, y, f'{int(i*100)}', fontsize=9, ha='right', color='red')

    # ä¾‹: å˜ç›¸é ˜åŸŸã¨2ç›¸é ˜åŸŸã‚’æãï¼ˆæ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿ï¼‰
    # å˜ç›¸é ˜åŸŸÎ±ï¼ˆA-richï¼‰
    alpha_region = np.array([
        ternary_to_cartesian(1.0, 0.0, 0.0),
        ternary_to_cartesian(0.8, 0.2, 0.0),
        ternary_to_cartesian(0.8, 0.0, 0.2),
    ])
    alpha_patch = Polygon(alpha_region, facecolor='lightblue', edgecolor='blue',
                          linewidth=1.5, alpha=0.5, label='Î±ç›¸')
    ax.add_patch(alpha_patch)
    ax.text(0.85, 0.05, 'Î±', fontsize=14, ha='center', fontweight='bold')

    # å˜ç›¸é ˜åŸŸÎ²ï¼ˆB-richï¼‰
    beta_region = np.array([
        ternary_to_cartesian(0.0, 1.0, 0.0),
        ternary_to_cartesian(0.2, 0.8, 0.0),
        ternary_to_cartesian(0.0, 0.8, 0.2),
    ])
    beta_patch = Polygon(beta_region, facecolor='lightgreen', edgecolor='green',
                         linewidth=1.5, alpha=0.5, label='Î²ç›¸')
    ax.add_patch(beta_patch)
    ax.text(0.15, 0.05, 'Î²', fontsize=14, ha='center', fontweight='bold')

    # å˜ç›¸é ˜åŸŸÎ³ï¼ˆC-richï¼‰
    gamma_region = np.array([
        ternary_to_cartesian(0.0, 0.0, 1.0),
        ternary_to_cartesian(0.2, 0.0, 0.8),
        ternary_to_cartesian(0.0, 0.2, 0.8),
    ])
    gamma_patch = Polygon(gamma_region, facecolor='lightcoral', edgecolor='red',
                          linewidth=1.5, alpha=0.5, label='Î³ç›¸')
    ax.add_patch(gamma_patch)
    ax.text(0.5, 0.75, 'Î³', fontsize=14, ha='center', fontweight='bold')

    # 2ç›¸é ˜åŸŸ
    ax.text(0.5, 0.4, 'Î±+Î²+Î³\n(3ç›¸é ˜åŸŸ)', fontsize=12, ha='center',
           bbox=dict(boxstyle='round', facecolor='yellow', alpha=0.6))

    ax.set_xlim([-0.1, 1.1])
    ax.set_ylim([-0.15, 1.0])
    ax.set_aspect('equal')
    ax.axis('off')
    ax.set_title('ä¸‰å…ƒç³»ç›¸å›³ï¼ˆA-B-Cç³»ã€ç­‰æ¸©æ–­é¢ï¼‰', fontsize=15, fontweight='bold', pad=20)
    ax.legend(loc='upper right', fontsize=11)

    plt.tight_layout()
    plt.savefig('phase_ternary_diagram.png', dpi=300, bbox_inches='tight')
    plt.show()

plot_ternary_diagram()

# ä¸‰å…ƒç³»ã§ã®çµ„æˆè¨ˆç®—ä¾‹
print("=== ä¸‰å…ƒç³»çµ„æˆã®ä¾‹ ===\n")

# ä¾‹: Al-Cu-Mgç³»åˆé‡‘
compositions = [
    ("Al 90% - Cu 5% - Mg 5%", 0.90, 0.05, 0.05),
    ("Al 70% - Cu 20% - Mg 10%", 0.70, 0.20, 0.10),
    ("Al 50% - Cu 30% - Mg 20%", 0.50, 0.30, 0.20),
]

print(f"{'çµ„æˆ':<30} {'Al':<8} {'Cu':<8} {'Mg':<8} {'åˆè¨ˆ':<8}")
print("-" * 65)
for name, a, b, c in compositions:
    total = a + b + c
    print(f"{name:<30} {a:<8.2f} {b:<8.2f} {c:<8.2f} {total:<8.2f}")

print("\nä¸‰å…ƒç³»ç›¸å›³ã®èª­ã¿æ–¹:")
print("  1. 3ã¤ã®é ‚ç‚¹ãŒç´”å…ƒç´ ï¼ˆA, B, Cï¼‰")
print("  2. å„è¾ºãŒäºŒå…ƒç³»")
print("  3. å†…éƒ¨ãŒä¸‰å…ƒç³»çµ„æˆ")
print("  4. Gibbsã®ç›¸å¾‹: C = 3, Tãƒ»På›ºå®š â†’ F = 3 - P")
print("     - 1ç›¸é ˜åŸŸ: F = 2ï¼ˆçµ„æˆ2å¤‰æ•°ã‚’è‡ªç”±ã«é¸ã¹ã‚‹ï¼‰")
print("     - 2ç›¸é ˜åŸŸ: F = 1ï¼ˆ1å¤‰æ•°ã®ã¿è‡ªç”±ï¼‰")
print("     - 3ç›¸é ˜åŸŸ: F = 0ï¼ˆçµ„æˆå›ºå®šã€ã‚¿ã‚¤ãƒ©ã‚¤ãƒ³ï¼‰")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ3.7: ç›¸è»¢ç§»ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã®è¨ˆç®—</h2>

            <div class="code-title">Pythonå®Ÿè£…: ç›¸è»¢ç§»ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã¨Clapeyronå¼</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

# å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆæ¨¡æ“¬ï¼‰: æ°´ã®è’¸æ°—åœ§
T_exp = np.array([273.15, 283.15, 293.15, 303.15, 313.15,
                  323.15, 333.15, 343.15, 353.15, 363.15, 373.15])  # K
P_exp = np.array([611, 1228, 2339, 4246, 7384,
                  12350, 19940, 31190, 47410, 70140, 101325])  # Pa

# Clausius-Clapeyronå¼ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
# ln(P) = -L_vap/(RÂ·T) + C

def clausius_clapeyron_fit(T, L_vap, C):
    """ln(P) = -L_vap/(RÂ·T) + C"""
    R = 8.314
    return -L_vap / (R * T) + C

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
params, cov = curve_fit(clausius_clapeyron_fit, T_exp, np.log(P_exp))
L_vap_fit, C_fit = params
L_vap_err = np.sqrt(cov[0, 0])

print("=== Clausius-Clapeyronå¼ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚° ===\n")
print(f"è’¸ç™ºã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ L_vap = {L_vap_fit:.0f} Â± {L_vap_err:.0f} J/mol")
print(f"æ–‡çŒ®å€¤ï¼ˆ100Â°Cï¼‰: 40660 J/mol")
print(f"ç›¸å¯¾èª¤å·®: {abs(L_vap_fit - 40660) / 40660 * 100:.2f}%\n")

# ãƒ•ã‚£ãƒƒãƒˆçµæœã®å¯è¦–åŒ–
T_fit = np.linspace(270, 380, 100)
P_fit = np.exp(clausius_clapeyron_fit(T_fit, L_vap_fit, C_fit))

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# ç·šå½¢ãƒ—ãƒ­ãƒƒãƒˆ
ax1 = axes[0]
ax1.plot(T_exp - 273.15, P_exp / 1e3, 'bo', markersize=8, label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')
ax1.plot(T_fit - 273.15, P_fit / 1e3, 'r-', linewidth=2, label='ãƒ•ã‚£ãƒƒãƒˆ')
ax1.set_xlabel('Temperature (Â°C)')
ax1.set_ylabel('Vapor pressure (kPa)')
ax1.set_title('æ°´ã®è’¸æ°—åœ§æ›²ç·š')
ax1.legend()
ax1.grid(True, alpha=0.3)

# Clausius-Clapeyronãƒ—ãƒ­ãƒƒãƒˆ
ax2 = axes[1]
ax2.plot(1000 / T_exp, np.log(P_exp), 'bo', markersize=8, label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')
ax2.plot(1000 / T_fit, np.log(P_fit), 'r-', linewidth=2, label='ãƒ•ã‚£ãƒƒãƒˆ')
ax2.set_xlabel('1000/T (Kâ»Â¹)')
ax2.set_ylabel('ln(P)')
ax2.set_title('Clausius-Clapeyronãƒ—ãƒ­ãƒƒãƒˆ')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('phase_transition_enthalpy_fit.png', dpi=300, bbox_inches='tight')
plt.show()

# ä»–ã®ç‰©è³ªã¨ã®æ¯”è¼ƒ
substances = {
    'Hâ‚‚O': 40660,
    'Câ‚‚Hâ‚…OH (ã‚¨ã‚¿ãƒãƒ¼ãƒ«)': 38560,
    'CHâ‚ƒOH (ãƒ¡ã‚¿ãƒãƒ¼ãƒ«)': 35270,
    'Câ‚†Hâ‚† (ãƒ™ãƒ³ã‚¼ãƒ³)': 30720,
    'Nâ‚‚': 5577,
    'Oâ‚‚': 6820,
}

print("=== è’¸ç™ºã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ã®æ¯”è¼ƒ ===\n")
print(f"{'ç‰©è³ª':<20} {'L_vap (J/mol)':<18} {'L_vap (kJ/mol)':<18}")
print("-" * 60)
for substance, L in substances.items():
    print(f"{substance:<20} {L:<18.0f} {L/1000:<18.2f}")

print("\næ°´ç´ çµåˆã®å½±éŸ¿:")
print("  - æ°´ã¯å¼·ã„æ°´ç´ çµåˆã®ãŸã‚è’¸ç™ºã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ãŒå¤§ãã„")
print("  - ã‚¨ã‚¿ãƒãƒ¼ãƒ«ãƒ»ãƒ¡ã‚¿ãƒãƒ¼ãƒ«ã‚‚æ°´ç´ çµåˆã‚’æŒã¤")
print("  - Nâ‚‚, Oâ‚‚ã¯åˆ†å­é–“åŠ›ãŒå¼±ãã€è’¸ç™ºã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ãŒå°ã•ã„")
</div>
        </div>

        <div class="content">
            <h2>ğŸ“š ã¾ã¨ã‚</h2>
            <ul>
                <li><strong>Gibbsã®ç›¸å¾‹</strong> \(F = C - P + 2\) ã¯ç³»ã®è‡ªç”±åº¦ã‚’æ±ºå®šã™ã‚‹</li>
                <li><strong>Clausius-Clapeyronå¼</strong>ã«ã‚ˆã‚Šç›¸å¹³è¡¡æ›²ç·šã¨ç›¸è»¢ç§»ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ãŒé–¢ä¿‚ã¥ã‘ã‚‰ã‚Œã‚‹</li>
                <li><strong>van der WaalsçŠ¶æ…‹æ–¹ç¨‹å¼</strong>ã®Maxwellæ§‹æˆã§æ°—æ¶²å…±å­˜ã‚’è¨˜è¿°ã§ãã‚‹</li>
                <li><strong>äºŒå…ƒç³»ç›¸å›³</strong>ã«ã¯å…±æ™¶å‹ãƒ»åŒ…æ™¶å‹ãƒ»å…¨ç‡å›ºæº¶ä½“å‹ãªã©ãŒã‚ã‚‹</li>
                <li><strong>Lever rule</strong>ã§2ç›¸å…±å­˜é ˜åŸŸã®ç›¸åˆ†ç‡ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li><strong>å…±æ™¶åå¿œ</strong> (L â†’ Î± + Î²) ã¨<strong>åŒ…æ™¶åå¿œ</strong> (L + Î± â†’ Î²) ã¯é‡è¦ãªç›¸è»¢ç§»</li>
                <li><strong>ä¸‰å…ƒç³»ç›¸å›³</strong>ã¯ä¸‰è§’åº§æ¨™ã§è¡¨ã•ã‚Œã€ææ–™è¨­è¨ˆã«é‡è¦</li>
                <li>ç›¸å›³ã¯ææ–™ã®ãƒ—ãƒ­ã‚»ã‚¹è¨­è¨ˆãƒ»çµ„ç¹”åˆ¶å¾¡ã«ä¸å¯æ¬ ãªãƒ„ãƒ¼ãƒ«</li>
            </ul>
        </div>

        <div class="exercise">
            <h3>ğŸ’¡ æ¼”ç¿’å•é¡Œ</h3>
            <ol>
                <li><strong>[Easy]</strong> Gibbsã®ç›¸å¾‹ã‚’ç”¨ã„ã¦ã€COâ‚‚ã®ä¸‰é‡ç‚¹ï¼ˆå›ºä½“ãƒ»æ¶²ä½“ãƒ»æ°—ä½“å…±å­˜ï¼‰ã§ã®è‡ªç”±åº¦ã‚’æ±‚ã‚ã‚ˆã€‚</li>

                <li><strong>[Easy]</strong> Lever ruleã‚’ç”¨ã„ã¦ã€Pb-Snç³»ã§Sn 30%ã®åˆé‡‘ãŒ200â„ƒã§Î±ç›¸ï¼ˆSn 15%ï¼‰ã¨Î²ç›¸ï¼ˆSn 90%ï¼‰ã«åˆ†é›¢ã™ã‚‹ã¨ãã®å„ç›¸ã®åˆ†ç‡ã‚’è¨ˆç®—ã›ã‚ˆã€‚</li>

                <li><strong>[Medium]</strong> æ°´ã®è’¸ç™ºã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼ãŒ40.66 kJ/molã®ã¨ãã€90â„ƒã§ã®è’¸æ°—åœ§ã‚’è¨ˆç®—ã›ã‚ˆã€‚ãŸã ã—100â„ƒã§ã®è’¸æ°—åœ§ã¯1 atmã¨ã™ã‚‹ã€‚</li>

                <li><strong>[Medium]</strong> van der Waalsæ°—ä½“ã®è‡¨ç•Œç‚¹ã§ \(\left(\frac{\partial P}{\partial V}\right)_T = \left(\frac{\partial^2 P}{\partial V^2}\right)_T = 0\) ã¨ãªã‚‹ã“ã¨ã‚’ç¤ºã—ã€ã“ã‚Œã‚ˆã‚Š \(T_c = \frac{8a}{27Rb}\) ã‚’å°å‡ºã›ã‚ˆã€‚</li>

                <li><strong>[Hard]</strong> äºŒå…ƒå…±æ™¶ç³»ã§å…±æ™¶çµ„æˆãŒ40%ã€å…±æ™¶æ¸©åº¦ãŒ300â„ƒã€ç´”Aãƒ»ç´”Bã®èç‚¹ãŒãã‚Œãã‚Œ500â„ƒã€450â„ƒã¨ã™ã‚‹ã€‚æ¶²ç›¸ç·šã‚’æ”¾ç‰©ç·šè¿‘ä¼¼ã§æ±‚ã‚ã€çµ„æˆ30%ã®åˆé‡‘ã®æ¶²ç›¸ç·šæ¸©åº¦ã‚’è¨ˆç®—ã›ã‚ˆã€‚</li>
            </ol>
        </div>

        <div class="nav-buttons">
            <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« : Maxwellé–¢ä¿‚å¼</a>
            <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºTOP</a>
            <a href="chapter-4.html" class="nav-button">ç¬¬4ç« : è‡¨ç•Œç¾è±¡ã¨ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ç†è«– â†’</a>
        </div>
    </div>
        </div>
    </div>

    <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

<footer>
        <p>&copy; 2025 AI Terakoya - åŸºç¤æ•°ç†é“å ´</p>
    </footer>
</body>
</html>
