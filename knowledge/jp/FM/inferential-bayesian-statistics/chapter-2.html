<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : åŒºé–“æ¨å®šã¨ä¿¡é ¼åŒºé–“ | æ¨æ¸¬çµ±è¨ˆå­¦ã¨ãƒ™ã‚¤ã‚ºçµ±è¨ˆ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8;
            color: #333;
            background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 1rem;
            text-align: center;
        }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; font-size: 1rem; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .back-link { display: inline-block; margin-bottom: 2rem; padding: 0.5rem 1rem; background: white; color: #667eea; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 1rem 0; }
        .theory-box { background: linear-gradient(to right, #f0f4ff, #fef5ff); border-left: 4px solid #667eea; padding: 1.5rem; margin: 1.5rem 0; border-radius: 6px; }
        .theory-box h4 { color: #667eea; margin-bottom: 1rem; }
        .formula { background: #fafafa; padding: 1rem; border-radius: 6px; margin: 1rem 0; overflow-x: auto; text-align: center; }
        pre { background: #1e1e1e; color: #d4d4d4; padding: 1.5rem; border-radius: 8px; overflow-x: auto; margin: 1rem 0; }
        code { font-family: 'Consolas', 'Monaco', monospace; font-size: 0.9rem; }
        .example { background: #f8f9fa; border-left: 4px solid #28a745; padding: 1.5rem; margin: 1.5rem 0; border-radius: 6px; }
        .example h4 { color: #28a745; margin-bottom: 1rem; }
        .exercise { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1.5rem; margin: 1.5rem 0; border-radius: 6px; }
        .exercise h4 { color: #856404; margin-bottom: 1rem; }
        ul, ol { margin-left: 2rem; margin-top: 0.5rem; margin-bottom: 0.5rem; }
        li { margin: 0.5rem 0; }
        .note { background: #e7f3ff; border-left: 4px solid #2196F3; padding: 1rem 1.5rem; margin: 1rem 0; border-radius: 6px; }
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 3rem; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; transition: background 0.3s; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) {
            .content { padding: 1.5rem; }
            h1 { font-size: 1.5rem; }
            pre { padding: 1rem; font-size: 0.85rem; }
        }
    </style>
</head>
<body>
    <header>
        <h1>ç¬¬2ç« : åŒºé–“æ¨å®šã¨ä¿¡é ¼åŒºé–“</h1>
        <p class="subtitle">Interval Estimation and Confidence Intervals</p>
    </header>

    <div class="container">
        <a href="index.html" class="back-link">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>

        <div class="content">
            <h2>2.1 ä¿¡é ¼åŒºé–“ã®æ¦‚å¿µ</h2>
            <p>
                ç‚¹æ¨å®šã¯æ¯æ•°ã®å˜ä¸€ã®æ¨å®šå€¤ã‚’ä¸ãˆã¾ã™ãŒã€ãã®æ¨å®šå€¤ãŒã©ã®ç¨‹åº¦ä¿¡é ¼ã§ãã‚‹ã‹ã®æƒ…å ±ã¯å«ã¿ã¾ã›ã‚“ã€‚
                <strong>åŒºé–“æ¨å®šï¼ˆInterval Estimationï¼‰</strong>ã¯ã€æ¯æ•°ã‚’å«ã‚€å¯èƒ½æ€§ãŒé«˜ã„ç¯„å›²ã‚’ç¢ºç‡çš„ã«æç¤ºã—ã¾ã™ã€‚
            </p>

            <div class="theory-box">
                <h4>ğŸ“˜ ä¿¡é ¼åŒºé–“ã®å®šç¾©</h4>
                <p>æ¯æ•° \( \theta \) ã«å¯¾ã™ã‚‹<strong>ä¿¡é ¼æ°´æº– \( 1-\alpha \) ã®ä¿¡é ¼åŒºé–“</strong>ã¯ã€çµ±è¨ˆé‡ \( L(X_1, \ldots, X_n) \) ã¨ \( U(X_1, \ldots, X_n) \) ã‚’ç”¨ã„ã¦ï¼š</p>
                <div class="formula">
                    $$ P(L \leq \theta \leq U) = 1 - \alpha $$
                </div>
                <p>ã¨ãªã‚‹åŒºé–“ \( [L, U] \) ã§ã™ã€‚é€šå¸¸ \( \alpha = 0.05 \)ï¼ˆ95%ä¿¡é ¼åŒºé–“ï¼‰ãŒç”¨ã„ã‚‰ã‚Œã¾ã™ã€‚</p>
            </div>

            <div class="note">
                <strong>ğŸ“Œ é‡è¦ãªè§£é‡ˆ</strong><br>
                ã€Œ95%ä¿¡é ¼åŒºé–“ã€ã¯ã€Œæ¯æ•°ãŒã“ã®åŒºé–“ã«å«ã¾ã‚Œã‚‹ç¢ºç‡ãŒ95%ã€ã§ã¯ãªãã€
                ã€Œã“ã®ã‚ˆã†ãªåŒºé–“æ¨å®šã‚’100å›è¡Œã£ãŸã¨ãã€ç´„95å›ã¯çœŸã®æ¯æ•°ã‚’å«ã‚€åŒºé–“ãŒå¾—ã‚‰ã‚Œã‚‹ã€ã¨ã„ã†æ„å‘³ã§ã™ï¼ˆé »åº¦è«–çš„è§£é‡ˆï¼‰ã€‚
            </div>

            <h2>2.2 æ­£è¦æ¯é›†å›£ã®æ¯å¹³å‡ã®ä¿¡é ¼åŒºé–“</h2>

            <h3>2.2.1 æ¯åˆ†æ•£æ—¢çŸ¥ã®å ´åˆï¼ˆzåŒºé–“ï¼‰</h3>
            <div class="theory-box">
                <h4>ğŸ“˜ æ¯åˆ†æ•£æ—¢çŸ¥ã®ã¨ãã®ä¿¡é ¼åŒºé–“</h4>
                <p>æ¯é›†å›£ãŒ \( N(\mu, \sigma^2) \) ã§ \( \sigma^2 \) ãŒæ—¢çŸ¥ã®ã¨ãï¼š</p>
                <div class="formula">
                    $$ \bar{X} \pm z_{\alpha/2} \frac{\sigma}{\sqrt{n}} $$
                </div>
                <p>ã“ã“ã§ \( z_{\alpha/2} \) ã¯æ¨™æº–æ­£è¦åˆ†å¸ƒã®ä¸Šå´ \( \alpha/2 \) ç‚¹ï¼ˆä¾‹: 95%ä¿¡é ¼åŒºé–“ãªã‚‰ \( z_{0.025} = 1.96 \)ï¼‰</p>
            </div>

            <div class="example">
                <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹1: æ­£è¦æ¯é›†å›£ã®æ¯å¹³å‡ã®ä¿¡é ¼åŒºé–“ï¼ˆæ¯åˆ†æ•£æ—¢çŸ¥ï¼‰</h4>
                <pre><code>import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# çœŸã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
mu_true = 100
sigma_true = 15  # æ—¢çŸ¥

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
np.random.seed(42)
n = 25
data = np.random.normal(mu_true, sigma_true, n)

# æ¨™æœ¬å¹³å‡
x_bar = np.mean(data)

# 95%ä¿¡é ¼åŒºé–“ï¼ˆzåŒºé–“ï¼‰
alpha = 0.05
z_critical = stats.norm.ppf(1 - alpha/2)
margin_of_error = z_critical * sigma_true / np.sqrt(n)
ci_lower = x_bar - margin_of_error
ci_upper = x_bar + margin_of_error

print("=== æ¯å¹³å‡ã®ä¿¡é ¼åŒºé–“ï¼ˆæ¯åˆ†æ•£æ—¢çŸ¥ï¼‰ ===")
print(f"æ¨™æœ¬ã‚µã‚¤ã‚º: {n}")
print(f"æ¨™æœ¬å¹³å‡: {x_bar:.2f}")
print(f"æ¯æ¨™æº–åå·®ï¼ˆæ—¢çŸ¥ï¼‰: {sigma_true}")
print(f"z_{{{alpha/2}}} = {z_critical:.4f}")
print(f"èª¤å·®é™ç•Œ: Â±{margin_of_error:.2f}")
print(f"95%ä¿¡é ¼åŒºé–“: [{ci_lower:.2f}, {ci_upper:.2f}]")
print(f"çœŸã®æ¯å¹³å‡ {mu_true} ã¯åŒºé–“å†…: {ci_lower <= mu_true <= ci_upper}")

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§è¢«è¦†ç¢ºç‡ã‚’æ¤œè¨¼
n_simulations = 1000
coverage_count = 0
ci_data = []

np.random.seed(123)
for _ in range(n_simulations):
    sample = np.random.normal(mu_true, sigma_true, n)
    sample_mean = np.mean(sample)
    ci_l = sample_mean - margin_of_error
    ci_u = sample_mean + margin_of_error
    ci_data.append((ci_l, ci_u))
    if ci_l <= mu_true <= ci_upper:
        coverage_count += 1

coverage_rate = coverage_count / n_simulations
print(f"\nã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ{n_simulations}å›ï¼‰:")
print(f"è¢«è¦†ç¢ºç‡: {coverage_rate:.3f} (ç†è«–å€¤: 0.95)")

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# ä¿¡é ¼åŒºé–“ã®åˆ†å¸ƒ
axes[0].hist(data, bins=15, density=True, alpha=0.7,
             color='skyblue', edgecolor='black', label='ãƒ‡ãƒ¼ã‚¿')
x_range = np.linspace(mu_true - 4*sigma_true, mu_true + 4*sigma_true, 200)
axes[0].plot(x_range, stats.norm.pdf(x_range, mu_true, sigma_true),
             'r-', linewidth=2, label=f'çœŸã®æ¯é›†å›£ N({mu_true}, {sigma_true}Â²)')
axes[0].axvline(x_bar, color='blue', linestyle='--', linewidth=2,
                label=f'æ¨™æœ¬å¹³å‡: {x_bar:.1f}')
axes[0].axvspan(ci_lower, ci_upper, alpha=0.3, color='green',
                label=f'95%ä¿¡é ¼åŒºé–“')
axes[0].axvline(mu_true, color='red', linestyle=':', linewidth=2,
                label=f'çœŸã®æ¯å¹³å‡: {mu_true}')
axes[0].set_xlabel('å€¤')
axes[0].set_ylabel('ç¢ºç‡å¯†åº¦')
axes[0].set_title('æ¯å¹³å‡ã®95%ä¿¡é ¼åŒºé–“')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# ä¿¡é ¼åŒºé–“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæœ€åˆã®50å›ã‚’è¡¨ç¤ºï¼‰
for i in range(min(50, len(ci_data))):
    ci_l, ci_u = ci_data[i]
    color = 'green' if ci_l <= mu_true <= ci_u else 'red'
    axes[1].plot([ci_l, ci_u], [i, i], color=color, linewidth=1, alpha=0.6)
    axes[1].plot((ci_l + ci_u)/2, i, 'o', color=color, markersize=2)

axes[1].axvline(mu_true, color='blue', linestyle='--', linewidth=2,
                label=f'çœŸã®æ¯å¹³å‡: {mu_true}')
axes[1].set_xlabel('åŒºé–“')
axes[1].set_ylabel('ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç•ªå·')
axes[1].set_title(f'ä¿¡é ¼åŒºé–“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆè¢«è¦†ç‡: {coverage_rate:.1%}ï¼‰')
axes[1].legend()
axes[1].grid(True, alpha=0.3, axis='x')

plt.tight_layout()
plt.show()</code></pre>
            </div>

            <h3>2.2.2 æ¯åˆ†æ•£æœªçŸ¥ã®å ´åˆï¼ˆtåŒºé–“ï¼‰</h3>
            <div class="theory-box">
                <h4>ğŸ“˜ æ¯åˆ†æ•£æœªçŸ¥ã®ã¨ãã®ä¿¡é ¼åŒºé–“ï¼ˆtåˆ†å¸ƒï¼‰</h4>
                <p>æ¯é›†å›£ãŒ \( N(\mu, \sigma^2) \) ã§ \( \sigma^2 \) ãŒæœªçŸ¥ã®ã¨ãï¼š</p>
                <div class="formula">
                    $$ \bar{X} \pm t_{\alpha/2, n-1} \frac{S}{\sqrt{n}} $$
                </div>
                <p>ã“ã“ã§ \( S = \sqrt{\frac{1}{n-1}\sum_{i=1}^n (X_i - \bar{X})^2} \) ã¯æ¨™æœ¬æ¨™æº–åå·®ã€</p>
                <p>\( t_{\alpha/2, n-1} \) ã¯è‡ªç”±åº¦ \( n-1 \) ã®tåˆ†å¸ƒã®ä¸Šå´ \( \alpha/2 \) ç‚¹</p>
            </div>

            <div class="example">
                <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹2: tåˆ†å¸ƒã‚’ç”¨ã„ãŸä¿¡é ¼åŒºé–“ï¼ˆå°æ¨™æœ¬ï¼‰</h4>
                <pre><code>import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# çœŸã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
mu_true = 75
sigma_true = 12

# å°æ¨™æœ¬ã®å ´åˆ
np.random.seed(42)
n = 10  # å°æ¨™æœ¬
data = np.random.normal(mu_true, sigma_true, n)

# æ¨™æœ¬çµ±è¨ˆé‡
x_bar = np.mean(data)
s = np.std(data, ddof=1)  # ä¸åæ¨™æº–åå·®

# 95%ä¿¡é ¼åŒºé–“ï¼ˆtåŒºé–“ï¼‰
alpha = 0.05
t_critical = stats.t.ppf(1 - alpha/2, df=n-1)
margin_of_error_t = t_critical * s / np.sqrt(n)
ci_lower_t = x_bar - margin_of_error_t
ci_upper_t = x_bar + margin_of_error_t

# æ¯”è¼ƒã®ãŸã‚ã€zåŒºé–“ã‚‚è¨ˆç®—ï¼ˆèª¤ã£ãŸæ–¹æ³•ï¼‰
z_critical = stats.norm.ppf(1 - alpha/2)
margin_of_error_z = z_critical * s / np.sqrt(n)
ci_lower_z = x_bar - margin_of_error_z
ci_upper_z = x_bar + margin_of_error_z

print("=== æ¯å¹³å‡ã®ä¿¡é ¼åŒºé–“ï¼ˆæ¯åˆ†æ•£æœªçŸ¥ã€å°æ¨™æœ¬ï¼‰ ===")
print(f"æ¨™æœ¬ã‚µã‚¤ã‚º: {n}")
print(f"æ¨™æœ¬å¹³å‡: {x_bar:.2f}")
print(f"æ¨™æœ¬æ¨™æº–åå·®: {s:.2f}")
print(f"\ntåˆ†å¸ƒï¼ˆæ­£ã—ã„æ–¹æ³•ï¼‰:")
print(f"  t_{{{alpha/2}, {n-1}}} = {t_critical:.4f}")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_t:.2f}, {ci_upper_t:.2f}]")
print(f"  åŒºé–“ã®å¹…: {ci_upper_t - ci_lower_t:.2f}")
print(f"\nzåˆ†å¸ƒï¼ˆèª¤ã£ãŸæ–¹æ³•ã€å‚è€ƒï¼‰:")
print(f"  z_{{{alpha/2}}} = {z_critical:.4f}")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_z:.2f}, {ci_upper_z:.2f}]")
print(f"  åŒºé–“ã®å¹…: {ci_upper_z - ci_lower_z:.2f}")
print(f"\ntåŒºé–“ vs zåŒºé–“ã®å¹…ã®æ¯”: {(ci_upper_t - ci_lower_t)/(ci_upper_z - ci_lower_z):.3f}")

# æ¨™æœ¬ã‚µã‚¤ã‚ºã¨ä¿¡é ¼åŒºé–“å¹…ã®é–¢ä¿‚
sample_sizes = np.array([5, 10, 20, 30, 50, 100, 200])
ci_widths_t = []
ci_widths_z = []

np.random.seed(42)
for ns in sample_sizes:
    sample = np.random.normal(mu_true, sigma_true, ns)
    xb = np.mean(sample)
    sb = np.std(sample, ddof=1)

    t_crit = stats.t.ppf(1 - alpha/2, df=ns-1)
    z_crit = stats.norm.ppf(1 - alpha/2)

    width_t = 2 * t_crit * sb / np.sqrt(ns)
    width_z = 2 * z_crit * sb / np.sqrt(ns)

    ci_widths_t.append(width_t)
    ci_widths_z.append(width_z)

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# tåˆ†å¸ƒã¨zåˆ†å¸ƒã®æ¯”è¼ƒ
x = np.linspace(-4, 4, 200)
axes[0].plot(x, stats.norm.pdf(x), 'b-', linewidth=2, label='æ¨™æº–æ­£è¦åˆ†å¸ƒ (z)')
for df in [2, 5, 10, 30]:
    axes[0].plot(x, stats.t.pdf(x, df), linewidth=2, label=f'tåˆ†å¸ƒ (df={df})')
axes[0].set_xlabel('å€¤')
axes[0].set_ylabel('ç¢ºç‡å¯†åº¦')
axes[0].set_title('tåˆ†å¸ƒã¨æ¨™æº–æ­£è¦åˆ†å¸ƒã®æ¯”è¼ƒ')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# æ¨™æœ¬ã‚µã‚¤ã‚ºã¨ä¿¡é ¼åŒºé–“å¹…
axes[1].plot(sample_sizes, ci_widths_t, 'ro-', markersize=8,
             linewidth=2, label='tåŒºé–“ï¼ˆæ­£ã—ã„ï¼‰')
axes[1].plot(sample_sizes, ci_widths_z, 'b^--', markersize=8,
             linewidth=2, label='zåŒºé–“ï¼ˆæ¯åˆ†æ•£æ—¢çŸ¥ã®å ´åˆï¼‰')
axes[1].set_xlabel('æ¨™æœ¬ã‚µã‚¤ã‚º')
axes[1].set_ylabel('ä¿¡é ¼åŒºé–“ã®å¹…')
axes[1].set_title('æ¨™æœ¬ã‚µã‚¤ã‚ºã¨95%ä¿¡é ¼åŒºé–“ã®å¹…')
axes[1].set_xscale('log')
axes[1].legend()
axes[1].grid(True, alpha=0.3, which='both')

plt.tight_layout()
plt.show()</code></pre>
            </div>

            <div class="note">
                <strong>ğŸ“Œ é‡è¦ãƒã‚¤ãƒ³ãƒˆ</strong><br>
                å°æ¨™æœ¬ï¼ˆn < 30ç¨‹åº¦ï¼‰ã§ã¯ã€tåˆ†å¸ƒã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚è‡ªç”±åº¦ãŒå°ã•ã„ã»ã©ã€
                tåˆ†å¸ƒã¯æ­£è¦åˆ†å¸ƒã‚ˆã‚Šï¿½ï¿½è£¾ãŒåšãã€ä¿¡é ¼åŒºé–“ãŒåºƒããªã‚Šã¾ã™ã€‚æ¨™æœ¬ã‚µã‚¤ã‚ºãŒå¤§ãããªã‚‹ã¨ã€
                tåˆ†å¸ƒã¯æ­£è¦åˆ†å¸ƒã«è¿‘ã¥ãã¾ã™ã€‚
            </div>

            <h2>2.3 æ¯åˆ†æ•£ã®ä¿¡é ¼åŒºé–“ï¼ˆã‚«ã‚¤äºŒä¹—åˆ†å¸ƒï¼‰</h2>

            <div class="theory-box">
                <h4>ğŸ“˜ æ¯åˆ†æ•£ã®ä¿¡é ¼åŒºé–“</h4>
                <p>æ¯é›†å›£ãŒ \( N(\mu, \sigma^2) \) ã®ã¨ãã€\( \frac{(n-1)S^2}{\sigma^2} \sim \chi^2_{n-1} \) ã‚ˆã‚Šï¼š</p>
                <div class="formula">
                    $$ \left[ \frac{(n-1)S^2}{\chi^2_{\alpha/2, n-1}}, \frac{(n-1)S^2}{\chi^2_{1-\alpha/2, n-1}} \right] $$
                </div>
                <p>ãŒæ¯åˆ†æ•£ \( \sigma^2 \) ã® \( 1-\alpha \) ä¿¡é ¼åŒºé–“ã§ã™ã€‚</p>
            </div>

            <div class="example">
                <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹3: æ¯åˆ†æ•£ã®ä¿¡é ¼åŒºé–“</h4>
                <pre><code>import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# çœŸã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
mu_true = 50
sigma2_true = 100  # æ¯åˆ†æ•£
sigma_true = np.sqrt(sigma2_true)

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
np.random.seed(42)
n = 20
data = np.random.normal(mu_true, sigma_true, n)

# æ¨™æœ¬åˆ†æ•£ï¼ˆä¸åï¼‰
s2 = np.var(data, ddof=1)

# 95%ä¿¡é ¼åŒºé–“
alpha = 0.05
chi2_lower = stats.chi2.ppf(alpha/2, df=n-1)
chi2_upper = stats.chi2.ppf(1 - alpha/2, df=n-1)

ci_lower = (n-1) * s2 / chi2_upper
ci_upper = (n-1) * s2 / chi2_lower

print("=== æ¯åˆ†æ•£ã®ä¿¡é ¼åŒºé–“ ===")
print(f"æ¨™æœ¬ã‚µã‚¤ã‚º: {n}")
print(f"æ¨™æœ¬åˆ†æ•£: {s2:.2f}")
print(f"çœŸã®æ¯åˆ†æ•£: {sigma2_true}")
print(f"\nã‚«ã‚¤äºŒä¹—åˆ†ä½ç‚¹:")
print(f"  Ï‡Â²_{{{alpha/2}, {n-1}}} = {chi2_lower:.4f}")
print(f"  Ï‡Â²_{{{1-alpha/2}, {n-1}}} = {chi2_upper:.4f}")
print(f"\næ¯åˆ†æ•£ÏƒÂ²ã®95%ä¿¡é ¼åŒºé–“: [{ci_lower:.2f}, {ci_upper:.2f}]")
print(f"æ¯æ¨™æº–åå·®Ïƒã®95%ä¿¡é ¼åŒºé–“: [{np.sqrt(ci_lower):.2f}, {np.sqrt(ci_upper):.2f}]")
print(f"çœŸã®æ¯åˆ†æ•£ã¯åŒºé–“å†…: {ci_lower <= sigma2_true <= ci_upper}")

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§è¢«è¦†ç¢ºç‡ã‚’æ¤œè¨¼
n_simulations = 1000
coverage_count = 0

np.random.seed(123)
for _ in range(n_simulations):
    sample = np.random.normal(mu_true, sigma_true, n)
    s2_sample = np.var(sample, ddof=1)
    ci_l = (n-1) * s2_sample / chi2_upper
    ci_u = (n-1) * s2_sample / chi2_lower
    if ci_l <= sigma2_true <= ci_u:
        coverage_count += 1

coverage_rate = coverage_count / n_simulations
print(f"\nã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ{n_simulations}å›ï¼‰:")
print(f"è¢«è¦†ç¢ºç‡: {coverage_rate:.3f} (ç†è«–å€¤: 0.95)")

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# ã‚«ã‚¤äºŒä¹—åˆ†å¸ƒ
x = np.linspace(0, 40, 300)
axes[0].plot(x, stats.chi2.pdf(x, df=n-1), 'b-', linewidth=2,
             label=f'Ï‡Â²åˆ†å¸ƒ (df={n-1})')
axes[0].axvline(chi2_lower, color='red', linestyle='--', linewidth=2,
                label=f'ä¸‹å´åˆ†ä½ç‚¹: {chi2_lower:.2f}')
axes[0].axvline(chi2_upper, color='green', linestyle='--', linewidth=2,
                label=f'ä¸Šå´åˆ†ä½ç‚¹: {chi2_upper:.2f}')
axes[0].fill_between(x, 0, stats.chi2.pdf(x, df=n-1),
                      where=(x >= chi2_lower) & (x <= chi2_upper),
                      alpha=0.3, color='yellow', label='95%é ˜åŸŸ')
axes[0].set_xlabel('Ï‡Â²å€¤')
axes[0].set_ylabel('ç¢ºç‡å¯†åº¦')
axes[0].set_title(f'ã‚«ã‚¤äºŒä¹—åˆ†å¸ƒ (è‡ªç”±åº¦={n-1})')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# æ¨™æœ¬åˆ†æ•£ã®åˆ†å¸ƒ
sample_variances = []
np.random.seed(42)
for _ in range(5000):
    sample = np.random.normal(mu_true, sigma_true, n)
    sample_variances.append(np.var(sample, ddof=1))

axes[1].hist(sample_variances, bins=50, density=True, alpha=0.7,
             color='skyblue', edgecolor='black', label='æ¨™æœ¬åˆ†æ•£ã®åˆ†å¸ƒ')
axes[1].axvline(sigma2_true, color='red', linestyle='--', linewidth=2,
                label=f'çœŸã®æ¯åˆ†æ•£: {sigma2_true}')
axes[1].axvline(ci_lower, color='green', linestyle=':', linewidth=2,
                label=f'ä¿¡é ¼åŒºé–“ä¸‹é™: {ci_lower:.1f}')
axes[1].axvline(ci_upper, color='green', linestyle=':', linewidth=2,
                label=f'ä¿¡é ¼åŒºé–“ä¸Šé™: {ci_upper:.1f}')
axes[1].axvspan(ci_lower, ci_upper, alpha=0.2, color='green')
axes[1].set_xlabel('åˆ†æ•£')
axes[1].set_ylabel('å¯†åº¦')
axes[1].set_title('æ¨™æœ¬åˆ†æ•£ã®åˆ†å¸ƒã¨ä¿¡é ¼åŒºé–“')
axes[1].legend()
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()</code></pre>
            </div>

            <h2>2.4 2æ¨™æœ¬å•é¡Œã¨å·®ã®ä¿¡é ¼åŒºé–“</h2>

            <div class="theory-box">
                <h4>ğŸ“˜ 2ã¤ã®æ¯å¹³å‡ã®å·®ã®ä¿¡é ¼åŒºé–“</h4>
                <p><strong>ç­‰åˆ†æ•£ã®å ´åˆ</strong>ï¼ˆãƒ—ãƒ¼ãƒ«ã•ã‚ŒãŸåˆ†æ•£ã‚’ä½¿ç”¨ï¼‰ï¼š</p>
                <div class="formula">
                    $$ (\bar{X}_1 - \bar{X}_2) \pm t_{\alpha/2, n_1+n_2-2} \cdot S_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}} $$
                </div>
                <p>ã“ã“ã§ \( S_p^2 = \frac{(n_1-1)S_1^2 + (n_2-1)S_2^2}{n_1+n_2-2} \) ã¯ãƒ—ãƒ¼ãƒ«ã•ã‚ŒãŸåˆ†æ•£</p>

                <p><strong>ä¸ç­‰åˆ†æ•£ã®å ´åˆ</strong>ï¼ˆWelchã®tæ¤œå®šï¼‰ï¼š</p>
                <div class="formula">
                    $$ (\bar{X}_1 - \bar{X}_2) \pm t_{\alpha/2, \nu} \sqrt{\frac{S_1^2}{n_1} + \frac{S_2^2}{n_2}} $$
                </div>
                <p>è‡ªç”±åº¦ \( \nu \) ã¯Welch-Satterthwaiteã®è¿‘ä¼¼å¼ã§è¨ˆç®—</p>
            </div>

            <div class="example">
                <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹4: 2æ¨™æœ¬tä¿¡é ¼åŒºé–“</h4>
                <pre><code>import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# 2ã¤ã®è£½é€ ãƒ—ãƒ­ã‚»ã‚¹ã®å¼·åº¦ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
np.random.seed(42)

# ãƒ—ãƒ­ã‚»ã‚¹A
mu_A = 450
sigma_A = 25
n_A = 20
data_A = np.random.normal(mu_A, sigma_A, n_A)

# ãƒ—ãƒ­ã‚»ã‚¹B
mu_B = 470
sigma_B = 30
n_B = 25
data_B = np.random.normal(mu_B, sigma_B, n_B)

# æ¨™æœ¬çµ±è¨ˆé‡
x_bar_A = np.mean(data_A)
x_bar_B = np.mean(data_B)
s_A = np.std(data_A, ddof=1)
s_B = np.std(data_B, ddof=1)

diff = x_bar_B - x_bar_A
true_diff = mu_B - mu_A

print("=== 2æ¨™æœ¬å•é¡Œ: å¹³å‡ã®å·®ã®ä¿¡é ¼åŒºé–“ ===")
print(f"ãƒ—ãƒ­ã‚»ã‚¹A: n={n_A}, å¹³å‡={x_bar_A:.2f}, SD={s_A:.2f}")
print(f"ãƒ—ãƒ­ã‚»ã‚¹B: n={n_B}, å¹³å‡={x_bar_B:.2f}, SD={s_B:.2f}")
print(f"å¹³å‡ã®å·®: {diff:.2f} (çœŸã®å·®: {true_diff})")

# ç­‰åˆ†æ•£æ€§ã®æ¤œå®šï¼ˆFæ¤œå®šï¼‰
f_stat = s_A**2 / s_B**2 if s_A > s_B else s_B**2 / s_A**2
f_pvalue = 2 * min(stats.f.cdf(s_A**2/s_B**2, n_A-1, n_B-1),
                   1 - stats.f.cdf(s_A**2/s_B**2, n_A-1, n_B-1))
print(f"\nç­‰åˆ†æ•£æ€§ã®æ¤œå®šï¼ˆFæ¤œå®šï¼‰:")
print(f"  Fçµ±è¨ˆé‡: {f_stat:.4f}, på€¤: {f_pvalue:.4f}")

# æ–¹æ³•1: ç­‰åˆ†æ•£ã‚’ä»®å®šï¼ˆãƒ—ãƒ¼ãƒ«ã•ã‚ŒãŸåˆ†æ•£ï¼‰
alpha = 0.05
s_pooled = np.sqrt(((n_A-1)*s_A**2 + (n_B-1)*s_B**2) / (n_A + n_B - 2))
se_pooled = s_pooled * np.sqrt(1/n_A + 1/n_B)
df_pooled = n_A + n_B - 2
t_crit_pooled = stats.t.ppf(1 - alpha/2, df=df_pooled)
ci_lower_pooled = diff - t_crit_pooled * se_pooled
ci_upper_pooled = diff + t_crit_pooled * se_pooled

print(f"\nã€æ–¹æ³•1ã€‘ç­‰åˆ†æ•£ã‚’ä»®å®š:")
print(f"  ãƒ—ãƒ¼ãƒ«ã•ã‚ŒãŸæ¨™æº–åå·®: {s_pooled:.2f}")
print(f"  è‡ªç”±åº¦: {df_pooled}")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_pooled:.2f}, {ci_upper_pooled:.2f}]")

# æ–¹æ³•2: ä¸ç­‰åˆ†æ•£ï¼ˆWelchã®æ–¹æ³•ï¼‰
se_welch = np.sqrt(s_A**2/n_A + s_B**2/n_B)
df_welch = (s_A**2/n_A + s_B**2/n_B)**2 / \
           (s_A**4/(n_A**2*(n_A-1)) + s_B**4/(n_B**2*(n_B-1)))
t_crit_welch = stats.t.ppf(1 - alpha/2, df=df_welch)
ci_lower_welch = diff - t_crit_welch * se_welch
ci_upper_welch = diff + t_crit_welch * se_welch

print(f"\nã€æ–¹æ³•2ã€‘ä¸ç­‰åˆ†æ•£ï¼ˆWelchï¼‰:")
print(f"  è‡ªç”±åº¦ï¼ˆWelch-Satterthwaiteï¼‰: {df_welch:.2f}")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_welch:.2f}, {ci_upper_welch:.2f}]")

# SciPyã®é–¢æ•°ã‚’ä½¿ç”¨
t_stat, p_value = stats.ttest_ind(data_B, data_A, equal_var=False)
ci_scipy = stats.ttest_ind(data_B, data_A, equal_var=False,
                            alternative='two-sided').confidence_interval(0.95)
print(f"\nã€SciPyã€‘ä¸ç­‰åˆ†æ•£tæ¤œå®š:")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_scipy.low:.2f}, {ci_scipy.high:.2f}]")

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒ
axes[0].boxplot([data_A, data_B], labels=['ãƒ—ãƒ­ã‚»ã‚¹A', 'ãƒ—ãƒ­ã‚»ã‚¹B'],
                patch_artist=True,
                boxprops=dict(facecolor='skyblue', alpha=0.7),
                medianprops=dict(color='red', linewidth=2))
axes[0].scatter(np.ones(n_A)*1 + np.random.normal(0, 0.05, n_A),
                data_A, alpha=0.5, color='blue', s=30)
axes[0].scatter(np.ones(n_B)*2 + np.random.normal(0, 0.05, n_B),
                data_B, alpha=0.5, color='green', s=30)
axes[0].set_ylabel('å¼·åº¦ [MPa]')
axes[0].set_title('2ã¤ã®ãƒ—ãƒ­ã‚»ã‚¹ã®å¼·åº¦ãƒ‡ãƒ¼ã‚¿')
axes[0].grid(True, alpha=0.3, axis='y')

# å¹³å‡ã®å·®ã®ä¿¡é ¼åŒºé–“
methods = ['ç­‰åˆ†æ•£\nä»®å®š', 'Welch\n(ä¸ç­‰åˆ†æ•£)']
diffs = [diff, diff]
errors_lower = [diff - ci_lower_pooled, diff - ci_lower_welch]
errors_upper = [ci_upper_pooled - diff, ci_upper_welch - diff]

axes[1].errorbar(methods, diffs,
                 yerr=[errors_lower, errors_upper],
                 fmt='o', markersize=10, capsize=10, capthick=2,
                 elinewidth=2, color='blue', label='95%ä¿¡é ¼åŒºé–“')
axes[1].axhline(true_diff, color='red', linestyle='--',
                linewidth=2, label=f'çœŸã®å·®: {true_diff}')
axes[1].axhline(0, color='gray', linestyle=':', linewidth=1,
                label='å·®ãªã—')
axes[1].set_ylabel('å¹³å‡ã®å·® [MPa]')
axes[1].set_title('å¹³å‡ã®å·®ã®95%ä¿¡é ¼åŒºé–“')
axes[1].legend()
axes[1].grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.show()</code></pre>
            </div>

            <h2>2.5 å‰²åˆã®ä¿¡é ¼åŒºé–“ï¼ˆäºŒé …åˆ†å¸ƒï¼‰</h2>

            <div class="theory-box">
                <h4>ğŸ“˜ æ¯æ¯”ç‡ã®ä¿¡é ¼åŒºé–“</h4>
                <p><strong>æ­£è¦è¿‘ä¼¼</strong>ï¼ˆ\( np \geq 5 \) ã‹ã¤ \( n(1-p) \geq 5 \) ã®ã¨ãï¼‰ï¼š</p>
                <div class="formula">
                    $$ \hat{p} \pm z_{\alpha/2} \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} $$
                </div>
                <p><strong>WilsonåŒºé–“</strong>ï¼ˆå°æ¨™æœ¬ã§ã‚‚é©ç”¨å¯èƒ½ï¼‰ï¼š</p>
                <div class="formula">
                    $$ \frac{\hat{p} + \frac{z^2}{2n} \pm z\sqrt{\frac{\hat{p}(1-\hat{p})}{n} + \frac{z^2}{4n^2}}}{1 + \frac{z^2}{n}} $$
                </div>
            </div>

            <div class="example">
                <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹5: æ¯æ¯”ç‡ã®ä¿¡é ¼åŒºé–“</h4>
                <pre><code>import numpy as np
import matplotlib.pyplot as plt
from scipy import stats
from statsmodels.stats.proportion import proportion_confint

# ãƒ‡ãƒ¼ã‚¿ï¼ˆä¾‹: è£½å“ã®ä¸è‰¯ç‡èª¿æŸ»ï¼‰
n = 200  # æ¤œæŸ»ã—ãŸè£½å“æ•°
x = 15   # ä¸è‰¯å“æ•°
p_hat = x / n  # æ¨™æœ¬æ¯”ç‡

print("=== æ¯æ¯”ç‡ã®ä¿¡é ¼åŒºé–“ ===")
print(f"æ¨™æœ¬ã‚µã‚¤ã‚º: {n}")
print(f"ä¸è‰¯å“æ•°: {x}")
print(f"æ¨™æœ¬æ¯”ç‡: {p_hat:.4f} ({p_hat*100:.2f}%)")

# æ–¹æ³•1: æ­£è¦è¿‘ä¼¼ï¼ˆWaldåŒºé–“ï¼‰
alpha = 0.05
z = stats.norm.ppf(1 - alpha/2)
se = np.sqrt(p_hat * (1 - p_hat) / n)
ci_lower_wald = p_hat - z * se
ci_upper_wald = p_hat + z * se

print(f"\nã€WaldåŒºé–“ã€‘ï¼ˆæ­£è¦è¿‘ä¼¼ï¼‰:")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_wald:.4f}, {ci_upper_wald:.4f}]")
print(f"               [{ci_lower_wald*100:.2f}%, {ci_upper_wald*100:.2f}%]")

# æ–¹æ³•2: WilsonåŒºé–“
term1 = p_hat + z**2 / (2*n)
term2 = z * np.sqrt(p_hat*(1-p_hat)/n + z**2/(4*n**2))
denominator = 1 + z**2/n
ci_lower_wilson = (term1 - term2) / denominator
ci_upper_wilson = (term1 + term2) / denominator

print(f"\nã€WilsonåŒºé–“ã€‘:")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_wilson:.4f}, {ci_upper_wilson:.4f}]")
print(f"               [{ci_lower_wilson*100:.2f}%, {ci_upper_wilson*100:.2f}%]")

# æ–¹æ³•3: Clopper-PearsonåŒºé–“ï¼ˆexactï¼‰
ci_lower_cp, ci_upper_cp = proportion_confint(x, n, alpha=alpha, method='beta')

print(f"\nã€Clopper-PearsonåŒºé–“ã€‘ï¼ˆexactï¼‰:")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_cp:.4f}, {ci_upper_cp:.4f}]")
print(f"               [{ci_lower_cp*100:.2f}%, {ci_upper_cp*100:.2f}%]")

# æ¯”è¼ƒå¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# å„æ‰‹æ³•ã®ä¿¡é ¼åŒºé–“æ¯”è¼ƒ
methods = ['Wald\n(æ­£è¦è¿‘ä¼¼)', 'Wilson', 'Clopper-\nPearson']
lowers = [ci_lower_wald, ci_lower_wilson, ci_lower_cp]
uppers = [ci_upper_wald, ci_upper_wilson, ci_upper_cp]
centers = [p_hat, p_hat, p_hat]

for i, (method, lower, upper) in enumerate(zip(methods, lowers, uppers)):
    axes[0].plot([lower, upper], [i, i], 'o-', linewidth=3, markersize=8,
                 label=method)

axes[0].axvline(p_hat, color='red', linestyle='--', linewidth=2,
                label=f'æ¨™æœ¬æ¯”ç‡: {p_hat:.3f}')
axes[0].set_yticks(range(len(methods)))
axes[0].set_yticklabels(methods)
axes[0].set_xlabel('æ¯”ç‡')
axes[0].set_title('æ¯æ¯”ç‡ã®95%ä¿¡é ¼åŒºé–“ï¼ˆæ‰‹æ³•æ¯”è¼ƒï¼‰')
axes[0].grid(True, alpha=0.3, axis='x')
axes[0].legend()

# æ¨™æœ¬ã‚µã‚¤ã‚ºã¨ä¿¡é ¼åŒºé–“å¹…ã®é–¢ä¿‚
sample_sizes = np.logspace(1, 3, 50, dtype=int)
widths_wald = []
widths_wilson = []

p_fixed = 0.075  # å›ºå®šã•ã‚ŒãŸçœŸã®æ¯”ç‡

for ns in sample_sizes:
    x_sim = int(p_fixed * ns)
    p_sim = x_sim / ns

    # Wald
    se_sim = np.sqrt(p_sim * (1-p_sim) / ns)
    w_wald = 2 * z * se_sim
    widths_wald.append(w_wald)

    # Wilson
    t1 = p_sim + z**2/(2*ns)
    t2 = z * np.sqrt(p_sim*(1-p_sim)/ns + z**2/(4*ns**2))
    denom = 1 + z**2/ns
    w_wilson = 2 * t2 / denom
    widths_wilson.append(w_wilson)

axes[1].plot(sample_sizes, widths_wald, 'b-', linewidth=2, label='WaldåŒºé–“')
axes[1].plot(sample_sizes, widths_wilson, 'g--', linewidth=2, label='WilsonåŒºé–“')
axes[1].set_xlabel('æ¨™æœ¬ã‚µã‚¤ã‚º')
axes[1].set_ylabel('ä¿¡é ¼åŒºé–“ã®å¹…')
axes[1].set_title(f'æ¨™æœ¬ã‚µã‚¤ã‚ºã¨ä¿¡é ¼åŒºé–“å¹…ã®é–¢ä¿‚ (p={p_fixed})')
axes[1].set_xscale('log')
axes[1].set_yscale('log')
axes[1].legend()
axes[1].grid(True, alpha=0.3, which='both')

plt.tight_layout()
plt.show()</code></pre>
            </div>

            <h2>2.6 ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ä¿¡é ¼åŒºé–“</h2>

            <div class="theory-box">
                <h4>ğŸ“˜ ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—æ³•</h4>
                <p>ç†è«–çš„ãªåˆ†å¸ƒãŒæœªçŸ¥ã®å ´åˆã€ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°ã«ã‚ˆã£ã¦ä¿¡é ¼åŒºé–“ã‚’æ§‹ç¯‰ã§ãã¾ã™ï¼š</p>
                <ol>
                    <li>å…ƒãƒ‡ãƒ¼ã‚¿ã‹ã‚‰<strong>å¾©å…ƒæŠ½å‡º</strong>ã§ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒ«ã‚’ç”Ÿæˆ</li>
                    <li>å„ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ã‚µãƒ³ãƒ—ãƒ«ã§çµ±è¨ˆé‡ã‚’è¨ˆç®—</li>
                    <li>çµ±è¨ˆé‡ã®åˆ†å¸ƒã‹ã‚‰åˆ†ä½ç‚¹ã‚’æ±‚ã‚ã¦ä¿¡é ¼åŒºé–“ã‚’æ§‹ç¯‰</li>
                </ol>
                <p><strong>ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«æ³•</strong>: ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—åˆ†å¸ƒã® \( \alpha/2 \) åˆ†ä½ç‚¹ã¨ \( 1-\alpha/2 \) åˆ†ä½ç‚¹ã‚’åŒºé–“ç«¯ç‚¹ã¨ã™ã‚‹</p>
            </div>

            <div class="example">
                <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹6: ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ä¿¡é ¼åŒºé–“</h4>
                <pre><code>import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆæ­ªã‚“ã åˆ†å¸ƒï¼‰
np.random.seed(42)
# ã‚¬ãƒ³ãƒåˆ†å¸ƒï¼ˆå³ã«æ­ªã‚“ã§ã„ã‚‹ï¼‰
data = np.random.gamma(2, 2, 50)

# æ¨å®šã—ãŸã„çµ±è¨ˆé‡: ä¸­å¤®å€¤ï¼ˆmedianï¼‰
observed_median = np.median(data)

print("=== ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ä¿¡é ¼åŒºé–“ ===")
print(f"æ¨™æœ¬ã‚µã‚¤ã‚º: {len(data)}")
print(f"æ¨™æœ¬ä¸­å¤®å€¤: {observed_median:.2f}")
print(f"æ¨™æœ¬å¹³å‡: {np.mean(data):.2f}")
print(f"ãƒ‡ãƒ¼ã‚¿ã®æ­ªåº¦: {stats.skew(data):.2f}")

# ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
n_bootstrap = 10000
bootstrap_medians = []

np.random.seed(123)
for _ in range(n_bootstrap):
    # å¾©å…ƒæŠ½å‡º
    bootstrap_sample = np.random.choice(data, size=len(data), replace=True)
    bootstrap_medians.append(np.median(bootstrap_sample))

bootstrap_medians = np.array(bootstrap_medians)

# ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«æ³•ã«ã‚ˆã‚‹ä¿¡é ¼åŒºé–“
alpha = 0.05
ci_lower_percentile = np.percentile(bootstrap_medians, alpha/2 * 100)
ci_upper_percentile = np.percentile(bootstrap_medians, (1 - alpha/2) * 100)

print(f"\nã€ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«æ³•ã€‘:")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_percentile:.2f}, {ci_upper_percentile:.2f}]")

# BCaæ³•ï¼ˆBias-Corrected and Acceleratedï¼‰ã«ã‚ˆã‚‹ä¿¡é ¼åŒºé–“
# ã‚ˆã‚Šç²¾åº¦ã®é«˜ã„æ–¹æ³•
from scipy.stats import norm

# ãƒã‚¤ã‚¢ã‚¹è£œæ­£é …ã®è¨ˆç®—
z0 = norm.ppf(np.sum(bootstrap_medians < observed_median) / n_bootstrap)

# åŠ é€Ÿåº¦å®šæ•°ã®è¨ˆç®—ï¼ˆã‚¸ãƒ£ãƒƒã‚¯ãƒŠã‚¤ãƒ•æ³•ï¼‰
jackknife_medians = []
for i in range(len(data)):
    jackknife_sample = np.delete(data, i)
    jackknife_medians.append(np.median(jackknife_sample))

jackknife_medians = np.array(jackknife_medians)
mean_jack = np.mean(jackknife_medians)
numerator = np.sum((mean_jack - jackknife_medians)**3)
denominator = 6 * (np.sum((mean_jack - jackknife_medians)**2))**(3/2)
a = numerator / denominator if denominator != 0 else 0

# BCaä¿¡é ¼åŒºé–“ã®åˆ†ä½ç‚¹
z_alpha = norm.ppf(alpha/2)
z_1alpha = norm.ppf(1 - alpha/2)

p_lower = norm.cdf(z0 + (z0 + z_alpha)/(1 - a*(z0 + z_alpha)))
p_upper = norm.cdf(z0 + (z0 + z_1alpha)/(1 - a*(z0 + z_1alpha)))

ci_lower_bca = np.percentile(bootstrap_medians, p_lower * 100)
ci_upper_bca = np.percentile(bootstrap_medians, p_upper * 100)

print(f"\nã€BCaæ³•ã€‘:")
print(f"  ãƒã‚¤ã‚¢ã‚¹è£œæ­£é … z0: {z0:.4f}")
print(f"  åŠ é€Ÿåº¦å®šæ•° a: {a:.4f}")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_bca:.2f}, {ci_upper_bca:.2f}]")

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# å…ƒãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒ
axes[0].hist(data, bins=15, density=True, alpha=0.7,
             color='skyblue', edgecolor='black', label='ãƒ‡ãƒ¼ã‚¿')
axes[0].axvline(observed_median, color='red', linestyle='--',
                linewidth=2, label=f'æ¨™æœ¬ä¸­å¤®å€¤: {observed_median:.1f}')
axes[0].axvline(np.mean(data), color='blue', linestyle=':',
                linewidth=2, label=f'æ¨™æœ¬å¹³å‡: {np.mean(data):.1f}')
axes[0].set_xlabel('å€¤')
axes[0].set_ylabel('å¯†åº¦')
axes[0].set_title('å…ƒãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒï¼ˆå³ã«æ­ªã‚“ã§ã„ã‚‹ï¼‰')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—åˆ†å¸ƒ
axes[1].hist(bootstrap_medians, bins=50, density=True, alpha=0.7,
             color='lightgreen', edgecolor='black', label='ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—åˆ†å¸ƒ')
axes[1].axvline(observed_median, color='red', linestyle='--',
                linewidth=2, label=f'è¦³æ¸¬ä¸­å¤®å€¤: {observed_median:.1f}')
axes[1].axvline(ci_lower_percentile, color='blue', linestyle=':',
                linewidth=2, label='ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«æ³•')
axes[1].axvline(ci_upper_percentile, color='blue', linestyle=':',
                linewidth=2)
axes[1].axvline(ci_lower_bca, color='purple', linestyle='--',
                linewidth=2, label='BCaæ³•')
axes[1].axvline(ci_upper_bca, color='purple', linestyle='--',
                linewidth=2)
axes[1].set_xlabel('ä¸­å¤®å€¤')
axes[1].set_ylabel('å¯†åº¦')
axes[1].set_title(f'ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—åˆ†å¸ƒï¼ˆ{n_bootstrap}å›ï¼‰')
axes[1].legend()
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

# æ­£è¦è¿‘ä¼¼ã¨ã®æ¯”è¼ƒ
print(f"\nã€å‚è€ƒã€‘æ­£è¦è¿‘ä¼¼ã«ã‚ˆã‚‹ä¸­å¤®å€¤ã®ä¿¡é ¼åŒºé–“:")
# ä¸­å¤®å€¤ã®æ¨™æº–èª¤å·®ã®è¿‘ä¼¼: SE â‰ˆ 1.253 * Ïƒ / sqrt(n)
se_median_approx = 1.253 * np.std(data) / np.sqrt(len(data))
ci_lower_normal = observed_median - 1.96 * se_median_approx
ci_upper_normal = observed_median + 1.96 * se_median_approx
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_lower_normal:.2f}, {ci_upper_normal:.2f}]")
print(f"  ï¼ˆæ­ªã‚“ã åˆ†å¸ƒã§ã¯ä¸æ­£ç¢ºãªå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼‰")</code></pre>
            </div>

            <div class="note">
                <strong>ğŸ“Œ é‡è¦ãƒã‚¤ãƒ³ãƒˆ</strong><br>
                ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—æ³•ã¯åˆ†å¸ƒã®å½¢ã‚’ä»®å®šã›ãšã«ä¿¡é ¼åŒºé–“ã‚’æ§‹ç¯‰ã§ãã‚‹å¼·åŠ›ãªæ‰‹æ³•ã§ã™ã€‚
                ç‰¹ã«ã€ä¸­å¤®å€¤ã‚„æ­ªåº¦ãªã©ã€ç†è«–çš„ãªåˆ†å¸ƒãŒè¤‡é›‘ãªçµ±è¨ˆé‡ã«æœ‰åŠ¹ã§ã™ã€‚BCaæ³•ã¯ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«æ³•ã‚ˆã‚Š
                ç²¾åº¦ãŒé«˜ãã€ãƒã‚¤ã‚¢ã‚¹ã¨æ­ªåº¦ã‚’è£œæ­£ã—ã¾ã™ã€‚
            </div>

            <h2>2.7 ææ–™å¼·åº¦ãƒ‡ãƒ¼ã‚¿ã®åŒºé–“æ¨å®š</h2>

            <div class="example">
                <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹7: ææ–™å¼·åº¦ãƒ‡ãƒ¼ã‚¿ã®åŒ…æ‹¬çš„åŒºé–“æ¨å®š</h4>
                <pre><code>import numpy as np
import matplotlib.pyplot as plt
from scipy import stats
from statsmodels.stats.proportion import proportion_confint

# ææ–™å¼·åº¦ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
np.random.seed(42)
n_specimens = 30
true_mean = 450  # MPa
true_std = 30    # MPa

# Weibullåˆ†å¸ƒã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆè„†æ€§ææ–™ï¼‰
k_weibull = 15
lambda_weibull = 470
strength_data = np.random.weibull(k_weibull, n_specimens) * lambda_weibull

print("=== ææ–™å¼·åº¦ãƒ‡ãƒ¼ã‚¿ã®åŒºé–“æ¨å®š ===")
print(f"è©¦é¨“ç‰‡æ•°: {n_specimens}")
print(f"å¹³å‡å¼·åº¦: {np.mean(strength_data):.2f} MPa")
print(f"æ¨™æº–åå·®: {np.std(strength_data, ddof=1):.2f} MPa")
print(f"æœ€å°å€¤: {np.min(strength_data):.2f} MPa")
print(f"æœ€å¤§å€¤: {np.max(strength_data):.2f} MPa")

# 1. å¹³å‡å¼·åº¦ã®95%ä¿¡é ¼åŒºé–“ï¼ˆtåŒºé–“ï¼‰
mean_strength = np.mean(strength_data)
std_strength = np.std(strength_data, ddof=1)
se_mean = std_strength / np.sqrt(n_specimens)
alpha = 0.05
t_crit = stats.t.ppf(1 - alpha/2, df=n_specimens-1)
ci_mean_lower = mean_strength - t_crit * se_mean
ci_mean_upper = mean_strength + t_crit * se_mean

print(f"\nã€å¹³å‡å¼·åº¦ã®95%ä¿¡é ¼åŒºé–“ã€‘:")
print(f"  [{ci_mean_lower:.2f}, {ci_mean_upper:.2f}] MPa")

# 2. æ¨™æº–åå·®ã®95%ä¿¡é ¼åŒºé–“ï¼ˆã‚«ã‚¤äºŒä¹—åˆ†å¸ƒï¼‰
chi2_lower = stats.chi2.ppf(alpha/2, df=n_specimens-1)
chi2_upper = stats.chi2.ppf(1-alpha/2, df=n_specimens-1)
ci_std_lower = np.sqrt((n_specimens-1) * std_strength**2 / chi2_upper)
ci_std_upper = np.sqrt((n_specimens-1) * std_strength**2 / chi2_lower)

print(f"\nã€æ¨™æº–åå·®ã®95%ä¿¡é ¼åŒºé–“ã€‘:")
print(f"  [{ci_std_lower:.2f}, {ci_std_upper:.2f}] MPa")

# 3. å¤‰å‹•ä¿‚æ•°ï¼ˆCVï¼‰ã®ä¿¡é ¼åŒºé–“ï¼ˆãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ï¼‰
cv_observed = std_strength / mean_strength

n_bootstrap = 5000
cv_bootstrap = []
np.random.seed(123)
for _ in range(n_bootstrap):
    boot_sample = np.random.choice(strength_data, size=n_specimens, replace=True)
    cv_bootstrap.append(np.std(boot_sample, ddof=1) / np.mean(boot_sample))

ci_cv_lower = np.percentile(cv_bootstrap, alpha/2 * 100)
ci_cv_upper = np.percentile(cv_bootstrap, (1-alpha/2) * 100)

print(f"\nã€å¤‰å‹•ä¿‚æ•°ï¼ˆCVï¼‰ã®95%ä¿¡é ¼åŒºé–“ã€‘:")
print(f"  è¦³æ¸¬CV: {cv_observed:.4f} ({cv_observed*100:.2f}%)")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_cv_lower:.4f}, {ci_cv_upper:.4f}]")
print(f"               [{ci_cv_lower*100:.2f}%, {ci_cv_upper*100:.2f}%]")

# 4. ç ´å£Šç¢ºç‡ã®ä¿¡é ¼åŒºé–“
# 400 MPaä»¥ä¸‹ã§ç ´å£Šã™ã‚‹ç¢ºç‡ã®æ¨å®š
threshold = 400  # MPa
n_failed = np.sum(strength_data <= threshold)
p_failure = n_failed / n_specimens

print(f"\nã€ç ´å£Šç¢ºç‡ã®95%ä¿¡é ¼åŒºé–“ã€‘({threshold} MPaä»¥ä¸‹):")
print(f"  ç ´å£Šã—ãŸè©¦é¨“ç‰‡æ•°: {n_failed}/{n_specimens}")
print(f"  æ¨™æœ¬ç ´å£Šç¢ºç‡: {p_failure:.4f} ({p_failure*100:.2f}%)")

if n_failed > 0:
    ci_fail_lower, ci_fail_upper = proportion_confint(n_failed, n_specimens,
                                                       alpha=alpha, method='wilson')
    print(f"  Wilsonä¿¡é ¼åŒºé–“: [{ci_fail_lower:.4f}, {ci_fail_upper:.4f}]")
    print(f"                   [{ci_fail_lower*100:.2f}%, {ci_fail_upper*100:.2f}%]")
else:
    print(f"  ï¼ˆç ´å£Šãªã—: ä¸Šå´ä¿¡é ¼é™ç•Œã®ã¿è¨ˆç®—å¯èƒ½ï¼‰")

# 5. ç‰¹å®šãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã®ä¿¡é ¼åŒºé–“ï¼ˆãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—ï¼‰
# 5%ã‚¿ã‚¤ãƒ«ï¼ˆä¸‹ä½5%ã®å¼·åº¦ï¼‰ã®ä¿¡é ¼åŒºé–“
percentile_5 = np.percentile(strength_data, 5)
percentile_95 = np.percentile(strength_data, 95)

p5_bootstrap = []
p95_bootstrap = []
for _ in range(n_bootstrap):
    boot_sample = np.random.choice(strength_data, size=n_specimens, replace=True)
    p5_bootstrap.append(np.percentile(boot_sample, 5))
    p95_bootstrap.append(np.percentile(boot_sample, 95))

ci_p5_lower = np.percentile(p5_bootstrap, alpha/2 * 100)
ci_p5_upper = np.percentile(p5_bootstrap, (1-alpha/2) * 100)
ci_p95_lower = np.percentile(p95_bootstrap, alpha/2 * 100)
ci_p95_upper = np.percentile(p95_bootstrap, (1-alpha/2) * 100)

print(f"\nã€5ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã®95%ä¿¡é ¼åŒºé–“ã€‘:")
print(f"  è¦³æ¸¬å€¤: {percentile_5:.2f} MPa")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_p5_lower:.2f}, {ci_p5_upper:.2f}] MPa")

print(f"\nã€95ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã®95%ä¿¡é ¼åŒºé–“ã€‘:")
print(f"  è¦³æ¸¬å€¤: {percentile_95:.2f} MPa")
print(f"  95%ä¿¡é ¼åŒºé–“: [{ci_p95_lower:.2f}, {ci_p95_upper:.2f}] MPa")

# å¯è¦–åŒ–
fig = plt.figure(figsize=(16, 10))
gs = fig.add_gridspec(3, 2, hspace=0.3, wspace=0.3)

# 1. ãƒ‡ãƒ¼ã‚¿ã®åˆ†å¸ƒã¨å¹³å‡ã®ä¿¡é ¼åŒºé–“
ax1 = fig.add_subplot(gs[0, :])
ax1.hist(strength_data, bins=12, density=True, alpha=0.7,
         color='skyblue', edgecolor='black', label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')
ax1.axvline(mean_strength, color='blue', linestyle='--', linewidth=2,
            label=f'å¹³å‡: {mean_strength:.1f} MPa')
ax1.axvspan(ci_mean_lower, ci_mean_upper, alpha=0.3, color='blue',
            label=f'å¹³å‡ã®95%CI: [{ci_mean_lower:.1f}, {ci_mean_upper:.1f}]')
ax1.axvline(threshold, color='red', linestyle=':', linewidth=2,
            label=f'è¨­è¨ˆåŸºæº–: {threshold} MPa')
ax1.set_xlabel('å¼·åº¦ [MPa]')
ax1.set_ylabel('å¯†åº¦')
ax1.set_title('ææ–™å¼·åº¦ãƒ‡ãƒ¼ã‚¿ã¨çµ±è¨ˆçš„åŒºé–“æ¨å®š')
ax1.legend()
ax1.grid(True, alpha=0.3)

# 2. CVã®ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—åˆ†å¸ƒ
ax2 = fig.add_subplot(gs[1, 0])
ax2.hist(cv_bootstrap, bins=40, density=True, alpha=0.7,
         color='lightgreen', edgecolor='black')
ax2.axvline(cv_observed, color='red', linestyle='--', linewidth=2,
            label=f'è¦³æ¸¬CV: {cv_observed:.3f}')
ax2.axvline(ci_cv_lower, color='blue', linestyle=':', linewidth=2)
ax2.axvline(ci_cv_upper, color='blue', linestyle=':', linewidth=2,
            label=f'95%CI: [{ci_cv_lower:.3f}, {ci_cv_upper:.3f}]')
ax2.set_xlabel('å¤‰å‹•ä¿‚æ•° (CV)')
ax2.set_ylabel('å¯†åº¦')
ax2.set_title('å¤‰å‹•ä¿‚æ•°ã®ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—åˆ†å¸ƒ')
ax2.legend()
ax2.grid(True, alpha=0.3)

# 3. ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«ã®ä¿¡é ¼åŒºé–“
ax3 = fig.add_subplot(gs[1, 1])
percentiles = [5, 25, 50, 75, 95]
obs_values = [np.percentile(strength_data, p) for p in percentiles]
ci_lowers = [ci_p5_lower, 0, 0, 0, ci_p95_lower]
ci_uppers = [ci_p5_upper, 0, 0, 0, ci_p95_upper]

# 5%ã¨95%ã‚¿ã‚¤ãƒ«ã®ã¿ä¿¡é ¼åŒºé–“ã‚’è¡¨ç¤º
ax3.errorbar([0, 4], [obs_values[0], obs_values[4]],
             yerr=[[obs_values[0]-ci_lowers[0], obs_values[4]-ci_lowers[4]],
                   [ci_uppers[0]-obs_values[0], ci_uppers[4]-obs_values[4]]],
             fmt='o', markersize=10, capsize=8, capthick=2,
             elinewidth=2, color='blue', label='95%ä¿¡é ¼åŒºé–“')
ax3.plot(range(5), obs_values, 'ro-', markersize=8, linewidth=2,
         label='è¦³æ¸¬å€¤')
ax3.set_xticks(range(5))
ax3.set_xticklabels([f'{p}%' for p in percentiles])
ax3.set_ylabel('å¼·åº¦ [MPa]')
ax3.set_title('ãƒ‘ãƒ¼ã‚»ãƒ³ã‚¿ã‚¤ãƒ«å€¤ã¨ä¿¡é ¼åŒºé–“')
ax3.legend()
ax3.grid(True, alpha=0.3, axis='y')

# 4. ä¿¡é ¼åŒºé–“ã®å¹…ã®æ¯”è¼ƒ
ax4 = fig.add_subplot(gs[2, :])
metrics = ['å¹³å‡', 'æ¨™æº–åå·®', 'CV', '5%ã‚¿ã‚¤ãƒ«', '95%ã‚¿ã‚¤ãƒ«']
observed = [mean_strength, std_strength, cv_observed, percentile_5, percentile_95]
lower_ci = [ci_mean_lower, ci_std_lower, ci_cv_lower, ci_p5_lower, ci_p95_lower]
upper_ci = [ci_mean_upper, ci_std_upper, ci_cv_upper, ci_p5_upper, ci_p95_upper]

# æ­£è¦åŒ–ã—ã¦æ¯”è¼ƒ
relative_widths = [(u-l)/o for o, l, u in zip(observed, lower_ci, upper_ci)]

ax4.bar(metrics, relative_widths, color='skyblue', edgecolor='black', alpha=0.7)
ax4.set_ylabel('ç›¸å¯¾çš„åŒºé–“å¹… (åŒºé–“å¹…/æ¨å®šå€¤)')
ax4.set_title('å„çµ±è¨ˆé‡ã®ä¿¡é ¼åŒºé–“ã®ç›¸å¯¾çš„å¹…ï¼ˆä¸ç¢ºå®Ÿæ€§ã®æ¯”è¼ƒï¼‰')
ax4.grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.show()

# å®Ÿè·µçš„ã¾ã¨ã‚
print("\n=== å®Ÿè·µçš„è§£é‡ˆ ===")
print(f"âœ“ å¹³å‡å¼·åº¦ã¯95%ã®ç¢ºç‡ã§{ci_mean_lower:.1f}ï½{ci_mean_upper:.1f} MPaã®ç¯„å›²")
print(f"âœ“ ãƒ‡ãƒ¼ã‚¿ã®ã°ã‚‰ã¤ãï¼ˆæ¨™æº–åå·®ï¼‰ã¯{ci_std_lower:.1f}ï½{ci_std_upper:.1f} MPa")
print(f"âœ“ å¤‰å‹•ä¿‚æ•°ã¯{ci_cv_lower*100:.1f}%ï½{ci_cv_upper*100:.1f}%ï¼ˆå“è³ªã®å®‰å®šæ€§æŒ‡æ¨™ï¼‰")
print(f"âœ“ ä¸‹ä½5%ã®ææ–™å¼·åº¦ã¯{ci_p5_lower:.1f}ï½{ci_p5_upper:.1f} MPaï¼ˆè¨­è¨ˆåŸºæº–å€¤ã®å‚è€ƒï¼‰")</code></pre>
            </div>

            <div class="exercise">
                <h4>ğŸ“ ç·´ç¿’å•é¡Œ</h4>
                <ol>
                    <li>æ¨™æœ¬ã‚µã‚¤ã‚ºãŒ10ã®å ´åˆã¨100ã®å ´åˆã§ã€åŒã˜ä¿¡é ¼æ°´æº–95%ã®ä¿¡é ¼åŒºé–“ã®å¹…ãŒã©ã†å¤‰ã‚ã‚‹ã‹è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</li>
                    <li>ä¿¡é ¼æ°´æº–ã‚’90%ã€95%ã€99%ã¨å¤‰ãˆãŸã¨ãã€ä¿¡é ¼åŒºé–“ã®å¹…ãŒã©ã†å¤‰åŒ–ã™ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚</li>
                    <li>å¯¾å¿œã®ã‚ã‚‹2æ¨™æœ¬ï¼ˆpaired t-testï¼‰ã®ä¿¡é ¼åŒºé–“ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚</li>
                    <li>ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—æ³•ã§æ¨™æœ¬å¹³å‡ã®ä¿¡é ¼åŒºé–“ã‚’æ§‹ç¯‰ã—ã€ç†è«–çš„ãªtåŒºé–“ã¨æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚</li>
                </ol>
            </div>

            <h2>ã¾ã¨ã‚</h2>
            <ul>
                <li>ä¿¡é ¼åŒºé–“ã¯æ¯æ•°ã®ä¸ç¢ºå®Ÿæ€§ã‚’å®šé‡åŒ–ã™ã‚‹é‡è¦ãªæ‰‹æ³•ã§ã‚ã‚‹</li>
                <li>æ¯åˆ†æ•£æ—¢çŸ¥ã®å ´åˆã¯zåˆ†å¸ƒã€æœªçŸ¥ã®å ´åˆã¯tåˆ†å¸ƒã‚’ä½¿ç”¨ã™ã‚‹</li>
                <li>å°æ¨™æœ¬ã§ã¯tåˆ†å¸ƒãŒå¿…é ˆã€å¤§æ¨™æœ¬ã§ã¯æ­£è¦åˆ†å¸ƒã«è¿‘ã¥ã</li>
                <li>æ¯åˆ†æ•£ã®ä¿¡é ¼åŒºé–“ã«ã¯ã‚«ã‚¤äºŒä¹—åˆ†å¸ƒã‚’ä½¿ç”¨ã™ã‚‹</li>
                <li>2æ¨™æœ¬å•é¡Œã§ã¯ç­‰åˆ†æ•£æ€§ã«å¿œã˜ã¦æ‰‹æ³•ã‚’é¸ã¶ï¼ˆãƒ—ãƒ¼ãƒ«ã•ã‚ŒãŸåˆ†æ•£ vs Welchæ³•ï¼‰</li>
                <li>æ¯æ¯”ç‡ã®ä¿¡é ¼åŒºé–“ã¯WilsonåŒºé–“ãŒæ¨å¥¨ã•ã‚Œã‚‹ï¼ˆå°æ¨™æœ¬ã§ã‚‚é©ç”¨å¯èƒ½ï¼‰</li>
                <li>ãƒ–ãƒ¼ãƒˆã‚¹ãƒˆãƒ©ãƒƒãƒ—æ³•ã¯åˆ†å¸ƒã®ä»®å®šãŒä¸è¦ã§å¼·åŠ›ã§ã‚ã‚‹</li>
                <li>ææ–™ç§‘å­¦ã§ã¯è¤‡æ•°ã®çµ±è¨ˆé‡ã®ä¿¡é ¼åŒºé–“ã‚’ç·åˆçš„ã«è©•ä¾¡ã™ã‚‹</li>
            </ul>
        </div>

        <div class="nav-buttons">
            <a href="chapter-1.html" class="nav-button">â† ç¬¬1ç« : æ¨å®šç†è«–ã®åŸºç¤</a>
            <a href="chapter-3.html" class="nav-button">ç¬¬3ç« : ä»®èª¬æ¤œå®šã¨æ¤œå®šåŠ›åˆ†æ â†’</a>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - Fundamentals of Mathematics & Physics Dojo</p>
    </footer>
</body>
</html>
