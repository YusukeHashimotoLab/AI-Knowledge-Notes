<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« : å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã¨å¯¾è§’åŒ– | ç·šå½¢ä»£æ•°ã¨ãƒ†ãƒ³ã‚½ãƒ«è§£æ</title>
    <meta name="description" content="å›ºæœ‰å€¤å•é¡Œã€å¯¾è§’åŒ–ã€å¯¾ç§°è¡Œåˆ—ã®æ€§è³ªã€PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰ã€æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰è§£æã‚’å­¦ã³ã¾ã™ã€‚">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/FM/linear-algebra-tensor/chapter-3.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
        <h1>ç¬¬3ç« : å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã¨å¯¾è§’åŒ–</h1>
        <p class="subtitle">Eigenvalues, Eigenvectors, and Diagonalization</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">ç·šå½¢ä»£æ•°ã¨ãƒ†ãƒ³ã‚½ãƒ«è§£æ</a> &gt;
            ç¬¬3ç« 
        </div>

        <div class="content">
            <h2>3.1 å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®å®šç¾©</h2>

            <div class="definition">
                <strong>ğŸ“ å®šç¾©: å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«</strong><br>
                æ­£æ–¹è¡Œåˆ—Aã«å¯¾ã—ã¦ã€Av = Î»v ã‚’æº€ãŸã™ã‚¼ãƒ­ã§ãªã„ãƒ™ã‚¯ãƒˆãƒ« v ã‚’å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã€
                ã‚¹ã‚«ãƒ©ãƒ¼ Î» ã‚’å›ºæœ‰å€¤ã¨å‘¼ã³ã¾ã™ã€‚<br>
                å¹¾ä½•å­¦çš„æ„å‘³ï¼šå›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã¯è¡Œåˆ—ã«ã‚ˆã‚‹å¤‰æ›ã§æ–¹å‘ãŒå¤‰ã‚ã‚‰ãªã„ãƒ™ã‚¯ãƒˆãƒ«
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹1: å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®è¨ˆç®—</h3>
            <div class="code-title">Pythonå®Ÿè£…: å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®è¨ˆç®—</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# 2Ã—2è¡Œåˆ—
A = np.array([[4, 1],
              [2, 3]])

# å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®è¨ˆç®—
eigenvalues, eigenvectors = np.linalg.eig(A)

print("å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®è¨ˆç®—:")
print(f"A =\n{A}\n")
print(f"å›ºæœ‰å€¤: {eigenvalues}")
print(f"å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«:\n{eigenvectors}\n")

# æ¤œè¨¼: Av = Î»v
for i in range(len(eigenvalues)):
    lam = eigenvalues[i]
    v = eigenvectors[:, i]
    Av = A @ v
    lam_v = lam * v
    print(f"Î»{i+1} = {lam:.4f}")
    print(f"  Av = {Av}")
    print(f"  Î»v = {lam_v}")
    print(f"  Av = Î»v? {np.allclose(Av, lam_v)}\n")</div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹2: å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®å¹¾ä½•å­¦çš„æ„å‘³</h3>
            <div class="code-title">Pythonå®Ÿè£…: å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®å¯è¦–åŒ–</div>
            <div class="code-example"># å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# ãƒ©ãƒ³ãƒ€ãƒ ãªãƒ™ã‚¯ãƒˆãƒ«ã¨å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«
random_vec = np.array([1, 1])
eigen_vec1 = eigenvectors[:, 0]
eigen_vec2 = eigenvectors[:, 1]

# å¤‰æ›å‰ã®ãƒ™ã‚¯ãƒˆãƒ«
origin = [0, 0]
ax1.quiver(*origin, *random_vec, angles='xy', scale_units='xy', scale=1,
           color='blue', width=0.01, label='ä¸€èˆ¬ãƒ™ã‚¯ãƒˆãƒ«')
ax1.quiver(*origin, *eigen_vec1, angles='xy', scale_units='xy', scale=1,
           color='red', width=0.01, label=f'å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«1 (Î»={eigenvalues[0]:.2f})')
ax1.quiver(*origin, *eigen_vec2, angles='xy', scale_units='xy', scale=1,
           color='green', width=0.01, label=f'å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«2 (Î»={eigenvalues[1]:.2f})')
ax1.set_xlim(-1, 5)
ax1.set_ylim(-1, 5)
ax1.set_xlabel('x')
ax1.set_ylabel('y')
ax1.set_title('å¤‰æ›å‰')
ax1.legend()
ax1.grid(True, alpha=0.3)
ax1.axhline(y=0, color='k', linewidth=0.5)
ax1.axvline(x=0, color='k', linewidth=0.5)

# å¤‰æ›å¾Œã®ãƒ™ã‚¯ãƒˆãƒ«
random_transformed = A @ random_vec
eigen_transformed1 = A @ eigen_vec1
eigen_transformed2 = A @ eigen_vec2

ax2.quiver(*origin, *random_transformed, angles='xy', scale_units='xy', scale=1,
           color='blue', width=0.01, label='ä¸€èˆ¬ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆæ–¹å‘å¤‰åŒ–ï¼‰', alpha=0.7)
ax2.quiver(*origin, *eigen_transformed1, angles='xy', scale_units='xy', scale=1,
           color='red', width=0.01, label='å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«1ï¼ˆæ–¹å‘ä¸å¤‰ï¼‰')
ax2.quiver(*origin, *eigen_transformed2, angles='xy', scale_units='xy', scale=1,
           color='green', width=0.01, label='å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«2ï¼ˆæ–¹å‘ä¸å¤‰ï¼‰')

# å…ƒã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’è–„ãè¡¨ç¤º
ax2.quiver(*origin, *random_vec, angles='xy', scale_units='xy', scale=1,
           color='blue', width=0.005, alpha=0.2)
ax2.quiver(*origin, *eigen_vec1, angles='xy', scale_units='xy', scale=1,
           color='red', width=0.005, alpha=0.2)
ax2.quiver(*origin, *eigen_vec2, angles='xy', scale_units='xy', scale=1,
           color='green', width=0.005, alpha=0.2)

ax2.set_xlim(-1, 5)
ax2.set_ylim(-1, 5)
ax2.set_xlabel('x')
ax2.set_ylabel('y')
ax2.set_title('è¡Œåˆ—Aã«ã‚ˆã‚‹å¤‰æ›å¾Œ')
ax2.legend(fontsize=8)
ax2.grid(True, alpha=0.3)
ax2.axhline(y=0, color='k', linewidth=0.5)
ax2.axvline(x=0, color='k', linewidth=0.5)

plt.tight_layout()
plt.show()</div>

            <h2>3.2 ç‰¹æ€§æ–¹ç¨‹å¼ã¨å›ºæœ‰å€¤ã®è¨ˆç®—</h2>

            <div class="theorem">
                <strong>ğŸ“ å®šç†: ç‰¹æ€§æ–¹ç¨‹å¼</strong><br>
                å›ºæœ‰å€¤ Î» ã¯ç‰¹æ€§æ–¹ç¨‹å¼ det(A - Î»I) = 0 ã®è§£ã¨ã—ã¦æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚<br>
                nÃ—nè¡Œåˆ—ã¯nå€‹ã®å›ºæœ‰å€¤ã‚’æŒã¡ã¾ã™ï¼ˆé‡è¤‡ã‚’å«ã‚€ï¼‰ã€‚
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹3: SymPyã«ã‚ˆã‚‹ç‰¹æ€§æ–¹ç¨‹å¼ã®å°å‡º</h3>
            <div class="code-title">Pythonå®Ÿè£…: ç‰¹æ€§æ–¹ç¨‹å¼ã®è¨˜å·è¨ˆç®—</div>
            <div class="code-example">import sympy as sp

# è¨˜å·å¤‰æ•°
lam = sp.Symbol('lambda')

# è¡Œåˆ—Aã‚’è¨˜å·ã§å®šç¾©
A_sym = sp.Matrix([[4, 1],
                   [2, 3]])

# I - å˜ä½è¡Œåˆ—
I = sp.eye(2)

# ç‰¹æ€§è¡Œåˆ— A - Î»I
char_matrix = A_sym - lam * I

print("ç‰¹æ€§æ–¹ç¨‹å¼ã®å°å‡º:")
print(f"A - Î»I =")
sp.pprint(char_matrix)

# ç‰¹æ€§æ–¹ç¨‹å¼ det(A - Î»I) = 0
char_poly = char_matrix.det()
print(f"\nç‰¹æ€§å¤šé …å¼: {char_poly} = 0")

# å›ºæœ‰å€¤ã‚’æ±‚ã‚ã‚‹
eigenvals_sym = sp.solve(char_poly, lam)
print(f"å›ºæœ‰å€¤: {eigenvals_sym}")

# NumPyã®çµæœã¨æ¯”è¼ƒ
print(f"\nNumPyã®å›ºæœ‰å€¤: {eigenvalues}")</div>

            <h2>3.3 å¯¾è§’åŒ–</h2>

            <div class="definition">
                <strong>ğŸ“ å®šç¾©: å¯¾è§’åŒ–</strong><br>
                è¡Œåˆ—AãŒå¯¾è§’åŒ–å¯èƒ½ â‡” P^(-1)AP = D ã¨ãªã‚‹è¡Œåˆ—Pï¼ˆå›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’åˆ—ã«æŒã¤ï¼‰ã¨
                å¯¾è§’è¡Œåˆ—Dï¼ˆå¯¾è§’æˆåˆ†ãŒå›ºæœ‰å€¤ï¼‰ãŒå­˜åœ¨ã™ã‚‹ã€‚
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹4: å¯¾è§’åŒ–ã®å®Ÿè£…</h3>
            <div class="code-title">Pythonå®Ÿè£…: å¯¾è§’åŒ–ã¨å¿œç”¨</div>
            <div class="code-example"># å›ºæœ‰å€¤ã‚’å¯¾è§’æˆåˆ†ã«æŒã¤å¯¾è§’è¡Œåˆ—D
D = np.diag(eigenvalues)

# å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã‚’åˆ—ã«æŒã¤è¡Œåˆ—P
P = eigenvectors

# P^(-1)
P_inv = np.linalg.inv(P)

# æ¤œè¨¼: P^(-1) A P = D
result = P_inv @ A @ P

print("å¯¾è§’åŒ–ã®æ¤œè¨¼:")
print(f"P (å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«è¡Œåˆ—) =\n{P}\n")
print(f"D (å›ºæœ‰å€¤å¯¾è§’è¡Œåˆ—) =\n{D}\n")
print(f"P^(-1) A P =\n{result}\n")
print(f"D ã«ä¸€è‡´? {np.allclose(result, D)}")

# å¯¾è§’åŒ–ã®å¿œç”¨: A^n ã®é«˜é€Ÿè¨ˆç®—
# A^n = P D^n P^(-1)
n = 10
A_n_fast = P @ np.linalg.matrix_power(D, n) @ P_inv
A_n_direct = np.linalg.matrix_power(A, n)

print(f"\nA^{n} ã®è¨ˆç®—:")
print(f"å¯¾è§’åŒ–åˆ©ç”¨: {A_n_fast[0,0]:.4f}")
print(f"ç›´æ¥è¨ˆç®—:   {A_n_direct[0,0]:.4f}")
print(f"ä¸€è‡´? {np.allclose(A_n_fast, A_n_direct)}")</div>

            <h2>3.4 å¯¾ç§°è¡Œåˆ—ã®æ€§è³ª</h2>

            <div class="theorem">
                <strong>ğŸ“ å®šç†: å¯¾ç§°è¡Œåˆ—ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«å®šç†</strong><br>
                å®Ÿå¯¾ç§°è¡Œåˆ—ï¼ˆA = A^Tï¼‰ã¯ï¼š<br>
                <ul style="margin-top: 0.5rem;">
                    <li>ã™ã¹ã¦ã®å›ºæœ‰å€¤ãŒå®Ÿæ•°</li>
                    <li>ç•°ãªã‚‹å›ºæœ‰å€¤ã«å¯¾å¿œã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã¯ç›´äº¤</li>
                    <li>å¿…ãšå¯¾è§’åŒ–å¯èƒ½ã§ã€ç›´äº¤è¡Œåˆ—ã«ã‚ˆã‚‹å¯¾è§’åŒ–ãŒå¯èƒ½</li>
                </ul>
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹5: å¯¾ç§°è¡Œåˆ—ã®å›ºæœ‰å€¤åˆ†è§£</h3>
            <div class="code-title">Pythonå®Ÿè£…: å¯¾ç§°è¡Œåˆ—ã®å›ºæœ‰å€¤åˆ†è§£</div>
            <div class="code-example"># å¯¾ç§°è¡Œåˆ—
A_sym = np.array([[3, 1],
                  [1, 3]])

# å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«
eigenvals_sym, eigenvecs_sym = np.linalg.eigh(A_sym)  # å¯¾ç§°è¡Œåˆ—å°‚ç”¨

print("å¯¾ç§°è¡Œåˆ—ã®å›ºæœ‰å€¤åˆ†è§£:")
print(f"A (å¯¾ç§°) =\n{A_sym}\n")
print(f"å›ºæœ‰å€¤: {eigenvals_sym}")
print(f"å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«:\n{eigenvecs_sym}\n")

# å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®ç›´äº¤æ€§ã‚’ç¢ºèª
v1 = eigenvecs_sym[:, 0]
v2 = eigenvecs_sym[:, 1]
inner_product = np.dot(v1, v2)
print(f"å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã®å†…ç©: {inner_product:.10f}")
print(f"ç›´äº¤? {np.abs(inner_product) < 1e-10}")

# ç›´äº¤è¡Œåˆ—æ€§ã®ç¢ºèª: Q^T Q = I
Q = eigenvecs_sym
QTQ = Q.T @ Q
print(f"\nQ^T Q =\n{QTQ}")
print(f"å˜ä½è¡Œåˆ—? {np.allclose(QTQ, np.eye(2))}")</div>

            <h2>3.5 PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰</h2>

            <div class="example">
                <strong>ğŸ”¬ å¿œç”¨ä¾‹: ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰</strong><br>
                ãƒ‡ãƒ¼ã‚¿ã®å…±åˆ†æ•£è¡Œåˆ—ã‚’å›ºæœ‰å€¤åˆ†è§£ã—ã€æœ€å¤§å›ºæœ‰å€¤ã«å¯¾å¿œã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«æ–¹å‘ãŒ
                ãƒ‡ãƒ¼ã‚¿ã®æœ€å¤§åˆ†æ•£æ–¹å‘ï¼ˆç¬¬1ä¸»æˆåˆ†ï¼‰ã¨ãªã‚Šã¾ã™ã€‚
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹6: PCAã®å®Ÿè£…</h3>
            <div class="code-title">Pythonå®Ÿè£…: ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰</div>
            <div class="code-example">from sklearn.datasets import make_blobs

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
np.random.seed(42)
X, _ = make_blobs(n_samples=100, n_features=2, centers=1, cluster_std=2.0)

# ãƒ‡ãƒ¼ã‚¿ã‚’ä¸­å¿ƒåŒ–
X_centered = X - np.mean(X, axis=0)

# å…±åˆ†æ•£è¡Œåˆ—
cov_matrix = np.cov(X_centered.T)

# å›ºæœ‰å€¤åˆ†è§£
eigenvals_pca, eigenvecs_pca = np.linalg.eigh(cov_matrix)

# å›ºæœ‰å€¤ã®å¤§ãã„é †ã«ã‚½ãƒ¼ãƒˆ
idx = eigenvals_pca.argsort()[::-1]
eigenvals_pca = eigenvals_pca[idx]
eigenvecs_pca = eigenvecs_pca[:, idx]

print("PCAï¼ˆä¸»æˆåˆ†åˆ†æï¼‰:")
print(f"å…±åˆ†æ•£è¡Œåˆ—:\n{cov_matrix}\n")
print(f"å›ºæœ‰å€¤: {eigenvals_pca}")
print(f"å¯„ä¸ç‡: {eigenvals_pca / eigenvals_pca.sum()}")

# å¯è¦–åŒ–
plt.figure(figsize=(10, 8))
plt.scatter(X_centered[:, 0], X_centered[:, 1], alpha=0.5)

# ä¸»æˆåˆ†æ–¹å‘ã‚’æç”»
origin = [0, 0]
scale = np.sqrt(eigenvals_pca)
for i in range(2):
    vec = eigenvecs_pca[:, i] * scale[i] * 3
    plt.quiver(*origin, *vec, angles='xy', scale_units='xy', scale=1,
              color=['red', 'blue'][i], width=0.01,
              label=f'PC{i+1} (Î»={eigenvals_pca[i]:.2f})')

plt.xlabel('Feature 1')
plt.ylabel('Feature 2')
plt.title('ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰')
plt.legend()
plt.grid(True, alpha=0.3)
plt.axis('equal')
plt.show()</div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹7: æ¬¡å…ƒå‰Šæ¸›ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿åœ§ç¸®</h3>
            <div class="code-title">Pythonå®Ÿè£…: æ¬¡å…ƒå‰Šæ¸›ã¨å†æ§‹æˆ</div>
            <div class="code-example"># ç¬¬1ä¸»æˆåˆ†ã®ã¿ã«å°„å½±ï¼ˆ2D â†’ 1Dï¼‰
PC1 = eigenvecs_pca[:, 0].reshape(-1, 1)

# å°„å½±
X_pca = X_centered @ PC1

# å…ƒã®ç©ºé–“ã«æˆ»ã™ï¼ˆè¿‘ä¼¼å†æ§‹æˆï¼‰
X_reconstructed = X_pca @ PC1.T

# å†æ§‹æˆèª¤å·®
reconstruction_error = np.mean(np.linalg.norm(X_centered - X_reconstructed, axis=1)**2)

print(f"\næ¬¡å…ƒå‰Šæ¸›:")
print(f"å…ƒã®æ¬¡å…ƒ: {X_centered.shape[1]}D")
print(f"å‰Šæ¸›å¾Œ: 1D")
print(f"å†æ§‹æˆèª¤å·®: {reconstruction_error:.4f}")
print(f"ç¬¬1ä¸»æˆåˆ†ã®å¯„ä¸ç‡: {eigenvals_pca[0]/eigenvals_pca.sum()*100:.1f}%")

# å¯è¦–åŒ–
plt.figure(figsize=(10, 8))
plt.scatter(X_centered[:, 0], X_centered[:, 1], alpha=0.3, label='å…ƒãƒ‡ãƒ¼ã‚¿')
plt.scatter(X_reconstructed[:, 0], X_reconstructed[:, 1], alpha=0.5, label='å†æ§‹æˆãƒ‡ãƒ¼ã‚¿', s=10)
plt.plot([0, PC1[0,0]*scale[0]*3], [0, PC1[1,0]*scale[0]*3], 'r-', linewidth=3, label='PC1')
plt.xlabel('Feature 1')
plt.ylabel('Feature 2')
plt.title('ç¬¬1ä¸»æˆåˆ†ã¸ã®å°„å½±ã¨å†æ§‹æˆ')
plt.legend()
plt.grid(True, alpha=0.3)
plt.axis('equal')
plt.show()</div>

            <h2>3.6 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨: æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰è§£æ</h2>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹8: é€£æˆæŒ¯å‹•ç³»ã®å›ºæœ‰æŒ¯å‹•æ•°</h3>
            <div class="code-title">Pythonå®Ÿè£…: æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰è§£æ</div>
            <div class="code-example"># 2è‡ªç”±åº¦é€£æˆæŒ¯å‹•ç³»
# m1 = m2 = 1 kg, k1 = k2 = k3 = 1 N/m
# é‹å‹•æ–¹ç¨‹å¼: M x'' + K x = 0
# å›ºæœ‰å€¤å•é¡Œ: det(K - Ï‰Â² M) = 0

M = np.array([[1, 0],
              [0, 1]])  # è³ªé‡è¡Œåˆ—

K = np.array([[2, -1],
              [-1, 2]])  # å‰›æ€§è¡Œåˆ—

# ä¸€èˆ¬åŒ–å›ºæœ‰å€¤å•é¡Œã‚’è§£ã
eigenvals_vibration, eigenvecs_vibration = np.linalg.eigh(K, M)

# å›ºæœ‰è§’æŒ¯å‹•æ•° Ï‰ = sqrt(Î»)
omega = np.sqrt(eigenvals_vibration)

print("æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰è§£æ:")
print(f"è³ªé‡è¡Œåˆ— M:\n{M}\n")
print(f"å‰›æ€§è¡Œåˆ— K:\n{K}\n")
print(f"å›ºæœ‰å€¤ Î»: {eigenvals_vibration}")
print(f"å›ºæœ‰è§’æŒ¯å‹•æ•° Ï‰: {omega} rad/s")
print(f"å›ºæœ‰æŒ¯å‹•æ•° f: {omega/(2*np.pi)} Hz\n")

print("æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ï¼ˆå›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ï¼‰:")
for i in range(2):
    print(f"ãƒ¢ãƒ¼ãƒ‰{i+1} (f={omega[i]/(2*np.pi):.3f} Hz):")
    print(f"  è³ªç‚¹1: {eigenvecs_vibration[0,i]:.4f}")
    print(f"  è³ªç‚¹2: {eigenvecs_vibration[1,i]:.4f}")

    if eigenvecs_vibration[0,i] * eigenvecs_vibration[1,i] > 0:
        print(f"  â†’ åŒä½ç›¸æŒ¯å‹•\n")
    else:
        print(f"  â†’ é€†ä½ç›¸æŒ¯å‹•\n")</div>

            <h2>ã¾ã¨ã‚</h2>
            <ul>
                <li>å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã¯ç·šå½¢å¤‰æ›ã§æ–¹å‘ãŒå¤‰ã‚ã‚‰ãªã„ãƒ™ã‚¯ãƒˆãƒ«ã€å›ºæœ‰å€¤ã¯ãã®ä¼¸ç¸®ç‡</li>
                <li>å¯¾è§’åŒ–ã«ã‚ˆã‚Šè¡Œåˆ—ã®ã¹ãä¹—è¨ˆç®—ãŒåŠ¹ç‡åŒ–ã•ã‚Œã€å‹•çš„ã‚·ã‚¹ãƒ†ãƒ è§£æã«æœ‰ç”¨</li>
                <li>å¯¾ç§°è¡Œåˆ—ã¯å®Ÿå›ºæœ‰å€¤ã‚’æŒã¡ã€ç›´äº¤ã™ã‚‹å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ«ã§å¯¾è§’åŒ–å¯èƒ½</li>
                <li>PCAã¯å…±åˆ†æ•£è¡Œåˆ—ã®å›ºæœ‰å€¤åˆ†è§£ã«ã‚ˆã‚Šãƒ‡ãƒ¼ã‚¿ã®ä¸»è¦ãªå¤‰å‹•æ–¹å‘ã‚’æŠ½å‡º</li>
                <li>ææ–™ç§‘å­¦ã§ã¯æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰è§£æã€çµæ™¶å¯¾ç§°æ€§ãªã©æ§˜ã€…ãªå¿œç”¨ãŒã‚ã‚‹</li>
            </ul>

            <div class="nav-buttons">
                <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« : è¡Œåˆ—å¼</a>
                <span class="coming-soon">ç¬¬4ç« : ç‰¹ç•°å€¤åˆ†è§£ â†’ï¼ˆæº–å‚™ä¸­ï¼‰</span>
            </div>
        </div>
    </div>

    <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

<footer>
        <p>&copy; 2025 AI Terakoya - åŸºç¤æ•°ç†é“å ´</p>
    </footer>
</body>
</html>
