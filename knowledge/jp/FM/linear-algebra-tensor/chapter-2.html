<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : è¡Œåˆ—å¼ã¨é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ | ç·šå½¢ä»£æ•°ã¨ãƒ†ãƒ³ã‚½ãƒ«è§£æ</title>
    <meta name="description" content="è¡Œåˆ—å¼ã®è¨ˆç®—ã€ã‚¯ãƒ©ãƒ¡ãƒ«ã®å…¬å¼ã€ã‚¬ã‚¦ã‚¹ã®æ¶ˆå»æ³•ã€LUåˆ†è§£ã€éšæ•°ã¨è§£ã®å­˜åœ¨æ¡ä»¶ã‚’å­¦ã³ã¾ã™ã€‚">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-block { background: #282c34; color: #abb2bf; padding: 1.5rem; border-radius: 8px; overflow-x: auto; margin: 1rem 0; font-size: 0.85rem; }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
    </style>
</head>
<body>
    <header>
        <h1>ç¬¬2ç« : è¡Œåˆ—å¼ã¨é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼</h1>
        <p class="subtitle">Determinants and Systems of Linear Equations</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">FM Dojo</a> &gt;
            <a href="index.html">ç·šå½¢ä»£æ•°ã¨ãƒ†ãƒ³ã‚½ãƒ«è§£æ</a> &gt;
            ç¬¬2ç« 
        </div>

        <div class="content">
            <h2>2.1 è¡Œåˆ—å¼ã®å®šç¾©ã¨è¨ˆç®—</h2>

            <div class="definition">
                <strong>ğŸ“ å®šç¾©: è¡Œåˆ—å¼</strong><br>
                nÃ—næ­£æ–¹è¡Œåˆ—Aã®è¡Œåˆ—å¼ det(A) ã¾ãŸã¯ |A| ã¯ã€ä»¥ä¸‹ã®æ€§è³ªã‚’æº€ãŸã™ã‚¹ã‚«ãƒ©ãƒ¼å€¤ï¼š<br>
                2Ã—2è¡Œåˆ—: $\det\begin{pmatrix}a&b\\c&d\end{pmatrix} = ad - bc$<br>
                3Ã—3è¡Œåˆ—: ã‚µãƒ©ã‚¹ã®å…¬å¼ã¾ãŸã¯ä½™å› å­å±•é–‹ã§è¨ˆç®—
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹1: è¡Œåˆ—å¼ã®è¨ˆç®—</h3>
            <div class="code-block">import numpy as np

# 2Ã—2è¡Œåˆ—ã®è¡Œåˆ—å¼
A_2x2 = np.array([[3, 8],
                  [4, 6]])

det_A = np.linalg.det(A_2x2)
det_manual = 3*6 - 8*4  # ad - bc

print("2Ã—2è¡Œåˆ—ã®è¡Œåˆ—å¼:")
print(f"A =\n{A_2x2}")
print(f"det(A) = {det_A:.4f}")
print(f"æ‰‹è¨ˆç®—: 3Ã—6 - 8Ã—4 = {det_manual}")

# 3Ã—3è¡Œåˆ—ã®è¡Œåˆ—å¼
A_3x3 = np.array([[1, 2, 3],
                  [4, 5, 6],
                  [7, 8, 9]])

det_A_3x3 = np.linalg.det(A_3x3)
print(f"\n3Ã—3è¡Œåˆ—ã®è¡Œåˆ—å¼:")
print(f"A =\n{A_3x3}")
print(f"det(A) = {det_A_3x3:.10f}")
print("det(A) â‰ˆ 0 ãªã®ã§ç‰¹ç•°è¡Œåˆ—ï¼ˆé€†è¡Œåˆ—ãªã—ï¼‰")</div>

            <div class="theorem">
                <strong>ğŸ“ å®šç†: è¡Œåˆ—å¼ã®æ€§è³ª</strong><br>
                <ul style="margin-top: 0.5rem;">
                    <li>det(AB) = det(A) det(B) ï¼ˆç©ã®è¡Œåˆ—å¼ï¼‰</li>
                    <li>det(A^T) = det(A) ï¼ˆè»¢ç½®ã—ã¦ã‚‚ä¸å¤‰ï¼‰</li>
                    <li>det(kA) = k^n det(A) ï¼ˆnÃ—nè¡Œåˆ—ã®ã‚¹ã‚«ãƒ©ãƒ¼å€ï¼‰</li>
                    <li>det(A) â‰  0 â‡” A ã¯æ­£å‰‡ï¼ˆé€†è¡Œåˆ—ãŒå­˜åœ¨ï¼‰</li>
                    <li>è¡Œã‚’å…¥ã‚Œæ›¿ãˆã‚‹ã¨ç¬¦å·ãŒåè»¢</li>
                </ul>
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹2: è¡Œåˆ—å¼ã®æ€§è³ªã®æ¤œè¨¼</h3>
            <div class="code-block">A = np.array([[2, 1],
              [3, 4]])
B = np.array([[5, 6],
              [7, 8]])

det_A = np.linalg.det(A)
det_B = np.linalg.det(B)
det_AB = np.linalg.det(A @ B)

print("è¡Œåˆ—å¼ã®æ€§è³ªã®æ¤œè¨¼:")
print(f"det(A) = {det_A:.4f}")
print(f"det(B) = {det_B:.4f}")
print(f"det(AB) = {det_AB:.4f}")
print(f"det(A) Ã— det(B) = {det_A * det_B:.4f}")
print(f"det(AB) = det(A)Ã—det(B)? {np.isclose(det_AB, det_A * det_B)}")

# è»¢ç½®
det_AT = np.linalg.det(A.T)
print(f"\ndet(A^T) = {det_AT:.4f}")
print(f"det(A) = det(A^T)? {np.isclose(det_A, det_AT)}")</div>

            <h2>2.2 é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã®è§£æ³•</h2>

            <div class="definition">
                <strong>ğŸ“ å®šç¾©: é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼</strong><br>
                Ax = b ã®å½¢ã§è¡¨ã•ã‚Œã‚‹æ–¹ç¨‹å¼ç³»ã€‚A: ä¿‚æ•°è¡Œåˆ—ã€x: æœªçŸ¥æ•°ãƒ™ã‚¯ãƒˆãƒ«ã€b: å®šæ•°é …ãƒ™ã‚¯ãƒˆãƒ«
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹3: NumPyã«ã‚ˆã‚‹é€£ç«‹æ–¹ç¨‹å¼ã®è§£æ³•</h3>
            <div class="code-block"># é€£ç«‹æ–¹ç¨‹å¼: 2x + 3y = 8, x - y = -1
A = np.array([[2, 3],
              [1, -1]])
b = np.array([8, -1])

# np.linalg.solve ã§è§£ã
x = np.linalg.solve(A, b)

print("é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã®è§£:")
print(f"2x + 3y = 8")
print(f"x - y = -1")
print(f"\nè§£: x = {x[0]:.4f}, y = {x[1]:.4f}")

# æ¤œç®—
b_check = A @ x
print(f"\næ¤œç®—: Ax = {b_check}")
print(f"èª¤å·®: {np.linalg.norm(b - b_check):.2e}")</div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹4: ã‚¯ãƒ©ãƒ¡ãƒ«ã®å…¬å¼</h3>
            <div class="code-block">def cramers_rule(A, b):
    """
    ã‚¯ãƒ©ãƒ¡ãƒ«ã®å…¬å¼ã«ã‚ˆã‚‹é€£ç«‹æ–¹ç¨‹å¼ã®è§£æ³•
    x_i = det(A_i) / det(A)
    A_i: iåˆ—ç›®ã‚’bã§ç½®ãæ›ãˆãŸè¡Œåˆ—
    """
    det_A = np.linalg.det(A)

    if np.abs(det_A) < 1e-10:
        raise ValueError("è¡Œåˆ—å¼ãŒã‚¼ãƒ­ã®ãŸã‚è§£ã‘ã¾ã›ã‚“")

    n = len(b)
    x = np.zeros(n)

    for i in range(n):
        A_i = A.copy()
        A_i[:, i] = b  # iåˆ—ç›®ã‚’bã§ç½®ãæ›ãˆ
        x[i] = np.linalg.det(A_i) / det_A

    return x

# åŒã˜é€£ç«‹æ–¹ç¨‹å¼ã‚’è§£ã
x_cramer = cramers_rule(A, b)

print("ã‚¯ãƒ©ãƒ¡ãƒ«ã®å…¬å¼:")
print(f"è§£: x = {x_cramer[0]:.4f}, y = {x_cramer[1]:.4f}")
print(f"np.linalg.solveã¨ã®å·®: {np.linalg.norm(x - x_cramer):.2e}")</div>

            <h2>2.3 ã‚¬ã‚¦ã‚¹ã®æ¶ˆå»æ³•</h2>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹5: ã‚¬ã‚¦ã‚¹ã®æ¶ˆå»æ³•ã®å®Ÿè£…</h3>
            <div class="code-block">def gaussian_elimination(A, b):
    """
    ã‚¬ã‚¦ã‚¹ã®æ¶ˆå»æ³•ã«ã‚ˆã‚‹é€£ç«‹æ–¹ç¨‹å¼ã®è§£æ³•
    å‰é€²æ¶ˆå» â†’ å¾Œé€€ä»£å…¥
    """
    n = len(b)
    # æ‹¡å¤§ä¿‚æ•°è¡Œåˆ—ã‚’ä½œæˆ
    Ab = np.hstack([A.astype(float), b.reshape(-1, 1)])

    # å‰é€²æ¶ˆå»
    for i in range(n):
        # ãƒ”ãƒœãƒƒãƒˆé¸æŠï¼ˆéƒ¨åˆ†ãƒ”ãƒœãƒƒãƒˆé¸æŠï¼‰
        max_row = np.argmax(np.abs(Ab[i:, i])) + i
        Ab[[i, max_row]] = Ab[[max_row, i]]

        # iè¡Œç›®ã‚’æ­£è¦åŒ–
        Ab[i] = Ab[i] / Ab[i, i]

        # iåˆ—ç›®ã®ä¸‹å´ã‚’ã‚¼ãƒ­ã«ã™ã‚‹
        for j in range(i+1, n):
            Ab[j] = Ab[j] - Ab[j, i] * Ab[i]

    # å¾Œé€€ä»£å…¥
    x = np.zeros(n)
    for i in range(n-1, -1, -1):
        x[i] = Ab[i, -1] - np.dot(Ab[i, i+1:n], x[i+1:])

    return x

# ãƒ†ã‚¹ãƒˆ
A_test = np.array([[2.0, 1.0, -1.0],
                   [-3.0, -1.0, 2.0],
                   [-2.0, 1.0, 2.0]])
b_test = np.array([8.0, -11.0, -3.0])

x_gauss = gaussian_elimination(A_test.copy(), b_test.copy())
x_numpy = np.linalg.solve(A_test, b_test)

print("ã‚¬ã‚¦ã‚¹ã®æ¶ˆå»æ³•:")
print(f"ã‚¬ã‚¦ã‚¹æ³•ã®è§£: {x_gauss}")
print(f"NumPyã®è§£:    {x_numpy}")
print(f"å·®: {np.linalg.norm(x_gauss - x_numpy):.2e}")</div>

            <h2>2.4 LUåˆ†è§£</h2>

            <div class="definition">
                <strong>ğŸ“ å®šç¾©: LUåˆ†è§£</strong><br>
                è¡Œåˆ—Aã‚’ä¸‹ä¸‰è§’è¡Œåˆ—Lã¨ä¸Šä¸‰è§’è¡Œåˆ—Uã®ç©ã«åˆ†è§£ï¼šA = LU<br>
                é€£ç«‹æ–¹ç¨‹å¼Ax = bã¯ã€Ly = b â†’ Ux = y ã®2æ®µéšã§è§£ã‘ã‚‹
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹6: LUåˆ†è§£ã«ã‚ˆã‚‹é€£ç«‹æ–¹ç¨‹å¼ã®è§£æ³•</h3>
            <div class="code-block">from scipy.linalg import lu

# LUåˆ†è§£
A_lu = np.array([[4, 3],
                 [6, 3]])

P, L, U = lu(A_lu)

print("LUåˆ†è§£:")
print(f"A =\n{A_lu}\n")
print(f"P (ç½®æ›è¡Œåˆ—) =\n{P}\n")
print(f"L (ä¸‹ä¸‰è§’) =\n{L}\n")
print(f"U (ä¸Šä¸‰è§’) =\n{U}\n")

# æ¤œè¨¼: PA = LU
print(f"PA =\n{P @ A_lu}\n")
print(f"LU =\n{L @ U}\n")
print(f"PA = LU? {np.allclose(P @ A_lu, L @ U)}")

# LUåˆ†è§£ã‚’ä½¿ã£ãŸé€£ç«‹æ–¹ç¨‹å¼ã®è§£æ³•
b_lu = np.array([10, 12])

# Step 1: Ly = Pb ã‚’è§£ã (å‰é€²ä»£å…¥)
y = np.linalg.solve(L, P @ b_lu)

# Step 2: Ux = y ã‚’è§£ã (å¾Œé€€ä»£å…¥)
x_lu = np.linalg.solve(U, y)

print(f"\né€£ç«‹æ–¹ç¨‹å¼ Ax = b ã®è§£:")
print(f"x = {x_lu}")

# æ¤œè¨¼
print(f"Ax = {A_lu @ x_lu}")
print(f"b  = {b_lu}")</div>

            <h2>2.5 éšæ•°ï¼ˆãƒ©ãƒ³ã‚¯ï¼‰ã¨è§£ã®å­˜åœ¨æ¡ä»¶</h2>

            <div class="theorem">
                <strong>ğŸ“ å®šç†: é€£ç«‹æ–¹ç¨‹å¼ã®è§£ã®å­˜åœ¨æ¡ä»¶</strong><br>
                Ax = b ã«ã¤ã„ã¦ï¼š<br>
                <ul style="margin-top: 0.5rem;">
                    <li>rank(A) = rank([A|b]) = n â†’ ä¸€æ„è§£</li>
                    <li>rank(A) = rank([A|b]) < n â†’ ç„¡æ•°ã®è§£</li>
                    <li>rank(A) < rank([A|b]) â†’ è§£ãªã—</li>
                </ul>
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹7: éšæ•°ã®è¨ˆç®—ã¨è§£ã®åˆ†é¡</h3>
            <div class="code-block"># éšæ•°ã®è¨ˆç®—
A_rank = np.array([[1, 2, 3],
                   [4, 5, 6],
                   [7, 8, 9]])

rank_A = np.linalg.matrix_rank(A_rank)

print("éšæ•°ã®è¨ˆç®—:")
print(f"A =\n{A_rank}")
print(f"rank(A) = {rank_A}")
print(f"Aã¯3æ¬¡æ­£æ–¹è¡Œåˆ—ã ãŒ rank < 3 ãªã®ã§ç‰¹ç•°è¡Œåˆ—\n")

# ä¸€æ„è§£ã‚’æŒã¤ä¾‹
A_unique = np.array([[1, 2],
                     [3, 4]])
b_unique = np.array([5, 6])

Ab_unique = np.column_stack([A_unique, b_unique])
rank_A_u = np.linalg.matrix_rank(A_unique)
rank_Ab_u = np.linalg.matrix_rank(Ab_unique)

print("ä¸€æ„è§£ã®ä¾‹:")
print(f"rank(A) = {rank_A_u}")
print(f"rank([A|b]) = {rank_Ab_u}")
print(f"rank(A) = rank([A|b]) = 2 â†’ ä¸€æ„è§£")
x_unique = np.linalg.solve(A_unique, b_unique)
print(f"è§£: {x_unique}\n")

# è§£ãªã—ã®ä¾‹
A_no_sol = np.array([[1, 2],
                     [2, 4]])
b_no_sol = np.array([3, 7])  # ç¬¬2å¼ã¯ç¬¬1å¼ã®2å€ã ãŒå³è¾ºãŒä¸æ•´åˆ

Ab_no_sol = np.column_stack([A_no_sol, b_no_sol])
rank_A_n = np.linalg.matrix_rank(A_no_sol)
rank_Ab_n = np.linalg.matrix_rank(Ab_no_sol)

print("è§£ãªã—ã®ä¾‹:")
print(f"rank(A) = {rank_A_n}")
print(f"rank([A|b]) = {rank_Ab_n}")
print(f"rank(A) < rank([A|b]) â†’ è§£ãªã—")</div>

            <h2>2.6 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨: åŒ–å­¦é‡è«–è¨ˆç®—</h2>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹8: åŒ–å­¦åå¿œå¼ã®ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°</h3>
            <div class="code-block"># åŒ–å­¦åå¿œå¼: aFe + bO2 â†’ cFe2O3
# å…ƒç´ ãƒãƒ©ãƒ³ã‚¹:
#   Fe: a = 2c
#   O:  2b = 3c
# ã“ã‚Œã‚’è¡Œåˆ—å½¢å¼ã§è¡¨ç¾

# ä¿‚æ•°è¡Œåˆ—ï¼ˆæœªçŸ¥æ•°ã‚’å·¦è¾ºã€æ—¢çŸ¥æ•°ã‚’å³è¾ºã«ï¼‰
# a - 2c = 0
# 2b - 3c = 0
# c = 1 (ä»»æ„ã«å›ºå®š)

# è§£ãã‚„ã™ã„å½¢ã«å¤‰å½¢
A_chem = np.array([[1, 0, -2],   # Fe balance
                   [0, 2, -3]])  # O balance

# c=1ã¨ã™ã‚‹ã¨
c = 1
b_chem = np.array([2*c, 3*c])

# æœ€å°äºŒä¹—è§£ã‚’æ±‚ã‚ã‚‹
x_chem = np.linalg.lstsq(A_chem[:, :2], b_chem, rcond=None)[0]

a, b = x_chem
print("åŒ–å­¦åå¿œå¼ã®ãƒãƒ©ãƒ³ã‚·ãƒ³ã‚°:")
print(f"Fe + O2 â†’ Fe2O3")
print(f"\nä¿‚æ•°:")
print(f"a (Fe) = {a:.1f}")
print(f"b (O2) = {b:.1f}")
print(f"c (Fe2O3) = {c:.1f}")
print(f"\nãƒãƒ©ãƒ³ã‚¹ã—ãŸåå¿œå¼:")
print(f"{int(a*2)}Fe + {int(b*2)}O2 â†’ {int(c*2)}Fe2O3")

# æ¤œè¨¼
print(f"\nå…ƒç´ ãƒãƒ©ãƒ³ã‚¹ã®æ¤œè¨¼:")
print(f"Fe: å·¦è¾º = {int(a*2)}, å³è¾º = {int(c*2)*2}")
print(f"O:  å·¦è¾º = {int(b*2)*2}, å³è¾º = {int(c*2)*3}")</div>

            <h2>ã¾ã¨ã‚</h2>
            <ul>
                <li>è¡Œåˆ—å¼ã¯æ­£æ–¹è¡Œåˆ—ã®é‡è¦ãªä¸å¤‰é‡ã§ã€é€†è¡Œåˆ—ã®å­˜åœ¨åˆ¤å®šã«ä½¿ã‚ã‚Œã‚‹</li>
                <li>é€£ç«‹ä¸€æ¬¡æ–¹ç¨‹å¼ã¯NumPyã®solveé–¢æ•°ã§åŠ¹ç‡çš„ã«è§£ã‘ã‚‹</li>
                <li>ã‚¬ã‚¦ã‚¹ã®æ¶ˆå»æ³•ã¯ç³»çµ±çš„ãªæ‰‹è¨ˆç®—æ³•ã¨ã—ã¦é‡è¦</li>
                <li>LUåˆ†è§£ã«ã‚ˆã‚Šã€åŒã˜Aã«å¯¾ã™ã‚‹è¤‡æ•°ã®bã®å•é¡Œã‚’åŠ¹ç‡çš„ã«è§£ã‘ã‚‹</li>
                <li>éšæ•°ï¼ˆãƒ©ãƒ³ã‚¯ï¼‰ã¯è§£ã®å­˜åœ¨æ€§ã¨ä¸€æ„æ€§ã‚’åˆ¤å®šã™ã‚‹éµã¨ãªã‚‹</li>
                <li>ææ–™ç§‘å­¦ã§ã¯åŒ–å­¦é‡è«–è¨ˆç®—ãªã©æ§˜ã€…ãªå ´é¢ã§ç·šå½¢æ–¹ç¨‹å¼ãŒç¾ã‚Œã‚‹</li>
            </ul>

            <div class="nav-buttons">
                <a href="chapter-1.html" class="nav-button">â† ç¬¬1ç« : ãƒ™ã‚¯ãƒˆãƒ«ã¨è¡Œåˆ—</a>
                <a href="chapter-3.html" class="nav-button">ç¬¬3ç« : å›ºæœ‰å€¤ãƒ»å›ºæœ‰ãƒ™ã‚¯ãƒˆãƒ« â†’</a>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - FM Dojo</p>
    </footer>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
