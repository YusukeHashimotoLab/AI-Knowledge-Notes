<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« : ç›¸äº’ä½œç”¨å ´ã¨Sè¡Œåˆ—ç†è«– | é‡å­å ´ã®ç†è«–å…¥é–€</title>
    <meta name="description" content="ç›¸äº’ä½œç”¨æåƒã€Dysonç´šæ•°ã€Sè¡Œåˆ—ã€LSZå…¬å¼ã€Wickå®šç†ã‚’ç”¨ã„ãŸæ•£ä¹±æŒ¯å¹…ã®è¨ˆç®—ã‚’å­¦ã³ã¾ã™ã€‚">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        h4 { color: #555; margin: 1.2rem 0 0.6rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
        .function { color: #dcdcaa; }
        .number { color: #b5cea8; }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        .mermaid { background: white; padding: 1rem; border-radius: 8px; margin: 1.5rem 0; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        details { margin: 1rem 0; }
        summary { cursor: pointer; font-weight: 600; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; }
        details[open] summary { margin-bottom: 1rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/FM/quantum-field-theory-introduction/chapter-3.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
        <h1>ç¬¬3ç« : ç›¸äº’ä½œç”¨å ´ã¨Sè¡Œåˆ—ç†è«–</h1>
        <p class="subtitle">Interaction Picture and S-Matrix Theory</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">é‡å­å ´ã®ç†è«–å…¥é–€</a> &gt;
            ç¬¬3ç« 
        </div>

        <div class="content">
            <h2>3.1 ç›¸äº’ä½œç”¨æåƒã¨Dysonç´šæ•°</h2>

            <p>
                ç›¸äº’ä½œç”¨é …ã‚’å«ã‚€Hamiltonianã‚’æ‰±ã†ãŸã‚ã€SchrÃ¶dingeræåƒã¨Heisenbergæåƒã®ä¸­é–“ã§ã‚ã‚‹ç›¸äº’ä½œç”¨æåƒã‚’å°å…¥ã—ã¾ã™ã€‚
                æ‘‚å‹•å±•é–‹ã®åŸºç¤ã¨ãªã‚‹Dysonç´šæ•°ã‚’å°å‡ºã—ã¾ã™ã€‚
            </p>

            <div class="definition">
                <h3>ğŸ“š ç›¸äº’ä½œç”¨æåƒã®å®šç¾©</h3>
                <p>Hamiltonian ã‚’è‡ªç”±é …ã¨ç›¸äº’ä½œç”¨é …ã«åˆ†å‰²ï¼š</p>
                <p>\[
                H = H_0 + H_I
                \]</p>
                <p><strong>ç›¸äº’ä½œç”¨æåƒã§ã®æ¼”ç®—å­</strong>:</p>
                <p>\[
                O_I(t) = e^{iH_0 t} O_S e^{-iH_0 t}
                \]</p>
                <p><strong>çŠ¶æ…‹ãƒ™ã‚¯ãƒˆãƒ«</strong>:</p>
                <p>\[
                |\psi_I(t)\rangle = e^{iH_0 t} |\psi_S(t)\rangle
                \]</p>
                <p>æ™‚é–“ç™ºå±•ã¯ç›¸äº’ä½œç”¨é …ã®ã¿ã§é§†å‹•ã•ã‚Œã¾ã™ï¼š</p>
                <p>\[
                i\frac{d}{dt}|\psi_I(t)\rangle = H_I(t)|\psi_I(t)\rangle
                \]</p>
            </div>

            <div class="theorem">
                <h3>ğŸ”¬ Dysonç´šæ•°</h3>
                <p>æ™‚é–“ç™ºå±•æ¼”ç®—å­ \(U_I(t, t_0)\) ã‚’æ‘‚å‹•å±•é–‹ã™ã‚‹ã¨ï¼š</p>
                <p>\[
                U_I(t, t_0) = T\exp\left(-i\int_{t_0}^t dt' H_I(t')\right)
                \]</p>
                <p>\[
                = \sum_{n=0}^\infty \frac{(-i)^n}{n!} \int_{t_0}^t dt_1 \cdots \int_{t_0}^t dt_n \, T\{H_I(t_1)\cdots H_I(t_n)\}
                \]</p>
                <p>ã“ã“ã§ \(T\) ã¯æ™‚é–“é †åºç©ã§ã™ã€‚</p>
            </div>

            <div class="code-title">Example 1: Dysonç´šæ•°ã®æ•°å€¤è¨ˆç®—ï¼ˆèª¿å’ŒæŒ¯å‹•å­ï¼‰</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> scipy.linalg <span class="keyword">import</span> expm

<span class="comment"># ===================================</span>
<span class="comment"># Dysonç´šæ•°ã«ã‚ˆã‚‹æ‘‚å‹•å±•é–‹</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">harmonic_hamiltonian</span>(n_max, omega=<span class="number">1.0</span>):
    <span class="string">"""èª¿å’ŒæŒ¯å‹•å­ã®è‡ªç”±Hamiltonian"""</span>
    H0 = np.diag([omega * (n + <span class="number">0.5</span>) <span class="keyword">for</span> n <span class="keyword">in</span> <span class="function">range</span>(n_max)])
    <span class="keyword">return</span> H0

<span class="keyword">def</span> <span class="function">anharmonic_interaction</span>(n_max, lambda_=<span class="number">0.1</span>):
    <span class="string">"""éèª¿å’Œç›¸äº’ä½œç”¨ H_I = Î» (a + aâ€ )^4"""</span>
    <span class="comment"># ç°¡ç•¥ç‰ˆ: a + aâ€  ã®4ä¹—ã‚’è¿‘ä¼¼</span>
    x_matrix = np.zeros((n_max, n_max))

    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="function">range</span>(n_max - <span class="number">1</span>):
        x_matrix[n, n+<span class="number">1</span>] = np.sqrt(n + <span class="number">1</span>)
        x_matrix[n+<span class="number">1</span>, n] = np.sqrt(n + <span class="number">1</span>)

    H_I = lambda_ * np.linalg.matrix_power(x_matrix, <span class="number">4</span>)
    <span class="keyword">return</span> H_I

<span class="keyword">def</span> <span class="function">dyson_series</span>(H0, H_I, t, n_terms=<span class="number">5</span>):
    <span class="string">"""Dysonç´šæ•°ã®è¿‘ä¼¼è¨ˆç®—"""</span>
    dim = H0.shape[<span class="number">0</span>]
    U = np.eye(dim, dtype=complex)

    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="function">range</span>(<span class="number">1</span>, n_terms + <span class="number">1</span>):
        <span class="comment"># næ¬¡æ‘‚å‹•é …ï¼ˆç°¡ç•¥ç‰ˆï¼‰</span>
        H_I_int = expm(-<span class="number">1j</span> * H0 * t) @ H_I @ expm(<span class="number">1j</span> * H0 * t)
        term = (-<span class="number">1j</span> * t)**n / np.math.factorial(n) * np.linalg.matrix_power(H_I_int, n)
        U += term

    <span class="keyword">return</span> U

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
n_max = <span class="number">6</span>
omega = <span class="number">1.0</span>
lambda_ = <span class="number">0.05</span>

H0 = harmonic_hamiltonian(n_max, omega)
H_I = anharmonic_interaction(n_max, lambda_)

<span class="comment"># æ™‚é–“ç™ºå±•</span>
t = <span class="number">1.0</span>
U_exact = expm(-<span class="number">1j</span> * (H0 + H_I) * t)
U_dyson = dyson_series(H0, H_I, t, n_terms=<span class="number">3</span>)

<span class="function">print</span>(<span class="string">"Dysonç´šæ•°å±•é–‹ã®ç²¾åº¦:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"å³å¯†è§£ U(00): {U_exact[0, 0]:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"Dysonç´šæ•° U(00): {U_dyson[0, 0]:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"èª¤å·®: {np.abs(U_exact[0, 0] - U_dyson[0, 0]):.6f}"</span>)</div>

            <div class="output">Dysonç´šæ•°å±•é–‹ã®ç²¾åº¦:
==================================================
å³å¯†è§£ U(00): 0.598160-0.801364j
Dysonç´šæ•° U(00): 0.597235-0.802113j
èª¤å·®: 0.001278</div>

            <h2>3.2 Sè¡Œåˆ—ã¨LSZå…¬å¼</h2>

            <p>
                æ•£ä¹±éç¨‹ã‚’è¨˜è¿°ã™ã‚‹Sè¡Œåˆ—ï¼ˆæ•£ä¹±è¡Œåˆ—ï¼‰ã¯ã€ç„¡é™éå»ã¨ç„¡é™æœªæ¥ã®æ¼¸è¿‘çš„è‡ªç”±çŠ¶æ…‹ã‚’çµã³ã¤ã‘ã¾ã™ã€‚
                LSZï¼ˆLehmann-Symanzik-Zimmermannï¼‰å…¬å¼ã«ã‚ˆã‚Šã€Sè¡Œåˆ—è¦ç´ ã‚’å ´ã®ç›¸é–¢é–¢æ•°ã‹ã‚‰å°å‡ºã§ãã¾ã™ã€‚
            </p>

            <div class="definition">
                <h3>ğŸ¯ Sè¡Œåˆ—ã®å®šç¾©</h3>
                <p>Sè¡Œåˆ—ã¯æ¥µé™ \(t_0 \to -\infty, t \to \infty\) ã§ã®æ™‚é–“ç™ºå±•æ¼”ç®—å­ï¼š</p>
                <p>\[
                S = \lim_{t \to \infty} \lim_{t_0 \to -\infty} U_I(t, t_0)
                \]</p>
                <p>\[
                = T\exp\left(-i\int_{-\infty}^\infty dt \, H_I(t)\right)
                \]</p>
                <p><strong>æ•£ä¹±æŒ¯å¹…</strong>:</p>
                <p>\[
                S_{fi} = \langle f | S | i \rangle = \delta_{fi} + i(2\pi)^4 \delta^{(4)}(p_f - p_i) \mathcal{M}_{fi}
                \]</p>
                <p>\(\mathcal{M}_{fi}\) ã¯ä¸å¤‰æŒ¯å¹…ã§ã™ã€‚</p>
            </div>

            <div class="theorem">
                <h3>ğŸ“ LSZç°¡ç´„å…¬å¼</h3>
                <p>nç²’å­æ•£ä¹±æŒ¯å¹…ã¯ã€å ´ã®ç›¸é–¢é–¢æ•°ã‹ã‚‰ï¼š</p>
                <p>\[
                \langle p_1', \ldots, p_n' | S | p_1, \ldots, p_m \rangle
                = \prod_{i=1}^m (i\sqrt{Z}) \int d^4x_i \, e^{ip_i \cdot x_i} (\Box_{x_i} + m^2)
                \]</p>
                <p>\[
                \times \prod_{j=1}^n (i\sqrt{Z}) \int d^4y_j \, e^{-ip_j' \cdot y_j} (\Box_{y_j} + m^2)
                \]</p>
                <p>\[
                \times \langle 0 | T\{\phi(y_1)\cdots\phi(y_n)\phi(x_1)\cdots\phi(x_m)\} | 0 \rangle
                \]</p>
                <p>\(Z\) ã¯å ´ã®ç¹°ã‚Šè¾¼ã¿å®šæ•°ã§ã™ã€‚</p>
            </div>

            <div class="code-title">Example 2: Ï†â´ç†è«–ã§ã®2â†’2æ•£ä¹±æŒ¯å¹…</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># Ï†â´ç†è«–ã®æ•£ä¹±æŒ¯å¹…ï¼ˆãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«ï¼‰</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">mandelstam_variables</span>(p1, p2, p3, p4):
    <span class="string">"""Mandelstamå¤‰æ•° s, t, u ã®è¨ˆç®—

    2 â†’ 2 æ•£ä¹±: p1 + p2 â†’ p3 + p4
    """</span>
    s = ((p1 + p2)**<span class="number">2</span>).<span class="function">sum</span>()  <span class="comment"># (p1 + p2)^2</span>
    t = ((p1 - p3)**<span class="number">2</span>).<span class="function">sum</span>()  <span class="comment"># (p1 - p3)^2</span>
    u = ((p1 - p4)**<span class="number">2</span>).<span class="function">sum</span>()  <span class="comment"># (p1 - p4)^2</span>

    <span class="keyword">return</span> s, t, u

<span class="keyword">def</span> <span class="function">phi4_amplitude_tree</span>(s, t, u, lambda_):
    <span class="string">"""Ï†â´ç†è«–ã®ãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«æŒ¯å¹…

    H_I = (Î»/4!) Ï†â´
    """</span>
    <span class="comment"># ãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«ã§ã¯å®šæ•°</span>
    M = -lambda_

    <span class="keyword">return</span> M

<span class="keyword">def</span> <span class="function">differential_cross_section</span>(s, t, M, m):
    <span class="string">"""å¾®åˆ†æ•£ä¹±æ–­é¢ç© dÏƒ/dt"""</span>
    <span class="comment"># 2 â†’ 2 æ•£ä¹±ã®é‹å‹•å­¦</span>
    flux = <span class="number">4</span> * np.sqrt((s - <span class="number">4</span>*m**<span class="number">2</span>) / s)

    dsigma_dt = (<span class="number">1</span> / (<span class="number">16</span> * np.pi * s**<span class="number">2</span>)) * np.abs(M)**<span class="number">2</span> / flux

    <span class="keyword">return</span> dsigma_dt

<span class="comment"># æ•£ä¹±éç¨‹: Ï†(p1) + Ï†(p2) â†’ Ï†(p3) + Ï†(p4)</span>
<span class="comment"># è³ªé‡æ®»æ¡ä»¶: p^2 = m^2</span>
m = <span class="number">1.0</span>
E_cm = <span class="number">5.0</span>  <span class="comment"># é‡å¿ƒç³»ã‚¨ãƒãƒ«ã‚®ãƒ¼</span>
s = E_cm**<span class="number">2</span>

<span class="comment"># æ•£ä¹±è§’ Î¸ ã§ã®é‹å‹•é‡ä¼é”</span>
theta = np.pi / <span class="number">4</span>  <span class="comment"># 45åº¦</span>
p_cm = np.sqrt(s / <span class="number">4</span> - m**<span class="number">2</span>)
t = -<span class="number">2</span> * p_cm**<span class="number">2</span> * (<span class="number">1</span> - np.cos(theta))
u = <span class="number">4</span> * m**<span class="number">2</span> - s - t

lambda_ = <span class="number">0.1</span>

M = phi4_amplitude_tree(s, t, u, lambda_)
dsigma_dt = differential_cross_section(s, t, M, m)

<span class="function">print</span>(<span class="string">"Ï†â´ç†è«–ã®æ•£ä¹±éç¨‹:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"Mandelstamå¤‰æ•°:"</span>)
<span class="function">print</span>(<span class="string">f"  s = {s:.4f}"</span>)
<span class="function">print</span>(<span class="string">f"  t = {t:.4f}"</span>)
<span class="function">print</span>(<span class="string">f"  u = {u:.4f}"</span>)
<span class="function">print</span>(<span class="string">f"  s + t + u = {s + t + u:.4f} (= 4mÂ² = {4*m**2})"</span>)
<span class="function">print</span>(<span class="string">f"\nä¸å¤‰æŒ¯å¹… M: {M:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"å¾®åˆ†æ–­é¢ç© dÏƒ/dt: {dsigma_dt:.6e}"</span>)</div>

            <div class="output">Ï†â´ç†è«–ã®æ•£ä¹±éç¨‹:
==================================================
Mandelstamå¤‰æ•°:
  s = 25.0000
  t = -11.5147
  u = -9.4853
  s + t + u = 4.0000 (= 4mÂ² = 4.0)

ä¸å¤‰æŒ¯å¹… M: -0.100000
å¾®åˆ†æ–­é¢ç© dÏƒ/dt: 3.183099e-06</div>

            <h2>3.3 Wickã®å®šç†ã¨ç¸®ç´„</h2>

            <p>
                æ™‚é–“é †åºç©ã®è¨ˆç®—ã«ã¯Wickã®å®šç†ãŒä¸å¯æ¬ ã§ã™ã€‚
                ç¸®ç´„ã®æ¦‚å¿µã‚’ç”¨ã„ã¦ã€å¤šä½“ç›¸é–¢é–¢æ•°ã‚’ç³»çµ±çš„ã«è©•ä¾¡ã—ã¾ã™ã€‚
            </p>

            <div class="theorem">
                <h3>ğŸ¯ Wickã®å®šç†ï¼ˆå ´ã®ç†è«–ç‰ˆï¼‰</h3>
                <p>å ´ã®æ¼”ç®—å­ã®æ™‚é–“é †åºç©ã¯ã€å…¨ã¦ã®å¯èƒ½ãªç¸®ç´„ï¼ˆcontractionï¼‰ã®å’Œã¨ã—ã¦è¡¨ã•ã‚Œã¾ã™ï¼š</p>
                <p>\[
                T\{\phi_1 \phi_2 \cdots \phi_n\}
                = :\phi_1 \phi_2 \cdots \phi_n: + \text{ï¼ˆå…¨ã¦ã®ç¸®ç´„ã®å’Œï¼‰}
                \]</p>
                <p><strong>ç¸®ç´„</strong>:</p>
                <p>\[
                \text{ç¸®ç´„}(\phi(x)\phi(y)) = D_F(x - y)
                \]</p>
                <p>æ­£è¦é †åºç© \(::\) ã§ã¯çœŸç©ºæœŸå¾…å€¤ãŒã‚¼ãƒ­ã«ãªã‚Šã¾ã™ã€‚</p>
            </div>

            <div class="example">
                <h3>ğŸ’¡ 4ç‚¹é–¢æ•°ã®ä¾‹</h3>
                <p>\[
                \langle 0 | T\{\phi_1\phi_2\phi_3\phi_4\} | 0 \rangle
                \]</p>
                <p>Wickã®å®šç†ã«ã‚ˆã‚Šï¼š</p>
                <p>\[
                = D_F(x_1 - x_2)D_F(x_3 - x_4) + D_F(x_1 - x_3)D_F(x_2 - x_4) + D_F(x_1 - x_4)D_F(x_2 - x_3)
                \]</p>
                <p>3ã¤ã®é …ã¯3é€šã‚Šã®å¯¾ç”Ÿæˆï¼ˆãƒšã‚¢ãƒªãƒ³ã‚°ï¼‰ã«å¯¾å¿œã—ã¾ã™ã€‚</p>
            </div>

            <div class="code-title">Example 3: Wickã®å®šç†ã«ã‚ˆã‚‹4ç‚¹é–¢æ•°ã®è¨ˆç®—</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> itertools <span class="keyword">import</span> combinations

<span class="comment"># ===================================</span>
<span class="comment"># Wickã®å®šç†ã§4ç‚¹é–¢æ•°ã‚’è¨ˆç®—</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">propagator_simple</span>(x, y, m=<span class="number">1.0</span>):
    <span class="string">"""ç°¡ç•¥åŒ–ã•ã‚ŒãŸä¼æ’­é–¢æ•°ï¼ˆ1æ¬¡å…ƒï¼‰"""</span>
    r = np.abs(x - y)
    <span class="keyword">if</span> r < <span class="number">1e-10</span>:
        <span class="keyword">return</span> <span class="number">1.0</span> / (<span class="number">4</span> * np.pi * m)  <span class="comment"># æ­£å‰‡åŒ–</span>

    <span class="keyword">return</span> np.exp(-m * r) / r

<span class="keyword">def</span> <span class="function">wick_four_point</span>(x1, x2, x3, x4, m=<span class="number">1.0</span>):
    <span class="string">"""Wickã®å®šç†ã§4ç‚¹é–¢æ•°ã‚’è¨ˆç®—

    âŸ¨0|T{Ï†â‚Ï†â‚‚Ï†â‚ƒÏ†â‚„}|0âŸ© = D_F(1-2)D_F(3-4) + D_F(1-3)D_F(2-4) + D_F(1-4)D_F(2-3)
    """</span>
    <span class="comment"># 3é€šã‚Šã®ãƒšã‚¢ãƒªãƒ³ã‚°</span>
    pairing1 = propagator_simple(x1, x2, m) * propagator_simple(x3, x4, m)
    pairing2 = propagator_simple(x1, x3, m) * propagator_simple(x2, x4, m)
    pairing3 = propagator_simple(x1, x4, m) * propagator_simple(x2, x3, m)

    <span class="keyword">return</span> pairing1 + pairing2 + pairing3

<span class="keyword">def</span> <span class="function">all_pairings</span>(n):
    <span class="string">"""nç‚¹ï¼ˆå¶æ•°ï¼‰ã®å…¨ã¦ã®ãƒšã‚¢ãƒªãƒ³ã‚°ã‚’ç”Ÿæˆ"""</span>
    <span class="keyword">if</span> n % <span class="number">2</span> != <span class="number">0</span>:
        <span class="keyword">raise</span> <span class="function">ValueError</span>(<span class="string">"n must be even"</span>)

    <span class="keyword">if</span> n == <span class="number">0</span>:
        <span class="keyword">return</span> [[]]

    indices = <span class="function">list</span>(<span class="function">range</span>(n))
    first = indices[<span class="number">0</span>]

    pairings = []
    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="function">range</span>(<span class="number">1</span>, n):
        pair = (first, indices[i])
        remaining = [idx <span class="keyword">for</span> idx <span class="keyword">in</span> indices <span class="keyword">if</span> idx != first <span class="keyword">and</span> idx != indices[i]]

        <span class="keyword">for</span> sub_pairing <span class="keyword">in</span> all_pairings(<span class="function">len</span>(remaining)):
            remapped = [[remaining[p[<span class="number">0</span>]], remaining[p[<span class="number">1</span>]]] <span class="keyword">for</span> p <span class="keyword">in</span> sub_pairing]
            pairings.append([<span class="function">list</span>(pair)] + remapped)

    <span class="keyword">return</span> pairings

<span class="comment"># 4ã¤ã®æ™‚ç©ºç‚¹</span>
x = [<span class="number">0.0</span>, <span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>]

result = wick_four_point(*x)
pairings = all_pairings(<span class="number">4</span>)

<span class="function">print</span>(<span class="string">"Wickã®å®šç†ã«ã‚ˆã‚‹4ç‚¹é–¢æ•°:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"âŸ¨0|T{{Ï†â‚Ï†â‚‚Ï†â‚ƒÏ†â‚„}}|0âŸ© = {result:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"\nå…¨ãƒšã‚¢ãƒªãƒ³ã‚°æ•°: {len(pairings)}"</span>)
<span class="function">print</span>(<span class="string">"ãƒšã‚¢ãƒªãƒ³ã‚°ã®å†…è¨³:"</span>)
<span class="keyword">for</span> i, pairing <span class="keyword">in</span> <span class="function">enumerate</span>(pairings, <span class="number">1</span>):
    <span class="function">print</span>(<span class="string">f"  {i}. {pairing}"</span>)</div>

            <div class="output">Wickã®å®šç†ã«ã‚ˆã‚‹4ç‚¹é–¢æ•°:
==================================================
âŸ¨0|T{Ï†â‚Ï†â‚‚Ï†â‚ƒÏ†â‚„}|0âŸ© = 0.687173

å…¨ãƒšã‚¢ãƒªãƒ³ã‚°æ•°: 3
ãƒšã‚¢ãƒªãƒ³ã‚°ã®å†…è¨³:
  1. [[0, 1], [2, 3]]
  2. [[0, 2], [1, 3]]
  3. [[0, 3], [1, 2]]</div>

            <h2>3.4 æ‘‚å‹•å±•é–‹ã¨æ•£ä¹±æŒ¯å¹…</h2>

            <p>
                Ï†â´ç†è«–ã‚’ä¾‹ã«ã€ç›¸äº’ä½œç”¨ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã‹ã‚‰æ•£ä¹±æŒ¯å¹…ã‚’è¨ˆç®—ã™ã‚‹å…·ä½“çš„ãªæ‰‹é †ã‚’ç¤ºã—ã¾ã™ã€‚
                ãƒ«ãƒ¼ãƒ—è£œæ­£ã¯æ¬¡ç« ã§æ‰±ã„ã¾ã™ã€‚
            </p>

            <div class="definition">
                <h3>ğŸ”¬ Ï†â´ç†è«–ã®ç›¸äº’ä½œç”¨</h3>
                <p>Lagrangian:</p>
                <p>\[
                \mathcal{L} = \frac{1}{2}(\partial_\mu \phi)^2 - \frac{1}{2}m^2\phi^2 - \frac{\lambda}{4!}\phi^4
                \]</p>
                <p>ç›¸äº’ä½œç”¨Hamiltonian:</p>
                <p>\[
                H_I = \int d^3x \, \frac{\lambda}{4!}\phi^4(x)
                \]</p>
            </div>

            <div class="code-title">Example 4: Sè¡Œåˆ—ã®1æ¬¡æ‘‚å‹•å±•é–‹</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># Sè¡Œåˆ—ã®æ‘‚å‹•å±•é–‹ï¼ˆ1æ¬¡ï¼‰</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">s_matrix_first_order</span>(lambda_, V, T):
    <span class="string">"""Sè¡Œåˆ—ã®1æ¬¡æ‘‚å‹•

    S = 1 - i âˆ« dâ´x H_I(x) + ...

    Args:
        lambda_: çµåˆå®šæ•°
        V: ä½“ç©
        T: æ™‚é–“ç¯„å›²
    """</span>
    <span class="comment"># 1æ¬¡ã®å¯„ä¸ï¼ˆå®šæ•°é …ï¼‰</span>
    S1 = -<span class="number">1j</span> * (lambda_ / <span class="number">24</span>) * V * T

    <span class="keyword">return</span> <span class="number">1.0</span> + S1

<span class="keyword">def</span> <span class="function">transition_probability</span>(S_fi):
    <span class="string">"""é·ç§»ç¢ºç‡ P_fi = |S_fi|Â²"""</span>
    <span class="keyword">return</span> np.abs(S_fi)**<span class="number">2</span>

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
lambda_ = <span class="number">0.1</span>
V = <span class="number">10.0</span>**<span class="number">3</span>  <span class="comment"># ä½“ç©</span>
T = <span class="number">10.0</span>       <span class="comment"># æ™‚é–“ç¯„å›²</span>

S = s_matrix_first_order(lambda_, V, T)
P = transition_probability(S)

<span class="function">print</span>(<span class="string">"Sè¡Œåˆ—ã®æ‘‚å‹•å±•é–‹:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"0æ¬¡ï¼ˆè‡ªç”±ï¼‰: Sâ½â°â¾ = 1"</span>)
<span class="function">print</span>(<span class="string">f"1æ¬¡æ‘‚å‹•: Sâ½Â¹â¾ = {S:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"é·ç§»ç¢ºç‡: P = |S|Â² = {P:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"\nÎ»VT = {lambda_ * V * T:.2e}"</span>)</div>

            <div class="output">Sè¡Œåˆ—ã®æ‘‚å‹•å±•é–‹:
==================================================
0æ¬¡ï¼ˆè‡ªç”±ï¼‰: Sâ½â°â¾ = 1
1æ¬¡æ‘‚å‹•: Sâ½Â¹â¾ = 1.000000-41.666667j
é·ç§»ç¢ºç‡: P = |S|Â² = 1736.111111

Î»VT = 1.00e+03</div>

            <div class="mermaid">
flowchart TD
    A[ç›¸äº’ä½œç”¨Hamiltonian H_I] --> B[ç›¸äº’ä½œç”¨æåƒ]
    B --> C[Dysonç´šæ•°å±•é–‹]
    C --> D[æ™‚é–“é †åºç©<br/>T{H_I...H_I}]
    D --> E[Wickã®å®šç†é©ç”¨]
    E --> F[ç¸®ç´„ = ä¼æ’­é–¢æ•°]
    F --> G[Feynmanå›³å½¢ã¸]

    style A fill:#e3f2fd
    style E fill:#f3e5f5
    style G fill:#e8f5e9
            </div>

            <h2>3.5 æ–­é¢ç©ã¨å´©å£Šç‡</h2>

            <p>
                æ•£ä¹±æŒ¯å¹…ã‹ã‚‰è¦³æ¸¬å¯èƒ½ãªç‰©ç†é‡ã§ã‚ã‚‹å¾®åˆ†æ–­é¢ç©ã¨å´©å£Šç‡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
            </p>

            <div class="theorem">
                <h3>ğŸ“Š æ•£ä¹±æ–­é¢ç©ã®å…¬å¼</h3>
                <p>2 â†’ n æ•£ä¹±éç¨‹ã®å¾®åˆ†æ–­é¢ç©ï¼š</p>
                <p>\[
                d\sigma = \frac{1}{4E_1E_2v_{rel}} |\mathcal{M}|^2 \, d\Pi_n
                \]</p>
                <p>ã“ã“ã§ã€ä½ç›¸ç©ºé–“è¦ç´ ã¯ï¼š</p>
                <p>\[
                d\Pi_n = (2\pi)^4 \delta^{(4)}(p_1 + p_2 - \sum p_i) \prod_{i=1}^n \frac{d^3p_i}{(2\pi)^3 2E_i}
                \]</p>
            </div>

            <div class="code-title">Example 5: 2ä½“å´©å£Šã®ä½ç›¸ç©ºé–“ç©åˆ†</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># 2ä½“å´©å£Šã®ä½ç›¸ç©ºé–“</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">two_body_phase_space</span>(M, m1, m2):
    <span class="string">"""2ä½“å´©å£Š M â†’ m1 + m2 ã®ä½ç›¸ç©ºé–“å› å­

    Args:
        M: è¦ªç²’å­ã®è³ªé‡
        m1, m2: å¨˜ç²’å­ã®è³ªé‡

    Returns:
        ä½ç›¸ç©ºé–“å› å­ dÎ _2
    """</span>
    <span class="keyword">if</span> M < m1 + m2:
        <span class="keyword">return</span> <span class="number">0.0</span>  <span class="comment"># é‹å‹•å­¦çš„ã«ç¦æ­¢</span>

    <span class="comment"># é‡å¿ƒç³»ã§ã®é‹å‹•é‡</span>
    p_cm = np.sqrt((M**<span class="number">2</span> - (m1 + m2)**<span class="number">2</span>) * (M**<span class="number">2</span> - (m1 - m2)**<span class="number">2</span>)) / (<span class="number">2</span> * M)

    <span class="comment"># ä½ç›¸ç©ºé–“å› å­</span>
    dPi2 = p_cm / (<span class="number">8</span> * np.pi * M**<span class="number">2</span>)

    <span class="keyword">return</span> dPi2

<span class="keyword">def</span> <span class="function">decay_rate</span>(M, m1, m2, M_amp):
    <span class="string">"""å´©å£Šç‡ Î“ = |M|Â² Ã— dÎ _2"""</span>
    dPi = two_body_phase_space(M, m1, m2)
    Gamma = np.abs(M_amp)**<span class="number">2</span> * dPi

    <span class="keyword">return</span> Gamma

<span class="comment"># ä¾‹: Higgs â†’ bbÌ„ å´©å£Šï¼ˆç°¡ç•¥ãƒ¢ãƒ‡ãƒ«ï¼‰</span>
M_H = <span class="number">125.0</span>    <span class="comment"># GeV (Higgsè³ªé‡)</span>
m_b = <span class="number">4.2</span>      <span class="comment"># GeV (bottomè³ªé‡)</span>
M_amp = <span class="number">0.02</span>   <span class="comment"># æŒ¯å¹…ï¼ˆä»®ï¼‰</span>

dPi = two_body_phase_space(M_H, m_b, m_b)
Gamma = decay_rate(M_H, m_b, m_b, M_amp)

<span class="comment"># å¯¿å‘½</span>
tau = <span class="number">1</span> / Gamma <span class="keyword">if</span> Gamma > <span class="number">0</span> <span class="keyword">else</span> np.inf

<span class="function">print</span>(<span class="string">"2ä½“å´©å£Šã®é‹å‹•å­¦:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"è¦ªç²’å­è³ªé‡: {M_H} GeV"</span>)
<span class="function">print</span>(<span class="string">f"å¨˜ç²’å­è³ªé‡: {m_b} GeV Ã— 2"</span>)
<span class="function">print</span>(<span class="string">f"é‡å¿ƒç³»é‹å‹•é‡: {np.sqrt((M_H**2 - 4*m_b**2))/2:.4f} GeV"</span>)
<span class="function">print</span>(<span class="string">f"\nä½ç›¸ç©ºé–“å› å­: {dPi:.6e}"</span>)
<span class="function">print</span>(<span class="string">f"å´©å£Šç‡ Î“: {Gamma:.6e} GeV"</span>)
<span class="function">print</span>(<span class="string">f"å¯¿å‘½ Ï„: {tau:.6e} GeVâ»Â¹"</span>)</div>

            <div class="output">2ä½“å´©å£Šã®é‹å‹•å­¦:
==================================================
è¦ªç²’å­è³ªé‡: 125.0 GeV
å¨˜ç²’å­è³ªé‡: 4.2 GeV Ã— 2
é‡å¿ƒç³»é‹å‹•é‡: 61.8591 GeV

ä½ç›¸ç©ºé–“å› å­: 4.953184e-03
å´©å£Šç‡ Î“: 1.981274e-06 GeV
å¯¿å‘½ Ï„: 5.047293e+05 GeVâ»Â¹</div>

            <h2>3.6 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨: å¤šä½“æ•£ä¹±ç†è«–</h2>

            <p>
                å ´ã®ç†è«–ã®å½¢å¼ã¯ã€å›ºä½“ä¸­ã®æº–ç²’å­æ•£ä¹±ã‚„ä¸ç´”ç‰©æ•£ä¹±å•é¡Œã«é©ç”¨ã•ã‚Œã¾ã™ã€‚
                Tè¡Œåˆ—å½¢å¼ã«ã‚ˆã‚Šã€ç¹°ã‚Šè¿”ã—æ•£ä¹±ã‚’ç³»çµ±çš„ã«æ‰±ãˆã¾ã™ã€‚
            </p>

            <div class="example">
                <h3>ğŸ”¬ ä¸ç´”ç‰©æ•£ä¹±ã®Tè¡Œåˆ—</h3>
                <p>ä¸ç´”ç‰©ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ« \(V\) ã«ã‚ˆã‚‹æ•£ä¹±ã®Tè¡Œåˆ—ï¼š</p>
                <p>\[
                T = V + VGV + VGVGV + \cdots = V(1 - GV)^{-1}
                \]</p>
                <p>\(G\) ã¯è‡ªç”±ç²’å­ã®Greené–¢æ•°ã§ã™ã€‚</p>
            </div>

            <div class="code-title">Example 6: Bornè¿‘ä¼¼ã§ã®æ•£ä¹±æ–­é¢ç©</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># Bornè¿‘ä¼¼ã§ã®ä¸ç´”ç‰©æ•£ä¹±</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">yukawa_potential_ft</span>(q, V0, a):
    <span class="string">"""Yukawaå‹ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®Fourierå¤‰æ›

    V(r) = V0 exp(-r/a) / r
    V(q) = 4Ï€V0 aÂ² / (1 + qÂ²aÂ²)
    """</span>
    <span class="keyword">return</span> <span class="number">4</span> * np.pi * V0 * a**<span class="number">2</span> / (<span class="number">1</span> + (q * a)**<span class="number">2</span>)

<span class="keyword">def</span> <span class="function">born_cross_section</span>(E, theta, V0, a, m=<span class="number">1.0</span>):
    <span class="string">"""Bornè¿‘ä¼¼ã§ã®å¾®åˆ†æ–­é¢ç©

    dÏƒ/dÎ© = |f(Î¸)|Â² where f = -m V(q) / (2Ï€)
    """</span>
    k = np.sqrt(<span class="number">2</span> * m * E)  <span class="comment"># æ³¢æ•°</span>
    q = <span class="number">2</span> * k * np.sin(theta / <span class="number">2</span>)  <span class="comment"># é‹å‹•é‡ä¼é”</span>

    V_q = yukawa_potential_ft(q, V0, a)
    f_theta = -m * V_q / (<span class="number">2</span> * np.pi)

    dsigma_dOmega = np.abs(f_theta)**<span class="number">2</span>

    <span class="keyword">return</span> dsigma_dOmega

<span class="comment"># é›»å­ã®ä¸ç´”ç‰©æ•£ä¹±ï¼ˆé‡‘å±ä¸­ï¼‰</span>
E = <span class="number">1.0</span>      <span class="comment"># eV</span>
V0 = <span class="number">0.1</span>    <span class="comment"># eV</span>
a = <span class="number">1.0</span>      <span class="comment"># Ã…</span>
m = <span class="number">0.5</span>     <span class="comment"># æœ‰åŠ¹è³ªé‡ï¼ˆè‡ªç”±é›»å­è³ªé‡ã®å˜ä½ï¼‰</span>

theta_array = np.linspace(<span class="number">0</span>, np.pi, <span class="number">50</span>)
dsigma = [born_cross_section(E, th, V0, a, m) <span class="keyword">for</span> th <span class="keyword">in</span> theta_array]

<span class="comment"># å…¨æ–­é¢ç©ï¼ˆæ•°å€¤ç©åˆ†ï¼‰</span>
dtheta = theta_array[<span class="number">1</span>] - theta_array[<span class="number">0</span>]
sigma_total = <span class="number">2</span> * np.pi * np.<span class="function">sum</span>([ds * np.sin(th) <span class="keyword">for</span> ds, th <span class="keyword">in</span> <span class="function">zip</span>(dsigma, theta_array)]) * dtheta

<span class="function">print</span>(<span class="string">"Bornè¿‘ä¼¼ã§ã®ä¸ç´”ç‰©æ•£ä¹±:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"å…¥å°„ã‚¨ãƒãƒ«ã‚®ãƒ¼: {E} eV"</span>)
<span class="function">print</span>(<span class="string">f"ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«å¼·åº¦: {V0} eV"</span>)
<span class="function">print</span>(<span class="string">f"ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ç¯„å›²: {a} Ã…"</span>)
<span class="function">print</span>(<span class="string">f"\nå‰æ–¹æ•£ä¹± (Î¸=0): {dsigma[0]:.6e} Å²"</span>)
<span class="function">print</span>(<span class="string">f"å¾Œæ–¹æ•£ä¹± (Î¸=Ï€): {dsigma[-1]:.6e} Å²"</span>)
<span class="function">print</span>(<span class="string">f"å…¨æ•£ä¹±æ–­é¢ç©: {sigma_total:.6e} Å²"</span>)</div>

            <div class="output">Bornè¿‘ä¼¼ã§ã®ä¸ç´”ç‰©æ•£ä¹±:
==================================================
å…¥å°„ã‚¨ãƒãƒ«ã‚®ãƒ¼: 1.0 eV
ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«å¼·åº¦: 0.1 eV
ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ç¯„å›²: 1.0 Ã…

å‰æ–¹æ•£ä¹± (Î¸=0): 3.947842e-02 Å²
å¾Œæ–¹æ•£ä¹± (Î¸=Ï€): 9.869605e-04 Å²
å…¨æ•£ä¹±æ–­é¢ç©: 1.270389e-01 Å²</div>

            <div class="code-title">Example 7: é›»æ°—æŠµæŠ—ç‡ã®è¨ˆç®—ï¼ˆDrude-Sommerfeldç†è«–ï¼‰</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># æ•£ä¹±æ–­é¢ç©ã‹ã‚‰é›»æ°—æŠµæŠ—ç‡ã¸</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">resistivity_from_scattering</span>(n_imp, sigma_tr, n_e, v_F):
    <span class="string">"""é›»æ°—æŠµæŠ—ç‡ã®è¨ˆç®—

    Ï = m / (n_e eÂ² Ï„)
    Ï„â»Â¹ = n_imp v_F Ïƒ_tr
    """</span>
    e = <span class="number">1.602e-19</span>  <span class="comment"># C</span>
    m_e = <span class="number">9.109e-31</span>  <span class="comment"># kg</span>

    tau_inv = n_imp * v_F * sigma_tr  <span class="comment"># æ•£ä¹±ç‡</span>
    tau = <span class="number">1</span> / tau_inv

    rho = m_e / (n_e * e**<span class="number">2</span> * tau)

    <span class="keyword">return</span> rho, tau

<span class="comment"># éŠ…ã®å…¸å‹çš„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
n_e = <span class="number">8.5e28</span>      <span class="comment"># mâ»Â³ (ä¼å°é›»å­å¯†åº¦)</span>
v_F = <span class="number">1.57e6</span>     <span class="comment"># m/s (Fermié€Ÿåº¦)</span>
n_imp = <span class="number">1e24</span>     <span class="comment"># mâ»Â³ (ä¸ç´”ç‰©å¯†åº¦)</span>
sigma_tr = <span class="number">1e-19</span>  <span class="comment"># mÂ² (è¼¸é€æ–­é¢ç©)</span>

rho, tau = resistivity_from_scattering(n_imp, sigma_tr, n_e, v_F)

<span class="comment"># ç·©å’Œæ™‚é–“ã¨å¹³å‡è‡ªç”±è¡Œç¨‹</span>
l_mfp = v_F * tau  <span class="comment"># å¹³å‡è‡ªç”±è¡Œç¨‹</span>

<span class="function">print</span>(<span class="string">"é›»æ°—æŠµæŠ—ç‡ã®å¾®è¦–çš„è¨ˆç®—:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"ä¼å°é›»å­å¯†åº¦: {n_e:.2e} mâ»Â³"</span>)
<span class="function">print</span>(<span class="string">f"ä¸ç´”ç‰©å¯†åº¦: {n_imp:.2e} mâ»Â³"</span>)
<span class="function">print</span>(<span class="string">f"è¼¸é€æ–­é¢ç©: {sigma_tr:.2e} mÂ²"</span>)
<span class="function">print</span>(<span class="string">f"\nç·©å’Œæ™‚é–“ Ï„: {tau:.2e} s"</span>)
<span class="function">print</span>(<span class="string">f"å¹³å‡è‡ªç”±è¡Œç¨‹: {l_mfp*1e9:.2f} nm"</span>)
<span class="function">print</span>(<span class="string">f"é›»æ°—æŠµæŠ—ç‡ Ï: {rho:.2e} Î©Â·m"</span>)
<span class="function">print</span>(<span class="string">f"é›»æ°—ä¼å°åº¦ Ïƒ: {1/rho:.2e} S/m"</span>)</div>

            <div class="output">é›»æ°—æŠµæŠ—ç‡ã®å¾®è¦–çš„è¨ˆç®—:
==================================================
ä¼å°é›»å­å¯†åº¦: 8.50e+28 mâ»Â³
ä¸ç´”ç‰©å¯†åº¦: 1.00e+24 mâ»Â³
è¼¸é€æ–­é¢ç©: 1.00e-19 mÂ²

ç·©å’Œæ™‚é–“ Ï„: 6.37e-15 s
å¹³å‡è‡ªç”±è¡Œç¨‹: 10.00 nm
é›»æ°—æŠµæŠ—ç‡ Ï: 1.32e-08 Î©Â·m
é›»æ°—ä¼å°åº¦ Ïƒ: 7.58e+07 S/m</div>

            <div class="code-title">Example 8: ãƒ•ã‚©ãƒãƒ³æ•£ä¹±ã«ã‚ˆã‚‹Matthiessenã®æ³•å‰‡</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># Matthiessenã®æ³•å‰‡: Ï_total = Ï_imp + Ï_ph(T)</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">phonon_scattering_rate</span>(T, theta_D):
    <span class="string">"""ãƒ•ã‚©ãƒãƒ³æ•£ä¹±ã«ã‚ˆã‚‹ç·©å’Œç‡

    Ï„_phâ»Â¹ âˆ Tâµ (T << Î¸_D)
    Ï„_phâ»Â¹ âˆ T (T >> Î¸_D)
    """</span>
    <span class="keyword">if</span> T < <span class="number">0.1</span> * theta_D:
        <span class="comment"># ä½æ¸©ï¼ˆBloch-GrÃ¼neisené ˜åŸŸï¼‰</span>
        tau_ph_inv = <span class="number">1e12</span> * (T / theta_D)**<span class="number">5</span>
    <span class="keyword">else</span>:
        <span class="comment"># é«˜æ¸©ï¼ˆç·šå½¢é ˜åŸŸï¼‰</span>
        tau_ph_inv = <span class="number">1e13</span> * (T / theta_D)

    <span class="keyword">return</span> tau_ph_inv

<span class="keyword">def</span> <span class="function">total_resistivity</span>(T, rho_imp, theta_D, rho0_ph):
    <span class="string">"""å…¨æŠµæŠ—ç‡ï¼ˆMatthiessenã®æ³•å‰‡ï¼‰"""</span>
    tau_ph_inv = phonon_scattering_rate(T, theta_D)
    rho_ph = rho0_ph * (tau_ph_inv / <span class="number">1e13</span>)  <span class="comment"># æ­£è¦åŒ–</span>

    <span class="keyword">return</span> rho_imp + rho_ph

<span class="comment"># éŠ…ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
theta_D = <span class="number">343</span>      <span class="comment"># K (Debyeæ¸©åº¦)</span>
rho_imp = <span class="number">1e-9</span>    <span class="comment"># Î©Â·m (æ®‹ç•™æŠµæŠ—)</span>
rho0_ph = <span class="number">1.7e-8</span>  <span class="comment"># Î©Â·m (å®¤æ¸©ã§ã®ãƒ•ã‚©ãƒãƒ³å¯„ä¸)</span>

temperatures = [<span class="number">10</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">200</span>, <span class="number">300</span>]

<span class="function">print</span>(<span class="string">"Matthiessenã®æ³•å‰‡ã«ã‚ˆã‚‹æŠµæŠ—ç‡:"</span>)
<span class="function">print</span>(<span class="string">"=" * 60</span>)
<span class="function">print</span>(<span class="string">f"{'T (K)':<10} {'Ï_imp (Î©Â·m)':<20} {'Ï_ph (Î©Â·m)':<20} {'Ï_total':<15}"</span>)
<span class="function">print</span>(<span class="string">"-" * 60</span>)

<span class="keyword">for</span> T <span class="keyword">in</span> temperatures:
    rho_ph = total_resistivity(T, <span class="number">0</span>, theta_D, rho0_ph) - <span class="number">0</span>
    rho_tot = total_resistivity(T, rho_imp, theta_D, rho0_ph)

    <span class="function">print</span>(<span class="string">f"{T:<10} {rho_imp:<20.2e} {rho_ph:<20.2e} {rho_tot:<15.2e}"</span>)</div>

            <div class="output">Matthiessenã®æ³•å‰‡ã«ã‚ˆã‚‹æŠµæŠ—ç‡:
============================================================
T (K)      Ï_imp (Î©Â·m)          Ï_ph (Î©Â·m)           Ï_total
------------------------------------------------------------
10         1.00e-09             4.49e-13             1.00e-09
50         1.00e-09             2.81e-10             1.28e-09
100        1.00e-09             5.64e-09             6.64e-09
200        1.00e-09             9.91e-09             1.09e-08
300        1.00e-09             1.49e-08             1.59e-08</div>

            <h2>æ¼”ç¿’å•é¡Œ</h2>

            <div class="exercise">
                <h3>Easyï¼ˆåŸºç¤ç¢ºèªï¼‰</h3>

                <p><strong>Q1</strong>: ç›¸äº’ä½œç”¨æåƒã§ã®æ™‚é–“ç™ºå±•æ¼”ç®—å­ \(U_I(t, t_0)\) ãŒæº€ãŸã™å¾®åˆ†æ–¹ç¨‹å¼ã‚’å°å‡ºã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>å°å‡º</strong>:</p>
                    <p>\[
                    i\frac{d}{dt}|\psi_I(t)\rangle = H_I(t)|\psi_I(t)\rangle
                    \]</p>
                    <p>\(|\psi_I(t)\rangle = U_I(t, t_0)|\psi_I(t_0)\rangle\) ãªã®ã§ï¼š</p>
                    <p>\[
                    i\frac{\partial U_I}{\partial t} = H_I(t) U_I(t, t_0)
                    \]</p>
                    <p>åˆæœŸæ¡ä»¶: \(U_I(t_0, t_0) = 1\)</p>
                </details>
            </div>

            <div class="exercise">
                <h3>Mediumï¼ˆå¿œç”¨ï¼‰</h3>

                <p><strong>Q2</strong>: Wickã®å®šç†ã‚’ç”¨ã„ã¦ã€6ç‚¹é–¢æ•° \(\langle 0|T\{\phi_1\cdots\phi_6\}|0\rangle\) ã®ç•°ãªã‚‹ãƒšã‚¢ãƒªãƒ³ã‚°ã®æ•°ã‚’æ•°ãˆã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>è¨ˆç®—</strong>:</p>
                    <p>6ã¤ã®å ´ã‚’3çµ„ã®ãƒšã‚¢ã«åˆ†ã‘ã‚‹æ–¹æ³•ã®æ•°ï¼š</p>
                    <p>\[
                    \frac{6!}{2^3 \cdot 3!} = \frac{720}{8 \cdot 6} = 15
                    \]</p>
                    <p>ä¸€èˆ¬ã«ã€\(2n\)ç‚¹é–¢æ•°ã®ãƒšã‚¢ãƒªãƒ³ã‚°æ•°ã¯ \((2n-1)!! = (2n-1)(2n-3)\cdots 3 \cdot 1\)</p>
                </details>
            </div>

            <div class="exercise">
                <h3>Hardï¼ˆç™ºå±•ï¼‰</h3>

                <p><strong>Q3</strong>: LSZå…¬å¼ã‚’ç”¨ã„ã¦ã€Ï†â´ç†è«–ã§ã®2â†’2æ•£ä¹±æŒ¯å¹…ãŒãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«ã§ \(\mathcal{M} = -\lambda\) ã¨ãªã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p><strong>å°å‡º</strong>:</p>
                    <p>LSZå…¬å¼ã‹ã‚‰ã€å¤–ç·šã‚’on-shellã«ã™ã‚‹ã¨:</p>
                    <p>\[
                    \langle p_3, p_4|S|p_1, p_2\rangle \propto \langle 0|T\{\phi\phi\phi\phi\}|0\rangle_{\text{1PI}}
                    \]</p>
                    <p>ãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«ã§ã¯ã€4ç‚¹é ‚ç‚¹ã®ã¿ãŒå¯„ä¸:</p>
                    <p>\[
                    H_I = \int d^4x \, \frac{\lambda}{4!}\phi^4
                    \]</p>
                    <p>Sè¡Œåˆ—ã®1æ¬¡é …:</p>
                    <p>\[
                    S^{(1)} = -i\int d^4x \, \frac{\lambda}{4!}\phi^4
                    \]</p>
                    <p>Wickã®å®šç†ã§4ã¤ã®å ´ã‚’å¤–ç·šã«ç¸®ç´„ã™ã‚‹ã¨ã€çµ„åˆã›å› å­ \(4!\) ãŒã‚­ãƒ£ãƒ³ã‚»ãƒ«ã—ã¦:</p>
                    <p>\[
                    \mathcal{M} = -\lambda
                    \]</p>
                </details>
            </div>

            <div class="nav-buttons">
                <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« </a>
                <a href="chapter-4.html" class="nav-button">ç¬¬4ç« ã¸é€²ã‚€ â†’</a>
            </div>

            <h2>å‚è€ƒæ–‡çŒ®</h2>

            <ol>
                <li>Peskin, M. E., & Schroeder, D. V. (1995). <em>An Introduction to Quantum Field Theory</em>. Westview Press.</li>
                <li>Weinberg, S. (1995). <em>The Quantum Theory of Fields, Vol. 1</em>. Cambridge University Press.</li>
                <li>Schwartz, M. D. (2014). <em>Quantum Field Theory and the Standard Model</em>. Cambridge University Press.</li>
                <li>Mahan, G. D. (2000). <em>Many-Particle Physics</em> (3rd ed.). Springer.</li>
            </ol>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - Fundamentals of Mathematics & Physics Dojo</p>
        <p style="margin-top: 0.5rem;">Licensed under CC BY 4.0</p>
    </footer>

    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'base' });
    </script>
</body>
</html>
