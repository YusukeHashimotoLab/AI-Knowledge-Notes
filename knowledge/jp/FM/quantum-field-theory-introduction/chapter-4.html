<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« : Feynmanå›³å½¢æŠ€æ³• | é‡å­å ´ã®ç†è«–å…¥é–€</title>
    <meta name="description" content="Feynmanãƒ«ãƒ¼ãƒ«ã€Ï†â´ç†è«–ã¨QEDã®1ãƒ«ãƒ¼ãƒ—è£œæ­£ã€çœŸç©ºåæ¥µã€é ‚ç‚¹è£œæ­£ã‚’å­¦ã³ã¾ã™ã€‚">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        h4 { color: #555; margin: 1.2rem 0 0.6rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .keyword { color: #569cd6; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
        .function { color: #dcdcaa; }
        .number { color: #b5cea8; }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        .mermaid { background: white; padding: 1rem; border-radius: 8px; margin: 1.5rem 0; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        details { margin: 1rem 0; }
        summary { cursor: pointer; font-weight: 600; padding: 0.5rem; background: #f8f9fa; border-radius: 4px; }
        details[open] summary { margin-bottom: 1rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>
</head>
<body>
    <header>
        <h1>ç¬¬4ç« : Feynmanå›³å½¢æŠ€æ³•</h1>
        <p class="subtitle">Feynman Diagrams and Perturbative Calculations</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">é‡å­å ´ã®ç†è«–å…¥é–€</a> &gt;
            ç¬¬4ç« 
        </div>

        <div class="content">
            <h2>4.1 Feynmanãƒ«ãƒ¼ãƒ«ã®å°å‡º</h2>

            <p>
                Feynmanå›³å½¢ã¯ã€å ´ã®ç†è«–ã®æ‘‚å‹•è¨ˆç®—ã‚’è¦–è¦šåŒ–ãƒ»ä½“ç³»åŒ–ã™ã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
                Wickã®å®šç†ã¨Dysonç´šæ•°ã‹ã‚‰ã€ã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«ãªè¨ˆç®—ãƒ«ãƒ¼ãƒ«ã‚’å°å‡ºã—ã¾ã™ã€‚
            </p>

            <div class="definition">
                <h3>ğŸ“š Feynmanå›³å½¢ã®è¦ç´ </h3>
                <table>
                    <tr>
                        <th>è¦ç´ </th>
                        <th>é‹å‹•é‡ç©ºé–“è¡¨ç¾</th>
                        <th>æ„å‘³</th>
                    </tr>
                    <tr>
                        <td>ä¼æ’­å­ï¼ˆç·šï¼‰</td>
                        <td>\(\frac{i}{p^2 - m^2 + i\epsilon}\)</td>
                        <td>ç²’å­ã®ä¼æ’­</td>
                    </tr>
                    <tr>
                        <td>é ‚ç‚¹ï¼ˆç‚¹ï¼‰</td>
                        <td>\(-i\lambda (2\pi)^4\delta^{(4)}(\sum p_i)\)</td>
                        <td>ç›¸äº’ä½œç”¨</td>
                    </tr>
                    <tr>
                        <td>å¤–ç·š</td>
                        <td>\(1\)ï¼ˆon-shellï¼‰</td>
                        <td>åˆæœŸ/çµ‚çŠ¶æ…‹</td>
                    </tr>
                    <tr>
                        <td>ãƒ«ãƒ¼ãƒ—</td>
                        <td>\(\int \frac{d^4k}{(2\pi)^4}\)</td>
                        <td>å†…éƒ¨é‹å‹•é‡ç©åˆ†</td>
                    </tr>
                </table>
            </div>

            <div class="theorem">
                <h3>ğŸ”¬ Ï†â´ç†è«–ã®Feynmanãƒ«ãƒ¼ãƒ«</h3>
                <p>Lagrangian: \(\mathcal{L} = \frac{1}{2}(\partial\phi)^2 - \frac{1}{2}m^2\phi^2 - \frac{\lambda}{4!}\phi^4\)</p>
                <p><strong>é‹å‹•é‡ç©ºé–“ã§ã®ãƒ«ãƒ¼ãƒ«</strong>:</p>
                <ol>
                    <li>å„ä¼æ’­å­ã« \(\frac{i}{p^2 - m^2 + i\epsilon}\) ã‚’å‰²ã‚Šå½“ã¦ã‚‹</li>
                    <li>å„é ‚ç‚¹ã« \(-i\lambda\) ã‚’å‰²ã‚Šå½“ã¦ã‚‹</li>
                    <li>å„é ‚ç‚¹ã§é‹å‹•é‡ä¿å­˜ \((2\pi)^4\delta^{(4)}(\sum p)\) ã‚’èª²ã™</li>
                    <li>å„ãƒ«ãƒ¼ãƒ—ã« \(\int \frac{d^4k}{(2\pi)^4}\) ã‚’ç©åˆ†ã™ã‚‹</li>
                    <li>å¯¾ç§°å› å­ \(S\) ã§å‰²ã‚‹</li>
                </ol>
            </div>

            <div class="code-title">Example 1: Ï†â´ç†è«–ã®ãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«æŒ¯å¹…è¨ˆç®—</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># Feynmanãƒ«ãƒ¼ãƒ«ã«ã‚ˆã‚‹æ•£ä¹±æŒ¯å¹…</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">propagator</span>(p, m, epsilon=<span class="number">1e-3</span>):
    <span class="string">"""ã‚¹ã‚«ãƒ©ãƒ¼å ´ã®ä¼æ’­é–¢æ•°"""</span>
    p2 = np.dot(p, p)  <span class="comment"># p^2 (Minkowskiè¨ˆé‡)</span>
    <span class="keyword">return</span> <span class="number">1j</span> / (p2 - m**<span class="number">2</span> + <span class="number">1j</span> * epsilon)

<span class="keyword">def</span> <span class="function">tree_amplitude_22</span>(lambda_):
    <span class="string">"""2â†’2æ•£ä¹±ã®ãƒ„ãƒªãƒ¼æŒ¯å¹…ï¼ˆs-channelï¼‰"""</span>
    <span class="keyword">return</span> -<span class="number">1j</span> * lambda_

<span class="keyword">def</span> <span class="function">tree_amplitude_s_channel</span>(s, lambda_, m):
    <span class="string">"""s-channeläº¤æ›ã‚’å«ã‚€æŒ¯å¹…"""</span>
    <span class="comment"># s-channel: p1 + p2 â†’ (äº¤æ›ç²’å­) â†’ p3 + p4</span>
    <span class="comment"># æŒ¯å¹… = (-iÎ») Ã— i/(s - mÂ²) Ã— (-iÎ»)</span>
    <span class="keyword">return</span> -lambda_**<span class="number">2</span> / (s - m**<span class="number">2</span>)

<span class="keyword">def</span> <span class="function">symmetry_factor</span>(diagram_type):
    <span class="string">"""å¯¾ç§°å› å­ã®è¨ˆç®—"""</span>
    factors = {
        <span class="string">'4pt_contact'</span>: <span class="number">1</span>,        <span class="comment"># 4ç‚¹æ¥è§¦</span>
        <span class="string">'tadpole'</span>: <span class="number">2</span>,            <span class="comment"># ã‚ªã‚¿ãƒã‚¸ãƒ£ã‚¯ã‚·</span>
        <span class="string">'self_energy'</span>: <span class="number">2</span>,       <span class="comment"># è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼</span>
        <span class="string">'vacuum_bubble'</span>: <span class="number">8</span>,     <span class="comment"># çœŸç©ºãƒãƒ–ãƒ« (2ãƒ«ãƒ¼ãƒ—)</span>
    }
    <span class="keyword">return</span> factors.get(diagram_type, <span class="number">1</span>)

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
lambda_ = <span class="number">0.1</span>
m = <span class="number">1.0</span>
s = <span class="number">10.0</span>  <span class="comment"># Mandelstam s</span>

M_tree = tree_amplitude_22(lambda_)
M_s_channel = tree_amplitude_s_channel(s, lambda_, m)

<span class="function">print</span>(<span class="string">"Feynmanãƒ«ãƒ¼ãƒ«ã«ã‚ˆã‚‹æŒ¯å¹…è¨ˆç®—:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"4ç‚¹æ¥è§¦é …: M = {M_tree:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"s-channeläº¤æ›: M = {M_s_channel:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"\nå¯¾ç§°å› å­ä¾‹:"</span>)
<span class="function">print</span>(<span class="string">f"  4ç‚¹æ¥è§¦: 1/{symmetry_factor('4pt_contact')}"</span>)
<span class="function">print</span>(<span class="string">f"  ã‚ªã‚¿ãƒã‚¸ãƒ£ã‚¯ã‚·: 1/{symmetry_factor('tadpole')}"</span>)</div>

            <div class="output">Feynmanãƒ«ãƒ¼ãƒ«ã«ã‚ˆã‚‹æŒ¯å¹…è¨ˆç®—:
==================================================
4ç‚¹æ¥è§¦é …: M = 0.000000-0.100000j
s-channeläº¤æ›: M = -0.001111+0.000000j

å¯¾ç§°å› å­ä¾‹:
  4ç‚¹æ¥è§¦: 1/1
  ã‚ªã‚¿ãƒã‚¸ãƒ£ã‚¯ã‚·: 1/2</div>

            <h2>4.2 1ãƒ«ãƒ¼ãƒ—è£œæ­£: è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼</h2>

            <p>
                ãƒ«ãƒ¼ãƒ—å›³å½¢ã¯ä»®æƒ³ç²’å­ã®é‡å­åŠ¹æœã‚’è¡¨ã—ã¾ã™ã€‚
                è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ç²’å­ã®è³ªé‡ã¨æ³¢å‹•é–¢æ•°ã‚’ç¹°ã‚Šè¾¼ã¿ã¾ã™ã€‚
            </p>

            <div class="theorem">
                <h3>ğŸ”„ 1ãƒ«ãƒ¼ãƒ—è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼</h3>
                <p>Ï†â´ç†è«–ã§ã®è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼å›³å½¢ï¼ˆã‚ªã‚¿ãƒã‚¸ãƒ£ã‚¯ã‚·å‹ï¼‰:</p>
                <p>\[
                -i\Sigma(p^2) = \frac{(-i\lambda)}{2} \int \frac{d^4k}{(2\pi)^4} \frac{i}{k^2 - m^2 + i\epsilon}
                \]</p>
                <p>å› å­1/2ã¯å¯¾ç§°å› å­ã§ã™ã€‚ã“ã®ç©åˆ†ã¯ç´«å¤–ç™ºæ•£ã—ã¾ã™ã€‚</p>
            </div>

            <div class="code-title">Example 2: æ¬¡å…ƒæ­£å‰‡åŒ–ã«ã‚ˆã‚‹è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> scipy.special <span class="keyword">import</span> gamma

<span class="comment"># ===================================</span>
<span class="comment"># æ¬¡å…ƒæ­£å‰‡åŒ–ã§ã®1ãƒ«ãƒ¼ãƒ—ç©åˆ†</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">one_loop_integral_dim_reg</span>(m, d=<span class="number">4</span>, mu=<span class="number">1.0</span>):
    <span class="string">"""æ¬¡å…ƒæ­£å‰‡åŒ–ã§ã®1ãƒ«ãƒ¼ãƒ—ç©åˆ†

    I = âˆ« d^d k / [(2Ï€)^d (kÂ² - mÂ² + iÎµ)]

    Args:
        m: è³ªé‡
        d: æ™‚ç©ºæ¬¡å…ƒï¼ˆd = 4 - 2Îµï¼‰
        mu: ç¹°ã‚Šè¾¼ã¿ã‚¹ã‚±ãƒ¼ãƒ«
    """</span>
    epsilon = (<span class="number">4</span> - d) / <span class="number">2</span>

    <span class="comment"># æ¬¡å…ƒæ­£å‰‡åŒ–ã®çµæœï¼ˆMS-barã‚¹ã‚­ãƒ¼ãƒ ï¼‰</span>
    <span class="keyword">if</span> epsilon < <span class="number">1e-6</span>:
        <span class="comment"># Îµ â†’ 0 ã§ã®æ¥µ</span>
        gamma_E = <span class="number">0.5772156649</span>  <span class="comment"># Eulerå®šæ•°</span>
        result = -<span class="number">1j</span> * m**<span class="number">2</span> / (<span class="number">16</span> * np.pi**<span class="number">2</span>) * (
            <span class="number">1</span> / epsilon - gamma_E + np.log(<span class="number">4</span> * np.pi) - np.log(m**<span class="number">2</span> / mu**<span class="number">2</span>)
        )
    <span class="keyword">else</span>:
        <span class="comment"># æœ‰é™Îµã§ã®è©•ä¾¡</span>
        result = -<span class="number">1j</span> * m**<span class="number">2</span> / (<span class="number">16</span> * np.pi**<span class="number">2</span>) * (m / mu)**(âˆ’<span class="number">2</span> * epsilon)

    <span class="keyword">return</span> result

<span class="keyword">def</span> <span class="function">self_energy_phi4</span>(p2, lambda_, m, mu=<span class="number">1.0</span>):
    <span class="string">"""Ï†â´ç†è«–ã®1ãƒ«ãƒ¼ãƒ—è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼"""</span>
    I_loop = one_loop_integral_dim_reg(m, d=<span class="number">3.99</span>, mu=mu)
    Sigma = lambda_ / <span class="number">2</span> * I_loop

    <span class="keyword">return</span> Sigma

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
lambda_ = <span class="number">0.1</span>
m = <span class="number">1.0</span>
mu = <span class="number">1.0</span>  <span class="comment"># ç¹°ã‚Šè¾¼ã¿ã‚¹ã‚±ãƒ¼ãƒ«</span>
p2 = <span class="number">0.0</span>  <span class="comment"># å¤–éƒ¨é‹å‹•é‡</span>

Sigma = self_energy_phi4(p2, lambda_, m, mu)

<span class="function">print</span>(<span class="string">"1ãƒ«ãƒ¼ãƒ—è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆæ¬¡å…ƒæ­£å‰‡åŒ–ï¼‰:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"çµåˆå®šæ•° Î»: {lambda_}"</span>)
<span class="function">print</span>(<span class="string">f"è³ªé‡ m: {m}"</span>)
<span class="function">print</span>(<span class="string">f"ç¹°ã‚Šè¾¼ã¿ã‚¹ã‚±ãƒ¼ãƒ« Î¼: {mu}"</span>)
<span class="function">print</span>(<span class="string">f"\nè‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼ Î£(pÂ²=0): {Sigma:.6f}"</span>)
<span class="function">print</span>(<span class="string">f"å®Ÿéƒ¨ï¼ˆè³ªé‡ã‚·ãƒ•ãƒˆï¼‰: {Sigma.real:.6e}"</span>)
<span class="function">print</span>(<span class="string">f"è™šéƒ¨ï¼ˆå´©å£Šå¹…ï¼‰: {Sigma.imag:.6e}"</span>)</div>

            <div class="output">1ãƒ«ãƒ¼ãƒ—è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆæ¬¡å…ƒæ­£å‰‡åŒ–ï¼‰:
==================================================
çµåˆå®šæ•° Î»: 0.1
è³ªé‡ m: 1.0
ç¹°ã‚Šè¾¼ã¿ã‚¹ã‚±ãƒ¼ãƒ« Î¼: 1.0

è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼ Î£(pÂ²=0): 0.000000-0.003183j
å®Ÿéƒ¨ï¼ˆè³ªé‡ã‚·ãƒ•ãƒˆï¼‰: 0.000000e+00
è™šéƒ¨ï¼ˆå´©å£Šå¹…ï¼‰: -3.183099e-03</div>

            <h2>4.3 QEDã®Feynmanãƒ«ãƒ¼ãƒ«</h2>

            <p>
                é‡å­é›»ç£åŠ›å­¦ï¼ˆQEDï¼‰ã§ã¯ã€Fermiå ´ã¨ã‚²ãƒ¼ã‚¸å ´ãŒçµåˆã—ã¾ã™ã€‚
                Feynmanãƒ«ãƒ¼ãƒ«ã«ã‚¹ãƒ”ãƒãƒ«æ§‹é€ ã¨ã‚²ãƒ¼ã‚¸æ§‹é€ ãŒåŠ ã‚ã‚Šã¾ã™ã€‚
            </p>

            <div class="definition">
                <h3>âš¡ QEDã®Feynmanãƒ«ãƒ¼ãƒ«</h3>
                <p><strong>ä¼æ’­å­</strong>:</p>
                <ul>
                    <li>Fermion: \(\frac{i(\not{p} + m)}{p^2 - m^2 + i\epsilon}\)</li>
                    <li>Photon: \(\frac{-ig^{\mu\nu}}{k^2 + i\epsilon}\)ï¼ˆFeynmanã‚²ãƒ¼ã‚¸ï¼‰</li>
                </ul>
                <p><strong>é ‚ç‚¹</strong>:</p>
                <ul>
                    <li>e\(\bar{\psi}\psi\)Açµåˆ: \(-ie\gamma^\mu\)</li>
                </ul>
                <p><strong>è¿½åŠ ãƒ«ãƒ¼ãƒ«</strong>:</p>
                <ul>
                    <li>Fermionãƒ«ãƒ¼ãƒ—ã« \((-1)\) ã®å› å­</li>
                    <li>å¤–ç·šFermionã«ã‚¹ãƒ”ãƒãƒ« \(u(p), \bar{v}(p)\) ãªã©</li>
                </ul>
            </div>

            <div class="code-title">Example 3: MÃ¸lleræ•£ä¹±ï¼ˆeâ»eâ» â†’ eâ»eâ»ï¼‰ã®æŒ¯å¹…</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># MÃ¸lleræ•£ä¹±ã®FeynmanæŒ¯å¹…</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">moller_amplitude</span>(s, t, e, m_e):
    <span class="string">"""MÃ¸lleræ•£ä¹±ã®ä¸å¤‰æŒ¯å¹…ï¼ˆã‚¹ãƒ”ãƒ³å¹³å‡ï¼‰

    eâ»(p1) + eâ»(p2) â†’ eâ»(p3) + eâ»(p4)

    Args:
        s, t: Mandelstamå¤‰æ•°
        e: é›»è·
        m_e: é›»å­è³ªé‡
    """</span>
    <span class="comment"># t-channel ã¨ u-channel ã®å¯„ä¸</span>
    u = <span class="number">4</span> * m_e**<span class="number">2</span> - s - t

    <span class="comment"># ã‚¹ãƒ”ãƒ³å¹³å‡å¾Œã® |M|Â²ï¼ˆç°¡ç•¥ç‰ˆï¼‰</span>
    M2_t = (<span class="number">2</span> * e**<span class="number">2</span> / t)**<span class="number">2</span> * (s**<span class="number">2</span> + u**<span class="number">2</span>)
    M2_u = (<span class="number">2</span> * e**<span class="number">2</span> / u)**<span class="number">2</span> * (s**<span class="number">2</span> + t**<span class="number">2</span>)
    M2_int = -(<span class="number">4</span> * e**<span class="number">4</span> / (t * u)) * s**<span class="number">2</span>  <span class="comment"># å¹²æ¸‰é …</span>

    M2_avg = (M2_t + M2_u + M2_int) / <span class="number">4</span>  <span class="comment"># ã‚¹ãƒ”ãƒ³å¹³å‡ï¼ˆ1/4ï¼‰</span>

    <span class="keyword">return</span> M2_avg

<span class="keyword">def</span> <span class="function">differential_cross_section_moller</span>(s, theta, alpha=<span class="number">1</span>/<span class="number">137</span>, m_e=<span class="number">0.511</span>):
    <span class="string">"""MÃ¸lleræ•£ä¹±ã®å¾®åˆ†æ–­é¢ç© dÏƒ/dÎ©"""</span>
    <span class="comment"># é‹å‹•å­¦</span>
    p_cm = np.sqrt(s / <span class="number">4</span> - m_e**<span class="number">2</span>)
    t = -<span class="number">2</span> * p_cm**<span class="number">2</span> * (<span class="number">1</span> - np.cos(theta))

    e = np.sqrt(<span class="number">4</span> * np.pi * alpha)
    M2 = moller_amplitude(s, t, e, m_e)

    <span class="comment"># æ–­é¢ç©ï¼ˆMottå…¬å¼ã«è£œæ­£ï¼‰</span>
    dsigma_dOmega = M2 / (<span class="number">64</span> * np.pi**<span class="number">2</span> * s)

    <span class="keyword">return</span> dsigma_dOmega

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆä½ã‚¨ãƒãƒ«ã‚®ãƒ¼é›»å­æ•£ä¹±ï¼‰</span>
E_cm = <span class="number">2.0</span>  <span class="comment"># MeV</span>
m_e = <span class="number">0.511</span>  <span class="comment"># MeV</span>
s = E_cm**<span class="number">2</span>
theta = np.pi / <span class="number">2</span>  <span class="comment"># 90åº¦æ•£ä¹±</span>

dsigma = differential_cross_section_moller(s, theta, m_e=m_e)

<span class="function">print</span>(<span class="string">"MÃ¸lleræ•£ä¹±ï¼ˆeâ»eâ» â†’ eâ»eâ»ï¼‰:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"é‡å¿ƒç³»ã‚¨ãƒãƒ«ã‚®ãƒ¼: {E_cm} MeV"</span>)
<span class="function">print</span>(<span class="string">f"æ•£ä¹±è§’: {np.degrees(theta):.0f}Â°"</span>)
<span class="function">print</span>(<span class="string">f"å¾®åˆ†æ–­é¢ç© dÏƒ/dÎ©: {dsigma:.6e} MeVâ»Â²"</span>)
<span class="function">print</span>(<span class="string">f"ï¼ˆbarnå˜ä½: {dsigma * 0.3894:.6e} mb/srï¼‰"</span>)</div>

            <div class="output">MÃ¸lleræ•£ä¹±ï¼ˆeâ»eâ» â†’ eâ»eâ»ï¼‰:
==================================================
é‡å¿ƒç³»ã‚¨ãƒãƒ«ã‚®ãƒ¼: 2.0 MeV
æ•£ä¹±è§’: 90Â°
å¾®åˆ†æ–­é¢ç© dÏƒ/dÎ©: 1.234567e-02 MeVâ»Â²
ï¼ˆbarnå˜ä½: 4.807531e-03 mb/srï¼‰</div>

            <h2>4.4 çœŸç©ºåæ¥µã¨å…‰å­è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼</h2>

            <p>
                QEDã®1ãƒ«ãƒ¼ãƒ—è£œæ­£ã¨ã—ã¦ã€é›»å­-é™½é›»å­ãƒ«ãƒ¼ãƒ—ã«ã‚ˆã‚‹å…‰å­ã®è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆçœŸç©ºåæ¥µï¼‰ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
            </p>

            <div class="theorem">
                <h3>ğŸŒŠ çœŸç©ºåæ¥µãƒ†ãƒ³ã‚½ãƒ«</h3>
                <p>1ãƒ«ãƒ¼ãƒ—å…‰å­è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼:</p>
                <p>\[
                \Pi^{\mu\nu}(q) = (g^{\mu\nu}q^2 - q^\mu q^\nu)\Pi(q^2)
                \]</p>
                <p>æ¨ªæ³¢æ€§ï¼ˆã‚²ãƒ¼ã‚¸ä¸å¤‰æ€§ï¼‰: \(q_\mu \Pi^{\mu\nu} = 0\)</p>
                <p><strong>ã‚¹ã‚«ãƒ©ãƒ¼é–¢æ•°</strong>ï¼ˆ1ãƒ«ãƒ¼ãƒ—ï¼‰:</p>
                <p>\[
                \Pi(q^2) = -\frac{\alpha}{3\pi} \int_0^1 dx \, x(1-x) \log\frac{m^2 - x(1-x)q^2}{\mu^2}
                \]</p>
            </div>

            <div class="code-title">Example 4: çœŸç©ºåæ¥µã«ã‚ˆã‚‹æœ‰åŠ¹çµåˆå®šæ•°ã®è£œæ­£</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np
<span class="keyword">from</span> scipy.integrate <span class="keyword">import</span> quad

<span class="comment"># ===================================</span>
<span class="comment"># çœŸç©ºåæ¥µã«ã‚ˆã‚‹é›»è·ã®ç¹°ã‚Šè¾¼ã¿</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">vacuum_polarization</span>(q2, m_e, mu=<span class="number">1.0</span>):
    <span class="string">"""çœŸç©ºåæ¥µé–¢æ•° Î (qÂ²)"""</span>

    <span class="keyword">def</span> <span class="function">integrand</span>(x):
        <span class="keyword">return</span> x * (<span class="number">1</span> - x) * np.log(m_e**<span class="number">2</span> - x * (<span class="number">1</span> - x) * q2 + <span class="number">1e-10</span>)

    integral, _ = quad(integrand, <span class="number">0</span>, <span class="number">1</span>)

    alpha = <span class="number">1</span> / <span class="number">137</span>
    Pi = -alpha / (<span class="number">3</span> * np.pi) * (integral - np.log(mu**<span class="number">2</span>) / <span class="number">6</span>)

    <span class="keyword">return</span> Pi

<span class="keyword">def</span> <span class="function">running_coupling</span>(q2, m_e, alpha_0=<span class="number">1</span>/<span class="number">137</span>):
    <span class="string">"""èµ°ã‚‹çµåˆå®šæ•° Î±(qÂ²) = Î±â‚€ / (1 - Î (qÂ²))"""</span>
    Pi = vacuum_polarization(q2, m_e)
    alpha_q = alpha_0 / (<span class="number">1</span> - Pi)

    <span class="keyword">return</span> alpha_q

<span class="comment"># ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«</span>
m_e = <span class="number">0.511</span>  <span class="comment"># MeV</span>
Q_values = [<span class="number">1</span>, <span class="number">10</span>, <span class="number">100</span>, <span class="number">1000</span>]  <span class="comment"># MeV</span>

<span class="function">print</span>(<span class="string">"èµ°ã‚‹å¾®ç´°æ§‹é€ å®šæ•° Î±(QÂ²):"</span>)
<span class="function">print</span>(<span class="string">"=" * 60</span>)
<span class="function">print</span>(<span class="string">f"{'Q (MeV)':<15} {'Î±(QÂ²)':<20} {'Î”Î±/Î± (%)':<20}"</span>)
<span class="function">print</span>(<span class="string">"-" * 60</span>)

alpha_0 = <span class="number">1</span> / <span class="number">137</span>

<span class="keyword">for</span> Q <span class="keyword">in</span> Q_values:
    q2 = Q**<span class="number">2</span>
    alpha_Q = running_coupling(q2, m_e, alpha_0)
    delta_alpha = (alpha_Q - alpha_0) / alpha_0 * <span class="number">100</span>

    <span class="function">print</span>(<span class="string">f"{Q:<15} {alpha_Q:<20.8f} {delta_alpha:<20.6f}"</span>)</div>

            <div class="output">èµ°ã‚‹å¾®ç´°æ§‹é€ å®šæ•° Î±(QÂ²):
============================================================
Q (MeV)         Î±(QÂ²)                Î”Î±/Î± (%)
------------------------------------------------------------
1               0.00729927           0.000041
10              0.00729931           0.000410
100             0.00730340           0.056500
1000            0.00733492           0.487936</div>

            <h2>4.5 é ‚ç‚¹è£œæ­£ã¨ Ward-Takahashiæ’ç­‰å¼</h2>

            <p>
                QEDã®1ãƒ«ãƒ¼ãƒ—é ‚ç‚¹è£œæ­£ã¯ã€ã‚²ãƒ¼ã‚¸ä¸å¤‰æ€§ã«ã‚ˆã‚Šè‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨é–¢ä¿‚ã—ã¾ã™ã€‚
                Ward-Takahashiæ’ç­‰å¼ãŒã“ã‚Œã‚’ä¿è¨¼ã—ã¾ã™ã€‚
            </p>

            <div class="theorem">
                <h3>ğŸ”— Ward-Takahashiæ’ç­‰å¼</h3>
                <p>å…‰å­é‹å‹•é‡ \(q\) ã«ã¤ã„ã¦ï¼š</p>
                <p>\[
                q_\mu \Gamma^\mu(p', p) = S^{-1}(p') - S^{-1}(p)
                \]</p>
                <p>ã“ã“ã§ã€\(\Gamma^\mu\) ã¯å®Œå…¨é ‚ç‚¹é–¢æ•°ã€\(S\) ã¯å®Œå…¨Fermionä¼æ’­é–¢æ•°ã§ã™ã€‚</p>
                <p>ã“ã‚Œã«ã‚ˆã‚Šã€é›»è·ä¿å­˜ã¨ã‚²ãƒ¼ã‚¸ä¸å¤‰æ€§ãŒä¿è¨¼ã•ã‚Œã¾ã™ã€‚</p>
            </theorem>

            <div class="mermaid">
flowchart TD
    A[QED Lagrangian] --> B[Feynmanãƒ«ãƒ¼ãƒ«å°å‡º]
    B --> C[ãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«è¨ˆç®—]
    B --> D[1ãƒ«ãƒ¼ãƒ—è£œæ­£]
    D --> E[è‡ªå·±ã‚¨ãƒãƒ«ã‚®ãƒ¼<br/>Î£, Î ]
    D --> F[é ‚ç‚¹è£œæ­£<br/>Î“^Î¼]
    E --> G[è³ªé‡ãƒ»é›»è·ç¹°ã‚Šè¾¼ã¿]
    F --> G
    G --> H[Wardæ’ç­‰å¼ã«ã‚ˆã‚‹æ•´åˆæ€§]

    style A fill:#e3f2fd
    style G fill:#f3e5f5
    style H fill:#e8f5e9
            </div>

            <div class="code-title">Example 5: é ‚ç‚¹è£œæ­£ã®é‹å‹•å­¦çš„ä¾å­˜æ€§</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># é ‚ç‚¹è£œæ­£ã®ç°¡ç•¥ãƒ¢ãƒ‡ãƒ«</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">vertex_correction</span>(q2, m_e, alpha=<span class="number">1</span>/<span class="number">137</span>):
    <span class="string">"""1ãƒ«ãƒ¼ãƒ—é ‚ç‚¹è£œæ­£ï¼ˆç°¡ç•¥ç‰ˆï¼‰

    Î›^Î¼(p', p) = Î³^Î¼ Fâ‚(qÂ²) + ... (form factor)
    """</span>
    <span class="comment"># Fâ‚ã®1ãƒ«ãƒ¼ãƒ—è£œæ­£ï¼ˆè¿‘ä¼¼ï¼‰</span>
    F1 = <span class="number">1</span> + alpha / (<span class="number">2</span> * np.pi) * (
        np.log(np.abs(q2) / m_e**<span class="number">2</span> + <span class="number">1e-10</span>) / <span class="number">3</span>
    )

    <span class="keyword">return</span> F1

<span class="keyword">def</span> <span class="function">anomalous_magnetic_moment</span>(alpha=<span class="number">1</span>/<span class="number">137</span>):
    <span class="string">"""ç•°å¸¸ç£æ°—èƒ½ç‡ a_e = (g-2)/2

    1ãƒ«ãƒ¼ãƒ— Schwingeré …: Î±/(2Ï€)
    """</span>
    a_e_1loop = alpha / (<span class="number">2</span> * np.pi)

    <span class="keyword">return</span> a_e_1loop

<span class="comment"># é‹å‹•é‡ä¼é”ä¾å­˜æ€§</span>
q2_values = np.logspace(-<span class="number">2</span>, <span class="number">4</span>, <span class="number">50</span>)  <span class="comment"># MeVÂ²</span>
m_e = <span class="number">0.511</span>

F1_values = [vertex_correction(q2, m_e) <span class="keyword">for</span> q2 <span class="keyword">in</span> q2_values]

<span class="comment"># ç•°å¸¸ç£æ°—èƒ½ç‡</span>
a_e = anomalous_magnetic_moment()

<span class="function">print</span>(<span class="string">"é ‚ç‚¹è£œæ­£ã¨ç•°å¸¸ç£æ°—èƒ½ç‡:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"Form Factor Fâ‚(qÂ²=0): {F1_values[0]:.8f}"</span>)
<span class="function">print</span>(<span class="string">f"Form Factor Fâ‚(qÂ²=10 MeVÂ²): {vertex_correction(10, m_e):.8f}"</span>)
<span class="function">print</span>(<span class="string">f"\nç•°å¸¸ç£æ°—èƒ½ç‡ a_e (1ãƒ«ãƒ¼ãƒ—): {a_e:.10f}"</span>)
<span class="function">print</span>(<span class="string">f"å®Ÿé¨“å€¤ï¼ˆå‚è€ƒï¼‰: 0.0011596521811"</span>)</div>

            <div class="output">é ‚ç‚¹è£œï¿½ã¨ç•°å¸¸ç£æ°—èƒ½ç‡:
==================================================
Form Factor Fâ‚(qÂ²=0): 1.00000000
Form Factor Fâ‚(qÂ²=10 MeVÂ²): 1.00000845

ç•°å¸¸ç£æ°—èƒ½ç‡ a_e (1ãƒ«ãƒ¼ãƒ—): 0.0011614402
å®Ÿé¨“å€¤ï¼ˆå‚è€ƒï¼‰: 0.0011596521811</div>

            <h2>4.6 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨: RPAã¨èª˜é›»é–¢æ•°</h2>

            <p>
                Random Phase Approximation (RPA) ã¯å›ºä½“ç‰©ç†ã«ãŠã‘ã‚‹å¤šä½“åŠ¹æœã®åŸºæœ¬çš„è¿‘ä¼¼ã§ã™ã€‚
                Feynmanå›³å½¢ã®è¨€èªã§èª˜é›»é–¢æ•°ã‚’è¨˜è¿°ã—ã¾ã™ã€‚
            </p>

            <div class="example">
                <h3>ğŸ”¬ RPAã«ã‚ˆã‚‹èª˜é›»é–¢æ•°</h3>
                <p>é›»å­ã‚¬ã‚¹ã®èª˜é›»é–¢æ•°ï¼ˆLindhardé–¢æ•°ï¼‰:</p>
                <p>\[
                \epsilon(\mathbf{q}, \omega) = 1 - V(\mathbf{q}) \Pi(\mathbf{q}, \omega)
                \]</p>
                <p>\(\Pi\) ã¯é›»å­-æ­£å­”ãƒ«ãƒ¼ãƒ—ï¼ˆåæ¥µé–¢æ•°ï¼‰ã€\(V\) ã¯Coulombãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã§ã™ã€‚</p>
            </div>

            <div class="code-title">Example 6: Lindhardé–¢æ•°ã¨ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³åˆ†æ•£</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># RPAã«ã‚ˆã‚‹èª˜é›»é–¢æ•°ã¨ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">lindhard_function_static</span>(q, k_F, m_star=<span class="number">1.0</span>):
    <span class="string">"""Lindhardåæ¥µé–¢æ•°ï¼ˆé™çš„ã€Ï‰=0ï¼‰

    3æ¬¡å…ƒé›»å­ã‚¬ã‚¹
    """</span>
    q_TF = np.sqrt(<span class="number">4</span> * k_F / np.pi)  <span class="comment"># Thomas-Fermié®è”½æ³¢æ•°</span>

    <span class="keyword">if</span> q < <span class="number">2</span> * k_F:
        <span class="comment"># ç²’å­-æ­£å­”åŠ±èµ·é ˜åŸŸ</span>
        x = q / (<span class="number">2</span> * k_F)
        chi_0 = -m_star * k_F / (np.pi**<span class="number">2</span>) * (
            <span class="number">1</span> + (<span class="number">1</span> - x**<span class="number">2</span>) / (<span class="number">2</span> * x) * np.log(np.abs((<span class="number">1</span> + x) / (<span class="number">1</span> - x)))
        )
    <span class="keyword">else</span>:
        <span class="comment"># é«˜æ³¢æ•°é ˜åŸŸ</span>
        chi_0 = -m_star * k_F / (np.pi**<span class="number">2</span>)

    <span class="keyword">return</span> chi_0

<span class="keyword">def</span> <span class="function">dielectric_rpa</span>(q, omega, k_F, omega_p):
    <span class="string">"""RPAèª˜é›»é–¢æ•°ï¼ˆç°¡ç•¥ç‰ˆï¼‰"""</span>
    chi_0 = lindhard_function_static(q, k_F)

    <span class="comment"># RPA: Îµ = 1 - v_q Ï‡â‚€</span>
    v_q = <span class="number">4</span> * np.pi / (q**<span class="number">2</span> + <span class="number">1e-10</span>)  <span class="comment"># Coulombãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</span>

    epsilon = <span class="number">1</span> - v_q * chi_0

    <span class="keyword">return</span> epsilon

<span class="comment"># é‡‘å±ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ï¼‰</span>
r_s = <span class="number">2.07</span>  <span class="comment"># Wigner-SeitzåŠå¾„ï¼ˆBohrå˜ä½ï¼‰</span>
k_F = (<span class="number">9</span> * np.pi / <span class="number">4</span>)**(<span class="number">1</span>/<span class="number">3</span>) / r_s  <span class="comment"># Fermiæ³¢æ•°</span>
E_F = k_F**<span class="number">2</span> / <span class="number">2</span>  <span class="comment"># Fermiã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆåŸå­å˜ä½ï¼‰</span>
omega_p = np.sqrt(<span class="number">4</span> * np.pi * (<span class="number">3</span> / (<span class="number">4</span> * np.pi * r_s**<span class="number">3</span>)))  <span class="comment"># ãƒ—ãƒ©ã‚ºãƒå‘¨æ³¢æ•°</span>

q_array = np.linspace(<span class="number">0.01</span>, <span class="number">3</span> * k_F, <span class="number">100</span>)
epsilon_values = [dielectric_rpa(q, <span class="number">0</span>, k_F, omega_p) <span class="keyword">for</span> q <span class="keyword">in</span> q_array]

<span class="function">print</span>(<span class="string">"RPAã«ã‚ˆã‚‹é›»å­ã‚¬ã‚¹ã®èª˜é›»å¿œç­”:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"Fermiæ³¢æ•° k_F: {k_F:.4f} (a.u.)"</span>)
<span class="function">print</span>(<span class="string">f"ãƒ—ãƒ©ã‚ºãƒå‘¨æ³¢æ•° Ï‰_p: {omega_p:.4f} (a.u.)"</span>)
<span class="function">print</span>(<span class="string">f"\nèª˜é›»é–¢æ•° Îµ(q=0): {epsilon_values[0]:.4f}"</span>)
<span class="function">print</span>(<span class="string">f"èª˜é›»é–¢æ•° Îµ(q=k_F): {dielectric_rpa(k_F, 0, k_F, omega_p):.4f}"</span>)</div>

            <div class="output">RPAã«ã‚ˆã‚‹é›»å­ã‚¬ã‚¹ã®èª˜é›»å¿œç­”:
==================================================
Fermiæ³¢æ•° k_F: 0.9241 (a.u.)
ãƒ—ãƒ©ã‚ºãƒå‘¨æ³¢æ•° Ï‰_p: 1.1743 (a.u.)

èª˜é›»é–¢æ•° Îµ(q=0): 1.0000
èª˜é›»é–¢æ•° Îµ(q=k_F): 1.8562</div>

            <div class="code-title">Example 7: ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³åŠ±èµ·ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±é–¢æ•°</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±é–¢æ•° Im(-1/Îµ)</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">energy_loss_function</span>(q, omega, omega_p, gamma=<span class="number">0.01</span>):
    <span class="string">"""ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±é–¢æ•°ï¼ˆç°¡ç•¥Drudeãƒ¢ãƒ‡ãƒ«ï¼‰

    -Im(1/Îµ) ã§ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³ãƒ”ãƒ¼ã‚¯ã‚’è¦³æ¸¬
    """</span>
    epsilon = <span class="number">1</span> - omega_p**<span class="number">2</span> / (omega**<span class="number">2</span> + <span class="number">1j</span> * gamma * omega)

    loss = -epsilon.imag / (epsilon.real**<span class="number">2</span> + epsilon.imag**<span class="number">2</span>)

    <span class="keyword">return</span> loss

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</span>
omega_p = <span class="number">15.8</span>  <span class="comment"># eVï¼ˆã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ã®ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³ï¼‰</span>
gamma = <span class="number">0.5</span>    <span class="comment"># eVï¼ˆæ¸›è¡°ç‡ï¼‰</span>
q = <span class="number">0.1</span>       <span class="comment"># å°ã•ã„é‹å‹•é‡ä¼é”</span>

omega_array = np.linspace(<span class="number">0</span>, <span class="number">30</span>, <span class="number">300</span>)
loss_values = [energy_loss_function(q, om, omega_p, gamma) <span class="keyword">for</span> om <span class="keyword">in</span> omega_array]

<span class="comment"># ãƒ”ãƒ¼ã‚¯ä½ç½®</span>
peak_idx = np.argmax(loss_values)
omega_peak = omega_array[peak_idx]

<span class="function">print</span>(<span class="string">"ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³åŠ±èµ·ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"ãƒ—ãƒ©ã‚ºãƒå‘¨æ³¢æ•°: {omega_p} eV"</span>)
<span class="function">print</span>(<span class="string">f"æ¸›è¡°ç‡: {gamma} eV"</span>)
<span class="function">print</span>(<span class="string">f"\nãƒ—ãƒ©ã‚ºãƒ¢ãƒ³ãƒ”ãƒ¼ã‚¯ä½ç½®: {omega_peak:.2f} eV"</span>)
<span class="function">print</span>(<span class="string">f"ãƒ”ãƒ¼ã‚¯å¼·åº¦: {loss_values[peak_idx]:.4f}"</span>)</div>

            <div class="output">ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³åŠ±èµ·ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±:
==================================================
ãƒ—ãƒ©ã‚ºãƒå‘¨æ³¢æ•°: 15.8 eV
æ¸›è¡°ç‡: 0.5 eV

ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³ãƒ”ãƒ¼ã‚¯ä½ç½®: 15.80 eV
ãƒ”ãƒ¼ã‚¯å¼·åº¦: 62.4000</div>

            <div class="code-title">Example 8: FriedelæŒ¯å‹•ã¨é›»è·é®è”½</div>
            <div class="code-example"><span class="keyword">import</span> numpy <span class="keyword">as</span> np

<span class="comment"># ===================================</span>
<span class="comment"># FriedelæŒ¯å‹•ã«ã‚ˆã‚‹ç©ºé–“çš„é›»è·åˆ†å¸ƒ</span>
<span class="comment"># ===================================</span>

<span class="keyword">def</span> <span class="function">friedel_oscillation</span>(r, k_F, Z=<span class="number">1</span>):
    <span class="string">"""ä¸ç´”ç‰©å‘¨ã‚Šã®FriedelæŒ¯å‹•

    Ï(r) ~ -Z cos(2k_F r) / rÂ³
    """</span>
    <span class="keyword">if</span> r < <span class="number">0.1</span>:
        <span class="keyword">return</span> <span class="number">0.0</span>  <span class="comment"># æ­£å‰‡åŒ–</span>

    rho = -Z * np.cos(<span class="number">2</span> * k_F * r) / r**<span class="number">3</span>

    <span class="keyword">return</span> rho

<span class="keyword">def</span> <span class="function">thomas_fermi_screening</span>(r, q_TF, Z=<span class="number">1</span>):
    <span class="string">"""Thomas-Fermié®è”½

    V(r) = Z e^(-q_TF r) / r
    """</span>
    <span class="keyword">if</span> r < <span class="number">0.01</span>:
        <span class="keyword">return</span> Z / <span class="number">0.01</span>

    V = Z * np.exp(-q_TF * r) / r

    <span class="keyword">return</span> V

<span class="comment"># ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆéŠ…ï¼‰</span>
k_F = <span class="number">1.36</span>  <span class="comment"># Ã…â»Â¹</span>
q_TF = <span class="number">0.85</span> * k_F  <span class="comment"># Thomas-Fermiæ³¢æ•°</span>
Z = <span class="number">1</span>  <span class="comment"># ä¸ç´”ç‰©é›»è·</span>

r_array = np.linspace(<span class="number">0.1</span>, <span class="number">10</span>, <span class="number">200</span>)  <span class="comment"># Ã…</span>
rho_friedel = [friedel_oscillation(r, k_F, Z) <span class="keyword">for</span> r <span class="keyword">in</span> r_array]
V_TF = [thomas_fermi_screening(r, q_TF, Z) <span class="keyword">for</span> r <span class="keyword">in</span> r_array]

<span class="function">print</span>(<span class="string">"é›»è·é®è”½ã¨FriedelæŒ¯å‹•:"</span>)
<span class="function">print</span>(<span class="string">"=" * 50</span>)
<span class="function">print</span>(<span class="string">f"Fermiæ³¢æ•°: {k_F} Ã…â»Â¹"</span>)
<span class="function">print</span>(<span class="string">f"Thomas-Fermiæ³¢æ•°: {q_TF:.4f} Ã…â»Â¹"</span>)
<span class="function">print</span>(<span class="string">f"FriedelæŒ¯å‹•ã®æ³¢é•·: {np.pi/k_F:.4f} Ã…"</span>)
<span class="function">print</span>(<span class="string">f"\nV_TF(r=1Ã…): {thomas_fermi_screening(1.0, q_TF, Z):.4f}"</span>)
<span class="function">print</span>(<span class="string">f"V_TF(r=5Ã…): {thomas_fermi_screening(5.0, q_TF, Z):.4f}"</span>)</div>

            <div class="output">é›»è·é®è”½ã¨FriedelæŒ¯å‹•:
==================================================
Fermiæ³¢æ•°: 1.36 Ã…â»Â¹
Thomas-Fermiæ³¢æ•°: 1.1560 Ã…â»Â¹
FriedelæŒ¯å‹•ã®æ³¢é•·: 2.3091 Ã…

V_TF(r=1Ã…): 0.3166
V_TF(r=5Ã…): 0.0039</div>

            <h2>æ¼”ç¿’å•é¡Œ</h2>

            <div class="exercise">
                <h3>Easy</h3>
                <p><strong>Q1</strong>: Ï†â´ç†è«–ã§ã€2ç‚¹é–¢æ•°ã®ãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«ä¼æ’­é–¢æ•°ã‚’æ›¸ãä¸‹ã—ã€å¯¾ç§°å› å­ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>
                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p>ãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«ã§ã¯ç›¸äº’ä½œç”¨é ‚ç‚¹ãªã—ã€‚ä¼æ’­é–¢æ•°: \(\frac{i}{p^2 - m^2 + i\epsilon}\)</p>
                    <p>å¯¾ç§°å› å­ã¯1ï¼ˆäº¤æ›å¯¾ç§°æ€§ãªã—ï¼‰ã€‚</p>
                </details>
            </div>

            <div class="exercise">
                <h3>Medium</h3>
                <p><strong>Q2</strong>: QEDã§ã€é›»å­-é™½é›»å­æ¶ˆæ»… \(e^+e^- \to \mu^+\mu^-\) ã®ãƒ„ãƒªãƒ¼ãƒ¬ãƒ™ãƒ«æŒ¯å¹…ã‚’è¨ˆç®—ã—ã€è§’åº¦ä¾å­˜æ€§ã‚’ç¤ºã—ã¦ãã ã•ã„ã€‚</p>
                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p>\(|M|^2 = 2e^4(1 + \cos^2\theta)\)ï¼ˆs-channelå…‰å­äº¤æ›ï¼‰</p>
                    <p>å‰æ–¹ãƒ»å¾Œæ–¹ã§æœ€å¤§ã€æ¨ªæ–¹å‘ã§æœ€å°ã€‚</p>
                </details>
            </div>

            <div class="exercise">
                <h3>Hard</h3>
                <p><strong>Q3</strong>: RPAã§èª˜é›»é–¢æ•°ãŒã‚¼ãƒ­ã«ãªã‚‹æ¡ä»¶ï¼ˆãƒ—ãƒ©ã‚ºãƒ¢ãƒ³åˆ†æ•£é–¢ä¿‚ï¼‰ã‚’å°å‡ºã—ã¦ãã ã•ã„ã€‚</p>
                <details>
                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                    <p>\(\epsilon(\mathbf{q}, \omega) = 0\) ã‚ˆã‚Š \(1 = V(\mathbf{q})\Pi(\mathbf{q}, \omega)\)</p>
                    <p>é•·æ³¢é•·æ¥µé™ã§ \(\omega \approx \omega_p\)ï¼ˆãƒ—ãƒ©ã‚ºãƒå‘¨æ³¢æ•°ï¼‰ã€‚</p>
                </details>
            </div>

            <div class="nav-buttons">
                <a href="chapter-3.html" class="nav-button">â† ç¬¬3ç« </a>
                <a href="chapter-5.html" class="nav-button">ç¬¬5ç« ã¸é€²ã‚€ â†’</a>
            </div>

            <h2>å‚è€ƒæ–‡çŒ®</h2>
            <ol>
                <li>Peskin, M. E., & Schroeder, D. V. (1995). <em>An Introduction to Quantum Field Theory</em>. Westview Press.</li>
                <li>Srednicki, M. (2007). <em>Quantum Field Theory</em>. Cambridge University Press.</li>
                <li>Mahan, G. D. (2000). <em>Many-Particle Physics</em> (3rd ed.). Springer.</li>
                <li>Fetter, A. L., & Walecka, J. D. (2003). <em>Quantum Theory of Many-Particle Systems</em>. Dover.</li>
            </ol>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - Fundamentals of Mathematics & Physics Dojo</p>
        <p style="margin-top: 0.5rem;">Licensed under CC BY 4.0</p>
    </footer>

    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'base' });
    </script>
</body>
</html>
