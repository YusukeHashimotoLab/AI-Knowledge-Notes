<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« : æ³¢å‹•æ–¹ç¨‹å¼ã¨æŒ¯å‹•ç¾è±¡ | åå¾®åˆ†æ–¹ç¨‹å¼ã¨å¢ƒç•Œå€¤å•é¡Œ - FMé“å ´</title>
    <link rel="stylesheet" href="../../../assets/css/style.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>MathJax = {tex: {inlineMath: [['\(', '\)'], ['\\(', '\\)']], displayMath: [['\[', '\]'], ['\\[', '\\]']]}};</script>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <div class="site-logo"><a href="../../../index.html">ğŸ›ï¸ AIå¯ºå­å±‹</a></div>
                <nav class="main-nav">
                    <a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a>
                    <a href="../../index.html">çŸ¥è­˜ãƒ™ãƒ¼ã‚¹</a>
                    <a href="../index.html" class="active">FMé“å ´</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="chapter-page">
        <div class="container">
            <nav class="breadcrumb">
                <a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a> &gt;
                <a href="../index.html">FMé“å ´</a> &gt;
                <a href="index.html">åå¾®åˆ†æ–¹ç¨‹å¼ã¨å¢ƒç•Œå€¤å•é¡Œ</a> &gt;
                <span>ç¬¬1ç« </span>
            </nav>

            <article class="chapter-content">
                <div class="chapter-header">
                    <span class="chapter-label">ç¬¬1ç« </span>
                    <h1>æ³¢å‹•æ–¹ç¨‹å¼ã¨æŒ¯å‹•ç¾è±¡</h1>
                    <p class="chapter-subtitle">Wave Equation and Oscillations</p>
                    <div class="chapter-meta">
                        <span class="meta-item">â±ï¸ 20-24åˆ†</span>
                        <span class="meta-item">ğŸ’» 8ã‚³ãƒ¼ãƒ‰ä¾‹</span>
                        <span class="meta-item">ğŸ“Š ä¸­ç´š</span>
                    </div>
                </div>

                <section class="chapter-section">
                    <h2>1.1 æ³¢å‹•æ–¹ç¨‹å¼ã®å°å‡º</h2>
                    <p>
                        å¼¦ã®æŒ¯å‹•ã‹ã‚‰1æ¬¡å…ƒæ³¢å‹•æ–¹ç¨‹å¼ã‚’å°å‡ºã—ã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>1æ¬¡å…ƒæ³¢å‹•æ–¹ç¨‹å¼:</strong></p>
                        \[\frac{\partial^2 u}{\partial t^2} = c^2 \frac{\partial^2 u}{\partial x^2}\]
                        <p>ã“ã“ã§ \(u(x,t)\) ã¯å¤‰ä½ã€\(c\) ã¯æ³¢ã®ä¼æ’­é€Ÿåº¦</p>
                        <p><strong>å°å‡º:</strong> å¼µåŠ› \(T\) ã®å¼¦ã€ç·šå¯†åº¦ \(\rho\) ã®ã¨ã \(c = \sqrt{T/\rho}\)</p>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 1: æ³¢å‹•æ–¹ç¨‹å¼ã®æ•°å€¤ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæœ‰é™å·®åˆ†æ³•ï¼‰</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation
from IPython.display import HTML

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0  # å¼¦ã®é•·ã•
c = 1.0   # æ³¢ã®ä¼æ’­é€Ÿåº¦
T = 20.0  # æ™‚é–“ç¯„å›²
Nx = 200  # ç©ºé–“æ ¼å­ç‚¹æ•°
Nt = 1000 # æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—æ•°

# æ ¼å­
x = np.linspace(0, L, Nx)
t = np.linspace(0, T, Nt)
dx = x[1] - x[0]
dt = t[1] - t[0]

# CFLæ¡ä»¶ã®ç¢ºèª
r = c * dt / dx  # ã‚¯ãƒ¼ãƒ©ãƒ³ãƒˆæ•°
print(f"ã‚¯ãƒ¼ãƒ©ãƒ³ãƒˆæ•° r = {r:.3f} (å®‰å®šæ¡ä»¶: r â‰¤ 1)")

# åˆæœŸæ¡ä»¶: ä¸‰è§’æ³¢
def initial_displacement(x):
    u = np.zeros_like(x)
    peak = L / 2
    width = L / 5
    mask = np.abs(x - peak) < width
    u[mask] = 1 - np.abs(x[mask] - peak) / width
    return u

# åˆæœŸåŒ–
u = np.zeros((Nt, Nx))
u[0] = initial_displacement(x)
u[1] = u[0].copy()  # åˆé€Ÿåº¦=0

# æœ‰é™å·®åˆ†æ³•ï¼ˆé™½çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼‰
for n in range(1, Nt-1):
    for i in range(1, Nx-1):
        u[n+1, i] = (2*(1-r**2)*u[n, i] - u[n-1, i] + 
                     r**2*(u[n, i+1] + u[n, i-1]))
    
    # å¢ƒç•Œæ¡ä»¶: u(0,t) = u(L,t) = 0
    u[n+1, 0] = 0
    u[n+1, -1] = 0

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
times = [0, Nt//4, Nt//2, 3*Nt//4]
for idx, n in enumerate(times):
    ax = axes[idx//2, idx%2]
    ax.plot(x, u[n], 'b-', linewidth=2)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=12)
    ax.set_ylabel('å¤‰ä½ u(x,t)', fontsize=12)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.set_ylim(-1.2, 1.2)

plt.suptitle('æ³¢å‹•æ–¹ç¨‹å¼ã®æ•°å€¤è§£ï¼ˆæœ‰é™å·®åˆ†æ³•ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

# æ™‚ç©ºé–“ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(12, 6))
plt.contourf(x, t, u, levels=50, cmap='RdBu_r')
plt.colorbar(label='å¤‰ä½ u(x,t)')
plt.xlabel('ä½ç½® x', fontsize=12)
plt.ylabel('æ™‚é–“ t', fontsize=12)
plt.title('æ³¢å‹•ã®ä¼æ’­ï¼ˆæ™‚ç©ºé–“å›³ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

print("\næ³¢å‹•æ–¹ç¨‹å¼ã®æ€§è³ª:")
print("- æ³¢ã¯å·¦å³ã«ä¼æ’­ã—ã€å¢ƒç•Œã§åå°„")
print("- ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ä¿å­˜ã•ã‚Œã‚‹")
print(f"- ä¼æ’­é€Ÿåº¦: c = {c} m/s")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>1.2 ãƒ€ãƒ©ãƒ³ãƒ™ãƒ¼ãƒ«ã®è§£ï¼ˆé€²è¡Œæ³¢è§£ï¼‰</h2>
                    <p>
                        ç„¡é™é ˜åŸŸã§ã®æ³¢å‹•æ–¹ç¨‹å¼ã®ä¸€èˆ¬è§£ã¯ãƒ€ãƒ©ãƒ³ãƒ™ãƒ¼ãƒ«ã®å…¬å¼ã§è¡¨ã•ã‚Œã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ãƒ€ãƒ©ãƒ³ãƒ™ãƒ¼ãƒ«ã®è§£:</strong></p>
                        \[u(x,t) = f(x-ct) + g(x+ct)\]
                        <p>å·¦é€²è¡Œæ³¢ \(f(x-ct)\) ã¨å³é€²è¡Œæ³¢ \(g(x+ct)\) ã®é‡ã­åˆã‚ã›</p>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 2: ãƒ€ãƒ©ãƒ³ãƒ™ãƒ¼ãƒ«ã®è§£ã®å¯è¦–åŒ–</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
c = 1.0
x = np.linspace(-10, 10, 500)
t_values = np.linspace(0, 5, 6)

# åˆæœŸæ³¢å½¢
def f(xi):
    """å·¦é€²è¡Œæ³¢"""
    return np.exp(-xi**2)

def g(xi):
    """å³é€²è¡Œæ³¢"""
    return 0.5 * np.exp(-(xi-2)**2 / 0.5)

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 2, figsize=(14, 12))
axes = axes.flatten()

for idx, t in enumerate(t_values):
    ax = axes[idx]
    
    # ãƒ€ãƒ©ãƒ³ãƒ™ãƒ¼ãƒ«ã®è§£
    u_left = f(x - c*t)
    u_right = g(x + c*t)
    u_total = u_left + u_right
    
    ax.plot(x, u_left, 'b--', linewidth=1.5, alpha=0.7, label='å·¦é€²è¡Œæ³¢ f(x-ct)')
    ax.plot(x, u_right, 'r--', linewidth=1.5, alpha=0.7, label='å³é€²è¡Œæ³¢ g(x+ct)')
    ax.plot(x, u_total, 'k-', linewidth=2, label='å…¨æ³¢å½¢ u(x,t)')
    
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('å¤‰ä½ u', fontsize=11)
    ax.set_title(f't = {t:.2f}', fontsize=12)
    ax.set_ylim(-0.5, 1.5)
    ax.legend(fontsize=9)

plt.suptitle('ãƒ€ãƒ©ãƒ³ãƒ™ãƒ¼ãƒ«ã®è§£: é€²è¡Œæ³¢ã®é‡ã­åˆã‚ã›', fontsize=14)
plt.tight_layout()
plt.show()

print("=== ãƒ€ãƒ©ãƒ³ãƒ™ãƒ¼ãƒ«ã®è§£ã®æ€§è³ª ===")
print("- å·¦é€²è¡Œæ³¢: f(x-ct) ã¯é€Ÿåº¦ c ã§å³ã«ç§»å‹•")
print("- å³é€²è¡Œæ³¢: g(x+ct) ã¯é€Ÿåº¦ c ã§å·¦ã«ç§»å‹•")
print("- ç·åˆæ³¢å½¢: é‡ã­åˆã‚ã›ã®åŸç†ã«ã‚ˆã‚Š u = f + g")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>1.3 å¤‰æ•°åˆ†é›¢æ³•ã¨å›ºæœ‰å€¤å•é¡Œ</h2>
                    <p>
                        å¢ƒç•Œæ¡ä»¶ã®ã‚ã‚‹æ³¢å‹•æ–¹ç¨‹å¼ã‚’å¤‰æ•°åˆ†é›¢æ³•ã§è§£ãã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>å¤‰æ•°åˆ†é›¢:</strong> \(u(x,t) = X(x)T(t)\) ã¨ä»®å®šã™ã‚‹ã¨</p>
                        \[\frac{T''}{c^2 T} = \frac{X''}{X} = -\lambda\]
                        <p><strong>å›ºæœ‰å€¤å•é¡Œ:</strong> \(X'' + \lambda X = 0\) with \(X(0) = X(L) = 0\)</p>
                        \[\lambda_n = \left(\frac{n\pi}{L}\right)^2, \quad X_n(x) = \sin\frac{n\pi x}{L}\]
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 3: å¤‰æ•°åˆ†é›¢æ³•ã«ã‚ˆã‚‹è§£æè§£</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
c = 1.0
n_modes = 5

# ç©ºé–“ãƒ»æ™‚é–“ã‚°ãƒªãƒƒãƒ‰
x = np.linspace(0, L, 200)
t_values = np.linspace(0, 10, 100)

# å›ºæœ‰é–¢æ•°ã¨å›ºæœ‰å€¤
def eigenfunction(x, n, L):
    return np.sin(n * np.pi * x / L)

def eigenvalue(n, L, c):
    return (n * np.pi * c / L)**2

# åˆæœŸæ¡ä»¶ã‹ã‚‰ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°ã‚’è¨ˆç®—
def fourier_coefficients(initial_func, L, n_max):
    """åˆæœŸå¤‰ä½ã‹ã‚‰ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°ã‚’è¨ˆç®—"""
    coeffs = []
    for n in range(1, n_max+1):
        integrand = lambda x: initial_func(x) * eigenfunction(x, n, L)
        # æ•°å€¤ç©åˆ†
        x_int = np.linspace(0, L, 1000)
        y_int = integrand(x_int)
        c_n = (2/L) * np.trapz(y_int, x_int)
        coeffs.append(c_n)
    return coeffs

# åˆæœŸæ¡ä»¶: ä¸‰è§’æ³¢
def initial_shape(x):
    peak = L/2
    width = L/4
    u = np.zeros_like(x)
    mask = np.abs(x - peak) < width
    u[mask] = 1 - np.abs(x[mask] - peak) / width
    return u

# ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°ã®è¨ˆç®—
a_n = fourier_coefficients(initial_shape, L, n_modes)
print(f"ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°: {a_n}")

# å¯è¦–åŒ–: å›ºæœ‰ãƒ¢ãƒ¼ãƒ‰
fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

# å›ºæœ‰ãƒ¢ãƒ¼ãƒ‰
for n in range(1, 6):
    ax = axes[n-1]
    X_n = eigenfunction(x, n, L)
    omega_n = np.sqrt(eigenvalue(n, L, c))
    
    ax.plot(x, X_n, linewidth=2, label=f'Mode {n}')
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('\(X_n(x)\)', fontsize=11)
    ax.set_title(f'Mode {n}: \(\\omega_{{{n}}} = {omega_n:.2f}\)', fontsize=11)
    ax.legend()

# åˆæœŸå½¢çŠ¶ã¨ãƒ•ãƒ¼ãƒªã‚¨è¿‘ä¼¼
ax = axes[5]
ax.plot(x, initial_shape(x), 'b-', linewidth=2, label='åˆæœŸå½¢çŠ¶')

# ãƒ•ãƒ¼ãƒªã‚¨ç´šæ•°è¿‘ä¼¼
u_approx = np.zeros_like(x)
for n, a in enumerate(a_n, 1):
    u_approx += a * eigenfunction(x, n, L)
ax.plot(x, u_approx, 'r--', linewidth=2, label=f'ãƒ•ãƒ¼ãƒªã‚¨è¿‘ä¼¼ (N={n_modes})')

ax.grid(True, alpha=0.3)
ax.set_xlabel('ä½ç½® x', fontsize=11)
ax.set_ylabel('å¤‰ä½ u', fontsize=11)
ax.set_title('åˆæœŸå½¢çŠ¶ã¨ãƒ•ãƒ¼ãƒªã‚¨å±•é–‹', fontsize=11)
ax.legend()

plt.suptitle('å¤‰æ•°åˆ†é›¢æ³•: å›ºæœ‰ãƒ¢ãƒ¼ãƒ‰ã¨å›ºæœ‰æŒ¯å‹•æ•°', fontsize=14)
plt.tight_layout()
plt.show()

print("\nå›ºæœ‰å€¤ã¨å›ºæœ‰æŒ¯å‹•æ•°:")
for n in range(1, 6):
    lambda_n = eigenvalue(n, L, c)
    omega_n = np.sqrt(lambda_n)
    f_n = omega_n / (2 * np.pi)
    print(f"Mode {n}: Î»_{n} = {lambda_n:.3f}, Ï‰_{n} = {omega_n:.3f}, f_{n} = {f_n:.3f} Hz")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>1.4 å®šåœ¨æ³¢ã¨ãƒ•ãƒ¼ãƒªã‚¨ç´šæ•°è§£</h2>
                    <p>
                        å¤‰æ•°åˆ†é›¢è§£ã‚’ç”¨ã„ã¦ã€å®šåœ¨æ³¢ã‚’æ§‹æˆã—ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 4: å®šåœ¨æ³¢ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
c = 1.0
n_modes = 10

# ã‚°ãƒªãƒƒãƒ‰
x = np.linspace(0, L, 200)
t_values = np.linspace(0, 20, 100)

# ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°ï¼ˆå‰ã®ä¾‹ã‹ã‚‰ï¼‰
def initial_shape(x):
    peak = L/2
    width = L/4
    u = np.zeros_like(x)
    mask = np.abs(x - peak) < width
    u[mask] = 1 - np.abs(x[mask] - peak) / width
    return u

def fourier_coefficients(initial_func, L, n_max):
    coeffs = []
    for n in range(1, n_max+1):
        integrand = lambda x: initial_func(x) * np.sin(n * np.pi * x / L)
        x_int = np.linspace(0, L, 1000)
        y_int = integrand(x_int)
        c_n = (2/L) * np.trapz(y_int, x_int)
        coeffs.append(c_n)
    return coeffs

a_n = fourier_coefficients(initial_shape, L, n_modes)

# è§£ã®è¨ˆç®—
def wave_solution(x, t, L, c, a_n):
    u = np.zeros_like(x)
    for n, a in enumerate(a_n, 1):
        omega_n = n * np.pi * c / L
        u += a * np.sin(n * np.pi * x / L) * np.cos(omega_n * t)
    return u

# ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

snapshot_times = [0, 2, 4, 6, 8, 10]
for idx, t in enumerate(snapshot_times):
    ax = axes[idx]
    u = wave_solution(x, t, L, c, a_n)
    ax.plot(x, u, 'b-', linewidth=2)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('å¤‰ä½ u(x,t)', fontsize=11)
    ax.set_title(f't = {t:.1f}', fontsize=12)
    ax.set_ylim(-1.2, 1.2)

plt.suptitle('å®šåœ¨æ³¢ã®æ™‚é–“ç™ºå±•ï¼ˆãƒ•ãƒ¼ãƒªã‚¨ç´šæ•°è§£ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

# ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®è¨ˆç®—
def energy(x, t, L, c, a_n, dx):
    u = wave_solution(x, t, L, c, a_n)
    
    # é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ (âˆ‚u/âˆ‚t)Â²
    dt = 0.01
    u_plus = wave_solution(x, t+dt, L, c, a_n)
    u_minus = wave_solution(x, t-dt, L, c, a_n)
    du_dt = (u_plus - u_minus) / (2*dt)
    KE = 0.5 * np.trapz(du_dt**2, dx=dx)
    
    # ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼ cÂ²(âˆ‚u/âˆ‚x)Â²
    du_dx = np.gradient(u, dx)
    PE = 0.5 * c**2 * np.trapz(du_dx**2, dx=dx)
    
    return KE, PE

# ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®æ™‚é–“å¤‰åŒ–
dx = x[1] - x[0]
energies = [energy(x, t, L, c, a_n, dx) for t in t_values]
KE_arr = [e[0] for e in energies]
PE_arr = [e[1] for e in energies]
E_total = [ke + pe for ke, pe in zip(KE_arr, PE_arr)]

plt.figure(figsize=(10, 6))
plt.plot(t_values, KE_arr, 'b-', linewidth=2, label='é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼')
plt.plot(t_values, PE_arr, 'r-', linewidth=2, label='ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼')
plt.plot(t_values, E_total, 'k--', linewidth=2, label='å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼')
plt.grid(True, alpha=0.3)
plt.xlabel('æ™‚é–“ t', fontsize=12)
plt.ylabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼', fontsize=12)
plt.title('å®šåœ¨æ³¢ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜', fontsize=14)
plt.legend()
plt.tight_layout()
plt.show()

print("ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®æ¤œè¨¼:")
print(f"åˆæœŸã‚¨ãƒãƒ«ã‚®ãƒ¼: {E_total[0]:.6f}")
print(f"æœ€çµ‚ã‚¨ãƒãƒ«ã‚®ãƒ¼: {E_total[-1]:.6f}")
print(f"ç›¸å¯¾èª¤å·®: {abs(E_total[-1] - E_total[0])/E_total[0]:.2e}")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>1.5 åˆæœŸå€¤å•é¡Œã®è§£</h2>
                    <p>
                        ä¸€èˆ¬çš„ãªåˆæœŸæ¡ä»¶ï¼ˆåˆæœŸå¤‰ä½ã¨åˆé€Ÿåº¦ï¼‰ã‹ã‚‰ã®è§£ã‚’æ§‹æˆã—ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 5: åˆæœŸå€¤å•é¡Œã®ä¸€èˆ¬è§£</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
c = 1.0
n_modes = 20

x = np.linspace(0, L, 200)

# åˆæœŸæ¡ä»¶
def initial_displacement(x):
    """åˆæœŸå¤‰ä½"""
    return np.sin(np.pi * x / L) + 0.5 * np.sin(3 * np.pi * x / L)

def initial_velocity(x):
    """åˆæœŸé€Ÿåº¦"""
    return 0.5 * np.sin(2 * np.pi * x / L)

# ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•° a_n (åˆæœŸå¤‰ä½ã‹ã‚‰)
def compute_a_n(f, L, n_max):
    coeffs = []
    for n in range(1, n_max+1):
        x_int = np.linspace(0, L, 1000)
        integrand = f(x_int) * np.sin(n * np.pi * x_int / L)
        c_n = (2/L) * np.trapz(integrand, x_int)
        coeffs.append(c_n)
    return coeffs

# ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•° b_n (åˆé€Ÿåº¦ã‹ã‚‰)
def compute_b_n(g, L, c, n_max):
    coeffs = []
    for n in range(1, n_max+1):
        omega_n = n * np.pi * c / L
        x_int = np.linspace(0, L, 1000)
        integrand = g(x_int) * np.sin(n * np.pi * x_int / L)
        b_n = (2/(L * omega_n)) * np.trapz(integrand, x_int)
        coeffs.append(b_n)
    return coeffs

a_n = compute_a_n(initial_displacement, L, n_modes)
b_n = compute_b_n(initial_velocity, L, c, n_modes)

print(f"a_n (åˆæœŸå¤‰ä½): {a_n[:5]}")
print(f"b_n (åˆé€Ÿåº¦): {b_n[:5]}")

# ä¸€èˆ¬è§£
def general_solution(x, t, L, c, a_n, b_n):
    u = np.zeros_like(x)
    for n in range(len(a_n)):
        omega_n = (n+1) * np.pi * c / L
        X_n = np.sin((n+1) * np.pi * x / L)
        u += X_n * (a_n[n] * np.cos(omega_n * t) + b_n[n] * np.sin(omega_n * t))
    return u

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

times = [0, 1, 2, 3, 4, 5]
for idx, t in enumerate(times):
    ax = axes[idx]
    u = general_solution(x, t, L, c, a_n, b_n)
    ax.plot(x, u, 'b-', linewidth=2)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('å¤‰ä½ u(x,t)', fontsize=11)
    ax.set_title(f't = {t:.1f}', fontsize=12)
    ax.set_ylim(-2, 2)

plt.suptitle('åˆæœŸå€¤å•é¡Œã®ä¸€èˆ¬è§£ï¼ˆåˆæœŸå¤‰ä½ + åˆé€Ÿåº¦ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

print("\nä¸€èˆ¬è§£ã®å½¢:")
print("u(x,t) = Î£ sin(nÏ€x/L) [a_n cos(Ï‰_n t) + b_n sin(Ï‰_n t)]")
print("a_n: åˆæœŸå¤‰ä½ã‹ã‚‰æ±ºå®š")
print("b_n: åˆé€Ÿåº¦ã‹ã‚‰æ±ºå®š")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>1.6 2æ¬¡å…ƒæ³¢å‹•æ–¹ç¨‹å¼ï¼ˆè†œã®æŒ¯å‹•ï¼‰</h2>
                    <p>
                        é•·æ–¹å½¢è†œã®æŒ¯å‹•ã‚’2æ¬¡å…ƒæ³¢å‹•æ–¹ç¨‹å¼ã§è§£ãã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>2æ¬¡å…ƒæ³¢å‹•æ–¹ç¨‹å¼:</strong></p>
                        \[\frac{\partial^2 u}{\partial t^2} = c^2 \left(\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}\right)\]
                        <p><strong>å›ºæœ‰å€¤:</strong> \(\omega_{mn} = c\pi\sqrt{\frac{m^2}{L_x^2} + \frac{n^2}{L_y^2}}\)</p>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 6: 2æ¬¡å…ƒè†œã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from matplotlib import cm

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
Lx, Ly = 10.0, 8.0
c = 1.0

# ã‚°ãƒªãƒƒãƒ‰
x = np.linspace(0, Lx, 100)
y = np.linspace(0, Ly, 80)
X, Y = np.meshgrid(x, y)

# å›ºæœ‰ãƒ¢ãƒ¼ãƒ‰
def eigenmode_2d(x, y, m, n, Lx, Ly):
    return np.sin(m * np.pi * x / Lx) * np.sin(n * np.pi * y / Ly)

def eigenfrequency_2d(m, n, Lx, Ly, c):
    return c * np.pi * np.sqrt((m/Lx)**2 + (n/Ly)**2)

# æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰
modes = [(1,1), (2,1), (1,2), (2,2), (3,1), (1,3)]

fig = plt.figure(figsize=(16, 10))

for idx, (m, n) in enumerate(modes, 1):
    omega_mn = eigenfrequency_2d(m, n, Lx, Ly, c)
    
    # å›ºæœ‰ãƒ¢ãƒ¼ãƒ‰
    U = eigenmode_2d(X, Y, m, n, Lx, Ly)
    
    # 3Dãƒ—ãƒ­ãƒƒãƒˆ
    ax = fig.add_subplot(2, 3, idx, projection='3d')
    surf = ax.plot_surface(X, Y, U, cmap=cm.coolwarm, alpha=0.9)
    
    ax.set_xlabel('x', fontsize=10)
    ax.set_ylabel('y', fontsize=10)
    ax.set_zlabel('u', fontsize=10)
    ax.set_title(f'Mode ({m},{n}): \(\\omega_{{{m}{n}}} = {omega_mn:.2f}\)', fontsize=11)
    ax.set_zlim(-1, 1)

plt.suptitle('é•·æ–¹å½¢è†œã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰', fontsize=14)
plt.tight_layout()
plt.show()

# å›ºæœ‰æŒ¯å‹•æ•°ã®ãƒ†ãƒ¼ãƒ–ãƒ«
print("=== 2æ¬¡å…ƒè†œã®å›ºæœ‰æŒ¯å‹•æ•° ===")
print("Mode (m,n) | Ï‰_mn")
print("-" * 30)
for m, n in modes:
    omega = eigenfrequency_2d(m, n, Lx, Ly, c)
    print(f"  ({m},{n})    | {omega:.3f}")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>1.7 æ¸›è¡°ã¨å¼·åˆ¶æŒ¯å‹•</h2>
                    <p>
                        æ¸›è¡°é …ã¨å¤–åŠ›ã‚’å«ã‚€æ³¢å‹•æ–¹ç¨‹å¼ã‚’è€ƒãˆã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 7: æ¸›è¡°æŒ¯å‹•ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# æ¸›è¡°æ³¢å‹•æ–¹ç¨‹å¼: u_tt + 2Î³u_t = cÂ²u_xx
# Î³: æ¸›è¡°ä¿‚æ•°

L = 10.0
c = 1.0
gamma = 0.1  # æ¸›è¡°ä¿‚æ•°
T = 30.0
Nx = 200
Nt = 1500

x = np.linspace(0, L, Nx)
t = np.linspace(0, T, Nt)
dx = x[1] - x[0]
dt = t[1] - t[0]

# åˆæœŸæ¡ä»¶
u = np.zeros((Nt, Nx))
u[0] = np.sin(np.pi * x / L)
u[1] = u[0] * (1 - 2*gamma*dt)  # åˆé€Ÿåº¦ = -2Î³u_0

# æœ‰é™å·®åˆ†æ³•ï¼ˆæ¸›è¡°é …ä»˜ãï¼‰
r = c * dt / dx
for n in range(1, Nt-1):
    for i in range(1, Nx-1):
        u[n+1, i] = ((2 - 2*r**2 - 4*gamma*dt)*u[n, i] - (1 - 2*gamma*dt)*u[n-1, i] +
                     r**2*(u[n, i+1] + u[n, i-1])) / (1 + 2*gamma*dt)
    
    u[n+1, 0] = 0
    u[n+1, -1] = 0

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
times_idx = [0, Nt//4, Nt//2, 3*Nt//4]
for idx, n in enumerate(times_idx):
    ax = axes[idx//2, idx%2]
    ax.plot(x, u[n], 'b-', linewidth=2)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('å¤‰ä½ u(x,t)', fontsize=11)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.set_ylim(-1.2, 1.2)

plt.suptitle(f'æ¸›è¡°æŒ¯å‹•ï¼ˆæ¸›è¡°ä¿‚æ•° Î³={gamma}ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

# æŒ¯å¹…ã®æ¸›è¡°
amplitude = [np.max(np.abs(u[n])) for n in range(Nt)]

plt.figure(figsize=(10, 6))
plt.plot(t, amplitude, 'b-', linewidth=2)
plt.plot(t, amplitude[0] * np.exp(-gamma * t), 'r--', linewidth=2, label=f'ç†è«–æ¸›è¡° \(e^{{-\\gamma t}}\)')
plt.grid(True, alpha=0.3)
plt.xlabel('æ™‚é–“ t', fontsize=12)
plt.ylabel('æŒ¯å¹…', fontsize=12)
plt.title('æŒ¯å¹…ã®æ™‚é–“æ¸›è¡°', fontsize=14)
plt.legend()
plt.tight_layout()
plt.show()

print(f"æ¸›è¡°ä¿‚æ•°: Î³ = {gamma}")
print(f"æ¸›è¡°æ™‚å®šæ•°: Ï„ = 1/Î³ = {1/gamma:.2f}")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>1.8 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨: è¶…éŸ³æ³¢æ¢å‚·</h2>
                    <p>
                        è¶…éŸ³æ³¢ã‚’ä½¿ã£ãŸææ–™ã®éç ´å£Šæ¤œæŸ»ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 8: è¶…éŸ³æ³¢ãƒ‘ãƒ«ã‚¹ã®åå°„ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ææ–™ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L1 = 50.0  # ææ–™1ã®åšã• (mm)
L2 = 30.0  # ææ–™2ã®åšã• (mm)
c1 = 5.9   # ææ–™1ã®éŸ³é€Ÿ (mm/Î¼s) - é‹¼
c2 = 3.2   # ææ–™2ã®éŸ³é€Ÿ (mm/Î¼s) - ã‚¢ãƒ«ãƒŸ
Z1 = 45.0  # ææ–™1ã®éŸ³éŸ¿ã‚¤ãƒ³ãƒ”ãƒ¼ãƒ€ãƒ³ã‚¹
Z2 = 17.0  # ææ–™2ã®éŸ³éŸ¿ã‚¤ãƒ³ãƒ”ãƒ¼ãƒ€ãƒ³ã‚¹

# åå°„ç‡ã¨é€éç‡
R = (Z2 - Z1) / (Z2 + Z1)  # åå°„ç‡
T = 2 * Z2 / (Z2 + Z1)     # é€éç‡

print(f"ç•Œé¢ã§ã®åå°„ç‡: R = {R:.3f}")
print(f"ç•Œé¢ã§ã®é€éç‡: T = {T:.3f}")

# ã‚°ãƒªãƒƒãƒ‰
L_total = L1 + L2 + 50  # è¿½åŠ ã®ç©ºé–“
Nx = 500
Nt = 1000
x = np.linspace(0, L_total, Nx)
dx = x[1] - x[0]

# å¯å¤‰éŸ³é€Ÿ
c = np.ones(Nx) * c1
interface_idx = int(L1 / L_total * Nx)
c[interface_idx:] = c2

# æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆæœ€å°éŸ³é€Ÿã§CFLæ¡ä»¶ï¼‰
dt = 0.5 * dx / np.max(c)
t = np.arange(Nt) * dt

# åˆæœŸãƒ‘ãƒ«ã‚¹ï¼ˆã‚¬ã‚¦ã‚·ã‚¢ãƒ³ï¼‰
u = np.zeros((Nt, Nx))
pulse_center = L1 / 4
pulse_width = 5.0
u[0] = np.exp(-((x - pulse_center)/pulse_width)**2)

# æ³¢å‹•ä¼æ’­ï¼ˆå¯å¤‰éŸ³é€Ÿï¼‰
for n in range(Nt-1):
    for i in range(1, Nx-1):
        r_local = c[i] * dt / dx
        u[n+1, i] = 2*(1-r_local**2)*u[n, i] - u[n-1, i] + r_local**2*(u[n, i+1] + u[n, i-1])
    
    # å¢ƒç•Œæ¡ä»¶
    u[n+1, 0] = 0
    u[n+1, -1] = 0
    
    # ç•Œé¢ã§ã®å‡¦ç†ï¼ˆç°¡æ˜“ãƒ¢ãƒ‡ãƒ«ï¼‰
    # å®Ÿéš›ã«ã¯ã‚ˆã‚Šç²¾å¯†ãªå¢ƒç•Œæ¡ä»¶ãŒå¿…è¦

# å¯è¦–åŒ–
fig, axes = plt.subplots(3, 2, figsize=(14, 12))
axes = axes.flatten()

snapshot_times = [50, 150, 250, 350, 450, 550]
for idx, n in enumerate(snapshot_times):
    if n >= Nt:
        continue
    ax = axes[idx]
    ax.plot(x, u[n], 'b-', linewidth=1.5)
    ax.axvline(L1, color='red', linestyle='--', linewidth=2, alpha=0.7, label='ç•Œé¢')
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.fill_between([0, L1], -1, 1, alpha=0.1, color='blue', label='ææ–™1 (é‹¼)')
    ax.fill_between([L1, L1+L2], -1, 1, alpha=0.1, color='green', label='ææ–™2 (Al)')
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x (mm)', fontsize=11)
    ax.set_ylabel('æŒ¯å¹…', fontsize=11)
    ax.set_title(f't = {t[n]:.2f} Î¼s', fontsize=12)
    ax.set_ylim(-0.5, 1.2)
    if idx == 0:
        ax.legend()

plt.suptitle('è¶…éŸ³æ³¢ãƒ‘ãƒ«ã‚¹ã®ä¼æ’­ã¨ç•Œé¢åå°„', fontsize=14)
plt.tight_layout()
plt.show()

print("\nè¶…éŸ³æ³¢æ¢å‚·ã®åŸç†:")
print("- è¶…éŸ³æ³¢ãƒ‘ãƒ«ã‚¹ã‚’ææ–™ã«å…¥å°„")
print("- ç•Œé¢ã‚„æ¬ é™¥ã§åå°„")
print("- åå°„æ³¢ã®åˆ°é”æ™‚é–“ã‹ã‚‰æ¬ é™¥ä½ç½®ã‚’ç‰¹å®š")
print(f"- ææ–™1ã®éŸ³é€Ÿ: {c1} mm/Î¼s")
print(f"- ææ–™2ã®éŸ³é€Ÿ: {c2} mm/Î¼s")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>ğŸ“ ç« æœ«å•é¡Œ</h2>
                    <div class="exercise-box">
                        <h4>æ¼”ç¿’å•é¡Œ</h4>
                        <ol>
                            <li>é•·ã• \(L=5\) mã€æ³¢é€Ÿ \(c=2\) m/sã®å¼¦ã§ã€åŸºæœ¬æŒ¯å‹•ã®å‘¨æœŸã‚’æ±‚ã‚ã‚ˆã€‚</li>
                            <li>åˆæœŸå½¢çŠ¶ \(u(x,0) = \sin(\pi x/L)\)ã€åˆé€Ÿåº¦ \(u_t(x,0) = 0\) ã®å ´åˆã®è§£ã‚’ãƒ•ãƒ¼ãƒªã‚¨ç´šæ•°ã§è¡¨ã›ã€‚</li>
                            <li>2æ¬¡å…ƒæ­£æ–¹å½¢è†œï¼ˆ\(L_x = L_y = L\)ï¼‰ã§ã€æœ€ä½3ã¤ã®å›ºæœ‰æŒ¯å‹•æ•°ã‚’æ±‚ã‚ã‚ˆã€‚</li>
                            <li>æ¸›è¡°ä¿‚æ•° \(\gamma\) ãŒå¤§ãã„ã¨ãã€æŒ¯å‹•ã¯ã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹æ•°å€¤å®Ÿé¨“ã§ç¢ºèªã›ã‚ˆã€‚</li>
                        </ol>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>ğŸ”— å‚è€ƒæ–‡çŒ®</h2>
                    <ul class="reference-list">
                        <li>Strauss, W. A. (2007). <em>Partial Differential Equations: An Introduction</em>. Wiley.</li>
                        <li>Haberman, R. (2012). <em>Applied Partial Differential Equations</em>. Pearson.</li>
                    </ul>
                </section>
            </article>

            <nav class="chapter-navigation">
                <a href="index.html" class="btn btn-secondary">â† ã‚·ãƒªãƒ¼ã‚ºãƒˆãƒƒãƒ—ã¸</a>
                <a href="chapter-2.html" class="btn btn-primary">ç¬¬2ç« ã¸ â†’</a>
            </nav>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 AI Terakoya. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
