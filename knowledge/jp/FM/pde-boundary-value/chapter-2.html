<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : ç†±ä¼å°æ–¹ç¨‹å¼ã¨æ‹¡æ•£ç¾è±¡ | åå¾®åˆ†æ–¹ç¨‹å¼ã¨å¢ƒç•Œå€¤å•é¡Œ - FMé“å ´</title>
    <link rel="stylesheet" href="../../../assets/css/style.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>MathJax = {tex: {inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']]}};</script>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <div class="site-logo"><a href="../../../index.html">ğŸ›ï¸ AIå¯ºå­å±‹</a></div>
                <nav class="main-nav">
                    <a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a>
                    <a href="../../index.html">çŸ¥è­˜ãƒ™ãƒ¼ã‚¹</a>
                    <a href="../index.html" class="active">FMé“å ´</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="chapter-page">
        <div class="container">
            <nav class="breadcrumb">
                <a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a> &gt;
                <a href="../index.html">FMé“å ´</a> &gt;
                <a href="index.html">åå¾®åˆ†æ–¹ç¨‹å¼ã¨å¢ƒç•Œå€¤å•é¡Œ</a> &gt;
                <span>ç¬¬2ç« </span>
            </nav>

            <article class="chapter-content">
                <div class="chapter-header">
                    <span class="chapter-label">ç¬¬2ç« </span>
                    <h1>ç†±ä¼å°æ–¹ç¨‹å¼ã¨æ‹¡æ•£ç¾è±¡</h1>
                    <p class="chapter-subtitle">Heat Equation and Diffusion</p>
                    <div class="chapter-meta">
                        <span class="meta-item">â±ï¸ 20-24åˆ†</span>
                        <span class="meta-item">ğŸ’» 8ã‚³ãƒ¼ãƒ‰ä¾‹</span>
                        <span class="meta-item">ğŸ“Š ä¸­ç´š</span>
                    </div>
                </div>

                <section class="chapter-section">
                    <h2>2.1 ç†±ä¼å°æ–¹ç¨‹å¼ã®å°å‡º</h2>
                    <p>
                        ãƒ•ãƒ¼ãƒªã‚¨ã®ç†±ä¼å°æ³•å‰‡ã‹ã‚‰æ‹¡æ•£æ–¹ç¨‹å¼ã‚’å°å‡ºã—ã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ç†±ä¼å°æ–¹ç¨‹å¼ï¼ˆæ‹¡æ•£æ–¹ç¨‹å¼ï¼‰:</strong></p>
                        $$\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}$$
                        <p>ã“ã“ã§ $u(x,t)$ ã¯æ¸©åº¦ã€$\alpha = k/(\rho c_p)$ ã¯ç†±æ‹¡æ•£ç‡</p>
                        <p>$k$: ç†±ä¼å°ç‡ã€$\rho$: å¯†åº¦ã€$c_p$: æ¯”ç†±</p>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 1: ç†±ä¼å°æ–¹ç¨‹å¼ã®æ•°å€¤è§£ï¼ˆé™½çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼‰</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0  # æ£’ã®é•·ã•
alpha = 0.1  # ç†±æ‹¡æ•£ç‡
T_total = 10.0
Nx = 100
Nt = 2000

x = np.linspace(0, L, Nx)
t = np.linspace(0, T_total, Nt)
dx = x[1] - x[0]
dt = t[1] - t[0]

# å®‰å®šæ€§æ¡ä»¶ã®ç¢ºèª
r = alpha * dt / dx**2
print(f"å®‰å®šæ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ r = {r:.4f} (å®‰å®šæ¡ä»¶: r â‰¤ 0.5)")

# åˆæœŸæ¡ä»¶: ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°
u = np.zeros((Nt, Nx))
u[0, Nx//4:3*Nx//4] = 100.0

# å¢ƒç•Œæ¡ä»¶: u(0,t) = u(L,t) = 0
# é™½çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼ˆFTCS: Forward Time Central Spaceï¼‰
for n in range(Nt-1):
    for i in range(1, Nx-1):
        u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])
    
    u[n+1, 0] = 0
    u[n+1, -1] = 0

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))
axes = axes.flatten()

times_idx = [0, Nt//10, Nt//3, Nt-1]
for idx, n in enumerate(times_idx):
    ax = axes[idx]
    ax.plot(x, u[n], 'b-', linewidth=2)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=12)
    ax.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=12)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.set_ylim(-10, 110)

plt.suptitle('ç†±ä¼å°æ–¹ç¨‹å¼ã®æ•°å€¤è§£ï¼ˆé™½çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

# æ™‚ç©ºé–“ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(12, 6))
plt.contourf(x, t, u, levels=50, cmap='hot')
plt.colorbar(label='æ¸©åº¦ u(x,t)')
plt.xlabel('ä½ç½® x', fontsize=12)
plt.ylabel('æ™‚é–“ t', fontsize=12)
plt.title('ç†±æ‹¡æ•£ã®æ™‚ç©ºé–“å›³', fontsize=14)
plt.tight_layout()
plt.show()

print("\nç†±ä¼å°æ–¹ç¨‹å¼ã®æ€§è³ª:")
print("- ç†±ã¯é«˜æ¸©ã‹ã‚‰ä½æ¸©ã¸æ‹¡æ•£")
print("- æ™‚é–“ã¨ã¨ã‚‚ã«æ¸©åº¦åˆ†å¸ƒã¯æ»‘ã‚‰ã‹ã«ãªã‚‹")
print("- ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¯å¢—å¤§ï¼ˆä¸å¯é€†éç¨‹ï¼‰")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.2 åŸºæœ¬è§£ï¼ˆã‚¬ã‚¦ã‚¹æ ¸ï¼‰</h2>
                    <p>
                        ç„¡é™é ˜åŸŸã§ã®ç†±ä¼å°æ–¹ç¨‹å¼ã®åŸºæœ¬è§£ã‚’å­¦ã³ã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>åŸºæœ¬è§£ï¼ˆã‚¬ã‚¦ã‚¹æ ¸ï¼‰:</strong></p>
                        $$G(x,t) = \frac{1}{\sqrt{4\pi\alpha t}} e^{-x^2/(4\alpha t)}$$
                        <p><strong>ç•³ã¿è¾¼ã¿ã«ã‚ˆã‚‹ä¸€èˆ¬è§£:</strong></p>
                        $$u(x,t) = \int_{-\infty}^{\infty} G(x-\xi, t) f(\xi) d\xi$$
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 2: åŸºæœ¬è§£ï¼ˆã‚¬ã‚¦ã‚¹æ ¸ï¼‰ã®å¯è¦–åŒ–</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
alpha = 0.1
x = np.linspace(-10, 10, 500)

# åŸºæœ¬è§£
def fundamental_solution(x, t, alpha):
    if t <= 0:
        return np.zeros_like(x)
    return (1/np.sqrt(4*np.pi*alpha*t)) * np.exp(-x**2 / (4*alpha*t))

# æ™‚é–“ç™ºå±•
t_values = [0.1, 0.5, 1.0, 2.0, 5.0]

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# åŸºæœ¬è§£ã®æ™‚é–“ç™ºå±•
for t in t_values:
    G = fundamental_solution(x, t, alpha)
    ax1.plot(x, G, linewidth=2, label=f't = {t}')

ax1.grid(True, alpha=0.3)
ax1.set_xlabel('ä½ç½® x', fontsize=12)
ax1.set_ylabel('G(x,t)', fontsize=12)
ax1.set_title('åŸºæœ¬è§£ï¼ˆã‚¬ã‚¦ã‚¹æ ¸ï¼‰ã®æ™‚é–“ç™ºå±•', fontsize=14)
ax1.legend()

# ç•³ã¿è¾¼ã¿ã«ã‚ˆã‚‹ä¸€èˆ¬è§£
# åˆæœŸæ¡ä»¶: ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°
def initial_condition(x):
    return np.where(np.abs(x) < 1, 1.0, 0.0)

# ç•³ã¿è¾¼ã¿
def convolution_solution(x, t, alpha, f):
    xi = np.linspace(-20, 20, 1000)
    dxi = xi[1] - xi[0]
    u = np.zeros_like(x)
    
    for i, x_val in enumerate(x):
        G = fundamental_solution(x_val - xi, t, alpha)
        integrand = G * f(xi)
        u[i] = np.trapz(integrand, dx=dxi)
    
    return u

# ç•°ãªã‚‹æ™‚åˆ»ã§ã®è§£
for t in [0.5, 1.0, 2.0, 5.0]:
    u = convolution_solution(x, t, alpha, initial_condition)
    ax2.plot(x, u, linewidth=2, label=f't = {t}')

# åˆæœŸæ¡ä»¶
ax2.plot(x, initial_condition(x), 'k--', linewidth=2, alpha=0.5, label='åˆæœŸæ¡ä»¶')

ax2.grid(True, alpha=0.3)
ax2.set_xlabel('ä½ç½® x', fontsize=12)
ax2.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=12)
ax2.set_title('ç•³ã¿è¾¼ã¿ã«ã‚ˆã‚‹ä¸€èˆ¬è§£', fontsize=14)
ax2.legend()

plt.tight_layout()
plt.show()

print("=== åŸºæœ¬è§£ã®æ€§è³ª ===")
print("- è³ªé‡ä¿å­˜: âˆ«G(x,t)dx = 1")
print("- æ™‚é–“ã¨ã¨ã‚‚ã«åºƒãŒã‚‹ï¼ˆæ‹¡æ•£ï¼‰")
print("- tâ†’0 ã§ãƒ‡ãƒ«ã‚¿é–¢æ•°ã«è¿‘ã¥ã")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.3 å¤‰æ•°åˆ†é›¢æ³•ã«ã‚ˆã‚‹å¢ƒç•Œå€¤å•é¡Œ</h2>
                    <p>
                        æœ‰é™é ˜åŸŸã§ã®ç†±ä¼å°æ–¹ç¨‹å¼ã‚’å¤‰æ•°åˆ†é›¢æ³•ã§è§£ãã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 3: å¤‰æ•°åˆ†é›¢è§£ã¨ãƒ•ãƒ¼ãƒªã‚¨ç´šæ•°</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
alpha = 0.1
n_modes = 20

x = np.linspace(0, L, 200)

# åˆæœŸæ¡ä»¶
def initial_temp(x):
    return 100 * np.sin(np.pi * x / L) + 50 * np.sin(2 * np.pi * x / L)

# ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°
def compute_fourier_coeff(f, L, n_max):
    coeffs = []
    for n in range(1, n_max+1):
        x_int = np.linspace(0, L, 1000)
        integrand = f(x_int) * np.sin(n * np.pi * x_int / L)
        c_n = (2/L) * np.trapz(integrand, x_int)
        coeffs.append(c_n)
    return coeffs

c_n = compute_fourier_coeff(initial_temp, L, n_modes)
print(f"ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•° c_n: {c_n[:5]}")

# å¤‰æ•°åˆ†é›¢è§£
def separation_solution(x, t, L, alpha, c_n):
    u = np.zeros_like(x)
    for n, c in enumerate(c_n, 1):
        lambda_n = (n * np.pi / L)**2
        u += c * np.sin(n * np.pi * x / L) * np.exp(-alpha * lambda_n * t)
    return u

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

times = [0, 1, 2, 5, 10, 20]
for idx, t in enumerate(times):
    ax = axes[idx]
    u = separation_solution(x, t, L, alpha, c_n)
    ax.plot(x, u, 'b-', linewidth=2)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=11)
    ax.set_title(f't = {t:.1f}', fontsize=12)
    ax.set_ylim(-200, 200)

plt.suptitle('å¤‰æ•°åˆ†é›¢è§£: ãƒ•ãƒ¼ãƒªã‚¨ç´šæ•°å±•é–‹', fontsize=14)
plt.tight_layout()
plt.show()

# å„ãƒ¢ãƒ¼ãƒ‰ã®æ¸›è¡°
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ãƒ¢ãƒ¼ãƒ‰ã®æ™‚é–“æ¸›è¡°
t_range = np.linspace(0, 20, 200)
for n in range(1, 6):
    lambda_n = (n * np.pi / L)**2
    amplitude = np.exp(-alpha * lambda_n * t_range)
    ax1.plot(t_range, amplitude, linewidth=2, label=f'Mode {n}')

ax1.grid(True, alpha=0.3)
ax1.set_xlabel('æ™‚é–“ t', fontsize=12)
ax1.set_ylabel('æŒ¯å¹…ï¼ˆè¦æ ¼åŒ–ï¼‰', fontsize=12)
ax1.set_title('å„ãƒ¢ãƒ¼ãƒ‰ã®æ™‚é–“æ¸›è¡°', fontsize=14)
ax1.legend()

# æ¸›è¡°ç‡
modes = np.arange(1, 11)
decay_rates = alpha * (modes * np.pi / L)**2

ax2.plot(modes, decay_rates, 'bo-', linewidth=2, markersize=8)
ax2.grid(True, alpha=0.3)
ax2.set_xlabel('ãƒ¢ãƒ¼ãƒ‰ç•ªå· n', fontsize=12)
ax2.set_ylabel('æ¸›è¡°ç‡ $\\alpha\\lambda_n$', fontsize=12)
ax2.set_title('æ¸›è¡°ç‡ã¨ãƒ¢ãƒ¼ãƒ‰ç•ªå·ã®é–¢ä¿‚', fontsize=14)

plt.tight_layout()
plt.show()

print("\nå¤‰æ•°åˆ†é›¢è§£ã®ç‰¹å¾´:")
print("- é«˜æ¬¡ãƒ¢ãƒ¼ãƒ‰ã»ã©é€Ÿãæ¸›è¡°")
print("- é•·æ™‚é–“å¾Œã¯åŸºæœ¬ãƒ¢ãƒ¼ãƒ‰ï¼ˆn=1ï¼‰ãŒæ”¯é…çš„")
print(f"- åŸºæœ¬ãƒ¢ãƒ¼ãƒ‰ã®æ¸›è¡°æ™‚å®šæ•°: Ï„ = 1/(Î±Î»â‚) = {1/(alpha*(np.pi/L)**2):.2f}")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.4 å¢ƒç•Œæ¡ä»¶ã®ç¨®é¡</h2>
                    <p>
                        Dirichletã€Neumannã€Robinå¢ƒç•Œæ¡ä»¶ã‚’å­¦ã³ã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>å¢ƒç•Œæ¡ä»¶ã®ç¨®é¡:</strong></p>
                        <ul>
                            <li><strong>Dirichlet:</strong> $u(0,t) = T_0$ ï¼ˆæ¸©åº¦æŒ‡å®šï¼‰</li>
                            <li><strong>Neumann:</strong> $\frac{\partial u}{\partial x}(0,t) = q_0$ ï¼ˆç†±æµæŸæŒ‡å®šï¼‰</li>
                            <li><strong>Robin:</strong> $\frac{\partial u}{\partial x} + hu = 0$ ï¼ˆå¯¾æµå¢ƒç•Œï¼‰</li>
                        </ul>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 4: ç•°ãªã‚‹å¢ƒç•Œæ¡ä»¶ã®æ¯”è¼ƒ</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
alpha = 0.1
T_total = 15.0
Nx = 100
Nt = 1500

x = np.linspace(0, L, Nx)
dx = x[1] - x[0]
dt = T_total / Nt
r = alpha * dt / dx**2

# åˆæœŸæ¡ä»¶
def init_cond(x):
    return 100 * np.exp(-((x - L/2)/2)**2)

# 3ç¨®é¡ã®å¢ƒç•Œæ¡ä»¶ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
cases = {
    'Dirichlet (u=0)': 'dirichlet',
    'Neumann (âˆ‚u/âˆ‚x=0)': 'neumann',
    'Robin (å¯¾æµ)': 'robin'
}

solutions = {}

for name, bc_type in cases.items():
    u = np.zeros((Nt, Nx))
    u[0] = init_cond(x)
    
    for n in range(Nt-1):
        for i in range(1, Nx-1):
            u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])
        
        # å¢ƒç•Œæ¡ä»¶
        if bc_type == 'dirichlet':
            # ä¸¡ç«¯ã§æ¸©åº¦å›ºå®š
            u[n+1, 0] = 0
            u[n+1, -1] = 0
        
        elif bc_type == 'neumann':
            # ä¸¡ç«¯ã§æ–­ç†±ï¼ˆâˆ‚u/âˆ‚x = 0ï¼‰
            u[n+1, 0] = u[n+1, 1]
            u[n+1, -1] = u[n+1, -2]
        
        elif bc_type == 'robin':
            # å¯¾æµå¢ƒç•Œæ¡ä»¶ï¼ˆç°¡æ˜“ï¼‰
            h = 0.5  # å¯¾æµä¿‚æ•°
            u[n+1, 0] = (u[n+1, 1] + h*dx*0) / (1 + h*dx)
            u[n+1, -1] = (u[n+1, -2] + h*dx*0) / (1 + h*dx)
    
    solutions[name] = u

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 3, figsize=(16, 10))

times_idx = [0, Nt//5, 2*Nt//5, 3*Nt//5, 4*Nt//5, Nt-1]
t = np.linspace(0, T_total, Nt)

for idx, n in enumerate(times_idx):
    ax = axes[idx//3, idx%3]
    
    for name, u in solutions.items():
        ax.plot(x, u[n], linewidth=2, label=name, alpha=0.8)
    
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=11)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.set_ylim(-10, 110)
    if idx == 0:
        ax.legend()

plt.suptitle('å¢ƒç•Œæ¡ä»¶ã®ç¨®é¡ã«ã‚ˆã‚‹æ¸©åº¦åˆ†å¸ƒã®é•ã„', fontsize=14)
plt.tight_layout()
plt.show()

print("=== å¢ƒç•Œæ¡ä»¶ã®ç‰©ç†çš„æ„å‘³ ===")
print("Dirichlet: ä¸€å®šæ¸©åº¦ã«ä¿ãŸã‚ŒãŸå¢ƒç•Œï¼ˆä¾‹: æ°·æ°´æµ´ï¼‰")
print("Neumann: æ–­ç†±å¢ƒç•Œï¼ˆä¾‹: æ–­ç†±æï¼‰")
print("Robin: å¯¾æµå¢ƒç•Œï¼ˆä¾‹: ç©ºæ°—ä¸­ã¸ã®æ”¾ç†±ï¼‰")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.5 2æ¬¡å…ƒç†±ä¼å°</h2>
                    <p>
                        2æ¬¡å…ƒå¹³é¢ã§ã®ç†±ä¼å°ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 5: 2æ¬¡å…ƒç†±ä¼å°ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from matplotlib import cm

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
Lx, Ly = 10.0, 10.0
alpha = 0.1
T_total = 5.0
Nx, Ny = 50, 50
Nt = 500

x = np.linspace(0, Lx, Nx)
y = np.linspace(0, Ly, Ny)
X, Y = np.meshgrid(x, y)
dx = x[1] - x[0]
dy = y[1] - y[0]
dt = T_total / Nt

# å®‰å®šæ€§æ¡ä»¶
r_x = alpha * dt / dx**2
r_y = alpha * dt / dy**2
print(f"å®‰å®šæ€§: r_x={r_x:.4f}, r_y={r_y:.4f} (å¿…è¦: r_x+r_y â‰¤ 0.5)")

# åˆæœŸæ¡ä»¶: ä¸­å¤®ã«é«˜æ¸©é ˜åŸŸ
u = np.zeros((Nt, Ny, Nx))
cx, cy = Lx/2, Ly/2
u[0] = 100 * np.exp(-((X-cx)**2 + (Y-cy)**2) / 4)

# 2æ¬¡å…ƒç†±ä¼å°ï¼ˆé™½çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼‰
for n in range(Nt-1):
    for i in range(1, Ny-1):
        for j in range(1, Nx-1):
            u[n+1, i, j] = (u[n, i, j] + 
                           r_x * (u[n, i, j+1] - 2*u[n, i, j] + u[n, i, j-1]) +
                           r_y * (u[n, i+1, j] - 2*u[n, i, j] + u[n, i-1, j]))
    
    # å¢ƒç•Œæ¡ä»¶: Dirichlet (u=0)
    u[n+1, 0, :] = 0
    u[n+1, -1, :] = 0
    u[n+1, :, 0] = 0
    u[n+1, :, -1] = 0

# å¯è¦–åŒ–
fig = plt.figure(figsize=(16, 10))

times_idx = [0, Nt//5, 2*Nt//5, 3*Nt//5, 4*Nt//5, Nt-1]
t = np.linspace(0, T_total, Nt)

for idx, n in enumerate(times_idx, 1):
    ax = fig.add_subplot(2, 3, idx, projection='3d')
    surf = ax.plot_surface(X, Y, u[n], cmap=cm.hot, alpha=0.9)
    ax.set_xlabel('x', fontsize=10)
    ax.set_ylabel('y', fontsize=10)
    ax.set_zlabel('æ¸©åº¦', fontsize=10)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.set_zlim(0, 100)

plt.suptitle('2æ¬¡å…ƒç†±ä¼å°ã®æ™‚é–“ç™ºå±•', fontsize=14)
plt.tight_layout()
plt.show()

# ç­‰é«˜ç·šå›³
fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

for idx, n in enumerate(times_idx):
    ax = axes[idx]
    contour = ax.contourf(X, Y, u[n], levels=20, cmap='hot')
    ax.contour(X, Y, u[n], levels=10, colors='black', linewidths=0.5, alpha=0.4)
    plt.colorbar(contour, ax=ax, label='æ¸©åº¦')
    ax.set_xlabel('x', fontsize=11)
    ax.set_ylabel('y', fontsize=11)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.axis('equal')

plt.suptitle('2æ¬¡å…ƒç†±ä¼å°ï¼ˆç­‰é«˜ç·šå›³ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.6 æœ€å¤§å€¤åŸç†ã¨ä¸€æ„æ€§</h2>
                    <p>
                        ç†±ä¼å°æ–¹ç¨‹å¼ã®é‡è¦ãªæ€§è³ªã§ã‚ã‚‹æœ€å¤§å€¤åŸç†ã‚’æ•°å€¤çš„ã«ç¢ºèªã—ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 6: æœ€å¤§å€¤åŸç†ã®æ¤œè¨¼</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
alpha = 0.1
T_total = 10.0
Nx = 100
Nt = 1000

x = np.linspace(0, L, Nx)
t = np.linspace(0, T_total, Nt)
dx = x[1] - x[0]
dt = t[1] - t[0]
r = alpha * dt / dx**2

# åˆæœŸæ¡ä»¶: è¤‡é›‘ãªæ¸©åº¦åˆ†å¸ƒ
u = np.zeros((Nt, Nx))
u[0] = 50 + 30*np.sin(2*np.pi*x/L) + 20*np.sin(5*np.pi*x/L)

# å¢ƒç•Œæ¡ä»¶
u[:, 0] = 30
u[:, -1] = 40

# ç†±ä¼å°
for n in range(Nt-1):
    for i in range(1, Nx-1):
        u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])

# æœ€å¤§å€¤ãƒ»æœ€å°å€¤ã®è¿½è·¡
max_values = [np.max(u[n]) for n in range(Nt)]
min_values = [np.min(u[n]) for n in range(Nt)]
max_initial = np.max(u[0])
min_initial = np.min(u[0])
max_boundary = max(u[0, 0], u[0, -1])
min_boundary = min(u[0, 0], u[0, -1])

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# æ¸©åº¦åˆ†å¸ƒã®æ™‚é–“ç™ºå±•
times_idx = [0, Nt//4, Nt//2, 3*Nt//4, Nt-1]
for n in times_idx:
    ax1.plot(x, u[n], linewidth=2, label=f't={t[n]:.2f}', alpha=0.8)

ax1.axhline(max_initial, color='red', linestyle='--', linewidth=1, alpha=0.5, label='åˆæœŸæœ€å¤§å€¤')
ax1.axhline(min_initial, color='blue', linestyle='--', linewidth=1, alpha=0.5, label='åˆæœŸæœ€å°å€¤')
ax1.grid(True, alpha=0.3)
ax1.set_xlabel('ä½ç½® x', fontsize=12)
ax1.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=12)
ax1.set_title('æ¸©åº¦åˆ†å¸ƒã®æ™‚é–“ç™ºå±•', fontsize=14)
ax1.legend()

# æœ€å¤§å€¤ãƒ»æœ€å°å€¤ã®æ™‚é–“å¤‰åŒ–
ax2.plot(t, max_values, 'r-', linewidth=2, label='æœ€å¤§å€¤')
ax2.plot(t, min_values, 'b-', linewidth=2, label='æœ€å°å€¤')
ax2.axhline(max_initial, color='red', linestyle='--', linewidth=1, alpha=0.5, label='åˆæœŸæœ€å¤§å€¤')
ax2.axhline(min_initial, color='blue', linestyle='--', linewidth=1, alpha=0.5, label='åˆæœŸæœ€å°å€¤')
ax2.grid(True, alpha=0.3)
ax2.set_xlabel('æ™‚é–“ t', fontsize=12)
ax2.set_ylabel('æ¸©åº¦', fontsize=12)
ax2.set_title('æœ€å¤§å€¤åŸç†ã®æ¤œè¨¼', fontsize=14)
ax2.legend()

plt.tight_layout()
plt.show()

print("=== æœ€å¤§å€¤åŸç† ===")
print(f"åˆæœŸæœ€å¤§å€¤: {max_initial:.2f}")
print(f"æœ€çµ‚æœ€å¤§å€¤: {max_values[-1]:.2f}")
print(f"åˆæœŸæœ€å°å€¤: {min_initial:.2f}")
print(f"æœ€çµ‚æœ€å°å€¤: {min_values[-1]:.2f}")
print("\næœ€å¤§å€¤åŸç†: å†…éƒ¨ã®æ¸©åº¦ã¯åˆæœŸå€¤ã¨å¢ƒç•Œå€¤ã®ç¯„å›²å†…ã«ç•™ã¾ã‚‹")
print("â†’ æœ€å¤§å€¤ã¯æ¸›å°‘ã—ã€æœ€å°å€¤ã¯å¢—åŠ ã—ã¦å¹³è¡¡çŠ¶æ…‹ã¸")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.7 é™°çš„ã‚¹ã‚­ãƒ¼ãƒ ã¨å®‰å®šæ€§</h2>
                    <p>
                        ç„¡æ¡ä»¶å®‰å®šãªé™°çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼ˆCrank-Nicolsonæ³•ï¼‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 7: Crank-Nicolsonæ³•</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.sparse import diags
from scipy.sparse.linalg import spsolve

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
alpha = 0.1
T_total = 5.0
Nx = 100
Nt = 100  # é™°çš„æ³•ãªã®ã§å°‘ãªã„ã‚¹ãƒ†ãƒƒãƒ—ã§OK

x = np.linspace(0, L, Nx)
dx = x[1] - x[0]
dt = T_total / Nt
r = alpha * dt / dx**2

print(f"r = {r:.4f} (é™°çš„æ³•ã§ã¯ r > 0.5 ã§ã‚‚å®‰å®š)")

# åˆæœŸæ¡ä»¶
u_implicit = np.zeros((Nt, Nx))
u_implicit[0] = 100 * np.sin(np.pi * x / L)

# Crank-Nicolsonæ³•ã®è¡Œåˆ—æ§‹ç¯‰
# (I + r/2 A) u^{n+1} = (I - r/2 A) u^n
main_diag = np.ones(Nx) * (1 + r)
off_diag = np.ones(Nx-1) * (-r/2)

A_left = diags([off_diag, main_diag, off_diag], [-1, 0, 1], shape=(Nx, Nx)).tocsr()
A_right = diags([-off_diag, np.ones(Nx) * (1 - r), -off_diag], [-1, 0, 1], shape=(Nx, Nx)).tocsr()

# å¢ƒç•Œæ¡ä»¶ã®å‡¦ç†
A_left[0, :] = 0
A_left[0, 0] = 1
A_left[-1, :] = 0
A_left[-1, -1] = 1

# æ™‚é–“ç™ºå±•
for n in range(Nt-1):
    rhs = A_right.dot(u_implicit[n])
    rhs[0] = 0  # å¢ƒç•Œæ¡ä»¶
    rhs[-1] = 0
    u_implicit[n+1] = spsolve(A_left, rhs)

# æ¯”è¼ƒ: é™½çš„æ³•
u_explicit = np.zeros((Nt, Nx))
u_explicit[0] = u_implicit[0].copy()

for n in range(Nt-1):
    for i in range(1, Nx-1):
        u_explicit[n+1, i] = u_explicit[n, i] + r * (u_explicit[n, i+1] - 2*u_explicit[n, i] + u_explicit[n, i-1])
    u_explicit[n+1, 0] = 0
    u_explicit[n+1, -1] = 0

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

t = np.linspace(0, T_total, Nt)
times_idx = [Nt//4, Nt//2, 3*Nt//4, Nt-1]

for idx, n in enumerate(times_idx):
    ax = axes[idx//2, idx%2]
    ax.plot(x, u_implicit[n], 'b-', linewidth=2, label='Crank-Nicolson (é™°çš„)')
    ax.plot(x, u_explicit[n], 'r--', linewidth=2, alpha=0.7, label='FTCS (é™½çš„)')
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=11)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.legend()
    ax.set_ylim(-10, 110)

plt.suptitle(f'é™°çš„æ³• vs é™½çš„æ³•ã®æ¯”è¼ƒ (r={r:.2f})', fontsize=14)
plt.tight_layout()
plt.show()

print("\n=== Crank-Nicolsonæ³•ã®åˆ©ç‚¹ ===")
print("- ç„¡æ¡ä»¶å®‰å®šï¼ˆr > 0.5 ã§ã‚‚å®‰å®šï¼‰")
print("- 2æ¬¡ç²¾åº¦ï¼ˆæ™‚é–“ãƒ»ç©ºé–“ã¨ã‚‚ã«ï¼‰")
print("- å¤§ããªæ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ãŒä½¿ç”¨å¯èƒ½")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.8 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨: ç†±å‡¦ç†ãƒ—ãƒ­ã‚»ã‚¹</h2>
                    <p>
                        é‹¼æã®ç„¼å…¥ã‚Œãƒ—ãƒ­ã‚»ã‚¹ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 8: é‹¼æç„¼å…¥ã‚Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# é‹¼æãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 0.05  # æ¿åš 50mm
alpha = 1.2e-5  # ç†±æ‹¡æ•£ç‡ (mÂ²/s) - é‹¼
T_initial = 900  # åˆæœŸæ¸©åº¦ (Â°C) - ã‚ªãƒ¼ã‚¹ãƒ†ãƒŠã‚¤ãƒˆåŒ–æ¸©åº¦
T_quench = 20    # ç„¼å…¥ã‚Œæ¶²æ¸©åº¦ (Â°C)

# æ•°å€¤ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
Nx = 100
T_total = 300  # 300ç§’
Nt = 3000

x = np.linspace(0, L, Nx)
t = np.linspace(0, T_total, Nt)
dx = x[1] - x[0]
dt = t[1] - t[0]
r = alpha * dt / dx**2

print(f"æ¿åš: {L*1000:.1f} mm")
print(f"å®‰å®šæ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ r = {r:.4f}")

# åˆæœŸæ¡ä»¶: ä¸€æ§˜é«˜æ¸©
u = np.zeros((Nt, Nx))
u[0] = T_initial

# å¢ƒç•Œæ¡ä»¶: æ€¥å†·ï¼ˆå¯¾æµå¢ƒç•Œæ¡ä»¶ã®ç°¡æ˜“ãƒ¢ãƒ‡ãƒ«ï¼‰
h = 1000  # å¯¾æµç†±ä¼é”ä¿‚æ•° (W/mÂ²K) - æ°´ç„¼å…¥ã‚Œ
T_inf = T_quench

# ç†±ä¼å° + å¯¾æµå¢ƒç•Œ
for n in range(Nt-1):
    for i in range(1, Nx-1):
        u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])
    
    # Robinå¢ƒç•Œæ¡ä»¶ï¼ˆå¯¾æµï¼‰
    # -k âˆ‚u/âˆ‚x = h(u - T_inf)
    # ç°¡æ˜“çš„ã«: u[0] = u[1] - (h*dx/k)*(u[1] - T_inf)
    k_steel = 50  # ç†±ä¼å°ç‡ (W/mK)
    biot = h * dx / k_steel
    
    u[n+1, 0] = (u[n+1, 1] + biot*T_inf) / (1 + biot)
    u[n+1, -1] = (u[n+1, -2] + biot*T_inf) / (1 + biot)

# è‡¨ç•Œå†·å´é€Ÿåº¦ã®è©•ä¾¡
# ãƒãƒ«ãƒ†ãƒ³ã‚µã‚¤ãƒˆå¤‰æ…‹æ¸©åº¦ Ms â‰ˆ 350Â°C
Ms_temp = 350
center_idx = Nx // 2

# ä¸­å¿ƒæ¸©åº¦ã®æ™‚é–“å¤‰åŒ–
center_temp = u[:, center_idx]

# Msæ¸©åº¦é€šéæ™‚åˆ»
ms_crossing = np.where(center_temp < Ms_temp)[0]
if len(ms_crossing) > 0:
    t_ms = t[ms_crossing[0]]
    print(f"\nä¸­å¿ƒéƒ¨ãŒMsæ¸©åº¦ï¼ˆ{Ms_temp}Â°Cï¼‰åˆ°é”: t = {t_ms:.1f} s")
else:
    print(f"\nä¸­å¿ƒéƒ¨ã¯Msæ¸©åº¦ã«æœªåˆ°é”")

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# æ¸©åº¦åˆ†å¸ƒã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
ax = axes[0, 0]
times_idx = [0, Nt//10, Nt//4, Nt//2, Nt-1]
for n in times_idx:
    ax.plot(x*1000, u[n], linewidth=2, label=f't={t[n]:.1f}s', alpha=0.8)

ax.axhline(Ms_temp, color='red', linestyle='--', linewidth=2, alpha=0.5, label=f'Msæ¸©åº¦ {Ms_temp}Â°C')
ax.grid(True, alpha=0.3)
ax.set_xlabel('æ¿åšæ–¹å‘ä½ç½® (mm)', fontsize=12)
ax.set_ylabel('æ¸©åº¦ (Â°C)', fontsize=12)
ax.set_title('æ¿åšæ–¹å‘ã®æ¸©åº¦åˆ†å¸ƒ', fontsize=14)
ax.legend()

# æ™‚ç©ºé–“ãƒ—ãƒ­ãƒƒãƒˆ
ax = axes[0, 1]
contour = ax.contourf(x*1000, t, u, levels=30, cmap='hot')
ax.contour(x*1000, t, u, levels=[Ms_temp], colors='blue', linewidths=3)
plt.colorbar(contour, ax=ax, label='æ¸©åº¦ (Â°C)')
ax.set_xlabel('æ¿åšæ–¹å‘ä½ç½® (mm)', fontsize=12)
ax.set_ylabel('æ™‚é–“ (s)', fontsize=12)
ax.set_title('ç„¼å…¥ã‚Œéç¨‹ã®æ™‚ç©ºé–“å›³', fontsize=14)

# è¡¨é¢ãƒ»ä¸­å¿ƒæ¸©åº¦ã®æ™‚é–“å¤‰åŒ–
ax = axes[1, 0]
ax.plot(t, u[:, 0], 'b-', linewidth=2, label='è¡¨é¢æ¸©åº¦')
ax.plot(t, u[:, center_idx], 'r-', linewidth=2, label='ä¸­å¿ƒæ¸©åº¦')
ax.axhline(Ms_temp, color='green', linestyle='--', linewidth=2, alpha=0.5, label=f'Msæ¸©åº¦')
ax.grid(True, alpha=0.3)
ax.set_xlabel('æ™‚é–“ (s)', fontsize=12)
ax.set_ylabel('æ¸©åº¦ (Â°C)', fontsize=12)
ax.set_title('è¡¨é¢ãƒ»ä¸­å¿ƒæ¸©åº¦ã®æ™‚é–“å¤‰åŒ–', fontsize=14)
ax.legend()

# å†·å´é€Ÿåº¦
ax = axes[1, 1]
cooling_rate_surface = -np.gradient(u[:, 0], dt)
cooling_rate_center = -np.gradient(u[:, center_idx], dt)

ax.plot(t[1:], cooling_rate_surface[1:], 'b-', linewidth=2, label='è¡¨é¢å†·å´é€Ÿåº¦')
ax.plot(t[1:], cooling_rate_center[1:], 'r-', linewidth=2, label='ä¸­å¿ƒå†·å´é€Ÿåº¦')
ax.grid(True, alpha=0.3)
ax.set_xlabel('æ™‚é–“ (s)', fontsize=12)
ax.set_ylabel('å†·å´é€Ÿåº¦ (Â°C/s)', fontsize=12)
ax.set_title('å†·å´é€Ÿåº¦ã®æ™‚é–“å¤‰åŒ–', fontsize=14)
ax.legend()

plt.suptitle('é‹¼æç„¼å…¥ã‚Œãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³', fontsize=14)
plt.tight_layout()
plt.show()

print("\n=== ç„¼å…¥ã‚Œçµæœ ===")
print(f"æœ€çµ‚è¡¨é¢æ¸©åº¦: {u[-1, 0]:.1f}Â°C")
print(f"æœ€çµ‚ä¸­å¿ƒæ¸©åº¦: {u[-1, center_idx]:.1f}Â°C")
print(f"æ¸©åº¦å·®: {u[-1, center_idx] - u[-1, 0]:.1f}Â°C")
print("\nç„¼å…¥ã‚Œã®æˆåŠŸæ¡ä»¶:")
print("- å…¨ä½“ãŒMsæ¸©åº¦ä»¥ä¸‹ã¾ã§å†·å´ã•ã‚Œã‚‹ã“ã¨")
print("- å†·å´é€Ÿåº¦ãŒè‡¨ç•Œå†·å´é€Ÿåº¦ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>ğŸ“ ç« æœ«å•é¡Œ</h2>
                    <div class="exercise-box">
                        <h4>æ¼”ç¿’å•é¡Œ</h4>
                        <ol>
                            <li>ç†±æ‹¡æ•£ç‡ $\alpha = 0.2$ cmÂ²/sã€é•·ã• $L=10$ cm ã®æ£’ã§ã€åŸºæœ¬ãƒ¢ãƒ¼ãƒ‰ã®æ¸›è¡°æ™‚å®šæ•°ã‚’æ±‚ã‚ã‚ˆã€‚</li>
                            <li>Neumannå¢ƒç•Œæ¡ä»¶ã§å…¨ä½“ãŒæ–­ç†±ã•ã‚Œã¦ã„ã‚‹å ´åˆã€å¹³è¡¡çŠ¶æ…‹ã§ã®æ¸©åº¦åˆ†å¸ƒã‚’æ±‚ã‚ã‚ˆã€‚</li>
                            <li>2æ¬¡å…ƒæ­£æ–¹å½¢é ˜åŸŸã§ã€1ã¤ã®è¾ºã®ã¿ãŒé«˜æ¸©ï¼ˆä»–ã¯ä½æ¸©ï¼‰ã®å ´åˆã®å®šå¸¸çŠ¶æ…‹ã‚’æ±‚ã‚ã‚ˆã€‚</li>
                            <li>Crank-Nicolsonæ³•ã§ $r=2$ ã®å ´åˆã®æ•°å€¤è§£ã‚’é™½çš„æ³•ã¨æ¯”è¼ƒã›ã‚ˆã€‚</li>
                        </ol>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>ğŸ”— å‚è€ƒæ–‡çŒ®</h2>
                    <ul class="reference-list">
                        <li>Crank, J. (1975). <em>The Mathematics of Diffusion</em>. Oxford University Press.</li>
                        <li>Carslaw, H. S., & Jaeger, J. C. (1959). <em>Conduction of Heat in Solids</em>. Oxford University Press.</li>
                    </ul>
                </section>
            </article>

            <nav class="chapter-navigation">
                <a href="chapter-1.html" class="btn btn-secondary">â† ç¬¬1ç« ã¸</a>
                <a href="chapter-3.html" class="btn btn-primary">ç¬¬3ç« ã¸ â†’</a>
            </nav>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 AI Terakoya. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
