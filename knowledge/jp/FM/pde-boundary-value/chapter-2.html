<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : ç†±ä¼å°æ–¹ç¨‹å¼ã¨æ‹¡æ•£ç¾è±¡ | åå¾®åˆ†æ–¹ç¨‹å¼ã¨å¢ƒç•Œå€¤å•é¡Œ</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/FM/pde-boundary-value/chapter-2.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
        <h1>ç¬¬2ç« : ç†±ä¼å°æ–¹ç¨‹å¼ã¨æ‹¡æ•£ç¾è±¡</h1>
        <p class="subtitle">Heat Equation and Diffusion</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">åå¾®åˆ†æ–¹ç¨‹å¼ã¨å¢ƒç•Œå€¤å•é¡Œ</a> &gt;
            ç¬¬2ç« 
        </div>

        <div class="content">
            <h2>2.1 ç†±ä¼å°æ–¹ç¨‹å¼ã®å°å‡º</h2>
            <p>
                ãƒ•ãƒ¼ãƒªã‚¨ã®ç†±ä¼å°æ³•å‰‡ã‹ã‚‰æ‹¡æ•£æ–¹ç¨‹å¼ã‚’å°å‡ºã—ã¾ã™ã€‚
            </p>

            <div class="theorem">
                <strong>ğŸ“ ç†è«–</strong><br>
                <p><strong>ç†±ä¼å°æ–¹ç¨‹å¼ï¼ˆæ‹¡æ•£æ–¹ç¨‹å¼ï¼‰:</strong></p>
                $$\frac{\partial u}{\partial t} = \alpha \frac{\partial^2 u}{\partial x^2}$$
                <p>ã“ã“ã§ $u(x,t)$ ã¯æ¸©åº¦ã€$\alpha = k/(\rho c_p)$ ã¯ç†±æ‹¡æ•£ç‡</p>
                <p>$k$: ç†±ä¼å°ç‡ã€$\rho$: å¯†åº¦ã€$c_p$: æ¯”ç†±</p>
            </div>

            <div class="code-title">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 1: ç†±ä¼å°æ–¹ç¨‹å¼ã®æ•°å€¤è§£ï¼ˆé™½çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼‰</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0  # æ£’ã®é•·ã•
alpha = 0.1  # ç†±æ‹¡æ•£ç‡
T_total = 10.0
Nx = 100
Nt = 2000

x = np.linspace(0, L, Nx)
t = np.linspace(0, T_total, Nt)
dx = x[1] - x[0]
dt = t[1] - t[0]

# å®‰å®šæ€§æ¡ä»¶ã®ç¢ºèª
r = alpha * dt / dx**2
print(f"å®‰å®šæ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ r = {r:.4f} (å®‰å®šæ¡ä»¶: r â‰¤ 0.5)")

# åˆæœŸæ¡ä»¶: ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°
u = np.zeros((Nt, Nx))
u[0, Nx//4:3*Nx//4] = 100.0

# å¢ƒç•Œæ¡ä»¶: u(0,t) = u(L,t) = 0
# é™½çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼ˆFTCS: Forward Time Central Spaceï¼‰
for n in range(Nt-1):
    for i in range(1, Nx-1):
        u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])

    u[n+1, 0] = 0
    u[n+1, -1] = 0

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))
axes = axes.flatten()

times_idx = [0, Nt//10, Nt//3, Nt-1]
for idx, n in enumerate(times_idx):
    ax = axes[idx]
    ax.plot(x, u[n], 'b-', linewidth=2)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=12)
    ax.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=12)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.set_ylim(-10, 110)

plt.suptitle('ç†±ä¼å°æ–¹ç¨‹å¼ã®æ•°å€¤è§£ï¼ˆé™½çš„ã‚¹ã‚­ãƒ¼ãƒ ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

# æ™‚ç©ºé–“ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(12, 6))
plt.contourf(x, t, u, levels=50, cmap='hot')
plt.colorbar(label='æ¸©åº¦ u(x,t)')
plt.xlabel('ä½ç½® x', fontsize=12)
plt.ylabel('æ™‚é–“ t', fontsize=12)
plt.title('ç†±æ‹¡æ•£ã®æ™‚ç©ºé–“å›³', fontsize=14)
plt.tight_layout()
plt.show()

print("\nç†±ä¼å°æ–¹ç¨‹å¼ã®æ€§è³ª:")
print("- ç†±ã¯é«˜æ¸©ã‹ã‚‰ä½æ¸©ã¸æ‹¡æ•£")
print("- æ™‚é–“ã¨ã¨ã‚‚ã«æ¸©åº¦åˆ†å¸ƒã¯æ»‘ã‚‰ã‹ã«ãªã‚‹")
print("- ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¯å¢—å¤§ï¼ˆä¸å¯é€†éç¨‹ï¼‰")</div>
        </div>

        <div class="content">
            <h2>2.2 åŸºæœ¬è§£ï¼ˆã‚¬ã‚¦ã‚¹æ ¸ï¼‰</h2>
            <p>
                ç„¡é™é ˜åŸŸã§ã®ç†±ä¼å°æ–¹ç¨‹å¼ã®åŸºæœ¬è§£ã‚’å­¦ã³ã¾ã™ã€‚
            </p>

            <div class="theorem">
                <strong>ğŸ“ ç†è«–</strong><br>
                <p><strong>åŸºæœ¬è§£ï¼ˆã‚¬ã‚¦ã‚¹æ ¸ï¼‰:</strong></p>
                $$G(x,t) = \frac{1}{\sqrt{4\pi\alpha t}} e^{-x^2/(4\alpha t)}$$
                <p><strong>ç•³ã¿è¾¼ã¿ã«ã‚ˆã‚‹ä¸€èˆ¬è§£:</strong></p>
                $$u(x,t) = \int_{-\infty}^{\infty} G(x-\xi, t) f(\xi) d\xi$$
            </div>

            <div class="code-title">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 2: åŸºæœ¬è§£ï¼ˆã‚¬ã‚¦ã‚¹æ ¸ï¼‰ã®å¯è¦–åŒ–</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
alpha = 0.1
x = np.linspace(-10, 10, 500)

# åŸºæœ¬è§£
def fundamental_solution(x, t, alpha):
    if t <= 0:
        return np.zeros_like(x)
    return (1/np.sqrt(4*np.pi*alpha*t)) * np.exp(-x**2 / (4*alpha*t))

# æ™‚é–“ç™ºå±•
t_values = [0.1, 0.5, 1.0, 2.0, 5.0]

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# åŸºæœ¬è§£ã®æ™‚é–“ç™ºå±•
for t in t_values:
    G = fundamental_solution(x, t, alpha)
    ax1.plot(x, G, linewidth=2, label=f't = {t}')

ax1.grid(True, alpha=0.3)
ax1.set_xlabel('ä½ç½® x', fontsize=12)
ax1.set_ylabel('G(x,t)', fontsize=12)
ax1.set_title('åŸºæœ¬è§£ï¼ˆã‚¬ã‚¦ã‚¹æ ¸ï¼‰ã®æ™‚é–“ç™ºå±•', fontsize=14)
ax1.legend()

# ç•³ã¿è¾¼ã¿ã«ã‚ˆã‚‹ä¸€èˆ¬è§£
# åˆæœŸæ¡ä»¶: ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°
def initial_condition(x):
    return np.where(np.abs(x) < 1, 1.0, 0.0)

# ç•³ã¿è¾¼ã¿
def convolution_solution(x, t, alpha, f):
    xi = np.linspace(-20, 20, 1000)
    dxi = xi[1] - xi[0]
    u = np.zeros_like(x)

    for i, x_val in enumerate(x):
        G = fundamental_solution(x_val - xi, t, alpha)
        integrand = G * f(xi)
        u[i] = np.trapz(integrand, dx=dxi)

    return u

# ç•°ãªã‚‹æ™‚åˆ»ã§ã®è§£
for t in [0.5, 1.0, 2.0, 5.0]:
    u = convolution_solution(x, t, alpha, initial_condition)
    ax2.plot(x, u, linewidth=2, label=f't = {t}')

# åˆæœŸæ¡ä»¶
ax2.plot(x, initial_condition(x), 'k--', linewidth=2, alpha=0.5, label='åˆæœŸæ¡ä»¶')

ax2.grid(True, alpha=0.3)
ax2.set_xlabel('ä½ç½® x', fontsize=12)
ax2.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=12)
ax2.set_title('ç•³ã¿è¾¼ã¿ã«ã‚ˆã‚‹ä¸€èˆ¬è§£', fontsize=14)
ax2.legend()

plt.tight_layout()
plt.show()

print("=== åŸºæœ¬è§£ã®æ€§è³ª ===")
print("- è³ªé‡ä¿å­˜: âˆ«G(x,t)dx = 1")
print("- æ™‚é–“ã¨ã¨ã‚‚ã«åºƒãŒã‚‹ï¼ˆæ‹¡æ•£ï¼‰")
print("- tâ†’0 ã§ãƒ‡ãƒ«ã‚¿é–¢æ•°ã«è¿‘ã¥ã")</div>
        </div>

        <div class="content">
            <h2>2.3 å¤‰æ•°åˆ†é›¢æ³•ã«ã‚ˆã‚‹å¢ƒç•Œå€¤å•é¡Œ</h2>
            <p>
                æœ‰é™é ˜åŸŸã§ã®ç†±ä¼å°æ–¹ç¨‹å¼ã‚’å¤‰æ•°åˆ†é›¢æ³•ã§è§£ãã¾ã™ã€‚
            </p>

            <div class="code-title">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 3: å¤‰æ•°åˆ†é›¢è§£ã¨ãƒ•ãƒ¼ãƒªã‚¨ç´šæ•°</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
alpha = 0.1
n_modes = 20

x = np.linspace(0, L, 200)

# åˆæœŸæ¡ä»¶
def initial_temp(x):
    return 100 * np.sin(np.pi * x / L) + 50 * np.sin(2 * np.pi * x / L)

# ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°
def compute_fourier_coeff(f, L, n_max):
    coeffs = []
    for n in range(1, n_max+1):
        x_int = np.linspace(0, L, 1000)
        integrand = f(x_int) * np.sin(n * np.pi * x_int / L)
        c_n = (2/L) * np.trapz(integrand, x_int)
        coeffs.append(c_n)
    return coeffs

c_n = compute_fourier_coeff(initial_temp, L, n_modes)
print(f"ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•° c_n: {c_n[:5]}")

# å¤‰æ•°åˆ†é›¢è§£
def separation_solution(x, t, L, alpha, c_n):
    u = np.zeros_like(x)
    for n, c in enumerate(c_n, 1):
        lambda_n = (n * np.pi / L)**2
        u += c * np.sin(n * np.pi * x / L) * np.exp(-alpha * lambda_n * t)
    return u

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

times = [0, 1, 2, 5, 10, 20]
for idx, t in enumerate(times):
    ax = axes[idx]
    u = separation_solution(x, t, L, alpha, c_n)
    ax.plot(x, u, 'b-', linewidth=2)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=11)
    ax.set_title(f't = {t:.1f}', fontsize=12)
    ax.set_ylim(-200, 200)

plt.suptitle('å¤‰æ•°åˆ†é›¢è§£: ãƒ•ãƒ¼ãƒªã‚¨ç´šæ•°å±•é–‹', fontsize=14)
plt.tight_layout()
plt.show()

# å„ãƒ¢ãƒ¼ãƒ‰ã®æ¸›è¡°
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ãƒ¢ãƒ¼ãƒ‰ã®æ™‚é–“æ¸›è¡°
t_range = np.linspace(0, 20, 200)
for n in range(1, 6):
    lambda_n = (n * np.pi / L)**2
    amplitude = np.exp(-alpha * lambda_n * t_range)
    ax1.plot(t_range, amplitude, linewidth=2, label=f'Mode {n}')

ax1.grid(True, alpha=0.3)
ax1.set_xlabel('æ™‚é–“ t', fontsize=12)
ax1.set_ylabel('æŒ¯å¹…ï¼ˆè¦æ ¼åŒ–ï¼‰', fontsize=12)
ax1.set_title('å„ãƒ¢ãƒ¼ãƒ‰ã®æ™‚é–“æ¸›è¡°', fontsize=14)
ax1.legend()

# æ¸›è¡°ç‡
modes = np.arange(1, 11)
decay_rates = alpha * (modes * np.pi / L)**2

ax2.plot(modes, decay_rates, 'bo-', linewidth=2, markersize=8)
ax2.grid(True, alpha=0.3)
ax2.set_xlabel('ãƒ¢ãƒ¼ãƒ‰ç•ªå· n', fontsize=12)
ax2.set_ylabel('æ¸›è¡°ç‡ $\\alpha\\lambda_n$', fontsize=12)
ax2.set_title('æ¸›è¡°ç‡ã¨ãƒ¢ãƒ¼ãƒ‰ç•ªå·ã®é–¢ä¿‚', fontsize=14)

plt.tight_layout()
plt.show()

print("\nå¤‰æ•°åˆ†é›¢è§£ã®ç‰¹å¾´:")
print("- é«˜æ¬¡ãƒ¢ãƒ¼ãƒ‰ã»ã©é€Ÿãæ¸›è¡°")
print("- é•·æ™‚é–“å¾Œã¯åŸºæœ¬ãƒ¢ãƒ¼ãƒ‰ï¼ˆn=1ï¼‰ãŒæ”¯é…çš„")
print(f"- åŸºæœ¬ãƒ¢ãƒ¼ãƒ‰ã®æ¸›è¡°æ™‚å®šæ•°: Ï„ = 1/(Î±Î»â‚) = {1/(alpha*(np.pi/L)**2):.2f}")</div>
        </div>

        <div class="content">
            <h2>2.4 å¢ƒç•Œæ¡ä»¶ã®ç¨®é¡</h2>
            <p>
                Dirichletã€Neumannã€Robinå¢ƒç•Œæ¡ä»¶ã‚’å­¦ã³ã¾ã™ã€‚
            </p>

            <div class="theorem">
                <strong>ğŸ“ ç†è«–</strong><br>
                <p><strong>å¢ƒç•Œæ¡ä»¶ã®ç¨®é¡:</strong></p>
                <ul>
                    <li><strong>Dirichlet:</strong> $u(0,t) = T_0$ ï¼ˆæ¸©åº¦æŒ‡å®šï¼‰</li>
                    <li><strong>Neumann:</strong> $\frac{\partial u}{\partial x}(0,t) = q_0$ ï¼ˆç†±æµæŸæŒ‡å®šï¼‰</li>
                    <li><strong>Robin:</strong> $\frac{\partial u}{\partial x} + hu = 0$ ï¼ˆå¯¾æµå¢ƒç•Œï¼‰</li>
                </ul>
            </div>

            <div class="code-title">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 4: ç•°ãªã‚‹å¢ƒç•Œæ¡ä»¶ã®æ¯”è¼ƒ</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
L = 10.0
alpha = 0.1
T_total = 15.0
Nx = 100
Nt = 1500

x = np.linspace(0, L, Nx)
dx = x[1] - x[0]
dt = T_total / Nt
r = alpha * dt / dx**2

# åˆæœŸæ¡ä»¶
def init_cond(x):
    return 100 * np.exp(-((x - L/2)/2)**2)

# 3ç¨®é¡ã®å¢ƒç•Œæ¡ä»¶ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
cases = {
    'Dirichlet (u=0)': 'dirichlet',
    'Neumann (âˆ‚u/âˆ‚x=0)': 'neumann',
    'Robin (å¯¾æµ)': 'robin'
}

solutions = {}

for name, bc_type in cases.items():
    u = np.zeros((Nt, Nx))
    u[0] = init_cond(x)

    for n in range(Nt-1):
        for i in range(1, Nx-1):
            u[n+1, i] = u[n, i] + r * (u[n, i+1] - 2*u[n, i] + u[n, i-1])

        # å¢ƒç•Œæ¡ä»¶
        if bc_type == 'dirichlet':
            # ä¸¡ç«¯ã§æ¸©åº¦å›ºå®š
            u[n+1, 0] = 0
            u[n+1, -1] = 0

        elif bc_type == 'neumann':
            # ä¸¡ç«¯ã§æ–­ç†±ï¼ˆâˆ‚u/âˆ‚x = 0ï¼‰
            u[n+1, 0] = u[n+1, 1]
            u[n+1, -1] = u[n+1, -2]

        elif bc_type == 'robin':
            # å¯¾æµå¢ƒç•Œæ¡ä»¶ï¼ˆç°¡æ˜“ï¼‰
            h = 0.5  # å¯¾æµä¿‚æ•°
            u[n+1, 0] = (u[n+1, 1] + h*dx*0) / (1 + h*dx)
            u[n+1, -1] = (u[n+1, -2] + h*dx*0) / (1 + h*dx)

    solutions[name] = u

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 3, figsize=(16, 10))

times_idx = [0, Nt//5, 2*Nt//5, 3*Nt//5, 4*Nt//5, Nt-1]
t = np.linspace(0, T_total, Nt)

for idx, n in enumerate(times_idx):
    ax = axes[idx//3, idx%3]

    for name, u in solutions.items():
        ax.plot(x, u[n], linewidth=2, label=name, alpha=0.8)

    ax.axhline(0, color='gray', linewidth=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('ä½ç½® x', fontsize=11)
    ax.set_ylabel('æ¸©åº¦ u(x,t)', fontsize=11)
    ax.set_title(f't = {t[n]:.2f}', fontsize=12)
    ax.set_ylim(-10, 110)
    if idx == 0:
        ax.legend()

plt.suptitle('å¢ƒç•Œæ¡ä»¶ã®ç¨®é¡ã«ã‚ˆã‚‹æ¸©åº¦åˆ†å¸ƒã®é•ã„', fontsize=14)
plt.tight_layout()
plt.show()

print("=== å¢ƒç•Œæ¡ä»¶ã®ç‰©ç†çš„æ„å‘³ ===")
print("Dirichlet: ä¸€å®šæ¸©åº¦ã«ä¿ãŸã‚ŒãŸå¢ƒç•Œï¼ˆä¾‹: æ°·æ°´æµ´ï¼‰")
print("Neumann: æ–­ç†±å¢ƒç•Œï¼ˆä¾‹: æ–­ç†±æï¼‰")
print("Robin: å¯¾æµå¢ƒç•Œï¼ˆä¾‹: ç©ºæ°—ä¸­ã¸ã®æ”¾ç†±ï¼‰")</div>
        </div>

        <div class="content">
            <h2>ğŸ“ ç« æœ«å•é¡Œ</h2>
            <div class="exercise">
                <strong>æ¼”ç¿’å•é¡Œ</strong>
                <ol>
                    <li>ç†±æ‹¡æ•£ç‡ $\alpha = 0.2$ cmÂ²/sã€é•·ã• $L=10$ cm ã®æ£’ã§ã€åŸºæœ¬ãƒ¢ãƒ¼ãƒ‰ã®æ¸›è¡°æ™‚å®šæ•°ã‚’æ±‚ã‚ã‚ˆã€‚</li>
                    <li>Neumannå¢ƒç•Œæ¡ä»¶ã§å…¨ä½“ãŒæ–­ç†±ã•ã‚Œã¦ã„ã‚‹å ´åˆã€å¹³è¡¡çŠ¶æ…‹ã§ã®æ¸©åº¦åˆ†å¸ƒã‚’æ±‚ã‚ã‚ˆã€‚</li>
                    <li>2æ¬¡å…ƒæ­£æ–¹å½¢é ˜åŸŸã§ã€1ã¤ã®è¾ºã®ã¿ãŒé«˜æ¸©ï¼ˆä»–ã¯ä½æ¸©ï¼‰ã®å ´åˆã®å®šå¸¸çŠ¶æ…‹ã‚’æ±‚ã‚ã‚ˆã€‚</li>
                    <li>Crank-Nicolsonæ³•ã§ $r=2$ ã®å ´åˆã®æ•°å€¤è§£ã‚’é™½çš„æ³•ã¨æ¯”è¼ƒã›ã‚ˆã€‚</li>
                </ol>
            </div>
        </div>

        <div class="nav-buttons">
            <a href="chapter-1.html" class="nav-button">â† ç¬¬1ç« ã¸</a>
            <a href="chapter-3.html" class="nav-button">ç¬¬3ç« ã¸ â†’</a>
        </div>
    </div>

    <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

<footer>
        <p>&copy; 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
