<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« : ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã¨Hå®šç† - éå¹³è¡¡çµ±è¨ˆåŠ›å­¦</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-container {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise-box { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theory-box { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example-box { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        .navigation-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .btn { padding: 0.8rem 1.5rem; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .btn-primary { background: #667eea; }
        .btn-primary:hover { background: #764ba2; }
        .btn-secondary { background: #6c757d; }
        .btn-secondary:hover { background: #5a6268; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/FM/non-equilibrium-statistical-mechanics/chapter-1.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
        <h1>ç¬¬1ç« : ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã¨Hå®šç†</h1>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">éå¹³è¡¡çµ±è¨ˆåŠ›å­¦</a> &gt;
            ç¬¬1ç« 
        </div>

        <div class="content">
<section>
                <h2>å­¦ç¿’ç›®æ¨™</h2>
                <ul>
                    <li>åˆ†å¸ƒé–¢æ•°ã®æ¦‚å¿µã¨ç‰©ç†çš„æ„å‘³ã‚’ç†è§£ã™ã‚‹</li>
                    <li>ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã‚’å°å‡ºã—ã€è¡çªé …ã®æ‰±ã„ã‚’ç¿’å¾—ã™ã‚‹</li>
                    <li>Hå®šç†ã‚’è¨¼æ˜ã—ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¢—å¤§å‰‡ã¨ã®é–¢ä¿‚ã‚’ç†è§£ã™ã‚‹</li>
                    <li>ç·©å’Œæ™‚é–“è¿‘ä¼¼ï¼ˆBGKè¿‘ä¼¼ï¼‰ã‚’å­¦ã³ã€å®Ÿç”¨çš„ãªè§£æ³•ã‚’èº«ã«ã¤ã‘ã‚‹</li>
                    <li>Pythonã§æ°—ä½“åˆ†å­ã®ç·©å’Œéç¨‹ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹</li>
                </ul>
            </section>

            <section>
                <h2>1.1 åˆ†å¸ƒé–¢æ•°ã¨ä½ç›¸ç©ºé–“</h2>
                
                <div class="theory-box">
                    <h3>ç†è«–: 1ç²’å­åˆ†å¸ƒé–¢æ•°</h3>
                    <p>
                        æ°—ä½“åˆ†å­ç³»ã‚’è¨˜è¿°ã™ã‚‹æœ€ã‚‚åŸºæœ¬çš„ãªé‡ã¯1ç²’å­åˆ†å¸ƒé–¢æ•° \( f(\mathbf{r}, \mathbf{v}, t) \) ã§ã™ã€‚
                        ã“ã‚Œã¯æ™‚åˆ» \( t \) ã«ãŠã„ã¦ã€ä½ç½® \( \mathbf{r} \) ã‹ã‚‰ \( \mathbf{r} + d\mathbf{r} \)ã€
                        é€Ÿåº¦ \( \mathbf{v} \) ã‹ã‚‰ \( \mathbf{v} + d\mathbf{v} \) ã®ç¯„å›²å†…ã«ã‚ã‚‹ç²’å­æ•°ã®æœŸå¾…å€¤ã‚’è¡¨ã—ã¾ã™ã€‚
                    </p>
                    <p>
                        åˆ†å¸ƒé–¢æ•°ã®è¦æ ¼åŒ–æ¡ä»¶ï¼š
                        \[
                        N = \int f(\mathbf{r}, \mathbf{v}, t) \, d\mathbf{r} \, d\mathbf{v}
                        \]
                        ã“ã“ã§ \( N \) ã¯å…¨ç²’å­æ•°ã§ã™ã€‚
                    </p>
                    <p>
                        ãƒã‚¯ãƒ­ãªç‰©ç†é‡ã¯åˆ†å¸ƒé–¢æ•°ã®é€Ÿåº¦ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¡¨ã•ã‚Œã¾ã™ï¼š
                        \[
                        n(\mathbf{r}, t) = \int f(\mathbf{r}, \mathbf{v}, t) \, d\mathbf{v} \quad \text{ï¼ˆæ•°å¯†åº¦ï¼‰}
                        \]
                        \[
                        \mathbf{u}(\mathbf{r}, t) = \frac{1}{n} \int \mathbf{v} f(\mathbf{r}, \mathbf{v}, t) \, d\mathbf{v} \quad \text{ï¼ˆæµé€Ÿï¼‰}
                        \]
                    </p>
                </div>

                <div class="example-box">
                    <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: Maxwellåˆ†å¸ƒã®å¯è¦–åŒ–</h3>
                    <div class="code-container">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import maxwell

class MaxwellDistribution:
    """Maxwellé€Ÿåº¦åˆ†å¸ƒã®è§£æã¨å¯è¦–åŒ–"""
    
    def __init__(self, temperature, mass):
        """
        Parameters:
            temperature: æ¸©åº¦ [K]
            mass: ç²’å­è³ªé‡ [kg]
        """
        self.T = temperature
        self.m = mass
        self.kB = 1.380649e-23  # Boltzmannå®šæ•°
        
        # ç‰¹æ€§é€Ÿåº¦
        self.v_mean = np.sqrt(8 * self.kB * self.T / (np.pi * self.m))
        self.v_rms = np.sqrt(3 * self.kB * self.T / self.m)
        self.v_prob = np.sqrt(2 * self.kB * self.T / self.m)
        
    def distribution(self, v):
        """Maxwellé€Ÿåº¦åˆ†å¸ƒé–¢æ•°"""
        a = np.sqrt(self.kB * self.T / self.m)
        return maxwell.pdf(v, scale=a)
    
    def plot_distribution(self):
        """åˆ†å¸ƒé–¢æ•°ã®ãƒ—ãƒ­ãƒƒãƒˆ"""
        v = np.linspace(0, 4*self.v_rms, 1000)
        f_v = self.distribution(v)
        
        fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))
        
        # é€Ÿåº¦åˆ†å¸ƒ
        ax1.plot(v, f_v, 'b-', linewidth=2, label='Maxwellåˆ†å¸ƒ')
        ax1.axvline(self.v_prob, color='r', linestyle='--', 
                   label=f'æœ€ç¢ºé€Ÿåº¦ = {self.v_prob:.1f} m/s')
        ax1.axvline(self.v_mean, color='g', linestyle='--',
                   label=f'å¹³å‡é€Ÿåº¦ = {self.v_mean:.1f} m/s')
        ax1.axvline(self.v_rms, color='purple', linestyle='--',
                   label=f'RMSé€Ÿåº¦ = {self.v_rms:.1f} m/s')
        ax1.set_xlabel('é€Ÿåº¦ v [m/s]', fontsize=12)
        ax1.set_ylabel('ç¢ºç‡å¯†åº¦ f(v)', fontsize=12)
        ax1.set_title(f'Maxwellé€Ÿåº¦åˆ†å¸ƒ (T={self.T}K)', fontsize=14, fontweight='bold')
        ax1.legend()
        ax1.grid(True, alpha=0.3)
        
        # æ¸©åº¦ä¾å­˜æ€§
        temperatures = [100, 300, 500, 1000]
        for T in temperatures:
            md = MaxwellDistribution(T, self.m)
            v = np.linspace(0, 3000, 1000)
            ax2.plot(v, md.distribution(v), label=f'T={T}K')
        
        ax2.set_xlabel('é€Ÿåº¦ v [m/s]', fontsize=12)
        ax2.set_ylabel('ç¢ºç‡å¯†åº¦ f(v)', fontsize=12)
        ax2.set_title('æ¸©åº¦ä¾å­˜æ€§', fontsize=14, fontweight='bold')
        ax2.legend()
        ax2.grid(True, alpha=0.3)
        
        plt.tight_layout()
        return fig

# å®Ÿè¡Œä¾‹: çª’ç´ åˆ†å­ï¼ˆå®¤æ¸©ï¼‰
m_N2 = 28.014 * 1.66054e-27  # kg
maxwell_N2 = MaxwellDistribution(temperature=300, mass=m_N2)
fig = maxwell_N2.plot_distribution()
plt.show()

print(f"æœ€ç¢ºé€Ÿåº¦: {maxwell_N2.v_prob:.2f} m/s")
print(f"å¹³å‡é€Ÿåº¦: {maxwell_N2.v_mean:.2f} m/s")
print(f"RMSé€Ÿåº¦: {maxwell_N2.v_rms:.2f} m/s")</div>
                </div>
            </section>

            <section>
                <h2>1.2 ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã®å°å‡º</h2>
                
                <div class="theory-box">
                    <h3>ç†è«–: ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼</h3>
                    <p>
                        åˆ†å¸ƒé–¢æ•°ã®æ™‚é–“ç™ºå±•ã¯ã€å¤–åŠ›ã¨è¡çªã®åŠ¹æœã‚’è€ƒæ…®ã—ãŸãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã§è¨˜è¿°ã•ã‚Œã¾ã™ï¼š
                        \[
                        \frac{\partial f}{\partial t} + \mathbf{v} \cdot \nabla_{\mathbf{r}} f + \frac{\mathbf{F}}{m} \cdot \nabla_{\mathbf{v}} f = \left( \frac{\partial f}{\partial t} \right)_{\text{coll}}
                        \]
                    </p>
                    <p>
                        å·¦è¾ºã®å„é …ã®ç‰©ç†çš„æ„å‘³ï¼š
                    </p>
                    <ul>
                        <li>\( \frac{\partial f}{\partial t} \): åˆ†å¸ƒã®æ™‚é–“å¤‰åŒ–</li>
                        <li>\( \mathbf{v} \cdot \nabla_{\mathbf{r}} f \): ä½ç½®ç©ºé–“ã§ã®æµã‚Œ</li>
                        <li>\( \frac{\mathbf{F}}{m} \cdot \nabla_{\mathbf{v}} f \): å¤–åŠ›ã«ã‚ˆã‚‹é€Ÿåº¦ç©ºé–“ã§ã®æµã‚Œ</li>
                        <li>å³è¾º: è¡çªã«ã‚ˆã‚‹åˆ†å¸ƒã®å¤‰åŒ–ï¼ˆè¡çªé …ï¼‰</li>
                    </ul>
                    <p>
                        è¡çªé …ã®è©³ç´°ãªå½¢ï¼š
                        \[
                        \left( \frac{\partial f}{\partial t} \right)_{\text{coll}} = \int \int [f(\mathbf{v}')f(\mathbf{v}_1') - f(\mathbf{v})f(\mathbf{v}_1)] \sigma(\Omega) |\mathbf{v} - \mathbf{v}_1| \, d\Omega \, d\mathbf{v}_1
                        \]
                        ã“ã“ã§ \( \sigma(\Omega) \) ã¯å¾®åˆ†æ•£ä¹±æ–­é¢ç©ã§ã™ã€‚
                    </p>
                </div>

                <div class="example-box">
                    <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: è‡ªç”±æµä¸­ã®ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼</h3>
                    <div class="code-container">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation

class FreeBoltzmannSolver:
    """è¡çªãªã—è‡ªç”±æµã®ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã‚½ãƒ«ãƒãƒ¼"""
    
    def __init__(self, Nx=100, Nv=100, Lx=10.0, v_max=3.0):
        """
        Parameters:
            Nx: ä½ç½®ã‚°ãƒªãƒƒãƒ‰ç‚¹æ•°
            Nv: é€Ÿåº¦ã‚°ãƒªãƒƒãƒ‰ç‚¹æ•°
            Lx: ç©ºé–“é ˜åŸŸã‚µã‚¤ã‚º
            v_max: é€Ÿåº¦é ˜åŸŸã®æœ€å¤§å€¤
        """
        self.Nx = Nx
        self.Nv = Nv
        self.Lx = Lx
        self.v_max = v_max
        
        # ã‚°ãƒªãƒƒãƒ‰ç”Ÿæˆ
        self.x = np.linspace(0, Lx, Nx)
        self.v = np.linspace(-v_max, v_max, Nv)
        self.dx = self.x[1] - self.x[0]
        self.dv = self.v[1] - self.v[0]
        
        # åˆ†å¸ƒé–¢æ•°ï¼ˆ2æ¬¡å…ƒé…åˆ—: x, vï¼‰
        self.f = np.zeros((Nx, Nv))
        
    def initialize_gaussian(self, x0, v0, sigma_x, sigma_v):
        """ã‚¬ã‚¦ã‚¹å‹åˆæœŸåˆ†å¸ƒ"""
        X, V = np.meshgrid(self.x, self.v, indexing='ij')
        self.f = np.exp(-((X - x0)**2 / (2*sigma_x**2) + 
                         (V - v0)**2 / (2*sigma_v**2)))
        self.f /= np.sum(self.f) * self.dx * self.dv  # è¦æ ¼åŒ–
        
    def step(self, dt):
        """æ™‚é–“ç™ºå±•ï¼ˆ1ã‚¹ãƒ†ãƒƒãƒ—ï¼‰- Upwindæ³•"""
        f_new = self.f.copy()
        
        for i in range(self.Nx):
            for j in range(self.Nv):
                v_ij = self.v[j]
                
                if v_ij > 0:  # å³å‘ãç§»æµ
                    if i > 0:
                        f_new[i, j] = self.f[i, j] - v_ij * dt / self.dx * \
                                      (self.f[i, j] - self.f[i-1, j])
                elif v_ij < 0:  # å·¦å‘ãç§»æµ
                    if i < self.Nx - 1:
                        f_new[i, j] = self.f[i, j] - v_ij * dt / self.dx * \
                                      (self.f[i+1, j] - self.f[i, j])
        
        self.f = f_new
        
    def get_density(self):
        """æ•°å¯†åº¦ n(x)"""
        return np.sum(self.f, axis=1) * self.dv
    
    def get_mean_velocity(self):
        """å¹³å‡é€Ÿåº¦ u(x)"""
        n = self.get_density()
        u = np.sum(self.f * self.v[np.newaxis, :], axis=1) * self.dv
        return u / (n + 1e-10)
    
    def plot_state(self, t):
        """ç¾åœ¨ã®çŠ¶æ…‹ã‚’ãƒ—ãƒ­ãƒƒãƒˆ"""
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # åˆ†å¸ƒé–¢æ•°f(x,v)
        ax = axes[0, 0]
        im = ax.contourf(self.x, self.v, self.f.T, levels=20, cmap='viridis')
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_title(f'åˆ†å¸ƒé–¢æ•° f(x,v) at t={t:.2f}', fontsize=14, fontweight='bold')
        plt.colorbar(im, ax=ax)
        
        # æ•°å¯†åº¦n(x)
        ax = axes[0, 1]
        n = self.get_density()
        ax.plot(self.x, n, 'b-', linewidth=2)
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('æ•°å¯†åº¦ n(x)', fontsize=12)
        ax.set_title('æ•°å¯†åº¦åˆ†å¸ƒ', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        
        # å¹³å‡é€Ÿåº¦u(x)
        ax = axes[1, 0]
        u = self.get_mean_velocity()
        ax.plot(self.x, u, 'r-', linewidth=2)
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('å¹³å‡é€Ÿåº¦ u(x)', fontsize=12)
        ax.set_title('é€Ÿåº¦å ´', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        
        # é€Ÿåº¦åˆ†å¸ƒï¼ˆç‰¹å®šä½ç½®ï¼‰
        ax = axes[1, 1]
        for x_pos in [self.Nx//4, self.Nx//2, 3*self.Nx//4]:
            ax.plot(self.v, self.f[x_pos, :], label=f'x={self.x[x_pos]:.2f}')
        ax.set_xlabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_ylabel('åˆ†å¸ƒ f(v)', fontsize=12)
        ax.set_title('é€Ÿåº¦åˆ†å¸ƒï¼ˆå„ä½ç½®ï¼‰', fontsize=14, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        return fig

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
solver = FreeBoltzmannSolver(Nx=100, Nv=100)
solver.initialize_gaussian(x0=2.0, v0=1.0, sigma_x=0.5, sigma_v=0.3)

dt = 0.01
for step in range(100):
    solver.step(dt)

fig = solver.plot_state(t=1.0)
plt.show()</div>
                </div>
            </section>

            <section>
                <h2>1.3 Hå®šç†ã¨ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¢—å¤§å‰‡</h2>
                
                <div class="theory-box">
                    <h3>ç†è«–: Hå®šç†</h3>
                    <p>
                        Boltzmannã¯ã€Hé–¢æ•°ã‚’æ¬¡ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã—ãŸï¼š
                        \[
                        H(t) = \int f(\mathbf{r}, \mathbf{v}, t) \ln f(\mathbf{r}, \mathbf{v}, t) \, d\mathbf{r} \, d\mathbf{v}
                        \]
                        ã“ã®é–¢æ•°ã¯ç†±åŠ›å­¦çš„ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ \( S \) ã¨ \( S = -k_B H \) ã®é–¢ä¿‚ã«ã‚ã‚Šã¾ã™ã€‚
                    </p>
                    <p>
                        <strong>Hå®šç†</strong>: ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã®è§£ã«å¯¾ã—ã¦ã€
                        \[
                        \frac{dH}{dt} \leq 0
                        \]
                        ãŒæˆã‚Šç«‹ã¡ã€ç­‰å·ã¯Maxwellåˆ†å¸ƒã®ã¨ãã«é™ã‚Šæˆç«‹ã—ã¾ã™ã€‚
                    </p>
                    <p>
                        è¨¼æ˜ã®æ¦‚ç•¥ï¼š
                        \[
                        \frac{dH}{dt} = \int (\ln f + 1) \left( \frac{\partial f}{\partial t} \right)_{\text{coll}} d\mathbf{r} d\mathbf{v}
                        \]
                        è¡çªé …ã®æ€§è³ªã‚’ç”¨ã„ã¦ã€ã“ã®ç©åˆ†ãŒå¸¸ã«éæ­£ã§ã‚ã‚‹ã“ã¨ã‚’ç¤ºã›ã¾ã™ã€‚
                        Maxwellåˆ†å¸ƒ \( f_M \propto \exp(-\beta m v^2/2) \) ã§ã¯ \( \frac{dH}{dt} = 0 \) ã¨ãªã‚Šã€
                        ã“ã‚ŒãŒå¹³è¡¡çŠ¶æ…‹ã«å¯¾å¿œã—ã¾ã™ã€‚
                    </p>
                </div>

                <div class="example-box">
                    <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: Hé–¢æ•°ã®æ™‚é–“ç™ºå±•</h3>
                    <div class="code-container">import numpy as np
import matplotlib.pyplot as plt

class HTheoremDemo:
    """Hå®šç†ã®ãƒ‡ãƒ¢ãƒ³ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""
    
    def __init__(self, N_particles=1000, N_bins=50):
        """
        Parameters:
            N_particles: ç²’å­æ•°
            N_bins: é€Ÿåº¦ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã®ãƒ“ãƒ³æ•°
        """
        self.N = N_particles
        self.N_bins = N_bins
        
        # é€Ÿåº¦ã®ç¯„å›²
        self.v_min, self.v_max = -5.0, 5.0
        self.bins = np.linspace(self.v_min, self.v_max, N_bins+1)
        self.bin_centers = 0.5 * (self.bins[:-1] + self.bins[1:])
        
    def initialize_two_maxwellians(self, T1=1.0, T2=4.0):
        """2ã¤ã®ç•°ãªã‚‹æ¸©åº¦ã®Maxwellåˆ†å¸ƒã®æ··åˆ"""
        N1 = self.N // 2
        N2 = self.N - N1
        
        v1 = np.random.normal(0, np.sqrt(T1), N1)
        v2 = np.random.normal(0, np.sqrt(T2), N2)
        
        self.velocities = np.concatenate([v1, v2])
        
    def compute_H(self, velocities):
        """Hé–¢æ•°ã®è¨ˆç®—"""
        # ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã§åˆ†å¸ƒé–¢æ•°ã‚’è¿‘ä¼¼
        hist, _ = np.histogram(velocities, bins=self.bins, density=True)
        
        # H = âˆ« f ln(f) dv â‰ˆ Î£ f_i ln(f_i) Î”v
        H = 0.0
        dv = self.bins[1] - self.bins[0]
        
        for f_i in hist:
            if f_i > 1e-10:  # ã‚¼ãƒ­é™¤ç®—å›é¿
                H += f_i * np.log(f_i) * dv
                
        return H
    
    def maxwell_boltzmann_collision(self, dt, cross_section=0.1):
        """ç°¡ç•¥åŒ–ã•ã‚ŒãŸè¡çªéç¨‹"""
        N_collisions = int(cross_section * self.N * dt)
        
        for _ in range(N_collisions):
            # ãƒ©ãƒ³ãƒ€ãƒ ã«2ç²’å­ã‚’é¸æŠ
            i, j = np.random.choice(self.N, size=2, replace=False)
            
            v_i = self.velocities[i]
            v_j = self.velocities[j]
            
            # é‡å¿ƒç³»é€Ÿåº¦ã¨ç›¸å¯¾é€Ÿåº¦
            v_cm = 0.5 * (v_i + v_j)
            v_rel = v_i - v_j
            
            # ãƒ©ãƒ³ãƒ€ãƒ ãªè§’åº¦ã§æ•£ä¹±
            theta = np.random.uniform(0, 2*np.pi)
            v_rel_new = v_rel * np.array([np.cos(theta), np.sin(theta)])[0]
            
            # è¡çªå¾Œã®é€Ÿåº¦
            self.velocities[i] = v_cm + 0.5 * v_rel_new
            self.velocities[j] = v_cm - 0.5 * v_rel_new
    
    def simulate(self, T_max=10.0, dt=0.1):
        """æ™‚é–“ç™ºå±•ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""
        times = np.arange(0, T_max, dt)
        H_values = []
        
        for t in times:
            H = self.compute_H(self.velocities)
            H_values.append(H)
            
            self.maxwell_boltzmann_collision(dt)
        
        return times, H_values
    
    def plot_evolution(self, times, H_values):
        """Hé–¢æ•°ã®æ™‚é–“ç™ºå±•ã¨åˆ†å¸ƒé–¢æ•°ã®å¤‰åŒ–"""
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # Hé–¢æ•°ã®æ™‚é–“ç™ºå±•
        ax = axes[0, 0]
        ax.plot(times, H_values, 'b-', linewidth=2)
        ax.set_xlabel('æ™‚é–“ t', fontsize=12)
        ax.set_ylabel('Hé–¢æ•°', fontsize=12)
        ax.set_title('Hå®šç†: dH/dt â‰¤ 0', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        ax.axhline(y=H_values[-1], color='r', linestyle='--', 
                   label='å¹³è¡¡å€¤')
        ax.legend()
        
        # Hé–¢æ•°ã®æ™‚é–“å¾®åˆ†
        ax = axes[0, 1]
        dH_dt = np.gradient(H_values, times[1] - times[0])
        ax.plot(times, dH_dt, 'r-', linewidth=2)
        ax.axhline(y=0, color='k', linestyle='--', alpha=0.5)
        ax.set_xlabel('æ™‚é–“ t', fontsize=12)
        ax.set_ylabel('dH/dt', fontsize=12)
        ax.set_title('ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ç”Ÿæˆç‡', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        
        # åˆæœŸåˆ†å¸ƒ
        ax = axes[1, 0]
        demo_init = HTheoremDemo(self.N, self.N_bins)
        demo_init.initialize_two_maxwellians()
        ax.hist(demo_init.velocities, bins=self.bins, density=True, 
               alpha=0.7, color='blue', label='åˆæœŸçŠ¶æ…‹')
        ax.set_xlabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_ylabel('ç¢ºç‡å¯†åº¦ f(v)', fontsize=12)
        ax.set_title('åˆæœŸé€Ÿåº¦åˆ†å¸ƒï¼ˆ2æ¸©åº¦æ··åˆï¼‰', fontsize=14, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        # æœ€çµ‚åˆ†å¸ƒ
        ax = axes[1, 1]
        ax.hist(self.velocities, bins=self.bins, density=True,
               alpha=0.7, color='green', label='å¹³è¡¡çŠ¶æ…‹')
        
        # ç†è«–çš„Maxwellåˆ†å¸ƒ
        T_eq = np.var(self.velocities)
        v_theory = np.linspace(self.v_min, self.v_max, 200)
        f_maxwell = (1/np.sqrt(2*np.pi*T_eq)) * np.exp(-v_theory**2/(2*T_eq))
        ax.plot(v_theory, f_maxwell, 'r--', linewidth=2, label='Maxwellåˆ†å¸ƒ')
        
        ax.set_xlabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_ylabel('ç¢ºç‡å¯†åº¦ f(v)', fontsize=12)
        ax.set_title('å¹³è¡¡é€Ÿåº¦åˆ†å¸ƒ', fontsize=14, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        return fig

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
demo = HTheoremDemo(N_particles=10000, N_bins=50)
demo.initialize_two_maxwellians(T1=1.0, T2=4.0)

times, H_values = demo.simulate(T_max=20.0, dt=0.1)
fig = demo.plot_evolution(times, H_values)
plt.show()

print(f"åˆæœŸHå€¤: {H_values[0]:.4f}")
print(f"æœ€çµ‚Hå€¤: {H_values[-1]:.4f}")
print(f"Î”H = {H_values[-1] - H_values[0]:.4f} < 0 (ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¢—å¤§)")</div>
                </div>
            </section>

            <section>
                <h2>1.4 ç·©å’Œæ™‚é–“è¿‘ä¼¼ï¼ˆBGKè¿‘ä¼¼ï¼‰</h2>
                
                <div class="theory-box">
                    <h3>ç†è«–: BGKè¡çªæ¼”ç®—å­</h3>
                    <p>
                        å®Œå…¨ãªè¡çªé …ã®è¨ˆç®—ã¯éå¸¸ã«è¤‡é›‘ã§ã™ã€‚Bhatnagar-Gross-Krook (BGK)ã¯ã€
                        è¡çªé …ã‚’ç·©å’Œæ™‚é–“ \( \tau \) ã‚’ç”¨ã„ã¦è¿‘ä¼¼ã—ã¾ã—ãŸï¼š
                        \[
                        \left( \frac{\partial f}{\partial t} \right)_{\text{coll}} = -\frac{f - f^{(0)}}{\tau}
                        \]
                        ã“ã“ã§ \( f^{(0)} \) ã¯å±€æ‰€Maxwellåˆ†å¸ƒï¼š
                        \[
                        f^{(0)}(\mathbf{v}) = n \left( \frac{m}{2\pi k_B T} \right)^{3/2} \exp\left( -\frac{m(\mathbf{v} - \mathbf{u})^2}{2k_B T} \right)
                        \]
                    </p>
                    <p>
                        ã“ã®è¿‘ä¼¼ã«ã‚ˆã‚Šã€ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã¯ï¼š
                        \[
                        \frac{\partial f}{\partial t} + \mathbf{v} \cdot \nabla_{\mathbf{r}} f = -\frac{f - f^{(0)}}{\tau}
                        \]
                        ã¨ãªã‚Šã€æ•°å€¤è¨ˆç®—ãŒå¤§å¹…ã«ç°¡ç•¥åŒ–ã•ã‚Œã¾ã™ã€‚
                    </p>
                </div>

                <div class="example-box">
                    <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: BGKæ–¹ç¨‹å¼ã®æ•°å€¤è§£æ³•</h3>
                    <div class="code-container">import numpy as np
import matplotlib.pyplot as plt

class BGKSolver:
    """BGKæ–¹ç¨‹å¼ã‚½ãƒ«ãƒãƒ¼"""
    
    def __init__(self, Nx=100, Nv=64, Lx=10.0, v_max=5.0, tau=1.0):
        """
        Parameters:
            Nx: ç©ºé–“ã‚°ãƒªãƒƒãƒ‰æ•°
            Nv: é€Ÿåº¦ã‚°ãƒªãƒƒãƒ‰æ•°
            Lx: ç©ºé–“é ˜åŸŸã‚µã‚¤ã‚º
            v_max: é€Ÿåº¦é ˜åŸŸã®æœ€å¤§å€¤
            tau: ç·©å’Œæ™‚é–“
        """
        self.Nx = Nx
        self.Nv = Nv
        self.Lx = Lx
        self.v_max = v_max
        self.tau = tau
        
        # ã‚°ãƒªãƒƒãƒ‰
        self.x = np.linspace(0, Lx, Nx)
        self.v = np.linspace(-v_max, v_max, Nv)
        self.dx = self.x[1] - self.x[0]
        self.dv = self.v[1] - self.v[0]
        
        # åˆ†å¸ƒé–¢æ•°
        self.f = np.zeros((Nx, Nv))
        
    def local_maxwell(self, n, u, T):
        """å±€æ‰€Maxwellåˆ†å¸ƒ"""
        f_eq = np.zeros((self.Nx, self.Nv))
        
        for i in range(self.Nx):
            for j in range(self.Nv):
                v_rel = self.v[j] - u[i]
                f_eq[i, j] = n[i] / np.sqrt(2*np.pi*T[i]) * \
                            np.exp(-v_rel**2 / (2*T[i]))
        
        return f_eq
    
    def compute_moments(self):
        """ãƒã‚¯ãƒ­é‡ã®è¨ˆç®—"""
        # æ•°å¯†åº¦
        n = np.sum(self.f, axis=1) * self.dv
        
        # å¹³å‡é€Ÿåº¦
        u = np.sum(self.f * self.v[np.newaxis, :], axis=1) * self.dv / (n + 1e-10)
        
        # æ¸©åº¦
        v_rel_sq = np.zeros(self.Nx)
        for i in range(self.Nx):
            v_rel_sq[i] = np.sum(self.f[i, :] * (self.v - u[i])**2) * self.dv
        T = v_rel_sq / (n + 1e-10)
        
        return n, u, T
    
    def step_BGK(self, dt):
        """BGKæ–¹ç¨‹å¼ã®æ™‚é–“ç™ºå±•"""
        # ãƒã‚¯ãƒ­é‡è¨ˆç®—
        n, u, T = self.compute_moments()
        
        # å±€æ‰€Maxwellåˆ†å¸ƒ
        f_eq = self.local_maxwell(n, u, T)
        
        # BGKè¡çªé …
        collision_term = -(self.f - f_eq) / self.tau
        
        # ç§»æµé …ï¼ˆUpwindæ³•ï¼‰
        advection_term = np.zeros_like(self.f)
        for j in range(self.Nv):
            v_j = self.v[j]
            if v_j > 0:
                advection_term[1:, j] = -v_j * (self.f[1:, j] - self.f[:-1, j]) / self.dx
            else:
                advection_term[:-1, j] = -v_j * (self.f[1:, j] - self.f[:-1, j]) / self.dx
        
        # æ™‚é–“ç™ºå±•
        self.f += dt * (advection_term + collision_term)
        
    def initialize_shock(self, x_shock=5.0):
        """è¡æ’ƒæ³¢å•é¡Œã®åˆæœŸæ¡ä»¶"""
        n_L, u_L, T_L = 2.0, 1.0, 1.0  # å·¦å´
        n_R, u_R, T_R = 1.0, 0.0, 0.5  # å³å´
        
        for i in range(self.Nx):
            if self.x[i] < x_shock:
                n, u, T = n_L, u_L, T_L
            else:
                n, u, T = n_R, u_R, T_R
            
            for j in range(self.Nv):
                v_rel = self.v[j] - u
                self.f[i, j] = n / np.sqrt(2*np.pi*T) * np.exp(-v_rel**2/(2*T))
    
    def plot_solution(self, t):
        """è§£ã®ãƒ—ãƒ­ãƒƒãƒˆ"""
        n, u, T = self.compute_moments()
        
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # åˆ†å¸ƒé–¢æ•°
        ax = axes[0, 0]
        im = ax.contourf(self.x, self.v, self.f.T, levels=20, cmap='plasma')
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_title(f'åˆ†å¸ƒé–¢æ•° f(x,v) at t={t:.2f}', fontsize=14, fontweight='bold')
        plt.colorbar(im, ax=ax)
        
        # æ•°å¯†åº¦
        ax = axes[0, 1]
        ax.plot(self.x, n, 'b-', linewidth=2)
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('æ•°å¯†åº¦ n(x)', fontsize=12)
        ax.set_title('æ•°å¯†åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        
        # æµé€Ÿ
        ax = axes[1, 0]
        ax.plot(self.x, u, 'r-', linewidth=2)
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('æµé€Ÿ u(x)', fontsize=12)
        ax.set_title('æµé€Ÿãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        
        # æ¸©åº¦
        ax = axes[1, 1]
        ax.plot(self.x, T, 'g-', linewidth=2)
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('æ¸©åº¦ T(x)', fontsize=12)
        ax.set_title('æ¸©åº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        return fig

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
solver = BGKSolver(Nx=100, Nv=64, tau=0.5)
solver.initialize_shock(x_shock=5.0)

dt = 0.01
for step in range(200):
    solver.step_BGK(dt)

fig = solver.plot_solution(t=2.0)
plt.show()</div>
                </div>
            </section>

            <section>
                <h2>1.5 æ•°å€¤ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè·µ</h2>
                
                <div class="example-box">
                    <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: æ°—ä½“åˆ†å­ã®ç›´æ¥ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ (DSMCæ³•)</h3>
                    <div class="code-container">import numpy as np
import matplotlib.pyplot as plt

class DSMCSimulator:
    """Direct Simulation Monte Carloæ³•"""
    
    def __init__(self, N_particles=10000, Lx=10.0, N_cells=50):
        """
        Parameters:
            N_particles: ç²’å­æ•°
            Lx: ç©ºé–“é ˜åŸŸã‚µã‚¤ã‚º
            N_cells: ã‚»ãƒ«æ•°
        """
        self.N = N_particles
        self.Lx = Lx
        self.N_cells = N_cells
        self.dx = Lx / N_cells
        
        # ç²’å­ä½ç½®ã¨é€Ÿåº¦
        self.x = np.random.uniform(0, Lx, N_particles)
        self.v = np.zeros(N_particles)
        
    def initialize_two_stream(self):
        """2æµä½“åˆæœŸæ¡ä»¶"""
        N_half = self.N // 2
        self.v[:N_half] = np.random.normal(2.0, 0.5, N_half)
        self.v[N_half:] = np.random.normal(-2.0, 0.5, self.N - N_half)
    
    def advect(self, dt):
        """ç²’å­ã®ç§»æµ"""
        self.x += self.v * dt
        
        # å‘¨æœŸå¢ƒç•Œæ¡ä»¶
        self.x = self.x % self.Lx
    
    def collide(self, dt, sigma_collision=0.5):
        """ç²’å­è¡çªå‡¦ç†"""
        # ã‚»ãƒ«ã”ã¨ã«ç²’å­ã‚’åˆ†é¡
        cell_indices = (self.x / self.dx).astype(int)
        
        for cell in range(self.N_cells):
            # ã“ã®ã‚»ãƒ«å†…ã®ç²’å­ã‚’å–å¾—
            particles_in_cell = np.where(cell_indices == cell)[0]
            N_cell = len(particles_in_cell)
            
            if N_cell < 2:
                continue
            
            # è¡çªå›æ•°ã®æ¨å®š
            N_collisions = int(0.5 * N_cell * sigma_collision * dt / self.dx + 0.5)
            
            for _ in range(N_collisions):
                # ãƒ©ãƒ³ãƒ€ãƒ ã«2ç²’å­é¸æŠ
                if N_cell >= 2:
                    i, j = np.random.choice(particles_in_cell, size=2, replace=False)
                    
                    # ç›¸å¯¾é€Ÿåº¦
                    v_rel = self.v[i] - self.v[j]
                    
                    # è¡çªå¾Œã®é€Ÿåº¦ï¼ˆç­‰æ–¹æ•£ä¹±ï¼‰
                    v_cm = 0.5 * (self.v[i] + self.v[j])
                    theta = np.random.uniform(0, 2*np.pi)
                    v_rel_new = abs(v_rel) * np.cos(theta)
                    
                    self.v[i] = v_cm + 0.5 * v_rel_new
                    self.v[j] = v_cm - 0.5 * v_rel_new
    
    def compute_distribution(self, N_bins=50):
        """ä½ç›¸ç©ºé–“åˆ†å¸ƒã®è¨ˆç®—"""
        x_bins = np.linspace(0, self.Lx, N_bins+1)
        v_bins = np.linspace(self.v.min()-1, self.v.max()+1, N_bins+1)
        
        H, xedges, vedges = np.histogram2d(self.x, self.v, bins=[x_bins, v_bins])
        
        return H.T, xedges, vedges
    
    def run_simulation(self, T_max=5.0, dt=0.01):
        """ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ"""
        times = np.arange(0, T_max, dt)
        entropy = []
        
        for t in times:
            self.advect(dt)
            self.collide(dt)
            
            # ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼è¨ˆç®—
            H, _, _ = self.compute_distribution(N_bins=30)
            H_norm = H / (H.sum() + 1e-10)
            S = -np.sum(H_norm * np.log(H_norm + 1e-10))
            entropy.append(S)
        
        return times, entropy
    
    def plot_phase_space(self, t):
        """ä½ç›¸ç©ºé–“ãƒ—ãƒ­ãƒƒãƒˆ"""
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # ä½ç›¸ç©ºé–“æ•£å¸ƒå›³
        ax = axes[0, 0]
        ax.scatter(self.x, self.v, alpha=0.3, s=1)
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_title(f'ä½ç›¸ç©ºé–“ t={t:.2f}', fontsize=14, fontweight='bold')
        ax.set_xlim(0, self.Lx)
        
        # ä½ç›¸ç©ºé–“å¯†åº¦
        ax = axes[0, 1]
        H, xedges, vedges = self.compute_distribution(N_bins=50)
        im = ax.contourf(xedges[:-1], vedges[:-1], H, levels=20, cmap='viridis')
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_title('åˆ†å¸ƒé–¢æ•°å¯†åº¦', fontsize=14, fontweight='bold')
        plt.colorbar(im, ax=ax)
        
        # ç©ºé–“å¯†åº¦
        ax = axes[1, 0]
        x_hist, x_bins = np.histogram(self.x, bins=50, density=True)
        ax.bar(x_bins[:-1], x_hist, width=x_bins[1]-x_bins[0], alpha=0.7)
        ax.set_xlabel('ä½ç½® x', fontsize=12)
        ax.set_ylabel('å¯†åº¦', fontsize=12)
        ax.set_title('ç©ºé–“å¯†åº¦åˆ†å¸ƒ', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        
        # é€Ÿåº¦åˆ†å¸ƒ
        ax = axes[1, 1]
        v_hist, v_bins = np.histogram(self.v, bins=50, density=True)
        ax.bar(v_bins[:-1], v_hist, width=v_bins[1]-v_bins[0], alpha=0.7)
        
        # Maxwellåˆ†å¸ƒï¼ˆç†è«–å€¤ï¼‰
        T = np.var(self.v)
        v_theory = np.linspace(self.v.min(), self.v.max(), 200)
        f_maxwell = (1/np.sqrt(2*np.pi*T)) * np.exp(-v_theory**2/(2*T))
        ax.plot(v_theory, f_maxwell, 'r--', linewidth=2, label='Maxwellåˆ†å¸ƒ')
        
        ax.set_xlabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_ylabel('ç¢ºç‡å¯†åº¦', fontsize=12)
        ax.set_title('é€Ÿåº¦åˆ†å¸ƒ', fontsize=14, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        return fig

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
dsmc = DSMCSimulator(N_particles=20000, Lx=10.0, N_cells=50)
dsmc.initialize_two_stream()

times, entropy = dsmc.run_simulation(T_max=5.0, dt=0.01)

# æ™‚é–“ç™ºå±•ã®ãƒ—ãƒ­ãƒƒãƒˆ
fig_phase = dsmc.plot_phase_space(t=5.0)
plt.show()

# ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¢—å¤§
fig_entropy, ax = plt.subplots(figsize=(10, 6))
ax.plot(times, entropy, 'b-', linewidth=2)
ax.set_xlabel('æ™‚é–“ t', fontsize=12)
ax.set_ylabel('ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ S', fontsize=12)
ax.set_title('DSMCæ³•ã«ã‚ˆã‚‹ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¢—å¤§', fontsize=14, fontweight='bold')
ax.grid(True, alpha=0.3)
plt.show()

print(f"åˆæœŸã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: {entropy[0]:.4f}")
print(f"æœ€çµ‚ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: {entropy[-1]:.4f}")
print(f"ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¢—åŠ : {entropy[-1] - entropy[0]:.4f}")</div>
                </div>

                <div class="example-box">
                    <h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: æ¸©åº¦ç·©å’Œéç¨‹</h3>
                    <div class="code-container">import numpy as np
import matplotlib.pyplot as plt

class TemperatureRelaxation:
    """æ¸©åº¦ç·©å’Œéç¨‹ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""
    
    def __init__(self, N1=5000, N2=5000, T1=2.0, T2=0.5):
        """
        2ã¤ã®ç•°ãªã‚‹æ¸©åº¦ã®æ°—ä½“ã®æ··åˆ
        
        Parameters:
            N1, N2: å„æ°—ä½“ã®ç²’å­æ•°
            T1, T2: åˆæœŸæ¸©åº¦
        """
        self.N1 = N1
        self.N2 = N2
        
        # åˆæœŸé€Ÿåº¦åˆ†å¸ƒ
        self.v1 = np.random.normal(0, np.sqrt(T1), N1)
        self.v2 = np.random.normal(0, np.sqrt(T2), N2)
        
    def compute_temperatures(self):
        """å„æ°—ä½“ã®æ¸©åº¦è¨ˆç®—"""
        T1 = np.var(self.v1)
        T2 = np.var(self.v2)
        return T1, T2
    
    def collide_step(self, dt, collision_rate=0.1):
        """è¡çªã«ã‚ˆã‚‹æ¸©åº¦ç·©å’Œ"""
        N_collisions = int(collision_rate * min(self.N1, self.N2) * dt)
        
        for _ in range(N_collisions):
            # å„æ°—ä½“ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«1ç²’å­é¸æŠ
            i = np.random.randint(0, self.N1)
            j = np.random.randint(0, self.N2)
            
            # è¡çªï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨é‹å‹•é‡ä¿å­˜ï¼‰
            v_cm = 0.5 * (self.v1[i] + self.v2[j])
            v_rel = self.v1[i] - self.v2[j]
            
            # æ•£ä¹±è§’
            theta = np.random.uniform(0, 2*np.pi)
            v_rel_new = abs(v_rel) * np.cos(theta)
            
            # è¡çªå¾Œã®é€Ÿåº¦
            self.v1[i] = v_cm + 0.5 * v_rel_new
            self.v2[j] = v_cm - 0.5 * v_rel_new
    
    def run_simulation(self, T_max=50.0, dt=0.1):
        """ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ"""
        times = np.arange(0, T_max, dt)
        T1_history = []
        T2_history = []
        
        for t in times:
            T1, T2 = self.compute_temperatures()
            T1_history.append(T1)
            T2_history.append(T2)
            
            self.collide_step(dt)
        
        return times, np.array(T1_history), np.array(T2_history)
    
    def plot_relaxation(self, times, T1_hist, T2_hist):
        """ç·©å’Œéç¨‹ã®ãƒ—ãƒ­ãƒƒãƒˆ"""
        fig, axes = plt.subplots(2, 2, figsize=(14, 10))
        
        # æ¸©åº¦ã®æ™‚é–“ç™ºå±•
        ax = axes[0, 0]
        ax.plot(times, T1_hist, 'r-', linewidth=2, label='æ°—ä½“1')
        ax.plot(times, T2_hist, 'b-', linewidth=2, label='æ°—ä½“2')
        
        # å¹³è¡¡æ¸©åº¦ï¼ˆç†è«–å€¤ï¼‰
        T_eq = (self.N1 * T1_hist[0] + self.N2 * T2_hist[0]) / (self.N1 + self.N2)
        ax.axhline(y=T_eq, color='k', linestyle='--', label=f'å¹³è¡¡æ¸©åº¦={T_eq:.3f}')
        
        ax.set_xlabel('æ™‚é–“ t', fontsize=12)
        ax.set_ylabel('æ¸©åº¦ T', fontsize=12)
        ax.set_title('æ¸©åº¦ç·©å’Œéç¨‹', fontsize=14, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        # æ¸©åº¦å·®ã®æ™‚é–“ç™ºå±•
        ax = axes[0, 1]
        dT = np.abs(T1_hist - T2_hist)
        ax.semilogy(times, dT, 'g-', linewidth=2)
        
        # æŒ‡æ•°é–¢æ•°çš„æ¸›è¡°ã®ãƒ•ã‚£ãƒƒãƒˆ
        from scipy.optimize import curve_fit
        def exp_decay(t, A, tau):
            return A * np.exp(-t/tau)
        
        try:
            popt, _ = curve_fit(exp_decay, times[10:], dT[10:], p0=[dT[10], 10.0])
            ax.semilogy(times, exp_decay(times, *popt), 'r--', 
                       label=f'ãƒ•ã‚£ãƒƒãƒˆ: Ï„={popt[1]:.2f}')
            ax.legend()
        except:
            pass
        
        ax.set_xlabel('æ™‚é–“ t', fontsize=12)
        ax.set_ylabel('æ¸©åº¦å·® |T1 - T2|', fontsize=12)
        ax.set_title('æ¸©åº¦å·®ã®ç·©å’Œï¼ˆå¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰', fontsize=14, fontweight='bold')
        ax.grid(True, alpha=0.3)
        
        # åˆæœŸé€Ÿåº¦åˆ†å¸ƒ
        ax = axes[1, 0]
        v1_init = np.random.normal(0, np.sqrt(T1_hist[0]), self.N1)
        v2_init = np.random.normal(0, np.sqrt(T2_hist[0]), self.N2)
        ax.hist(v1_init, bins=50, alpha=0.5, density=True, color='red', label='æ°—ä½“1 (é«˜æ¸©)')
        ax.hist(v2_init, bins=50, alpha=0.5, density=True, color='blue', label='æ°—ä½“2 (ä½æ¸©)')
        ax.set_xlabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_ylabel('ç¢ºç‡å¯†åº¦', fontsize=12)
        ax.set_title('åˆæœŸé€Ÿåº¦åˆ†å¸ƒ', fontsize=14, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        # æœ€çµ‚é€Ÿåº¦åˆ†å¸ƒ
        ax = axes[1, 1]
        ax.hist(self.v1, bins=50, alpha=0.5, density=True, color='red', label='æ°—ä½“1')
        ax.hist(self.v2, bins=50, alpha=0.5, density=True, color='blue', label='æ°—ä½“2')
        
        # å¹³è¡¡Maxwellåˆ†å¸ƒ
        v_range = np.linspace(-5, 5, 200)
        f_eq = (1/np.sqrt(2*np.pi*T_eq)) * np.exp(-v_range**2/(2*T_eq))
        ax.plot(v_range, f_eq, 'k--', linewidth=2, label='Maxwellåˆ†å¸ƒ')
        
        ax.set_xlabel('é€Ÿåº¦ v', fontsize=12)
        ax.set_ylabel('ç¢ºç‡å¯†åº¦', fontsize=12)
        ax.set_title('å¹³è¡¡é€Ÿåº¦åˆ†å¸ƒ', fontsize=14, fontweight='bold')
        ax.legend()
        ax.grid(True, alpha=0.3)
        
        plt.tight_layout()
        return fig

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
relaxation = TemperatureRelaxation(N1=10000, N2=10000, T1=3.0, T2=0.5)
times, T1_hist, T2_hist = relaxation.run_simulation(T_max=50.0, dt=0.1)

fig = relaxation.plot_relaxation(times, T1_hist, T2_hist)
plt.show()

print(f"åˆæœŸæ¸©åº¦: T1={T1_hist[0]:.3f}, T2={T2_hist[0]:.3f}")
print(f"æœ€çµ‚æ¸©åº¦: T1={T1_hist[-1]:.3f}, T2={T2_hist[-1]:.3f}")
print(f"ç†è«–å¹³è¡¡æ¸©åº¦: {(10000*T1_hist[0] + 10000*T2_hist[0])/20000:.3f}")</div>
                </div>

                <div class="example-box">
                    <h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: ç·åˆæ¼”ç¿’ - å¸Œè–„æ°—ä½“ã®æµã‚Œ</h3>
                    <div class="code-container">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation

class RarefiedGasFlow:
    """å¸Œè–„æ°—ä½“æµã‚Œã®ç·åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""
    
    def __init__(self, Nx=100, Nv=64, Lx=20.0, v_max=5.0, tau=0.5):
        self.Nx = Nx
        self.Nv = Nv
        self.Lx = Lx
        self.v_max = v_max
        self.tau = tau
        
        self.x = np.linspace(0, Lx, Nx)
        self.v = np.linspace(-v_max, v_max, Nv)
        self.dx = self.x[1] - self.x[0]
        self.dv = self.v[1] - self.v[0]
        
        self.f = np.zeros((Nx, Nv))
        
        # éšœå®³ç‰©ï¼ˆæµã‚Œã‚’é®ã‚‹å£ï¼‰
        self.obstacle_start = Nx // 3
        self.obstacle_end = Nx // 3 + Nx // 10
        
    def initialize_flow(self, n0=1.0, u0=2.0, T0=1.0):
        """æµã‚Œã®åˆæœŸæ¡ä»¶"""
        for i in range(self.Nx):
            for j in range(self.Nv):
                v_rel = self.v[j] - u0
                self.f[i, j] = n0 / np.sqrt(2*np.pi*T0) * \
                              np.exp(-v_rel**2/(2*T0))
    
    def compute_moments(self):
        """ãƒã‚¯ãƒ­é‡"""
        n = np.sum(self.f, axis=1) * self.dv
        u = np.sum(self.f * self.v[np.newaxis, :], axis=1) * self.dv / (n + 1e-10)
        
        v_rel_sq = np.zeros(self.Nx)
        for i in range(self.Nx):
            v_rel_sq[i] = np.sum(self.f[i, :] * (self.v - u[i])**2) * self.dv
        T = v_rel_sq / (n + 1e-10)
        
        return n, u, T
    
    def apply_boundary_conditions(self):
        """å¢ƒç•Œæ¡ä»¶ï¼ˆéšœå®³ç‰©ã§ã®åå°„ï¼‰"""
        # éšœå®³ç‰©ã§ã®å®Œå…¨åå°„
        for i in range(self.obstacle_start, self.obstacle_end):
            for j in range(self.Nv):
                if self.v[j] > 0 and i == self.obstacle_start:
                    # å³å‘ãé€Ÿåº¦ã‚’å·¦å‘ãã«åå°„
                    j_reflect = self.Nv - 1 - j
                    self.f[i, j_reflect] = self.f[i, j]
                    self.f[i, j] = 0
    
    def step(self, dt):
        """æ™‚é–“ç™ºå±•ï¼ˆBGK + ç§»æµï¼‰"""
        n, u, T = self.compute_moments()
        
        # å±€æ‰€Maxwellåˆ†å¸ƒ
        f_eq = np.zeros_like(self.f)
        for i in range(self.Nx):
            for j in range(self.Nv):
                v_rel = self.v[j] - u[i]
                f_eq[i, j] = n[i] / np.sqrt(2*np.pi*T[i]) * \
                            np.exp(-v_rel**2/(2*T[i]))
        
        # BGKè¡çª
        collision = -(self.f - f_eq) / self.tau
        
        # ç§»æµï¼ˆUpwindï¼‰
        advection = np.zeros_like(self.f)
        for j in range(self.Nv):
            v_j = self.v[j]
            if v_j > 0:
                advection[1:, j] = -v_j * (self.f[1:, j] - self.f[:-1, j]) / self.dx
                advection[0, j] = -v_j * (self.f[0, j] - self.f[-1, j]) / self.dx  # å‘¨æœŸå¢ƒç•Œ
            else:
                advection[:-1, j] = -v_j * (self.f[1:, j] - self.f[:-1, j]) / self.dx
                advection[-1, j] = -v_j * (self.f[0, j] - self.f[-1, j]) / self.dx
        
        # æ™‚é–“ç™ºå±•
        self.f += dt * (advection + collision)
        
        # å¢ƒç•Œæ¡ä»¶é©ç”¨
        self.apply_boundary_conditions()
    
    def plot_solution(self, t):
        """è§£ã®å¯è¦–åŒ–"""
        n, u, T = self.compute_moments()
        
        fig = plt.figure(figsize=(16, 12))
        gs = fig.add_gridspec(3, 2, hspace=0.3, wspace=0.3)
        
        # åˆ†å¸ƒé–¢æ•°
        ax1 = fig.add_subplot(gs[0, :])
        im = ax1.contourf(self.x, self.v, self.f.T, levels=30, cmap='viridis')
        
        # éšœå®³ç‰©ã®è¡¨ç¤º
        ax1.axvspan(self.x[self.obstacle_start], self.x[self.obstacle_end], 
                   alpha=0.3, color='red', label='éšœå®³ç‰©')
        
        ax1.set_xlabel('ä½ç½® x', fontsize=12)
        ax1.set_ylabel('é€Ÿåº¦ v', fontsize=12)
        ax1.set_title(f'ä½ç›¸ç©ºé–“åˆ†å¸ƒ t={t:.2f}', fontsize=14, fontweight='bold')
        ax1.legend(loc='upper right')
        plt.colorbar(im, ax=ax1, label='f(x,v)')
        
        # æ•°å¯†åº¦
        ax2 = fig.add_subplot(gs[1, 0])
        ax2.plot(self.x, n, 'b-', linewidth=2)
        ax2.axvspan(self.x[self.obstacle_start], self.x[self.obstacle_end],
                   alpha=0.2, color='red')
        ax2.set_xlabel('ä½ç½® x', fontsize=12)
        ax2.set_ylabel('æ•°å¯†åº¦ n', fontsize=12)
        ax2.set_title('å¯†åº¦å ´', fontsize=14, fontweight='bold')
        ax2.grid(True, alpha=0.3)
        
        # æµé€Ÿ
        ax3 = fig.add_subplot(gs[1, 1])
        ax3.plot(self.x, u, 'r-', linewidth=2)
        ax3.axvspan(self.x[self.obstacle_start], self.x[self.obstacle_end],
                   alpha=0.2, color='red')
        ax3.set_xlabel('ä½ç½® x', fontsize=12)
        ax3.set_ylabel('æµé€Ÿ u', fontsize=12)
        ax3.set_title('é€Ÿåº¦å ´', fontsize=14, fontweight='bold')
        ax3.grid(True, alpha=0.3)
        
        # æ¸©åº¦
        ax4 = fig.add_subplot(gs[2, 0])
        ax4.plot(self.x, T, 'g-', linewidth=2)
        ax4.axvspan(self.x[self.obstacle_start], self.x[self.obstacle_end],
                   alpha=0.2, color='red')
        ax4.set_xlabel('ä½ç½® x', fontsize=12)
        ax4.set_ylabel('æ¸©åº¦ T', fontsize=12)
        ax4.set_title('æ¸©åº¦å ´', fontsize=14, fontweight='bold')
        ax4.grid(True, alpha=0.3)
        
        # åœ§åŠ›
        ax5 = fig.add_subplot(gs[2, 1])
        p = n * T  # ç†æƒ³æ°—ä½“
        ax5.plot(self.x, p, 'purple', linewidth=2)
        ax5.axvspan(self.x[self.obstacle_start], self.x[self.obstacle_end],
                   alpha=0.2, color='red')
        ax5.set_xlabel('ä½ç½® x', fontsize=12)
        ax5.set_ylabel('åœ§åŠ› p', fontsize=12)
        ax5.set_title('åœ§åŠ›å ´', fontsize=14, fontweight='bold')
        ax5.grid(True, alpha=0.3)
        
        return fig

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
flow = RarefiedGasFlow(Nx=150, Nv=80, Lx=20.0, v_max=6.0, tau=0.3)
flow.initialize_flow(n0=1.0, u0=3.0, T0=1.0)

dt = 0.005
for step in range(1000):
    flow.step(dt)
    if step % 100 == 0:
        print(f"Step {step}/1000")

fig = flow.plot_solution(t=5.0)
plt.show()

print("\n=== å¸Œè–„æ°—ä½“æµã‚Œã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Œäº† ===")</div>
                </div>
            </section>

            <section>
                <h2>æ¼”ç¿’å•é¡Œ</h2>
                
                <div class="exercise-box">
                    <h3>æ¼”ç¿’1: Maxwellåˆ†å¸ƒã®å°å‡º</h3>
                    <p>
                        å¹³è¡¡çŠ¶æ…‹ã«ãŠã‘ã‚‹é€Ÿåº¦åˆ†å¸ƒãŒMaxwellåˆ†å¸ƒã«ãªã‚‹ã“ã¨ã‚’ã€Hé–¢æ•°ã‚’æœ€å°åŒ–ã™ã‚‹
                        å¤‰åˆ†åŸç†ã‹ã‚‰å°å‡ºã›ã‚ˆã€‚ç²’å­æ•°ä¿å­˜ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã‚’åˆ¶ç´„æ¡ä»¶ã¨ã™ã‚‹ã“ã¨ã€‚
                    </p>
                </div>

                <div class="exercise-box">
                    <h3>æ¼”ç¿’2: BGKæ–¹ç¨‹å¼ã®ç·šå½¢åŒ–</h3>
                    <p>
                        Maxwellåˆ†å¸ƒã‹ã‚‰ã®å¾®å°ãªãšã‚Œ \( f = f_M(1 + \phi) \) ã‚’è€ƒãˆã€
                        BGKæ–¹ç¨‹å¼ã‚’ \( \phi \) ã«ã¤ã„ã¦ç·šå½¢åŒ–ã›ã‚ˆã€‚éŸ³æ³¢ã®ä¼æ’­ã‚’è¨˜è¿°ã™ã‚‹
                        æ–¹ç¨‹å¼ã‚’å°å‡ºã—ã€éŸ³é€Ÿã‚’æ±‚ã‚ã‚ˆã€‚
                    </p>
                </div>

                <div class="exercise-box">
                    <h3>æ¼”ç¿’3: ç†±ä¼å°ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>
                    <p>
                        æ¸©åº¦å‹¾é…ãŒã‚ã‚‹ç³»ã«å¯¾ã—ã¦BGKæ–¹ç¨‹å¼ã‚’è§£ãã€Fourierã®ç†±ä¼å°å‰‡
                        \( \mathbf{q} = -\kappa \nabla T \) ãŒç¾ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã›ã‚ˆã€‚
                        ç†±ä¼å°ç‡ \( \kappa \) ã¨ç·©å’Œæ™‚é–“ \( \tau \) ã®é–¢ä¿‚ã‚’æ±‚ã‚ã‚ˆã€‚
                    </p>
                </div>
            </section>

            <section>
                <h2>ã¾ã¨ã‚</h2>
                <ul>
                    <li>åˆ†å¸ƒé–¢æ•° \( f(\mathbf{r}, \mathbf{v}, t) \) ã¯éå¹³è¡¡ç³»ã®åŸºæœ¬çš„ãªè¨˜è¿°é‡ã§ã‚ã‚‹</li>
                    <li>ãƒœãƒ«ãƒ„ãƒãƒ³æ–¹ç¨‹å¼ã¯åˆ†å¸ƒé–¢æ•°ã®æ™‚é–“ç™ºå±•ã‚’è¡çªé …ã‚’å«ã‚ã¦è¨˜è¿°ã™ã‚‹</li>
                    <li>Hå®šç†ã¯ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¢—å¤§å‰‡ã®å¾®è¦–çš„åŸºç¤ã‚’ä¸ãˆã‚‹</li>
                    <li>BGKè¿‘ä¼¼ã«ã‚ˆã‚Šå®Ÿç”¨çš„ãªæ•°å€¤è¨ˆç®—ãŒå¯èƒ½ã«ãªã‚‹</li>
                    <li>DSMCæ³•ã¯ç›´æ¥çš„ãªç²’å­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹è§£æ³•ã‚’æä¾›ã™ã‚‹</li>
                    <li>ã“ã‚Œã‚‰ã®æ‰‹æ³•ã¯å¸Œè–„æ°—ä½“åŠ›å­¦ã‚„ææ–™ãƒ—ãƒ­ã‚»ã‚¹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«å¿œç”¨ã•ã‚Œã‚‹</li>
                </ul>
            </section>

            <section>
                <h2>å‚è€ƒæ–‡çŒ®</h2>
                <ol>
                    <li>ä¹…ä¿äº®äº”ã€çµ±è¨ˆåŠ›å­¦ã€ï¼ˆå²©æ³¢æ›¸åº—ï¼‰</li>
                    <li>S. Harris, "An Introduction to the Theory of the Boltzmann Equation" (Dover)</li>
                    <li>C. Cercignani, "The Boltzmann Equation and Its Applications" (Springer)</li>
                    <li>G. A. Bird, "Molecular Gas Dynamics and the Direct Simulation of Gas Flows" (Oxford)</li>
                </ol>
            </section>
        </div>

        <div class="nav-buttons">
<a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a>
            <a href="chapter-2.html" class="nav-button">æ¬¡ã¸: ç¬¬2ç«  ãƒã‚¹ã‚¿ãƒ¼æ–¹ç¨‹å¼ã¨ç¢ºç‡éç¨‹</a>
        </div>
    </div>

    <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

<footer>
        <p>&copy; 2025 AI Terakoya - åŸºç¤æ•°ç†é“å ´</p>
    </footer>
</body>
</html>
