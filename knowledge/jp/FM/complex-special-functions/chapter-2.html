<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : æ­£å‰‡é–¢æ•°ã¨è¤‡ç´ å¾®ç©åˆ† | è¤‡ç´ é–¢æ•°è«–ã¨ç‰¹æ®Šé–¢æ•° - FMé“å ´</title>
    <link rel="stylesheet" href="../../../../assets/css/variables.css">
    <link rel="stylesheet" href="../../../../assets/css/reset.css">
    <link rel="stylesheet" href="../../../../assets/css/base.css">
    <link rel="stylesheet" href="../../../../assets/css/components.css">
    <link rel="stylesheet" href="../../../../assets/css/layout.css">
    <link rel="stylesheet" href="../../../../assets/css/responsive.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>MathJax = {tex: {inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']]}};</script>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <div class="site-logo"><a href="../../../../index.html">ğŸ›ï¸ AIå¯ºå­å±‹</a></div>
                <nav class="main-nav">
                    <a href="../../../../index.html">ãƒ›ãƒ¼ãƒ </a>
                    <a href="../../../index.html">çŸ¥è­˜ãƒ™ãƒ¼ã‚¹</a>
                    <a href="../../index.html" class="active">FMé“å ´</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="chapter-page">
        <div class="container">
            <nav class="breadcrumb">
                <a href="../../../../index.html">ãƒ›ãƒ¼ãƒ </a> &gt;
                <a href="../../index.html">FMé“å ´</a> &gt;
                <a href="../index.html">è¤‡ç´ é–¢æ•°è«–ã¨ç‰¹æ®Šé–¢æ•°</a> &gt;
                <span>ç¬¬2ç« </span>
            </nav>

            <article class="chapter-content">
                <div class="chapter-header">
                    <span class="chapter-label">ç¬¬2ç« </span>
                    <h1>æ­£å‰‡é–¢æ•°ã¨è¤‡ç´ å¾®ç©åˆ†</h1>
                    <p class="chapter-subtitle">Analytic Functions and Complex Calculus</p>
                    <div class="chapter-meta">
                        <span class="meta-item">â±ï¸ 22-26åˆ†</span>
                        <span class="meta-item">ğŸ’» 8ã‚³ãƒ¼ãƒ‰ä¾‹</span>
                        <span class="meta-item">ğŸ“Š ä¸­ç´š</span>
                    </div>
                </div>

                <section class="chapter-section">
                    <h2>2.1 è¤‡ç´ å¾®åˆ†ã¨ã‚³ãƒ¼ã‚·ãƒ¼ãƒ»ãƒªãƒ¼ãƒãƒ³ã®æ–¹ç¨‹å¼</h2>
                    <p>
                        è¤‡ç´ é–¢æ•° $f(z)$ ãŒç‚¹ $z_0$ ã§å¾®åˆ†å¯èƒ½ã§ã‚ã‚‹ã¨ã¯ã€æ¥µé™ $\lim_{h \to 0} \frac{f(z_0+h) - f(z_0)}{h}$ ãŒ $h$ ã®è¿‘ã¥ãæ–¹ã«ã‚ˆã‚‰ãšå­˜åœ¨ã™ã‚‹ã“ã¨ã§ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ã‚³ãƒ¼ã‚·ãƒ¼ãƒ»ãƒªãƒ¼ãƒãƒ³ã®æ–¹ç¨‹å¼:</strong></p>
                        <p>$f(z) = u(x,y) + iv(x,y)$ ãŒæ­£å‰‡ã§ã‚ã‚‹ãŸã‚ã®å¿…è¦ååˆ†æ¡ä»¶:</p>
                        $$\frac{\partial u}{\partial x} = \frac{\partial v}{\partial y}, \quad \frac{\partial u}{\partial y} = -\frac{\partial v}{\partial x}$$
                        <p><strong>è¤‡ç´ å¾®åˆ†ã®è¨ˆç®—:</strong></p>
                        $$f'(z) = \frac{\partial u}{\partial x} + i\frac{\partial v}{\partial x} = \frac{\partial v}{\partial y} - i\frac{\partial u}{\partial y}$$
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 1: ã‚³ãƒ¼ã‚·ãƒ¼ãƒ»ãƒªãƒ¼ãƒãƒ³ã®æ–¹ç¨‹å¼ã®æ¤œè¨¼</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.misc import derivative

def f_analytic(z):
    """æ­£å‰‡é–¢æ•°: f(z) = z^2"""
    return z**2

def f_not_analytic(z):
    """éæ­£å‰‡é–¢æ•°: f(z) = zÌ„ (è¤‡ç´ å…±å½¹)"""
    return np.conj(z)

# å®Ÿéƒ¨ã¨è™šéƒ¨ã‚’åˆ†é›¢
def extract_uv(f, x, y):
    z = x + 1j*y
    w = f(z)
    return w.real, w.imag

# åå¾®åˆ†ã®æ•°å€¤è¨ˆç®—
def check_cauchy_riemann(f, x0, y0, h=1e-5):
    u, v = extract_uv(f, x0, y0)

    # âˆ‚u/âˆ‚x
    u_xp, _ = extract_uv(f, x0+h, y0)
    u_xm, _ = extract_uv(f, x0-h, y0)
    du_dx = (u_xp - u_xm) / (2*h)

    # âˆ‚u/âˆ‚y
    u_yp, _ = extract_uv(f, x0, y0+h)
    u_ym, _ = extract_uv(f, x0, y0-h)
    du_dy = (u_yp - u_ym) / (2*h)

    # âˆ‚v/âˆ‚x
    _, v_xp = extract_uv(f, x0+h, y0)
    _, v_xm = extract_uv(f, x0-h, y0)
    dv_dx = (v_xp - v_xm) / (2*h)

    # âˆ‚v/âˆ‚y
    _, v_yp = extract_uv(f, x0, y0+h)
    _, v_ym = extract_uv(f, x0, y0-h)
    dv_dy = (v_yp - v_ym) / (2*h)

    return du_dx, du_dy, dv_dx, dv_dy

# ãƒ†ã‚¹ãƒˆç‚¹
x0, y0 = 1.5, 2.0

print("=== æ­£å‰‡é–¢æ•°: f(z) = z^2 ===")
du_dx, du_dy, dv_dx, dv_dy = check_cauchy_riemann(f_analytic, x0, y0)
print(f"âˆ‚u/âˆ‚x = {du_dx:.6f}")
print(f"âˆ‚v/âˆ‚y = {dv_dy:.6f}")
print(f"âˆ‚u/âˆ‚x - âˆ‚v/âˆ‚y = {du_dx - dv_dy:.6e} (should be ~0)")
print(f"\nâˆ‚u/âˆ‚y = {du_dy:.6f}")
print(f"-âˆ‚v/âˆ‚x = {-dv_dx:.6f}")
print(f"âˆ‚u/âˆ‚y - (-âˆ‚v/âˆ‚x) = {du_dy - (-dv_dx):.6e} (should be ~0)")

print("\n\n=== éæ­£å‰‡é–¢æ•°: f(z) = zÌ„ ===")
du_dx, du_dy, dv_dx, dv_dy = check_cauchy_riemann(f_not_analytic, x0, y0)
print(f"âˆ‚u/âˆ‚x = {du_dx:.6f}")
print(f"âˆ‚v/âˆ‚y = {dv_dy:.6f}")
print(f"âˆ‚u/âˆ‚x - âˆ‚v/âˆ‚y = {du_dx - dv_dy:.6f} (NOT ~0)")
print(f"\nâˆ‚u/âˆ‚y = {du_dy:.6f}")
print(f"-âˆ‚v/âˆ‚x = {-dv_dx:.6f}")
print(f"âˆ‚u/âˆ‚y - (-âˆ‚v/âˆ‚x) = {du_dy - (-dv_dx):.6f} (NOT ~0)")

# å¯è¦–åŒ–
x = np.linspace(-2, 2, 100)
y = np.linspace(-2, 2, 100)
X, Y = np.meshgrid(x, y)
Z = X + 1j*Y

# æ­£å‰‡é–¢æ•°
W_analytic = f_analytic(Z)
U_analytic = W_analytic.real
V_analytic = W_analytic.imag

# éæ­£å‰‡é–¢æ•°
W_not = f_not_analytic(Z)
U_not = W_not.real
V_not = W_not.imag

fig, axes = plt.subplots(2, 2, figsize=(14, 12))

# æ­£å‰‡é–¢æ•°: å®Ÿéƒ¨
im = axes[0, 0].contourf(X, Y, U_analytic, levels=20, cmap='RdBu_r')
axes[0, 0].contour(X, Y, V_analytic, levels=10, colors='green', linewidths=1, alpha=0.5)
axes[0, 0].plot(x0, y0, 'ko', markersize=10)
axes[0, 0].set_xlabel('x', fontsize=12)
axes[0, 0].set_ylabel('y', fontsize=12)
axes[0, 0].set_title('æ­£å‰‡é–¢æ•° $f(z)=z^2$: å®Ÿéƒ¨(è‰²), è™šéƒ¨(ç·‘ç·š)', fontsize=12)
plt.colorbar(im, ax=axes[0, 0])

# æ­£å‰‡é–¢æ•°: è™šéƒ¨
im = axes[0, 1].contourf(X, Y, V_analytic, levels=20, cmap='RdBu_r')
axes[0, 1].contour(X, Y, U_analytic, levels=10, colors='red', linewidths=1, alpha=0.5)
axes[0, 1].plot(x0, y0, 'ko', markersize=10)
axes[0, 1].set_xlabel('x', fontsize=12)
axes[0, 1].set_ylabel('y', fontsize=12)
axes[0, 1].set_title('æ­£å‰‡é–¢æ•° $f(z)=z^2$: è™šéƒ¨(è‰²), å®Ÿéƒ¨(èµ¤ç·š)', fontsize=12)
plt.colorbar(im, ax=axes[0, 1])

# éæ­£å‰‡é–¢æ•°: å®Ÿéƒ¨
im = axes[1, 0].contourf(X, Y, U_not, levels=20, cmap='RdBu_r')
axes[1, 0].contour(X, Y, V_not, levels=10, colors='green', linewidths=1, alpha=0.5)
axes[1, 0].plot(x0, y0, 'ko', markersize=10)
axes[1, 0].set_xlabel('x', fontsize=12)
axes[1, 0].set_ylabel('y', fontsize=12)
axes[1, 0].set_title('éæ­£å‰‡é–¢æ•° $f(z)=\\bar{z}$: å®Ÿéƒ¨(è‰²), è™šéƒ¨(ç·‘ç·š)', fontsize=12)
plt.colorbar(im, ax=axes[1, 0])

# éæ­£å‰‡é–¢æ•°: è™šéƒ¨
im = axes[1, 1].contourf(X, Y, V_not, levels=20, cmap='RdBu_r')
axes[1, 1].contour(X, Y, U_not, levels=10, colors='red', linewidths=1, alpha=0.5)
axes[1, 1].plot(x0, y0, 'ko', markersize=10)
axes[1, 1].set_xlabel('x', fontsize=12)
axes[1, 1].set_ylabel('y', fontsize=12)
axes[1, 1].set_title('éæ­£å‰‡é–¢æ•° $f(z)=\\bar{z}$: è™šéƒ¨(è‰²), å®Ÿéƒ¨(èµ¤ç·š)', fontsize=12)
plt.colorbar(im, ax=axes[1, 1])

plt.suptitle('æ­£å‰‡é–¢æ•°ã¨éæ­£å‰‡é–¢æ•°ã®ç­‰é«˜ç·š (ç›´äº¤æ€§ã®æ¤œè¨¼)', fontsize=14)
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <p class="note">
                        <strong>ğŸ“Œ æ³¨æ„:</strong> æ­£å‰‡é–¢æ•°ã§ã¯å®Ÿéƒ¨ã¨è™šéƒ¨ã®ç­‰é«˜ç·šãŒç›´äº¤ã—ã¾ã™(ã‚³ãƒ¼ã‚·ãƒ¼ãƒ»ãƒªãƒ¼ãƒãƒ³ã®æ–¹ç¨‹å¼ã®å¹¾ä½•å­¦çš„æ„å‘³)ã€‚
                    </p>
                </section>

                <section class="chapter-section">
                    <h2>2.2 æ­£å‰‡é–¢æ•°ã®ä¾‹ã¨æ€§è³ª</h2>
                    <p>
                        å¤šãã®è¤‡ç´ é–¢æ•°ã¯æ­£å‰‡ã§ã™ãŒã€è¤‡ç´ å…±å½¹ã‚„çµ¶å¯¾å€¤ã‚’å«ã‚€é–¢æ•°ã¯æ­£å‰‡ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>æ­£å‰‡é–¢æ•°ã®ä¾‹:</strong></p>
                        <ul>
                            <li>å¤šé …å¼: $z^n$, $a_n z^n + \cdots + a_1 z + a_0$</li>
                            <li>æŒ‡æ•°é–¢æ•°: $e^z$</li>
                            <li>ä¸‰è§’é–¢æ•°: $\sin z$, $\cos z$</li>
                            <li>æœ‰ç†é–¢æ•°: $\frac{P(z)}{Q(z)}$ ($Q(z) \neq 0$ ã®é ˜åŸŸ)</li>
                        </ul>
                        <p><strong>æ­£å‰‡ã§ãªã„é–¢æ•°ã®ä¾‹:</strong></p>
                        <ul>
                            <li>è¤‡ç´ å…±å½¹: $\bar{z}$</li>
                            <li>å®Ÿéƒ¨/è™šéƒ¨: $\mathrm{Re}(z)$, $\mathrm{Im}(z)$</li>
                            <li>çµ¶å¯¾å€¤: $|z|$</li>
                        </ul>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 2: æ§˜ã€…ãªæ­£å‰‡é–¢æ•°ã®å¾®åˆ†</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# è¤‡ç´ å¾®åˆ†ã®æ•°å€¤è¨ˆç®—
def complex_derivative(f, z, h=1e-7):
    return (f(z + h) - f(z - h)) / (2*h)

# ãƒ†ã‚¹ãƒˆé–¢æ•°
functions = {
    'z^2': lambda z: z**2,
    'z^3': lambda z: z**3,
    'e^z': lambda z: np.exp(z),
    'sin(z)': lambda z: np.sin(z),
    '1/z': lambda z: 1/z,
}

# ç†è«–çš„ãªå°é–¢æ•°
derivatives_theory = {
    'z^2': lambda z: 2*z,
    'z^3': lambda z: 3*z**2,
    'e^z': lambda z: np.exp(z),
    'sin(z)': lambda z: np.cos(z),
    '1/z': lambda z: -1/z**2,
}

# ãƒ†ã‚¹ãƒˆç‚¹
z0 = 1.5 + 2.0j

print("è¤‡ç´ å¾®åˆ†ã®è¨ˆç®—ã¨æ¤œè¨¼:")
print("=" * 60)
for name, f in functions.items():
    f_prime_numerical = complex_derivative(f, z0)
    f_prime_theoretical = derivatives_theory[name](z0)
    error = np.abs(f_prime_numerical - f_prime_theoretical)

    print(f"\nf(z) = {name}")
    print(f"  z = {z0}")
    print(f"  æ•°å€¤å¾®åˆ†: f'(z) = {f_prime_numerical:.6f}")
    print(f"  ç†è«–å€¤:   f'(z) = {f_prime_theoretical:.6f}")
    print(f"  èª¤å·®: {error:.2e}")

# å¯è¦–åŒ–: ãƒ™ã‚¯ãƒˆãƒ«å ´ã¨ã—ã¦ã®å°é–¢æ•°
x = np.linspace(-2, 2, 15)
y = np.linspace(-2, 2, 15)
X, Y = np.meshgrid(x, y)
Z = X + 1j*Y

fig, axes = plt.subplots(2, 3, figsize=(16, 10))
axes = axes.flatten()

for idx, (name, f) in enumerate(functions.items()):
    if idx >= len(axes):
        break

    ax = axes[idx]

    # é–¢æ•°å€¤
    W = f(Z)
    # å°é–¢æ•°(ãƒ™ã‚¯ãƒˆãƒ«å ´)
    F_prime = np.array([[complex_derivative(f, z) for z in row] for row in Z])

    # ãƒ™ã‚¯ãƒˆãƒ«å ´ã®å¯è¦–åŒ–
    U = F_prime.real
    V = F_prime.imag
    magnitude = np.sqrt(U**2 + V**2)

    # è‰²ã§å¤§ãã•ã‚’è¡¨ç¤º
    im = ax.contourf(X, Y, magnitude, levels=20, cmap='viridis', alpha=0.6)
    # ãƒ™ã‚¯ãƒˆãƒ«å ´
    skip = 2
    ax.quiver(X[::skip, ::skip], Y[::skip, ::skip],
              U[::skip, ::skip], V[::skip, ::skip],
              magnitude[::skip, ::skip], cmap='hot', scale=50, width=0.003)

    ax.set_xlabel('Re(z)', fontsize=10)
    ax.set_ylabel('Im(z)', fontsize=10)
    ax.set_title(f"$f'(z)$ for $f(z) = {name}$", fontsize=12)
    ax.axis('equal')
    ax.grid(True, alpha=0.3)
    plt.colorbar(im, ax=ax, label="$|f'(z)|$")

# æœ€å¾Œã®ã‚µãƒ–ãƒ—ãƒ­ãƒƒãƒˆã‚’å‰Šé™¤(5ã¤ã—ã‹é–¢æ•°ãŒãªã„ã®ã§)
fig.delaxes(axes[5])

plt.suptitle('æ­£å‰‡é–¢æ•°ã®å°é–¢æ•°(ãƒ™ã‚¯ãƒˆãƒ«å ´è¡¨ç¤º)', fontsize=14)
plt.tight_layout()
plt.show()</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.3 è¤‡ç´ ç©åˆ†ã®è¨ˆç®—</h2>
                    <p>
                        è¤‡ç´ ç©åˆ†ã¯çµŒè·¯ç©åˆ†ã¨ã—ã¦å®šç¾©ã•ã‚Œã¾ã™: $\int_C f(z) dz = \int_a^b f(z(t)) z'(t) dt$
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>è¤‡ç´ ç·šç©åˆ†:</strong></p>
                        $$\int_C f(z) dz = \int_a^b f(z(t)) \frac{dz}{dt} dt$$
                        <p>ã“ã“ã§ $z(t)$ ã¯çµŒè·¯ $C$ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¡¨ç¤º $(a \leq t \leq b)$</p>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 3: è¤‡ç´ ç©åˆ†ã®æ•°å€¤è¨ˆç®—</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import quad

def complex_line_integral(f, z_t, t_range, n_points=1000):
    """
    è¤‡ç´ ç·šç©åˆ†ã®æ•°å€¤è¨ˆç®—
    f: è¢«ç©åˆ†é–¢æ•°
    z_t: çµŒè·¯ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¡¨ç¤º z(t)
    t_range: (t_start, t_end)
    """
    t = np.linspace(t_range[0], t_range[1], n_points)
    dt = t[1] - t[0]

    # çµŒè·¯ä¸Šã®ç‚¹
    z = z_t(t)
    # å°é–¢æ•° dz/dt (æ•°å€¤å¾®åˆ†)
    dz_dt = np.gradient(z, dt)
    # è¢«ç©åˆ†é–¢æ•°ã®å€¤
    f_z = f(z)

    # ç©åˆ† (å°å½¢å‰‡)
    integral = np.trapz(f_z * dz_dt, dx=dt)
    return integral, z

# ãƒ†ã‚¹ãƒˆé–¢æ•°
f1 = lambda z: z
f2 = lambda z: z**2
f3 = lambda z: 1/z

# çµŒè·¯1: åŸç‚¹ã‹ã‚‰1+iã¸ã®ç›´ç·š
path1 = lambda t: t * (1 + 1j)
t_range1 = (0, 1)

print("=== çµŒè·¯1: ç›´ç·š (0 â†’ 1+i) ===")
integral1_f1, z1 = complex_line_integral(f1, path1, t_range1)
print(f"âˆ« z dz = {integral1_f1:.6f}")
print(f"ç†è«–å€¤: (1+i)^2 / 2 = {(1+1j)**2 / 2:.6f}")

integral1_f2, _ = complex_line_integral(f2, path1, t_range1)
print(f"\nâˆ« z^2 dz = {integral1_f2:.6f}")
print(f"ç†è«–å€¤: (1+i)^3 / 3 = {(1+1j)**3 / 3:.6f}")

# çµŒè·¯2: å˜ä½å††(åæ™‚è¨ˆå›ã‚Š)
path2 = lambda t: np.exp(1j * t)
t_range2 = (0, 2*np.pi)

print("\n\n=== çµŒè·¯2: å˜ä½å††(åæ™‚è¨ˆå›ã‚Š) ===")
integral2_f1, z2 = complex_line_integral(f1, path2, t_range2)
print(f"âˆ« z dz = {integral2_f1:.6f}")
print(f"ç†è«–å€¤: 0 (æ­£å‰‡é–¢æ•°ã®é–‰æ›²ç·šç©åˆ†)")

integral2_f3, _ = complex_line_integral(f3, path2, t_range2)
print(f"\nâˆ« (1/z) dz = {integral2_f3:.6f}")
print(f"ç†è«–å€¤: 2Ï€i = {2*np.pi*1j:.6f}")

# çµŒè·¯3: åŸç‚¹ã‹ã‚‰1+iã¸ã®æŠ˜ã‚Œç·š (0â†’1â†’1+i)
path3a = lambda t: t  # 0 â†’ 1 (å®Ÿè»¸)
path3b = lambda t: 1 + 1j*t  # 1 â†’ 1+i (è™šè»¸)

integral3_f1a, z3a = complex_line_integral(f1, path3a, (0, 1))
integral3_f1b, z3b = complex_line_integral(f1, path3b, (0, 1))
integral3_f1_total = integral3_f1a + integral3_f1b

print("\n\n=== çµŒè·¯3: æŠ˜ã‚Œç·š (0â†’1â†’1+i) ===")
print(f"âˆ« z dz = {integral3_f1_total:.6f}")
print(f"ç†è«–å€¤: (1+i)^2 / 2 = {(1+1j)**2 / 2:.6f}")
print(f"(çµŒè·¯ã«ã‚ˆã‚‰ãªã„ = æ­£å‰‡é–¢æ•°)")

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 3, figsize=(16, 5))

# çµŒè·¯1
ax = axes[0]
ax.plot(z1.real, z1.imag, 'b-', linewidth=2, label='çµŒè·¯')
ax.plot(0, 0, 'go', markersize=10, label='å§‹ç‚¹')
ax.plot(1, 1, 'ro', markersize=10, label='çµ‚ç‚¹')
ax.arrow(0, 0, 0.4, 0.4, head_width=0.05, head_length=0.05, fc='blue', ec='blue')
ax.grid(True, alpha=0.3)
ax.set_xlabel('Re(z)', fontsize=12)
ax.set_ylabel('Im(z)', fontsize=12)
ax.set_title('çµŒè·¯1: ç›´ç·š $(0 \\to 1+i)$', fontsize=12)
ax.axis('equal')
ax.legend()

# çµŒè·¯2
ax = axes[1]
ax.plot(z2.real, z2.imag, 'b-', linewidth=2, label='çµŒè·¯')
ax.plot(1, 0, 'go', markersize=10, label='å§‹ç‚¹/çµ‚ç‚¹')
# çŸ¢å°(åæ™‚è¨ˆå›ã‚Š)
angles_arrow = [0, np.pi/2, np.pi, 3*np.pi/2]
for angle in angles_arrow:
    z_arr = np.exp(1j * angle)
    dz = 0.3 * np.exp(1j * (angle + np.pi/2))
    ax.arrow(z_arr.real, z_arr.imag, dz.real, dz.imag,
             head_width=0.1, head_length=0.08, fc='blue', ec='blue', alpha=0.6)
ax.grid(True, alpha=0.3)
ax.set_xlabel('Re(z)', fontsize=12)
ax.set_ylabel('Im(z)', fontsize=12)
ax.set_title('çµŒè·¯2: å˜ä½å††(åæ™‚è¨ˆå›ã‚Š)', fontsize=12)
ax.axis('equal')
ax.legend()

# çµŒè·¯3
ax = axes[2]
ax.plot(z3a.real, z3a.imag, 'b-', linewidth=2, label='çµŒè·¯')
ax.plot(z3b.real, z3b.imag, 'b-', linewidth=2)
ax.plot(0, 0, 'go', markersize=10, label='å§‹ç‚¹')
ax.plot(1, 1, 'ro', markersize=10, label='çµ‚ç‚¹')
ax.plot(1, 0, 'ko', markersize=8, label='ä¸­é–“ç‚¹')
ax.arrow(0, 0, 0.4, 0, head_width=0.05, head_length=0.05, fc='blue', ec='blue')
ax.arrow(1, 0, 0, 0.4, head_width=0.05, head_length=0.05, fc='blue', ec='blue')
ax.grid(True, alpha=0.3)
ax.set_xlabel('Re(z)', fontsize=12)
ax.set_ylabel('Im(z)', fontsize=12)
ax.set_title('çµŒè·¯3: æŠ˜ã‚Œç·š $(0 \\to 1 \\to 1+i)$', fontsize=12)
ax.axis('equal')
ax.legend()

plt.suptitle('è¤‡ç´ ç©åˆ†ã®çµŒè·¯', fontsize=14)
plt.tight_layout()
plt.show()</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.4 ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å®šç†</h2>
                    <p>
                        æ­£å‰‡é–¢æ•°ã®é–‰æ›²ç·šã«æ²¿ã£ãŸç©åˆ†ã¯0ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å®šç†ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å®šç†:</strong></p>
                        $$\oint_C f(z) dz = 0$$
                        <p>ãŸã ã— $f(z)$ ã¯é–‰æ›²ç·š $C$ ã®å†…éƒ¨ã§æ­£å‰‡</p>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 4: ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å®šç†ã®æ¤œè¨¼</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def complex_contour_integral(f, path, t_range, n_points=1000):
    """é–‰æ›²ç·šã«æ²¿ã£ãŸè¤‡ç´ ç©åˆ†"""
    t = np.linspace(t_range[0], t_range[1], n_points)
    dt = t[1] - t[0]
    z = path(t)
    dz_dt = np.gradient(z, dt)
    f_z = f(z)
    integral = np.trapz(f_z * dz_dt, dx=dt)
    return integral, z

# æ­£å‰‡é–¢æ•°
f_analytic = [
    ('z', lambda z: z),
    ('z^2', lambda z: z**2),
    ('e^z', lambda z: np.exp(z)),
    ('sin(z)', lambda z: np.sin(z)),
]

# éæ­£å‰‡é–¢æ•°
f_not_analytic = [
    ('zÌ„', lambda z: np.conj(z)),
    ('|z|^2', lambda z: np.abs(z)**2),
]

# ç‰¹ç•°ç‚¹ã‚’å«ã‚€é–¢æ•°
f_singular = [
    ('1/z', lambda z: 1/z),  # z=0 ã§ç‰¹ç•°ç‚¹
    ('1/(z-1)', lambda z: 1/(z-1)),  # z=1 ã§ç‰¹ç•°ç‚¹
]

# é–‰æ›²ç·š: å˜ä½å††
unit_circle = lambda t: np.exp(1j * t)
t_range = (0, 2*np.pi)

print("=== ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å®šç†ã®æ¤œè¨¼ ===\n")
print("é–‰æ›²ç·š: å˜ä½å††(åæ™‚è¨ˆå›ã‚Š)\n")

print("ã€æ­£å‰‡é–¢æ•°(ç‰¹ç•°ç‚¹ãªã—)ã€‘")
print("ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å®šç†ã«ã‚ˆã‚Š âˆ®f(z)dz = 0 ã®ã¯ãš:")
for name, f in f_analytic:
    integral, _ = complex_contour_integral(f, unit_circle, t_range)
    print(f"  âˆ® {name:8s} dz = {integral.real:10.6f} + {integral.imag:10.6f}i")

print("\nã€éæ­£å‰‡é–¢æ•°ã€‘")
print("ä¸€èˆ¬ã« âˆ®f(z)dz â‰  0:")
for name, f in f_not_analytic:
    integral, _ = complex_contour_integral(f, unit_circle, t_range)
    print(f"  âˆ® {name:8s} dz = {integral.real:10.6f} + {integral.imag:10.6f}i")

print("\nã€ç‰¹ç•°ç‚¹ã‚’å«ã‚€é–¢æ•°ã€‘")
print("å˜ä½å††å†…ã«ç‰¹ç•°ç‚¹ â†’ âˆ®f(z)dz â‰  0:")
for name, f in f_singular:
    integral, _ = complex_contour_integral(f, unit_circle, t_range)
    print(f"  âˆ® {name:12s} dz = {integral.real:10.6f} + {integral.imag:10.6f}i")

# å¯è¦–åŒ–: æ§˜ã€…ãªé–‰æ›²ç·šã§ã®æ¤œè¨¼
contours = {
    'å˜ä½å††': (lambda t: np.exp(1j * t), (0, 2*np.pi)),
    'æ­£æ–¹å½¢': (lambda t: np.where(t < 0.25, 4*t,
                         np.where(t < 0.5, 1 + 4j*(t-0.25),
                         np.where(t < 0.75, 1 - 4*(t-0.5) + 1j,
                                  4j*(1 - (t-0.75))))), (0, 1)),
    'æ¥•å††': (lambda t: 2*np.cos(t) + 1j*np.sin(t), (0, 2*np.pi)),
}

f_test = lambda z: z**2  # æ­£å‰‡é–¢æ•°

fig, axes = plt.subplots(1, 3, figsize=(15, 5))

for ax, (name, (path, t_range)) in zip(axes, contours.items()):
    integral, z_path = complex_contour_integral(f_test, path, t_range)

    ax.plot(z_path.real, z_path.imag, 'b-', linewidth=2, label=f'çµŒè·¯: {name}')
    ax.plot(z_path.real[0], z_path.imag[0], 'go', markersize=10, label='å§‹ç‚¹')
    ax.grid(True, alpha=0.3)
    ax.axhline(0, color='gray', linewidth=0.5)
    ax.axvline(0, color='gray', linewidth=0.5)
    ax.set_xlabel('Re(z)', fontsize=12)
    ax.set_ylabel('Im(z)', fontsize=12)
    ax.set_title(f'{name}\nâˆ® $z^2$ dz = {integral:.6f}', fontsize=12)
    ax.axis('equal')
    ax.legend()

plt.suptitle('ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å®šç†: æ­£å‰‡é–¢æ•°ã®é–‰æ›²ç·šç©åˆ† = 0', fontsize=14)
plt.tight_layout()
plt.show()</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.5 ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å…¬å¼</h2>
                    <p>
                        æ­£å‰‡é–¢æ•°ã®å€¤ã¯ã€ãã®å‘¨å›²ã®é–‰æ›²ç·šä¸Šã®å€¤ã‹ã‚‰æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å…¬å¼:</strong></p>
                        $$f(z_0) = \frac{1}{2\pi i} \oint_C \frac{f(z)}{z - z_0} dz$$
                        <p><strong>å°é–¢æ•°ã®å…¬å¼:</strong></p>
                        $$f^{(n)}(z_0) = \frac{n!}{2\pi i} \oint_C \frac{f(z)}{(z - z_0)^{n+1}} dz$$
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 5: ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å…¬å¼ã®æ¤œè¨¼</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def cauchy_integral_formula(f, z0, radius=1.0, n_points=1000):
    """
    ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å…¬å¼ã‚’ä½¿ã£ã¦f(z0)ã‚’è¨ˆç®—
    f: æ­£å‰‡é–¢æ•°
    z0: è©•ä¾¡ç‚¹
    radius: z0ã‚’ä¸­å¿ƒã¨ã™ã‚‹å††ã®åŠå¾„
    """
    t = np.linspace(0, 2*np.pi, n_points)
    dt = t[1] - t[0]

    # çµŒè·¯: z0ã‚’ä¸­å¿ƒã¨ã™ã‚‹å††
    z = z0 + radius * np.exp(1j * t)
    dz_dt = 1j * radius * np.exp(1j * t)

    # è¢«ç©åˆ†é–¢æ•°
    integrand = f(z) / (z - z0)

    # ç©åˆ†
    integral = np.trapz(integrand * dz_dt, dx=dt)
    f_z0_from_integral = integral / (2 * np.pi * 1j)

    return f_z0_from_integral, z

# ãƒ†ã‚¹ãƒˆé–¢æ•°
functions = {
    'z^2': lambda z: z**2,
    'z^3': lambda z: z**3,
    'e^z': lambda z: np.exp(z),
    'sin(z)': lambda z: np.sin(z),
}

# è©•ä¾¡ç‚¹
z0 = 0.5 + 0.8j

print("=== ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å…¬å¼ã®æ¤œè¨¼ ===")
print(f"è©•ä¾¡ç‚¹: z0 = {z0}\n")

results = []
for name, f in functions.items():
    # ç›´æ¥è¨ˆç®—
    f_z0_direct = f(z0)

    # ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å…¬å¼ã§è¨ˆç®—
    f_z0_integral, path = cauchy_integral_formula(f, z0, radius=1.0)

    error = np.abs(f_z0_direct - f_z0_integral)

    print(f"f(z) = {name}")
    print(f"  ç›´æ¥è¨ˆç®—:     f(z0) = {f_z0_direct:.8f}")
    print(f"  ç©åˆ†å…¬å¼ã‹ã‚‰: f(z0) = {f_z0_integral:.8f}")
    print(f"  èª¤å·®: {error:.2e}\n")

    results.append((name, f, path))

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(12, 12))
axes = axes.flatten()

for idx, (name, f, path) in enumerate(results):
    if idx >= len(axes):
        break

    ax = axes[idx]

    # é–¢æ•°ã®ç­‰é«˜ç·š
    x = np.linspace(-2, 2, 100)
    y = np.linspace(-2, 2, 100)
    X, Y = np.meshgrid(x, y)
    Z = X + 1j*Y
    W = f(Z)

    im = ax.contourf(X, Y, np.abs(W), levels=20, cmap='viridis', alpha=0.6)
    plt.colorbar(im, ax=ax, label='|f(z)|')

    # ç©åˆ†çµŒè·¯
    ax.plot(path.real, path.imag, 'r-', linewidth=2, label='ç©åˆ†çµŒè·¯')
    ax.plot(z0.real, z0.imag, 'ko', markersize=10, label=f'z0 = {z0:.2f}')

    ax.grid(True, alpha=0.3)
    ax.set_xlabel('Re(z)', fontsize=12)
    ax.set_ylabel('Im(z)', fontsize=12)
    ax.set_title(f'$f(z) = {name}$', fontsize=12)
    ax.axis('equal')
    ax.legend()
    ax.set_xlim(-1.5, 2)
    ax.set_ylim(-1, 2)

plt.suptitle('ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å…¬å¼: å††å‘¨ä¸Šã®å€¤ã‹ã‚‰ä¸­å¿ƒã®å€¤ã‚’è¨ˆç®—', fontsize=14)
plt.tight_layout()
plt.show()</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.6 å°é–¢æ•°ã®ç©åˆ†å…¬å¼</h2>
                    <p>
                        ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å…¬å¼ã‚’æ‹¡å¼µã™ã‚‹ã¨ã€é«˜éšå°é–¢æ•°ã‚‚ç©åˆ†ã§è¡¨ç¾ã§ãã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 6: é«˜éšå°é–¢æ•°ã®ç©åˆ†å…¬å¼</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import factorial

def cauchy_derivative_formula(f, z0, n, radius=1.0, n_points=1000):
    """
    ã‚³ãƒ¼ã‚·ãƒ¼ã®å°é–¢æ•°å…¬å¼ã‚’ä½¿ã£ã¦f^(n)(z0)ã‚’è¨ˆç®—
    f: æ­£å‰‡é–¢æ•°
    z0: è©•ä¾¡ç‚¹
    n: å°é–¢æ•°ã®éšæ•°
    """
    t = np.linspace(0, 2*np.pi, n_points)
    dt = t[1] - t[0]

    # çµŒè·¯: z0ã‚’ä¸­å¿ƒã¨ã™ã‚‹å††
    z = z0 + radius * np.exp(1j * t)
    dz_dt = 1j * radius * np.exp(1j * t)

    # è¢«ç©åˆ†é–¢æ•°
    integrand = f(z) / (z - z0)**(n + 1)

    # ç©åˆ†
    integral = np.trapz(integrand * dz_dt, dx=dt)
    f_n_z0 = factorial(n) * integral / (2 * np.pi * 1j)

    return f_n_z0

# è¤‡ç´ å¾®åˆ†ã®æ•°å€¤è¨ˆç®—(æ¤œè¨¼ç”¨)
def numerical_derivative(f, z, n=1, h=1e-5):
    """néšå¾®åˆ†ã®æ•°å€¤è¨ˆç®—"""
    if n == 0:
        return f(z)
    elif n == 1:
        return (f(z + h) - f(z - h)) / (2*h)
    else:
        # å†å¸°çš„ã«è¨ˆç®—
        f_n_minus_1 = lambda w: numerical_derivative(f, w, n-1, h)
        return (f_n_minus_1(z + h) - f_n_minus_1(z - h)) / (2*h)

# ãƒ†ã‚¹ãƒˆé–¢æ•°
f = lambda z: np.exp(z)
z0 = 1.0 + 0.5j

print("=== é«˜éšå°é–¢æ•°ã®ç©åˆ†å…¬å¼ ===")
print(f"f(z) = e^z, z0 = {z0}\n")
print("ç†è«–å€¤: ã™ã¹ã¦ã®å°é–¢æ•°ãŒ e^z0\n")

for n in range(5):
    # ç©åˆ†å…¬å¼
    f_n_integral = cauchy_derivative_formula(f, z0, n, radius=0.5)
    # æ•°å€¤å¾®åˆ†
    f_n_numerical = numerical_derivative(f, z0, n)
    # ç†è«–å€¤ (e^z ã® n éšå°é–¢æ•°ã¯ e^z)
    f_n_theory = np.exp(z0)

    error_integral = np.abs(f_n_integral - f_n_theory)
    error_numerical = np.abs(f_n_numerical - f_n_theory)

    print(f"f^({n})(z0):")
    print(f"  ç©åˆ†å…¬å¼:   {f_n_integral:.8f}")
    print(f"  æ•°å€¤å¾®åˆ†:   {f_n_numerical:.8f}")
    print(f"  ç†è«–å€¤:     {f_n_theory:.8f}")
    print(f"  èª¤å·®(ç©åˆ†): {error_integral:.2e}")
    print(f"  èª¤å·®(æ•°å€¤): {error_numerical:.2e}\n")

# åˆ¥ã®ãƒ†ã‚¹ãƒˆ: f(z) = z^4
print("\n=== f(z) = z^4 ===")
f2 = lambda z: z**4
z0_2 = 2.0 + 1.0j

derivatives_theory = [
    z0_2**4,                    # f
    4 * z0_2**3,               # f'
    12 * z0_2**2,              # f''
    24 * z0_2,                 # f'''
    24,                        # f''''
]

for n in range(5):
    f_n_integral = cauchy_derivative_formula(f2, z0_2, n, radius=1.0)
    f_n_theory = derivatives_theory[n]
    error = np.abs(f_n_integral - f_n_theory)

    print(f"f^({n})(z0) = {f_n_integral:.6f}, ç†è«–å€¤ = {f_n_theory:.6f}, èª¤å·® = {error:.2e}")

# å¯è¦–åŒ–: ç•°ãªã‚‹åŠå¾„ã§ã®ç²¾åº¦
radii = np.linspace(0.1, 2.0, 20)
errors = []

for radius in radii:
    f_2_integral = cauchy_derivative_formula(f2, z0_2, 2, radius=radius)
    error = np.abs(f_2_integral - derivatives_theory[2])
    errors.append(error)

plt.figure(figsize=(10, 6))
plt.semilogy(radii, errors, 'b-o', linewidth=2, markersize=6)
plt.grid(True, alpha=0.3)
plt.xlabel('ç©åˆ†çµŒè·¯ã®åŠå¾„', fontsize=12)
plt.ylabel('èª¤å·®', fontsize=12)
plt.title("ã‚³ãƒ¼ã‚·ãƒ¼ã®å°é–¢æ•°å…¬å¼ã®ç²¾åº¦ vs ç©åˆ†çµŒè·¯ã®åŠå¾„\n$f''(z_0)$ for $f(z) = z^4$", fontsize=14)
plt.axhline(1e-10, color='red', linestyle='--', label='æ•°å€¤èª¤å·®ã®é™ç•Œ')
plt.legend()
plt.tight_layout()
plt.show()</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>2.7 ç­‰è§’å†™åƒã¨èª¿å’Œé–¢æ•°</h2>
                    <p>
                        æ­£å‰‡é–¢æ•°ã¯è§’åº¦ã‚’ä¿ã¤å†™åƒ(ç­‰è§’å†™åƒ)ã§ã™ã€‚ã¾ãŸã€æ­£å‰‡é–¢æ•°ã®å®Ÿéƒ¨ã¨è™šéƒ¨ã¯èª¿å’Œé–¢æ•°(ãƒ©ãƒ—ãƒ©ã‚¹æ–¹ç¨‹å¼ã®è§£)ã§ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ç­‰è§’å†™åƒ:</strong> æ­£å‰‡é–¢æ•° $w = f(z)$ ã¯è§’åº¦ã‚’ä¿ã¤</p>
                        <p><strong>èª¿å’Œé–¢æ•°:</strong> $f(z) = u + iv$ ãŒæ­£å‰‡ãªã‚‰</p>
                        $$\nabla^2 u = \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} = 0$$
                        $$\nabla^2 v = \frac{\partial^2 v}{\partial x^2} + \frac{\partial^2 v}{\partial y^2} = 0$$
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 7: ç­‰è§’å†™åƒã®å¯è¦–åŒ–</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def plot_conformal_map(f, title):
    """ç­‰è§’å†™åƒã®å¯è¦–åŒ–"""
    # å…ƒã®é ˜åŸŸ: æ ¼å­
    x = np.linspace(-1.5, 1.5, 15)
    y = np.linspace(-1.5, 1.5, 15)

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

    # å·¦å›³: å…ƒã®é ˜åŸŸ
    for xi in x:
        y_line = y
        z_line = xi + 1j*y_line
        ax1.plot(z_line.real, z_line.imag, 'b-', linewidth=1, alpha=0.5)

    for yi in y:
        x_line = x
        z_line = x_line + 1j*yi
        ax1.plot(z_line.real, z_line.imag, 'b-', linewidth=1, alpha=0.5)

    ax1.axhline(0, color='gray', linewidth=0.5)
    ax1.axvline(0, color='gray', linewidth=0.5)
    ax1.grid(True, alpha=0.3)
    ax1.set_xlabel('Re(z)', fontsize=12)
    ax1.set_ylabel('Im(z)', fontsize=12)
    ax1.set_title('å…ƒã®é ˜åŸŸ (zå¹³é¢)', fontsize=12)
    ax1.axis('equal')
    ax1.set_xlim(-2, 2)
    ax1.set_ylim(-2, 2)

    # å³å›³: å†™åƒå¾Œã®é ˜åŸŸ
    for xi in x:
        y_line = y
        z_line = xi + 1j*y_line
        w_line = f(z_line)
        ax2.plot(w_line.real, w_line.imag, 'r-', linewidth=1, alpha=0.5)

    for yi in y:
        x_line = x
        z_line = x_line + 1j*yi
        w_line = f(z_line)
        ax2.plot(w_line.real, w_line.imag, 'r-', linewidth=1, alpha=0.5)

    ax2.axhline(0, color='gray', linewidth=0.5)
    ax2.axvline(0, color='gray', linewidth=0.5)
    ax2.grid(True, alpha=0.3)
    ax2.set_xlabel('Re(w)', fontsize=12)
    ax2.set_ylabel('Im(w)', fontsize=12)
    ax2.set_title(f'å†™åƒå¾Œã®é ˜åŸŸ (wå¹³é¢): {title}', fontsize=12)
    ax2.axis('equal')

    plt.tight_layout()
    return fig

# æ§˜ã€…ãªç­‰è§’å†™åƒ
maps = {
    'w = z^2': lambda z: z**2,
    'w = e^z': lambda z: np.exp(z),
    'w = 1/z': lambda z: 1/z,
    'w = (z-1)/(z+1) (MÃ¶bius)': lambda z: (z-1)/(z+1),
}

for name, f in maps.items():
    fig = plot_conformal_map(f, name)
    plt.show()

print("ç­‰è§’å†™åƒã®æ€§è³ª:")
print("- æ ¼å­ã®äº¤ç‚¹ã§ã®è§’åº¦ãŒä¿ãŸã‚Œã‚‹")
print("- æ­£å‰‡é–¢æ•°ã¯å±€æ‰€çš„ã«å›è»¢ã¨æ‹¡å¤§ã®åˆæˆ")</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 8: èª¿å’Œé–¢æ•°ã®æ¤œè¨¼</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def laplacian_2d(u, x, y, h=0.01):
    """2æ¬¡å…ƒãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®æ•°å€¤è¨ˆç®—"""
    u_xx = (u(x+h, y) - 2*u(x, y) + u(x-h, y)) / h**2
    u_yy = (u(x, y+h) - 2*u(x, y) + u(x, y-h)) / h**2
    return u_xx + u_yy

# æ­£å‰‡é–¢æ•° f(z) = z^2 = (x+iy)^2 = (x^2-y^2) + i(2xy)
def u(x, y):
    """å®Ÿéƒ¨: u = x^2 - y^2"""
    return x**2 - y**2

def v(x, y):
    """è™šéƒ¨: v = 2xy"""
    return 2*x*y

# ã‚°ãƒªãƒƒãƒ‰
x = np.linspace(-2, 2, 100)
y = np.linspace(-2, 2, 100)
X, Y = np.meshgrid(x, y)

U = u(X, Y)
V = v(X, Y)

# ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®è¨ˆç®—(æ•°å€¤å¾®åˆ†)
dx = x[1] - x[0]
dy = y[1] - y[0]

Laplacian_U = (np.roll(U, -1, axis=1) - 2*U + np.roll(U, 1, axis=1)) / dx**2 + \
              (np.roll(U, -1, axis=0) - 2*U + np.roll(U, 1, axis=0)) / dy**2

Laplacian_V = (np.roll(V, -1, axis=1) - 2*V + np.roll(V, 1, axis=1)) / dx**2 + \
              (np.roll(V, -1, axis=0) - 2*V + np.roll(V, 1, axis=0)) / dy**2

# ãƒ†ã‚¹ãƒˆç‚¹ã§ã®ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³
x0, y0 = 1.0, 1.5
lap_u = laplacian_2d(u, x0, y0)
lap_v = laplacian_2d(v, x0, y0)

print("=== èª¿å’Œé–¢æ•°ã®æ¤œè¨¼ ===")
print(f"æ­£å‰‡é–¢æ•°: f(z) = z^2")
print(f"å®Ÿéƒ¨: u(x,y) = x^2 - y^2")
print(f"è™šéƒ¨: v(x,y) = 2xy")
print(f"\nãƒ†ã‚¹ãƒˆç‚¹: ({x0}, {y0})")
print(f"âˆ‡Â²u = {lap_u:.6e} (should be ~0)")
print(f"âˆ‡Â²v = {lap_v:.6e} (should be ~0)")

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 3, figsize=(16, 10))

# å®Ÿéƒ¨
im = axes[0, 0].contourf(X, Y, U, levels=20, cmap='RdBu_r')
axes[0, 0].contour(X, Y, U, levels=10, colors='black', linewidths=0.5, alpha=0.4)
axes[0, 0].set_xlabel('x', fontsize=12)
axes[0, 0].set_ylabel('y', fontsize=12)
axes[0, 0].set_title('å®Ÿéƒ¨: $u = x^2 - y^2$', fontsize=12)
axes[0, 0].axis('equal')
plt.colorbar(im, ax=axes[0, 0])

# è™šéƒ¨
im = axes[0, 1].contourf(X, Y, V, levels=20, cmap='RdBu_r')
axes[0, 1].contour(X, Y, V, levels=10, colors='black', linewidths=0.5, alpha=0.4)
axes[0, 1].set_xlabel('x', fontsize=12)
axes[0, 1].set_ylabel('y', fontsize=12)
axes[0, 1].set_title('è™šéƒ¨: $v = 2xy$', fontsize=12)
axes[0, 1].axis('equal')
plt.colorbar(im, ax=axes[0, 1])

# å®Ÿéƒ¨ã¨è™šéƒ¨ã®ç­‰é«˜ç·š(ç›´äº¤æ€§)
axes[0, 2].contour(X, Y, U, levels=15, colors='blue', linewidths=1.5, alpha=0.7)
axes[0, 2].contour(X, Y, V, levels=15, colors='red', linewidths=1.5, alpha=0.7)
axes[0, 2].set_xlabel('x', fontsize=12)
axes[0, 2].set_ylabel('y', fontsize=12)
axes[0, 2].set_title('ç­‰é«˜ç·šã®ç›´äº¤æ€§(é’:u, èµ¤:v)', fontsize=12)
axes[0, 2].axis('equal')
axes[0, 2].grid(True, alpha=0.3)

# ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³(å®Ÿéƒ¨)
im = axes[1, 0].contourf(X, Y, Laplacian_U, levels=20, cmap='seismic', vmin=-0.1, vmax=0.1)
axes[1, 0].set_xlabel('x', fontsize=12)
axes[1, 0].set_ylabel('y', fontsize=12)
axes[1, 0].set_title('$\\nabla^2 u$ (should be ~0)', fontsize=12)
axes[1, 0].axis('equal')
plt.colorbar(im, ax=axes[1, 0])

# ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³(è™šéƒ¨)
im = axes[1, 1].contourf(X, Y, Laplacian_V, levels=20, cmap='seismic', vmin=-0.1, vmax=0.1)
axes[1, 1].set_xlabel('x', fontsize=12)
axes[1, 1].set_ylabel('y', fontsize=12)
axes[1, 1].set_title('$\\nabla^2 v$ (should be ~0)', fontsize=12)
axes[1, 1].axis('equal')
plt.colorbar(im, ax=axes[1, 1])

# ãƒ©ãƒ—ãƒ©ã‚·ã‚¢ãƒ³ã®å¤§ãã•
Lap_magnitude = np.sqrt(Laplacian_U**2 + Laplacian_V**2)
im = axes[1, 2].contourf(X, Y, Lap_magnitude, levels=20, cmap='viridis')
axes[1, 2].set_xlabel('x', fontsize=12)
axes[1, 2].set_ylabel('y', fontsize=12)
axes[1, 2].set_title('$|\\nabla^2 u|^2 + |\\nabla^2 v|^2$', fontsize=12)
axes[1, 2].axis('equal')
plt.colorbar(im, ax=axes[1, 2])

plt.suptitle('èª¿å’Œé–¢æ•°: æ­£å‰‡é–¢æ•°ã®å®Ÿéƒ¨ãƒ»è™šéƒ¨ã¯ãƒ©ãƒ—ãƒ©ã‚¹æ–¹ç¨‹å¼ã‚’æº€ãŸã™', fontsize=14)
plt.tight_layout()
plt.show()

print("\nèª¿å’Œé–¢æ•°ã®æ€§è³ª:")
print("- æ­£å‰‡é–¢æ•°ã®å®Ÿéƒ¨ã¨è™šéƒ¨ã¯èª¿å’Œé–¢æ•°")
print("- èª¿å’Œé–¢æ•°ã®ç­‰é«˜ç·šã¯ç›´äº¤ã™ã‚‹(ã‚³ãƒ¼ã‚·ãƒ¼ãƒ»ãƒªãƒ¼ãƒãƒ³ã®æ–¹ç¨‹å¼)")
print("- èª¿å’Œé–¢æ•°ã¯æ¥µå¤§å€¤ãƒ»æ¥µå°å€¤ã‚’æŒãŸãªã„(æœ€å¤§å€¤åŸç†)")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>ğŸ“ ç« æœ«å•é¡Œ</h2>
                    <div class="exercise-box">
                        <h4>æ¼”ç¿’å•é¡Œ</h4>
                        <ol>
                            <li>$f(z) = z^3$ ã«ã¤ã„ã¦ã€ç‚¹ $z_0 = 1+i$ ã§ã‚³ãƒ¼ã‚·ãƒ¼ãƒ»ãƒªãƒ¼ãƒãƒ³ã®æ–¹ç¨‹å¼ã‚’æ¤œè¨¼ã›ã‚ˆã€‚</li>
                            <li>$\oint_C z^n dz$ ã‚’è¨ˆç®—ã›ã‚ˆã€‚ãŸã ã— $C$ ã¯åŸç‚¹ä¸­å¿ƒã®å˜ä½å††ã€$n$ ã¯æ•´æ•°ã€‚</li>
                            <li>$f(z) = \frac{1}{z-2}$ ã«ã¤ã„ã¦ã€å˜ä½å††ã«æ²¿ã£ãŸç©åˆ† $\oint_C f(z) dz$ ã‚’è¨ˆç®—ã—ã€ã‚³ãƒ¼ã‚·ãƒ¼ã®ç©åˆ†å®šç†ã¨ã®é–¢ä¿‚ã‚’è€ƒå¯Ÿã›ã‚ˆã€‚</li>
                            <li>ç­‰è§’å†™åƒ $w = z^2$ ã«ã‚ˆã£ã¦ã€ç›´ç·š $x=1$ ãŒã©ã®ã‚ˆã†ãªæ›²ç·šã«å†™ã•ã‚Œã‚‹ã‹æ±‚ã‚ã‚ˆã€‚</li>
                        </ol>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>ğŸ”— å‚è€ƒæ–‡çŒ®</h2>
                    <ul class="reference-list">
                        <li>Ahlfors, L. V. (1979). <em>Complex Analysis</em>. McGraw-Hill.</li>
                        <li>Stein, E. M., & Shakarchi, R. (2003). <em>Complex Analysis</em>. Princeton University Press.</li>
                    </ul>
                </section>
            </article>

            <nav class="chapter-navigation">
                <a href="chapter-1.html" class="btn btn-secondary">â† ç¬¬1ç« ã¸</a>
                <a href="chapter-3.html" class="btn btn-primary">ç¬¬3ç« ã¸ â†’</a>
            </nav>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 AI Terakoya. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
