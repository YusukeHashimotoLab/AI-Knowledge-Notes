<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬5ç« : ç‰¹æ®Šé–¢æ•°ã¨å¢ƒç•Œå€¤å•é¡Œ | è¤‡ç´ é–¢æ•°è«–ã¨ç‰¹æ®Šé–¢æ•° - FMé“å ´</title>
    <link rel="stylesheet" href="../../../assets/css/style.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>MathJax = {tex: {inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']]}};</script>
</head>
<body>
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <div class="site-logo"><a href="../../../index.html">ğŸ›ï¸ AIå¯ºå­å±‹</a></div>
                <nav class="main-nav">
                    <a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a>
                    <a href="../../index.html">çŸ¥è­˜ãƒ™ãƒ¼ã‚¹</a>
                    <a href="../index.html" class="active">FMé“å ´</a>
                </nav>
            </div>
        </div>
    </header>

    <main class="chapter-page">
        <div class="container">
            <nav class="breadcrumb">
                <a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a> &gt;
                <a href="../index.html">FMé“å ´</a> &gt;
                <a href="index.html">è¤‡ç´ é–¢æ•°è«–ã¨ç‰¹æ®Šé–¢æ•°</a> &gt;
                <span>ç¬¬5ç« </span>
            </nav>

            <article class="chapter-content">
                <div class="chapter-header">
                    <span class="chapter-label">ç¬¬5ç« </span>
                    <h1>ç‰¹æ®Šé–¢æ•°ã¨å¢ƒç•Œå€¤å•é¡Œ</h1>
                    <p class="chapter-subtitle">Special Functions and Boundary Value Problems</p>
                    <div class="chapter-meta">
                        <span class="meta-item">â±ï¸ 22-25åˆ†</span>
                        <span class="meta-item">ğŸ’» 9ã‚³ãƒ¼ãƒ‰ä¾‹</span>
                        <span class="meta-item">ğŸ“Š ä¸­ç´š-ä¸Šç´š</span>
                    </div>
                </div>

                <section class="chapter-section">
                    <h2>5.1 ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®å®šç¾©ã¨æ€§è³ª</h2>
                    <p>
                        ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã¯å††ç­’åº§æ¨™ç³»ã§ã®æ³¢å‹•æ–¹ç¨‹å¼ã‚„æ‹¡æ•£æ–¹ç¨‹å¼ã®è§£ã¨ã—ã¦ç¾ã‚Œã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ãƒ™ãƒƒã‚»ãƒ«å¾®åˆ†æ–¹ç¨‹å¼:</strong></p>
                        $$x^2 \frac{d^2y}{dx^2} + x\frac{dy}{dx} + (x^2 - \nu^2)y = 0$$
                        <p><strong>ç¬¬1ç¨®ãƒ™ãƒƒã‚»ãƒ«é–¢æ•° $J_\nu(x)$:</strong></p>
                        $$J_\nu(x) = \sum_{m=0}^{\infty} \frac{(-1)^m}{m!\Gamma(m+\nu+1)} \left(\frac{x}{2}\right)^{2m+\nu}$$
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 1: ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®è¨ˆç®—ã¨å¯è¦–åŒ–</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import jv, yv, jn_zeros

# ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®å¯è¦–åŒ–
x = np.linspace(0, 20, 1000)
orders = [0, 1, 2, 3, 4]

fig, axes = plt.subplots(2, 2, figsize=(14, 12))

# ç¬¬1ç¨®ãƒ™ãƒƒã‚»ãƒ«é–¢æ•° J_Î½(x)
ax = axes[0, 0]
for nu in orders:
    y = jv(nu, x)
    ax.plot(x, y, linewidth=2, label=f'$J_{{{nu}}}(x)$')
ax.axhline(0, color='gray', linewidth=0.5)
ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('$J_\\nu(x)$', fontsize=12)
ax.set_title('ç¬¬1ç¨®ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°', fontsize=12)
ax.legend()
ax.set_ylim(-0.5, 1.0)

# ç¬¬2ç¨®ãƒ™ãƒƒã‚»ãƒ«é–¢æ•° Y_Î½(x)
ax = axes[0, 1]
for nu in orders:
    y = yv(nu, x)
    ax.plot(x, y, linewidth=2, label=f'$Y_{{{nu}}}(x)$')
ax.axhline(0, color='gray', linewidth=0.5)
ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('$Y_\\nu(x)$', fontsize=12)
ax.set_title('ç¬¬2ç¨®ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°', fontsize=12)
ax.legend()
ax.set_ylim(-1.5, 1.0)

# ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®é›¶ç‚¹
ax = axes[1, 0]
for nu in [0, 1, 2]:
    zeros = jn_zeros(nu, 10)  # æœ€åˆã®10å€‹ã®é›¶ç‚¹
    ax.plot(zeros, np.zeros_like(zeros), 'o', markersize=8, label=f'$J_{{{nu}}}$ zeros')
ax.grid(True, alpha=0.3)
ax.set_xlabel('é›¶ç‚¹ã®ä½ç½®', fontsize=12)
ax.set_ylabel('Order', fontsize=12)
ax.set_title('ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®é›¶ç‚¹', fontsize=12)
ax.legend()
ax.set_xlim(0, 30)
ax.set_ylim(-0.5, 2.5)

# æ¼¸è¿‘æŒ™å‹•
ax = axes[1, 1]
x_large = np.linspace(5, 50, 500)
for nu in [0, 1]:
    y_exact = jv(nu, x_large)
    # æ¼¸è¿‘å±•é–‹: J_Î½(x) â‰ˆ sqrt(2/(Ï€x)) cos(x - Î½Ï€/2 - Ï€/4)
    y_asymp = np.sqrt(2/(np.pi*x_large)) * np.cos(x_large - nu*np.pi/2 - np.pi/4)
    
    ax.plot(x_large, y_exact, linewidth=2, label=f'$J_{{{nu}}}(x)$ exact')
    ax.plot(x_large, y_asymp, '--', linewidth=2, alpha=0.7, label=f'$J_{{{nu}}}(x)$ asymptotic')

ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('$J_\\nu(x)$', fontsize=12)
ax.set_title('ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®æ¼¸è¿‘æŒ™å‹•', fontsize=12)
ax.legend()

plt.suptitle('ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®åŸºæœ¬æ€§è³ª', fontsize=14)
plt.tight_layout()
plt.show()

print("=== ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®é›¶ç‚¹ ===")
for nu in [0, 1, 2]:
    zeros = jn_zeros(nu, 5)
    print(f"J_{nu}(x) ã®æœ€åˆã®5å€‹ã®é›¶ç‚¹: {zeros}")
print("\né›¶ç‚¹ã¯å††å½¢è†œã®å›ºæœ‰æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã«å¯¾å¿œ")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>5.2 å††ç­’åº§æ¨™ç³»ã§ã®æ³¢å‹•æ–¹ç¨‹å¼</h2>
                    <p>
                        å††ç­’åº§æ¨™ç³»ã§ã®æ³¢å‹•æ–¹ç¨‹å¼ã®è§£ã¯ã€ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã§è¡¨ã•ã‚Œã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>å††ç­’åº§æ¨™ã§ã®æ³¢å‹•æ–¹ç¨‹å¼:</strong></p>
                        $$\frac{1}{r}\frac{\partial}{\partial r}\left(r\frac{\partial u}{\partial r}\right) + \frac{1}{r^2}\frac{\partial^2 u}{\partial \theta^2} + \frac{\partial^2 u}{\partial z^2} = \frac{1}{c^2}\frac{\partial^2 u}{\partial t^2}$$
                        <p><strong>å¤‰æ•°åˆ†é›¢è§£:</strong></p>
                        $$u(r,\theta,z,t) = J_m(k_r r) e^{im\theta} e^{ik_z z} e^{-i\omega t}$$
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 2: å††å½¢è†œã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import jv, jn_zeros
from matplotlib import cm

# å††å½¢è†œã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
R = 1.0  # è†œã®åŠå¾„
c = 1.0  # æ³¢ã®é€Ÿåº¦

# æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ (m, n): m ã¯è§’åº¦æ–¹å‘ã®ç¯€æ•°ã€n ã¯å‹•å¾„æ–¹å‘ã®ç¯€æ•°
modes = [(0, 1), (1, 1), (0, 2), (2, 1), (1, 2), (0, 3)]

# ã‚°ãƒªãƒƒãƒ‰
r = np.linspace(0, R, 100)
theta = np.linspace(0, 2*np.pi, 100)
R_grid, Theta_grid = np.meshgrid(r, theta)

# å¯è¦–åŒ–
fig = plt.figure(figsize=(16, 10))

for idx, (m, n) in enumerate(modes, 1):
    # m æ¬¡ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã® n ç•ªç›®ã®é›¶ç‚¹
    k_mn = jn_zeros(m, n)[-1] / R
    
    # å›ºæœ‰æŒ¯å‹•æ•°
    omega_mn = c * k_mn
    
    # æŒ¯å¹…åˆ†å¸ƒ
    u_r = jv(m, k_mn * R_grid)
    u_theta = np.cos(m * Theta_grid)
    u = u_r * u_theta
    
    # æ¥µåº§æ¨™ã‹ã‚‰ç›´äº¤åº§æ¨™ã¸
    X = R_grid * np.cos(Theta_grid)
    Y = R_grid * np.sin(Theta_grid)
    
    # 3Dãƒ—ãƒ­ãƒƒãƒˆ
    ax = fig.add_subplot(2, 3, idx, projection='3d')
    surf = ax.plot_surface(X, Y, u, cmap=cm.coolwarm, alpha=0.9)
    
    ax.set_xlabel('x', fontsize=10)
    ax.set_ylabel('y', fontsize=10)
    ax.set_zlabel('u', fontsize=10)
    ax.set_title(f'Mode ({m},{n}): $\\omega_{{{m}{n}}} = {omega_mn:.2f}$', fontsize=11)
    ax.set_zlim(-1.5, 1.5)

plt.suptitle('å††å½¢è†œã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ï¼ˆå›ºæœ‰é–¢æ•°ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

# å›ºæœ‰æŒ¯å‹•æ•°ã®ãƒ†ãƒ¼ãƒ–ãƒ«
print("=== å††å½¢è†œã®å›ºæœ‰æŒ¯å‹•æ•° ===")
print("Mode (m,n) | k_mn | Ï‰_mn = cÂ·k_mn")
print("-" * 40)
for m, n in modes:
    k_mn = jn_zeros(m, n)[-1] / R
    omega_mn = c * k_mn
    print(f"  ({m},{n})    | {k_mn:.3f} | {omega_mn:.3f}")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>5.3 ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼</h2>
                    <p>
                        çƒåº§æ¨™ç³»ã§ã®å¢ƒç•Œå€¤å•é¡Œã§ã¯ã€ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ãŒé‡è¦ãªå½¹å‰²ã‚’æœãŸã—ã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¾®åˆ†æ–¹ç¨‹å¼:</strong></p>
                        $$\frac{d}{dx}\left[(1-x^2)\frac{dy}{dx}\right] + n(n+1)y = 0$$
                        <p><strong>ãƒ­ãƒ‰ãƒªã‚²ã‚¹ã®å…¬å¼:</strong></p>
                        $$P_n(x) = \frac{1}{2^n n!} \frac{d^n}{dx^n}[(x^2-1)^n]$$
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 3: ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ã®è¨ˆç®—ã¨æ€§è³ª</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import legendre, eval_legendre
from scipy.integrate import quad

# ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼
x = np.linspace(-1, 1, 500)
orders = range(6)

fig, axes = plt.subplots(2, 2, figsize=(14, 12))

# ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ã®ãƒ—ãƒ­ãƒƒãƒˆ
ax = axes[0, 0]
for n in orders:
    P_n = eval_legendre(n, x)
    ax.plot(x, P_n, linewidth=2, label=f'$P_{{{n}}}(x)$')

ax.axhline(0, color='gray', linewidth=0.5)
ax.axvline(0, color='gray', linewidth=0.5)
ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('$P_n(x)$', fontsize=12)
ax.set_title('ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼', fontsize=12)
ax.legend()

# ç›´äº¤æ€§ã®æ¤œè¨¼
ax = axes[0, 1]
n_max = 5
orthogonality_matrix = np.zeros((n_max+1, n_max+1))

for n in range(n_max+1):
    for m in range(n_max+1):
        # âˆ«[-1,1] P_n(x) P_m(x) dx
        integrand = lambda x: eval_legendre(n, x) * eval_legendre(m, x)
        integral, _ = quad(integrand, -1, 1)
        orthogonality_matrix[n, m] = integral

im = ax.imshow(orthogonality_matrix, cmap='RdBu_r', vmin=-0.1, vmax=1)
ax.set_xlabel('m', fontsize=12)
ax.set_ylabel('n', fontsize=12)
ax.set_title('ç›´äº¤æ€§: $\\int_{-1}^{1} P_n(x)P_m(x)dx$', fontsize=12)
plt.colorbar(im, ax=ax)

for n in range(n_max+1):
    for m in range(n_max+1):
        text = ax.text(m, n, f'{orthogonality_matrix[n, m]:.2f}',
                      ha="center", va="center", color="black", fontsize=9)

# ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ã®é›¶ç‚¹
ax = axes[1, 0]
for n in range(1, 6):
    P_n = legendre(n)
    zeros = P_n.roots
    ax.plot(zeros, n * np.ones_like(zeros), 'o', markersize=8, label=f'$P_{{{n}}}$')

ax.axvline(0, color='gray', linewidth=0.5)
ax.grid(True, alpha=0.3)
ax.set_xlabel('é›¶ç‚¹ã®ä½ç½®', fontsize=12)
ax.set_ylabel('æ¬¡æ•° n', fontsize=12)
ax.set_title('ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ã®é›¶ç‚¹', fontsize=12)
ax.set_xlim(-1.1, 1.1)
ax.legend()

# ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ã«ã‚ˆã‚‹é–¢æ•°è¿‘ä¼¼
ax = axes[1, 1]
# ã‚¿ãƒ¼ã‚²ãƒƒãƒˆé–¢æ•°: f(x) = |x|
f_target = np.abs(x)
ax.plot(x, f_target, 'b-', linewidth=2, label='$f(x) = |x|$')

# ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å±•é–‹
n_terms_list = [3, 5, 10, 20]
for n_terms in n_terms_list:
    # ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°ã®è¨ˆç®—
    coeffs = []
    for n in range(n_terms):
        integrand = lambda t: np.abs(t) * eval_legendre(n, t)
        c_n, _ = quad(integrand, -1, 1)
        c_n *= (2*n + 1) / 2  # æ­£è¦åŒ–
        coeffs.append(c_n)
    
    # è¿‘ä¼¼é–¢æ•°
    f_approx = np.zeros_like(x)
    for n, c_n in enumerate(coeffs):
        f_approx += c_n * eval_legendre(n, x)
    
    ax.plot(x, f_approx, linewidth=1.5, alpha=0.7, label=f'N={n_terms}')

ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('f(x)', fontsize=12)
ax.set_title('ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«ç´šæ•°å±•é–‹ã«ã‚ˆã‚‹è¿‘ä¼¼', fontsize=12)
ax.legend()

plt.suptitle('ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ã®æ€§è³ª', fontsize=14)
plt.tight_layout()
plt.show()

print("=== ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ã®ç›´äº¤æ€§ ===")
print("âˆ«[-1,1] P_n(x)P_m(x)dx = 2/(2n+1) Î´_nm")
for n in range(5):
    norm_squared = orthogonality_matrix[n, n]
    theoretical = 2 / (2*n + 1)
    print(f"n={n}: Numerical={norm_squared:.6f}, Theory={theoretical:.6f}")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>5.4 çƒé¢èª¿å’Œé–¢æ•°</h2>
                    <p>
                        çƒåº§æ¨™ç³»ã§ã®3æ¬¡å…ƒå•é¡Œã§ã¯ã€ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«é™ªé–¢æ•°ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹çƒé¢èª¿å’Œé–¢æ•°ã‚’ä½¿ã„ã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>çƒé¢èª¿å’Œé–¢æ•°:</strong></p>
                        $$Y_l^m(\theta, \phi) = \sqrt{\frac{(2l+1)}{4\pi}\frac{(l-m)!}{(l+m)!}} P_l^m(\cos\theta) e^{im\phi}$$
                        <p>ã“ã“ã§ $P_l^m$ ã¯ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«é™ªé–¢æ•°</p>
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 4: çƒé¢èª¿å’Œé–¢æ•°ã®å¯è¦–åŒ–</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import sph_harm
from mpl_toolkits.mplot3d import Axes3D

# çƒé¢èª¿å’Œé–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
modes = [
    (0, 0), (1, -1), (1, 0), (1, 1),
    (2, -2), (2, -1), (2, 0), (2, 1), (2, 2)
]

# çƒé¢ã‚°ãƒªãƒƒãƒ‰
theta = np.linspace(0, np.pi, 100)
phi = np.linspace(0, 2*np.pi, 100)
Theta, Phi = np.meshgrid(theta, phi)

fig = plt.figure(figsize=(16, 10))

for idx, (l, m) in enumerate(modes, 1):
    # çƒé¢èª¿å’Œé–¢æ•°ã®è¨ˆç®—
    Y_lm = sph_harm(m, l, Phi, Theta)
    
    # æŒ¯å¹…ï¼ˆå®Ÿéƒ¨ï¼‰
    Y_real = Y_lm.real
    
    # çƒé¢åº§æ¨™ã‹ã‚‰ç›´äº¤åº§æ¨™ã¸
    R = 0.5 + np.abs(Y_real)  # åŠå¾„ã‚’æŒ¯å¹…ã§å¤‰èª¿
    X = R * np.sin(Theta) * np.cos(Phi)
    Y = R * np.sin(Theta) * np.sin(Phi)
    Z = R * np.cos(Theta)
    
    # 3Dãƒ—ãƒ­ãƒƒãƒˆ
    ax = fig.add_subplot(3, 3, idx, projection='3d')
    surf = ax.plot_surface(X, Y, Z, facecolors=cm.seismic(Y_real/np.max(np.abs(Y_real))/2 + 0.5),
                           alpha=0.9, antialiased=True)
    
    ax.set_xlabel('x', fontsize=9)
    ax.set_ylabel('y', fontsize=9)
    ax.set_zlabel('z', fontsize=9)
    ax.set_title(f'$Y_{{{l}}}^{{{m}}}(\\theta, \\phi)$', fontsize=11)
    ax.set_xlim(-1.5, 1.5)
    ax.set_ylim(-1.5, 1.5)
    ax.set_zlim(-1.5, 1.5)

plt.suptitle('çƒé¢èª¿å’Œé–¢æ•°ï¼ˆå®Ÿéƒ¨ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

print("=== çƒé¢èª¿å’Œé–¢æ•°ã®æ€§è³ª ===")
print("ç›´äº¤æ€§: âˆ«âˆ« Y_l^m* Y_l'^m' sin(Î¸)dÎ¸dÏ† = Î´_ll' Î´_mm'")
print("\né‡å­åŠ›å­¦ã¸ã®å¿œç”¨:")
print("- æ°´ç´ åŸå­ã®è§’åº¦éƒ¨åˆ†ã®æ³¢å‹•é–¢æ•°")
print("- è§’é‹å‹•é‡ã®å›ºæœ‰çŠ¶æ…‹")
print("- l: æ–¹ä½é‡å­æ•°, m: ç£æ°—é‡å­æ•° (-l â‰¤ m â‰¤ l)")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>5.5 ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼</h2>
                    <p>
                        èª¿å’ŒæŒ¯å‹•å­ã®é‡å­åŠ›å­¦çš„è§£ã¨ã—ã¦ç¾ã‚Œã‚‹ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼ã‚’å­¦ã³ã¾ã™ã€‚
                    </p>

                    <div class="theory-box">
                        <h4>ğŸ“ ç†è«–</h4>
                        <p><strong>ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¾®åˆ†æ–¹ç¨‹å¼:</strong></p>
                        $$\frac{d^2y}{dx^2} - 2x\frac{dy}{dx} + 2ny = 0$$
                        <p><strong>ãƒ­ãƒ‰ãƒªã‚²ã‚¹ã®å…¬å¼:</strong></p>
                        $$H_n(x) = (-1)^n e^{x^2} \frac{d^n}{dx^n} e^{-x^2}$$
                    </div>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 5: ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼ã¨èª¿å’ŒæŒ¯å‹•å­</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import hermite, eval_hermite
from scipy.integrate import quad

# ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼
x = np.linspace(-4, 4, 500)
orders = range(6)

fig, axes = plt.subplots(2, 2, figsize=(14, 12))

# ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼
ax = axes[0, 0]
for n in orders:
    H_n = eval_hermite(n, x)
    ax.plot(x, H_n, linewidth=2, label=f'$H_{{{n}}}(x)$')

ax.axhline(0, color='gray', linewidth=0.5)
ax.axvline(0, color='gray', linewidth=0.5)
ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('$H_n(x)$', fontsize=12)
ax.set_title('ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼', fontsize=12)
ax.legend()
ax.set_ylim(-100, 100)

# èª¿å’ŒæŒ¯å‹•å­ã®æ³¢å‹•é–¢æ•°
ax = axes[0, 1]
for n in range(5):
    # Ïˆ_n(x) = (1/sqrt(2^n n!)) (1/Ï€)^(1/4) e^(-xÂ²/2) H_n(x)
    normalization = 1 / np.sqrt(2**n * np.math.factorial(n)) * (1/np.pi)**0.25
    psi_n = normalization * np.exp(-x**2 / 2) * eval_hermite(n, x)
    ax.plot(x, psi_n + n, linewidth=2, label=f'$\\psi_{{{n}}}(x)$')

# ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
V = 0.5 * x**2
ax.plot(x, V, 'k--', linewidth=2, alpha=0.5, label='$V(x) = x^2/2$')

ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼', fontsize=12)
ax.set_title('èª¿å’ŒæŒ¯å‹•å­ã®æ³¢å‹•é–¢æ•°', fontsize=12)
ax.legend()
ax.set_ylim(-0.5, 5)

# ç¢ºç‡å¯†åº¦
ax = axes[1, 0]
for n in range(5):
    normalization = 1 / np.sqrt(2**n * np.math.factorial(n)) * (1/np.pi)**0.25
    psi_n = normalization * np.exp(-x**2 / 2) * eval_hermite(n, x)
    prob_density = np.abs(psi_n)**2
    ax.plot(x, prob_density, linewidth=2, label=f'$|\\psi_{{{n}}}(x)|^2$')

ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('ç¢ºç‡å¯†åº¦', fontsize=12)
ax.set_title('ç¢ºç‡å¯†åº¦åˆ†å¸ƒ', fontsize=12)
ax.legend()

# ç›´äº¤æ€§ã®æ¤œè¨¼
ax = axes[1, 1]
n_max = 5
orthogonality_matrix = np.zeros((n_max+1, n_max+1))

for n in range(n_max+1):
    for m in range(n_max+1):
        # âˆ«[-âˆ,âˆ] H_n(x) H_m(x) e^(-xÂ²) dx
        integrand = lambda x: eval_hermite(n, x) * eval_hermite(m, x) * np.exp(-x**2)
        integral, _ = quad(integrand, -np.inf, np.inf)
        orthogonality_matrix[n, m] = integral / (np.sqrt(np.pi) * 2**n * np.math.factorial(n))

im = ax.imshow(orthogonality_matrix, cmap='RdBu_r', vmin=-0.1, vmax=1.1)
ax.set_xlabel('m', fontsize=12)
ax.set_ylabel('n', fontsize=12)
ax.set_title('ç›´äº¤æ€§ï¼ˆé‡ã¿é–¢æ•°: $e^{-x^2}$ï¼‰', fontsize=12)
plt.colorbar(im, ax=ax)

for n in range(n_max+1):
    for m in range(n_max+1):
        text = ax.text(m, n, f'{orthogonality_matrix[n, m]:.2f}',
                      ha="center", va="center", color="black", fontsize=9)

plt.suptitle('ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼ã¨èª¿å’ŒæŒ¯å‹•å­', fontsize=14)
plt.tight_layout()
plt.show()

print("=== ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼ã®ç›´äº¤æ€§ ===")
print("âˆ«[-âˆ,âˆ] H_n(x)H_m(x)e^(-xÂ²)dx = sqrt(Ï€) 2^n n! Î´_nm")
print("\nèª¿å’ŒæŒ¯å‹•å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼å›ºæœ‰å€¤:")
for n in range(5):
    E_n = n + 0.5  # E_n = Ä§Ï‰(n + 1/2), Ä§Ï‰ = 1
    print(f"n={n}: E_{n} = {E_n}")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>5.6 ãƒ©ã‚²ãƒ¼ãƒ«å¤šé …å¼</h2>
                    <p>
                        æ°´ç´ åŸå­ã®å‹•å¾„æ³¢å‹•é–¢æ•°ã«ç¾ã‚Œã‚‹ãƒ©ã‚²ãƒ¼ãƒ«å¤šé …å¼ã‚’å­¦ã³ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 6: ãƒ©ã‚²ãƒ¼ãƒ«å¤šé …å¼ã¨æ°´ç´ åŸå­</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import genlaguerre, eval_genlaguerre

# ãƒ©ã‚²ãƒ¼ãƒ«å¤šé …å¼
x = np.linspace(0, 20, 500)

fig, axes = plt.subplots(2, 2, figsize=(14, 12))

# ä¸€èˆ¬ãƒ©ã‚²ãƒ¼ãƒ«å¤šé …å¼ L_n^Î±(x)
ax = axes[0, 0]
alpha = 0
for n in range(5):
    L_n = eval_genlaguerre(n, alpha, x)
    ax.plot(x, L_n, linewidth=2, label=f'$L_{{{n}}}^{{0}}(x)$')

ax.axhline(0, color='gray', linewidth=0.5)
ax.grid(True, alpha=0.3)
ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('$L_n^{0}(x)$', fontsize=12)
ax.set_title('ãƒ©ã‚²ãƒ¼ãƒ«å¤šé …å¼ï¼ˆÎ±=0ï¼‰', fontsize=12)
ax.legend()
ax.set_ylim(-5, 10)

# æ°´ç´ åŸå­ã®å‹•å¾„æ³¢å‹•é–¢æ•°
ax = axes[0, 1]
a0 = 1.0  # ãƒœãƒ¼ã‚¢åŠå¾„
r = np.linspace(0, 20*a0, 500)

# ä¸»é‡å­æ•° n, æ–¹ä½é‡å­æ•° l
states = [(1, 0), (2, 0), (2, 1), (3, 0), (3, 1)]

for n, l in states:
    # å‹•å¾„æ³¢å‹•é–¢æ•° R_nl(r)
    rho = 2 * r / (n * a0)
    
    # æ­£è¦åŒ–å®šæ•°
    normalization = np.sqrt((2/(n*a0))**3 * np.math.factorial(n-l-1) / (2*n*np.math.factorial(n+l)))
    
    # R_nl = normalization Ã— rho^l Ã— e^(-rho/2) Ã— L_{n-l-1}^{2l+1}(rho)
    L = eval_genlaguerre(n-l-1, 2*l+1, rho)
    R_nl = normalization * rho**l * np.exp(-rho/2) * L
    
    ax.plot(r/a0, R_nl, linewidth=2, label=f'$R_{{{n}{l}}}(r)$')

ax.axhline(0, color='gray', linewidth=0.5)
ax.grid(True, alpha=0.3)
ax.set_xlabel('$r/a_0$', fontsize=12)
ax.set_ylabel('$R_{nl}(r)$', fontsize=12)
ax.set_title('æ°´ç´ åŸå­ã®å‹•å¾„æ³¢å‹•é–¢æ•°', fontsize=12)
ax.legend()

# å‹•å¾„ç¢ºç‡å¯†åº¦
ax = axes[1, 0]
for n, l in states:
    rho = 2 * r / (n * a0)
    normalization = np.sqrt((2/(n*a0))**3 * np.math.factorial(n-l-1) / (2*n*np.math.factorial(n+l)))
    L = eval_genlaguerre(n-l-1, 2*l+1, rho)
    R_nl = normalization * rho**l * np.exp(-rho/2) * L
    
    # å‹•å¾„ç¢ºç‡å¯†åº¦: P(r) = rÂ² |R_nl(r)|Â²
    P_r = r**2 * R_nl**2
    ax.plot(r/a0, P_r, linewidth=2, label=f'$r^2|R_{{{n}{l}}}|^2$')

ax.grid(True, alpha=0.3)
ax.set_xlabel('$r/a_0$', fontsize=12)
ax.set_ylabel('å‹•å¾„ç¢ºç‡å¯†åº¦', fontsize=12)
ax.set_title('å‹•å¾„ç¢ºç‡å¯†åº¦åˆ†å¸ƒ', fontsize=12)
ax.legend()

# ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½
ax = axes[1, 1]
n_values = np.arange(1, 6)
E_n = -13.6 / n_values**2  # eV

for n in n_values:
    ax.hlines(E_n[n-1], 0, 1, colors='blue', linewidth=3)
    ax.text(1.1, E_n[n-1], f'n={n}, E={E_n[n-1]:.2f} eV', fontsize=10, va='center')
    
    # å„nã«å¯¾ã™ã‚‹ l ã®ç¸®é€€
    for l in range(n):
        offset = 0.05 + 0.15*l/n
        ax.plot([offset], [E_n[n-1]], 'ro', markersize=8)
        if l < 3:
            ax.text(offset, E_n[n-1] - 0.5, ['s','p','d'][l], fontsize=9, ha='center')

ax.set_xlim(-0.1, 2)
ax.set_ylim(-14, 0)
ax.set_ylabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
ax.set_title('æ°´ç´ åŸå­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½', fontsize=12)
ax.axhline(0, color='gray', linestyle='--', alpha=0.5)
ax.text(1.5, -1, 'é€£ç¶šçŠ¶æ…‹', fontsize=10)
ax.text(1.5, -12, 'æŸç¸›çŠ¶æ…‹', fontsize=10)
ax.grid(True, alpha=0.3, axis='y')

plt.suptitle('ãƒ©ã‚²ãƒ¼ãƒ«å¤šé …å¼ã¨æ°´ç´ åŸå­', fontsize=14)
plt.tight_layout()
plt.show()

print("=== æ°´ç´ åŸå­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ ===")
print("E_n = -13.6 eV / nÂ²")
for n in range(1, 6):
    E = -13.6 / n**2
    print(f"n={n}: E_{n} = {E:.3f} eV")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>5.7 ç‰¹æ®Šé–¢æ•°ã®ã¾ã¨ã‚ã¨é–¢ä¿‚</h2>
                    <p>
                        ã“ã‚Œã¾ã§å­¦ã‚“ã ç‰¹æ®Šé–¢æ•°ã®é–¢ä¿‚ã¨å¿œç”¨ã‚’ã¾ã¨ã‚ã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 7: ç‰¹æ®Šé–¢æ•°ã®é–¢ä¿‚ãƒãƒƒãƒ—</h4>
                        <pre><code class="language-python">import matplotlib.pyplot as plt
import matplotlib.patches as mpatches
from matplotlib.patches import FancyBboxPatch, FancyArrowPatch

fig, ax = plt.subplots(figsize=(14, 10))
ax.set_xlim(0, 10)
ax.set_ylim(0, 10)
ax.axis('off')

# ç‰¹æ®Šé–¢æ•°ã®ãƒœãƒƒã‚¯ã‚¹
functions = {
    'Bessel': {'pos': (1, 8), 'color': '#FFE5B4'},
    'Legendre': {'pos': (5, 8), 'color': '#B4D7FF'},
    'Hermite': {'pos': (1, 5), 'color': '#C8FFB4'},
    'Laguerre': {'pos': (5, 5), 'color': '#FFB4D7'},
    'Spherical Harmonics': {'pos': (8, 6.5), 'color': '#D7B4FF'},
}

# å¿œç”¨ã®ãƒœãƒƒã‚¯ã‚¹
applications = {
    'å††ç­’åº§æ¨™\næ³¢å‹•å•é¡Œ': {'pos': (1, 2), 'func': 'Bessel'},
    'çƒåº§æ¨™\nãƒ©ãƒ—ãƒ©ã‚¹æ–¹ç¨‹å¼': {'pos': (5, 2), 'func': 'Legendre'},
    'èª¿å’ŒæŒ¯å‹•å­\né‡å­åŠ›å­¦': {'pos': (1, 0.5), 'func': 'Hermite'},
    'æ°´ç´ åŸå­\né‡å­åŠ›å­¦': {'pos': (5, 0.5), 'func': 'Laguerre'},
    'è§’é‹å‹•é‡\né‡å­åŠ›å­¦': {'pos': (8, 3), 'func': 'Spherical Harmonics'},
}

# ç‰¹æ®Šé–¢æ•°ã®ãƒœãƒƒã‚¯ã‚¹æç”»
for name, info in functions.items():
    box = FancyBboxPatch((info['pos'][0]-0.6, info['pos'][1]-0.3), 1.2, 0.6,
                         boxstyle="round,pad=0.1", 
                         edgecolor='black', facecolor=info['color'], linewidth=2)
    ax.add_patch(box)
    ax.text(info['pos'][0], info['pos'][1], name, ha='center', va='center', 
           fontsize=11, fontweight='bold')

# å¿œç”¨ã®ãƒœãƒƒã‚¯ã‚¹æç”»
for name, info in applications.items():
    box = FancyBboxPatch((info['pos'][0]-0.5, info['pos'][1]-0.25), 1.0, 0.5,
                         boxstyle="round,pad=0.05",
                         edgecolor='blue', facecolor='white', linewidth=1, linestyle='--')
    ax.add_patch(box)
    ax.text(info['pos'][0], info['pos'][1], name, ha='center', va='center',
           fontsize=9)

# çŸ¢å°ï¼ˆç‰¹æ®Šé–¢æ•° â†’ å¿œç”¨ï¼‰
arrows = [
    ((1, 7.7), (1, 2.5)),  # Bessel â†’ å††ç­’åº§æ¨™
    ((1, 7.7), (1, 1.0)),  # Bessel â†’ (Hermiteã¸ã®å¯„ã‚Šé“ãªã—ã€ç›´æ¥æç”»ã—ãªã„)
    ((5, 7.7), (5, 2.5)),  # Legendre â†’ çƒåº§æ¨™
    ((1, 4.7), (1, 1.0)),  # Hermite â†’ èª¿å’ŒæŒ¯å‹•å­
    ((5, 4.7), (5, 1.0)),  # Laguerre â†’ æ°´ç´ åŸå­
    ((7.4, 6.5), (7.5, 3.5)),  # Spherical â†’ è§’é‹å‹•é‡
]

for start, end in arrows:
    arrow = FancyArrowPatch(start, end, arrowstyle='->', 
                           mutation_scale=20, linewidth=2, color='gray')
    ax.add_patch(arrow)

# ã‚¿ã‚¤ãƒˆãƒ«ã¨ãƒ©ãƒ™ãƒ«
ax.text(5, 9.5, 'ç‰¹æ®Šé–¢æ•°ã¨ç‰©ç†å¿œç”¨ã®é–¢ä¿‚', ha='center', fontsize=16, fontweight='bold')

# å‡¡ä¾‹
legend_elements = [
    mpatches.Patch(facecolor='lightgray', edgecolor='black', label='ç‰¹æ®Šé–¢æ•°'),
    mpatches.Patch(facecolor='white', edgecolor='blue', linestyle='--', label='ç‰©ç†å¿œç”¨'),
]
ax.legend(handles=legend_elements, loc='upper right', fontsize=10)

plt.tight_layout()
plt.show()

print("=== ç‰¹æ®Šé–¢æ•°ã®ç·æ‹¬ ===\n")

print("ã€åº§æ¨™ç³»ã¨ç‰¹æ®Šé–¢æ•°ã®å¯¾å¿œã€‘")
print("ãƒ»ç›´äº¤åº§æ¨™: ä¸‰è§’é–¢æ•° (sin, cos)")
print("ãƒ»å††ç­’åº§æ¨™: ãƒ™ãƒƒã‚»ãƒ«é–¢æ•° (J_n, Y_n)")
print("ãƒ»çƒåº§æ¨™: ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ (P_n), çƒé¢èª¿å’Œé–¢æ•° (Y_l^m)")
print()

print("ã€é‡å­åŠ›å­¦ã¨ç‰¹æ®Šé–¢æ•°ã€‘")
print("ãƒ»èª¿å’ŒæŒ¯å‹•å­: ã‚¨ãƒ«ãƒŸãƒ¼ãƒˆå¤šé …å¼ (H_n)")
print("ãƒ»æ°´ç´ åŸå­ï¼ˆå‹•å¾„ï¼‰: ãƒ©ã‚²ãƒ¼ãƒ«å¤šé …å¼ (L_n^Î±)")
print("ãƒ»æ°´ç´ åŸå­ï¼ˆè§’åº¦ï¼‰: çƒé¢èª¿å’Œé–¢æ•° (Y_l^m)")
print("ãƒ»è§’é‹å‹•é‡: çƒé¢èª¿å’Œé–¢æ•° (Y_l^m)")
print()

print("ã€å…±é€šã®æ€§è³ªã€‘")
print("ãƒ»ç›´äº¤æ€§: âˆ« Ï†_n(x) Ï†_m(x) w(x) dx = Î´_nm (é‡ã¿é–¢æ•° w(x))")
print("ãƒ»å®Œå…¨æ€§: ä»»æ„ã®é–¢æ•°ã‚’ç‰¹æ®Šé–¢æ•°ã§å±•é–‹å¯èƒ½")
print("ãƒ»å¾®åˆ†æ–¹ç¨‹å¼: ç‰©ç†çš„å¢ƒç•Œå€¤å•é¡Œã®å›ºæœ‰é–¢æ•°")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>5.8 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨(1): å††æŸ±è©¦æ–™ã®ç†±ä¼å°</h2>
                    <p>
                        å††ç­’åº§æ¨™ç³»ã§ã®ç†±ä¼å°æ–¹ç¨‹å¼ã‚’ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã§è§£ãã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 8: å††æŸ±è©¦æ–™ã®ç†±æ‹¡æ•£ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import jv, jn_zeros
from matplotlib.animation import FuncAnimation
from IPython.display import HTML

# å††æŸ±è©¦æ–™ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
R = 1.0  # åŠå¾„ (cm)
alpha = 0.1  # ç†±æ‹¡æ•£ç‡ (cmÂ²/s)
T_initial = 100  # åˆæœŸæ¸©åº¦ (â„ƒ)
T_surface = 0  # è¡¨é¢æ¸©åº¦ (â„ƒ)

# åˆæœŸæ¸©åº¦åˆ†å¸ƒï¼ˆä¸€æ§˜ï¼‰
def initial_temp(r):
    return T_initial * np.ones_like(r)

# ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã«ã‚ˆã‚‹è§£
def temperature(r, t, n_terms=20):
    """
    ç†±ä¼å°æ–¹ç¨‹å¼ã®è§£:
    T(r,t) = T_surface + Î£ A_n J_0(Î»_n r) exp(-Î± Î»_nÂ² t)
    
    å¢ƒç•Œæ¡ä»¶: T(R,t) = T_surface
    åˆæœŸæ¡ä»¶: T(r,0) = T_initial
    """
    # ãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã®é›¶ç‚¹
    zeros = jn_zeros(0, n_terms)
    lambdas = zeros / R
    
    # ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•° A_n
    A_n = []
    for lam in lambdas:
        # A_n = 2/(R J_1(Î»_n R)) âˆ«[0,R] r (T_initial - T_surface) J_0(Î»_n r) dr
        # ä¸€æ§˜åˆæœŸæ¸©åº¦ã®å ´åˆ: A_n = 2(T_initial - T_surface) / (Î»_n R J_1(Î»_n R))
        A = 2 * (T_initial - T_surface) / (lam * R * jv(1, lam * R))
        A_n.append(A)
    
    # æ¸©åº¦è¨ˆç®—
    T = T_surface * np.ones_like(r)
    for A, lam in zip(A_n, lambdas):
        T += A * jv(0, lam * r) * np.exp(-alpha * lam**2 * t)
    
    return T

# å¯è¦–åŒ–
r_grid = np.linspace(0, R, 100)
t_values = [0, 1, 5, 10, 20, 50]

fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

for idx, t in enumerate(t_values):
    ax = axes[idx]
    T = temperature(r_grid, t)
    
    ax.plot(r_grid, T, 'b-', linewidth=2)
    ax.axhline(T_surface, color='red', linestyle='--', linewidth=1, label=f'Surface T={T_surface}Â°C')
    ax.axhline(T_initial, color='green', linestyle='--', linewidth=1, alpha=0.5, label=f'Initial T={T_initial}Â°C')
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('åŠå¾„ä½ç½® r (cm)', fontsize=11)
    ax.set_ylabel('æ¸©åº¦ T (Â°C)', fontsize=11)
    ax.set_title(f't = {t} s', fontsize=12)
    ax.set_xlim(0, R)
    ax.set_ylim(-5, 105)
    if idx == 0:
        ax.legend()

plt.suptitle('å††æŸ±è©¦æ–™ã®ç†±æ‹¡æ•£ï¼ˆãƒ™ãƒƒã‚»ãƒ«é–¢æ•°ã«ã‚ˆã‚‹è§£ï¼‰', fontsize=14)
plt.tight_layout()
plt.show()

# ä¸­å¿ƒæ¸©åº¦ã®æ™‚é–“å¤‰åŒ–
t_range = np.linspace(0, 50, 500)
T_center = [temperature(0, t) for t in t_range]

plt.figure(figsize=(10, 6))
plt.plot(t_range, T_center, 'b-', linewidth=2)
plt.axhline(T_surface, color='red', linestyle='--', linewidth=1, label='Surface temperature')
plt.axhline(T_initial, color='green', linestyle='--', linewidth=1, alpha=0.5, label='Initial temperature')
plt.grid(True, alpha=0.3)
plt.xlabel('æ™‚é–“ t (s)', fontsize=12)
plt.ylabel('ä¸­å¿ƒæ¸©åº¦ T(0,t) (Â°C)', fontsize=12)
plt.title('å††æŸ±ä¸­å¿ƒã®æ¸©åº¦å¤‰åŒ–', fontsize=14)
plt.legend()
plt.tight_layout()
plt.show()

print("=== å††æŸ±è©¦æ–™ã®ç†±æ‹¡æ•£ ===")
print(f"è©¦æ–™åŠå¾„: R = {R} cm")
print(f"ç†±æ‹¡æ•£ç‡: Î± = {alpha} cmÂ²/s")
print(f"åˆæœŸæ¸©åº¦: T_initial = {T_initial} Â°C")
print(f"è¡¨é¢æ¸©åº¦: T_surface = {T_surface} Â°C")
print(f"\nç‰¹æ€§æ™‚é–“: Ï„ = RÂ²/Î± = {R**2/alpha:.2f} s")
print(f"t = Ï„ ã®ã¨ãã€æ¸©åº¦ã¯ç´„37%ã¾ã§æ¸›è¡°")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>5.9 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨(2): çƒå½¢ç²’å­ã®æ‹¡æ•£å•é¡Œ</h2>
                    <p>
                        çƒåº§æ¨™ç³»ã§ã®æ‹¡æ•£æ–¹ç¨‹å¼ã‚’ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ã§è§£ãã¾ã™ã€‚
                    </p>

                    <div class="code-example">
                        <h4>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹ 9: çƒå½¢ç²’å­ã‹ã‚‰ã®ç‰©è³ªæ‹¡æ•£</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import spherical_jn

# çƒå½¢ç²’å­ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
R = 1.0  # ç²’å­åŠå¾„ (Î¼m)
D = 0.1  # æ‹¡æ•£ä¿‚æ•° (Î¼mÂ²/s)
C_initial = 1.0  # åˆæœŸæ¿ƒåº¦
C_infinity = 0.0  # é æ–¹ã§ã®æ¿ƒåº¦

# çƒåº§æ¨™ã§ã®æ‹¡æ•£æ–¹ç¨‹å¼ã®è§£ï¼ˆçƒå¯¾ç§°ï¼‰
def concentration(r, t, n_terms=20):
    """
    æ‹¡æ•£æ–¹ç¨‹å¼ã®è§£ï¼ˆçƒå¯¾ç§°ï¼‰:
    C(r,t) = C_infinity + Î£ A_n (sin(k_n r)/r) exp(-D k_nÂ² t)
    
    å¢ƒç•Œæ¡ä»¶: C(R,t) = C_infinity
    åˆæœŸæ¡ä»¶: C(r,0) = C_initial (r < R), C_infinity (r > R)
    """
    # å¢ƒç•Œæ¡ä»¶ã‚ˆã‚Š k_n = nÏ€/R
    k_n = np.pi * np.arange(1, n_terms+1) / R
    
    # ãƒ•ãƒ¼ãƒªã‚¨ä¿‚æ•°
    A_n = []
    for k in k_n:
        # A_n = 2R(C_initial - C_infinity)(-1)^(n+1) / (nÏ€)
        n = k * R / np.pi
        A = 2 * R * (C_initial - C_infinity) * (-1)**(int(n)+1) / (n * np.pi)
        A_n.append(A)
    
    # æ¿ƒåº¦è¨ˆç®—
    C = C_infinity * np.ones_like(r)
    for A, k in zip(A_n, k_n):
        # r > 0 ã®éƒ¨åˆ†ã®ã¿è¨ˆç®—
        mask = r > 1e-10
        C[mask] += A * np.sin(k * r[mask]) / r[mask] * np.exp(-D * k**2 * t)
    
    return C

# å¯è¦–åŒ–: ç©ºé–“åˆ†å¸ƒã®æ™‚é–“å¤‰åŒ–
r_grid = np.linspace(0.01, 3*R, 200)
t_values = [0, 2, 5, 10, 20, 50]

fig, axes = plt.subplots(2, 3, figsize=(15, 10))
axes = axes.flatten()

for idx, t in enumerate(t_values):
    ax = axes[idx]
    C = concentration(r_grid, t)
    
    ax.plot(r_grid, C, 'b-', linewidth=2)
    ax.axvline(R, color='red', linestyle='--', linewidth=2, alpha=0.5, label=f'Particle surface (r=R)')
    ax.axhline(C_initial, color='green', linestyle='--', linewidth=1, alpha=0.5)
    ax.axhline(C_infinity, color='gray', linestyle='--', linewidth=1, alpha=0.5)
    ax.grid(True, alpha=0.3)
    ax.set_xlabel('è·é›¢ r (Î¼m)', fontsize=11)
    ax.set_ylabel('æ¿ƒåº¦ C', fontsize=11)
    ax.set_title(f't = {t} s', fontsize=12)
    ax.set_xlim(0, 3*R)
    ax.set_ylim(-0.1, 1.1)
    if idx == 0:
        ax.legend()

plt.suptitle('çƒå½¢ç²’å­ã‹ã‚‰ã®ç‰©è³ªæ‹¡æ•£', fontsize=14)
plt.tight_layout()
plt.show()

# ç²’å­å†…éƒ¨ã®å¹³å‡æ¿ƒåº¦
def average_concentration(t, n_terms=50):
    """ç²’å­å†…éƒ¨ã®å¹³å‡æ¿ƒåº¦"""
    k_n = np.pi * np.arange(1, n_terms+1) / R
    C_avg = C_infinity
    
    for n, k in enumerate(k_n, 1):
        A = 2 * R * (C_initial - C_infinity) * (-1)**(n+1) / (n * np.pi)
        # ç©åˆ†: âˆ«[0,R] (sin(kr)/r) rÂ² dr = ...
        integral_term = 6 / (n * np.pi)**2
        C_avg += A * integral_term * np.exp(-D * k**2 * t)
    
    return C_avg

# å¹³å‡æ¿ƒåº¦ã®æ™‚é–“å¤‰åŒ–
t_range = np.linspace(0, 100, 500)
C_avg = [average_concentration(t) for t in t_range]

# æ”¾å‡ºç‡ã®è¨ˆç®—
release_fraction = (C_initial - np.array(C_avg)) / (C_initial - C_infinity)

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å¹³å‡æ¿ƒåº¦
ax1.plot(t_range, C_avg, 'b-', linewidth=2)
ax1.axhline(C_initial, color='green', linestyle='--', linewidth=1, label='Initial concentration')
ax1.axhline(C_infinity, color='gray', linestyle='--', linewidth=1, label='Final concentration')
ax1.grid(True, alpha=0.3)
ax1.set_xlabel('æ™‚é–“ t (s)', fontsize=12)
ax1.set_ylabel('å¹³å‡æ¿ƒåº¦ $\\langle C \\rangle$', fontsize=12)
ax1.set_title('ç²’å­å†…éƒ¨ã®å¹³å‡æ¿ƒåº¦', fontsize=14)
ax1.legend()

# æ”¾å‡ºç‡
ax2.plot(t_range, release_fraction, 'r-', linewidth=2)
ax2.axhline(1.0, color='gray', linestyle='--', linewidth=1, alpha=0.5)
ax2.grid(True, alpha=0.3)
ax2.set_xlabel('æ™‚é–“ t (s)', fontsize=12)
ax2.set_ylabel('æ”¾å‡ºç‡', fontsize=12)
ax2.set_title('ç´¯ç©æ”¾å‡ºç‡ï¼ˆè–¬ç‰©æ”¾å‡ºãªã©ï¼‰', fontsize=14)
ax2.set_ylim(0, 1.1)

plt.tight_layout()
plt.show()

print("=== çƒå½¢ç²’å­ã®æ‹¡æ•£å•é¡Œ ===")
print(f"ç²’å­åŠå¾„: R = {R} Î¼m")
print(f"æ‹¡æ•£ä¿‚æ•°: D = {D} Î¼mÂ²/s")
print(f"\nç‰¹æ€§æ™‚é–“: Ï„ = RÂ²/D = {R**2/D:.2f} s")
print(f"\nå¿œç”¨ä¾‹:")
print("- è–¬ç‰©å¾æ”¾ã‚«ãƒ—ã‚»ãƒ«ï¼ˆDDS: Drug Delivery Systemï¼‰")
print("- è§¦åª’ç²’å­ã‹ã‚‰ã®åå¿œç‰©æ‹¡æ•£")
print("- ãƒŠãƒç²’å­ã®æº¶è§£")</code></pre>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>ğŸ“ ç« æœ«å•é¡Œ</h2>
                    <div class="exercise-box">
                        <h4>æ¼”ç¿’å•é¡Œ</h4>
                        <ol>
                            <li>$J_0(x)$ ã®æœ€åˆã®3ã¤ã®æ­£ã®é›¶ç‚¹ã‚’æ•°å€¤çš„ã«æ±‚ã‚ã€å††å½¢è†œã®å›ºæœ‰æŒ¯å‹•æ•°ã‚’è¨ˆç®—ã›ã‚ˆã€‚</li>
                            <li>ãƒ«ã‚¸ãƒ£ãƒ³ãƒ‰ãƒ«å¤šé …å¼ $P_2(x)$ ã¨ $P_3(x)$ ã®ç›´äº¤æ€§ã‚’æ•°å€¤ç©åˆ†ã§æ¤œè¨¼ã›ã‚ˆã€‚</li>
                            <li>çƒé¢èª¿å’Œé–¢æ•° $Y_2^1(\theta, \phi)$ ã‚’å¯è¦–åŒ–ã—ã€ãã®ç¯€ç·šã‚’ç¢ºèªã›ã‚ˆã€‚</li>
                            <li>èª¿å’ŒæŒ¯å‹•å­ã®æ³¢å‹•é–¢æ•° $\psi_3(x)$ ã®ç¯€ã®æ•°ã‚’ç¢ºèªã—ã€å¤å…¸çš„è»¢å›ç‚¹ã®ä½ç½®ã‚’æ±‚ã‚ã‚ˆã€‚</li>
                        </ol>
                    </div>
                </section>

                <section class="chapter-section">
                    <h2>ğŸ”— å‚è€ƒæ–‡çŒ®</h2>
                    <ul class="reference-list">
                        <li>Arfken, G. B., Weber, H. J., & Harris, F. E. (2013). <em>Mathematical Methods for Physicists</em>. Academic Press.</li>
                        <li>Abramowitz, M., & Stegun, I. A. (1965). <em>Handbook of Mathematical Functions</em>. Dover.</li>
                        <li>Gradshteyn, I. S., & Ryzhik, I. M. (2007). <em>Table of Integrals, Series, and Products</em>. Academic Press.</li>
                    </ul>
                </section>
            </article>

            <nav class="chapter-navigation">
                <a href="chapter-4.html" class="btn btn-secondary">â† ç¬¬4ç« ã¸</a>
                <a href="index.html" class="btn btn-primary">ã‚·ãƒªãƒ¼ã‚ºãƒˆãƒƒãƒ—ã¸ â†’</a>
            </nav>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2025 AI Terakoya. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
