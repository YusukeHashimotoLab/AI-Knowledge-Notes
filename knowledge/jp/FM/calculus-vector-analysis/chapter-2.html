<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : ç©åˆ†ã®åŸºç¤ã¨æ•°å€¤ç©åˆ† | å¾®ç©åˆ†ã¨ãƒ™ã‚¯ãƒˆãƒ«è§£æå…¥é–€</title>
    <meta name="description" content="å®šç©åˆ†ãƒ»ä¸å®šç©åˆ†ã®åŸºç¤ã‹ã‚‰æ•°å€¤ç©åˆ†æ³•ï¼ˆå°å½¢å‰‡ã€Simpsonå‰‡ã€Gaussæ±‚ç©æ³•ï¼‰ã¾ã§å®Ÿè£…ã—ã¾ã™ã€‚">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-block { background: #282c34; color: #abb2bf; padding: 1.5rem; border-radius: 8px; overflow-x: auto; margin: 1rem 0; }
        .code-block code { font-family: 'Consolas', 'Monaco', monospace; font-size: 0.9rem; line-height: 1.6; }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>
</head>
<body>
    <header>
        <h1>ç¬¬2ç« : ç©åˆ†ã®åŸºç¤ã¨æ•°å€¤ç©åˆ†</h1>
        <p class="subtitle">Fundamentals of Integration and Numerical Integration</p>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">å¾®ç©åˆ†ã¨ãƒ™ã‚¯ãƒˆãƒ«è§£æå…¥é–€</a> &gt;
            ç¬¬2ç« 
        </div>

        <div class="content">
            <h2>2.1 å®šç©åˆ†ã¨ä¸å®šç©åˆ†</h2>

            <div class="definition">
                <strong>ğŸ“ å®šç¾©: å®šç©åˆ†</strong><br>
                é–¢æ•° f(x) ã®åŒºé–“ [a, b] ã«ãŠã‘ã‚‹å®šç©åˆ†ã¯ã€ãƒªãƒ¼ãƒãƒ³å’Œã®æ¥µé™ã¨ã—ã¦å®šç¾©ã•ã‚Œã¾ã™ï¼š
                $$\int_a^b f(x) dx = \lim_{n \to \infty} \sum_{i=1}^n f(x_i^*) \Delta x$$
                å¹¾ä½•å­¦çš„ã«ã¯ã€æ›²ç·š y = f(x) ã¨ x è»¸ã§å›²ã¾ã‚ŒãŸé¢ç©ã‚’è¡¨ã—ã¾ã™ã€‚
            </div>

            <p>
                ç©åˆ†ã¯ã€Œç´¯ç©é‡ã€ã‚’è¨ˆç®—ã™ã‚‹æ“ä½œã§ã™ã€‚ææ–™ç§‘å­¦ã§ã¯ç†±é‡è¨ˆç®—ã€ãƒ—ãƒ­ã‚»ã‚¹å·¥å­¦ã§ã¯åå¿œç‰©ã®ç·é‡ã€
                æ©Ÿæ¢°å­¦ç¿’ã§ã¯ç¢ºç‡åˆ†å¸ƒã®æ­£è¦åŒ–å®šæ•°ãªã©ã«ä½¿ã‚ã‚Œã¾ã™ã€‚
            </p>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹1: ãƒªãƒ¼ãƒãƒ³å’Œã«ã‚ˆã‚‹å®šç©åˆ†ã®è¿‘ä¼¼</h3>
            <div class="code-block"><code>import numpy as np
import matplotlib.pyplot as plt

def f(x):
    """è¢«ç©åˆ†é–¢æ•°: f(x) = x^2"""
    return x**2

# ãƒªãƒ¼ãƒãƒ³å’Œã«ã‚ˆã‚‹ç©åˆ†ã®è¿‘ä¼¼
def riemann_sum(f, a, b, n, method='midpoint'):
    """
    method: 'left' (å·¦ç«¯), 'right' (å³ç«¯), 'midpoint' (ä¸­ç‚¹)
    """
    dx = (b - a) / n
    x = np.linspace(a, b, n+1)

    if method == 'left':
        x_sample = x[:-1]
    elif method == 'right':
        x_sample = x[1:]
    else:  # midpoint
        x_sample = (x[:-1] + x[1:]) / 2

    return np.sum(f(x_sample) * dx)

# âˆ«â‚€Â¹ xÂ² dx = 1/3 ã‚’è¨ˆç®—
a, b = 0, 1
exact_value = 1/3

n_values = [4, 10, 50, 100, 500]
print("ãƒªãƒ¼ãƒãƒ³å’Œã«ã‚ˆã‚‹ç©åˆ†è¿‘ä¼¼:")
print(f"è§£æè§£: âˆ«â‚€Â¹ xÂ² dx = {exact_value:.10f}\n")

for n in n_values:
    approx = riemann_sum(f, a, b, n, 'midpoint')
    error = abs(approx - exact_value)
    print(f"n={n:3d}: è¿‘ä¼¼å€¤ = {approx:.10f}, èª¤å·® = {error:.2e}")

# å¯è¦–åŒ–: n=10 ã®å ´åˆã®ä¸­ç‚¹ãƒªãƒ¼ãƒãƒ³å’Œ
n = 10
x = np.linspace(a, b, 1000)
dx = (b - a) / n
x_rect = np.linspace(a, b, n+1)
x_mid = (x_rect[:-1] + x_rect[1:]) / 2

fig, ax = plt.subplots(figsize=(10, 6))
ax.plot(x, f(x), 'b-', linewidth=2, label='f(x) = xÂ²')
ax.fill_between(x, 0, f(x), alpha=0.2)

# é•·æ–¹å½¢ã‚’æç”»
for i in range(n):
    height = f(x_mid[i])
    rect = plt.Rectangle((x_rect[i], 0), dx, height,
                         edgecolor='red', facecolor='none', linewidth=1.5)
    ax.add_patch(rect)
    ax.plot([x_mid[i]], [height], 'ro', markersize=6)

ax.set_xlabel('x', fontsize=12)
ax.set_ylabel('f(x)', fontsize=12)
ax.set_title(f'ä¸­ç‚¹ãƒªãƒ¼ãƒãƒ³å’Œ (n={n})', fontsize=14)
ax.legend()
ax.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()</code></div>

            <div class="theorem">
                <strong>ğŸ“ å®šç†: å¾®ç©åˆ†ã®åŸºæœ¬å®šç†</strong><br>
                f(x) ãŒé€£ç¶šé–¢æ•°ã§ F(x) ãŒ f(x) ã®åŸå§‹é–¢æ•°ï¼ˆä¸å®šç©åˆ†ï¼‰ã®ã¨ãï¼š
                $$\int_a^b f(x) dx = F(b) - F(a)$$
                ã“ã®å®šç†ã«ã‚ˆã‚Šã€å¾®åˆ†ã¨ç©åˆ†ãŒäº’ã„ã«é€†æ“ä½œã§ã‚ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹2: SymPyã«ã‚ˆã‚‹è¨˜å·ç©åˆ†</h3>
            <div class="code-block"><code>import sympy as sp

x = sp.Symbol('x')

# ä¸å®šç©åˆ†ï¼ˆåŸå§‹é–¢æ•°ï¼‰
functions = [
    x**2,
    sp.exp(x),
    sp.sin(x),
    1/x,
    x * sp.exp(x)
]

print("ä¸å®šç©åˆ†ã®ä¾‹:")
for func in functions:
    integral = sp.integrate(func, x)
    print(f"âˆ« {func} dx = {integral} + C")

print("\nå®šç©åˆ†ã®ä¾‹:")
# âˆ«â‚€Â¹ xÂ² dx
result = sp.integrate(x**2, (x, 0, 1))
print(f"âˆ«â‚€Â¹ xÂ² dx = {result}")

# âˆ«â‚€^Ï€ sin(x) dx
result = sp.integrate(sp.sin(x), (x, 0, sp.pi))
print(f"âˆ«â‚€^Ï€ sin(x) dx = {result}")</code></div>

            <h2>2.2 å°å½¢å‰‡ã«ã‚ˆã‚‹æ•°å€¤ç©åˆ†</h2>

            <p>
                å°å½¢å‰‡ã¯ã€æ›²ç·šã‚’ç›´ç·šã§è¿‘ä¼¼ã—ã¦é¢ç©ã‚’è¨ˆç®—ã™ã‚‹æœ€ã‚‚åŸºæœ¬çš„ãªæ•°å€¤ç©åˆ†æ³•ã§ã™ã€‚
            </p>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹3: å°å½¢å‰‡ã®å®Ÿè£…</h3>
            <div class="code-block"><code>def trapezoidal_rule(f, a, b, n):
    """
    å°å½¢å‰‡ã«ã‚ˆã‚‹æ•°å€¤ç©åˆ†
    ç²¾åº¦: O(hÂ²) where h = (b-a)/n
    """
    x = np.linspace(a, b, n+1)
    y = f(x)
    h = (b - a) / n

    # å°å½¢å‰‡ã®å…¬å¼: h * [f(a)/2 + f(xâ‚) + ... + f(xâ‚™â‚‹â‚) + f(b)/2]
    integral = h * (y[0]/2 + np.sum(y[1:-1]) + y[-1]/2)
    return integral

# ãƒ†ã‚¹ãƒˆ: âˆ«â‚€^Ï€ sin(x) dx = 2
f = np.sin
a, b = 0, np.pi
exact = 2.0

print("å°å½¢å‰‡ã«ã‚ˆã‚‹ç©åˆ†:")
print(f"è§£æè§£: âˆ«â‚€^Ï€ sin(x) dx = {exact}\n")

for n in [10, 50, 100, 500]:
    approx = trapezoidal_rule(f, a, b, n)
    error = abs(approx - exact)
    print(f"n={n:3d}: è¿‘ä¼¼å€¤ = {approx:.10f}, èª¤å·® = {error:.2e}")

# åæŸæ€§ã®ç¢ºèª
n_values = np.array([10, 20, 50, 100, 200, 500, 1000])
errors = []
for n in n_values:
    approx = trapezoidal_rule(f, a, b, n)
    errors.append(abs(approx - exact))

plt.figure(figsize=(8, 6))
plt.loglog(n_values, errors, 'o-', linewidth=2, markersize=8, label='å°å½¢å‰‡ã®èª¤å·®')
plt.loglog(n_values, 1/n_values**2, '--', label='O(1/nÂ²)', alpha=0.5)
plt.xlabel('åˆ†å‰²æ•° n', fontsize=12)
plt.ylabel('çµ¶å¯¾èª¤å·®', fontsize=12)
plt.title('å°å½¢å‰‡ã®åæŸæ€§', fontsize=14)
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()</code></div>

            <h2>2.3 Simpsonå‰‡ã«ã‚ˆã‚‹é«˜ç²¾åº¦ç©åˆ†</h2>

            <p>
                Simpsonå‰‡ã¯ã€æ›²ç·šã‚’2æ¬¡é–¢æ•°ï¼ˆæ”¾ç‰©ç·šï¼‰ã§è¿‘ä¼¼ã™ã‚‹æ–¹æ³•ã§ã€å°å½¢å‰‡ã‚ˆã‚Šã‚‚é«˜ç²¾åº¦ã§ã™ã€‚
            </p>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹4: Simpsonå‰‡ã®å®Ÿè£…</h3>
            <div class="code-block"><code>def simpson_rule(f, a, b, n):
    """
    Simpsonå‰‡ã«ã‚ˆã‚‹æ•°å€¤ç©åˆ†
    n ã¯å¶æ•°ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹
    ç²¾åº¦: O(hâ´) where h = (b-a)/n
    """
    if n % 2 != 0:
        raise ValueError("n must be even for Simpson's rule")

    x = np.linspace(a, b, n+1)
    y = f(x)
    h = (b - a) / n

    # Simpsonå‰‡ã®å…¬å¼
    integral = h/3 * (y[0] + 4*np.sum(y[1:-1:2]) + 2*np.sum(y[2:-1:2]) + y[-1])
    return integral

# å°å½¢å‰‡ã¨Simpsonå‰‡ã®æ¯”è¼ƒ
print("å°å½¢å‰‡ vs Simpsonå‰‡:")
print(f"è§£æè§£: âˆ«â‚€^Ï€ sin(x) dx = {exact}\n")

n = 100
trap_result = trapezoidal_rule(f, a, b, n)
simp_result = simpson_rule(f, a, b, n)

print(f"n={n}:")
print(f"å°å½¢å‰‡:    {trap_result:.10f}, èª¤å·® = {abs(trap_result - exact):.2e}")
print(f"Simpsonå‰‡: {simp_result:.10f}, èª¤å·® = {abs(simp_result - exact):.2e}")

# ç²¾åº¦æ¯”è¼ƒã®å¯è¦–åŒ–
n_values = np.array([10, 20, 50, 100, 200, 500])
errors_trap = []
errors_simp = []

for n in n_values:
    errors_trap.append(abs(trapezoidal_rule(f, a, b, n) - exact))
    errors_simp.append(abs(simpson_rule(f, a, b, n if n%2==0 else n+1) - exact))

plt.figure(figsize=(10, 6))
plt.loglog(n_values, errors_trap, 'o-', linewidth=2, markersize=8, label='å°å½¢å‰‡')
plt.loglog(n_values, errors_simp, 's-', linewidth=2, markersize=8, label='Simpsonå‰‡')
plt.loglog(n_values, 1/n_values**2, '--', label='O(1/nÂ²)', alpha=0.5)
plt.loglog(n_values, 1/n_values**4, '--', label='O(1/nâ´)', alpha=0.5)
plt.xlabel('åˆ†å‰²æ•° n', fontsize=12)
plt.ylabel('çµ¶å¯¾èª¤å·®', fontsize=12)
plt.title('æ•°å€¤ç©åˆ†æ³•ã®ç²¾åº¦æ¯”è¼ƒ', fontsize=14)
plt.legend()
plt.grid(True, alpha=0.3)
plt.show()</code></div>

            <h2>2.4 SciPyã«ã‚ˆã‚‹é«˜åº¦ãªæ•°å€¤ç©åˆ†</h2>

            <p>
                SciPyãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€é©å¿œçš„åˆ»ã¿å¹…èª¿æ•´ã‚„é«˜æ¬¡ã®æ±‚ç©æ³•ã‚’å®Ÿè£…ã—ãŸé«˜æ€§èƒ½ãªç©åˆ†é–¢æ•°ã‚’æä¾›ã—ã¾ã™ã€‚
            </p>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹5: SciPyã®æ•°å€¤ç©åˆ†é–¢æ•°</h3>
            <div class="code-block"><code>from scipy import integrate

# æ§˜ã€…ãªç©åˆ†æ³•ã®æ¯”è¼ƒ
def test_function(x):
    """æŒ¯å‹•ã®æ¿€ã—ã„é–¢æ•°"""
    return np.sin(x) * np.exp(-x/10)

a, b = 0, 20
exact_value = integrate.quad(test_function, a, b, limit=1000)[0]  # é«˜ç²¾åº¦å‚ç…§å€¤

print("SciPyã®æ•°å€¤ç©åˆ†:")
print(f"å‚ç…§å€¤ (quad): {exact_value:.10f}\n")

# quad: é©å¿œçš„Gauss-Kronrodæ±‚ç©æ³•
result, error = integrate.quad(test_function, a, b)
print(f"quad (é©å¿œçš„):        {result:.10f}, æ¨å®šèª¤å·® = {error:.2e}")

# fixed_quad: å›ºå®šæ¬¡æ•°Gauss-Legendreæ±‚ç©æ³•
result, _ = integrate.fixed_quad(test_function, a, b, n=50)
print(f"fixed_quad (n=50):    {result:.10f}, èª¤å·® = {abs(result-exact_value):.2e}")

# romberg: Rombergç©åˆ†ï¼ˆRichardsonå¤–æŒ¿ã®æ‹¡å¼µï¼‰
result = integrate.romberg(test_function, a, b, show=False)
print(f"romberg:              {result:.10f}, èª¤å·® = {abs(result-exact_value):.2e}")

# å¯è¦–åŒ–
x = np.linspace(a, b, 1000)
y = test_function(x)

plt.figure(figsize=(10, 6))
plt.plot(x, y, linewidth=2)
plt.fill_between(x, 0, y, alpha=0.3)
plt.xlabel('x', fontsize=12)
plt.ylabel('f(x)', fontsize=12)
plt.title('è¢«ç©åˆ†é–¢æ•°: f(x) = sin(x)Â·exp(-x/10)', fontsize=14)
plt.grid(True, alpha=0.3)
plt.axhline(y=0, color='k', linewidth=0.5)
plt.show()</code></div>

            <h2>2.5 ææ–™ç§‘å­¦ã¸ã®å¿œç”¨: ç†±å®¹é‡ã®è¨ˆç®—</h2>

            <div class="example">
                <strong>ğŸ”¬ å¿œç”¨ä¾‹:</strong> æ¸©åº¦ Tâ‚ ã‹ã‚‰ Tâ‚‚ ã¾ã§ç‰©è³ªã‚’åŠ ç†±ã™ã‚‹ã®ã«å¿…è¦ãªç†±é‡ Q ã¯ã€
                ç†±å®¹é‡ C_p(T) ã‚’æ¸©åº¦ã§ç©åˆ†ã—ã¦æ±‚ã‚ã‚‰ã‚Œã¾ã™ï¼š
                $$Q = \int_{T_1}^{T_2} C_p(T) dT$$
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹6: ç†±é‡è¨ˆç®—</h3>
            <div class="code-block"><code># éŠ…ã®ç†±å®¹é‡ã®æ¸©åº¦ä¾å­˜æ€§ï¼ˆå®Ÿé¨“å¼ï¼‰
def copper_heat_capacity(T):
    """
    éŠ…ã®å®šåœ§ç†±å®¹é‡ Cp [J/(molÂ·K)]
    T: æ¸©åº¦ [K]
    """
    # Shomate equation (ç°¡ç•¥ç‰ˆ)
    A, B, C = 22.64, 6.28e-3, 0
    return A + B*T + C*T**2

# 300K ã‹ã‚‰ 600K ã¾ã§åŠ ç†±ã™ã‚‹ã®ã«å¿…è¦ãªç†±é‡
T1, T2 = 300, 600

# æ•°å€¤ç©åˆ†
Q_numerical, error = integrate.quad(copper_heat_capacity, T1, T2)

# è§£æç©åˆ†ï¼ˆæ¤œè¨¼ç”¨ï¼‰
def Q_analytical(T1, T2):
    A, B = 22.64, 6.28e-3
    return A*(T2-T1) + B/2*(T2**2-T1**2)

Q_exact = Q_analytical(T1, T2)

print(f"éŠ… 1 mol ã‚’ {T1}K â†’ {T2}K ã«åŠ ç†±ã™ã‚‹ç†±é‡:")
print(f"æ•°å€¤ç©åˆ†: Q = {Q_numerical:.2f} J/mol (æ¨å®šèª¤å·®: {error:.2e})")
print(f"è§£æè§£:   Q = {Q_exact:.2f} J/mol")
print(f"å·®:       {abs(Q_numerical - Q_exact):.2e} J/mol")

# Cp(T) ã®å¯è¦–åŒ–
T = np.linspace(200, 800, 100)
Cp = copper_heat_capacity(T)

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³: ç†±å®¹é‡ã®æ¸©åº¦ä¾å­˜æ€§
ax1.plot(T, Cp, linewidth=2)
ax1.axvspan(T1, T2, alpha=0.2, color='orange', label='ç©åˆ†åŒºé–“')
ax1.set_xlabel('æ¸©åº¦ T (K)', fontsize=12)
ax1.set_ylabel('ç†±å®¹é‡ Cp (J/(molÂ·K))', fontsize=12)
ax1.set_title('éŠ…ã®ç†±å®¹é‡', fontsize=14)
ax1.legend()
ax1.grid(True, alpha=0.3)

# å³å›³: ç†±é‡ã®ç´¯ç©
T_range = np.linspace(300, 800, 100)
Q_cumulative = [integrate.quad(copper_heat_capacity, 300, T)[0] for T in T_range]

ax2.plot(T_range, Q_cumulative, linewidth=2)
ax2.axhline(y=Q_numerical, color='red', linestyle='--', label=f'Q(300â†’600K) = {Q_numerical:.0f} J/mol')
ax2.set_xlabel('æ¸©åº¦ T (K)', fontsize=12)
ax2.set_ylabel('ç´¯ç©ç†±é‡ (J/mol)', fontsize=12)
ax2.set_title('300Kã‹ã‚‰ã®ç´¯ç©åŠ ç†±é‡', fontsize=14)
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()</code></div>

            <h2>2.6 åºƒç¾©ç©åˆ†ã¨ç‰¹ç•°ç‚¹ã®æ‰±ã„</h2>

            <div class="note">
                <strong>ğŸ“ æ³¨æ„:</strong> è¢«ç©åˆ†é–¢æ•°ãŒç„¡é™å¤§ã«ç™ºæ•£ã™ã‚‹ç‚¹ï¼ˆç‰¹ç•°ç‚¹ï¼‰ã‚„ã€
                ç©åˆ†åŒºé–“ãŒç„¡é™å¤§ã®å ´åˆï¼ˆåºƒç¾©ç©åˆ†ï¼‰ã¯ã€ç‰¹åˆ¥ãªæ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
            </div>

            <h3>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹7: åºƒç¾©ç©åˆ†ã®è¨ˆç®—</h3>
            <div class="code-block"><code># ä¾‹1: ç©åˆ†åŒºé–“ãŒç„¡é™å¤§
def integrand1(x):
    return np.exp(-x**2)

# âˆ«â‚€^âˆ exp(-xÂ²) dx = âˆšÏ€/2
result, error = integrate.quad(integrand1, 0, np.inf)
exact = np.sqrt(np.pi) / 2
print("åºƒç¾©ç©åˆ†ã®ä¾‹:")
print(f"âˆ«â‚€^âˆ exp(-xÂ²) dx = {result:.10f} (è§£æè§£: {exact:.10f})")
print(f"æ¨å®šèª¤å·®: {error:.2e}, å®Ÿèª¤å·®: {abs(result-exact):.2e}\n")

# ä¾‹2: ç‰¹ç•°ç‚¹ãŒã‚ã‚‹å ´åˆ
def integrand2(x):
    """x=0 ã§ç‰¹ç•°ç‚¹ã‚’æŒã¤"""
    return 1/np.sqrt(x)

# âˆ«â‚€Â¹ 1/âˆšx dx = 2
result, error = integrate.quad(integrand2, 0, 1)
exact = 2.0
print(f"âˆ«â‚€Â¹ 1/âˆšx dx = {result:.10f} (è§£æè§£: {exact:.10f})")
print(f"æ¨å®šèª¤å·®: {error:.2e}, å®Ÿèª¤å·®: {abs(result-exact):.2e}")

# ç‰¹ç•°ç‚¹ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š
result2, error2 = integrate.quad(integrand2, 0, 1, points=[0])
print(f"ç‰¹ç•°ç‚¹æŒ‡å®š: {result2:.10f}, èª¤å·®: {abs(result2-exact):.2e}")</code></div>

            <h2>2.7 ç·´ç¿’å•é¡Œ</h2>

            <div class="exercise">
                <strong>âœï¸ æ¼”ç¿’1:</strong>
                âˆ«â‚€Â² (xÂ³ - 2xÂ² + x) dx ã‚’ (1) è§£æçš„ã«ã€(2) å°å½¢å‰‡ (n=100) ã§ã€
                (3) Simpsonå‰‡ (n=100) ã§æ±‚ã‚ã‚ˆã€‚
            </div>

            <div class="exercise">
                <strong>âœï¸ æ¼”ç¿’2:</strong>
                åå¿œé€Ÿåº¦ãŒ r(t) = 0.5 exp(-0.1t) [mol/L/s] ã§ä¸ãˆã‚‰ã‚Œã‚‹ã€‚
                0 â‰¤ t â‰¤ 20 ç§’ã«ãŠã‘ã‚‹ç·åå¿œé‡ã‚’æ•°å€¤ç©åˆ†ã§æ±‚ã‚ã‚ˆã€‚
            </div>

            <h2>ã¾ã¨ã‚</h2>
            <ul>
                <li>å®šç©åˆ†ã¯æ›²ç·šã¨è»¸ã§å›²ã¾ã‚ŒãŸé¢ç©ã‚’è¡¨ã—ã€ç´¯ç©é‡ã®è¨ˆç®—ã«ä½¿ã‚ã‚Œã‚‹</li>
                <li>å°å½¢å‰‡ã¯ O(hÂ²)ã€Simpsonå‰‡ã¯ O(hâ´) ã®ç²¾åº¦ã‚’æŒã¤åŸºæœ¬çš„ãªæ•°å€¤ç©åˆ†æ³•</li>
                <li>SciPyã® quad é–¢æ•°ã¯é©å¿œçš„åˆ»ã¿å¹…èª¿æ•´ã«ã‚ˆã‚Šé«˜ç²¾åº¦ãªç©åˆ†ã‚’å®Ÿç¾</li>
                <li>ææ–™ç§‘å­¦ã§ã¯ç†±é‡è¨ˆç®—ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«è§£æãªã©æ§˜ã€…ãªå ´é¢ã§ç©åˆ†ãŒæ´»ç”¨ã•ã‚Œã‚‹</li>
                <li>åºƒç¾©ç©åˆ†ã‚„ç‰¹ç•°ç‚¹ã‚’å«ã‚€ç©åˆ†ã‚‚ã€é©åˆ‡ãªæ‰‹æ³•ã§æ•°å€¤è¨ˆç®—å¯èƒ½</li>
            </ul>

            <div class="nav-buttons">
                <a href="chapter-1.html" class="nav-button">â† ç¬¬1ç« : å¾®åˆ†ã®åŸºç¤</a>
                <a href="chapter-3.html" class="nav-button">ç¬¬3ç« : å¤šå¤‰æ•°é–¢æ•°ã®å¾®ç©åˆ† â†’</a>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - åŸºç¤æ•°ç†é“å ´</p>
    </footer>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>
