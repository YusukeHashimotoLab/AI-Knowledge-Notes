<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
<meta content="ç¬¬2ç« : ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã¨åˆ†é…é–¢æ•° | åŸºç¤æ•°ç†é“å ´ - å¤å…¸çµ±è¨ˆåŠ›å­¦å…¥é–€" name="description"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« : ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã¨åˆ†é…é–¢æ•° | åŸºç¤æ•°ç†é“å ´ - å¤å…¸çµ±è¨ˆåŠ›å­¦å…¥é–€</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; line-height: 1.8; color: #333; background: #f5f5f5; }
        header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1.5rem; text-align: center; }
        h1 { font-size: 1.8rem; margin-bottom: 0.5rem; }
        .subtitle { opacity: 0.9; }
        .container { max-width: 900px; margin: 2rem auto; padding: 0 1rem; }
        .breadcrumb { margin-bottom: 1.5rem; font-size: 0.9rem; }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .content { background: white; padding: 2.5rem; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-bottom: 2rem; }
        h2 { color: #667eea; margin: 2rem 0 1rem 0; padding-bottom: 0.5rem; border-bottom: 2px solid #e0e0e0; }
        h3 { color: #764ba2; margin: 1.5rem 0 0.8rem 0; }
        .definition { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theorem { background: #f3e5f5; border-left: 4px solid #764ba2; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 0 0 8px 8px;
            overflow-x: auto;
            margin: 0 0 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-block code {
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .code-container {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            white-space: pre-wrap;
        }
        .output { background: #f8f9fa; border: 1px solid #dee2e6; padding: 1rem; border-radius: 6px; margin: 1rem 0; font-family: monospace; font-size: 0.9rem; }
        table { width: 100%; border-collapse: collapse; margin: 1.5rem 0; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid #ddd; }
        th { background: #667eea; color: white; }
        .note { background: #fff3cd; border-left: 4px solid #ffc107; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .exercise-box { background: #d4edda; border-left: 4px solid #28a745; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .theory-box { background: #e7f3ff; border-left: 4px solid #667eea; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .example-box { background: #fff3e0; border-left: 4px solid #ff9800; padding: 1rem 1.5rem; margin: 1.5rem 0; border-radius: 4px; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .nav-button { padding: 0.8rem 1.5rem; background: #667eea; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .nav-button:hover { background: #764ba2; }
        .navigation-buttons { display: flex; justify-content: space-between; margin: 2rem 0; }
        .btn { padding: 0.8rem 1.5rem; color: white; text-decoration: none; border-radius: 6px; font-weight: 600; }
        .btn-primary { background: #667eea; }
        .btn-primary:hover { background: #764ba2; }
        .btn-secondary { background: #6c757d; }
        .btn-secondary:hover { background: #5a6268; }
        footer { background: #2c3e50; color: white; text-align: center; padding: 2rem 1rem; margin-top: 3rem; }
        @media (max-width: 768px) { .content { padding: 1.5rem; } h1 { font-size: 1.5rem; } }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/FM/classical-statistical-mechanics/chapter-2.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
        <h1>ç¬¬2ç« : ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã¨åˆ†é…é–¢æ•°</h1>
    </header>

    <div class="container">
        <div class="breadcrumb">
            <a href="../index.html">åŸºç¤æ•°ç†é“å ´</a> &gt;
            <a href="index.html">å¤å…¸çµ±è¨ˆåŠ›å­¦å…¥é–€</a> &gt;
            ç¬¬2ç« 
        </div>

        <div class="content">
            <h2>ğŸ¯ å­¦ç¿’ç›®æ¨™</h2>
            <ul>
                <li>ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã®æ¦‚å¿µã¨é©ç”¨ç¯„å›²ã‚’ç†è§£ã™ã‚‹</li>
                <li>æ­£æº–åˆ†é…é–¢æ•°ã‹ã‚‰ç†±åŠ›å­¦é‡ã‚’å°å‡ºã™ã‚‹æ–¹æ³•ã‚’ç¿’å¾—ã™ã‚‹</li>
                <li>Helmholtzè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®æ„å‘³ã¨é‡è¦æ€§ã‚’å­¦ã¶</li>
                <li>ç­‰åˆ†é…å®šç†ã‚’ç†è§£ã—ã€ç†æƒ³æ°—ä½“ã¸ã®å¿œç”¨ã‚’å­¦ã¶</li>
                <li>èª¿å’ŒæŒ¯å‹•å­ç³»ã®ç†±åŠ›å­¦ã‚’å®Œå…¨ã«è§£ã</li>
                <li>2æº–ä½ç³»ã¨Schottkyæ¯”ç†±ã‚’ç†è§£ã™ã‚‹</li>
                <li>Einsteinå›ºä½“ãƒ¢ãƒ‡ãƒ«ã§æ ¼å­æŒ¯å‹•ã‚’è¨˜è¿°ã™ã‚‹</li>
                <li>Debyeãƒ¢ãƒ‡ãƒ«ã§ä½æ¸©æ¯”ç†±ã® \(T^3\) å‰‡ã‚’å°å‡ºã™ã‚‹</li>
            </ul>
        </div>

        <div class="content">
            <h2>ğŸ“– ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã¨ã¯</h2>
            
            <div class="definition">
                <h3>ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ï¼ˆCanonical Ensembleï¼‰</h3>
                <p>æ¸©åº¦ \(T\) ã®ç†±æµ´ã¨æ¥è§¦ã—ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’äº¤æ›ã§ãã‚‹ç³»ã€‚</p>
                <ul>
                    <li>ç²’å­æ•° \(N\)ã€ä½“ç© \(V\)ã€æ¸©åº¦ \(T\) ãŒå›ºå®š</li>
                    <li>ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(E\) ã¯æºã‚‰ã</li>
                    <li>å®Ÿé¨“å®¤ã§ã®æ¨™æº–çš„ãªçŠ¶æ³ã«å¯¾å¿œ</li>
                </ul>
                <p><strong>æ­£æº–åˆ†é…é–¢æ•°ï¼ˆCanonical partition functionï¼‰</strong>:</p>
                <p>\[
                Z(N, V, T) = \sum_i e^{-\beta E_i}, \quad \beta = \frac{1}{k_B T}
                \]</p>
                <p>å¤å…¸ç³»ã§ã¯ç©åˆ†å½¢å¼ï¼š</p>
                <p>\[
                Z = \frac{1}{h^{3N} N!} \int e^{-\beta H(\mathbf{q}, \mathbf{p})} d^{3N}\mathbf{q} \, d^{3N}\mathbf{p}
                \]</p>
            </div>

            <div class="definition">
                <h3>Helmholtzè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼</h3>
                <p>åˆ†é…é–¢æ•°ã‹ã‚‰ç†±åŠ›å­¦ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚’å°å‡ºï¼š</p>
                <p>\[
                F = -k_B T \ln Z
                \]</p>
                <p>\(F\) ã¯Helmholtzè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã€\(F = U - TS\) ã®é–¢ä¿‚ãŒã‚ã‚Šã¾ã™ã€‚</p>
                <p>ç†±åŠ›å­¦é‡ã®å°å‡ºï¼š</p>
                <ul>
                    <li>å†…éƒ¨ã‚¨ãƒãƒ«ã‚®ãƒ¼: \(U = -\frac{\partial \ln Z}{\partial \beta}\)</li>
                    <li>ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: \(S = -\frac{\partial F}{\partial T} = k_B(\ln Z + \beta U)\)</li>
                    <li>åœ§åŠ›: \(P = -\frac{\partial F}{\partial V}\)</li>
                    <li>ç†±å®¹é‡: \(C_V = \frac{\partial U}{\partial T}\)</li>
                </ul>
            </div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ2.1: 1æ¬¡å…ƒèª¿å’ŒæŒ¯å‹•å­ã®åˆ†é…é–¢æ•°</h2>
            
            <div class="definition">
                <h3>é‡å­èª¿å’ŒæŒ¯å‹•å­</h3>
                <p>ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½: \(E_n = \hbar\omega(n + \frac{1}{2})\), \(n = 0, 1, 2, \ldots\)</p>
                <p>åˆ†é…é–¢æ•°:</p>
                <p>\[
                Z = \sum_{n=0}^\infty e^{-\beta\hbar\omega(n+1/2)} = \frac{e^{-\beta\hbar\omega/2}}{1 - e^{-\beta\hbar\omega}}
                \]</p>
                <p>å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼:</p>
                <p>\[
                \langle E \rangle = \hbar\omega\left(\frac{1}{2} + \frac{1}{e^{\beta\hbar\omega} - 1}\right)
                \]</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: èª¿å’ŒæŒ¯å‹•å­ã®ç†±åŠ›å­¦</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# ç‰©ç†å®šæ•°
k_B = 1.380649e-23  # J/K
hbar = 1.054572e-34  # JÂ·s

# èª¿å’ŒæŒ¯å‹•å­ã®åˆ†é…é–¢æ•°
omega = 2e13  # è§’æŒ¯å‹•æ•° (rad/s) - å…¸å‹çš„ãªæ ¼å­æŒ¯å‹•

def partition_function_harmonic(omega, T, hbar, k_B):
    """é‡å­èª¿å’ŒæŒ¯å‹•å­ã®åˆ†é…é–¢æ•°"""
    beta = 1 / (k_B * T)
    x = beta * hbar * omega
    return np.exp(-x/2) / (1 - np.exp(-x))

def average_energy(omega, T, hbar, k_B):
    """å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼"""
    beta = 1 / (k_B * T)
    x = beta * hbar * omega
    return hbar * omega * (0.5 + 1/(np.exp(x) - 1))

def heat_capacity(omega, T, hbar, k_B):
    """ç†±å®¹é‡ C = dE/dT"""
    beta = 1 / (k_B * T)
    x = beta * hbar * omega
    exp_x = np.exp(x)
    return k_B * x**2 * exp_x / (exp_x - 1)**2

# æ¸©åº¦ç¯„å›²
T_range = np.logspace(0, 3, 200)  # 1 K ~ 1000 K

# å„é‡ã‚’è¨ˆç®—
Z_vals = [partition_function_harmonic(omega, T, hbar, k_B) for T in T_range]
E_vals = [average_energy(omega, T, hbar, k_B) for T in T_range]
C_vals = [heat_capacity(omega, T, hbar, k_B) for T in T_range]

# ç‰¹æ€§æ¸©åº¦
theta = hbar * omega / k_B
print(f"=== èª¿å’ŒæŒ¯å‹•å­ã®ç†±åŠ›å­¦ ===")
print(f"è§’æŒ¯å‹•æ•° Ï‰ = {omega:.2e} rad/s")
print(f"ç‰¹æ€§æ¸©åº¦ Î¸ = â„Ï‰/k_B = {theta:.2f} K\n")

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 3, figsize=(16, 5))

# åˆ†é…é–¢æ•°
ax1 = axes[0]
ax1.loglog(T_range, Z_vals, 'b-', linewidth=2)
ax1.axvline(theta, color='r', linestyle='--', linewidth=1.5, label=f'Î¸ = {theta:.1f} K')
ax1.set_xlabel('Temperature (K)')
ax1.set_ylabel('Partition function Z')
ax1.set_title('åˆ†é…é–¢æ•°')
ax1.legend()
ax1.grid(True, alpha=0.3, which='both')

# å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼
ax2 = axes[1]
E_0 = hbar * omega / 2  # é›¶ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼
ax2.semilogx(T_range, np.array(E_vals) / (hbar * omega), 'g-', linewidth=2)
ax2.axhline(0.5, color='k', linestyle=':', linewidth=1, label='é›¶ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼')
ax2.axvline(theta, color='r', linestyle='--', linewidth=1.5, label=f'Î¸ = {theta:.1f} K')
ax2.set_xlabel('Temperature (K)')
ax2.set_ylabel('Average energy / â„Ï‰')
ax2.set_title('å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼')
ax2.legend()
ax2.grid(True, alpha=0.3)

# ç†±å®¹é‡
ax3 = axes[2]
ax3.semilogx(T_range, np.array(C_vals) / k_B, 'r-', linewidth=2)
ax3.axhline(1.0, color='k', linestyle=':', linewidth=1, label='å¤å…¸æ¥µé™')
ax3.axvline(theta, color='r', linestyle='--', linewidth=1.5, label=f'Î¸ = {theta:.1f} K')
ax3.set_xlabel('Temperature (K)')
ax3.set_ylabel('Heat capacity / k_B')
ax3.set_title('ç†±å®¹é‡')
ax3.legend()
ax3.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_harmonic_oscillator.png', dpi=300, bbox_inches='tight')
plt.show()

# ä½æ¸©ãƒ»é«˜æ¸©æ¥µé™
print("ä½æ¸©æ¥µé™ (T << Î¸):")
T_low = theta / 10
E_low = average_energy(omega, T_low, hbar, k_B)
C_low = heat_capacity(omega, T_low, hbar, k_B)
print(f"  T = {T_low:.2f} K")
print(f"  <E> â‰ˆ {E_low/(hbar*omega):.4f} â„Ï‰ (â‰ˆ é›¶ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼)")
print(f"  C â‰ˆ {C_low/k_B:.6f} k_B (æŒ‡æ•°çš„ã«æ¸›è¡°)\n")

print("é«˜æ¸©æ¥µé™ (T >> Î¸):")
T_high = theta * 10
E_high = average_energy(omega, T_high, hbar, k_B)
C_high = heat_capacity(omega, T_high, hbar, k_B)
print(f"  T = {T_high:.2f} K")
print(f"  <E> â‰ˆ {E_high/(k_B*T_high):.4f} k_B T (å¤å…¸çš„)")
print(f"  C â‰ˆ {C_high/k_B:.4f} k_B (ç­‰åˆ†é…å®šç†)")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ2.2: ç­‰åˆ†é…å®šç†</h2>
            
            <div class="definition">
                <h3>ç­‰åˆ†é…å®šç†ï¼ˆEquipartition Theoremï¼‰</h3>
                <p>é«˜æ¸©æ¥µé™ï¼ˆå¤å…¸çš„ï¼‰ã§ã¯ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«2æ¬¡ã§å¯„ä¸ã™ã‚‹å„è‡ªç”±åº¦ã¯å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(\frac{1}{2}k_B T\) ã‚’æŒã¡ã¾ã™ã€‚</p>
                <p>ä¾‹:</p>
                <ul>
                    <li>1æ¬¡å…ƒä¸¦é€²é‹å‹•: \(\langle \frac{p^2}{2m} \rangle = \frac{1}{2}k_B T\)</li>
                    <li>èª¿å’ŒæŒ¯å‹•: \(\langle \frac{p^2}{2m} + \frac{1}{2}kq^2 \rangle = k_B T\)ï¼ˆ2ã¤ã®2æ¬¡é …ï¼‰</li>
                    <li>ç†æƒ³æ°—ä½“ï¼ˆ3æ¬¡å…ƒï¼‰: \(\langle E \rangle = \frac{3}{2}k_B T\)</li>
                </ul>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: ç­‰åˆ†é…å®šç†ã®æ¤œè¨¼ï¼ˆãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æ³•ï¼‰</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æ³•ã§ç­‰åˆ†é…å®šç†ã‚’æ¤œè¨¼
k_B = 1.380649e-23  # J/K
m = 4.65e-26  # Nâ‚‚åˆ†å­ã®è³ªé‡ (kg)

def monte_carlo_classical_gas(N_particles, T, k_B, m, n_steps=100000):
    """å¤å…¸ç†æƒ³æ°—ä½“ã®ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"""
    # é€Ÿåº¦ã®åˆæœŸåŒ–ï¼ˆMaxwellåˆ†å¸ƒã‹ã‚‰ï¼‰
    sigma_v = np.sqrt(k_B * T / m)
    v = np.random.normal(0, sigma_v, (N_particles, 3))
    
    # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
    kinetic_energies = []
    
    for step in range(n_steps):
        # é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼
        KE = 0.5 * m * np.sum(v**2, axis=1)
        kinetic_energies.append(np.mean(KE))
        
        # Metropolisã‚¹ãƒ†ãƒƒãƒ—ï¼ˆé€Ÿåº¦ã®å¾®å°å¤‰åŒ–ï¼‰
        if step < n_steps - 1:
            dv = np.random.normal(0, 0.1 * sigma_v, (N_particles, 3))
            v_new = v + dv
            
            # ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰åŒ–
            KE_old = 0.5 * m * np.sum(v**2)
            KE_new = 0.5 * m * np.sum(v_new**2)
            delta_E = KE_new - KE_old
            
            # Metropolisåˆ¤å®š
            if delta_E < 0 or np.random.rand() < np.exp(-delta_E / (k_B * T * N_particles)):
                v = v_new
    
    return np.array(kinetic_energies)

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
N_particles = 1000
temperatures = [100, 300, 500, 800]  # K
colors = ['blue', 'green', 'orange', 'red']

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# å¹³å‡é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ vs æ¸©åº¦
ax1 = axes[0]
avg_KE_list = []
for T in temperatures:
    KE_samples = monte_carlo_classical_gas(N_particles, T, k_B, m, n_steps=50000)
    avg_KE = np.mean(KE_samples[10000:])  # å¹³è¡¡åŒ–å¾Œ
    avg_KE_list.append(avg_KE)

theoretical = [1.5 * k_B * T for T in temperatures]
ax1.plot(temperatures, avg_KE_list, 'bo-', markersize=8, linewidth=2, label='Simulation')
ax1.plot(temperatures, theoretical, 'r--', linewidth=2, label='Theory: (3/2)k_B T')
ax1.set_xlabel('Temperature (K)')
ax1.set_ylabel('Average kinetic energy (J)')
ax1.set_title('ç­‰åˆ†é…å®šç†ã®æ¤œè¨¼')
ax1.legend()
ax1.grid(True, alpha=0.3)

# æ™‚é–“ç™ºå±•
ax2 = axes[1]
T_demo = 300
KE_samples = monte_carlo_classical_gas(N_particles, T_demo, k_B, m, n_steps=10000)
ax2.plot(KE_samples, 'b-', alpha=0.7, linewidth=1)
ax2.axhline(1.5 * k_B * T_demo, color='r', linestyle='--', linewidth=2, 
            label=f'Theory: (3/2)k_B T = {1.5*k_B*T_demo:.2e} J')
ax2.set_xlabel('Monte Carlo step')
ax2.set_ylabel('Average kinetic energy (J)')
ax2.set_title(f'æ™‚é–“ç™ºå±•ï¼ˆT = {T_demo} Kï¼‰')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_equipartition.png', dpi=300, bbox_inches='tight')
plt.show()

# çµæœã®æ¯”è¼ƒ
print("=== ç­‰åˆ†é…å®šç†ã®æ¤œè¨¼ ===\n")
for T, avg_KE in zip(temperatures, avg_KE_list):
    theoretical_KE = 1.5 * k_B * T
    error = abs(avg_KE - theoretical_KE) / theoretical_KE * 100
    print(f"T = {T} K:")
    print(f"  ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: <KE> = {avg_KE:.6e} J")
    print(f"  ç†è«–å€¤: (3/2)k_B T = {theoretical_KE:.6e} J")
    print(f"  èª¤å·®: {error:.2f}%\n")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ2.3: 2æº–ä½ç³»ã¨Schottkyæ¯”ç†±</h2>
            
            <div class="definition">
                <h3>2æº–ä½ç³»</h3>
                <p>ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ãŒ2ã¤ã®ç³»: \(E_0 = 0\), \(E_1 = \varepsilon\)</p>
                <p>åˆ†é…é–¢æ•°:</p>
                <p>\[
                Z = 1 + e^{-\beta\varepsilon}
                \]</p>
                <p>å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼:</p>
                <p>\[
                \langle E \rangle = \frac{\varepsilon}{e^{\beta\varepsilon} + 1}
                \]</p>
                <p>ç†±å®¹é‡ï¼ˆSchottkyæ¯”ç†±ï¼‰:</p>
                <p>\[
                C = k_B \left(\frac{\varepsilon}{k_B T}\right)^2 \frac{e^{\varepsilon/k_B T}}{(e^{\varepsilon/k_B T} + 1)^2}
                \]</p>
                <p>ãƒ”ãƒ¼ã‚¯æ¸©åº¦: \(T \approx \varepsilon / (2k_B)\)</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: Schottkyæ¯”ç†±</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

k_B = 1.380649e-23  # J/K

def two_level_partition(epsilon, T, k_B):
    """2æº–ä½ç³»ã®åˆ†é…é–¢æ•°"""
    beta = 1 / (k_B * T)
    return 1 + np.exp(-beta * epsilon)

def two_level_energy(epsilon, T, k_B):
    """å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼"""
    beta = 1 / (k_B * T)
    return epsilon / (np.exp(beta * epsilon) + 1)

def schottky_heat_capacity(epsilon, T, k_B):
    """Schottkyæ¯”ç†±"""
    x = epsilon / (k_B * T)
    exp_x = np.exp(x)
    return k_B * x**2 * exp_x / (exp_x + 1)**2

# ã‚¨ãƒãƒ«ã‚®ãƒ¼é–“éš”
epsilon_values = [1e-21, 2e-21, 5e-21]  # J
colors = ['blue', 'green', 'red']
labels = ['Îµ = 1Ã—10â»Â²Â¹ J', 'Îµ = 2Ã—10â»Â²Â¹ J', 'Îµ = 5Ã—10â»Â²Â¹ J']

T_range = np.linspace(1, 1000, 500)

fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å æœ‰ç¢ºç‡
ax1 = axes[0, 0]
for epsilon, color, label in zip(epsilon_values, colors, labels):
    p_0 = 1 / (1 + np.exp(-epsilon / (k_B * T_range)))  # åŸºåº•çŠ¶æ…‹
    p_1 = 1 - p_0  # åŠ±èµ·çŠ¶æ…‹
    ax1.plot(T_range, p_0, '-', color=color, linewidth=2, label=f'{label} (ground)')
    ax1.plot(T_range, p_1, '--', color=color, linewidth=2, label=f'{label} (excited)')

ax1.set_xlabel('Temperature (K)')
ax1.set_ylabel('Occupation probability')
ax1.set_title('æº–ä½å æœ‰ç¢ºç‡')
ax1.legend(fontsize=8)
ax1.grid(True, alpha=0.3)

# å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼
ax2 = axes[0, 1]
for epsilon, color, label in zip(epsilon_values, colors, labels):
    E_avg = [two_level_energy(epsilon, T, k_B) for T in T_range]
    ax2.plot(T_range, np.array(E_avg) / epsilon, color=color, linewidth=2, label=label)

ax2.axhline(0.5, color='k', linestyle=':', linewidth=1, label='é«˜æ¸©æ¥µé™')
ax2.set_xlabel('Temperature (K)')
ax2.set_ylabel('Average energy / Îµ')
ax2.set_title('å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼')
ax2.legend()
ax2.grid(True, alpha=0.3)

# Schottkyæ¯”ç†±
ax3 = axes[1, 0]
for epsilon, color, label in zip(epsilon_values, colors, labels):
    C_vals = [schottky_heat_capacity(epsilon, T, k_B) for T in T_range]
    ax3.plot(T_range, np.array(C_vals) / k_B, color=color, linewidth=2, label=label)
    
    # ãƒ”ãƒ¼ã‚¯ä½ç½®
    T_peak = epsilon / (2 * k_B)
    C_peak = schottky_heat_capacity(epsilon, T_peak, k_B)
    ax3.plot(T_peak, C_peak / k_B, 'o', color=color, markersize=8)

ax3.set_xlabel('Temperature (K)')
ax3.set_ylabel('Heat capacity / k_B')
ax3.set_title('Schottkyæ¯”ç†±')
ax3.legend()
ax3.grid(True, alpha=0.3)

# ã‚¨ãƒãƒ«ã‚®ãƒ¼é–“éš”ä¾å­˜æ€§ï¼ˆãƒ”ãƒ¼ã‚¯æ¸©åº¦ï¼‰
ax4 = axes[1, 1]
epsilon_scan = np.linspace(0.5e-21, 10e-21, 50)
T_peak_list = epsilon_scan / (2 * k_B)
C_peak_list = [schottky_heat_capacity(eps, eps/(2*k_B), k_B) for eps in epsilon_scan]

ax4.plot(epsilon_scan / 1e-21, T_peak_list, 'b-', linewidth=2)
ax4_twin = ax4.twinx()
ax4_twin.plot(epsilon_scan / 1e-21, np.array(C_peak_list) / k_B, 'r-', linewidth=2)

ax4.set_xlabel('Energy gap Îµ (10â»Â²Â¹ J)')
ax4.set_ylabel('Peak temperature (K)', color='b')
ax4_twin.set_ylabel('Peak heat capacity / k_B', color='r')
ax4.set_title('ãƒ”ãƒ¼ã‚¯ç‰¹æ€§ã®Îµä¾å­˜æ€§')
ax4.tick_params(axis='y', labelcolor='b')
ax4_twin.tick_params(axis='y', labelcolor='r')
ax4.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_two_level_schottky.png', dpi=300, bbox_inches='tight')
plt.show()

# æ•°å€¤çµæœ
print("=== 2æº–ä½ç³»ã¨Schottkyæ¯”ç†± ===\n")
for epsilon, label in zip(epsilon_values, labels):
    T_peak = epsilon / (2 * k_B)
    C_peak = schottky_heat_capacity(epsilon, T_peak, k_B)
    print(f"{label}:")
    print(f"  ç‰¹æ€§æ¸©åº¦ Î¸ = Îµ/k_B = {epsilon/k_B:.2f} K")
    print(f"  ãƒ”ãƒ¼ã‚¯æ¸©åº¦ T_peak â‰ˆ {T_peak:.2f} K")
    print(f"  ãƒ”ãƒ¼ã‚¯æ¯”ç†± C_peak = {C_peak/k_B:.4f} k_B\n")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ2.4: Einsteinå›ºä½“ãƒ¢ãƒ‡ãƒ«</h2>
            
            <div class="definition">
                <h3>Einsteinå›ºä½“ãƒ¢ãƒ‡ãƒ«</h3>
                <p>\(N\)å€‹ã®åŸå­ãŒç‹¬ç«‹ãª3æ¬¡å…ƒèª¿å’ŒæŒ¯å‹•å­ã¨ã—ã¦æŒ¯ã‚‹èˆã†:</p>
                <p>åˆ†é…é–¢æ•°ï¼ˆ1åŸå­ã‚ãŸã‚Šï¼‰:</p>
                <p>\[
                z = \left(\frac{e^{-\beta\hbar\omega/2}}{1 - e^{-\beta\hbar\omega}}\right)^3
                \]</p>
                <p>ãƒ¢ãƒ«ç†±å®¹é‡:</p>
                <p>\[
                C_V = 3R \left(\frac{\theta_E}{T}\right)^2 \frac{e^{\theta_E/T}}{(e^{\theta_E/T} - 1)^2}
                \]</p>
                <p>Einsteinæ¸©åº¦: \(\theta_E = \hbar\omega / k_B\)</p>
                <p>é«˜æ¸©æ¥µé™: \(C_V \to 3R\) ï¼ˆDulongã¨ Petitã®æ³•å‰‡ï¼‰</p>
                <p>ä½æ¸©æ¥µé™: \(C_V \propto e^{-\theta_E/T}\) ï¼ˆæŒ‡æ•°çš„æ¸›è¡°ï¼‰</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: Einsteinå›ºä½“ã®ç†±å®¹é‡</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

R = 8.314  # J/(KÂ·mol)

def einstein_heat_capacity(T, theta_E, R):
    """Einsteinå›ºä½“ã®ãƒ¢ãƒ«ç†±å®¹é‡"""
    x = theta_E / T
    exp_x = np.exp(x)
    return 3 * R * x**2 * exp_x / (exp_x - 1)**2

# ç•°ãªã‚‹ç‰©è³ªï¼ˆEinsteinæ¸©åº¦ãŒç•°ãªã‚‹ï¼‰
materials = {
    'Pb': 88,    # K
    'Ag': 215,
    'Al': 394,
    'C (diamond)': 1860
}

colors = ['blue', 'green', 'orange', 'red']
T_range = np.logspace(0, 3, 300)  # 1 K ~ 1000 K

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# Einsteinç†±å®¹é‡
ax1 = axes[0]
for (material, theta_E), color in zip(materials.items(), colors):
    C_V = [einstein_heat_capacity(T, theta_E, R) for T in T_range]
    ax1.semilogx(T_range, C_V, color=color, linewidth=2, label=f'{material} (Î¸_E={theta_E}K)')

ax1.axhline(3 * R, color='k', linestyle='--', linewidth=1.5, label='Dulong-Petit: 3R')
ax1.set_xlabel('Temperature (K)')
ax1.set_ylabel('Molar heat capacity (J/(KÂ·mol))')
ax1.set_title('Einsteinå›ºä½“ã®ç†±å®¹é‡')
ax1.legend()
ax1.grid(True, alpha=0.3)
ax1.set_ylim([0, 30])

# è¦æ ¼åŒ–ã—ãŸç†±å®¹é‡ï¼ˆæ™®éæ›²ç·šï¼‰
ax2 = axes[1]
for (material, theta_E), color in zip(materials.items(), colors):
    T_reduced = T_range / theta_E
    C_V_reduced = [einstein_heat_capacity(T, theta_E, R) / (3*R) for T in T_range]
    ax2.semilogx(T_reduced, C_V_reduced, color=color, linewidth=2, label=material)

ax2.axhline(1.0, color='k', linestyle='--', linewidth=1.5, label='é«˜æ¸©æ¥µé™')
ax2.set_xlabel('Reduced temperature T/Î¸_E')
ax2.set_ylabel('C_V / (3R)')
ax2.set_title('è¦æ ¼åŒ–ç†±å®¹é‡ï¼ˆæ™®éæ›²ç·šï¼‰')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_einstein_solid.png', dpi=300, bbox_inches='tight')
plt.show()

# æ•°å€¤çµæœ
print("=== Einsteinå›ºä½“ãƒ¢ãƒ‡ãƒ« ===\n")
print("Dulong-Petitã®æ³•å‰‡: C_V = 3R = {:.3f} J/(KÂ·mol)\n".format(3*R))

T_test = 300  # K
print(f"T = {T_test} K ã§ã®ç†±å®¹é‡:")
for material, theta_E in materials.items():
    C_V = einstein_heat_capacity(T_test, theta_E, R)
    print(f"  {material:15s}: C_V = {C_V:.3f} J/(KÂ·mol) ({C_V/(3*R)*100:.1f}% of 3R)")

print("\nä½æ¸©ã§ã®æŒ¯ã‚‹èˆã„ï¼ˆT = 10 Kï¼‰:")
T_low = 10
for material, theta_E in materials.items():
    C_V_low = einstein_heat_capacity(T_low, theta_E, R)
    print(f"  {material:15s}: C_V = {C_V_low:.6f} J/(KÂ·mol)")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ2.5: Debyeå›ºä½“ãƒ¢ãƒ‡ãƒ«</h2>
            
            <div class="definition">
                <h3>Debyeãƒ¢ãƒ‡ãƒ«</h3>
                <p>æ ¼å­æŒ¯å‹•ã‚’é€£ç¶šä½“ã®éŸ³æ³¢ã¨ã—ã¦æ‰±ã„ã€å‘¨æ³¢æ•°åˆ†å¸ƒã‚’è€ƒæ…®:</p>
                <p>çŠ¶æ…‹å¯†åº¦: \(g(\omega) \propto \omega^2\) ï¼ˆ\(\omega < \omega_D\)ï¼‰</p>
                <p>Debyeæ¸©åº¦: \(\theta_D = \hbar\omega_D / k_B\)</p>
                <p>ä½æ¸©æ¥µé™ï¼ˆ\(T \ll \theta_D\)ï¼‰:</p>
                <p>\[
                C_V = \frac{12\pi^4}{5} R \left(\frac{T}{\theta_D}\right)^3
                \]</p>
                <p>ã“ã‚ŒãŒæœ‰åãª<strong>Debye \(T^3\) å‰‡</strong>ã§ã™ã€‚å®Ÿé¨“ã¨ã‚ˆãä¸€è‡´ã—ã¾ã™ã€‚</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: Debyeç†±å®¹é‡ã¨TÂ³å‰‡</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import quad

R = 8.314  # J/(KÂ·mol)

def debye_integral(x):
    """Debyeç©åˆ†: D(x) = (3/xÂ³) âˆ«â‚€Ë£ (tâ´ e^t)/(e^t - 1)Â² dt"""
    if x < 1e-10:
        return 0
    
    def integrand(t):
        if t < 1e-10:
            return 0
        exp_t = np.exp(t)
        return (t**4 * exp_t) / (exp_t - 1)**2
    
    integral_value, _ = quad(integrand, 0, x, limit=100)
    return 3 * integral_value / x**3

def debye_heat_capacity(T, theta_D, R):
    """Debyeãƒ¢ãƒ‡ãƒ«ã®ç†±å®¹é‡"""
    x = theta_D / T
    D_x = debye_integral(x)
    return 3 * R * D_x

def debye_T3_law(T, theta_D, R):
    """ä½æ¸©æ¥µé™ã®TÂ³å‰‡"""
    return (12 * np.pi**4 / 5) * R * (T / theta_D)**3

# ç‰©è³ªã®Debyeæ¸©åº¦
materials_debye = {
    'Pb': 105,   # K
    'Ag': 225,
    'Cu': 343,
    'Al': 428,
    'C (diamond)': 2230
}

colors = ['blue', 'green', 'orange', 'red', 'purple']
T_range = np.logspace(0, 3, 100)

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# Debyeç†±å®¹é‡
ax1 = axes[0]
for (material, theta_D), color in zip(materials_debye.items(), colors):
    C_V = [debye_heat_capacity(T, theta_D, R) for T in T_range]
    ax1.semilogx(T_range, C_V, '-', color=color, linewidth=2, 
                 label=f'{material} (Î¸_D={theta_D}K)')

ax1.axhline(3 * R, color='k', linestyle='--', linewidth=1.5, label='Dulong-Petit')
ax1.set_xlabel('Temperature (K)')
ax1.set_ylabel('Molar heat capacity (J/(KÂ·mol))')
ax1.set_title('Debyeå›ºä½“ã®ç†±å®¹é‡')
ax1.legend(fontsize=9)
ax1.grid(True, alpha=0.3)

# TÂ³å‰‡ã®æ¤œè¨¼ï¼ˆä½æ¸©ï¼‰
ax2 = axes[1]
T_low = np.linspace(1, 50, 100)
material_test = 'Al'
theta_D_test = materials_debye[material_test]

C_debye = [debye_heat_capacity(T, theta_D_test, R) for T in T_low]
C_T3 = [debye_T3_law(T, theta_D_test, R) for T in T_low]

ax2.plot(T_low**3, C_debye, 'b-', linewidth=2, label='Debyeãƒ¢ãƒ‡ãƒ«')
ax2.plot(T_low**3, C_T3, 'r--', linewidth=2, label='TÂ³å‰‡ï¼ˆä½æ¸©æ¥µé™ï¼‰')
ax2.set_xlabel('TÂ³ (KÂ³)')
ax2.set_ylabel('Heat capacity (J/(KÂ·mol))')
ax2.set_title(f'TÂ³å‰‡ã®æ¤œè¨¼ï¼ˆ{material_test}, Î¸_D={theta_D_test}Kï¼‰')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_debye_model.png', dpi=300, bbox_inches='tight')
plt.show()

# Einsteinãƒ¢ãƒ‡ãƒ«ã¨Debyeãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒ
print("=== Einsteinãƒ¢ãƒ‡ãƒ«ã¨Debyeãƒ¢ãƒ‡ãƒ«ã®æ¯”è¼ƒ ===\n")
print("ç‰©è³ª: Al (Î¸_E â‰ˆ Î¸_D â‰ˆ 400 K)\n")

theta_test = 400
T_values = [10, 50, 100, 300]

from scipy.integrate import quad as scipy_quad

for T in T_values:
    C_einstein = einstein_heat_capacity(T, theta_test, R)
    C_debye = debye_heat_capacity(T, theta_test, R)
    
    print(f"T = {T} K:")
    print(f"  Einstein: C_V = {C_einstein:.4f} J/(KÂ·mol)")
    print(f"  Debye:    C_V = {C_debye:.4f} J/(KÂ·mol)")
    print(f"  å·®: {abs(C_einstein - C_debye):.4f} J/(KÂ·mol)\n")

print("ä½æ¸©ã§ã®TÂ³å‰‡:")
T_low_test = 10
C_debye_low = debye_heat_capacity(T_low_test, theta_test, R)
C_T3_low = debye_T3_law(T_low_test, theta_test, R)
print(f"T = {T_low_test} K:")
print(f"  Debyeå®Œå…¨è¨ˆç®—: {C_debye_low:.6f} J/(KÂ·mol)")
print(f"  TÂ³è¿‘ä¼¼: {C_T3_low:.6f} J/(KÂ·mol)")
print(f"  ç›¸å¯¾èª¤å·®: {abs(C_debye_low - C_T3_low)/C_debye_low * 100:.2f}%")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ2.6: å›è»¢ã®åˆ†é…é–¢æ•°ï¼ˆ2åŸå­åˆ†å­ï¼‰</h2>
            
            <div class="code-title">Pythonå®Ÿè£…: 2åŸå­åˆ†å­ã®å›è»¢ã‚¹ãƒšã‚¯ãƒˆãƒ«</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# 2åŸå­åˆ†å­ã®å›è»¢ã‚¨ãƒãƒ«ã‚®ãƒ¼
# E_J = B J(J+1), J = 0, 1, 2, ...
# B = â„Â²/(2I) : å›è»¢å®šæ•°
# ç¸®é€€åº¦: g_J = 2J + 1

k_B = 1.380649e-23  # J/K
hbar = 1.054572e-34  # JÂ·s

# Hâ‚‚åˆ†å­ã®å›è»¢å®šæ•°
B_H2 = 85.4  # Kï¼ˆB/k_B ã®å˜ä½ã§ï¼‰

def rotational_energy(J, B):
    """å›è»¢ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ï¼ˆæ¸©åº¦å˜ä½ï¼‰"""
    return B * J * (J + 1)

def rotational_partition_function(T, B, J_max=50):
    """å›è»¢åˆ†é…é–¢æ•°"""
    Z_rot = 0
    for J in range(J_max):
        g_J = 2 * J + 1
        E_J = rotational_energy(J, B)
        Z_rot += g_J * np.exp(-E_J / T)
    return Z_rot

def rotational_heat_capacity(T, B, J_max=50):
    """å›è»¢ç†±å®¹é‡"""
    Z = rotational_partition_function(T, B, J_max)
    
    # <E>ã®è¨ˆç®—
    E_avg = 0
    for J in range(J_max):
        g_J = 2 * J + 1
        E_J = rotational_energy(J, B)
        E_avg += g_J * E_J * np.exp(-E_J / T)
    E_avg /= Z
    
    # <EÂ²>ã®è¨ˆç®—
    E2_avg = 0
    for J in range(J_max):
        g_J = 2 * J + 1
        E_J = rotational_energy(J, B)
        E2_avg += g_J * E_J**2 * np.exp(-E_J / T)
    E2_avg /= Z
    
    # C = d<E>/dT = (<EÂ²> - <E>Â²) / (k_B TÂ²)
    C_rot = (E2_avg - E_avg**2) / T**2
    return C_rot * k_B

# æ¸©åº¦ç¯„å›²
T_range = np.linspace(10, 1000, 200)

# æº–ä½å æœ‰æ•°
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å›è»¢æº–ä½ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ç¸®é€€åº¦
ax1 = axes[0, 0]
J_values = np.arange(0, 20)
E_values = [rotational_energy(J, B_H2) for J in J_values]
g_values = [2*J + 1 for J in J_values]

ax1.stem(J_values, E_values, basefmt=' ', linefmt='b-', markerfmt='bo')
for J, E, g in zip(J_values[:10], E_values[:10], g_values[:10]):
    ax1.text(J + 0.3, E, f'g={g}', fontsize=8)

ax1.set_xlabel('Rotational quantum number J')
ax1.set_ylabel('Energy E/k_B (K)')
ax1.set_title(f'å›è»¢æº–ä½ï¼ˆHâ‚‚, B = {B_H2} Kï¼‰')
ax1.grid(True, alpha=0.3)

# æ¸©åº¦ã§ã®å æœ‰åˆ†å¸ƒ
ax2 = axes[0, 1]
temperatures_demo = [50, 100, 300, 500]
colors_demo = ['blue', 'green', 'orange', 'red']

for T, color in zip(temperatures_demo, colors_demo):
    Z = rotational_partition_function(T, B_H2)
    populations = []
    for J in J_values:
        g_J = 2 * J + 1
        E_J = rotational_energy(J, B_H2)
        p_J = g_J * np.exp(-E_J / T) / Z
        populations.append(p_J)
    
    ax2.plot(J_values, populations, 'o-', color=color, linewidth=2, 
             markersize=4, label=f'T = {T} K')

ax2.set_xlabel('J')
ax2.set_ylabel('Population')
ax2.set_title('å›è»¢æº–ä½ã®å æœ‰åˆ†å¸ƒ')
ax2.legend()
ax2.grid(True, alpha=0.3)

# åˆ†é…é–¢æ•°
ax3 = axes[1, 0]
Z_values = [rotational_partition_function(T, B_H2) for T in T_range]
ax3.plot(T_range, Z_values, 'b-', linewidth=2)
ax3.axvline(B_H2, color='r', linestyle='--', linewidth=1.5, label=f'Î¸_rot = {B_H2} K')
ax3.set_xlabel('Temperature (K)')
ax3.set_ylabel('Partition function Z_rot')
ax3.set_title('å›è»¢åˆ†é…é–¢æ•°')
ax3.legend()
ax3.grid(True, alpha=0.3)

# å›è»¢ç†±å®¹é‡
ax4 = axes[1, 1]
C_rot_values = [rotational_heat_capacity(T, B_H2) / k_B for T in T_range]
ax4.plot(T_range, C_rot_values, 'g-', linewidth=2)
ax4.axhline(1.0, color='k', linestyle='--', linewidth=1.5, label='å¤å…¸æ¥µé™: k_B')
ax4.axvline(B_H2, color='r', linestyle='--', linewidth=1.5, label=f'Î¸_rot = {B_H2} K')
ax4.set_xlabel('Temperature (K)')
ax4.set_ylabel('C_rot / k_B')
ax4.set_title('å›è»¢ç†±å®¹é‡')
ax4.legend()
ax4.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_rotation.png', dpi=300, bbox_inches='tight')
plt.show()

print("=== 2åŸå­åˆ†å­ã®å›è»¢ï¼ˆHâ‚‚ï¼‰===")
print(f"å›è»¢å®šæ•° B = {B_H2} K\n")

for T in [50, 100, 300, 500]:
    Z_rot = rotational_partition_function(T, B_H2)
    C_rot = rotational_heat_capacity(T, B_H2)
    print(f"T = {T} K:")
    print(f"  Z_rot = {Z_rot:.4f}")
    print(f"  C_rot = {C_rot/k_B:.4f} k_B\n")

print("é«˜æ¸©æ¥µé™ï¼ˆT >> Î¸_rotï¼‰:")
print("  Z_rot â‰ˆ T/Î¸_rot")
print("  C_rot â‰ˆ k_B (å¤å…¸çš„)")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ2.7: ç†æƒ³æ°—ä½“ã®åˆ†é…é–¢æ•°</h2>
            
            <div class="code-title">Pythonå®Ÿè£…: ä¸¦é€²ãƒ»å›è»¢ãƒ»æŒ¯å‹•ã®åˆ†é›¢</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

k_B = 1.380649e-23  # J/K
h = 6.62607015e-34  # JÂ·s
hbar = h / (2 * np.pi)
m_N2 = 4.65e-26  # Nâ‚‚åˆ†å­ã®è³ªé‡ (kg)

# Nâ‚‚åˆ†å­ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
B_N2 = 2.88  # Kï¼ˆå›è»¢å®šæ•°ï¼‰
theta_vib_N2 = 3374  # Kï¼ˆæŒ¯å‹•æ¸©åº¦ï¼‰

def translational_partition_per_molecule(V, T, m, h, k_B):
    """ä¸¦é€²åˆ†é…é–¢æ•°ï¼ˆ1åˆ†å­ã‚ãŸã‚Šï¼‰"""
    lambda_T = h / np.sqrt(2 * np.pi * m * k_B * T)  # ç†±çš„de Broglieæ³¢é•·
    return V / lambda_T**3

def rotational_partition(T, B):
    """å›è»¢åˆ†é…é–¢æ•°ï¼ˆé«˜æ¸©è¿‘ä¼¼ï¼‰"""
    return T / B

def vibrational_partition(T, theta_vib):
    """æŒ¯å‹•åˆ†é…é–¢æ•°"""
    return 1 / (1 - np.exp(-theta_vib / T))

def total_partition_per_molecule(V, T, m, B, theta_vib, h, k_B):
    """å…¨åˆ†é…é–¢æ•° = z_trans Ã— z_rot Ã— z_vib"""
    z_trans = translational_partition_per_molecule(V, T, m, h, k_B)
    z_rot = rotational_partition(T, B)
    z_vib = vibrational_partition(T, theta_vib)
    return z_trans * z_rot * z_vib

# æ¨™æº–çŠ¶æ…‹
T_std = 298.15  # K
V_molar = 0.0224  # mÂ³/mol
N_A = 6.022e23
V_per_molecule = V_molar / N_A

# æ¸©åº¦ç¯„å›²
T_range = np.linspace(100, 1000, 200)

# å„å¯„ä¸ã‚’è¨ˆç®—
z_trans_list = [translational_partition_per_molecule(V_per_molecule, T, m_N2, h, k_B) 
                for T in T_range]
z_rot_list = [rotational_partition(T, B_N2) for T in T_range]
z_vib_list = [vibrational_partition(T, theta_vib_N2) for T in T_range]
z_total_list = [total_partition_per_molecule(V_per_molecule, T, m_N2, B_N2, 
                                               theta_vib_N2, h, k_B) for T in T_range]

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å„å¯„ä¸ã®æ¸©åº¦ä¾å­˜æ€§
ax1 = axes[0, 0]
ax1.semilogy(T_range, z_trans_list, 'b-', linewidth=2, label='Translational')
ax1.semilogy(T_range, z_rot_list, 'g-', linewidth=2, label='Rotational')
ax1.semilogy(T_range, z_vib_list, 'r-', linewidth=2, label='Vibrational')
ax1.set_xlabel('Temperature (K)')
ax1.set_ylabel('Partition function (per molecule)')
ax1.set_title('å„è‡ªç”±åº¦ã®åˆ†é…é–¢æ•°')
ax1.legend()
ax1.grid(True, alpha=0.3, which='both')

# å…¨åˆ†é…é–¢æ•°
ax2 = axes[0, 1]
ax2.semilogy(T_range, z_total_list, 'k-', linewidth=2)
ax2.set_xlabel('Temperature (K)')
ax2.set_ylabel('Total partition function')
ax2.set_title('å…¨åˆ†é…é–¢æ•°ï¼ˆz_trans Ã— z_rot Ã— z_vibï¼‰')
ax2.grid(True, alpha=0.3, which='both')

# å¯„ä¸ã®å‰²åˆ
ax3 = axes[1, 0]
log_z_trans = np.log(z_trans_list)
log_z_rot = np.log(z_rot_list)
log_z_vib = np.log(z_vib_list)
log_z_total = np.log(z_total_list)

fraction_trans = log_z_trans / log_z_total
fraction_rot = log_z_rot / log_z_total
fraction_vib = log_z_vib / log_z_total

ax3.plot(T_range, fraction_trans, 'b-', linewidth=2, label='Translational')
ax3.plot(T_range, fraction_rot, 'g-', linewidth=2, label='Rotational')
ax3.plot(T_range, fraction_vib, 'r-', linewidth=2, label='Vibrational')
ax3.set_xlabel('Temperature (K)')
ax3.set_ylabel('Fraction of ln(z)')
ax3.set_title('å¯„ä¸ã®å‰²åˆ')
ax3.legend()
ax3.grid(True, alpha=0.3)

# ç†±å®¹é‡ã¸ã®å¯„ä¸
ax4 = axes[1, 1]
C_trans = 1.5 * np.ones_like(T_range)  # (3/2) k_B
C_rot = 1.0 * np.ones_like(T_range)    # k_Bï¼ˆé«˜æ¸©ï¼‰

C_vib_list = []
for T in T_range:
    x = theta_vib_N2 / T
    exp_x = np.exp(x)
    C_vib = x**2 * exp_x / (exp_x - 1)**2
    C_vib_list.append(C_vib)

C_total = C_trans + C_rot + np.array(C_vib_list)

ax4.plot(T_range, C_trans, 'b--', linewidth=2, label='Translational')
ax4.plot(T_range, C_rot, 'g--', linewidth=2, label='Rotational')
ax4.plot(T_range, C_vib_list, 'r--', linewidth=2, label='Vibrational')
ax4.plot(T_range, C_total, 'k-', linewidth=2, label='Total')
ax4.axhline(3.5, color='gray', linestyle=':', linewidth=1.5, label='(7/2)k_B')
ax4.set_xlabel('Temperature (K)')
ax4.set_ylabel('C_V / k_B')
ax4.set_title('ç†±å®¹é‡ã¸ã®å¯„ä¸ï¼ˆNâ‚‚ï¼‰')
ax4.legend()
ax4.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_ideal_gas_partition.png', dpi=300, bbox_inches='tight')
plt.show()

# æ•°å€¤çµæœ
print("=== Nâ‚‚ç†æƒ³æ°—ä½“ã®åˆ†é…é–¢æ•°ï¼ˆæ¨™æº–çŠ¶æ…‹ï¼‰===")
print(f"T = {T_std} K, V = {V_molar} mÂ³/mol\n")

z_trans_std = translational_partition_per_molecule(V_per_molecule, T_std, m_N2, h, k_B)
z_rot_std = rotational_partition(T_std, B_N2)
z_vib_std = vibrational_partition(T_std, theta_vib_N2)
z_total_std = z_trans_std * z_rot_std * z_vib_std

print(f"ä¸¦é€²: z_trans = {z_trans_std:.6e}")
print(f"å›è»¢: z_rot = {z_rot_std:.2f}")
print(f"æŒ¯å‹•: z_vib = {z_vib_std:.6f}")
print(f"å…¨ä½“: z_total = {z_total_std:.6e}\n")

print("ç†±å®¹é‡ï¼ˆ300 Kï¼‰:")
C_trans_val = 1.5
C_rot_val = 1.0
T_300 = 300
x_300 = theta_vib_N2 / T_300
C_vib_val = x_300**2 * np.exp(x_300) / (np.exp(x_300) - 1)**2
C_total_val = C_trans_val + C_rot_val + C_vib_val

print(f"  C_trans = {C_trans_val:.2f} k_B")
print(f"  C_rot = {C_rot_val:.2f} k_B")
print(f"  C_vib = {C_vib_val:.4f} k_B ï¼ˆæŒ¯å‹•ã¯ã»ã¼å‡çµï¼‰")
print(f"  C_total â‰ˆ {C_total_val:.2f} k_B")
print(f"  å®Ÿæ¸¬å€¤: C_V â‰ˆ 2.5 k_B ï¼ˆä¸¦é€²+å›è»¢ã®ã¿ï¼‰")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ2.8: ææ–™ç§‘å­¦å¿œç”¨ - æ ¼å­æŒ¯å‹•ã¨ç†±è†¨å¼µ</h2>
            
            <div class="code-title">Pythonå®Ÿè£…: éèª¿å’ŒåŠ¹æœã¨ç†±è†¨å¼µ</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# éèª¿å’Œãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«: V(x) = (1/2)kxÂ² - gxÂ³ + fxâ´
# gãŒéèª¿å’Œæ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

k_B = 1.380649e-23  # J/K

def anharmonic_potential(x, k, g, f):
    """éèª¿å’Œãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«"""
    return 0.5 * k * x**2 - g * x**3 + f * x**4

def thermal_expansion_coefficient(T, k, g, theta, k_B):
    """ç·šç†±è†¨å¼µä¿‚æ•°ï¼ˆæ‘‚å‹•ç†è«–ï¼‰"""
    # Î± âˆ g/k Ã— (dE/dT)
    # ç°¡æ˜“ãƒ¢ãƒ‡ãƒ«
    x = theta / T
    if x > 50:  # æ¥µä½æ¸©
        return 0
    exp_x = np.exp(x)
    dE_dT = k_B * x**2 * exp_x / (exp_x - 1)**2
    alpha = (g / k) * dE_dT / (k_B * T)
    return alpha

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆå…¸å‹çš„ãªå›ºä½“ï¼‰
k = 100  # N/mï¼ˆãƒãƒå®šæ•°ï¼‰
g = 10   # éèª¿å’Œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
f = 1    # 4æ¬¡é …
theta = 300  # Kï¼ˆEinsteinæ¸©åº¦ï¼‰

x_range = np.linspace(-0.2, 0.3, 1000)

fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®å½¢çŠ¶
ax1 = axes[0, 0]
V_harmonic = 0.5 * k * x_range**2
V_anharmonic = anharmonic_potential(x_range, k, g, f)

ax1.plot(x_range, V_harmonic, 'b--', linewidth=2, label='èª¿å’Œãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«')
ax1.plot(x_range, V_anharmonic, 'r-', linewidth=2, label='éèª¿å’Œãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«')
ax1.axvline(0, color='k', linestyle=':', linewidth=1)
ax1.axhline(0, color='k', linestyle=':', linewidth=1)
ax1.set_xlabel('Displacement x')
ax1.set_ylabel('Potential V(x)')
ax1.set_title('èª¿å’Œãƒ»éèª¿å’Œãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«')
ax1.legend()
ax1.grid(True, alpha=0.3)
ax1.set_ylim([-0.5, 2])

# å¹³è¡¡ä½ç½®ã®æ¸©åº¦ä¾å­˜æ€§ï¼ˆå®šæ€§çš„ï¼‰
ax2 = axes[0, 1]
T_vals = np.linspace(1, 1000, 100)
# éèª¿å’Œæ€§ã«ã‚ˆã‚Šé«˜æ¸©ã§å¹³è¡¡ä½ç½®ãŒã‚·ãƒ•ãƒˆ
x_eq_shift = [0.01 * (T / theta) * (g / k) if T > theta/10 else 0 for T in T_vals]

ax2.plot(T_vals, x_eq_shift, 'r-', linewidth=2)
ax2.set_xlabel('Temperature (K)')
ax2.set_ylabel('Equilibrium shift')
ax2.set_title('å¹³è¡¡ä½ç½®ã®æ¸©åº¦ä¾å­˜æ€§ï¼ˆç†±è†¨å¼µï¼‰')
ax2.grid(True, alpha=0.3)

# ç†±è†¨å¼µä¿‚æ•°
ax3 = axes[1, 0]
alpha_vals = [thermal_expansion_coefficient(T, k, g, theta, k_B) for T in T_vals]
ax3.plot(T_vals, alpha_vals, 'b-', linewidth=2)
ax3.set_xlabel('Temperature (K)')
ax3.set_ylabel('Thermal expansion coefficient (a.u.)')
ax3.set_title('ç·šç†±è†¨å¼µä¿‚æ•°ã®æ¸©åº¦ä¾å­˜æ€§')
ax3.grid(True, alpha=0.3)

# GrÃ¼neisenãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã®é–¢ä¿‚
ax4 = axes[1, 1]
# GrÃ¼neisenãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î³ = V/C_V Ã— Î± Ã— B_T
# å…¸å‹çš„ãªå€¤
gamma_typical = 2.0  # ç„¡æ¬¡å…ƒ
text_str = f"""
GrÃ¼neisenãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î³:

Î³ = (V/C_V) Ã— Î± Ã— B_T

å…¸å‹çš„ãªå€¤: Î³ â‰ˆ {gamma_typical}

æ„å‘³:
- æ ¼å­æŒ¯å‹•ã®ä½“ç©ä¾å­˜æ€§
- ç†±è†¨å¼µã¨åœ§ç¸®ç‡ã®é–¢ä¿‚
- éèª¿å’Œæ€§ã®å°ºåº¦
"""
ax4.text(0.1, 0.5, text_str, fontsize=12, verticalalignment='center',
         bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5))
ax4.axis('off')
ax4.set_title('GrÃ¼neisenãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿')

plt.tight_layout()
plt.savefig('stat_mech_anharmonic_thermal_expansion.png', dpi=300, bbox_inches='tight')
plt.show()

print("=== éèª¿å’ŒåŠ¹æœã¨ç†±è†¨å¼µ ===\n")
print("éèª¿å’Œãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«: V(x) = (1/2)kxÂ² - gxÂ³ + fxâ´\n")
print(f"ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:")
print(f"  k = {k} N/m")
print(f"  g = {g} ï¼ˆéèª¿å’Œãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰")
print(f"  Î¸ = {theta} K\n")

print("ç†±è†¨å¼µã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ :")
print("  1. éèª¿å’Œæ€§ï¼ˆgâ‰ 0ï¼‰ã«ã‚ˆã‚Šã€ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãŒéå¯¾ç§°")
print("  2. é«˜æ¸©ã§æŒ¯å‹•æŒ¯å¹…ãŒå¢—å¤§")
print("  3. éå¯¾ç§°æ€§ã«ã‚ˆã‚Šå¹³è¡¡ä½ç½®ãŒã‚·ãƒ•ãƒˆ â†’ ç†±è†¨å¼µ\n")

T_test = 300
alpha_test = thermal_expansion_coefficient(T_test, k, g, theta, k_B)
print(f"T = {T_test} K ã§ã®ç†±è†¨å¼µä¿‚æ•°:")
print(f"  Î± â‰ˆ {alpha_test:.6e} Kâ»Â¹ (ä»»æ„å˜ä½)\n")

print("å®Ÿéš›ã®ç‰©è³ªã®ç·šç†±è†¨å¼µä¿‚æ•°ï¼ˆ300 Kä»˜è¿‘ï¼‰:")
print("  Al: Î± â‰ˆ 23 Ã— 10â»â¶ Kâ»Â¹")
print("  Cu: Î± â‰ˆ 17 Ã— 10â»â¶ Kâ»Â¹")
print("  Fe: Î± â‰ˆ 12 Ã— 10â»â¶ Kâ»Â¹")
</div>
        </div>

        <div class="content">
            <h2>ğŸ“š ã¾ã¨ã‚</h2>
            <ul>
                <li><strong>ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£</strong>ã¯æ¸©åº¦å›ºå®šã®ç³»ã‚’è¨˜è¿°ã—ã€åˆ†é…é–¢æ•° \(Z\) ã‹ã‚‰å…¨ç†±åŠ›å­¦é‡ãŒå°å‡ºå¯èƒ½</li>
                <li><strong>Helmholtzè‡ªç”±ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong> \(F = -k_B T \ln Z\) ãŒåŸºæœ¬çš„ãªç†±åŠ›å­¦ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«</li>
                <li><strong>ç­‰åˆ†é…å®šç†</strong>ã«ã‚ˆã‚Šã€å¤å…¸çš„ãª2æ¬¡ã‚¨ãƒãƒ«ã‚®ãƒ¼é …ã¯å„è‡ªç”±åº¦ã§ \(\frac{1}{2}k_B T\) ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã¤</li>
                <li><strong>èª¿å’ŒæŒ¯å‹•å­</strong>ã¯é‡å­åŠ¹æœï¼ˆé›¶ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ã¨é«˜æ¸©å¤å…¸æ¥µé™ã‚’ç¤ºã™åŸºæœ¬ç³»</li>
                <li><strong>2æº–ä½ç³»</strong>ã¯Schottkyæ¯”ç†±ã‚’ç¤ºã—ã€ç£æ€§ã‚„ãƒˆãƒ³ãƒãƒ«ç³»ã®ãƒ¢ãƒ‡ãƒ«</li>
                <li><strong>Einsteinå›ºä½“</strong>ã¯ç‹¬ç«‹æŒ¯å‹•å­ã®é›†åˆã¨ã—ã¦Dulong-Petitã®æ³•å‰‡ã‚’èª¬æ˜</li>
                <li><strong>Debyeãƒ¢ãƒ‡ãƒ«</strong>ã¯ä½æ¸©ã§ \(T^3\) å‰‡ã‚’ä¸ãˆã€å®Ÿé¨“ã¨ã‚ˆãä¸€è‡´</li>
                <li>ç†æƒ³æ°—ä½“ã®åˆ†é…é–¢æ•°ã¯<strong>ä¸¦é€²ãƒ»å›è»¢ãƒ»æŒ¯å‹•ã«åˆ†é›¢</strong>ã§ãã€å„å¯„ä¸ã‚’ç‹¬ç«‹ã«è©•ä¾¡å¯èƒ½</li>
                <li><strong>éèª¿å’ŒåŠ¹æœ</strong>ãŒç†±è†¨å¼µã®èµ·æºã§ã‚ã‚Šã€GrÃ¼neisenãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ç‰¹å¾´ã¥ã‘ã‚‰ã‚Œã‚‹</li>
            </ul>
        </div>

        <div class="exercise">
            <h3>ğŸ’¡ æ¼”ç¿’å•é¡Œ</h3>
            <ol>
                <li><strong>èª¿å’ŒæŒ¯å‹•å­ã®æºã‚‰ã</strong>: ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åˆ†æ•£ \(\langle E^2 \rangle - \langle E \rangle^2\) ã‚’è¨ˆç®—ã—ã€æ¸©åº¦ä¾å­˜æ€§ã‚’èª¿ã¹ã‚ˆã€‚</li>
                <li><strong>ç­‰åˆ†é…å®šç†ã®å°å‡º</strong>: \(\langle p^2/(2m) \rangle\) ã‚’ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã‹ã‚‰ç©åˆ†ã—ã¦ \(\frac{1}{2}k_B T\) ã‚’ç¤ºã›ã€‚</li>
                <li><strong>Schottkyç•°å¸¸</strong>: 3æº–ä½ç³»ï¼ˆEâ‚€=0, Eâ‚=Îµ, Eâ‚‚=2Îµï¼‰ã®Schottkyæ¯”ç†±ã‚’è¨ˆç®—ã—ã€2ã¤ã®ãƒ”ãƒ¼ã‚¯ã‚’è¦³å¯Ÿã›ã‚ˆã€‚</li>
                <li><strong>Einsteinã¨Debyeã®æ¯”è¼ƒ</strong>: åŒã˜ç‰¹æ€§æ¸©åº¦ï¼ˆÎ¸_E = Î¸_Dï¼‰ã§ä½æ¸©ç†±å®¹é‡ã‚’æ¯”è¼ƒã—ã€Debyeãƒ¢ãƒ‡ãƒ«ã®å„ªä½æ€§ã‚’ç¢ºèªã›ã‚ˆã€‚</li>
                <li><strong>æŒ¯å‹•-å›è»¢ã‚¹ãƒšã‚¯ãƒˆãƒ«</strong>: 2åŸå­åˆ†å­ã®å…¨åˆ†é…é–¢æ•°ã‹ã‚‰æŒ¯å‹•-å›è»¢æº–ä½ã®å æœ‰æ•°ã‚’è¨ˆç®—ã—ã€æ¸©åº¦ä¾å­˜æ€§ã‚’å¯è¦–åŒ–ã›ã‚ˆã€‚</li>
            </ol>
        </div>

        <div class="nav-buttons">
            <a href="chapter-1.html" class="nav-button">â† ç¬¬1ç« : çµ±è¨ˆåŠ›å­¦ã®åŸºç¤ã¨ç¢ºç‡è«–</a>
            <a href="chapter-3.html" class="nav-button">ç¬¬3ç« : ã‚°ãƒ©ãƒ³ãƒ‰ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ â†’</a>
        </div>
    </div>
        </div>
    </div>

    <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

<footer>
        <p>&copy; 2025 AI Terakoya - åŸºç¤æ•°ç†é“å ´</p>
    </footer>
</body>
</html>
