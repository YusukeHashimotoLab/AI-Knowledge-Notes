<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« : çµ±è¨ˆåŠ›å­¦ã®åŸºç¤ã¨ç¢ºç‡è«– | FM Dojo - å¤å…¸çµ±è¨ˆåŠ›å­¦å…¥é–€</title>
    <meta name="description" content="çµ±è¨ˆåŠ›å­¦ã®åŸºç¤ï¼šä½ç›¸ç©ºé–“ã€ãƒŸã‚¯ãƒ­çŠ¶æ…‹ã€ç­‰é‡ç‡ã®åŸç†ã€ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã€ãƒŸã‚¯ãƒ­ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã€Maxwellé€Ÿåº¦åˆ†å¸ƒã‚’å­¦ã³ã¾ã™ã€‚">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            line-height: 1.8;
            color: #333;
            background: #f5f5f5;
        }
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 1rem;
            text-align: center;
        }
        .breadcrumb {
            max-width: 1200px;
            margin: 1rem auto;
            padding: 0 1rem;
            font-size: 0.9rem;
        }
        .breadcrumb a { color: #667eea; text-decoration: none; }
        .breadcrumb a:hover { text-decoration: underline; }
        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        .content {
            background: white;
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        h1 { font-size: 2rem; margin-bottom: 1rem; }
        h2 {
            font-size: 1.5rem;
            margin: 2rem 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid #764ba2;
            color: #667eea;
        }
        h3 { font-size: 1.2rem; margin: 1.5rem 0 1rem; color: #555; }
        p { margin-bottom: 1rem; }
        ul, ol { margin: 1rem 0 1rem 2rem; }
        li { margin-bottom: 0.5rem; }
        .theory-box {
            background: linear-gradient(to right, #f0f4ff, #faf5ff);
            border-left: 4px solid #667eea;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        .code-example {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
        }
        .code-title {
            background: #667eea;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 6px 6px 0 0;
            font-weight: 600;
            margin-top: 1.5rem;
        }
        .exercise {
            background: #fff9e6;
            border-left: 4px solid #f59e0b;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            gap: 1rem;
        }
        .nav-button {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: transform 0.3s;
        }
        .nav-button:hover { transform: translateY(-2px); }
        footer {
            background: #2c3e50;
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 4rem;
        }
        @media (max-width: 768px) {
            .content { padding: 1.5rem; }
            h1 { font-size: 1.5rem; }
            h2 { font-size: 1.3rem; }
            .navigation { flex-direction: column; }
        }
    </style>
</head>
<body>
    <header>
        <h1>ğŸ”¥ ç¬¬1ç« : çµ±è¨ˆåŠ›å­¦ã®åŸºç¤ã¨ç¢ºç‡è«–</h1>
        <p>Foundations of Statistical Mechanics and Probability</p>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹</a> &gt;
        <a href="../index.html">FM Dojo</a> &gt;
        <a href="index.html">å¤å…¸çµ±è¨ˆåŠ›å­¦å…¥é–€</a> &gt;
        ç¬¬1ç« 
    </div>

    <div class="container">
        <div class="content">
            <h2>ğŸ¯ å­¦ç¿’ç›®æ¨™</h2>
            <ul>
                <li>ä½ç›¸ç©ºé–“ã¨ãƒŸã‚¯ãƒ­çŠ¶æ…‹ã®æ¦‚å¿µã‚’ç†è§£ã™ã‚‹</li>
                <li>ç­‰é‡ç‡ã®åŸç†ï¼ˆç­‰ç¢ºç‡ã®ä»®å®šï¼‰ã‚’å­¦ã¶</li>
                <li>ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã¨ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®é–¢ä¿‚ã‚’ç†è§£ã™ã‚‹</li>
                <li>Stirlingã®å…¬å¼ã‚’ä½¿ã£ãŸå¤§æ•°ç³»ã®æ‰±ã„ã‚’ç¿’å¾—ã™ã‚‹</li>
                <li>ãƒŸã‚¯ãƒ­ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã®åŸºç¤ã‚’å­¦ã¶</li>
                <li>ç†æƒ³æ°—ä½“ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’è¨ˆç®—ã™ã‚‹</li>
                <li>Maxwellé€Ÿåº¦åˆ†å¸ƒã‚’å°å‡ºã—ã€å¯è¦–åŒ–ã™ã‚‹</li>
                <li>æƒ…å ±ç†è«–ã¨ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®é–¢ä¿‚ã‚’ç†è§£ã™ã‚‹</li>
            </ul>
        </div>

        <div class="content">
            <h2>ğŸ“– çµ±è¨ˆåŠ›å­¦ã¨ã¯</h2>
            
            <div class="theory-box">
                <h3>çµ±è¨ˆåŠ›å­¦ã®ç›®çš„</h3>
                <p><strong>çµ±è¨ˆåŠ›å­¦</strong>ã¯ã€ãƒŸã‚¯ãƒ­ãªç²’å­ã®é›†å›£ï¼ˆ\(10^{23}\)å€‹ç¨‹åº¦ï¼‰ã‹ã‚‰ãƒã‚¯ãƒ­ãªç†±åŠ›å­¦çš„æ€§è³ªã‚’å°å‡ºã™ã‚‹ç†è«–ã§ã™ã€‚</p>
                <p><strong>ãªãœçµ±è¨ˆåŠ›å­¦ãŒå¿…è¦ã‹ï¼Ÿ</strong></p>
                <ul>
                    <li>ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³åŠ›å­¦ã§å…¨ç²’å­ã®é‹å‹•ã‚’è¿½è·¡ã™ã‚‹ã®ã¯å®Ÿè³ªä¸å¯èƒ½ï¼ˆ\(10^{23}\)å€‹ã®æ–¹ç¨‹å¼ï¼‰</li>
                    <li>ã—ã‹ã—ã€ãƒã‚¯ãƒ­ãªç‰©ç†é‡ï¼ˆæ¸©åº¦ã€åœ§åŠ›ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼‰ã¯å†ç¾æ€§ãŒã‚ã‚Šäºˆæ¸¬å¯èƒ½</li>
                    <li>â†’ ãƒŸã‚¯ãƒ­ãªè©³ç´°ã§ã¯ãªãã€<strong>ç¢ºç‡åˆ†å¸ƒ</strong>ã‚’ç”¨ã„ã¦å¹³å‡çš„ãªæŒ¯ã‚‹èˆã„ã‚’è¨˜è¿°</li>
                </ul>
            </div>

            <h3>ä½ç›¸ç©ºé–“ã¨ãƒŸã‚¯ãƒ­çŠ¶æ…‹</h3>
            <p><strong>ä½ç›¸ç©ºé–“ï¼ˆPhase spaceï¼‰</strong>: \(N\)ç²’å­ç³»ã®å…¨çŠ¶æ…‹ã‚’è¨˜è¿°ã™ã‚‹ \(6N\)æ¬¡å…ƒç©ºé–“ï¼ˆä½ç½® \(\mathbf{q}\) ã¨é‹å‹•é‡ \(\mathbf{p}\)ï¼‰</p>
            <p>\[
            \Gamma = (\mathbf{q}_1, \mathbf{p}_1, \mathbf{q}_2, \mathbf{p}_2, \ldots, \mathbf{q}_N, \mathbf{p}_N)
            \]</p>
            <p><strong>ãƒŸã‚¯ãƒ­çŠ¶æ…‹ï¼ˆMicrostateï¼‰</strong>: ä½ç›¸ç©ºé–“ä¸­ã®1ç‚¹ã€‚ç³»ã®å®Œå…¨ãªè¨˜è¿°ã€‚</p>
            <p><strong>ãƒã‚¯ãƒ­çŠ¶æ…‹ï¼ˆMacrostateï¼‰</strong>: ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(E\)ã€ç²’å­æ•° \(N\)ã€ä½“ç© \(V\) ãªã©ã§æŒ‡å®šã•ã‚Œã‚‹å·¨è¦–çš„çŠ¶æ…‹ã€‚å¤šæ•°ã®ãƒŸã‚¯ãƒ­çŠ¶æ…‹ã«å¯¾å¿œã€‚</p>

            <div class="theory-box">
                <h3>ç­‰é‡ç‡ã®åŸç†ï¼ˆPrinciple of Equal a priori Probabilityï¼‰</h3>
                <p>å­¤ç«‹ç³»ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ä¸€å®šï¼‰ã§ã¯ã€<strong>åŒã˜ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã¤ã™ã¹ã¦ã®ãƒŸã‚¯ãƒ­çŠ¶æ…‹ã¯ç­‰ç¢ºç‡ã§å®Ÿç¾ã•ã‚Œã‚‹</strong>ã€‚</p>
                <p>ã“ã‚Œã¯çµ±è¨ˆåŠ›å­¦ã®åŸºæœ¬ä»®å®šã§ã‚ã‚Šã€å®Ÿé¨“äº‹å®Ÿã¨ã‚‚æ•´åˆã—ã¾ã™ã€‚</p>
            </div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ1.1: ä½ç›¸ç©ºé–“ã®å¯è¦–åŒ–ï¼ˆ1æ¬¡å…ƒèª¿å’ŒæŒ¯å‹•å­ï¼‰</h2>
            
            <div class="code-title">Pythonå®Ÿè£…: ä½ç›¸ç©ºé–“è»Œé“</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# 1æ¬¡å…ƒèª¿å’ŒæŒ¯å‹•å­ã®ä½ç›¸ç©ºé–“
# ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³: H = pÂ²/(2m) + (1/2)kqÂ²

m = 1.0  # è³ªé‡
k = 1.0  # ãƒãƒå®šæ•°
omega = np.sqrt(k / m)  # è§’æŒ¯å‹•æ•°

# ã‚¨ãƒãƒ«ã‚®ãƒ¼å›ºå®šã§ã®è»Œé“ï¼ˆæ¥•å††ï¼‰
def phase_space_trajectory(E, m, k, num_points=100):
    """ã‚¨ãƒãƒ«ã‚®ãƒ¼ E ã®ä½ç›¸ç©ºé–“è»Œé“"""
    # q ã®ç¯„å›²: -sqrt(2E/k) ~ sqrt(2E/k)
    q_max = np.sqrt(2 * E / k)
    q = np.linspace(-q_max, q_max, num_points)
    
    # p(q) = Â±sqrt(2m(E - (1/2)kqÂ²))
    p_squared = 2 * m * (E - 0.5 * k * q**2)
    p_squared = np.maximum(p_squared, 0)  # è² ã«ãªã‚‰ãªã„ã‚ˆã†ã«
    p_pos = np.sqrt(p_squared)
    p_neg = -np.sqrt(p_squared)
    
    return q, p_pos, p_neg

# ç•°ãªã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã®è»Œé“
energies = [0.5, 1.0, 2.0, 3.0]
colors = ['blue', 'green', 'orange', 'red']

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# ä½ç›¸ç©ºé–“è»Œé“
ax1 = axes[0]
for E, color in zip(energies, colors):
    q, p_pos, p_neg = phase_space_trajectory(E, m, k)
    ax1.plot(q, p_pos, color=color, linewidth=2, label=f'E = {E:.1f}')
    ax1.plot(q, p_neg, color=color, linewidth=2)

ax1.set_xlabel('Position q')
ax1.set_ylabel('Momentum p')
ax1.set_title('ä½ç›¸ç©ºé–“è»Œé“ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼å›ºå®šï¼‰')
ax1.legend()
ax1.grid(True, alpha=0.3)
ax1.axis('equal')

# æ™‚é–“ç™ºå±•
ax2 = axes[1]
E = 2.0
q0, p0 = np.sqrt(2 * E / k), 0  # åˆæœŸæ¡ä»¶

t = np.linspace(0, 4 * np.pi / omega, 1000)
q_t = q0 * np.cos(omega * t)
p_t = -q0 * m * omega * np.sin(omega * t)

ax2.plot(t, q_t, 'b-', label='Position q(t)', linewidth=2)
ax2.plot(t, p_t, 'r-', label='Momentum p(t)', linewidth=2)
ax2.set_xlabel('Time t')
ax2.set_ylabel('q(t), p(t)')
ax2.set_title(f'æ™‚é–“ç™ºå±•ï¼ˆE = {E}ï¼‰')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_phase_space.png', dpi=300, bbox_inches='tight')
plt.show()

print("=== ä½ç›¸ç©ºé–“ã®æ€§è³ª ===")
print(f"è§’æŒ¯å‹•æ•° Ï‰ = {omega:.4f}")
print(f"å‘¨æœŸ T = {2*np.pi/omega:.4f}")
print("\nä½ç›¸ç©ºé–“è»Œé“ã¯ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¸€å®šã§æ¥•å††ã‚’æãã¾ã™ã€‚")
print("ã“ã‚ŒãŒã€ŒãƒŸã‚¯ãƒ­çŠ¶æ…‹ã€ã®é›†åˆã‚’è¡¨ã—ã¾ã™ã€‚")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ1.2: ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã®å°å‡º</h2>
            
            <div class="theory-box">
                <h3>ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒ</h3>
                <p>æ¸©åº¦ \(T\) ã®ç†±æµ´ã¨æ¥è§¦ã™ã‚‹ç³»ã«ãŠã„ã¦ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(E_i\) ã®çŠ¶æ…‹ \(i\) ãŒå®Ÿç¾ã•ã‚Œã‚‹ç¢ºç‡ã¯ï¼š</p>
                <p>\[
                P_i = \frac{1}{Z} e^{-\beta E_i}, \quad \beta = \frac{1}{k_B T}
                \]</p>
                <p>ã“ã“ã§ \(Z\) ã¯åˆ†é…é–¢æ•°ï¼ˆpartition functionï¼‰ï¼š</p>
                <p>\[
                Z = \sum_i e^{-\beta E_i}
                \]</p>
                <p>\(k_B = 1.380649 \times 10^{-23}\) J/K ã¯ãƒœãƒ«ãƒ„ãƒãƒ³å®šæ•°ã§ã™ã€‚</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã®å¯è¦–åŒ–</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# ãƒœãƒ«ãƒ„ãƒãƒ³å®šæ•°
k_B = 1.380649e-23  # J/K

# é›¢æ•£ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ç³»ï¼ˆä¾‹: ç­‰é–“éš”æº–ä½ï¼‰
n_levels = 10
energy_spacing = 1e-21  # Jï¼ˆç´„0.6 meVï¼‰
E_levels = np.arange(n_levels) * energy_spacing

def boltzmann_distribution(E_levels, T, k_B):
    """ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒ"""
    beta = 1 / (k_B * T)
    exp_factors = np.exp(-beta * E_levels)
    Z = np.sum(exp_factors)
    P = exp_factors / Z
    return P, Z

# ç•°ãªã‚‹æ¸©åº¦ã§ã®åˆ†å¸ƒ
temperatures = [100, 300, 500, 1000]  # K
colors = ['blue', 'green', 'orange', 'red']

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒ
ax1 = axes[0]
for T, color in zip(temperatures, colors):
    P, Z = boltzmann_distribution(E_levels, T, k_B)
    ax1.plot(E_levels / 1e-21, P, 'o-', color=color, linewidth=2, 
             markersize=6, label=f'T = {T} K')

ax1.set_xlabel('Energy (10â»Â²Â¹ J)')
ax1.set_ylabel('Probability P(E)')
ax1.set_title('ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒï¼ˆæ¸©åº¦ä¾å­˜ï¼‰')
ax1.legend()
ax1.grid(True, alpha=0.3)

# å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼
ax2 = axes[1]
T_range = np.linspace(50, 1000, 100)
avg_energies = []
for T in T_range:
    P, Z = boltzmann_distribution(E_levels, T, k_B)
    avg_E = np.sum(P * E_levels)
    avg_energies.append(avg_E)

ax2.plot(T_range, np.array(avg_energies) / 1e-21, 'b-', linewidth=2)
ax2.set_xlabel('Temperature (K)')
ax2.set_ylabel('Average Energy (10â»Â²Â¹ J)')
ax2.set_title('å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®æ¸©åº¦ä¾å­˜æ€§')
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_boltzmann_distribution.png', dpi=300, bbox_inches='tight')
plt.show()

# æ•°å€¤çµæœ
print("=== ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã®è§£æ ===")
for T in temperatures:
    P, Z = boltzmann_distribution(E_levels, T, k_B)
    avg_E = np.sum(P * E_levels)
    print(f"\nT = {T} K:")
    print(f"  åˆ†é…é–¢æ•° Z = {Z:.4f}")
    print(f"  å¹³å‡ã‚¨ãƒãƒ«ã‚®ãƒ¼ <E> = {avg_E/1e-21:.4f} Ã— 10â»Â²Â¹ J")
    print(f"  åŸºåº•çŠ¶æ…‹å æœ‰ç‡ P(E=0) = {P[0]:.4f}")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ1.3: Stirlingã®å…¬å¼</h2>
            
            <div class="theory-box">
                <h3>Stirlingã®å…¬å¼</h3>
                <p>å¤§ããª \(N\) ã«å¯¾ã—ã¦ï¼š</p>
                <p>\[
                \ln N! \approx N \ln N - N
                \]</p>
                <p>ã•ã‚‰ã«ç²¾å¯†ã«ã¯ï¼š</p>
                <p>\[
                \ln N! \approx N \ln N - N + \frac{1}{2} \ln(2\pi N)
                \]</p>
                <p>çµ±è¨ˆåŠ›å­¦ã§ã¯ \(N \sim 10^{23}\) ãªã®ã§ã€Stirlingã®å…¬å¼ãŒæ¥µã‚ã¦æœ‰ç”¨ã§ã™ã€‚</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: Stirlingã®å…¬å¼ã®ç²¾åº¦æ¤œè¨¼</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import factorial, gammaln

# Stirlingã®å…¬å¼ã®æ¯”è¼ƒ
N_values = np.arange(1, 101)

# å³å¯†ãªå€¤
ln_factorial_exact = gammaln(N_values + 1)

# Stirlingã®å…¬å¼ï¼ˆç°¡æ˜“ç‰ˆï¼‰
ln_factorial_stirling_simple = N_values * np.log(N_values) - N_values

# Stirlingã®å…¬å¼ï¼ˆç²¾å¯†ç‰ˆï¼‰
ln_factorial_stirling_precise = N_values * np.log(N_values) - N_values + \
                                  0.5 * np.log(2 * np.pi * N_values)

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# å¯¾æ•°éšä¹—ã®æ¯”è¼ƒ
ax1 = axes[0]
ax1.plot(N_values, ln_factorial_exact, 'k-', label='Exact ln(N!)', linewidth=2)
ax1.plot(N_values, ln_factorial_stirling_simple, 'b--', 
         label='Stirling (simple)', linewidth=2)
ax1.plot(N_values, ln_factorial_stirling_precise, 'r:', 
         label='Stirling (precise)', linewidth=2)
ax1.set_xlabel('N')
ax1.set_ylabel('ln(N!)')
ax1.set_title('Stirlingã®å…¬å¼ã®æ¯”è¼ƒ')
ax1.legend()
ax1.grid(True, alpha=0.3)

# ç›¸å¯¾èª¤å·®
ax2 = axes[1]
rel_error_simple = np.abs((ln_factorial_stirling_simple - ln_factorial_exact) / ln_factorial_exact)
rel_error_precise = np.abs((ln_factorial_stirling_precise - ln_factorial_exact) / ln_factorial_exact)

ax2.semilogy(N_values, rel_error_simple, 'b--', label='Simple', linewidth=2)
ax2.semilogy(N_values, rel_error_precise, 'r:', label='Precise', linewidth=2)
ax2.set_xlabel('N')
ax2.set_ylabel('Relative error')
ax2.set_title('Stirlingã®å…¬å¼ã®ç›¸å¯¾èª¤å·®')
ax2.legend()
ax2.grid(True, alpha=0.3, which='both')

plt.tight_layout()
plt.savefig('stat_mech_stirling.png', dpi=300, bbox_inches='tight')
plt.show()

# å¤§ããªNã§ã®æ¤œè¨¼
N_large = [100, 1000, 10000, 100000]
print("=== Stirlingã®å…¬å¼ã®ç²¾åº¦ï¼ˆå¤§ããªNï¼‰===\n")
for N in N_large:
    ln_exact = gammaln(N + 1)
    ln_stirling = N * np.log(N) - N + 0.5 * np.log(2 * np.pi * N)
    rel_error = np.abs((ln_stirling - ln_exact) / ln_exact)
    
    print(f"N = {N}:")
    print(f"  ln(N!) (exact) = {ln_exact:.6e}")
    print(f"  ln(N!) (Stirling) = {ln_stirling:.6e}")
    print(f"  Relative error = {rel_error:.6e}\n")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ1.4: ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¨ãƒœãƒ«ãƒ„ãƒãƒ³ã®é–¢ä¿‚å¼</h2>
            
            <div class="theory-box">
                <h3>ãƒœãƒ«ãƒ„ãƒãƒ³ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</h3>
                <p>ãƒã‚¯ãƒ­çŠ¶æ…‹ã«å¯¾å¿œã™ã‚‹ãƒŸã‚¯ãƒ­çŠ¶æ…‹ã®æ•°ã‚’ \(\Omega\) ã¨ã™ã‚‹ã¨ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ \(S\) ã¯ï¼š</p>
                <p>\[
                S = k_B \ln \Omega
                \]</p>
                <p>ã“ã‚Œã¯<strong>ãƒœãƒ«ãƒ„ãƒãƒ³ã®é–¢ä¿‚å¼</strong>ã¨å‘¼ã°ã‚Œã€çµ±è¨ˆåŠ›å­¦ã¨ç†±åŠ›å­¦ã‚’çµã³ã¤ã‘ã¾ã™ã€‚</p>
                <p>\(\Omega\) ãŒå¤§ãã„ã»ã©ï¼ˆãƒŸã‚¯ãƒ­çŠ¶æ…‹ãŒå¤šã„ã»ã©ï¼‰ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒå¤§ãã„ã€‚</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: ã‚³ã‚¤ãƒ³æŠ•ã’ã¨ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import comb

# Nå€‹ã®ã‚³ã‚¤ãƒ³ã‚’æŠ•ã’ãŸæ™‚ã®çŠ¶æ…‹æ•°
# ãƒã‚¯ãƒ­çŠ¶æ…‹: è¡¨ãŒnå€‹
# ãƒŸã‚¯ãƒ­çŠ¶æ…‹æ•°: Î©(n) = C(N, n) = N! / (n!(N-n)!)

k_B = 1.380649e-23  # J/K

def microstate_count(N, n):
    """Nå€‹ã®ã‚³ã‚¤ãƒ³ä¸­ã€nå€‹ãŒè¡¨ã¨ãªã‚‹ãƒŸã‚¯ãƒ­çŠ¶æ…‹æ•°"""
    return comb(N, n, exact=True)

def entropy(N, n, k_B):
    """ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ S = k_B ln(Î©)"""
    Omega = microstate_count(N, n)
    return k_B * np.log(Omega)

# N = 100 ã®ã‚³ã‚¤ãƒ³
N = 100
n_values = np.arange(N + 1)
Omega_values = [microstate_count(N, n) for n in n_values]
S_values = [entropy(N, n, k_B) for n in n_values]

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# ãƒŸã‚¯ãƒ­çŠ¶æ…‹æ•°
ax1 = axes[0]
ax1.semilogy(n_values, Omega_values, 'b-', linewidth=2)
ax1.axvline(N/2, color='r', linestyle='--', linewidth=2, label=f'n = N/2 (æœ€å¤§)')
ax1.set_xlabel('Number of heads (n)')
ax1.set_ylabel('Number of microstates Î©(n)')
ax1.set_title(f'ãƒŸã‚¯ãƒ­çŠ¶æ…‹æ•°ï¼ˆN = {N}ï¼‰')
ax1.legend()
ax1.grid(True, alpha=0.3)

# ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼
ax2 = axes[1]
ax2.plot(n_values, np.array(S_values) / k_B, 'g-', linewidth=2)
ax2.axvline(N/2, color='r', linestyle='--', linewidth=2, label=f'n = N/2 (æœ€å¤§)')
ax2.set_xlabel('Number of heads (n)')
ax2.set_ylabel('Entropy S/k_B')
ax2.set_title(f'ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆN = {N}ï¼‰')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_entropy_coins.png', dpi=300, bbox_inches='tight')
plt.show()

# æœ€å¤§ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼çŠ¶æ…‹
n_max = N // 2
Omega_max = microstate_count(N, n_max)
S_max = entropy(N, n_max, k_B)

print(f"=== ã‚³ã‚¤ãƒ³æŠ•ã’ã¨ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆN = {N}ï¼‰===")
print(f"æœ€ã‚‚ã‚ã‚Šãã†ãªçŠ¶æ…‹: n = {n_max}ï¼ˆè¡¨ãŒåŠåˆ†ï¼‰")
print(f"  ãƒŸã‚¯ãƒ­çŠ¶æ…‹æ•° Î© = {Omega_max:.6e}")
print(f"  ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ S = {S_max:.6e} J/K")
print(f"  S/k_B = {S_max/k_B:.4f}")
print(f"\nã™ã¹ã¦è¡¨ï¼ˆn={N}ï¼‰:")
print(f"  ãƒŸã‚¯ãƒ­çŠ¶æ…‹æ•° Î© = 1")
print(f"  ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ S = 0")
print("\nâ†’ æœ€ã‚‚ç„¡ç§©åºãªçŠ¶æ…‹ï¼ˆn=N/2ï¼‰ãŒæœ€å¤§ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’æŒã¤")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ1.5: ãƒŸã‚¯ãƒ­ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã¨ç†æƒ³æ°—ä½“ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</h2>
            
            <div class="theory-box">
                <h3>ãƒŸã‚¯ãƒ­ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£</h3>
                <p>ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(E\)ã€ç²’å­æ•° \(N\)ã€ä½“ç© \(V\) ãŒå›ºå®šã•ã‚ŒãŸå­¤ç«‹ç³»ã€‚</p>
                <p>ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼:</p>
                <p>\[
                S(E, V, N) = k_B \ln \Omega(E, V, N)
                \]</p>
                <p>ç†æƒ³æ°—ä½“ã®å ´åˆï¼ˆSackur-Tetrodeå¼ï¼‰:</p>
                <p>\[
                S = N k_B \left[\ln\left(\frac{V}{N}\left(\frac{2\pi m k_B T}{h^2}\right)^{3/2}\right) + \frac{5}{2}\right]
                \]</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: ç†æƒ³æ°—ä½“ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# ç‰©ç†å®šæ•°
k_B = 1.380649e-23  # J/K
h = 6.62607015e-34  # JÂ·s
m_Ar = 6.63e-26  # AråŸå­ã®è³ªé‡ (kg)

def sackur_tetrode_entropy(N, V, T, m, k_B, h):
    """Sackur-Tetrodeå¼ã«ã‚ˆã‚‹ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼"""
    thermal_wavelength = h / np.sqrt(2 * np.pi * m * k_B * T)
    entropy_per_particle = k_B * (np.log(V / (N * thermal_wavelength**3)) + 5/2)
    return N * entropy_per_particle

# Arã‚¬ã‚¹ 1 mol
N_A = 6.022e23  # ã‚¢ãƒœã‚¬ãƒ‰ãƒ­æ•°
N = N_A

# ä½“ç©ä¾å­˜æ€§ï¼ˆæ¸©åº¦å›ºå®šï¼‰
T = 300  # K
V_range = np.linspace(0.001, 0.1, 100)  # mÂ³
S_vs_V = [sackur_tetrode_entropy(N, V, T, m_Ar, k_B, h) for V in V_range]

# æ¸©åº¦ä¾å­˜æ€§ï¼ˆä½“ç©å›ºå®šï¼‰
V = 0.0224  # mÂ³ (æ¨™æº–çŠ¶æ…‹ã§1 mol)
T_range = np.linspace(100, 1000, 100)  # K
S_vs_T = [sackur_tetrode_entropy(N, V, T, m_Ar, k_B, h) for T in T_range]

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# ä½“ç©ä¾å­˜æ€§
ax1 = axes[0]
ax1.plot(V_range * 1000, np.array(S_vs_V) / N, 'b-', linewidth=2)
ax1.set_xlabel('Volume (L)')
ax1.set_ylabel('Entropy per particle (J/K)')
ax1.set_title(f'ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®ä½“ç©ä¾å­˜æ€§ï¼ˆT = {T} Kï¼‰')
ax1.grid(True, alpha=0.3)

# æ¸©åº¦ä¾å­˜æ€§
ax2 = axes[1]
ax2.plot(T_range, np.array(S_vs_T) / N, 'r-', linewidth=2)
ax2.set_xlabel('Temperature (K)')
ax2.set_ylabel('Entropy per particle (J/K)')
ax2.set_title(f'ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®æ¸©åº¦ä¾å­˜æ€§ï¼ˆV = {V*1000:.1f} Lï¼‰')
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_sackur_tetrode.png', dpi=300, bbox_inches='tight')
plt.show()

# æ¨™æº–çŠ¶æ…‹ã§ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼
T_std = 298.15  # K
V_std = 0.0224  # mÂ³
S_std = sackur_tetrode_entropy(N, V_std, T_std, m_Ar, k_B, h)
S_molar = S_std / N_A  # ãƒ¢ãƒ«ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼

print("=== ç†æƒ³æ°—ä½“ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆAr, 1 molï¼‰===")
print(f"æ¨™æº–çŠ¶æ…‹ï¼ˆT = {T_std} K, V = {V_std*1000:.1f} Lï¼‰:")
print(f"  ãƒ¢ãƒ«ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ S = {S_molar:.6e} J/(KÂ·mol)")
print(f"  S = {S_molar:.2f} J/(KÂ·mol)")
print(f"\nå®Ÿé¨“å€¤ã¨ã®æ¯”è¼ƒï¼ˆArï¼‰: ~154.8 J/(KÂ·mol)")
print(f"ç†è«–å€¤: {S_molar:.1f} J/(KÂ·mol)")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ1.6: Maxwellé€Ÿåº¦åˆ†å¸ƒã®å°å‡º</h2>
            
            <div class="theory-box">
                <h3>Maxwellé€Ÿåº¦åˆ†å¸ƒ</h3>
                <p>ç†æƒ³æ°—ä½“ä¸­ã®ç²’å­ã®é€Ÿã• \(v\) ã®ç¢ºç‡åˆ†å¸ƒï¼š</p>
                <p>\[
                f(v) = 4\pi \left(\frac{m}{2\pi k_B T}\right)^{3/2} v^2 e^{-\frac{mv^2}{2k_B T}}
                \]</p>
                <p>æœ€ç¢ºé€Ÿåº¦ï¼ˆmost probable speedï¼‰:</p>
                <p>\[
                v_{\text{mp}} = \sqrt{\frac{2k_B T}{m}}
                \]</p>
                <p>å¹³å‡é€Ÿåº¦:</p>
                <p>\[
                \langle v \rangle = \sqrt{\frac{8k_B T}{\pi m}}
                \]</p>
                <p>äºŒä¹—å¹³å‡é€Ÿåº¦ï¼ˆroot-mean-square speedï¼‰:</p>
                <p>\[
                v_{\text{rms}} = \sqrt{\langle v^2 \rangle} = \sqrt{\frac{3k_B T}{m}}
                \]</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: Maxwellé€Ÿåº¦åˆ†å¸ƒ</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import quad

# ç‰©ç†å®šæ•°
k_B = 1.380649e-23  # J/K
m_N2 = 4.65e-26  # Nâ‚‚åˆ†å­ã®è³ªé‡ (kg)

def maxwell_speed_distribution(v, m, T, k_B):
    """Maxwellé€Ÿåº¦åˆ†å¸ƒ"""
    factor = 4 * np.pi * (m / (2 * np.pi * k_B * T))**(3/2)
    return factor * v**2 * np.exp(-m * v**2 / (2 * k_B * T))

def most_probable_speed(m, T, k_B):
    """æœ€ç¢ºé€Ÿåº¦"""
    return np.sqrt(2 * k_B * T / m)

def mean_speed(m, T, k_B):
    """å¹³å‡é€Ÿåº¦"""
    return np.sqrt(8 * k_B * T / (np.pi * m))

def rms_speed(m, T, k_B):
    """äºŒä¹—å¹³å‡é€Ÿåº¦"""
    return np.sqrt(3 * k_B * T / m)

# Nâ‚‚ã‚¬ã‚¹
temperatures = [200, 300, 500, 800]  # K
colors = ['blue', 'green', 'orange', 'red']

v_range = np.linspace(0, 2000, 1000)  # m/s

fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# Maxwellåˆ†å¸ƒ
ax1 = axes[0]
for T, color in zip(temperatures, colors):
    f_v = maxwell_speed_distribution(v_range, m_N2, T, k_B)
    ax1.plot(v_range, f_v, color=color, linewidth=2, label=f'T = {T} K')
    
    # æœ€ç¢ºé€Ÿåº¦ã‚’ãƒãƒ¼ã‚¯
    v_mp = most_probable_speed(m_N2, T, k_B)
    f_mp = maxwell_speed_distribution(v_mp, m_N2, T, k_B)
    ax1.plot(v_mp, f_mp, 'o', color=color, markersize=8)

ax1.set_xlabel('Speed v (m/s)')
ax1.set_ylabel('Probability density f(v)')
ax1.set_title('Maxwellé€Ÿåº¦åˆ†å¸ƒï¼ˆNâ‚‚ï¼‰')
ax1.legend()
ax1.grid(True, alpha=0.3)

# ç‰¹æ€§é€Ÿåº¦ã®æ¸©åº¦ä¾å­˜æ€§
ax2 = axes[1]
T_range = np.linspace(100, 1000, 100)
v_mp_array = [most_probable_speed(m_N2, T, k_B) for T in T_range]
v_mean_array = [mean_speed(m_N2, T, k_B) for T in T_range]
v_rms_array = [rms_speed(m_N2, T, k_B) for T in T_range]

ax2.plot(T_range, v_mp_array, 'b-', linewidth=2, label='Most probable')
ax2.plot(T_range, v_mean_array, 'g-', linewidth=2, label='Mean')
ax2.plot(T_range, v_rms_array, 'r-', linewidth=2, label='RMS')
ax2.set_xlabel('Temperature (K)')
ax2.set_ylabel('Speed (m/s)')
ax2.set_title('ç‰¹æ€§é€Ÿåº¦ã®æ¸©åº¦ä¾å­˜æ€§')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_maxwell_distribution.png', dpi=300, bbox_inches='tight')
plt.show()

# æ•°å€¤çµæœ
print("=== Maxwellé€Ÿåº¦åˆ†å¸ƒï¼ˆNâ‚‚ at 300 Kï¼‰===")
T = 300
v_mp = most_probable_speed(m_N2, T, k_B)
v_mean = mean_speed(m_N2, T, k_B)
v_rms = rms_speed(m_N2, T, k_B)

print(f"æœ€ç¢ºé€Ÿåº¦: {v_mp:.1f} m/s")
print(f"å¹³å‡é€Ÿåº¦: {v_mean:.1f} m/s")
print(f"äºŒä¹—å¹³å‡é€Ÿåº¦: {v_rms:.1f} m/s")
print(f"\næ¯”ç‡:")
print(f"  v_mp : v_mean : v_rms = {v_mp/v_mp:.3f} : {v_mean/v_mp:.3f} : {v_rms/v_mp:.3f}")
print(f"  ç†è«–æ¯”: 1 : {np.sqrt(8/(2*np.pi)):.3f} : {np.sqrt(3/2):.3f}")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ1.7: æƒ…å ±ç†è«–ã¨ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</h2>
            
            <div class="theory-box">
                <h3>Shannonã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</h3>
                <p>æƒ…å ±ç†è«–ã«ãŠã‘ã‚‹ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆä¸ç¢ºå®Ÿæ€§ã®å°ºåº¦ï¼‰ï¼š</p>
                <p>\[
                H = -\sum_i p_i \ln p_i
                \]</p>
                <p>çµ±è¨ˆåŠ›å­¦ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¨ã®é–¢ä¿‚:</p>
                <p>\[
                S = k_B H
                \]</p>
                <p>æœ€å¤§ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åŸç†: åˆ¶ç´„æ¡ä»¶ã®ã‚‚ã¨ã§ã€ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒæœ€å¤§ã¨ãªã‚‹åˆ†å¸ƒãŒå¹³è¡¡åˆ†å¸ƒã€‚</p>
            </div>

            <div class="code-title">Pythonå®Ÿè£…: Shannonã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¨ç¢ºç‡åˆ†å¸ƒ</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

def shannon_entropy(p):
    """Shannonã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ H = -Î£ p_i ln(p_i)"""
    p = np.array(p)
    p = p[p > 0]  # ã‚¼ãƒ­ã‚’é™¤å¤–ï¼ˆlog(0)ã‚’é¿ã‘ã‚‹ï¼‰
    return -np.sum(p * np.log(p))

# ç•°ãªã‚‹ç¢ºç‡åˆ†å¸ƒ
n = 10  # çŠ¶æ…‹æ•°

# 1. å‡ç­‰åˆ†å¸ƒ
p_uniform = np.ones(n) / n

# 2. åã£ãŸåˆ†å¸ƒ
p_biased = np.array([0.5] + [0.5/(n-1)] * (n-1))

# 3. æ¥µç«¯ãªåˆ†å¸ƒ
p_extreme = np.zeros(n)
p_extreme[0] = 1.0

# 4. ä¸­é–“çš„ãªåˆ†å¸ƒ
p_moderate = np.exp(-np.arange(n) * 0.5)
p_moderate /= np.sum(p_moderate)

distributions = {
    'Uniform': p_uniform,
    'Biased': p_biased,
    'Extreme (deterministic)': p_extreme,
    'Moderate (exponential)': p_moderate
}

# ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼è¨ˆç®—
entropies = {name: shannon_entropy(p) for name, p in distributions.items()}

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 10))
axes = axes.ravel()

for i, (name, p) in enumerate(distributions.items()):
    ax = axes[i]
    ax.bar(range(n), p, color='skyblue', edgecolor='black', alpha=0.7)
    ax.set_xlabel('State')
    ax.set_ylabel('Probability')
    ax.set_title(f'{name}\nH = {entropies[name]:.4f}')
    ax.set_ylim([0, 1.0])
    ax.grid(True, axis='y', alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_shannon_entropy.png', dpi=300, bbox_inches='tight')
plt.show()

# çµæœ
print("=== Shannonã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã®æ¯”è¼ƒ ===\n")
for name, H in entropies.items():
    print(f"{name}:")
    print(f"  H = {H:.6f}")
    print(f"  æœ€å¤§ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼æ¯”: {H / np.log(n) * 100:.2f}%\n")

print(f"æœ€å¤§ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆå‡ç­‰åˆ†å¸ƒï¼‰: H_max = ln({n}) = {np.log(n):.6f}")
print("\nâ†’ å‡ç­‰åˆ†å¸ƒãŒæœ€å¤§ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’æŒã¤ï¼ˆæœ€ã‚‚ä¸ç¢ºå®Ÿï¼‰")
print("â†’ æ±ºå®šè«–çš„åˆ†å¸ƒï¼ˆ1çŠ¶æ…‹ã«é›†ä¸­ï¼‰ã¯ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚¼ãƒ­ï¼ˆå®Œå…¨ã«ç¢ºå®Ÿï¼‰")
</div>
        </div>

        <div class="content">
            <h2>ğŸ’» ä¾‹é¡Œ1.8: ææ–™ç§‘å­¦å¿œç”¨ - åˆé‡‘ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</h2>
            
            <div class="code-title">Pythonå®Ÿè£…: é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆæ··åˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼‰</div>
            <div class="code-example">import numpy as np
import matplotlib.pyplot as plt

# 2å…ƒåˆé‡‘ A-B ã®é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼
# Nå€‹ã®åŸå­ã‚µã‚¤ãƒˆä¸Šã«ã€N_Aå€‹ã®AåŸå­ã¨N_Bå€‹ã®BåŸå­
# é…ç½®ã®æ•°: Î© = N! / (N_A! N_B!)
# ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: S = k_B ln(Î©)

k_B = 1.380649e-23  # J/K
N_A_avogadro = 6.022e23  # ã‚¢ãƒœã‚¬ãƒ‰ãƒ­æ•°

def configurational_entropy_per_site(x_A, k_B):
    """å˜ä½ã‚µã‚¤ãƒˆã‚ãŸã‚Šã®é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼"""
    x_B = 1 - x_A
    if x_A == 0 or x_A == 1:
        return 0
    return -k_B * (x_A * np.log(x_A) + x_B * np.log(x_B))

def mixing_entropy_molar(x_A):
    """ãƒ¢ãƒ«æ··åˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆR = N_A * k_Bï¼‰"""
    R = 8.314  # J/(KÂ·mol)
    x_B = 1 - x_A
    if x_A == 0 or x_A == 1:
        return 0
    return -R * (x_A * np.log(x_A) + x_B * np.log(x_B))

# çµ„æˆç¯„å›²
x_A_range = np.linspace(0.001, 0.999, 1000)
S_config = [configurational_entropy_per_site(x, k_B) for x in x_A_range]
S_mixing_molar = [mixing_entropy_molar(x) for x in x_A_range]

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# å˜ä½ã‚µã‚¤ãƒˆã‚ãŸã‚Šã®é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼
ax1 = axes[0]
ax1.plot(x_A_range, np.array(S_config) / k_B, 'b-', linewidth=2)
ax1.axvline(0.5, color='r', linestyle='--', linewidth=1.5, label='x_A = 0.5 (æœ€å¤§)')
ax1.set_xlabel('Composition x_A')
ax1.set_ylabel('Configurational entropy per site (S/k_B)')
ax1.set_title('é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆå˜ä½ã‚µã‚¤ãƒˆï¼‰')
ax1.legend()
ax1.grid(True, alpha=0.3)

# ãƒ¢ãƒ«æ··åˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼
ax2 = axes[1]
ax2.plot(x_A_range, S_mixing_molar, 'g-', linewidth=2)
ax2.axvline(0.5, color='r', linestyle='--', linewidth=1.5, label='x_A = 0.5 (æœ€å¤§)')
ax2.set_xlabel('Composition x_A')
ax2.set_ylabel('Mixing entropy (J/(KÂ·mol))')
ax2.set_title('ãƒ¢ãƒ«æ··åˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('stat_mech_alloy_entropy.png', dpi=300, bbox_inches='tight')
plt.show()

# ç‰¹å®šçµ„æˆã§ã®å€¤
compositions = [0.1, 0.3, 0.5, 0.7, 0.9]
print("=== åˆé‡‘ã®é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ ===\n")
for x_A in compositions:
    S_per_site = configurational_entropy_per_site(x_A, k_B)
    S_molar = mixing_entropy_molar(x_A)
    print(f"çµ„æˆ x_A = {x_A:.1f}:")
    print(f"  é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆper siteï¼‰: {S_per_site/k_B:.4f} k_B")
    print(f"  ãƒ¢ãƒ«æ··åˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼: {S_molar:.4f} J/(KÂ·mol)\n")

S_max = mixing_entropy_molar(0.5)
print(f"æœ€å¤§æ··åˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼ˆx_A = 0.5ï¼‰: {S_max:.4f} J/(KÂ·mol)")
print(f"ç†è«–å€¤ R ln(2) = {8.314 * np.log(2):.4f} J/(KÂ·mol)")
print("\nâ†’ ç­‰çµ„æˆï¼ˆ50:50ï¼‰ã§æ··åˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒæœ€å¤§")
print("â†’ é«˜ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰ã®è¨­è¨ˆåŸç†ã«é–¢é€£")
</div>
        </div>

        <div class="content">
            <h2>ğŸ“š ã¾ã¨ã‚</h2>
            <ul>
                <li><strong>ä½ç›¸ç©ºé–“</strong>ã¯ç³»ã®å…¨ãƒŸã‚¯ãƒ­çŠ¶æ…‹ã‚’è¨˜è¿°ã—ã€ç­‰é‡ç‡ã®åŸç†ãŒçµ±è¨ˆåŠ›å­¦ã®åŸºç¤</li>
                <li><strong>ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒ</strong>ã¯æ¸©åº¦ \(T\) ã§ã®å¹³è¡¡çŠ¶æ…‹ã®ç¢ºç‡åˆ†å¸ƒã‚’ä¸ãˆã‚‹</li>
                <li><strong>Stirlingã®å…¬å¼</strong>ã«ã‚ˆã‚Šå¤§æ•°ç³»ï¼ˆ\(N \sim 10^{23}\)ï¼‰ã®éšä¹—ã‚’è¿‘ä¼¼è¨ˆç®—å¯èƒ½</li>
                <li><strong>ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</strong> \(S = k_B \ln \Omega\) ã¯ãƒŸã‚¯ãƒ­çŠ¶æ…‹æ•°ã¨çµã³ã¤ãã€ä¸ç¢ºå®Ÿæ€§ã®å°ºåº¦</li>
                <li><strong>ãƒŸã‚¯ãƒ­ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£</strong>ã¯å­¤ç«‹ç³»ã‚’è¨˜è¿°ã—ã€Sackur-Tetrodeå¼ã§ç†æƒ³æ°—ä½“ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ãŒå¾—ã‚‰ã‚Œã‚‹</li>
                <li><strong>Maxwellé€Ÿåº¦åˆ†å¸ƒ</strong>ã¯ç†æƒ³æ°—ä½“ã®é€Ÿåº¦åˆ†å¸ƒã‚’ä¸ãˆã€æ¸©åº¦ã¨è³ªé‡ã«ä¾å­˜</li>
                <li><strong>Shannonã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</strong>ã¯æƒ…å ±ç†è«–ã¨çµ±è¨ˆåŠ›å­¦ã‚’çµã³ã¤ã‘ã‚‹</li>
                <li>åˆé‡‘ã®<strong>é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</strong>ã¯ææ–™è¨­è¨ˆï¼ˆé«˜ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼‰ã«é‡è¦</li>
            </ul>
        </div>

        <div class="exercise">
            <h3>ğŸ’¡ æ¼”ç¿’å•é¡Œ</h3>
            <ol>
                <li><strong>ä½ç›¸ç©ºé–“ä½“ç©</strong>: 2æ¬¡å…ƒèª¿å’ŒæŒ¯å‹•å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ \(E\) ä»¥ä¸‹ã®ä½ç›¸ç©ºé–“ä½“ç©ã‚’è¨ˆç®—ã›ã‚ˆã€‚</li>
                <li><strong>ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã®æ¤œè¨¼</strong>: 3æº–ä½ç³»ï¼ˆEâ‚€=0, Eâ‚=Îµ, Eâ‚‚=2Îµï¼‰ã§ãƒœãƒ«ãƒ„ãƒãƒ³åˆ†å¸ƒã‚’è¨ˆç®—ã—ã€é«˜æ¸©ãƒ»ä½æ¸©æ¥µé™ã§ã®æŒ¯ã‚‹èˆã„ã‚’èª¿ã¹ã‚ˆã€‚</li>
                <li><strong>Stirlingè¿‘ä¼¼ã®æ”¹è‰¯</strong>: Stirlingã®å…¬å¼ã®æ¬¡ã®é … \(\ln N! \approx N\ln N - N + \frac{1}{2}\ln(2\pi N) + \frac{1}{12N}\) ã‚’å«ã‚ã¦ç²¾åº¦ã‚’æ¯”è¼ƒã›ã‚ˆã€‚</li>
                <li><strong>Maxwellåˆ†å¸ƒã®æ¤œè¨¼</strong>: é€Ÿåº¦ç©ºé–“ã§ã®ç©åˆ† \(\int_0^\infty f(v) dv = 1\) ã‚’æ•°å€¤çš„ã«ç¢ºèªã›ã‚ˆã€‚</li>
                <li><strong>3å…ƒåˆé‡‘ã®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼</strong>: A-B-C 3å…ƒåˆé‡‘ã®é…ç½®ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’ \(x_A + x_B + x_C = 1\) ã®åˆ¶ç´„ã®ã‚‚ã¨ã§è¨ˆç®—ã—ã€3æ¬¡å…ƒãƒ—ãƒ­ãƒƒãƒˆã›ã‚ˆã€‚</li>
            </ol>
        </div>

        <div class="navigation">
            <a href="index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºTOP</a>
            <a href="chapter-2.html" class="nav-button">ç¬¬2ç« : ã‚«ãƒãƒ‹ã‚«ãƒ«é›†å›£ã¨åˆ†é…é–¢æ•° â†’</a>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 AI Terakoya - Classical Statistical Mechanics</p>
    </footer>
</body>
</html>
