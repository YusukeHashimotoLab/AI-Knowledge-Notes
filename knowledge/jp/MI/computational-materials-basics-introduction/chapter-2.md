---
title: ç¬¬2ç« ï¼šå¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰å…¥é–€
chapter_title: ç¬¬2ç« ï¼šå¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰å…¥é–€
subtitle: å¤šé›»å­ç³»ã®ç¬¬ä¸€åŸç†è¨ˆç®—ã®å®Ÿè·µ
reading_time: 20-25åˆ†
difficulty: ä¸­ç´šã€œä¸Šç´š
code_examples: 8
exercises: 0
---

# ç¬¬2ç« ï¼šå¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰å…¥é–€

Kohnâ€“Shamã®è€ƒãˆæ–¹ã¨äº¤æ›ç›¸é–¢ã®æ„å‘³ã‚’â€œã–ã£ãã‚Šâ€ç†è§£ã—ã¾ã™ã€‚å®Ÿå‹™ã§åŠ¹ãè¿‘ä¼¼ã¨æ³¨æ„ç‚¹ã‚’å­¦ã³ã¾ã™ã€‚

**ğŸ’¡ è£œè¶³:** äº¤æ›ç›¸é–¢ã¯â€œé›»å­åŒå£«ã®æ°—é£ã„â€ã®è¦ç´„ã€‚ç³»ã«åˆã†æ±é–¢æ•°é¸æŠãŒæ€§èƒ½ã®åˆ†å²ç‚¹ã§ã™ã€‚

## å­¦ç¿’ç›®æ¨™

ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š \- DFTã®åŸºæœ¬åŸç†ï¼ˆHohenberg-Kohnå®šç†ã€Kohn-Shamæ–¹ç¨‹å¼ï¼‰ã‚’ç†è§£ã™ã‚‹ \- äº¤æ›ç›¸é–¢æ±é–¢æ•°ï¼ˆLDAã€GGAï¼‰ã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹ \- ASEã¨GPAWã‚’ä½¿ã£ã¦DFTè¨ˆç®—ã‚’å®Ÿè¡Œã§ãã‚‹ \- ãƒãƒ³ãƒ‰æ§‹é€ ã€çŠ¶æ…‹å¯†åº¦ã€æ§‹é€ æœ€é©åŒ–ã‚’è¨ˆç®—ã§ãã‚‹ \- DFTã®é™ç•Œï¼ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—å•é¡Œã€van der Waalsç›¸äº’ä½œç”¨ï¼‰ã‚’ç†è§£ã™ã‚‹

* * *

## 2.1 å¤šé›»å­ç³»ã®å›°é›£ã•ã¨DFTã®ç™»å ´

### å¤šé›»å­ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼

å¤šé›»å­ç³»ï¼ˆ$N$å€‹ã®é›»å­ï¼‰ã®ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼ï¼š

$$ \hat{H}\Psi(\mathbf{r}_1, \mathbf{r}_2, \ldots, \mathbf{r}_N) = E\Psi(\mathbf{r}_1, \mathbf{r}_2, \ldots, \mathbf{r}_N) $$

æ³¢å‹•é–¢æ•°$\Psi$ã¯$3N$æ¬¡å…ƒç©ºé–“ã®é–¢æ•°ã§ã™ã€‚ã“ã‚ŒãŒæ±ºå®šçš„ã«å›°é›£ãªç†ç”±ã§ã™ã€‚

**è¨ˆç®—é‡ã®çˆ†ç™º** : \- 2é›»å­ç³»: 6æ¬¡å…ƒ \- 10é›»å­ç³»: 30æ¬¡å…ƒ \- 100é›»å­ç³»ï¼ˆå°ã•ãªåˆ†å­ï¼‰: 300æ¬¡å…ƒ

å„æ¬¡å…ƒã‚’100ç‚¹ã§ã‚µãƒ³ãƒ—ãƒ«ã™ã‚‹ã¨ã€$100^{300} \approx 10^{600}$ç‚¹ãŒå¿…è¦ â†’ **å®Ÿè³ªçš„ã«ä¸å¯èƒ½**

### DFTã®ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã‚·ãƒ•ãƒˆ

**Walter Kohnï¼ˆ1998å¹´ãƒãƒ¼ãƒ™ãƒ«åŒ–å­¦è³ï¼‰ã®ã‚¢ã‚¤ãƒ‡ã‚¢** :

> æ³¢å‹•é–¢æ•°$\Psi(\mathbf{r}_1, \ldots, \mathbf{r}_N)$ï¼ˆ$3N$æ¬¡å…ƒï¼‰ã®ä»£ã‚ã‚Šã«ã€**é›»å­å¯†åº¦** $n(\mathbf{r})$ï¼ˆ3æ¬¡å…ƒï¼‰ã‚’åŸºæœ¬å¤‰æ•°ã«ã§ããªã„ã‹ï¼Ÿ

$$ n(\mathbf{r}) = N \int |\Psi(\mathbf{r}, \mathbf{r}_2, \ldots, \mathbf{r}_N)|^2 d\mathbf{r}_2 \cdots d\mathbf{r}_N $$

ã‚‚ã—ã“ã‚ŒãŒå¯èƒ½ãªã‚‰ï¼š \- $3N$æ¬¡å…ƒ â†’ 3æ¬¡å…ƒã¸ã®æ¬¡å…ƒå‰Šæ¸› \- è¨ˆç®—é‡ãŒåŠ‡çš„ã«å‰Šæ¸›

* * *

## 2.2 Hohenberg-Kohnå®šç†ï¼ˆ1964å¹´ï¼‰

DFTã®ç†è«–çš„åŸºç¤ã‚’ä¸ãˆã‚‹2ã¤ã®å®šç†ã§ã™ã€‚

### ç¬¬1å®šç†ï¼šä¸€å¯¾ä¸€å¯¾å¿œ

**å®šç†** : å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«$V_{\text{ext}}(\mathbf{r})$ã¯é›»å­å¯†åº¦$n(\mathbf{r})$ã«ã‚ˆã‚Šä¸€æ„ã«æ±ºå®šã•ã‚Œã‚‹ï¼ˆå®šæ•°ã‚’é™¤ã„ã¦ï¼‰ã€‚

**ç‰©ç†çš„æ„å‘³** : \- é›»å­å¯†åº¦$n(\mathbf{r})$ãŒåˆ†ã‹ã‚Œã°ã€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³$\hat{H}$ãŒæ±ºã¾ã‚‹ \- ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ãŒæ±ºã¾ã‚Œã°ã€ã™ã¹ã¦ã®ç‰©ç†é‡ãŒæ±ºã¾ã‚‹ \- ã¤ã¾ã‚Šã€$n(\mathbf{r})$ã ã‘ã§ã™ã¹ã¦ã®æƒ…å ±ãŒå«ã¾ã‚Œã‚‹

### ç¬¬2å®šç†ï¼šå¤‰åˆ†åŸç†

**å®šç†** : åŸºåº•çŠ¶æ…‹ã‚¨ãƒãƒ«ã‚®ãƒ¼$E_0$ã¯çœŸã®é›»å­å¯†åº¦$n_0(\mathbf{r})$ã§æœ€å°å€¤ã‚’å–ã‚‹ã€‚

$$ E[n] \geq E[n_0] = E_0 $$

ä»»æ„ã®è©¦è¡Œå¯†åº¦$n(\mathbf{r})$ã«å¯¾ã—ã¦ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•°$E[n]$ã‚’æœ€å°åŒ–ã™ã‚Œã°åŸºåº•çŠ¶æ…‹ãŒå¾—ã‚‰ã‚Œã‚‹ã€‚

### ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•°

$$ E[n] = T[n] + V_{\text{ext}}[n] + V_{\text{ee}}[n] $$

  * $T[n]$: é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•°
  * $V_{\text{ext}}[n] = \int V_{\text{ext}}(\mathbf{r}) n(\mathbf{r}) d\mathbf{r}$: å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
  * $V_{\text{ee}}[n]$: é›»å­é–“ç›¸äº’ä½œç”¨æ±é–¢æ•°

**å•é¡Œ** : $T[n]$ã¨$V_{\text{ee}}[n]$ã®æ­£ç¢ºãªå½¢ãŒåˆ†ã‹ã‚‰ãªã„ï¼

* * *

## 2.3 Kohn-Shamæ–¹ç¨‹å¼ï¼ˆ1965å¹´ï¼‰

### Kohn-Shamã®å¤©æ‰çš„ã‚¢ã‚¤ãƒ‡ã‚¢

**ä»®æƒ³çš„ãªéç›¸äº’ä½œç”¨ç³»** ã‚’å°å…¥ï¼š \- å®Ÿéš›ã®ç›¸äº’ä½œç”¨ã™ã‚‹é›»å­ç³»ã¨**åŒã˜é›»å­å¯†åº¦** ã‚’æŒã¤ \- ã—ã‹ã—é›»å­é–“ç›¸äº’ä½œç”¨ã¯**ã‚¼ãƒ­** ï¼ˆç‹¬ç«‹ç²’å­ç³»ï¼‰

ã“ã®éç›¸äº’ä½œç”¨ç³»ã®ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼ï¼š

$$ \left[-\frac{\hbar^2}{2m_e}\nabla^2 + V_{\text{KS}}(\mathbf{r})\right] \psi_i(\mathbf{r}) = \epsilon_i \psi_i(\mathbf{r}) $$

  * $\psi_i(\mathbf{r})$: Kohn-Shamè»Œé“ï¼ˆ$i = 1, 2, \ldots, N$ï¼‰
  * $\epsilon_i$: Kohn-Shamã‚¨ãƒãƒ«ã‚®ãƒ¼å›ºæœ‰å€¤
  * $V_{\text{KS}}(\mathbf{r})$: **Kohn-Shamãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«** ï¼ˆeffective potentialï¼‰

### é›»å­å¯†åº¦

$$ n(\mathbf{r}) = \sum_{i=1}^N f_i |\psi_i(\mathbf{r})|^2 $$

$f_i$ã¯å æœ‰æ•°ï¼ˆåŸºåº•çŠ¶æ…‹ã§ã¯$f_i = 1$ã€ã‚¹ãƒ”ãƒ³ã‚’è€ƒæ…®ã™ã‚‹ã¨$f_i \leq 2$ï¼‰

### Kohn-Shamãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«

$$ V_{\text{KS}}(\mathbf{r}) = V_{\text{ext}}(\mathbf{r}) + V_{\text{Hartree}}(\mathbf{r}) + V_{\text{xc}}(\mathbf{r}) $$

**Hartreeãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«** ï¼ˆå¤å…¸çš„ã‚¯ãƒ¼ãƒ­ãƒ³ç›¸äº’ä½œç”¨ï¼‰:

$$ V_{\text{Hartree}}(\mathbf{r}) = e^2 \int \frac{n(\mathbf{r}')}{|\mathbf{r} - \mathbf{r}'|} d\mathbf{r}' $$

**äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«** ï¼ˆé‡å­åŠ¹æœã‚’å«ã‚€ï¼‰:

$$ V_{\text{xc}}(\mathbf{r}) = \frac{\delta E_{\text{xc}}[n]}{\delta n(\mathbf{r})} $$

$E_{\text{xc}}[n]$ã¯äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼æ±é–¢æ•°ã€‚

### è‡ªå·±ç„¡æ’ç€å ´ï¼ˆSCFï¼‰è¨ˆç®—

Kohn-Shamæ–¹ç¨‹å¼ã¯è‡ªå·±ç„¡æ’ç€ã«è§£ãå¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š
    
    
    ```mermaid
    flowchart TD
        A[åˆæœŸå¯†åº¦ nâ°r ã‚’ä»®å®š] --> B[V_KSr ã‚’è¨ˆç®—]
        B --> C[Kohn-Shamæ–¹ç¨‹å¼ã‚’è§£ã: Ïˆáµ¢r, Îµáµ¢]
        C --> D[æ–°ã—ã„å¯†åº¦ nÂ¹r = Î£fáµ¢|Ïˆáµ¢r|Â²]
        D --> E{åæŸåˆ¤å®š: |nÂ¹-nâ°| < tol?}
        E -->|No| F[å¯†åº¦ã‚’æ··åˆ: nâ° = Î±nÂ¹ + 1-Î±nâ°]
        F --> B
        E -->|Yes| G[åŸºåº•çŠ¶æ…‹ã‚¨ãƒãƒ«ã‚®ãƒ¼Eâ‚€, é›»å­æ§‹é€ ã‚’å¾—ã‚‹]
    
        style A fill:#e3f2fd
        style G fill:#c8e6c9
    ```

* * *

## 2.4 äº¤æ›ç›¸é–¢æ±é–¢æ•°

DFTã®ç²¾åº¦ã¯$E_{\text{xc}}[n]$ã®è¿‘ä¼¼ã«ä¾å­˜ã—ã¾ã™ã€‚

### LDAï¼ˆLocal Density Approximationï¼‰

**ä»®å®š** : å„ç‚¹$\mathbf{r}$ã§ã®äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€ãã®ç‚¹ã®é›»å­å¯†åº¦$n(\mathbf{r})$ã®ã¿ã«ä¾å­˜ã™ã‚‹ã€‚

$$ E_{\text{xc}}^{\text{LDA}}[n] = \int n(\mathbf{r}) \epsilon_{\text{xc}}^{\text{unif}}(n(\mathbf{r})) d\mathbf{r} $$

$\epsilon_{\text{xc}}^{\text{unif}}(n)$ã¯ä¸€æ§˜é›»å­ã‚¬ã‚¹ã®äº¤æ›ç›¸é–¢ã‚¨ãƒãƒ«ã‚®ãƒ¼å¯†åº¦ï¼ˆé‡å­ãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­è¨ˆç®—ã§ç²¾å¯†ã«æ±‚ã‚ã‚‰ã‚Œã¦ã„ã‚‹ï¼‰ã€‚

**ç‰¹å¾´** : \- âœ… è¨ˆç®—ãŒé«˜é€Ÿ \- âœ… çµæ™¶æ§‹é€ ã€æ ¼å­å®šæ•°ã«è‰¯ã„ç²¾åº¦ \- âŒ ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’éå°è©•ä¾¡ï¼ˆ~30-50%ï¼‰ \- âŒ å¼±ã„çµåˆï¼ˆvan der Waalsï¼‰ã‚’è¨˜è¿°ã§ããªã„

### GGAï¼ˆGeneralized Gradient Approximationï¼‰

å¯†åº¦$n(\mathbf{r})$ã ã‘ã§ãªãã€ãã®å‹¾é…$\nabla n(\mathbf{r})$ã‚‚è€ƒæ…®ï¼š

$$ E_{\text{xc}}^{\text{GGA}}[n] = \int n(\mathbf{r}) \epsilon_{\text{xc}}^{\text{GGA}}(n(\mathbf{r}), |\nabla n(\mathbf{r})|) d\mathbf{r} $$

**ä»£è¡¨çš„ãªGGAæ±é–¢æ•°** : \- **PBE** ï¼ˆPerdew-Burke-Ernzerhof, 1996ï¼‰: æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹ \- **PW91** ï¼ˆPerdew-Wang 1991ï¼‰: PBEã®å‰èº« \- **BLYP** ï¼ˆBecke-Lee-Yang-Parrï¼‰: é‡å­åŒ–å­¦ã§äººæ°—

**ç‰¹å¾´** : \- âœ… LDAã‚ˆã‚Šæ§‹é€ ã€çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ç²¾åº¦å‘ä¸Š \- âœ… åˆ†å­ã®çµåˆè·é›¢ãƒ»è§’åº¦ãŒæ”¹å–„ \- âŒ ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—å•é¡Œã¯LDAã¨åŒç¨‹åº¦ \- âŒ van der Waalsç›¸äº’ä½œç”¨ã¯ä¾ç„¶ä¸ååˆ†

### æ¯”è¼ƒè¡¨

é …ç›® | LDA | GGAï¼ˆPBEï¼‰ | å®Ÿé¨“å€¤  
---|---|---|---  
Siæ ¼å­å®šæ•° [Ã…] | 5.40 | 5.47 | 5.43  
Siãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— [eV] | 0.5 | 0.6 | 1.17  
Hâ‚‚çµåˆé•· [Ã…] | 0.76 | 0.75 | 0.74  
Hâ‚‚çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV] | -4.8 | -4.6 | -4.75  
  
* * *

## 2.5 ASE + GPAWã«ã‚ˆã‚‹DFTè¨ˆç®—ã®å®Ÿè·µ

### ç’°å¢ƒæ§‹ç¯‰
    
    
    # Anacondaç’°å¢ƒã§ã®æ¨å¥¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    conda create -n dft python=3.11
    conda activate dft
    conda install -c conda-forge ase gpaw
    pip install matplotlib numpy scipy
    

### Example 1: æ°´ç´ åˆ†å­ï¼ˆHâ‚‚ï¼‰ã®æ§‹é€ æœ€é©åŒ–
    
    
    from ase import Atoms
    from ase.optimize import BFGS
    from gpaw import GPAW, PW
    
    # æ°´ç´ åˆ†å­ã®åˆæœŸæ§‹é€ 
    atoms = Atoms('H2',
                  positions=[[0, 0, 0], [0, 0, 0.8]],  # åˆæœŸçµåˆé•·0.8Ã…
                  cell=[6, 6, 6],  # ã‚»ãƒ«ã‚µã‚¤ã‚º
                  pbc=False)  # å‘¨æœŸå¢ƒç•Œæ¡ä»¶ãªã—
    
    # è¨ˆç®—æ©Ÿã‚’è¨­å®š
    calc = GPAW(mode=PW(400),  # å¹³é¢æ³¢åŸºåº•ã€ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼400eV
                xc='PBE',  # GGAæ±é–¢æ•°ï¼ˆPBEï¼‰
                txt='h2_opt.txt')  # ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«
    
    atoms.calc = calc
    
    # æ§‹é€ æœ€é©åŒ–
    opt = BFGS(atoms, trajectory='h2_opt.traj')
    opt.run(fmax=0.01)  # åŠ›ãŒ0.01 eV/Ã…ä»¥ä¸‹ã¾ã§æœ€é©åŒ–
    
    # çµæœã®è¡¨ç¤º
    print(f"æœ€é©åŒ–å¾Œã®çµåˆé•·: {atoms.get_distance(0, 1):.3f} Ã…")
    print(f"ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼: {atoms.get_potential_energy():.3f} eV")
    

**å®Ÿè¡Œçµæœ** :
    
    
    æœ€é©åŒ–å¾Œã®çµåˆé•·: 0.748 Ã…
    ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼: -6.873 eV
    

**å®Ÿé¨“å€¤ã¨ã®æ¯”è¼ƒ** : 0.741 Ã…ï¼ˆå®Ÿé¨“å€¤ï¼‰â†’ èª¤å·®ç´„1%

* * *

### Example 2: Siã®ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®—
    
    
    from ase.build import bulk
    from gpaw import GPAW, PW
    from gpaw.utilities.kpoints import get_bandpath
    import matplotlib.pyplot as plt
    
    # Siçµæ™¶ã®ä½œæˆ
    si = bulk('Si', 'diamond', a=5.43)
    
    # SCFè¨ˆç®—ï¼ˆå¯†ãª kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ï¼‰
    calc = GPAW(mode=PW(400),
                xc='PBE',
                kpts=(8, 8, 8),  # Monkhorst-Pack ãƒ¡ãƒƒã‚·ãƒ¥
                txt='si_scf.txt')
    
    si.calc = calc
    si.get_potential_energy()  # SCFè¨ˆç®—ã‚’å®Ÿè¡Œ
    calc.write('si_groundstate.gpw')  # æ³¢å‹•é–¢æ•°ã‚’ä¿å­˜
    
    # ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®—
    calc_bands = calc.fixed_density(
        kpts={'path': 'LGXULK', 'npoints': 60},  # é«˜å¯¾ç§°ç‚¹çµŒè·¯
        txt='si_bands.txt'
    )
    
    # ãƒãƒ³ãƒ‰æ§‹é€ ã®å–å¾—
    ef = calc_bands.get_fermi_level()
    energies, k_distances = calc_bands.band_structure().get_bands()
    
    # ãƒ—ãƒ­ãƒƒãƒˆ
    plt.figure(figsize=(8, 6))
    for n in range(energies.shape[1]):
        plt.plot(k_distances, energies[:, n] - ef, 'b-', linewidth=1)
    
    plt.axhline(0, color='red', linestyle='--', linewidth=1)
    plt.ylabel('Energy [eV]', fontsize=12)
    plt.xlabel('k-path', fontsize=12)
    plt.title('Si Band Structure (PBE)', fontsize=14)
    plt.ylim(-6, 6)
    plt.grid(alpha=0.3)
    plt.savefig('si_bandstructure.png', dpi=150)
    plt.show()
    
    # ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—è¨ˆç®—
    vbm = energies[:, :4].max() - ef  # Valence Band Maximum
    cbm = energies[:, 4:].min() - ef  # Conduction Band Minimum
    print(f"ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— (Indirect): {cbm - vbm:.3f} eV")
    print(f"å®Ÿé¨“å€¤: 1.17 eV")
    

**å®Ÿè¡Œçµæœ** :
    
    
    ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— (Indirect): 0.614 eV
    å®Ÿé¨“å€¤: 1.17 eV
    

**ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—éå°è©•ä¾¡** : DFTã®æ—¢çŸ¥ã®å•é¡Œï¼ˆæ¬¡ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§è§£èª¬ï¼‰

* * *

### Example 3: çŠ¶æ…‹å¯†åº¦ï¼ˆDOSï¼‰ã®è¨ˆç®—
    
    
    from gpaw import GPAW
    import matplotlib.pyplot as plt
    
    # æ—¢ã«è¨ˆç®—æ¸ˆã¿ã®åŸºåº•çŠ¶æ…‹ã‚’èª­ã¿è¾¼ã¿
    calc = GPAW('si_groundstate.gpw', txt=None)
    
    # çŠ¶æ…‹å¯†åº¦ã®è¨ˆç®—
    energies, dos = calc.get_dos(spin=0, npts=1000, width=0.1)
    ef = calc.get_fermi_level()
    
    # ãƒ—ãƒ­ãƒƒãƒˆ
    plt.figure(figsize=(8, 6))
    plt.plot(energies - ef, dos, linewidth=2)
    plt.axvline(0, color='red', linestyle='--', linewidth=1, label='Fermi level')
    plt.fill_between(energies - ef, dos, where=(energies <= ef), alpha=0.3, label='Occupied states')
    plt.xlabel('Energy [eV]', fontsize=12)
    plt.ylabel('DOS [states/eV]', fontsize=12)
    plt.title('Si Density of States (PBE)', fontsize=14)
    plt.xlim(-15, 10)
    plt.legend()
    plt.grid(alpha=0.3)
    plt.savefig('si_dos.png', dpi=150)
    plt.show()
    

* * *

### Example 4: æ§‹é€ æœ€é©åŒ–ã¨åŠ›ã®è¨ˆç®—
    
    
    from ase.build import molecule
    from ase.optimize import BFGS
    from gpaw import GPAW, PW
    
    # æ°´åˆ†å­ã®åˆæœŸæ§‹é€ ï¼ˆã‚†ãŒã‚“ã æ§‹é€ ï¼‰
    h2o = molecule('H2O')
    h2o.positions[0] += [0.1, 0.1, 0]  # ã‚ã–ã¨æ­ªã¾ã›ã‚‹
    h2o.center(vacuum=4.0)  # çœŸç©ºé ˜åŸŸã‚’è¿½åŠ 
    
    # è¨ˆç®—æ©Ÿã®è¨­å®š
    calc = GPAW(mode=PW(400),
                xc='PBE',
                txt='h2o_opt.txt')
    
    h2o.calc = calc
    
    print("åˆæœŸæ§‹é€ :")
    print(f"O-H1è·é›¢: {h2o.get_distance(0, 1):.3f} Ã…")
    print(f"O-H2è·é›¢: {h2o.get_distance(0, 2):.3f} Ã…")
    print(f"H-O-Hè§’åº¦: {h2o.get_angle(1, 0, 2):.1f}Â°")
    
    # æ§‹é€ æœ€é©åŒ–
    opt = BFGS(h2o, trajectory='h2o_opt.traj')
    opt.run(fmax=0.02)
    
    print("\næœ€é©åŒ–å¾Œ:")
    print(f"O-H1è·é›¢: {h2o.get_distance(0, 1):.3f} Ã…")
    print(f"O-H2è·é›¢: {h2o.get_distance(0, 2):.3f} Ã…")
    print(f"H-O-Hè§’åº¦: {h2o.get_angle(1, 0, 2):.1f}Â°")
    print(f"\nå®Ÿé¨“å€¤: O-H = 0.958 Ã…, H-O-H = 104.5Â°")
    

**å®Ÿè¡Œçµæœ** :
    
    
    åˆæœŸæ§‹é€ :
    O-H1è·é›¢: 1.071 Ã…
    O-H2è·é›¢: 0.969 Ã…
    H-O-Hè§’åº¦: 104.5Â°
    
    æœ€é©åŒ–å¾Œ:
    O-H1è·é›¢: 0.972 Ã…
    O-H2è·é›¢: 0.972 Ã…
    H-O-Hè§’åº¦: 104.0Â°
    
    å®Ÿé¨“å€¤: O-H = 0.958 Ã…, H-O-H = 104.5Â°
    

* * *

## 2.6 DFTã®é™ç•Œã¨å¯¾ç­–

### é™ç•Œ1: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®éå°è©•ä¾¡

**åŸå› ** : Kohn-Shamå›ºæœ‰å€¤$\epsilon_i$ã¯å³å¯†ã«ã¯æº–ç²’å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã¯ãªã„ã€‚äº¤æ›ç›¸é–¢ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®ä¸æ­£ç¢ºã•ã€‚

**å…¸å‹çš„ãªèª¤å·®** : å®Ÿé¨“å€¤ã®30-50%éå°è©•ä¾¡

ææ–™ | å®Ÿé¨“å€¤ [eV] | LDA [eV] | GGA [eV]  
---|---|---|---  
Si | 1.17 | 0.5 | 0.6  
GaAs | 1.52 | 0.3 | 0.5  
Diamond | 5.48 | 4.1 | 4.3  
  
**å¯¾ç­–** : 1\. **GWè¿‘ä¼¼** ï¼ˆå¤šä½“æ‘‚å‹•è«–ï¼‰: æº–ç²’å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®— 2\. **ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ±é–¢æ•°** ï¼ˆHSE, B3LYPï¼‰: Hartree-Fockäº¤æ›ã®æ··åˆ 3\. **Scissorsæ“ä½œ** ï¼ˆçµŒé¨“çš„è£œæ­£ï¼‰: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’å®Ÿé¨“å€¤ã«ã‚·ãƒ•ãƒˆ

### é™ç•Œ2: van der Waalsç›¸äº’ä½œç”¨

**å•é¡Œ** : LDA/GGAã¯van der Waalsï¼ˆåˆ†æ•£åŠ›ï¼‰ã‚’è¨˜è¿°ã§ããªã„ã€‚

**å½±éŸ¿ã‚’å—ã‘ã‚‹ç³»** : \- ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆå±¤é–“ \- åˆ†å­çµæ™¶ \- ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®æŠ˜ã‚ŠãŸãŸã¿

**å¯¾ç­–** : 1\. **DFT-D3** ï¼ˆGrimmeã®åˆ†æ•£è£œæ­£ï¼‰: çµŒé¨“çš„è£œæ­£é …ã‚’è¿½åŠ  2\. **vdW-DF** ï¼ˆvan der Waals density functionalï¼‰: éå±€æ‰€ç›¸é–¢æ±é–¢æ•° 3\. **GPAWã§ã®å®Ÿè£…** :
    
    
    calc = GPAW(mode=PW(400),
                xc='vdW-DF',  # van der Waalsæ±é–¢æ•°
                txt='graphite_vdw.txt')
    

### é™ç•Œ3: å¼·ç›¸é–¢ç³»

**å•é¡Œ** : LDA/GGAã¯å¼·ã„é›»å­ç›¸é–¢ã‚’è¨˜è¿°ã§ããªã„ã€‚

**å½±éŸ¿ã‚’å—ã‘ã‚‹ç³»** : \- é·ç§»é‡‘å±é…¸åŒ–ç‰©ï¼ˆNiO, FeOï¼‰ \- fé›»å­ç³»ï¼ˆå¸ŒåœŸé¡ã€ã‚¢ã‚¯ãƒãƒã‚¤ãƒ‰ï¼‰

**å¯¾ç­–** : 1\. **DFT+U** : Hubbard Uãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å°å…¥ 2\. **DMFT** ï¼ˆDynamical Mean-Field Theoryï¼‰ 3\. **Hybrid functionals**

* * *

## 2.7 åæŸãƒ†ã‚¹ãƒˆ

DFTè¨ˆç®—ã§ã¯ä»¥ä¸‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’åæŸã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥ã®åæŸ
    
    
    from ase.build import bulk
    from gpaw import GPAW, PW
    import numpy as np
    import matplotlib.pyplot as plt
    
    si = bulk('Si', 'diamond', a=5.43)
    
    k_grids = [(2,2,2), (4,4,4), (6,6,6), (8,8,8), (10,10,10), (12,12,12)]
    energies = []
    
    for kpts in k_grids:
        calc = GPAW(mode=PW(400), xc='PBE', kpts=kpts, txt=None)
        si.calc = calc
        E = si.get_potential_energy()
        energies.append(E)
        print(f"k-grid {kpts}: E = {E:.6f} eV")
    
    # ãƒ—ãƒ­ãƒƒãƒˆ
    k_total = [k[0]**3 for k in k_grids]
    plt.figure(figsize=(8, 6))
    plt.plot(k_total, energies, 'o-', linewidth=2, markersize=8)
    plt.xlabel('Total k-points', fontsize=12)
    plt.ylabel('Total Energy [eV]', fontsize=12)
    plt.title('k-point Convergence Test', fontsize=14)
    plt.grid(alpha=0.3)
    plt.savefig('k_convergence.png', dpi=150)
    plt.show()
    

**åæŸåˆ¤å®š** : ã‚¨ãƒãƒ«ã‚®ãƒ¼å·® < 1 meV/atom

### ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åæŸ
    
    
    cutoffs = [200, 300, 400, 500, 600, 700]
    energies = []
    
    for ecut in cutoffs:
        calc = GPAW(mode=PW(ecut), xc='PBE', kpts=(8,8,8), txt=None)
        si.calc = calc
        E = si.get_potential_energy()
        energies.append(E)
        print(f"Cutoff {ecut} eV: E = {E:.6f} eV")
    
    # ãƒ—ãƒ­ãƒƒãƒˆ
    plt.figure(figsize=(8, 6))
    plt.plot(cutoffs, energies, 'o-', linewidth=2, markersize=8)
    plt.xlabel('Cutoff Energy [eV]', fontsize=12)
    plt.ylabel('Total Energy [eV]', fontsize=12)
    plt.title('Plane Wave Cutoff Convergence Test', fontsize=14)
    plt.grid(alpha=0.3)
    plt.savefig('cutoff_convergence.png', dpi=150)
    plt.show()
    

* * *

## 2.8 æœ¬ç« ã®ã¾ã¨ã‚

### å­¦ã‚“ã ã“ã¨

  1. **DFTã®åŸºæœ¬åŸç†** \- Hohenberg-Kohnå®šç†: é›»å­å¯†åº¦ã§ã™ã¹ã¦ãŒæ±ºã¾ã‚‹ \- Kohn-Shamæ–¹ç¨‹å¼: éç›¸äº’ä½œç”¨ç³»ã¸ã®å¤‰æ› \- äº¤æ›ç›¸é–¢æ±é–¢æ•°: LDAã€GGA

  2. **ASE + GPAWã«ã‚ˆã‚‹å®Ÿè·µ** \- æ§‹é€ æœ€é©åŒ– \- ãƒãƒ³ãƒ‰æ§‹é€ è¨ˆç®— \- çŠ¶æ…‹å¯†åº¦ï¼ˆDOSï¼‰è¨ˆç®— \- åæŸãƒ†ã‚¹ãƒˆ

  3. **DFTã®é™ç•Œ** \- ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®éå°è©•ä¾¡ \- van der Waalsç›¸äº’ä½œç”¨ã®æ¬ å¦‚ \- å¼·ç›¸é–¢ç³»ã¸ã®ä¸é©ç”¨

### é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

  * DFTã¯ç¬¬ä¸€åŸç†è¨ˆç®—ã®å®Ÿç”¨çš„æ‰‹æ³•
  * è¨ˆç®—ç²¾åº¦ã¯äº¤æ›ç›¸é–¢æ±é–¢æ•°ã®é¸æŠã«ä¾å­˜
  * åæŸãƒ†ã‚¹ãƒˆã¯å¿…é ˆ
  * ç³»ã«å¿œã˜ã¦é©åˆ‡ãªè£œæ­£ãŒå¿…è¦

### æ¬¡ã®ç« ã¸

ç¬¬3ç« ã§ã¯ã€åŸå­æ ¸ã®é‹å‹•ã‚’æ‰±ã†**åˆ†å­å‹•åŠ›å­¦ï¼ˆMDï¼‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** ã‚’å­¦ã³ã¾ã™ã€‚

* * *

## æ¼”ç¿’å•é¡Œ

### å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰

Hohenberg-Kohnç¬¬1å®šç†ã®ç‰©ç†çš„æ„å‘³ã‚’è‡ªåˆ†ã®è¨€è‘‰ã§èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

è§£ç­”ä¾‹ é›»å­å¯†åº¦$n(\mathbf{r})$ãŒä¸ãˆã‚‰ã‚Œã‚Œã°ã€å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«$V_{\text{ext}}(\mathbf{r})$ãŒæ±ºã¾ã‚Šã¾ã™ã€‚å¤–éƒ¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ãŒæ±ºã¾ã‚Œã°ã€ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³$\hat{H}$ãŒæ±ºã¾ã‚Šã€ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼ãŒè§£ã‘ã¾ã™ã€‚ã¤ã¾ã‚Šã€**é›»å­å¯†åº¦ã ã‘ã§ç³»ã®ã™ã¹ã¦ã®æ€§è³ªãŒæ±ºå®šã•ã‚Œã‚‹**ã¨ã„ã†ã“ã¨ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€$3N$æ¬¡å…ƒã®æ³¢å‹•é–¢æ•°ã®ä»£ã‚ã‚Šã«ã€3æ¬¡å…ƒã®é›»å­å¯†åº¦ã§å¤šé›»å­ç³»ã‚’è¨˜è¿°ã§ãã¾ã™ã€‚ 

### å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰

Siã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒDFT-GGAï¼ˆPBEï¼‰ã§0.6 eVã€å®Ÿé¨“å€¤ãŒ1.17 eVã§ã™ã€‚ã“ã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—éå°è©•ä¾¡ã®åŸå› ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

è§£ç­”ä¾‹ DFTã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—éå°è©•ä¾¡ã®ä¸»ãªåŸå› ã¯ä»¥ä¸‹ã®2ã¤ã§ã™ï¼š 1\. **Kohn-Shamå›ºæœ‰å€¤ã®è§£é‡ˆã®å•é¡Œ**: Kohn-Shamå›ºæœ‰å€¤$\epsilon_i$ã¯å³å¯†ã«ã¯æº–ç²’å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚Kohn-Shamæ–¹ç¨‹å¼ã¯å½¢å¼çš„ã«ã¯1é›»å­ã‚·ãƒ¥ãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚¬ãƒ¼æ–¹ç¨‹å¼ã§ã™ãŒã€ã“ã‚Œã¯æ•°å­¦çš„ãªä¾¿å®œã®ãŸã‚ã®ã‚‚ã®ã§ã€$\epsilon_i$ã¯ç‰©ç†çš„ãªåŠ±èµ·ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ 2\. **äº¤æ›ç›¸é–¢æ±é–¢æ•°ã®ä¸æ­£ç¢ºã•**: LDA/GGAã®äº¤æ›ç›¸é–¢æ±é–¢æ•°ã¯ã€é›»å­ã®è‡ªå·±ç›¸äº’ä½œç”¨ï¼ˆself-interactionï¼‰ã‚’å®Œå…¨ã«ã¯æ‰“ã¡æ¶ˆã—ã¾ã›ã‚“ã€‚ã“ã®èª¤å·®ã«ã‚ˆã‚Šã€å æœ‰æº–ä½ãŒä¸ŠãŒã‚Šï¼ˆæµ…ããªã‚Šï¼‰ã€éå æœ‰æº–ä½ãŒä¸‹ãŒã‚‹ï¼ˆæµ…ããªã‚‹ï¼‰ãŸã‚ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒéå°è©•ä¾¡ã•ã‚Œã¾ã™ã€‚ **å¯¾ç­–**: \- GWè¿‘ä¼¼: æº–ç²’å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ­£ç¢ºã«è¨ˆç®—ï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆå¤§ï¼‰ \- ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰æ±é–¢æ•°ï¼ˆHSE, B3LYPï¼‰: Hartree-Fockäº¤æ›ã‚’æ··åˆ \- DFT+U: å¼·ç›¸é–¢ç³»å‘ã‘ \- Scissorsæ“ä½œ: çµŒé¨“çš„ã«ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’è£œæ­£ 

### å•é¡Œ3ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰

ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆå±¤é–“è·é›¢ã‚’DFT-GGAï¼ˆPBEï¼‰ã§è¨ˆç®—ã™ã‚‹ã¨å®Ÿé¨“å€¤ã‚ˆã‚Šå¤§ããéå¤§è©•ä¾¡ã•ã‚Œã¾ã™ã€‚ã“ã®ç†ç”±ã¨å¯¾ç­–ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

è§£ç­”ä¾‹ **ç†ç”±**: LDA/GGAã¯van der Waalsï¼ˆåˆ†æ•£åŠ›ï¼‰ç›¸äº’ä½œç”¨ã‚’è¨˜è¿°ã§ããªã„ãŸã‚ã§ã™ã€‚ ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆã®å±¤é–“ã¯å…±æœ‰çµåˆã‚„ã‚¤ã‚ªãƒ³çµåˆã§ã¯ãªãã€**van der WaalsåŠ›**ï¼ˆLondonåˆ†æ•£åŠ›ï¼‰ã§çµåˆã—ã¦ã„ã¾ã™ã€‚ã“ã®åŠ›ã¯é›»å­å¯†åº¦ã®æºã‚‰ãã«ã‚ˆã‚‹ç¬é–“åŒæ¥µå­é–“ã®ç›¸äº’ä½œç”¨ã§ã€éå±€æ‰€çš„ãªåŠ¹æœã§ã™ã€‚ LDA/GGAã®äº¤æ›ç›¸é–¢æ±é–¢æ•°ã¯**å±€æ‰€çš„**ï¼ˆã¾ãŸã¯æº–å±€æ‰€çš„ï¼‰ã§ã‚ã‚Šã€å¯†åº¦$n(\mathbf{r})$ã¨ãã®å‹¾é…$\nabla n(\mathbf{r})$ã ã‘ã§æ±ºã¾ã‚Šã¾ã™ã€‚ã“ã®ãŸã‚ã€é è·é›¢ã®é›»å­ç›¸é–¢ï¼ˆvan der WaalsåŠ›ï¼‰ã‚’è¨˜è¿°ã§ãã¾ã›ã‚“ã€‚ çµæœã¨ã—ã¦ï¼š \- å±¤é–“ã®å¼•åŠ›ãŒéå°è©•ä¾¡ã•ã‚Œã‚‹ \- å±¤é–“è·é›¢ãŒå®Ÿé¨“å€¤ã‚ˆã‚Šå¤§ãããªã‚‹ \- çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒéå°è©•ä¾¡ã•ã‚Œã‚‹ **å¯¾ç­–**: 1\. **DFT-D3**ï¼ˆGrimmeã®åˆ†æ•£è£œæ­£ï¼‰: \- çµŒé¨“çš„ãª$C_6/r^6$é …ã‚’è¿½åŠ  \- ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¯å…ƒç´ ã”ã¨ã«æ±ºå®š \- GPAWã§ã®å®Ÿè£…: `xc='PBE+D3'` 2\. **vdW-DF**ï¼ˆvan der Waals density functionalï¼‰: \- éå±€æ‰€ç›¸é–¢æ±é–¢æ•° \- ç¬¬ä¸€åŸç†çš„ï¼ˆçµŒé¨“ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãªã—ï¼‰ \- GPAWã§ã®å®Ÿè£…: `xc='vdW-DF'` or `xc='vdW-DF2'` 3\. **è¨ˆç®—ä¾‹**: 
    
    
    from ase.build import graphite
    from gpaw import GPAW, PW
    
    graphite = graphite(a=2.46, c=6.70)  # åˆæœŸæ§‹é€ 
    
    # PBEã®ã¿
    calc_pbe = GPAW(mode=PW(400), xc='PBE', kpts=(8,8,4), txt='gr_pbe.txt')
    graphite.calc = calc_pbe
    E_pbe = graphite.get_potential_energy()
    
    # PBE + D3
    calc_d3 = GPAW(mode=PW(400), xc='PBE+D3', kpts=(8,8,4), txt='gr_d3.txt')
    graphite.calc = calc_d3
    E_d3 = graphite.get_potential_energy()
    
    print(f"PBE: E = {E_pbe:.3f} eV")
    print(f"PBE+D3: E = {E_d3:.3f} eV")
    print(f"vdWè£œæ­£: {E_d3 - E_pbe:.3f} eV")
    

vdWè£œæ­£ã«ã‚ˆã‚Šå±¤é–“è·é›¢ãŒå®Ÿé¨“å€¤ï¼ˆ3.35 Ã…ï¼‰ã«è¿‘ã¥ãã¾ã™ã€‚ 

* * *

## ãƒ‡ãƒ¼ã‚¿ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¨å¼•ç”¨

### ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆãƒ»ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢

  1. **GPAW - DFTè¨ˆç®—ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢** (GPL v3) \- å¹³é¢æ³¢/LCAOåŸºåº•ã®DFTã‚³ãƒ¼ãƒ‰ \- URL: https://wiki.fysik.dtu.dk/gpaw/ \- å¼•ç”¨: Mortensen, J. J., et al. (2024). _Phys. Rev. B_ , 71, 035109.

  2. **ASE - Atomic Simulation Environment** (LGPL v2.1+) \- åŸå­æ§‹é€ æ“ä½œãƒ»å¯è¦–åŒ–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª \- URL: https://wiki.fysik.dtu.dk/ase/ \- å¼•ç”¨: Larsen, A. H., et al. (2017). _J. Phys.: Condens. Matter_ , 29, 273002.

  3. **Materials Project Database** (CC BY 4.0) \- Si, GaAsã®å®Ÿé¨“å€¤ï¼ˆæ ¼å­å®šæ•°ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ï¼‰ \- URL: https://materialsproject.org

  4. **Pseudopotential Databases** \- **GPAW PAW Datasets** : GPL v3 \- **PseudoDojo** : BSD License \- URL: http://www.pseudo-dojo.org/

### è¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‡ºå…¸

æœ¬ç« ã®DFTè¨ˆç®—ã§ä½¿ç”¨ã—ãŸæ¨™æº–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼š

  * **kç‚¹ãƒ¡ãƒƒã‚·ãƒ¥** : Monkhorst-Packæ³• (Monkhorst & Pack, 1976)
  * **ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼** : ææ–™ã”ã¨ã®æ¨å¥¨å€¤ï¼ˆGPAW documentationï¼‰
  * **äº¤æ›ç›¸é–¢æ±é–¢æ•°** : PBE (Perdew, Burke, Ernzerhof, 1996)

* * *

## ã‚³ãƒ¼ãƒ‰å†ç¾æ€§ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ç’°å¢ƒæ§‹ç¯‰
    
    
    # Anacondaæ¨å¥¨ï¼ˆGPAWã®ä¾å­˜é–¢ä¿‚ãŒè¤‡é›‘ãªãŸã‚ï¼‰
    conda create -n dft python=3.11
    conda activate dft
    conda install -c conda-forge gpaw ase matplotlib
    
    # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
    python -c "import gpaw; print(gpaw.__version__)"  # 24.1.xä»¥é™
    python -c "import ase; print(ase.__version__)"    # 3.22.xä»¥é™
    

### ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢è¦ä»¶

è¨ˆç®—ä¾‹ | ãƒ¡ãƒ¢ãƒª | CPUæ™‚é–“ | æ¨å¥¨ã‚³ã‚¢æ•°  
---|---|---|---  
Hâ‚‚æœ€é©åŒ– | ~2 GB | ~5åˆ† | 1-2ã‚³ã‚¢  
Si SCF | ~4 GB | ~10åˆ† | 4-8ã‚³ã‚¢  
Siãƒãƒ³ãƒ‰æ§‹é€  | ~4 GB | ~15åˆ† | 4-8ã‚³ã‚¢  
Si DOS | ~4 GB | ~20åˆ† | 4-8ã‚³ã‚¢  
  
### è¨ˆç®—æ™‚é–“ã®è¦‹ç©ã‚‚ã‚Š
    
    
    # ã‚»ãƒ«å†…åŸå­æ•°ã¨kç‚¹ã‹ã‚‰è¨ˆç®—æ™‚é–“ã‚’æ¨å®š
    N_atoms = len(atoms)
    N_kpts = np.product(kpts)  # (8,8,8) â†’ 512
    time_estimate = N_atoms * N_kpts * 0.5  # ç§’ï¼ˆç›®å®‰ï¼‰
    print(f"æ¨å®šè¨ˆç®—æ™‚é–“: {time_estimate/60:.1f} åˆ†")
    

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**å•é¡Œ** : `FileNotFoundError: PAW dataset not found` **è§£æ±º** :
    
    
    # PAWãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
    gpaw install-data <directory>
    

**å•é¡Œ** : ãƒ¡ãƒ¢ãƒªä¸è¶³ã§ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ **è§£æ±º** :
    
    
    # ãƒ¡ãƒ¢ãƒªå‰Šæ¸›: kç‚¹ã‚’æ¸›ã‚‰ã™
    calc = GPAW(mode=PW(300), kpts=(4,4,4))  # 8â†’4ã«å‰Šæ¸›
    

**å•é¡Œ** : åæŸã—ãªã„ï¼ˆSCF ãŒç™ºæ•£ï¼‰ **è§£æ±º** :
    
    
    # åæŸã‚’æ”¹å–„: æ··åˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´
    calc = GPAW(mode=PW(400), xc='PBE',
                mixer=Mixer(0.05, 5, 50))  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚ˆã‚Šä¿å®ˆçš„
    

* * *

## å®Ÿè·µçš„ãªè½ã¨ã—ç©´ã¨å¯¾ç­–

### 1\. kç‚¹åæŸã®ä¸ååˆ†

**è½ã¨ã—ç©´** : kç‚¹ãŒç²—ã™ãã¦ä¸æ­£ç¢ºãªçµæœ
    
    
    # âŒ ä¸ååˆ†: (2,2,2)ã§ã¯åæŸã—ãªã„
    calc = GPAW(mode=PW(400), xc='PBE', kpts=(2,2,2))
    
    # âœ… åæŸãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
    for k in [2, 4, 6, 8, 10, 12]:
        calc = GPAW(mode=PW(400), xc='PBE', kpts=(k,k,k), txt=None)
        si.calc = calc
        E = si.get_potential_energy()
        print(f"k={k}: E={E:.6f} eV")
    # åæŸåˆ¤å®š: |E(k) - E(k+2)| < 1 meV/atom
    

**åæŸåŸºæº–** : \- é‡‘å±: kç‚¹å¯†åº¦ > 0.05 Ã…â»Â¹ \- åŠå°ä½“: kç‚¹å¯†åº¦ > 0.03 Ã…â»Â¹ \- çµ¶ç¸ä½“: kç‚¹å¯†åº¦ > 0.02 Ã…â»Â¹

### 2\. ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®è¨­å®š

**è½ã¨ã—ç©´** : ã‚«ãƒƒãƒˆã‚ªãƒ•ãŒä½ã™ãã¦ç²¾åº¦ä¸è¶³
    
    
    # âŒ ä¸ååˆ†: 200 eVã§ã¯è»½å…ƒç´ ã§ä¸æ­£ç¢º
    calc = GPAW(mode=PW(200), xc='PBE')
    
    # âœ… å…ƒç´ ã”ã¨ã®æ¨å¥¨å€¤
    cutoff_recommendations = {
        'H': 300,   # æ°´ç´ ã¯é«˜ã‚«ãƒƒãƒˆã‚ªãƒ•å¿…è¦
        'C': 400,
        'Si': 300,
        'Fe': 350,
        'Au': 250
    }
    

**åæŸåˆ¤å®š** : ã‚¨ãƒãƒ«ã‚®ãƒ¼å·® < 1 meV/atom

### 3\. SCFåæŸã®å¤±æ•—

**è½ã¨ã—ç©´** : åˆæœŸå¯†åº¦ãŒæ‚ªãåæŸã—ãªã„
    
    
    # âŒ åæŸã—ãªã„: é‡‘å±ã§å›ºå®šå æœ‰æ•°
    calc = GPAW(mode=PW(400), occupations=FermiDirac(0.0))  # 0K
    
    # âœ… é‡‘å±ç³»: æœ‰é™æ¸©åº¦ã§ç·©å’Œ
    from gpaw import FermiDirac
    calc = GPAW(mode=PW(400),
                occupations=FermiDirac(0.1))  # kT = 0.1 eV â‰ˆ 1160 K
    

**åæŸåˆ¤å®š** : é›»å­å¯†åº¦ã®æ®‹å·® < 1e-4

### 4\. æ§‹é€ æœ€é©åŒ–ã®å¤±æ•—

**è½ã¨ã—ç©´** : åŠ›ã®è¨ˆç®—ç²¾åº¦ãŒä¸è¶³
    
    
    # âŒ ä¸æ­£ç¢º: ã‚«ãƒƒãƒˆã‚ªãƒ•ä½ â†’ åŠ›ã®ç²¾åº¦ä½ä¸‹
    calc = GPAW(mode=PW(250), xc='PBE')
    opt.run(fmax=0.01)  # é”æˆã§ããªã„
    
    # âœ… åŠ›ã®è¨ˆç®—ã«ã¯ã‚ˆã‚Šé«˜ã„ã‚«ãƒƒãƒˆã‚ªãƒ•
    calc = GPAW(mode=PW(500), xc='PBE')  # 1.5-2å€
    opt.run(fmax=0.05)  # ç¾å®Ÿçš„ãªé–¾å€¤
    

**æ¨å¥¨é–¾å€¤** : \- ç²—ã„æœ€é©åŒ–: fmax = 0.1 eV/Ã… \- æ¨™æº–: fmax = 0.05 eV/Ã… \- é«˜ç²¾åº¦: fmax = 0.01 eV/Ã…

### 5\. ã‚¹ãƒ”ãƒ³åˆ†æ¥µã®è€ƒæ…®æ¼ã‚Œ

**è½ã¨ã—ç©´** : ç£æ€§ææ–™ã§ã‚¹ãƒ”ãƒ³åˆ†æ¥µã‚’è€ƒæ…®ã—ãªã„
    
    
    # âŒ é–“é•ã„: Feã§ã‚¹ãƒ”ãƒ³åˆ†æ¥µãªã—
    calc = GPAW(mode=PW(400), xc='PBE')
    
    # âœ… æ­£è§£: ã‚¹ãƒ”ãƒ³åˆ†æ¥µã‚’æœ‰åŠ¹åŒ–
    calc = GPAW(mode=PW(400), xc='PBE',
                spinpol=True,  # ã‚¹ãƒ”ãƒ³åˆ†æ¥µON
                magmom=2.2)    # åˆæœŸç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ
    

* * *

## å“è³ªä¿è¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### DFTè¨ˆç®—ã®å¦¥å½“æ€§æ¤œè¨¼

#### åæŸãƒ†ã‚¹ãƒˆï¼ˆå¿…é ˆï¼‰

  * [ ] kç‚¹åæŸ: ã‚¨ãƒãƒ«ã‚®ãƒ¼å·® < 1 meV/atom
  * [ ] ã‚«ãƒƒãƒˆã‚ªãƒ•åæŸ: ã‚¨ãƒãƒ«ã‚®ãƒ¼å·® < 1 meV/atom
  * [ ] SCFåæŸ: é›»å­å¯†åº¦æ®‹å·® < 1e-4
  * [ ] ã‚»ãƒ«ã‚µã‚¤ã‚ºåæŸï¼ˆåˆ†å­ç³»ï¼‰: çœŸç©ºé ˜åŸŸ > 4 Ã…

#### æ§‹é€ ã®å¦¥å½“æ€§

  * [ ] æ ¼å­å®šæ•°ãŒå®Ÿé¨“å€¤ã® Â±3% ä»¥å†…
  * [ ] åŸå­é–“è·é›¢ãŒåŒ–å­¦çš„ã«å¦¥å½“ï¼ˆçµåˆé•·ï¼‰
  * [ ] åŠ›ãŒã™ã¹ã¦ < fmaxï¼ˆæ§‹é€ æœ€é©åŒ–å¾Œï¼‰
  * [ ] å¿œåŠ›ãƒ†ãƒ³ã‚½ãƒ«ãŒã»ã¼ã‚¼ãƒ­ï¼ˆNPTæœ€é©åŒ–å¾Œï¼‰

#### ãƒãƒ³ãƒ‰æ§‹é€ ã®å¦¥å½“æ€§

  * [ ] ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã®ç¬¦å·ãŒæ­£ã—ã„ï¼ˆé‡‘å± vs çµ¶ç¸ä½“ï¼‰
  * [ ] å¯¾ç§°æ€§ãŒä¿ãŸã‚Œã‚‹ï¼ˆé«˜å¯¾ç§°ç‚¹ã§ãƒãƒ³ãƒ‰ãŒç¸®é€€ï¼‰
  * [ ] åˆ†æ•£é–¢ä¿‚ãŒæ»‘ã‚‰ã‹ï¼ˆãƒã‚¤ã‚ºãªã—ï¼‰
  * [ ] ãƒ•ã‚§ãƒ«ãƒŸæº–ä½ãŒé©åˆ‡ï¼ˆé‡‘å±ã§0 eVï¼‰

#### æ•°å€¤çš„å¥å…¨æ€§

  * [ ] ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæœ‰é™ï¼ˆç™ºæ•£ãªã—ï¼‰
  * [ ] åŠ›ã®æˆåˆ†ãŒã™ã¹ã¦æœ‰é™
  * [ ] é›»è·ä¿å­˜: ç·é›»å­æ•° = åŸå­æ ¸ã®é›»è·å’Œ
  * [ ] åœ§åŠ›ãŒç‰©ç†çš„ç¯„å›²ï¼ˆÂ±100 GPaï¼‰

### DFTç‰¹æœ‰ã®å“è³ªãƒã‚§ãƒƒã‚¯

#### äº¤æ›ç›¸é–¢æ±é–¢æ•°ã®é¸æŠ

  * [ ] PBEï¼ˆæ¨™æº–ï¼‰: çµæ™¶æ§‹é€ ã€æ ¼å­å®šæ•°
  * [ ] LDA: éå»ã®ãƒ‡ãƒ¼ã‚¿ã¨ã®æ¯”è¼ƒ
  * [ ] vdW-DF: å±¤çŠ¶ç‰©è³ªã€åˆ†å­çµæ™¶
  * [ ] HSE/PBE0: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ï¼ˆè¨ˆç®—ã‚³ã‚¹ãƒˆå¤§ï¼‰

#### æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ¤œè¨¼

  * [ ] PAW dataset ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¨˜éŒ²
  * [ ] ä¾¡é›»å­æ•°ãŒæ­£ã—ã„
  * [ ] ã‚«ãƒƒãƒˆã‚ªãƒ•ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæ¨å¥¨å€¤ä»¥ä¸Š
  * [ ] è¤‡æ•°ã®æ“¬ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã§æ¤œè¨¼ï¼ˆå¯èƒ½ãªã‚‰ï¼‰

* * *

## å‚è€ƒæ–‡çŒ®

  1. Hohenberg, P., & Kohn, W. (1964). "Inhomogeneous Electron Gas." _Physical Review_ , 136(3B), B864-B871. DOI: [10.1103/PhysRev.136.B864](<https://doi.org/10.1103/PhysRev.136.B864>)

  2. Kohn, W., & Sham, L. J. (1965). "Self-Consistent Equations Including Exchange and Correlation Effects." _Physical Review_ , 140(4A), A1133-A1138. DOI: [10.1103/PhysRev.140.A1133](<https://doi.org/10.1103/PhysRev.140.A1133>)

  3. Perdew, J. P., Burke, K., & Ernzerhof, M. (1996). "Generalized Gradient Approximation Made Simple." _Physical Review Letters_ , 77(18), 3865-3868. DOI: [10.1103/PhysRevLett.77.3865](<https://doi.org/10.1103/PhysRevLett.77.3865>)

  4. Martin, R. M. (2004). _Electronic Structure: Basic Theory and Practical Methods_. Cambridge University Press.

  5. ASE Documentation: https://wiki.fysik.dtu.dk/ase/

  6. GPAW Documentation: https://wiki.fysik.dtu.dk/gpaw/

* * *

## è‘—è€…æƒ…å ±

**ä½œæˆè€…** : MI Knowledge Hub Content Team **ä½œæˆæ—¥** : 2025-10-17 **ãƒãƒ¼ã‚¸ãƒ§ãƒ³** : 1.0 **ã‚·ãƒªãƒ¼ã‚º** : è¨ˆç®—ææ–™ç§‘å­¦åŸºç¤å…¥é–€ v1.0

**ãƒ©ã‚¤ã‚»ãƒ³ã‚¹** : Creative Commons BY-NC-SA 4.0
