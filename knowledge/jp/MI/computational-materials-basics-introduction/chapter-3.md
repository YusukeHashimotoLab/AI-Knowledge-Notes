---
title: ç¬¬3ç« ï¼šåˆ†å­å‹•åŠ›å­¦ï¼ˆMDï¼‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
chapter_title: ç¬¬3ç« ï¼šåˆ†å­å‹•åŠ›å­¦ï¼ˆMDï¼‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
subtitle: åŸå­ã®é‹å‹•ã¨ç†±åŠ›å­¦ç‰¹æ€§ã®è¨ˆç®—
reading_time: 20-25åˆ†
difficulty: ä¸­ç´š
code_examples: 7
exercises: 0
---

# ç¬¬3ç« ï¼šåˆ†å­å‹•åŠ›å­¦ï¼ˆMDï¼‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

é‹å‹•æ–¹ç¨‹å¼ã¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®é–¢ä¿‚ã‚’æŠŠæ¡ã—ã€æ¸©åº¦ãƒ»åœ§åŠ›åˆ¶å¾¡ã®åŸºæœ¬ã‚’ç†è§£ã—ã¾ã™ã€‚

**ğŸ’¡ è£œè¶³:** æ¸©åº¦ã¯é‹å‹•ã®æ¿€ã—ã•ã€åœ§åŠ›ã¯è©°ã‚è¾¼ã¿å…·åˆã®æŒ‡æ¨™ã€‚åˆ¶å¾¡æ³•ã®é•ã„ã¯â€œç’°å¢ƒã®ä½œã‚Šæ–¹â€ã®é•ã„ã§ã™ã€‚

## å­¦ç¿’ç›®æ¨™

ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š \- MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®åŸºæœ¬åŸç†ï¼ˆãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³é‹å‹•æ–¹ç¨‹å¼ã€æ™‚é–“ç©åˆ†ï¼‰ã‚’ç†è§£ã™ã‚‹ \- åŠ›å ´ï¼ˆForce Fieldï¼‰ã¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ¦‚å¿µã‚’ç†è§£ã™ã‚‹ \- çµ±è¨ˆã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ï¼ˆNVEã€NVTã€NPTï¼‰ã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹ \- LAMMPSã§åŸºæœ¬çš„ãªMDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹ \- Ab Initio MDï¼ˆAIMDï¼‰ã¨Classical MDã®é•ã„ã‚’ç†è§£ã™ã‚‹

* * *

## 3.1 åˆ†å­å‹•åŠ›å­¦ã®åŸºæœ¬åŸç†

### ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ã®é‹å‹•æ–¹ç¨‹å¼

MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ ¸å¿ƒã¯ã€å¤å…¸åŠ›å­¦ã®**ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³ã®é‹å‹•æ–¹ç¨‹å¼** ã§ã™ï¼š

$$ m_i \frac{d^2 \mathbf{r}_i}{dt^2} = \mathbf{F}_i = -\nabla_i U(\mathbf{r}_1, \mathbf{r}_2, \ldots, \mathbf{r}_N) $$

  * $m_i$: åŸå­$i$ã®è³ªé‡
  * $\mathbf{r}_i$: åŸå­$i$ã®ä½ç½®
  * $\mathbf{F}_i$: åŸå­$i$ã«åƒãåŠ›
  * $U(\mathbf{r}_1, \ldots, \mathbf{r}_N)$: ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼

### MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æ‰‹é †
    
    
    ```mermaid
    flowchart TD
        A[åˆæœŸé…ç½®ãƒ»é€Ÿåº¦ã‚’è¨­å®š] --> B[åŠ›ã‚’è¨ˆç®—: F = -âˆ‡U]
        B --> C[ä½ç½®ãƒ»é€Ÿåº¦ã‚’æ›´æ–°: æ™‚é–“ç©åˆ†]
        C --> D[ç‰©ç†é‡ã‚’è¨ˆç®—: T, P, E, etc.]
        D --> E{æ™‚é–“çµ‚äº†?}
        E -->|No| B
        E -->|Yes| F[ãƒ‡ãƒ¼ã‚¿è§£æãƒ»å¯è¦–åŒ–]
    
        style A fill:#e3f2fd
        style F fill:#c8e6c9
    ```

**æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—** : å…¸å‹çš„ã«ã¯$\Delta t = 0.5$-$2$ fsï¼ˆãƒ•ã‚§ãƒ ãƒˆç§’ã€$10^{-15}$ç§’ï¼‰

* * *

## 3.2 æ™‚é–“ç©åˆ†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

### Verletæ³•ï¼ˆæœ€ã‚‚åŸºæœ¬çš„ï¼‰

ä½ç½®ã®Taylorå±•é–‹ï¼š

$$ \mathbf{r}(t + \Delta t) = \mathbf{r}(t) + \mathbf{v}(t)\Delta t + \frac{1}{2}\mathbf{a}(t)\Delta t^2 + O(\Delta t^3) $$

$$ \mathbf{r}(t - \Delta t) = \mathbf{r}(t) - \mathbf{v}(t)\Delta t + \frac{1}{2}\mathbf{a}(t)\Delta t^2 + O(\Delta t^3) $$

2å¼ã‚’è¶³ã™ã¨ï¼š

$$ \mathbf{r}(t + \Delta t) = 2\mathbf{r}(t) - \mathbf{r}(t - \Delta t) + \mathbf{a}(t)\Delta t^2 $$

**ç‰¹å¾´** : \- âœ… ã‚·ãƒ³ãƒ—ãƒ«ã€ãƒ¡ãƒ¢ãƒªåŠ¹ç‡è‰¯ã„ \- âœ… æ™‚é–“åè»¢å¯¾ç§°æ€§ã‚’ä¿ã¤ \- âŒ é€Ÿåº¦ãŒé™½ã«ç¾ã‚Œãªã„

### Velocity Verletæ³•ï¼ˆæœ€ã‚‚ã‚ˆãä½¿ã‚ã‚Œã‚‹ï¼‰

$$ \mathbf{r}(t + \Delta t) = \mathbf{r}(t) + \mathbf{v}(t)\Delta t + \frac{1}{2}\mathbf{a}(t)\Delta t^2 $$

$$ \mathbf{v}(t + \Delta t) = \mathbf{v}(t) + \frac{1}{2}[\mathbf{a}(t) + \mathbf{a}(t + \Delta t)]\Delta t $$

**ç‰¹å¾´** : \- âœ… ä½ç½®ã¨é€Ÿåº¦ã‚’åŒæ™‚ã«æ›´æ–° \- âœ… ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ãŒè‰¯ã„ \- âœ… æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹

### Leap-frogæ³•

$$ \mathbf{v}(t + \frac{\Delta t}{2}) = \mathbf{v}(t - \frac{\Delta t}{2}) + \mathbf{a}(t)\Delta t $$

$$ \mathbf{r}(t + \Delta t) = \mathbf{r}(t) + \mathbf{v}(t + \frac{\Delta t}{2})\Delta t $$

ä½ç½®ã¨é€Ÿåº¦ãŒåŠæ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ãšã‚Œã‚‹ã€Œè·³ã³çŸ³ã€ã®ã‚ˆã†ãªå‹•ãã€‚

### Pythonã§ã®å®Ÿè£…ä¾‹
    
    
    import numpy as np
    import matplotlib.pyplot as plt
    
    def lennard_jones(r, epsilon=1.0, sigma=1.0):
        """Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«"""
        return 4 * epsilon * ((sigma/r)**12 - (sigma/r)**6)
    
    def lj_force(r, epsilon=1.0, sigma=1.0):
        """Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®åŠ›"""
        return 24 * epsilon * (2*(sigma/r)**13 - (sigma/r)**7) / r
    
    def velocity_verlet_md(N_steps=1000, dt=0.001):
        """
        Velocity Verletæ³•ã«ã‚ˆã‚‹1æ¬¡å…ƒMDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        2ã¤ã®Lennard-Jonesç²’å­
        """
        # åˆæœŸæ¡ä»¶
        r = np.array([0.0, 2.0])  # ä½ç½®
        v = np.array([0.5, -0.5])  # é€Ÿåº¦
        m = np.array([1.0, 1.0])  # è³ªé‡
    
        # å±¥æ­´ä¿å­˜ç”¨
        r_history = np.zeros((N_steps, 2))
        v_history = np.zeros((N_steps, 2))
        E_history = np.zeros(N_steps)
    
        for step in range(N_steps):
            # åŠ›ã®è¨ˆç®—
            r12 = r[1] - r[0]
            F = lj_force(abs(r12))
            a = np.array([-F/m[0], F/m[1]])  # åŠ é€Ÿåº¦
    
            # ä½ç½®ã®æ›´æ–°
            r = r + v * dt + 0.5 * a * dt**2
    
            # æ–°ã—ã„åŠ›ã®è¨ˆç®—
            r12_new = r[1] - r[0]
            F_new = lj_force(abs(r12_new))
            a_new = np.array([-F_new/m[0], F_new/m[1]])
    
            # é€Ÿåº¦ã®æ›´æ–°
            v = v + 0.5 * (a + a_new) * dt
    
            # ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—
            KE = 0.5 * np.sum(m * v**2)
            PE = lennard_jones(abs(r12_new))
            E_total = KE + PE
    
            # ä¿å­˜
            r_history[step] = r
            v_history[step] = v
            E_history[step] = E_total
    
        return r_history, v_history, E_history
    
    # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
    r_hist, v_hist, E_hist = velocity_verlet_md(N_steps=5000, dt=0.001)
    
    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig, axes = plt.subplots(2, 2, figsize=(12, 10))
    time = np.arange(len(r_hist)) * 0.001
    
    # ä½ç½®
    axes[0,0].plot(time, r_hist[:, 0], label='Particle 1')
    axes[0,0].plot(time, r_hist[:, 1], label='Particle 2')
    axes[0,0].set_xlabel('Time')
    axes[0,0].set_ylabel('Position')
    axes[0,0].set_title('Particle Positions')
    axes[0,0].legend()
    axes[0,0].grid(alpha=0.3)
    
    # é€Ÿåº¦
    axes[0,1].plot(time, v_hist[:, 0], label='Particle 1')
    axes[0,1].plot(time, v_hist[:, 1], label='Particle 2')
    axes[0,1].set_xlabel('Time')
    axes[0,1].set_ylabel('Velocity')
    axes[0,1].set_title('Particle Velocities')
    axes[0,1].legend()
    axes[0,1].grid(alpha=0.3)
    
    # ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜
    axes[1,0].plot(time, E_hist)
    axes[1,0].set_xlabel('Time')
    axes[1,0].set_ylabel('Total Energy')
    axes[1,0].set_title('Energy Conservation (NVE)')
    axes[1,0].grid(alpha=0.3)
    
    # ç›¸ç©ºé–“è»Œé“
    axes[1,1].plot(r_hist[:, 0] - r_hist[:, 1], v_hist[:, 0], alpha=0.5)
    axes[1,1].set_xlabel('Relative Position')
    axes[1,1].set_ylabel('Velocity 1')
    axes[1,1].set_title('Phase Space Trajectory')
    axes[1,1].grid(alpha=0.3)
    
    plt.tight_layout()
    plt.savefig('md_verlet.png', dpi=150)
    plt.show()
    
    print(f"ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰å‹•: {np.std(E_hist):.6f} (ç†æƒ³çš„ã«ã¯0ã«è¿‘ã„)")
    

**å®Ÿè¡Œçµæœ** : ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰å‹• < $10^{-6}$ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜å‰‡ãŒè‰¯å¥½ï¼‰

* * *

## 3.3 åŠ›å ´ï¼ˆForce Fieldï¼‰ã¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«

### Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«

æœ€ã‚‚åŸºæœ¬çš„ãª2ä½“ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼š

$$ U_{\text{LJ}}(r) = 4\epsilon \left[\left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6\right] $$

  * $\epsilon$: ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã®æ·±ã•ï¼ˆçµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰
  * $\sigma$: å¹³è¡¡è·é›¢ã®ã‚¹ã‚±ãƒ¼ãƒ«
  * $r^{-12}$: çŸ­è·é›¢æ–¥åŠ›ï¼ˆPauliæ–¥åŠ›ï¼‰
  * $r^{-6}$: é•·è·é›¢å¼•åŠ›ï¼ˆvan der WaalsåŠ›ï¼‰

**ç”¨é€”** : å¸Œã‚¬ã‚¹ï¼ˆAr, Neï¼‰ã€ç²—è¦–åŒ–ãƒ¢ãƒ‡ãƒ«

### å¤šä½“ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«

**Embedded Atom Method (EAM)** \- é‡‘å±å‘ã‘:

$$ U_{\text{EAM}} = \sum_i F_i(\rho_i) + \frac{1}{2}\sum_{i \neq j} \phi_{ij}(r_{ij}) $$

  * $F_i(\rho_i)$: åŸ‹ã‚è¾¼ã¿ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆé›»å­å¯†åº¦$\rho_i$ã®é–¢æ•°ï¼‰
  * $\phi_{ij}(r_{ij})$: å¯¾ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«

**Tersoff/Brenner** \- å…±æœ‰çµåˆç³»ï¼ˆC, Si, Geï¼‰:

$$ U_{\text{Tersoff}} = \sum_i \sum_{j>i} [f_R(r_{ij}) - b_{ij} f_A(r_{ij})] $$

$b_{ij}$ã¯çµåˆæ¬¡æ•°ï¼ˆbond orderï¼‰ã€å‘¨å›²ã®ç’°å¢ƒã«ä¾å­˜ã€‚

### æ°´ã®åŠ›å ´

**TIP3P** ï¼ˆ3ç‚¹é›»è·ãƒ¢ãƒ‡ãƒ«ï¼‰: \- OåŸå­ã«è² é›»è·$-0.834e$ \- å„HåŸå­ã«æ­£é›»è·$+0.417e$ \- Lennard-Jonesãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆO-Oé–“ã®ã¿ï¼‰

**ç‰¹å¾´** : \- âœ… è¨ˆç®—ãŒé«˜é€Ÿ \- âœ… æ¶²ä½“æ°´ã®å¯†åº¦ãƒ»æ‹¡æ•£ä¿‚æ•°ã‚’å†ç¾ \- âŒ æ°·ã®æ§‹é€ ã¯ä¸æ­£ç¢º

* * *

## 3.4 çµ±è¨ˆã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«

### NVEï¼ˆå¾®å°æ­£æº–ï¼‰ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«

**æ¡ä»¶** : ç²’å­æ•°$N$ã€ä½“ç©$V$ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼$E$ãŒä¸€å®šï¼ˆå­¤ç«‹ç³»ï¼‰

**å®Ÿè£…** : æ™‚é–“ç©åˆ†ã®ã¿ï¼ˆç†±æµ´ãªã—ï¼‰

**ç”¨é€”** : \- ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®ãƒ†ã‚¹ãƒˆ \- ç†è«–çš„åŸºç¤ç ”ç©¶

### NVTï¼ˆæ­£æº–ï¼‰ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«

**æ¡ä»¶** : ç²’å­æ•°$N$ã€ä½“ç©$V$ã€æ¸©åº¦$T$ãŒä¸€å®šï¼ˆç†±æµ´ã¨æ¥è§¦ï¼‰

**NosÃ©-Hooverç†±æµ´** :

$$ \frac{d\mathbf{r}_i}{dt} = \mathbf{v}_i $$

$$ \frac{d\mathbf{v}_i}{dt} = \frac{\mathbf{F}_i}{m_i} - \zeta \mathbf{v}_i $$

$$ \frac{d\zeta}{dt} = \frac{1}{Q}\left(\sum_i m_i v_i^2 - 3NkT\right) $$

  * $\zeta$: ç†±æµ´å¤‰æ•°ï¼ˆæ‘©æ“¦ä¿‚æ•°ã®ã‚ˆã†ãªå½¹å‰²ï¼‰
  * $Q$: ç†±æµ´ã®ã€Œè³ªé‡ã€ï¼ˆç·©å’Œæ™‚é–“ã‚’åˆ¶å¾¡ï¼‰

**ç”¨é€”** : \- å¹³è¡¡çŠ¶æ…‹ã®ç†±åŠ›å­¦é‡è¨ˆç®— \- ç›¸è»¢ç§»ã®ç ”ç©¶

### NPTï¼ˆç­‰æ¸©ç­‰åœ§ï¼‰ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«

**æ¡ä»¶** : ç²’å­æ•°$N$ã€åœ§åŠ›$P$ã€æ¸©åº¦$T$ãŒä¸€å®šï¼ˆç†±æµ´ï¼‹åœ§åŠ›æµ´ï¼‰

**Parrinello-Rahmanæ³•** : ã‚»ãƒ«ã®å½¢çŠ¶ã¨ã‚µã‚¤ã‚ºãŒå¤‰å‹•

**ç”¨é€”** : \- å®Ÿé¨“æ¡ä»¶ã¨ã®ç›´æ¥æ¯”è¼ƒ \- æ ¼å­å®šæ•°ã®è¨ˆç®— \- ç›¸è»¢ç§»ï¼ˆå›º-æ¶²ãªã©ï¼‰

### æ¯”è¼ƒè¡¨

ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ« | ä¿å­˜é‡ | å¤‰å‹•é‡ | ç”¨é€”  
---|---|---|---  
NVE | $N, V, E$ | $T, P$ | å­¤ç«‹ç³»ã€æ¤œè¨¼  
NVT | $N, V, T$ | $E, P$ | ç†±å¹³è¡¡çŠ¶æ…‹  
NPT | $N, P, T$ | $E, V$ | å®Ÿé¨“æ¡ä»¶å†ç¾  
  
* * *

## 3.5 LAMMPSã«ã‚ˆã‚‹å®Ÿè·µ

### LAMMPSã¨ã¯

**LAMMPS** ï¼ˆLarge-scale Atomic/Molecular Massively Parallel Simulatorï¼‰: \- Sandia National LaboratoryãŒé–‹ç™º \- ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã€ç„¡æ–™ \- ä¸¦åˆ—è¨ˆç®—ã«æœ€é©åŒ–ï¼ˆæ•°å„„åŸå­ã‚¹ã‚±ãƒ¼ãƒ«å¯èƒ½ï¼‰

### Example 1: Arã‚¬ã‚¹ã®å¹³è¡¡åŒ–ï¼ˆNVTï¼‰
    
    
    # LAMMPSå…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«: ar_nvt.in
    
    # åˆæœŸè¨­å®š
    units lj                    # Lennard-Joneså˜ä½ç³»
    atom_style atomic
    dimension 3
    boundary p p p              # å‘¨æœŸå¢ƒç•Œæ¡ä»¶
    
    # ç³»ã®ä½œæˆ
    region box block 0 10 0 10 0 10
    create_box 1 box
    create_atoms 1 random 100 12345 box
    
    # è³ªé‡è¨­å®š
    mass 1 1.0
    
    # ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«
    pair_style lj/cut 2.5
    pair_coeff 1 1 1.0 1.0 2.5  # epsilon, sigma, cutoff
    
    # åˆæœŸé€Ÿåº¦ï¼ˆæ¸©åº¦1.0ã«å¯¾å¿œï¼‰
    velocity all create 1.0 87287 dist gaussian
    
    # NVTè¨­å®šï¼ˆNosÃ©-Hooverï¼‰
    fix 1 all nvt temp 1.0 1.0 0.1
    
    # æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—
    timestep 0.005
    
    # ç†±åŠ›å­¦å‡ºåŠ›
    thermo 100
    thermo_style custom step temp press pe ke etotal vol density
    
    # ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªä¿å­˜
    dump 1 all custom 1000 ar_nvt.lammpstrj id type x y z vx vy vz
    
    # å®Ÿè¡Œ
    run 10000
    
    # çµ‚äº†
    write_data ar_nvt_final.data
    

**å®Ÿè¡Œ** :
    
    
    lammps -in ar_nvt.in
    

### Example 2: Pythonã‹ã‚‰ LAMMPSã‚’åˆ¶å¾¡
    
    
    from lammps import lammps
    import numpy as np
    import matplotlib.pyplot as plt
    
    # LAMMPSã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
    lmp = lammps()
    
    # å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ
    lmp.file('ar_nvt.in')
    
    # ç†±åŠ›å­¦ãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡º
    temps = lmp.extract_compute("thermo_temp", 0, 0)
    press = lmp.extract_compute("thermo_press", 0, 0)
    
    print(f"å¹³è¡¡æ¸©åº¦: {temps:.3f} (ç›®æ¨™: 1.0)")
    print(f"å¹³è¡¡åœ§åŠ›: {press:.3f}")
    
    # å‹•å¾„åˆ†å¸ƒé–¢æ•°ï¼ˆRDFï¼‰ã®è¨ˆç®—
    lmp.command("compute myRDF all rdf 100")
    lmp.command("fix 2 all ave/time 100 1 100 c_myRDF[*] file ar_rdf.dat mode vector")
    lmp.command("run 5000")
    
    # RDFã®èª­ã¿è¾¼ã¿ã¨ãƒ—ãƒ­ãƒƒãƒˆ
    rdf_data = np.loadtxt('ar_rdf.dat')
    r = rdf_data[:, 1]
    g_r = rdf_data[:, 2]
    
    plt.figure(figsize=(8, 6))
    plt.plot(r, g_r, linewidth=2)
    plt.xlabel('r (Ïƒ)', fontsize=12)
    plt.ylabel('g(r)', fontsize=12)
    plt.title('Radial Distribution Function (Ar gas)', fontsize=14)
    plt.grid(alpha=0.3)
    plt.savefig('ar_rdf.png', dpi=150)
    plt.show()
    
    lmp.close()
    

* * *

### Example 3: æ°´åˆ†å­ã®MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆTIP3Pï¼‰
    
    
    # water_nvt.in
    
    units real                  # å®Ÿå˜ä½ç³» (Ã…, fs, kcal/mol)
    atom_style full
    dimension 3
    boundary p p p
    
    # ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ï¼ˆæ°´åˆ†å­216å€‹ï¼‰
    read_data water_box.data
    
    # TIP3Pæ°´ãƒ¢ãƒ‡ãƒ«
    pair_style lj/cut/coul/long 10.0
    pair_coeff 1 1 0.102 3.188   # O-O
    pair_coeff * 2 0.0 0.0       # HåŸå­ã¯LJãªã—
    kspace_style pppm 1e-4       # é•·è·é›¢ã‚¯ãƒ¼ãƒ­ãƒ³ï¼ˆEwaldå’Œï¼‰
    
    # çµåˆãƒ»è§’åº¦
    bond_style harmonic
    bond_coeff 1 450.0 0.9572    # O-Hçµåˆ
    angle_style harmonic
    angle_coeff 1 55.0 104.52    # H-O-Hè§’åº¦
    
    # SHAKEåˆ¶ç´„ï¼ˆO-Hçµåˆã‚’å›ºå®šï¼‰
    fix shake all shake 0.0001 20 0 b 1 a 1
    
    # NVTï¼ˆ300Kï¼‰
    fix 1 all nvt temp 300.0 300.0 100.0
    
    # æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—
    timestep 1.0  # 1 fs
    
    # å‡ºåŠ›
    thermo 100
    dump 1 all custom 1000 water.lammpstrj id mol type x y z
    
    # å®Ÿè¡Œï¼ˆ100 psï¼‰
    run 100000
    

**æ‹¡æ•£ä¿‚æ•°ã®è¨ˆç®—** :
    
    
    import numpy as np
    from MDAnalysis import Universe
    import matplotlib.pyplot as plt
    
    # ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªèª­ã¿è¾¼ã¿
    u = Universe('water_box.data', 'water.lammpstrj', format='LAMMPSDUMP')
    
    # é…¸ç´ åŸå­ã®ã¿é¸æŠ
    oxygens = u.select_atoms('type 1')
    
    # å¹³å‡äºŒä¹—å¤‰ä½ï¼ˆMSDï¼‰ã®è¨ˆç®—
    n_frames = len(u.trajectory)
    msd = np.zeros(n_frames)
    
    for i, ts in enumerate(u.trajectory):
        if i == 0:
            r0 = oxygens.positions.copy()
        dr = oxygens.positions - r0
        msd[i] = np.mean(np.sum(dr**2, axis=1))
    
    # æ™‚é–“è»¸ï¼ˆfsï¼‰
    time = np.arange(n_frames) * 1.0
    
    # ãƒ—ãƒ­ãƒƒãƒˆ
    plt.figure(figsize=(8, 6))
    plt.plot(time/1000, msd, linewidth=2)
    plt.xlabel('Time (ps)', fontsize=12)
    plt.ylabel('MSD (Ã…Â²)', fontsize=12)
    plt.title('Mean Square Displacement (Hâ‚‚O)', fontsize=14)
    plt.grid(alpha=0.3)
    plt.savefig('water_msd.png', dpi=150)
    plt.show()
    
    # æ‹¡æ•£ä¿‚æ•°ã®è¨ˆç®—ï¼ˆEinsteiné–¢ä¿‚å¼ï¼‰
    # MSD = 6Dt â†’ D = slope / 6
    slope = np.polyfit(time[len(time)//2:], msd[len(time)//2:], 1)[0]
    D = slope / 6 / 1000  # Ã…Â²/ps â†’ 10â»âµ cmÂ²/s
    print(f"æ‹¡æ•£ä¿‚æ•°: {D:.2f} Ã— 10â»âµ cmÂ²/s")
    print(f"å®Ÿé¨“å€¤: 2.30 Ã— 10â»âµ cmÂ²/s (300K)")
    

* * *

## 3.6 Ab Initio MDï¼ˆAIMDï¼‰

### Classical MD vs Ab Initio MD

é …ç›® | Classical MD | Ab Initio MD  
---|---|---  
**åŠ›ã®è¨ˆç®—** | çµŒé¨“çš„ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ï¼ˆåŠ›å ´ï¼‰ | DFTè¨ˆç®—ï¼ˆç¬¬ä¸€åŸç†ï¼‰  
**ç²¾åº¦** | åŠ›å ´ã«ä¾å­˜ | é‡å­åŠ›å­¦çš„ã«æ­£ç¢º  
**è¨ˆç®—ã‚³ã‚¹ãƒˆ** | ä½ã„ï¼ˆ$\sim$1 ns/dayï¼‰ | æ¥µã‚ã¦é«˜ã„ï¼ˆ$\sim$10 ps/dayï¼‰  
**ç³»ã®ã‚µã‚¤ã‚º** | æ•°ç™¾ä¸‡åŸå­ | æ•°ç™¾åŸå­  
**ç”¨é€”** | å¤§è¦æ¨¡ç³»ã€é•·æ™‚é–“ | åŒ–å­¦åå¿œã€é›»å­çŠ¶æ…‹  
  
### Born-Oppenheimer MDï¼ˆBOMDï¼‰

å„æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ã§DFTè¨ˆç®—ã‚’å®Ÿè¡Œï¼š
    
    
    1. åŸå­é…ç½® R(t) ã‚’ä¸ãˆã‚‹
    2. DFTè¨ˆç®—ã§åŸºåº•çŠ¶æ…‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ E(R(t)) ã‚’è¨ˆç®—
    3. åŠ› F = -âˆ‡E ã‚’è¨ˆç®—
    4. ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³æ–¹ç¨‹å¼ã§ R(t+Î”t) ã‚’è¨ˆç®—
    5. 1ã«æˆ»ã‚‹
    

### GPAWã«ã‚ˆã‚‹AIMDå®Ÿè£…ä¾‹
    
    
    from ase import Atoms
    from ase.md.velocitydistribution import MaxwellBoltzmannDistribution
    from ase.md.verlet import VelocityVerlet
    from ase import units
    from gpaw import GPAW, PW
    
    # æ°´åˆ†å­ã®ä½œæˆ
    h2o = Atoms('H2O',
                positions=[[0.00, 0.00, 0.00],
                           [0.96, 0.00, 0.00],
                           [0.24, 0.93, 0.00]])
    h2o.center(vacuum=5.0)
    
    # DFTè¨ˆç®—æ©Ÿï¼ˆåŠ›å ´ã®ä»£ã‚ã‚Šï¼‰
    calc = GPAW(mode=PW(400),
                xc='PBE',
                txt='h2o_aimd.txt')
    
    h2o.calc = calc
    
    # åˆæœŸé€Ÿåº¦ï¼ˆ300Kï¼‰
    MaxwellBoltzmannDistribution(h2o, temperature_K=300)
    
    # Velocity Verlet MD
    dyn = VelocityVerlet(h2o, timestep=1.0*units.fs,
                         trajectory='h2o_aimd.traj')
    
    # 10 pså®Ÿè¡Œï¼ˆå®Ÿéš›ã«ã¯éå¸¸ã«æ™‚é–“ãŒã‹ã‹ã‚‹ï¼‰
    def print_energy(a=h2o):
        epot = a.get_potential_energy()
        ekin = a.get_kinetic_energy()
        print(f"Time: {dyn.get_time()/units.fs:.1f} fs, "
              f"Epot: {epot:.3f} eV, "
              f"Ekin: {ekin:.3f} eV, "
              f"Etot: {epot+ekin:.3f} eV")
    
    dyn.attach(print_energy, interval=10)
    dyn.run(100)  # 100ã‚¹ãƒ†ãƒƒãƒ— = 100 fs
    

**ç”¨é€”** : \- åŒ–å­¦åå¿œã®ç ”ç©¶ \- ç›¸è»¢ç§»ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ  \- åŠ›å ´ãŒå­˜åœ¨ã—ãªã„æ–°è¦ææ–™

* * *

## 3.7 æœ¬ç« ã®ã¾ã¨ã‚

### å­¦ã‚“ã ã“ã¨

  1. **MDã®åŸºæœ¬åŸç†** \- ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ³é‹å‹•æ–¹ç¨‹å¼ \- æ™‚é–“ç©åˆ†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ï¼ˆVerletã€Velocity Verletã€Leap-frogï¼‰ \- ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜å‰‡

  2. **åŠ›å ´ã¨ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«** \- Lennard-Jonesï¼ˆå¸Œã‚¬ã‚¹ï¼‰ \- EAMï¼ˆé‡‘å±ï¼‰ \- Tersoff/Brennerï¼ˆå…±æœ‰çµåˆç³»ï¼‰ \- TIP3Pï¼ˆæ°´ï¼‰

  3. **çµ±è¨ˆã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«** \- NVEï¼ˆå¾®å°æ­£æº–ï¼‰ \- NVTï¼ˆæ­£æº–ã€NosÃ©-Hooverç†±æµ´ï¼‰ \- NPTï¼ˆç­‰æ¸©ç­‰åœ§ã€Parrinello-Rahmanï¼‰

  4. **LAMMPSã«ã‚ˆã‚‹å®Ÿè·µ** \- å…¥åŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ \- å¹³è¡¡åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ \- å‹•å¾„åˆ†å¸ƒé–¢æ•°ã€æ‹¡æ•£ä¿‚æ•°

  5. **Ab Initio MD** \- Classical MDã¨ã®é•ã„ \- Born-Oppenheimer MD \- GPAWã§ã®å®Ÿè£…

### é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

  * MDã¯å¤å…¸åŠ›å­¦ã«åŸºã¥ã
  * æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ã¯ç´„1 fs
  * çµ±è¨ˆã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã§å®Ÿé¨“æ¡ä»¶ã‚’å†ç¾
  * åŠ›å ´ã®é¸æŠãŒç²¾åº¦ã‚’æ±ºã‚ã‚‹
  * AIMDã¯ç²¾åº¦ãŒé«˜ã„ãŒè¨ˆç®—ã‚³ã‚¹ãƒˆå¤§

### æ¬¡ã®ç« ã¸

ç¬¬4ç« ã§ã¯ã€æ ¼å­æŒ¯å‹•ï¼ˆãƒ•ã‚©ãƒãƒ³ï¼‰ã¨ç†±åŠ›å­¦ç‰¹æ€§ã®è¨ˆç®—ã‚’å­¦ã³ã¾ã™ã€‚

* * *

## æ¼”ç¿’å•é¡Œ

### å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰

Velocity Verletæ³•ã¨Leap-frogæ³•ã®é•ã„ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

è§£ç­”ä¾‹ **Velocity Verletæ³•**: \- ä½ç½®$\mathbf{r}$ã¨é€Ÿåº¦$\mathbf{v}$ã‚’åŒã˜æ™‚åˆ»$t$ã§æ›´æ–° \- é€Ÿåº¦ã¯ç¾åœ¨ã¨æ¬¡æ™‚åˆ»ã®åŠ é€Ÿåº¦ã®å¹³å‡ã‚’ä½¿ç”¨ \- ç†±åŠ›å­¦é‡ï¼ˆæ¸©åº¦ã€é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ãŒç›´æ¥è¨ˆç®—å¯èƒ½ **Leap-frogæ³•**: \- ä½ç½®$\mathbf{r}(t)$ã¨é€Ÿåº¦$\mathbf{v}(t+\Delta t/2)$ãŒåŠæ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ãšã‚Œã‚‹ \- ã€Œè·³ã³çŸ³ã€ã®ã‚ˆã†ã«äº¤äº’ã«æ›´æ–° \- ç†±åŠ›å­¦é‡ã‚’è¨ˆç®—ã™ã‚‹ã«ã¯é€Ÿåº¦ã®è£œé–“ãŒå¿…è¦ **ã©ã¡ã‚‰ã‚‚**: \- ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜æ€§ã¯åŒç­‰ \- 2æ¬¡ç²¾åº¦ï¼ˆ$O(\Delta t^2)$ï¼‰ \- æ™‚é–“åè»¢å¯¾ç§°æ€§ã‚’æŒã¤ 

### å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰

NVTã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã¨NPTã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ã‚’ã„ã¤ä½¿ã†ã¹ãã‹ã€å…·ä½“ä¾‹ã¨ã¨ã‚‚ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚

è§£ç­”ä¾‹ **NVTã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ï¼ˆN, V, Tä¸€å®šï¼‰**: **ä½¿ç”¨å ´é¢**: \- å›ºä½“ã®ç†±åŠ›å­¦ç‰¹æ€§ï¼ˆæ¯”ç†±ã€ç†±è†¨å¼µä¿‚æ•°ï¼‰ \- æ¶²ä½“ã®æ§‹é€ å› å­ã€å‹•å¾„åˆ†å¸ƒé–¢æ•° \- è¡¨é¢ãƒ»ç•Œé¢ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆä½“ç©å›ºå®šï¼‰ \- ç‰¹å®šã®å¯†åº¦ã§ã®æŒ™å‹•ã‚’èª¿ã¹ãŸã„å ´åˆ **å…·ä½“ä¾‹**: \- Siçµæ™¶ã®300Kã§ã®åŸå­æŒ¯å‹• \- æ°´æº¶æ¶²ä¸­ã®ã‚¿ãƒ³ãƒ‘ã‚¯è³ªã®æ§‹é€ æºã‚‰ã \- ãƒªãƒã‚¦ãƒ ã‚¤ã‚ªãƒ³é›»æ± é›»è§£æ¶²ã®è¼¸é€ç‰¹æ€§ **NPTã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ï¼ˆN, P, Tä¸€å®šï¼‰**: **ä½¿ç”¨å ´é¢**: \- å®Ÿé¨“æ¡ä»¶ï¼ˆ1æ°—åœ§ã€å®¤æ¸©ãªã©ï¼‰ã¨ã®ç›´æ¥æ¯”è¼ƒ \- ç›¸è»¢ç§»ï¼ˆå›º-æ¶²ã€æ¶²-æ°—ï¼‰ \- æ ¼å­å®šæ•°ã®è¨ˆç®— \- å¯†åº¦ã®æ¸©åº¦ãƒ»åœ§åŠ›ä¾å­˜æ€§ **å…·ä½“ä¾‹**: \- 1æ°—åœ§ã€300Kã§ã®æ¶²ä½“æ°´ã®å¯†åº¦è¨ˆç®— \- é«˜åœ§ä¸‹ã§ã®ææ–™ã®æ§‹é€ å¤‰åŒ– \- ç†±è†¨å¼µä¿‚æ•°ã®è¨ˆç®— \- æ°·ã®èè§£ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ **åˆ¤æ–­åŸºæº–**: \- å®Ÿé¨“ãŒå®šåœ§æ¡ä»¶ â†’ NPT \- ç†è«–ç ”ç©¶ã§å¯†åº¦å›ºå®š â†’ NVT \- ç›¸è»¢ç§»ã®ç ”ç©¶ â†’ NPTï¼ˆä½“ç©å¤‰åŒ–ã‚’è¦³æ¸¬ï¼‰ 

### å•é¡Œ3ï¼ˆé›£æ˜“åº¦ï¼šhardï¼‰

Classical MDã¨Ab Initio MDã®è¨ˆç®—ã‚³ã‚¹ãƒˆã®é•ã„ã‚’ã€100åŸå­ç³»ã§è¦‹ç©ã‚‚ã£ã¦ãã ã•ã„ã€‚å„MDã‚¹ãƒ†ãƒƒãƒ—ã§DFTè¨ˆç®—ã«ã‹ã‹ã‚‹æ™‚é–“ãŒ1ç§’ã¨ã—ã¾ã™ã€‚

è§£ç­”ä¾‹ **å‰ææ¡ä»¶**: \- ç³»: 100åŸå­ \- æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—: $\Delta t = 1$ fs \- DFTè¨ˆç®—: 1ã‚¹ãƒ†ãƒƒãƒ—ã‚ãŸã‚Š1ç§’ **Classical MD**: åŠ›ã®è¨ˆç®—: åŠ›å ´ï¼ˆè§£æå¼ï¼‰ \- Lennard-Jonesã®å ´åˆ: $O(N^2)$ ã¾ãŸã¯ $O(N)$ï¼ˆã‚«ãƒƒãƒˆã‚ªãƒ•ä½¿ç”¨ï¼‰ \- 1ã‚¹ãƒ†ãƒƒãƒ—ã®è¨ˆç®—æ™‚é–“: $\sim 10^{-3}$ ç§’ï¼ˆ100åŸå­ç¨‹åº¦ï¼‰ **ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“**: \- 1 nsï¼ˆãƒŠãƒç§’ï¼‰= $10^6$ fs = $10^6$ã‚¹ãƒ†ãƒƒãƒ— \- ç·è¨ˆç®—æ™‚é–“: $10^6 \times 10^{-3}$ ç§’ = 1000ç§’ â‰ˆ **17åˆ†** **Ab Initio MD (AIMD)**: åŠ›ã®è¨ˆç®—: DFTï¼ˆSCFè¨ˆç®—ï¼‰ \- 1ã‚¹ãƒ†ãƒƒãƒ—ã®è¨ˆç®—æ™‚é–“: 1ç§’ï¼ˆå‰æï¼‰ **ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æ™‚é–“**: \- 10 psï¼ˆãƒ”ã‚³ç§’ï¼‰= $10^4$ fs = $10^4$ã‚¹ãƒ†ãƒƒãƒ— \- ç·è¨ˆç®—æ™‚é–“: $10^4 \times 1$ ç§’ = 10000ç§’ â‰ˆ **2.8æ™‚é–“** **æ¯”è¼ƒ**: | é …ç›® | Classical MD | AIMD | |-----|-------------|-----| | 1ã‚¹ãƒ†ãƒƒãƒ—è¨ˆç®—æ™‚é–“ | 0.001ç§’ | 1ç§’ | | åˆ°é”å¯èƒ½æ™‚é–“ | 1 ns (17åˆ†) | 10 ps (2.8æ™‚é–“) | | **æ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ«æ¯”** | **100å€é•·ã„** | - | | **è¨ˆç®—ã‚³ã‚¹ãƒˆæ¯”** | 1 | **1000å€** | **çµè«–**: \- AIMDã¯1ã‚¹ãƒ†ãƒƒãƒ—ã‚ãŸã‚Šç´„1000å€é…ã„ \- åŒã˜è¨ˆç®—æ™‚é–“ã§ã€Classical MDã¯100å€é•·ã„æ™‚é–“ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆå¯èƒ½ \- AIMDã¯åŒ–å­¦åå¿œï¼ˆps-nsã‚¹ã‚±ãƒ¼ãƒ«ï¼‰ã«ã¯é©ç”¨å¯èƒ½ \- æ‹¡æ•£éç¨‹ï¼ˆnsã‚¹ã‚±ãƒ¼ãƒ«ä»¥ä¸Šï¼‰ã«ã¯Classical MDãŒå¿…é ˆ **å®Ÿç”¨çš„æˆ¦ç•¥**: 1\. AIMDã§çŸ­æ™‚é–“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ10-100 psï¼‰ 2\. AIMDã®çµæœã‹ã‚‰åŠ›å ´ï¼ˆMachine Learning Potentialï¼‰ã‚’è¨“ç·´ 3\. MLPã‚’ä½¿ã£ãŸClassical MDã§é•·æ™‚é–“ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆns-Î¼sï¼‰ â†’ ç¬¬5ç« ã§MLPã«ã¤ã„ã¦è©³ã—ãå­¦ã³ã¾ã™ï¼ 

* * *

## ãƒ‡ãƒ¼ã‚¿ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¨å¼•ç”¨

### ä½¿ç”¨ã—ãŸã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ãƒ»åŠ›å ´

  1. **LAMMPS - Molecular Dynamics Simulator** (GPL v2) \- å¤§è¦æ¨¡ä¸¦åˆ—MDè¨ˆç®—ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ \- URL: https://www.lammps.org/ \- å¼•ç”¨: Thompson, A. P., et al. (2022). _Comp. Phys. Comm._ , 271, 108171.

  2. **ASE Molecular Dynamics Module** (LGPL v2.1+) \- Python MDãƒ©ã‚¤ãƒ–ãƒ©ãƒª \- URL: https://wiki.fysik.dtu.dk/ase/ase/md.html

  3. **åŠ›å ´ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹** \- **TIP3Pæ°´ãƒ¢ãƒ‡ãƒ«** : Jorgensen, W. L., et al. (1983). _J. Chem. Phys._ , 79, 926. \- **EAMé‡‘å±ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«** : OpenKIM Repository (CDDL License)

     * URL: https://openkim.org/
     * **Tersoff Siãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«** : Tersoff, J. (1988). _Phys. Rev. B_ , 38, 9902.

### æ¨™æº–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‡ºå…¸

  * **æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—** : 1-2 fsï¼ˆæ–‡çŒ®æ¨™æº–å€¤ï¼‰
  * **NosÃ©-Hooverç†±æµ´** : NosÃ©, S. (1984). _J. Chem. Phys._ , 81, 511.
  * **Parrinello-Rahman barostat** : Parrinello, M., & Rahman, A. (1981). _J. Appl. Phys._ , 52, 7182.

* * *

## ã‚³ãƒ¼ãƒ‰å†ç¾æ€§ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### ç’°å¢ƒæ§‹ç¯‰
    
    
    # LAMMPS ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆAnacondaæ¨å¥¨ï¼‰
    conda create -n md-sim python=3.11
    conda activate md-sim
    conda install -c conda-forge lammps
    conda install numpy matplotlib MDAnalysis
    
    # ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª
    lmp -v  # LAMMPS 23Jun2022 ä»¥é™
    python -c "import lammps; print(lammps.__version__)"
    

### ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢è¦ä»¶

ç³»ã®ã‚µã‚¤ã‚º | ãƒ¡ãƒ¢ãƒª | CPUæ™‚é–“ï¼ˆ10 psï¼‰ | æ¨å¥¨ã‚³ã‚¢æ•°  
---|---|---|---  
100åŸå­ï¼ˆArï¼‰ | ~100 MB | ~1åˆ† | 1ã‚³ã‚¢  
1,000åŸå­ï¼ˆæ°´ï¼‰ | ~500 MB | ~10åˆ† | 2-4ã‚³ã‚¢  
10,000åŸå­ï¼ˆã‚¿ãƒ³ãƒ‘ã‚¯è³ªï¼‰ | ~2 GB | ~2æ™‚é–“ | 8-16ã‚³ã‚¢  
100,000åŸå­ï¼ˆãƒŠãƒç²’å­ï¼‰ | ~10 GB | ~20æ™‚é–“ | 32-64ã‚³ã‚¢  
  
### è¨ˆç®—æ™‚é–“ã®è¦‹ç©ã‚‚ã‚Š
    
    
    # ç°¡æ˜“è¦‹ç©ã‚‚ã‚Šå¼
    N_atoms = 1000
    N_steps = 100000
    timestep = 1.0  # fs
    time_per_step = N_atoms * 1e-5  # ç§’ï¼ˆç›®å®‰ï¼‰
    total_time = N_steps * time_per_step / 60  # åˆ†
    print(f"æ¨å®šè¨ˆç®—æ™‚é–“: {total_time:.1f} åˆ†")
    

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

**å•é¡Œ** : `ERROR: Unknown pair style` **è§£æ±º** :
    
    
    # LAMMPSãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®è¿½åŠ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
    conda install -c conda-forge lammps-packages
    

**å•é¡Œ** : ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒç™ºæ•£ï¼ˆNaNï¼‰ **è§£æ±º** :
    
    
    # æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ã‚’å°ã•ãã™ã‚‹
    timestep 0.5  # 1.0 â†’ 0.5 fs
    
    # ã¾ãŸã¯ã€åˆæœŸé…ç½®ã®é‡ãªã‚Šã‚’ãƒã‚§ãƒƒã‚¯
    minimize 1.0e-4 1.0e-6 1000 10000
    

**å•é¡Œ** : æ¸©åº¦ãŒç›®æ¨™å€¤ã«åæŸã—ãªã„ **è§£æ±º** :
    
    
    # ç†±æµ´ã®dampingãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´
    fix 1 all nvt temp 300.0 300.0 100.0  # (100.0 = 100*timestep)
    # 100å€ â†’ 10å€ã«å¤‰æ›´ï¼ˆã‚ˆã‚Šå¼·ã„çµåˆï¼‰
    fix 1 all nvt temp 300.0 300.0 10.0
    

* * *

## å®Ÿè·µçš„ãªè½ã¨ã—ç©´ã¨å¯¾ç­–

### 1\. æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ã®é¸æŠãƒŸã‚¹

**è½ã¨ã—ç©´** : æ™‚é–“ã‚¹ãƒ†ãƒƒãƒ—ãŒå¤§ãã™ãã¦ã‚¨ãƒãƒ«ã‚®ãƒ¼ç™ºæ•£
    
    
    # âŒ å¤§ãã™ã: æ°´ç´ åŸå­ã‚’å«ã‚€ç³»ã§2 fs
    timestep 2.0  # æ°´ç´ ã®O-HæŒ¯å‹•ï¼ˆ~10 fså‘¨æœŸï¼‰ã‚’æ‰ãˆã‚‰ã‚Œãªã„
    
    # âœ… æ¨å¥¨å€¤:
    # - é‡åŸå­ã®ã¿: 2 fs
    # - æ°´ç´ ã‚’å«ã‚€: 0.5-1 fs
    # - åŒ–å­¦åå¿œ: 0.25 fs
    timestep 0.5
    

**æ¤œè¨¼æ–¹æ³•** :
    
    
    # ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ãƒã‚§ãƒƒã‚¯ï¼ˆNVEï¼‰
    fix 1 all nve
    run 10000
    variable E_drift equal abs((etotal[10000]-etotal[1])/etotal[1])
    if "${E_drift} > 0.001" then "print 'WARNING: Energy drift > 0.1%'"
    

### 2\. å¹³è¡¡åŒ–æ™‚é–“ã®ä¸è¶³

**è½ã¨ã—ç©´** : å¹³è¡¡åŒ–ã›ãšã«æœ¬ç•ªè¨ˆç®—é–‹å§‹
    
    
    # âŒ ä¸ååˆ†: ã™ãã«çµ±è¨ˆé–‹å§‹
    fix 1 all nvt temp 300.0 300.0 100.0
    run 1000  # 1 psï¼ˆä¸ååˆ†ï¼‰
    # ã“ã“ã§çµ±è¨ˆå–å¾— â†’ éå¹³è¡¡çŠ¶æ…‹
    
    # âœ… æ¨å¥¨: ååˆ†ãªå¹³è¡¡åŒ–
    # 1. ã‚¨ãƒãƒ«ã‚®ãƒ¼ç·©å’Œ
    minimize 1.0e-4 1.0e-6 1000 10000
    
    # 2. æ¸©åº¦å¹³è¡¡åŒ–ï¼ˆ10-50 psï¼‰
    fix 1 all nvt temp 300.0 300.0 100.0
    run 50000  # 50 ps
    
    # 3. çµ±è¨ˆå–å¾—é–‹å§‹
    reset_timestep 0
    run 100000  # 100 ps
    

**å¹³è¡¡åŒ–åˆ¤å®š** : \- æ¸©åº¦å¤‰å‹• < Â±5% \- ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰å‹• < Â±1% \- åœ§åŠ›å¤‰å‹• < Â±10%

### 3\. å‘¨æœŸå¢ƒç•Œæ¡ä»¶ã®èª¤ç”¨

**è½ã¨ã—ç©´** : åˆ†å­ãŒå‘¨æœŸå¢ƒç•Œã‚’ã¾ãŸã„ã§åˆ‡æ–­
    
    
    # âŒ é–“é•ã„: ã‚»ãƒ«ã‚µã‚¤ã‚ºãŒå°ã•ã™ã
    region box block 0 5 0 5 0 5  # 5 Ã… Ã— 5 Ã… Ã— 5 Ã…
    # æ°´åˆ†å­ï¼ˆ~3 Ã…ï¼‰ãŒå¢ƒç•Œã‚’ã¾ãŸã
    
    # âœ… æ­£è§£: åˆ†å­ã‚µã‚¤ã‚ºã®3å€ä»¥ä¸Š
    region box block 0 15 0 15 0 15  # 15 Ã… Ã— 15 Ã… Ã— 15 Ã…
    

**æ¤œè¨¼** :
    
    
    # ã‚«ãƒƒãƒˆã‚ªãƒ•è·é›¢ã¨ã‚»ãƒ«ã‚µã‚¤ã‚ºã®é–¢ä¿‚
    # ã‚»ãƒ«ã‚µã‚¤ã‚º > 2 Ã— ã‚«ãƒƒãƒˆã‚ªãƒ•è·é›¢
    pair_style lj/cut 10.0  # ã‚«ãƒƒãƒˆã‚ªãƒ•10 Ã…
    # â†’ ã‚»ãƒ«ã‚µã‚¤ã‚º > 20 Ã…å¿…è¦
    

### 4\. å˜ä½ç³»ã®æ··åŒ

**è½ã¨ã—ç©´** : LAMMPSå˜ä½ç³»ã®å–ã‚Šé•ãˆ
    
    
    # âŒ æ··åŒ: realã¨metalã‚’æ··ãœã‚‹
    units real  # ã‚¨ãƒãƒ«ã‚®ãƒ¼: kcal/mol
    pair_coeff 1 1 1.0 3.4  # LJ-epsilon = 1.0 kcal/mol
    
    # é€”ä¸­ã§metalã«å¤‰æ›´ï¼ˆå±é™ºï¼ï¼‰
    units metal  # ã‚¨ãƒãƒ«ã‚®ãƒ¼: eV
    
    # âœ… æ­£è§£: 1ã¤ã®å˜ä½ç³»ã§çµ±ä¸€
    units real
    # ã™ã¹ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’realå˜ä½ã§è¨­å®š
    

**ä¸»è¦ãªå˜ä½ç³»** : | å˜ä½ç³» | ã‚¨ãƒãƒ«ã‚®ãƒ¼ | è·é›¢ | æ™‚é–“ | ç”¨é€” | |-------|-----------|-----|------|-----| | real | kcal/mol | Ã… | fs | ç”Ÿä½“åˆ†å­ | | metal | eV | Ã… | ps | é‡‘å±ãƒ»ææ–™ | | si | J | m | s | æ•™è‚² | | lj | Îµ | Ïƒ | Ï„ | ç†è«– |

### 5\. åŠ›å ´ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®èª¤ã‚Š

**è½ã¨ã—ç©´** : åŠ›å ´ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å˜ä½ãƒ»å€¤ãŒé–“é•ã„
    
    
    # âŒ é–“é•ã„: TIP3Pæ°´ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒä¸æ­£ç¢º
    pair_coeff 1 1 0.102 3.188  # O-Oï¼ˆé–“é•ã„: kcal/molã¨Ã…ã®æ··åŒï¼‰
    
    # âœ… æ­£è§£: æ–‡çŒ®å€¤ã‚’æ­£ç¢ºã«
    # TIP3P (Jorgensen 1983, realå˜ä½):
    pair_coeff 1 1 0.1521 3.1507  # Îµ=0.1521 kcal/mol, Ïƒ=3.1507 Ã…
    bond_coeff 1 450.0 0.9572     # k=450 kcal/mol/Ã…Â², r0=0.9572 Ã…
    angle_coeff 1 55.0 104.52     # k=55 kcal/mol/radÂ², Î¸0=104.52Â°
    

* * *

## å“è³ªä¿è¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### MD ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å¦¥å½“æ€§æ¤œè¨¼

#### ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ï¼ˆNVEï¼‰

  * [ ] ç·ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®ãƒ‰ãƒªãƒ•ãƒˆ < 0.1% / ns
  * [ ] é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ä½ç½®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒç›¸äº’å¤‰æ›
  * [ ] æ¸©åº¦å¤‰å‹•ãŒMaxwellåˆ†å¸ƒã«å¾“ã†

#### æ¸©åº¦åˆ¶å¾¡ï¼ˆNVTï¼‰

  * [ ] å¹³å‡æ¸©åº¦ãŒç›®æ¨™å€¤ã® Â±2% ä»¥å†…
  * [ ] æ¸©åº¦ã®æ¨™æº–åå·®ãŒç†è«–å€¤ï¼ˆâˆš(2TÂ²/3N)ï¼‰ã¨ä¸€è‡´
  * [ ] æ¸©åº¦æ™‚ç³»åˆ—ãŒå®šå¸¸ï¼ˆãƒˆãƒ¬ãƒ³ãƒ‰ãªã—ï¼‰

#### åœ§åŠ›åˆ¶å¾¡ï¼ˆNPTï¼‰

  * [ ] å¹³å‡åœ§åŠ›ãŒç›®æ¨™å€¤ã® Â±10% ä»¥å†…
  * [ ] ä½“ç©ãŒå¹³è¡¡ã«é”ã—ã¦ã„ã‚‹ï¼ˆå¤‰å‹• < 1%ï¼‰
  * [ ] å¯†åº¦ãŒå®Ÿé¨“å€¤ã® Â±5% ä»¥å†…

#### æ§‹é€ ã®å¦¥å½“æ€§

  * [ ] å‹•å¾„åˆ†å¸ƒé–¢æ•°ï¼ˆRDFï¼‰ãŒå®Ÿé¨“/æ–‡çŒ®ã¨ä¸€è‡´
  * [ ] é…ä½æ•°ãŒåŒ–å­¦çš„ã«å¦¥å½“
  * [ ] çµåˆé•·ãƒ»è§’åº¦åˆ†å¸ƒãŒæœŸå¾…å€¤ç¯„å›²å†…

#### å‹•çš„æ€§è³ª

  * [ ] å¹³å‡äºŒä¹—å¤‰ä½ï¼ˆMSDï¼‰ãŒæ™‚é–“ã«å¯¾ã—ã¦ç·šå½¢ï¼ˆæ‹¡æ•£é ˜åŸŸï¼‰
  * [ ] æ‹¡æ•£ä¿‚æ•°ãŒå®Ÿé¨“å€¤ã®Â±50% ä»¥å†…
  * [ ] é€Ÿåº¦è‡ªå·±ç›¸é–¢é–¢æ•°ãŒæ­£ã—ãæ¸›è¡°

### æ•°å€¤è¨ˆç®—ã®å¥å…¨æ€§

  * [ ] åŸå­ãŒç³»å¤–ã«é£›ã³å‡ºã—ã¦ã„ãªã„
  * [ ] ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ç•°å¸¸å€¤ï¼ˆNaN, Infï¼‰ãªã—
  * [ ] åŠ›ã®å¤§ãã•ãŒå¦¥å½“ï¼ˆ< 10 eV/Ã…ï¼‰
  * [ ] åŸå­é–“è·é›¢ã®æœ€å°å€¤ãŒå¦¥å½“ï¼ˆ> 0.8 Ã…ï¼‰

### MDç‰¹æœ‰ã®å“è³ªãƒã‚§ãƒƒã‚¯

#### çµ±è¨ˆç²¾åº¦

  * [ ] ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°æ™‚é–“ãŒç›¸é–¢æ™‚é–“ã®10å€ä»¥ä¸Š
  * [ ] ãƒ–ãƒ­ãƒƒã‚¯å¹³å‡æ³•ã§èª¤å·®è©•ä¾¡
  * [ ] è¤‡æ•°ã®independent runsã§å†ç¾æ€§ç¢ºèª

#### ç³»ã®ã‚µã‚¤ã‚ºåŠ¹æœ

  * [ ] ã‚»ãƒ«ã‚µã‚¤ã‚ºãŒã‚«ãƒƒãƒˆã‚ªãƒ•ã®2å€ä»¥ä¸Š
  * [ ] ç³»ã®ã‚µã‚¤ã‚ºä¾å­˜æ€§ã‚’ç¢ºèªï¼ˆå¯èƒ½ãªã‚‰ï¼‰
  * [ ] æœ‰é™ã‚µã‚¤ã‚ºåŠ¹æœãŒç„¡è¦–ã§ãã‚‹

* * *

## å‚è€ƒæ–‡çŒ®

  1. Frenkel, D., & Smit, B. (2001). _Understanding Molecular Simulation: From Algorithms to Applications_ (2nd ed.). Academic Press.

  2. Haile, J. M. (1992). _Molecular Dynamics Simulation: Elementary Methods_. Wiley-Interscience.

  3. Plimpton, S. (1995). "Fast Parallel Algorithms for Short-Range Molecular Dynamics." _Journal of Computational Physics_ , 117(1), 1-19. DOI: [10.1006/jcph.1995.1039](<https://doi.org/10.1006/jcph.1995.1039>)

  4. LAMMPS Documentation: https://docs.lammps.org/

  5. ASE-MD Documentation: https://wiki.fysik.dtu.dk/ase/ase/md.html

* * *

## è‘—è€…æƒ…å ±

**ä½œæˆè€…** : MI Knowledge Hub Content Team **ä½œæˆæ—¥** : 2025-10-17 **ãƒãƒ¼ã‚¸ãƒ§ãƒ³** : 1.0 **ã‚·ãƒªãƒ¼ã‚º** : è¨ˆç®—ææ–™ç§‘å­¦åŸºç¤å…¥é–€ v1.0

**ãƒ©ã‚¤ã‚»ãƒ³ã‚¹** : Creative Commons BY-NC-SA 4.0
