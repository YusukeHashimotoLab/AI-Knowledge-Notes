<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á¨¨2Á´†ÔºöDFTË®àÁÆó„ÅÆËá™ÂãïÂåñÔºàVASP, Quantum ESPRESSOÔºâ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Á¨¨2Á´†ÔºöDFTË®àÁÆó„ÅÆËá™ÂãïÂåñÔºàVASP, Quantum ESPRESSOÔºâ</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">üìñ Ë™≠‰∫ÜÊôÇÈñì: 20-25ÂàÜ</span>
                <span class="meta-item">üìä Èõ£ÊòìÂ∫¶: ‰∏≠Á¥ö„Äú‰∏äÁ¥ö</span>
                <span class="meta-item">üíª „Ç≥„Éº„Éâ‰æã: 6ÂÄã</span>
                <span class="meta-item">üìù ÊºîÁøíÂïèÈ°å: 0Âïè</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Á¨¨2Á´†ÔºöDFTË®àÁÆó„ÅÆËá™ÂãïÂåñÔºàVASP, Quantum ESPRESSOÔºâ</h1>
<p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-left: 4px solid #7b2cbf; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">ASE„ÇÑpymatgen„Åß„ÅÆÂÖ•ÂäõÁîüÊàê„Åã„ÇâÂÆüË°åÁÆ°ÁêÜ„Åæ„Åß„ÄÅ„Éü„Çπ„ÇíÊ∏õ„Çâ„ÅôËá™ÂãïÂåñ„ÅÆÂü∫Êú¨„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>




<h2>Â≠¶ÁøíÁõÆÊ®ô</h2>
<p>„Åì„ÅÆÁ´†„ÇíË™≠„ÇÄ„Åì„Å®„Åß„ÄÅ‰ª•‰∏ã„ÇíÁøíÂæó„Åß„Åç„Åæ„ÅôÔºö</p>
<ul>
<li>‚úÖ ASE„Çí‰Ωø„Å£„Å¶DFTË®àÁÆó„ÇíËá™ÂãïÂÆüË°å„Åß„Åç„Çã</li>
<li>‚úÖ VASP„Å®Quantum ESPRESSO„ÅÆÂÖ•Âäõ„Éï„Ç°„Ç§„É´„ÇíËá™ÂãïÁîüÊàê„Åß„Åç„Çã</li>
<li>‚úÖ pymatgen„ÅÆInputSet„ÅßÊ®ôÊ∫ñÂåñ„Åï„Çå„ÅüË®≠ÂÆö„Çí‰Ωø„Åà„Çã</li>
<li>‚úÖ „Ç®„É©„Éº„ÇíÊ§úÂá∫„Åó„Å¶Ëá™Âãï„É™„Çπ„Çø„Éº„Éà„Åß„Åç„Çã</li>
<li>‚úÖ ÊßãÈÄ†ÊúÄÈÅ©Âåñ„ÅÆÂèéÊùüÂà§ÂÆö„ÇíËá™ÂãïÂåñ„Åß„Åç„Çã</li>
</ul>
<hr />
<h2>2.1 ASEÔºàAtomic Simulation EnvironmentÔºâÂü∫Á§é</h2>
<h3>ASE„Å®„ÅØ</h3>
<p><strong>ASEÔºàAtomic Simulation EnvironmentÔºâ</strong>„ÅØ„ÄÅÂéüÂ≠ê„Çπ„Ç±„Éº„É´„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥„ÅÆ„Åü„ÇÅ„ÅÆPython„É©„Ç§„Éñ„É©„É™„Åß„Åô„ÄÇ</p>
<p><strong>ÁâπÂæ¥</strong>:
- ‚úÖ Â§öÊßò„Å™Ë®àÁÆó„Ç≥„Éº„ÉâÂØæÂøúÔºàVASP„ÄÅQE„ÄÅLAMMPSÁ≠âÔºâ
- ‚úÖ ÊßãÈÄ†ÁîüÊàê„ÉªÊìç‰Ωú„ÅÆÁµ±‰∏Ä„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ
- ‚úÖ Ë®àÁÆóÁµêÊûú„ÅÆËß£Êûê„ÉÑ„Éº„É´
- ‚úÖ MIT„É©„Ç§„Çª„É≥„ÇπÔºà„Ç™„Éº„Éó„É≥„ÇΩ„Éº„ÇπÔºâ</p>
<h3>„Ç§„É≥„Çπ„Éà„Éº„É´</h3>
<pre><code class="language-bash"># condaÁí∞Â¢É„ÇíÊé®Â•®
conda create -n ht_computing python=3.10
conda activate ht_computing

# ASE„Ç§„É≥„Çπ„Éà„Éº„É´
pip install ase

# ËøΩÂä†„Éë„ÉÉ„Ç±„Éº„Ç∏
pip install numpy scipy matplotlib
</code></pre>
<h3>Âü∫Êú¨ÁöÑ„Å™ÊßãÈÄ†ÁîüÊàê</h3>
<pre><code class="language-python">from ase import Atoms
from ase.build import bulk, molecule
import numpy as np

# ‰æã1: „Éê„É´„ÇØÁµêÊô∂„ÅÆÁîüÊàê
si = bulk('Si', 'diamond', a=5.43)
print(f&quot;SiÁµêÊô∂: {len(si)}ÂéüÂ≠ê&quot;)
print(f&quot;Ê†ºÂ≠êÂÆöÊï∞: {si.cell.cellpar()}&quot;)

# ‰æã2: ÂàÜÂ≠ê„ÅÆÁîüÊàê
h2o = molecule('H2O')
print(f&quot;H2OÂàÜÂ≠ê: {len(h2o)}ÂéüÂ≠ê&quot;)

# ‰æã3: „Ç´„Çπ„Çø„É†ÊßãÈÄ†
# LiCoO2ÔºàÂ±§Áä∂ÊßãÈÄ†Ôºâ
a = 2.82
c = 14.05
positions = [
    [0, 0, 0],       # Li
    [0, 0, 0.5*c],   # Co
    [1/3, 2/3, 0.25*c],  # O
    [2/3, 1/3, 0.75*c],  # O
]
atoms = Atoms('LiCoO2',
              positions=positions,
              cell=[a, a, c, 90, 90, 120],
              pbc=True)

print(f&quot;LiCoO2: {atoms.get_chemical_formula()}&quot;)
</code></pre>
<p><strong>Âá∫Âäõ</strong>:</p>
<pre><code>SiÁµêÊô∂: 2ÂéüÂ≠ê
Ê†ºÂ≠êÂÆöÊï∞: [5.43 5.43 5.43 90.  90.  90. ]
H2OÂàÜÂ≠ê: 3ÂéüÂ≠ê
LiCoO2: LiCoO2
</code></pre>
<h3>ÊßãÈÄ†„ÅÆÂèØË¶ñÂåñ</h3>
<pre><code class="language-python">from ase.visualize import view

# 3DÂèØË¶ñÂåñÔºàGUI„ÅåËµ∑ÂãïÔºâ
view(si)

# „Éï„Ç°„Ç§„É´‰øùÂ≠ò
from ase.io import write

# CIFÂΩ¢Âºè„Åß‰øùÂ≠ò
write('si_structure.cif', si)

# POSCARÂΩ¢ÂºèÔºàVASPÁî®Ôºâ
write('POSCAR', si, format='vasp')

# XYZÂΩ¢Âºè
write('structure.xyz', si)
</code></pre>
<hr />
<h2>2.2 VASPËá™ÂãïÂåñ</h2>
<h3>VASP„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„ÇπË®≠ÂÆö</h3>
<pre><code class="language-python">from ase.calculators.vasp import Vasp

# VASPË®àÁÆóÂô®„ÅÆË®≠ÂÆö
calc = Vasp(
    # Âü∫Êú¨Ë®≠ÂÆö
    xc='PBE',           # ‰∫§ÊèõÁõ∏Èñ¢Ê±éÈñ¢Êï∞
    encut=520,          # „Ç®„Éç„É´„ÇÆ„Éº„Ç´„ÉÉ„Éà„Ç™„ÉïÔºàeVÔºâ

    # k-pointË®≠ÂÆö
    kpts=(8, 8, 8),     # Monkhorst-PackÊ†ºÂ≠ê
    gamma=True,         # ŒìÁÇπ‰∏≠ÂøÉ

    # ÈõªÂ≠êÊßãÈÄ†
    ismear=0,           # Gaussian„Çπ„Éü„Ç¢„É™„É≥„Ç∞
    sigma=0.05,         # „Çπ„Éü„Ç¢„É™„É≥„Ç∞ÂπÖÔºàeVÔºâ

    # ÂèéÊùüÂà§ÂÆö
    ediff=1e-5,         # „Ç®„Éç„É´„ÇÆ„ÉºÂèéÊùüÔºàeVÔºâ

    # ‰∏¶ÂàóÂåñ
    ncore=4,            # ‰∏¶ÂàóÂäπÁéáÂêë‰∏ä

    # Âá∫ÂäõÂà∂Âæ°
    lwave=False,        # WAVECAR„Çí‰øùÂ≠ò„Åó„Å™„ÅÑ
    lcharg=False,       # CHGCAR„Çí‰øùÂ≠ò„Åó„Å™„ÅÑ
)
</code></pre>
<h3>ÊßãÈÄ†ÊúÄÈÅ©Âåñ„ÅÆËá™ÂãïÂåñ</h3>
<pre><code class="language-python">from ase.optimize import BFGS
from ase.calculators.vasp import Vasp
from ase.io import read, write
import os

def relax_structure(atoms, output_dir='relaxation'):
    &quot;&quot;&quot;
    ÊßãÈÄ†ÊúÄÈÅ©Âåñ„ÇíËá™ÂãïÂÆüË°å

    Parameters:
    -----------
    atoms : ase.Atoms
        ÊúÄÈÅ©Âåñ„Åô„ÇãÊßãÈÄ†
    output_dir : str
        Âá∫Âäõ„Éá„Ç£„É¨„ÇØ„Éà„É™

    Returns:
    --------
    relaxed_atoms : ase.Atoms
        ÊúÄÈÅ©ÂåñÂæå„ÅÆÊßãÈÄ†
    &quot;&quot;&quot;
    # Âá∫Âäõ„Éá„Ç£„É¨„ÇØ„Éà„É™‰ΩúÊàê
    os.makedirs(output_dir, exist_ok=True)
    os.chdir(output_dir)

    # VASPË®àÁÆóÂô®Ë®≠ÂÆö
    calc = Vasp(
        xc='PBE',
        encut=520,
        kpts=(8, 8, 8),
        ediff=1e-5,
        ibrion=2,       # ÊßãÈÄ†ÊúÄÈÅ©Âåñ„Ç¢„É´„Ç¥„É™„Ç∫„É†
        nsw=100,        # ÊúÄÂ§ß„Ç§„Ç™„É≥„Çπ„ÉÜ„ÉÉ„ÉóÊï∞
        isif=3,         # „Çª„É´ÂΩ¢Áä∂„ÇÇÊúÄÈÅ©Âåñ
        ediffg=-0.01,   # Âäõ„ÅÆÂèéÊùüÂà§ÂÆöÔºàeV/√ÖÔºâ
    )

    atoms.calc = calc

    # ÊúÄÈÅ©ÂåñÂÆüË°å
    print(f&quot;ÊßãÈÄ†ÊúÄÈÅ©Âåñ„ÇíÈñãÂßã: {atoms.get_chemical_formula()}&quot;)

    try:
        # BFGS„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅßÊúÄÈÅ©Âåñ
        optimizer = BFGS(atoms, trajectory='optimization.traj')
        optimizer.run(fmax=0.01)  # ÊúÄÂ§ßÂäõ„Åå0.01 eV/√Ö‰ª•‰∏ã

        print(&quot;ÊßãÈÄ†ÊúÄÈÅ©Âåñ„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü&quot;)
        print(f&quot;ÊúÄÁµÇ„Ç®„Éç„É´„ÇÆ„Éº: {atoms.get_potential_energy():.3f} eV&quot;)

        # ÊúÄÈÅ©ÂåñÂæå„ÅÆÊßãÈÄ†„Çí‰øùÂ≠ò
        write('CONTCAR', atoms, format='vasp')

        return atoms

    except Exception as e:
        print(f&quot;„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü: {e}&quot;)
        return None

    finally:
        os.chdir('..')

# ‰ΩøÁî®‰æã
si = bulk('Si', 'diamond', a=5.43)
relaxed_si = relax_structure(si, output_dir='si_relaxation')
</code></pre>
<h3>INCAR„Éï„Ç°„Ç§„É´Ëá™ÂãïÁîüÊàê</h3>
<pre><code class="language-python">def generate_incar(calculation_type='relax'):
    &quot;&quot;&quot;
    Ë®àÁÆó„Çø„Ç§„Éó„Å´Âøú„Åò„ÅüINCARË®≠ÂÆö„ÇíÁîüÊàê

    Parameters:
    -----------
    calculation_type : str
        'relax', 'static', 'band', 'dos'„ÅÆ„ÅÑ„Åö„Çå„Åã

    Returns:
    --------
    incar_dict : dict
        INCARË®≠ÂÆö„ÅÆËæûÊõ∏
    &quot;&quot;&quot;
    # ÂÖ±ÈÄöË®≠ÂÆö
    base_settings = {
        'SYSTEM': 'Automated calculation',
        'PREC': 'Accurate',
        'ENCUT': 520,
        'EDIFF': 1e-5,
        'ISMEAR': 0,
        'SIGMA': 0.05,
        'LREAL': False,
        'LWAVE': False,
        'LCHARG': False,
    }

    # Ë®àÁÆó„Çø„Ç§„ÉóÂà•Ë®≠ÂÆö
    if calculation_type == 'relax':
        specific = {
            'IBRION': 2,      # CGÊ≥ï
            'NSW': 100,       # ÊúÄÂ§ß„Ç§„Ç™„É≥„Çπ„ÉÜ„ÉÉ„Éó
            'ISIF': 3,        # „Çª„É´ÂΩ¢Áä∂ÊúÄÈÅ©Âåñ
            'EDIFFG': -0.01,  # Âäõ„ÅÆÂèéÊùü
        }

    elif calculation_type == 'static':
        specific = {
            'IBRION': -1,     # „Ç§„Ç™„É≥Á∑©Âíå„Å™„Åó
            'NSW': 0,
            'LCHARG': True,   # ÈõªËç∑ÂØÜÂ∫¶„Çí‰øùÂ≠ò
        }

    elif calculation_type == 'band':
        specific = {
            'IBRION': -1,
            'NSW': 0,
            'ICHARG': 11,     # ÈõªËç∑ÂØÜÂ∫¶„ÇíË™≠„ÅøËæº„Åø
            'LORBIT': 11,     # DOS„Å®„Éê„É≥„Éâ
        }

    elif calculation_type == 'dos':
        specific = {
            'IBRION': -1,
            'NSW': 0,
            'ICHARG': 11,
            'LORBIT': 11,
            'NEDOS': 2001,    # DOSËß£ÂÉèÂ∫¶
        }

    else:
        raise ValueError(f&quot;Unknown calculation type: {calculation_type}&quot;)

    # Ë®≠ÂÆö„ÇíÁµêÂêà
    incar_dict = {**base_settings, **specific}

    return incar_dict

# ‰ΩøÁî®‰æã
relax_incar = generate_incar('relax')
print(&quot;ÊßãÈÄ†ÊúÄÈÅ©ÂåñÁî®INCAR:&quot;)
for key, value in relax_incar.items():
    print(f&quot;{key} = {value}&quot;)
</code></pre>
<h3>K-pointËá™ÂãïË®≠ÂÆö</h3>
<pre><code class="language-python">from ase.dft.kpoints import monkhorst_pack
import numpy as np

def auto_kpoints(atoms, kpt_density=1000):
    &quot;&quot;&quot;
    „Çª„É´„Çµ„Ç§„Ç∫„Å´Âøú„Åò„Å¶k-pointÂØÜÂ∫¶„ÇíËá™ÂãïË®≠ÂÆö

    Parameters:
    -----------
    atoms : ase.Atoms
        ÊßãÈÄ†
    kpt_density : float
        k-pointÂØÜÂ∫¶Ôºà1/√Ö¬≥„ÅÇ„Åü„Çä„ÅÆk-pointÊï∞Ôºâ

    Returns:
    --------
    kpts : tuple
        k-pointÊ†ºÂ≠êÔºànx, ny, nzÔºâ
    &quot;&quot;&quot;
    # „Çª„É´„ÅÆÈÄÜÊ†ºÂ≠ê„Éô„ÇØ„Éà„É´Èï∑„Åï
    cell = atoms.get_cell()
    reciprocal_cell = cell.reciprocal()
    lengths = np.linalg.norm(reciprocal_cell, axis=1)

    # k-pointÊï∞„ÇíË®àÁÆó
    kpts = []
    for length in lengths:
        # k-pointÂØÜÂ∫¶„Åã„ÇâÂøÖË¶Å„Å™ÂàÜÂâ≤Êï∞„ÇíË®àÁÆó
        n = max(1, int(np.ceil(kpt_density / length)))
        kpts.append(n)

    return tuple(kpts)

# ‰ΩøÁî®‰æã
si = bulk('Si', 'diamond', a=5.43)
kpts = auto_kpoints(si, kpt_density=1000)
print(f&quot;SiÁî®k-pointÊ†ºÂ≠ê: {kpts}&quot;)  # ‰æã: (12, 12, 12)

# Â§ß„Åç„Å™„Çª„É´
supercell = si * (2, 2, 2)
kpts_super = auto_kpoints(supercell, kpt_density=1000)
print(f&quot;„Çπ„Éº„Éë„Éº„Çª„É´Áî®k-point: {kpts_super}&quot;)  # ‰æã: (6, 6, 6)
</code></pre>
<hr />
<h2>2.3 Quantum ESPRESSOËá™ÂãïÂåñ</h2>
<h3>QEË®àÁÆóÂô®Ë®≠ÂÆö</h3>
<pre><code class="language-python">from ase.calculators.espresso import Espresso

# Quantum ESPRESSOË®àÁÆóÂô®
calc_qe = Espresso(
    # ÂÆüË°å„Éï„Ç°„Ç§„É´„Éë„Çπ
    command='pw.x -in PREFIX.pwi &gt; PREFIX.pwo',

    # Êì¨„Éù„ÉÜ„É≥„Ç∑„É£„É´
    pseudopotentials={
        'Si': 'Si.pbe-n-kjpaw_psl.1.0.0.UPF',
        'O': 'O.pbe-n-kjpaw_psl.1.0.0.UPF',
    },
    pseudo_dir='/path/to/pseudopotentials',

    # ÂÖ•Âäõ„Éë„É©„É°„Éº„Çø
    input_data={
        'control': {
            'calculation': 'relax',
            'restart_mode': 'from_scratch',
            'prefix': 'pwscf',
            'outdir': './tmp',
            'pseudo_dir': '/path/to/pseudopotentials',
        },
        'system': {
            'ecutwfc': 60,      # Ê≥¢ÂãïÈñ¢Êï∞„Ç´„ÉÉ„Éà„Ç™„ÉïÔºàRyÔºâ
            'ecutrho': 480,     # ÈõªËç∑ÂØÜÂ∫¶„Ç´„ÉÉ„Éà„Ç™„Éï
            'occupations': 'smearing',
            'smearing': 'gaussian',
            'degauss': 0.01,
        },
        'electrons': {
            'conv_thr': 1e-8,   # ÂèéÊùüÂà§ÂÆö
            'mixing_beta': 0.7,
        },
        'ions': {
            'ion_dynamics': 'bfgs',
        },
    },

    # k-point
    kpts=(8, 8, 8),
    koffset=(0, 0, 0),
)
</code></pre>
<h3>QEÂÖ•Âäõ„Éï„Ç°„Ç§„É´„ÉÜ„É≥„Éó„É¨„Éº„Éà</h3>
<pre><code class="language-python">def generate_qe_input(atoms, calculation='relax'):
    &quot;&quot;&quot;
    Quantum ESPRESSOÂÖ•Âäõ„Éï„Ç°„Ç§„É´„ÇíÁîüÊàê

    Parameters:
    -----------
    atoms : ase.Atoms
        Ë®àÁÆó„Åô„ÇãÊßãÈÄ†
    calculation : str
        'relax', 'scf', 'nscf', 'bands'

    Returns:
    --------
    input_str : str
        ÂÖ•Âäõ„Éï„Ç°„Ç§„É´ÂÜÖÂÆπ
    &quot;&quot;&quot;
    from ase.io.espresso import write_espresso_in

    # Ë®àÁÆó„Çø„Ç§„ÉóÂà•Ë®≠ÂÆö
    if calculation == 'relax':
        input_data = {
            'control': {
                'calculation': 'relax',
                'restart_mode': 'from_scratch',
            },
            'system': {
                'ecutwfc': 60,
                'ecutrho': 480,
            },
            'electrons': {
                'conv_thr': 1e-8,
            },
            'ions': {
                'ion_dynamics': 'bfgs',
            },
        }

    elif calculation == 'scf':
        input_data = {
            'control': {
                'calculation': 'scf',
            },
            'system': {
                'ecutwfc': 60,
                'ecutrho': 480,
            },
            'electrons': {
                'conv_thr': 1e-8,
            },
        }

    elif calculation == 'bands':
        input_data = {
            'control': {
                'calculation': 'bands',
            },
            'system': {
                'ecutwfc': 60,
                'ecutrho': 480,
                'nbnd': 20,  # „Éê„É≥„ÉâÊï∞
            },
            'electrons': {
                'conv_thr': 1e-8,
            },
        }

    # ÂÖ•Âäõ„Éï„Ç°„Ç§„É´Êõ∏„ÅçËæº„Åø
    write_espresso_in(
        'pw.in',
        atoms,
        input_data=input_data,
        pseudopotentials={el: f&quot;{el}.pbe.UPF&quot; for el in set(atoms.get_chemical_symbols())},
        kpts=(8, 8, 8),
    )

    with open('pw.in', 'r') as f:
        input_str = f.read()

    return input_str

# ‰ΩøÁî®‰æã
si = bulk('Si', 'diamond', a=5.43)
qe_input = generate_qe_input(si, calculation='relax')
print(qe_input)
</code></pre>
<hr />
<h2>2.4 pymatgen„Å´„Çà„ÇãÈ´òÂ∫¶„Å™Ëá™ÂãïÂåñ</h2>
<h3>InputSet„ÅÆÊ¥ªÁî®</h3>
<p>pymatgen„ÅØ„ÄÅMaterials Project„Åß‰ΩøÁî®„Åï„Çå„Å¶„ÅÑ„ÇãÊ®ôÊ∫ñÂåñ„Åï„Çå„ÅüË®àÁÆóË®≠ÂÆö„ÇíÊèê‰æõ„Åó„Åæ„Åô„ÄÇ</p>
<pre><code class="language-python">from pymatgen.core import Structure
from pymatgen.io.vasp.sets import MPRelaxSet, MPStaticSet

# ÊßãÈÄ†„ÇíË™≠„ÅøËæº„ÅøÔºàCIF„Éï„Ç°„Ç§„É´„Åã„ÇâÔºâ
structure = Structure.from_file(&quot;LiCoO2.cif&quot;)

# Materials ProjectÊ®ôÊ∫ñ„ÅÆÊßãÈÄ†ÊúÄÈÅ©ÂåñË®≠ÂÆö
relax_set = MPRelaxSet(structure)

# INCAR, KPOINTS, POTCAR„ÇíËá™ÂãïÁîüÊàê
relax_set.write_input(&quot;relax_calculation&quot;)

# „Éá„Ç£„É¨„ÇØ„Éà„É™ÂÜÖÂÆπ:
# relax_calculation/
#   ‚îú‚îÄ‚îÄ INCAR
#   ‚îú‚îÄ‚îÄ POSCAR
#   ‚îú‚îÄ‚îÄ KPOINTS
#   ‚îî‚îÄ‚îÄ POTCAR

# ÈùôÁöÑË®àÁÆóË®≠ÂÆöÔºàÊßãÈÄ†ÊúÄÈÅ©ÂåñÂæåÔºâ
static_set = MPStaticSet(structure)
static_set.write_input(&quot;static_calculation&quot;)
</code></pre>
<h3>„Ç´„Çπ„Çø„É†InputSet</h3>
<pre><code class="language-python">from pymatgen.io.vasp.sets import DictSet

# „Ç´„Çπ„Çø„É†Ë®≠ÂÆö
custom_incar = {
    &quot;ENCUT&quot;: 600,      # „Éá„Éï„Ç©„É´„Éà„Çà„ÇäÈ´òÁ≤æÂ∫¶
    &quot;EDIFF&quot;: 1e-6,
    &quot;ISMEAR&quot;: -5,      # TetrahedronÊ≥ï
    &quot;LORBIT&quot;: 11,
    &quot;LWAVE&quot;: False,
    &quot;LCHARG&quot;: True,
}

# „Ç´„Çπ„Çø„É†InputSet‰ΩúÊàê
custom_set = DictSet(
    structure,
    config_dict={
        &quot;INCAR&quot;: custom_incar,
        &quot;KPOINTS&quot;: {&quot;reciprocal_density&quot;: 200},  # k-pointÂØÜÂ∫¶
    }
)

custom_set.write_input(&quot;custom_calculation&quot;)
</code></pre>
<h3>„Ç®„É©„ÉºÊ§úÂá∫„Å®„É™„Çπ„Çø„Éº„Éà</h3>
<pre><code class="language-python">from pymatgen.io.vasp.outputs import Vasprun, Outcar
from pymatgen.io.vasp.sets import MPRelaxSet
import os

def check_convergence(directory):
    &quot;&quot;&quot;
    VASPË®àÁÆó„ÅÆÂèéÊùü„Çí„ÉÅ„Çß„ÉÉ„ÇØ

    Returns:
    --------
    status : str
        'converged', 'not_converged', 'error'
    &quot;&quot;&quot;
    try:
        # vasprun.xml„ÇíË™≠„ÅøËæº„Åø
        vasprun = Vasprun(os.path.join(directory, &quot;vasprun.xml&quot;))

        if vasprun.converged:
            return 'converged'
        else:
            return 'not_converged'

    except Exception as e:
        print(f&quot;„Ç®„É©„Éº: {e}&quot;)
        return 'error'

def auto_restart(directory, max_attempts=3):
    &quot;&quot;&quot;
    ÂèéÊùü„Åó„Å™„ÅÑË®àÁÆó„ÇíËá™Âãï„É™„Çπ„Çø„Éº„Éà

    Parameters:
    -----------
    directory : str
        Ë®àÁÆó„Éá„Ç£„É¨„ÇØ„Éà„É™
    max_attempts : int
        ÊúÄÂ§ß„É™„Éà„É©„Ç§ÂõûÊï∞
    &quot;&quot;&quot;
    for attempt in range(max_attempts):
        status = check_convergence(directory)

        if status == 'converged':
            print(&quot;Ë®àÁÆó„ÅåÂèéÊùü„Åó„Åæ„Åó„Åü&quot;)
            return True

        elif status == 'not_converged':
            print(f&quot;Êú™ÂèéÊùü„ÄÇ„É™„Éà„É©„Ç§ {attempt+1}/{max_attempts}&quot;)

            # Ë®≠ÂÆö„ÇíÁ∑©Âíå
            # ‰æã: „Ç®„Éç„É´„ÇÆ„Éº„Ç´„ÉÉ„Éà„Ç™„Éï„Çí‰∏ã„Åí„Çã„ÄÅ„Çπ„Éü„Ç¢„É™„É≥„Ç∞„ÇíÂ¢ó„ÇÑ„Åô
            modify_incar(directory, {'ENCUT': 450, 'SIGMA': 0.1})

            # „É™„Çπ„Çø„Éº„Éà
            restart_calculation(directory)

        elif status == 'error':
            print(&quot;Ëá¥ÂëΩÁöÑ„Ç®„É©„Éº„ÄÇ„Çπ„Ç≠„ÉÉ„Éó„Åó„Åæ„Åô&quot;)
            return False

    print(&quot;ÊúÄÂ§ß„É™„Éà„É©„Ç§ÂõûÊï∞„Å´ÈÅî„Åó„Åæ„Åó„Åü&quot;)
    return False

def modify_incar(directory, new_params):
    &quot;&quot;&quot;INCAR„Éï„Ç°„Ç§„É´„Çí‰øÆÊ≠£&quot;&quot;&quot;
    from pymatgen.io.vasp.inputs import Incar

    incar_file = os.path.join(directory, &quot;INCAR&quot;)
    incar = Incar.from_file(incar_file)

    # „Éë„É©„É°„Éº„Çø„ÇíÊõ¥Êñ∞
    for key, value in new_params.items():
        incar[key] = value

    # ‰øùÂ≠ò
    incar.write_file(incar_file)
    print(f&quot;INCAR„ÇíÊõ¥Êñ∞: {new_params}&quot;)

def restart_calculation(directory):
    &quot;&quot;&quot;Ë®àÁÆó„ÇíÂÜçÂÆüË°å&quot;&quot;&quot;
    import subprocess

    # CONTCAR„ÇíPOSCAR„Å´„Ç≥„Éî„Éº
    os.system(f&quot;cp {directory}/CONTCAR {directory}/POSCAR&quot;)

    # VASPÂÜçÂÆüË°å
    os.chdir(directory)
    subprocess.run([&quot;mpirun&quot;, &quot;-np&quot;, &quot;48&quot;, &quot;vasp_std&quot;])
    os.chdir(&quot;..&quot;)
</code></pre>
<hr />
<h2>2.5 „Éê„ÉÉ„ÉÅÂá¶ÁêÜ</h2>
<h3>Ë§áÊï∞ÊùêÊñô„ÅÆËá™ÂãïË®àÁÆó</h3>
<pre><code class="language-python">import os
from pymatgen.core import Structure
from pymatgen.io.vasp.sets import MPRelaxSet

def batch_relax(structure_files, output_root='calculations'):
    &quot;&quot;&quot;
    Ë§áÊï∞„ÅÆÊßãÈÄ†„Çí‰∏ÄÊã¨„ÅßÊßãÈÄ†ÊúÄÈÅ©Âåñ

    Parameters:
    -----------
    structure_files : list
        CIF„Éï„Ç°„Ç§„É´„ÅÆ„É™„Çπ„Éà
    output_root : str
        Âá∫Âäõ„É´„Éº„Éà„Éá„Ç£„É¨„ÇØ„Éà„É™
    &quot;&quot;&quot;
    os.makedirs(output_root, exist_ok=True)

    for cif_file in structure_files:
        # ÊßãÈÄ†„ÇíË™≠„ÅøËæº„Åø
        structure = Structure.from_file(cif_file)
        formula = structure.composition.reduced_formula

        print(f&quot;Âá¶ÁêÜ‰∏≠: {formula}&quot;)

        # Âá∫Âäõ„Éá„Ç£„É¨„ÇØ„Éà„É™
        calc_dir = os.path.join(output_root, formula)

        # InputSet‰ΩúÊàê
        relax_set = MPRelaxSet(structure)
        relax_set.write_input(calc_dir)

        # „Ç∏„Éß„Éñ„Çπ„ÇØ„É™„Éó„Éà‰ΩúÊàê
        create_job_script(calc_dir, formula)

        # „Ç∏„Éß„ÉñÊäïÂÖ•ÔºàSLURM„ÅÆÂ†¥ÂêàÔºâ
        os.chdir(calc_dir)
        os.system(&quot;sbatch job.sh&quot;)
        os.chdir(&quot;../..&quot;)

        print(f&quot;  ‚Üí „Ç∏„Éß„ÉñÊäïÂÖ•ÂÆå‰∫Ü: {calc_dir}&quot;)

def create_job_script(directory, jobname):
    &quot;&quot;&quot;SLURM„Ç∏„Éß„Éñ„Çπ„ÇØ„É™„Éó„Éà‰ΩúÊàê&quot;&quot;&quot;
    script = f&quot;&quot;&quot;#!/bin/bash
#SBATCH --job-name={jobname}
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=48
#SBATCH --time=24:00:00
#SBATCH --partition=standard

module load vasp/6.3.0

mpirun -np 48 vasp_std
&quot;&quot;&quot;

    with open(os.path.join(directory, &quot;job.sh&quot;), 'w') as f:
        f.write(script)

# ‰ΩøÁî®‰æã
cif_files = [
    &quot;LiCoO2.cif&quot;,
    &quot;LiNiO2.cif&quot;,
    &quot;LiMnO2.cif&quot;,
    &quot;LiFePO4.cif&quot;,
]

batch_relax(cif_files, output_root='battery_materials')
</code></pre>
<hr />
<h2>2.6 ÊºîÁøíÂïèÈ°å</h2>
<h3>ÂïèÈ°å1ÔºàÈõ£ÊòìÂ∫¶: easyÔºâ</h3>
<p><strong>ÂïèÈ°å</strong>: ASE„Çí‰Ωø„Å£„Å¶NaClÔºàÂ≤©Â°©ÊßãÈÄ†Ôºâ„ÅÆÁµêÊô∂„ÇíÁîüÊàê„Åó„ÄÅPOSCAR„Éï„Ç°„Ç§„É´„Å´‰øùÂ≠ò„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÊ†ºÂ≠êÂÆöÊï∞„ÅØ5.64 √Ö„Åß„Åô„ÄÇ</p>
<details>
<summary>„Éí„É≥„Éà</summary>

`ase.build.bulk`Èñ¢Êï∞„Çí‰ΩøÁî®„ÄÇÁµêÊô∂ÊßãÈÄ†„ÅØ'rocksalt'„ÇíÊåáÂÆö„ÄÇ

</details>

<details>
<summary>Ëß£Á≠î‰æã</summary>


<pre><code class="language-python">from ase.build import bulk
from ase.io import write

# NaClÁµêÊô∂ÁîüÊàê
nacl = bulk('NaCl', 'rocksalt', a=5.64)

# POSCAR‰øùÂ≠ò
write('POSCAR_NaCl', nacl, format='vasp')

print(f&quot;NaCl: {nacl.get_chemical_formula()}&quot;)
print(f&quot;ÂéüÂ≠êÊï∞: {len(nacl)}&quot;)
print(f&quot;„Çª„É´„Éë„É©„É°„Éº„Çø: {nacl.cell.cellpar()}&quot;)
</code></pre>


**Âá∫Âäõ**:

<pre><code>NaCl: NaCl
ÂéüÂ≠êÊï∞: 2
„Çª„É´„Éë„É©„É°„Éº„Çø: [5.64 5.64 5.64 90.  90.  90. ]
</code></pre>


</details>

<h3>ÂïèÈ°å2ÔºàÈõ£ÊòìÂ∫¶: mediumÔºâ</h3>
<p><strong>ÂïèÈ°å</strong>: pymatgen„ÅÆMPRelaxSet„Çí‰Ωø„Å£„Å¶„ÄÅLi‚ÇÇOÔºàLi2O.cifÔºâ„ÅÆÊßãÈÄ†ÊúÄÈÅ©ÂåñÁî®ÂÖ•Âäõ„Éï„Ç°„Ç§„É´„ÇíÁîüÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ„Åï„Çâ„Å´„ÄÅk-pointÂØÜÂ∫¶„Çí2000„Å´Â§âÊõ¥„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<details>
<summary>„Éí„É≥„Éà</summary>

`MPRelaxSet`„ÅÆuser_incar_settings„Å®user_kpoints_settings„Çí‰ΩøÁî®„ÄÇ

</details>

<details>
<summary>Ëß£Á≠î‰æã</summary>


<pre><code class="language-python">from pymatgen.core import Structure
from pymatgen.io.vasp.sets import MPRelaxSet

# ÊßãÈÄ†Ë™≠„ÅøËæº„Åø
structure = Structure.from_file(&quot;Li2O.cif&quot;)

# k-pointÂØÜÂ∫¶„Çí„Ç´„Çπ„Çø„Éû„Ç§„Ç∫
relax_set = MPRelaxSet(
    structure,
    user_kpoints_settings={&quot;reciprocal_density&quot;: 2000}
)

# ÂÖ•Âäõ„Éï„Ç°„Ç§„É´ÁîüÊàê
relax_set.write_input(&quot;li2o_relax&quot;)

print(&quot;ÂÖ•Âäõ„Éï„Ç°„Ç§„É´„ÇíÁîüÊàê„Åó„Åæ„Åó„Åü: li2o_relax/&quot;)
print(f&quot;k-pointË®≠ÂÆö:&quot;)
with open(&quot;li2o_relax/KPOINTS&quot;, 'r') as f:
    print(f.read())
</code></pre>


</details>

<h3>ÂïèÈ°å3ÔºàÈõ£ÊòìÂ∫¶: hardÔºâ</h3>
<p><strong>ÂïèÈ°å</strong>: 100ÂÄã„ÅÆÈÖ∏ÂåñÁâ©ÔºàCIFÂΩ¢ÂºèÔºâ„Å´„Å§„ÅÑ„Å¶„ÄÅ‰ª•‰∏ã„ÅÆÊù°‰ª∂„ÅßËá™ÂãïË®àÁÆó„ÇíË®≠ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö</p>
<ol>
<li>Materials ProjectÊ®ôÊ∫ñË®≠ÂÆö„ÅßÊßãÈÄ†ÊúÄÈÅ©Âåñ</li>
<li>k-pointÂØÜÂ∫¶„ÅØ1500</li>
<li>ÂêÑÊùêÊñô„Åî„Å®„Å´„Éá„Ç£„É¨„ÇØ„Éà„É™„Çí‰ΩúÊàê</li>
<li>SLURM„Ç∏„Éß„Éñ„Çπ„ÇØ„É™„Éó„Éà„ÇíËá™ÂãïÁîüÊàê</li>
<li>„Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞ÔºàË™≠„ÅøËæº„ÅøÂ§±ÊïóÊôÇ„ÅØ„Çπ„Ç≠„ÉÉ„ÉóÔºâ</li>
</ol>
<details>
<summary>„Éí„É≥„Éà</summary>

„Éê„ÉÉ„ÉÅÂá¶ÁêÜ„ÅÆ„Ç≥„Éº„Éâ‰æã„ÇíÂèÇËÄÉ„Å´„ÄÅ„Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„ÇíËøΩÂä†„ÄÇ

</details>

<details>
<summary>Ëß£Á≠î‰æã</summary>


<pre><code class="language-python">import os
from pymatgen.core import Structure
from pymatgen.io.vasp.sets import MPRelaxSet
from glob import glob

def batch_process_oxides(cif_directory, output_root='oxide_calculations'):
    &quot;&quot;&quot;
    100ÂÄã„ÅÆÈÖ∏ÂåñÁâ©„Çí‰∏ÄÊã¨Âá¶ÁêÜ
    &quot;&quot;&quot;
    # CIF„Éï„Ç°„Ç§„É´„É™„Çπ„Éà
    cif_files = glob(os.path.join(cif_directory, &quot;*.cif&quot;))
    print(f&quot;CIF„Éï„Ç°„Ç§„É´Êï∞: {len(cif_files)}&quot;)

    os.makedirs(output_root, exist_ok=True)

    success_count = 0
    error_count = 0

    for cif_file in cif_files:
        try:
            # ÊßãÈÄ†Ë™≠„ÅøËæº„Åø
            structure = Structure.from_file(cif_file)
            formula = structure.composition.reduced_formula

            # ÈÖ∏ÂåñÁâ©„ÅÆ„ÅøÂá¶ÁêÜ
            if 'O' not in structure.composition.elements:
                print(f&quot;„Çπ„Ç≠„ÉÉ„ÉóÔºàÈÖ∏ÂåñÁâ©„Åß„ÅØ„Å™„ÅÑÔºâ: {formula}&quot;)
                continue

            print(f&quot;Âá¶ÁêÜ‰∏≠ ({success_count+1}): {formula}&quot;)

            # Âá∫Âäõ„Éá„Ç£„É¨„ÇØ„Éà„É™
            calc_dir = os.path.join(output_root, formula)

            # InputSet‰ΩúÊàêÔºàk-pointÂØÜÂ∫¶1500Ôºâ
            relax_set = MPRelaxSet(
                structure,
                user_kpoints_settings={&quot;reciprocal_density&quot;: 1500}
            )
            relax_set.write_input(calc_dir)

            # „Ç∏„Éß„Éñ„Çπ„ÇØ„É™„Éó„Éà‰ΩúÊàê
            create_slurm_script(calc_dir, formula)

            success_count += 1

        except Exception as e:
            print(f&quot;„Ç®„É©„Éº: {cif_file} - {e}&quot;)
            error_count += 1
            continue

    print(f&quot;\nÂÆå‰∫Ü:&quot;)
    print(f&quot;  ÊàêÂäü: {success_count}&quot;)
    print(f&quot;  Â§±Êïó: {error_count}&quot;)

def create_slurm_script(directory, jobname):
    &quot;&quot;&quot;SLURM„Ç∏„Éß„Éñ„Çπ„ÇØ„É™„Éó„Éà&quot;&quot;&quot;
    script = f&quot;&quot;&quot;#!/bin/bash
#SBATCH --job-name={jobname}
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=48
#SBATCH --time=24:00:00
#SBATCH --partition=standard
#SBATCH --output=slurm-%j.out
#SBATCH --error=slurm-%j.err

# Áí∞Â¢ÉË®≠ÂÆö
module load intel/2021.2
module load vasp/6.3.0

# VASPÂÆüË°å
mpirun -np 48 vasp_std

# ÂèéÊùü„ÉÅ„Çß„ÉÉ„ÇØ
if grep -q &quot;reached required accuracy&quot; OUTCAR; then
    echo &quot;ÂèéÊùüÊàêÂäü&quot;
    exit 0
else
    echo &quot;ÂèéÊùüÂ§±Êïó&quot;
    exit 1
fi
&quot;&quot;&quot;

    with open(os.path.join(directory, &quot;job.sh&quot;), 'w') as f:
        f.write(script)

# ÂÆüË°å
batch_process_oxides(&quot;oxide_cifs&quot;, output_root=&quot;oxide_ht_calculations&quot;)
</code></pre>


**Âá∫Âäõ‰æã**:

<pre><code>CIF„Éï„Ç°„Ç§„É´Êï∞: 100
Âá¶ÁêÜ‰∏≠ (1): Li2O
Âá¶ÁêÜ‰∏≠ (2): Na2O
„Çπ„Ç≠„ÉÉ„ÉóÔºàÈÖ∏ÂåñÁâ©„Åß„ÅØ„Å™„ÅÑÔºâ: LiCl
Âá¶ÁêÜ‰∏≠ (3): MgO
...
ÂÆå‰∫Ü:
  ÊàêÂäü: 95
  Â§±Êïó: 5
</code></pre>


</details>

<hr />
<h2>2.7 „Åæ„Å®„ÇÅ</h2>
<p>„Åì„ÅÆÁ´†„Åß„ÅØ„ÄÅASE„Å®pymatgen„Çí‰Ωø„Å£„ÅüDFTË®àÁÆó„ÅÆËá™ÂãïÂåñ„ÇíÂ≠¶„Å≥„Åæ„Åó„Åü„ÄÇ</p>
<p><strong>„Ç≠„Éº„Éù„Ç§„É≥„Éà</strong>:</p>
<ol>
<li><strong>ASE</strong>: Áµ±‰∏Ä„Ç§„É≥„Çø„Éº„Éï„Çß„Éº„Çπ„ÅßÂ§öÊßò„Å™Ë®àÁÆó„Ç≥„Éº„Éâ„ÇíÊìç‰Ωú</li>
<li><strong>VASPËá™ÂãïÂåñ</strong>: INCAR„ÄÅKPOINTS„ÄÅPOTCAR„ÅÆËá™ÂãïÁîüÊàê</li>
<li><strong>QEËá™ÂãïÂåñ</strong>: ÂÖ•Âäõ„Éï„Ç°„Ç§„É´„ÉÜ„É≥„Éó„É¨„Éº„Éà</li>
<li><strong>pymatgen InputSet</strong>: Materials ProjectÊ®ôÊ∫ñË®≠ÂÆö</li>
<li><strong>„Ç®„É©„ÉºÂá¶ÁêÜ</strong>: ÂèéÊùü„ÉÅ„Çß„ÉÉ„ÇØ„Å®Ëá™Âãï„É™„Çπ„Çø„Éº„Éà</li>
<li><strong>„Éê„ÉÉ„ÉÅÂá¶ÁêÜ</strong>: Ë§áÊï∞ÊùêÊñô„ÅÆ‰∏ÄÊã¨Ë®àÁÆó</li>
</ol>
<p><strong>Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó</strong>:</p>
<p>Á¨¨3Á´†„Åß„ÅØ„ÄÅ<strong>„Ç∏„Éß„Éñ„Çπ„Ç±„Ç∏„É•„Éº„É™„É≥„Ç∞„Å®‰∏¶ÂàóÂåñ</strong>„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇSLURM„Çπ„ÇØ„É™„Éó„Éà„ÅÆ‰ΩúÊàê„ÄÅMPI„Å´„Çà„ÇãÂ§ßË¶èÊ®°‰∏¶ÂàóË®àÁÆó„ÄÅ1000ÊùêÊñôË¶èÊ®°„ÅÆÂäπÁéáÁöÑ„Å™ÁÆ°ÁêÜÊâãÊ≥ï„ÇíÁøíÂæó„Åó„Åæ„Åô„ÄÇ</p>
<p><strong><a href="./chapter-3.html">Á¨¨3Á´†: „Ç∏„Éß„Éñ„Çπ„Ç±„Ç∏„É•„Éº„É™„É≥„Ç∞„Å®‰∏¶ÂàóÂåñ ‚Üí</a></strong></p>
<hr />
<h2>ÂèÇËÄÉÊñáÁåÆ</h2>
<ol>
<li>
<p>Larsen, A. H., et al. (2017). "The atomic simulation environment‚Äîa Python library for working with atoms." <em>Journal of Physics: Condensed Matter</em>, 29(27), 273002.</p>
</li>
<li>
<p>Ong, S. P., et al. (2013). "Python Materials Genomics (pymatgen): A robust, open-source python library for materials analysis." <em>Computational Materials Science</em>, 68, 314-319.</p>
</li>
<li>
<p>Kresse, G., &amp; Furthm√ºller, J. (1996). "Efficient iterative schemes for ab initio total-energy calculations using a plane-wave basis set." <em>Physical Review B</em>, 54(16), 11169.</p>
</li>
<li>
<p>Giannozzi, P., et al. (2009). "QUANTUM ESPRESSO: a modular and open-source software project for quantum simulations of materials." <em>Journal of Physics: Condensed Matter</em>, 21(39), 395502.</p>
</li>
</ol>
<hr />
<p><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: CC BY 4.0
<strong>‰ΩúÊàêÊó•</strong>: 2025-10-17
<strong>‰ΩúÊàêËÄÖ</strong>: Dr. Yusuke Hashimoto, Tohoku University</p><div class="navigation">
    <a href="chapter-1.html" class="nav-button">‚Üê Ââç„ÅÆÁ´†</a>
    <a href="index.html" class="nav-button">„Ç∑„É™„Éº„Ç∫ÁõÆÊ¨°„Å´Êàª„Çã</a>
    <a href="chapter-3.html" class="nav-button">Ê¨°„ÅÆÁ´† ‚Üí</a>
</div>
    </main>

    <footer>
        <p><strong>‰ΩúÊàêËÄÖ</strong>: AI Terakoya Content Team</p>
        <p><strong>Áõ£‰øÆ</strong>: Dr. Yusuke HashimotoÔºàÊù±ÂåóÂ§ßÂ≠¶Ôºâ</p>
        <p><strong>„Éê„Éº„Ç∏„Éß„É≥</strong>: 1.0 | <strong>‰ΩúÊàêÊó•</strong>: 2025-10-17</p>
        <p><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: Creative Commons BY 4.0</p>
        <p>¬© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
