<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« ï¼šãƒ‡ãƒ¼ã‚¿ç®¡ç†ã¨ãƒã‚¹ãƒˆãƒ—ãƒ­ã‚»ã‚¹ï¼ˆFireWorks, AiiDAï¼‰ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../MI/index.html">ãƒãƒ†ãƒªã‚¢ãƒ«ã‚ºãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a><span class="breadcrumb-separator">â€º</span><a href="../../MI/high-throughput-computing-introduction/index.html">High Throughput Computing</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 4</span>
        </div>
    </nav>

        <header>
        <div class="header-content">
            <h1>ç¬¬4ç« ï¼šãƒ‡ãƒ¼ã‚¿ç®¡ç†ã¨ãƒã‚¹ãƒˆãƒ—ãƒ­ã‚»ã‚¹ï¼ˆFireWorks, AiiDAï¼‰</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 20-25åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸Šç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 6å€‹</span>
                <span class="meta-item">ğŸ“ æ¼”ç¿’å•é¡Œ: 0å•</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>ç¬¬4ç« ï¼šãƒ‡ãƒ¼ã‚¿ç®¡ç†ã¨ãƒã‚¹ãƒˆãƒ—ãƒ­ã‚»ã‚¹ï¼ˆFireWorks, AiiDAï¼‰</h1>
<p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-left: 4px solid #7b2cbf; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">SLURMã‚„ã‚¯ãƒ©ã‚¦ãƒ‰ã‚’ä½¿ã£ã¦ã‚¹ã‚±ãƒ¼ãƒ«ã•ã›ã‚‹æ‰‹é †ã‚’å…·ä½“çš„ã«ç¤ºã—ã¾ã™ã€‚ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Šã¨æœ€é©åŒ–ã®å‹˜æ‰€ã‚‚å­¦ã³ã¾ã™ã€‚</p>
<p class="chapter-supplement" style="margin: 0.75rem 0 1.5rem 0; padding: 0.75rem 1rem; background: linear-gradient(135deg, #fff8e1 0%, #fff3cd 100%); border-left: 3px solid #f59e0b; border-radius: 6px; font-size: 0.95rem; line-height: 1.7; color: #4a5568;"><strong>ğŸ’¡ è£œè¶³:</strong> å˜ä¾¡Ã—æ™‚é–“Ã—å°æ•°ã§ç²—è¦‹ç©ã‚‚ã‚Šâ†’ä¸Šé™è¨­å®šã€‚ä¸¦åˆ—åº¦ã®ä¸Šã’éãã¯å¤±æ•—ç‡ã‚’ä¸Šã’ã‚‹ãŸã‚æ³¨æ„ã€‚</p>





<h2>å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
<ul>
<li>âœ… FireWorksã§è¤‡é›‘ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
<li>âœ… Atomateã®æ¨™æº–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½¿ã„ã“ãªã›ã‚‹</li>
<li>âœ… AiiDAã§ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒ“ãƒŠãƒ³ã‚¹ã‚’è¨˜éŒ²ã§ãã‚‹</li>
<li>âœ… è¨ˆç®—çµæœã‚’æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã§ãã‚‹</li>
<li>âœ… çµæœã‚’NOMADã«å…¬é–‹ã§ãã‚‹</li>
</ul>
<hr />
<h2>4.1 FireWorksã«ã‚ˆã‚‹ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†</h2>
<h3>FireWorksã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h3>
<div class="mermaid">
flowchart TD
    A[Firework] -->|é€£é–| B[Workflow]
    B --> C[LaunchPad\nMongoDB]
    C -->|ã‚¿ã‚¹ã‚¯å‰²å½“| D[Rocket Launcher]
    D -->|å®Ÿè¡Œ| E[è¨ˆç®—ãƒãƒ¼ãƒ‰]
    E -->|çµæœ| C

    style C fill:#4ecdc4
    style A fill:#ffe66d
    style B fill:#ff6b6b
</div>

<p><strong>ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</strong>:
- <strong>Firework</strong>: å˜ä¸€ã‚¿ã‚¹ã‚¯ï¼ˆ1ã¤ã®DFTè¨ˆç®—ï¼‰
- <strong>Workflow</strong>: è¤‡æ•°Fireworkã®é€£é–
- <strong>LaunchPad</strong>: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆMongoDBï¼‰
- <strong>Rocket</strong>: ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³</p>
<h3>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨è¨­å®š</h3>
<pre><code class="language-bash"># FireWorksã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install fireworks

# MongoDBã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆmacOSï¼‰
brew install mongodb-community

# MongoDBèµ·å‹•
brew services start mongodb-community

# FireWorksè¨­å®š
lpad init
# â†’ my_launchpad.yamlãŒç”Ÿæˆã•ã‚Œã‚‹
</code></pre>
<p><strong>my_launchpad.yaml</strong>:</p>
<pre><code class="language-yaml">host: localhost
port: 27017
name: fireworks
username: null
password: null
</code></pre>
<h3>åŸºæœ¬çš„ãªFireworkä½œæˆ</h3>
<pre><code class="language-python">from fireworks import Firework, LaunchPad, ScriptTask
from fireworks.core.rocket_launcher import rapidfire

# LaunchPadï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰ã«æ¥ç¶š
launchpad = LaunchPad(host='localhost', port=27017, name='fireworks')

# Taskå®šç¾©ï¼ˆVASPå®Ÿè¡Œï¼‰
vasp_task = ScriptTask.from_str(
    'mpirun -np 48 vasp_std',
    use_shell=True
)

# Fireworkä½œæˆ
fw = Firework(
    vasp_task,
    name='VASP relaxation',
    spec={'_category': 'VASP'}
)

# LaunchPadã«è¿½åŠ 
launchpad.add_wf(fw)

# å®Ÿè¡Œ
rapidfire(launchpad)
</code></pre>
<h3>Atomateã®æ¨™æº–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h3>
<p><strong>Atomate</strong>ã¯ã€Materials Projectã§ä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹æ¨™æº–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚</p>
<pre><code class="language-python">from atomate.vasp.workflows.base.core import get_wf
from pymatgen.core import Structure

# æ§‹é€ èª­ã¿è¾¼ã¿
structure = Structure.from_file(&quot;LiCoO2.cif&quot;)

# æ¨™æº–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å–å¾—
# optimize_structure_and_properties:
#   1. æ§‹é€ æœ€é©åŒ–
#   2. é™çš„è¨ˆç®—
#   3. ãƒãƒ³ãƒ‰æ§‹é€ 
#   4. DOSè¨ˆç®—
wf = get_wf(
    structure,
    &quot;optimize_structure_and_properties.yaml&quot;
)

# LaunchPadã«è¿½åŠ 
launchpad.add_wf(wf)

# å®Ÿè¡Œ
rapidfire(launchpad, nlaunches='infinite')
</code></pre>
<h3>ã‚«ã‚¹ã‚¿ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ä½œæˆ</h3>
<pre><code class="language-python">from fireworks import Firework, Workflow
from fireworks.core.firework import FiretaskBase
from atomate.vasp.firetasks.write_inputs import WriteVaspFromIOSet
from atomate.vasp.firetasks.run_calc import RunVaspCustodian
from atomate.vasp.firetasks.parse_outputs import VaspToDb
from pymatgen.io.vasp.sets import MPRelaxSet, MPStaticSet

class CustomWorkflow:
    &quot;&quot;&quot;ã‚«ã‚¹ã‚¿ãƒ ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç”Ÿæˆ&quot;&quot;&quot;

    @staticmethod
    def bandgap_workflow(structure):
        &quot;&quot;&quot;
        ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—è¨ˆç®—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
        1. æ§‹é€ æœ€é©åŒ– â†’ 2. é™çš„è¨ˆç®— â†’ 3. ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æŠ½å‡º
        &quot;&quot;&quot;
        # Firework 1: æ§‹é€ æœ€é©åŒ–
        fw1 = Firework(
            [
                WriteVaspFromIOSet(structure=structure, vasp_input_set=MPRelaxSet),
                RunVaspCustodian(vasp_cmd=&quot;vasp_std&quot;),
                VaspToDb(db_file=&quot;db.json&quot;, task_label=&quot;relax&quot;)
            ],
            name=&quot;Structural relaxation&quot;,
            spec={&quot;_category&quot;: &quot;relax&quot;}
        )

        # Firework 2: é™çš„è¨ˆç®—
        fw2 = Firework(
            [
                WriteVaspFromIOSet(structure=structure, vasp_input_set=MPStaticSet),
                RunVaspCustodian(vasp_cmd=&quot;vasp_std&quot;),
                VaspToDb(db_file=&quot;db.json&quot;, task_label=&quot;static&quot;)
            ],
            name=&quot;Static calculation&quot;,
            spec={&quot;_category&quot;: &quot;static&quot;}
        )

        # Firework 3: ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æŠ½å‡º
        fw3 = Firework(
            [ExtractBandgapTask()],
            name=&quot;Extract bandgap&quot;
        )

        # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ§‹ç¯‰ï¼ˆfw1 â†’ fw2 â†’ fw3ï¼‰
        wf = Workflow(
            [fw1, fw2, fw3],
            links_dict={fw1: [fw2], fw2: [fw3]},
            name=f&quot;Bandgap workflow: {structure.composition.reduced_formula}&quot;
        )

        return wf


class ExtractBandgapTask(FiretaskBase):
    &quot;&quot;&quot;ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æŠ½å‡ºã‚¿ã‚¹ã‚¯&quot;&quot;&quot;

    def run_task(self, fw_spec):
        from pymatgen.io.vasp.outputs import Vasprun

        vasprun = Vasprun(&quot;vasprun.xml&quot;)
        bandgap = vasprun.get_band_structure().get_band_gap()

        print(f&quot;ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: {bandgap['energy']:.3f} eV&quot;)

        # çµæœã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜
        return {&quot;bandgap&quot;: bandgap['energy']}

# ä½¿ç”¨ä¾‹
structure = Structure.from_file(&quot;LiCoO2.cif&quot;)
wf = CustomWorkflow.bandgap_workflow(structure)

launchpad.add_wf(wf)
rapidfire(launchpad)
</code></pre>
<h3>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒªã‚¹ã‚¿ãƒ¼ãƒˆ</h3>
<pre><code class="language-python">from custodian.custodian import Custodian
from custodian.vasp.handlers import VaspErrorHandler, UnconvergedErrorHandler
from custodian.vasp.jobs import VaspJob

# ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ãƒ¼è¨­å®š
handlers = [
    VaspErrorHandler(),           # ä¸€èˆ¬çš„ãªVASPã‚¨ãƒ©ãƒ¼
    UnconvergedErrorHandler(),    # åæŸæ€§ã‚¨ãƒ©ãƒ¼
]

# VASPã‚¸ãƒ§ãƒ–å®šç¾©
jobs = [
    VaspJob(
        vasp_cmd=[&quot;mpirun&quot;, &quot;-np&quot;, &quot;48&quot;, &quot;vasp_std&quot;],
        output_file=&quot;vasp.out&quot;,
        auto_npar=False
    )
]

# Custodianå®Ÿè¡Œï¼ˆè‡ªå‹•ã‚¨ãƒ©ãƒ¼å‡¦ç†ï¼‰
c = Custodian(
    handlers=handlers,
    jobs=jobs,
    max_errors=5
)

c.run()
</code></pre>
<hr />
<h2>4.2 AiiDAã«ã‚ˆã‚‹ãƒ—ãƒ­ãƒ“ãƒŠãƒ³ã‚¹ç®¡ç†</h2>
<h3>ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒ“ãƒŠãƒ³ã‚¹ï¼ˆæ¥æ­´è¿½è·¡ï¼‰ã®é‡è¦æ€§</h3>
<p><strong>ãƒ—ãƒ­ãƒ“ãƒŠãƒ³ã‚¹</strong>ã¨ã¯ã€è¨ˆç®—çµæœãŒã©ã®ã‚ˆã†ã«å¾—ã‚‰ã‚ŒãŸã‹ã®å®Œå…¨ãªè¨˜éŒ²ã§ã™ã€‚</p>
<p><strong>è¿½è·¡ã™ã¹ãæƒ…å ±</strong>:
- å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ï¼ˆæ§‹é€ ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰
- ä½¿ç”¨ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆVASP 6.3.0ç­‰ï¼‰
- è¨ˆç®—ç’°å¢ƒï¼ˆãƒãƒ¼ãƒ‰ã€ã‚³ã‚¢æ•°ã€æ—¥æ™‚ï¼‰
- ä¸­é–“çµæœ
- æœ€çµ‚çµæœ</p>
<h3>AiiDAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h3>
<pre><code class="language-bash"># AiiDAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install aiida-core aiida-vasp

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
verdi quicksetup

# å‹•ä½œç¢ºèª
verdi status
</code></pre>
<h3>AiiDAã§ã®è¨ˆç®—å®Ÿè¡Œ</h3>
<pre><code class="language-python">from aiida import orm, engine
from aiida.plugins import CalculationFactory, DataFactory

# VASPè¨ˆç®—ã‚¯ãƒ©ã‚¹å–å¾—
VaspCalculation = CalculationFactory('vasp.vasp')

# ãƒ‡ãƒ¼ã‚¿å‹
StructureData = DataFactory('structure')
KpointsData = DataFactory('array.kpoints')

# æ§‹é€ ãƒ‡ãƒ¼ã‚¿ä½œæˆ
structure = StructureData()
# ï¼ˆæ§‹é€ ã‚’è¨­å®šï¼‰

# k-pointsè¨­å®š
kpoints = KpointsData()
kpoints.set_kpoints_mesh([8, 8, 8])

# è¨ˆç®—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
parameters = orm.Dict(dict={
    'ENCUT': 520,
    'EDIFF': 1e-5,
    'ISMEAR': 0,
    'SIGMA': 0.05,
})

# è¨ˆç®—ãƒ“ãƒ«ãƒ€ãƒ¼
builder = VaspCalculation.get_builder()
builder.structure = structure
builder.kpoints = kpoints
builder.parameters = parameters
builder.code = orm.Code.get_from_string('vasp@localhost')

# å®Ÿè¡Œ
calc_node = engine.submit(builder)
print(f&quot;è¨ˆç®—ãƒãƒ¼ãƒ‰: {calc_node.pk}&quot;)
</code></pre>
<h3>ãƒ‡ãƒ¼ã‚¿ã‚¯ã‚¨ãƒª</h3>
<pre><code class="language-python">from aiida.orm import QueryBuilder

# ã™ã¹ã¦ã®VASPè¨ˆç®—ã‚’æ¤œç´¢
qb = QueryBuilder()
qb.append(VaspCalculation, filters={'attributes.exit_status': 0})

for calc in qb.all():
    print(f&quot;PK: {calc[0].pk}, Formula: {calc[0].inputs.structure.get_formula()}&quot;)

# ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒ1.5-2.5 eVã®ææ–™ã‚’æ¤œç´¢
qb = QueryBuilder()
qb.append(VaspCalculation, tag='calc')
qb.append(orm.Dict, with_incoming='calc', filters={
    'attributes.band_gap': {'and': [{'&gt;=': 1.5}, {'&lt;=': 2.5}]}
})

results = qb.all()
print(f&quot;è©²å½“ã™ã‚‹ææ–™: {len(results)}å€‹&quot;)
</code></pre>
<hr />
<h2>4.3 è¨ˆç®—ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ åŒ–</h2>
<h3>JSONã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ</h3>
<pre><code class="language-python">import json
from datetime import datetime

class MaterialsDataSchema:
    &quot;&quot;&quot;ææ–™è¨ˆç®—ãƒ‡ãƒ¼ã‚¿ã®ã‚¹ã‚­ãƒ¼ãƒ&quot;&quot;&quot;

    @staticmethod
    def create_entry(material_id, formula, structure, calculation_results):
        &quot;&quot;&quot;
        ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ³ãƒˆãƒªã‚’ä½œæˆ

        Returns:
        --------
        entry : dict
            æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿
        &quot;&quot;&quot;
        entry = {
            # è­˜åˆ¥æƒ…å ±
            &quot;material_id&quot;: material_id,
            &quot;formula&quot;: formula,
            &quot;created_at&quot;: datetime.now().isoformat(),

            # æ§‹é€ æƒ…å ±
            &quot;structure&quot;: {
                &quot;lattice&quot;: structure.lattice.matrix.tolist(),
                &quot;species&quot;: [str(site.specie) for site in structure],
                &quot;coords&quot;: [site.frac_coords.tolist() for site in structure],
                &quot;space_group&quot;: structure.get_space_group_info()[1]
            },

            # è¨ˆç®—çµæœ
            &quot;properties&quot;: {
                &quot;energy&quot;: calculation_results.get(&quot;energy&quot;),
                &quot;band_gap&quot;: calculation_results.get(&quot;band_gap&quot;),
                &quot;formation_energy&quot;: calculation_results.get(&quot;formation_energy&quot;),
            },

            # è¨ˆç®—ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
            &quot;calculation_metadata&quot;: {
                &quot;software&quot;: &quot;VASP 6.3.0&quot;,
                &quot;functional&quot;: &quot;PBE&quot;,
                &quot;encut&quot;: 520,
                &quot;kpoints&quot;: calculation_results.get(&quot;kpoints&quot;),
                &quot;converged&quot;: calculation_results.get(&quot;converged&quot;),
                &quot;calculation_time&quot;: calculation_results.get(&quot;calculation_time&quot;),
            },

            # ãƒ—ãƒ­ãƒ“ãƒŠãƒ³ã‚¹
            &quot;provenance&quot;: {
                &quot;input_structure_source&quot;: &quot;Materials Project&quot;,
                &quot;workflow&quot;: &quot;Atomate optimize_structure&quot;,
                &quot;hostname&quot;: calculation_results.get(&quot;hostname&quot;),
                &quot;date&quot;: calculation_results.get(&quot;date&quot;),
            }
        }

        return entry

# ä½¿ç”¨ä¾‹
entry = MaterialsDataSchema.create_entry(
    material_id=&quot;custom-0001&quot;,
    formula=&quot;LiCoO2&quot;,
    structure=structure,
    calculation_results={
        &quot;energy&quot;: -45.67,
        &quot;band_gap&quot;: 2.3,
        &quot;converged&quot;: True,
        &quot;kpoints&quot;: [12, 12, 8],
        &quot;calculation_time&quot;: &quot;2.5 hours&quot;,
        &quot;hostname&quot;: &quot;hpc.university.edu&quot;,
        &quot;date&quot;: &quot;2025-10-17&quot;,
    }
)

# JSONä¿å­˜
with open(&quot;data/custom-0001.json&quot;, 'w') as f:
    json.dump(entry, f, indent=2)
</code></pre>
<h3>MongoDBã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h3>
<pre><code class="language-python">from pymongo import MongoClient
import json

class MaterialsDatabase:
    &quot;&quot;&quot;MongoDBã«ã‚ˆã‚‹ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹&quot;&quot;&quot;

    def __init__(self, host='localhost', port=27017, db_name='materials'):
        self.client = MongoClient(host, port)
        self.db = self.client[db_name]
        self.collection = self.db['calculations']

        # ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆï¼ˆæ¤œç´¢é«˜é€ŸåŒ–ï¼‰
        self.collection.create_index(&quot;material_id&quot;, unique=True)
        self.collection.create_index(&quot;formula&quot;)
        self.collection.create_index(&quot;properties.band_gap&quot;)

    def insert(self, entry):
        &quot;&quot;&quot;ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥&quot;&quot;&quot;
        result = self.collection.insert_one(entry)
        return result.inserted_id

    def find_by_formula(self, formula):
        &quot;&quot;&quot;åŒ–å­¦å¼ã§æ¤œç´¢&quot;&quot;&quot;
        return list(self.collection.find({&quot;formula&quot;: formula}))

    def find_by_bandgap_range(self, min_gap, max_gap):
        &quot;&quot;&quot;ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ç¯„å›²ã§æ¤œç´¢&quot;&quot;&quot;
        query = {
            &quot;properties.band_gap&quot;: {
                &quot;$gte&quot;: min_gap,
                &quot;$lte&quot;: max_gap
            }
        }
        return list(self.collection.find(query))

    def get_statistics(self):
        &quot;&quot;&quot;çµ±è¨ˆæƒ…å ±&quot;&quot;&quot;
        pipeline = [
            {
                &quot;$group&quot;: {
                    &quot;_id&quot;: None,
                    &quot;total&quot;: {&quot;$sum&quot;: 1},
                    &quot;avg_bandgap&quot;: {&quot;$avg&quot;: &quot;$properties.band_gap&quot;},
                    &quot;avg_energy&quot;: {&quot;$avg&quot;: &quot;$properties.energy&quot;}
                }
            }
        ]

        result = list(self.collection.aggregate(pipeline))
        return result[0] if result else {}

# ä½¿ç”¨ä¾‹
db = MaterialsDatabase()

# ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥
db.insert(entry)

# æ¤œç´¢
licoo2_results = db.find_by_formula(&quot;LiCoO2&quot;)
print(f&quot;LiCoO2ã®è¨ˆç®—: {len(licoo2_results)}ä»¶&quot;)

# ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¤œç´¢
semiconductors = db.find_by_bandgap_range(0.5, 3.0)
print(f&quot;åŠå°ä½“ï¼ˆ0.5-3.0 eVï¼‰: {len(semiconductors)}ä»¶&quot;)

# çµ±è¨ˆ
stats = db.get_statistics()
print(f&quot;å¹³å‡ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: {stats['avg_bandgap']:.2f} eV&quot;)
</code></pre>
<hr />
<h2>4.4 ãƒã‚¹ãƒˆãƒ—ãƒ­ã‚»ã‚¹ã®è‡ªå‹•åŒ–</h2>
<h3>DOS/ãƒãƒ³ãƒ‰æ§‹é€ ã®è‡ªå‹•ãƒ—ãƒ­ãƒƒãƒˆ</h3>
<pre><code class="language-python">from pymatgen.io.vasp.outputs import Vasprun
from pymatgen.electronic_structure.plotter import BSPlotter, DosPlotter
import matplotlib.pyplot as plt

def auto_plot_band_dos(directory):
    &quot;&quot;&quot;
    ãƒãƒ³ãƒ‰æ§‹é€ ã¨DOSã‚’è‡ªå‹•ãƒ—ãƒ­ãƒƒãƒˆ

    Parameters:
    -----------
    directory : str
        vasprun.xmlãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
    &quot;&quot;&quot;
    vasprun = Vasprun(f&quot;{directory}/vasprun.xml&quot;)

    # ãƒãƒ³ãƒ‰æ§‹é€ 
    bs = vasprun.get_band_structure()
    bs_plotter = BSPlotter(bs)

    fig = bs_plotter.get_plot(ylim=[-5, 5])
    fig.savefig(f&quot;{directory}/band_structure.png&quot;, dpi=300)
    print(f&quot;ãƒãƒ³ãƒ‰æ§‹é€ ã‚’ä¿å­˜: {directory}/band_structure.png&quot;)

    # DOS
    dos = vasprun.complete_dos
    dos_plotter = DosPlotter()
    dos_plotter.add_dos(&quot;Total&quot;, dos)

    fig = dos_plotter.get_plot(xlim=[-5, 5])
    fig.savefig(f&quot;{directory}/dos.png&quot;, dpi=300)
    print(f&quot;DOSã‚’ä¿å­˜: {directory}/dos.png&quot;)

    # ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—
    bandgap = bs.get_band_gap()
    print(f&quot;ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: {bandgap['energy']:.3f} eV ({bandgap['transition']})&quot;)

# ä½¿ç”¨ä¾‹
auto_plot_band_dos(&quot;calculations/LiCoO2&quot;)
</code></pre>
<h3>ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆ</h3>
<pre><code class="language-python">from jinja2 import Template
from datetime import datetime

def generate_report(material_data, output_file=&quot;report.html&quot;):
    &quot;&quot;&quot;
    è¨ˆç®—çµæœãƒ¬ãƒãƒ¼ãƒˆã‚’è‡ªå‹•ç”Ÿæˆ

    Parameters:
    -----------
    material_data : dict
        ææ–™ãƒ‡ãƒ¼ã‚¿
    output_file : str
        å‡ºåŠ›HTMLãƒ•ã‚¡ã‚¤ãƒ«
    &quot;&quot;&quot;
    template_str = &quot;&quot;&quot;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;è¨ˆç®—ãƒ¬ãƒãƒ¼ãƒˆ: {{ material_data.formula }}&lt;/title&gt;
    &lt;style&gt;
        body { font-family: Arial, sans-serif; margin: 40px; }
        table { border-collapse: collapse; width: 100%; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #4CAF50; color: white; }
        img { max-width: 600px; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;{{ material_data.formula }}&lt;/h1&gt;
    &lt;p&gt;ç”Ÿæˆæ—¥æ™‚: {{ generation_time }}&lt;/p&gt;

    &lt;h2&gt;æ§‹é€ æƒ…å ±&lt;/h2&gt;
    &lt;table&gt;
        &lt;tr&gt;&lt;th&gt;é …ç›®&lt;/th&gt;&lt;th&gt;å€¤&lt;/th&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;ç©ºé–“ç¾¤&lt;/td&gt;&lt;td&gt;{{ material_data.structure.space_group }}&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;æ ¼å­å®šæ•° a&lt;/td&gt;&lt;td&gt;{{ &quot;%.3f&quot;|format(material_data.structure.lattice[0][0]) }} Ã…&lt;/td&gt;&lt;/tr&gt;
    &lt;/table&gt;

    &lt;h2&gt;è¨ˆç®—çµæœ&lt;/h2&gt;
    &lt;table&gt;
        &lt;tr&gt;&lt;th&gt;ç‰¹æ€§&lt;/th&gt;&lt;th&gt;å€¤&lt;/th&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;ã‚¨ãƒãƒ«ã‚®ãƒ¼&lt;/td&gt;&lt;td&gt;{{ &quot;%.3f&quot;|format(material_data.properties.energy) }} eV/atom&lt;/td&gt;&lt;/tr&gt;
        &lt;tr&gt;&lt;td&gt;ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—&lt;/td&gt;&lt;td&gt;{{ &quot;%.3f&quot;|format(material_data.properties.band_gap) }} eV&lt;/td&gt;&lt;/tr&gt;
    &lt;/table&gt;

    &lt;h2&gt;ãƒãƒ³ãƒ‰æ§‹é€ &lt;/h2&gt;
    &lt;img src=&quot;band_structure.png&quot; alt=&quot;ãƒãƒ³ãƒ‰æ§‹é€ &quot;&gt;

    &lt;h2&gt;çŠ¶æ…‹å¯†åº¦&lt;/h2&gt;
    &lt;img src=&quot;dos.png&quot; alt=&quot;DOS&quot;&gt;
&lt;/body&gt;
&lt;/html&gt;
    &quot;&quot;&quot;

    template = Template(template_str)

    html = template.render(
        material_data=material_data,
        generation_time=datetime.now().strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)
    )

    with open(output_file, 'w') as f:
        f.write(html)

    print(f&quot;ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ: {output_file}&quot;)

# ä½¿ç”¨ä¾‹
generate_report(entry, output_file=&quot;LiCoO2_report.html&quot;)
</code></pre>
<hr />
<h2>4.5 ãƒ‡ãƒ¼ã‚¿å…±æœ‰ã¨ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–</h2>
<h3>NOMAD Repositoryã¸ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</h3>
<pre><code class="language-python">import requests
import json

def upload_to_nomad(data_files, metadata):
    &quot;&quot;&quot;
    NOMAD Repositoryã«ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

    Parameters:
    -----------
    data_files : list
        ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆ
    metadata : dict
        ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
    &quot;&quot;&quot;
    nomad_url = &quot;https://nomad-lab.eu/prod/rae/api/v1/uploads&quot;

    # ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æº–å‚™
    upload_metadata = {
        &quot;upload_name&quot;: metadata.get(&quot;name&quot;, &quot;Untitled&quot;),
        &quot;references&quot;: metadata.get(&quot;references&quot;, []),
        &quot;coauthors&quot;: metadata.get(&quot;coauthors&quot;, []),
    }

    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    files = []
    for file_path in data_files:
        files.append(('file', open(file_path, 'rb')))

    response = requests.post(
        nomad_url,
        files=files,
        data={'metadata': json.dumps(upload_metadata)},
        headers={'Authorization': f'Bearer {NOMAD_API_TOKEN}'}
    )

    if response.status_code == 200:
        upload_id = response.json()['upload_id']
        print(f&quot;ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸ: {upload_id}&quot;)
        print(f&quot;URL: https://nomad-lab.eu/prod/rae/gui/uploads/{upload_id}&quot;)
        return upload_id
    else:
        print(f&quot;ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—: {response.status_code}&quot;)
        return None

# ä½¿ç”¨ä¾‹
files = [
    &quot;calculations/LiCoO2/vasprun.xml&quot;,
    &quot;calculations/LiCoO2/OUTCAR&quot;,
    &quot;calculations/LiCoO2/CONTCAR&quot;,
]

metadata = {
    &quot;name&quot;: &quot;LiCoO2 battery material calculations&quot;,
    &quot;references&quot;: [&quot;https://doi.org/10.xxxx/xxxxx&quot;],
    &quot;coauthors&quot;: [&quot;Dr. Yusuke Hashimoto&quot;]
}

upload_to_nomad(files, metadata)
</code></pre>
<hr />
<h2>4.6 æ¼”ç¿’å•é¡Œ</h2>
<h3>å•é¡Œ1ï¼ˆé›£æ˜“åº¦: mediumï¼‰</h3>
<p><strong>å•é¡Œ</strong>: FireWorksã§ã€æ§‹é€ æœ€é©åŒ–â†’é™çš„è¨ˆç®—ã®2ã‚¹ãƒ†ãƒƒãƒ—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
<details>
<summary>è§£ç­”ä¾‹</summary>


<pre><code class="language-python">from fireworks import Firework, Workflow
from atomate.vasp.firetasks.write_inputs import WriteVaspFromIOSet
from atomate.vasp.firetasks.run_calc import RunVaspCustodian
from pymatgen.io.vasp.sets import MPRelaxSet, MPStaticSet
from pymatgen.core import Structure

structure = Structure.from_file(&quot;POSCAR&quot;)

# Firework 1: æ§‹é€ æœ€é©åŒ–
fw1 = Firework(
    [
        WriteVaspFromIOSet(structure=structure, vasp_input_set=MPRelaxSet),
        RunVaspCustodian(vasp_cmd=&quot;vasp_std&quot;)
    ],
    name=&quot;Relax&quot;
)

# Firework 2: é™çš„è¨ˆç®—
fw2 = Firework(
    [
        WriteVaspFromIOSet(structure=structure, vasp_input_set=MPStaticSet),
        RunVaspCustodian(vasp_cmd=&quot;vasp_std&quot;)
    ],
    name=&quot;Static&quot;
)

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
wf = Workflow([fw1, fw2], links_dict={fw1: [fw2]})

launchpad.add_wf(wf)
</code></pre>


</details>

<h3>å•é¡Œ2ï¼ˆé›£æ˜“åº¦: hardï¼‰</h3>
<p><strong>å•é¡Œ</strong>: MongoDBã«ä¿å­˜ã•ã‚ŒãŸ1000ææ–™ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ä»¥ä¸‹ã‚’æŠ½å‡ºã—ã¦ãã ã•ã„ï¼š
1. ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒ1.0-2.0 eVã®åŠå°ä½“
2. å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒè² ï¼ˆå®‰å®šï¼‰
3. çµæœã‚’CSVã«ä¿å­˜</p>
<details>
<summary>è§£ç­”ä¾‹</summary>


<pre><code class="language-python">import pandas as pd

db = MaterialsDatabase()

# ã‚¯ã‚¨ãƒª
query = {
    &quot;properties.band_gap&quot;: {&quot;$gte&quot;: 1.0, &quot;$lte&quot;: 2.0},
    &quot;properties.formation_energy&quot;: {&quot;$lt&quot;: 0}
}

results = list(db.collection.find(query))

# DataFrameåŒ–
data = []
for r in results:
    data.append({
        &quot;formula&quot;: r[&quot;formula&quot;],
        &quot;band_gap&quot;: r[&quot;properties&quot;][&quot;band_gap&quot;],
        &quot;formation_energy&quot;: r[&quot;properties&quot;][&quot;formation_energy&quot;],
        &quot;space_group&quot;: r[&quot;structure&quot;][&quot;space_group&quot;]
    })

df = pd.DataFrame(data)

# CSVä¿å­˜
df.to_csv(&quot;stable_semiconductors.csv&quot;, index=False)
print(f&quot;è©²å½“ææ–™: {len(df)}å€‹&quot;)
print(df.head())
</code></pre>


</details>

<hr />
<h2>4.7 ã¾ã¨ã‚</h2>
<p><strong>ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ</strong>:</p>
<ol>
<li><strong>FireWorks</strong>: Materials Projectæ¨™æº–ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ç®¡ç†</li>
<li><strong>Atomate</strong>: æ¨™æº–åŒ–ã•ã‚ŒãŸè¨ˆç®—ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</li>
<li><strong>AiiDA</strong>: ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒ“ãƒŠãƒ³ã‚¹è¿½è·¡</li>
<li><strong>MongoDB</strong>: å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ç®¡ç†</li>
<li><strong>NOMAD</strong>: ãƒ‡ãƒ¼ã‚¿å…¬é–‹ã¨FAIRåŸå‰‡</li>
</ol>
<p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</strong>: ç¬¬5ç« ã§ã‚¯ãƒ©ã‚¦ãƒ‰HPCæ´»ç”¨ã‚’å­¦ã³ã¾ã™ã€‚</p>
<p><strong><a href="./chapter-5.html">ç¬¬5ç« : ã‚¯ãƒ©ã‚¦ãƒ‰HPCæ´»ç”¨ã¨æœ€é©åŒ– â†’</a></strong></p>
<hr />
<p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: CC BY 4.0
<strong>ä½œæˆæ—¥</strong>: 2025-10-17
<strong>ä½œæˆè€…</strong>: Dr. Yusuke Hashimoto, Tohoku University</p><div class="navigation">
    <a href="chapter-3.html" class="nav-button">â† å‰ã®ç« </a>
    <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
    <a href="chapter-5.html" class="nav-button">æ¬¡ã®ç«  â†’</a>
</div>
    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: AI Terakoya Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-17</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>Â© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
