<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á¨¨2Á´†ÔºöÈÖçÂàóËß£Êûê„Å®Ê©üÊ¢∞Â≠¶Áøí - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Á¨¨2Á´†ÔºöÈÖçÂàóËß£Êûê„Å®Ê©üÊ¢∞Â≠¶Áøí</h1>
            <p class="subtitle">„Çø„É≥„Éë„ÇØË≥™Ê©üËÉΩ‰∫àÊ∏¨„ÅÆÂÆüË∑µ</p>
            <div class="meta">
                <span class="meta-item">üìñ Ë™≠‰∫ÜÊôÇÈñì: 25-30ÂàÜ</span>
                <span class="meta-item">üìä Èõ£ÊòìÂ∫¶: ÂàùÁ¥ö„Äú‰∏≠Á¥ö</span>
                <span class="meta-item">üíª „Ç≥„Éº„Éâ‰æã: 9ÂÄã</span>
                <span class="meta-item">üìù ÊºîÁøíÂïèÈ°å: 3Âïè</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Á¨¨2Á´†ÔºöÈÖçÂàóËß£Êûê„Å®Ê©üÊ¢∞Â≠¶Áøí</h1>
<p><strong>„Çø„É≥„Éë„ÇØË≥™Ê©üËÉΩ‰∫àÊ∏¨„ÅÆÂÆüË∑µ</strong></p>
<h2>Â≠¶ÁøíÁõÆÊ®ô</h2>
<ul>
<li>‚úÖ BLASTÊ§úÁ¥¢„ÇíÂÆüË°å„Åó„ÄÅÁõ∏Âêå„Çø„É≥„Éë„ÇØË≥™„ÇíÁô∫Ë¶ã„Åß„Åç„Çã</li>
<li>‚úÖ „Ç¢„Éü„ÉéÈÖ∏ÈÖçÂàó„Åã„ÇâÁâ©ÁêÜÂåñÂ≠¶ÁöÑÁâπÂæ¥Èáè„ÇíÊäΩÂá∫„Åß„Åç„Çã</li>
<li>‚úÖ Ê©üÊ¢∞Â≠¶Áøí„É¢„Éá„É´„Åß„Çø„É≥„Éë„ÇØË≥™„ÅÆÂ±ÄÂú®„ÉªÊ©üËÉΩ„Çí‰∫àÊ∏¨„Åß„Åç„Çã</li>
<li>‚úÖ Random Forest„ÄÅLightGBM„Çí‰Ωø„Å£„ÅüÈÖµÁ¥†Ê¥ªÊÄß‰∫àÊ∏¨„Åå„Åß„Åç„Çã</li>
<li>‚úÖ „É¢„Éá„É´„ÅÆÊÄßËÉΩË©ï‰æ°„Å®ÊîπÂñÑ„Åå„Åß„Åç„Çã</li>
</ul>
<p><strong>Ë™≠‰∫ÜÊôÇÈñì</strong>: 25-30ÂàÜ | <strong>„Ç≥„Éº„Éâ‰æã</strong>: 9ÂÄã | <strong>ÊºîÁøíÂïèÈ°å</strong>: 3Âïè</p>
<hr />
<h2>2.1 ÈÖçÂàó„Ç¢„É©„Ç§„É°„É≥„Éà</h2>
<h3>„Ç¢„É©„Ç§„É°„É≥„Éà„Å®„ÅØ</h3>
<p><strong>ÈÖçÂàó„Ç¢„É©„Ç§„É°„É≥„Éà</strong>„ÅØ„ÄÅ2„Å§‰ª•‰∏ä„ÅÆÈÖçÂàó„Çí‰∏¶„Åπ„Å¶È°û‰ººÊÄß„ÇíË©ï‰æ°„Åô„ÇãÊâãÊ≥ï„Åß„Åô„ÄÇ</p>
<div class="mermaid">
flowchart LR
    A[„ÇØ„Ç®„É™ÈÖçÂàó] --> B[„Ç¢„É©„Ç§„É°„É≥„Éà\n„Ç¢„É´„Ç¥„É™„Ç∫„É†]
    C[„Éá„Éº„Çø„Éô„Éº„Çπ] --> B
    B --> D[Áõ∏ÂêåÈÖçÂàó]
    D --> E[Ê©üËÉΩÊé®ÂÆö]
    D --> F[ÈÄ≤ÂåñËß£Êûê]

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#f3e5f5
    style D fill:#e8f5e9
    style E fill:#ffebee
    style F fill:#fff9c4
</div>

<p><strong>Áî®ÈÄî</strong>:
- Ê©üËÉΩÊú™Áü•„Çø„É≥„Éë„ÇØË≥™„ÅÆÊ©üËÉΩÊé®ÂÆö
- ÈÄ≤ÂåñÁöÑÈñ¢‰øÇ„ÅÆËß£Êûê
- ÈáçË¶Å„Å™ÊÆãÂü∫„ÅÆÂêåÂÆö</p>
<hr />
<h3>BLASTÊ§úÁ¥¢</h3>
<p><strong>BLASTÔºàBasic Local Alignment Search ToolÔºâ</strong>„ÅØ„ÄÅÊúÄ„ÇÇÂ∫É„Åè‰Ωø„Çè„Çå„ÇãÈÖçÂàóÈ°û‰ººÊÄßÊ§úÁ¥¢„ÉÑ„Éº„É´„Åß„Åô„ÄÇ</p>
<p><strong>Example 1: Biopython„Çí‰Ωø„Å£„ÅüBLASTÊ§úÁ¥¢</strong></p>
<pre><code class="language-python">from Bio.Blast import NCBIWWW, NCBIXML
from Bio import SeqIO

# „ÇØ„Ç®„É™ÈÖçÂàóÔºà‰æã: „Ç§„É≥„Çπ„É™„É≥Ôºâ
query_sequence = &quot;&quot;&quot;
MALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFYTPKTRREAEDLQVGQVELGGGPGAGSLQPLALEGSLQKRGIVEQCCTSICSLYQLENYCN
&quot;&quot;&quot;

print(&quot;BLASTÊ§úÁ¥¢„ÇíÂÆüË°å‰∏≠...&quot;)

# NCBI„ÅÆBLAST„Çµ„Éº„Éê„Éº„ÅßÊ§úÁ¥¢
result_handle = NCBIWWW.qblast(
    &quot;blastp&quot;,  # „Çø„É≥„Éë„ÇØË≥™BLAST
    &quot;nr&quot;,  # non-redundant„Éá„Éº„Çø„Éô„Éº„Çπ
    query_sequence,
    hitlist_size=10  # ‰∏ä‰Ωç10‰ª∂
)

# ÁµêÊûú„Çí„Éï„Ç°„Ç§„É´„Å´‰øùÂ≠ò
with open(&quot;blast_results.xml&quot;, &quot;w&quot;) as out_handle:
    out_handle.write(result_handle.read())

result_handle.close()

print(&quot;Ê§úÁ¥¢ÂÆå‰∫Ü„ÄÇÁµêÊûú„ÇíËß£Êûê‰∏≠...&quot;)

# ÁµêÊûú„ÇíËß£Êûê
with open(&quot;blast_results.xml&quot;) as result_handle:
    blast_records = NCBIXML.parse(result_handle)

    for blast_record in blast_records:
        print(f&quot;\n=== BLASTÊ§úÁ¥¢ÁµêÊûú ===&quot;)
        print(f&quot;„ÇØ„Ç®„É™Èï∑: {blast_record.query_length} aa&quot;)
        print(f&quot;„Éí„ÉÉ„ÉàÊï∞: {len(blast_record.alignments)}&quot;)

        # ‰∏ä‰Ωç5‰ª∂„ÇíË°®Á§∫
        for alignment in blast_record.alignments[:5]:
            for hsp in alignment.hsps:
                print(f&quot;\n--- „Éí„ÉÉ„Éà ---&quot;)
                print(f&quot;ÈÖçÂàó: {alignment.title[:60]}...&quot;)
                print(f&quot;E-value: {hsp.expect:.2e}&quot;)
                print(f&quot;„Çπ„Ç≥„Ç¢: {hsp.score}&quot;)
                print(f&quot;Âêå‰∏ÄÊÄß: {hsp.identities}/{hsp.align_length} &quot;
                      f&quot;({100*hsp.identities/hsp.align_length:.1f}%)&quot;)
                print(f&quot;„Ç¢„É©„Ç§„É°„É≥„Éà:&quot;)
                print(f&quot;Query: {hsp.query[:60]}&quot;)
                print(f&quot;       {hsp.match[:60]}&quot;)
                print(f&quot;Sbjct: {hsp.sbjct[:60]}&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã</strong>:</p>
<pre><code>=== BLASTÊ§úÁ¥¢ÁµêÊûú ===
„ÇØ„Ç®„É™Èï∑: 110 aa
„Éí„ÉÉ„ÉàÊï∞: 50

--- „Éí„ÉÉ„Éà ---
ÈÖçÂàó: insulin [Homo sapiens]
E-value: 2.5e-75
„Çπ„Ç≥„Ç¢: 229
Âêå‰∏ÄÊÄß: 110/110 (100.0%)
Align ment:
Query: MALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFYTPKTRREAED
       ||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||
Sbjct: MALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFYTPKTRREAED
</code></pre>
<hr />
<h3>„É≠„Éº„Ç´„É´ vs „Ç∞„É≠„Éº„Éê„É´„Ç¢„É©„Ç§„É°„É≥„Éà</h3>
<p><strong>„Ç∞„É≠„Éº„Éê„É´„Ç¢„É©„Ç§„É°„É≥„ÉàÔºàNeedleman-WunschÔºâ</strong>:
- ÈÖçÂàóÂÖ®‰Ωì„ÇíÊØîËºÉ
- È°û‰ºº„Åó„ÅüÈï∑„Åï„ÅÆÈÖçÂàó„Å´ÈÅ©Áî®</p>
<p><strong>„É≠„Éº„Ç´„É´„Ç¢„É©„Ç§„É°„É≥„ÉàÔºàSmith-WatermanÔºâ</strong>:
- ÊúÄ„ÇÇÈ°û‰ºº„Åó„ÅüÈÉ®ÂàÜÈ†òÂüü„ÇíÊ§úÂá∫
- Èï∑„Åï„ÅåÁï∞„Å™„ÇãÈÖçÂàó„Å´ÈÅ©Áî®ÔºàBLAST„Åß‰ΩøÁî®Ôºâ</p>
<p><strong>Example 2: Biopython„Åß„ÅÆ„Ç¢„É©„Ç§„É°„É≥„Éà</strong></p>
<pre><code class="language-python">from Bio import pairwise2
from Bio.pairwise2 import format_alignment

# 2„Å§„ÅÆÈÖçÂàó
seq1 = &quot;ACDEFGHIKLMNPQRSTVWY&quot;
seq2 = &quot;ACDEFGHIKLQNPQRSTVWY&quot;  # 1ÊñáÂ≠óÁï∞„Å™„Çã

# „Ç∞„É≠„Éº„Éê„É´„Ç¢„É©„Ç§„É°„É≥„Éà
alignments = pairwise2.align.globalxx(seq1, seq2)

print(&quot;=== „Ç∞„É≠„Éº„Éê„É´„Ç¢„É©„Ç§„É°„É≥„Éà ===&quot;)
print(format_alignment(*alignments[0]))

# „É≠„Éº„Ç´„É´„Ç¢„É©„Ç§„É°„É≥„Éà
local_alignments = pairwise2.align.localxx(seq1, seq2)

print(&quot;\n=== „É≠„Éº„Ç´„É´„Ç¢„É©„Ç§„É°„É≥„Éà ===&quot;)
print(format_alignment(*local_alignments[0]))

# „Çπ„Ç≥„Ç¢„É™„É≥„Ç∞: match +2, mismatch -1, gap -0.5
gap_penalty = -0.5
alignments_scored = pairwise2.align.globalms(
    seq1, seq2,
    match=2,
    mismatch=-1,
    open=-0.5,
    extend=-0.1
)

print(&quot;\n=== „Çπ„Ç≥„Ç¢„É™„É≥„Ç∞‰ªò„Åç„Ç¢„É©„Ç§„É°„É≥„Éà ===&quot;)
print(format_alignment(*alignments_scored[0]))
print(f&quot;„Çπ„Ç≥„Ç¢: {alignments_scored[0][2]:.1f}&quot;)
</code></pre>
<hr />
<h2>2.2 ÈÖçÂàó„Åã„Çâ„ÅÆÁâπÂæ¥ÈáèÊäΩÂá∫</h2>
<h3>„Ç¢„Éü„ÉéÈÖ∏„ÅÆÁâ©ÁêÜÂåñÂ≠¶ÁöÑÊÄßË≥™</h3>
<p><strong>20Á®ÆÈ°û„ÅÆ„Ç¢„Éü„ÉéÈÖ∏</strong>„ÅØ„ÄÅÁï∞„Å™„ÇãÁâ©ÁêÜÂåñÂ≠¶ÁöÑÊÄßË≥™„ÇíÊåÅ„Å°„Åæ„ÅôÔºö</p>
<table>
<thead>
<tr>
<th>ÊÄßË≥™</th>
<th>„Ç¢„Éü„ÉéÈÖ∏</th>
</tr>
</thead>
<tbody>
<tr>
<td>ÁñéÊ∞¥ÊÄß</td>
<td>A, V, I, L, M, F, W, P</td>
</tr>
<tr>
<td>Ë¶™Ê∞¥ÊÄßÔºàÊ•µÊÄßÔºâ</td>
<td>S, T, N, Q, Y, C</td>
</tr>
<tr>
<td>Â°©Âü∫ÊÄßÔºàÊ≠£ÈõªËç∑Ôºâ</td>
<td>K, R, H</td>
</tr>
<tr>
<td>ÈÖ∏ÊÄßÔºàË≤†ÈõªËç∑Ôºâ</td>
<td>D, E</td>
</tr>
<tr>
<td>Ëä≥È¶ôÊóè</td>
<td>F, Y, W</td>
</tr>
</tbody>
</table>
<p><strong>Example 3: „Ç¢„Éü„ÉéÈÖ∏ÁµÑÊàê„ÅÆË®àÁÆó</strong></p>
<pre><code class="language-python">from collections import Counter
import numpy as np

def calculate_aa_composition(sequence):
    &quot;&quot;&quot;
    „Ç¢„Éü„ÉéÈÖ∏ÁµÑÊàê„ÇíË®àÁÆó

    Returns:
    --------
    dict: ÂêÑ„Ç¢„Éü„ÉéÈÖ∏„ÅÆÂá∫ÁèæÈ†ªÂ∫¶Ôºà%Ôºâ
    &quot;&quot;&quot;
    # Â§ßÊñáÂ≠ó„Å´Áµ±‰∏Ä
    sequence = sequence.upper()

    # 20Á®ÆÈ°û„ÅÆÊ®ôÊ∫ñ„Ç¢„Éü„ÉéÈÖ∏
    standard_aa = &quot;ACDEFGHIKLMNPQRSTVWY&quot;

    # „Ç´„Ç¶„É≥„Éà
    aa_count = Counter(sequence)

    # È†ªÂ∫¶Ôºà%Ôºâ„Å´Â§âÊèõ
    total = len(sequence)
    composition = {aa: 100 * aa_count.get(aa, 0) / total
                   for aa in standard_aa}

    return composition

# „ÉÜ„Çπ„ÉàÈÖçÂàó
sequence = &quot;&quot;&quot;
MALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFY
TPKTRREAEDLQVGQVELGGGPGAGSLQPLALEGSLQKRGIVEQCCTSIC
SLYQLENYCN
&quot;&quot;&quot;
sequence = sequence.replace(&quot;\n&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;)

comp = calculate_aa_composition(sequence)

print(&quot;=== „Ç¢„Éü„ÉéÈÖ∏ÁµÑÊàê ===&quot;)
for aa in sorted(comp.keys(), key=lambda x: comp[x], reverse=True):
    if comp[aa] &gt; 0:
        print(f&quot;{aa}: {comp[aa]:.1f}%&quot;)

# Áâ©ÁêÜÂåñÂ≠¶ÁöÑÊÄßË≥™„ÅÆÈõÜË®à
hydrophobic = [&quot;A&quot;, &quot;V&quot;, &quot;I&quot;, &quot;L&quot;, &quot;M&quot;, &quot;F&quot;, &quot;W&quot;, &quot;P&quot;]
charged = [&quot;K&quot;, &quot;R&quot;, &quot;H&quot;, &quot;D&quot;, &quot;E&quot;]
polar = [&quot;S&quot;, &quot;T&quot;, &quot;N&quot;, &quot;Q&quot;, &quot;Y&quot;, &quot;C&quot;]

hydrophobic_pct = sum(comp[aa] for aa in hydrophobic)
charged_pct = sum(comp[aa] for aa in charged)
polar_pct = sum(comp[aa] for aa in polar)

print(f&quot;\nÁñéÊ∞¥ÊÄß„Ç¢„Éü„ÉéÈÖ∏: {hydrophobic_pct:.1f}%&quot;)
print(f&quot;Ëç∑Èõª„Ç¢„Éü„ÉéÈÖ∏: {charged_pct:.1f}%&quot;)
print(f&quot;Ê•µÊÄß„Ç¢„Éü„ÉéÈÖ∏: {polar_pct:.1f}%&quot;)
</code></pre>
<hr />
<h3>k-merË°®Áèæ</h3>
<p><strong>k-mer</strong>„ÅØ„ÄÅÈï∑„Åïk„ÅÆÈÄ£Á∂öÈÉ®ÂàÜÈÖçÂàó„Åß„ÅôÔºàËá™ÁÑ∂Ë®ÄË™ûÂá¶ÁêÜ„ÅÆn-gram„Å´Áõ∏ÂΩìÔºâ„ÄÇ</p>
<p><strong>Example 4: k-merÁâπÂæ¥Èáè„ÅÆÊäΩÂá∫</strong></p>
<pre><code class="language-python">from collections import Counter

def extract_kmers(sequence, k=3):
    &quot;&quot;&quot;
    k-merÁâπÂæ¥Èáè„ÇíÊäΩÂá∫

    Parameters:
    -----------
    sequence : str
        „Ç¢„Éü„ÉéÈÖ∏ÈÖçÂàó
    k : int
        k-mer„ÅÆÈï∑„Åï

    Returns:
    --------
    dict: k-mer„ÅÆÂá∫ÁèæÈ†ªÂ∫¶
    &quot;&quot;&quot;
    kmers = []
    for i in range(len(sequence) - k + 1):
        kmer = sequence[i:i+k]
        kmers.append(kmer)

    # È†ªÂ∫¶Ë®àÁÆó
    kmer_counts = Counter(kmers)
    total = len(kmers)

    # È†ªÂ∫¶Ôºà%Ôºâ„Å´Â§âÊèõ
    kmer_freq = {kmer: 100 * count / total
                 for kmer, count in kmer_counts.items()}

    return kmer_freq

# „ÉÜ„Çπ„Éà
sequence = &quot;ACDEFGHIKLMNPQRSTVWY&quot; * 3

# 3-mer
kmers_3 = extract_kmers(sequence, k=3)

print(&quot;=== ‰∏ä‰Ωç10ÂÄã„ÅÆ3-mer ===&quot;)
for kmer, freq in sorted(kmers_3.items(),
                         key=lambda x: x[1],
                         reverse=True)[:10]:
    print(f&quot;{kmer}: {freq:.2f}%&quot;)

# ÁâπÂæ¥„Éô„ÇØ„Éà„É´„ÅÆ‰ΩúÊàê
def create_kmer_vector(sequence, k=3):
    &quot;&quot;&quot;
    k-merÁâπÂæ¥„Éô„ÇØ„Éà„É´„Çí‰ΩúÊàêÔºàÊ©üÊ¢∞Â≠¶ÁøíÁî®Ôºâ
    &quot;&quot;&quot;
    # ÂÖ®„Å¶„ÅÆÂèØËÉΩ„Å™k-mer„ÇíÁîüÊàêÔºà„Çµ„Ç§„Ç∫: 20^kÔºâ
    # ÂÆüÈöõ„Å´„ÅØÈ†ªÂá∫k-mer„ÅÆ„Åø‰ΩøÁî®
    kmers = extract_kmers(sequence, k)

    # „Éô„ÇØ„Éà„É´ÂåñÔºàÈ†ªÂ∫¶„Éô„Éº„ÇπÔºâ
    vector = list(kmers.values())
    return vector

# Ê©üÊ¢∞Â≠¶ÁøíÁî®„Éô„ÇØ„Éà„É´
feature_vector = create_kmer_vector(sequence, k=2)
print(f&quot;\nÁâπÂæ¥„Éô„ÇØ„Éà„É´Ê¨°ÂÖÉ: {len(feature_vector)}&quot;)
</code></pre>
<hr />
<h3>Áâ©ÁêÜÂåñÂ≠¶ÁöÑË®òËø∞Â≠ê</h3>
<p><strong>Example 5: ÁñéÊ∞¥ÊÄß„Éó„É≠„Éï„Ç°„Ç§„É´„ÅÆË®àÁÆó</strong></p>
<pre><code class="language-python">import matplotlib.pyplot as plt
import numpy as np

# Kyte-DoolittleÁñéÊ∞¥ÊÄß„Çπ„Ç±„Éº„É´
hydrophobicity_scale = {
    'A': 1.8, 'C': 2.5, 'D': -3.5, 'E': -3.5,
    'F': 2.8, 'G': -0.4, 'H': -3.2, 'I': 4.5,
    'K': -3.9, 'L': 3.8, 'M': 1.9, 'N': -3.5,
    'P': -1.6, 'Q': -3.5, 'R': -4.5, 'S': -0.8,
    'T': -0.7, 'V': 4.2, 'W': -0.9, 'Y': -1.3
}

def calculate_hydrophobicity_profile(sequence, window=9):
    &quot;&quot;&quot;
    ÁñéÊ∞¥ÊÄß„Éó„É≠„Éï„Ç°„Ç§„É´„ÇíË®àÁÆó

    Parameters:
    -----------
    sequence : str
        „Ç¢„Éü„ÉéÈÖ∏ÈÖçÂàó
    window : int
        ÁßªÂãïÂπ≥Âùá„ÅÆ„Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫

    Returns:
    --------
    list: ÂêÑ‰ΩçÁΩÆ„ÅÆÁñéÊ∞¥ÊÄß„Çπ„Ç≥„Ç¢
    &quot;&quot;&quot;
    profile = []

    for i in range(len(sequence) - window + 1):
        segment = sequence[i:i+window]
        # „Ç¶„Ç£„É≥„Éâ„Ç¶ÂÜÖ„ÅÆÂπ≥ÂùáÁñéÊ∞¥ÊÄß
        hydrophobicity = np.mean([
            hydrophobicity_scale.get(aa, 0)
            for aa in segment
        ])
        profile.append(hydrophobicity)

    return profile

# „ÉÜ„Çπ„ÉàÈÖçÂàó
sequence = &quot;&quot;&quot;
MALWMRLLPLLALLALWGPDPAAAFVNQHLCGSHLVEALYLVCGERGFFY
&quot;&quot;&quot;
sequence = sequence.replace(&quot;\n&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;)

# ÁñéÊ∞¥ÊÄß„Éó„É≠„Éï„Ç°„Ç§„É´
profile = calculate_hydrophobicity_profile(sequence, window=9)

# ÂèØË¶ñÂåñ
plt.figure(figsize=(12, 5))
plt.plot(range(len(profile)), profile, linewidth=2)
plt.axhline(y=0, color='black', linestyle='--', alpha=0.5)
plt.xlabel('‰ΩçÁΩÆ', fontsize=12)
plt.ylabel('ÁñéÊ∞¥ÊÄß„Çπ„Ç≥„Ç¢', fontsize=12)
plt.title('Kyte-DoolittleÁñéÊ∞¥ÊÄß„Éó„É≠„Éï„Ç°„Ç§„É´', fontsize=14)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('hydrophobicity_profile.png', dpi=300)
plt.show()

# ËÜúË≤´ÈÄöÈ†òÂüü„ÅÆ‰∫àÊ∏¨ÔºàÁñéÊ∞¥ÊÄß„ÅåÈ´ò„ÅÑÈ†òÂüüÔºâ
threshold = 1.6  # ËÜúË≤´ÈÄöÈ†òÂüü„ÅÆÈñæÂÄ§
tm_regions = []

for i, score in enumerate(profile):
    if score &gt; threshold:
        tm_regions.append(i)

if tm_regions:
    print(f&quot;ËÜúË≤´ÈÄöÈ†òÂüüÂÄôË£ú: {min(tm_regions)}-{max(tm_regions)}&quot;)
else:
    print(&quot;ËÜúË≤´ÈÄöÈ†òÂüü„ÅØÊ§úÂá∫„Åï„Çå„Åæ„Åõ„Çì„Åß„Åó„Åü&quot;)
</code></pre>
<hr />
<h2>2.3 Ê©üÊ¢∞Â≠¶Áøí„Å´„Çà„ÇãÊ©üËÉΩ‰∫àÊ∏¨</h2>
<h3>„Çø„É≥„Éë„ÇØË≥™„ÅÆÂ±ÄÂú®‰∫àÊ∏¨</h3>
<p><strong>Example 6: Á¥∞ËÉûÂÜÖÂ±ÄÂú®„ÅÆ‰∫àÊ∏¨</strong></p>
<pre><code class="language-python">import numpy as np
import pandas as pd
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import classification_report, confusion_matrix

# „Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÅÆÁîüÊàêÔºàÂÆüÈöõ„ÅØ„Éá„Éº„Çø„Éô„Éº„Çπ„Åã„ÇâÂèñÂæóÔºâ
def generate_sample_data(n_samples=500):
    &quot;&quot;&quot;
    „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÁîüÊàêÔºà„Éá„É¢Áî®Ôºâ
    &quot;&quot;&quot;
    np.random.seed(42)

    data = []

    # Ê†∏ÔºàNuclearÔºâ: Â°©Âü∫ÊÄß„ÅåÈ´ò„ÅÑ
    for _ in range(n_samples // 5):
        features = {
            'hydrophobic_pct': np.random.normal(30, 5),
            'charged_pct': np.random.normal(35, 5),  # È´ò„ÅÑ
            'polar_pct': np.random.normal(25, 5),
            'aromatic_pct': np.random.normal(10, 3),
            'length': np.random.normal(300, 50),
            'localization': 'Nuclear'
        }
        data.append(features)

    # Á¥∞ËÉûË≥™ÔºàCytoplasmicÔºâ
    for _ in range(n_samples // 5):
        features = {
            'hydrophobic_pct': np.random.normal(35, 5),
            'charged_pct': np.random.normal(25, 5),
            'polar_pct': np.random.normal(30, 5),
            'aromatic_pct': np.random.normal(10, 3),
            'length': np.random.normal(350, 60),
            'localization': 'Cytoplasmic'
        }
        data.append(features)

    # ËÜúÔºàMembraneÔºâ: ÁñéÊ∞¥ÊÄß„ÅåÈ´ò„ÅÑ
    for _ in range(n_samples // 5):
        features = {
            'hydrophobic_pct': np.random.normal(50, 5),  # È´ò„ÅÑ
            'charged_pct': np.random.normal(15, 5),
            'polar_pct': np.random.normal(25, 5),
            'aromatic_pct': np.random.normal(10, 3),
            'length': np.random.normal(280, 40),
            'localization': 'Membrane'
        }
        data.append(features)

    # „Éü„Éà„Ç≥„É≥„Éâ„É™„Ç¢
    for _ in range(n_samples // 5):
        features = {
            'hydrophobic_pct': np.random.normal(38, 5),
            'charged_pct': np.random.normal(28, 5),
            'polar_pct': np.random.normal(24, 5),
            'aromatic_pct': np.random.normal(10, 3),
            'length': np.random.normal(320, 55),
            'localization': 'Mitochondrial'
        }
        data.append(features)

    # ÂàÜÊ≥åÔºàSecretedÔºâ
    for _ in range(n_samples // 5):
        features = {
            'hydrophobic_pct': np.random.normal(32, 5),
            'charged_pct': np.random.normal(22, 5),
            'polar_pct': np.random.normal(36, 5),  # È´ò„ÅÑ
            'aromatic_pct': np.random.normal(10, 3),
            'length': np.random.normal(250, 45),
            'localization': 'Secreted'
        }
        data.append(features)

    return pd.DataFrame(data)

# „Éá„Éº„ÇøÁîüÊàê
df = generate_sample_data(n_samples=500)

print(&quot;=== „Éá„Éº„Çø„Çª„ÉÉ„ÉàÊ¶ÇË¶Å ===&quot;)
print(df.head())
print(f&quot;\nÂ±ÄÂú®„ÅÆÂàÜÂ∏É:&quot;)
print(df['localization'].value_counts())

# ÁâπÂæ¥Èáè„Å®„É©„Éô„É´„ÇíÂàÜÈõ¢
X = df.drop('localization', axis=1)
y = df['localization']

# Ë®ìÁ∑¥„Éá„Éº„Çø„Å®„ÉÜ„Çπ„Éà„Éá„Éº„Çø„Å´ÂàÜÂâ≤
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

# Random Forest„É¢„Éá„É´
model = RandomForestClassifier(
    n_estimators=100,
    max_depth=10,
    random_state=42
)

model.fit(X_train, y_train)

# ‰∫àÊ∏¨
y_pred = model.predict(X_test)

# Ë©ï‰æ°
print(&quot;\n=== Ë©ï‰æ°ÁµêÊûú ===&quot;)
print(classification_report(y_test, y_pred))

# ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶
feature_importance = pd.DataFrame({
    'feature': X.columns,
    'importance': model.feature_importances_
}).sort_values('importance', ascending=False)

print(&quot;\n=== ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶ ===&quot;)
print(feature_importance)

# Êñ∞„Åó„ÅÑ„Çø„É≥„Éë„ÇØË≥™„ÅÆ‰∫àÊ∏¨
new_protein = {
    'hydrophobic_pct': 48.0,
    'charged_pct': 18.0,
    'polar_pct': 24.0,
    'aromatic_pct': 10.0,
    'length': 290.0
}

prediction = model.predict([list(new_protein.values())])
print(f&quot;\nÊñ∞„Åó„ÅÑ„Çø„É≥„Éë„ÇØË≥™„ÅÆ‰∫àÊ∏¨Â±ÄÂú®: {prediction[0]}&quot;)
</code></pre>
<hr />
<h2>2.4 „Ç±„Éº„Çπ„Çπ„Çø„Éá„Ç£ÔºöÈÖµÁ¥†Ê¥ªÊÄß‰∫àÊ∏¨</h2>
<h3>„Éá„Éº„ÇøÂèéÈõÜ„Å®ÂâçÂá¶ÁêÜ</h3>
<p><strong>Example 7: ÈÖµÁ¥†„Éá„Éº„Çø„Çª„ÉÉ„Éà„ÅÆÊ∫ñÂÇô</strong></p>
<pre><code class="language-python">import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler

def extract_features_from_sequence(sequence):
    &quot;&quot;&quot;
    ÈÖçÂàó„Åã„ÇâÁâπÂæ¥Èáè„ÇíÊäΩÂá∫
    &quot;&quot;&quot;
    # „Ç¢„Éü„ÉéÈÖ∏ÁµÑÊàê
    aa_count = {aa: sequence.count(aa) for aa in &quot;ACDEFGHIKLMNPQRSTVWY&quot;}
    aa_comp = {f&quot;aa_{aa}&quot;: count / len(sequence)
               for aa, count in aa_count.items()}

    # Áâ©ÁêÜÂåñÂ≠¶ÁöÑÊÄßË≥™
    hydrophobic = sum(sequence.count(aa) for aa in &quot;AVILMFWP&quot;)
    charged = sum(sequence.count(aa) for aa in &quot;KRHDE&quot;)
    polar = sum(sequence.count(aa) for aa in &quot;STNQYC&quot;)

    features = {
        **aa_comp,
        'length': len(sequence),
        'hydrophobic_pct': 100 * hydrophobic / len(sequence),
        'charged_pct': 100 * charged / len(sequence),
        'polar_pct': 100 * polar / len(sequence),
        'molecular_weight': sum(
            aa_count.get(aa, 0) * mw
            for aa, mw in {
                'A': 89, 'C': 121, 'D': 133, 'E': 147,
                'F': 165, 'G': 75, 'H': 155, 'I': 131,
                'K': 146, 'L': 131, 'M': 149, 'N': 132,
                'P': 115, 'Q': 146, 'R': 174, 'S': 105,
                'T': 119, 'V': 117, 'W': 204, 'Y': 181
            }.items()
        )
    }

    return features

# „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÔºàÂÆüÈöõ„ÅØUniProt„Å™„Å©„Åã„ÇâÂèñÂæóÔºâ
enzyme_data = [
    {
        'sequence': &quot;ACDEFGHIKLMNPQRSTVWY&quot; * 10,
        'activity': 8.5  # log(kcat/Km)
    },
    # ÂÆüÈöõ„Å´„ÅØÊï∞Áôæ„ÄúÊï∞ÂçÉ„ÅÆ„Éá„Éº„Çø
]

print(&quot;ÁâπÂæ¥ÈáèÊäΩÂá∫„ÅÆ„Éá„É¢:&quot;)
features = extract_features_from_sequence(enzyme_data[0]['sequence'])
print(f&quot;ÁâπÂæ¥ÈáèÊï∞: {len(features)}&quot;)
print(f&quot;„Çµ„É≥„Éó„É´ÁâπÂæ¥Èáè:&quot;)
for key, value in list(features.items())[:5]:
    print(f&quot;  {key}: {value:.3f}&quot;)
</code></pre>
<hr />
<h3>„É¢„Éá„É´Ë®ìÁ∑¥„Å®Ë©ï‰æ°</h3>
<p><strong>Example 8: LightGBM„Å´„Çà„ÇãÈÖµÁ¥†Ê¥ªÊÄß‰∫àÊ∏¨</strong></p>
<pre><code class="language-python">import numpy as np
import pandas as pd
import lightgbm as lgb
from sklearn.model_selection import cross_val_score
from sklearn.metrics import mean_absolute_error, r2_score
import matplotlib.pyplot as plt

# „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÁîüÊàêÔºàÂÆüÈöõ„ÅØ„Éá„Éº„Çø„Éô„Éº„Çπ„Åã„ÇâÔºâ
np.random.seed(42)

n_samples = 200
X = np.random.randn(n_samples, 25)  # 25ÁâπÂæ¥Èáè
# Ê¥ªÊÄß„ÅØÁâπÂÆö„ÅÆÁâπÂæ¥„Å´‰æùÂ≠ò
y = (2.0 * X[:, 0] + 1.5 * X[:, 1] - 1.0 * X[:, 2] +
     np.random.randn(n_samples) * 0.5)

# Ë®ìÁ∑¥/„ÉÜ„Çπ„ÉàÂàÜÂâ≤
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# LightGBM„É¢„Éá„É´
model = lgb.LGBMRegressor(
    n_estimators=100,
    learning_rate=0.1,
    max_depth=5,
    random_state=42
)

model.fit(X_train, y_train)

# ‰∫àÊ∏¨
y_pred = model.predict(X_test)

# Ë©ï‰æ°
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f&quot;=== „É¢„Éá„É´ÊÄßËÉΩ ===&quot;)
print(f&quot;MAE: {mae:.3f}&quot;)
print(f&quot;R¬≤: {r2:.3f}&quot;)

# ÂèØË¶ñÂåñ
plt.figure(figsize=(8, 6))
plt.scatter(y_test, y_pred, alpha=0.6)
plt.plot([y_test.min(), y_test.max()],
         [y_test.min(), y_test.max()],
         'r--', lw=2)
plt.xlabel('ÂÆüÊ∏¨ÂÄ§ (log(kcat/Km))', fontsize=12)
plt.ylabel('‰∫àÊ∏¨ÂÄ§', fontsize=12)
plt.title(f'ÈÖµÁ¥†Ê¥ªÊÄß‰∫àÊ∏¨ (R¬≤={r2:.3f})', fontsize=14)
plt.grid(alpha=0.3)
plt.tight_layout()
plt.savefig('enzyme_activity_prediction.png', dpi=300)
plt.show()

# „ÇØ„É≠„Çπ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥
cv_scores = cross_val_score(
    model, X_train, y_train,
    cv=5,
    scoring='r2'
)

print(f&quot;\nCV R¬≤: {cv_scores.mean():.3f} ¬± &quot;
      f&quot;{cv_scores.std():.3f}&quot;)
</code></pre>
<hr />
<h3>„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„ÉÅ„É•„Éº„Éã„É≥„Ç∞</h3>
<p><strong>Example 9: Optuna„Å´„Çà„ÇãÊúÄÈÅ©Âåñ</strong></p>
<pre><code class="language-python">import optuna
import lightgbm as lgb
from sklearn.model_selection import cross_val_score

def objective(trial):
    &quot;&quot;&quot;
    Optuna„ÅÆÁõÆÁöÑÈñ¢Êï∞
    &quot;&quot;&quot;
    # „Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„ÅÆÊé¢Á¥¢Á©∫Èñì
    params = {
        'n_estimators': trial.suggest_int('n_estimators', 50, 200),
        'learning_rate': trial.suggest_float(
            'learning_rate', 0.01, 0.3
        ),
        'max_depth': trial.suggest_int('max_depth', 3, 10),
        'num_leaves': trial.suggest_int('num_leaves', 20, 100),
        'min_child_samples': trial.suggest_int(
            'min_child_samples', 5, 50
        ),
        'random_state': 42
    }

    # „É¢„Éá„É´
    model = lgb.LGBMRegressor(**params)

    # „ÇØ„É≠„Çπ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥
    scores = cross_val_score(
        model, X_train, y_train,
        cv=3,
        scoring='r2'
    )

    return scores.mean()

# ÊúÄÈÅ©Âåñ
study = optuna.create_study(direction='maximize')
study.optimize(objective, n_trials=50)

print(f&quot;\n=== ÊúÄÈÅ©ÂåñÁµêÊûú ===&quot;)
print(f&quot;ÊúÄËâØR¬≤: {study.best_value:.3f}&quot;)
print(f&quot;ÊúÄËâØ„Éë„É©„É°„Éº„Çø:&quot;)
for key, value in study.best_params.items():
    print(f&quot;  {key}: {value}&quot;)

# ÊúÄËâØ„É¢„Éá„É´„ÅßÂÜçË®ìÁ∑¥
best_model = lgb.LGBMRegressor(**study.best_params)
best_model.fit(X_train, y_train)

y_pred_best = best_model.predict(X_test)
r2_best = r2_score(y_test, y_pred_best)

print(f&quot;\n„ÉÜ„Çπ„ÉàR¬≤ÔºàÊúÄÈÅ©ÂåñÂæåÔºâ: {r2_best:.3f}&quot;)
</code></pre>
<hr />
<h2>2.5 Êú¨Á´†„ÅÆ„Åæ„Å®„ÇÅ</h2>
<h3>Â≠¶„Çì„Å†„Åì„Å®</h3>
<ol>
<li>
<p><strong>ÈÖçÂàó„Ç¢„É©„Ç§„É°„É≥„Éà</strong>
   - BLASTÊ§úÁ¥¢„Å´„Çà„ÇãÁõ∏ÂêåÈÖçÂàóÊé¢Á¥¢
   - „É≠„Éº„Ç´„É´ vs „Ç∞„É≠„Éº„Éê„É´„Ç¢„É©„Ç§„É°„É≥„Éà</p>
</li>
<li>
<p><strong>ÁâπÂæ¥ÈáèÊäΩÂá∫</strong>
   - „Ç¢„Éü„ÉéÈÖ∏ÁµÑÊàê
   - k-merË°®Áèæ
   - Áâ©ÁêÜÂåñÂ≠¶ÁöÑË®òËø∞Â≠êÔºàÁñéÊ∞¥ÊÄß„Å™„Å©Ôºâ</p>
</li>
<li>
<p><strong>Ê©üÊ¢∞Â≠¶Áøí</strong>
   - Random Forest„Å´„Çà„ÇãÂ±ÄÂú®‰∫àÊ∏¨
   - LightGBM„Å´„Çà„ÇãÈÖµÁ¥†Ê¥ªÊÄß‰∫àÊ∏¨
   - „Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„ÉÅ„É•„Éº„Éã„É≥„Ç∞</p>
</li>
</ol>
<h3>Ê¨°„ÅÆÁ´†„Å∏</h3>
<p>Á¨¨3Á´†„Åß„ÅØ„ÄÅ<strong>ÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„Å®Áõ∏‰∫í‰ΩúÁî®Ëß£Êûê</strong>„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>
<p><strong><a href="./chapter-3.html">Á¨¨3Á´†ÔºöÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„Å®Áõ∏‰∫í‰ΩúÁî®Ëß£Êûê ‚Üí</a></strong></p>
<hr />
<h2>„Éá„Éº„Çø„É©„Ç§„Çª„É≥„Çπ„Å®ÂºïÁî®</h2>
<h3>ÈÖçÂàó„Éá„Éº„Çø„Éô„Éº„Çπ</h3>
<h4>1. NCBI (National Center for Biotechnology Information)</h4>
<ul>
<li><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: Public Domain</li>
<li><strong>ÂºïÁî®</strong>: NCBI Resource Coordinators. (2018). "Database resources of the National Center for Biotechnology Information." <em>Nucleic Acids Research</em>, 46(D1), D8-D13.</li>
<li><strong>BLAST</strong>: https://blast.ncbi.nlm.nih.gov/</li>
<li><strong>Áî®ÈÄî</strong>: „Çø„É≥„Éë„ÇØË≥™ÈÖçÂàóÊ§úÁ¥¢„ÄÅÁõ∏ÂêåÊÄßËß£Êûê</li>
</ul>
<h4>2. UniProt</h4>
<ul>
<li><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: CC BY 4.0</li>
<li><strong>ÂºïÁî®</strong>: The UniProt Consortium. (2023). "UniProt: the Universal Protein Knowledgebase in 2023." <em>Nucleic Acids Research</em>, 51(D1), D523-D531.</li>
<li><strong>„Ç¢„ÇØ„Çª„Çπ</strong>: https://www.uniprot.org/</li>
<li><strong>Áî®ÈÄî</strong>: „Ç¢„Éé„ÉÜ„Éº„Ç∑„Éß„É≥Ê∏à„ÅøÈÖçÂàó„Éá„Éº„Çø„ÄÅÈÖµÁ¥†Ê¥ªÊÄßÊÉÖÂ†±</li>
</ul>
<h4>3. Pfam (Protein families database)</h4>
<ul>
<li><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: CC0 1.0</li>
<li><strong>ÂºïÁî®</strong>: Mistry, J. et al. (2021). "Pfam: The protein families database in 2021." <em>Nucleic Acids Research</em>, 49(D1), D412-D419.</li>
<li><strong>„Ç¢„ÇØ„Çª„Çπ</strong>: https://pfam.xfam.org/</li>
<li><strong>Áî®ÈÄî</strong>: „Çø„É≥„Éë„ÇØË≥™„Éâ„É°„Ç§„É≥„ÄÅÊ©üËÉΩÂàÜÈ°û</li>
</ul>
<h3>„É©„Ç§„Éñ„É©„É™„É©„Ç§„Çª„É≥„Çπ</h3>
<table>
<thead>
<tr>
<th>„É©„Ç§„Éñ„É©„É™</th>
<th>„Éê„Éº„Ç∏„Éß„É≥</th>
<th>„É©„Ç§„Çª„É≥„Çπ</th>
<th>Áî®ÈÄî</th>
</tr>
</thead>
<tbody>
<tr>
<td>Biopython</td>
<td>1.81+</td>
<td>BSD-3-Clause</td>
<td>BLAST„ÄÅÈÖçÂàóËß£Êûê</td>
</tr>
<tr>
<td>scikit-learn</td>
<td>1.3+</td>
<td>BSD-3-Clause</td>
<td>Ê©üÊ¢∞Â≠¶Áøí</td>
</tr>
<tr>
<td>LightGBM</td>
<td>4.0+</td>
<td>MIT</td>
<td>ÂãæÈÖç„Éñ„Éº„Çπ„ÉÜ„Ç£„É≥„Ç∞</td>
</tr>
<tr>
<td>Optuna</td>
<td>3.3+</td>
<td>MIT</td>
<td>„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„ÇøÊúÄÈÅ©Âåñ</td>
</tr>
</tbody>
</table>
<hr />
<h2>„Ç≥„Éº„ÉâÂÜçÁèæÊÄß</h2>
<h3>‰π±Êï∞„Ç∑„Éº„ÉâË®≠ÂÆö</h3>
<pre><code class="language-python"># ÂÖ®„Å¶„ÅÆ‰π±Êï∞„ÇíÂõ∫ÂÆö
import numpy as np
import random

SEED = 42
np.random.seed(SEED)
random.seed(SEED)

# scikit-learn
from sklearn.ensemble import RandomForestClassifier
model = RandomForestClassifier(random_state=SEED)

# LightGBM
import lightgbm as lgb
model = lgb.LGBMRegressor(random_state=SEED)
</code></pre>
<h3>BLASTÊ§úÁ¥¢„ÅÆÂÜçÁèæÊÄßÁ¢∫‰øù</h3>
<pre><code class="language-python">from Bio.Blast import NCBIWWW
from datetime import datetime

# „Çø„Ç§„É†„Çπ„Çø„É≥„ÉóË®òÈå≤
timestamp = datetime.now().strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)

# BLASTÂÆüË°å
result_handle = NCBIWWW.qblast(
    &quot;blastp&quot;,
    &quot;nr&quot;,
    query_sequence,
    hitlist_size=10
)

# ÁµêÊûú‰øùÂ≠òÔºàÂÜçÁèæÂèØËÉΩÔºâ
filename = f&quot;blast_results_{timestamp.replace(' ', '_')}.xml&quot;
with open(filename, &quot;w&quot;) as f:
    f.write(result_handle.read())

print(f&quot;BLAST results saved: {filename}&quot;)
</code></pre>
<hr />
<h2>„Çà„Åè„ÅÇ„ÇãËêΩ„Å®„ÅóÁ©¥„Å®ÂØæÂá¶Ê≥ï</h2>
<h3>1. BLAST E-value„ÅÆË™§Ëß£Èáà</h3>
<p><strong>ÂïèÈ°å</strong>: E-value„Åå‰Ωé„Åë„Çå„Å∞ÂÖ®„Å¶ÊúâÊÑè„Å®Ë™§Ëß£</p>
<p><strong>NG</strong>:</p>
<pre><code class="language-python">if hsp.expect &lt; 0.05:  # Áµ±Ë®àÁöÑÊúâÊÑèÊÄß„Å®Ê∑∑Âêå
    accept_hit()
</code></pre>
<p><strong>OK</strong>:</p>
<pre><code class="language-python"># E-valueÈñæÂÄ§„ÅØÁî®ÈÄî„Å´„Çà„ÇäÂ§â„Åà„Çã
if application == 'homology_search':
    threshold = 1e-10  # Âé≥„Åó„ÅÑÈñæÂÄ§
elif application == 'remote_homology':
    threshold = 1e-3   # Á∑©„ÅÑÈñæÂÄ§

if hsp.expect &lt; threshold and hsp.identities/hsp.align_length &gt; 0.3:
    # ÈÖçÂàóÂêå‰∏ÄÊÄß„ÇÇËÄÉÊÖÆ
    accept_hit()
</code></pre>
<h3>2. ÈÖçÂàó„Ç¢„É©„Ç§„É°„É≥„Éà„ÅÆ„ÇÆ„É£„ÉÉ„Éó„Éö„Éä„É´„ÉÜ„Ç£Ë®≠ÂÆö„Éü„Çπ</h3>
<p><strong>ÂïèÈ°å</strong>: „Éá„Éï„Ç©„É´„ÉàÂÄ§„ÅÆ„Åæ„Åæ‰ΩøÁî®</p>
<p><strong>NG</strong>:</p>
<pre><code class="language-python"># „Éá„Éï„Ç©„É´„ÉàÂÄ§„ÅØÂøÖ„Åö„Åó„ÇÇÊúÄÈÅ©„Åß„ÅØ„Å™„ÅÑ
alignments = pairwise2.align.globalxx(seq1, seq2)
</code></pre>
<p><strong>OK</strong>:</p>
<pre><code class="language-python"># „Çø„É≥„Éë„ÇØË≥™„ÅÆÁ®ÆÈ°û„Å´Âøú„Åò„Å¶Ë™øÊï¥
if protein_type == 'short_peptide':
    gap_open = -10
    gap_extend = -0.5
elif protein_type == 'structured':
    gap_open = -5
    gap_extend = -2

alignments = pairwise2.align.globalms(
    seq1, seq2,
    match=2,
    mismatch=-1,
    open=gap_open,
    extend=gap_extend
)
</code></pre>
<h3>3. k-merË°®Áèæ„ÅÆÊ¨°ÂÖÉÁàÜÁô∫</h3>
<p><strong>ÂïèÈ°å</strong>: kÂÄ§„ÅåÂ§ß„Åç„Åô„Åé„Å¶„É°„É¢„É™‰∏çË∂≥</p>
<p><strong>NG</strong>:</p>
<pre><code class="language-python">k = 5  # 20^5 = 3,200,000Ê¨°ÂÖÉÔºÅ
kmers = extract_kmers(sequence, k=k)
</code></pre>
<p><strong>OK</strong>:</p>
<pre><code class="language-python"># k=2 or 3„ÅåÂÆüÁî®ÁöÑ
k = 3  # 20^3 = 8,000Ê¨°ÂÖÉ
kmers = extract_kmers(sequence, k=k)

# „Åæ„Åü„ÅØÈ†ªÂá∫k-mer„ÅÆ„Åø‰ΩøÁî®
from collections import Counter
kmer_counts = Counter(kmers.keys())
top_kmers = [k for k, _ in kmer_counts.most_common(1000)]
</code></pre>
<h3>4. Ê©üÊ¢∞Â≠¶Áøí„É¢„Éá„É´„ÅÆÈÅéÂ≠¶Áøí</h3>
<p><strong>ÂïèÈ°å</strong>: Ë®ìÁ∑¥„Éá„Éº„Çø„Å´ÈÅéÂ∫¶„Å´„Éï„Ç£„ÉÉ„Éà</p>
<p><strong>NG</strong>:</p>
<pre><code class="language-python">model = RandomForestClassifier(
    n_estimators=1000,
    max_depth=None  # ÁÑ°Âà∂Èôê„ÅÆÊ∑±„Åï
)
</code></pre>
<p><strong>OK</strong>:</p>
<pre><code class="language-python"># Ê≠£ÂâáÂåñ„Éë„É©„É°„Éº„Çø„ÇíË®≠ÂÆö
model = RandomForestClassifier(
    n_estimators=100,
    max_depth=10,
    min_samples_split=5,
    min_samples_leaf=2,
    random_state=42
)

# „ÇØ„É≠„Çπ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥„ÅßÊ§úË®º
from sklearn.model_selection import cross_val_score
cv_scores = cross_val_score(model, X, y, cv=5)
print(f&quot;CV accuracy: {cv_scores.mean():.3f} ¬± {cv_scores.std():.3f}&quot;)
</code></pre>
<h3>5. ÈÖçÂàóÈï∑„ÅÆÈÅï„ÅÑ„ÇíÁÑ°Ë¶ñ</h3>
<p><strong>ÂïèÈ°å</strong>: Áï∞„Å™„ÇãÈï∑„Åï„ÅÆÈÖçÂàó„ÇíÁõ¥Êé•ÊØîËºÉ</p>
<p><strong>NG</strong>:</p>
<pre><code class="language-python"># Áµ∂ÂØæÂÄ§„ÅßÊØîËºÉÔºàÈï∑„Åï„ÅåÁï∞„Å™„ÇãÔºâ
if feature1 &gt; feature2:
    select_protein1()
</code></pre>
<p><strong>OK</strong>:</p>
<pre><code class="language-python"># Ê≠£Ë¶èÂåñ„Åó„Å¶„Åã„ÇâÊØîËºÉ
feature1_norm = feature1 / len(sequence1)
feature2_norm = feature2 / len(sequence2)

if feature1_norm &gt; feature2_norm:
    select_protein1()
</code></pre>
<h3>6. ‰∏çÂùáË°°„Éá„Éº„Çø„Çª„ÉÉ„Éà</h3>
<p><strong>ÂïèÈ°å</strong>: „ÇØ„É©„ÇπÈñì„ÅÆ„Çµ„É≥„Éó„É´Êï∞„ÅåÂ§ß„Åç„ÅèÁï∞„Å™„Çã</p>
<p><strong>NG</strong>:</p>
<pre><code class="language-python"># ‰∏çÂùáË°°„Å™„Åæ„ÅæÂ≠¶Áøí
model.fit(X_train, y_train)
</code></pre>
<p><strong>OK</strong>:</p>
<pre><code class="language-python">from sklearn.utils.class_weight import compute_class_weight

# „ÇØ„É©„ÇπÈáç„Åø„ÇíË®àÁÆó
classes = np.unique(y_train)
class_weights = compute_class_weight(
    'balanced',
    classes=classes,
    y=y_train
)

# Èáç„Åø‰ªò„ÅçÂ≠¶Áøí
model = RandomForestClassifier(
    class_weight=dict(zip(classes, class_weights)),
    random_state=42
)
model.fit(X_train, y_train)
</code></pre>
<hr />
<h2>ÂìÅË≥™„ÉÅ„Çß„ÉÉ„ÇØ„É™„Çπ„Éà</h2>
<h3>„Éá„Éº„ÇøÂèñÂæóÊÆµÈöé</h3>
<ul>
<li>[ ] ÈÖçÂàó„ÅåFASTAÂΩ¢Âºè„ÅßÊ≠£„Åó„Åè‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„Çã</li>
<li>[ ] ÈùûÊ®ôÊ∫ñ„Ç¢„Éü„ÉéÈÖ∏ÔºàX, B, Z „Å™„Å©Ôºâ„ÅÆÂá¶ÁêÜÊñπÈáù„ÇíÊ±∫ÂÆö</li>
<li>[ ] ÈÖçÂàóÈï∑„ÅÆÂàÜÂ∏É„ÇíÁ¢∫Ë™çÔºàÊ•µÁ´Ø„Å´Áü≠„ÅÑ/Èï∑„ÅÑÈÖçÂàó„ÅÆÈô§Â§ñÔºâ</li>
<li>[ ] ÈáçË§áÈÖçÂàó„ÅÆÈô§Âéª</li>
</ul>
<h3>BLASTÊ§úÁ¥¢ÊÆµÈöé</h3>
<ul>
<li>[ ] E-valueÈñæÂÄ§„ÅåÁî®ÈÄî„Å´ÈÅ©ÂàáÔºà1e-3 „Äú 1e-10Ôºâ</li>
<li>[ ] „ÇØ„Ç®„É™ÈÖçÂàóÈï∑„ÅåÂçÅÂàÜÔºàÊúÄ‰Ωé20ÊÆãÂü∫Ôºâ</li>
<li>[ ] „Éá„Éº„Çø„Éô„Éº„ÇπÈÅ∏Êäû„ÅåÈÅ©ÂàáÔºànr, swissprotÁ≠âÔºâ</li>
<li>[ ] „Éí„ÉÉ„ÉàÊï∞„ÅåÂçÅÂàÜÔºàÊúÄ‰Ωé3-5‰ª∂Ôºâ</li>
</ul>
<h3>ÁâπÂæ¥ÈáèÊäΩÂá∫ÊÆµÈöé</h3>
<ul>
<li>[ ] „Ç¢„Éü„ÉéÈÖ∏ÁµÑÊàê„ÅÆÂêàË®à„Åå100%</li>
<li>[ ] k-mer „ÅÆ k ÂÄ§„ÅåÈÅ©ÂàáÔºà2-3Ôºâ</li>
<li>[ ] ÁñéÊ∞¥ÊÄß„Çπ„Ç±„Éº„É´„ÅåÊ®ôÊ∫ñÁöÑ„Å™„ÇÇ„ÅÆÔºàKyte-DoolittleÁ≠âÔºâ</li>
<li>[ ] ÁâπÂæ¥Èáè„Å´Ê¨†ÊêçÂÄ§„Åå„Å™„ÅÑ</li>
</ul>
<h3>Ê©üÊ¢∞Â≠¶ÁøíÊÆµÈöé</h3>
<ul>
<li>[ ] Ë®ìÁ∑¥/„ÉÜ„Çπ„Éà„Éá„Éº„Çø„ÅÆÂàÜÂâ≤„ÅåÂ±§Âåñ„Çµ„É≥„Éó„É™„É≥„Ç∞</li>
<li>[ ] „ÇØ„É≠„Çπ„Éê„É™„Éá„Éº„Ç∑„Éß„É≥ÂÆüÊñΩÔºàk=5 or 10Ôºâ</li>
<li>[ ] ÁâπÂæ¥Èáè„Çπ„Ç±„Éº„É™„É≥„Ç∞ÂÆüÊñΩÔºàStandardScalerÁ≠âÔºâ</li>
<li>[ ] „É¢„Éá„É´ÊÄßËÉΩÊåáÊ®ô„ÅåË§áÊï∞ÔºàAccuracy, F1, AUCÁ≠âÔºâ</li>
</ul>
<h3>ÈÖµÁ¥†Ê¥ªÊÄß‰∫àÊ∏¨ÁâπÊúâ</h3>
<ul>
<li>[ ] Ê¥ªÊÄßÂÄ§„ÅÆÂçò‰Ωç„ÅåÊòéÁ¢∫Ôºàkcat/Km, IC50Á≠âÔºâ</li>
<li>[ ] Ê∏¨ÂÆöÊù°‰ª∂ÔºàpH, Ê∏©Â∫¶Ôºâ„ÅåÁµ±‰∏Ä</li>
<li>[ ] Â§ñ„ÇåÂÄ§„ÅÆÊ§úÂá∫„Å®Èô§Âéª</li>
<li>[ ] ÂÆüÈ®ìË™§Â∑Æ„ÅÆËÄÉÊÖÆ</li>
</ul>
<hr />
<h2>ÂèÇËÄÉÊñáÁåÆ</h2>
<ol>
<li>
<p>Altschul, S. F. et al. (1990). "Basic local alignment search tool."
   <em>Journal of Molecular Biology</em>, 215(3), 403-410.</p>
</li>
<li>
<p>Kyte, J. &amp; Doolittle, R. F. (1982). "A simple method for displaying
   the hydropathic character of a protein." <em>Journal of Molecular Biology</em>,
   157(1), 105-132.</p>
</li>
</ol>
<hr />
<h2>„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥</h2>
<p><strong><a href="./chapter-1.html">‚Üê Á¨¨1Á´†</a></strong> | <strong><a href="./chapter-3.html">Á¨¨3Á´† ‚Üí</a></strong> | <strong><a href="./index.html">ÁõÆÊ¨°</a></strong></p><div class="navigation">
    <a href="chapter-1.html" class="nav-button">‚Üê Ââç„ÅÆÁ´†</a>
    <a href="index.html" class="nav-button">„Ç∑„É™„Éº„Ç∫ÁõÆÊ¨°„Å´Êàª„Çã</a>
    <a href="chapter-3.html" class="nav-button">Ê¨°„ÅÆÁ´† ‚Üí</a>
</div>
    </main>

    <footer>
        <p><strong>‰ΩúÊàêËÄÖ</strong>: AI Terakoya Content Team</p>
        <p><strong>„Éê„Éº„Ç∏„Éß„É≥</strong>: 1.0 | <strong>‰ΩúÊàêÊó•</strong>: 2025-10-17</p>
        <p><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: Creative Commons BY 4.0</p>
        <p>¬© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
