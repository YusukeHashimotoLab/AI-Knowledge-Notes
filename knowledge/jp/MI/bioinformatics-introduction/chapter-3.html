<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á¨¨3Á´†ÔºöÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„Å®Áõ∏‰∫í‰ΩúÁî®Ëß£Êûê - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Á¨¨3Á´†ÔºöÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„Å®Áõ∏‰∫í‰ΩúÁî®Ëß£Êûê</h1>
            <p class="subtitle">„Çø„É≥„Éë„ÇØË≥™-„É™„Ç¨„É≥„ÉâÁµêÂêà„ÅÆ‰∫àÊ∏¨</p>
            <div class="meta">
                <span class="meta-item">üìñ Ë™≠‰∫ÜÊôÇÈñì: 25-30ÂàÜ</span>
                <span class="meta-item">üìä Èõ£ÊòìÂ∫¶: ‰∏≠Á¥ö</span>
                <span class="meta-item">üíª „Ç≥„Éº„Éâ‰æã: 9ÂÄã</span>
                <span class="meta-item">üìù ÊºîÁøíÂïèÈ°å: 3Âïè</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Á¨¨3Á´†ÔºöÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„Å®Áõ∏‰∫í‰ΩúÁî®Ëß£Êûê</h1>
<p><strong>„Çø„É≥„Éë„ÇØË≥™-„É™„Ç¨„É≥„ÉâÁµêÂêà„ÅÆ‰∫àÊ∏¨</strong></p>
<h2>Â≠¶ÁøíÁõÆÊ®ô</h2>
<ul>
<li>‚úÖ ÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„ÅÆÂéüÁêÜ„Å®„Çπ„Ç≥„Ç¢„É™„É≥„Ç∞Èñ¢Êï∞„ÇíÁêÜËß£„Åô„Çã</li>
<li>‚úÖ AutoDock Vina„ÅßÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„ÇíÂÆüË°å„Åß„Åç„Çã</li>
<li>‚úÖ ÁµêÂêàË¶™ÂíåÊÄß„ÇíË©ï‰æ°„Åó„ÄÅÂÆüÈ®ì„Éá„Éº„Çø„Å®ÊØîËºÉ„Åß„Åç„Çã</li>
<li>‚úÖ PyMOL„ÅßÁµêÂêàÈÉ®‰Ωç„Å®Áõ∏‰∫í‰ΩúÁî®„ÇíÂèØË¶ñÂåñ„Åß„Åç„Çã</li>
<li>‚úÖ Ê©üÊ¢∞Â≠¶Áøí„ÅßÁµêÂêà‰∫àÊ∏¨„É¢„Éá„É´„ÇíÊßãÁØâ„Åß„Åç„Çã</li>
</ul>
<p><strong>Ë™≠‰∫ÜÊôÇÈñì</strong>: 25-30ÂàÜ | <strong>„Ç≥„Éº„Éâ‰æã</strong>: 9ÂÄã | <strong>ÊºîÁøíÂïèÈ°å</strong>: 3Âïè</p>
<hr />
<h2>3.1 ÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„ÅÆÂü∫Á§é</h2>
<h3>ÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„Å®„ÅØ</h3>
<p><strong>ÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞</strong>„ÅØ„ÄÅ„É™„Ç¨„É≥„ÉâÔºàÂ∞èÂàÜÂ≠êÔºâ„Å®„Çø„É≥„Éë„ÇØË≥™ÔºàÂèóÂÆπ‰ΩìÔºâ„ÅÆÁµêÂêàÊßòÂºè„Çí‰∫àÊ∏¨„Åô„ÇãË®àÁÆóÊâãÊ≥ï„Åß„Åô„ÄÇ</p>
<div class="mermaid">
graph LR
    A[„Çø„É≥„Éë„ÇØË≥™ÊßãÈÄ†] --> C[„Éâ„ÉÉ„Ç≠„É≥„Ç∞<br>„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥]
    B[„É™„Ç¨„É≥„ÉâÊßãÈÄ†] --> C
    C --> D[ÁµêÂêà„Éù„Éº„Ç∫]
    C --> E[ÁµêÂêàË¶™ÂíåÊÄß]
    D --> F[Ëñ¨Ââ§Ë®≠Ë®à]
    E --> F

    style A fill:#e3f2fd
    style B fill:#fff3e0
    style C fill:#4CAF50,color:#fff
    style D fill:#f3e5f5
    style E fill:#ffebee
    style F fill:#fff9c4
</div>

<p><strong>Áî®ÈÄî</strong>:
- ÂâµËñ¨Ôºà„Éí„ÉÉ„ÉàÂåñÂêàÁâ©„ÅÆÁô∫Ë¶ãÔºâ
- „Éê„Ç§„Ç™„Çª„É≥„Çµ„ÉºË®≠Ë®àÔºà„É™„Ç¨„É≥„ÉâÈÅ∏ÊäûÔºâ
- DDSË®≠Ë®àÔºàÊ®ôÁöÑ„Çø„É≥„Éë„ÇØË≥™„Å®„ÅÆÁµêÂêàÔºâ</p>
<hr />
<h3>„Éâ„ÉÉ„Ç≠„É≥„Ç∞„ÅÆ2„Å§„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó</h3>
<p><strong>1. „Çµ„É≥„Éó„É™„É≥„Ç∞ÔºàSamplingÔºâ</strong>
- „É™„Ç¨„É≥„Éâ„ÅÆÂèØËÉΩ„Å™ÁµêÂêà„Éù„Éº„Ç∫„ÇíÊé¢Á¥¢
- ÊâãÊ≥ï: ÈÅ∫‰ºùÁöÑ„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÄÅ„É¢„É≥„ÉÜ„Ç´„É´„É≠„ÄÅÁ≥ªÁµ±ÁöÑÊé¢Á¥¢</p>
<p><strong>2. „Çπ„Ç≥„Ç¢„É™„É≥„Ç∞ÔºàScoringÔºâ</strong>
- ÂêÑ„Éù„Éº„Ç∫„ÅÆÁµêÂêàË¶™ÂíåÊÄß„ÇíË©ï‰æ°
- „Çπ„Ç≥„Ç¢„É™„É≥„Ç∞Èñ¢Êï∞: ÂäõÂ†¥„Éô„Éº„Çπ„ÄÅÁµåÈ®ìÁöÑ„ÄÅÁü•Ë≠ò„Éô„Éº„Çπ</p>
<hr />
<h3>AutoDock Vina„ÅÆÊ¶ÇË¶Å</h3>
<p><strong>AutoDock Vina</strong>„ÅØ„ÄÅÊúÄ„ÇÇÂ∫É„Åè‰Ωø„Çè„Çå„ÇãÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞„ÇΩ„Éï„Éà„Ç¶„Çß„Ç¢„Åß„Åô„ÄÇ</p>
<p><strong>ÁâπÂæ¥</strong>:
- È´òÈÄüÔºàÂæìÊù•„ÅÆAutoDock„ÅÆ100ÂÄçÔºâ
- È´òÁ≤æÂ∫¶ÔºàÂÆüÈ®ìÂÄ§„Å®„ÅÆRMSD &lt; 2 √ÖÔºâ
- „Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ</p>
<p><strong>„Ç§„É≥„Çπ„Éà„Éº„É´</strong>:</p>
<pre><code class="language-bash"># Conda„Åß„Ç§„É≥„Çπ„Éà„Éº„É´
conda install -c conda-forge vina

# „Åæ„Åü„ÅØÂÖ¨Âºè„Çµ„Ç§„Éà„Åã„Çâ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
# http://vina.scripps.edu/
</code></pre>
<hr />
<h3>Example 1: „Çø„É≥„Éë„ÇØË≥™„Å®„É™„Ç¨„É≥„Éâ„ÅÆÊ∫ñÂÇô</h3>
<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem, Descriptors
from Bio.PDB import PDBParser
import os

# „Çø„É≥„Éë„ÇØË≥™„ÅÆÊ∫ñÂÇôÔºàPDB„Éï„Ç°„Ç§„É´Ôºâ
def prepare_protein(pdb_file, output_pdbqt):
    &quot;&quot;&quot;
    „Çø„É≥„Éë„ÇØË≥™„Çí„Éâ„ÉÉ„Ç≠„É≥„Ç∞Áî®„Å´Ê∫ñÂÇô

    Parameters:
    -----------
    pdb_file : str
        ÂÖ•ÂäõPDB„Éï„Ç°„Ç§„É´
    output_pdbqt : str
        Âá∫ÂäõPDBQT„Éï„Ç°„Ç§„É´ÔºàAutoDockÂΩ¢ÂºèÔºâ
    &quot;&quot;&quot;
    # Open Babel„Çí‰ΩøÁî®„Åó„Å¶PDB ‚Üí PDBQTÂ§âÊèõ
    # PDBQT: ÈõªËç∑„Å®ÂéüÂ≠ê„Çø„Ç§„Éó„ÇíÂê´„ÇÄÊã°ÂºµPDBÂΩ¢Âºè
    cmd = f&quot;obabel {pdb_file} -O {output_pdbqt} -xr&quot;
    os.system(cmd)

    print(f&quot;„Çø„É≥„Éë„ÇØË≥™Ê∫ñÂÇôÂÆå‰∫Ü: {output_pdbqt}&quot;)

# „É™„Ç¨„É≥„Éâ„ÅÆÊ∫ñÂÇôÔºàSMILESÔºâ
def prepare_ligand_from_smiles(smiles, output_pdbqt):
    &quot;&quot;&quot;
    SMILES„Åã„Çâ„É™„Ç¨„É≥„Éâ„ÇíÊ∫ñÂÇô

    Parameters:
    -----------
    smiles : str
        „É™„Ç¨„É≥„Éâ„ÅÆSMILESË°®Ë®ò
    output_pdbqt : str
        Âá∫ÂäõPDBQT„Éï„Ç°„Ç§„É´
    &quot;&quot;&quot;
    # ÂàÜÂ≠ê„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÁîüÊàê
    mol = Chem.MolFromSmiles(smiles)

    # Ê∞¥Á¥†ËøΩÂä†
    mol = Chem.AddHs(mol)

    # 3DÂ∫ßÊ®ôÁîüÊàê
    AllChem.EmbedMolecule(mol, randomSeed=42)
    AllChem.MMFFOptimizeMolecule(mol)

    # PDBÂΩ¢Âºè„Åß‰øùÂ≠ò
    temp_pdb = &quot;ligand_temp.pdb&quot;
    Chem.MolToPDBFile(mol, temp_pdb)

    # PDB ‚Üí PDBQTÂ§âÊèõ
    cmd = f&quot;obabel {temp_pdb} -O {output_pdbqt} -xh&quot;
    os.system(cmd)

    # ‰∏ÄÊôÇ„Éï„Ç°„Ç§„É´ÂâäÈô§
    os.remove(temp_pdb)

    print(f&quot;„É™„Ç¨„É≥„ÉâÊ∫ñÂÇôÂÆå‰∫Ü: {output_pdbqt}&quot;)

    # ÂàÜÂ≠êÊÉÖÂ†±Ë°®Á§∫
    mw = Descriptors.MolWt(mol)
    logp = Descriptors.MolLogP(mol)
    print(f&quot;  ÂàÜÂ≠êÈáè: {mw:.1f}&quot;)
    print(f&quot;  LogP: {logp:.2f}&quot;)

# ‰ΩøÁî®‰æã
# „Ç¢„Çπ„Éî„É™„É≥ÔºàÈéÆÁóõÂâ§Ôºâ
aspirin_smiles = &quot;CC(=O)Oc1ccccc1C(=O)O&quot;
prepare_ligand_from_smiles(aspirin_smiles, &quot;aspirin.pdbqt&quot;)
</code></pre>
<hr />
<h3>Example 2: AutoDock Vina„ÅÆÂÆüË°å</h3>
<pre><code class="language-python">import subprocess
import os

def run_autodock_vina(
    receptor_pdbqt,
    ligand_pdbqt,
    center_x, center_y, center_z,
    size_x=20, size_y=20, size_z=20,
    output_pdbqt=&quot;output.pdbqt&quot;,
    exhaustiveness=8
):
    &quot;&quot;&quot;
    AutoDock Vina„ÇíÂÆüË°å

    Parameters:
    -----------
    receptor_pdbqt : str
        „Çø„É≥„Éë„ÇØË≥™PDBQT„Éï„Ç°„Ç§„É´
    ligand_pdbqt : str
        „É™„Ç¨„É≥„ÉâPDBQT„Éï„Ç°„Ç§„É´
    center_x, center_y, center_z : float
        Êé¢Á¥¢„Éú„ÉÉ„ÇØ„Çπ„ÅÆ‰∏≠ÂøÉÂ∫ßÊ®ôÔºà√ÖÔºâ
    size_x, size_y, size_z : float
        Êé¢Á¥¢„Éú„ÉÉ„ÇØ„Çπ„ÅÆ„Çµ„Ç§„Ç∫Ôºà√ÖÔºâ
    output_pdbqt : str
        Âá∫Âäõ„Éï„Ç°„Ç§„É´
    exhaustiveness : int
        Êé¢Á¥¢„ÅÆÂæπÂ∫ïÂ∫¶Ôºà„Éá„Éï„Ç©„É´„Éà8„ÄÅÁ≤æÂ∫¶ÈáçË¶ñ„Å™„Çâ16-32Ôºâ
    &quot;&quot;&quot;

    # Vina„Ç≥„Éû„É≥„Éâ
    cmd = [
        &quot;vina&quot;,
        &quot;--receptor&quot;, receptor_pdbqt,
        &quot;--ligand&quot;, ligand_pdbqt,
        &quot;--center_x&quot;, str(center_x),
        &quot;--center_y&quot;, str(center_y),
        &quot;--center_z&quot;, str(center_z),
        &quot;--size_x&quot;, str(size_x),
        &quot;--size_y&quot;, str(size_y),
        &quot;--size_z&quot;, str(size_z),
        &quot;--out&quot;, output_pdbqt,
        &quot;--exhaustiveness&quot;, str(exhaustiveness)
    ]

    print(&quot;=== AutoDock VinaÂÆüË°å‰∏≠ ===&quot;)
    print(&quot; &quot;.join(cmd))

    # ÂÆüË°å
    result = subprocess.run(
        cmd,
        capture_output=True,
        text=True
    )

    # ÁµêÊûúË°®Á§∫
    print(result.stdout)

    # ÁµêÂêàË¶™ÂíåÊÄß„ÇíÊäΩÂá∫
    affinities = []
    for line in result.stdout.split('\n'):
        if line.strip().startswith('1') or \
           line.strip().startswith('2') or \
           line.strip().startswith('3'):
            parts = line.split()
            if len(parts) &gt;= 2:
                try:
                    affinity = float(parts[1])
                    affinities.append(affinity)
                except ValueError:
                    pass

    if affinities:
        print(f&quot;\n=== ÁµêÂêàË¶™ÂíåÊÄß ===&quot;)
        print(f&quot;ÊúÄËâØ„Çπ„Ç≥„Ç¢: {affinities[0]:.1f} kcal/mol&quot;)
        print(f&quot;‰∏ä‰Ωç3„Å§: {affinities[:3]}&quot;)

    return affinities

# ‰ΩøÁî®‰æãÔºàÊû∂Á©∫„ÅÆÂ∫ßÊ®ôÔºâ
# ÂÆüÈöõ„ÅÆ‰ΩøÁî®„Åß„ÅØ„ÄÅÁµêÂêàÈÉ®‰Ωç„ÅÆÂ∫ßÊ®ô„ÇíÊåáÂÆö
&quot;&quot;&quot;
affinities = run_autodock_vina(
    receptor_pdbqt=&quot;protein.pdbqt&quot;,
    ligand_pdbqt=&quot;ligand.pdbqt&quot;,
    center_x=10.5,
    center_y=20.3,
    center_z=15.8,
    size_x=20,
    size_y=20,
    size_z=20,
    output_pdbqt=&quot;docking_result.pdbqt&quot;
)
&quot;&quot;&quot;
</code></pre>
<p><strong>Âá∫Âäõ‰æã</strong>:</p>
<pre><code>=== AutoDock VinaÂÆüË°å‰∏≠ ===
vina --receptor protein.pdbqt --ligand ligand.pdbqt ...

Performing docking...
mode |   affinity | dist from best mode
     | (kcal/mol) | rmsd l.b.| rmsd u.b.
-----+------------+----------+----------
   1      -8.5       0.000       0.000
   2      -8.2       1.823       3.145
   3      -7.9       2.456       4.021

=== ÁµêÂêàË¶™ÂíåÊÄß ===
ÊúÄËâØ„Çπ„Ç≥„Ç¢: -8.5 kcal/mol
‰∏ä‰Ωç3„Å§: [-8.5, -8.2, -7.9]
</code></pre>
<hr />
<h2>3.2 Áõ∏‰∫í‰ΩúÁî®„ÅÆÂèØË¶ñÂåñ„Å®Ëß£Êûê</h2>
<h3>PyMOL„Å´„Çà„ÇãÂèØË¶ñÂåñ</h3>
<p><strong>Example 3: PyMOL„Çπ„ÇØ„É™„Éó„Éà„ÅÆÁîüÊàê</strong></p>
<pre><code class="language-python">def generate_pymol_script(
    protein_pdb,
    ligand_pdbqt,
    output_script=&quot;visualize.pml&quot;
):
    &quot;&quot;&quot;
    PyMOLÂèØË¶ñÂåñ„Çπ„ÇØ„É™„Éó„Éà„ÇíÁîüÊàê

    Parameters:
    -----------
    protein_pdb : str
        „Çø„É≥„Éë„ÇØË≥™PDB„Éï„Ç°„Ç§„É´
    ligand_pdbqt : str
        „Éâ„ÉÉ„Ç≠„É≥„Ç∞ÁµêÊûúÔºàPDBQTÔºâ
    output_script : str
        Âá∫ÂäõPyMOL„Çπ„ÇØ„É™„Éó„Éà
    &quot;&quot;&quot;
    script = f&quot;&quot;&quot;
# PyMOLÂèØË¶ñÂåñ„Çπ„ÇØ„É™„Éó„Éà

# „Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø
load {protein_pdb}, protein
load {ligand_pdbqt}, ligand

# „Çø„É≥„Éë„ÇØË≥™„ÅÆË°®Á§∫Ë®≠ÂÆö
hide everything, protein
show cartoon, protein
color cyan, protein

# ÁµêÂêàÈÉ®‰Ωç„ÅÆË°®Á§∫Ôºà„É™„Ç¨„É≥„Éâ„Åã„Çâ5√Ö‰ª•ÂÜÖÔºâ
select binding_site, protein within 5 of ligand
show sticks, binding_site
color green, binding_site

# „É™„Ç¨„É≥„Éâ„ÅÆË°®Á§∫
hide everything, ligand
show sticks, ligand
color yellow, ligand
util.cbay ligand

# Ê∞¥Á¥†ÁµêÂêà„ÅÆË°®Á§∫
distance hbonds, ligand, binding_site, mode=2
color red, hbonds

# Ë¶ñÁÇπË®≠ÂÆö
zoom ligand, 5
set stick_radius, 0.3
set sphere_scale, 0.25

# ËÉåÊôØ„ÇíÁôΩ„Å´
bg_color white

# „É¨„É≥„ÉÄ„É™„É≥„Ç∞Ë®≠ÂÆö
set ray_shadows, 0
set antialias, 2

# ÁîªÂÉè‰øùÂ≠ò
ray 1200, 1200
png binding_site.png, dpi=300

print(&quot;ÂèØË¶ñÂåñÂÆå‰∫Ü: binding_site.png&quot;)
&quot;&quot;&quot;

    with open(output_script, 'w') as f:
        f.write(script)

    print(f&quot;PyMOL„Çπ„ÇØ„É™„Éó„ÉàÁîüÊàê: {output_script}&quot;)
    print(&quot;ÂÆüË°åÊñπÊ≥ï: pymol visualize.pml&quot;)

# ‰ΩøÁî®‰æã
generate_pymol_script(
    &quot;protein.pdb&quot;,
    &quot;docking_result.pdbqt&quot;,
    &quot;visualize.pml&quot;
)
</code></pre>
<hr />
<h3>Áõ∏‰∫í‰ΩúÁî®„ÅÆÂÆöÈáèËß£Êûê</h3>
<p><strong>Example 4: Ê∞¥Á¥†ÁµêÂêà„ÅÆÊ§úÂá∫</strong></p>
<pre><code class="language-python">from Bio.PDB import PDBParser, NeighborSearch
import numpy as np

def detect_hydrogen_bonds(
    protein_structure,
    ligand_structure,
    distance_cutoff=3.5,  # √Ö
    angle_cutoff=120  # degrees
):
    &quot;&quot;&quot;
    Ê∞¥Á¥†ÁµêÂêà„ÇíÊ§úÂá∫

    Parameters:
    -----------
    protein_structure : Bio.PDB.Structure
        „Çø„É≥„Éë„ÇØË≥™ÊßãÈÄ†
    ligand_structure : Bio.PDB.Structure
        „É™„Ç¨„É≥„ÉâÊßãÈÄ†
    distance_cutoff : float
        Ë∑ùÈõ¢„ÅÆÈñæÂÄ§Ôºà√ÖÔºâ
    angle_cutoff : float
        ËßíÂ∫¶„ÅÆÈñæÂÄ§ÔºàÂ∫¶Ôºâ

    Returns:
    --------
    list: Ê∞¥Á¥†ÁµêÂêà„ÅÆ„É™„Çπ„Éà
    &quot;&quot;&quot;
    # „Çø„É≥„Éë„ÇØË≥™„ÅÆÂÖ®ÂéüÂ≠ê
    protein_atoms = [
        atom for atom in protein_structure.get_atoms()
    ]

    # „É™„Ç¨„É≥„Éâ„ÅÆÂÖ®ÂéüÂ≠ê
    ligand_atoms = [
        atom for atom in ligand_structure.get_atoms()
    ]

    # ËøëÂÇçÊé¢Á¥¢
    ns = NeighborSearch(protein_atoms)

    hbonds = []

    # „É™„Ç¨„É≥„Éâ„ÅÆÂêÑÂéüÂ≠ê„Å´„Å§„ÅÑ„Å¶
    for ligand_atom in ligand_atoms:
        # „Éâ„Éä„Éº/„Ç¢„ÇØ„Çª„Éó„Çø„ÉºÂà§ÂÆöÔºàÁ∞°ÊòìÁâàÔºâ
        if ligand_atom.element not in ['N', 'O']:
            continue

        # ËøëÂÇç„ÅÆ„Çø„É≥„Éë„ÇØË≥™ÂéüÂ≠ê
        nearby_atoms = ns.search(
            ligand_atom.get_coord(),
            distance_cutoff
        )

        for protein_atom in nearby_atoms:
            if protein_atom.element not in ['N', 'O']:
                continue

            # Ë∑ùÈõ¢Ë®àÁÆó
            distance = ligand_atom - protein_atom

            if distance &lt;= distance_cutoff:
                hbonds.append({
                    'ligand_atom': ligand_atom.get_full_id(),
                    'protein_atom': protein_atom.get_full_id(),
                    'distance': distance
                })

    return hbonds

# ‰ΩøÁî®‰æãÔºàÊû∂Á©∫„ÅÆÊßãÈÄ†Ôºâ
&quot;&quot;&quot;
parser = PDBParser(QUIET=True)
protein = parser.get_structure('protein', 'protein.pdb')
ligand = parser.get_structure('ligand', 'ligand.pdb')

hbonds = detect_hydrogen_bonds(protein, ligand)

print(f&quot;=== Ê∞¥Á¥†ÁµêÂêà ===&quot;)
print(f&quot;Ê§úÂá∫Êï∞: {len(hbonds)}&quot;)

for i, hb in enumerate(hbonds[:5], 1):
    print(f&quot;\nÊ∞¥Á¥†ÁµêÂêà {i}:&quot;)
    print(f&quot;  Ë∑ùÈõ¢: {hb['distance']:.2f} √Ö&quot;)
    print(f&quot;  „É™„Ç¨„É≥„ÉâÂéüÂ≠ê: {hb['ligand_atom']}&quot;)
    print(f&quot;  „Çø„É≥„Éë„ÇØË≥™ÂéüÂ≠ê: {hb['protein_atom']}&quot;)
&quot;&quot;&quot;
</code></pre>
<hr />
<h3>ÁñéÊ∞¥ÊÄßÁõ∏‰∫í‰ΩúÁî®„ÅÆËß£Êûê</h3>
<p><strong>Example 5: ÁñéÊ∞¥ÊÄßÊé•Ëß¶„ÅÆÊ§úÂá∫</strong></p>
<pre><code class="language-python">def detect_hydrophobic_contacts(
    protein_structure,
    ligand_structure,
    distance_cutoff=4.5  # √Ö
):
    &quot;&quot;&quot;
    ÁñéÊ∞¥ÊÄßÁõ∏‰∫í‰ΩúÁî®„ÇíÊ§úÂá∫

    Parameters:
    -----------
    protein_structure : Bio.PDB.Structure
    ligand_structure : Bio.PDB.Structure
    distance_cutoff : float
        ÁñéÊ∞¥ÊÄßÁõ∏‰∫í‰ΩúÁî®„ÅÆÈñæÂÄ§Ôºà√ÖÔºâ

    Returns:
    --------
    list: ÁñéÊ∞¥ÊÄßÊé•Ëß¶„ÅÆ„É™„Çπ„Éà
    &quot;&quot;&quot;
    # ÁñéÊ∞¥ÊÄß„Ç¢„Éü„ÉéÈÖ∏
    hydrophobic_residues = [
        'ALA', 'VAL', 'ILE', 'LEU', 'MET',
        'PHE', 'TRP', 'PRO'
    ]

    # „Çø„É≥„Éë„ÇØË≥™„ÅÆÁñéÊ∞¥ÊÄßÊÆãÂü∫„ÅÆÁÇ≠Á¥†ÂéüÂ≠ê
    protein_hydrophobic_atoms = []
    for residue in protein_structure.get_residues():
        if residue.get_resname() in hydrophobic_residues:
            for atom in residue:
                if atom.element == 'C':
                    protein_hydrophobic_atoms.append(atom)

    # „É™„Ç¨„É≥„Éâ„ÅÆÁÇ≠Á¥†ÂéüÂ≠ê
    ligand_carbon_atoms = [
        atom for atom in ligand_structure.get_atoms()
        if atom.element == 'C'
    ]

    # ËøëÂÇçÊé¢Á¥¢
    ns = NeighborSearch(protein_hydrophobic_atoms)

    contacts = []

    for ligand_atom in ligand_carbon_atoms:
        nearby_atoms = ns.search(
            ligand_atom.get_coord(),
            distance_cutoff
        )

        for protein_atom in nearby_atoms:
            distance = ligand_atom - protein_atom

            if distance &lt;= distance_cutoff:
                contacts.append({
                    'ligand_atom': ligand_atom.get_full_id(),
                    'protein_atom': protein_atom.get_full_id(),
                    'residue': protein_atom.get_parent().get_resname(),
                    'distance': distance
                })

    return contacts

# ‰ΩøÁî®‰æã
&quot;&quot;&quot;
contacts = detect_hydrophobic_contacts(protein, ligand)

print(f&quot;\n=== ÁñéÊ∞¥ÊÄßÊé•Ëß¶ ===&quot;)
print(f&quot;Ê§úÂá∫Êï∞: {len(contacts)}&quot;)

# ÊÆãÂü∫„Åî„Å®„Å´ÈõÜË®à
from collections import Counter
residue_counts = Counter(
    [c['residue'] for c in contacts]
)

print(&quot;\nÊÆãÂü∫Âà•„ÅÆÊé•Ëß¶Êï∞:&quot;)
for residue, count in residue_counts.most_common(5):
    print(f&quot;  {residue}: {count}&quot;)
&quot;&quot;&quot;
</code></pre>
<hr />
<h2>3.3 Ê©üÊ¢∞Â≠¶Áøí„Å´„Çà„ÇãÁµêÂêà‰∫àÊ∏¨</h2>
<h3>„Ç∞„É©„Éï„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØÔºàGNNÔºâ</h3>
<p><strong>Example 6: „Çø„É≥„Éë„ÇØË≥™-„É™„Ç¨„É≥„ÉâË§áÂêà‰Ωì„ÅÆ„Ç∞„É©„ÉïË°®Áèæ</strong></p>
<pre><code class="language-python">import networkx as nx
import numpy as np
from rdkit import Chem

def protein_ligand_to_graph(protein_atoms, ligand_mol):
    &quot;&quot;&quot;
    „Çø„É≥„Éë„ÇØË≥™-„É™„Ç¨„É≥„ÉâË§áÂêà‰Ωì„Çí„Ç∞„É©„Éï„Å´Â§âÊèõ

    Parameters:
    -----------
    protein_atoms : list
        „Çø„É≥„Éë„ÇØË≥™„ÅÆÂéüÂ≠ê„É™„Çπ„Éà
    ligand_mol : RDKit Mol
        „É™„Ç¨„É≥„ÉâÂàÜÂ≠ê

    Returns:
    --------
    networkx.Graph: Ë§áÂêà‰Ωì„Ç∞„É©„Éï
    &quot;&quot;&quot;
    G = nx.Graph()

    # „É™„Ç¨„É≥„Éâ„ÅÆ„Ç∞„É©„ÉïÔºàÂàÜÂ≠ê„Ç∞„É©„ÉïÔºâ
    for atom in ligand_mol.GetAtoms():
        G.add_node(
            f&quot;L{atom.GetIdx()}&quot;,
            atom_type=atom.GetSymbol(),
            atomic_num=atom.GetAtomicNum(),
            hybridization=str(atom.GetHybridization()),
            node_type='ligand'
        )

    # „É™„Ç¨„É≥„Éâ„ÅÆÁµêÂêà
    for bond in ligand_mol.GetBonds():
        G.add_edge(
            f&quot;L{bond.GetBeginAtomIdx()}&quot;,
            f&quot;L{bond.GetEndAtomIdx()}&quot;,
            bond_type=str(bond.GetBondType())
        )

    # „Çø„É≥„Éë„ÇØË≥™„ÅÆÂéüÂ≠êÔºàÁ∞°Áï•Âåñ: ‰ª£Ë°®ÂéüÂ≠ê„ÅÆ„ÅøÔºâ
    for i, atom in enumerate(protein_atoms[:50]):  # ÊúÄÂàù„ÅÆ50ÂéüÂ≠ê
        G.add_node(
            f&quot;P{i}&quot;,
            atom_type=atom.element,
            node_type='protein'
        )

    # „Çø„É≥„Éë„ÇØË≥™-„É™„Ç¨„É≥„ÉâÈñì„ÅÆÁõ∏‰∫í‰ΩúÁî®„Ç®„ÉÉ„Ç∏
    # ÔºàË∑ùÈõ¢„Éô„Éº„Çπ„ÄÅÈñæÂÄ§4√ÖÔºâ
    ligand_coords = ligand_mol.GetConformer().GetPositions()

    for i, protein_atom in enumerate(protein_atoms[:50]):
        protein_coord = protein_atom.get_coord()

        for j, ligand_coord in enumerate(ligand_coords):
            distance = np.linalg.norm(
                protein_coord - ligand_coord
            )

            if distance &lt; 4.0:  # 4√Ö‰ª•ÂÜÖ
                G.add_edge(
                    f&quot;P{i}&quot;,
                    f&quot;L{j}&quot;,
                    interaction='contact',
                    distance=distance
                )

    return G

# ‰ΩøÁî®‰æã
&quot;&quot;&quot;
ligand_smiles = &quot;CC(=O)Oc1ccccc1C(=O)O&quot;  # „Ç¢„Çπ„Éî„É™„É≥
ligand_mol = Chem.MolFromSmiles(ligand_smiles)
ligand_mol = Chem.AddHs(ligand_mol)
AllChem.EmbedMolecule(ligand_mol)

# protein_atoms „ÅØ Bio.PDB.Structure „Åã„ÇâÂèñÂæó
# complex_graph = protein_ligand_to_graph(
#     protein_atoms, ligand_mol
# )

# „Ç∞„É©„ÉïÁµ±Ë®à
# print(f&quot;„Éé„Éº„ÉâÊï∞: {complex_graph.number_of_nodes()}&quot;)
# print(f&quot;„Ç®„ÉÉ„Ç∏Êï∞: {complex_graph.number_of_edges()}&quot;)
&quot;&quot;&quot;
</code></pre>
<hr />
<h3>DeepDockingÈ¢®„ÅÆ‰∫àÊ∏¨„É¢„Éá„É´</h3>
<p><strong>Example 7: ÁµêÂêàË¶™ÂíåÊÄß‰∫àÊ∏¨„É¢„Éá„É´</strong></p>
<pre><code class="language-python">import numpy as np
import pandas as pd
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import mean_absolute_error, r2_score

def extract_complex_features(
    protein_structure,
    ligand_mol
):
    &quot;&quot;&quot;
    „Çø„É≥„Éë„ÇØË≥™-„É™„Ç¨„É≥„ÉâË§áÂêà‰Ωì„Åã„ÇâÁâπÂæ¥Èáè„ÇíÊäΩÂá∫

    Returns:
    --------
    dict: ÁâπÂæ¥ÈáèËæûÊõ∏
    &quot;&quot;&quot;
    from rdkit.Chem import Descriptors

    # „É™„Ç¨„É≥„Éâ„ÅÆÁâπÂæ¥
    ligand_features = {
        'ligand_mw': Descriptors.MolWt(ligand_mol),
        'ligand_logp': Descriptors.MolLogP(ligand_mol),
        'ligand_hbd': Descriptors.NumHDonors(ligand_mol),
        'ligand_hba': Descriptors.NumHAcceptors(ligand_mol),
        'ligand_rotatable_bonds': Descriptors.NumRotatableBonds(
            ligand_mol
        ),
        'ligand_aromatic_rings': Descriptors.NumAromaticRings(
            ligand_mol
        )
    }

    # „Çø„É≥„Éë„ÇØË≥™„ÅÆÁâπÂæ¥ÔºàÁ∞°Áï•ÂåñÔºâ
    # ÂÆüÈöõ„ÅØÁµêÂêàÈÉ®‰Ωç„ÅÆÊÆãÂü∫ÁµÑÊàê„Å™„Å©
    protein_features = {
        'binding_site_residues': 10,  # ‰ªÆ„ÅÆÂÄ§
        'binding_site_hydrophobic': 0.4,
        'binding_site_charged': 0.3
    }

    return {**ligand_features, **protein_features}

# „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÁîüÊàêÔºàÂÆüÈöõ„ÅØ„Éá„Éº„Çø„Éô„Éº„Çπ„Åã„ÇâÔºâ
np.random.seed(42)

n_samples = 200
X_features = []
y_affinities = []

for _ in range(n_samples):
    # „É©„É≥„ÉÄ„É†„Å™ÁâπÂæ¥ÈáèÔºà„Éá„É¢Áî®Ôºâ
    features = {
        'ligand_mw': np.random.uniform(150, 500),
        'ligand_logp': np.random.uniform(-2, 5),
        'ligand_hbd': np.random.randint(0, 6),
        'ligand_hba': np.random.randint(0, 10),
        'ligand_rotatable_bonds': np.random.randint(0, 10),
        'ligand_aromatic_rings': np.random.randint(0, 4),
        'binding_site_residues': np.random.randint(5, 20),
        'binding_site_hydrophobic': np.random.uniform(0.2, 0.6),
        'binding_site_charged': np.random.uniform(0.1, 0.5)
    }

    # ÁµêÂêàË¶™ÂíåÊÄßÔºàkcal/molÔºâ
    # ÂÆüÈöõ„ÅÆÈñ¢‰øÇÂºè„Å´Âü∫„Å•„ÅÑ„Å¶ÁîüÊàê
    affinity = (
        -0.1 * features['ligand_mw'] / 100
        - 1.5 * features['ligand_hbd']
        - 1.0 * features['ligand_hba']
        + 2.0 * features['ligand_logp']
        + np.random.randn() * 1.0
    )

    X_features.append(list(features.values()))
    y_affinities.append(affinity)

X = np.array(X_features)
y = np.array(y_affinities)

# Ë®ìÁ∑¥/„ÉÜ„Çπ„ÉàÂàÜÂâ≤
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# „É¢„Éá„É´Ë®ìÁ∑¥
model = RandomForestRegressor(
    n_estimators=100,
    max_depth=10,
    random_state=42
)

model.fit(X_train, y_train)

# ‰∫àÊ∏¨
y_pred = model.predict(X_test)

# Ë©ï‰æ°
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f&quot;=== ÁµêÂêàË¶™ÂíåÊÄß‰∫àÊ∏¨„É¢„Éá„É´ ===&quot;)
print(f&quot;MAE: {mae:.2f} kcal/mol&quot;)
print(f&quot;R¬≤: {r2:.3f}&quot;)

# ÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶
feature_names = [
    'MW', 'LogP', 'HBD', 'HBA', 'RotBonds',
    'AromRings', 'BSResidues', 'BSHydrophobic',
    'BSCharged'
]

importance_df = pd.DataFrame({
    'feature': feature_names,
    'importance': model.feature_importances_
}).sort_values('importance', ascending=False)

print(&quot;\nÁâπÂæ¥ÈáèÈáçË¶ÅÂ∫¶:&quot;)
print(importance_df)
</code></pre>
<hr />
<h2>3.4 „Ç±„Éº„Çπ„Çπ„Çø„Éá„Ç£ÔºöÊäó‰Ωì-ÊäóÂéüÁõ∏‰∫í‰ΩúÁî®</h2>
<h3>Êäó‰ΩìÊßãÈÄ†„ÅÆ„É¢„Éá„É™„É≥„Ç∞</h3>
<p><strong>Example 8: Êäó‰ΩìÂèØÂ§âÈ†òÂüü„ÅÆ„É¢„Éá„É™„É≥„Ç∞</strong></p>
<pre><code class="language-python">def model_antibody_structure(
    heavy_chain_seq,
    light_chain_seq,
    output_pdb=&quot;antibody_model.pdb&quot;
):
    &quot;&quot;&quot;
    Êäó‰ΩìÊßãÈÄ†„Çí„É¢„Éá„É™„É≥„Ç∞

    Parameters:
    -----------
    heavy_chain_seq : str
        ÈáçÈéñ„ÅÆÈÖçÂàó
    light_chain_seq : str
        ËªΩÈéñ„ÅÆÈÖçÂàó
    output_pdb : str
        Âá∫ÂäõPDB„Éï„Ç°„Ç§„É´

    Note:
    -----
    ÂÆüÈöõ„Å´„ÅØÂ∞ÇÈñÄ„ÉÑ„Éº„É´ÔºàModeller„ÄÅAlphaFold2Ôºâ„Çí‰ΩøÁî®
    &quot;&quot;&quot;
    print(&quot;=== Êäó‰ΩìÊßãÈÄ†„É¢„Éá„É™„É≥„Ç∞ ===&quot;)
    print(f&quot;ÈáçÈéñÈï∑: {len(heavy_chain_seq)} aa&quot;)
    print(f&quot;ËªΩÈéñÈï∑: {len(light_chain_seq)} aa&quot;)

    # CDRÔºàÁõ∏Ë£úÊÄßÊ±∫ÂÆöÈ†òÂüüÔºâ„ÅÆÊé®ÂÆö
    # Á∞°Áï•Âåñ: ÈáçÈéñCDR3„ÅØ95-102Áï™ÁõÆ„Å®‰ªÆÂÆö
    cdr_h3_start = 95
    cdr_h3_end = 102

    if len(heavy_chain_seq) &gt;= cdr_h3_end:
        cdr_h3_seq = heavy_chain_seq[cdr_h3_start:cdr_h3_end]
        print(f&quot;\nCDR-H3ÈÖçÂàó: {cdr_h3_seq}&quot;)
        print(f&quot;Èï∑„Åï: {len(cdr_h3_seq)} aa&quot;)

    # ÂÆüÈöõ„ÅÆ„É¢„Éá„É™„É≥„Ç∞„ÅØAlphaFold2„ÇÑModeller „ÅßÂÆüË°å
    # „Åì„Åì„Åß„ÅØ„Éá„É¢„Å®„Åó„Å¶ÊÉÖÂ†±Ë°®Á§∫„ÅÆ„Åø

    print(f&quot;\n„É¢„Éá„É´‰øùÂ≠ò‰∫àÂÆö: {output_pdb}&quot;)
    print(&quot;ÂÆüÈöõ„ÅÆ„É¢„Éá„É™„É≥„Ç∞„Å´„ÅØAlphaFold2„Çí‰ΩøÁî®„Åó„Å¶„Åè„Å†„Åï„ÅÑ&quot;)

# ‰ΩøÁî®‰æã
heavy_chain = &quot;QVQLQQSGPGLVKPSQTLSLTCAISGDSVSSNSAAWN&quot; * 3
light_chain = &quot;DIQMTQSPSSLSASVGDRVTITCRASQDVNTAVAWY&quot; * 3

model_antibody_structure(heavy_chain, light_chain)
</code></pre>
<hr />
<h3>„Ç®„Éî„Éà„Éº„Éó‰∫àÊ∏¨</h3>
<p><strong>Example 9: Á∑öÂΩ¢„Ç®„Éî„Éà„Éº„Éó‰∫àÊ∏¨</strong></p>
<pre><code class="language-python">def predict_linear_epitopes(
    antigen_sequence,
    window_size=9
):
    &quot;&quot;&quot;
    Á∑öÂΩ¢„Ç®„Éî„Éà„Éº„Éó„Çí‰∫àÊ∏¨ÔºàÁ∞°ÊòìÁâàÔºâ

    Parameters:
    -----------
    antigen_sequence : str
        ÊäóÂéü„ÅÆ„Ç¢„Éü„ÉéÈÖ∏ÈÖçÂàó
    window_size : int
        „Ç®„Éî„Éà„Éº„Éó„ÅÆ„Ç¶„Ç£„É≥„Éâ„Ç¶„Çµ„Ç§„Ç∫

    Returns:
    --------
    list: „Ç®„Éî„Éà„Éº„ÉóÂÄôË£ú„ÅÆ„É™„Çπ„Éà
    &quot;&quot;&quot;
    # Á∞°ÊòìÁöÑ„Å™‰∫àÊ∏¨ÔºàÂÆüÈöõ„ÅØBepipred„ÄÅIEDB tools„Å™„Å©„Çí‰ΩøÁî®Ôºâ

    # ÁñéÊ∞¥ÊÄß„ÄÅÈõªËç∑„ÄÅË°®Èù¢Èú≤Âá∫„ÇíËÄÉÊÖÆ„Åó„Åü„Çπ„Ç≥„Ç¢„É™„É≥„Ç∞
    hydrophobic_aa = &quot;AVILMFWP&quot;
    charged_aa = &quot;KRHDE&quot;
    polar_aa = &quot;STNQYC&quot;

    epitope_candidates = []

    for i in range(len(antigen_sequence) - window_size + 1):
        peptide = antigen_sequence[i:i+window_size]

        # „Çπ„Ç≥„Ç¢Ë®àÁÆó
        hydrophobic_count = sum(
            1 for aa in peptide if aa in hydrophobic_aa
        )
        charged_count = sum(
            1 for aa in peptide if aa in charged_aa
        )
        polar_count = sum(
            1 for aa in peptide if aa in polar_aa
        )

        # Á∞°Êòì„Çπ„Ç≥„Ç¢: „Éê„É©„É≥„Çπ„ÅÆËâØ„ÅÑ„Éö„Éó„ÉÅ„Éâ„ÇíÈÅ∏Â•Ω
        score = (
            0.3 * charged_count +
            0.5 * polar_count +
            0.2 * hydrophobic_count
        )

        epitope_candidates.append({
            'position': i,
            'peptide': peptide,
            'score': score
        })

    # „Çπ„Ç≥„Ç¢È†Ü„Å´„ÇΩ„Éº„Éà
    epitope_candidates.sort(
        key=lambda x: x['score'],
        reverse=True
    )

    return epitope_candidates

# ‰ΩøÁî®‰æã
antigen_seq = &quot;&quot;&quot;
MFVFLVLLPLVSSQCVNLTTRTQLPPAYTNSFTRGVYYPDKVFRSSVLHS
TQDLFLPFFSNVTWFHAIHVSGTNGTKRFDNPVLPFNDGVYFASTEKSNI
IRGWIFGTTLDSKTQSLLIVNNATNVVIKVCEFQFCNDPFLGVYYHKNNK
SWMESEFRVYSSANNCTFEYVSQPFLMDLEGKQGNFKNLREFVFKNIDGY
FKIYSKHTPINLVRDLPQGFSALEPLVDLPIGINITRFQTLLALHRSYLT
PGDSSSGWTAGAAAYYVGYLQPRTFLLKYNENGTITDAVDCALDPLSETK
CTLKSFTVEKGIYQTSNFRVQPTESIVRFPNITNLCPFGEVFNATRFASV
YAWNRKRISNCVADYSVLYNSASFSTFKCYGVSPTKLNDLCFTNVYADSF
VIRGDEVRQIAPGQTGKIADYNYKLPDDFTGCVIAWNSNNLDSKVGGNYN
YLYRLFRKSNLKPFERDISTEIYQAGSTPCNGVEGFNCYFPLQSYGFQPT
NGVGYQPYRVVVLSFELLHAPATVCGPKKSTNLVKNKCVNF
&quot;&quot;&quot;
antigen_seq = antigen_seq.replace(&quot;\n&quot;, &quot;&quot;).replace(&quot; &quot;, &quot;&quot;)

epitopes = predict_linear_epitopes(antigen_seq, window_size=9)

print(f&quot;=== „Ç®„Éî„Éà„Éº„Éó‰∫àÊ∏¨ ===&quot;)
print(f&quot;ÈÖçÂàóÈï∑: {len(antigen_seq)} aa&quot;)
print(f&quot;\n‰∏ä‰Ωç5ÂÄôË£ú:&quot;)

for i, ep in enumerate(epitopes[:5], 1):
    print(f&quot;\n{i}. ‰ΩçÁΩÆ {ep['position']}&quot;)
    print(f&quot;   ÈÖçÂàó: {ep['peptide']}&quot;)
    print(f&quot;   „Çπ„Ç≥„Ç¢: {ep['score']:.2f}&quot;)
</code></pre>
<hr />
<h2>3.5 Êú¨Á´†„ÅÆ„Åæ„Å®„ÇÅ</h2>
<h3>Â≠¶„Çì„Å†„Åì„Å®</h3>
<ol>
<li>
<p><strong>ÂàÜÂ≠ê„Éâ„ÉÉ„Ç≠„É≥„Ç∞</strong>
   - AutoDock Vina„Å´„Çà„Çã„Éâ„ÉÉ„Ç≠„É≥„Ç∞
   - ÁµêÂêàË¶™ÂíåÊÄß„Çπ„Ç≥„Ç¢</p>
</li>
<li>
<p><strong>Áõ∏‰∫í‰ΩúÁî®Ëß£Êûê</strong>
   - Ê∞¥Á¥†ÁµêÂêà„ÅÆÊ§úÂá∫
   - ÁñéÊ∞¥ÊÄßÊé•Ëß¶
   - PyMOLÂèØË¶ñÂåñ</p>
</li>
<li>
<p><strong>Ê©üÊ¢∞Â≠¶Áøí</strong>
   - „Ç∞„É©„ÉïË°®Áèæ
   - ÁµêÂêàË¶™ÂíåÊÄß‰∫àÊ∏¨</p>
</li>
<li>
<p><strong>Êäó‰Ωì-ÊäóÂéü</strong>
   - Êäó‰ΩìÊßãÈÄ†„É¢„Éá„É™„É≥„Ç∞
   - „Ç®„Éî„Éà„Éº„Éó‰∫àÊ∏¨</p>
</li>
</ol>
<h3>Ê¨°„ÅÆÁ´†„Å∏</h3>
<p>Á¨¨4Á´†„Åß„ÅØ„ÄÅ<strong>„Éê„Ç§„Ç™„Çª„É≥„Çµ„Éº„ÉªDDSÊùêÊñôË®≠Ë®à</strong>„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>
<p><strong><a href="./chapter-4.html">Á¨¨4Á´†Ôºö„Éê„Ç§„Ç™„Çª„É≥„Çµ„Éº„ÉªDDSÊùêÊñôË®≠Ë®à ‚Üí</a></strong></p>
<hr />
<h2>ÂèÇËÄÉÊñáÁåÆ</h2>
<ol>
<li>
<p>Trott, O. &amp; Olson, A. J. (2010). "AutoDock Vina: improving the
   speed and accuracy of docking with a new scoring function."
   <em>Journal of Computational Chemistry</em>, 31(2), 455-461.</p>
</li>
<li>
<p>Burley, S. K. et al. (2021). "RCSB Protein Data Bank."
   <em>Nucleic Acids Research</em>, 49(D1), D437-D451.</p>
</li>
</ol>
<hr />
<h2>„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥</h2>
<p><strong><a href="./chapter-2.html">‚Üê Á¨¨2Á´†</a></strong> | <strong><a href="./chapter-4.html">Á¨¨4Á´† ‚Üí</a></strong> | <strong><a href="./index.html">ÁõÆÊ¨°</a></strong></p><div class="navigation">
    <a href="chapter-2.html" class="nav-button">‚Üê Á¨¨2Á´†</a>
    <a href="index.html" class="nav-button">„Ç∑„É™„Éº„Ç∫ÁõÆÊ¨°„Å´Êàª„Çã</a>
    <a href="chapter-4.html" class="nav-button">Á¨¨4Á´† ‚Üí</a>
</div>
    </main>

    <footer>
        <p><strong>‰ΩúÊàêËÄÖ</strong>: AI Terakoya Content Team</p>
        <p><strong>Áõ£‰øÆ</strong>: Dr. Yusuke HashimotoÔºàÊù±ÂåóÂ§ßÂ≠¶Ôºâ</p>
        <p><strong>„Éê„Éº„Ç∏„Éß„É≥</strong>: 1.0 | <strong>‰ΩúÊàêÊó•</strong>: 2025-10-17</p>
        <p><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: Creative Commons BY 4.0</p>
        <p>¬© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
