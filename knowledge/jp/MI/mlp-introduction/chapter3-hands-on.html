<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ç’°å¢ƒæ§‹ç¯‰ã‹ã‚‰è¨“ç·´ã€MLP-MDã¾ã§">
    <title>ç¬¬3ç« ï¼šPythonã§ä½“é¨“ã™ã‚‹MLP - SchNetPackãƒãƒ³ã‚ºã‚ªãƒ³ - MI Knowledge Hub</title>

    <!-- CSS Styling -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --bg-color: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --code-bg: #f5f5f5;
            --link-color: #3498db;
            --link-hover: #2980b9;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
            line-height: 1.8;
            color: var(--text-color);
            background: var(--bg-color);
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        header .container {
            padding: 0 1.5rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .meta {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            font-size: 0.9rem;
            opacity: 0.95;
            margin-top: 1rem;
        }

        .meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }

        /* Typography */
        h2 {
            font-size: 1.75rem;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--secondary-color);
            color: var(--primary-color);
        }

        h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
            margin-bottom: 0.8rem;
            color: var(--primary-color);
        }

        h4 {
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
        }

        p {
            margin-bottom: 1.2rem;
        }

        a {
            color: var(--link-color);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--link-hover);
            text-decoration: underline;
        }

        /* Lists */
        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1.2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        /* Code blocks */
        code {
            background: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
        }

        pre code {
            background: none;
            padding: 0;
            font-size: 0.9rem;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            display: block;
        }

        thead {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        th, td {
            padding: 0.8rem;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background: var(--primary-color);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: #f9f9f9;
        }

        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--secondary-color);
            padding-left: 1.5rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #666;
        }

        /* Images */
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
        }

        /* Mermaid diagrams */
        .mermaid {
            text-align: center;
            margin: 2rem 0;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        /* Details/Summary (for exercises) */
        details {
            margin: 1rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--primary-color);
            padding: 0.5rem;
        }

        summary:hover {
            color: var(--secondary-color);
        }

        /* Footer */
        footer {
            margin-top: 4rem;
            padding: 2rem 0;
            border-top: 2px solid var(--border-color);
            text-align: center;
            color: #666;
            font-size: 0.9rem;
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        /* Navigation buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin: 3rem 0;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-button {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background: var(--secondary-color);
            color: white;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 600;
        }

        .nav-button:hover {
            background: var(--link-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(52, 152, 219, 0.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            h1 {
                font-size: 1.6rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }

            table {
                font-size: 0.9rem;
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../MI/index.html">ãƒãƒ†ãƒªã‚¢ãƒ«ã‚ºãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a><span class="breadcrumb-separator">â€º</span><a href="../../MI/mlp-introduction/index.html">Mlp</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 3</span>
        </div>
    </nav>

        <header>
        <div class="container">
            <h1>ç¬¬3ç« ï¼šPythonã§ä½“é¨“ã™ã‚‹MLP - SchNetPackãƒãƒ³ã‚ºã‚ªãƒ³</h1>
            <div class="meta">
                <span>ğŸ“– èª­äº†æ™‚é–“: ä¸æ˜</span>
                <span>ğŸ“Š ãƒ¬ãƒ™ãƒ«: beginner-intermediate</span>
            </div>
        </div>
    </header>

    <main class="container">
        <h1 id="3pythonmlp-schnetpack">ç¬¬3ç« ï¼šPythonã§ä½“é¨“ã™ã‚‹MLP - SchNetPackãƒãƒ³ã‚ºã‚ªãƒ³</h1>
<p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-left: 4px solid #7b2cbf; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">å°ã•ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ã®è¨“ç·´ãƒ»è©•ä¾¡ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä¸€é€šã‚Šå›ã—ã¾ã™ã€‚å†ç¾æ€§ç¢ºä¿ã¨éå­¦ç¿’å¯¾ç­–ã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚‚æ˜ç¢ºã«ã—ã¾ã™ã€‚</p>
<p class="chapter-supplement" style="margin: 0.75rem 0 1.5rem 0; padding: 0.75rem 1rem; background: linear-gradient(135deg, #fff8e1 0%, #fff3cd 100%); border-left: 3px solid #f59e0b; border-radius: 6px; font-size: 0.95rem; line-height: 1.7; color: #4a5568;"><strong>ğŸ’¡ è£œè¶³:</strong> ã‚·ãƒ¼ãƒ‰å›ºå®šã€ãƒ‡ãƒ¼ã‚¿åˆ†å‰²ã€å­¦ç¿’æ›²ç·šã®è¨˜éŒ²ãŒåŸºæœ¬ä¸‰ç‚¹ã‚»ãƒƒãƒˆã€‚æ—©æœŸçµ‚äº†ã¨é‡ã¿æ¸›è¡°ã§å®‰å®šåŒ–ã—ã¾ã™ã€‚</p>




<h2 id="_1">å­¦ç¿’ç›®æ¨™</h2>
<p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š<br />
- Pythonç’°å¢ƒã§SchNetPackã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€ç’°å¢ƒã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã§ãã‚‹<br />
- å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆMD17ã®ã‚¢ã‚¹ãƒ”ãƒªãƒ³åˆ†å­ï¼‰ã‚’ç”¨ã„ã¦MLPãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã§ãã‚‹<br />
- è¨“ç·´æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ã‚’è©•ä¾¡ã—ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»åŠ›ã®äºˆæ¸¬èª¤å·®ã‚’ç¢ºèªã§ãã‚‹<br />
- MLP-MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã€ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªã‚’è§£æã§ãã‚‹<br />
- ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•ã‚’ç†è§£ã™ã‚‹</p>
<hr />
<h2 id="31">3.1 ç’°å¢ƒæ§‹ç¯‰ï¼šå¿…è¦ãªãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h2>
<p>MLPã‚’å®Ÿè·µã™ã‚‹ã«ã¯ã€Pythonç’°å¢ƒã¨SchNetPackã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå¿…è¦ã§ã™ã€‚</p>
<h3 id="_2">å¿…è¦ãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</h3>
<table>
<thead>
<tr>
<th>ãƒ„ãƒ¼ãƒ«</th>
<th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
<th>ç”¨é€”</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Python</strong></td>
<td>3.9-3.11</td>
<td>åŸºç›¤è¨€èª</td>
</tr>
<tr>
<td><strong>PyTorch</strong></td>
<td>2.0+</td>
<td>ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</td>
</tr>
<tr>
<td><strong>SchNetPack</strong></td>
<td>2.0+</td>
<td>MLPè¨“ç·´ãƒ»æ¨è«–</td>
</tr>
<tr>
<td><strong>ASE</strong></td>
<td>3.22+</td>
<td>åŸå­æ§‹é€ æ“ä½œã€MDå®Ÿè¡Œ</td>
</tr>
<tr>
<td><strong>NumPy/Matplotlib</strong></td>
<td>æœ€æ–°ç‰ˆ</td>
<td>ãƒ‡ãƒ¼ã‚¿è§£æãƒ»å¯è¦–åŒ–</td>
</tr>
</tbody>
</table>
<h3 id="_3">ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ‰‹é †</h3>
<p><strong>ã‚¹ãƒ†ãƒƒãƒ—1: Condaç’°å¢ƒã®ä½œæˆ</strong></p>
<pre class="codehilite"><code class="language-bash"># æ–°ã—ã„Condaç’°å¢ƒã‚’ä½œæˆï¼ˆPython 3.10ï¼‰
conda create -n mlp-tutorial python=3.10 -y
conda activate mlp-tutorial
</code></pre>

<p><strong>ã‚¹ãƒ†ãƒƒãƒ—2: PyTorchã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong></p>
<pre class="codehilite"><code class="language-bash"># CPUç‰ˆï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã€è»½é‡ï¼‰
conda install pytorch cpuonly -c pytorch

# GPUç‰ˆï¼ˆCUDAãŒåˆ©ç”¨å¯èƒ½ãªå ´åˆï¼‰
conda install pytorch pytorch-cuda=11.8 -c pytorch -c nvidia
</code></pre>

<p><strong>ã‚¹ãƒ†ãƒƒãƒ—3: SchNetPackã¨ASEã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong></p>
<pre class="codehilite"><code class="language-bash"># SchNetPackï¼ˆpipæ¨å¥¨ï¼‰
pip install schnetpack

# ASEï¼ˆåŸå­ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ç’°å¢ƒï¼‰
pip install ase

# å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«
pip install matplotlib seaborn
</code></pre>

<p><strong>ã‚¹ãƒ†ãƒƒãƒ—4: å‹•ä½œç¢ºèª</strong></p>
<pre class="codehilite"><code class="language-python"># Example 1: ç’°å¢ƒç¢ºèªã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆ5è¡Œï¼‰
import torch
import schnetpack as spk
print(f&quot;PyTorch: {torch.__version__}&quot;)
print(f&quot;SchNetPack: {spk.__version__}&quot;)
print(f&quot;GPU available: {torch.cuda.is_available()}&quot;)
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre class="codehilite"><code>PyTorch: 2.1.0
SchNetPack: 2.0.3
GPU available: False  # CPUã®å ´åˆ
</code></pre>

<hr />
<h2 id="32-md17">3.2 ãƒ‡ãƒ¼ã‚¿æº–å‚™ï¼šMD17ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®å–å¾—</h2>
<p>SchNetPackã¯ã€å°è¦æ¨¡åˆ†å­ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ<strong>MD17</strong>ã‚’å†…è”µã—ã¦ã„ã¾ã™ã€‚</p>
<h3 id="md17">MD17ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ã¯</h3>
<ul>
<li><strong>å†…å®¹</strong>: DFTè¨ˆç®—ã«ã‚ˆã‚‹åˆ†å­å‹•åŠ›å­¦ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒª</li>
<li><strong>å¯¾è±¡åˆ†å­</strong>: ã‚¢ã‚¹ãƒ”ãƒªãƒ³ã€ãƒ™ãƒ³ã‚¼ãƒ³ã€ã‚¨ã‚¿ãƒãƒ¼ãƒ«ãªã©10ç¨®é¡</li>
<li><strong>ãƒ‡ãƒ¼ã‚¿æ•°</strong>: å„åˆ†å­ç´„10ä¸‡é…ç½®</li>
<li><strong>ç²¾åº¦</strong>: PBE/def2-SVP ãƒ¬ãƒ™ãƒ«ï¼ˆDFTï¼‰</li>
<li><strong>ç”¨é€”</strong>: MLPæ‰‹æ³•ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</li>
</ul>
<h3 id="_4">ãƒ‡ãƒ¼ã‚¿ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨èª­ã¿è¾¼ã¿</h3>
<p><strong>Example 2: MD17ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ­ãƒ¼ãƒ‰ï¼ˆ10è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">from schnetpack.datasets import MD17
from schnetpack.data import AtomsDataModule

# ã‚¢ã‚¹ãƒ”ãƒªãƒ³åˆ†å­ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆç´„10ä¸‡é…ç½®ï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
dataset = MD17(
    datapath='./data',
    molecule='aspirin',
    download=True
)

print(f&quot;Total samples: {len(dataset)}&quot;)
print(f&quot;Properties: {dataset.available_properties}&quot;)
print(f&quot;First sample: {dataset[0]}&quot;)
</code></pre>

<p><strong>å‡ºåŠ›</strong>:</p>
<pre class="codehilite"><code>Total samples: 211762
Properties: ['energy', 'forces']
First sample: {'_atomic_numbers': tensor([...]), 'energy': tensor(-1234.5), 'forces': tensor([...])}
</code></pre>

<h3 id="_5">ãƒ‡ãƒ¼ã‚¿ã®åˆ†å‰²</h3>
<p><strong>Example 3: è¨“ç·´/æ¤œè¨¼/ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã®åˆ†å‰²ï¼ˆ10è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python"># ãƒ‡ãƒ¼ã‚¿ã‚’è¨“ç·´:æ¤œè¨¼:ãƒ†ã‚¹ãƒˆ = 70%:15%:15%ã«åˆ†å‰²
data_module = AtomsDataModule(
    datapath='./data',
    dataset=dataset,
    batch_size=32,
    num_train=100000,      # è¨“ç·´ãƒ‡ãƒ¼ã‚¿æ•°
    num_val=10000,          # æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿æ•°
    num_test=10000,         # ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ•°
    split_file='split.npz', # åˆ†å‰²æƒ…å ±ã‚’ä¿å­˜
)
data_module.prepare_data()
data_module.setup()
</code></pre>

<p><strong>èª¬æ˜</strong>:<br />
- <code>batch_size=32</code>: 32é…ç½®ãšã¤ã¾ã¨ã‚ã¦å‡¦ç†ï¼ˆãƒ¡ãƒ¢ãƒªåŠ¹ç‡ï¼‰<br />
- <code>num_train=100000</code>: å¤§é‡ãƒ‡ãƒ¼ã‚¿ã§æ±åŒ–æ€§èƒ½å‘ä¸Š<br />
- <code>split_file</code>: åˆ†å‰²ã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ï¼ˆå†ç¾æ€§ç¢ºä¿ï¼‰</p>
<hr />
<h2 id="33-schnetpack">3.3 SchNetPackã§ã®ãƒ¢ãƒ‡ãƒ«è¨“ç·´</h2>
<p>SchNetãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ã—ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨åŠ›ã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>
<h3 id="schnet">SchNetã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¨­å®š</h3>
<p><strong>Example 4: SchNetãƒ¢ãƒ‡ãƒ«ã®å®šç¾©ï¼ˆ15è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">import schnetpack.transform as trn
from schnetpack.representation import SchNet
from schnetpack.model import AtomisticModel
from schnetpack.task import ModelOutput

# 1. SchNetè¡¨ç¾å±¤ï¼ˆåŸå­é…ç½®â†’ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ï¼‰
representation = SchNet(
    n_atom_basis=128,      # åŸå­ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒ
    n_interactions=6,      # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°å±¤ã®æ•°
    cutoff=5.0,            # ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„ï¼ˆÃ…ï¼‰
    n_filters=128          # ãƒ•ã‚£ãƒ«ã‚¿æ•°
)

# 2. å‡ºåŠ›å±¤ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼äºˆæ¸¬ï¼‰
output = ModelOutput(
    name='energy',
    loss_fn=torch.nn.MSELoss(),
    metrics={'MAE': spk.metrics.MeanAbsoluteError()}
)
</code></pre>

<p><strong>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è§£èª¬</strong>:<br />
- <code>n_atom_basis=128</code>: å„åŸå­ã®ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ãŒ128æ¬¡å…ƒï¼ˆå…¸å‹çš„ãªå€¤ï¼‰<br />
- <code>n_interactions=6</code>: 6å±¤ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°ï¼ˆæ·±ã„ã»ã©é•·è·é›¢ç›¸äº’ä½œç”¨ã‚’æ‰ãˆã‚‹ï¼‰<br />
- <code>cutoff=5.0Ã…</code>: ã“ã®è·é›¢ä»¥ä¸Šã®åŸå­é–“ç›¸äº’ä½œç”¨ã‚’ç„¡è¦–ï¼ˆè¨ˆç®—åŠ¹ç‡ï¼‰</p>
<h3 id="_6">è¨“ç·´ã®å®Ÿè¡Œ</h3>
<p><strong>Example 5: è¨“ç·´ãƒ«ãƒ¼ãƒ—ã®è¨­å®šï¼ˆ15è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">import pytorch_lightning as pl
from schnetpack.task import AtomisticTask

# è¨“ç·´ã‚¿ã‚¹ã‚¯ã®å®šç¾©
task = AtomisticTask(
    model=AtomisticModel(representation, [output]),
    outputs=[output],
    optimizer_cls=torch.optim.AdamW,
    optimizer_args={'lr': 1e-4}  # å­¦ç¿’ç‡
)

# Trainerã®è¨­å®š
trainer = pl.Trainer(
    max_epochs=50,               # æœ€å¤§50ã‚¨ãƒãƒƒã‚¯
    accelerator='cpu',           # CPUä½¿ç”¨ï¼ˆGPU: 'gpu'ï¼‰
    devices=1,
    default_root_dir='./training'
)

# è¨“ç·´é–‹å§‹
trainer.fit(task, datamodule=data_module)
</code></pre>

<p><strong>è¨“ç·´æ™‚é–“ã®ç›®å®‰</strong>:<br />
- CPUï¼ˆ4ã‚³ã‚¢ï¼‰: ç´„2-3æ™‚é–“ï¼ˆ10ä¸‡é…ç½®ï¼‰<br />
- GPUï¼ˆRTX 3090ï¼‰: ç´„15-20åˆ†</p>
<h3 id="_7">è¨“ç·´ã®é€²æ—ç¢ºèª</h3>
<p><strong>Example 6: TensorBoardã§ã®å¯è¦–åŒ–ï¼ˆ10è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python"># TensorBoardã®èµ·å‹•ï¼ˆåˆ¥ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰
# tensorboard --logdir=./training/lightning_logs

# Pythonã‹ã‚‰ã®ãƒ­ã‚°ç¢ºèª
import pandas as pd

metrics = pd.read_csv('./training/lightning_logs/version_0/metrics.csv')
print(metrics[['epoch', 'train_loss', 'val_loss']].tail(10))
</code></pre>

<p><strong>æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›</strong>:</p>
<pre class="codehilite"><code>   epoch  train_loss  val_loss
40    40      0.0023    0.0031
41    41      0.0022    0.0030
42    42      0.0021    0.0029
...
</code></pre>

<p><strong>è¦³å¯Ÿãƒã‚¤ãƒ³ãƒˆ</strong>:<br />
- <code>train_loss</code>ã¨<code>val_loss</code>ãŒã¨ã‚‚ã«æ¸›å°‘ â†’ æ­£å¸¸ã«å­¦ç¿’ä¸­<br />
- <code>val_loss</code>ãŒå¢—åŠ ã—å§‹ã‚ãŸã‚‰ <strong>éå­¦ç¿’</strong>ã®å…†å€™ â†’ Early Stoppingã‚’æ¤œè¨</p>
<hr />
<h2 id="34">3.4 ç²¾åº¦æ¤œè¨¼ï¼šã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨åŠ›ã®äºˆæ¸¬ç²¾åº¦</h2>
<p>è¨“ç·´ã—ãŸãƒ¢ãƒ‡ãƒ«ãŒDFTç²¾åº¦ã‚’é”æˆã—ã¦ã„ã‚‹ã‹è©•ä¾¡ã—ã¾ã™ã€‚</p>
<h3 id="_8">ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã§ã®è©•ä¾¡</h3>
<p><strong>Example 7: ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆè©•ä¾¡ï¼ˆ12è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python"># ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã§è©•ä¾¡
test_results = trainer.test(task, datamodule=data_module)

# çµæœã®è¡¨ç¤º
print(f&quot;Energy MAE: {test_results[0]['test_energy_MAE']:.4f} eV&quot;)
print(f&quot;Energy RMSE: {test_results[0]['test_energy_RMSE']:.4f} eV&quot;)

# åŠ›ã®è©•ä¾¡ï¼ˆåˆ¥é€”è¨ˆç®—ãŒå¿…è¦ï¼‰
from schnetpack.metrics import MeanAbsoluteError
force_mae = MeanAbsoluteError(target='forces')
# ... åŠ›ã®è©•ä¾¡ã‚³ãƒ¼ãƒ‰
</code></pre>

<p><strong>è‰¯å¥½ãªç²¾åº¦ã®ç›®å®‰</strong>ï¼ˆã‚¢ã‚¹ãƒ”ãƒªãƒ³åˆ†å­ã€21åŸå­ï¼‰:<br />
- <strong>ã‚¨ãƒãƒ«ã‚®ãƒ¼MAE</strong>: &lt; 1 kcal/molï¼ˆ&lt; 0.043 eVï¼‰<br />
- <strong>åŠ›ã®MAE</strong>: &lt; 1 kcal/mol/Ã…ï¼ˆ&lt; 0.043 eV/Ã…ï¼‰</p>
<h3 id="_9">äºˆæ¸¬å€¤ã¨çœŸå€¤ã®ç›¸é–¢ãƒ—ãƒ­ãƒƒãƒˆ</h3>
<p><strong>Example 8: äºˆæ¸¬ç²¾åº¦ã®å¯è¦–åŒ–ï¼ˆ15è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">import matplotlib.pyplot as plt
import numpy as np

# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã§äºˆæ¸¬
model = task.model
predictions, targets = [], []

for batch in data_module.test_dataloader():
    pred = model(batch)['energy'].detach().numpy()
    true = batch['energy'].numpy()
    predictions.extend(pred)
    targets.extend(true)

# æ•£å¸ƒå›³ãƒ—ãƒ­ãƒƒãƒˆ
plt.scatter(targets, predictions, alpha=0.5, s=1)
plt.plot([min(targets), max(targets)], [min(targets), max(targets)], 'r--')
plt.xlabel('DFT Energy (eV)')
plt.ylabel('MLP Predicted Energy (eV)')
plt.title('Energy Prediction Accuracy')
plt.show()
</code></pre>

<p><strong>ç†æƒ³çš„ãªçµæœ</strong>:<br />
- ç‚¹ãŒèµ¤ã„å¯¾è§’ç·šï¼ˆy=xï¼‰ä¸Šã«å¯†é›†<br />
- RÂ² &gt; 0.99ï¼ˆæ±ºå®šä¿‚æ•°ï¼‰</p>
<hr />
<h2 id="35-mlp-md">3.5 MLP-MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šåˆ†å­å‹•åŠ›å­¦ã®å®Ÿè¡Œ</h2>
<p>è¨“ç·´ã—ãŸMLPã‚’ä½¿ã£ã¦ã€DFTã‚ˆã‚Š10â´å€é«˜é€ŸãªMDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p>
<h3 id="asemlp-md">ASEã§ã®MLP-MDè¨­å®š</h3>
<p><strong>Example 9: MLP-MDè¨ˆç®—ã®æº–å‚™ï¼ˆ10è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">from ase import units
from ase.md.velocitydistribution import MaxwellBoltzmannDistribution
from ase.md.verlet import VelocityVerlet
import schnetpack.interfaces.ase_interface as spk_ase

# MLPã‚’ASE Calculatorã¨ã—ã¦ãƒ©ãƒƒãƒ—
calculator = spk_ase.SpkCalculator(
    model_file='./training/best_model.ckpt',
    device='cpu'
)

# åˆæœŸæ§‹é€ ã®æº–å‚™ï¼ˆMD17ã®æœ€åˆã®é…ç½®ï¼‰
atoms = dataset.get_atoms(0)
atoms.calc = calculator
</code></pre>

<h3 id="_10">åˆæœŸé€Ÿåº¦ã®è¨­å®šã¨å¹³è¡¡åŒ–</h3>
<p><strong>Example 10: æ¸©åº¦åˆæœŸåŒ–ï¼ˆ10è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python"># 300Kã§ã®é€Ÿåº¦åˆ†å¸ƒã‚’è¨­å®š
temperature = 300  # K
MaxwellBoltzmannDistribution(atoms, temperature_K=temperature)

# é‹å‹•é‡ã‚’ã‚¼ãƒ­ã«ï¼ˆç³»å…¨ä½“ã®ä¸¦é€²ã‚’é™¤å»ï¼‰
from ase.md.velocitydistribution import Stationary
Stationary(atoms)

print(f&quot;Initial kinetic energy: {atoms.get_kinetic_energy():.3f} eV&quot;)
print(f&quot;Initial potential energy: {atoms.get_potential_energy():.3f} eV&quot;)
</code></pre>

<h3 id="md">MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ</h3>
<p><strong>Example 11: MDå®Ÿè¡Œã¨ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªä¿å­˜ï¼ˆ12è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">from ase.io.trajectory import Trajectory

# MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã®è¨­å®š
timestep = 0.5 * units.fs  # 0.5ãƒ•ã‚§ãƒ ãƒˆç§’
dyn = VelocityVerlet(atoms, timestep=timestep)

# ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
traj = Trajectory('aspirin_md.traj', 'w', atoms)
dyn.attach(traj.write, interval=10)  # 10ã‚¹ãƒ†ãƒƒãƒ—ã”ã¨ã«ä¿å­˜

# 10,000ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆ5ãƒ”ã‚³ç§’ï¼‰ã®MDå®Ÿè¡Œ
dyn.run(10000)
print(&quot;MD simulation completed!&quot;)
</code></pre>

<p><strong>è¨ˆç®—æ™‚é–“ã®ç›®å®‰</strong>:<br />
- CPUï¼ˆ4ã‚³ã‚¢ï¼‰: ç´„5åˆ†ï¼ˆ10,000ã‚¹ãƒ†ãƒƒãƒ—ï¼‰<br />
- DFTãªã‚‰: ç´„1é€±é–“ï¼ˆ10,000ã‚¹ãƒ†ãƒƒãƒ—ï¼‰<br />
- <strong>10â´å€ã®é«˜é€ŸåŒ–é”æˆï¼</strong></p>
<h3 id="_11">ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªã®è§£æ</h3>
<p><strong>Example 12: ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã¨RDFè¨ˆç®—ï¼ˆ15è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">from ase.io import read
import numpy as np

# ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªã®èª­ã¿è¾¼ã¿
traj_data = read('aspirin_md.traj', index=':')

# ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã®ç¢ºèª
energies = [a.get_total_energy() for a in traj_data]
plt.plot(energies)
plt.xlabel('Time step')
plt.ylabel('Total Energy (eV)')
plt.title('Energy Conservation Check')
plt.show()

# ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆï¼ˆå˜èª¿å¢—åŠ /æ¸›å°‘ï¼‰ã®è¨ˆç®—
drift = (energies[-1] - energies[0]) / len(energies)
print(f&quot;Energy drift: {drift:.6f} eV/step&quot;)
</code></pre>

<p><strong>è‰¯å¥½ãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®æŒ‡æ¨™</strong>:<br />
- ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆ: &lt; 0.001 eV/step<br />
- å…¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæ™‚é–“ã¨ã¨ã‚‚ã«æŒ¯å‹•ï¼ˆä¿å­˜å‰‡ï¼‰</p>
<hr />
<h2 id="36">3.6 ç‰©æ€§è¨ˆç®—ï¼šæŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨æ‹¡æ•£ä¿‚æ•°</h2>
<p>MLP-MDã‹ã‚‰ç‰©ç†çš„ãªç‰©æ€§å€¤ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>
<h3 id="_12">æŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆãƒ‘ãƒ¯ãƒ¼ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼‰</h3>
<p><strong>Example 13: æŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«è¨ˆç®—ï¼ˆ15è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">from scipy.fft import fft, fftfreq

# 1ã¤ã®åŸå­ã®é€Ÿåº¦æ™‚ç³»åˆ—ã‚’æŠ½å‡º
atom_idx = 0  # æœ€åˆã®åŸå­
velocities = np.array([a.get_velocities()[atom_idx] for a in traj_data])

# xæ–¹å‘é€Ÿåº¦ã®ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›
vx = velocities[:, 0]
freq = fftfreq(len(vx), d=timestep)
spectrum = np.abs(fft(vx))**2

# æ­£ã®å‘¨æ³¢æ•°ã®ã¿ãƒ—ãƒ­ãƒƒãƒˆ
mask = freq &gt; 0
plt.plot(freq[mask] * 1e15 / (2 * np.pi), spectrum[mask])  # Hz â†’ THzå¤‰æ›
plt.xlabel('Frequency (THz)')
plt.ylabel('Power Spectrum')
plt.title('Vibrational Spectrum')
plt.xlim(0, 100)
plt.show()
</code></pre>

<p><strong>è§£é‡ˆ</strong>:<br />
- ãƒ”ãƒ¼ã‚¯ãŒåˆ†å­ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã«å¯¾å¿œ<br />
- DFTã§è¨ˆç®—ã—ãŸæŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨æ¯”è¼ƒã™ã‚‹ã“ã¨ã§ç²¾åº¦æ¤œè¨¼</p>
<h3 id="msd">å¹³å‡äºŒä¹—å¤‰ä½ï¼ˆMSDï¼‰ã¨æ‹¡æ•£ä¿‚æ•°</h3>
<p><strong>Example 14: MSDè¨ˆç®—ï¼ˆ15è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python">def calculate_msd(traj, atom_idx=0):
    &quot;&quot;&quot;å¹³å‡äºŒä¹—å¤‰ä½ã‚’è¨ˆç®—&quot;&quot;&quot;
    positions = np.array([a.positions[atom_idx] for a in traj])
    msd = np.zeros(len(positions))

    for t in range(len(positions)):
        displacement = positions[t:] - positions[:-t or None]
        msd[t] = np.mean(np.sum(displacement**2, axis=1))

    return msd

# MSDè¨ˆç®—ã¨ãƒ—ãƒ­ãƒƒãƒˆ
msd = calculate_msd(traj_data)
time_ps = np.arange(len(msd)) * timestep / units.fs * 1e-3  # ãƒ”ã‚³ç§’

plt.plot(time_ps, msd)
plt.xlabel('Time (ps)')
plt.ylabel('MSD (Å²)')
plt.title('Mean Square Displacement')
plt.show()
</code></pre>

<p><strong>æ‹¡æ•£ä¿‚æ•°ã®è¨ˆç®—</strong>:</p>
<pre class="codehilite"><code class="language-python"># MSDã®ç·šå½¢é ˜åŸŸã‹ã‚‰æ‹¡æ•£ä¿‚æ•°ã‚’è¨ˆç®—ï¼ˆEinsteiné–¢ä¿‚å¼ï¼‰
# D = lim_{tâ†’âˆ} MSD(t) / (6t)
linear_region = slice(100, 500)
fit = np.polyfit(time_ps[linear_region], msd[linear_region], deg=1)
D = fit[0] / 6  # Å²/ps â†’ cmÂ²/så¤‰æ›ãŒå¿…è¦
print(f&quot;Diffusion coefficient: {D:.6f} Å²/ps&quot;)
</code></pre>

<hr />
<h2 id="37-active-learning">3.7 Active Learningï¼šåŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿è¿½åŠ </h2>
<p>ãƒ¢ãƒ‡ãƒ«ãŒä¸ç¢ºå®Ÿãªé…ç½®ã‚’è‡ªå‹•æ¤œå‡ºã—ã€DFTè¨ˆç®—ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
<h3 id="_13">ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ä¸ç¢ºå®Ÿæ€§ã®è©•ä¾¡</h3>
<p><strong>Example 15: äºˆæ¸¬ã®ä¸ç¢ºå®Ÿæ€§ï¼ˆ15è¡Œï¼‰</strong></p>
<pre class="codehilite"><code class="language-python"># è¤‡æ•°ã®ç‹¬ç«‹ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’è¨“ç·´ï¼ˆçœç•¥ï¼šExample 5ã‚’3å›å®Ÿè¡Œï¼‰
models = [model1, model2, model3]  # 3ã¤ã®ç‹¬ç«‹ãƒ¢ãƒ‡ãƒ«

def predict_with_uncertainty(atoms, models):
    &quot;&quot;&quot;ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«äºˆæ¸¬ã¨ä¸ç¢ºå®Ÿæ€§&quot;&quot;&quot;
    predictions = []
    for model in models:
        atoms.calc = spk_ase.SpkCalculator(model_file=model, device='cpu')
        predictions.append(atoms.get_potential_energy())

    mean = np.mean(predictions)
    std = np.std(predictions)
    return mean, std

# MDãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªã®å„é…ç½®ã§ä¸ç¢ºå®Ÿæ€§è©•ä¾¡
uncertainties = []
for atoms in traj_data[::100]:  # 100ãƒ•ãƒ¬ãƒ¼ãƒ ã”ã¨
    _, std = predict_with_uncertainty(atoms, models)
    uncertainties.append(std)

# ä¸ç¢ºå®Ÿæ€§ãŒé«˜ã„é…ç½®ã‚’ç‰¹å®š
threshold = np.percentile(uncertainties, 95)
high_uncertainty_frames = np.where(np.array(uncertainties) &gt; threshold)[0]
print(f&quot;High uncertainty frames: {high_uncertainty_frames}&quot;)
</code></pre>

<p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</strong>:<br />
- ä¸ç¢ºå®Ÿæ€§ã®é«˜ã„é…ç½®ã‚’DFTè¨ˆç®—ã«è¿½åŠ <br />
- ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æ›´æ–°ã—ã¦ãƒ¢ãƒ‡ãƒ«å†è¨“ç·´<br />
- ç²¾åº¦å‘ä¸Šã‚’ç¢ºèª</p>
<hr />
<h2 id="38">3.8 ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼šã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨å¯¾å‡¦æ³•</h2>
<p>å®Ÿè·µã§ã‚ˆãé­é‡ã™ã‚‹å•é¡Œã¨è§£æ±ºç­–ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚</p>
<table>
<thead>
<tr>
<th>ã‚¨ãƒ©ãƒ¼</th>
<th>åŸå› </th>
<th>å¯¾å‡¦æ³•</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Out of Memory (OOM)</strong></td>
<td>ãƒãƒƒãƒã‚µã‚¤ã‚ºãŒå¤§ãã™ãã‚‹</td>
<td><code>batch_size</code>ã‚’32â†’16â†’8ã¨æ¸›ã‚‰ã™</td>
</tr>
<tr>
<td><strong>Loss becomes NaN</strong></td>
<td>å­¦ç¿’ç‡ãŒé«˜ã™ãã‚‹</td>
<td><code>lr=1e-4</code>â†’<code>1e-5</code>ã«ä¸‹ã’ã‚‹</td>
</tr>
<tr>
<td><strong>Energy drift in MD</strong></td>
<td>ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ãŒå¤§ãã™ãã‚‹</td>
<td><code>timestep=0.5fs</code>â†’<code>0.25fs</code>ã«æ¸›ã‚‰ã™</td>
</tr>
<tr>
<td><strong>Poor generalization</strong></td>
<td>è¨“ç·´ãƒ‡ãƒ¼ã‚¿ãŒåã£ã¦ã„ã‚‹</td>
<td>Active Learningã§ãƒ‡ãƒ¼ã‚¿å¤šæ§˜åŒ–</td>
</tr>
<tr>
<td><strong>CUDA error</strong></td>
<td>GPUäº’æ›æ€§ã®å•é¡Œ</td>
<td>PyTorchã¨CUDAãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª</td>
</tr>
</tbody>
</table>
<h3 id="_14">ãƒ‡ãƒãƒƒã‚°ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h3>
<pre class="codehilite"><code class="language-python"># 1. å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã§ãƒ†ã‚¹ãƒˆ
data_module.num_train = 1000  # 1,000é…ç½®ã§ã‚¯ã‚¤ãƒƒã‚¯ãƒ†ã‚¹ãƒˆ

# 2. 1ãƒãƒƒãƒã§ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ç¢ºèª
trainer = pl.Trainer(max_epochs=100, overfit_batches=1)
# è¨“ç·´èª¤å·®ãŒ0ã«è¿‘ã¥ã‘ã°ã€ãƒ¢ãƒ‡ãƒ«ã«å­¦ç¿’èƒ½åŠ›ã‚ã‚Š

# 3. ã‚°ãƒ©ãƒ‡ã‚£ã‚¨ãƒ³ãƒˆã®ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°
task = AtomisticTask(..., gradient_clip_val=1.0)  # å‹¾é…çˆ†ç™ºé˜²æ­¢
</code></pre>

<hr />
<h2 id="39">3.9 æœ¬ç« ã®ã¾ã¨ã‚</h2>
<h3 id="_15">å­¦ã‚“ã ã“ã¨</h3>
<ol>
<li>
<p><strong>ç’°å¢ƒæ§‹ç¯‰</strong><br />
   - Condaç’°å¢ƒã€PyTorchã€SchNetPackã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«<br />
   - GPU/CPUç’°å¢ƒã®é¸æŠ</p>
</li>
<li>
<p><strong>ãƒ‡ãƒ¼ã‚¿æº–å‚™</strong><br />
   - MD17ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨èª­ã¿è¾¼ã¿<br />
   - è¨“ç·´/æ¤œè¨¼/ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã¸ã®åˆ†å‰²</p>
</li>
<li>
<p><strong>ãƒ¢ãƒ‡ãƒ«è¨“ç·´</strong><br />
   - SchNetã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®è¨­å®šï¼ˆ6å±¤ã€128æ¬¡å…ƒï¼‰<br />
   - 50ã‚¨ãƒãƒƒã‚¯ã®è¨“ç·´ï¼ˆCPU: 2-3æ™‚é–“ï¼‰<br />
   - TensorBoardã§ã®é€²æ—ç¢ºèª</p>
</li>
<li>
<p><strong>ç²¾åº¦æ¤œè¨¼</strong><br />
   - ã‚¨ãƒãƒ«ã‚®ãƒ¼MAE &lt; 1 kcal/molé”æˆã‚’ç¢ºèª<br />
   - äºˆæ¸¬å€¤vsçœŸå€¤ã®ç›¸é–¢ãƒ—ãƒ­ãƒƒãƒˆ<br />
   - RÂ² &gt; 0.99ã®é«˜ç²¾åº¦</p>
</li>
<li>
<p><strong>MLP-MDå®Ÿè¡Œ</strong><br />
   - ASE Calculatorã¨ã—ã¦ã®çµ±åˆ<br />
   - 10,000ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆ5ãƒ”ã‚³ç§’ï¼‰ã®MDå®Ÿè¡Œ<br />
   - DFTã‚ˆã‚Š10â´å€é«˜é€ŸåŒ–ã‚’ä½“é¨“</p>
</li>
<li>
<p><strong>ç‰©æ€§è¨ˆç®—</strong><br />
   - æŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼‰<br />
   - æ‹¡æ•£ä¿‚æ•°ï¼ˆå¹³å‡äºŒä¹—å¤‰ä½ã‹ã‚‰è¨ˆç®—ï¼‰</p>
</li>
<li>
<p><strong>Active Learning</strong><br />
   - ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ä¸ç¢ºå®Ÿæ€§ã«ã‚ˆã‚‹é…ç½®é¸æŠ<br />
   - ãƒ‡ãƒ¼ã‚¿è¿½åŠ ã®è‡ªå‹•åŒ–æˆ¦ç•¥</p>
</li>
</ol>
<h3 id="_16">é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>
<ul>
<li><strong>SchNetPackã¯å®Ÿè£…ãŒå®¹æ˜“</strong>: æ•°åè¡Œã®ã‚³ãƒ¼ãƒ‰ã§MLPè¨“ç·´ãŒå¯èƒ½</li>
<li><strong>å°è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ï¼ˆ10ä¸‡é…ç½®ï¼‰ã§å®Ÿç”¨ç²¾åº¦é”æˆ</strong>: MD17ã¯å„ªã‚ŒãŸãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</li>
<li><strong>MLP-MDã¯å®Ÿç”¨çš„</strong>: DFTã®10â´å€é«˜é€Ÿã€å€‹äººã®PCã§å®Ÿè¡Œå¯èƒ½</li>
<li><strong>Active Learningã§åŠ¹ç‡åŒ–</strong>: é‡è¦ãªé…ç½®ã‚’è‡ªå‹•ç™ºè¦‹ã€ãƒ‡ãƒ¼ã‚¿åé›†ã‚³ã‚¹ãƒˆå‰Šæ¸›</li>
</ul>
<h3 id="_17">æ¬¡ã®ç« ã¸</h3>
<p>ç¬¬4ç« ã§ã¯ã€æœ€æ–°ã®MLPæ‰‹æ³•ï¼ˆNequIPã€MACEï¼‰ã¨å®Ÿéš›ã®ç ”ç©¶å¿œç”¨ä¾‹ã‚’å­¦ã³ã¾ã™ï¼š<br />
- E(3)ç­‰å¤‰ã‚°ãƒ©ãƒ•ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ç†è«–<br />
- ãƒ‡ãƒ¼ã‚¿åŠ¹ç‡ã®åŠ‡çš„å‘ä¸Šï¼ˆ10ä¸‡â†’3,000é…ç½®ï¼‰<br />
- è§¦åª’åå¿œã€ãƒãƒƒãƒ†ãƒªãƒ¼ææ–™ã¸ã®å¿œç”¨äº‹ä¾‹<br />
- å¤§è¦æ¨¡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ100ä¸‡åŸå­ï¼‰ã®å®Ÿç¾</p>
<hr />
<h2 id="_18">æ¼”ç¿’å•é¡Œ</h2>
<h3 id="1easy">å•é¡Œ1ï¼ˆé›£æ˜“åº¦ï¼šeasyï¼‰</h3>
<p>Example 4ã®SchNetè¨­å®šã§ã€<code>n_interactions</code>ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°å±¤ã®æ•°ï¼‰ã‚’3, 6, 9ã«å¤‰ãˆã¦è¨“ç·´ã—ã€ãƒ†ã‚¹ãƒˆMAEãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹äºˆæ¸¬ã—ã¦ãã ã•ã„ã€‚</p>
<details>
<summary>ãƒ’ãƒ³ãƒˆ</summary>

å±¤ãŒæ·±ã„ã»ã©ã€é•·è·é›¢ã®åŸå­é–“ç›¸äº’ä½œç”¨ã‚’æ‰ãˆã‚‰ã‚Œã¾ã™ã€‚ã—ã‹ã—ã€æ·±ã™ãã‚‹ã¨éå­¦ç¿’ã®ãƒªã‚¹ã‚¯ã‚‚ã€‚

</details>

<details>
<summary>è§£ç­”ä¾‹</summary>

**äºˆæ¸¬ã•ã‚Œã‚‹çµæœ**:

| `n_interactions` | ãƒ†ã‚¹ãƒˆMAEäºˆæ¸¬ | è¨“ç·´æ™‚é–“ | ç‰¹å¾´ |
|-----------------|-------------|---------|------|
| **3** | 0.8-1.2 kcal/mol | 1æ™‚é–“ | æµ…ã„ãŸã‚é•·è·é›¢ç›¸äº’ä½œç”¨ã‚’æ‰ãˆãã‚Œãªã„ |
| **6** | 0.5-0.8 kcal/mol | 2-3æ™‚é–“ | ãƒãƒ©ãƒ³ã‚¹ãŒè‰¯ã„ï¼ˆæ¨å¥¨ï¼‰ |
| **9** | 0.6-1.0 kcal/mol | 4-5æ™‚é–“ | éå­¦ç¿’ãƒªã‚¹ã‚¯ã€è¨“ç·´ãƒ‡ãƒ¼ã‚¿ä¸è¶³ãªã‚‰ç²¾åº¦ä½ä¸‹ |

**å®Ÿé¨“æ–¹æ³•**:

<pre class="codehilite"><code class="language-python">for n in [3, 6, 9]:
    representation = SchNet(n_interactions=n, ...)
    task = AtomisticTask(...)
    trainer.fit(task, datamodule=data_module)
    results = trainer.test(task, datamodule=data_module)
    print(f&quot;n={n}: MAE={results[0]['test_energy_MAE']:.4f} eV&quot;)
</code></pre>



**çµè«–**: å°åˆ†å­ï¼ˆã‚¢ã‚¹ãƒ”ãƒªãƒ³21åŸå­ï¼‰ã§ã¯`n_interactions=6`ãŒæœ€é©ã€‚å¤§è¦æ¨¡ç³»ï¼ˆ100åŸå­ä»¥ä¸Šï¼‰ã§ã¯9-12å±¤ãŒæœ‰åŠ¹ãªå ´åˆã‚‚ã‚ã‚‹ã€‚

</details>

<h3 id="2medium">å•é¡Œ2ï¼ˆé›£æ˜“åº¦ï¼šmediumï¼‰</h3>
<p>Example 11ã®MLP-MDã§ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆãŒè¨±å®¹ç¯„å›²ã‚’è¶…ãˆãŸå ´åˆï¼ˆä¾‹: 0.01 eV/stepï¼‰ã€ã©ã®ã‚ˆã†ãªå¯¾å‡¦æ³•ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã‹ï¼Ÿ3ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</p>
<details>
<summary>ãƒ’ãƒ³ãƒˆ</summary>

ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ã€è¨“ç·´ç²¾åº¦ã€MDã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®3ã¤ã®è¦³ç‚¹ã‹ã‚‰è€ƒãˆã¾ã—ã‚‡ã†ã€‚

</details>

<details>
<summary>è§£ç­”ä¾‹</summary>

**å¯¾å‡¦æ³•1: ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ã‚’å°ã•ãã™ã‚‹**

<pre class="codehilite"><code class="language-python">timestep = 0.25 * units.fs  # 0.5fs â†’ 0.25fsã«åŠæ¸›
dyn = VelocityVerlet(atoms, timestep=timestep)
</code></pre>


- **ç†ç”±**: å°ã•ã„ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ã¯æ•°å€¤ç©åˆ†ã®èª¤å·®ã‚’æ¸›ã‚‰ã™
- **ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**: 2å€ã®è¨ˆç®—æ™‚é–“

**å¯¾å‡¦æ³•2: ãƒ¢ãƒ‡ãƒ«è¨“ç·´ç²¾åº¦ã‚’å‘ä¸Š**

<pre class="codehilite"><code class="language-python"># ã‚ˆã‚Šå¤šãã®ãƒ‡ãƒ¼ã‚¿ã§è¨“ç·´
data_module.num_train = 200000  # 10ä¸‡â†’20ä¸‡é…ç½®ã«å¢—åŠ 

# ã¾ãŸã¯åŠ›ã®æå¤±é–¢æ•°ã®é‡ã¿ã‚’å¢—ã‚„ã™
task = AtomisticTask(..., loss_weights={'energy': 1.0, 'forces': 1000})
</code></pre>


- **ç†ç”±**: åŠ›ã®äºˆæ¸¬ç²¾åº¦ãŒä½ã„ã¨MDãŒä¸å®‰å®š
- **ç›®æ¨™**: åŠ›ã®MAE < 0.05 eV/Ã…

**å¯¾å‡¦æ³•3: Langevinå‹•åŠ›å­¦ã«å¤‰æ›´ï¼ˆç†±æµ´çµåˆï¼‰**

<pre class="codehilite"><code class="language-python">from ase.md.langevin import Langevin
dyn = Langevin(atoms, timestep=0.5*units.fs,
               temperature_K=300, friction=0.01)
</code></pre>


- **ç†ç”±**: ç†±æµ´ãŒã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆã‚’å¸å
- **æ³¨æ„**: å³å¯†ãªå¾®å°æ­£æº–ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ï¼ˆNVEï¼‰ã§ã¯ãªããªã‚‹

**å„ªå…ˆé †ä½**: å¯¾å‡¦æ³•2ï¼ˆç²¾åº¦å‘ä¸Šï¼‰â†’ å¯¾å‡¦æ³•1ï¼ˆã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ï¼‰â†’ å¯¾å‡¦æ³•3ï¼ˆLangevinï¼‰

</details>

<hr />
<h2 id="310">3.10 ãƒ‡ãƒ¼ã‚¿ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¨å†ç¾æ€§</h2>

<p>æœ¬ç« ã®ãƒãƒ³ã‚ºã‚ªãƒ³ã‚³ãƒ¼ãƒ‰ã‚’å†ç¾ã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã¨ãƒ„ãƒ¼ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚</p>

<h3 id="3101">3.10.1 ä½¿ç”¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</h3>

<table>
<thead>
<tr>
<th>ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ</th>
<th>èª¬æ˜</th>
<th>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</th>
<th>ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>MD17</strong></td>
<td>å°åˆ†å­MDè»Œé“ï¼ˆã‚¢ã‚¹ãƒ”ãƒªãƒ³ã€ãƒ™ãƒ³ã‚¼ãƒ³ãªã©10ç¨®é¡ï¼‰</td>
<td>CC0 1.0 (Public Domain)</td>
<td>SchNetPackå†…è”µ (<code>MD17(molecule='aspirin')</code>)</td>
</tr>
<tr>
<td><strong>ã‚¢ã‚¹ãƒ”ãƒªãƒ³åˆ†å­</strong></td>
<td>211,762é…ç½®ã€DFTï¼ˆPBE/def2-SVPï¼‰</td>
<td>CC0 1.0</td>
<td><a href="http://sgdml.org/#datasets">sgdml.org</a></td>
</tr>
</tbody>
</table>

<p><strong>æ³¨æ„äº‹é …</strong>:<br />
- <strong>å•†ç”¨åˆ©ç”¨</strong>: CC0ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã«ã‚ˆã‚Šã€å•†ç”¨åˆ©ç”¨ãƒ»æ”¹å¤‰ãƒ»å†é…å¸ƒã™ã¹ã¦è‡ªç”±<br />
- <strong>è«–æ–‡å¼•ç”¨</strong>: MD17ä½¿ç”¨æ™‚ã¯ä»¥ä¸‹ã‚’å¼•ç”¨<br />
  Chmiela, S., et al. (2017). "Machine learning of accurate energy-conserving molecular force fields." <em>Science Advances</em>, 3(5), e1603015.<br />
- <strong>ãƒ‡ãƒ¼ã‚¿å®Œå…¨æ€§</strong>: SchNetPackã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½ã¯SHA256ãƒã‚§ãƒƒã‚¯ã‚µãƒ ã§æ¤œè¨¼</p>

<h3 id="3102">3.10.2 ã‚³ãƒ¼ãƒ‰å†ç¾æ€§ã®ãŸã‚ã®ç’°å¢ƒæƒ…å ±</h3>

<p>æœ¬ç« ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’æ­£ç¢ºã«å†ç¾ã™ã‚‹ãŸã‚ã«ã€ä»¥ä¸‹ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚</p>

<table>
<thead>
<tr>
<th>ãƒ„ãƒ¼ãƒ«</th>
<th>æ¨å¥¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
<th>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰</th>
<th>äº’æ›æ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Python</strong></td>
<td>3.10.x</td>
<td><code>conda create -n mlp python=3.10</code></td>
<td>3.9-3.11ã§å‹•ä½œç¢ºèªæ¸ˆã¿</td>
</tr>
<tr>
<td><strong>PyTorch</strong></td>
<td>2.1.0</td>
<td><code>conda install pytorch=2.1.0</code></td>
<td>2.0ä»¥ä¸Šå¿…é ˆ</td>
</tr>
<tr>
<td><strong>SchNetPack</strong></td>
<td>2.0.3</td>
<td><code>pip install schnetpack==2.0.3</code></td>
<td>2.0ç³»ã¨1.xç³»ã§APIãŒç•°ãªã‚‹</td>
</tr>
<tr>
<td><strong>ASE</strong></td>
<td>3.22.1</td>
<td><code>pip install ase==3.22.1</code></td>
<td>3.20ä»¥ä¸Šæ¨å¥¨</td>
</tr>
<tr>
<td><strong>PyTorch Lightning</strong></td>
<td>2.1.0</td>
<td><code>pip install pytorch-lightning==2.1.0</code></td>
<td>SchNetPack 2.0.3ã¨äº’æ›</td>
</tr>
<tr>
<td><strong>NumPy</strong></td>
<td>1.24.3</td>
<td><code>pip install numpy==1.24.3</code></td>
<td>1.20ä»¥ä¸Š</td>
</tr>
<tr>
<td><strong>Matplotlib</strong></td>
<td>3.7.1</td>
<td><code>pip install matplotlib==3.7.1</code></td>
<td>3.5ä»¥ä¸Š</td>
</tr>
</tbody>
</table>

<p><strong>ç’°å¢ƒãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜</strong>:</p>
<pre class="codehilite"><code class="language-bash"># ç¾åœ¨ã®ç’°å¢ƒã‚’å†ç¾å¯èƒ½ãªå½¢ã§ä¿å­˜
conda env export > environment.yml

# ä»–ã®ç’°å¢ƒã§å†ç¾
conda env create -f environment.yml
</code></pre>

<p><strong>Dockerã«ã‚ˆã‚‹å†ç¾æ€§ç¢ºä¿</strong>ï¼ˆæ¨å¥¨ï¼‰:</p>
<pre class="codehilite"><code class="language-dockerfile"># Dockerfileä¾‹
FROM pytorch/pytorch:2.1.0-cuda11.8-cudnn8-runtime
RUN pip install schnetpack==2.0.3 ase==3.22.1 pytorch-lightning==2.1.0
</code></pre>

<h3 id="3103">3.10.3 è¨“ç·´ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å®Œå…¨è¨˜éŒ²</h3>

<p>Example 4, 5ã§ä½¿ç”¨ã—ãŸãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å…¨è¨˜éŒ²ï¼ˆè«–æ–‡å†ç¾ç”¨ï¼‰:</p>

<table>
<thead>
<tr>
<th>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</th>
<th>å€¤</th>
<th>èª¬æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>n_atom_basis</code></td>
<td>128</td>
<td>åŸå­ç‰¹å¾´ãƒ™ã‚¯ãƒˆãƒ«ã®æ¬¡å…ƒ</td>
</tr>
<tr>
<td><code>n_interactions</code></td>
<td>6</td>
<td>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒƒã‚·ãƒ³ã‚°å±¤ã®æ•°</td>
</tr>
<tr>
<td><code>cutoff</code></td>
<td>5.0 Ã…</td>
<td>åŸå­é–“ç›¸äº’ä½œç”¨ã®ã‚«ãƒƒãƒˆã‚ªãƒ•åŠå¾„</td>
</tr>
<tr>
<td><code>n_filters</code></td>
<td>128</td>
<td>ç•³ã¿è¾¼ã¿ãƒ•ã‚£ãƒ«ã‚¿ã®æ•°</td>
</tr>
<tr>
<td><code>batch_size</code></td>
<td>32</td>
<td>ãƒŸãƒ‹ãƒãƒƒãƒã‚µã‚¤ã‚º</td>
</tr>
<tr>
<td><code>learning_rate</code></td>
<td>1e-4</td>
<td>åˆæœŸå­¦ç¿’ç‡ï¼ˆAdamWï¼‰</td>
</tr>
<tr>
<td><code>max_epochs</code></td>
<td>50</td>
<td>æœ€å¤§è¨“ç·´ã‚¨ãƒãƒƒã‚¯æ•°</td>
</tr>
<tr>
<td><code>num_train</code></td>
<td>100,000</td>
<td>è¨“ç·´ãƒ‡ãƒ¼ã‚¿æ•°</td>
</tr>
<tr>
<td><code>num_val</code></td>
<td>10,000</td>
<td>æ¤œè¨¼ãƒ‡ãƒ¼ã‚¿æ•°</td>
</tr>
<tr>
<td><code>num_test</code></td>
<td>10,000</td>
<td>ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿æ•°</td>
</tr>
<tr>
<td><code>random_seed</code></td>
<td>42</td>
<td>ä¹±æ•°ã‚·ãƒ¼ãƒ‰ï¼ˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²ã®å†ç¾æ€§ï¼‰</td>
</tr>
</tbody>
</table>

<p><strong>å®Œå…¨ãªå†ç¾ã‚³ãƒ¼ãƒ‰</strong>:</p>
<pre class="codehilite"><code class="language-python">import torch
torch.manual_seed(42)  # å†ç¾æ€§ç¢ºä¿

representation = SchNet(
    n_atom_basis=128, n_interactions=6, cutoff=5.0, n_filters=128
)
task = AtomisticTask(
    model=AtomisticModel(representation, [output]),
    optimizer_cls=torch.optim.AdamW,
    optimizer_args={'lr': 1e-4, 'weight_decay': 0.01}
)
trainer = pl.Trainer(max_epochs=50, deterministic=True)
</code></pre>

<h3 id="3104">3.10.4 ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»åŠ›ã®å˜ä½æ›ç®—è¡¨</h3>

<p>æœ¬ç« ã§ä½¿ç”¨ã™ã‚‹ç‰©ç†é‡ã®å˜ä½æ›ç®—ï¼ˆSchNetPackã¨ASEã®æ¨™æº–å˜ä½ï¼‰:</p>

<table>
<thead>
<tr>
<th>ç‰©ç†é‡</th>
<th>SchNetPack/ASE</th>
<th>eV</th>
<th>kcal/mol</th>
<th>Hartree</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong></td>
<td>eV</td>
<td>1.0</td>
<td>23.06</td>
<td>0.03674</td>
</tr>
<tr>
<td><strong>åŠ›</strong></td>
<td>eV/Ã…</td>
<td>1.0</td>
<td>23.06</td>
<td>0.01945</td>
</tr>
<tr>
<td><strong>è·é›¢</strong></td>
<td>Ã…</td>
<td>-</td>
<td>-</td>
<td>1.889726 Bohr</td>
</tr>
<tr>
<td><strong>æ™‚é–“</strong></td>
<td>fs (ãƒ•ã‚§ãƒ ãƒˆç§’)</td>
<td>-</td>
<td>-</td>
<td>0.02419 a.u.</td>
</tr>
</tbody>
</table>

<p><strong>å˜ä½å¤‰æ›ä¾‹</strong>:</p>
<pre class="codehilite"><code class="language-python">from ase import units

# ã‚¨ãƒãƒ«ã‚®ãƒ¼æ›ç®—
energy_ev = 1.0  # eV
energy_kcal = energy_ev * 23.06052  # kcal/mol
energy_hartree = energy_ev * 0.036749  # Hartree

# ASEã®å˜ä½å®šæ•°ã‚’ä½¿ç”¨ï¼ˆæ¨å¥¨ï¼‰
print(f"{energy_ev} eV = {energy_ev * units.eV / units.kcal * units.mol} kcal/mol")
</code></pre>

<hr />
<h2 id="311">3.11 å®Ÿè·µä¸Šã®æ³¨æ„ç‚¹ï¼šãƒãƒ³ã‚ºã‚ªãƒ³ã§ã®å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³</h2>

<h3 id="3111">3.11.1 ç’°å¢ƒæ§‹ç¯‰ã¨ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®è½ã¨ã—ç©´</h3>

<details>
<summary><strong>å¤±æ•—1: PyTorchã¨CUDAãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ä¸ä¸€è‡´</strong></summary>

<p><strong>å•é¡Œ</strong>:</p>
<pre class="codehilite"><code>RuntimeError: CUDA error: no kernel image is available for execution on the device
</code></pre>

<p><strong>åŸå› </strong>:<br />
PyTorch 2.1.0ã¯CUDA 11.8ã¾ãŸã¯12.1ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦ã„ã‚‹ãŒã€ã‚·ã‚¹ãƒ†ãƒ ã®CUDAãŒ10.2ãªã©å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³</p>

<p><strong>è¨ºæ–­ã‚³ãƒ¼ãƒ‰</strong>:</p>
<pre class="codehilite"><code class="language-python">import torch
print(f"PyTorch version: {torch.__version__}")
print(f"CUDA available: {torch.cuda.is_available()}")
print(f"CUDA version (PyTorch): {torch.version.cuda}")

# ã‚·ã‚¹ãƒ†ãƒ CUDAãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèªï¼ˆã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼‰
# nvcc --version
</code></pre>

<p><strong>å¯¾å‡¦æ³•</strong>:</p>
<pre class="codehilite"><code class="language-bash"># ã‚·ã‚¹ãƒ†ãƒ CUDA 11.8ã®å ´åˆ
conda install pytorch==2.1.0 pytorch-cuda=11.8 -c pytorch -c nvidia

# CUDAåˆ©ç”¨ä¸å¯ã®å ´åˆã¯CPUç‰ˆã«åˆ‡ã‚Šæ›¿ãˆ
conda install pytorch==2.1.0 cpuonly -c pytorch
</code></pre>

<p><strong>äºˆé˜²ç­–</strong>:<br />
ç’°å¢ƒæ§‹ç¯‰å‰ã« <code>nvidia-smi</code> ã§GPUãƒ‰ãƒ©ã‚¤ãƒã¨CUDAãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹</p>

</details>

<details>
<summary><strong>å¤±æ•—2: SchNetPack 1.x ã¨ 2.x ã®APIæ··åŒ</strong></summary>

<p><strong>å•é¡Œ</strong>:</p>
<pre class="codehilite"><code>AttributeError: module 'schnetpack' has no attribute 'AtomsData'
</code></pre>

<p><strong>åŸå› </strong>:<br />
SchNetPack 1.xç³»ã®å¤ã„ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’2.xç³»ã§å®Ÿè¡Œ</p>

<p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç¢ºèª</strong>:</p>
<pre class="codehilite"><code class="language-python">import schnetpack as spk
print(spk.__version__)  # 2.0.3ãªã‚‰æœ¬ç« ã®ã‚³ãƒ¼ãƒ‰ãŒå‹•ä½œ
</code></pre>

<p><strong>ä¸»ãªAPIå¤‰æ›´</strong>:</p>
<table>
<thead>
<tr>
<th>SchNetPack 1.x</th>
<th>SchNetPack 2.x</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>spk.AtomsData</code></td>
<td><code>spk.data.AtomsDataModule</code></td>
</tr>
<tr>
<td><code>spk.atomistic.Atomwise</code></td>
<td><code>spk.task.ModelOutput</code></td>
</tr>
<tr>
<td><code>spk.train.Trainer</code></td>
<td><code>pytorch_lightning.Trainer</code></td>
</tr>
</tbody>
</table>

<p><strong>å¯¾å‡¦æ³•</strong>:<br />
æœ¬ç« ã®ã‚³ãƒ¼ãƒ‰ä¾‹ï¼ˆ2.xç³»ï¼‰ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€SchNetPackå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ<a href="https://schnetpack.readthedocs.io">schnetpack.readthedocs.io</a>ï¼‰ã®2.xç³»ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’å‚ç…§</p>

</details>

<details>
<summary><strong>å¤±æ•—3: ãƒ¡ãƒ¢ãƒªä¸è¶³ï¼ˆOOMï¼‰ã®èª¤è¨ºæ–­</strong></summary>

<p><strong>å•é¡Œ</strong>:</p>
<pre class="codehilite"><code>RuntimeError: CUDA out of memory. Tried to allocate 1.50 GiB
</code></pre>

<p><strong>ã‚ˆãã‚ã‚‹èª¤è§£</strong>:<br />
ã€ŒGPUãƒ¡ãƒ¢ãƒªä¸è¶³ãªã®ã§GPUã‚’è²·ã„æ›¿ãˆã‚‹å¿…è¦ãŒã‚ã‚‹ã€â†’ <strong>é–“é•ã„</strong></p>

<p><strong>è¨ºæ–­æ‰‹é †</strong>:</p>
<pre class="codehilite"><code class="language-python"># 1. ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’ç¢ºèª
print(f"Current batch size: {data_module.batch_size}")

# 2. GPUãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’ç¢ºèª
if torch.cuda.is_available():
    print(f"GPU memory allocated: {torch.cuda.memory_allocated() / 1e9:.2f} GB")
    print(f"GPU memory reserved: {torch.cuda.memory_reserved() / 1e9:.2f} GB")
</code></pre>

<p><strong>å¯¾å‡¦æ³•ï¼ˆå„ªå…ˆé †ï¼‰</strong>:</p>
<ol>
<li><strong>ãƒãƒƒãƒã‚µã‚¤ã‚ºã‚’æ¸›ã‚‰ã™</strong>: <code>batch_size=32</code> â†’ <code>16</code> â†’ <code>8</code> â†’ <code>4</code></li>
<li><strong>å‹¾é…ç´¯ç©</strong>: å°ãƒãƒƒãƒã‚’è¤‡æ•°å›ç´¯ç©ã—ã¦ç–‘ä¼¼çš„ã«å¤§ãƒãƒƒãƒ</li>
</ol>
<pre class="codehilite"><code class="language-python">trainer = pl.Trainer(accumulate_grad_batches=4)  # 4ãƒãƒƒãƒã”ã¨ã«æ›´æ–°
</code></pre>

<ol start="3">
<li><strong>Mixed Precisionè¨“ç·´</strong>: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’åŠæ¸›</li>
</ol>
<pre class="codehilite"><code class="language-python">trainer = pl.Trainer(precision=16)  # float16ä½¿ç”¨
</code></pre>

<p><strong>ç›®å®‰</strong>:<br />
- GPU 4GB: batch_size=4-8<br />
- GPU 8GB: batch_size=16-32<br />
- GPU 24GB: batch_size=64-128</p>

</details>

<h3 id="3112">3.11.2 è¨“ç·´ã¨ãƒ‡ãƒãƒƒã‚°ã®è½ã¨ã—ç©´</h3>

<details>
<summary><strong>å¤±æ•—4: è¨“ç·´èª¤å·®ãŒæ¸›å°‘ã—ãªã„ï¼ˆNaNæå¤±ï¼‰</strong></summary>

<p><strong>å•é¡Œ</strong>:</p>
<pre class="codehilite"><code>Epoch 5: train_loss=nan, val_loss=nan
</code></pre>

<p><strong>åŸå› ãƒˆãƒƒãƒ—3</strong>:</p>
<ol>
<li><strong>å­¦ç¿’ç‡ãŒé«˜ã™ãã‚‹</strong>: å‹¾é…çˆ†ç™º â†’ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒNaNã«</li>
<li><strong>ãƒ‡ãƒ¼ã‚¿æ­£è¦åŒ–ã®æ¬ å¦‚</strong>: ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®çµ¶å¯¾å€¤ãŒå¤§ãã™ãã‚‹ï¼ˆä¾‹: -1000 eVï¼‰</li>
<li><strong>åŠ›ã®æå¤±ä¿‚æ•°ãŒä¸é©åˆ‡</strong>: åŠ›ã®æå¤±ãŒæ”¯é…çš„ã™ãã‚‹</li>
</ol>

<p><strong>è¨ºæ–­ã‚³ãƒ¼ãƒ‰</strong>:</p>
<pre class="codehilite"><code class="language-python"># è¨“ç·´é–‹å§‹ç›´å¾Œã«ãƒ¢ãƒ‡ãƒ«ã®å‡ºåŠ›ã‚’ç¢ºèª
for batch in data_module.train_dataloader():
    output = task.model(batch)
    print(f"Energy prediction: {output['energy'][:5]}")  # æœ€åˆã®5ã‚µãƒ³ãƒ—ãƒ«
    print(f"Energy target: {batch['energy'][:5]}")
    break

# NaNãƒã‚§ãƒƒã‚¯
print(f"Has NaN in prediction: {torch.isnan(output['energy']).any()}")
</code></pre>

<p><strong>å¯¾å‡¦æ³•</strong>:</p>
<ol>
<li><strong>å­¦ç¿’ç‡ã‚’ä¸‹ã’ã‚‹</strong>:</li>
</ol>
<pre class="codehilite"><code class="language-python">optimizer_args={'lr': 1e-5}  # 1e-4 â†’ 1e-5ã«æ¸›å°‘
</code></pre>

<ol start="2">
<li><strong>å‹¾é…ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°</strong>:</li>
</ol>
<pre class="codehilite"><code class="language-python">trainer = pl.Trainer(gradient_clip_val=1.0)  # å‹¾é…ãƒãƒ«ãƒ ã‚’1.0ä»¥ä¸‹ã«
</code></pre>

<ol start="3">
<li><strong>ãƒ‡ãƒ¼ã‚¿æ­£è¦åŒ–</strong>ï¼ˆSchNetPack 2.xã¯è‡ªå‹•ã ãŒã€æ‰‹å‹•ç¢ºèªï¼‰:</li>
</ol>
<pre class="codehilite"><code class="language-python">import schnetpack.transform as trn
data_module.train_transforms = [
    trn.SubtractCenterOfMass(),
    trn.RemoveOffsets('energy', remove_mean=True)  # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚ªãƒ•ã‚»ãƒƒãƒˆé™¤å»
]
</code></pre>

</details>

<details>
<summary><strong>å¤±æ•—5: éå­¦ç¿’ã®è¦‹é€ƒã—</strong></summary>

<p><strong>å•é¡Œ</strong>:<br />
è¨“ç·´èª¤å·®ã¯æ¸›å°‘ã™ã‚‹ãŒã€æ¤œè¨¼èª¤å·®ãŒåœæ»ã¾ãŸã¯å¢—åŠ </p>

<pre class="codehilite"><code>Epoch 30: train_loss=0.001, val_loss=0.050  # val_lossãŒæ‚ªåŒ–
</code></pre>

<p><strong>åŸå› </strong>:<br />
ãƒ¢ãƒ‡ãƒ«ãŒè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’è¨˜æ†¶ã—ã€æœªçŸ¥ãƒ‡ãƒ¼ã‚¿ã¸ã®æ±åŒ–æ€§èƒ½ãŒä½ä¸‹</p>

<p><strong>è¨ºæ–­ã‚°ãƒ©ãƒ•</strong>:</p>
<pre class="codehilite"><code class="language-python">import matplotlib.pyplot as plt
import pandas as pd

metrics = pd.read_csv('./training/lightning_logs/version_0/metrics.csv')
plt.plot(metrics['epoch'], metrics['train_loss'], label='Train')
plt.plot(metrics['epoch'], metrics['val_loss'], label='Validation')
plt.xlabel('Epoch')
plt.ylabel('Loss')
plt.legend()
plt.show()
</code></pre>

<p><strong>å¯¾å‡¦æ³•</strong>:</p>
<ol>
<li><strong>Early Stopping</strong>ï¼ˆè‡ªå‹•åœæ­¢ï¼‰:</li>
</ol>
<pre class="codehilite"><code class="language-python">from pytorch_lightning.callbacks import EarlyStopping

early_stop = EarlyStopping(monitor='val_loss', patience=10, mode='min')
trainer = pl.Trainer(callbacks=[early_stop])
</code></pre>

<ol start="2">
<li><strong>ãƒ‡ãƒ¼ã‚¿å¢—å¼·</strong>ï¼ˆè¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‚’å¢—ã‚„ã™ï¼‰:</li>
</ol>
<pre class="codehilite"><code class="language-python">data_module.num_train = 200000  # 10ä¸‡ â†’ 20ä¸‡ã«å¢—åŠ 
</code></pre>

<ol start="3">
<li><strong>Dropoutï¼ˆéæ¨å¥¨ã€MLPã§ã¯åŠ¹æœè–„ã„ï¼‰</strong>: ä»£ã‚ã‚Šã«ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°ã‚’æ¸›ã‚‰ã™</li>
</ol>
<pre class="codehilite"><code class="language-python">representation = SchNet(n_atom_basis=64, n_interactions=4)  # 128â†’64ã«å‰Šæ¸›
</code></pre>

</details>

<h3 id="3113">3.11.3 MLP-MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®è½ã¨ã—ç©´</h3>

<details>
<summary><strong>å¤±æ•—6: ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆã®éå°è©•ä¾¡</strong></summary>

<p><strong>å•é¡Œ</strong>:<br />
MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ã«ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå˜èª¿å¢—åŠ /æ¸›å°‘ï¼ˆä¿å­˜å‰‡ã®ç ´ã‚Œï¼‰</p>

<p><strong>è¨±å®¹ç¯„å›²ã®èª¤è§£</strong>:</p>
<ul>
<li>ã€Œå°‘ã—ãã‚‰ã„ã®ãƒ‰ãƒªãƒ•ãƒˆã¯ä»•æ–¹ãªã„ã€â†’ <strong>å±é™º</strong></li>
<li>0.01 eV/stepã®ãƒ‰ãƒªãƒ•ãƒˆã§ã‚‚ã€10,000ã‚¹ãƒ†ãƒƒãƒ—ã§100 eVã®ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰åŒ–ï¼ˆéç¾å®Ÿçš„ï¼‰</li>
</ul>

<p><strong>å®šé‡è¨ºæ–­</strong>:</p>
<pre class="codehilite"><code class="language-python">from ase.io import read

traj = read('aspirin_md.traj', index=':')
energies = [a.get_total_energy() for a in traj]

# ãƒ‰ãƒªãƒ•ãƒˆã®è¨ˆç®—ï¼ˆç·šå½¢ãƒ•ã‚£ãƒƒãƒˆï¼‰
import numpy as np
time_steps = np.arange(len(energies))
drift_rate, offset = np.polyfit(time_steps, energies, deg=1)
print(f"Energy drift: {drift_rate:.6f} eV/step")

# è¨±å®¹ç¯„å›²ãƒã‚§ãƒƒã‚¯
if abs(drift_rate) > 0.001:
    print("âš ï¸ WARNING: Excessive energy drift detected!")
</code></pre>

<p><strong>å¯¾å‡¦æ³•ï¼ˆå•é¡Œ2ã®è©³ç´°ç‰ˆï¼‰</strong>:</p>
<ol>
<li><strong>åŠ›ã®è¨“ç·´ç²¾åº¦ã‚’å‘ä¸Š</strong>ï¼ˆæœ€é‡è¦ï¼‰:</li>
</ol>
<pre class="codehilite"><code class="language-python"># åŠ›ã®æå¤±é–¢æ•°ã®é‡ã¿ã‚’å¤§å¹…ã«å¢—åŠ 
task = AtomisticTask(
    loss_weights={'energy': 0.01, 'forces': 0.99}  # åŠ›ã«99%ã®é‡ã¿
)
</code></pre>

<ol start="2">
<li><strong>ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ã®æœ€é©åŒ–</strong>:</li>
</ol>
<pre class="codehilite"><code class="language-bash"># å®‰å®šæ€§ãƒ†ã‚¹ãƒˆ
for dt in [0.1, 0.25, 0.5, 1.0]:  # fs
    # dt=0.5ã§å®‰å®šã€dt=1.0ã§ç™ºæ•£ãªã‚‰ã€dt=0.5ã‚’æ¡ç”¨
</code></pre>

<ol start="3">
<li><strong>MLPç²¾åº¦ã®é™ç•Œã‚’èªè­˜</strong>:<br />
åŠ›ã®MAE > 0.1 eV/Ã…ã®å ´åˆã€é•·æ™‚é–“MDï¼ˆ>10 psï¼‰ã¯ä¿¡é ¼æ€§ä½ä¸‹<br />
â†’ Active Learningã§è¨“ç·´ãƒ‡ãƒ¼ã‚¿è¿½åŠ </li>
</ol>

</details>

<details>
<summary><strong>å¤±æ•—7: MDçµæœã®ç‰©ç†çš„å¦¥å½“æ€§ã®æœªæ¤œè¨¼</strong></summary>

<p><strong>å•é¡Œ</strong>:<br />
ã€ŒMDãŒå®Œèµ°ã—ãŸã‹ã‚‰æˆåŠŸã€ã¨èª¤è§£ â†’ å®Ÿã¯éç‰©ç†çš„ãªæ§‹é€ å¤‰åŒ–</p>

<p><strong>æ¤œè¨¼ã™ã¹ãé …ç›®</strong>:</p>

<p><strong>1. æ¸©åº¦åˆ¶å¾¡ã®ç¢ºèª</strong>:</p>
<pre class="codehilite"><code class="language-python">temperatures = [a.get_temperature() for a in traj]
print(f"Average T: {np.mean(temperatures):.1f} K (target: 300 K)")
print(f"Std T: {np.std(temperatures):.1f} K")
# æ¨™æº–åå·®ãŒ30Kä»¥ä¸Šãªã‚‰ç•°å¸¸
</code></pre>

<p><strong>2. æ§‹é€ ã®ç ´å£Šãƒã‚§ãƒƒã‚¯</strong>:</p>
<pre class="codehilite"><code class="language-python">from ase.geometry.analysis import Analysis

# åˆæœŸæ§‹é€ ã¨æœ€çµ‚æ§‹é€ ã®æ¯”è¼ƒ
ana_init = Analysis(traj[0])
ana_final = Analysis(traj[-1])

# çµåˆãŒåˆ‡ã‚Œã¦ã„ãªã„ã‹ç¢ºèª
bonds_init = ana_init.all_bonds[0]
bonds_final = ana_final.all_bonds[0]
print(f"Initial bonds: {len(bonds_init)}, Final bonds: {len(bonds_final)}")

# çµåˆæ•°ãŒå¤‰åŒ– â†’ æ§‹é€ ç ´å£Šã®å¯èƒ½æ€§
</code></pre>

<p><strong>3. å‹•å¾„åˆ†å¸ƒé–¢æ•°ï¼ˆRDFï¼‰ã®å¦¥å½“æ€§</strong>:</p>
<pre class="codehilite"><code class="language-python"># ç¬¬ä¸€ãƒ”ãƒ¼ã‚¯ä½ç½®ãŒDFTè¨ˆç®—ã‚„Xç·šå›æŠ˜ãƒ‡ãƒ¼ã‚¿ã¨ä¸€è‡´ã™ã‚‹ã‹ç¢ºèª
# ï¼ˆå®Ÿè£…ã¯é«˜åº¦ãªãŸã‚ã€çœç•¥ï¼‰
</code></pre>

<p><strong>å¯¾å‡¦æ³•</strong>:<br />
ç‰©ç†çš„ã«å¦¥å½“ãªçµæœãŒå¾—ã‚‰ã‚Œãªã„å ´åˆã€è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã®ç¯„å›²å¤–ï¼ˆå¤–æŒ¿ï¼‰ã®å¯èƒ½æ€§<br />
â†’ Active Learningã§è©²å½“ã™ã‚‹é…ç½®ã‚’è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã«è¿½åŠ </p>

</details>

<hr />
<h2 id="312">3.12 ç« æœ«ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼šãƒãƒ³ã‚ºã‚ªãƒ³ã®å“è³ªä¿è¨¼</h2>

<p>ã“ã®ç« ã‚’å®Œäº†ã—ãŸã‚‰ã€ä»¥ä¸‹ã®é …ç›®ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚å…¨ã¦ãƒã‚§ãƒƒã‚¯ã§ãã‚Œã°ã€å®Ÿéš›ã®ç ”ç©¶ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§MLPã‚’æ´»ç”¨ã™ã‚‹æº–å‚™ãŒæ•´ã£ã¦ã„ã¾ã™ã€‚</p>

<h3 id="3121">3.12.1 æ¦‚å¿µç†è§£ï¼ˆUnderstandingï¼‰</h3>

<p><strong>ç’°å¢ƒã¨ãƒ„ãƒ¼ãƒ«ã®ç†è§£</strong>:</p>
<ul>
<li>â–¡ SchNetPackã®å½¹å‰²ï¼ˆMLPè¨“ç·´ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>â–¡ PyTorchã¨SchNetPackã®é–¢ä¿‚ï¼ˆPyTorchãƒ™ãƒ¼ã‚¹ã®MLPå®Ÿè£…ï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
<li>â–¡ ASEã®å½¹å‰²ï¼ˆåŸå­æ§‹é€ æ“ä½œã€MDå®Ÿè¡Œï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>â–¡ MD17ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã®ç‰¹å¾´ï¼ˆ10ç¨®é¡ã®å°åˆ†å­ã€DFTç²¾åº¦ï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
</ul>

<p><strong>ãƒ¢ãƒ‡ãƒ«è¨“ç·´ã®ç†è§£</strong>:</p>
<ul>
<li>â–¡ SchNetã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆ<code>n_atom_basis</code>ã€<code>n_interactions</code>ã€<code>cutoff</code>ï¼‰ã®æ„å‘³ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>â–¡ è¨“ç·´/æ¤œè¨¼/ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã®å½¹å‰²ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
<li>â–¡ éå­¦ç¿’ã®å…†å€™ï¼ˆæ¤œè¨¼èª¤å·®ã®å¢—åŠ ï¼‰ã‚’è­˜åˆ¥ã§ãã‚‹</li>
<li>â–¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼MAE < 1 kcal/molãŒé«˜ç²¾åº¦ã®ç›®å®‰ã§ã‚ã‚‹ã“ã¨ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
</ul>

<p><strong>MLP-MDã®ç†è§£</strong>:</p>
<ul>
<li>â–¡ MLPãŒASE Calculatorã¨ã—ã¦çµ±åˆã•ã‚Œã‚‹ä»•çµ„ã¿ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
<li>â–¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜å‰‡ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹</li>
<li>â–¡ ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆ0.5 fsï¼‰ãŒå®‰å®šæ€§ã«å½±éŸ¿ã™ã‚‹ç†ç”±ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
<li>â–¡ MLP-MDãŒDFTã‚ˆã‚Š10â´å€é«˜é€Ÿãªç†ç”±ã‚’èª¬æ˜ã§ãã‚‹</li>
</ul>

<h3 id="3122">3.12.2 å®Ÿè·µã‚¹ã‚­ãƒ«ï¼ˆDoingï¼‰</h3>

<p><strong>ç’°å¢ƒæ§‹ç¯‰</strong>:</p>
<ul>
<li>â–¡ Condaç’°å¢ƒã‚’ä½œæˆã—ã€Python 3.10ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹</li>
<li>â–¡ PyTorchï¼ˆCPUç‰ˆ/GPUç‰ˆï¼‰ã‚’æ­£ã—ãã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹</li>
<li>â–¡ SchNetPack 2.0.3ã¨ASE 3.22.1ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹</li>
<li>â–¡ ç’°å¢ƒç¢ºèªã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œã—ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã§ãã‚‹</li>
</ul>

<p><strong>ãƒ‡ãƒ¼ã‚¿æº–å‚™ã¨è¨“ç·´</strong>:</p>
<ul>
<li>â–¡ MD17ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã€10ä¸‡é…ç½®ã«åˆ†å‰²ã§ãã‚‹</li>
<li>â–¡ SchNetãƒ¢ãƒ‡ãƒ«ã‚’å®šç¾©ã—ã€ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã§ãã‚‹</li>
<li>â–¡ 50ã‚¨ãƒãƒƒã‚¯ã®è¨“ç·´ã‚’å®Ÿè¡Œã—ã€TensorBoardã§é€²æ—ã‚’ç¢ºèªã§ãã‚‹</li>
<li>â–¡ ãƒ†ã‚¹ãƒˆã‚»ãƒƒãƒˆã§MAEã‚’è©•ä¾¡ã—ã€ç›®æ¨™ç²¾åº¦ï¼ˆ< 1 kcal/molï¼‰ã‚’é”æˆã§ãã‚‹</li>
</ul>

<p><strong>MLP-MDã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</strong>:</p>
<ul>
<li>â–¡ è¨“ç·´æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ã‚’ASE Calculatorã¨ã—ã¦ãƒ©ãƒƒãƒ—ã§ãã‚‹</li>
<li>â–¡ Maxwell-Boltzmannåˆ†å¸ƒã§åˆæœŸé€Ÿåº¦ã‚’è¨­å®šã§ãã‚‹</li>
<li>â–¡ 10,000ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆ5ãƒ”ã‚³ç§’ï¼‰ã®MDã‚’å®Ÿè¡Œã§ãã‚‹</li>
<li>â–¡ ãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªã‚’ä¿å­˜ã—ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ä¿å­˜ã‚’ç¢ºèªã§ãã‚‹</li>
</ul>

<p><strong>è§£æã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</strong>:</p>
<ul>
<li>â–¡ æŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆãƒ‘ãƒ¯ãƒ¼ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼‰ã‚’è¨ˆç®—ã§ãã‚‹</li>
<li>â–¡ å¹³å‡äºŒä¹—å¤‰ä½ï¼ˆMSDï¼‰ã‹ã‚‰æ‹¡æ•£ä¿‚æ•°ã‚’è¨ˆç®—ã§ãã‚‹</li>
<li>â–¡ Out of Memoryï¼ˆOOMï¼‰ã‚¨ãƒ©ãƒ¼ã«å¯¾å‡¦ã§ãã‚‹ï¼ˆãƒãƒƒãƒã‚µã‚¤ã‚ºå‰Šæ¸›ï¼‰</li>
<li>â–¡ NaNæå¤±ã®åŸå› ã‚’è¨ºæ–­ã—ã€å­¦ç¿’ç‡ã‚’èª¿æ•´ã§ãã‚‹</li>
</ul>

<h3 id="3123">3.12.3 å¿œç”¨åŠ›ï¼ˆApplyingï¼‰</h3>

<p><strong>è‡ªåˆ†ã®ç ”ç©¶ã¸ã®é©ç”¨è¨ˆç”»</strong>:</p>
<ul>
<li>â–¡ è‡ªåˆ†ã®ç ”ç©¶å¯¾è±¡ï¼ˆåˆ†å­ã€ææ–™ï¼‰ã§MD17ç›¸å½“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’è¨­è¨ˆã§ãã‚‹</li>
<li>â–¡ å¿…è¦ãªDFTè¨ˆç®—æ•°ï¼ˆç›®æ¨™ç²¾åº¦ã¨ç³»ã®ã‚µã‚¤ã‚ºã‹ã‚‰ï¼‰ã‚’è¦‹ç©ã‚‚ã‚Œã‚‹</li>
<li>â–¡ SchNetã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è‡ªåˆ†ã®ç³»ã«æœ€é©åŒ–ã™ã‚‹æˆ¦ç•¥ã‚’ç«‹ã¦ã‚‰ã‚Œã‚‹</li>
<li>â–¡ MLP-MDã§å¾—ãŸã„ç‰©æ€§ï¼ˆæ‹¡æ•£ä¿‚æ•°ã€æŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«ã€åå¿œçµŒè·¯ï¼‰ã‚’æ˜ç¢ºã«ã§ãã‚‹</li>
</ul>

<p><strong>å•é¡Œè§£æ±ºã¨ãƒ‡ãƒãƒƒã‚°</strong>:</p>
<ul>
<li>â–¡ è¨“ç·´ãŒåæŸã—ãªã„å ´åˆã®è¨ºæ–­æ‰‹é †ï¼ˆå­¦ç¿’ç‡ã€ãƒ‡ãƒ¼ã‚¿æ­£è¦åŒ–ã€å‹¾é…ã‚¯ãƒªãƒƒãƒ”ãƒ³ã‚°ï¼‰ã‚’å®Ÿè¡Œã§ãã‚‹</li>
<li>â–¡ ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆã®åŸå› ã‚’ç‰¹å®šã—ã€å¯¾å‡¦æ³•ã‚’é¸æŠã§ãã‚‹</li>
<li>â–¡ éå­¦ç¿’ã‚’æ¤œå‡ºã—ã€Early Stoppingã‚„Data Augmentationã‚’é©ç”¨ã§ãã‚‹</li>
<li>â–¡ GPU/CPUãƒªã‚½ãƒ¼ã‚¹ã«å¿œã˜ã¦ãƒãƒƒãƒã‚µã‚¤ã‚ºã¨è¨“ç·´æ™‚é–“ã‚’æœ€é©åŒ–ã§ãã‚‹</li>
</ul>

<p><strong>AdvancedæŠ€è¡“ã¸ã®æº–å‚™</strong>:</p>
<ul>
<li>â–¡ Active Learningï¼ˆExample 15ï¼‰ã®æ¦‚å¿µã‚’ç†è§£ã—ã€å®Ÿè£…ã®æµã‚Œã‚’èª¬æ˜ã§ãã‚‹</li>
<li>â–¡ ã‚¢ãƒ³ã‚µãƒ³ãƒ–ãƒ«ä¸ç¢ºå®Ÿæ€§ã«ã‚ˆã‚‹é…ç½®é¸æŠã®é‡è¦æ€§ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
<li>â–¡ æ¬¡ç« ï¼ˆNequIPã€MACEï¼‰ã§ãƒ‡ãƒ¼ã‚¿åŠ¹ç‡ãŒã©ã†æ”¹å–„ã•ã‚Œã‚‹ã‹æœŸå¾…ã‚’æŒã£ã¦ã„ã‚‹</li>
<li>â–¡ SchNetPackã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ<a href="https://schnetpack.readthedocs.io">schnetpack.readthedocs.io</a>ï¼‰ã‚’æ´»ç”¨ã—ã¦ã€ç‹¬å­¦ã§å­¦ç¿’ã‚’ç¶šã‘ã‚‰ã‚Œã‚‹</li>
</ul>

<p><strong>æ¬¡ç« ã¸ã®ãƒ–ãƒªãƒƒã‚¸</strong>:</p>
<ul>
<li>â–¡ SchNetã®é™ç•Œï¼ˆãƒ‡ãƒ¼ã‚¿åŠ¹ç‡ã€å›è»¢ç­‰å¤‰æ€§ï¼‰ã‚’èªè­˜ã—ã¦ã„ã‚‹</li>
<li>â–¡ E(3)ç­‰å¤‰æ€§ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆNequIPã€MACEï¼‰ãŒã©ã†æ”¹å–„ã™ã‚‹ã‹èˆˆå‘³ã‚’æŒã£ã¦ã„ã‚‹</li>
<li>â–¡ å®Ÿéš›ã®ç ”ç©¶å¿œç”¨ä¾‹ï¼ˆè§¦åª’ã€ãƒãƒƒãƒ†ãƒªãƒ¼ã€å‰µè–¬ï¼‰ã‚’ç¬¬4ç« ã§å­¦ã¶æº–å‚™ãŒã§ãã¦ã„ã‚‹</li>
</ul>

<hr />
<h2 id="_19">å‚è€ƒæ–‡çŒ®</h2>
<ol>
<li>
<p>SchÃ¼tt, K. T., et al. (2019). "SchNetPack: A Deep Learning Toolbox For Atomistic Systems." <em>Journal of Chemical Theory and Computation</em>, 15(1), 448-455.<br />
   DOI: <a href="https://doi.org/10.1021/acs.jctc.8b00908">10.1021/acs.jctc.8b00908</a></p>
</li>
<li>
<p>Chmiela, S., et al. (2017). "Machine learning of accurate energy-conserving molecular force fields." <em>Science Advances</em>, 3(5), e1603015.<br />
   DOI: <a href="https://doi.org/10.1126/sciadv.1603015">10.1126/sciadv.1603015</a></p>
</li>
<li>
<p>Larsen, A. H., et al. (2017). "The atomic simulation environmentâ€”a Python library for working with atoms." <em>Journal of Physics: Condensed Matter</em>, 29(27), 273002.<br />
   DOI: <a href="https://doi.org/10.1088/1361-648X/aa680e">10.1088/1361-648X/aa680e</a></p>
</li>
<li>
<p>Paszke, A., et al. (2019). "PyTorch: An imperative style, high-performance deep learning library." <em>Advances in Neural Information Processing Systems</em>, 32.<br />
   arXiv: <a href="https://arxiv.org/abs/1912.01703">1912.01703</a></p>
</li>
<li>
<p>Zhang, L., et al. (2020). "Active learning of uniformly accurate interatomic potentials for materials simulation." <em>Physical Review Materials</em>, 3(2), 023804.<br />
   DOI: <a href="https://doi.org/10.1103/PhysRevMaterials.3.023804">10.1103/PhysRevMaterials.3.023804</a></p>
</li>
<li>
<p>SchÃ¼tt, K. T., et al. (2017). "Quantum-chemical insights from deep tensor neural networks." <em>Nature Communications</em>, 8(1), 13890.<br />
   DOI: <a href="https://doi.org/10.1038/ncomms13890">10.1038/ncomms13890</a></p>
</li>
</ol>
<hr />
<h2 id="_20">è‘—è€…æƒ…å ±</h2>
<p><strong>ä½œæˆè€…</strong>: MI Knowledge Hub Content Team<br />
<strong>ä½œæˆæ—¥</strong>: 2025-10-17<br />
<strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.1ï¼ˆChapter 3 quality improvementï¼‰<br />
<strong>ã‚·ãƒªãƒ¼ã‚º</strong>: MLPå…¥é–€ã‚·ãƒªãƒ¼ã‚º</p>
<p><strong>æ›´æ–°å±¥æ­´</strong>:<br />
- 2025-10-19: v1.1 å“è³ªå‘ä¸Šæ”¹è¨‚<br />
  - ãƒ‡ãƒ¼ã‚¿ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¨å†ç¾æ€§ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ ï¼ˆMD17ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã€ã‚¢ã‚¹ãƒ”ãƒªãƒ³åˆ†å­æƒ…å ±ï¼‰<br />
  - ã‚³ãƒ¼ãƒ‰å†ç¾æ€§æƒ…å ±ï¼ˆPython 3.10.x, PyTorch 2.1.0, SchNetPack 2.0.3, ASE 3.22.1ï¼‰<br />
  - è¨“ç·´ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å®Œå…¨è¨˜éŒ²ï¼ˆ11é …ç›®ã€è«–æ–‡å†ç¾ç”¨ï¼‰<br />
  - ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»åŠ›ã®å˜ä½æ›ç®—è¡¨ï¼ˆeV, kcal/mol, Hartreeç›¸äº’å¤‰æ›ï¼‰<br />
  - å®Ÿè·µä¸Šã®æ³¨æ„ç‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¿½åŠ ï¼ˆ7ã¤ã®å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³: CUDAä¸ä¸€è‡´ã€APIæ··åŒã€OOMã€NaNæå¤±ã€éå­¦ç¿’ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‰ãƒªãƒ•ãƒˆã€ç‰©ç†å¦¥å½“æ€§ï¼‰<br />
  - ç« æœ«ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆè¿½åŠ ï¼ˆæ¦‚å¿µç†è§£12é …ç›®ã€å®Ÿè·µã‚¹ã‚­ãƒ«16é …ç›®ã€å¿œç”¨åŠ›16é …ç›®ï¼‰<br />
- 2025-10-17: v1.0 ç¬¬3ç« åˆç‰ˆä½œæˆ<br />
  - Pythonç’°å¢ƒæ§‹ç¯‰ï¼ˆConda, PyTorch, SchNetPackï¼‰<br />
  - MD17ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆæº–å‚™ã¨åˆ†å‰²<br />
  - SchNetãƒ¢ãƒ‡ãƒ«è¨“ç·´ï¼ˆ15ã‚³ãƒ¼ãƒ‰ä¾‹ï¼‰<br />
  - MLP-MDå®Ÿè¡Œã¨è§£æï¼ˆãƒˆãƒ©ã‚¸ã‚§ã‚¯ãƒˆãƒªã€æŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«ã€MSDï¼‰<br />
  - Active Learningä¸ç¢ºå®Ÿæ€§è©•ä¾¡<br />
  - ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¡¨ï¼ˆ5é …ç›®ï¼‰<br />
  - æ¼”ç¿’å•é¡Œ2å•ï¼ˆeasy, mediumï¼‰<br />
  - å‚è€ƒæ–‡çŒ®6ä»¶</p>
<p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY-NC-SA 4.0</p>

        <div class="nav-buttons">
            <a href="index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
        </div>
    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <div class="container">
            <p>&copy; 2025 MI Knowledge Hub - Dr. Yusuke Hashimoto, Tohoku University</p>
            <p>Licensed under CC BY 4.0</p>
        </div>
    </footer>
</body>
</html>
