<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á¨¨4Á´†ÔºöÂèçÂøú‰∫àÊ∏¨„Å®Retrosynthesis - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ÂèçÂøú‰∫àÊ∏¨„Å®Retrosynthesis</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">üìñ Ë™≠‰∫ÜÊôÇÈñì: 25-30ÂàÜ</span>
                <span class="meta-item">üìä Èõ£ÊòìÂ∫¶: ‰∏≠Á¥ö„Äú‰∏äÁ¥ö</span>
                <span class="meta-item">üíª „Ç≥„Éº„Éâ‰æã: 10ÂÄã</span>
                <span class="meta-item">üìù ÊºîÁøíÂïèÈ°å: 3Âïè</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Á¨¨4Á´†ÔºöÂèçÂøú‰∫àÊ∏¨„Å®Retrosynthesis</h1>
<h2>„Åì„ÅÆÁ´†„ÅßÂ≠¶„Å∂„Åì„Å®</h2>
<p>„Åì„ÅÆÁ´†„Åß„ÅØ„ÄÅÂåñÂ≠¶ÂèçÂøú„ÅÆË®àÁÆóÊ©üË°®Áèæ„Å®‰∫àÊ∏¨„ÄÅ„Åù„Åó„Å¶ÁõÆÊ®ôÂàÜÂ≠ê„Åã„ÇâÂéüÊñô„Å∏„ÅÆÈÄÜÂêàÊàêËß£ÊûêÔºàRetrosynthesisÔºâ„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ„Åì„Çå„Çâ„ÅÆÊäÄË°ì„ÅØ„ÄÅÂäπÁéáÁöÑ„Å™ÂêàÊàêÁµåË∑ØË®≠Ë®à„Å´„Åä„ÅÑ„Å¶Èù©ÂëΩÁöÑ„Å™ÈÄ≤Â±ï„Çí„ÇÇ„Åü„Çâ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ</p>
<h3>Â≠¶ÁøíÁõÆÊ®ô</h3>
<ul>
<li>‚úÖ ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„Å®SMARTS„ÇíÁêÜËß£„Åó„ÄÅË®òËø∞„Åß„Åç„Çã</li>
<li>‚úÖ ÂèçÂøú‰∫àÊ∏¨„É¢„Éá„É´„ÅÆÂü∫Êú¨„ÇíÁêÜËß£„Åó„Å¶„ÅÑ„Çã</li>
<li>‚úÖ Retrosynthesis„ÅÆÊ¶ÇÂøµ„Å®‰∏ªË¶Å„ÉÑ„Éº„É´„Çí‰Ωø„Åà„Çã</li>
<li>‚úÖ Áî£Ê•≠ÂøúÁî®‰∫ã‰æã„ÇíÁü•„Çä„ÄÅ„Ç≠„É£„É™„Ç¢„Éë„Çπ„ÇíÊèè„Åë„Çã</li>
<li>‚úÖ ÂÆüÈöõ„ÅÆÂâµËñ¨„ÉªÊùêÊñôÈñãÁô∫„Éó„É≠„Ç∏„Çß„ÇØ„Éà„Å´ÂøúÁî®„Åß„Åç„Çã</li>
</ul>
<hr />
<h2>4.1 ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„Å®SMARTS</h2>
<p><strong>ÂåñÂ≠¶ÂèçÂøú„ÅÆË°®Áèæ</strong>„ÅØ„ÄÅÂèçÂøúÁâ©„Åã„ÇâÁîüÊàêÁâ©„Å∏„ÅÆÂ§âÊèõ„ÇíË®òËø∞„Åô„ÇãÂøÖË¶Å„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ</p>
<div class="mermaid">
graph LR
    A[ÂèçÂøúÁâ©<br>Reactants] -->|ÂèçÂøúÊù°‰ª∂<br>Conditions| B[ÁîüÊàêÁâ©<br>Products]

    C[SMILES] --> D[ÂèçÂøúSMILES]
    C --> E[ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà<br>SMARTS]
    C --> F[ÂèçÂøú„Ç∞„É©„Éï]

    D --> G[Ê©üÊ¢∞Â≠¶Áøí„É¢„Éá„É´]
    E --> G
    F --> G
    G --> H[ÂèçÂøú‰∫àÊ∏¨]

    style A fill:#e3f2fd
    style B fill:#4CAF50,color:#fff
    style H fill:#FF9800,color:#fff
</div>

<h3>4.1.1 ÂèçÂøúSMILES„Å®SMIRKS</h3>
<p><strong>ÂèçÂøúSMILES</strong>„ÅØ„ÄÅÂèçÂøúÁâ©„Å®ÁîüÊàêÁâ©„Çí<code>&gt;&gt;</code>„ÅßÂå∫Âàá„Å£„Å¶Ë°®Áèæ„Åó„Åæ„Åô„ÄÇ</p>
<p><strong>ÂΩ¢Âºè</strong>:</p>
<pre><code>reactant1.reactant2&gt;&gt;product1.product2
</code></pre>
<p><strong>SMIRKSÔºàSMILES Reaction SpecificationÔºâ</strong>„ÅØ„ÄÅÂèçÂøú„ÅÆÂ§âÂåñÈÉ®ÂàÜ„ÇíÊòéÁ§∫ÁöÑ„Å´Ë®òËø∞„Åó„Åæ„Åô„ÄÇ</p>
<h4>„Ç≥„Éº„Éâ‰æã1: ÂèçÂøúSMILES„ÅÆËß£Êûê</h4>
<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem, Draw

# „Ç®„Çπ„ÉÜ„É´ÂåñÂèçÂøú„ÅÆ‰æã
reaction_smiles = &quot;CC(=O)O.CCO&gt;&gt;CC(=O)OCC.O&quot;
# ÈÖ¢ÈÖ∏ + „Ç®„Çø„Éé„Éº„É´ &gt;&gt; ÈÖ¢ÈÖ∏„Ç®„ÉÅ„É´ + Ê∞¥

# ÂèçÂøú„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ‰ΩúÊàê
rxn = AllChem.ReactionFromSmarts(reaction_smiles)

print(f&quot;ÂèçÂøúÁâ©Êï∞: {rxn.GetNumReactantTemplates()}&quot;)
print(f&quot;ÁîüÊàêÁâ©Êï∞: {rxn.GetNumProductTemplates()}&quot;)

# ÂèçÂøúÁâ©„Å®ÁîüÊàêÁâ©„ÅÆÂèñÂæó
reactants = [rxn.GetReactantTemplate(i)
             for i in range(rxn.GetNumReactantTemplates())]
products = [rxn.GetProductTemplate(i)
            for i in range(rxn.GetNumProductTemplates())]

# SMILES„ÅÆË°®Á§∫
print(&quot;\nÂèçÂøúÁâ©:&quot;)
for i, mol in enumerate(reactants, 1):
    print(f&quot;  {i}. {Chem.MolToSmiles(mol)}&quot;)

print(&quot;\nÁîüÊàêÁâ©:&quot;)
for i, mol in enumerate(products, 1):
    print(f&quot;  {i}. {Chem.MolToSmiles(mol)}&quot;)

# ÂèçÂøú„ÅÆÊèèÁîª
rxn_img = Draw.ReactionToImage(rxn)
rxn_img.save(&quot;esterification_reaction.png&quot;)
print(&quot;\nÂèçÂøúÂõ≥„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>ÂèçÂøúÁâ©Êï∞: 2
ÁîüÊàêÁâ©Êï∞: 2

ÂèçÂøúÁâ©:
  1. CC(=O)O
  2. CCO

ÁîüÊàêÁâ©:
  1. CC(=O)OCC
  2. O

ÂèçÂøúÂõ≥„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü
</code></pre>
<h3>4.1.2 ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅÆÂÆöÁæ©</h3>
<p><strong>ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà</strong>„ÅØ„ÄÅÂèçÂøú„ÅÆ‰∏ÄËà¨ÁöÑ„Å™„Éë„Çø„Éº„É≥„ÇíSMARTS„ÅßË®òËø∞„Åó„Åü„ÇÇ„ÅÆ„Åß„Åô„ÄÇ</p>
<h4>‰∏ªË¶Å„Å™ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà</h4>
<pre><code class="language-python"># ‰ª£Ë°®ÁöÑ„Å™ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà

reaction_templates = {
    # „Ç®„Çπ„ÉÜ„É´Âåñ
    &quot;Esterification&quot;: &quot;[C:1](=[O:2])[OH:3].[OH:4][C:5]&gt;&gt;[C:1](=[O:2])[O:4][C:5].[OH2:3]&quot;,

    # „Ç¢„Éü„ÉâÂåñ
    &quot;Amidation&quot;: &quot;[C:1](=[O:2])[OH:3].[NH2:4][C:5]&gt;&gt;[C:1](=[O:2])[NH:4][C:5].[OH2:3]&quot;,

    # Suzuki-Miyaura„Ç´„ÉÉ„Éó„É™„É≥„Ç∞
    &quot;Suzuki&quot;: &quot;[c:1][Br,I:2].[c:3][B:4]([OH])([OH])&gt;&gt;[c:1][c:3]&quot;,

    # ÈÇÑÂÖÉÔºà„Ç´„É´„Éú„Éã„É´ ‚Üí „Ç¢„É´„Ç≥„Éº„É´Ôºâ
    &quot;Reduction&quot;: &quot;[C:1]=[O:2]&gt;&gt;[C:1][OH:2]&quot;,

    # ÈÖ∏ÂåñÔºà„Ç¢„É´„Ç≥„Éº„É´ ‚Üí „Ç´„É´„Éú„Éã„É´Ôºâ
    &quot;Oxidation&quot;: &quot;[C:1][OH:2]&gt;&gt;[C:1]=[O:2]&quot;,

    # GrignardÂèçÂøú
    &quot;Grignard&quot;: &quot;[C:1]=[O:2].[C:3][Mg][Br:4]&gt;&gt;[C:1]([OH:2])[C:3]&quot;
}

# „ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅÆË°®Á§∫
for name, smarts in reaction_templates.items():
    print(f&quot;{name:20s}: {smarts}&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>Esterification      : [C:1](=[O:2])[OH:3].[OH:4][C:5]&gt;&gt;[C:1](=[O:2])[O:4][C:5].[OH2:3]
Amidation           : [C:1](=[O:2])[OH:3].[NH2:4][C:5]&gt;&gt;[C:1](=[O:2])[NH:4][C:5].[OH2:3]
Suzuki              : [c:1][Br,I:2].[c:3][B:4]([OH])([OH])&gt;&gt;[c:1][c:3]
Reduction           : [C:1]=[O:2]&gt;&gt;[C:1][OH:2]
Oxidation           : [C:1][OH:2]&gt;&gt;[C:1]=[O:2]
Grignard            : [C:1]=[O:2].[C:3][Mg][Br:4]&gt;&gt;[C:1]([OH:2])[C:3]
</code></pre>
<h4>„Ç≥„Éº„Éâ‰æã2: ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅÆÈÅ©Áî®</h4>
<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem

def apply_reaction_template(reactants_smiles, template_smarts):
    &quot;&quot;&quot;
    ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÈÅ©Áî®„Åó„Å¶ÁîüÊàêÁâ©„Çí‰∫àÊ∏¨

    Parameters:
    -----------
    reactants_smiles : list
        ÂèçÂøúÁâ©„ÅÆSMILES„É™„Çπ„Éà
    template_smarts : str
        ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„ÉàÔºàSMARTSÂΩ¢ÂºèÔºâ

    Returns:
    --------
    products : list
        ÁîüÊàêÁâ©„ÅÆSMILES„É™„Çπ„Éà
    &quot;&quot;&quot;
    # ÂèçÂøú„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ‰ΩúÊàê
    rxn = AllChem.ReactionFromSmarts(template_smarts)

    # ÂèçÂøúÁâ©„ÅÆÂàÜÂ≠ê„Ç™„Éñ„Ç∏„Çß„ÇØ„ÉàÂåñ
    reactant_mols = [Chem.MolFromSmiles(smi)
                     for smi in reactants_smiles]

    # ÂèçÂøú„ÅÆÂÆüË°å
    products = rxn.RunReactants(tuple(reactant_mols))

    # ÁµêÊûú„ÅÆÊï¥ÂΩ¢
    product_smiles = []
    for product_set in products:
        for mol in product_set:
            # „Çµ„Éã„Çø„Ç§„Ç∫
            try:
                Chem.SanitizeMol(mol)
                smi = Chem.MolToSmiles(mol)
                product_smiles.append(smi)
            except:
                pass

    return product_smiles

# „Ç®„Çπ„ÉÜ„É´Âåñ„ÅÆ‰æã
reactants = [&quot;CC(=O)O&quot;, &quot;CCO&quot;]  # ÈÖ¢ÈÖ∏ + „Ç®„Çø„Éé„Éº„É´
template = reaction_templates[&quot;Esterification&quot;]

products = apply_reaction_template(reactants, template)

print(&quot;„Ç®„Çπ„ÉÜ„É´ÂåñÂèçÂøú:&quot;)
print(f&quot;ÂèçÂøúÁâ©: {' + '.join(reactants)}&quot;)
print(f&quot;ÁîüÊàêÁâ©: {', '.join(products)}&quot;)

# Suzuki-Miyaura„Ç´„ÉÉ„Éó„É™„É≥„Ç∞„ÅÆ‰æã
reactants_suzuki = [&quot;c1ccc(Br)cc1&quot;, &quot;c1ccccc1B(O)O&quot;]
template_suzuki = reaction_templates[&quot;Suzuki&quot;]

products_suzuki = apply_reaction_template(reactants_suzuki, template_suzuki)

print(&quot;\nSuzuki-Miyaura„Ç´„ÉÉ„Éó„É™„É≥„Ç∞:&quot;)
print(f&quot;ÂèçÂøúÁâ©: {' + '.join(reactants_suzuki)}&quot;)
print(f&quot;ÁîüÊàêÁâ©: {', '.join(products_suzuki)}&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>„Ç®„Çπ„ÉÜ„É´ÂåñÂèçÂøú:
ÂèçÂøúÁâ©: CC(=O)O + CCO
ÁîüÊàêÁâ©: CC(=O)OCC, O

Suzuki-Miyaura„Ç´„ÉÉ„Éó„É™„É≥„Ç∞:
ÂèçÂøúÁâ©: c1ccc(Br)cc1 + c1ccccc1B(O)O
ÁîüÊàêÁâ©: c1ccc(-c2ccccc2)cc1
</code></pre>
<h3>4.1.3 USPTOÂèçÂøú„Éá„Éº„Çø„Çª„ÉÉ„Éà</h3>
<p><strong>USPTOÔºàUnited States Patent and Trademark OfficeÔºâ</strong>„ÅØ„ÄÅÁâπË®±„Éá„Éº„Çø„Éô„Éº„Çπ„Åã„ÇâÊäΩÂá∫„Åï„Çå„ÅüÂ§ßË¶èÊ®°ÂèçÂøú„Éá„Éº„Çø„Çª„ÉÉ„Éà„Åß„Åô„ÄÇ</p>
<p><strong>Áµ±Ë®à</strong>:
- Á∑èÂèçÂøúÊï∞: Á¥Ñ180‰∏áÂèçÂøú
- ÂèçÂøú„Çø„Ç§„Éó: 10Á®ÆÈ°û„Å´ÂàÜÈ°û
- ÈÅ©Áî®: ÂèçÂøú‰∫àÊ∏¨„É¢„Éá„É´„ÅÆË®ìÁ∑¥„Éá„Éº„Çø</p>
<h4>„Ç≥„Éº„Éâ‰æã3: USPTOÂèçÂøú„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å®ÂàÜÊûê</h4>
<pre><code class="language-python">import pandas as pd

# USPTO„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„ÅøÔºà„Çµ„É≥„Éó„É´Ôºâ
# ÂÆüÈöõ„ÅÆ„Éá„Éº„Çø„ÅØ https://github.com/rxn4chemistry/rxnfp „Åã„ÇâÂèñÂæó

# „Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÅÆ‰ΩúÊàê
sample_reactions = [
    {
        'reaction_smiles': 'CC(=O)O.CCO&gt;&gt;CC(=O)OCC.O',
        'reaction_type': 'Esterification',
        'yield': 85.3
    },
    {
        'reaction_smiles': 'c1ccc(Br)cc1.c1ccccc1B(O)O&gt;&gt;c1ccc(-c2ccccc2)cc1',
        'reaction_type': 'Suzuki',
        'yield': 92.1
    },
    {
        'reaction_smiles': 'CC(=O)O.Nc1ccccc1&gt;&gt;CC(=O)Nc1ccccc1.O',
        'reaction_type': 'Amidation',
        'yield': 78.5
    }
]

df_uspto = pd.DataFrame(sample_reactions)

print(&quot;USPTOÂèçÂøú„Éá„Éº„Çø„Çµ„É≥„Éó„É´:&quot;)
print(df_uspto)

# ÂèçÂøú„Çø„Ç§„Éó„Åî„Å®„ÅÆÁµ±Ë®à
print(&quot;\nÂèçÂøú„Çø„Ç§„Éó„ÅÆÂàÜÂ∏É:&quot;)
print(df_uspto['reaction_type'].value_counts())

print(f&quot;\nÂπ≥ÂùáÂèéÁéá: {df_uspto['yield'].mean():.1f}%&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>USPTOÂèçÂøú„Éá„Éº„Çø„Çµ„É≥„Éó„É´:
                                    reaction_smiles  reaction_type  yield
0               CC(=O)O.CCO&gt;&gt;CC(=O)OCC.O  Esterification   85.3
1  c1ccc(Br)cc1.c1ccccc1B(O)O&gt;&gt;c1ccc(-c2ccc...         Suzuki   92.1
2        CC(=O)O.Nc1ccccc1&gt;&gt;CC(=O)Nc1ccccc1.O      Amidation   78.5

ÂèçÂøú„Çø„Ç§„Éó„ÅÆÂàÜÂ∏É:
Esterification    1
Suzuki            1
Amidation         1

Âπ≥ÂùáÂèéÁéá: 85.3%
</code></pre>
<hr />
<h2>4.2 ÂèçÂøú‰∫àÊ∏¨„É¢„Éá„É´</h2>
<h3>4.2.1 Ê©üÊ¢∞Â≠¶Áøí„Å´„Çà„ÇãÂèçÂøú‰∫àÊ∏¨</h3>
<p>ÂèçÂøú‰∫àÊ∏¨„ÅØ„ÄÅÂèçÂøúÁâ©„Åã„ÇâÁîüÊàêÁâ©„Çí‰∫àÊ∏¨„Åô„ÇãÈ†ÜÊñπÂêë‰∫àÊ∏¨ÔºàForward PredictionÔºâ„Åß„Åô„ÄÇ</p>
<div class="mermaid">
flowchart TD
    A[ÂèçÂøúÁâ©<br>Reactants] --> B[ÁâπÂæ¥ÈáèÊäΩÂá∫]
    B --> C[ÂàÜÂ≠êÊåáÁ¥ã]
    B --> D[Ë®òËø∞Â≠ê]
    B --> E[„Ç∞„É©„ÉïË°®Áèæ]

    C --> F[Ê©üÊ¢∞Â≠¶Áøí„É¢„Éá„É´]
    D --> F
    E --> F

    F --> G[ÁîüÊàêÁâ©‰∫àÊ∏¨]
    G --> H[Top-kÂÄôË£ú]

    style A fill:#e3f2fd
    style G fill:#4CAF50,color:#fff
    style H fill:#FF9800,color:#fff
</div>

<h4>„Ç≥„Éº„Éâ‰æã4: Random Forest„Å´„Çà„ÇãÂèçÂøúÂèéÁéá‰∫àÊ∏¨</h4>
<pre><code class="language-python">from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import r2_score, mean_absolute_error
from rdkit import Chem
from rdkit.Chem import AllChem
import numpy as np

def reaction_to_fingerprint(reaction_smiles, nBits=2048):
    &quot;&quot;&quot;
    ÂèçÂøúSMILES„Åã„ÇâÂ∑ÆÂàÜÊåáÁ¥ã„ÇíË®àÁÆó

    Â∑ÆÂàÜÊåáÁ¥ã = ÁîüÊàêÁâ©ÊåáÁ¥ã - ÂèçÂøúÁâ©ÊåáÁ¥ã
    &quot;&quot;&quot;
    reactants_smiles, products_smiles = reaction_smiles.split('&gt;&gt;')

    # ÂèçÂøúÁâ©„ÅÆÊåáÁ¥ãÔºàË§áÊï∞„ÅÆÂ†¥Âêà„ÅØÂêàÁÆóÔºâ
    reactants = reactants_smiles.split('.')
    reactant_fp = np.zeros(nBits)
    for smi in reactants:
        mol = Chem.MolFromSmiles(smi)
        if mol:
            fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, nBits)
            reactant_fp += np.array(fp)

    # ÁîüÊàêÁâ©„ÅÆÊåáÁ¥ãÔºàË§áÊï∞„ÅÆÂ†¥Âêà„ÅØÂêàÁÆóÔºâ
    products = products_smiles.split('.')
    product_fp = np.zeros(nBits)
    for smi in products:
        mol = Chem.MolFromSmiles(smi)
        if mol:
            fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, nBits)
            product_fp += np.array(fp)

    # Â∑ÆÂàÜÊåáÁ¥ã
    diff_fp = product_fp - reactant_fp
    return diff_fp

# „Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÅÆÁîüÊàêÔºàÂÆüÈöõ„ÅØUSPTO„Å™„Å©„Åã„ÇâÂèñÂæóÔºâ
np.random.seed(42)
n_reactions = 200

sample_data = []
for i in range(n_reactions):
    # ‰ªÆÊÉ≥„ÅÆÂèçÂøúSMILESÔºàÁ∞°Áï•ÂåñÔºâ
    rxn_smi = f&quot;CCO.CC(=O)O&gt;&gt;CC(=O)OCC.O&quot;
    # ‰ªÆÊÉ≥„ÅÆÂèéÁéáÔºà70-95%„ÅÆÁØÑÂõ≤Ôºâ
    yield_val = np.random.uniform(70, 95)
    sample_data.append((rxn_smi, yield_val))

# ÁâπÂæ¥ÈáèÊäΩÂá∫
X = np.array([reaction_to_fingerprint(rxn) for rxn, _ in sample_data])
y = np.array([yield_val for _, yield_val in sample_data])

# „Éá„Éº„ÇøÂàÜÂâ≤
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# Random Forest„É¢„Éá„É´
rf = RandomForestRegressor(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)

# ‰∫àÊ∏¨
y_pred = rf.predict(X_test)

# Ë©ï‰æ°
r2 = r2_score(y_test, y_pred)
mae = mean_absolute_error(y_test, y_pred)

print(&quot;ÂèçÂøúÂèéÁéá‰∫àÊ∏¨„É¢„Éá„É´„ÅÆÊÄßËÉΩ:&quot;)
print(f&quot;R¬≤: {r2:.3f}&quot;)
print(f&quot;MAE: {mae:.2f}%&quot;)

# „Çµ„É≥„Éó„É´‰∫àÊ∏¨
print(&quot;\n„Çµ„É≥„Éó„É´‰∫àÊ∏¨:&quot;)
for i in range(min(5, len(y_test))):
    print(f&quot;ÂÆüÊ∏¨: {y_test[i]:.1f}%  ‰∫àÊ∏¨: {y_pred[i]:.1f}%  &quot;
          f&quot;Ë™§Â∑Æ: {abs(y_test[i] - y_pred[i]):.1f}%&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>ÂèçÂøúÂèéÁéá‰∫àÊ∏¨„É¢„Éá„É´„ÅÆÊÄßËÉΩ:
R¬≤: 0.012
MAE: 7.32%

„Çµ„É≥„Éó„É´‰∫àÊ∏¨:
ÂÆüÊ∏¨: 82.4%  ‰∫àÊ∏¨: 81.8%  Ë™§Â∑Æ: 0.6%
ÂÆüÊ∏¨: 89.2%  ‰∫àÊ∏¨: 82.1%  Ë™§Â∑Æ: 7.1%
ÂÆüÊ∏¨: 76.5%  ‰∫àÊ∏¨: 81.9%  Ë™§Â∑Æ: 5.4%
ÂÆüÊ∏¨: 91.3%  ‰∫àÊ∏¨: 82.2%  Ë™§Â∑Æ: 9.1%
ÂÆüÊ∏¨: 73.8%  ‰∫àÊ∏¨: 81.7%  Ë™§Â∑Æ: 7.9%
</code></pre>
<h3>4.2.2 Transformer„Å´„Çà„ÇãÂèçÂøú‰∫àÊ∏¨</h3>
<p>Transformer„É¢„Éá„É´„ÅØ„ÄÅÂèçÂøúSMILES„ÇíÊñáÂ≠óÂàó„Å®„Åó„Å¶Êâ±„ÅÑ„ÄÅSeq2Seq„ÅßÁîüÊàêÁâ©„Çí‰∫àÊ∏¨„Åó„Åæ„Åô„ÄÇ</p>
<div class="mermaid">
graph LR
    A[ÂèçÂøúÁâ©SMILES] --> B[Tokenization]
    B --> C[Transformer<br>Encoder]
    C --> D[Context Vector]
    D --> E[Transformer<br>Decoder]
    E --> F[ÁîüÊàêÁâ©SMILES]

    style A fill:#e3f2fd
    style F fill:#4CAF50,color:#fff
</div>

<h4>„Ç≥„Éº„Éâ‰æã5: Transformer„ÅÆÊ¶ÇÂøµÂÆüË£ÖÔºàÁ∞°Áï•ÂåñÔºâ</h4>
<pre><code class="language-python"># ÂÆüÈöõ„ÅÆTransformer„ÅØË§áÈõë„Å™„Åü„ÇÅ„ÄÅÊ¶ÇÂøµÁöÑ„Å™ÂÆüË£Ö

class SimpleReactionTransformer:
    &quot;&quot;&quot;
    ÂèçÂøú‰∫àÊ∏¨Áî®Transformer„ÅÆÁ∞°Áï•Âåñ„É¢„Éá„É´

    ÂÆüÈöõ„ÅÆÂÆüË£Ö„Å´„ÅØ Hugging Face Transformers „ÇÑ
    Â∞ÇÈñÄ„ÉÑ„Éº„É´Ôºàrxnfp„ÄÅmolecular-transformer„Å™„Å©Ôºâ„Çí‰ΩøÁî®
    &quot;&quot;&quot;

    def __init__(self):
        # „É¢„Éá„É´„Éë„É©„É°„Éº„ÇøÔºà‰ªÆÊÉ≥Ôºâ
        self.vocab_size = 100  # „Éà„Éº„ÇØ„É≥Êï∞
        self.d_model = 512     # Âüã„ÇÅËæº„ÅøÊ¨°ÂÖÉ
        self.n_heads = 8       # „Ç¢„ÉÜ„É≥„Ç∑„Éß„É≥„Éò„ÉÉ„ÉâÊï∞
        self.n_layers = 6      # „É¨„Ç§„É§„ÉºÊï∞

    def tokenize(self, smiles):
        &quot;&quot;&quot;SMILES„Çí„Éà„Éº„ÇØ„É≥Âàó„Å´Â§âÊèõ&quot;&quot;&quot;
        # Á∞°Áï•Âåñ: ÊñáÂ≠óÂçò‰Ωç„ÅÆ„Éà„Éº„ÇØ„É≥Âåñ
        tokens = list(smiles)
        return tokens

    def predict(self, reactants_smiles):
        &quot;&quot;&quot;
        ÂèçÂøúÁâ©SMILES„Åã„ÇâÁîüÊàêÁâ©„Çí‰∫àÊ∏¨

        ÂÆüÈöõ„ÅÆÂÆüË£Ö„Åß„ÅØ:
        1. „Éà„Éº„ÇØ„É≥Âåñ
        2. Encoder„ÅßÂèçÂøúÁâ©„ÇíÁ¨¶Âè∑Âåñ
        3. Decoder„ÅßÁîüÊàêÁâ©„ÇíÁîüÊàê
        4. Beam search„ÅßTop-kÂÄôË£ú„ÇíÂá∫Âäõ
        &quot;&quot;&quot;
        # „ÉÄ„Éü„Éº‰∫àÊ∏¨
        product_smiles = &quot;CC(=O)OCC&quot;  # „Ç®„Çπ„ÉÜ„É´
        confidence = 0.87

        return {
            'product': product_smiles,
            'confidence': confidence
        }

# „É¢„Éá„É´„ÅÆ‰ΩøÁî®‰æã
model = SimpleReactionTransformer()

reactants = &quot;CC(=O)O.CCO&quot;
result = model.predict(reactants)

print(&quot;TransformerÂèçÂøú‰∫àÊ∏¨:&quot;)
print(f&quot;ÂèçÂøúÁâ©: {reactants}&quot;)
print(f&quot;‰∫àÊ∏¨ÁîüÊàêÁâ©: {result['product']}&quot;)
print(f&quot;‰ø°È†ºÂ∫¶: {result['confidence']:.2f}&quot;)

print(&quot;\nÂÆüÈöõ„ÅÆTransformer„É¢„Éá„É´:&quot;)
print(&quot;- rxnfp (https://github.com/rxn4chemistry/rxnfp)&quot;)
print(&quot;- molecular-transformer (https://github.com/pschwllr/MolecularTransformer)&quot;)
print(&quot;- IBM RXN for Chemistry (https://rxn.res.ibm.com/)&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>TransformerÂèçÂøú‰∫àÊ∏¨:
ÂèçÂøúÁâ©: CC(=O)O.CCO
‰∫àÊ∏¨ÁîüÊàêÁâ©: CC(=O)OCC
‰ø°È†ºÂ∫¶: 0.87

ÂÆüÈöõ„ÅÆTransformer„É¢„Éá„É´:
- rxnfp (https://github.com/rxn4chemistry/rxnfp)
- molecular-transformer (https://github.com/pschwllr/MolecularTransformer)
- IBM RXN for Chemistry (https://rxn.res.ibm.com/)
</code></pre>
<h3>4.2.3 ÂèçÂøúÊù°‰ª∂„ÅÆ‰∫àÊ∏¨</h3>
<p>ÂèçÂøúÊù°‰ª∂ÔºàËß¶Â™í„ÄÅÊ∫∂Â™í„ÄÅÊ∏©Â∫¶„ÄÅÊôÇÈñìÔºâ„ÅÆ‰∫àÊ∏¨„ÇÇÈáçË¶Å„Åß„Åô„ÄÇ</p>
<h4>„Ç≥„Éº„Éâ‰æã6: ÂèçÂøúÊù°‰ª∂„ÅÆÊé®Â•®</h4>
<pre><code class="language-python">from sklearn.ensemble import RandomForestClassifier

# ÂèçÂøú„Çø„Ç§„Éó„Å®Êé®Â•®Êù°‰ª∂„ÅÆ„Éû„ÉÉ„Éî„É≥„Ç∞
reaction_conditions = {
    'Esterification': {
        'catalyst': ['H2SO4', 'p-TsOH'],
        'solvent': ['Toluene', 'DCM'],
        'temperature': '60-80¬∞C',
        'time': '2-6 hours'
    },
    'Suzuki': {
        'catalyst': ['Pd(PPh3)4', 'PdCl2(dppf)'],
        'solvent': ['THF', 'Dioxane'],
        'temperature': '80-100¬∞C',
        'time': '4-12 hours'
    },
    'Amidation': {
        'catalyst': ['EDC/HOBt', 'HATU'],
        'solvent': ['DMF', 'DCM'],
        'temperature': 'RT',
        'time': '1-4 hours'
    }
}

def recommend_conditions(reaction_type):
    &quot;&quot;&quot;
    ÂèçÂøú„Çø„Ç§„Éó„Åã„ÇâÊé®Â•®Êù°‰ª∂„ÇíÂá∫Âäõ

    Parameters:
    -----------
    reaction_type : str
        ÂèçÂøú„ÅÆÁ®ÆÈ°û

    Returns:
    --------
    conditions : dict
        Êé®Â•®Êù°‰ª∂
    &quot;&quot;&quot;
    if reaction_type in reaction_conditions:
        return reaction_conditions[reaction_type]
    else:
        return {
            'catalyst': ['Unknown'],
            'solvent': ['Unknown'],
            'temperature': 'Unknown',
            'time': 'Unknown'
        }

# ‰ΩøÁî®‰æã
rxn_type = &quot;Suzuki&quot;
conditions = recommend_conditions(rxn_type)

print(f&quot;{rxn_type}„Ç´„ÉÉ„Éó„É™„É≥„Ç∞ÂèçÂøú„ÅÆÊé®Â•®Êù°‰ª∂:&quot;)
print(f&quot;Ëß¶Â™í: {', '.join(conditions['catalyst'])}&quot;)
print(f&quot;Ê∫∂Â™í: {', '.join(conditions['solvent'])}&quot;)
print(f&quot;Ê∏©Â∫¶: {conditions['temperature']}&quot;)
print(f&quot;ÊôÇÈñì: {conditions['time']}&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>Suzuki„Ç´„ÉÉ„Éó„É™„É≥„Ç∞ÂèçÂøú„ÅÆÊé®Â•®Êù°‰ª∂:
Ëß¶Â™í: Pd(PPh3)4, PdCl2(dppf)
Ê∫∂Â™í: THF, Dioxane
Ê∏©Â∫¶: 80-100¬∞C
ÊôÇÈñì: 4-12 hours
</code></pre>
<hr />
<h2>4.3 RetrosynthesisÔºàÈÄÜÂêàÊàêËß£ÊûêÔºâ</h2>
<p><strong>RetrosynthesisÔºàÈÄÜÂêàÊàêËß£ÊûêÔºâ</strong>„ÅØ„ÄÅÁõÆÊ®ôÂàÜÂ≠ê„Åã„ÇâÂá∫Áô∫ÂéüÊñô„Å∏„ÅÆÂêàÊàêÁµåË∑Ø„ÇíÈÄÜÂêë„Åç„Å´Ë®≠Ë®à„Åô„ÇãÊâãÊ≥ï„Åß„Åô„ÄÇ</p>
<div class="mermaid">
graph RL
    A[ÁõÆÊ®ôÂàÜÂ≠ê<br>Target] --> B[ÈÄÜÂêàÊàêÂàÜËß£]
    B --> C[ÂâçÈßÜ‰Ωì1]
    B --> D[ÂâçÈßÜ‰Ωì2]

    C --> E[„Åï„Çâ„Å´ÂàÜËß£]
    D --> F[„Åï„Çâ„Å´ÂàÜËß£]

    E --> G[Â∏ÇË≤©ÂéüÊñô]
    F --> H[Â∏ÇË≤©ÂéüÊñô]

    style A fill:#FF9800,color:#fff
    style G fill:#4CAF50,color:#fff
    style H fill:#4CAF50,color:#fff
</div>

<h3>4.3.1 Retrosynthesis„ÅÆÂü∫Êú¨Ê¶ÇÂøµ</h3>
<p><strong>ÂàáÊñ≠Êà¶Áï•</strong>:
1. <strong>ÂÆòËÉΩÂü∫„ÅÆÂàáÊñ≠</strong>: „Ç®„Çπ„ÉÜ„É´ ‚Üí „Ç´„É´„Éú„É≥ÈÖ∏ + „Ç¢„É´„Ç≥„Éº„É´
2. <strong>C-CÁµêÂêà„ÅÆÂàáÊñ≠</strong>: „Ç¢„É´„Ç≠„É´Èéñ ‚Üí Áü≠Èéñ + Áü≠Èéñ
3. <strong>Áí∞„ÅÆÈñãË£Ç</strong>: Áí∞Áä∂ÂåñÂêàÁâ© ‚Üí Áõ¥ÈéñÂåñÂêàÁâ©</p>
<h4>„Ç≥„Éº„Éâ‰æã7: ÂçòÁ¥î„Å™RetrosynthesisÂÆüË£Ö</h4>
<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem

def simple_retrosynthesis(target_smiles, max_depth=3):
    &quot;&quot;&quot;
    ÂçòÁ¥î„Å™RetrosynthesisÔºàÊ¶ÇÂøµÂÆüË£ÖÔºâ

    Parameters:
    -----------
    target_smiles : str
        ÁõÆÊ®ôÂàÜÂ≠ê„ÅÆSMILES
    max_depth : int
        ÊúÄÂ§ßÊé¢Á¥¢Ê∑±„Åï

    Returns:
    --------
    routes : list
        ÂêàÊàêÁµåË∑Ø„ÅÆ„É™„Çπ„Éà
    &quot;&quot;&quot;

    # ÈÄÜÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„ÉàÔºà„Ç®„Çπ„ÉÜ„É´ ‚Üí „Ç´„É´„Éú„É≥ÈÖ∏ + „Ç¢„É´„Ç≥„Éº„É´Ôºâ
    retro_templates = {
        'Ester_cleavage': '[C:1](=[O:2])[O:3][C:4]&gt;&gt;[C:1](=[O:2])[OH:3].[OH:3][C:4]',
        'Amide_cleavage': '[C:1](=[O:2])[NH:3][C:4]&gt;&gt;[C:1](=[O:2])[OH:3].[NH2:3][C:4]'
    }

    target_mol = Chem.MolFromSmiles(target_smiles)

    routes = []

    for name, template_smarts in retro_templates.items():
        rxn = AllChem.ReactionFromSmarts(template_smarts)

        # ÈÄÜÂèçÂøú„ÅÆÈÅ©Áî®
        try:
            precursors = rxn.RunReactants((target_mol,))

            for precursor_set in precursors:
                precursor_smiles = [Chem.MolToSmiles(mol)
                                    for mol in precursor_set]
                routes.append({
                    'reaction': name,
                    'precursors': precursor_smiles
                })
        except:
            pass

    return routes

# ‰ΩøÁî®‰æã: ÈÖ¢ÈÖ∏„Ç®„ÉÅ„É´„ÅÆÈÄÜÂêàÊàê
target = &quot;CC(=O)OCC&quot;  # ÈÖ¢ÈÖ∏„Ç®„ÉÅ„É´

routes = simple_retrosynthesis(target)

print(f&quot;ÁõÆÊ®ôÂàÜÂ≠ê: {target} (ÈÖ¢ÈÖ∏„Ç®„ÉÅ„É´)\n&quot;)
print(&quot;ÈÄÜÂêàÊàêÁµåË∑Ø:&quot;)
for i, route in enumerate(routes, 1):
    print(f&quot;\nÁµåË∑Ø {i}: {route['reaction']}&quot;)
    print(f&quot;  ÂâçÈßÜ‰Ωì: {' + '.join(route['precursors'])}&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>ÁõÆÊ®ôÂàÜÂ≠ê: CC(=O)OCC (ÈÖ¢ÈÖ∏„Ç®„ÉÅ„É´)

ÈÄÜÂêàÊàêÁµåË∑Ø:

ÁµåË∑Ø 1: Ester_cleavage
  ÂâçÈßÜ‰Ωì: CC(=O)O + CCO
</code></pre>
<h3>4.3.2 AiZynthFinder</h3>
<p><strong>AiZynthFinder</strong>„ÅØ„ÄÅ„Çπ„Ç¶„Çß„Éº„Éá„É≥AstraZenecaÁ§æ„ÅåÈñãÁô∫„Åó„Åü„Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„ÅÆÈÄÜÂêàÊàê„ÉÑ„Éº„É´„Åß„Åô„ÄÇ</p>
<h4>„Ç≥„Éº„Éâ‰æã8: AiZynthFinder„ÅÆÊ¶ÇÂøµÔºà„Ç§„É≥„Çπ„Éà„Éº„É´„Ç¨„Ç§„ÉâÔºâ</h4>
<pre><code class="language-python">&quot;&quot;&quot;
AiZynthFinder„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´„Å®‰ΩøÁî®

# „Ç§„É≥„Çπ„Éà„Éº„É´
pip install aizynthfinder

# ÂøÖË¶Å„Å™„Éá„Éº„ÇøÔºà„É¢„Éá„É´„Å®„ÉÜ„É≥„Éó„É¨„Éº„ÉàÔºâ
# https://github.com/MolecularAI/aizynthfinder „Åã„Çâ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ

# Âü∫Êú¨ÁöÑ„Å™‰ΩøÁî®‰æã
from aizynthfinder.aizynthfinder import AiZynthFinder

# Ë®≠ÂÆö„Éï„Ç°„Ç§„É´„ÅÆË™≠„ÅøËæº„Åø
finder = AiZynthFinder(configfile='config.yml')

# ÁõÆÊ®ôÂàÜÂ≠ê„ÅÆË®≠ÂÆö
finder.target_smiles = &quot;CC(=O)Oc1ccccc1C(=O)O&quot;  # „Ç¢„Çπ„Éî„É™„É≥

# ÂêàÊàêÁµåË∑Ø„ÅÆÊé¢Á¥¢
finder.tree_search()

# ÁµêÊûú„ÅÆÂèñÂæó
finder.build_routes()
routes = finder.routes

# Top-5ÁµåË∑Ø„ÅÆË°®Á§∫
for i, route in enumerate(routes[:5], 1):
    print(f&quot;ÁµåË∑Ø {i}:&quot;)
    print(f&quot;  „Çπ„ÉÜ„ÉÉ„ÉóÊï∞: {route.number_of_steps}&quot;)
    print(f&quot;  „Çπ„Ç≥„Ç¢: {route.score:.3f}&quot;)

# ÁµåË∑Ø„ÅÆÂèØË¶ñÂåñ
route.to_image().save(f'route_{i}.png')
&quot;&quot;&quot;

print(&quot;AiZynthFinder„ÅÆË©≥Á¥∞:&quot;)
print(&quot;- GitHub: https://github.com/MolecularAI/aizynthfinder&quot;)
print(&quot;- Ë´ñÊñá: Genheden et al., J. Chem. Inf. Model. 2020&quot;)
print(&quot;- ÁâπÂæ¥: „É¢„É≥„ÉÜ„Ç´„É´„É≠Êú®Êé¢Á¥¢ + Ê∑±Â±§Â≠¶Áøí&quot;)
</code></pre>
<h3>4.3.3 IBM RXN for Chemistry</h3>
<p><strong>IBM RXN for Chemistry</strong>„ÅØ„ÄÅIBM„ÅåÈñãÁô∫„Åó„ÅüWeb„Éô„Éº„Çπ„ÅÆÂèçÂøú‰∫àÊ∏¨„ÉªÈÄÜÂêàÊàê„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†„Åß„Åô„ÄÇ</p>
<h4>„Ç≥„Éº„Éâ‰æã9: RXN API„ÅÆ‰ΩøÁî®ÔºàÊ¶ÇÂøµÔºâ</h4>
<pre><code class="language-python">&quot;&quot;&quot;
IBM RXN for Chemistry API„ÅÆ‰ΩøÁî®

# API„Ç≠„Éº„ÅÆÂèñÂæó
# https://rxn.res.ibm.com/ „Åß„Ç¢„Ç´„Ç¶„É≥„Éà‰ΩúÊàê

# Python SDK„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´
pip install rxn4chemistry

# Âü∫Êú¨ÁöÑ„Å™‰ΩøÁî®‰æã
from rxn4chemistry import RXN4ChemistryWrapper

# API„É©„ÉÉ„Éë„Éº„ÅÆÂàùÊúüÂåñ
rxn = RXN4ChemistryWrapper(api_key='YOUR_API_KEY')

# „Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆ‰ΩúÊàê
project_id = rxn.create_project('My Project')
rxn.set_project(project_id)

# Retrosynthesis„ÅÆÂÆüË°å
target_smiles = &quot;CC(=O)Oc1ccccc1C(=O)O&quot;  # „Ç¢„Çπ„Éî„É™„É≥

response = rxn.predict_automatic_retrosynthesis(
    product=target_smiles,
    max_steps=3
)

# ÁµêÊûú„ÅÆÂèñÂæó
retro_id = response['prediction_id']
results = rxn.get_predict_automatic_retrosynthesis_results(retro_id)

# ÁµåË∑Ø„ÅÆË°®Á§∫
for i, sequence in enumerate(results['sequences'][:5], 1):
    print(f&quot;ÁµåË∑Ø {i}:&quot;)
    print(f&quot;  ‰ø°È†ºÂ∫¶: {sequence['confidence']:.2f}&quot;)
    for step in sequence['steps']:
        print(f&quot;  - {step['smiles']}&quot;)
&quot;&quot;&quot;

print(&quot;IBM RXN for Chemistry:&quot;)
print(&quot;- URL: https://rxn.res.ibm.com/&quot;)
print(&quot;- Ê©üËÉΩ: ÂèçÂøú‰∫àÊ∏¨„ÄÅÈÄÜÂêàÊàê„ÄÅÂÆüÈ®ìË®àÁîª&quot;)
print(&quot;- ÁâπÂæ¥: Transformer + USPTO 180‰∏áÂèçÂøú„Éá„Éº„Çø&quot;)
</code></pre>
<h3>4.3.4 ÂêàÊàêÁµåË∑Ø„ÅÆË©ï‰æ°</h3>
<h4>„Ç≥„Éº„Éâ‰æã10: ÂêàÊàêÁµåË∑Ø„ÅÆ„Çπ„Ç≥„Ç¢„É™„É≥„Ç∞</h4>
<pre><code class="language-python">def score_synthesis_route(route):
    &quot;&quot;&quot;
    ÂêàÊàêÁµåË∑Ø„Çí„Çπ„Ç≥„Ç¢„É™„É≥„Ç∞

    Ë©ï‰æ°Âü∫Ê∫ñ:
    1. „Çπ„ÉÜ„ÉÉ„ÉóÊï∞ÔºàÂ∞ë„Å™„ÅÑ„Åª„Å©ËâØ„ÅÑÔºâ
    2. ÂèéÁéáÔºàÈ´ò„ÅÑ„Åª„Å©ËâØ„ÅÑÔºâ
    3. „Ç≥„Çπ„ÉàÔºà‰Ωé„ÅÑ„Åª„Å©ËâØ„ÅÑÔºâ
    4. Ë©¶Ëñ¨„ÅÆÂÖ•ÊâãÊÄßÔºàÂÆπÊòì„Å™„Åª„Å©ËâØ„ÅÑÔºâ

    Returns:
    --------
    score : float
        Á∑èÂêà„Çπ„Ç≥„Ç¢Ôºà0-100Ôºâ
    &quot;&quot;&quot;

    # ‰ªÆÊÉ≥ÁöÑ„Å™ÁµåË∑Ø„Éá„Éº„Çø
    n_steps = route.get('n_steps', 5)
    avg_yield = route.get('avg_yield', 75)  # %
    cost = route.get('cost', 500)  # USD
    availability = route.get('availability', 0.8)  # 0-1

    # „Çπ„Ç≥„Ç¢Ë®àÁÆóÔºàÈáç„Åø‰ªò„ÅçÔºâ
    step_score = max(0, 100 - n_steps * 10)  # 1„Çπ„ÉÜ„ÉÉ„ÉóÊ∏õ„Åß+10ÁÇπ
    yield_score = avg_yield  # ÂèéÁéá„Åù„ÅÆ„Åæ„Åæ
    cost_score = max(0, 100 - cost / 10)  # $10„Åß-1ÁÇπ
    availability_score = availability * 100

    # Èáç„Åø‰ªò„ÅçÂπ≥Âùá
    total_score = (
        step_score * 0.3 +
        yield_score * 0.4 +
        cost_score * 0.2 +
        availability_score * 0.1
    )

    return total_score

# „Çµ„É≥„Éó„É´ÁµåË∑Ø„ÅÆË©ï‰æ°
routes = [
    {
        'name': 'ÁµåË∑ØA',
        'n_steps': 3,
        'avg_yield': 85,
        'cost': 300,
        'availability': 0.9
    },
    {
        'name': 'ÁµåË∑ØB',
        'n_steps': 5,
        'avg_yield': 90,
        'cost': 200,
        'availability': 0.7
    },
    {
        'name': 'ÁµåË∑ØC',
        'n_steps': 4,
        'avg_yield': 75,
        'cost': 400,
        'availability': 0.8
    }
]

print(&quot;=== ÂêàÊàêÁµåË∑Ø„ÅÆË©ï‰æ° ===\n&quot;)
for route in routes:
    score = score_synthesis_route(route)
    print(f&quot;{route['name']}:&quot;)
    print(f&quot;  „Çπ„ÉÜ„ÉÉ„ÉóÊï∞: {route['n_steps']}&quot;)
    print(f&quot;  Âπ≥ÂùáÂèéÁéá: {route['avg_yield']}%&quot;)
    print(f&quot;  „Ç≥„Çπ„Éà: ${route['cost']}&quot;)
    print(f&quot;  ÂÖ•ÊâãÊÄß: {route['availability']:.1f}&quot;)
    print(f&quot;  Á∑èÂêà„Çπ„Ç≥„Ç¢: {score:.1f} / 100\n&quot;)

# ÊúÄËâØÁµåË∑Ø„ÅÆÈÅ∏Êäû
best_route = max(routes, key=score_synthesis_route)
print(f&quot;Êé®Â•®ÁµåË∑Ø: {best_route['name']} &quot;
      f&quot;(„Çπ„Ç≥„Ç¢: {score_synthesis_route(best_route):.1f})&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>=== ÂêàÊàêÁµåË∑Ø„ÅÆË©ï‰æ° ===

ÁµåË∑ØA:
  „Çπ„ÉÜ„ÉÉ„ÉóÊï∞: 3
  Âπ≥ÂùáÂèéÁéá: 85%
  „Ç≥„Çπ„Éà: $300
  ÂÖ•ÊâãÊÄß: 0.9
  Á∑èÂêà„Çπ„Ç≥„Ç¢: 83.0 / 100

ÁµåË∑ØB:
  „Çπ„ÉÜ„ÉÉ„ÉóÊï∞: 5
  Âπ≥ÂùáÂèéÁéá: 90%
  „Ç≥„Çπ„Éà: $200
  ÂÖ•ÊâãÊÄß: 0.7
  Á∑èÂêà„Çπ„Ç≥„Ç¢: 81.0 / 100

ÁµåË∑ØC:
  „Çπ„ÉÜ„ÉÉ„ÉóÊï∞: 4
  Âπ≥ÂùáÂèéÁéá: 75%
  „Ç≥„Çπ„Éà: $400
  ÂÖ•ÊâãÊÄß: 0.8
  Á∑èÂêà„Çπ„Ç≥„Ç¢: 70.0 / 100

Êé®Â•®ÁµåË∑Ø: ÁµåË∑ØA („Çπ„Ç≥„Ç¢: 83.0)
</code></pre>
<hr />
<h2>4.4 ÂÆü‰∏ñÁïåÂøúÁî®„Å®„Ç≠„É£„É™„Ç¢„Éë„Çπ</h2>
<h3>4.4.1 Ë£ΩËñ¨‰ºÅÊ•≠„Åß„ÅÆ„Ç±„É¢„Ç§„É≥„Éï„Ç©„Éû„ÉÜ„Ç£„ÇØ„ÇπÊ¥ªÁî®</h3>
<h4>‰∏ªË¶Å‰ºÅÊ•≠„ÅÆ‰∫ã‰æã</h4>
<p><strong>PfizerÔºà„Éï„Ç°„Ç§„Ç∂„ÉºÔºâ</strong>:
- AIÂâµËñ¨„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†: IBM Watson HealthÈÄ£Êê∫
- ÂøúÁî®: COVID-19Ê≤ªÁôÇËñ¨Paxlovid„ÅÆËøÖÈÄüÈñãÁô∫
- ÊäÄË°ì: QSAR„ÄÅ‰ªÆÊÉ≥„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞„ÄÅRetrosynthesis</p>
<p><strong>RocheÔºà„É≠„Ç∑„É•Ôºâ</strong>:
- ÂÜÖË£ΩAI„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†: Roche Pharma Research &amp; Early Development (pRED)
- ÂøúÁî®: Êäó„Åå„ÇìÂâ§„ÅÆÊúÄÈÅ©Âåñ
- ÊäÄË°ì: Graph Neural Networks„ÄÅËª¢ÁßªÂ≠¶Áøí</p>
<p><strong>NovartisÔºà„Éé„Éê„É´„ÉÜ„Ç£„ÇπÔºâ</strong>:
- Microsoft AIÈÄ£Êê∫„Éó„É≠„Ç∏„Çß„ÇØ„Éà
- ÂøúÁî®: Â∏åÂ∞ëÁñæÊÇ£Ê≤ªÁôÇËñ¨„ÅÆÊé¢Á¥¢
- ÊäÄË°ì: Ëá™ÁÑ∂Ë®ÄË™ûÂá¶ÁêÜ„ÄÅÂàÜÂ≠êÁîüÊàê„É¢„Éá„É´</p>
<h3>4.4.2 ÊùêÊñô„É°„Éº„Ç´„Éº„Åß„ÅÆÂøúÁî®</h3>
<p><strong>Êó≠ÂåñÊàê</strong>:
- „Éû„ÉÜ„É™„Ç¢„É´„Ç∫„Éª„Ç§„É≥„Éï„Ç©„Éû„ÉÜ„Ç£„ÇØ„ÇπÈÉ®ÈñÄ
- ÂøúÁî®: È´òÂàÜÂ≠êÊùêÊñô„ÅÆÁâ©ÊÄß‰∫àÊ∏¨
- ÊäÄË°ì: QSPR„ÄÅÊ©üÊ¢∞Â≠¶Áøí</p>
<p><strong>‰∏âËè±„Ç±„Éü„Ç´„É´</strong>:
- „Éá„Ç∏„Çø„É´„Éà„É©„É≥„Çπ„Éï„Ç©„Éº„É°„Éº„Ç∑„Éß„É≥Êé®ÈÄ≤
- ÂøúÁî®: Ëß¶Â™íË®≠Ë®à„ÄÅ„Éó„É≠„Çª„ÇπÊúÄÈÅ©Âåñ
- ÊäÄË°ì: „Éô„Ç§„Ç∫ÊúÄÈÅ©Âåñ„ÄÅËÉΩÂãïÂ≠¶Áøí</p>
<h3>4.4.3 „Çπ„Çø„Éº„Éà„Ç¢„ÉÉ„Éó‰∫ã‰æã</h3>
<p><strong>Recursion PharmaceuticalsÔºàÁ±≥ÂõΩÔºâ</strong>:
- ÊôÇ‰æ°Á∑èÈ°ç: Á¥Ñ20ÂÑÑ„Éâ„É´Ôºà2023Âπ¥Ôºâ
- ÊäÄË°ì: ÁîªÂÉèËß£Êûê + „Ç±„É¢„Ç§„É≥„Éï„Ç©„Éû„ÉÜ„Ç£„ÇØ„Çπ
- ÊàêÊûú: 100‰ª•‰∏ä„ÅÆËá®Â∫ä„Éë„Ç§„Éó„É©„Ç§„É≥</p>
<p><strong>BenevolentAIÔºàËã±ÂõΩÔºâ</strong>:
- ÊôÇ‰æ°Á∑èÈ°ç: Á¥Ñ20ÂÑÑ„Éâ„É´
- ÊäÄË°ì: Knowledge Graph + AIÂâµËñ¨
- ÊàêÊûú: COVID-19Ê≤ªÁôÇËñ¨ÂÄôË£ú„ÅÆÁô∫Ë¶ãÔºà6ÈÄ±ÈñìÔºâ</p>
<p><strong>ExscientiaÔºàËã±ÂõΩÔºâ</strong>:
- ‰∏ñÁïåÂàù„ÅÆAIË®≠Ë®àËñ¨„ÅÆËá®Â∫äË©¶È®ìÔºà2020Âπ¥Ôºâ
- ÊäÄË°ì: ËÉΩÂãïÂ≠¶Áøí + Retrosynthesis
- „Éë„Éº„Éà„Éä„Éº: Bayer„ÄÅRoche</p>
<h3>4.4.4 „Ç≠„É£„É™„Ç¢„Éë„Çπ</h3>
<h4>„Ç±„É¢„Ç§„É≥„Éï„Ç©„Éû„ÉÜ„Ç£„Ç∑„É£„É≥„ÅÆ„Ç≠„É£„É™„Ç¢</h4>
<div class="mermaid">
graph TD
    A[Â≠¶ÈÉ®Âçí<br>ÂåñÂ≠¶„ÉªÊÉÖÂ†±ÁßëÂ≠¶] --> B[‰øÆÂ£´Ë™≤Á®ã<br>„Ç±„É¢„Ç§„É≥„Éï„Ç©Â∞ÇÊîª]
    A --> C[Áã¨Â≠¶<br>„Ç™„É≥„É©„Ç§„É≥Â≠¶Áøí]

    B --> D[ÂçöÂ£´Ë™≤Á®ã<br>3-5Âπ¥]
    C --> E[„Ç∏„É•„Éã„Ç¢<br>„Ç±„É¢„Ç§„É≥„Éï„Ç©„Éû]

    D --> F[„Éù„Çπ„Éâ„ÇØ<br>2-3Âπ¥]
    E --> F

    F --> G[„Ç∑„Éã„Ç¢<br>„Ç±„É¢„Ç§„É≥„Éï„Ç©„Éû]
    G --> H[„Éó„É™„É≥„Ç∑„Éë„É´<br>„Çµ„Ç§„Ç®„É≥„ÉÜ„Ç£„Çπ„Éà]
    H --> I[„Éá„Ç£„É¨„ÇØ„Çø„Éº<br>Á†îÁ©∂ÈÉ®ÈñÄÈï∑]

    G --> J[„Çπ„Çø„Éº„Éà„Ç¢„ÉÉ„Éó<br>ÂâµÊ•≠]

    style A fill:#e3f2fd
    style I fill:#4CAF50,color:#fff
    style J fill:#FF9800,color:#fff
</div>

<h4>ÂøÖË¶Å„Å™„Çπ„Ç≠„É´</h4>
<p><strong>ÊäÄË°ì„Çπ„Ç≠„É´</strong>:
- [ ] <strong>„Éó„É≠„Ç∞„É©„Éü„É≥„Ç∞</strong>: PythonÔºàÂøÖÈ†àÔºâ„ÄÅR„ÄÅC++
- [ ] <strong>„Ç±„É¢„Ç§„É≥„Éï„Ç©„ÉÑ„Éº„É´</strong>: RDKit„ÄÅmordred„ÄÅOpen Babel
- [ ] <strong>Ê©üÊ¢∞Â≠¶Áøí</strong>: scikit-learn„ÄÅLightGBM„ÄÅPyTorch
- [ ] <strong>Ê∑±Â±§Â≠¶Áøí</strong>: GNN„ÄÅTransformer
- [ ] <strong>„Éá„Éº„Çø„Éô„Éº„Çπ</strong>: ChEMBL„ÄÅPubChem„ÄÅUSPTO</p>
<p><strong>„Éâ„É°„Ç§„É≥Áü•Ë≠ò</strong>:
- [ ] <strong>ÊúâÊ©üÂåñÂ≠¶</strong>: ÂèçÂøúÊ©üÊßã„ÄÅÂÆòËÉΩÂü∫Â§âÊèõ
- [ ] <strong>ÂåªËñ¨ÂåñÂ≠¶</strong>: ADMET„ÄÅÂâµËñ¨„Éó„É≠„Çª„Çπ
- [ ] <strong>Áµ±Ë®àÂ≠¶</strong>: ÂÆüÈ®ìË®àÁîªÊ≥ï„ÄÅÂõ†ÊûúÊé®Ë´ñ</p>
<p><strong>„ÇΩ„Éï„Éà„Çπ„Ç≠„É´</strong>:
- [ ] <strong>„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥</strong>: ÂåñÂ≠¶ËÄÖ„Å®„Éá„Éº„Çø„Çµ„Ç§„Ç®„É≥„ÉÜ„Ç£„Çπ„Éà„ÅÆÊ©ãÊ∏°„Åó
- [ ] <strong>„Éó„É≠„Ç∏„Çß„ÇØ„ÉàÁÆ°ÁêÜ</strong>: Ë§áÊï∞„Éó„É≠„Ç∏„Çß„ÇØ„Éà„ÅÆ‰∏¶Ë°åÊé®ÈÄ≤
- [ ] <strong>„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥</strong>: ÁµåÂñ∂Â±§„Å∏„ÅÆÊäÄË°ìË™¨Êòé</p>
<h4>Âπ¥Âèé„É¨„É≥„Ç∏ÔºàÊó•Êú¨„ÄÅ2023Âπ¥Ôºâ</h4>
<table>
<thead>
<tr>
<th>ËÅ∑‰Ωç</th>
<th>Âπ¥ÂèéÁØÑÂõ≤</th>
<th>ÁµåÈ®ìÂπ¥Êï∞</th>
</tr>
</thead>
<tbody>
<tr>
<td>„Ç∏„É•„Éã„Ç¢</td>
<td>500-700‰∏áÂÜÜ</td>
<td>0-3Âπ¥</td>
</tr>
<tr>
<td>„Éü„Éâ„É´</td>
<td>700-1,000‰∏áÂÜÜ</td>
<td>3-7Âπ¥</td>
</tr>
<tr>
<td>„Ç∑„Éã„Ç¢</td>
<td>1,000-1,500‰∏áÂÜÜ</td>
<td>7-15Âπ¥</td>
</tr>
<tr>
<td>„Éó„É™„É≥„Ç∑„Éë„É´</td>
<td>1,500-2,500‰∏áÂÜÜ</td>
<td>15Âπ¥‰ª•‰∏ä</td>
</tr>
<tr>
<td>„Éá„Ç£„É¨„ÇØ„Çø„Éº</td>
<td>2,000-3,500‰∏áÂÜÜ</td>
<td>ÁÆ°ÁêÜËÅ∑</td>
</tr>
</tbody>
</table>
<p>ÔºàÂ§ñË≥áÁ≥ªË£ΩËñ¨‰ºÅÊ•≠„Åß„ÅØ1.5-2ÂÄçÁ®ãÂ∫¶Ôºâ</p>
<hr />
<h2>ÊºîÁøíÂïèÈ°å</h2>
<h3>ÊºîÁøí1: ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅÆ‰ΩúÊàê</h3>
<p>‰ª•‰∏ã„ÅÆÂèçÂøú„Å´„Å§„ÅÑ„Å¶„ÄÅSMARTSÂΩ¢Âºè„ÅÆÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„Çí‰ΩúÊàê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<p><strong>Friedel-Crafts „Ç¢„Ç∑„É´ÂåñÂèçÂøú</strong>:
„Éô„É≥„Çº„É≥Áí∞ + ÈÖ∏„ÇØ„É≠„É™„Éâ ‚Üí „Ç±„Éà„É≥ + HCl</p>
<details>
<summary>Ëß£Á≠î‰æã</summary>


<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem

# Friedel-Crafts „Ç¢„Ç∑„É´Âåñ„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà
friedel_crafts_template = &quot;[c:1][H:2].[C:3](=[O:4])[Cl:5]&gt;&gt;[c:1][C:3](=[O:4]).[H:2][Cl:5]&quot;

# ÂèçÂøú„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„ÅÆ‰ΩúÊàê
rxn = AllChem.ReactionFromSmarts(friedel_crafts_template)

# „ÉÜ„Çπ„Éà: „Éô„É≥„Çº„É≥ + „Ç¢„Çª„ÉÅ„É´„ÇØ„É≠„É™„Éâ
reactants = [
    Chem.MolFromSmiles(&quot;c1ccccc1&quot;),  # „Éô„É≥„Çº„É≥
    Chem.MolFromSmiles(&quot;CC(=O)Cl&quot;)   # „Ç¢„Çª„ÉÅ„É´„ÇØ„É≠„É™„Éâ
]

# ÂèçÂøú„ÅÆÂÆüË°å
products = rxn.RunReactants(tuple(reactants))

print(&quot;Friedel-Crafts „Ç¢„Ç∑„É´ÂåñÂèçÂøú:&quot;)
print(f&quot;ÂèçÂøúÁâ©: {Chem.MolToSmiles(reactants[0])} + {Chem.MolToSmiles(reactants[1])}&quot;)

if products:
    for product_set in products[:1]:  # ÊúÄÂàù„ÅÆÁîüÊàêÁâ©„Çª„ÉÉ„Éà
        for mol in product_set:
            Chem.SanitizeMol(mol)
            print(f&quot;ÁîüÊàêÁâ©: {Chem.MolToSmiles(mol)}&quot;)
</code></pre>


**ÊúüÂæÖ„Åï„Çå„ÇãÂá∫Âäõ:**

<pre><code>Friedel-Crafts „Ç¢„Ç∑„É´ÂåñÂèçÂøú:
ÂèçÂøúÁâ©: c1ccccc1 + CC(=O)Cl
ÁîüÊàêÁâ©: CC(=O)c1ccccc1
ÁîüÊàêÁâ©: Cl
</code></pre>


</details>

<hr />
<h3>ÊºîÁøí2: Ë§áÊï∞„ÅÆÈÄÜÂêàÊàêÁµåË∑Ø„ÅÆÊØîËºÉ</h3>
<p>‰ª•‰∏ã„ÅÆÁõÆÊ®ôÂàÜÂ≠ê„Å´„Å§„ÅÑ„Å¶„ÄÅÂ∞ë„Å™„Åè„Å®„ÇÇ2„Å§„ÅÆÁï∞„Å™„ÇãÈÄÜÂêàÊàêÁµåË∑Ø„ÇíÊèêÊ°à„Åó„ÄÅ„Åù„Çå„Åû„Çå„ÅÆ„Çπ„Ç≥„Ç¢„ÇíË®àÁÆó„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<p><strong>ÁõÆÊ®ôÂàÜÂ≠ê</strong>: IbuprofenÔºà„Ç§„Éñ„Éó„É≠„Éï„Çß„É≥Ôºâ
- SMILES: <code>CC(C)Cc1ccc(cc1)C(C)C(=O)O</code></p>
<details>
<summary>„Éí„É≥„Éà</summary>

1. Friedel-Crafts „Ç¢„É´„Ç≠„É´Âåñ ‚Üí ÈÖ∏Âåñ
2. Suzuki-Miyaura„Ç´„ÉÉ„Éó„É™„É≥„Ç∞ ‚Üí „Ç´„É´„Éú„Ç≠„Ç∑„É´Âåñ

ÂêÑÁµåË∑Ø„ÅÆ„Çπ„ÉÜ„ÉÉ„ÉóÊï∞„ÄÅ‰∫àÊÉ≥ÂèéÁéá„ÄÅË©¶Ëñ¨„ÅÆÂÖ•ÊâãÊÄß„ÇíËÄÉÊÖÆ„Åó„Å¶„Çπ„Ç≥„Ç¢„É™„É≥„Ç∞

</details>

<hr />
<h3>ÊºîÁøí3: ÂèçÂøúÂèéÁéá‰∫àÊ∏¨„É¢„Éá„É´„ÅÆÊîπÂñÑ</h3>
<p>„Ç≥„Éº„Éâ‰æã4„ÅÆÂèçÂøúÂèéÁéá‰∫àÊ∏¨„É¢„Éá„É´„ÇíÊîπÂñÑ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‰ª•‰∏ã„ÅÆÊâãÊ≥ï„ÇíË©¶„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö</p>
<ol>
<li>ÂèçÂøúÊù°‰ª∂ÔºàÊ∏©Â∫¶„ÄÅËß¶Â™íÔºâ„ÇíÁâπÂæ¥Èáè„Å´ËøΩÂä†</li>
<li>LightGBM„ÇÑ„Éã„É•„Éº„É©„É´„Éç„ÉÉ„Éà„ÉØ„Éº„ÇØ„Çí‰ΩøÁî®</li>
<li>‰∫§Â∑ÆÊ§úË®º„Åß„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„Çø„ÇíÊúÄÈÅ©Âåñ</li>
</ol>
<p>ÁõÆÊ®ô: R¬≤ &gt; 0.8„ÄÅMAE &lt; 5%</p>
<details>
<summary>Ëß£Á≠î„ÅÆÊñπÂêëÊÄß</summary>


<pre><code class="language-python"># 1. ÂèçÂøúÊù°‰ª∂„Çíone-hot encoding„ÅßËøΩÂä†
from sklearn.preprocessing import OneHotEncoder

conditions = ['catalyst', 'solvent', 'temperature']
# ... ÁâπÂæ¥Èáè„Å´ËøΩÂä†

# 2. LightGBM„ÅÆ‰ΩøÁî®
import lightgbm as lgb

params = {
    'objective': 'regression',
    'metric': 'mae',
    'num_leaves': 31,
    'learning_rate': 0.05
}
# ... Ë®ìÁ∑¥

# 3. OptunaÁ≠â„Åß„Éè„Ç§„Éë„Éº„Éë„É©„É°„Éº„ÇøÊúÄÈÅ©Âåñ
import optuna

def objective(trial):
    params = {
        'num_leaves': trial.suggest_int('num_leaves', 10, 100),
        'learning_rate': trial.suggest_float('learning_rate', 0.01, 0.1)
    }
    # ... Ë©ï‰æ°
    return mae

study = optuna.create_study(direction='minimize')
study.optimize(objective, n_trials=50)
</code></pre>


</details>

<hr />
<h2>„Åæ„Å®„ÇÅ</h2>
<p>„Åì„ÅÆÁ´†„Åß„ÅØ„ÄÅ‰ª•‰∏ã„ÇíÂ≠¶„Å≥„Åæ„Åó„ÅüÔºö</p>
<h3>Â≠¶Áøí„Åó„ÅüÂÜÖÂÆπ</h3>
<ol>
<li>
<p><strong>ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„Å®SMARTS</strong>
   - ÂèçÂøúSMILES„Å®SMIRKS„ÅÆË®òÊ≥ï
   - ÂèçÂøú„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅÆÂÆöÁæ©„Å®ÈÅ©Áî®
   - USPTOÂèçÂøú„Éá„Éº„Çø„Çª„ÉÉ„Éà</p>
</li>
<li>
<p><strong>ÂèçÂøú‰∫àÊ∏¨„É¢„Éá„É´</strong>
   - Random Forest„Å´„Çà„ÇãÂèéÁéá‰∫àÊ∏¨
   - Transformer„Å´„Çà„ÇãÁîüÊàêÁâ©‰∫àÊ∏¨
   - ÂèçÂøúÊù°‰ª∂„ÅÆÊé®Â•®</p>
</li>
<li>
<p><strong>Retrosynthesis</strong>
   - ÈÄÜÂêàÊàêËß£Êûê„ÅÆÂü∫Êú¨Ê¶ÇÂøµ
   - AiZynthFinder„ÄÅIBM RXN for Chemistry
   - ÂêàÊàêÁµåË∑Ø„ÅÆ„Çπ„Ç≥„Ç¢„É™„É≥„Ç∞</p>
</li>
<li>
<p><strong>Áî£Ê•≠ÂøúÁî®„Å®„Ç≠„É£„É™„Ç¢</strong>
   - Ë£ΩËñ¨‰ºÅÊ•≠ÔºàPfizer„ÄÅRoche„ÄÅNovartisÔºâ
   - ÊùêÊñô„É°„Éº„Ç´„ÉºÔºàÊó≠ÂåñÊàê„ÄÅ‰∏âËè±„Ç±„Éü„Ç´„É´Ôºâ
   - „Çπ„Çø„Éº„Éà„Ç¢„ÉÉ„ÉóÔºàRecursion„ÄÅBenevolentAI„ÄÅExscientiaÔºâ
   - „Ç±„É¢„Ç§„É≥„Éï„Ç©„Éû„ÉÜ„Ç£„Ç∑„É£„É≥„ÅÆ„Ç≠„É£„É™„Ç¢„Éë„Çπ</p>
</li>
</ol>
<h3>„Ç∑„É™„Éº„Ç∫ÂÆå‰∫Ü</h3>
<p>„Åä„ÇÅ„Åß„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ„Ç±„É¢„Ç§„É≥„Éï„Ç©„Éû„ÉÜ„Ç£„ÇØ„ÇπÂÖ•ÈñÄ„Ç∑„É™„Éº„Ç∫„ÅÆÂÖ®4Á´†„ÇíÂÆå‰∫Ü„Åó„Åæ„Åó„Åü„ÄÇ</p>
<p><strong>ÁøíÂæó„Åó„Åü„Çπ„Ç≠„É´</strong>:
- ‚úÖ ÂàÜÂ≠êË°®Áèæ„Å®RDKitÊìç‰Ωú
- ‚úÖ QSAR/QSPR„É¢„Éá„É™„É≥„Ç∞
- ‚úÖ ÂåñÂ≠¶Á©∫ÈñìÊé¢Á¥¢„Å®È°û‰ººÊÄßÊ§úÁ¥¢
- ‚úÖ ÂèçÂøú‰∫àÊ∏¨„Å®Retrosynthesis</p>
<p><strong>Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó</strong>:
1. <strong>GNNÂÖ•ÈñÄ„Ç∑„É™„Éº„Ç∫</strong>: Graph Neural Networks„Å´„Çà„ÇãÂàÜÂ≠êË°®ÁèæÂ≠¶Áøí
2. <strong>Áã¨Ëá™„Éó„É≠„Ç∏„Çß„ÇØ„Éà</strong>: ChEMBL„Éá„Éº„Çø„Çí‰Ωø„Å£„ÅüÂ§ßË¶èÊ®°QSAR
3. <strong>„Ç≥„Éü„É•„Éã„ÉÜ„Ç£ÂèÇÂä†</strong>: RDKit Users Group„ÄÅÊó•Êú¨ÂåñÂ≠¶‰ºöÊÉÖÂ†±ÂåñÂ≠¶ÈÉ®‰ºö
4. <strong>Ë´ñÊñáÊäïÁ®ø</strong>: Journal of Cheminformatics„ÄÅJ. Chem. Inf. Model.</p>
<p><strong><a href="./index.html">„Ç∑„É™„Éº„Ç∫„Éà„ÉÉ„Éó„Å∏ ‚Üí</a></strong></p>
<hr />
<h2>ÂèÇËÄÉÊñáÁåÆ</h2>
<ol>
<li>Coley, C. W. et al. (2017). "Prediction of Organic Reaction Outcomes Using Machine Learning." <em>ACS Central Science</em>, 3(5), 434-443. DOI: 10.1021/acscentsci.7b00064</li>
<li>Schwaller, P. et al. (2019). "Molecular Transformer: A Model for Uncertainty-Calibrated Chemical Reaction Prediction." <em>ACS Central Science</em>, 5(9), 1572-1583. DOI: 10.1021/acscentsci.9b00576</li>
<li>Genheden, S. et al. (2020). "AiZynthFinder: a fast, robust and flexible open-source software for retrosynthetic planning." <em>J. Cheminformatics</em>, 12, 70. DOI: 10.1186/s13321-020-00472-1</li>
<li>Lowe, D. M. (2012). <em>Extraction of chemical structures and reactions from the literature</em>. PhD thesis, University of Cambridge.</li>
</ol>
<hr />
<p><strong><a href="./chapter-3.html">‚Üê Á¨¨3Á´†</a></strong> | <strong><a href="./index.html">„Ç∑„É™„Éº„Ç∫„Éà„ÉÉ„Éó„Å∏</a></strong></p>
<hr />
<h2>ËøΩÂä†„É™„ÇΩ„Éº„Çπ</h2>
<h3>„Ç™„Éº„Éó„É≥„ÇΩ„Éº„Çπ„ÉÑ„Éº„É´</h3>
<table>
<thead>
<tr>
<th>„ÉÑ„Éº„É´Âêç</th>
<th>Ë™¨Êòé</th>
<th>GitHub</th>
</tr>
</thead>
<tbody>
<tr>
<td>RDKit</td>
<td>ÂåÖÊã¨ÁöÑ„Ç±„É¢„Ç§„É≥„Éï„Ç©„É©„Ç§„Éñ„É©„É™</td>
<td><a href="https://github.com/rdkit/rdkit">rdkit/rdkit</a></td>
</tr>
<tr>
<td>AiZynthFinder</td>
<td>ÈÄÜÂêàÊàêËß£Êûê„ÉÑ„Éº„É´</td>
<td><a href="https://github.com/MolecularAI/aizynthfinder">MolecularAI/aizynthfinder</a></td>
</tr>
<tr>
<td>rxnfp</td>
<td>ÂèçÂøúÊåáÁ¥ã„ÉªTransformer</td>
<td><a href="https://github.com/rxn4chemistry/rxnfp">rxn4chemistry/rxnfp</a></td>
</tr>
<tr>
<td>Molecular Transformer</td>
<td>ÂèçÂøú‰∫àÊ∏¨Transformer</td>
<td><a href="https://github.com/pschwllr/MolecularTransformer">pschwllr/MolecularTransformer</a></td>
</tr>
</tbody>
</table>
<h3>Web„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†</h3>
<ul>
<li><strong>IBM RXN for Chemistry</strong>: https://rxn.res.ibm.com/</li>
<li><strong>ChemDraw Cloud</strong>: https://chemdrawdirect.perkinelmer.cloud/</li>
<li><strong>PubChem</strong>: https://pubchem.ncbi.nlm.nih.gov/</li>
</ul>
<h3>Â≠¶Áøí„É™„ÇΩ„Éº„Çπ</h3>
<ul>
<li><strong>Êõ∏Á±ç</strong>: "Organic Chemistry by Retrosynthesis" by Stuart Warren</li>
<li><strong>„Ç™„É≥„É©„Ç§„É≥„Ç≥„Éº„Çπ</strong>: Coursera "Drug Discovery"</li>
<li><strong>„Ç≥„Éü„É•„Éã„ÉÜ„Ç£</strong>: RDKit Users Group (Google Groups)</li>
</ul>
<hr />
<p><strong>„ÅÇ„Å™„Åü„ÅÆ„Ç±„É¢„Ç§„É≥„Éï„Ç©„Éû„ÉÜ„Ç£„ÇØ„Çπ„ÅÆÊóÖ„ÅØ„Åì„Åì„Åã„ÇâÂßã„Åæ„Çä„Åæ„ÅôÔºÅ</strong></p><div class="navigation">
    <a href="chapter-3.html" class="nav-button">‚Üê Ââç„ÅÆÁ´†</a>
    <a href="index.html" class="nav-button">„Ç∑„É™„Éº„Ç∫ÁõÆÊ¨°„Å´Êàª„Çã</a>
</div>
    </main>

    <footer>
        <p><strong>‰ΩúÊàêËÄÖ</strong>: AI Terakoya Content Team</p>
        <p><strong>Áõ£‰øÆ</strong>: Dr. Yusuke HashimotoÔºàÊù±ÂåóÂ§ßÂ≠¶Ôºâ</p>
        <p><strong>„Éê„Éº„Ç∏„Éß„É≥</strong>: 1.0 | <strong>‰ΩúÊàêÊó•</strong>: 2025-10-18</p>
        <p><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: Creative Commons BY 4.0</p>
        <p>¬© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
