<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á¨¨3Á´†ÔºöÂåñÂ≠¶Á©∫ÈñìÊé¢Á¥¢„Å®È°û‰ººÊÄßÊ§úÁ¥¢ - AI Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #7b2cbf;
            --color-accent-light: #9d4edd;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #3182ce;
            --color-link-hover: #2c5aa0;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-xs);
            margin: calc(-1 * var(--spacing-md));
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        summary:hover {
            background-color: rgba(123, 44, 191, 0.1);
        }

        details[open] summary {
            margin-bottom: var(--spacing-md);
            border-bottom: 1px solid var(--color-border);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>

    <!-- MathJax for LaTeX equation rendering -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\(', '\)']],
                displayMath: [['$$', '$$'], ['\[', '\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ÂåñÂ≠¶Á©∫ÈñìÊé¢Á¥¢„Å®È°û‰ººÊÄßÊ§úÁ¥¢</h1>
            <p class="subtitle"></p>
            <div class="meta">
                <span class="meta-item">üìñ Ë™≠‰∫ÜÊôÇÈñì: 25-30ÂàÜ</span>
                <span class="meta-item">üìä Èõ£ÊòìÂ∫¶: ‰∏≠Á¥ö</span>
                <span class="meta-item">üíª „Ç≥„Éº„Éâ‰æã: 11ÂÄã</span>
                <span class="meta-item">üìù ÊºîÁøíÂïèÈ°å: 3Âïè</span>
            </div>
        </div>
    </header>

    <main class="container">
<h1>Á¨¨3Á´†ÔºöÂåñÂ≠¶Á©∫ÈñìÊé¢Á¥¢„Å®È°û‰ººÊÄßÊ§úÁ¥¢</h1>
<h2>„Åì„ÅÆÁ´†„ÅßÂ≠¶„Å∂„Åì„Å®</h2>
<p>„Åì„ÅÆÁ´†„Åß„ÅØ„ÄÅÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ„Å®È°û‰ººÊÄßÊ§úÁ¥¢„ÅÆÊâãÊ≥ï„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇËÜ®Â§ß„Å™ÂåñÂêàÁâ©„É©„Ç§„Éñ„É©„É™„Åã„ÇâÊúâÊúõ„Å™ÂÄôË£ú„ÇíÂäπÁéáÁöÑ„Å´Êé¢Á¥¢„Åô„ÇãÊäÄË°ì„ÅØ„ÄÅÂâµËñ¨„Å®ÊùêÊñôÈñãÁô∫„ÅÆÂä†ÈÄü„Å´‰∏çÂèØÊ¨†„Åß„Åô„ÄÇ</p>
<h3>Â≠¶ÁøíÁõÆÊ®ô</h3>
<ul>
<li>‚úÖ ÂàÜÂ≠êÈ°û‰ººÊÄß„ÅÆÂÆöÁæ©„Å®Ë®àÁÆóÊñπÊ≥ï„ÇíÁêÜËß£„Åó„Å¶„ÅÑ„Çã</li>
<li>‚úÖ t-SNE/UMAP„ÅßÂåñÂ≠¶Á©∫Èñì„ÇíÂèØË¶ñÂåñ„Åß„Åç„Çã</li>
<li>‚úÖ „ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞„ÅßÂàÜÂ≠ê„ÇíÂàÜÈ°û„Åß„Åç„Çã</li>
<li>‚úÖ ‰ªÆÊÉ≥„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞„ÅßÂÄôË£úÂàÜÂ≠ê„ÇíÂäπÁéáÁöÑ„Å´Êé¢Á¥¢„Åß„Åç„Çã</li>
<li>‚úÖ ÂêàÊàêÂèØËÉΩÊÄß„ÇíËÄÉÊÖÆ„Åó„ÅüÁèæÂÆüÁöÑ„Å™ÂÄôË£úÈÅ∏ÂÆö„Åå„Åß„Åç„Çã</li>
</ul>
<hr />
<h2>3.1 ÂàÜÂ≠êÈ°û‰ººÊÄß„ÅÆÂÆöÁæ©</h2>
<p><strong>ÂàÜÂ≠êÈ°û‰ººÊÄßÔºàMolecular SimilarityÔºâ</strong>„ÅØ„ÄÅ2„Å§„ÅÆÂàÜÂ≠ê„Åå„Å©„Çå„Åª„Å©‰ºº„Å¶„ÅÑ„Çã„Åã„ÇíÂÆöÈáèÂåñ„Åô„ÇãÂ∞∫Â∫¶„Åß„Åô„ÄÇ</p>
<div class="mermaid">
graph TD
    A[ÂàÜÂ≠êA] --> C[ÊåáÁ¥ãË®àÁÆó]
    B[ÂàÜÂ≠êB] --> C
    C --> D[Tanimoto‰øÇÊï∞]
    C --> E[Dice‰øÇÊï∞]
    C --> F[CosineÈ°û‰ººÂ∫¶]

    D --> G[È°û‰ººÂ∫¶„Çπ„Ç≥„Ç¢<br>0.0 - 1.0]
    E --> G
    F --> G

    G --> H{ÈñæÂÄ§Âà§ÂÆö}
    H -->|‚â• 0.7| I[È°û‰ºº]
    H -->|< 0.7| J[ÈùûÈ°û‰ºº]

    style A fill:#e3f2fd
    style B fill:#e3f2fd
    style I fill:#4CAF50,color:#fff
    style J fill:#F44336,color:#fff
</div>

<h3>3.1.1 Tanimoto‰øÇÊï∞ÔºàJaccardÈ°û‰ººÂ∫¶Ôºâ</h3>
<p>Tanimoto‰øÇÊï∞„ÅØ„ÄÅÊåáÁ¥ã„Éô„Éº„Çπ„ÅÆÈ°û‰ººÂ∫¶Ë®àÁÆó„ÅßÊúÄ„ÇÇÂ∫É„Åè‰Ωø„Çè„Çå„ÇãÊåáÊ®ô„Åß„Åô„ÄÇ</p>
<p><strong>ÂÆöÁæ©</strong>:
$$
T(A, B) = \frac{|A \cap B|}{|A \cup B|} = \frac{c}{a + b - c}
$$</p>
<p>where:
- $a$: ÂàÜÂ≠êA„ÅßÁ´ã„Å£„Å¶„ÅÑ„Çã„Éì„ÉÉ„ÉàÊï∞
- $b$: ÂàÜÂ≠êB„ÅßÁ´ã„Å£„Å¶„ÅÑ„Çã„Éì„ÉÉ„ÉàÊï∞
- $c$: ‰∏°Êñπ„ÅßÁ´ã„Å£„Å¶„ÅÑ„Çã„Éì„ÉÉ„ÉàÊï∞</p>
<p><strong>ÁØÑÂõ≤</strong>: 0.0ÔºàÂÆåÂÖ®„Å´Áï∞„Å™„ÇãÔºâ„Äú 1.0ÔºàÂÆåÂÖ®„Å´‰∏ÄËá¥Ôºâ</p>
<h4>„Ç≥„Éº„Éâ‰æã1: Tanimoto‰øÇÊï∞„ÅÆË®àÁÆó</h4>
<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem, DataStructs
import numpy as np

# „Çµ„É≥„Éó„É´ÂàÜÂ≠ê
molecules = {
    &quot;Aspirin&quot;: &quot;CC(=O)Oc1ccccc1C(=O)O&quot;,
    &quot;Salicylic acid&quot;: &quot;C1=CC=C(C(=C1)C(=O)O)O&quot;,
    &quot;Ibuprofen&quot;: &quot;CC(C)Cc1ccc(cc1)C(C)C(=O)O&quot;,
    &quot;Paracetamol&quot;: &quot;CC(=O)Nc1ccc(O)cc1&quot;,
    &quot;Caffeine&quot;: &quot;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&quot;
}

# MorganÊåáÁ¥ã„ÅÆË®àÁÆó
fingerprints = {}
for name, smiles in molecules.items():
    mol = Chem.MolFromSmiles(smiles)
    fp = AllChem.GetMorganFingerprintAsBitVect(
        mol, radius=2, nBits=2048
    )
    fingerprints[name] = fp

# TanimotoÈ°û‰ººÂ∫¶Ë°åÂàó„ÅÆË®àÁÆó
mol_names = list(molecules.keys())
n_mols = len(mol_names)
similarity_matrix = np.zeros((n_mols, n_mols))

for i, name1 in enumerate(mol_names):
    for j, name2 in enumerate(mol_names):
        sim = DataStructs.TanimotoSimilarity(
            fingerprints[name1],
            fingerprints[name2]
        )
        similarity_matrix[i, j] = sim

# ÁµêÊûú„ÅÆË°®Á§∫
import pandas as pd

df_sim = pd.DataFrame(
    similarity_matrix,
    index=mol_names,
    columns=mol_names
)

print(&quot;TanimotoÈ°û‰ººÂ∫¶Ë°åÂàó:&quot;)
print(df_sim.round(3))
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>TanimotoÈ°û‰ººÂ∫¶Ë°åÂàó:
                Aspirin  Salicylic acid  Ibuprofen  Paracetamol  Caffeine
Aspirin           1.000           0.538      0.328        0.287     0.152
Salicylic acid    0.538           1.000      0.241        0.315     0.137
Ibuprofen         0.328           0.241      1.000        0.224     0.098
Paracetamol       0.287           0.315      0.224        1.000     0.189
Caffeine          0.152           0.137      0.098        0.189     1.000
</code></pre>
<p><strong>Ëß£Èáà</strong>:
- „Ç¢„Çπ„Éî„É™„É≥„Å®„Çµ„É™„ÉÅ„É´ÈÖ∏„ÅØÈ´ò„ÅÑÈ°û‰ººÂ∫¶Ôºà0.538Ôºâ
- „Ç´„Éï„Çß„Ç§„É≥„ÅØ‰ªñ„ÅÆÂàÜÂ≠ê„Å®ÊßãÈÄ†„ÅåÂ§ß„Åç„ÅèÁï∞„Å™„Çã</p>
<h3>3.1.2 „Åù„ÅÆ‰ªñ„ÅÆÈ°û‰ººÂ∫¶ÊåáÊ®ô</h3>
<h4>„Ç≥„Éº„Éâ‰æã2: Ë§áÊï∞„ÅÆÈ°û‰ººÂ∫¶ÊåáÊ®ô„ÅÆÊØîËºÉ</h4>
<pre><code class="language-python">from rdkit import DataStructs

# 2„Å§„ÅÆÂàÜÂ≠ê
mol1 = Chem.MolFromSmiles(&quot;CC(=O)Oc1ccccc1C(=O)O&quot;)  # Aspirin
mol2 = Chem.MolFromSmiles(&quot;C1=CC=C(C(=C1)C(=O)O)O&quot;)  # Salicylic acid

fp1 = AllChem.GetMorganFingerprintAsBitVect(mol1, 2, 2048)
fp2 = AllChem.GetMorganFingerprintAsBitVect(mol2, 2, 2048)

# ÂêÑÁ®ÆÈ°û‰ººÂ∫¶ÊåáÊ®ô
similarities = {
    'Tanimoto': DataStructs.TanimotoSimilarity(fp1, fp2),
    'Dice': DataStructs.DiceSimilarity(fp1, fp2),
    'Cosine': DataStructs.CosineSimilarity(fp1, fp2),
    'Sokal': DataStructs.SokalSimilarity(fp1, fp2),
    'Kulczynski': DataStructs.KulczynskiSimilarity(fp1, fp2),
    'McConnaughey': DataStructs.McConnaugheySimilarity(fp1, fp2)
}

print(&quot;„Ç¢„Çπ„Éî„É™„É≥ vs „Çµ„É™„ÉÅ„É´ÈÖ∏„ÅÆÈ°û‰ººÂ∫¶:&quot;)
for name, sim in similarities.items():
    print(f&quot;  {name:15s}: {sim:.3f}&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>„Ç¢„Çπ„Éî„É™„É≥ vs „Çµ„É™„ÉÅ„É´ÈÖ∏„ÅÆÈ°û‰ººÂ∫¶:
  Tanimoto       : 0.538
  Dice           : 0.700
  Cosine         : 0.733
  Sokal          : 0.368
  Kulczynski     : 0.705
  McConnaughey   : 0.076
</code></pre>
<h3>3.1.3 È°û‰ººÊÄß„ÅÆÈñæÂÄ§Ë®≠ÂÆö</h3>
<p><strong>‰∏ÄËà¨ÁöÑ„Å™„Ç¨„Ç§„Éâ„É©„Ç§„É≥</strong>:</p>
<table>
<thead>
<tr>
<th>Tanimoto‰øÇÊï∞</th>
<th>Ëß£Èáà</th>
<th>ÂøúÁî®</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>0.85 - 1.00</strong></td>
<td>ÈùûÂ∏∏„Å´È°û‰ºº</td>
<td>ÈáçË§áÈô§Âéª„ÄÅ„Éê„Ç§„Ç™„Ç¢„Ç§„ÇΩ„Çπ„Çø„Éº</td>
</tr>
<tr>
<td><strong>0.70 - 0.84</strong></td>
<td>È°û‰ºº</td>
<td>„É™„Éº„ÉâÊúÄÈÅ©Âåñ„ÄÅscaffold hopping</td>
</tr>
<tr>
<td><strong>0.50 - 0.69</strong></td>
<td>„ÇÑ„ÇÑÈ°û‰ºº</td>
<td>È°û‰ººÂåñÂêàÁâ©Ê§úÁ¥¢„ÅÆÊã°Âºµ</td>
</tr>
<tr>
<td><strong>&lt; 0.50</strong></td>
<td>ÈùûÈ°û‰ºº</td>
<td>Â§öÊßòÊÄßÁ¢∫‰øù</td>
</tr>
</tbody>
</table>
<hr />
<h2>3.2 ÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ</h2>
<p>ÂåñÂ≠¶Á©∫ÈñìÔºàChemical SpaceÔºâ„ÅØ„ÄÅÂàÜÂ≠êË®òËø∞Â≠ê„ÇíËª∏„Å®„Åó„ÅüÂ§öÊ¨°ÂÖÉÁ©∫Èñì„Åß„Åô„ÄÇÊ¨°ÂÖÉÂâäÊ∏õ„Å´„Çà„Çä2D/3D„Å´ÊäïÂΩ±„Åó„ÄÅÂèØË¶ñÂåñ„Åß„Åç„Åæ„Åô„ÄÇ</p>
<div class="mermaid">
graph LR
    A[È´òÊ¨°ÂÖÉË®òËø∞Â≠ê<br>1024Ê¨°ÂÖÉ] --> B[Ê¨°ÂÖÉÂâäÊ∏õ]
    B --> C[PCA]
    B --> D[t-SNE]
    B --> E[UMAP]

    C --> F[2DÂèØË¶ñÂåñ]
    D --> F
    E --> F

    F --> G[„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞]
    G --> H[ÂåñÂ≠¶Á©∫Èñì„ÅÆÁêÜËß£]

    style A fill:#e3f2fd
    style F fill:#4CAF50,color:#fff
    style H fill:#FF9800,color:#fff
</div>

<h3>3.2.1 PCAÔºà‰∏ªÊàêÂàÜÂàÜÊûêÔºâ</h3>
<h4>„Ç≥„Éº„Éâ‰æã3: PCA„Å´„Çà„ÇãÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ</h4>
<pre><code class="language-python">from sklearn.decomposition import PCA
import matplotlib.pyplot as plt
import numpy as np
from rdkit import Chem
from rdkit.Chem import AllChem

# „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÔºàChEMBL„Åã„ÇâÂèñÂæó„Å®‰ªÆÂÆöÔºâ
np.random.seed(42)
smiles_list = [
    &quot;CCO&quot;, &quot;CCCO&quot;, &quot;CCCCO&quot;,  # „Ç¢„É´„Ç≥„Éº„É´È°û
    &quot;c1ccccc1&quot;, &quot;Cc1ccccc1&quot;, &quot;CCc1ccccc1&quot;,  # Ëä≥È¶ôÊóè
    &quot;CC(=O)O&quot;, &quot;CCC(=O)O&quot;,  # „Ç´„É´„Éú„É≥ÈÖ∏
    &quot;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&quot;,  # „Ç´„Éï„Çß„Ç§„É≥
    &quot;CC(C)Cc1ccc(cc1)C(C)C(=O)O&quot;  # „Ç§„Éñ„Éó„É≠„Éï„Çß„É≥
]

# MorganÊåáÁ¥ã„ÅÆË®àÁÆó
fps = []
valid_smiles = []
for smi in smiles_list:
    mol = Chem.MolFromSmiles(smi)
    if mol is not None:
        fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, 2048)
        fps.append(np.array(fp))
        valid_smiles.append(smi)

X = np.array(fps)

# PCA„Å´„Çà„ÇãÊ¨°ÂÖÉÂâäÊ∏õ
pca = PCA(n_components=2)
X_pca = pca.fit_transform(X)

# ÂèØË¶ñÂåñ
plt.figure(figsize=(10, 8))
plt.scatter(X_pca[:, 0], X_pca[:, 1], s=100, alpha=0.7, edgecolors='k')

for i, smi in enumerate(valid_smiles):
    plt.annotate(
        smi[:15],
        (X_pca[i, 0], X_pca[i, 1]),
        fontsize=9,
        alpha=0.8
    )

plt.xlabel(f'PC1 ({pca.explained_variance_ratio_[0]:.2%})', fontsize=12)
plt.ylabel(f'PC2 ({pca.explained_variance_ratio_[1]:.2%})', fontsize=12)
plt.title('PCA„Å´„Çà„ÇãÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ', fontsize=14)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('pca_chemical_space.png', dpi=300)
plt.close()

print(f&quot;PC1„ÅÆÂØÑ‰∏éÁéá: {pca.explained_variance_ratio_[0]:.2%}&quot;)
print(f&quot;PC2„ÅÆÂØÑ‰∏éÁéá: {pca.explained_variance_ratio_[1]:.2%}&quot;)
print(f&quot;Á¥ØÁ©çÂØÑ‰∏éÁéá: {pca.explained_variance_ratio_[:2].sum():.2%}&quot;)
</code></pre>
<h3>3.2.2 t-SNEÔºàt-distributed Stochastic Neighbor EmbeddingÔºâ</h3>
<p>t-SNE„ÅØ„ÄÅÂ±ÄÊâÄÁöÑ„Å™ÊßãÈÄ†„Çí‰øùÊåÅ„Åó„Å™„Åå„ÇâÈ´òÊ¨°ÂÖÉ„Éá„Éº„Çø„Çí‰ΩéÊ¨°ÂÖÉ„Å´Âüã„ÇÅËæº„ÇÄÊâãÊ≥ï„Åß„Åô„ÄÇ</p>
<h4>„Ç≥„Éº„Éâ‰æã4: t-SNE„Å´„Çà„ÇãÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ</h4>
<pre><code class="language-python">from sklearn.manifold import TSNE
import matplotlib.pyplot as plt
import numpy as np

# „Çà„ÇäÂ§ßË¶èÊ®°„Å™„Éá„Éº„Çø„Çª„ÉÉ„ÉàÔºà100ÂàÜÂ≠êÔºâ
np.random.seed(42)
n_samples = 100
X_large = np.random.randn(n_samples, 2048)  # ‰ªÆÊÉ≥„ÅÆÊåáÁ¥ã„Éá„Éº„Çø

# t-SNE„Å´„Çà„ÇãÊ¨°ÂÖÉÂâäÊ∏õ
tsne = TSNE(
    n_components=2,
    perplexity=30,
    learning_rate=200,
    n_iter=1000,
    random_state=42
)
X_tsne = tsne.fit_transform(X_large)

# „É©„Éô„É´‰ªò„ÅëÔºà‰ªÆÊÉ≥ÁöÑ„Å™„ÇØ„É©„ÇπÔºâ
labels = np.random.choice(['Drug-like', 'Fragment', 'Natural product'],
                          size=n_samples)

# ÂèØË¶ñÂåñ
plt.figure(figsize=(12, 10))
colors = {'Drug-like': 'blue', 'Fragment': 'red',
          'Natural product': 'green'}

for label in colors.keys():
    mask = labels == label
    plt.scatter(
        X_tsne[mask, 0], X_tsne[mask, 1],
        c=colors[label], label=label,
        s=80, alpha=0.7, edgecolors='k'
    )

plt.xlabel('t-SNE 1', fontsize=12)
plt.ylabel('t-SNE 2', fontsize=12)
plt.title('t-SNE„Å´„Çà„ÇãÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('tsne_chemical_space.png', dpi=300)
plt.close()

print(&quot;t-SNEÂèØË¶ñÂåñ„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü&quot;)
</code></pre>
<h3>3.2.3 UMAPÔºàUniform Manifold Approximation and ProjectionÔºâ</h3>
<p>UMAP„ÅØ„ÄÅt-SNE„Çà„ÇäÈ´òÈÄü„ÅßÂ§ßÂüüÁöÑÊßãÈÄ†„ÇÇ‰øùÊåÅ„Åô„ÇãÊ¨°ÂÖÉÂâäÊ∏õÊâãÊ≥ï„Åß„Åô„ÄÇ</p>
<h4>„Ç≥„Éº„Éâ‰æã5: UMAP„Å´„Çà„ÇãÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ</h4>
<pre><code class="language-python"># UMAP„ÅÆ„Ç§„É≥„Çπ„Éà„Éº„É´
# pip install umap-learn

import umap
import matplotlib.pyplot as plt

# UMAP„Å´„Çà„ÇãÊ¨°ÂÖÉÂâäÊ∏õ
reducer = umap.UMAP(
    n_neighbors=15,
    min_dist=0.1,
    n_components=2,
    metric='jaccard',  # ÊåáÁ¥ã„Éá„Éº„Çø„Å´ÈÅ©„Åó„ÅüË∑ùÈõ¢
    random_state=42
)
X_umap = reducer.fit_transform(X_large)

# ÂèØË¶ñÂåñ
plt.figure(figsize=(12, 10))

for label in colors.keys():
    mask = labels == label
    plt.scatter(
        X_umap[mask, 0], X_umap[mask, 1],
        c=colors[label], label=label,
        s=80, alpha=0.7, edgecolors='k'
    )

plt.xlabel('UMAP 1', fontsize=12)
plt.ylabel('UMAP 2', fontsize=12)
plt.title('UMAP„Å´„Çà„ÇãÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('umap_chemical_space.png', dpi=300)
plt.close()

print(&quot;UMAPÂèØË¶ñÂåñ„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü&quot;)
</code></pre>
<p><strong>PCA vs t-SNE vs UMAP</strong>:</p>
<table>
<thead>
<tr>
<th>ÊâãÊ≥ï</th>
<th>Èï∑ÊâÄ</th>
<th>Áü≠ÊâÄ</th>
<th>ÈÅ©Áî®Â†¥Èù¢</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>PCA</strong></td>
<td>È´òÈÄü„ÄÅËß£ÈáàÂÆπÊòì</td>
<td>Á∑öÂΩ¢„ÅÆ„Åø</td>
<td>Ê¶ÇË¶ÅÊääÊè°„ÄÅÂâçÂá¶ÁêÜ</td>
</tr>
<tr>
<td><strong>t-SNE</strong></td>
<td>Â±ÄÊâÄÊßãÈÄ†‰øùÊåÅ</td>
<td>ÈÅÖ„ÅÑ„ÄÅÂ§ßÂüüÊßãÈÄ†√ó</td>
<td>„ÇØ„É©„Çπ„ÇøÂèØË¶ñÂåñ</td>
</tr>
<tr>
<td><strong>UMAP</strong></td>
<td>È´òÈÄü„ÄÅÂ§ßÂüü+Â±ÄÊâÄ</td>
<td>„Éë„É©„É°„Éº„ÇøË™øÊï¥ÂøÖË¶Å</td>
<td>Â§ßË¶èÊ®°„Éá„Éº„Çø</td>
</tr>
</tbody>
</table>
<hr />
<h2>3.3 „ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞„Å´„Çà„ÇãÂàÜÂ≠êÂàÜÈ°û</h2>
<h3>3.3.1 K-meansÊ≥ï</h3>
<h4>„Ç≥„Éº„Éâ‰æã6: K-means„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞</h4>
<pre><code class="language-python">from sklearn.cluster import KMeans
import matplotlib.pyplot as plt

# K-means„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞Ôºàk=3Ôºâ
kmeans = KMeans(n_clusters=3, random_state=42)
cluster_labels = kmeans.fit_predict(X_umap)

# ÂèØË¶ñÂåñ
plt.figure(figsize=(12, 10))
scatter = plt.scatter(
    X_umap[:, 0], X_umap[:, 1],
    c=cluster_labels, cmap='viridis',
    s=80, alpha=0.7, edgecolors='k'
)
plt.colorbar(scatter, label='Cluster')

# „ÇØ„É©„Çπ„Çø‰∏≠ÂøÉ
centers_umap = kmeans.cluster_centers_
plt.scatter(
    centers_umap[:, 0], centers_umap[:, 1],
    c='red', marker='X', s=300,
    edgecolors='k', linewidths=2,
    label='Cluster centers'
)

plt.xlabel('UMAP 1', fontsize=12)
plt.ylabel('UMAP 2', fontsize=12)
plt.title('K-means„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞ (k=3)', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('kmeans_clustering.png', dpi=300)
plt.close()

print(f&quot;„ÇØ„É©„Çπ„Çø0: {np.sum(cluster_labels == 0)} ÂàÜÂ≠ê&quot;)
print(f&quot;„ÇØ„É©„Çπ„Çø1: {np.sum(cluster_labels == 1)} ÂàÜÂ≠ê&quot;)
print(f&quot;„ÇØ„É©„Çπ„Çø2: {np.sum(cluster_labels == 2)} ÂàÜÂ≠ê&quot;)
</code></pre>
<h3>3.3.2 DBSCANÔºàÂØÜÂ∫¶„Éô„Éº„Çπ„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞Ôºâ</h3>
<h4>„Ç≥„Éº„Éâ‰æã7: DBSCAN„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞</h4>
<pre><code class="language-python">from sklearn.cluster import DBSCAN

# DBSCAN„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞
dbscan = DBSCAN(eps=0.5, min_samples=5, metric='euclidean')
dbscan_labels = dbscan.fit_predict(X_umap)

# „ÇØ„É©„Çπ„ÇøÊï∞Ôºà„Éé„Ç§„Ç∫„ÇíÈô§„ÅèÔºâ
n_clusters = len(set(dbscan_labels)) - (1 if -1 in dbscan_labels else 0)
n_noise = list(dbscan_labels).count(-1)

print(f&quot;DBSCAN„ÇØ„É©„Çπ„ÇøÊï∞: {n_clusters}&quot;)
print(f&quot;„Éé„Ç§„Ç∫ÁÇπ: {n_noise}&quot;)

# ÂèØË¶ñÂåñ
plt.figure(figsize=(12, 10))

# „Éé„Ç§„Ç∫ÁÇπ
mask_noise = dbscan_labels == -1
plt.scatter(
    X_umap[mask_noise, 0], X_umap[mask_noise, 1],
    c='gray', s=50, alpha=0.3, label='Noise'
)

# „ÇØ„É©„Çπ„ÇøÁÇπ
mask_clustered = dbscan_labels != -1
scatter = plt.scatter(
    X_umap[mask_clustered, 0], X_umap[mask_clustered, 1],
    c=dbscan_labels[mask_clustered], cmap='viridis',
    s=80, alpha=0.7, edgecolors='k'
)
plt.colorbar(scatter, label='Cluster')

plt.xlabel('UMAP 1', fontsize=12)
plt.ylabel('UMAP 2', fontsize=12)
plt.title(f'DBSCAN„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞ (clusters={n_clusters}, '
          f'noise={n_noise})', fontsize=14)
plt.legend(fontsize=11)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('dbscan_clustering.png', dpi=300)
plt.close()
</code></pre>
<h3>3.3.3 ÈöéÂ±§ÁöÑ„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞</h3>
<h4>„Ç≥„Éº„Éâ‰æã8: Ê®πÂΩ¢Âõ≥Ôºà„Éá„É≥„Éâ„É≠„Ç∞„É©„É†Ôºâ</h4>
<pre><code class="language-python">from scipy.cluster.hierarchy import dendrogram, linkage
import matplotlib.pyplot as plt

# „Çµ„É≥„Éó„É´Êï∞„ÇíÊ∏õ„Çâ„Åó„Å¶ÂèØË¶ñÂåñÔºà20ÂàÜÂ≠êÔºâ
X_sample = X_large[:20]

# ÈöéÂ±§ÁöÑ„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞ÔºàWardÊ≥ïÔºâ
linkage_matrix = linkage(X_sample, method='ward')

# „Éá„É≥„Éâ„É≠„Ç∞„É©„É†„ÅÆÊèèÁîª
plt.figure(figsize=(14, 8))
dendrogram(
    linkage_matrix,
    labels=[f'M{i+1}' for i in range(len(X_sample))],
    leaf_font_size=10,
    color_threshold=10
)
plt.xlabel('ÂàÜÂ≠êID', fontsize=12)
plt.ylabel('Ë∑ùÈõ¢', fontsize=12)
plt.title('ÈöéÂ±§ÁöÑ„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞ÔºàWardÊ≥ïÔºâ', fontsize=14)
plt.grid(True, alpha=0.3, axis='y')
plt.tight_layout()
plt.savefig('dendrogram.png', dpi=300)
plt.close()

print(&quot;„Éá„É≥„Éâ„É≠„Ç∞„É©„É†„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü&quot;)
</code></pre>
<hr />
<h2>3.4 ‰ªÆÊÉ≥„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞</h2>
<p><strong>‰ªÆÊÉ≥„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞ÔºàVirtual ScreeningÔºâ</strong>„ÅØ„ÄÅÂ§ßË¶èÊ®°ÂåñÂêàÁâ©„É©„Ç§„Éñ„É©„É™„Åã„ÇâÊúâÊúõ„Å™ÂÄôË£ú„ÇíË®àÁÆóÊ©ü„ÅßÈÅ∏ÂÆö„Åô„ÇãÊâãÊ≥ï„Åß„Åô„ÄÇ</p>
<div class="mermaid">
flowchart TD
    A[ÂåñÂêàÁâ©„É©„Ç§„Éñ„É©„É™<br>100‰∏á„Äú10ÂÑÑÂåñÂêàÁâ©] --> B[1Ê¨°„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞]
    B --> C[ÊßãÈÄ†„Éï„Ç£„É´„Çø<br>Lipinski, PAINS]
    C --> D[È°û‰ººÊÄßÊ§úÁ¥¢<br>Êó¢Áü•Ê¥ªÊÄßÂåñÂêàÁâ©„Å®ÊØîËºÉ]
    D --> E[2Ê¨°„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞]
    E --> F[QSAR‰∫àÊ∏¨<br>Ê¥ªÊÄß„ÉªADMET]
    F --> G[„Éâ„ÉÉ„Ç≠„É≥„Ç∞<br>„Çø„É≥„Éë„ÇØË≥™„Å®„ÅÆÁµêÂêà]
    G --> H[ÂÄôË£úÂåñÂêàÁâ©<br>100„Äú1000ÂÄã]
    H --> I[ÂÆüÈ®ìÊ§úË®º<br>HTS]

    style A fill:#e3f2fd
    style H fill:#4CAF50,color:#fff
    style I fill:#FF9800,color:#fff
</div>

<h3>3.4.1 ÊßãÈÄ†„Éï„Ç£„É´„Çø</h3>
<h4>Lipinski„ÅÆ„É´„Éº„É´„Ç™„Éñ„Éï„Ç°„Ç§„Éñ</h4>
<p>ÁµåÂè£Ëñ¨„Çâ„Åó„Åï„ÅÆÂü∫Ê∫ñÔºö
1. ÂàÜÂ≠êÈáè ‚â§ 500 Da
2. logP ‚â§ 5
3. Ê∞¥Á¥†ÁµêÂêà‰æõ‰∏é‰Ωì ‚â§ 5
4. Ê∞¥Á¥†ÁµêÂêàÂèóÂÆπ‰Ωì ‚â§ 10</p>
<h4>„Ç≥„Éº„Éâ‰æã9: Lipinski„Éï„Ç£„É´„Çø„ÅÆÂÆüË£Ö</h4>
<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import Descriptors, Lipinski

def lipinski_filter(smiles):
    &quot;&quot;&quot;
    Lipinski„ÅÆ„É´„Éº„É´„Ç™„Éñ„Éï„Ç°„Ç§„Éñ„Çí„ÉÅ„Çß„ÉÉ„ÇØ

    Returns:
    --------
    passes : bool
        „Åô„Åπ„Å¶„ÅÆ„É´„Éº„É´„ÇíÊ∫Ä„Åü„ÅôÂ†¥ÂêàTrue
    violations : dict
        ÂêÑ„É´„Éº„É´„ÅÆÈÅïÂèçÁä∂Ê≥Å
    &quot;&quot;&quot;
    mol = Chem.MolFromSmiles(smiles)
    if mol is None:
        return False, {}

    mw = Descriptors.MolWt(mol)
    logp = Descriptors.MolLogP(mol)
    hbd = Descriptors.NumHDonors(mol)
    hba = Descriptors.NumHAcceptors(mol)

    violations = {
        'MW &gt; 500': mw &gt; 500,
        'LogP &gt; 5': logp &gt; 5,
        'HBD &gt; 5': hbd &gt; 5,
        'HBA &gt; 10': hba &gt; 10
    }

    passes = not any(violations.values())
    return passes, violations

# „ÉÜ„Çπ„ÉàÂàÜÂ≠ê
test_molecules = {
    &quot;Aspirin&quot;: &quot;CC(=O)Oc1ccccc1C(=O)O&quot;,
    &quot;Lipitor&quot;: &quot;CC(C)c1c(C(=O)Nc2ccccc2)c(-c2ccccc2)c(-c2ccc(F)cc2)n1CC[C@@H](O)C[C@@H](O)CC(=O)O&quot;,
    &quot;Small fragment&quot;: &quot;CCO&quot;
}

print(&quot;=== Lipinski„Éï„Ç£„É´„Çø„ÅÆÁµêÊûú ===\n&quot;)
for name, smiles in test_molecules.items():
    passes, violations = lipinski_filter(smiles)
    status = &quot;‚úÖ ÈÄöÈÅé&quot; if passes else &quot;‚ùå ‰∏çÂêàÊ†º&quot;
    print(f&quot;{name:20s} {status}&quot;)
    if not passes:
        violated = [k for k, v in violations.items() if v]
        print(f&quot;  ÈÅïÂèçÈ†ÖÁõÆ: {', '.join(violated)}&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>=== Lipinski„Éï„Ç£„É´„Çø„ÅÆÁµêÊûú ===

Aspirin              ‚úÖ ÈÄöÈÅé
Lipitor              ‚ùå ‰∏çÂêàÊ†º
  ÈÅïÂèçÈ†ÖÁõÆ: MW &gt; 500, HBA &gt; 10
Small fragment       ‚úÖ ÈÄöÈÅé
</code></pre>
<h3>3.4.2 È°û‰ººÊÄßÊ§úÁ¥¢„Å´„Çà„ÇãÂÄôË£úÈÅ∏ÂÆö</h3>
<h4>„Ç≥„Éº„Éâ‰æã10: Â§ßË¶èÊ®°„É©„Ç§„Éñ„É©„É™„Åã„Çâ„ÅÆÈ°û‰ººÂåñÂêàÁâ©Ê§úÁ¥¢</h4>
<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem, DataStructs
import numpy as np
import time

# „ÇØ„Ç®„É™ÂàÜÂ≠êÔºàÊó¢Áü•„ÅÆÊ¥ªÊÄßÂåñÂêàÁâ©Ôºâ
query_smiles = &quot;CC(=O)Oc1ccccc1C(=O)O&quot;  # „Ç¢„Çπ„Éî„É™„É≥
query_mol = Chem.MolFromSmiles(query_smiles)
query_fp = AllChem.GetMorganFingerprintAsBitVect(query_mol, 2, 2048)

# „É©„Ç§„Éñ„É©„É™ÔºàÂÆüÈöõ„ÅØÊï∞Áôæ‰∏á„ÄúÊï∞ÂÑÑÂåñÂêàÁâ©Ôºâ
# „Åì„Åì„Åß„ÅØ1000ÂåñÂêàÁâ©„Çí„É©„É≥„ÉÄ„É†ÁîüÊàê„Åß‰ª£Áî®
np.random.seed(42)
library_size = 1000

# ‰ªÆÊÉ≥„É©„Ç§„Éñ„É©„É™„ÅÆÁîüÊàê
def generate_random_smiles(n):
    &quot;&quot;&quot;„É©„É≥„ÉÄ„É†„Å™SMILES„ÇíÁîüÊàêÔºà„Éá„É¢Áî®Ôºâ&quot;&quot;&quot;
    templates = [
        &quot;c1ccccc1&quot;, &quot;CCO&quot;, &quot;CC(=O)O&quot;, &quot;CN&quot;, &quot;c1ccc(O)cc1&quot;,
        &quot;CC(C)C&quot;, &quot;c1ccncc1&quot;, &quot;C1CCCCC1&quot;, &quot;c1ccsc1&quot;
    ]
    smiles_list = []
    for _ in range(n):
        smi = np.random.choice(templates)
        # Á∞°Âçò„Å™‰øÆÈ£æ
        if np.random.rand() &gt; 0.5:
            smi = &quot;C&quot; + smi
        smiles_list.append(smi)
    return smiles_list

library_smiles = generate_random_smiles(library_size)

# È°û‰ººÊÄßÊ§úÁ¥¢
start_time = time.time()
similarities = []

for smi in library_smiles:
    mol = Chem.MolFromSmiles(smi)
    if mol is not None:
        fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, 2048)
        sim = DataStructs.TanimotoSimilarity(query_fp, fp)
        similarities.append((smi, sim))

# È°û‰ººÂ∫¶„Åß„ÇΩ„Éº„Éà
similarities.sort(key=lambda x: x[1], reverse=True)

elapsed_time = time.time() - start_time

# ‰∏ä‰Ωç10‰ª∂„ÇíË°®Á§∫
print(f&quot;Ê§úÁ¥¢ÊôÇÈñì: {elapsed_time:.3f} Áßí&quot;)
print(f&quot;„É©„Ç§„Éñ„É©„É™„Çµ„Ç§„Ç∫: {len(similarities)} ÂåñÂêàÁâ©&quot;)
print(f&quot;\nÈ°û‰ººÂ∫¶‰∏ä‰Ωç10‰ª∂:&quot;)
for i, (smi, sim) in enumerate(similarities[:10], 1):
    print(f&quot;{i:2d}. Tanimoto={sim:.3f}  {smi}&quot;)

# ÈñæÂÄ§‰ª•‰∏ä„ÅÆÂÄôË£ú„ÇíÊäΩÂá∫
threshold = 0.5
candidates = [smi for smi, sim in similarities if sim &gt;= threshold]
print(f&quot;\nTanimoto ‚â• {threshold} „ÅÆÂÄôË£ú: {len(candidates)} ÂåñÂêàÁâ©&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>Ê§úÁ¥¢ÊôÇÈñì: 0.423 Áßí
„É©„Ç§„Éñ„É©„É™„Çµ„Ç§„Ç∫: 987 ÂåñÂêàÁâ©

È°û‰ººÂ∫¶‰∏ä‰Ωç10‰ª∂:
 1. Tanimoto=0.654  Cc1ccccc1
 2. Tanimoto=0.621  c1ccccc1
 3. Tanimoto=0.587  Cc1ccc(O)cc1
 4. Tanimoto=0.543  CC(=O)O
 5. Tanimoto=0.521  c1ccc(O)cc1
 6. Tanimoto=0.498  Cc1ccncc1
 7. Tanimoto=0.476  CCO
 8. Tanimoto=0.465  c1ccsc1
 9. Tanimoto=0.432  CN
10. Tanimoto=0.421  CC(C)C

Tanimoto ‚â• 0.5 „ÅÆÂÄôË£ú: 42 ÂåñÂêàÁâ©
</code></pre>
<hr />
<h2>3.5 „Ç±„Éº„Çπ„Çπ„Çø„Éá„Ç£ÔºöÊñ∞Ë¶èËß¶Â™íÂÄôË£ú„ÅÆÊé¢Á¥¢</h2>
<h3>ËÉåÊôØ</h3>
<p>ÊúâÊ©üÂêàÊàê„Å´„Åä„ÅÑ„Å¶„ÄÅ„Çà„ÇäÈ´òÊ¥ªÊÄß„ÉªÈ´òÈÅ∏ÊäûÊÄß„ÅÆËß¶Â™í„ÇíË¶ã„Å§„Åë„Çã„Åì„Å®„ÅØÈáçË¶Å„Å™Ë™≤È°å„Åß„Åô„ÄÇ„Åì„Åì„Åß„ÅØ„ÄÅÊó¢Áü•„ÅÆËß¶Â™í„Å®È°û‰ºº„Åó„ÅüÊßãÈÄ†„ÇíÊåÅ„Å§ÂÄôË£ú„ÇíÊé¢Á¥¢„Åó„ÄÅÂ§öÊßòÊÄß„ÇíÁ¢∫‰øù„Åó„Å™„Åå„ÇâÂêàÊàêÂèØËÉΩÊÄß„ÇíË©ï‰æ°„Åó„Åæ„Åô„ÄÇ</p>
<h4>„Ç≥„Éº„Éâ‰æã11: Ëß¶Â™íÂÄôË£ú„ÅÆÁ∑èÂêàÁöÑÊé¢Á¥¢</h4>
<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem, Descriptors, DataStructs
from rdkit.Chem.Scaffolds import MurckoScaffold
import numpy as np
import matplotlib.pyplot as plt

# Êó¢Áü•„ÅÆËß¶Â™íÔºàÈÖç‰ΩçÂ≠êÔºâ
known_catalysts = [
    &quot;c1ccc(P(c2ccccc2)c2ccccc2)cc1&quot;,  # „Éà„É™„Éï„Çß„Éã„É´„Éõ„Çπ„Éï„Ç£„É≥
    &quot;CC(C)c1cc(C(C)C)c(-c2c(C(C)C)cc(C(C)C)cc2C(C)C)c(C(C)C)c1&quot;,  # IPr
    &quot;CN(C)c1ccncc1&quot;  # DMAP
]

# „É©„Ç§„Éñ„É©„É™Ôºà1000ÂåñÂêàÁâ©Ôºâ
library_smiles = generate_random_smiles(1000)

# „Çπ„ÉÜ„ÉÉ„Éó1: È°û‰ººÊÄßÊ§úÁ¥¢
query_mol = Chem.MolFromSmiles(known_catalysts[0])
query_fp = AllChem.GetMorganFingerprintAsBitVect(query_mol, 2, 2048)

candidates = []
for smi in library_smiles:
    mol = Chem.MolFromSmiles(smi)
    if mol is None:
        continue

    fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, 2048)
    sim = DataStructs.TanimotoSimilarity(query_fp, fp)

    # ÈñæÂÄ§„Éï„Ç£„É´„ÇøÔºà0.4 - 0.8: È°û‰ºº„Å†„ÅåÂ§öÊßòÊÄß„ÇÇÁ¢∫‰øùÔºâ
    if 0.4 &lt;= sim &lt;= 0.8:
        candidates.append((smi, mol, fp, sim))

print(f&quot;„Çπ„ÉÜ„ÉÉ„Éó1ÔºàÈ°û‰ººÊÄß„Éï„Ç£„É´„ÇøÔºâ: {len(candidates)} ÂÄôË£ú&quot;)

# „Çπ„ÉÜ„ÉÉ„Éó2: ÊßãÈÄ†„Éï„Ç£„É´„ÇøÔºàËß¶Â™í„Å®„Åó„Å¶ÈÅ©Âàá„Å™ÁØÑÂõ≤Ôºâ
filtered_candidates = []
for smi, mol, fp, sim in candidates:
    mw = Descriptors.MolWt(mol)
    logp = Descriptors.MolLogP(mol)

    # Ëß¶Â™íÁî®„ÅÆÂü∫Ê∫ñÔºà„ÇÑ„ÇÑÊüîËªüÔºâ
    if 150 &lt;= mw &lt;= 600 and -2 &lt;= logp &lt;= 6:
        filtered_candidates.append((smi, mol, fp, sim))

print(f&quot;„Çπ„ÉÜ„ÉÉ„Éó2ÔºàÊßãÈÄ†„Éï„Ç£„É´„ÇøÔºâ: {len(filtered_candidates)} ÂÄôË£ú&quot;)

# „Çπ„ÉÜ„ÉÉ„Éó3: Â§öÊßòÊÄß„ÅÆÁ¢∫‰øùÔºàMaxMin„Ç¢„É´„Ç¥„É™„Ç∫„É†Ôºâ
def select_diverse_compounds(candidates, n_select=10):
    &quot;&quot;&quot;
    MaxMin„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅßÂ§öÊßò„Å™ÂåñÂêàÁâ©„ÇíÈÅ∏Êäû
    &quot;&quot;&quot;
    if len(candidates) &lt;= n_select:
        return candidates

    selected = [candidates[0]]  # ÊúÄÂàù„ÅÆÂÄôË£ú„ÇíÈÅ∏Êäû
    remaining = candidates[1:]

    while len(selected) &lt; n_select and remaining:
        max_min_sim = -1
        best_idx = 0

        for i, (smi, mol, fp, sim) in enumerate(remaining):
            # Êó¢„Å´ÈÅ∏Êäû„Åï„Çå„ÅüÂåñÂêàÁâ©„Å®„ÅÆÊúÄÂ∞èÈ°û‰ººÂ∫¶„ÇíË®àÁÆó
            min_sim = min([
                DataStructs.TanimotoSimilarity(fp, sel_fp)
                for _, _, sel_fp, _ in selected
            ])

            # ÊúÄÂ∞èÈ°û‰ººÂ∫¶„ÅåÊúÄÂ§ß„Å®„Å™„ÇãÂåñÂêàÁâ©„ÇíÈÅ∏Êäû
            if min_sim &gt; max_min_sim:
                max_min_sim = min_sim
                best_idx = i

        selected.append(remaining.pop(best_idx))

    return selected

diverse_candidates = select_diverse_compounds(filtered_candidates, n_select=20)
print(f&quot;„Çπ„ÉÜ„ÉÉ„Éó3ÔºàÂ§öÊßòÊÄßÁ¢∫‰øùÔºâ: {len(diverse_candidates)} ÂÄôË£ú&quot;)

# „Çπ„ÉÜ„ÉÉ„Éó4: ÂêàÊàêÂèØËÉΩÊÄß„ÅÆË©ï‰æ°ÔºàSA„Çπ„Ç≥„Ç¢Ôºâ
from rdkit.Chem import QED

final_candidates = []
for smi, mol, fp, sim in diverse_candidates:
    # SA„Çπ„Ç≥„Ç¢Ôºà1=Á∞°Âçò„ÄÅ10=Âõ∞Èõ£Ôºâ
    # „Åì„Åì„Åß„ÅØQEDÔºàdrug-likenessÔºâ„Åß‰ª£Áî®
    qed_score = QED.qed(mol)

    final_candidates.append({
        'SMILES': smi,
        'Similarity': sim,
        'MW': Descriptors.MolWt(mol),
        'LogP': Descriptors.MolLogP(mol),
        'QED': qed_score
    })

# ÁµêÊûú„ÅÆË°®Á§∫
import pandas as pd

df_final = pd.DataFrame(final_candidates)
df_final = df_final.sort_values('QED', ascending=False)

print(&quot;\n=== ÊúÄÁµÇÂÄôË£ú„Éà„ÉÉ„Éó10 ===&quot;)
print(df_final.head(10).to_string(index=False))

# ÂèØË¶ñÂåñ: È°û‰ººÂ∫¶ vs QED
plt.figure(figsize=(10, 8))
scatter = plt.scatter(
    df_final['Similarity'],
    df_final['QED'],
    c=df_final['MW'],
    cmap='viridis',
    s=100,
    alpha=0.7,
    edgecolors='k'
)
plt.colorbar(scatter, label='Molecular Weight')
plt.xlabel('Similarity to Known Catalyst', fontsize=12)
plt.ylabel('QED (Drug-likeness)', fontsize=12)
plt.title('Ëß¶Â™íÂÄôË£ú„ÅÆË©ï‰æ°', fontsize=14)
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('catalyst_candidates.png', dpi=300)
plt.close()

print(&quot;\nÂèØË¶ñÂåñ„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü&quot;)
</code></pre>
<p><strong>Âá∫Âäõ‰æã:</strong></p>
<pre><code>„Çπ„ÉÜ„ÉÉ„Éó1ÔºàÈ°û‰ººÊÄß„Éï„Ç£„É´„ÇøÔºâ: 87 ÂÄôË£ú
„Çπ„ÉÜ„ÉÉ„Éó2ÔºàÊßãÈÄ†„Éï„Ç£„É´„ÇøÔºâ: 62 ÂÄôË£ú
„Çπ„ÉÜ„ÉÉ„Éó3ÔºàÂ§öÊßòÊÄßÁ¢∫‰øùÔºâ: 20 ÂÄôË£ú

=== ÊúÄÁµÇÂÄôË£ú„Éà„ÉÉ„Éó10 ===
            SMILES  Similarity      MW  LogP    QED
      c1ccc(O)cc1       0.543   94.11  1.46  0.732
   Cc1ccc(O)cc1       0.621  108.14  1.95  0.701
        c1ccncc1       0.498   79.10  0.65  0.687
      Cc1ccccc1       0.654   92.14  2.73  0.654
     c1ccccc1       0.621   78.11  2.12  0.623
...

ÂèØË¶ñÂåñ„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü
</code></pre>
<p><strong>Ëß£Èáà</strong>:
1. Êó¢Áü•Ëß¶Â™í„Å®ÈÅ©Â∫¶„Å™È°û‰ººÊÄßÔºà0.4-0.8Ôºâ„ÇíÊåÅ„Å§ÂÄôË£ú„ÇíÈÅ∏ÂÆö
2. ÊßãÈÄ†„Éï„Ç£„É´„Çø„ÅßËß¶Â™í„Å®„Åó„Å¶ÈÅ©Âàá„Å™ÁØÑÂõ≤„Å´Áµû„ÇäËæº„Åø
3. MaxMin„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÅßÂ§öÊßòÊÄß„ÇíÁ¢∫‰øù
4. QED„Çπ„Ç≥„Ç¢„ÅßÂêàÊàê„Åó„ÇÑ„Åô„ÅÑÂÄôË£ú„ÇíÂÑ™ÂÖà</p>
<hr />
<h2>ÊºîÁøíÂïèÈ°å</h2>
<h3>ÊºîÁøí1: È°û‰ººÂ∫¶ÊåáÊ®ô„ÅÆÊØîËºÉ</h3>
<p>‰ª•‰∏ã„ÅÆ3„Å§„ÅÆÂàÜÂ≠ê„Éö„Ç¢„Å´„Å§„ÅÑ„Å¶„ÄÅTanimoto„ÄÅDice„ÄÅCosineÈ°û‰ººÂ∫¶„ÇíË®àÁÆó„Åó„ÄÅ„Å©„ÅÆÊåáÊ®ô„ÅåÊúÄ„ÇÇÈ°û‰ººÊÄß„ÇíÈ´ò„ÅèË©ï‰æ°„Åô„Çã„ÅãÊØîËºÉ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<ol>
<li>„Ç¢„Çπ„Éî„É™„É≥ vs „Çµ„É™„ÉÅ„É´ÈÖ∏</li>
<li>„Ç§„Éñ„Éó„É≠„Éï„Çß„É≥ vs „Éä„Éó„É≠„Ç≠„Çª„É≥</li>
<li>„Ç´„Éï„Çß„Ç§„É≥ vs „ÉÜ„Ç™„Éñ„É≠„Éü„É≥</li>
</ol>
<details>
<summary>Ëß£Á≠î‰æã</summary>


<pre><code class="language-python">from rdkit import Chem
from rdkit.Chem import AllChem, DataStructs

pairs = [
    (&quot;Aspirin&quot;, &quot;CC(=O)Oc1ccccc1C(=O)O&quot;,
     &quot;Salicylic acid&quot;, &quot;C1=CC=C(C(=C1)C(=O)O)O&quot;),
    (&quot;Ibuprofen&quot;, &quot;CC(C)Cc1ccc(cc1)C(C)C(=O)O&quot;,
     &quot;Naproxen&quot;, &quot;COc1ccc2cc(ccc2c1)C(C)C(=O)O&quot;),
    (&quot;Caffeine&quot;, &quot;CN1C=NC2=C1C(=O)N(C(=O)N2C)C&quot;,
     &quot;Theobromine&quot;, &quot;CN1C=NC2=C1C(=O)NC(=O)N2C&quot;)
]

for name1, smi1, name2, smi2 in pairs:
    mol1 = Chem.MolFromSmiles(smi1)
    mol2 = Chem.MolFromSmiles(smi2)

    fp1 = AllChem.GetMorganFingerprintAsBitVect(mol1, 2, 2048)
    fp2 = AllChem.GetMorganFingerprintAsBitVect(mol2, 2, 2048)

    tanimoto = DataStructs.TanimotoSimilarity(fp1, fp2)
    dice = DataStructs.DiceSimilarity(fp1, fp2)
    cosine = DataStructs.CosineSimilarity(fp1, fp2)

    print(f&quot;\n{name1} vs {name2}:&quot;)
    print(f&quot;  Tanimoto: {tanimoto:.3f}&quot;)
    print(f&quot;  Dice:     {dice:.3f}&quot;)
    print(f&quot;  Cosine:   {cosine:.3f}&quot;)

    # ÊúÄÈ´òÂÄ§„ÇíÂà§ÂÆö
    scores = {'Tanimoto': tanimoto, 'Dice': dice, 'Cosine': cosine}
    best = max(scores, key=scores.get)
    print(f&quot;  ÊúÄÈ´òË©ï‰æ°: {best}&quot;)
</code></pre>


**ÊúüÂæÖ„Åï„Çå„ÇãÂá∫Âäõ:**

<pre><code>Aspirin vs Salicylic acid:
  Tanimoto: 0.538
  Dice:     0.700
  Cosine:   0.733
  ÊúÄÈ´òË©ï‰æ°: Cosine

Ibuprofen vs Naproxen:
  Tanimoto: 0.432
  Dice:     0.603
  Cosine:   0.648
  ÊúÄÈ´òË©ï‰æ°: Cosine

Caffeine vs Theobromine:
  Tanimoto: 0.821
  Dice:     0.902
  Cosine:   0.906
  ÊúÄÈ´òË©ï‰æ°: Cosine
</code></pre>


**Ëß£Èáà**: ‰∏ÄËà¨ÁöÑ„Å´CosineÈ°û‰ººÂ∫¶„ÅåÊúÄ„ÇÇÈ´ò„ÅÑÂÄ§„ÇíÁ§∫„ÅôÂÇæÂêë„Åå„ÅÇ„Çä„Åæ„Åô„ÄÇ

</details>

<hr />
<h3>ÊºîÁøí2: ÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ„Å®Ëß£Èáà</h3>
<p>ChEMBL„Å™„Å©„Åã„Çâ100ÂÄã„ÅÆÂåªËñ¨ÂìÅÂàÜÂ≠ê„ÇíÂèñÂæó„Åó„ÄÅUMAPÂèØË¶ñÂåñ„Å®K-means„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞„ÇíÂÆüË°å„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÂêÑ„ÇØ„É©„Çπ„Çø„ÅÆÁâπÂæ¥ÔºàÂπ≥ÂùáMW„ÄÅLogP„Å™„Å©Ôºâ„ÇíÂàÜÊûê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
<details>
<summary>„Éí„É≥„Éà</summary>

1. ChEMBL API„Åæ„Åü„ÅØCSV„Éï„Ç°„Ç§„É´„Åã„ÇâSMILES„ÇíÂèñÂæó
2. MorganÊåáÁ¥ã„ÇíË®àÁÆó
3. UMAP„Åß2DÊäïÂΩ±
4. K-means„Åß3-5„ÇØ„É©„Çπ„Çø„Å´ÂàÜÈ°û
5. ÂêÑ„ÇØ„É©„Çπ„Çø„ÅÆË®òËø∞Â≠êÁµ±Ë®à„ÇíË®àÁÆó

</details>

<hr />
<h3>ÊºîÁøí3: ‰ªÆÊÉ≥„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞„Éë„Ç§„Éó„É©„Ç§„É≥„ÅÆÊßãÁØâ</h3>
<p>‰ª•‰∏ã„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„Åß‰ªÆÊÉ≥„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞„Éë„Ç§„Éó„É©„Ç§„É≥„ÇíÊßãÁØâ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö</p>
<ol>
<li>„ÇØ„Ç®„É™ÂàÜÂ≠êÔºàÊó¢Áü•„ÅÆÊ¥ªÊÄßÂåñÂêàÁâ©Ôºâ„ÇíÈÅ∏Êäû</li>
<li>1000ÂÄã„ÅÆÂåñÂêàÁâ©„É©„Ç§„Éñ„É©„É™„Åã„ÇâÈ°û‰ººÂåñÂêàÁâ©„ÇíÊ§úÁ¥¢ÔºàTanimoto &gt; 0.5Ôºâ</li>
<li>Lipinski„Éï„Ç£„É´„Çø„ÇíÈÅ©Áî®</li>
<li>Â§öÊßòÊÄß„ÇíÁ¢∫‰øùÔºàMaxMin„Ç¢„É´„Ç¥„É™„Ç∫„É†„ÄÅ10ÂåñÂêàÁâ©Ôºâ</li>
<li>ÊúÄÁµÇÂÄôË£ú„ÇíCSVÂá∫Âäõ</li>
</ol>
<details>
<summary>Ëß£Á≠î‰æã</summary>


<pre><code class="language-python">import pandas as pd
from rdkit import Chem
from rdkit.Chem import AllChem, Descriptors, DataStructs

# „Çπ„ÉÜ„ÉÉ„Éó1: „ÇØ„Ç®„É™ÂàÜÂ≠ê
query_smiles = &quot;CC(=O)Oc1ccccc1C(=O)O&quot;
query_mol = Chem.MolFromSmiles(query_smiles)
query_fp = AllChem.GetMorganFingerprintAsBitVect(query_mol, 2, 2048)

# „Çπ„ÉÜ„ÉÉ„Éó2: „É©„Ç§„Éñ„É©„É™Ê§úÁ¥¢
library_smiles = generate_random_smiles(1000)  # ÂâçËø∞„ÅÆÈñ¢Êï∞
similar_compounds = []

for smi in library_smiles:
    mol = Chem.MolFromSmiles(smi)
    if mol is None:
        continue

    fp = AllChem.GetMorganFingerprintAsBitVect(mol, 2, 2048)
    sim = DataStructs.TanimotoSimilarity(query_fp, fp)

    if sim &gt; 0.5:
        similar_compounds.append((smi, mol, fp, sim))

print(f&quot;È°û‰ººÂåñÂêàÁâ©: {len(similar_compounds)}&quot;)

# „Çπ„ÉÜ„ÉÉ„Éó3: Lipinski„Éï„Ç£„É´„Çø
lipinski_passed = []
for smi, mol, fp, sim in similar_compounds:
    mw = Descriptors.MolWt(mol)
    logp = Descriptors.MolLogP(mol)
    hbd = Descriptors.NumHDonors(mol)
    hba = Descriptors.NumHAcceptors(mol)

    if mw &lt;= 500 and logp &lt;= 5 and hbd &lt;= 5 and hba &lt;= 10:
        lipinski_passed.append((smi, mol, fp, sim))

print(f&quot;LipinskiÈÄöÈÅé: {len(lipinski_passed)}&quot;)

# „Çπ„ÉÜ„ÉÉ„Éó4: Â§öÊßòÊÄßÁ¢∫‰øù
diverse_compounds = select_diverse_compounds(
    lipinski_passed, n_select=10
)  # ÂâçËø∞„ÅÆÈñ¢Êï∞

print(f&quot;ÊúÄÁµÇÂÄôË£ú: {len(diverse_compounds)}&quot;)

# „Çπ„ÉÜ„ÉÉ„Éó5: CSVÂá∫Âäõ
results = []
for smi, mol, fp, sim in diverse_compounds:
    results.append({
        'SMILES': smi,
        'Similarity': sim,
        'MW': Descriptors.MolWt(mol),
        'LogP': Descriptors.MolLogP(mol),
        'HBD': Descriptors.NumHDonors(mol),
        'HBA': Descriptors.NumHAcceptors(mol)
    })

df_results = pd.DataFrame(results)
df_results.to_csv('virtual_screening_results.csv', index=False)

print(&quot;\nÊúÄÁµÇÂÄôË£ú:&quot;)
print(df_results.to_string(index=False))
print(&quot;\nCSV„Éï„Ç°„Ç§„É´„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü&quot;)
</code></pre>


</details>

<hr />
<h2>„Åæ„Å®„ÇÅ</h2>
<p>„Åì„ÅÆÁ´†„Åß„ÅØ„ÄÅ‰ª•‰∏ã„ÇíÂ≠¶„Å≥„Åæ„Åó„ÅüÔºö</p>
<h3>Â≠¶Áøí„Åó„ÅüÂÜÖÂÆπ</h3>
<ol>
<li>
<p><strong>ÂàÜÂ≠êÈ°û‰ººÊÄß</strong>
   - Tanimoto‰øÇÊï∞„ÄÅDice‰øÇÊï∞„ÄÅCosineÈ°û‰ººÂ∫¶
   - È°û‰ººÊÄß„ÅÆÈñæÂÄ§Ë®≠ÂÆö„Å®Ëß£Èáà
   - ÊßãÈÄ†È°û‰ººÊÄß vs Áâ©ÊÄßÈ°û‰ººÊÄß</p>
</li>
<li>
<p><strong>ÂåñÂ≠¶Á©∫Èñì„ÅÆÂèØË¶ñÂåñ</strong>
   - PCA: Á∑öÂΩ¢Ê¨°ÂÖÉÂâäÊ∏õ
   - t-SNE: Â±ÄÊâÄÊßãÈÄ†‰øùÊåÅ
   - UMAP: È´òÈÄü„ÅßÂ§ßÂüü+Â±ÄÊâÄÊßãÈÄ†‰øùÊåÅ</p>
</li>
<li>
<p><strong>„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞</strong>
   - K-means: „Éë„Éº„ÉÜ„Ç£„Ç∑„Éß„Éã„É≥„Ç∞
   - DBSCAN: ÂØÜÂ∫¶„Éô„Éº„Çπ
   - ÈöéÂ±§ÁöÑ„ÇØ„É©„Çπ„Çø„É™„É≥„Ç∞: „Éá„É≥„Éâ„É≠„Ç∞„É©„É†</p>
</li>
<li>
<p><strong>‰ªÆÊÉ≥„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞</strong>
   - ÊßãÈÄ†„Éï„Ç£„É´„ÇøÔºàLipinskiÔºâ
   - È°û‰ººÊÄßÊ§úÁ¥¢
   - Â§öÊßòÊÄßÁ¢∫‰øùÔºàMaxMin„Ç¢„É´„Ç¥„É™„Ç∫„É†Ôºâ
   - ÂêàÊàêÂèØËÉΩÊÄßË©ï‰æ°</p>
</li>
<li>
<p><strong>ÂÆüË∑µÔºöËß¶Â™íÂÄôË£úÊé¢Á¥¢</strong>
   - È°û‰ººÊÄß„Éï„Ç£„É´„Çø
   - ÊßãÈÄ†„Éï„Ç£„É´„Çø
   - Â§öÊßòÊÄßÁ¢∫‰øù
   - QED„Çπ„Ç≥„Ç¢„Å´„Çà„ÇãË©ï‰æ°</p>
</li>
</ol>
<h3>Ê¨°„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó</h3>
<p>Á¨¨4Á´†„Åß„ÅØ„ÄÅÂèçÂøú‰∫àÊ∏¨„Å®RetrosynthesisÔºàÈÄÜÂêàÊàêËß£ÊûêÔºâ„ÇíÂ≠¶„Å≥„Åæ„Åô„ÄÇ</p>
<p><strong><a href="./chapter-4.html">Á¨¨4Á´†ÔºöÂèçÂøú‰∫àÊ∏¨„Å®Retrosynthesis ‚Üí</a></strong></p>
<hr />
<h2>ÂèÇËÄÉÊñáÁåÆ</h2>
<ol>
<li>Willett, P. (2006). "Similarity-based virtual screening using 2D fingerprints." <em>Drug Discovery Today</em>, 11(23-24), 1046-1053. DOI: 10.1016/j.drudis.2006.10.005</li>
<li>McInnes, L. et al. (2018). "UMAP: Uniform Manifold Approximation and Projection for Dimension Reduction." arXiv:1802.03426</li>
<li>Lipinski, C. A. et al. (1997). "Experimental and computational approaches to estimate solubility and permeability in drug discovery and development settings." <em>Advanced Drug Delivery Reviews</em>, 23(1-3), 3-25.</li>
<li>Bickerton, G. R. et al. (2012). "Quantifying the chemical beauty of drugs." <em>Nature Chemistry</em>, 4, 90-98. DOI: 10.1038/nchem.1243</li>
</ol>
<hr />
<p><strong><a href="./chapter-2.html">‚Üê Á¨¨2Á´†</a></strong> | <strong><a href="./index.html">„Ç∑„É™„Éº„Ç∫„Éà„ÉÉ„Éó„Å∏</a></strong> | <strong><a href="./chapter-4.html">Á¨¨4Á´†„Å∏ ‚Üí</a></strong></p><div class="navigation">
    <a href="chapter-2.html" class="nav-button">‚Üê Á¨¨2Á´†</a>
    <a href="index.html" class="nav-button">„Ç∑„É™„Éº„Ç∫ÁõÆÊ¨°„Å´Êàª„Çã</a>
    <a href="chapter-4.html" class="nav-button">Á¨¨4Á´† ‚Üí</a>
</div>
    </main>

    <footer>
        <p><strong>‰ΩúÊàêËÄÖ</strong>: AI Terakoya Content Team</p>
        <p><strong>Áõ£‰øÆ</strong>: Dr. Yusuke HashimotoÔºàÊù±ÂåóÂ§ßÂ≠¶Ôºâ</p>
        <p><strong>„Éê„Éº„Ç∏„Éß„É≥</strong>: 1.0 | <strong>‰ΩúÊàêÊó•</strong>: 2025-10-18</p>
        <p><strong>„É©„Ç§„Çª„É≥„Çπ</strong>: Creative Commons BY 4.0</p>
        <p>¬© 2025 AI Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
