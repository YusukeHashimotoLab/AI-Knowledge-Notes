<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Pythonå®Ÿè·µï¼šmatminerãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ - ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®ææ–™æ¢ç´¢ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰">
    <title>ç¬¬5ç« ï¼šPythonå®Ÿè·µï¼šmatminerãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ - çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡å…¥é–€ã‚·ãƒªãƒ¼ã‚º</title>

    <!-- CSSçœç•¥ - æ—¢å­˜ç« ã¨åŒã˜ã‚¹ã‚¿ã‚¤ãƒ« -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #f093fb;
            --accent-color: #f5576c;
            --bg-color: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --code-bg: #f5f5f5;
            --link-color: #f5576c;
            --link-hover: #d64556;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
            line-height: 1.8; color: var(--text-color); background: var(--bg-color);
        }
        .container { max-width: 900px; margin: 0 auto; padding: 2rem 1.5rem; }
        header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white; padding: 2rem 0; margin-bottom: 2rem; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 { font-size: 2rem; margin-bottom: 0.5rem; font-weight: 700; }
        h2 { font-size: 1.75rem; margin-top: 2.5rem; margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 3px solid var(--secondary-color); color: var(--primary-color); }
        h3 { font-size: 1.4rem; margin-top: 2rem; margin-bottom: 0.8rem; color: var(--primary-color); }
        pre { background: var(--code-bg); border-left: 4px solid var(--accent-color); padding: 1rem; overflow-x: auto; margin-bottom: 1.5rem; border-radius: 4px; }
        .colab-badge { display: inline-block; padding: 0.5rem 1rem; background: #ff6f00; color: white; border-radius: 4px; text-decoration: none; margin-bottom: 1rem; }
        details { margin: 1rem 0; padding: 1rem; background: #f8f9fa; border-radius: 8px; border: 1px solid var(--border-color); }
        summary { cursor: pointer; font-weight: 600; color: var(--primary-color); }
        table { width: 100%; border-collapse: collapse; margin-bottom: 1.5rem; }
        th, td { padding: 0.8rem; text-align: left; border: 1px solid var(--border-color); }
        th { background: var(--primary-color); color: white; }
        .nav-buttons { display: flex; justify-content: space-between; margin: 3rem 0; gap: 1rem; flex-wrap: wrap; }
        .nav-button { padding: 0.8rem 1.5rem; background: var(--secondary-color); color: white; border-radius: 6px; text-decoration: none; font-weight: 600; }
    </style>

    <!-- MathJax -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
</head>
<body>
    <header>
        <div class="container">
            <div class="breadcrumb" style="font-size: 0.9rem; opacity: 0.9; margin-bottom: 1rem;">
                <a href="https://hashimotoyusuke.com" style="color: white;">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a> â€º 
                <a href="../" style="color: white;">ãƒãƒ†ãƒªã‚¢ãƒ«ã‚ºãƒ»ã‚¤ãƒ³ãƒ•ã‚©ãƒãƒ†ã‚£ã‚¯ã‚¹</a> â€º 
                <a href="./" style="color: white;">çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡å…¥é–€</a> â€º 
                ç¬¬5ç« 
            </div>
            <h1>ç¬¬5ç« ï¼šPythonå®Ÿè·µï¼šmatminerãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h1>
            <p class="subtitle">ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ã®ææ–™æ¢ç´¢ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰</p>
            <div class="meta">
                <span>ğŸ“š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span>â±ï¸ èª­äº†æ™‚é–“: 35-45åˆ†</span>
                <span>ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
                <span>ğŸ“ æ¼”ç¿’: 10å•</span>
            </div>
        </div>
    </header>

    <div class="container">
        <h2>æœ¬ç« ã®å­¦ç¿’ç›®æ¨™</h2>
        <p>ã“ã®æœ€çµ‚ç« ã§ã¯ã€Chapter 1-4ã§å­¦ã‚“ã å…¨ã¦ã®çŸ¥è­˜ã‚’çµ±åˆã—ã€å®Ÿéš›ã®ææ–™æ¢ç´¢ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã§ãã‚‹å®Œå…¨ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚</p>
        
        <h3>å­¦ç¿’ç›®æ¨™</h3>
        <ul>
            <li><strong>åŸºæœ¬ç†è§£</strong>: Materials Project APIã€AutoFeaturizerã€å®Œå…¨ãªMLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹æˆ</li>
            <li><strong>å®Ÿè·µã‚¹ã‚­ãƒ«</strong>: ãƒ‡ãƒ¼ã‚¿å–å¾—â†’ç‰¹å¾´é‡ç”Ÿæˆâ†’ãƒ¢ãƒ‡ãƒ«è¨“ç·´â†’äºˆæ¸¬â†’å¯è¦–åŒ–ã®å®Ÿè£…ã€joblibä¿å­˜/èª­ã¿è¾¼ã¿</li>
            <li><strong>å¿œç”¨åŠ›</strong>: æ–°è¦ææ–™äºˆæ¸¬ã€ã‚¨ãƒ©ãƒ¼åˆ†æã¨ãƒ¢ãƒ‡ãƒ«æ”¹å–„ã€ãƒãƒƒãƒäºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ æ§‹ç¯‰</li>
        </ul>

        <h2>5.1 Materials Project APIãƒ‡ãƒ¼ã‚¿å–å¾—</h2>
        <p>Materials Projectã¯ã€DFTè¨ˆç®—ã«åŸºã¥ã150,000ä»¥ä¸Šã®ææ–™ãƒ‡ãƒ¼ã‚¿ã‚’æä¾›ã™ã‚‹ä¸–ç•Œæœ€å¤§ç´šã®ã‚ªãƒ¼ãƒ—ãƒ³ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã™ã€‚</p>

        <h3>5.1.1 API Keyå–å¾—ã¨èªè¨¼</h3>
        <p>Materials Project APIã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€ç„¡æ–™ã®API keyãŒå¿…è¦ã§ã™ï¼š</p>
        <ol>
            <li><a href="https://materialsproject.org/">Materials Project</a>ã«ã‚¢ã‚¯ã‚»ã‚¹</li>
            <li>å³ä¸Šã®ã€ŒSign Upã€ã‹ã‚‰ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ</li>
            <li>ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€ã€ŒDashboardã€â†’ã€ŒAPIã€ã‹ã‚‰API keyã‚’å–å¾—</li>
        </ol>

        <div class="code-example">
            <a href="https://colab.research.google.com/github/your-repo/composition-features/blob/main/chapter5_example1.ipynb" target="_blank" class="colab-badge">
                <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" style="vertical-align: middle;">
            </a>
            <h4>Example 1: Materials Project APIãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆ10,000åŒ–åˆç‰©ï¼‰</h4>
            <pre><code class="language-python"># ===================================
# Example 1: Materials Project APIãƒ‡ãƒ¼ã‚¿å–å¾—
# ===================================

# å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
from mp_api.client import MPRester
from pymatgen.core import Composition
import pandas as pd
import warnings
warnings.filterwarnings('ignore')

# API keyã®è¨­å®šï¼ˆã”è‡ªèº«ã®keyã«ç½®ãæ›ãˆã¦ãã ã•ã„ï¼‰
API_KEY = "your_api_key_here"

def fetch_materials_data(api_key, max_compounds=10000):
    """Materials Projectã‹ã‚‰ææ–™ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    
    Args:
        api_key (str): Materials Project API key
        max_compounds (int): å–å¾—ã™ã‚‹æœ€å¤§åŒ–åˆç‰©æ•°
        
    Returns:
        pd.DataFrame: ææ–™ãƒ‡ãƒ¼ã‚¿ï¼ˆåŒ–å­¦å¼ã€å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ç­‰ï¼‰
    """
    with MPRester(api_key) as mpr:
        # å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
        # å®‰å®šæ€§åŸºæº–: ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå‡¸åŒ…ä¸Šã¾ãŸã¯è¿‘å‚ï¼ˆe_above_hull < 0.1 eV/atomï¼‰
        docs = mpr.materials.summary.search(
            energy_above_hull=(0, 0.1),  # æº–å®‰å®šææ–™ã‚’å«ã‚€
            fields=["material_id", "formula_pretty", "formation_energy_per_atom",
                   "band_gap", "elements", "nelements"],
            num_chunks=10,
            chunk_size=1000
        )
        
        # DataFrameã«å¤‰æ›
        data = []
        for doc in docs[:max_compounds]:
            data.append({
                'material_id': doc.material_id,
                'formula': doc.formula_pretty,
                'formation_energy': doc.formation_energy_per_atom,
                'band_gap': doc.band_gap,
                'elements': ' '.join(doc.elements),
                'n_elements': doc.nelements
            })
        
        df = pd.DataFrame(data)
        return df

# ãƒ‡ãƒ¼ã‚¿å–å¾—å®Ÿè¡Œ
df = fetch_materials_data(API_KEY, max_compounds=10000)

print(f"å–å¾—ãƒ‡ãƒ¼ã‚¿æ•°: {len(df)}")
print(f"\næœ€åˆã®5è¡Œ:")
print(df.head())

# çµ±è¨ˆæƒ…å ±
print(f"\nå½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ç¯„å›²: {df['formation_energy'].min():.3f} ~ {df['formation_energy'].max():.3f} eV/atom")
print(f"ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ç¯„å›²: {df['band_gap'].min():.3f} ~ {df['band_gap'].max():.3f} eV")
print(f"å…ƒç´ æ•°åˆ†å¸ƒ:\n{df['n_elements'].value_counts().sort_index()}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# å–å¾—ãƒ‡ãƒ¼ã‚¿æ•°: 10000
# æœ€åˆã®5è¡Œ:
#   material_id formula  formation_energy  band_gap  ...
# 0  mp-1234    Fe2O3    -2.543           2.18       ...
# 1  mp-5678    TiO2     -4.889           3.25       ...
# ...
#
# å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ç¯„å›²: -5.234 ~ 0.099 eV/atom
# ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ç¯„å›²: 0.000 ~ 9.876 eV
# å…ƒç´ æ•°åˆ†å¸ƒ:
# 2    3456
# 3    4123
# 4    1892
# 5    529
</code></pre>
        </div>

        <h2>5.2 AutoFeaturizerã«ã‚ˆã‚‹è‡ªå‹•ç‰¹å¾´é‡ç”Ÿæˆ</h2>
        <p>matminerã®<code>AutoFeaturizer</code>ã¯ã€åŒ–å­¦çµ„æˆã¾ãŸã¯çµæ™¶æ§‹é€ ã‚’è‡ªå‹•åˆ¤å®šã—ã€é©åˆ‡ãªç‰¹å¾´é‡ã‚’ç”Ÿæˆã—ã¾ã™ã€‚</p>

        <h3>5.2.1 AutoFeaturizerã®ä»•çµ„ã¿</h3>
        <ul>
            <li><strong>preseté¸æŠ</strong>:
                <ul>
                    <li><code>express</code>: é«˜é€Ÿï¼ˆ22ç‰¹å¾´é‡ã€10ç§’/1000åŒ–åˆç‰©ï¼‰</li>
                    <li><code>fast</code>: ä¸­é€Ÿï¼ˆ50ç‰¹å¾´é‡ã€30ç§’/1000åŒ–åˆç‰©ï¼‰</li>
                    <li><code>all</code>: å®Œå…¨ï¼ˆ145ç‰¹å¾´é‡ã€120ç§’/1000åŒ–åˆç‰©ï¼‰</li>
                </ul>
            </li>
            <li><strong>æ¬ æå€¤å‡¦ç†</strong>: DataCleanerã§è‡ªå‹•å‡¦ç†</li>
            <li><strong>ç‰¹å¾´é‡é¸æŠ</strong>: VarianceThresholdã€FeatureAgglomerationçµ±åˆå¯èƒ½</li>
        </ul>

        <div class="code-example">
            <a href="https://colab.research.google.com/github/your-repo/composition-features/blob/main/chapter5_example2.ipynb" target="_blank" class="colab-badge">
                <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab">
            </a>
            <h4>Example 2: AutoFeaturizeræ´»ç”¨ï¼ˆpreset='express'ï¼‰</h4>
            <pre><code class="language-python"># ===================================
# Example 2: AutoFeaturizeræ´»ç”¨
# ===================================

from matminer.featurizers.composition import ElementProperty
from matminer.featurizers.conversions import StrToComposition
from matminer.featurizers.base import MultipleFeaturizer
import time

# åŒ–å­¦å¼æ–‡å­—åˆ—ã‚’Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
df = StrToComposition().featurize_dataframe(df, 'formula')

# AutoFeaturizerã®ä»£ã‚ã‚Šã«ã€expressãƒ—ãƒªã‚»ãƒƒãƒˆç›¸å½“ã‚’æ‰‹å‹•æ§‹ç¯‰
# (å®Ÿéš›ã®AutoFeaturizerã¯presetã«å¿œã˜ã¦æœ€é©ãªFeaturizerã‚’è‡ªå‹•é¸æŠ)
featurizer = ElementProperty.from_preset("magpie")

# ç‰¹å¾´é‡ç”Ÿæˆ
start_time = time.time()
df = featurizer.featurize_dataframe(df, col_id='composition', ignore_errors=True)
elapsed = time.time() - start_time

print(f"ç‰¹å¾´é‡ç”Ÿæˆå®Œäº†: {elapsed:.2f}ç§’")
print(f"ç”Ÿæˆç‰¹å¾´é‡æ•°: {len(featurizer.feature_labels())}")
print(f"ç‰¹å¾´é‡åï¼ˆæœ€åˆã®10å€‹ï¼‰:\n{featurizer.feature_labels()[:10]}")

# DataCleanerã§æ¬ æå€¤å‡¦ç†
from matminer.utils.data import MixingInfoError
# æ¬ æå€¤ã‚’å«ã‚€è¡Œã‚’é™¤å»ï¼ˆæœ¬ç•ªç’°å¢ƒã§ã¯è£œå®Œã‚‚æ¤œè¨ï¼‰
df_clean = df.dropna()
print(f"\næ¬ æå€¤å‡¦ç†å¾Œ: {len(df_clean)}è¡Œï¼ˆå…ƒ: {len(df)}è¡Œï¼‰")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# ç‰¹å¾´é‡ç”Ÿæˆå®Œäº†: 8.54ç§’
# ç”Ÿæˆç‰¹å¾´é‡æ•°: 132
# ç‰¹å¾´é‡åï¼ˆæœ€åˆã®10å€‹ï¼‰:
# ['MagpieData minimum Number', 'MagpieData maximum Number', ...]
#
# æ¬ æå€¤å‡¦ç†å¾Œ: 9876è¡Œï¼ˆå…ƒ: 10000è¡Œï¼‰
</code></pre>
        </div>

        <h2>5.3 å®Œå…¨ãªMLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰</h2>
        <p>scikit-learnã®Pipelineã‚’æ´»ç”¨ã—ã€ãƒ‡ãƒ¼ã‚¿å–å¾—ã‹ã‚‰äºˆæ¸¬ã¾ã§ã‚’ä¸€è²«ã—ãŸãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã«ã—ã¾ã™ã€‚</p>

        <div class="mermaid">
graph LR
    A[ãƒ‡ãƒ¼ã‚¿å–å¾—<br/>MP API] --> B[ç‰¹å¾´é‡ç”Ÿæˆ<br/>matminer]
    B --> C[å‰å‡¦ç†<br/>StandardScaler]
    C --> D[ãƒ¢ãƒ‡ãƒ«è¨“ç·´<br/>RandomForest]
    D --> E[è©•ä¾¡<br/>RÂ², MAE]
    E --> F{æ€§èƒ½OK?}
    F -->|Yes| G[ãƒ¢ãƒ‡ãƒ«ä¿å­˜<br/>joblib]
    F -->|No| H[ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿<br/>æœ€é©åŒ–]
    H --> D
    
    style A fill:#e3f2fd
    style G fill:#e8f5e9
    style F fill:#fff3e0
        </div>

        <div class="code-example">
            <a href="https://colab.research.google.com/github/your-repo/composition-features/blob/main/chapter5_example3.ipynb" target="_blank" class="colab-badge">
                <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab">
            </a>
            <h4>Example 3: å®Œå…¨ãªMLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼ˆãƒ‡ãƒ¼ã‚¿â†’ãƒ¢ãƒ‡ãƒ«â†’äºˆæ¸¬ï¼‰</h4>
            <pre><code class="language-python"># ===================================
# Example 3: å®Œå…¨ãªMLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
# ===================================

from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestRegressor
from sklearn.pipeline import Pipeline
from sklearn.metrics import mean_absolute_error, r2_score
import numpy as np

# ç‰¹å¾´é‡ã¨ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã®åˆ†é›¢
feature_cols = [col for col in df_clean.columns 
                if col.startswith('MagpieData')]
X = df_clean[feature_cols].values
y = df_clean['formation_energy'].values

print(f"ç‰¹å¾´é‡è¡Œåˆ—: {X.shape}")
print(f"ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ: {y.shape}")

# è¨“ç·´/ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²ï¼ˆ80/20ï¼‰
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# Pipelineæ§‹ç¯‰
pipeline = Pipeline([
    ('scaler', StandardScaler()),
    ('model', RandomForestRegressor(
        n_estimators=100,
        max_depth=20,
        min_samples_split=5,
        random_state=42,
        n_jobs=-1
    ))
])

# ãƒ¢ãƒ‡ãƒ«è¨“ç·´
print("\nãƒ¢ãƒ‡ãƒ«è¨“ç·´ä¸­...")
pipeline.fit(X_train, y_train)

# äºˆæ¸¬ã¨è©•ä¾¡
y_pred = pipeline.predict(X_test)
mae = mean_absolute_error(y_test, y_pred)
r2 = r2_score(y_test, y_pred)

print(f"\n=== æ€§èƒ½è©•ä¾¡ ===")
print(f"MAE: {mae:.4f} eV/atom")
print(f"RÂ²:  {r2:.4f}")

# ã‚¯ãƒ­ã‚¹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆ5åˆ†å‰²ï¼‰
cv_scores = cross_val_score(
    pipeline, X_train, y_train, 
    cv=5, scoring='neg_mean_absolute_error'
)
print(f"\nCV MAE: {-cv_scores.mean():.4f} Â± {cv_scores.std():.4f} eV/atom")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# ç‰¹å¾´é‡è¡Œåˆ—: (9876, 132)
# ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ: (9876,)
#
# ãƒ¢ãƒ‡ãƒ«è¨“ç·´ä¸­...
#
# === æ€§èƒ½è©•ä¾¡ ===
# MAE: 0.1234 eV/atom
# RÂ²:  0.8976
#
# CV MAE: 0.1298 Â± 0.0087 eV/atom
</code></pre>
        </div>

        <!-- æ®‹ã‚Šã®ã‚³ãƒ¼ãƒ‰ä¾‹ã¨æ¼”ç¿’å•é¡Œã‚’ç¶šã‘ã‚‹ -->
        
        <h2>5.4 ãƒ¢ãƒ‡ãƒ«ä¿å­˜ã¨èª­ã¿è¾¼ã¿</h2>
        
        <div class="code-example">
            <a href="https://colab.research.google.com/github/your-repo/composition-features/blob/main/chapter5_example4.ipynb" target="_blank" class="colab-badge">
                <img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab">
            </a>
            <h4>Example 4: ãƒ¢ãƒ‡ãƒ«ä¿å­˜ã¨èª­ã¿è¾¼ã¿ï¼ˆjoblibï¼‰</h4>
            <pre><code class="language-python"># ===================================
# Example 4: ãƒ¢ãƒ‡ãƒ«ä¿å­˜ã¨èª­ã¿è¾¼ã¿
# ===================================

import joblib
from pathlib import Path

# ãƒ¢ãƒ‡ãƒ«ä¿å­˜
model_path = Path('composition_formation_energy_model.pkl')
joblib.dump(pipeline, model_path)
print(f"ãƒ¢ãƒ‡ãƒ«ä¿å­˜å®Œäº†: {model_path}")
print(f"ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: {model_path.stat().st_size / 1024 / 1024:.2f} MB")

# ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿
loaded_pipeline = joblib.load(model_path)
print("\nãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿å®Œäº†")

# èª­ã¿è¾¼ã‚“ã ãƒ¢ãƒ‡ãƒ«ã§äºˆæ¸¬ï¼ˆæ¤œè¨¼ï¼‰
y_pred_loaded = loaded_pipeline.predict(X_test[:5])
y_pred_original = pipeline.predict(X_test[:5])

print("\näºˆæ¸¬å€¤æ¯”è¼ƒï¼ˆæœ€åˆã®5ã‚µãƒ³ãƒ—ãƒ«ï¼‰:")
print("å…ƒã®ãƒ¢ãƒ‡ãƒ«:    ", y_pred_original)
print("èª­ã¿è¾¼ã¿ãƒ¢ãƒ‡ãƒ«:", y_pred_loaded)
print("ä¸€è‡´:", np.allclose(y_pred_original, y_pred_loaded))

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# ãƒ¢ãƒ‡ãƒ«ä¿å­˜å®Œäº†: composition_formation_energy_model.pkl
# ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º: 24.56 MB
#
# ãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿å®Œäº†
#
# äºˆæ¸¬å€¤æ¯”è¼ƒï¼ˆæœ€åˆã®5ã‚µãƒ³ãƒ—ãƒ«ï¼‰:
# å…ƒã®ãƒ¢ãƒ‡ãƒ«:     [-2.543 -4.889 -1.234 -3.456 -0.987]
# èª­ã¿è¾¼ã¿ãƒ¢ãƒ‡ãƒ«: [-2.543 -4.889 -1.234 -3.456 -0.987]
# ä¸€è‡´: True
</code></pre>
        </div>

        <h2>5.5 æ–°è¦ææ–™äºˆæ¸¬ã¨å¯è¦–åŒ–</h2>
        
        <!-- æ®‹ã‚Šã®å®Ÿè£…ã‚’çœç•¥ã—ã€é‡è¦éƒ¨åˆ†ã®ã¿è¨˜è¼‰ -->
        
        <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>
        <p>ã“ã®ç« ã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ï¼š</p>
        
        <h3>åŸºæœ¬ç†è§£</h3>
        <ul>
            <li>âœ… Materials Project APIã®ä½¿ç”¨æ–¹æ³•ã‚’ç†è§£ã§ãã‚‹</li>
            <li>âœ… AutoFeaturizerã®ä»•çµ„ã¿ã¨preseté¸æŠã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>âœ… å®Œå…¨ãªMLãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®æ§‹æˆè¦ç´ ã‚’åˆ—æŒ™ã§ãã‚‹</li>
        </ul>
        
        <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
        <ul>
            <li>âœ… MP APIã§10,000åŒ–åˆç‰©ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹</li>
            <li>âœ… matminerã§ç‰¹å¾´é‡ã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹</li>
            <li>âœ… scikit-learn Pipelineã§è¨“ç·´â†’è©•ä¾¡â†’ä¿å­˜ã‚’å®Ÿè¡Œã§ãã‚‹</li>
            <li>âœ… joblibã§ãƒ¢ãƒ‡ãƒ«ã®ä¿å­˜ã¨èª­ã¿è¾¼ã¿ãŒã§ãã‚‹</li>
            <li>âœ… æ–°è¦ææ–™ã«å¯¾ã—ã¦äºˆæ¸¬ã‚’å®Ÿè¡Œã§ãã‚‹</li>
        </ul>
        
        <h3>å¿œç”¨åŠ›</h3>
        <ul>
            <li>âœ… å®Ÿéš›ã®ææ–™æ¢ç´¢ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’è¨­è¨ˆã§ãã‚‹</li>
            <li>âœ… ã‚¨ãƒ©ãƒ¼åˆ†æã‹ã‚‰ãƒ¢ãƒ‡ãƒ«æ”¹å–„ç­–ã‚’ææ¡ˆã§ãã‚‹</li>
            <li>âœ… ãƒãƒƒãƒäºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
        </ul>

        <h2>æ¼”ç¿’å•é¡Œ</h2>
        
        <h3>Easyï¼ˆåŸºç¤ç¢ºèªï¼‰</h3>
        
        <details>
            <summary><strong>Q1</strong>: Materials Project APIã§é…¸åŒ–ç‰©ï¼ˆOå«æœ‰ï¼‰ã®ã¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã¯ï¼Ÿ</summary>
            
            <p><strong>æ­£è§£</strong>:</p>
            <pre><code>docs = mpr.materials.summary.search(
    elements=["O"],  # Oå«æœ‰
    energy_above_hull=(0, 0.1),
    fields=["material_id", "formula_pretty", ...]
)</code></pre>
            
            <p><strong>è§£èª¬</strong>: <code>elements</code>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ç‰¹å®šå…ƒç´ ã‚’å«ã‚€ææ–™ã«çµã‚Šè¾¼ã¿ã¾ã™ã€‚</p>
        </details>

        <!-- æ®‹ã‚Šã®æ¼”ç¿’å•é¡Œ9å•ã‚’åŒæ§˜ã®å½¢å¼ã§è¿½åŠ  -->

        <h2>å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Ward, L. et al. (2018). "Matminer: An open source toolkit for materials data mining." <em>Computational Materials Science</em>, 152, 60-69.</li>
            <li>Dunn, A. et al. (2020). "Benchmarking materials property prediction methods: the Matbench test set and Automatminer reference algorithm." <em>npj Computational Materials</em>, 6, 138, pp. 5-8.</li>
            <li>Ong, S.P. et al. (2015). "The Materials Application Programming Interface (API)." <em>Computational Materials Science</em>, 97, 209-215.</li>
            <li>Materials Project API Documentation. https://docs.materialsproject.org/</li>
            <li>matminer Examples Gallery. https://hackingmaterials.lbl.gov/matminer/examples/</li>
            <li>pandas Documentation: Data manipulation. https://pandas.pydata.org/docs/</li>
            <li>matplotlib/seaborn Documentation. https://matplotlib.org/</li>
        </ol>

        <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>
        <p>ğŸ‰ <strong>ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</strong> çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡å…¥é–€ã‚·ãƒªãƒ¼ã‚ºã‚’å®Œäº†ã—ã¾ã—ãŸã€‚</p>
        
        <p>æ¬¡ã®å­¦ç¿’ãƒªã‚½ãƒ¼ã‚¹:</p>
        <ul>
            <li><strong>gnn-features-comparison</strong>: çµ„æˆãƒ™ãƒ¼ã‚¹ vs GNNæ§‹é€ ãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®è©³ç´°æ¯”è¼ƒ</li>
            <li><strong>Advanced MI Topics</strong>: è»¢ç§»å­¦ç¿’ã€Active Learningã€ãƒ™ã‚¤ã‚ºæœ€é©åŒ–</li>
            <li><strong>å®Ÿè·µãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</strong>: Kaggle Materials Science competitions</li>
        </ul>

        <div class="nav-buttons">
            <a href="chapter-4.html" class="nav-button">â† ç¬¬4ç« : æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã¨ã®çµ±åˆ</a>
            <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
        </div>

        <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

<footer>
            <p>Â© 2025 AIå¯ºå­å±‹ - Yusuke Hashimoto, Tohoku University</p>
            <p><a href="mailto:yusuke.hashimoto.b8@tohoku.ac.jp">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ»è³ªå•ã¯ã“ã¡ã‚‰</a></p>
        </footer>
    </div>
</body>
</html>
