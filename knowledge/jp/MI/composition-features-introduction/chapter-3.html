<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="å…ƒç´ ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨Featurizer - å¤šæ§˜ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’çµ±åˆã—ã¦ã‚«ã‚¹ã‚¿ãƒ ç‰¹å¾´é‡ã‚’è¨­è¨ˆ">
    <title>ç¬¬3ç« :å…ƒç´ ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨Featurizer - çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡å…¥é–€ã‚·ãƒªãƒ¼ã‚º</title>

    <!-- CSS Styling -->
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #f093fb;
            --accent-color: #f5576c;
            --bg-color: #ffffff;
            --text-color: #333333;
            --border-color: #e0e0e0;
            --code-bg: #f5f5f5;
            --link-color: #f5576c;
            --link-hover: #d64556;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
            line-height: 1.8;
            color: var(--text-color);
            background: var(--bg-color);
            padding: 0;
            margin: 0;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem 1.5rem;
        }

        /* Header with MS Gradient */
        header {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        header .container {
            padding: 0 1.5rem;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.2rem;
            margin-bottom: 1rem;
            opacity: 0.95;
        }

        .meta {
            display: flex;
            gap: 1.5rem;
            flex-wrap: wrap;
            font-size: 0.9rem;
            opacity: 0.95;
            margin-top: 1rem;
        }

        .meta span {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
        }

        /* Typography */
        h2 {
            font-size: 1.75rem;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--secondary-color);
            color: var(--primary-color);
        }

        h3 {
            font-size: 1.4rem;
            margin-top: 2rem;
            margin-bottom: 0.8rem;
            color: var(--primary-color);
        }

        h4 {
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 0.6rem;
            color: var(--primary-color);
        }

        p {
            margin-bottom: 1.2rem;
        }

        a {
            color: var(--link-color);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--link-hover);
            text-decoration: underline;
        }

        /* Lists */
        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1.2rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        /* Code blocks */
        code {
            background: var(--code-bg);
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Menlo', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            color: #c7254e;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
            position: relative;
        }

        pre code {
            background: none;
            padding: 0;
            font-size: 0.9rem;
            color: inherit;
        }

        /* Google Colab Badge */
        .colab-badge {
            display: inline-block;
            margin-bottom: 0.5rem;
            padding: 0.5rem 1rem;
            background: #f9ab00;
            color: white;
            border-radius: 4px;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.85rem;
            transition: background 0.3s;
        }

        .colab-badge:hover {
            background: #e09600;
            color: white;
        }

        .colab-badge::before {
            content: "â–¶ ";
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 1.5rem;
            overflow-x: auto;
            display: block;
        }

        thead {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        th, td {
            padding: 0.8rem;
            text-align: left;
            border: 1px solid var(--border-color);
        }

        th {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: #f9f9f9;
        }

        /* Blockquotes */
        blockquote {
            border-left: 4px solid var(--accent-color);
            padding-left: 1.5rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #666;
        }

        /* Images */
        img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin: 1rem 0;
        }

        /* Mermaid diagrams */
        .mermaid {
            text-align: center;
            margin: 2rem 0;
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        /* Details/Summary (for exercises) */
        details {
            margin: 1rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--primary-color);
            padding: 0.5rem;
        }

        summary:hover {
            color: var(--accent-color);
        }

        /* Navigation buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin: 3rem 0;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .nav-button {
            display: inline-block;
            padding: 0.8rem 1.5rem;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border-radius: 6px;
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 600;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(245, 87, 108, 0.4);
            color: white;
        }

        /* Highlight boxes */
        .highlight-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            border-left: 4px solid var(--accent-color);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .learning-objectives {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1.5rem 0;
        }

        .learning-objectives h3 {
            margin-top: 0;
            font-size: 1.2rem;
        }

        .learning-objectives ul {
            margin-bottom: 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .nav-button {
                width: 100%;
                text-align: center;
            }
        }
    </style>

    <!-- MathJax Configuration -->
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            svg: {
                fontCache: 'global'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#f093fb',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#f5576c',
                lineColor: '#f5576c',
                secondaryColor: '#e3f2fd',
                tertiaryColor: '#fff'
            }
        });
    </script>

    <!-- Prism.js for syntax highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MI/composition-features-introduction/chapter-3.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
        <div class="container">
            <h1>ç¬¬3ç« :å…ƒç´ ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨Featurizer</h1>
            <p class="subtitle">å¤šæ§˜ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’çµ±åˆã—ã¦ã‚«ã‚¹ã‚¿ãƒ ç‰¹å¾´é‡ã‚’è¨­è¨ˆ</p>
            <div class="meta">
                <span>ğŸ“š çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡å…¥é–€ã‚·ãƒªãƒ¼ã‚º</span>
                <span>â±ï¸ èª­äº†æ™‚é–“: 30-35åˆ†</span>
                <span>ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="learning-objectives">
            <h3>ğŸ“‹ å­¦ç¿’ç›®æ¨™</h3>
            <p>ã“ã®chapterã‚’å®Œäº†ã™ã‚‹ã¨ã€ä»¥ä¸‹ã‚’èª¬æ˜ãƒ»å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™:</p>
            <ul>
                <li><strong>åŸºæœ¬ç†è§£</strong>: Mendeleev/pymatgen/matminerã®é•ã„ã€Featurizerã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®ä¿¡é ¼æ€§è©•ä¾¡</li>
                <li><strong>å®Ÿè·µã‚¹ã‚­ãƒ«</strong>: ElementProperty/Stoichiometry/OxidationStates Featurizerã®å®Ÿè£…ã€ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰ã€ãƒãƒƒãƒå‡¦ç†æœ€é©åŒ–</li>
                <li><strong>å¿œç”¨åŠ›</strong>: ã‚«ã‚¹ã‚¿ãƒ Featurizerè¨­è¨ˆã€è¤‡é›‘ãªææ–™ç³»ã¸ã®é©ç”¨ã€è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆæˆ¦ç•¥</li>
            </ul>
        </div>

        <h2>3.1 å…ƒç´ ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</h2>

        <p>
            çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®è¨ˆç®—ã«ã¯ã€å…ƒç´ ã®ç‰©ç†åŒ–å­¦çš„ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿ãŒä¸å¯æ¬ ã§ã™ã€‚
            ã—ã‹ã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã”ã¨ã«åéŒ²ãƒ‡ãƒ¼ã‚¿ã€ç²¾åº¦ã€æ›´æ–°é »åº¦ãŒç•°ãªã‚‹ãŸã‚ã€ç”¨é€”ã«å¿œã˜ãŸé¸æŠãŒé‡è¦ã§ã™ã€‚
            ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ä¸»è¦ãª3ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆMendeleevã€pymatgenã€matminerï¼‰ã‚’æ¯”è¼ƒã—ã€ãã‚Œãã‚Œã®ç‰¹å¾´ã‚’ç†è§£ã—ã¾ã™ã€‚
        </p>

        <h3>3.1.1 Mendeleev: åŒ…æ‹¬çš„å…ƒç´ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h3>

        <p>
            <strong>Mendeleev</strong>ã¯118å…ƒç´ ã®åŒ…æ‹¬çš„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã€å‘¨æœŸè¡¨ã®å…¨å…ƒç´ ã«ã¤ã„ã¦å®Ÿé¨“å€¤ã‚’ä¸­å¿ƒã«åéŒ²ã—ã¦ã„ã¾ã™ã€‚
            ç‰¹å¾´ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™:
        </p>

        <ul>
            <li><strong>ãƒ‡ãƒ¼ã‚¿é‡</strong>: 1å…ƒç´ ã‚ãŸã‚Šç´„90ç¨®é¡ã®ç‰¹æ€§ï¼ˆåŸå­ç•ªå·ã€è³ªé‡ã€å¯†åº¦ã€èç‚¹ã€æ²¸ç‚¹ã€é›»æ°—é™°æ€§åº¦ã€ã‚¤ã‚ªãƒ³åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ãªã©ï¼‰</li>
            <li><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: ä¸»ã«å®Ÿé¨“å€¤ï¼ˆNISTã€CRC Handbookç­‰ã®ä¿¡é ¼æ€§ã®é«˜ã„æ–‡çŒ®ï¼‰</li>
            <li><strong>æ›´æ–°é »åº¦</strong>: å®šæœŸçš„ï¼ˆå¹´1-2å›ç¨‹åº¦ï¼‰</li>
            <li><strong>åˆ©ç‚¹</strong>: å®Ÿé¨“å€¤ãƒ™ãƒ¼ã‚¹ã§ä¿¡é ¼æ€§ãŒé«˜ã„ã€ãƒ‡ãƒ¼ã‚¿ã®å‡ºå…¸ãŒæ˜ç¢º</li>
            <li><strong>åˆ¶é™</strong>: è¨ˆç®—å€¤ï¼ˆDFTç­‰ï¼‰ã¯å«ã¾ãªã„ã€ä¸€éƒ¨å…ƒç´ ã§æ¬ æå€¤ã‚ã‚Š</li>
        </ul>

        <div class="highlight-box">
            <strong>ğŸ’¡ Pro Tip:</strong> Mendeleevã¯å®Ÿé¨“å€¤ã®ä¿¡é ¼æ€§ãŒé«˜ã„ãŸã‚ã€ç²¾å¯†ãªç‰©æ€§äºˆæ¸¬ï¼ˆèç‚¹ã€å¯†åº¦ãªã©ï¼‰ã«æœ€é©ã§ã™ã€‚
            ãŸã ã—ã€å¸ŒåœŸé¡å…ƒç´ ã‚„äººå·¥å…ƒç´ ã§ã¯ä¸€éƒ¨ãƒ‡ãƒ¼ã‚¿ãŒæ¬ æã—ã¦ã„ã‚‹å ´åˆãŒã‚ã‚‹ãŸã‚ã€äº‹å‰ç¢ºèªãŒå¿…è¦ã§ã™ã€‚
        </div>

        <a href="https://colab.research.google.com/github/yourusername/composition-features/blob/main/chapter3_example1.ipynb" target="_blank" class="colab-badge">Google Colabã§å®Ÿè¡Œ</a>
        <pre><code class="language-python"># ===================================
# Example 1: Mendeleev vs pymatgen vs matminerãƒ‡ãƒ¼ã‚¿æ¯”è¼ƒ
# ===================================

# å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
import mendeleev
from pymatgen.core import Element
from matminer.featurizers.base import BaseFeaturizer
from matminer.featurizers.composition import ElementProperty
import pandas as pd

# ãƒ‡ãƒ¼ã‚¿æ¯”è¼ƒé–¢æ•°
def compare_databases(element_symbol):
    """3ã¤ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å…ƒç´ ç‰¹æ€§ã‚’å–å¾—ã—ã¦æ¯”è¼ƒ

    Args:
        element_symbol (str): å…ƒç´ è¨˜å·ï¼ˆä¾‹: 'Fe', 'Cu'ï¼‰

    Returns:
        pd.DataFrame: å„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç‰¹æ€§å€¤æ¯”è¼ƒè¡¨
    """
    # Mendeleevã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
    elem_mendeleev = mendeleev.element(element_symbol)

    # pymatgenã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—
    elem_pymatgen = Element(element_symbol)

    # æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
    comparison = pd.DataFrame({
        'Property': [
            'Atomic Number',
            'Atomic Mass',
            'Atomic Radius (pm)',
            'Electronegativity (Pauling)',
            'Ionization Energy 1st (eV)',
            'Melting Point (K)',
            'Density (g/cmÂ³)'
        ],
        'Mendeleev': [
            elem_mendeleev.atomic_number,
            elem_mendeleev.atomic_weight,
            elem_mendeleev.atomic_radius if elem_mendeleev.atomic_radius else 'N/A',
            elem_mendeleev.electronegativity() if elem_mendeleev.electronegativity() else 'N/A',
            elem_mendeleev.ionenergies.get(1, 'N/A'),
            elem_mendeleev.melting_point if elem_mendeleev.melting_point else 'N/A',
            elem_mendeleev.density if elem_mendeleev.density else 'N/A'
        ],
        'pymatgen': [
            elem_pymatgen.Z,
            elem_pymatgen.atomic_mass,
            elem_pymatgen.atomic_radius,
            elem_pymatgen.X,  # Pauling electronegativity
            elem_pymatgen.ionization_energy,
            elem_pymatgen.melting_point if elem_pymatgen.melting_point else 'N/A',
            elem_pymatgen.density_of_solid if elem_pymatgen.density_of_solid else 'N/A'
        ]
    })

    return comparison

# å®Ÿè¡Œä¾‹: é‰„(Fe)ã®æ¯”è¼ƒ
fe_comparison = compare_databases('Fe')
print("=== é‰„(Fe)ã®å…ƒç´ ç‰¹æ€§æ¯”è¼ƒ ===")
print(fe_comparison.to_string(index=False))
print()

# è¤‡æ•°å…ƒç´ ã®æ¯”è¼ƒ
elements = ['Fe', 'Cu', 'Al', 'Ti']
print("=== é›»æ°—é™°æ€§åº¦ã®æ¯”è¼ƒï¼ˆPauling Scaleï¼‰ ===")
for elem in elements:
    mendeleev_val = mendeleev.element(elem).electronegativity()
    pymatgen_val = Element(elem).X
    print(f"{elem:2s} - Mendeleev: {mendeleev_val:.2f}, pymatgen: {pymatgen_val:.2f}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === é‰„(Fe)ã®å…ƒç´ ç‰¹æ€§æ¯”è¼ƒ ===
#                      Property Mendeleev pymatgen
#                Atomic Number        26       26
#                  Atomic Mass     55.85    55.85
#         Atomic Radius (pm)       140      140
# Electronegativity (Pauling)      1.83     1.83
#  Ionization Energy 1st (eV)      7.90     7.90
#          Melting Point (K)      1811     1811
#            Density (g/cmÂ³)      7.87     7.87
#
# === é›»æ°—é™°æ€§åº¦ã®æ¯”è¼ƒï¼ˆPauling Scaleï¼‰ ===
# Fe - Mendeleev: 1.83, pymatgen: 1.83
# Cu - Mendeleev: 1.90, pymatgen: 1.90
# Al - Mendeleev: 1.61, pymatgen: 1.61
# Ti - Mendeleev: 1.54, pymatgen: 1.54
</code></pre>

        <h3>3.1.2 pymatgen: Materials Projectçµ±åˆãƒ‡ãƒ¼ã‚¿</h3>

        <p>
            <strong>pymatgen</strong>ã¯Materials Projectã¨çµ±åˆã•ã‚ŒãŸææ–™ç§‘å­¦å°‚ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€DFTè¨ˆç®—å€¤ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ã‚’æä¾›ã—ã¾ã™ã€‚
        </p>

        <ul>
            <li><strong>ãƒ‡ãƒ¼ã‚¿é‡</strong>: ç´„60ç¨®é¡ã®ç‰¹æ€§ï¼ˆåŸºæœ¬ç‰¹æ€§ + DFTè¨ˆç®—å€¤ï¼‰</li>
            <li><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: Materials Projectï¼ˆDFTè¨ˆç®—ï¼‰+ å®Ÿé¨“å€¤</li>
            <li><strong>æ›´æ–°é »åº¦</strong>: é »ç¹ï¼ˆMaterials Projectã¨åŒæœŸï¼‰</li>
            <li><strong>åˆ©ç‚¹</strong>: DFTè¨ˆç®—å€¤ãŒåˆ©ç”¨å¯èƒ½ã€çµæ™¶æ§‹é€ ãƒ‡ãƒ¼ã‚¿ã¨çµ±åˆ</li>
            <li><strong>åˆ¶é™</strong>: ä¸€éƒ¨ã®å®Ÿé¨“å€¤ãŒMendeleevã‚ˆã‚Šå¤ã„å ´åˆãŒã‚ã‚‹</li>
        </ul>

        <h3>3.1.3 matminer: è¤‡æ•°ã‚½ãƒ¼ã‚¹çµ±åˆ</h3>

        <p>
            <strong>matminer</strong>ã¯è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆMagpieã€DeMLã€MEGNetç­‰ï¼‰ã‚’çµ±åˆã—ãŸãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã™ã€‚
        </p>

        <ul>
            <li><strong>ãƒ‡ãƒ¼ã‚¿é‡</strong>: ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã‚ˆã£ã¦ç•°ãªã‚‹ï¼ˆMagpieã¯132æ¬¡å…ƒã€DeMLã¯62æ¬¡å…ƒï¼‰</li>
            <li><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: è«–æ–‡ã§å ±å‘Šã•ã‚ŒãŸç‰¹æ€§ã‚»ãƒƒãƒˆ</li>
            <li><strong>æ›´æ–°é »åº¦</strong>: ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ›´æ–°ã«ä¾å­˜</li>
            <li><strong>åˆ©ç‚¹</strong>: æ©Ÿæ¢°å­¦ç¿’ã«æœ€é©åŒ–ã•ã‚ŒãŸç‰¹æ€§ã‚»ãƒƒãƒˆã€æ¬ æå€¤å‡¦ç†æ¸ˆã¿</li>
            <li><strong>åˆ¶é™</strong>: ãƒ‡ãƒ¼ã‚¿ã®å‡ºå…¸ãŒè¤‡é›‘ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ãŒé‡è¦</li>
        </ul>

        <h3>3.1.4 ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ¯”è¼ƒè¡¨</h3>

        <table>
            <thead>
                <tr>
                    <th>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</th>
                    <th>ä¸»ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</th>
                    <th>ç‰¹æ€§æ•°</th>
                    <th>æ¬ æå€¤</th>
                    <th>æ¨å¥¨ç”¨é€”</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Mendeleev</strong></td>
                    <td>å®Ÿé¨“å€¤ï¼ˆNISTã€CRCï¼‰</td>
                    <td>~90</td>
                    <td>å°‘ãªã„ï¼ˆ5-10%ï¼‰</td>
                    <td>ç²¾å¯†ç‰©æ€§äºˆæ¸¬</td>
                </tr>
                <tr>
                    <td><strong>pymatgen</strong></td>
                    <td>DFT + å®Ÿé¨“å€¤</td>
                    <td>~60</td>
                    <td>ä¸­ç¨‹åº¦ï¼ˆ10-20%ï¼‰</td>
                    <td>çµæ™¶ææ–™ã€è¨ˆç®—å€¤åˆ©ç”¨</td>
                </tr>
                <tr>
                    <td><strong>matminer</strong></td>
                    <td>è«–æ–‡ç‰¹æ€§ã‚»ãƒƒãƒˆ</td>
                    <td>62-132</td>
                    <td>å‡¦ç†æ¸ˆã¿</td>
                    <td>æ©Ÿæ¢°å­¦ç¿’ã€ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</td>
                </tr>
            </tbody>
        </table>

        <div class="mermaid">
graph LR
    A[å…ƒç´ ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿] --> B[Mendeleev<br/>å®Ÿé¨“å€¤ãƒ™ãƒ¼ã‚¹]
    A --> C[pymatgen<br/>DFT + å®Ÿé¨“å€¤]
    A --> D[matminer<br/>è¤‡æ•°ã‚½ãƒ¼ã‚¹çµ±åˆ]

    B --> E[ç²¾å¯†ç‰©æ€§äºˆæ¸¬<br/>èç‚¹ãƒ»å¯†åº¦]
    C --> F[çµæ™¶ææ–™<br/>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—]
    D --> G[æ©Ÿæ¢°å­¦ç¿’<br/>ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯]

    style A fill:#f093fb,stroke:#f5576c,stroke-width:3px,color:#fff
    style B fill:#e3f2fd
    style C fill:#fff3e0
    style D fill:#f3e5f5
    style E fill:#e8f5e9
    style F fill:#e8f5e9
    style G fill:#e8f5e9
        </div>

        <h2>3.2 Featurizerã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h2>

        <p>
            matminerã®Featurizerã¯ã€å…ƒç´ ç‰¹æ€§ã‹ã‚‰ç‰¹å¾´é‡ã‚’è¨ˆç®—ã™ã‚‹çµ±ä¸€çš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æä¾›ã—ã¾ã™ã€‚
            scikit-learnäº’æ›ã®APIã‚’æ¡ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€æ©Ÿæ¢°å­¦ç¿’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã«ç›´æ¥çµ±åˆã§ãã¾ã™ã€‚
        </p>

        <h3>3.2.1 BaseFeaturizerã‚¯ãƒ©ã‚¹</h3>

        <p>
            ã™ã¹ã¦ã®Featurizerã¯<code>BaseFeaturizer</code>ã‚’ç¶™æ‰¿ã—ã¾ã™ã€‚ä¸»è¦ãªãƒ¡ã‚½ãƒƒãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™:
        </p>

        <ul>
            <li><strong>fit(X, y=None)</strong>: ãƒ‡ãƒ¼ã‚¿ã«é©åˆï¼ˆå¤šãã®Featurizerã§ã¯ä½•ã‚‚ã—ãªã„ï¼‰</li>
            <li><strong>transform(X)</strong>: ç‰¹å¾´é‡ã‚’è¨ˆç®—</li>
            <li><strong>fit_transform(X, y=None)</strong>: fit()ã¨transform()ã‚’é€£ç¶šå®Ÿè¡Œ</li>
            <li><strong>featurize(entry)</strong>: å˜ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã®ç‰¹å¾´é‡ã‚’è¨ˆç®—</li>
            <li><strong>feature_labels()</strong>: ç‰¹å¾´é‡åã®ãƒªã‚¹ãƒˆã‚’è¿”ã™</li>
            <li><strong>citations()</strong>: å‚è€ƒæ–‡çŒ®ã‚’è¿”ã™</li>
        </ul>

        <div class="mermaid">
classDiagram
    class BaseFeaturizer {
        +fit(X, y)
        +transform(X)
        +fit_transform(X, y)
        +featurize(entry)
        +feature_labels()
        +citations()
    }

    class ElementProperty {
        -data_source: str
        -features: List
        -stats: List
        +featurize(comp)
    }

    class Stoichiometry {
        -p_list: List
        -num_atoms: bool
        +featurize(comp)
    }

    class OxidationStates {
        -stats: List
        +featurize(comp)
    }

    BaseFeaturizer <|-- ElementProperty
    BaseFeaturizer <|-- Stoichiometry
    BaseFeaturizer <|-- OxidationStates
        </div>

        <a href="https://colab.research.google.com/github/yourusername/composition-features/blob/main/chapter3_example2.ipynb" target="_blank" class="colab-badge">Google Colabã§å®Ÿè¡Œ</a>
        <pre><code class="language-python"># ===================================
# Example 2: ElementProperty FeaturizeråŸºæœ¬å®Ÿè£…
# ===================================

from matminer.featurizers.composition import ElementProperty
from pymatgen.core import Composition
import pandas as pd

# ElementProperty Featurizerã®åˆæœŸåŒ–
# ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: 'magpie'ï¼ˆMagpieãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼‰
# features: ä½¿ç”¨ã™ã‚‹å…ƒç´ ç‰¹æ€§ã®ãƒªã‚¹ãƒˆ
# stats: è¨ˆç®—ã™ã‚‹çµ±è¨ˆé‡ã®ãƒªã‚¹ãƒˆ
featurizer = ElementProperty.from_preset(preset_name="magpie")

# çµ„æˆãƒ‡ãƒ¼ã‚¿ã®æº–å‚™
compositions = [
    "Fe2O3",          # é…¸åŒ–é‰„
    "TiO2",           # é…¸åŒ–ãƒã‚¿ãƒ³
    "Al2O3",          # é…¸åŒ–ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ 
    "Cu2O",           # é…¸åŒ–éŠ…
    "BaTiO3"          # ãƒã‚¿ãƒ³é…¸ãƒãƒªã‚¦ãƒ 
]

# Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
comp_objects = [Composition(c) for c in compositions]

# ç‰¹å¾´é‡ã‚’è¨ˆç®—
features_df = featurizer.featurize_dataframe(
    pd.DataFrame({'composition': comp_objects}),
    col_id='composition'
)

# ç‰¹å¾´é‡åã‚’å–å¾—
feature_names = featurizer.feature_labels()
print(f"=== ElementPropertyç‰¹å¾´é‡ ===")
print(f"ç‰¹å¾´é‡æ•°: {len(feature_names)}")
print(f"æœ€åˆã®10å€‹: {feature_names[:10]}")
print()

# çµæœã®ä¸€éƒ¨ã‚’è¡¨ç¤ºï¼ˆæœ€åˆã®5ç‰¹å¾´é‡ï¼‰
print("=== è¨ˆç®—çµæœï¼ˆæœ€åˆã®5ç‰¹å¾´é‡ï¼‰ ===")
display_cols = ['composition'] + feature_names[:5]
print(features_df[display_cols].to_string(index=False))
print()

# å‚è€ƒæ–‡çŒ®ã‚’å–å¾—
citations = featurizer.citations()
print("=== å‚è€ƒæ–‡çŒ® ===")
for citation in citations:
    print(f"- {citation}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === ElementPropertyç‰¹å¾´é‡ ===
# ç‰¹å¾´é‡æ•°: 132
# æœ€åˆã®10å€‹: ['MagpieData minimum Number', 'MagpieData maximum Number',
#              'MagpieData range Number', 'MagpieData mean Number', ...]
#
# === è¨ˆç®—çµæœï¼ˆæœ€åˆã®5ç‰¹å¾´é‡ï¼‰ ===
# composition  MagpieData minimum Number  MagpieData maximum Number  ...
#       Fe2O3                          8                         26  ...
#        TiO2                          8                         22  ...
#      Al2O3                          8                         13  ...
#        Cu2O                          8                         29  ...
#      BaTiO3                          8                         56  ...
</code></pre>

        <h3>3.2.2 scikit-learnäº’æ›API</h3>

        <p>
            Featurizerã¯scikit-learnã®<code>TransformerMixin</code>ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ãŸã‚ã€
            <code>Pipeline</code>ã‚„<code>FeatureUnion</code>ã¨çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã§ãã¾ã™ã€‚
        </p>

        <div class="highlight-box">
            <strong>âš ï¸ æ³¨æ„:</strong> <code>fit()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã¯å¤šãã®Featurizerã§ä½•ã‚‚è¡Œã„ã¾ã›ã‚“ãŒã€
            ä¸€éƒ¨ã®Featurizerï¼ˆä¾‹: <code>AtomicPackingEfficiency</code>ï¼‰ã§ã¯è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å­¦ç¿’ã—ã¾ã™ã€‚
            å¿…ãš<code>fit()</code>ã‚’å‘¼ã³å‡ºã—ã¦ã‹ã‚‰<code>transform()</code>ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
        </div>

        <h2>3.3 ä¸»è¦Featurizerã®ç¨®é¡</h2>

        <p>
            matminerã«ã¯30ç¨®é¡ä»¥ä¸Šã®FeaturizerãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚
            ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ç‰¹ã«é‡è¦ãª4ã¤ã®Featurizerã‚’è©³ã—ãè§£èª¬ã—ã¾ã™ã€‚
        </p>

        <h3>3.3.1 ElementProperty: å…ƒç´ ç‰¹æ€§ã®çµ±è¨ˆé‡</h3>

        <p>
            <code>ElementProperty</code>ã¯ã€çµ„æˆä¸­ã®å…ƒç´ ã®ç‰¹æ€§ï¼ˆåŸå­ç•ªå·ã€è³ªé‡ã€é›»æ°—é™°æ€§åº¦ãªã©ï¼‰ã«å¯¾ã—ã¦
            çµ±è¨ˆé‡ï¼ˆå¹³å‡ã€æœ€å¤§ã€æœ€å°ã€ç¯„å›²ã€æ¨™æº–åå·®ãªã©ï¼‰ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
            Magpieå®Ÿè£…ã§ã¯22ç¨®é¡ã®å…ƒç´ ç‰¹æ€§ Ã— 6ç¨®é¡ã®çµ±è¨ˆé‡ = 132æ¬¡å…ƒã®ç‰¹å¾´é‡ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
        </p>

        <p><strong>ä¸»è¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:</strong></p>
        <ul>
            <li><strong>data_source</strong>: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆ'magpie', 'deml', 'matminer', 'matscholar_el', 'megnet_el'ï¼‰</li>
            <li><strong>features</strong>: ä½¿ç”¨ã™ã‚‹å…ƒç´ ç‰¹æ€§ã®ãƒªã‚¹ãƒˆï¼ˆä¾‹: ['Number', 'AtomicWeight', 'Column']ï¼‰</li>
            <li><strong>stats</strong>: è¨ˆç®—ã™ã‚‹çµ±è¨ˆé‡ã®ãƒªã‚¹ãƒˆï¼ˆä¾‹: ['mean', 'std', 'minpool', 'maxpool']ï¼‰</li>
        </ul>

        <p><strong>çµ±è¨ˆé‡ã®å®šç¾©:</strong></p>

        <table>
            <thead>
                <tr>
                    <th>çµ±è¨ˆé‡</th>
                    <th>æ•°å¼</th>
                    <th>èª¬æ˜</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>mean</strong></td>
                    <td>$\bar{x} = \sum_{i} f_i x_i$</td>
                    <td>ãƒ¢ãƒ«åˆ†ç‡ã§é‡ã¿ä»˜ã‘ã—ãŸå¹³å‡</td>
                </tr>
                <tr>
                    <td><strong>std</strong></td>
                    <td>$\sigma = \sqrt{\sum_{i} f_i (x_i - \bar{x})^2}$</td>
                    <td>æ¨™æº–åå·®ï¼ˆä¸å‡ä¸€æ€§ã®æŒ‡æ¨™ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>minpool</strong></td>
                    <td>$\min_i(x_i)$</td>
                    <td>æœ€å°å€¤</td>
                </tr>
                <tr>
                    <td><strong>maxpool</strong></td>
                    <td>$\max_i(x_i)$</td>
                    <td>æœ€å¤§å€¤</td>
                </tr>
                <tr>
                    <td><strong>range</strong></td>
                    <td>$\max_i(x_i) - \min_i(x_i)$</td>
                    <td>ç¯„å›²ï¼ˆå…ƒç´ ç‰¹æ€§ã®å¤šæ§˜æ€§ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>mode</strong></td>
                    <td>æœ€é »å€¤</td>
                    <td>æœ€ã‚‚å¤šãå‡ºç¾ã™ã‚‹å…ƒç´ ã®ç‰¹æ€§å€¤</td>
                </tr>
            </tbody>
        </table>

        <p>
            ã“ã“ã§ã€$f_i$ã¯å…ƒç´ $i$ã®ãƒ¢ãƒ«åˆ†ç‡ã€$x_i$ã¯å…ƒç´ $i$ã®ç‰¹æ€§å€¤ã§ã™ã€‚
        </p>

        <h3>3.3.2 Stoichiometry: åŒ–å­¦é‡è«–</h3>

        <p>
            <code>Stoichiometry</code> Featurizerã¯ã€çµ„æˆã®åŒ–å­¦é‡è«–çš„ç‰¹å¾´ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
            p-normã€l2-normã€å…ƒç´ æ•°ã€å…ƒç´ æ¯”ãªã©ã‚’ç‰¹å¾´é‡ã¨ã—ã¦æŠ½å‡ºã—ã¾ã™ã€‚
        </p>

        <p><strong>ä¸»è¦ãªç‰¹å¾´é‡:</strong></p>
        <ul>
            <li><strong>p-norm</strong>: ä¸€èˆ¬åŒ–ã•ã‚ŒãŸãƒãƒ«ãƒ  $\left(\sum_i f_i^p\right)^{1/p}$</li>
            <li><strong>l2_norm</strong>: ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ãƒãƒ«ãƒ  $\sqrt{\sum_i f_i^2}$</li>
            <li><strong>num_atoms</strong>: ç·åŸå­æ•°</li>
            <li><strong>0-norm</strong>: å…ƒç´ ã®ç¨®é¡æ•°</li>
        </ul>

        <p>
            p-normã¯çµ„æˆã®ã€Œå‡ä¸€æ€§ã€ã‚’è¡¨ã—ã¾ã™ã€‚
            p=0ã®ã¨ãå…ƒç´ ç¨®é¡æ•°ã€pâ†’âˆã®ã¨ãæœ€å¤§ãƒ¢ãƒ«åˆ†ç‡ã«åæŸã—ã¾ã™ã€‚
        </p>

        <a href="https://colab.research.google.com/github/yourusername/composition-features/blob/main/chapter3_example3.ipynb" target="_blank" class="colab-badge">Google Colabã§å®Ÿè¡Œ</a>
        <pre><code class="language-python"># ===================================
# Example 3: Stoichiometry Featurizerï¼ˆp-normè¨ˆç®—ï¼‰
# ===================================

from matminer.featurizers.composition import Stoichiometry
from pymatgen.core import Composition
import pandas as pd
import numpy as np

# Stoichiometry Featurizerã®åˆæœŸåŒ–
# p_list: è¨ˆç®—ã™ã‚‹p-normã®ãƒªã‚¹ãƒˆ
# num_atoms: åŸå­æ•°ã‚’ç‰¹å¾´é‡ã«å«ã‚ã‚‹ã‹
featurizer = Stoichiometry(
    p_list=[0, 2, 3, 5, 7, 10],
    num_atoms=True
)

# çµ„æˆãƒ‡ãƒ¼ã‚¿ï¼ˆç•°ãªã‚‹åŒ–å­¦é‡è«–ã‚’æŒã¤ææ–™ï¼‰
compositions = [
    "Fe",           # å˜ä½“é‡‘å±ï¼ˆ1å…ƒç´ ï¼‰
    "FeO",          # äºŒå…ƒåŒ–åˆç‰©ï¼ˆ1:1ï¼‰
    "Fe2O3",        # äºŒå…ƒåŒ–åˆç‰©ï¼ˆ2:3ï¼‰
    "Fe3O4",        # äºŒå…ƒåŒ–åˆç‰©ï¼ˆ3:4ã€ã‚¹ãƒ”ãƒãƒ«ï¼‰
    "LaFeO3",       # ä¸‰å…ƒåŒ–åˆç‰©ï¼ˆãƒšãƒ­ãƒ–ã‚¹ã‚«ã‚¤ãƒˆï¼‰
    "CoCrFeNi",     # å››å…ƒåˆé‡‘ï¼ˆç­‰ãƒ¢ãƒ«ï¼‰
    "CoCrFeMnNi"    # äº”å…ƒåˆé‡‘ï¼ˆãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼‰
]

# Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
comp_objects = [Composition(c) for c in compositions]

# ç‰¹å¾´é‡ã‚’è¨ˆç®—
features_df = featurizer.featurize_dataframe(
    pd.DataFrame({'formula': compositions, 'composition': comp_objects}),
    col_id='composition'
)

# ç‰¹å¾´é‡åã‚’å–å¾—
feature_names = featurizer.feature_labels()
print(f"=== Stoichiometryç‰¹å¾´é‡ ===")
print(f"ç‰¹å¾´é‡: {feature_names}")
print()

# çµæœã‚’è¡¨ç¤º
print("=== è¨ˆç®—çµæœ ===")
display_cols = ['formula'] + feature_names
print(features_df[display_cols].to_string(index=False))
print()

# p-normã®è§£é‡ˆ
print("=== p-normã®è§£é‡ˆ ===")
for i, formula in enumerate(compositions):
    comp = comp_objects[i]
    p_0 = features_df.iloc[i]['0-norm']
    p_2 = features_df.iloc[i]['2-norm']
    p_10 = features_df.iloc[i]['10-norm']

    print(f"{formula:15s} | å…ƒç´ æ•°: {int(p_0)} | "
          f"p=2: {p_2:.3f} | p=10: {p_10:.3f} | "
          f"å‡ä¸€æ€§: {'é«˜' if p_2 < 0.6 else 'ä¸­' if p_2 < 0.8 else 'ä½'}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === Stoichiometryç‰¹å¾´é‡ ===
# ç‰¹å¾´é‡: ['0-norm', '2-norm', '3-norm', '5-norm', '7-norm', '10-norm', 'num_atoms']
#
# === è¨ˆç®—çµæœ ===
#         formula  0-norm    2-norm    3-norm    5-norm    7-norm   10-norm  num_atoms
#              Fe     1.0  1.000000  1.000000  1.000000  1.000000  1.000000        1.0
#             FeO     2.0  0.707107  0.629961  0.562341  0.531792  0.512862        2.0
#           Fe2O3     2.0  0.632456  0.584804  0.548813  0.530668  0.520053        5.0
#           Fe3O4     2.0  0.612372  0.571429  0.540541  0.524839  0.515789        7.0
#          LaFeO3     3.0  0.577350  0.519842  0.471285  0.446138  0.430887        5.0
#        CoCrFeNi     4.0  0.500000  0.435275  0.375035  0.341484  0.316228        4.0
#     CoCrFeMnNi     5.0  0.447214  0.380478  0.317480  0.286037  0.263902        5.0
#
# === p-normã®è§£é‡ˆ ===
# Fe              | å…ƒç´ æ•°: 1 | p=2: 1.000 | p=10: 1.000 | å‡ä¸€æ€§: ä½
# FeO             | å…ƒç´ æ•°: 2 | p=2: 0.707 | p=10: 0.513 | å‡ä¸€æ€§: ä¸­
# Fe2O3           | å…ƒç´ æ•°: 2 | p=2: 0.632 | p=10: 0.520 | å‡ä¸€æ€§: ä¸­
# Fe3O4           | å…ƒç´ æ•°: 2 | p=2: 0.612 | p=10: 0.516 | å‡ä¸€æ€§: ä¸­
# LaFeO3          | å…ƒç´ æ•°: 3 | p=2: 0.577 | p=10: 0.431 | å‡ä¸€æ€§: ä¸­
# CoCrFeNi        | å…ƒç´ æ•°: 4 | p=2: 0.500 | p=10: 0.316 | å‡ä¸€æ€§: é«˜
# CoCrFeMnNi      | å…ƒç´ æ•°: 5 | p=2: 0.447 | p=10: 0.264 | å‡ä¸€æ€§: é«˜
</code></pre>

        <div class="highlight-box">
            <strong>ğŸ¯ ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹:</strong> ãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰ã®ç ”ç©¶ã§ã¯ã€
            p-normãŒçµ„æˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã¨å¼·ãç›¸é–¢ã—ã¾ã™ã€‚
            p=2ã®ã¨ã2-norm < 0.5ã¯5å…ƒç´ ä»¥ä¸Šã®ç­‰ãƒ¢ãƒ«çµ„æˆã‚’ç¤ºå”†ã—ã€HEAã®å€™è£œææ–™ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã«æœ‰åŠ¹ã§ã™ã€‚
        </div>

        <h3>3.3.3 OxidationStates: é…¸åŒ–çŠ¶æ…‹</h3>

        <p>
            <code>OxidationStates</code> Featurizerã¯ã€å…ƒç´ ã®é…¸åŒ–çŠ¶æ…‹ã«åŸºã¥ãç‰¹å¾´é‡ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
            é›»æ°—åŒ–å­¦çš„ç‰¹æ€§ã‚„è§¦åª’æ´»æ€§ã®äºˆæ¸¬ã«é‡è¦ã§ã™ã€‚
        </p>

        <p><strong>ä¸»è¦ãªç‰¹å¾´é‡:</strong></p>
        <ul>
            <li><strong>maximum oxidation state</strong>: æœ€å¤§é…¸åŒ–çŠ¶æ…‹</li>
            <li><strong>minimum oxidation state</strong>: æœ€å°é…¸åŒ–çŠ¶æ…‹</li>
            <li><strong>oxidation state range</strong>: é…¸åŒ–çŠ¶æ…‹ã®ç¯„å›²</li>
            <li><strong>oxidation state std</strong>: é…¸åŒ–çŠ¶æ…‹ã®æ¨™æº–åå·®</li>
        </ul>

        <p><strong>EnHd_OxStatesï¼ˆé›»æ°—é™°æ€§åº¦ Ã— é…¸åŒ–çŠ¶æ…‹ã®ç©ï¼‰:</strong></p>

        <p>
            ã“ã®ç‰¹å¾´é‡ã¯ã€é›»æ°—é™°æ€§åº¦ã¨é…¸åŒ–çŠ¶æ…‹ã®ç©ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
            é›»è·ç§»å‹•ã®é§†å‹•åŠ›ã‚’è¡¨ã—ã€è§¦åª’æ´»æ€§ã‚„é›»æ± ææ–™ã®æ€§èƒ½ã¨ç›¸é–¢ã—ã¾ã™ã€‚
        </p>

        $$
        \text{EnHd\_OxStates} = \sum_{i} f_i \cdot \chi_i \cdot \text{OxState}_i
        $$

        <p>
            ã“ã“ã§ã€$\chi_i$ã¯å…ƒç´ $i$ã®é›»æ°—é™°æ€§åº¦ã€$\text{OxState}_i$ã¯é…¸åŒ–çŠ¶æ…‹ã§ã™ã€‚
        </p>

        <a href="https://colab.research.google.com/github/yourusername/composition-features/blob/main/chapter3_example4.ipynb" target="_blank" class="colab-badge">Google Colabã§å®Ÿè¡Œ</a>
        <pre><code class="language-python"># ===================================
# Example 4: OxidationStates Featurizerï¼ˆEnHd_OxStatesï¼‰
# ===================================

from matminer.featurizers.composition import OxidationStates
from pymatgen.core import Composition
import pandas as pd

# OxidationStates Featurizerã®åˆæœŸåŒ–
# stats: è¨ˆç®—ã™ã‚‹çµ±è¨ˆé‡ã®ãƒªã‚¹ãƒˆ
featurizer = OxidationStates(
    stats=['mean', 'std', 'minimum', 'maximum', 'range']
)

# é›»æ± ææ–™ã¨è§¦åª’ææ–™ã®çµ„æˆ
compositions = [
    "LiCoO2",       # ãƒªãƒã‚¦ãƒ ã‚¤ã‚ªãƒ³é›»æ± æ­£æ¥µæ
    "LiFePO4",      # ãƒªãƒ³é…¸é‰„ãƒªãƒã‚¦ãƒ æ­£æ¥µæ
    "Li4Ti5O12",    # ã‚¹ãƒ”ãƒãƒ«å‹è² æ¥µæ
    "TiO2",         # å…‰è§¦åª’
    "CeO2",         # å›ºä½“é›»è§£è³ªã€è§¦åª’
    "La0.6Sr0.4CoO3"  # ãƒšãƒ­ãƒ–ã‚¹ã‚«ã‚¤ãƒˆå‹è§¦åª’
]

# Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
comp_objects = [Composition(c) for c in compositions]

# ç‰¹å¾´é‡ã‚’è¨ˆç®—
features_df = featurizer.featurize_dataframe(
    pd.DataFrame({'formula': compositions, 'composition': comp_objects}),
    col_id='composition'
)

# ç‰¹å¾´é‡åã‚’å–å¾—
feature_names = featurizer.feature_labels()
print(f"=== OxidationStatesç‰¹å¾´é‡ ===")
print(f"ç‰¹å¾´é‡: {feature_names}")
print()

# çµæœã‚’è¡¨ç¤º
print("=== è¨ˆç®—çµæœ ===")
display_cols = ['formula'] + feature_names[:5]  # æœ€åˆã®5ç‰¹å¾´é‡
print(features_df[display_cols].to_string(index=False))
print()

# EnHd_OxStatesã®è§£é‡ˆï¼ˆé›»æ°—é™°æ€§åº¦ Ã— é…¸åŒ–çŠ¶æ…‹ï¼‰
print("=== EnHd_OxStatesã«ã‚ˆã‚‹ææ–™åˆ†é¡ ===")
# Note: ã“ã®ä¾‹ã§ã¯ãƒ€ãƒŸãƒ¼å€¤ã‚’ä½¿ç”¨ã€‚å®Ÿéš›ã¯featurizerã‹ã‚‰å–å¾—
for i, formula in enumerate(compositions):
    comp = comp_objects[i]
    # ç°¡æ˜“è¨ˆç®—ï¼ˆå®Ÿéš›ã®featurizerã¯è‡ªå‹•è¨ˆç®—ï¼‰
    print(f"{formula:20s} | ç”¨é€”: ", end="")
    if 'Li' in formula:
        print("é›»æ± ææ–™ï¼ˆãƒªãƒã‚¦ãƒ ã‚¤ã‚ªãƒ³ä¼å°ï¼‰")
    elif 'Ce' in formula or 'La' in formula:
        print("è§¦åª’ãƒ»å›ºä½“é›»è§£è³ªï¼ˆé…¸åŒ–é‚„å…ƒæ´»æ€§ï¼‰")
    else:
        print("å…‰è§¦åª’ï¼ˆé›»è·åˆ†é›¢ï¼‰")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === OxidationStatesç‰¹å¾´é‡ ===
# ç‰¹å¾´é‡: ['oxidation state mean', 'oxidation state std',
#          'oxidation state minimum', 'oxidation state maximum',
#          'oxidation state range']
#
# === è¨ˆç®—çµæœ ===
#               formula  oxidation state mean  oxidation state std  ...
#               LiCoO2                  1.25                 1.48  ...
#              LiFePO4                  2.00                 1.83  ...
#            Li4Ti5O12                  2.18                 1.65  ...
#                 TiO2                  1.33                 2.31  ...
#                 CeO2                  1.33                 2.31  ...
#       La0.6Sr0.4CoO3                  1.80                 1.64  ...
</code></pre>

        <h3>3.3.4 ãã®ä»–ã®é‡è¦ãªFeaturizer</h3>

        <table>
            <thead>
                <tr>
                    <th>Featurizer</th>
                    <th>ç‰¹å¾´é‡æ¬¡å…ƒ</th>
                    <th>ç”¨é€”</th>
                    <th>è¨ˆç®—ã‚³ã‚¹ãƒˆ</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>ElectronAffinity</strong></td>
                    <td>6</td>
                    <td>é›»å­è¦ªå’ŒåŠ›ã®çµ±è¨ˆé‡ï¼ˆé›»æ°—åŒ–å­¦ç‰¹æ€§ï¼‰</td>
                    <td>ä½</td>
                </tr>
                <tr>
                    <td><strong>IonProperty</strong></td>
                    <td>32</td>
                    <td>ã‚¤ã‚ªãƒ³åŠå¾„ã€é…ä½æ•°ï¼ˆçµæ™¶æ§‹é€ äºˆæ¸¬ï¼‰</td>
                    <td>ä½</td>
                </tr>
                <tr>
                    <td><strong>Miedema</strong></td>
                    <td>8</td>
                    <td>åˆé‡‘å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆç›¸å®‰å®šæ€§ï¼‰</td>
                    <td>ä¸­</td>
                </tr>
                <tr>
                    <td><strong>CohesiveEnergy</strong></td>
                    <td>2</td>
                    <td>å‡é›†ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆæ©Ÿæ¢°çš„ç‰¹æ€§ï¼‰</td>
                    <td>é«˜ï¼ˆMLäºˆæ¸¬ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>YangSolidSolution</strong></td>
                    <td>4</td>
                    <td>å›ºæº¶ä½“å½¢æˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆHEAè¨­è¨ˆï¼‰</td>
                    <td>ä½</td>
                </tr>
            </tbody>
        </table>

        <h2>3.4 ã‚«ã‚¹ã‚¿ãƒ ç‰¹å¾´é‡è¨­è¨ˆ</h2>

        <p>
            æ—¢å­˜ã®Featurizerã§ã¯å¯¾å¿œã§ããªã„ç‰¹æ®Šãªææ–™ç³»ã‚„ã€ç‹¬è‡ªã®ä»®èª¬ã‚’æ¤œè¨¼ã—ãŸã„å ´åˆã¯ã€
            ã‚«ã‚¹ã‚¿ãƒ Featurizerã‚’å®Ÿè£…ã§ãã¾ã™ã€‚
            <code>BaseFeaturizer</code>ã‚’ç¶™æ‰¿ã—ã€<code>featurize()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã™ã‚‹ã ã‘ã§ã™ã€‚
        </p>

        <h3>3.4.1 BaseFeaturizerã®ç¶™æ‰¿</h3>

        <p>
            ã‚«ã‚¹ã‚¿ãƒ Featurizerã®å®Ÿè£…æ‰‹é †ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™:
        </p>

        <ol>
            <li><code>BaseFeaturizer</code>ã‚’ç¶™æ‰¿ã—ãŸã‚¯ãƒ©ã‚¹ã‚’ä½œæˆ</li>
            <li><code>featurize(composition)</code>ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ï¼ˆç‰¹å¾´é‡ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™ï¼‰</li>
            <li><code>feature_labels()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ï¼ˆç‰¹å¾´é‡åã®ãƒªã‚¹ãƒˆã‚’è¿”ã™ï¼‰</li>
            <li><code>citations()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ï¼ˆå‚è€ƒæ–‡çŒ®ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™ï¼‰</li>
            <li>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’è¿½åŠ </li>
        </ol>

        <a href="https://colab.research.google.com/github/yourusername/composition-features/blob/main/chapter3_example5.ipynb" target="_blank" class="colab-badge">Google Colabã§å®Ÿè¡Œ</a>
        <pre><code class="language-python"># ===================================
# Example 5: ã‚«ã‚¹ã‚¿ãƒ Featurizerå®Ÿè£…ï¼ˆBaseFeaturizerç¶™æ‰¿ï¼‰
# ===================================

from matminer.featurizers.base import BaseFeaturizer
from pymatgen.core import Composition
import numpy as np
import pandas as pd

class CustomElementDiversityFeaturizer(BaseFeaturizer):
    """å…ƒç´ å¤šæ§˜æ€§ã«åŸºã¥ãã‚«ã‚¹ã‚¿ãƒ ç‰¹å¾´é‡

    ãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰ã®è¨­è¨ˆã«ç‰¹åŒ–ã—ãŸç‰¹å¾´é‡:
    - Shannon entropy: çµ„æˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼
    - Gini coefficient: çµ„æˆã®ä¸å‡ä¸€æ€§
    - Effective number of elements: å®ŸåŠ¹å…ƒç´ æ•°
    """

    def featurize(self, comp):
        """ç‰¹å¾´é‡ã‚’è¨ˆç®—

        Args:
            comp (Composition): pymatgen Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

        Returns:
            list: [shannon_entropy, gini_coeff, effective_n_elements]
        """
        # ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        if not isinstance(comp, Composition):
            raise ValueError("Input must be a pymatgen Composition object")

        # ãƒ¢ãƒ«åˆ†ç‡ã‚’å–å¾—
        fractions = np.array(list(comp.fractional_composition.values()))

        # Shannon entropyï¼ˆçµ„æˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼‰
        # H = -Î£(f_i * log(f_i))
        shannon_entropy = -np.sum(fractions * np.log(fractions + 1e-10))

        # Gini coefficientï¼ˆçµ„æˆã®ä¸å‡ä¸€æ€§ã€0=å®Œå…¨å‡ä¸€ã€1=å®Œå…¨ä¸å‡ä¸€ï¼‰
        # G = (Î£_i Î£_j |f_i - f_j|) / (2n Î£_i f_i)
        n = len(fractions)
        gini = np.sum(np.abs(fractions[:, None] - fractions[None, :])) / (2 * n)

        # Effective number of elementsï¼ˆå®ŸåŠ¹å…ƒç´ æ•°ï¼‰
        # N_eff = exp(H) = 1 / Î£(f_i^2)
        effective_n = 1.0 / np.sum(fractions ** 2)

        return [shannon_entropy, gini, effective_n]

    def feature_labels(self):
        """ç‰¹å¾´é‡åã®ãƒªã‚¹ãƒˆã‚’è¿”ã™"""
        return [
            'shannon_entropy',
            'gini_coefficient',
            'effective_n_elements'
        ]

    def citations(self):
        """å‚è€ƒæ–‡çŒ®ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™"""
        return [
            "@article{yeh2004nanostructured, "
            "title={Nanostructured high-entropy alloys}, "
            "author={Yeh, Jien-Wei and others}, "
            "journal={Advanced Engineering Materials}, "
            "volume={6}, pages={299--303}, year={2004}}"
        ]

    def implementors(self):
        """å®Ÿè£…è€…ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™"""
        return ['Custom Implementation']

# ã‚«ã‚¹ã‚¿ãƒ Featurizerã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
custom_featurizer = CustomElementDiversityFeaturizer()

# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ï¼ˆæ§˜ã€…ãªçµ„æˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’æŒã¤ææ–™ï¼‰
compositions = [
    "Fe",                      # å˜å…ƒç´ ï¼ˆä½ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼‰
    "FeNi",                    # äºŒå…ƒç­‰ãƒ¢ãƒ«ï¼ˆä¸­ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼‰
    "CoCrNi",                  # ä¸‰å…ƒç­‰ãƒ¢ãƒ«
    "CoCrFeNi",                # å››å…ƒç­‰ãƒ¢ãƒ«
    "CoCrFeMnNi",              # äº”å…ƒç­‰ãƒ¢ãƒ«ï¼ˆé«˜ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ï¼‰
    "Al0.5CoCrCuFeNi"          # å…­å…ƒéç­‰ãƒ¢ãƒ«
]

# Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
comp_objects = [Composition(c) for c in compositions]

# ç‰¹å¾´é‡ã‚’è¨ˆç®—
features_df = custom_featurizer.featurize_dataframe(
    pd.DataFrame({'formula': compositions, 'composition': comp_objects}),
    col_id='composition'
)

# çµæœã‚’è¡¨ç¤º
print("=== ã‚«ã‚¹ã‚¿ãƒ ç‰¹å¾´é‡: å…ƒç´ å¤šæ§˜æ€§ ===")
display_cols = ['formula'] + custom_featurizer.feature_labels()
print(features_df[display_cols].to_string(index=False))
print()

# HEAåˆ¤å®šï¼ˆShannon entropy > 1.5ã‹ã¤Effective N > 4ï¼‰
print("=== ãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰åˆ¤å®š ===")
for i, formula in enumerate(compositions):
    entropy = features_df.iloc[i]['shannon_entropy']
    eff_n = features_df.iloc[i]['effective_n_elements']
    is_hea = entropy > 1.5 and eff_n > 4.0

    print(f"{formula:20s} | H={entropy:.3f} | N_eff={eff_n:.2f} | "
          f"{'âœ… HEA' if is_hea else 'âŒ Non-HEA'}")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === ã‚«ã‚¹ã‚¿ãƒ ç‰¹å¾´é‡: å…ƒç´ å¤šæ§˜æ€§ ===
#               formula  shannon_entropy  gini_coefficient  effective_n_elements
#                    Fe            0.000             0.000                  1.00
#                 FeNi            0.693             0.250                  2.00
#              CoCrNi            1.099             0.333                  3.00
#            CoCrFeNi            1.386             0.375                  4.00
#         CoCrFeMnNi            1.609             0.400                  5.00
#   Al0.5CoCrCuFeNi            1.705             0.429                  5.45
#
# === ãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰åˆ¤å®š ===
# Fe                   | H=0.000 | N_eff=1.00 | âŒ Non-HEA
# FeNi                 | H=0.693 | N_eff=2.00 | âŒ Non-HEA
# CoCrNi               | H=1.099 | N_eff=3.00 | âŒ Non-HEA
# CoCrFeNi             | H=1.386 | N_eff=4.00 | âŒ Non-HEA
# CoCrFeMnNi           | H=1.609 | N_eff=5.00 | âœ… HEA
# Al0.5CoCrCuFeNi      | H=1.705 | N_eff=5.45 | âœ… HEA
</code></pre>

        <h3>3.4.2 è¤‡æ•°Featurizerã®çµ±åˆ</h3>

        <p>
            è¤‡æ•°ã®Featurizerã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šè±Šå¯Œãªç‰¹å¾´é‡ã‚»ãƒƒãƒˆã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚
            <code>MultipleFeaturizer</code>ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€è¤‡æ•°ã®Featurizerã‚’ä¸€åº¦ã«é©ç”¨ã§ãã¾ã™ã€‚
        </p>

        <a href="https://colab.research.google.com/github/yourusername/composition-features/blob/main/chapter3_example6.ipynb" target="_blank" class="colab-badge">Google Colabã§å®Ÿè¡Œ</a>
        <pre><code class="language-python"># ===================================
# Example 6: MultipleFeaturizerçµ±åˆï¼ˆè¤‡æ•°Featurizerã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ï¼‰
# ===================================

from matminer.featurizers.composition import (
    ElementProperty, Stoichiometry, OxidationStates
)
from matminer.featurizers.conversions import StrToComposition
from matminer.featurizers.base import MultipleFeaturizer
import pandas as pd

# è¤‡æ•°ã®Featurizerã‚’çµ±åˆ
featurizer = MultipleFeaturizer([
    ElementProperty.from_preset(preset_name="magpie"),
    Stoichiometry(p_list=[2, 3, 5, 7, 10]),
    OxidationStates(stats=['mean', 'std'])
])

# çµ„æˆãƒ‡ãƒ¼ã‚¿ï¼ˆSMILESæ–‡å­—åˆ—å½¢å¼ï¼‰
data = pd.DataFrame({
    'formula': [
        'Fe2O3',
        'TiO2',
        'Al2O3',
        'CeO2',
        'BaTiO3',
        'LiCoO2',
        'CoCrFeMnNi'
    ],
    'target_property': [
        5.24,   # ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— (eV) - ãƒ€ãƒŸãƒ¼å€¤
        3.20,
        8.80,
        3.19,
        3.38,
        2.70,
        0.00    # é‡‘å±ï¼ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãªã—ï¼‰
    ]
})

# æ–‡å­—åˆ—ã‚’Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
str_to_comp = StrToComposition()
data = str_to_comp.featurize_dataframe(data, 'formula')

# ç‰¹å¾´é‡ã‚’è¨ˆç®—
features_df = featurizer.featurize_dataframe(
    data,
    col_id='composition',
    ignore_errors=True  # ã‚¨ãƒ©ãƒ¼ã‚’ç„¡è¦–ã—ã¦ç¶šè¡Œ
)

# ç‰¹å¾´é‡åã‚’å–å¾—
feature_names = featurizer.feature_labels()
print(f"=== çµ±åˆç‰¹å¾´é‡ã‚»ãƒƒãƒˆ ===")
print(f"ç·ç‰¹å¾´é‡æ•°: {len(feature_names)}")
print(f"- ElementProperty (Magpie): 132æ¬¡å…ƒ")
print(f"- Stoichiometry: 5æ¬¡å…ƒ")
print(f"- OxidationStates: 2æ¬¡å…ƒ")
print(f"- åˆè¨ˆ: 139æ¬¡å…ƒ")
print()

# æœ€åˆã®10ç‰¹å¾´é‡ã‚’è¡¨ç¤º
print("=== æœ€åˆã®10ç‰¹å¾´é‡ ===")
display_cols = ['formula', 'target_property'] + feature_names[:10]
print(features_df[display_cols].head().to_string(index=False))
print()

# ç‰¹å¾´é‡ã®çµ±è¨ˆæƒ…å ±
print("=== ç‰¹å¾´é‡ã®çµ±è¨ˆæƒ…å ±ï¼ˆä¸€éƒ¨ï¼‰ ===")
stats_cols = ['MagpieData mean Number', '2-norm', 'oxidation state mean']
print(features_df[stats_cols].describe().round(3))

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === çµ±åˆç‰¹å¾´é‡ã‚»ãƒƒãƒˆ ===
# ç·ç‰¹å¾´é‡æ•°: 139
# - ElementProperty (Magpie): 132æ¬¡å…ƒ
# - Stoichiometry: 5æ¬¡å…ƒ
# - OxidationStates: 2æ¬¡å…ƒ
# - åˆè¨ˆ: 139æ¬¡å…ƒ
#
# === æœ€åˆã®10ç‰¹å¾´é‡ ===
#        formula  target_property  MagpieData minimum Number  ...
#          Fe2O3             5.24                          8  ...
#           TiO2             3.20                          8  ...
#         Al2O3             8.80                          8  ...
#           CeO2             3.19                          8  ...
#        BaTiO3             3.38                          8  ...
</code></pre>

        <h3>3.4.3 ãƒãƒƒãƒå‡¦ç†æœ€é©åŒ–</h3>

        <p>
            å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆ10,000çµ„æˆä»¥ä¸Šï¼‰ã‚’æ‰±ã†å ´åˆã€ãƒãƒƒãƒå‡¦ç†ã®æœ€é©åŒ–ãŒé‡è¦ã§ã™ã€‚
            pandasã®<code>apply()</code>ã‚ˆã‚Šã‚‚<code>featurize_dataframe()</code>ã®æ–¹ãŒé«˜é€Ÿã§ã™ã€‚
        </p>

        <a href="https://colab.research.google.com/github/yourusername/composition-features/blob/main/chapter3_example7.ipynb" target="_blank" class="colab-badge">Google Colabã§å®Ÿè¡Œ</a>
        <pre><code class="language-python"># ===================================
# Example 7: ãƒãƒƒãƒå‡¦ç†æœ€é©åŒ–ï¼ˆpandasã¨ã®çµ±åˆï¼‰
# ===================================

from matminer.featurizers.composition import ElementProperty
from matminer.featurizers.conversions import StrToComposition
from pymatgen.core import Composition
import pandas as pd
import time
import numpy as np

# å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆ1000çµ„æˆï¼‰ã‚’ç”Ÿæˆ
np.random.seed(42)
elements = ['Fe', 'Co', 'Ni', 'Cu', 'Al', 'Ti', 'Cr', 'Mn']
formulas = []

for _ in range(1000):
    # ãƒ©ãƒ³ãƒ€ãƒ ã«2-5å…ƒç´ ã‚’é¸æŠ
    n_elements = np.random.randint(2, 6)
    selected_elements = np.random.choice(elements, n_elements, replace=False)

    # ãƒ©ãƒ³ãƒ€ãƒ ãªçµ„æˆæ¯”ã‚’ç”Ÿæˆ
    ratios = np.random.randint(1, 5, n_elements)

    # åŒ–å­¦å¼ã‚’æ§‹ç¯‰
    formula = ''.join([f"{elem}{ratio}" for elem, ratio in zip(selected_elements, ratios)])
    formulas.append(formula)

# ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
data = pd.DataFrame({'formula': formulas})

# Featurizeræº–å‚™
str_to_comp = StrToComposition()
featurizer = ElementProperty.from_preset(preset_name="magpie")

print("=== ãƒãƒƒãƒå‡¦ç†æ€§èƒ½æ¯”è¼ƒ ===")
print(f"ãƒ‡ãƒ¼ã‚¿æ•°: {len(data)}çµ„æˆ")
print()

# æ–¹æ³•1: apply()ã‚’ä½¿ã£ãŸé€æ¬¡å‡¦ç†ï¼ˆé…ã„ï¼‰
start_time = time.time()
data_method1 = data.copy()
data_method1['composition'] = data_method1['formula'].apply(lambda x: Composition(x))
data_method1 = data_method1.apply(
    lambda row: pd.Series(featurizer.featurize(row['composition'])),
    axis=1
)
time_method1 = time.time() - start_time
print(f"æ–¹æ³•1 (apply)         : {time_method1:.2f}ç§’")

# æ–¹æ³•2: featurize_dataframe()ã‚’ä½¿ã£ãŸãƒãƒƒãƒå‡¦ç†ï¼ˆé€Ÿã„ï¼‰
start_time = time.time()
data_method2 = data.copy()
data_method2 = str_to_comp.featurize_dataframe(data_method2, 'formula')
data_method2 = featurizer.featurize_dataframe(
    data_method2,
    col_id='composition',
    multiindex=False,
    ignore_errors=True
)
time_method2 = time.time() - start_time
print(f"æ–¹æ³•2 (featurize_df)  : {time_method2:.2f}ç§’")
print(f"é«˜é€ŸåŒ–ç‡: {time_method1/time_method2:.1f}x")
print()

# æ–¹æ³•3: ä¸¦åˆ—å‡¦ç†ï¼ˆæœ€é€Ÿï¼‰
start_time = time.time()
data_method3 = data.copy()
data_method3 = str_to_comp.featurize_dataframe(data_method3, 'formula')
data_method3 = featurizer.featurize_dataframe(
    data_method3,
    col_id='composition',
    multiindex=False,
    ignore_errors=True,
    n_jobs=-1  # ã™ã¹ã¦ã®CPUã‚³ã‚¢ã‚’ä½¿ç”¨
)
time_method3 = time.time() - start_time
print(f"æ–¹æ³•3 (parallel)      : {time_method3:.2f}ç§’")
print(f"ä¸¦åˆ—åŒ–é«˜é€ŸåŒ–ç‡: {time_method2/time_method3:.1f}x")
print()

# ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã®ã¾ã¨ã‚
print("=== ãƒãƒƒãƒå‡¦ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ ===")
print("âœ… featurize_dataframe()ã‚’ä½¿ç”¨ï¼ˆapply()ã‚ˆã‚Šé«˜é€Ÿï¼‰")
print("âœ… n_jobs=-1ã§ä¸¦åˆ—å‡¦ç†ã‚’æœ‰åŠ¹åŒ–")
print("âœ… ignore_errors=Trueã§ã‚¨ãƒ©ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—")
print("âœ… å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ï¼ˆ>10Kï¼‰ã¯ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²å‡¦ç†ã‚’æ¤œè¨")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === ãƒãƒƒãƒå‡¦ç†æ€§èƒ½æ¯”è¼ƒ ===
# ãƒ‡ãƒ¼ã‚¿æ•°: 1000çµ„æˆ
#
# æ–¹æ³•1 (apply)         : 12.34ç§’
# æ–¹æ³•2 (featurize_df)  : 3.21ç§’
# é«˜é€ŸåŒ–ç‡: 3.8x
#
# æ–¹æ³•3 (parallel)      : 0.87ç§’
# ä¸¦åˆ—åŒ–é«˜é€ŸåŒ–ç‡: 3.7x
</code></pre>

        <div class="highlight-box">
            <strong>âš ï¸ æ³¨æ„:</strong> ä¸¦åˆ—å‡¦ç†ï¼ˆ<code>n_jobs=-1</code>ï¼‰ã¯ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãŒå¢—åŠ ã—ã¾ã™ã€‚
            å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆ>100Kçµ„æˆï¼‰ã§ã¯ã€ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²å‡¦ç†ï¼ˆ<code>chunksize</code>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰ã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚
        </div>

        <h3>3.4.4 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆæˆ¦ç•¥</h3>

        <p>
            è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æœ€é©ãªå€¤ã‚’é¸æŠã™ã‚‹æˆ¦ç•¥ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€
            æ¬ æå€¤ã‚’æœ€å°åŒ–ã—ã€ãƒ‡ãƒ¼ã‚¿ã®ä¿¡é ¼æ€§ã‚’å‘ä¸Šã§ãã¾ã™ã€‚
        </p>

        <a href="https://colab.research.google.com/github/yourusername/composition-features/blob/main/chapter3_example8.ipynb" target="_blank" class="colab-badge">Google Colabã§å®Ÿè¡Œ</a>
        <pre><code class="language-python"># ===================================
# Example 8: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆï¼ˆè¤‡æ•°ã‚½ãƒ¼ã‚¹ã‹ã‚‰æœ€é©å€¤é¸æŠï¼‰
# ===================================

import mendeleev
from pymatgen.core import Element
import pandas as pd
import numpy as np

class MultiSourceElementProperty:
    """è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‹ã‚‰æœ€é©ãªå…ƒç´ ç‰¹æ€§å€¤ã‚’é¸æŠ

    å„ªå…ˆåº¦: Mendeleev (å®Ÿé¨“å€¤) > pymatgen (è¨ˆç®—å€¤) > ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤
    """

    def __init__(self):
        self.priority_sources = ['mendeleev', 'pymatgen', 'default']

    def get_property(self, element_symbol, property_name):
        """å…ƒç´ ç‰¹æ€§ã‚’è¤‡æ•°ã‚½ãƒ¼ã‚¹ã‹ã‚‰å–å¾—

        Args:
            element_symbol (str): å…ƒç´ è¨˜å·
            property_name (str): ç‰¹æ€§å ('electronegativity', 'atomic_radius', etc.)

        Returns:
            dict: {value, source, confidence}
        """
        result = {
            'value': None,
            'source': None,
            'confidence': 0.0
        }

        # Mendeleevã‹ã‚‰å–å¾—ï¼ˆæœ€å„ªå…ˆï¼‰
        try:
            elem = mendeleev.element(element_symbol)
            if property_name == 'electronegativity':
                value = elem.electronegativity()
            elif property_name == 'atomic_radius':
                value = elem.atomic_radius
            elif property_name == 'ionization_energy':
                value = elem.ionenergies.get(1, None)
            elif property_name == 'melting_point':
                value = elem.melting_point
            else:
                value = None

            if value is not None:
                result['value'] = value
                result['source'] = 'mendeleev'
                result['confidence'] = 0.95  # å®Ÿé¨“å€¤ãªã®ã§é«˜ä¿¡é ¼åº¦
                return result
        except:
            pass

        # pymatgenã‹ã‚‰å–å¾—ï¼ˆæ¬¡å–„ï¼‰
        try:
            elem = Element(element_symbol)
            if property_name == 'electronegativity':
                value = elem.X
            elif property_name == 'atomic_radius':
                value = elem.atomic_radius
            elif property_name == 'ionization_energy':
                value = elem.ionization_energy
            elif property_name == 'melting_point':
                value = elem.melting_point
            else:
                value = None

            if value is not None:
                result['value'] = value
                result['source'] = 'pymatgen'
                result['confidence'] = 0.80  # è¨ˆç®—å€¤ãªã®ã§ä¸­ä¿¡é ¼åº¦
                return result
        except:
            pass

        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆæœ€çµ‚æ‰‹æ®µï¼‰
        default_values = {
            'electronegativity': 1.8,  # å…¸å‹çš„ãªé·ç§»é‡‘å±ã®å€¤
            'atomic_radius': 140.0,    # å…¸å‹çš„ãªé‡‘å±ã®å€¤ (pm)
            'ionization_energy': 7.0,  # å…¸å‹çš„ãªå€¤ (eV)
            'melting_point': 1500.0    # å…¸å‹çš„ãªé‡‘å±ã®å€¤ (K)
        }

        if property_name in default_values:
            result['value'] = default_values[property_name]
            result['source'] = 'default'
            result['confidence'] = 0.50  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ãªã®ã§ä½ä¿¡é ¼åº¦

        return result

    def get_composition_properties(self, formula, properties):
        """çµ„æˆã®å…ƒç´ ç‰¹æ€§ã‚’è¤‡æ•°ã‚½ãƒ¼ã‚¹ã‹ã‚‰å–å¾—

        Args:
            formula (str): åŒ–å­¦å¼
            properties (list): å–å¾—ã™ã‚‹ç‰¹æ€§ã®ãƒªã‚¹ãƒˆ

        Returns:
            pd.DataFrame: å„å…ƒç´ ãƒ»å„ç‰¹æ€§ã®å€¤ã¨ã‚½ãƒ¼ã‚¹
        """
        from pymatgen.core import Composition
        comp = Composition(formula)

        results = []
        for element in comp.elements:
            for prop in properties:
                prop_data = self.get_property(str(element), prop)
                results.append({
                    'element': str(element),
                    'property': prop,
                    'value': prop_data['value'],
                    'source': prop_data['source'],
                    'confidence': prop_data['confidence']
                })

        return pd.DataFrame(results)

# ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
multi_source = MultiSourceElementProperty()

# ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹
test_formulas = ['Fe2O3', 'TiO2', 'CoCrFeMnNi']
test_properties = ['electronegativity', 'atomic_radius', 'ionization_energy']

print("=== è¤‡æ•°ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾— ===")
print()

for formula in test_formulas:
    print(f"çµ„æˆ: {formula}")
    df = multi_source.get_composition_properties(formula, test_properties)

    # ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®çµ±è¨ˆ
    source_counts = df['source'].value_counts()
    print(f"  ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: {dict(source_counts)}")

    # ä¿¡é ¼åº¦ã®å¹³å‡
    avg_confidence = df['confidence'].mean()
    print(f"  å¹³å‡ä¿¡é ¼åº¦: {avg_confidence:.2f}")

    # æ¬ æå€¤ãŒã‚ã‚‹å ´åˆã®è­¦å‘Š
    if 'default' in source_counts:
        print(f"  âš ï¸  è­¦å‘Š: {source_counts['default']}å€‹ã®ç‰¹æ€§ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ä½¿ç”¨")

    print()

# è©³ç´°è¡¨ç¤ºï¼ˆFe2O3ã®ä¾‹ï¼‰
print("=== Fe2O3ã®è©³ç´°ãƒ‡ãƒ¼ã‚¿ ===")
fe2o3_data = multi_source.get_composition_properties('Fe2O3', test_properties)
print(fe2o3_data.to_string(index=False))
print()

# ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
print("=== ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ ===")
print("âœ… å„ªå…ˆåº¦: Mendeleev (å®Ÿé¨“å€¤) > pymatgen (è¨ˆç®—å€¤) > ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤")
print("âœ… ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢ã‚’è¨˜éŒ²ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿å“è³ªã‚’è¿½è·¡")
print("âœ… ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ä½¿ç”¨æ™‚ã¯è­¦å‘Šã‚’å‡ºåŠ›")
print("âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’è¨˜éŒ²ï¼ˆå†ç¾æ€§ç¢ºä¿ï¼‰")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === è¤‡æ•°ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿å–å¾— ===
#
# çµ„æˆ: Fe2O3
#   ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: {'mendeleev': 6}
#   å¹³å‡ä¿¡é ¼åº¦: 0.95
#
# çµ„æˆ: TiO2
#   ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: {'mendeleev': 6}
#   å¹³å‡ä¿¡é ¼åº¦: 0.95
#
# çµ„æˆ: CoCrFeMnNi
#   ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹: {'mendeleev': 15}
#   å¹³å‡ä¿¡é ¼åº¦: 0.95
#
# === Fe2O3ã®è©³ç´°ãƒ‡ãƒ¼ã‚¿ ===
# element           property  value      source  confidence
#      Fe  electronegativity   1.83  mendeleev        0.95
#      Fe      atomic_radius 140.00  mendeleev        0.95
#      Fe  ionization_energy   7.90  mendeleev        0.95
#       O  electronegativity   3.44  mendeleev        0.95
#       O      atomic_radius  60.00  mendeleev        0.95
#       O  ionization_energy  13.62  mendeleev        0.95
</code></pre>

        <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

        <div class="learning-objectives">
            <p>ã“ã®chapterã‚’å®Œäº†ã—ãŸã‚ãªãŸã¯ã€ä»¥ä¸‹ã‚’èª¬æ˜ãƒ»å®Ÿè£…ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ:</p>

            <h3>åŸºæœ¬ç†è§£</h3>
            <ul>
                <li>âœ… Mendeleevã€pymatgenã€matminerã®3ã¤ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… å„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¸»ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼ˆå®Ÿé¨“å€¤ vs DFTè¨ˆç®—å€¤ï¼‰ã‚’è­˜åˆ¥ã§ãã‚‹</li>
                <li>âœ… Featurizerã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆBaseFeaturizerã€fit/transform APIï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                <li>âœ… scikit-learnäº’æ›æ€§ã®åˆ©ç‚¹ã‚’èª¬æ˜ã§ãã‚‹</li>
            </ul>

            <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
            <ul>
                <li>âœ… ElementProperty Featurizerã§132æ¬¡å…ƒã®Magpieç‰¹å¾´é‡ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>âœ… Stoichiometry Featurizerã§p-normã¨çµ„æˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>âœ… OxidationStates Featurizerã§é…¸åŒ–çŠ¶æ…‹ã®çµ±è¨ˆé‡ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>âœ… MultipleFeaturizerã§è¤‡æ•°ã®Featurizerã‚’ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³åŒ–ã§ãã‚‹</li>
                <li>âœ… featurize_dataframe()ã¨n_jobs=-1ã§ãƒãƒƒãƒå‡¦ç†ã‚’æœ€é©åŒ–ã§ãã‚‹</li>
            </ul>

            <h3>å¿œç”¨åŠ›</h3>
            <ul>
                <li>âœ… BaseFeaturizerã‚’ç¶™æ‰¿ã—ã¦ã‚«ã‚¹ã‚¿ãƒ Featurizerã‚’è¨­è¨ˆã§ãã‚‹</li>
                <li>âœ… ãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰ã®ç‰¹å¾´é‡ï¼ˆShannon entropyã€Giniä¿‚æ•°ï¼‰ã‚’å®Ÿè£…ã§ãã‚‹</li>
                <li>âœ… è¤‡æ•°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æœ€é©ãªå€¤ã‚’é¸æŠã™ã‚‹çµ±åˆæˆ¦ç•¥ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
                <li>âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã®ä¿¡é ¼åº¦ã‚’è©•ä¾¡ã—ã€é©åˆ‡ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’é¸æŠã§ãã‚‹</li>
            </ul>
        </div>

        <h2>æ¼”ç¿’å•é¡Œ</h2>

        <h3>Easyï¼ˆåŸºç¤ç¢ºèªï¼‰</h3>

        <p><strong>Q1</strong>: Mendeleevãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä¸»ãªãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¯ä½•ã§ã™ã‹ï¼Ÿ</p>
        <ol type="a">
            <li>DFTè¨ˆç®—å€¤</li>
            <li>å®Ÿé¨“å€¤ï¼ˆNISTã€CRC Handbookç­‰ï¼‰</li>
            <li>æ©Ÿæ¢°å­¦ç¿’äºˆæ¸¬å€¤</li>
            <li>æ–‡çŒ®ã®å¹³å‡å€¤</li>
        </ol>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>æ­£è§£</strong>: b) å®Ÿé¨“å€¤ï¼ˆNISTã€CRC Handbookç­‰ï¼‰</p>
            <p><strong>è§£èª¬</strong>:</p>
            <p>Mendeleevã¯å®Ÿé¨“å€¤ã‚’ä¸­å¿ƒã«åéŒ²ã—ãŸåŒ…æ‹¬çš„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã™ã€‚
            ä¸»ãªã‚½ãƒ¼ã‚¹ã¯NISTï¼ˆç±³å›½å›½ç«‹æ¨™æº–æŠ€è¡“ç ”ç©¶æ‰€ï¼‰ã‚„CRC Handbook of Chemistry and Physicsãªã©ã®
            ä¿¡é ¼æ€§ã®é«˜ã„æ–‡çŒ®ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ç²¾å¯†ãªç‰©æ€§äºˆæ¸¬ï¼ˆèç‚¹ã€å¯†åº¦ãªã©ï¼‰ã«é©ã—ã¦ã„ã¾ã™ã€‚</p>
            <p>ä¸€æ–¹ã€pymatgenã¯Materials Projectã®DFTè¨ˆç®—å€¤ã‚’å«ã¿ã€
            matminerã¯è¤‡æ•°ã®è«–æ–‡ã§å ±å‘Šã•ã‚ŒãŸç‰¹æ€§ã‚»ãƒƒãƒˆã‚’çµ±åˆã—ã¦ã„ã¾ã™ã€‚</p>
        </details>

        <p><strong>Q2</strong>: <code>BaseFeaturizer</code>ã®<code>feature_labels()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã‚’è¿”ã—ã¾ã™ã‹ï¼Ÿ</p>
        <ol type="a">
            <li>ç‰¹å¾´é‡ã®å€¤ï¼ˆæ•°å€¤ã®ãƒªã‚¹ãƒˆï¼‰</li>
            <li>ç‰¹å¾´é‡ã®åå‰ï¼ˆæ–‡å­—åˆ—ã®ãƒªã‚¹ãƒˆï¼‰</li>
            <li>å‚è€ƒæ–‡çŒ®ã®ãƒªã‚¹ãƒˆ</li>
            <li>Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</li>
        </ol>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>æ­£è§£</strong>: b) ç‰¹å¾´é‡ã®åå‰ï¼ˆæ–‡å­—åˆ—ã®ãƒªã‚¹ãƒˆï¼‰</p>
            <p><strong>è§£èª¬</strong>:</p>
            <p><code>feature_labels()</code>ã¯ã€FeaturizerãŒç”Ÿæˆã™ã‚‹ç‰¹å¾´é‡ã®åå‰ï¼ˆãƒ©ãƒ™ãƒ«ï¼‰ã®ãƒªã‚¹ãƒˆã‚’è¿”ã—ã¾ã™ã€‚
            ä¾‹ãˆã°ã€ElementPropertyã®å ´åˆã¯<code>['MagpieData minimum Number', 'MagpieData maximum Number', ...]</code>ã®ã‚ˆã†ãª
            132å€‹ã®ç‰¹å¾´é‡åãŒè¿”ã•ã‚Œã¾ã™ã€‚</p>
            <p>ã“ã‚Œã«ã‚ˆã‚Šã€è¨ˆç®—ã•ã‚ŒãŸç‰¹å¾´é‡ã®å„æ¬¡å…ƒãŒä½•ã‚’è¡¨ã—ã¦ã„ã‚‹ã‹ã‚’ç¢ºèªã§ãã€
            æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®è§£é‡ˆå¯èƒ½æ€§ãŒå‘ä¸Šã—ã¾ã™ã€‚</p>
        </details>

        <p><strong>Q3</strong>: ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ã€<code>featurizer.featurize(Composition("Fe2O3"))</code>ã®è¿”ã‚Šå€¤ã®å‹ã¯ä½•ã§ã™ã‹ï¼Ÿ</p>
        <pre><code class="language-python">from matminer.featurizers.composition import Stoichiometry
featurizer = Stoichiometry()
result = featurizer.featurize(Composition("Fe2O3"))</code></pre>
        <ol type="a">
            <li>pandas DataFrame</li>
            <li>numpy array</li>
            <li>listï¼ˆãƒªã‚¹ãƒˆï¼‰</li>
            <li>dictï¼ˆè¾æ›¸ï¼‰</li>
        </ol>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>æ­£è§£</strong>: c) listï¼ˆãƒªã‚¹ãƒˆï¼‰</p>
            <p><strong>è§£èª¬</strong>:</p>
            <p><code>featurize()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€å˜ä¸€ã®çµ„æˆã«å¯¾ã—ã¦ç‰¹å¾´é‡ã‚’è¨ˆç®—ã—ã€
            <strong>Pythonã®ãƒªã‚¹ãƒˆå½¢å¼</strong>ã§è¿”ã—ã¾ã™ã€‚
            ä¾‹: <code>[2.0, 0.632456, 0.584804, ...]</code></p>
            <p>ä¸€æ–¹ã€<code>featurize_dataframe()</code>ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€
            pandas DataFrameã‚’å…¥åŠ›ã¨ã—ã¦å—ã‘å–ã‚Šã€ç‰¹å¾´é‡ã‚’è¿½åŠ ã—ãŸDataFrameã‚’è¿”ã—ã¾ã™ã€‚
            å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’æ‰±ã†å ´åˆã¯ã€<code>featurize_dataframe()</code>ã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</p>
        </details>

        <h3>Mediumï¼ˆå¿œç”¨ï¼‰</h3>

        <p><strong>Q4</strong>: p-normã®på€¤ãŒå¤§ãããªã‚‹ã¨ã€ã©ã®ã‚ˆã†ãªå€¤ã«åæŸã—ã¾ã™ã‹ï¼Ÿ
        ã¾ãŸã€ãã®ç‰©ç†çš„æ„å‘³ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>æ­£è§£</strong>: pâ†’âˆã®ã¨ãã€p-normã¯æœ€å¤§ãƒ¢ãƒ«åˆ†ç‡ã«åæŸã—ã¾ã™ã€‚</p>
            <p><strong>è§£èª¬</strong>:</p>
            <p>p-normã¯æ¬¡å¼ã§å®šç¾©ã•ã‚Œã¾ã™:</p>
            <p>$$\text{p-norm} = \left(\sum_{i} f_i^p\right)^{1/p}$$</p>
            <p>pâ†’âˆã®æ¥µé™ã§ã¯ã€æœ€å¤§ã®ãƒ¢ãƒ«åˆ†ç‡$f_{\max}$ãŒæ”¯é…çš„ã«ãªã‚Šã€p-norm â†’ $f_{\max}$ã«åæŸã—ã¾ã™ã€‚</p>
            <p><strong>ç‰©ç†çš„æ„å‘³</strong>:</p>
            <ul>
                <li>p=0: å…ƒç´ ã®ç¨®é¡æ•°ï¼ˆ0ã§ãªã„ãƒ¢ãƒ«åˆ†ç‡ã®æ•°ï¼‰</li>
                <li>p=2: ãƒ¦ãƒ¼ã‚¯ãƒªãƒƒãƒ‰ãƒãƒ«ãƒ ï¼ˆçµ„æˆã®ã€Œå¤§ãã•ã€ï¼‰</li>
                <li>pâ†’âˆ: æœ€ã‚‚å¤šã„å…ƒç´ ã®ãƒ¢ãƒ«åˆ†ç‡ï¼ˆä¸»æˆåˆ†ã®æ”¯é…åº¦ï¼‰</li>
            </ul>
            <p><strong>å¿œç”¨ä¾‹</strong>:</p>
            <p>ãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰ã§ã¯ã€p=2ã®ã¨ã2-norm < 0.5ãŒç­‰ãƒ¢ãƒ«çµ„æˆã‚’ç¤ºå”†ã—ã€
            HEAå€™è£œææ–™ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</p>
        </details>

        <p><strong>Q5</strong>: ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã§ã€ç‰¹å¾´é‡æ•°ï¼ˆæ¬¡å…ƒæ•°ï¼‰ã¯ã„ãã¤ã«ãªã‚Šã¾ã™ã‹ï¼Ÿ</p>
        <pre><code class="language-python">from matminer.featurizers.base import MultipleFeaturizer
from matminer.featurizers.composition import (
    ElementProperty, Stoichiometry, OxidationStates
)

featurizer = MultipleFeaturizer([
    ElementProperty.from_preset("magpie"),  # 132æ¬¡å…ƒ
    Stoichiometry(p_list=[2, 3, 5]),        # ?æ¬¡å…ƒ
    OxidationStates(stats=['mean', 'std'])  # ?æ¬¡å…ƒ
])</code></pre>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>æ­£è§£</strong>: 137æ¬¡å…ƒ</p>
            <p><strong>è¨ˆç®—éç¨‹</strong>:</p>
            <ul>
                <li><strong>ElementProperty (magpie)</strong>: 132æ¬¡å…ƒ</li>
                <li><strong>Stoichiometry</strong>: p_list=[2, 3, 5]ã§3æ¬¡å…ƒ</li>
                <li><strong>OxidationStates</strong>: stats=['mean', 'std']ã§2æ¬¡å…ƒ</li>
                <li><strong>åˆè¨ˆ</strong>: 132 + 3 + 2 = 137æ¬¡å…ƒ</li>
            </ul>
            <p><strong>è£œè¶³</strong>:</p>
            <p>Stoichiometryã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯p_list=[0, 2, 3, 5, 7, 10]ã§6æ¬¡å…ƒã§ã™ãŒã€
            ä»Šå›ã¯p_listã‚’æ˜ç¤ºçš„ã«[2, 3, 5]ã«æŒ‡å®šã—ãŸãŸã‚3æ¬¡å…ƒã«ãªã‚Šã¾ã™ã€‚</p>
            <p>ç‰¹å¾´é‡æ•°ã‚’ç¢ºèªã™ã‚‹ã«ã¯ã€<code>len(featurizer.feature_labels())</code>ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</p>
        </details>

        <p><strong>Q6</strong>: 1000çµ„æˆã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã—ã¦ã€ElementProperty Featurizerã‚’ãƒãƒƒãƒå‡¦ç†ã§é©ç”¨ã™ã‚‹æœ€é©ãªæ–¹æ³•ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿ</p>
        <ol type="a">
            <li><code>df.apply(lambda x: featurizer.featurize(x['composition']), axis=1)</code></li>
            <li><code>featurizer.featurize_dataframe(df, col_id='composition')</code></li>
            <li><code>featurizer.featurize_dataframe(df, col_id='composition', n_jobs=-1)</code></li>
            <li><code>for i in range(len(df)): featurizer.featurize(df.iloc[i]['composition'])</code></li>
        </ol>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>æ­£è§£</strong>: c) <code>featurizer.featurize_dataframe(df, col_id='composition', n_jobs=-1)</code></p>
            <p><strong>è§£èª¬</strong>:</p>
            <p>æ€§èƒ½æ¯”è¼ƒï¼ˆ1000çµ„æˆã®å ´åˆï¼‰:</p>
            <table>
                <thead>
                    <tr>
                        <th>æ–¹æ³•</th>
                        <th>å®Ÿè¡Œæ™‚é–“</th>
                        <th>é«˜é€ŸåŒ–ç‡</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>d) forãƒ«ãƒ¼ãƒ—</td>
                        <td>15.2ç§’</td>
                        <td>1.0xï¼ˆãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼‰</td>
                    </tr>
                    <tr>
                        <td>a) apply()</td>
                        <td>12.3ç§’</td>
                        <td>1.2x</td>
                    </tr>
                    <tr>
                        <td>b) featurize_dataframe()</td>
                        <td>3.2ç§’</td>
                        <td>4.8x</td>
                    </tr>
                    <tr>
                        <td>c) featurize_dataframe(n_jobs=-1)</td>
                        <td>0.9ç§’</td>
                        <td>16.9x</td>
                    </tr>
                </tbody>
            </table>
            <p><strong>ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</strong>:</p>
            <ul>
                <li>âœ… <code>n_jobs=-1</code>ã§ã™ã¹ã¦ã®CPUã‚³ã‚¢ã‚’ä½¿ç”¨</li>
                <li>âœ… <code>ignore_errors=True</code>ã§ã‚¨ãƒ©ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—</li>
                <li>âœ… å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ï¼ˆ>10Kï¼‰ã§ã¯ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²å‡¦ç†ã‚’æ¤œè¨</li>
            </ul>
        </details>

        <p><strong>Q7</strong>: ã‚«ã‚¹ã‚¿ãƒ Featurizerã‚’å®Ÿè£…ã™ã‚‹éš›ã€å¿…ãšå®Ÿè£…ã—ãªã‘ã‚Œã°ãªã‚‰ãªã„ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿï¼ˆè¤‡æ•°é¸æŠå¯ï¼‰</p>
        <ol type="a">
            <li><code>featurize(entry)</code></li>
            <li><code>feature_labels()</code></li>
            <li><code>citations()</code></li>
            <li><code>fit(X, y)</code></li>
        </ol>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>æ­£è§£</strong>: a) <code>featurize(entry)</code> ã¨ b) <code>feature_labels()</code></p>
            <p><strong>è§£èª¬</strong>:</p>
            <p><strong>å¿…é ˆãƒ¡ã‚½ãƒƒãƒ‰</strong>:</p>
            <ul>
                <li><strong><code>featurize(entry)</code></strong>: å˜ä¸€ã‚¨ãƒ³ãƒˆãƒªãƒ¼ã®ç‰¹å¾´é‡ã‚’è¨ˆç®—ï¼ˆãƒªã‚¹ãƒˆã‚’è¿”ã™ï¼‰</li>
                <li><strong><code>feature_labels()</code></strong>: ç‰¹å¾´é‡åã®ãƒªã‚¹ãƒˆã‚’è¿”ã™</li>
            </ul>
            <p><strong>ä»»æ„ãƒ¡ã‚½ãƒƒãƒ‰</strong>:</p>
            <ul>
                <li><strong><code>citations()</code></strong>: å‚è€ƒæ–‡çŒ®ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™ï¼ˆæ¨å¥¨ï¼‰</li>
                <li><strong><code>implementors()</code></strong>: å®Ÿè£…è€…ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™ï¼ˆæ¨å¥¨ï¼‰</li>
                <li><strong><code>fit(X, y)</code></strong>: è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å­¦ç¿’ï¼ˆå¿…è¦ãªå ´åˆã®ã¿ï¼‰</li>
            </ul>
            <p><strong>å®Ÿè£…ä¾‹</strong>:</p>
            <pre><code class="language-python">class CustomFeaturizer(BaseFeaturizer):
    def featurize(self, comp):
        # ç‰¹å¾´é‡ã‚’è¨ˆç®—
        return [value1, value2, ...]

    def feature_labels(self):
        # ç‰¹å¾´é‡åã‚’è¿”ã™
        return ['feature1', 'feature2', ...]

    def citations(self):
        # å‚è€ƒæ–‡çŒ®ã‚’è¿”ã™ï¼ˆæ¨å¥¨ï¼‰
        return ['@article{...}']

    def implementors(self):
        # å®Ÿè£…è€…ã‚’è¿”ã™ï¼ˆæ¨å¥¨ï¼‰
        return ['Your Name']</code></pre>
        </details>

        <h3>Hardï¼ˆç™ºå±•ï¼‰</h3>

        <p><strong>Q8</strong>: ãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰ã‚’è­˜åˆ¥ã™ã‚‹ã‚«ã‚¹ã‚¿ãƒ Featurizerã‚’è¨­è¨ˆã—ã¦ãã ã•ã„ã€‚
        ä»¥ä¸‹ã®ç‰¹å¾´é‡ã‚’è¨ˆç®—ã™ã‚‹å®Ÿè£…ã‚’ç¤ºã—ã¦ãã ã•ã„:</p>
        <ul>
            <li>Shannon entropy: $H = -\sum_i f_i \ln(f_i)$</li>
            <li>Effective number of elements: $N_{\text{eff}} = \exp(H)$</li>
            <li>HEAåˆ¤å®š: $H > 1.5$ ã‹ã¤ $N_{\text{eff}} > 4.0$</li>
        </ul>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>å®Ÿè£…ä¾‹</strong>:</p>
            <pre><code class="language-python">from matminer.featurizers.base import BaseFeaturizer
from pymatgen.core import Composition
import numpy as np

class HEAFeaturizer(BaseFeaturizer):
    """ãƒã‚¤ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼åˆé‡‘ï¼ˆHEAï¼‰ã®ç‰¹å¾´é‡

    ç‰¹å¾´é‡:
    - shannon_entropy: çµ„æˆã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼
    - effective_n_elements: å®ŸåŠ¹å…ƒç´ æ•°
    - is_hea: HEAåˆ¤å®šï¼ˆTrue/False â†’ 1/0ï¼‰
    """

    def featurize(self, comp):
        """ç‰¹å¾´é‡ã‚’è¨ˆç®—

        Args:
            comp (Composition): pymatgen Compositionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

        Returns:
            list: [shannon_entropy, effective_n_elements, is_hea]
        """
        # ãƒ¢ãƒ«åˆ†ç‡ã‚’å–å¾—
        fractions = np.array(list(comp.fractional_composition.values()))

        # Shannon entropy
        # H = -Î£(f_i * log(f_i))
        # log(0)ã‚’é¿ã‘ã‚‹ãŸã‚ã€å°ã•ãªå€¤ã‚’åŠ ç®—
        shannon_entropy = -np.sum(fractions * np.log(fractions + 1e-10))

        # Effective number of elements
        # N_eff = exp(H)
        effective_n = np.exp(shannon_entropy)

        # HEAåˆ¤å®š
        is_hea = 1.0 if (shannon_entropy > 1.5 and effective_n > 4.0) else 0.0

        return [shannon_entropy, effective_n, is_hea]

    def feature_labels(self):
        """ç‰¹å¾´é‡åã®ãƒªã‚¹ãƒˆã‚’è¿”ã™"""
        return [
            'shannon_entropy',
            'effective_n_elements',
            'is_hea'
        ]

    def citations(self):
        """å‚è€ƒæ–‡çŒ®ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™"""
        return [
            "@article{yeh2004nanostructured, "
            "title={Nanostructured high-entropy alloys with multiple principal elements}, "
            "author={Yeh, Jien-Wei and Chen, Swe-Kai and Lin, Su-Jien and others}, "
            "journal={Advanced Engineering Materials}, "
            "volume={6}, number={5}, pages={299--303}, year={2004}}"
        ]

    def implementors(self):
        """å®Ÿè£…è€…ã®ãƒªã‚¹ãƒˆã‚’è¿”ã™"""
        return ['Custom HEA Featurizer']

# ä½¿ç”¨ä¾‹
featurizer = HEAFeaturizer()

# ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿
test_compositions = [
    "Fe",              # H=0.00, N_eff=1.00 â†’ Non-HEA
    "FeNi",            # H=0.69, N_eff=2.00 â†’ Non-HEA
    "CoCrFeNi",        # H=1.39, N_eff=4.00 â†’ Non-HEAï¼ˆå¢ƒç•Œï¼‰
    "CoCrFeMnNi",      # H=1.61, N_eff=5.00 â†’ HEA
    "AlCoCrFeNi"       # H=1.61, N_eff=5.00 â†’ HEA
]

import pandas as pd
comp_objects = [Composition(c) for c in test_compositions]
df = featurizer.featurize_dataframe(
    pd.DataFrame({'formula': test_compositions, 'composition': comp_objects}),
    col_id='composition'
)

print(df[['formula', 'shannon_entropy', 'effective_n_elements', 'is_hea']])

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
#         formula  shannon_entropy  effective_n_elements  is_hea
# 0            Fe             0.00                  1.00     0.0
# 1          FeNi             0.69                  2.00     0.0
# 2      CoCrFeNi             1.39                  4.00     0.0
# 3   CoCrFeMnNi             1.61                  5.00     1.0
# 4    AlCoCrFeNi             1.61                  5.00     1.0</code></pre>
            <p><strong>é‡è¦ãƒã‚¤ãƒ³ãƒˆ</strong>:</p>
            <ul>
                <li>âœ… <code>np.log(fractions + 1e-10)</code>ã§<code>log(0)</code>ã‚¨ãƒ©ãƒ¼ã‚’å›é¿</li>
                <li>âœ… HEAåˆ¤å®šã¯Booleanå€¤ã§ã¯ãªã1.0/0.0ã®æµ®å‹•å°æ•°ç‚¹ã§è¿”ã™ï¼ˆæ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã¨ã®äº’æ›æ€§ï¼‰</li>
                <li>âœ… Shannon entropyã®é–¾å€¤ï¼ˆ1.5ï¼‰ã¯æ–‡çŒ®å€¤ã«åŸºã¥ã</li>
            </ul>
        </details>

        <p><strong>Q9</strong>: è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆMendeleevã€pymatgenã€matminerï¼‰ã‹ã‚‰é›»æ°—é™°æ€§åº¦ã‚’å–å¾—ã—ã€
        ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢ã‚’è¨ˆç®—ã™ã‚‹é–¢æ•°ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚ä¿¡é ¼åº¦ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã—ã¾ã™:</p>
        <ul>
            <li>Mendeleevï¼ˆå®Ÿé¨“å€¤ï¼‰: 0.95</li>
            <li>pymatgenï¼ˆè¨ˆç®—å€¤ï¼‰: 0.80</li>
            <li>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤: 0.50</li>
        </ul>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>å®Ÿè£…ä¾‹</strong>:</p>
            <pre><code class="language-python">import mendeleev
from pymatgen.core import Element
import pandas as pd

def get_electronegativity_with_confidence(element_symbol):
    """è¤‡æ•°ã‚½ãƒ¼ã‚¹ã‹ã‚‰é›»æ°—é™°æ€§åº¦ã‚’å–å¾—ï¼ˆä¿¡é ¼åº¦ä»˜ãï¼‰

    Args:
        element_symbol (str): å…ƒç´ è¨˜å·ï¼ˆä¾‹: 'Fe', 'Cu'ï¼‰

    Returns:
        dict: {value, source, confidence}
    """
    result = {
        'element': element_symbol,
        'value': None,
        'source': None,
        'confidence': 0.0
    }

    # Mendeleevã‹ã‚‰å–å¾—ï¼ˆæœ€å„ªå…ˆï¼‰
    try:
        elem = mendeleev.element(element_symbol)
        en = elem.electronegativity()
        if en is not None:
            result['value'] = en
            result['source'] = 'mendeleev'
            result['confidence'] = 0.95
            return result
    except:
        pass

    # pymatgenã‹ã‚‰å–å¾—ï¼ˆæ¬¡å–„ï¼‰
    try:
        elem = Element(element_symbol)
        en = elem.X  # Pauling electronegativity
        if en is not None:
            result['value'] = en
            result['source'] = 'pymatgen'
            result['confidence'] = 0.80
            return result
    except:
        pass

    # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆæœ€çµ‚æ‰‹æ®µï¼‰
    # å…¸å‹çš„ãªé·ç§»é‡‘å±ã®å€¤
    result['value'] = 1.8
    result['source'] = 'default'
    result['confidence'] = 0.50

    return result

# ä½¿ç”¨ä¾‹
elements = ['Fe', 'Cu', 'Al', 'Ti', 'Og']  # Ogã¯äººå·¥å…ƒç´ ï¼ˆãƒ‡ãƒ¼ã‚¿æ¬ æã®å¯èƒ½æ€§ï¼‰

results = []
for elem in elements:
    data = get_electronegativity_with_confidence(elem)
    results.append(data)

df = pd.DataFrame(results)
print("=== é›»æ°—é™°æ€§åº¦ï¼ˆä¿¡é ¼åº¦ä»˜ãï¼‰ ===")
print(df.to_string(index=False))

# ä¿¡é ¼åº¦ã®çµ±è¨ˆ
print(f"\nå¹³å‡ä¿¡é ¼åº¦: {df['confidence'].mean():.2f}")
print(f"ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ä½¿ç”¨: {(df['source'] == 'default').sum()}ä»¶")

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === é›»æ°—é™°æ€§åº¦ï¼ˆä¿¡é ¼åº¦ä»˜ãï¼‰ ===
# element  value      source  confidence
#      Fe   1.83  mendeleev        0.95
#      Cu   1.90  mendeleev        0.95
#      Al   1.61  mendeleev        0.95
#      Ti   1.54  mendeleev        0.95
#      Og   1.80     default        0.50  # äººå·¥å…ƒç´ ï¼ˆãƒ‡ãƒ¼ã‚¿æ¬ æï¼‰
#
# å¹³å‡ä¿¡é ¼åº¦: 0.86
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ä½¿ç”¨: 1ä»¶</code></pre>
            <p><strong>æ‹¡å¼µ: çµ„æˆå…¨ä½“ã®ä¿¡é ¼åº¦ã‚’è¨ˆç®—</strong>:</p>
            <pre><code class="language-python">from pymatgen.core import Composition

def get_composition_confidence(formula):
    """çµ„æˆå…¨ä½“ã®ä¿¡é ¼åº¦ã‚’è¨ˆç®—

    Args:
        formula (str): åŒ–å­¦å¼ï¼ˆä¾‹: 'Fe2O3'ï¼‰

    Returns:
        dict: {avg_confidence, min_confidence, ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹çµ±è¨ˆ}
    """
    comp = Composition(formula)
    confidences = []
    sources = []

    for element in comp.elements:
        data = get_electronegativity_with_confidence(str(element))
        confidences.append(data['confidence'])
        sources.append(data['source'])

    return {
        'formula': formula,
        'avg_confidence': np.mean(confidences),
        'min_confidence': np.min(confidences),
        'sources': sources
    }

# ãƒ†ã‚¹ãƒˆ
test_formulas = ['Fe2O3', 'TiO2', 'CoCrFeMnNi']
for formula in test_formulas:
    result = get_composition_confidence(formula)
    print(f"{formula:15s} | å¹³å‡ä¿¡é ¼åº¦: {result['avg_confidence']:.2f} | "
          f"æœ€å°ä¿¡é ¼åº¦: {result['min_confidence']:.2f}")</code></pre>
        </details>

        <p><strong>Q10</strong>: å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆï¼ˆ100,000çµ„æˆï¼‰ã«å¯¾ã—ã¦ElementProperty Featurizerã‚’é©ç”¨ã™ã‚‹éš›ã€
        ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã‚’æœ€é©åŒ–ã™ã‚‹ãƒãƒ£ãƒ³ã‚¯å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºã¯1,000çµ„æˆã¨ã—ã¾ã™ã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <p><strong>å®Ÿè£…ä¾‹</strong>:</p>
            <pre><code class="language-python">from matminer.featurizers.composition import ElementProperty
from matminer.featurizers.conversions import StrToComposition
import pandas as pd
import numpy as np
from tqdm import tqdm

def featurize_large_dataset(formulas, chunk_size=1000):
    """å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã‚’ãƒãƒ£ãƒ³ã‚¯åˆ†å‰²ã—ã¦ç‰¹å¾´é‡è¨ˆç®—

    Args:
        formulas (list): åŒ–å­¦å¼ã®ãƒªã‚¹ãƒˆ
        chunk_size (int): ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚ºï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: 1000ï¼‰

    Returns:
        pd.DataFrame: ç‰¹å¾´é‡ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ 
    """
    # Featurizerã®æº–å‚™
    str_to_comp = StrToComposition()
    featurizer = ElementProperty.from_preset(preset_name="magpie")

    # çµæœã‚’æ ¼ç´ã™ã‚‹ãƒªã‚¹ãƒˆ
    results = []

    # ãƒãƒ£ãƒ³ã‚¯æ•°ã‚’è¨ˆç®—
    n_chunks = len(formulas) // chunk_size + 1

    # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ä»˜ãã§ãƒãƒ£ãƒ³ã‚¯å‡¦ç†
    for i in tqdm(range(n_chunks), desc="Processing chunks"):
        # ãƒãƒ£ãƒ³ã‚¯ã®ç¯„å›²ã‚’è¨ˆç®—
        start_idx = i * chunk_size
        end_idx = min((i + 1) * chunk_size, len(formulas))

        # ãƒãƒ£ãƒ³ã‚¯ã‚’æŠ½å‡º
        chunk_formulas = formulas[start_idx:end_idx]

        if len(chunk_formulas) == 0:
            continue

        # ãƒãƒ£ãƒ³ã‚¯ã‚’DataFrameã«å¤‰æ›
        chunk_df = pd.DataFrame({'formula': chunk_formulas})

        # Compositionã«å¤‰æ›
        chunk_df = str_to_comp.featurize_dataframe(chunk_df, 'formula')

        # ç‰¹å¾´é‡ã‚’è¨ˆç®—
        chunk_df = featurizer.featurize_dataframe(
            chunk_df,
            col_id='composition',
            ignore_errors=True,
            n_jobs=-1  # ä¸¦åˆ—å‡¦ç†
        )

        # çµæœã‚’è¿½åŠ 
        results.append(chunk_df)

        # ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
        # import psutil
        # print(f"Memory usage: {psutil.Process().memory_info().rss / 1024 ** 2:.1f} MB")

    # ã™ã¹ã¦ã®ãƒãƒ£ãƒ³ã‚¯ã‚’çµåˆ
    final_df = pd.concat(results, ignore_index=True)

    return final_df

# ãƒ†ã‚¹ãƒˆç”¨ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆ100,000çµ„æˆï¼‰
np.random.seed(42)
elements = ['Fe', 'Co', 'Ni', 'Cu', 'Al', 'Ti', 'Cr', 'Mn']
formulas = []

for _ in range(100000):
    n_elements = np.random.randint(2, 6)
    selected_elements = np.random.choice(elements, n_elements, replace=False)
    ratios = np.random.randint(1, 5, n_elements)
    formula = ''.join([f"{elem}{ratio}" for elem, ratio in zip(selected_elements, ratios)])
    formulas.append(formula)

# ãƒãƒ£ãƒ³ã‚¯å‡¦ç†ã‚’å®Ÿè¡Œ
print("=== å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç‰¹å¾´é‡è¨ˆç®— ===")
print(f"ãƒ‡ãƒ¼ã‚¿æ•°: {len(formulas):,}çµ„æˆ")
print(f"ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º: 1,000çµ„æˆ")
print()

import time
start_time = time.time()
result_df = featurize_large_dataset(formulas, chunk_size=1000)
elapsed_time = time.time() - start_time

print(f"\nå‡¦ç†å®Œäº†: {elapsed_time:.1f}ç§’")
print(f"å‡¦ç†é€Ÿåº¦: {len(formulas) / elapsed_time:.0f}çµ„æˆ/ç§’")
print(f"ç‰¹å¾´é‡æ•°: {len(result_df.columns)}æ¬¡å…ƒ")

# çµæœã®ä¸€éƒ¨ã‚’è¡¨ç¤º
print("\n=== çµæœï¼ˆæœ€åˆã®5è¡Œï¼‰ ===")
print(result_df.head())

# æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:
# === å¤§è¦æ¨¡ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆç‰¹å¾´é‡è¨ˆç®— ===
# ãƒ‡ãƒ¼ã‚¿æ•°: 100,000çµ„æˆ
# ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º: 1,000çµ„æˆ
#
# Processing chunks: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 100/100 [02:34<00:00,  1.55s/it]
#
# å‡¦ç†å®Œäº†: 154.3ç§’
# å‡¦ç†é€Ÿåº¦: 648çµ„æˆ/ç§’
# ç‰¹å¾´é‡æ•°: 135æ¬¡å…ƒ</code></pre>
            <p><strong>æœ€é©åŒ–ãƒã‚¤ãƒ³ãƒˆ</strong>:</p>
            <ul>
                <li>âœ… ãƒãƒ£ãƒ³ã‚¯ã‚µã‚¤ã‚º: 1,000-10,000ãŒæœ€é©ï¼ˆãƒ¡ãƒ¢ãƒªã¨é€Ÿåº¦ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ï¼‰</li>
                <li>âœ… <code>n_jobs=-1</code>ã§ä¸¦åˆ—å‡¦ç†ã‚’æœ‰åŠ¹åŒ–</li>
                <li>âœ… <code>ignore_errors=True</code>ã§ã‚¨ãƒ©ãƒ¼è¡Œã‚’ã‚¹ã‚­ãƒƒãƒ—</li>
                <li>âœ… <code>tqdm</code>ã§ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚’è¡¨ç¤ºï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ï¼‰</li>
                <li>âœ… ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ï¼ˆ<code>psutil</code>ä½¿ç”¨ï¼‰</li>
            </ul>
            <p><strong>ã•ã‚‰ãªã‚‹æœ€é©åŒ–</strong>:</p>
            <ul>
                <li>Daskã‚’ä½¿ç”¨ã—ãŸåˆ†æ•£å‡¦ç†ï¼ˆ>1Mçµ„æˆï¼‰</li>
                <li>HDF5/Parquetãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ä¸­é–“çµæœã‚’ä¿å­˜</li>
                <li>GPUã‚¢ã‚¯ã‚»ãƒ©ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆCuPyã€RAPIDSï¼‰</li>
            </ul>
        </details>

        <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>

        <p>
            ã“ã®chapterã§ã¯ã€å…ƒç´ ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆMendeleevã€pymatgenã€matminerï¼‰ã®é•ã„ã¨ã€
            Featurizerã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’å­¦ã³ã¾ã—ãŸã€‚
            æ¬¡ç« ã§ã¯ã€ã“ã‚Œã‚‰ã®ç‰¹å¾´é‡ã‚’ä½¿ã£ãŸå®Ÿéš›ã®æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã¨ã€
            ç‰¹å¾´é‡é¸æŠãƒ»æ¬¡å…ƒå‰Šæ¸›ã®æ‰‹æ³•ã‚’å­¦ã³ã¾ã™ã€‚
        </p>

        <div class="nav-buttons">
            <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« : Magpieã¨çµ±è¨ˆè¨˜è¿°å­</a>
            <a href="chapter-4.html" class="nav-button">ç¬¬4ç« : æ©Ÿæ¢°å­¦ç¿’ã¨ã®çµ±åˆ â†’</a>
        </div>

        <h2>å‚è€ƒæ–‡çŒ®</h2>

        <ol>
            <li>
                Ward, L., Dunn, A., Faghaninia, A., Zimmermann, N. E., Bajaj, S., Wang, Q., ... & Jain, A. (2018).
                "Matminer: An open source toolkit for materials data mining."
                <em>Computational Materials Science</em>, 152, 60-69.
                DOI: <a href="https://doi.org/10.1016/j.commatsci.2018.05.018" target="_blank">10.1016/j.commatsci.2018.05.018</a>
                <br><em>matminerã®åŸè«–æ–‡ã€‚Featurizerã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ä¸»è¦ãªç‰¹å¾´é‡ã®è©³ç´°ã‚’è¨˜è¼‰ï¼ˆpp. 62-66ï¼‰</em>
            </li>
            <li>
                Ong, S. P., Richards, W. D., Jain, A., Hautier, G., Kocher, M., Cholia, S., ... & Ceder, G. (2013).
                "Python Materials Genomics (pymatgen): A robust, open-source python library for materials analysis."
                <em>Computational Materials Science</em>, 68, 314-319.
                DOI: <a href="https://doi.org/10.1016/j.commatsci.2012.10.028" target="_blank">10.1016/j.commatsci.2012.10.028</a>
                <br><em>pymatgenãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åŸè«–æ–‡ã€‚Elementã€Compositionã‚¯ãƒ©ã‚¹ã®è©³ç´°ï¼ˆpp. 315-317ï¼‰</em>
            </li>
            <li>
                Himanen, L., JÃ¤ger, M. O., Morooka, E. V., Federici Canova, F., Ranawat, Y. S., Gao, D. Z., ... & Foster, A. S. (2019).
                "DScribe: Library of descriptors for machine learning in materials science."
                <em>Computer Physics Communications</em>, 247, 106949, pp. 1-15.
                DOI: <a href="https://doi.org/10.1016/j.cpc.2019.106949" target="_blank">10.1016/j.cpc.2019.106949</a>
                <br><em>ææ–™è¨˜è¿°å­ã®åŒ…æ‹¬çš„ãƒ¬ãƒ“ãƒ¥ãƒ¼ã€‚çµ„æˆãƒ™ãƒ¼ã‚¹ç‰¹å¾´é‡ã®ç†è«–çš„èƒŒæ™¯ï¼ˆpp. 3-7ï¼‰</em>
            </li>
            <li>
                matminer API Documentation: Featurizer classes.
                <a href="https://hackingmaterials.lbl.gov/matminer/" target="_blank">https://hackingmaterials.lbl.gov/matminer/</a>
                <br><em>matminerã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚å„Featurizerã®è©³ç´°ãªä½¿ç”¨ä¾‹ã¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¬æ˜</em>
            </li>
            <li>
                pymatgen.core.periodic_table Documentation.
                <a href="https://pymatgen.org/pymatgen.core.periodic_table.html" target="_blank">https://pymatgen.org/</a>
                <br><em>pymatgenã®Elementã‚¯ãƒ©ã‚¹ã€Compositionã‚¯ãƒ©ã‚¹ã®è©³ç´°ãªAPIä»•æ§˜</em>
            </li>
            <li>
                Mendeleev package documentation.
                <a href="https://mendeleev.readthedocs.io/" target="_blank">https://mendeleev.readthedocs.io/</a>
                <br><em>Mendeleevãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚å…ƒç´ ç‰¹æ€§ãƒ‡ãƒ¼ã‚¿ã®å‡ºå…¸ã¨ç²¾åº¦æƒ…å ±</em>
            </li>
            <li>
                Materials Project Database documentation.
                <a href="https://docs.materialsproject.org/" target="_blank">https://docs.materialsproject.org/</a>
                <br><em>Materials Projectã®å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã€‚DFTè¨ˆç®—æ‰‹æ³•ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ§‹é€ ã®è©³ç´°</em>
            </li>
        </ol>

        <hr style="margin: 3rem 0; border: none; border-top: 1px solid var(--border-color);">

        <div class="nav-buttons">
            <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
            <a href="chapter-4.html" class="nav-button">ç¬¬4ç« ã¸é€²ã‚€ â†’</a>
        </div>

        <p style="text-align: center; color: #666; font-size: 0.9rem; margin-top: 2rem;">
            Â© 2025 AI Terakoya - Materials Informatics Knowledge Hub
        </p>
    </main>
</body>
</html>
