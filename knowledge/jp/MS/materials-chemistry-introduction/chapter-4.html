<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 4: 材料の熱力学と相平衡 - 材料化学入門</title>
    <meta name="description" content="Gibbs自由エネルギー、化学ポテンシャル、相図、Ellingham図を用いた材料の熱力学的安定性と相平衡の理解。">

    <!-- MathJax for equations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            color: #2c3e50;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #f093fb;
        }

        h2 {
            color: #34495e;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 5px solid #f5576c;
        }

        h3 {
            color: #546e7a;
            font-size: 1.4em;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .equation {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            border-left: 4px solid #f093fb;
            overflow-x: auto;
        }

        pre[class*="language-"] {
            margin: 20px 0;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }

        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .note {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .important {
            background: #f8d7da;
            border-left: 5px solid #dc3545;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .tip {
            background: #d1ecf1;
            border-left: 5px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
        }

        th {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        .nav-buttons a {
            padding: 12px 24px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: transform 0.2s;
        }

        .nav-buttons a:hover {
            transform: translateY(-2px);
        }

        .mermaid {
            background: white;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Chapter 4: 材料の熱力学と相平衡</h1>

        <p>本章では、材料科学における<strong>熱力学</strong>の基礎概念と、<strong>相平衡</strong>の理解に必要な理論的枠組みを学びます。Gibbs自由エネルギー、化学ポテンシャル、相図、Ellingham図などを用いて、材料の安定性、相転移、反応性を定量的に予測する方法を習得します。</p>

        <h2>4.1 Gibbs自由エネルギーと化学ポテンシャル</h2>

        <h3>4.1.1 Gibbs自由エネルギー</h3>

        <p><strong>Gibbs自由エネルギー（G）</strong>は、等温等圧条件下で系の自発的変化の方向と平衡状態を決定する熱力学関数です。</p>

        <div class="equation">
            <p><strong>定義式:</strong></p>
            \[
            G = H - TS
            \]
            <p>ここで、\(H\)はエンタルピー、\(T\)は絶対温度、\(S\)はエントロピー。</p>

            <p><strong>自発的変化の判定:</strong></p>
            \[
            \Delta G < 0 \quad \text{自発的（進行可能）}
            \]
            \[
            \Delta G = 0 \quad \text{平衡状態}
            \]
            \[
            \Delta G > 0 \quad \text{非自発的（進行不可能）}
            \]
        </div>

        <div class="equation">
            <p><strong>温度・圧力依存性:</strong></p>
            \[
            dG = -S dT + V dP
            \]
            <p>等温条件（\(dT = 0\)）: \(\left(\frac{\partial G}{\partial P}\right)_T = V\)</p>
            <p>等圧条件（\(dP = 0\)）: \(\left(\frac{\partial G}{\partial T}\right)_P = -S\)</p>
        </div>

        <h3>4.1.2 化学ポテンシャル</h3>

        <p><strong>化学ポテンシャル（\(\mu_i\)）</strong>は、成分\(i\)の物質量変化に対するGibbs自由エネルギーの変化率です。</p>

        <div class="equation">
            \[
            \mu_i = \left(\frac{\partial G}{\partial n_i}\right)_{T,P,n_{j \neq i}}
            \]
            <p>多成分系のGibbs自由エネルギー:</p>
            \[
            G = \sum_i \mu_i n_i
            \]
            <p>化学平衡条件: すべての相で各成分の化学ポテンシャルが等しい</p>
            \[
            \mu_i^{\alpha} = \mu_i^{\beta} = \cdots
            \]
        </div>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def gibbs_free_energy(H, T, S):
    """
    Gibbs自由エネルギーを計算

    Parameters:
    -----------
    H : float
        エンタルピー (kJ/mol)
    T : float or array
        温度 (K)
    S : float
        エントロピー (kJ/(mol·K))

    Returns:
    --------
    G : float or array
        Gibbs自由エネルギー (kJ/mol)
    """
    G = H - T * S
    return G

# 例: Fe2O3 + 3C → 2Fe + 3CO 反応
# ΔH ≈ 492 kJ/mol, ΔS ≈ 0.543 kJ/(mol·K)
delta_H = 492  # kJ/mol
delta_S = 0.543  # kJ/(mol·K)

# 温度範囲: 300-2000 K
T_range = np.linspace(300, 2000, 100)
delta_G = gibbs_free_energy(delta_H, T_range, delta_S)

# 平衡温度（ΔG = 0）
T_eq = delta_H / delta_S
print(f"反応: Fe2O3 + 3C → 2Fe + 3CO")
print(f"ΔH = {delta_H} kJ/mol")
print(f"ΔS = {delta_S} kJ/(mol·K)")
print(f"平衡温度 T_eq (ΔG = 0): {T_eq:.1f} K ({T_eq-273.15:.1f} °C)")

# 可視化
plt.figure(figsize=(10, 6))
plt.plot(T_range, delta_G, linewidth=2, color='#f5576c')
plt.axhline(0, color='black', linestyle='--', linewidth=1, label='ΔG = 0 (equilibrium)')
plt.axvline(T_eq, color='blue', linestyle='--', linewidth=1, label=f'T_eq = {T_eq:.0f} K')
plt.fill_between(T_range, delta_G, 0, where=(delta_G < 0), alpha=0.3, color='green', label='ΔG < 0 (spontaneous)')
plt.fill_between(T_range, delta_G, 0, where=(delta_G >= 0), alpha=0.3, color='red', label='ΔG > 0 (non-spontaneous)')
plt.xlabel('Temperature (K)', fontsize=12)
plt.ylabel('ΔG (kJ/mol)', fontsize=12)
plt.title('Gibbs Free Energy vs Temperature: Fe2O3 Reduction', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('gibbs_energy_temperature.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>

        <h2>4.2 相図と相平衡</h2>

        <h3>4.2.1 二元系相図の基礎</h3>

        <p><strong>相図（Phase Diagram）</strong>は、温度・組成・圧力などの条件における平衡相を示すマップです。材料の製造や熱処理において不可欠なツールです。</p>

        <div class="equation">
            <p><strong>Gibbs相律:</strong></p>
            \[
            F = C - P + 2
            \]
            <p>ここで、\(F\)は自由度、\(C\)は成分数、\(P\)は相数、2は温度と圧力の変数。等圧条件では\(F = C - P + 1\)。</p>
        </div>

        <h3>4.2.2 てこの法則（Lever Rule）</h3>

        <p>二相領域における各相の量比を求める規則です。</p>

        <div class="equation">
            \[
            \frac{W_{\alpha}}{W_{\beta}} = \frac{X_{\beta} - X_0}{X_0 - X_{\alpha}}
            \]
            <p>\(W_{\alpha}, W_{\beta}\): 各相の重量分率、\(X_0\): 全体組成、\(X_{\alpha}, X_{\beta}\): 各相の組成</p>
        </div>

        <pre><code class="language-python">def lever_rule(X0, X_alpha, X_beta):
    """
    てこの法則で二相の重量分率を計算

    Parameters:
    -----------
    X0 : float
        全体組成 (wt% or mol%)
    X_alpha : float
        α相の組成
    X_beta : float
        β相の組成

    Returns:
    --------
    W_alpha, W_beta : float
        各相の重量分率
    """
    # てこの法則
    W_beta = (X0 - X_alpha) / (X_beta - X_alpha)
    W_alpha = 1 - W_beta

    return W_alpha, W_beta

# 例: Cu-Ni合金（40 wt% Ni）が1200°Cで液相（L）と固相（α）の二相領域にある場合
# 液相組成: 30 wt% Ni, 固相組成: 50 wt% Ni
X0 = 40  # wt% Ni
X_liquid = 30  # wt% Ni
X_solid = 50  # wt% Ni

W_liquid, W_solid = lever_rule(X0, X_liquid, X_solid)

print("てこの法則による相量計算:")
print(f"全体組成: {X0} wt% Ni")
print(f"液相（L）組成: {X_liquid} wt% Ni")
print(f"固相（α）組成: {X_solid} wt% Ni")
print(f"\n相量:")
print(f"液相（L）: {W_liquid*100:.1f}%")
print(f"固相（α）: {W_solid*100:.1f}%")

# 検証
print(f"\n検証: {W_liquid*100:.1f}% + {W_solid*100:.1f}% = {(W_liquid + W_solid)*100:.1f}%")
</code></pre>

        <h3>4.2.3 相図の作成</h3>

        <pre><code class="language-python">def plot_binary_phase_diagram():
    """
    簡単な二元系相図（完全固溶型）を作成
    """
    # Cu-Ni系（完全固溶型）の簡略モデル
    composition = np.linspace(0, 100, 100)  # wt% Ni

    # 液相線（Liquidus）と固相線（Solidus）
    # 実際の値を簡略化したモデル
    T_Cu_melt = 1085  # °C
    T_Ni_melt = 1455  # °C

    liquidus = T_Cu_melt + (T_Ni_melt - T_Cu_melt) * composition / 100
    solidus = T_Cu_melt + (T_Ni_melt - T_Cu_melt) * (composition / 100) ** 1.2

    plt.figure(figsize=(10, 7))
    plt.plot(composition, liquidus, 'r-', linewidth=2, label='Liquidus')
    plt.plot(composition, solidus, 'b-', linewidth=2, label='Solidus')

    # 領域塗りつぶし
    plt.fill_between(composition, liquidus, 1600, alpha=0.3, color='red', label='Liquid (L)')
    plt.fill_between(composition, solidus, liquidus, alpha=0.3, color='yellow', label='L + α')
    plt.fill_between(composition, 900, solidus, alpha=0.3, color='blue', label='Solid (α)')

    plt.xlabel('Composition (wt% Ni)', fontsize=12)
    plt.ylabel('Temperature (°C)', fontsize=12)
    plt.title('Cu-Ni Binary Phase Diagram (Simplified)', fontsize=14, fontweight='bold')
    plt.legend(fontsize=11)
    plt.grid(True, alpha=0.3)
    plt.xlim(0, 100)
    plt.ylim(900, 1600)
    plt.tight_layout()
    plt.savefig('cu_ni_phase_diagram.png', dpi=300, bbox_inches='tight')
    plt.show()

plot_binary_phase_diagram()
</code></pre>

        <h2>4.3 Ellingham図と酸化還元反応</h2>

        <h3>4.3.1 Ellingham図の原理</h3>

        <p><strong>Ellingham図</strong>は、金属酸化反応のΔG°と温度の関係を示す図で、金属の精錬や酸化防止の検討に用います。</p>

        <div class="equation">
            <p>一般的な酸化反応:</p>
            \[
            2M + O_2 \rightarrow 2MO
            \]
            <p>標準Gibbs自由エネルギー変化:</p>
            \[
            \Delta G° = \Delta H° - T \Delta S°
            \]
            <p>Ellingham図の傾き: \(-\Delta S°\)（エントロピー変化）</p>
            <p>図で下に位置する金属ほど安定な酸化物を形成（酸化されやすい）</p>
        </div>

        <div class="important">
            <strong>重要:</strong> Ellingham図から、ある金属の酸化物を別の金属で還元できるかを判定できます。還元剤の線が被還元金属の線より下にあれば還元可能です。
        </div>

        <pre><code class="language-python">def ellingham_diagram():
    """
    主要金属酸化物のEllingham図を作成
    """
    T = np.linspace(300, 2000, 100)  # K

    # 各金属酸化反応の近似式 (ΔG° = A + B*T)
    # 2M + O2 → 2MO 形式に規格化
    reactions = {
        'Mg': {'A': -1200, 'B': 0.20, 'color': '#e74c3c'},
        'Al': {'A': -1050, 'B': 0.21, 'color': '#3498db'},
        'Fe': {'A': -520, 'B': 0.13, 'color': '#2ecc71'},
        'Cu': {'A': -300, 'B': 0.15, 'color': '#f39c12'},
        'Ag': {'A': -60, 'B': 0.12, 'color': '#9b59b6'},
    }

    plt.figure(figsize=(12, 8))

    for metal, params in reactions.items():
        delta_G = params['A'] + params['B'] * T
        plt.plot(T, delta_G, linewidth=2.5, color=params['color'], label=f'2{metal} + O₂ → 2{metal}O')

    # C + O2 → CO2 と 2C + O2 → 2CO も追加
    delta_G_CO2 = -394 + 0.003 * T
    delta_G_CO = -220 + 0.18 * T
    plt.plot(T, delta_G_CO2, 'k--', linewidth=2, label='C + O₂ → CO₂')
    plt.plot(T, delta_G_CO, 'k:', linewidth=2, label='2C + O₂ → 2CO')

    plt.axhline(0, color='gray', linestyle='-', linewidth=0.5)
    plt.xlabel('Temperature (K)', fontsize=13)
    plt.ylabel('ΔG° (kJ/mol O₂)', fontsize=13)
    plt.title('Ellingham Diagram for Metal Oxides', fontsize=15, fontweight='bold')
    plt.legend(fontsize=10, loc='upper right')
    plt.grid(True, alpha=0.3)
    plt.xlim(300, 2000)
    plt.ylim(-1300, 100)
    plt.tight_layout()
    plt.savefig('ellingham_diagram.png', dpi=300, bbox_inches='tight')
    plt.show()

    print("Ellingham図の解釈:")
    print("  - 下に位置する金属ほど酸化されやすい（安定な酸化物）")
    print("  - 高温でCO線がFe線より下 → 炭素でFe2O3を還元可能")
    print("  - Mgは最も下 → 強い還元剤として利用可能")

ellingham_diagram()
</code></pre>

        <div class="mermaid">
        flowchart TD
            A[金属酸化物の熱力学] --> B{Ellingham図}
            B --> C[ΔG° vs T]
            C --> D[下に位置]
            C --> E[上に位置]
            D --> F[安定な酸化物<br>酸化されやすい]
            E --> G[不安定な酸化物<br>酸化されにくい]
            F --> H[例: Mg, Al]
            G --> I[例: Ag, Au]
            H --> J[還元剤として利用]
            I --> K[貴金属<br>酸化しない]

            style A fill:#f093fb
            style D fill:#ffcccc
            style E fill:#ccffcc
            style J fill:#ffffcc
            style K fill:#ccccff
        </flowchart>
        </div>

        <h2>4.4 相転移と反応速度論</h2>

        <h3>4.4.1 相転移の分類</h3>

        <p>相転移はGibbs自由エネルギーの微分の連続性により分類されます（Ehrenfest分類）：</p>

        <ul>
            <li><strong>一次相転移</strong>: Gの一次微分（S, V）が不連続 → 融解、蒸発、昇華</li>
            <li><strong>二次相転移</strong>: Gの二次微分（熱容量、圧縮率）が不連続 → 強磁性-常磁性転移</li>
        </ul>

        <div class="equation">
            <p><strong>Clausius-Clapeyron式</strong>（一次相転移の平衡線）:</p>
            \[
            \frac{dP}{dT} = \frac{\Delta S}{\Delta V} = \frac{\Delta H}{T \Delta V}
            \]
            <p>気-液平衡の場合（ΔV ≈ V_gas）:</p>
            \[
            \ln P = -\frac{\Delta H_{\text{vap}}}{R} \left(\frac{1}{T}\right) + C
            \]
        </div>

        <pre><code class="language-python">def clausius_clapeyron(T, delta_H_vap, P0=101.325, T0=373.15):
    """
    Clausius-Clapeyron式で蒸気圧を計算

    Parameters:
    -----------
    T : float or array
        温度 (K)
    delta_H_vap : float
        蒸発エンタルピー (kJ/mol)
    P0 : float
        基準圧力 (kPa, default: 101.325 kPa = 1 atm)
    T0 : float
        基準温度 (K, default: 373.15 K = 100°C for water)

    Returns:
    --------
    P : float or array
        蒸気圧 (kPa)
    """
    R = 8.314  # J/(mol·K)
    delta_H_vap_J = delta_H_vap * 1000  # kJ/mol to J/mol
    P = P0 * np.exp(-delta_H_vap_J / R * (1/T - 1/T0))
    return P

# 例: 水の蒸気圧曲線
delta_H_vap_water = 40.7  # kJ/mol at 100°C
T_range = np.linspace(273, 473, 100)  # 0-200°C
P_water = clausius_clapeyron(T_range, delta_H_vap_water)

plt.figure(figsize=(10, 6))
plt.semilogy(T_range - 273.15, P_water, linewidth=2, color='#3498db')
plt.axhline(101.325, color='red', linestyle='--', label='1 atm (101.325 kPa)')
plt.axvline(100, color='red', linestyle='--', label='100°C')
plt.xlabel('Temperature (°C)', fontsize=12)
plt.ylabel('Vapor Pressure (kPa, log scale)', fontsize=12)
plt.title('Water Vapor Pressure: Clausius-Clapeyron Equation', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3, which='both')
plt.tight_layout()
plt.savefig('vapor_pressure_curve.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>

        <h2>4.5 演習問題</h2>

        <h3>Exercise 4.1 (Easy): Gibbs自由エネルギー変化の計算</h3>
        <p><strong>問題:</strong> ある反応のΔH = +150 kJ/mol、ΔS = +200 J/(mol·K)です。298 Kと500 Kでのthis反応のΔGを計算し、自発性を判定してください。</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 4.1 解答
delta_H = 150  # kJ/mol
delta_S = 0.200  # kJ/(mol·K) (200 J/(mol·K) = 0.2 kJ/(mol·K))

T1 = 298  # K
T2 = 500  # K

delta_G1 = gibbs_free_energy(delta_H, T1, delta_S)
delta_G2 = gibbs_free_energy(delta_H, T2, delta_S)

print("Exercise 4.1 解答:")
print(f"ΔH = {delta_H} kJ/mol")
print(f"ΔS = {delta_S} kJ/(mol·K)")
print(f"\n298 Kの場合:")
print(f"  ΔG = {delta_G1:.1f} kJ/mol")
print(f"  判定: {'非自発的（ΔG > 0）' if delta_G1 > 0 else '自発的（ΔG < 0）'}")

print(f"\n500 Kの場合:")
print(f"  ΔG = {delta_G2:.1f} kJ/mol")
print(f"  判定: {'非自発的（ΔG > 0）' if delta_G2 > 0 else '自発的（ΔG < 0）'}")

# 平衡温度
T_eq = delta_H / delta_S
print(f"\n平衡温度（ΔG = 0）: {T_eq:.1f} K ({T_eq-273.15:.1f} °C)")
print(f"結論: {T_eq:.0f} K以上で反応が自発的に進行")
</code></pre>
        </details>

        <h3>Exercise 4.2 (Medium): てこの法則の応用</h3>
        <p><strong>問題:</strong> Fe-C合金（0.8 wt% C）が727°Cでフェライト（α, 0.02 wt% C）とセメンタイト（Fe₃C, 6.67 wt% C）の二相平衡にあります。各相の重量分率を計算してください。</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 4.2 解答
# Fe-C共析組成（0.8 wt% C）
X0 = 0.8  # wt% C (全体組成)
X_ferrite = 0.02  # wt% C (フェライト)
X_cementite = 6.67  # wt% C (セメンタイト Fe3C)

W_ferrite, W_cementite = lever_rule(X0, X_ferrite, X_cementite)

print("Exercise 4.2 解答:")
print(f"全体組成: {X0} wt% C (共析鋼)")
print(f"フェライト（α）組成: {X_ferrite} wt% C")
print(f"セメンタイト（Fe₃C）組成: {X_cementite} wt% C")
print(f"\nてこの法則による相量:")
print(f"フェライト（α）: {W_ferrite*100:.2f}%")
print(f"セメンタイト（Fe₃C）: {W_cementite*100:.2f}%")

# パーライト組織の説明
print("\n補足:")
print("  共析鋼（0.8 wt% C）は727°Cでオーステナイトから")
print("  フェライトとセメンタイトの層状組織（パーライト）に変態")
print(f"  パーライト中のセメンタイト割合: 約{W_cementite*100:.1f}%")
</code></pre>
        </details>

        <h3>Exercise 4.3 (Medium): Ellingham図の応用</h3>
        <p><strong>問題:</strong> 1200 Kで鉄鉱石（Fe₂O₃）を炭素で還元する反応の自発性を、Ellingham図の知識を用いて判定してください。Fe₂O₃の酸化反応とCOの酸化反応のΔG°を比較してください。</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 4.3 解答
T = 1200  # K

# 反応式（O2 1 molあたりに規格化）
# (2/3)Fe2O3 → (4/3)Fe + O2 の逆反応: (4/3)Fe + O2 → (2/3)Fe2O3
# 簡略化: 2Fe + O2 → 2FeO として ΔG° = -520 + 0.13*T (kJ/mol O2)
delta_G_Fe = -520 + 0.13 * T

# 2C + O2 → 2CO として ΔG° = -220 + 0.18*T (kJ/mol O2)
delta_G_CO = -220 + 0.18 * T

print("Exercise 4.3 解答:")
print(f"温度: {T} K ({T-273.15:.0f}°C)\n")

print("反応1: 2Fe + O₂ → 2FeO（鉄の酸化）")
print(f"  ΔG° = {delta_G_Fe:.1f} kJ/mol O₂")

print("\n反応2: 2C + O₂ → 2CO（炭素の酸化）")
print(f"  ΔG° = {delta_G_CO:.1f} kJ/mol O₂")

# 還元反応: Fe2O3 + 3CO → 2Fe + 3CO2
# これは反応1の逆と反応2の組み合わせ
# ΔG_reduction = -ΔG_Fe + ΔG_CO系
delta_G_reduction = delta_G_CO - delta_G_Fe

print(f"\n還元反応: Fe₂O₃ + 3C → 2Fe + 3CO")
print(f"  ΔG ≈ {delta_G_reduction:.1f} kJ/mol")
print(f"  判定: {'自発的（ΔG < 0）' if delta_G_reduction < 0 else '非自発的（ΔG > 0）'}")

if delta_G_reduction < 0:
    print("\n結論: 1200 KではCO線がFe線より下に位置")
    print("        → 炭素による鉄鉱石の還元が熱力学的に可能")
</code></pre>
        </details>

        <h3>Exercise 4.4 (Hard): 相図とてこの法則の統合問題</h3>
        <p><strong>問題:</strong> Cu-Ni合金（60 wt% Ni）を1300°Cから冷却します。1250°Cで液相線と固相線の組成がそれぞれ55 wt% Niと65 wt% Niの場合、この温度での液相と固相の重量分率を求めてください。さらに、最初に晶出する固相の組成を推定してください。</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 4.4 解答

# 1250°Cでの条件
X0 = 60  # wt% Ni (全体組成)
X_liquid_1250 = 55  # wt% Ni (液相線)
X_solid_1250 = 65  # wt% Ni (固相線)

W_liquid, W_solid = lever_rule(X0, X_liquid_1250, X_solid_1250)

print("Exercise 4.4 解答:\n")
print("条件: Cu-Ni合金（60 wt% Ni）を1250°Cで冷却中")
print(f"全体組成: {X0} wt% Ni")
print(f"液相組成: {X_liquid_1250} wt% Ni")
print(f"固相組成: {X_solid_1250} wt% Ni")

print(f"\nてこの法則:")
print(f"液相（L）: {W_liquid*100:.1f}%")
print(f"固相（α）: {W_solid*100:.1f}%")

# 最初に晶出する固相の組成
# 液相線に達した温度で、てこの法則で固相量→0
# その時の固相組成が最初の晶出相
print(f"\n最初に晶出する固相の組成:")
print(f"  液相線温度で固相量→0のとき、固相組成は固相線上")
print(f"  Cu-Ni系では分配係数 k = C_solid / C_liquid > 1")
print(f"  → 最初に晶出する固相はNiリッチ（約65-70 wt% Ni）")

# 凝固過程のシミュレーション
print("\n凝固過程:")
print("  1300°C（液相のみ）→ 液相線到達 → 固相晶出開始")
print("  → 固相組成は常に液相よりNiリッチ")
print("  → 最後に凝固する液相はCuリッチ")
</code></pre>
        </details>

        <h2>4.6 参考文献</h2>

        <ol>
            <li>DeHoff, R.T. (2006). <em>Thermodynamics in Materials Science</em>, 2nd ed. CRC Press, pp. 1-50, 201-265.</li>
            <li>Gaskell, D.R., Laughlin, D.E. (2017). <em>Introduction to the Thermodynamics of Materials</em>, 6th ed. CRC Press, pp. 89-145, 321-378.</li>
            <li>Callister, W.D., Jr., Rethwisch, D.G. (2020). <em>Materials Science and Engineering: An Introduction</em>, 10th ed. Wiley, pp. 267-325.</li>
            <li>Porter, D.A., Easterling, K.E., Sherif, M.Y. (2009). <em>Phase Transformations in Metals and Alloys</em>, 3rd ed. CRC Press, pp. 1-78.</li>
            <li>Ellingham, H.J.T. (1944). "Reducibility of Oxides and Sulphides in Metallurgical Processes." <em>Journal of the Society of Chemical Industry</em>, 63, 125-133.</li>
        </ol>

        <h2>4.7 学習目標の確認</h2>

        <p>以下の各項目について、自己評価してください（理解度: 1-基本理解、2-実践スキル、3-応用力）：</p>

        <table>
            <thead>
                <tr>
                    <th>学習目標</th>
                    <th>レベル1<br>（基本理解）</th>
                    <th>レベル2<br>（実践スキル）</th>
                    <th>レベル3<br>（応用力）</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Gibbs自由エネルギー</td>
                    <td>ΔGと自発性の関係を説明できる</td>
                    <td>PythonでΔGを計算し反応の進行を予測できる</td>
                    <td>複雑な多段階反応の熱力学を解析できる</td>
                </tr>
                <tr>
                    <td>化学ポテンシャル</td>
                    <td>化学ポテンシャルの定義を理解している</td>
                    <td>多成分系の平衡条件を計算できる</td>
                    <td>活量を用いた実在系の解析ができる</td>
                </tr>
                <tr>
                    <td>相図</td>
                    <td>二元系相図の基本的な読み方を理解している</td>
                    <td>てこの法則で相量を計算できる</td>
                    <td>三元系相図や複雑な相変態を解析できる</td>
                </tr>
                <tr>
                    <td>Ellingham図</td>
                    <td>Ellingham図の基本原理を理解している</td>
                    <td>金属の還元可能性を判定できる</td>
                    <td>精錬プロセスの最適条件を設計できる</td>
                </tr>
                <tr>
                    <td>相転移</td>
                    <td>一次・二次相転移の違いを説明できる</td>
                    <td>Clausius-Clapeyron式を用いて計算できる</td>
                    <td>相転移速度論と組み合わせて解析できる</td>
                </tr>
            </tbody>
        </table>

        <div class="tip">
            <strong>次のステップ:</strong> Chapter 5では、本章で学んだ熱力学の理論をPythonで実装し、実際の材料系の電子構造計算やデータ解析に応用します。理論と計算を統合して材料設計の実践力を高めましょう。
        </div>

        <div class="nav-buttons">
            <a href="chapter-3.html">← Chapter 3: 結晶場理論</a>
            <a href="chapter-5.html">Chapter 5: Python実践 →</a>
        </div>
    </div>
</body>
</html>