<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 3: 結晶場理論と配位化学 - 材料化学入門</title>
    <meta name="description" content="結晶場理論、配位子場理論、Jahn-Teller効果、d軌道分裂と遷移金属錯体の色・磁性について学びます。">

    <!-- MathJax for equations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.8;
            color: #2c3e50;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 3px solid #f093fb;
        }

        h2 {
            color: #34495e;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            padding-left: 15px;
            border-left: 5px solid #f5576c;
        }

        h3 {
            color: #546e7a;
            font-size: 1.4em;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .equation {
            background: #f8f9fa;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            border-left: 4px solid #f093fb;
            overflow-x: auto;
        }

        pre[class*="language-"] {
            margin: 20px 0;
            border-radius: 5px;
            border: 1px solid #e0e0e0;
        }

        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .note {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .important {
            background: #f8d7da;
            border-left: 5px solid #dc3545;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .tip {
            background: #d1ecf1;
            border-left: 5px solid #17a2b8;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
        }

        th {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            font-weight: bold;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }

        .nav-buttons a {
            padding: 12px 24px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: transform 0.2s;
        }

        .nav-buttons a:hover {
            transform: translateY(-2px);
        }

        .mermaid {
            background: white;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Chapter 3: 結晶場理論と配位化学</h1>

        <p>本章では、遷移金属イオンの電子構造を理解する上で重要な<strong>結晶場理論（Crystal Field Theory, CFT）</strong>と<strong>配位子場理論（Ligand Field Theory, LFT）</strong>について学びます。d軌道の縮退が解ける仕組み、Jahn-Teller効果、そして遷移金属錯体の色や磁性の起源を理論的に理解します。</p>

        <h2>3.1 結晶場理論の基礎</h2>

        <h3>3.1.1 d軌道の縮退と結晶場分裂</h3>

        <p>自由な遷移金属イオンでは5つのd軌道（\(d_{xy}, d_{yz}, d_{zx}, d_{x^2-y^2}, d_{z^2}\)）はエネルギー的に縮退していますが、配位子が取り囲むと静電的な相互作用により縮退が解けます。</p>

        <div class="equation">
            <p><strong>八面体場でのd軌道分裂:</strong></p>
            \[
            \Delta_o = E(e_g) - E(t_{2g})
            \]
            <p>ここで、\(\Delta_o\)は結晶場分裂エネルギー（octahedral splitting）、\(e_g\)軌道（\(d_{x^2-y^2}, d_{z^2}\)）は配位子方向を向くため高エネルギー、\(t_{2g}\)軌道（\(d_{xy}, d_{yz}, d_{zx}\)）は配位子間を向くため低エネルギーとなります。</p>
        </div>

        <div class="equation">
            <p><strong>四面体場でのd軌道分裂:</strong></p>
            \[
            \Delta_t = E(e) - E(t_2) = \frac{4}{9}\Delta_o
            \]
            <p>四面体場では八面体場と逆の順序で分裂し、分裂エネルギーは約4/9倍となります。</p>
        </div>

        <div class="note">
            <strong>Note:</strong> 結晶場理論は配位子を点電荷として扱う古典的な静電モデルですが、d軌道分裂の定性的理解には有効です。より正確には、配位子場理論や分子軌道理論による記述が必要です。
        </div>

        <h3>3.1.2 Pythonによる結晶場分裂エネルギー計算</h3>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def octahedral_splitting(delta_o):
    """
    八面体場でのd軌道エネルギーレベルを計算

    Parameters:
    -----------
    delta_o : float
        結晶場分裂エネルギー (cm^-1 or eV)

    Returns:
    --------
    energies : dict
        各軌道のエネルギー
    """
    # 重心が元のエネルギー（基準0）を保つように配置
    e_t2g = -2 * delta_o / 5  # 3つの軌道
    e_eg = 3 * delta_o / 5    # 2つの軌道

    energies = {
        't2g': e_t2g,  # dxy, dyz, dzx
        'eg': e_eg     # dx2-y2, dz2
    }

    return energies

def tetrahedral_splitting(delta_t):
    """
    四面体場でのd軌道エネルギーレベルを計算

    Parameters:
    -----------
    delta_t : float
        結晶場分裂エネルギー (delta_t = 4/9 * delta_o)

    Returns:
    --------
    energies : dict
        各軌道のエネルギー
    """
    # 四面体では分裂の順序が逆
    e_t2 = -3 * delta_t / 5   # 3つの軌道
    e_e = 2 * delta_t / 5      # 2つの軌道

    energies = {
        't2': e_t2,  # 四面体のt2軌道
        'e': e_e     # 四面体のe軌道
    }

    return energies

# 八面体錯体の例: [Co(NH3)6]3+ (delta_o ≈ 22,900 cm^-1)
delta_o = 22900  # cm^-1
oct_energies = octahedral_splitting(delta_o)

print("八面体場の結晶場分裂:")
print(f"  t2g軌道エネルギー: {oct_energies['t2g']:.1f} cm^-1")
print(f"  eg軌道エネルギー: {oct_energies['eg']:.1f} cm^-1")
print(f"  分裂エネルギー Δo: {delta_o} cm^-1")

# 四面体錯体の例: [CoCl4]2- (delta_t ≈ 3,300 cm^-1)
delta_t = 3300  # cm^-1
tet_energies = tetrahedral_splitting(delta_t)

print("\n四面体場の結晶場分裂:")
print(f"  t2軌道エネルギー: {tet_energies['t2']:.1f} cm^-1")
print(f"  e軌道エネルギー: {tet_energies['e']:.1f} cm^-1")
print(f"  分裂エネルギー Δt: {delta_t} cm^-1")
print(f"  Δt/Δo比: {delta_t / delta_o:.3f} (理論値: 4/9 = 0.444)")

# 可視化
fig, axes = plt.subplots(1, 2, figsize=(12, 5))

# 八面体場
ax1 = axes[0]
ax1.hlines(0, 0, 1, colors='gray', linestyles='dashed', label='Free ion')
ax1.hlines(oct_energies['t2g'], 1.5, 2.5, colors='blue', linewidth=3, label='t2g (3)')
ax1.hlines(oct_energies['eg'], 1.5, 2.5, colors='red', linewidth=3, label='eg (2)')
ax1.set_xlim(-0.5, 3)
ax1.set_ylabel('Energy (cm$^{-1}$)', fontsize=12)
ax1.set_title('Octahedral Splitting', fontsize=14, fontweight='bold')
ax1.legend()
ax1.set_xticks([0.5, 2])
ax1.set_xticklabels(['Free ion', 'Oh field'])
ax1.grid(True, alpha=0.3)

# 四面体場
ax2 = axes[1]
ax2.hlines(0, 0, 1, colors='gray', linestyles='dashed', label='Free ion')
ax2.hlines(tet_energies['t2'], 1.5, 2.5, colors='blue', linewidth=3, label='t2 (3)')
ax2.hlines(tet_energies['e'], 1.5, 2.5, colors='red', linewidth=3, label='e (2)')
ax2.set_xlim(-0.5, 3)
ax2.set_ylabel('Energy (cm$^{-1}$)', fontsize=12)
ax2.set_title('Tetrahedral Splitting', fontsize=14, fontweight='bold')
ax2.legend()
ax2.set_xticks([0.5, 2])
ax2.set_xticklabels(['Free ion', 'Td field'])
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('crystal_field_splitting.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>

        <h2>3.2 スペクトル化学系列と配位子場強度</h2>

        <h3>3.2.1 配位子場強度の序列</h3>

        <p>配位子の種類によって結晶場分裂エネルギー\(\Delta\)は大きく変化します。実験的に得られた<strong>スペクトル化学系列（Spectrochemical Series）</strong>は以下の通りです：</p>

        <div class="equation">
            \[
            \text{I}^- < \text{Br}^- < \text{Cl}^- < \text{F}^- < \text{OH}^- < \text{H}_2\text{O} < \text{NH}_3 < \text{en} < \text{NO}_2^- < \text{CN}^- < \text{CO}
            \]
            <p>弱い場（small Δ） ← → 強い場（large Δ）</p>
        </div>

        <ul>
            <li><strong>弱い場配位子</strong>: ハロゲン化物イオン（I⁻, Br⁻, Cl⁻）→ 小さいΔ、高スピン錯体</li>
            <li><strong>中程度の場配位子</strong>: H₂O, NH₃ → 中間的Δ</li>
            <li><strong>強い場配位子</strong>: CN⁻, CO → 大きいΔ、低スピン錯体</li>
        </ul>

        <h3>3.2.2 高スピンと低スピンの決定</h3>

        <p>d⁴～d⁷の電子配置では、電子間反発エネルギー（スピン対形成エネルギー P）と結晶場分裂エネルギーΔの大小関係で高スピン・低スピンが決まります：</p>

        <div class="equation">
            <p><strong>高スピン錯体</strong>: Δ < P （弱い場配位子）</p>
            <p>例: [Fe(H₂O)₆]²⁺ (d⁶, 高スピン, S = 2)</p>

            <p><strong>低スピン錯体</strong>: Δ > P （強い場配位子）</p>
            <p>例: [Fe(CN)₆]⁴⁻ (d⁶, 低スピン, S = 0)</p>
        </div>

        <pre><code class="language-python">def determine_spin_state(d_electrons, delta, pairing_energy):
    """
    八面体錯体の高スピン/低スピン状態を決定

    Parameters:
    -----------
    d_electrons : int
        d電子数 (1-10)
    delta : float
        結晶場分裂エネルギー
    pairing_energy : float
        スピン対形成エネルギー

    Returns:
    --------
    spin_state : str
        'high-spin' or 'low-spin'
    unpaired_electrons : int
        不対電子数
    """
    # d4-d7で高スピン/低スピンの違いが生じる
    if d_electrons < 4 or d_electrons > 7:
        # d1-d3, d8-d10は一意
        spin_state = 'N/A'
        if d_electrons <= 3:
            unpaired_electrons = d_electrons
        elif d_electrons == 8:
            unpaired_electrons = 2
        elif d_electrons == 9:
            unpaired_electrons = 1
        elif d_electrons == 10:
            unpaired_electrons = 0
    else:
        if delta < pairing_energy:
            # 高スピン
            spin_state = 'high-spin'
            if d_electrons == 4:
                unpaired_electrons = 4
            elif d_electrons == 5:
                unpaired_electrons = 5
            elif d_electrons == 6:
                unpaired_electrons = 4
            elif d_electrons == 7:
                unpaired_electrons = 3
        else:
            # 低スピン
            spin_state = 'low-spin'
            if d_electrons == 4:
                unpaired_electrons = 2
            elif d_electrons == 5:
                unpaired_electrons = 1
            elif d_electrons == 6:
                unpaired_electrons = 0
            elif d_electrons == 7:
                unpaired_electrons = 1

    return spin_state, unpaired_electrons

# 例1: [Fe(H2O)6]2+ (d6, 弱い場)
d6_weak = determine_spin_state(6, delta=10000, pairing_energy=15000)
print(f"[Fe(H2O)6]2+: {d6_weak[0]}, 不対電子数 = {d6_weak[1]}")

# 例2: [Fe(CN)6]4- (d6, 強い場)
d6_strong = determine_spin_state(6, delta=35000, pairing_energy=15000)
print(f"[Fe(CN)6]4-: {d6_strong[0]}, 不対電子数 = {d6_strong[1]}")

# 例3: [Co(NH3)6]3+ (d6, 中程度の場)
d6_medium = determine_spin_state(6, delta=22900, pairing_energy=15000)
print(f"[Co(NH3)6]3+: {d6_medium[0]}, 不対電子数 = {d6_medium[1]}")
</code></pre>

        <h2>3.3 Jahn-Teller効果</h2>

        <h3>3.3.1 Jahn-Teller定理</h3>

        <p><strong>Jahn-Teller定理</strong>: 縮退した電子状態を持つ非線形分子は、対称性を下げる方向に歪むことでエネルギー的に安定化します。</p>

        <div class="equation">
            <p>八面体錯体で顕著なのは、\(e_g\)軌道に不均等に電子が入る場合：</p>
            <ul>
                <li>d⁹配置（Cu²⁺）: \(e_g^3\) → 軸方向伸長または圧縮</li>
                <li>高スピンd⁴配置（Cr²⁺, Mn³⁺）: \(e_g^1\) → 軸方向伸長</li>
            </ul>
        </div>

        <div class="important">
            <strong>重要:</strong> Jahn-Teller効果は結晶構造や磁気的性質に大きな影響を与えます。例えば、Cu²⁺錯体の歪んだ八面体構造や、LaMnO₃のペロブスカイト構造での軌道整列現象に関係します。
        </div>

        <pre><code class="language-python">def jahn_teller_distortion(d_electrons, spin_state='high'):
    """
    八面体錯体のJahn-Teller歪みの有無を判定

    Parameters:
    -----------
    d_electrons : int
        d電子数
    spin_state : str
        'high' or 'low' (d4-d7の場合)

    Returns:
    --------
    distortion : str
        歪みの種類
    """
    # eg軌道の電子数を計算
    if d_electrons <= 3:
        eg_electrons = 0
    elif d_electrons <= 5:
        if spin_state == 'high':
            # t2g軌道が先に埋まる
            eg_electrons = max(0, d_electrons - 3)
        else:
            # t2g軌道が完全に埋まってからeg軌道へ
            eg_electrons = max(0, d_electrons - 6)
    elif d_electrons <= 8:
        if spin_state == 'high':
            eg_electrons = d_electrons - 5
        else:
            eg_electrons = max(0, d_electrons - 6)
    elif d_electrons == 9:
        eg_electrons = 3  # t2g^6 eg^3
    elif d_electrons == 10:
        eg_electrons = 4  # t2g^6 eg^4

    # Jahn-Teller効果の判定
    if eg_electrons in [1, 3]:
        distortion = f"Strong Jahn-Teller effect (eg^{eg_electrons}, asymmetric filling)"
    elif d_electrons in [1, 2] and spin_state == 'low':
        distortion = f"Weak Jahn-Teller effect (t2g^{d_electrons}, asymmetric filling)"
    else:
        distortion = "No Jahn-Teller effect (symmetric filling)"

    return distortion

# 代表例
examples = [
    (3, 'high', 'Cr3+'),
    (4, 'high', 'Cr2+ (high-spin)'),
    (4, 'low', 'Mn3+ (low-spin)'),
    (6, 'low', 'Fe2+ (low-spin)'),
    (9, 'high', 'Cu2+'),
]

print("Jahn-Teller効果の判定:\n")
for d, spin, ion in examples:
    distortion = jahn_teller_distortion(d, spin)
    print(f"{ion} (d{d}, {spin}-spin): {distortion}")
</code></pre>

        <h2>3.4 遷移金属錯体の色と磁性</h2>

        <h3>3.4.1 d-d遷移と可視光吸収</h3>

        <p>遷移金属錯体が色を持つのは、d軌道間の電子遷移（d-d遷移）が可視光領域のエネルギーに対応するためです。</p>

        <div class="equation">
            <p>吸収される光の波長λと結晶場分裂エネルギーΔの関係：</p>
            \[
            \Delta = \frac{hc}{\lambda}
            \]
            <p>例: [Ti(H₂O)₆]³⁺（d¹）は約500 nmの光を吸収（緑色）→ 補色の紫色に見える</p>
        </div>

        <pre><code class="language-python">def wavelength_to_color(wavelength_nm):
    """
    吸収波長から観測される色（補色）を推定

    Parameters:
    -----------
    wavelength_nm : float
        吸収波長 (nm)

    Returns:
    --------
    absorbed_color : str
        吸収される色
    observed_color : str
        観測される色（補色）
    """
    color_map = {
        (380, 450): ('Violet', 'Yellow-green'),
        (450, 495): ('Blue', 'Yellow'),
        (495, 570): ('Green', 'Red-violet'),
        (570, 590): ('Yellow', 'Violet'),
        (590, 620): ('Orange', 'Blue'),
        (620, 750): ('Red', 'Green'),
    }

    for (low, high), (absorbed, observed) in color_map.items():
        if low <= wavelength_nm < high:
            return absorbed, observed

    return 'Outside visible range', 'Colorless or IR/UV absorbing'

def delta_to_wavelength(delta_cm):
    """
    結晶場分裂エネルギーから吸収波長を計算

    Parameters:
    -----------
    delta_cm : float
        結晶場分裂エネルギー (cm^-1)

    Returns:
    --------
    wavelength_nm : float
        吸収波長 (nm)
    """
    # ΔE = hc/λ より λ = hc/ΔE
    # hc = 1.9864 × 10^-23 J·m (h = 6.626 × 10^-34 J·s, c = 2.998 × 10^8 m/s)
    # 1 cm^-1 = 1.9864 × 10^-23 J
    hc_value = 1.9864e-23  # J·m
    energy_joules = delta_cm * 100 * 6.626e-34 * 2.998e8  # cm^-1 to J
    # 簡易計算: lambda (nm) = 10^7 / wavenumber (cm^-1)
    wavelength_nm = 1e7 / delta_cm

    return wavelength_nm

# 例: 各遷移金属錯体の色
complexes = [
    ('[Ti(H2O)6]3+', 20300, 'd1'),
    ('[V(H2O)6]3+', 17500, 'd2'),
    ('[Cr(H2O)6]3+', 17400, 'd3'),
    ('[Co(H2O)6]2+', 8100, 'd7 high-spin'),
    ('[Cu(H2O)6]2+', 12600, 'd9'),
]

print("遷移金属錯体の色:\n")
for complex_name, delta, config in complexes:
    wavelength = delta_to_wavelength(delta)
    absorbed, observed = wavelength_to_color(wavelength)
    print(f"{complex_name} ({config}):")
    print(f"  Δ = {delta} cm^-1, λ = {wavelength:.1f} nm")
    print(f"  吸収色: {absorbed}, 観測色: {observed}\n")
</code></pre>

        <h3>3.4.2 磁気モーメントとスピンのみ近似</h3>

        <p>遷移金属錯体の磁気モーメント（磁化率測定）から電子配置や不対電子数を推定できます。</p>

        <div class="equation">
            <p><strong>スピンのみ磁気モーメント:</strong></p>
            \[
            \mu_{\text{spin}} = \sqrt{n(n+2)} \mu_B
            \]
            <p>ここで、\(n\)は不対電子数、\(\mu_B\)はBohr磁子（9.274 × 10⁻²⁴ J/T）</p>
        </div>

        <pre><code class="language-python">def magnetic_moment(unpaired_electrons):
    """
    スピンのみ磁気モーメントを計算

    Parameters:
    -----------
    unpaired_electrons : int
        不対電子数

    Returns:
    --------
    mu : float
        磁気モーメント (Bohr magneton)
    """
    n = unpaired_electrons
    mu = np.sqrt(n * (n + 2))
    return mu

# d1 - d10の磁気モーメント（八面体、高スピン）
print("不対電子数と磁気モーメント:\n")
for d in range(1, 11):
    if d <= 5:
        n = d  # 高スピン
    else:
        n = 10 - d  # 高スピン
    mu = magnetic_moment(n)
    print(f"d{d} (high-spin): n = {n}, μ = {mu:.2f} μB")

# 低スピンの例
print("\n低スピンの例:")
low_spin_cases = [
    (4, 2, 'd4 low-spin'),
    (5, 1, 'd5 low-spin'),
    (6, 0, 'd6 low-spin'),
    (7, 1, 'd7 low-spin'),
]

for d, n, label in low_spin_cases:
    mu = magnetic_moment(n)
    print(f"{label}: n = {n}, μ = {mu:.2f} μB")
</code></pre>

        <div class="mermaid">
        flowchart TD
            A[遷移金属イオン] --> B{配位子の種類}
            B -->|弱い場| C[小さいΔ]
            B -->|強い場| D[大きいΔ]
            C --> E[高スピン錯体]
            D --> F[低スピン錯体]
            E --> G[多くの不対電子]
            F --> H[少ない不対電子]
            G --> I[常磁性、大きい磁気モーメント]
            H --> J[常磁性または反磁性]

            style A fill:#f093fb
            style E fill:#ffcccc
            style F fill:#ccccff
            style I fill:#ffffcc
            style J fill:#ccffcc
        </flowchart>
        </div>

        <h2>3.5 演習問題</h2>

        <h3>Exercise 3.1 (Easy): 八面体錯体の結晶場分裂</h3>
        <p><strong>問題:</strong> [Cr(H₂O)₆]³⁺錯体の結晶場分裂エネルギーが17,400 cm⁻¹の場合、t₂ₐ軌道とeₐ軌道のエネルギー差（基準を0とした場合）を計算してください。</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 3.1 解答
delta_o = 17400  # cm^-1

# 八面体場での分裂
# t2g軌道: -2/5 * delta_o
# eg軌道: +3/5 * delta_o
# エネルギー差: delta_o

e_t2g = -2 * delta_o / 5
e_eg = 3 * delta_o / 5

print("Exercise 3.1 解答:")
print(f"Δo = {delta_o} cm^-1")
print(f"t2g軌道エネルギー: {e_t2g:.1f} cm^-1 (基準0)")
print(f"eg軌道エネルギー: {e_eg:.1f} cm^-1 (基準0)")
print(f"エネルギー差: {e_eg - e_t2g:.1f} cm^-1 = Δo")

# 検証: 3つのt2g軌道と2つのeg軌道のエネルギー総和は0（重心規則）
total_energy = 3 * e_t2g + 2 * e_eg
print(f"\n検証（重心規則）: 3×E(t2g) + 2×E(eg) = {total_energy:.2f} (理論値: 0)")
</code></pre>
        </details>

        <h3>Exercise 3.2 (Easy): 吸収波長と錯体の色</h3>
        <p><strong>問題:</strong> ある八面体錯体が550 nmの光を吸収します。この錯体の観測される色と結晶場分裂エネルギーを求めてください。</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 3.2 解答
wavelength_nm = 550

# 波長から結晶場分裂エネルギーを計算
delta_cm = 1e7 / wavelength_nm
print(f"Exercise 3.2 解答:")
print(f"吸収波長: {wavelength_nm} nm")
print(f"結晶場分裂エネルギー Δo: {delta_cm:.0f} cm^-1")

# 色の推定
absorbed, observed = wavelength_to_color(wavelength_nm)
print(f"吸収される色: {absorbed}")
print(f"観測される色: {observed}")

# エネルギー換算
energy_kJ = delta_cm * 0.01196  # cm^-1 to kJ/mol
print(f"エネルギー: {energy_kJ:.1f} kJ/mol")
</code></pre>
        </details>

        <h3>Exercise 3.3 (Medium): 高スピンと低スピンの判定</h3>
        <p><strong>問題:</strong> [Fe(H₂O)₆]²⁺と[Fe(CN)₆]⁴⁻はどちらもd⁶配置ですが、磁気モーメントはそれぞれ5.4 μBと0 μBです。それぞれの不対電子数とスピン状態を説明してください。</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 3.3 解答

def analyze_fe_complexes():
    """
    [Fe(H2O)6]2+ と [Fe(CN)6]4- の磁気的性質を解析
    """
    print("Exercise 3.3 解答:\n")

    # [Fe(H2O)6]2+ (弱い場配位子)
    mu_measured_1 = 5.4  # μB
    # μ = sqrt(n(n+2)) より n を逆算
    # 5.4^2 = n(n+2)
    # 29.16 = n^2 + 2n
    # n^2 + 2n - 29.16 = 0
    # n = (-2 + sqrt(4 + 116.64)) / 2 ≈ 4
    n1 = 4
    mu_calc_1 = magnetic_moment(n1)

    print("[Fe(H2O)6]2+ (d6, 弱い場):")
    print(f"  測定磁気モーメント: {mu_measured_1} μB")
    print(f"  推定不対電子数: {n1}")
    print(f"  計算磁気モーメント: {mu_calc_1:.2f} μB")
    print(f"  電子配置: t2g↑↑↑ eg↑↑ (高スピン)")
    print(f"  スピン状態: 高スピン (Δ < P)")

    # [Fe(CN)6]4- (強い場配位子)
    mu_measured_2 = 0  # μB
    n2 = 0
    mu_calc_2 = magnetic_moment(n2)

    print(f"\n[Fe(CN)6]4- (d6, 強い場):")
    print(f"  測定磁気モーメント: {mu_measured_2} μB")
    print(f"  推定不対電子数: {n2}")
    print(f"  計算磁気モーメント: {mu_calc_2:.2f} μB")
    print(f"  電子配置: t2g↑↓↑↓↑↓ eg (低スピン)")
    print(f"  スピン状態: 低スピン (Δ > P)")

    print("\n結論:")
    print("  H2Oは弱い場配位子 → 高スピン錯体（常磁性）")
    print("  CN-は強い場配位子 → 低スピン錯体（反磁性）")

analyze_fe_complexes()
</code></pre>
        </details>

        <h3>Exercise 3.4 (Medium): Jahn-Teller効果の判定</h3>
        <p><strong>問題:</strong> 以下の錯体でJahn-Teller効果が顕著に現れるものを選び、理由を説明してください：(a) [Ti(H₂O)₆]³⁺ (d¹)、(b) [Cu(H₂O)₆]²⁺ (d⁹)、(c) [Zn(H₂O)₆]²⁺ (d¹⁰)</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 3.4 解答

def analyze_jahn_teller():
    """
    各錯体のJahn-Teller効果を解析
    """
    complexes = [
        ('[Ti(H2O)6]3+', 1, 'high', 't2g^1'),
        ('[Cu(H2O)6]2+', 9, 'high', 't2g^6 eg^3'),
        ('[Zn(H2O)6]2+', 10, 'high', 't2g^6 eg^4'),
    ]

    print("Exercise 3.4 解答:\n")

    for complex_name, d, spin, config in complexes:
        distortion = jahn_teller_distortion(d, spin)
        print(f"{complex_name} (d{d}, 電子配置: {config}):")
        print(f"  {distortion}")

        if d == 1:
            print("  理由: t2g軌道に1電子のみ（非対称充填）→ 弱いJT効果")
        elif d == 9:
            print("  理由: eg軌道に3電子（非対称充填）→ 強いJT効果")
            print("  結果: 軸方向伸長（dx2-y2に2電子、dz2に1電子）")
            print("  実例: CuSO4·5H2Oの歪んだ八面体構造")
        elif d == 10:
            print("  理由: 全軌道が完全充填（対称）→ JT効果なし")

        print()

    print("結論: (b) [Cu(H2O)6]2+ (d9) で最も顕著なJahn-Teller効果")

analyze_jahn_teller()
</code></pre>
        </details>

        <h3>Exercise 3.5 (Hard): スペクトル化学系列の定量的予測</h3>
        <p><strong>問題:</strong> [Co(NH₃)₆]³⁺の結晶場分裂エネルギーが22,900 cm⁻¹、[Co(H₂O)₆]³⁺が18,200 cm⁻¹の場合、NH₃とH₂Oの相対的な配位子場強度の比を求めてください。さらに、[Co(NH₃)₄(H₂O)₂]³⁺の予想される分裂エネルギーを推定してください（配位子の寄与が加成的と仮定）。</p>

        <details>
            <summary>解答を表示</summary>
            <pre><code class="language-python"># Exercise 3.5 解答

def ligand_field_strength_analysis():
    """
    配位子場強度の定量的解析
    """
    print("Exercise 3.5 解答:\n")

    # 実験値
    delta_NH3_6 = 22900  # cm^-1, [Co(NH3)6]3+
    delta_H2O_6 = 18200  # cm^-1, [Co(H2O)6]3+

    # 相対的配位子場強度（1配位子あたり）
    strength_NH3 = delta_NH3_6 / 6
    strength_H2O = delta_H2O_6 / 6
    ratio = strength_NH3 / strength_H2O

    print("配位子場強度の比較:")
    print(f"[Co(NH3)6]3+: Δo = {delta_NH3_6} cm^-1")
    print(f"[Co(H2O)6]3+: Δo = {delta_H2O_6} cm^-1")
    print(f"\n1配位子あたりの寄与:")
    print(f"  NH3: {strength_NH3:.1f} cm^-1")
    print(f"  H2O: {strength_H2O:.1f} cm^-1")
    print(f"  NH3/H2O比: {ratio:.3f}")

    # [Co(NH3)4(H2O)2]3+ の推定
    # 仮定: 各配位子の寄与が独立に加算される
    delta_mixed = 4 * strength_NH3 + 2 * strength_H2O

    print(f"\n[Co(NH3)4(H2O)2]3+ の推定:")
    print(f"  Δo = 4×{strength_NH3:.1f} + 2×{strength_H2O:.1f}")
    print(f"  Δo ≈ {delta_mixed:.0f} cm^-1")

    # 実験値との比較（参考）
    # 実際の実験値は約21,600 cm^-1
    delta_experimental = 21600
    error = abs(delta_mixed - delta_experimental) / delta_experimental * 100
    print(f"  実験値: {delta_experimental} cm^-1")
    print(f"  誤差: {error:.1f}%")

    print("\n考察:")
    print("  NH3はH2Oより約1.26倍強い場配位子")
    print("  混合配位子錯体では、加成性が近似的に成立")
    print("  （実際には配位子間の相互作用や幾何学的効果も影響）")

ligand_field_strength_analysis()
</code></pre>
        </details>

        <h2>3.6 参考文献</h2>

        <ol>
            <li>Figgis, B.N., Hitchman, M.A. (2000). <em>Ligand Field Theory and Its Applications</em>. Wiley-VCH, pp. 1-50, 95-145.</li>
            <li>Cotton, F.A., Wilkinson, G., Murillo, C.A., Bochmann, M. (1999). <em>Advanced Inorganic Chemistry</em>, 6th ed. Wiley, pp. 619-685.</li>
            <li>Shriver, D.F., Atkins, P.W. (2010). <em>Inorganic Chemistry</em>, 5th ed. W.H. Freeman, pp. 453-498.</li>
            <li>Atkins, P., de Paula, J. (2010). <em>Physical Chemistry</em>, 9th ed. Oxford University Press, pp. 412-456.</li>
            <li>Orgel, L.E. (1966). <em>An Introduction to Transition-Metal Chemistry: Ligand-Field Theory</em>, 2nd ed. Methuen, pp. 35-78.</li>
            <li>Jahn, H.A., Teller, E. (1937). "Stability of Polyatomic Molecules in Degenerate Electronic States." <em>Proceedings of the Royal Society A</em>, 161, 220-235.</li>
        </ol>

        <h2>3.7 学習目標の確認</h2>

        <p>以下の各項目について、自己評価してください（理解度: 1-基本理解、2-実践スキル、3-応用力）：</p>

        <table>
            <thead>
                <tr>
                    <th>学習目標</th>
                    <th>レベル1<br>（基本理解）</th>
                    <th>レベル2<br>（実践スキル）</th>
                    <th>レベル3<br>（応用力）</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>結晶場理論の基礎</td>
                    <td>八面体場・四面体場でのd軌道分裂を説明できる</td>
                    <td>Pythonで結晶場分裂エネルギーを計算できる</td>
                    <td>配位子の種類と構造からΔを予測できる</td>
                </tr>
                <tr>
                    <td>スペクトル化学系列</td>
                    <td>配位子場強度の序列を理解している</td>
                    <td>高スピン/低スピン錯体を判定できる</td>
                    <td>混合配位子錯体の分裂エネルギーを推定できる</td>
                </tr>
                <tr>
                    <td>Jahn-Teller効果</td>
                    <td>Jahn-Teller定理の意味を説明できる</td>
                    <td>d電子配置からJT効果の有無を判定できる</td>
                    <td>Cu²⁺錯体の構造歪みを定量的に解析できる</td>
                </tr>
                <tr>
                    <td>錯体の色</td>
                    <td>d-d遷移と色の関係を理解している</td>
                    <td>吸収波長から錯体の色を予測できる</td>
                    <td>UV-Visスペクトルから電子配置を推定できる</td>
                </tr>
                <tr>
                    <td>磁気的性質</td>
                    <td>磁気モーメントの式を理解している</td>
                    <td>不対電子数から磁気モーメントを計算できる</td>
                    <td>磁化率測定から錯体の電子状態を決定できる</td>
                </tr>
            </tbody>
        </table>

        <div class="tip">
            <strong>次のステップ:</strong> Chapter 4では、結晶場理論で学んだエネルギー論を熱力学的な枠組みに拡張し、材料の相平衡と反応性を理解します。d軌道の電子配置が材料の安定性や反応性にどう影響するかを学びましょう。
        </div>

        <div class="nav-buttons">
            <a href="chapter-2.html">← Chapter 2: 分子軌道理論</a>
            <a href="chapter-4.html">Chapter 4: 熱力学と相平衡 →</a>
        </div>
    </div>
</body>
</html>