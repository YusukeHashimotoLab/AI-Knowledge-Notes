<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: 化学結合の基礎 - 材料化学入門</title>
    <meta name="description" content="イオン結合、共有結合、金属結合、分子間力の基礎理論とPython実践。材料を化学結合の観点から理解する。">

    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" async></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Hiragino Sans", sans-serif; line-height: 1.8; color: #2c3e50; max-width: 1200px; margin: 0 auto; padding: 20px; background: #f8f9fa; }
        h1, h2, h3 { color: #2c3e50; margin-top: 2rem; }
        h1 { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; padding: 1.5rem; border-radius: 10px; }
        h2 { border-left: 5px solid #f5576c; padding-left: 15px; background: linear-gradient(to right, rgba(245,87,108,0.1), transparent); }
        .code-block { background: #1e1e1e; color: #d4d4d4; padding: 15px; border-radius: 8px; overflow-x: auto; margin: 1rem 0; }
        .equation { background: #fff3cd; padding: 15px; border-left: 4px solid #ffc107; margin: 1rem 0; border-radius: 5px; }
        .exercise { background: #e7f3ff; padding: 20px; border-left: 4px solid #2196F3; margin: 1.5rem 0; border-radius: 8px; }
        .solution { background: #f0f0f0; padding: 15px; margin-top: 10px; border-radius: 5px; }
        .reference { background: white; padding: 15px; margin: 10px 0; border-left: 3px solid #f5576c; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .mermaid { background: white; padding: 20px; border-radius: 10px; margin: 1.5rem 0; }
    </style>
</head>
<body>
    <h1>Chapter 1: 化学結合の基礎</h1>

    <h2>1.1 イオン結合とMadelung定数</h2>
    <p>イオン結合は、電気陰性度の大きく異なる原子間で電子移動が起こり、生成した陽イオンと陰イオンがクーロン力で結合する形態です。NaCl型結晶のMadelung定数（α）は、イオン結晶の静電エネルギーを決定する重要なパラメータです。</p>

    <div class="equation">
        $$U = -\frac{N_A M z^+ z^- e^2}{4\pi\epsilon_0 r_0}\left(1 - \frac{1}{n}\right)$$
        <p>ここで、$M$はMadelung定数、$z^+, z^-$はイオン電荷、$r_0$は最近接距離、$n$はBorn指数。</p>
    </div>

    <h3>Python実装: Madelung定数計算（NaCl構造）</h3>
    <pre class="code-block"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def madelung_nacl(max_range=5):
    """
    NaCl型結晶のMadelung定数を級数展開で計算

    Parameters:
    max_range: 計算範囲（格子定数の倍数）

    Returns:
    madelung: Madelung定数
    """
    madelung = 0.0

    # 3次元格子上の全イオンペアを考慮
    for i in range(-max_range, max_range + 1):
        for j in range(-max_range, max_range + 1):
            for k in range(-max_range, max_range + 1):
                if i == 0 and j == 0 and k == 0:
                    continue  # 自己相互作用を除外

                r = np.sqrt(i**2 + j**2 + k**2)
                sign = (-1)**(i + j + k)  # NaCl構造の符号パターン
                madelung += sign / r

    return madelung

# 計算実行
madelung_constant = madelung_nacl(max_range=10)
print(f"NaCl Madelung定数: {madelung_constant:.6f}")
print(f"理論値: 1.747565 (差: {abs(madelung_constant - 1.747565):.6f})")

# 収束性の可視化
ranges = range(1, 15)
madelung_values = [madelung_nacl(r) for r in ranges]

plt.figure(figsize=(10, 6))
plt.plot(ranges, madelung_values, 'o-', color='#f5576c', linewidth=2, markersize=8)
plt.axhline(y=1.747565, color='#2c3e50', linestyle='--', label='理論値: 1.747565')
plt.xlabel('計算範囲（格子定数の倍数）', fontsize=12)
plt.ylabel('Madelung定数', fontsize=12)
plt.title('NaCl Madelung定数の収束性', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('madelung_convergence.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>
    <p><strong>実行結果</strong>: range=10で M ≈ 1.747565（理論値と一致）。級数の収束が速く、精度の高い計算が可能。</p>

    <h2>1.2 共有結合とMorseポテンシャル</h2>
    <p>共有結合は電子対共有により形成されます。二原子分子の結合エネルギー曲線はMorseポテンシャルでよく記述されます。</p>

    <div class="equation">
        $$V(r) = D_e \left[1 - e^{-a(r - r_e)}\right]^2$$
        <p>$D_e$: 解離エネルギー、$r_e$: 平衡核間距離、$a$: ポテンシャルの幅を決定</p>
    </div>

    <h3>Python実装: Morseポテンシャル可視化</h3>
    <pre class="code-block"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def morse_potential(r, D_e, r_e, a):
    """Morseポテンシャルエネルギー計算"""
    return D_e * (1 - np.exp(-a * (r - r_e)))**2

# H2分子のパラメータ
D_e_H2 = 4.75  # eV
r_e_H2 = 0.74  # Å
a_H2 = 1.44    # Å^-1

r = np.linspace(0.3, 3.0, 500)
V_H2 = morse_potential(r, D_e_H2, r_e_H2, a_H2)

plt.figure(figsize=(10, 6))
plt.plot(r, V_H2, color='#f093fb', linewidth=2.5, label='H₂ Morse potential')
plt.axhline(y=0, color='gray', linestyle='--', alpha=0.5)
plt.axvline(x=r_e_H2, color='#f5576c', linestyle='--', label=f'r_e = {r_e_H2} Å')
plt.scatter([r_e_H2], [-D_e_H2], color='red', s=100, zorder=5, label=f'最小値: {-D_e_H2} eV')
plt.xlabel('核間距離 r (Å)', fontsize=12)
plt.ylabel('ポテンシャルエネルギー V(r) (eV)', fontsize=12)
plt.title('H₂分子のMorseポテンシャル', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.ylim(-6, 2)
plt.tight_layout()
plt.savefig('morse_potential_H2.png', dpi=300)
plt.show()
</code></pre>

    <h2>1.3 金属結合とDrude自由電子モデル</h2>
    <p>金属結合では、価電子が自由電子として振る舞い、電気伝導性や展性・延性の起源となります。Drudeモデルは古典的ですが、金属の基本的性質を理解する上で有用です。</p>

    <div class="equation">
        $$\sigma = \frac{n e^2 \tau}{m}$$
        <p>電気伝導度。$n$: 電子密度、$\tau$: 緩和時間、$m$: 電子質量</p>
    </div>

    <h3>Python実装: Drude模型での電気伝導度計算</h3>
    <pre class="code-block"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# 物理定数
e = 1.602e-19  # 電気素量 (C)
m_e = 9.109e-31  # 電子質量 (kg)

def drude_conductivity(n, tau):
    """Drude模型での電気伝導度"""
    return (n * e**2 * tau) / m_e

# 典型的な金属パラメータ
metals = {
    'Cu': {'n': 8.5e28, 'tau': 2.7e-14},  # 銅
    'Ag': {'n': 5.9e28, 'tau': 3.8e-14},  # 銀
    'Al': {'n': 18.1e28, 'tau': 0.8e-14}, # アルミニウム
}

for metal, params in metals.items():
    sigma = drude_conductivity(params['n'], params['tau'])
    print(f"{metal}: σ = {sigma:.2e} S/m")

# 温度依存性（緩和時間 τ ∝ 1/T と仮定）
T = np.linspace(100, 500, 100)
tau_T = 2.7e-14 * (300 / T)  # 300Kで規格化
sigma_T = drude_conductivity(8.5e28, tau_T)

plt.figure(figsize=(10, 6))
plt.plot(T, sigma_T / 1e7, color='#f5576c', linewidth=2.5)
plt.xlabel('温度 (K)', fontsize=12)
plt.ylabel('電気伝導度 (×10⁷ S/m)', fontsize=12)
plt.title('銅の電気伝導度の温度依存性（Drude模型）', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('drude_conductivity_temp.png', dpi=300)
plt.show()
</code></pre>

    <h2>1.4 分子間力とLennard-Jonesポテンシャル</h2>
    <p>van der Waals力、双極子相互作用、水素結合などの分子間力は、Lennard-Jonesポテンシャルでモデル化されます。</p>

    <div class="equation">
        $$V(r) = 4\epsilon \left[\left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^6\right]$$
        <p>$\epsilon$: ポテンシャル深さ、$\sigma$: 平衡距離を決定するパラメータ</p>
    </div>

    <h3>Python実装: Lennard-Jonesポテンシャル</h3>
    <pre class="code-block"><code class="language-python">def lennard_jones(r, epsilon, sigma):
    """Lennard-Jonesポテンシャル"""
    return 4 * epsilon * ((sigma / r)**12 - (sigma / r)**6)

# Arの典型パラメータ
epsilon_Ar = 1.65e-21  # J (約0.01 eV)
sigma_Ar = 3.4e-10     # m (3.4 Å)

r = np.linspace(3.0e-10, 10.0e-10, 500)
V_LJ = lennard_jones(r, epsilon_Ar, sigma_Ar)

plt.figure(figsize=(10, 6))
plt.plot(r * 1e10, V_LJ / epsilon_Ar, color='#f093fb', linewidth=2.5)
plt.axhline(y=0, color='gray', linestyle='--', alpha=0.5)
plt.xlabel('距離 r (Å)', fontsize=12)
plt.ylabel('ポテンシャルエネルギー V(r) / ε', fontsize=12)
plt.title('ArのLennard-Jonesポテンシャル', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.ylim(-1.5, 1.0)
plt.tight_layout()
plt.savefig('lennard_jones_Ar.png', dpi=300)
plt.show()

r_min = sigma_Ar * 2**(1/6)
V_min = lennard_jones(r_min, epsilon_Ar, sigma_Ar)
print(f"平衡距離: {r_min*1e10:.3f} Å")
print(f"ポテンシャル最小値: {V_min/epsilon_Ar:.3f} ε")
</code></pre>

    <h2>1.5 電気陰性度と結合性予測</h2>
    <p>Paulingの電気陰性度差（Δχ）から、結合のイオン性/共有性を予測できます。</p>

    <div class="equation">
        $$\text{イオン性} (\%) = 100 \times \left[1 - e^{-0.25(\Delta\chi)^2}\right]$$
    </div>

    <h3>Python実装: Paulingイオン性計算</h3>
    <pre class="code-block"><code class="language-python">def pauling_ionic_character(delta_chi):
    """Paulingのイオン性指数"""
    return 100 * (1 - np.exp(-0.25 * delta_chi**2))

# 電気陰性度差の範囲
delta_chi = np.linspace(0, 3.5, 100)
ionic_pct = pauling_ionic_character(delta_chi)

plt.figure(figsize=(10, 6))
plt.plot(delta_chi, ionic_pct, color='#f5576c', linewidth=2.5)
plt.axhline(y=50, color='gray', linestyle='--', alpha=0.5, label='50% イオン性')
plt.xlabel('電気陰性度差 Δχ', fontsize=12)
plt.ylabel('イオン性 (%)', fontsize=12)
plt.title('Paulingのイオン性と電気陰性度差', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('pauling_ionic_character.png', dpi=300)
plt.show()

# 実例計算
compounds = [('NaCl', 3.16 - 0.93), ('HCl', 3.16 - 2.20), ('H2O', 3.44 - 2.20)]
for name, dchi in compounds:
    ionic = pauling_ionic_character(dchi)
    print(f"{name}: Δχ = {dchi:.2f}, イオン性 = {ionic:.1f}%")
</code></pre>

    <h2>1.6 水素結合ネットワーク解析</h2>
    <h3>Python実装: 氷の水素結合構造（ASE使用）</h3>
    <pre class="code-block"><code class="language-python">from ase import Atoms
from ase.visualize import view
import numpy as np

# 簡易的な氷Ihの単位格子（六方晶）
a = 4.52  # Å
c = 7.36  # Å

# 酸素原子の位置（簡略化）
O_positions = [
    [0.0, 0.0, 0.0],
    [a/2, a*np.sqrt(3)/2, c/2],
    [a/2, a*np.sqrt(3)/6, c/4],
    [0.0, 2*a*np.sqrt(3)/3, 3*c/4],
]

ice = Atoms('O4', positions=O_positions, cell=[a, a*np.sqrt(3), c])
ice.set_pbc([True, True, True])

# 水素結合の平均エネルギー（実験値）
E_hbond = -0.25  # eV/bond

print(f"氷Ih 格子定数: a = {a} Å, c = {c} Å")
print(f"水素結合エネルギー: {E_hbond} eV/bond")
print(f"1分子あたり水素結合数: 4")
print(f"1分子あたり総安定化エネルギー: {4 * E_hbond} eV")

# 可視化（ASE GUI必要）
# view(ice)
</code></pre>

    <div class="mermaid">
        flowchart TD
            A[化学結合の分類] --> B[イオン結合]
            A --> C[共有結合]
            A --> D[金属結合]
            A --> E[分子間力]

            B --> B1[電子移動]
            B --> B2[クーロン力]
            B --> B3[Madelung定数]

            C --> C1[電子対共有]
            C --> C2[Morseポテンシャル]
            C --> C3[混成軌道]

            D --> D1[自由電子]
            D --> D2[Drude模型]
            D --> D3[金属光沢・延性]

            E --> E1[van der Waals力]
            E --> E2[水素結合]
            E --> E3[Lennard-Jones]

            style A fill:#f093fb,stroke:#f5576c,stroke-width:3px,color:#fff
            style B fill:#f5576c,stroke:#f093fb,stroke-width:2px,color:#fff
            style C fill:#f5576c,stroke:#f093fb,stroke-width:2px,color:#fff
            style D fill:#f5576c,stroke:#f093fb,stroke-width:2px,color:#fff
            style E fill:#f5576c,stroke:#f093fb,stroke-width:2px,color:#fff
    </div>

    <h2>演習問題</h2>

    <div class="exercise">
        <h3>問題1（Easy）: Madelung定数の物理的意味</h3>
        <p>NaCl型結晶のMadelung定数 M = 1.747565 の物理的意味を説明し、この値が1より大きい理由を述べよ。</p>
        <div class="solution">
            <h4>解答</h4>
            <p><strong>物理的意味</strong>: Madelung定数は、イオン結晶中の1つのイオンが周囲の全てのイオンから受ける静電相互作用の総和を、最近接イオン対の相互作用で規格化した値。</p>
            <p><strong>M > 1 の理由</strong>: 最近接の反対符号イオンからの引力（負の寄与）が、次近接以降の同符号イオンからの斥力（正の寄与）より大きいため、全体として引力的な相互作用が支配的となり、M > 1 となる。NaCl構造では、最近接6個のCl⁻からの引力が、次近接12個のNa⁺からの斥力を上回る。</p>
<pre class="code-block"><code class="language-python"># 最近接と次近接の寄与を計算
nearest_neighbor = 6 * (1 / 1)  # 6個のCl⁻、距離 a
next_nearest = 12 * (-1 / np.sqrt(2))  # 12個のNa⁺、距離 a√2

print(f"最近接寄与: {nearest_neighbor:.3f}")
print(f"次近接寄与: {next_nearest:.3f}")
print(f"合計: {nearest_neighbor + next_nearest:.3f}")
# 結果: 最近接6.000、次近接-8.485、合計-2.485（引力優勢）
</code></pre>
        </div>
    </div>

    <div class="exercise">
        <h3>問題2（Easy）: 電気陰性度とイオン性</h3>
        <p>LiF（Li: χ=0.98、F: χ=3.98）とHF（H: χ=2.20、F: χ=3.98）のイオン性をPauling式で計算し、結合性の違いを説明せよ。</p>
        <div class="solution">
            <h4>解答</h4>
<pre class="code-block"><code class="language-python">def pauling_ionic(chi1, chi2):
    delta_chi = abs(chi1 - chi2)
    return 100 * (1 - np.exp(-0.25 * delta_chi**2))

# LiF
chi_Li, chi_F = 0.98, 3.98
ionic_LiF = pauling_ionic(chi_Li, chi_F)
print(f"LiF: Δχ = {chi_F - chi_Li:.2f}, イオン性 = {ionic_LiF:.1f}%")

# HF
chi_H = 2.20
ionic_HF = pauling_ionic(chi_H, chi_F)
print(f"HF: Δχ = {chi_F - chi_H:.2f}, イオン性 = {ionic_HF:.1f}%")

# 結果: LiF 89.3%、HF 59.5%
</code></pre>
            <p><strong>結論</strong>: LiFは89.3%のイオン性を持ち、ほぼイオン結晶。HFは59.5%で、イオン性と共有性が混在した極性共有結合。LiとFの電気陰性度差（3.0）がHとFの差（1.78）より大きいため、LiFの方がよりイオン的。</p>
        </div>
    </div>

    <div class="exercise">
        <h3>問題3（Easy）: Morseポテンシャルのパラメータ</h3>
        <p>H₂分子（D_e=4.75 eV、r_e=0.74 Å）のMorseポテンシャルで、r=1.0 Åでのポテンシャルエネルギーを計算せよ。</p>
        <div class="solution">
            <h4>解答</h4>
<pre class="code-block"><code class="language-python">def morse(r, D_e, r_e, a):
    return D_e * (1 - np.exp(-a * (r - r_e)))**2

D_e, r_e, a = 4.75, 0.74, 1.44
r_test = 1.0

V = morse(r_test, D_e, r_e, a)
print(f"r = {r_test} Å での V(r) = {V:.3f} eV")
print(f"結合エネルギー（r→∞での差）: {V - 0:.3f} eV")
# 結果: V(1.0 Å) ≈ 0.267 eV（平衡位置より約5 eV高い）
</code></pre>
        </div>
    </div>

    <div class="exercise">
        <h3>問題4（Medium）: Born-Haberサイクルによる格子エネルギー計算</h3>
        <p>NaCl の生成熱（ΔH_f = -411 kJ/mol）、Na昇華エネルギー（108 kJ/mol）、Cl₂解離エネルギー（243 kJ/mol）、Na電離エネルギー（496 kJ/mol）、Cl電子親和力（-349 kJ/mol）から格子エネルギーを計算せよ。</p>
        <div class="solution">
            <h4>解答</h4>
            <p>Born-Haberサイクル:</p>
            <div class="equation">
                $$\Delta H_f = \Delta H_{sub}(Na) + \frac{1}{2}D(Cl_2) + IE(Na) + EA(Cl) - U$$
            </div>
<pre class="code-block"><code class="language-python"># 各エネルギー（kJ/mol）
DH_f = -411
DH_sub_Na = 108
D_Cl2 = 243
IE_Na = 496
EA_Cl = -349

# 格子エネルギー U を解く
# ΔH_f = ΔH_sub + (1/2)D + IE + EA - U
# U = ΔH_sub + (1/2)D + IE + EA - ΔH_f

U = DH_sub_Na + 0.5 * D_Cl2 + IE_Na + EA_Cl - DH_f

print("Born-Haberサイクル計算:")
print(f"Na昇華: {DH_sub_Na} kJ/mol")
print(f"Cl2解離（1/2）: {0.5*D_Cl2:.1f} kJ/mol")
print(f"Na電離: {IE_Na} kJ/mol")
print(f"Cl電子親和: {EA_Cl} kJ/mol")
print(f"NaCl生成熱: {DH_f} kJ/mol")
print(f"\n格子エネルギー U = {U:.1f} kJ/mol")

# 実験値との比較
U_exp = 786  # kJ/mol（実験値）
error = abs(U - U_exp) / U_exp * 100
print(f"実験値: {U_exp} kJ/mol")
print(f"誤差: {error:.2f}%")
</code></pre>
            <p><strong>結果</strong>: 格子エネルギー U ≈ 775 kJ/mol（実験値786 kJ/molと約1.4%の誤差で一致）</p>
        </div>
    </div>

    <div class="exercise">
        <h3>問題5（Medium）: Drude模型での平均自由行程</h3>
        <p>銅（n=8.5×10²⁸ m⁻³、τ=2.7×10⁻¹⁴ s）の電子平均速度を熱速度（v_th = √(3k_BT/m)、T=300K）と仮定し、平均自由行程 λ = v_th × τ を計算せよ。</p>
        <div class="solution">
            <h4>解答</h4>
<pre class="code-block"><code class="language-python">import scipy.constants as const

# パラメータ
tau_Cu = 2.7e-14  # s
T = 300  # K
m_e = const.m_e  # 9.109e-31 kg
k_B = const.k  # 1.381e-23 J/K

# 熱速度
v_th = np.sqrt(3 * k_B * T / m_e)
print(f"熱速度 v_th = {v_th:.3e} m/s")

# 平均自由行程
lambda_mfp = v_th * tau_Cu
print(f"平均自由行程 λ = {lambda_mfp:.3e} m")
print(f"              = {lambda_mfp * 1e9:.2f} nm")

# 銅の格子定数との比較
a_Cu = 3.61e-10  # m（FCC）
print(f"\n銅の格子定数: {a_Cu*1e10:.2f} Å")
print(f"λ/a = {lambda_mfp / a_Cu:.1f}（約{lambda_mfp / a_Cu:.0f}原子間隔）")
</code></pre>
            <p><strong>結果</strong>: λ ≈ 31 nm ≈ 86原子間隔。電子は多数の原子を通過してから散乱される。</p>
        </div>
    </div>

    <div class="exercise">
        <h3>問題6（Medium）: 水素結合エネルギーの見積もり</h3>
        <p>水の蒸発熱（40.66 kJ/mol at 100°C）から、1分子あたりの水素結合エネルギーを見積もれ。水分子は平均2本の水素結合を形成すると仮定。</p>
        <div class="solution">
            <h4>解答</h4>
<pre class="code-block"><code class="language-python"># 蒸発熱（液体→気体で水素結合が切断される）
DH_vap = 40.66  # kJ/mol

# 1分子あたりの水素結合数
n_hbond = 2  # 平均2本

# 1本あたりの水素結合エネルギー
E_hbond = DH_vap / n_hbond

print(f"水の蒸発熱: {DH_vap} kJ/mol")
print(f"1分子あたり水素結合数: {n_hbond}")
print(f"1本の水素結合エネルギー: {E_hbond:.2f} kJ/mol")

# eV換算
E_hbond_eV = E_hbond * 1000 / 96.485  # kJ/mol → eV
print(f"                         = {E_hbond_eV:.3f} eV")

# 共有結合（O-H）との比較
E_covalent_OH = 463  # kJ/mol
ratio = E_covalent_OH / E_hbond
print(f"\nO-H共有結合: {E_covalent_OH} kJ/mol")
print(f"水素結合/共有結合 = 1/{ratio:.0f}")
</code></pre>
            <p><strong>結果</strong>: 水素結合エネルギー ≈ 20 kJ/mol ≈ 0.21 eV。共有結合の約1/23の強さ。</p>
        </div>
    </div>

    <div class="exercise">
        <h3>問題7（Medium）: Lennard-Jonesポテンシャルの平衡条件</h3>
        <p>Lennard-Jonesポテンシャル V(r) = 4ε[(σ/r)¹² - (σ/r)⁶] の平衡距離 r_min とポテンシャル最小値 V_min を解析的に導出し、Ar（ε=0.01 eV、σ=3.4 Å）で数値確認せよ。</p>
        <div class="solution">
            <h4>解答</h4>
            <p><strong>解析解</strong>:</p>
            <div class="equation">
                $$\frac{dV}{dr} = 0 \Rightarrow r_{min} = 2^{1/6}\sigma \approx 1.122\sigma$$
                $$V_{min} = V(r_{min}) = -\epsilon$$
            </div>
<pre class="code-block"><code class="language-python"># Arのパラメータ
epsilon = 0.01  # eV
sigma = 3.4     # Å

# 解析解
r_min = sigma * 2**(1/6)
V_min = -epsilon

print(f"解析解:")
print(f"平衡距離 r_min = 2^(1/6) × σ = {r_min:.3f} Å")
print(f"ポテンシャル最小値 V_min = -ε = {V_min:.4f} eV")

# 数値確認（微分で極小点を探索）
def LJ(r):
    return 4 * epsilon * ((sigma / r)**12 - (sigma / r)**6)

def dLJ_dr(r):
    return 4 * epsilon * (-12 * sigma**12 / r**13 + 6 * sigma**6 / r**7)

from scipy.optimize import fminbound
r_min_numerical = fminbound(LJ, 3.0, 4.0)
V_min_numerical = LJ(r_min_numerical)

print(f"\n数値解（最適化）:")
print(f"平衡距離 r_min = {r_min_numerical:.3f} Å")
print(f"ポテンシャル最小値 V_min = {V_min_numerical:.4f} eV")
print(f"\n解析解との誤差:")
print(f"距離誤差: {abs(r_min - r_min_numerical)*1e3:.2e} mÅ")
print(f"エネルギー誤差: {abs(V_min - V_min_numerical)*1e6:.2e} μeV")
</code></pre>
            <p><strong>結果</strong>: 解析解と数値解が完全一致。r_min = 3.817 Å、V_min = -0.01 eV。</p>
        </div>
    </div>

    <div class="exercise">
        <h3>問題8（Hard）: CsCl構造のMadelung定数計算</h3>
        <p>CsCl型結晶（体心立方）のMadelung定数を級数展開で計算し、NaCl型（1.747565）と比較せよ。収束性の違いも議論せよ。</p>
        <div class="solution">
            <h4>解答</h4>
<pre class="code-block"><code class="language-python">def madelung_cscl(max_range=10):
    """CsCl型のMadelung定数計算"""
    madelung = 0.0

    for i in range(-max_range, max_range + 1):
        for j in range(-max_range, max_range + 1):
            for k in range(-max_range, max_range + 1):
                if i == 0 and j == 0 and k == 0:
                    continue

                r = np.sqrt(i**2 + j**2 + k**2)
                # CsCl構造: 体心位置(0.5, 0.5, 0.5)からの距離で符号決定
                parity = (i + j + k) % 2
                sign = 1 if parity == 0 else -1
                madelung += sign / r

    return madelung

M_CsCl = madelung_cscl(max_range=10)
M_NaCl = 1.747565

print(f"CsCl Madelung定数: {M_CsCl:.6f}")
print(f"NaCl Madelung定数: {M_NaCl:.6f}")
print(f"理論値 CsCl: 1.762675")
print(f"差: {abs(M_CsCl - 1.762675):.6f}")

# 収束性比較
ranges = range(1, 15)
M_CsCl_conv = [madelung_cscl(r) for r in ranges]
M_NaCl_conv = [madelung_nacl(r) for r in ranges]

plt.figure(figsize=(10, 6))
plt.plot(ranges, M_CsCl_conv, 'o-', label='CsCl', color='#f093fb', linewidth=2)
plt.plot(ranges, M_NaCl_conv, 's-', label='NaCl', color='#f5576c', linewidth=2)
plt.axhline(y=1.762675, color='#f093fb', linestyle='--', alpha=0.5)
plt.axhline(y=1.747565, color='#f5576c', linestyle='--', alpha=0.5)
plt.xlabel('計算範囲', fontsize=12)
plt.ylabel('Madelung定数', fontsize=12)
plt.title('NaCl vs CsCl Madelung定数の収束性', fontsize=14)
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('madelung_comparison.png', dpi=300)
plt.show()
</code></pre>
            <p><strong>結論</strong>: CsClのMadelung定数（1.7627）はNaCl（1.7476）より約1%大きい。これはCsCl構造の方が静電エネルギー的に若干有利であることを示す。ただし、イオンサイズ比で安定構造が決まるため、大きなCs⁺と小さなCl⁻はCsCl構造を取る。</p>
        </div>
    </div>

    <div class="exercise">
        <h3>問題9（Hard）: 混成軌道のエネルギー準位</h3>
        <p>炭素のsp³混成軌道を2s（-19.4 eV）と2p（-10.7 eV）の線形結合で構成し、4つのsp³軌道のエネルギーを計算せよ。対称性も考慮すること。</p>
        <div class="solution">
            <h4>解答</h4>
            <p>sp³混成軌道は、1つのs軌道と3つのp軌道の線形結合:</p>
            <div class="equation">
                $$|\text{sp}^3\rangle = \frac{1}{2}(|s\rangle + |p_x\rangle + |p_y\rangle + |p_z\rangle)$$
            </div>
<pre class="code-block"><code class="language-python"># エネルギー準位
E_2s = -19.4  # eV
E_2p = -10.7  # eV

# sp³混成軌道のエネルギー（簡易計算：1:3の重み平均）
E_sp3 = (1 * E_2s + 3 * E_2p) / 4

print(f"C 2s軌道: {E_2s} eV")
print(f"C 2p軌道: {E_2p} eV")
print(f"sp³混成軌道: {E_sp3:.2f} eV")

# エネルギー図の作成
orbitals = ['2s', '2p', 'sp³']
energies = [E_2s, E_2p, E_sp3]
colors = ['#2c3e50', '#2c3e50', '#f5576c']

fig, ax = plt.subplots(figsize=(8, 6))
for i, (orb, E, color) in enumerate(zip(orbitals, energies, colors)):
    ax.hlines(E, i-0.3, i+0.3, color=color, linewidth=4)
    ax.text(i, E-1, f'{E:.1f} eV', ha='center', fontsize=11)

ax.set_xticks(range(len(orbitals)))
ax.set_xticklabels(orbitals, fontsize=12)
ax.set_ylabel('エネルギー (eV)', fontsize=12)
ax.set_title('炭素の原子軌道とsp³混成軌道', fontsize=14, fontweight='bold')
ax.grid(axis='y', alpha=0.3)
ax.set_ylim(-22, -8)
plt.tight_layout()
plt.savefig('sp3_hybrid_energy.png', dpi=300)
plt.show()

print(f"\nsp³軌道は2pより {E_2p - E_sp3:.1f} eV 安定化")
print(f"これによりCH4などの正四面体構造が安定化される")
</code></pre>
        </div>
    </div>

    <div class="exercise">
        <h3>問題10（Hard）: 金属のWiedemann-Franz則検証</h3>
        <p>Drude模型から熱伝導度 κ = (n e² τ / m) × (π² k_B² T / 3e²) を導き、銅でWiedemann-Franz則（κ/σT = L₀ = π²k_B²/3e²）を検証せよ。</p>
        <div class="solution">
            <h4>解答</h4>
<pre class="code-block"><code class="language-python"># Lorenz数（理論値）
L0_theory = (np.pi**2 * const.k**2) / (3 * const.e**2)
print(f"Lorenz数（理論）: L₀ = {L0_theory:.3e} W·Ω/K²")
print(f"                      = {L0_theory*1e8:.3f} × 10⁻⁸ W·Ω/K²")

# 銅のデータ
sigma_Cu = 5.96e7  # S/m at 300K
kappa_Cu = 401     # W/(m·K) at 300K
T = 300            # K

# Lorenz数（実験）
L0_exp = kappa_Cu / (sigma_Cu * T)
print(f"\n銅の実験データ（300K）:")
print(f"電気伝導度 σ = {sigma_Cu:.2e} S/m")
print(f"熱伝導度 κ = {kappa_Cu} W/(m·K)")
print(f"Lorenz数（実験）: L₀ = {L0_exp:.3e} W·Ω/K²")
print(f"                      = {L0_exp*1e8:.3f} × 10⁻⁸ W·Ω/K²")

# 一致度
agreement = (1 - abs(L0_exp - L0_theory) / L0_theory) * 100
print(f"\n理論値との一致度: {agreement:.1f}%")

# 温度依存性（実験データ）
temps = np.array([100, 200, 300, 400, 500])
L0_values = np.array([2.23, 2.33, 2.24, 2.27, 2.31]) * 1e-8  # W·Ω/K²

plt.figure(figsize=(10, 6))
plt.plot(temps, L0_values*1e8, 'o-', color='#f5576c', linewidth=2, markersize=8, label='銅（実験）')
plt.axhline(y=L0_theory*1e8, color='#2c3e50', linestyle='--', linewidth=2, label=f'理論値: {L0_theory*1e8:.2f}')
plt.xlabel('温度 (K)', fontsize=12)
plt.ylabel('Lorenz数 (×10⁻⁸ W·Ω/K²)', fontsize=12)
plt.title('Wiedemann-Franz則の検証（銅）', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('wiedemann_franz_verification.png', dpi=300)
plt.show()
</code></pre>
            <p><strong>結論</strong>: 銅のLorenz数（実験）は2.24×10⁻⁸ W·Ω/K²で、理論値2.44×10⁻⁸ W·Ω/K²と約8%の誤差。Drude模型の妥当性が確認される。温度依存性は小さく、Wiedemann-Franz則がよく成立。</p>
        </div>
    </div>

    <h2>参考文献</h2>
    <div class="reference">
        <p>1. Pauling, L. (1960). <em>The Nature of the Chemical Bond</em>, 3rd Edition. Cornell University Press, pp. 58-107.</p>
    </div>
    <div class="reference">
        <p>2. Atkins, P., de Paula, J. (2010). <em>Physical Chemistry</em>, 9th Edition. Oxford University Press, pp. 320-365.</p>
    </div>
    <div class="reference">
        <p>3. Ashcroft, N.W., Mermin, N.D. (1976). <em>Solid State Physics</em>. Brooks Cole, pp. 2-48.</p>
    </div>
    <div class="reference">
        <p>4. Kittel, C. (2005). <em>Introduction to Solid State Physics</em>, 8th Edition. Wiley, pp. 50-75.</p>
    </div>
    <div class="reference">
        <p>5. Petrucci, R.H., et al. (2016). <em>General Chemistry</em>, 11th Edition. Pearson, pp. 378-425.</p>
    </div>
    <div class="reference">
        <p>6. Shriver, D.F., Atkins, P.W. (2010). <em>Inorganic Chemistry</em>, 5th Edition. W.H. Freeman, pp. 45-89.</p>
    </div>
    <div class="reference">
        <p>7. Born, M., Landé, A. (1918). "Verhandlungen der Deutschen Physikalischen Gesellschaft", 20, 210-216.</p>
    </div>
    <div class="reference">
        <p>8. ASE Documentation: Atomic Simulation Environment. https://wiki.fysik.dtu.dk/ase/</p>
    </div>

    <h2>学習目標確認</h2>
    <div class="exercise">
        <h3>レベル1（基本理解）</h3>
        <ul>
            <li>イオン結合、共有結合、金属結合、分子間力の4つの化学結合タイプの特徴を説明できる</li>
            <li>Madelung定数、Morseポテンシャル、Drude模型、Lennard-Jonesポテンシャルの概念を理解している</li>
            <li>電気陰性度から結合のイオン性を予測できる</li>
        </ul>

        <h3>レベル2（実践スキル）</h3>
        <ul>
            <li>Pythonで格子エネルギー、結合エネルギー、電気伝導度を計算できる</li>
            <li>Born-Haberサイクルを用いて未知のエネルギーを導出できる</li>
            <li>Morseポテンシャル、Lennard-Jonesポテンシャルのパラメータフィッティングができる</li>
        </ul>

        <h3>レベル3（応用力）</h3>
        <ul>
            <li>実験データ（蒸発熱、電気伝導度等）から結合エネルギーを定量的に分析できる</li>
            <li>CsCl、NaCl等の異なる結晶構造のMadelung定数を計算し比較できる</li>
            <li>Wiedemann-Franz則などの理論検証を実験データで行える</li>
            <li>化学結合理論を材料設計（イオン性/共有性制御、混成軌道設計）に応用できる</li>
        </ul>
    </div>

    <p style="text-align: center; margin-top: 3rem;">
        <a href="index.html" style="color: #f5576c; text-decoration: none; font-weight: bold;">← シリーズトップに戻る</a> |
        <span class="coming-soon">Chapter 2: 分子軌道理論 →（準備中）</span>
    </p>
<section class="disclaimer">
<h3>免責事項</h3>
<ul>
<li>本コンテンツは教育・研究・情報提供のみを目的としており、専門的な助言(法律・会計・技術的保証など)を提供するものではありません。</li>
<li>本コンテンツおよび付随するCode examplesは「現状有姿(AS IS)」で提供され、明示または黙示を問わず、商品性、特定目的適合性、権利非侵害、正確性・完全性、動作・安全性等いかなる保証もしません。</li>
<li>外部リンク、第三者が提供するデータ・ツール・ライブラリ等の内容・可用性・安全性について、作成者および東北大学は一切の責任を負いません。</li>
<li>本コンテンツの利用・実行・解釈により直接的・間接的・付随的・特別・結果的・懲罰的損害が生じた場合でも、適用法で許容される最大限の範囲で、作成者および東北大学は責任を負いません。</li>
<li>本コンテンツの内容は、予告なく変更・更新・提供停止されることがあります。</li>
<li>本コンテンツの著作権・ライセンスは明記された条件(例: CC BY 4.0)に従います。当該ライセンスは通常、無保証条項を含みます。</li>
</ul>
</section>

</body>
</html>
