<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« : æ©Ÿèƒ½æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ - ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ææ–™å…¥é–€ - MS Dojo</title>
    <meta name="description" content="èª˜é›»ä½“ã€åœ§é›»ã€ã‚¤ã‚ªãƒ³ä¼å°ã€ç™ºå…‰ã€ç£æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã®åŸç†ã¨å¿œç”¨ã‚’Pythonã§å­¦ã¶ã€‚">

    <!-- Prism.js for code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <!-- MathJax for mathematical expressions -->
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <style>
        :root {
            --accent-pink: #f093fb;
            --accent-coral: #f5576c;
            --primary-dark: #2c3e50;
            --secondary-dark: #34495e;
            --text-dark: #2c3e50;
            --text-light: #7f8c8d;
            --bg-light: #ecf0f1;
            --white: #ffffff;
            --code-bg: #2d2d2d;
            --border-light: #bdc3c7;
            --success: #27ae60;
            --warning: #f39c12;
            --danger: #e74c3c;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.8;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        header {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
            padding: 3rem 1.5rem;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        nav {
            background: var(--white);
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 0.5rem;
        }

        nav a {
            text-decoration: none;
            color: var(--text-dark);
            padding: 0.5rem 1rem;
            border-radius: 4px;
            transition: all 0.3s;
            font-weight: 500;
        }

        nav a:hover {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
        }

        main {
            max-width: 900px;
            margin: 2rem auto;
            padding: 0 1.5rem;
        }

        section {
            background: var(--white);
            padding: 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        h2 {
            color: var(--primary-dark);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid;
            border-image: linear-gradient(90deg, var(--accent-pink), var(--accent-coral)) 1;
        }

        h3 {
            color: var(--secondary-dark);
            font-size: 1.4rem;
            margin: 2rem 0 1rem;
        }

        h4 {
            color: var(--secondary-dark);
            font-size: 1.2rem;
            margin: 1.5rem 0 1rem;
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.8;
        }

        ul, ol {
            margin-left: 2rem;
            margin-bottom: 1rem;
        }

        li {
            margin-bottom: 0.5rem;
        }

        code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
            color: #e74c3c;
        }

        pre {
            background: var(--code-bg);
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1.5rem 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            border-left: 4px solid var(--accent-coral);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .info-box strong {
            color: var(--accent-coral);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .warning-box {
            background: rgba(243, 156, 18, 0.1);
            border-left: 4px solid var(--warning);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }

        .warning-box strong {
            color: var(--warning);
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .exercise-box {
            background: rgba(39, 174, 96, 0.05);
            border: 2px solid var(--success);
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 8px;
        }

        .exercise-box h4 {
            color: var(--success);
            margin-top: 0;
        }

        .difficulty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }

        .difficulty.easy {
            background: #d4edda;
            color: #155724;
        }

        .difficulty.medium {
            background: #fff3cd;
            color: #856404;
        }

        .difficulty.hard {
            background: #f8d7da;
            color: #721c24;
        }

        .mermaid {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
            text-align: center;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        th, td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--border-light);
        }

        th {
            background: linear-gradient(135deg, var(--accent-pink) 0%, var(--accent-coral) 100%);
            color: white;
            font-weight: 600;
        }

        tr:hover {
            background: rgba(240, 147, 251, 0.05);
        }

        footer {
            background: var(--primary-dark);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        footer a {
            color: var(--accent-pink);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--accent-coral);
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.5rem;
            }

            nav ul {
                flex-direction: column;
                align-items: center;
            }

            section {
                padding: 1.5rem;
            }

            pre {
                padding: 1rem;
                font-size: 0.85rem;
            }
        }
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
        <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MS/ceramic-materials-introduction/chapter-4.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/ceramic-materials-introduction/index.html">Ceramic Materials</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 4</span>
        </div>
    </nav>

    <header>
        <h1>ç¬¬4ç« : æ©Ÿèƒ½æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹</h1>
        <p>èª˜é›»ä½“ã€åœ§é›»ã€ã‚¤ã‚ªãƒ³ä¼å°ã€ç™ºå…‰ã€ç£æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã®åŸç†ã¨å¿œç”¨</p>
    </header>

    <nav>
        <ul>
            <li><a href="index.html">ãƒˆãƒƒãƒ—</a></li>
            <li><a href="#intro">æ¦‚è¦</a></li>
            <li><a href="#dielectric">èª˜é›»ä½“</a></li>
            <li><a href="#piezoelectric">åœ§é›»</a></li>
            <li><a href="#ionic">ã‚¤ã‚ªãƒ³ä¼å°</a></li>
            <li><a href="#luminescence">ç™ºå…‰ææ–™</a></li>
            <li><a href="#magnetic">ç£æ€§</a></li>
            <li><a href="#exercises">æ¼”ç¿’å•é¡Œ</a></li>
            <li><a href="#references">å‚è€ƒæ–‡çŒ®</a></li>
            <li><a href="chapter-3.html">â† å‰ã®ç« </a></li>
            <li><a href="chapter-5.html">æ¬¡ã®ç« ã¸ â†’</a></li>
        </ul>
    </nav>

    <main>
        <section id="intro">
            <h2>4.1 æ©Ÿèƒ½æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã®æ¦‚è¦</h2>

            <p>
                æ©Ÿèƒ½æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã¯ã€<strong>èª˜é›»æ€§ã€åœ§é›»æ€§ã€ã‚¤ã‚ªãƒ³ä¼å°æ€§ã€ç™ºå…‰æ€§ã€ç£æ€§</strong>ãªã©ã®é›»æ°—çš„ãƒ»å…‰å­¦çš„ãƒ»ç£æ°—çš„æ€§è³ªã‚’åˆ©ç”¨ã™ã‚‹ææ–™ç¾¤ã§ã™ã€‚ã“ã‚Œã‚‰ã¯ã‚³ãƒ³ãƒ‡ãƒ³ã‚µã€ã‚»ãƒ³ã‚µã€å›ºä½“é›»è§£è³ªã€LEDè›å…‰ä½“ã€ç£æ€§ãƒ‡ãƒã‚¤ã‚¹ã¨ã—ã¦åºƒãå¿œç”¨ã•ã‚Œã¦ã„ã¾ã™ã€‚æœ¬ç« ã§ã¯ã€å„æ©Ÿèƒ½ã®ç‰©ç†çš„ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã‚’å­¦ã³ã€Pythonã§ç‰¹æ€§è¨ˆç®—ã‚’å®Ÿè·µã—ã¾ã™ã€‚
            </p>

            <div class="info-box">
                <strong>æœ¬ç« ã®å­¦ç¿’ç›®æ¨™</strong>
                <ul>
                    <li><strong>ãƒ¬ãƒ™ãƒ«1ï¼ˆåŸºæœ¬ç†è§£ï¼‰</strong>: èª˜é›»ç‡ã€åœ§é›»å®šæ•°ã€ã‚¤ã‚ªãƒ³ä¼å°åº¦ã®å®šç¾©ã‚’èª¬æ˜ã§ãã€ä»£è¡¨ææ–™ã¨å¿œç”¨ã‚’ç†è§£ã§ãã‚‹</li>
                    <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: Pythonã§èª˜é›»ç‡è¨ˆç®—ã€åœ§é›»å¿œç­”ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€Arrheniusãƒ—ãƒ­ãƒƒãƒˆã‚’å®Ÿè¡Œã§ãã‚‹</li>
                    <li><strong>ãƒ¬ãƒ™ãƒ«3ï¼ˆå¿œç”¨åŠ›ï¼‰</strong>: å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ææ–™å®šæ•°ã‚’æŠ½å‡ºã—ã€ãƒ‡ãƒã‚¤ã‚¹è¨­è¨ˆã«å¿œç”¨ã§ãã‚‹ã€‚ç›¸å›³ã¨çµ„æˆã®æœ€é©åŒ–ãŒã§ãã‚‹</li>
                </ul>
            </div>

            <h3>æ©Ÿèƒ½æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã®åˆ†é¡</h3>

            <div class="mermaid">
            flowchart TD
                A[æ©Ÿèƒ½æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹] --> B[èª˜é›»ä½“ææ–™]
                A --> C[åœ§é›»ãƒ»ç„¦é›»ææ–™]
                A --> D[ã‚¤ã‚ªãƒ³ä¼å°ä½“]
                A --> E[å…‰æ©Ÿèƒ½ææ–™]
                A --> F[ç£æ€§ææ–™]

                B --> B1[BaTiOâ‚ƒ<br/>MLCC]
                B --> B2[é«˜èª˜é›»ç‡ææ–™<br/>Îµáµ£ > 1000]

                C --> C1[PZT<br/>ã‚¢ã‚¯ãƒãƒ¥ã‚¨ãƒ¼ã‚¿]
                C --> C2[AlN<br/>é«˜å‘¨æ³¢ãƒ•ã‚£ãƒ«ã‚¿]

                D --> D1[YSZ<br/>SOFCé›»è§£è³ª]
                D --> D2[Liç³»<br/>å…¨å›ºä½“é›»æ± ]

                E --> E1[è›å…‰ä½“<br/>LED, PDP]
                E --> E2[ãƒ¬ãƒ¼ã‚¶ãƒ¼<br/>YAG:Nd]

                F --> F1[ãƒ•ã‚§ãƒ©ã‚¤ãƒˆ<br/>ç£æ€§ã‚³ã‚¢]
                F --> F2[ç£æ€§ã‚¬ãƒ¼ãƒãƒƒãƒˆ<br/>å…‰ã‚¢ã‚¤ã‚½ãƒ¬ãƒ¼ã‚¿]

                style A fill:#f093fb,color:#fff
                style B fill:#e3f2fd
                style C fill:#fff3e0
                style D fill:#e8f5e9
                style E fill:#fce4ec
                style F fill:#f3e5f5
            </flowchart>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>æ©Ÿèƒ½</th>
                        <th>ä»£è¡¨ææ–™</th>
                        <th>ç‰¹æ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</th>
                        <th>ä¸»è¦å¿œç”¨</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>èª˜é›»ä½“</td>
                        <td>BaTiOâ‚ƒ, (Ba,Sr)TiOâ‚ƒ</td>
                        <td>èª˜é›»ç‡ Îµáµ£ = 1000-10000</td>
                        <td>MLCC, ãƒ¡ãƒ¢ãƒª</td>
                    </tr>
                    <tr>
                        <td>åœ§é›»ä½“</td>
                        <td>PZT, BaTiOâ‚ƒ, AlN</td>
                        <td>åœ§é›»å®šæ•° dâ‚ƒâ‚ƒ = 100-600 pC/N</td>
                        <td>è¶…éŸ³æ³¢ã‚»ãƒ³ã‚µã€æŒ¯å‹•å­</td>
                    </tr>
                    <tr>
                        <td>ã‚¤ã‚ªãƒ³ä¼å°ä½“</td>
                        <td>YSZ, LLZO, Î²-Alâ‚‚Oâ‚ƒ</td>
                        <td>ä¼å°åº¦ Ïƒ = 0.01-1 S/cm</td>
                        <td>SOFC, å…¨å›ºä½“é›»æ± </td>
                    </tr>
                    <tr>
                        <td>ç™ºå…‰ä½“</td>
                        <td>Yâ‚ƒAlâ‚…Oâ‚â‚‚:Ce (YAG:Ce)</td>
                        <td>é‡å­åŠ¹ç‡ > 90%</td>
                        <td>ç™½è‰²LEDè›å…‰ä½“</td>
                    </tr>
                    <tr>
                        <td>ç£æ€§ä½“</td>
                        <td>NiFeâ‚‚Oâ‚„, BaFeâ‚â‚‚Oâ‚â‚‰</td>
                        <td>é£½å’Œç£åŒ– Ms = 0.3-0.6 T</td>
                        <td>ãƒˆãƒ©ãƒ³ã‚¹ã€ãƒ¢ãƒ¼ã‚¿ãƒ¼</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="dielectric">
            <h2>4.2 èª˜é›»ä½“ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹</h2>

            <h3>4.2.1 èª˜é›»åˆ†æ¥µã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ </h3>

            <p>
                èª˜é›»ä½“ã«é›»å ´ã‚’å°åŠ ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®4ç¨®é¡ã®åˆ†æ¥µãŒç”Ÿã˜ã¾ã™ï¼š
            </p>

            <ol>
                <li><strong>é›»å­åˆ†æ¥µ</strong>: é›»å­é›²ã®å¤‰ä½ï¼ˆå…¨ææ–™ã€~10<sup>15</sup> Hzï¼‰</li>
                <li><strong>ã‚¤ã‚ªãƒ³åˆ†æ¥µ</strong>: ã‚¤ã‚ªãƒ³ã®ç›¸å¯¾å¤‰ä½ï¼ˆèµ¤å¤–åŸŸã€~10<sup>13</sup> Hzï¼‰</li>
                <li><strong>é…å‘åˆ†æ¥µ</strong>: æ°¸ä¹…åŒæ¥µå­ã®å›è»¢ï¼ˆãƒã‚¤ã‚¯ãƒ­æ³¢åŸŸã€~10<sup>9</sup> Hzï¼‰</li>
                <li><strong>ç•Œé¢åˆ†æ¥µ</strong>: ç•Œé¢ã§ã®é›»è·è“„ç©ï¼ˆä½å‘¨æ³¢ã€~10<sup>3</sup> Hzï¼‰</li>
            </ol>

            <p>
                èª˜é›»ç‡ \( \epsilon_r \) ã¯çœŸç©ºèª˜é›»ç‡ \( \epsilon_0 = 8.854 \times 10^{-12} \) F/m ã«å¯¾ã™ã‚‹æ¯”ã§å®šç¾©ã•ã‚Œã¾ã™ï¼š
            </p>

            <p>
                \[
                \epsilon_r = \frac{\epsilon}{\epsilon_0}
                \]
            </p>

            <h3>4.2.2 BaTiOâ‚ƒã®å¼·èª˜é›»æ€§</h3>

            <p>
                BaTiOâ‚ƒã¯ã€ã‚­ãƒ¥ãƒªãƒ¼æ¸©åº¦ï¼ˆT<sub>c</sub> â‰ˆ 120Â°Cï¼‰ä»¥ä¸‹ã§æ­£æ–¹æ™¶ã«ç›¸è»¢ç§»ã—ã€è‡ªç™ºåˆ†æ¥µã‚’æŒã¡ã¾ã™ã€‚ã“ã®å¼·èª˜é›»æ€§ã«ã‚ˆã‚Šã€èª˜é›»ç‡ãŒ10,000ã‚’è¶…ãˆã‚‹é«˜ã„å€¤ã‚’ç¤ºã—ã¾ã™ã€‚
            </p>

            <h4>Pythonå®Ÿè£…: Clausius-Mossottiå¼ã«ã‚ˆã‚‹èª˜é›»ç‡è¨ˆç®—</h4>

            <pre><code class="language-python"># ===================================
# Example 1: Clausius-Mossottièª˜é›»ç‡è¨ˆç®—
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def clausius_mossotti_permittivity(alpha, N, epsilon_0=8.854e-12):
    """
    Clausius-Mossottiå¼ã«ã‚ˆã‚‹èª˜é›»ç‡ã®è¨ˆç®—

    Parameters:
    -----------
    alpha : float
        åˆ†æ¥µç‡ [CÂ·mÂ²/V]
    N : float
        å˜ä½ä½“ç©ã‚ãŸã‚Šã®åŸå­æ•° [m^-3]
    epsilon_0 : float
        çœŸç©ºèª˜é›»ç‡ [F/m]

    Returns:
    --------
    epsilon_r : float
        æ¯”èª˜é›»ç‡ï¼ˆç„¡æ¬¡å…ƒï¼‰
    """
    # Clausius-Mossottiå¼: (Îµáµ£ - 1)/(Îµáµ£ + 2) = NÂ·Î±/(3Îµâ‚€)
    # å¤‰å½¢: Îµáµ£ = (1 + 2Â·NÂ·Î±/(3Îµâ‚€)) / (1 - NÂ·Î±/(3Îµâ‚€))

    numerator = 1 + 2 * N * alpha / (3 * epsilon_0)
    denominator = 1 - N * alpha / (3 * epsilon_0)

    epsilon_r = numerator / denominator

    return epsilon_r


def curie_weiss_law(T, T_c=393, C=1.5e5):
    """
    Curie-Weisså‰‡ã«ã‚ˆã‚‹èª˜é›»ç‡ã®æ¸©åº¦ä¾å­˜æ€§

    Parameters:
    -----------
    T : float or array
        æ¸©åº¦ [K]
    T_c : float
        ã‚­ãƒ¥ãƒªãƒ¼æ¸©åº¦ [K] (BaTiOâ‚ƒ â‰ˆ 120Â°C = 393K)
    C : float
        Curieå®šæ•° [K]

    Returns:
    --------
    epsilon_r : float or array
        æ¯”èª˜é›»ç‡
    """
    # Curie-Weisså‰‡: Îµáµ£ = C / (T - Tá¶œ)
    epsilon_r = C / np.abs(T - T_c)

    # ç™ºæ•£ã‚’é¿ã‘ã‚‹ãŸã‚ã€æœ€å¤§å€¤ã‚’åˆ¶é™
    epsilon_r = np.minimum(epsilon_r, 20000)

    return epsilon_r


def plot_dielectric_properties():
    """
    èª˜é›»ä½“ã®ç‰¹æ€§ã‚’å¯è¦–åŒ–
    """
    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å·¦å›³: åˆ†æ¥µç‡ã¨èª˜é›»ç‡ã®é–¢ä¿‚
    ax1 = axes[0]

    # å…¸å‹çš„ãªææ–™ã®åˆ†æ¥µç‡ç¯„å›²
    alpha_range = np.linspace(1e-40, 5e-40, 100)  # CÂ·mÂ²/V
    N = 5e28  # m^-3 (å…¸å‹çš„ãªã‚¤ã‚ªãƒ³å¯†åº¦)

    epsilon_r_values = [clausius_mossotti_permittivity(alpha, N) for alpha in alpha_range]

    ax1.plot(alpha_range * 1e40, epsilon_r_values, linewidth=2, color='navy')

    # ä»£è¡¨çš„ãªææ–™ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
    materials = {
        'SiOâ‚‚': {'alpha': 3.5e-41, 'epsilon_r': 3.8},
        'Alâ‚‚Oâ‚ƒ': {'alpha': 1.0e-40, 'epsilon_r': 9.0},
        'TiOâ‚‚': {'alpha': 2.5e-40, 'epsilon_r': 80},
        'BaTiOâ‚ƒ': {'alpha': 4.5e-40, 'epsilon_r': 1200}
    }

    for name, props in materials.items():
        ax1.scatter(props['alpha'] * 1e40, props['epsilon_r'],
                   s=150, edgecolors='black', linewidth=2, zorder=5)
        ax1.annotate(name, (props['alpha'] * 1e40, props['epsilon_r']),
                    xytext=(5, 5), textcoords='offset points', fontsize=10)

    ax1.set_xlabel('Polarizability Î± (10^-40 CÂ·mÂ²/V)', fontsize=12)
    ax1.set_ylabel('Relative Permittivity Îµáµ£', fontsize=12)
    ax1.set_title('Clausius-Mossotti Relation', fontsize=14, fontweight='bold')
    ax1.grid(True, alpha=0.3)

    # å³å›³: BaTiOâ‚ƒã®Curie-Weisså‰‡
    ax2 = axes[1]

    T_range = np.linspace(293, 493, 500)  # 20Â°C ~ 220Â°C
    T_c = 393  # 120Â°C

    epsilon_r_bto = curie_weiss_law(T_range, T_c, C=1.5e5)

    ax2.plot(T_range - 273.15, epsilon_r_bto, linewidth=2, color='crimson')
    ax2.axvline(x=T_c - 273.15, color='blue', linestyle='--', linewidth=2,
                label=f'Curie temperature = {T_c-273.15:.0f}Â°C')

    ax2.set_xlabel('Temperature (Â°C)', fontsize=12)
    ax2.set_ylabel('Relative Permittivity Îµáµ£', fontsize=12)
    ax2.set_title('BaTiOâ‚ƒ Curie-Weiss Behavior', fontsize=14, fontweight='bold')
    ax2.set_ylim(0, 20000)
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('dielectric_properties.png', dpi=300, bbox_inches='tight')
    plt.show()

    # æ•°å€¤ä¾‹
    print("=== Clausius-Mossotti Calculation ===")
    for name, props in materials.items():
        calculated_eps = clausius_mossotti_permittivity(props['alpha'], N)
        print(f"{name:10s}: Î± = {props['alpha']*1e40:.2f}Ã—10^-40, Îµáµ£ = {calculated_eps:.1f} (exp: {props['epsilon_r']})")

    print("\n=== BaTiOâ‚ƒ Temperature Dependence ===")
    for T_celsius in [80, 100, 120, 140, 160]:
        T = T_celsius + 273.15
        eps = curie_weiss_law(T, T_c=393, C=1.5e5)
        print(f"T = {T_celsius:3d}Â°C â†’ Îµáµ£ = {eps:6.0f}")

# å®Ÿè¡Œ
plot_dielectric_properties()
</code></pre>

            <h3>4.2.3 MLCCï¼ˆç©å±¤ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚³ãƒ³ãƒ‡ãƒ³ã‚µï¼‰ã®è¨­è¨ˆ</h3>

            <p>
                MLCCã¯ã€èª˜é›»ä½“å±¤ã¨å†…éƒ¨é›»æ¥µã‚’äº¤äº’ã«ç©å±¤ã—ãŸæ§‹é€ ã§ã€é«˜å®¹é‡åŒ–ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚å®¹é‡Cã¯ï¼š
            </p>

            <p>
                \[
                C = \frac{\epsilon_0 \epsilon_r A}{d} \times n
                \]
            </p>

            <p>
                ã“ã“ã§ã€\( A \) ã¯é›»æ¥µé¢ç©ã€\( d \) ã¯èª˜é›»ä½“å±¤åšã¿ã€\( n \) ã¯å±¤æ•°ã§ã™ã€‚
            </p>

            <h4>Pythonå®Ÿè£…: MLCCã‚­ãƒ£ãƒ‘ã‚·ã‚¿ãƒ³ã‚¹è¨­è¨ˆè¨ˆç®—</h4>

            <pre><code class="language-python"># ===================================
# Example 2: MLCCã‚­ãƒ£ãƒ‘ã‚·ã‚¿ãƒ³ã‚¹è¨­è¨ˆ
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def mlcc_capacitance(epsilon_r, A, d, n, epsilon_0=8.854e-12):
    """
    MLCCï¼ˆç©å±¤ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚³ãƒ³ãƒ‡ãƒ³ã‚µï¼‰ã®å®¹é‡è¨ˆç®—

    Parameters:
    -----------
    epsilon_r : float
        æ¯”èª˜é›»ç‡
    A : float
        é›»æ¥µé¢ç© [mÂ²]
    d : float
        èª˜é›»ä½“å±¤åšã¿ [m]
    n : int
        ç©å±¤æ•°
    epsilon_0 : float
        çœŸç©ºèª˜é›»ç‡ [F/m]

    Returns:
    --------
    C : float
        å®¹é‡ [F]
    """
    C = (epsilon_0 * epsilon_r * A / d) * n
    return C


def design_mlcc_optimization():
    """
    MLCCè¨­è¨ˆã®æœ€é©åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    """
    # è¨­è¨ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    epsilon_r = 3000  # X7Rææ–™ï¼ˆBaTiOâ‚ƒç³»ï¼‰
    A = (1e-3)**2  # 1mm Ã— 1mm
    d_range = np.linspace(1e-6, 50e-6, 100)  # 1~50 Î¼m
    n = 100  # 100å±¤

    # å®¹é‡è¨ˆç®—
    C_values = [mlcc_capacitance(epsilon_r, A, d, n) for d in d_range]

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å·¦å›³: å±¤åšã¿ã¨å®¹é‡ã®é–¢ä¿‚
    ax1 = axes[0]
    ax1.plot(d_range * 1e6, np.array(C_values) * 1e6, linewidth=2, color='navy')
    ax1.axhline(y=1, color='red', linestyle='--', alpha=0.5, label='Target: 1 Î¼F')

    ax1.set_xlabel('Dielectric Layer Thickness (Î¼m)', fontsize=12)
    ax1.set_ylabel('Capacitance (Î¼F)', fontsize=12)
    ax1.set_title('MLCC Capacitance vs Layer Thickness', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # å³å›³: ç©å±¤æ•°ã®å½±éŸ¿
    ax2 = axes[1]
    d_fixed = 5e-6  # 5 Î¼m
    n_range = np.arange(10, 501, 10)
    C_vs_n = [mlcc_capacitance(epsilon_r, A, d_fixed, n) for n in n_range]

    ax2.plot(n_range, np.array(C_vs_n) * 1e6, linewidth=2, color='green')

    ax2.set_xlabel('Number of Layers n', fontsize=12)
    ax2.set_ylabel('Capacitance (Î¼F)', fontsize=12)
    ax2.set_title(f'MLCC Capacitance vs Layer Count (d = {d_fixed*1e6} Î¼m)', fontsize=14, fontweight='bold')
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('mlcc_design.png', dpi=300, bbox_inches='tight')
    plt.show()

    # è¨­è¨ˆä¾‹
    print("=== MLCC Design Examples ===")
    designs = [
        {'name': 'Low-C (1 nF)', 'd': 20e-6, 'n': 10},
        {'name': 'Mid-C (100 nF)', 'd': 10e-6, 'n': 50},
        {'name': 'High-C (1 Î¼F)', 'd': 5e-6, 'n': 200},
        {'name': 'Ultra-C (10 Î¼F)', 'd': 2e-6, 'n': 500}
    ]

    for design in designs:
        C = mlcc_capacitance(epsilon_r, A, design['d'], design['n'])
        volume = A * design['d'] * design['n']
        density = C / volume  # F/mÂ³
        print(f"{design['name']:20s}: d={design['d']*1e6:4.1f} Î¼m, n={design['n']:3d} â†’ C={C*1e6:8.2f} Î¼F, density={density*1e-9:.2f} Î¼F/mmÂ³")

# å®Ÿè¡Œ
design_mlcc_optimization()
</code></pre>

            <div class="info-box">
                <strong>MLCCã®è–„å±¤åŒ–ãƒˆãƒ¬ãƒ³ãƒ‰</strong>
                ç¾ä»£ã®MLCCã§ã¯ã€èª˜é›»ä½“å±¤åšã¿ãŒ1 Î¼mä»¥ä¸‹ï¼ˆå…ˆç«¯å“ã§ã¯0.5 Î¼mï¼‰ã¾ã§è–„å±¤åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€1608ã‚µã‚¤ã‚ºï¼ˆ1.6 mm Ã— 0.8 mmï¼‰ã§10 Î¼Fã‚’è¶…ãˆã‚‹é«˜å®¹é‡ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚è–„å±¤åŒ–ã«ã¯ã€å‡ä¸€ãªèª˜é›»ä½“ã‚¹ãƒ©ãƒªãƒ¼ã¨ãƒŠãƒç²’å­åŸæ–™ãŒä¸å¯æ¬ ã§ã™ã€‚
            </div>
        </section>

        <section id="piezoelectric">
            <h2>4.3 åœ§é›»ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹</h2>

            <h3>4.3.1 åœ§é›»åŠ¹æœã®åŸç†</h3>

            <p>
                åœ§é›»åŠ¹æœã¯ã€æ©Ÿæ¢°çš„å¿œåŠ›ã«ã‚ˆã‚Šé›»è·ãŒç™ºç”Ÿã™ã‚‹ç¾è±¡ï¼ˆæ­£åœ§é›»åŠ¹æœï¼‰ã¨ã€é›»å ´å°åŠ ã«ã‚ˆã‚Šæ­ªã¿ãŒç”Ÿã˜ã‚‹ç¾è±¡ï¼ˆé€†åœ§é›»åŠ¹æœï¼‰ã§ã™ã€‚çµæ™¶æ§‹é€ ã®éå¯¾ç§°æ€§ãŒå¿…è¦ã§ã€32ç¨®ã®çµæ™¶ç‚¹ç¾¤ã®ã†ã¡20ç¨®ãŒåœ§é›»æ€§ã‚’ç¤ºã—ã¾ã™ã€‚
            </p>

            <p>
                åœ§é›»å®šæ•° \( d_{33} \) ã¯ã€é›»å ´æ–¹å‘ã¨å¿œåŠ›æ–¹å‘ãŒå¹³è¡Œãªå ´åˆã®æ­ªã¿ï¼ˆã¾ãŸã¯é›»è·ï¼‰ã‚’è¡¨ã—ã¾ã™ï¼š
            </p>

            <p>
                \[
                S_3 = d_{33} E_3 \quad \text{ï¼ˆé€†åœ§é›»åŠ¹æœï¼‰}
                \]
                \[
                D_3 = d_{33} T_3 \quad \text{ï¼ˆæ­£åœ§é›»åŠ¹æœï¼‰}
                \]
            </p>

            <p>
                ã“ã“ã§ã€\( S \) ã¯æ­ªã¿ã€\( E \) ã¯é›»å ´ã€\( D \) ã¯é›»æŸå¯†åº¦ã€\( T \) ã¯å¿œåŠ›ã§ã™ã€‚
            </p>

            <h3>4.3.2 PZTï¼ˆãƒã‚¿ãƒ³é…¸ã‚¸ãƒ«ã‚³ãƒ³é…¸é‰›ï¼‰ã®ç‰¹æ€§</h3>

            <p>
                PZTï¼ˆPb(Zr<sub>x</sub>Ti<sub>1-x</sub>)Oâ‚ƒï¼‰ã¯ã€æœ€ã‚‚åºƒãä½¿ã‚ã‚Œã‚‹åœ§é›»ææ–™ã§ã™ã€‚MPBï¼ˆMorphotropic Phase Boundaryã€x â‰ˆ 0.52ï¼‰çµ„æˆã§åœ§é›»ç‰¹æ€§ãŒæœ€å¤§ã¨ãªã‚Šã¾ã™ã€‚
            </p>

            <table>
                <thead>
                    <tr>
                        <th>ææ–™</th>
                        <th>dâ‚ƒâ‚ƒ (pC/N)</th>
                        <th>k<sub>p</sub></th>
                        <th>ç”¨é€”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>BaTiOâ‚ƒ</td>
                        <td>190</td>
                        <td>0.36</td>
                        <td>åˆæœŸåœ§é›»ç´ å­</td>
                    </tr>
                    <tr>
                        <td>PZT-4</td>
                        <td>289</td>
                        <td>0.58</td>
                        <td>ã‚»ãƒ³ã‚µ</td>
                    </tr>
                    <tr>
                        <td>PZT-5H</td>
                        <td>593</td>
                        <td>0.65</td>
                        <td>ã‚¢ã‚¯ãƒãƒ¥ã‚¨ãƒ¼ã‚¿</td>
                    </tr>
                    <tr>
                        <td>AlN</td>
                        <td>5.5</td>
                        <td>0.20</td>
                        <td>é«˜å‘¨æ³¢ãƒ•ã‚£ãƒ«ã‚¿</td>
                    </tr>
                </tbody>
            </table>

            <h4>Pythonå®Ÿè£…: åœ§é›»å®šæ•°ã¨çµåˆä¿‚æ•°ã®è¨ˆç®—</h4>

            <pre><code class="language-python"># ===================================
# Example 3: åœ§é›»å®šæ•°ã¨çµåˆä¿‚æ•°ã®è¨ˆç®—
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def piezoelectric_strain(d_33, E_3):
    """
    é€†åœ§é›»åŠ¹æœã«ã‚ˆã‚‹æ­ªã¿ã®è¨ˆç®—

    Parameters:
    -----------
    d_33 : float
        åœ§é›»å®šæ•° [m/V] ã¾ãŸã¯ [C/N]
    E_3 : float
        é›»å ´ [V/m]

    Returns:
    --------
    S_3 : float
        æ­ªã¿ï¼ˆç„¡æ¬¡å…ƒï¼‰
    """
    S_3 = d_33 * E_3
    return S_3


def electromechanical_coupling_factor(d_33, epsilon_33, s_33):
    """
    é›»æ°—æ©Ÿæ¢°çµåˆä¿‚æ•°ã®è¨ˆç®—

    Parameters:
    -----------
    d_33 : float
        åœ§é›»å®šæ•° [C/N]
    epsilon_33 : float
        èª˜é›»ç‡ [F/m]
    s_33 : float
        å¼¾æ€§ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹ [mÂ²/N]

    Returns:
    --------
    k_33 : float
        çµåˆä¿‚æ•°ï¼ˆç„¡æ¬¡å…ƒã€0~1ï¼‰
    """
    k_33 = d_33 / np.sqrt(epsilon_33 * s_33)
    return k_33


def plot_piezoelectric_response():
    """
    åœ§é›»å¿œç­”ã®å¯è¦–åŒ–
    """
    # PZT-5Hã®ç‰©æ€§å€¤
    d_33 = 593e-12  # C/N
    epsilon_0 = 8.854e-12
    epsilon_r = 3400
    epsilon_33 = epsilon_0 * epsilon_r

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å·¦å›³: é›»å ´-æ­ªã¿é–¢ä¿‚ï¼ˆé€†åœ§é›»åŠ¹æœï¼‰
    ax1 = axes[0]
    E_range = np.linspace(-2e6, 2e6, 500)  # -2 ~ +2 MV/m
    strain = piezoelectric_strain(d_33, E_range)

    ax1.plot(E_range / 1e6, strain * 1e6, linewidth=2, color='navy')
    ax1.axhline(y=0, color='black', linestyle='-', linewidth=0.5)
    ax1.axvline(x=0, color='black', linestyle='-', linewidth=0.5)

    ax1.set_xlabel('Electric Field Eâ‚ƒ (MV/m)', fontsize=12)
    ax1.set_ylabel('Strain Sâ‚ƒ (Î¼strain)', fontsize=12)
    ax1.set_title('Converse Piezoelectric Effect (PZT-5H)', fontsize=14, fontweight='bold')
    ax1.grid(True, alpha=0.3)

    # å³å›³: ææ–™æ¯”è¼ƒï¼ˆåœ§é›»å®šæ•°ã¨çµåˆä¿‚æ•°ï¼‰
    ax2 = axes[1]

    materials_piezo = {
        'BaTiOâ‚ƒ': {'d33': 190e-12, 'epsilon_r': 1700, 's33': 8.3e-12},
        'PZT-4': {'d33': 289e-12, 'epsilon_r': 1300, 's33': 12.3e-12},
        'PZT-5H': {'d33': 593e-12, 'epsilon_r': 3400, 's33': 16.5e-12},
        'PVDF': {'d33': 33e-12, 'epsilon_r': 12, 's33': 400e-12},
        'AlN': {'d33': 5.5e-12, 'epsilon_r': 9, 's33': 3.0e-12}
    }

    names = list(materials_piezo.keys())
    d33_values = [props['d33'] * 1e12 for props in materials_piezo.values()]
    k33_values = []

    for props in materials_piezo.values():
        epsilon = epsilon_0 * props['epsilon_r']
        k33 = electromechanical_coupling_factor(props['d33'], epsilon, props['s33'])
        k33_values.append(k33)

    x = np.arange(len(names))
    width = 0.35

    ax2.bar(x - width/2, d33_values, width, label='dâ‚ƒâ‚ƒ (pC/N)', color='skyblue', edgecolor='black')
    ax2_twin = ax2.twinx()
    ax2_twin.bar(x + width/2, k33_values, width, label='kâ‚ƒâ‚ƒ', color='salmon', edgecolor='black')

    ax2.set_xlabel('Material', fontsize=12)
    ax2.set_ylabel('Piezoelectric Constant dâ‚ƒâ‚ƒ (pC/N)', fontsize=12, color='skyblue')
    ax2_twin.set_ylabel('Coupling Coefficient kâ‚ƒâ‚ƒ', fontsize=12, color='salmon')
    ax2.set_title('Piezoelectric Material Comparison', fontsize=14, fontweight='bold')
    ax2.set_xticks(x)
    ax2.set_xticklabels(names, rotation=15)
    ax2.tick_params(axis='y', labelcolor='skyblue')
    ax2_twin.tick_params(axis='y', labelcolor='salmon')
    ax2.grid(True, alpha=0.3, axis='y')

    plt.tight_layout()
    plt.savefig('piezoelectric_response.png', dpi=300, bbox_inches='tight')
    plt.show()

    # æ•°å€¤ä¾‹
    print("=== Piezoelectric Response Calculation (PZT-5H) ===")
    for E_MV in [0.5, 1.0, 2.0]:
        E = E_MV * 1e6
        S = piezoelectric_strain(d_33, E)
        displacement = S * 1e-3  # 1 mmåšã•ã®å ´åˆ
        print(f"E = {E_MV:.1f} MV/m â†’ Strain = {S*1e6:.1f} Î¼strain, Displacement (1mm) = {displacement*1e9:.2f} nm")

    print("\n=== Electromechanical Coupling Coefficients ===")
    for name, props in materials_piezo.items():
        epsilon = epsilon_0 * props['epsilon_r']
        k33 = electromechanical_coupling_factor(props['d33'], epsilon, props['s33'])
        print(f"{name:10s}: dâ‚ƒâ‚ƒ = {props['d33']*1e12:5.1f} pC/N, kâ‚ƒâ‚ƒ = {k33:.3f}")

# å®Ÿè¡Œ
plot_piezoelectric_response()
</code></pre>

            <h4>Pythonå®Ÿè£…: PZTç›¸å›³ã¨MPBçµ„æˆ</h4>

            <pre><code class="language-python"># ===================================
# Example 4: PZTç›¸å›³ã¨MPBçµ„æˆã®å¯è¦–åŒ–
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def pzt_phase_diagram():
    """
    PZTã®ç›¸å›³ã¨MPBï¼ˆMorphotropic Phase Boundaryï¼‰ã®å¯è¦–åŒ–
    """
    # çµ„æˆç¯„å›²ï¼ˆZrå«æœ‰ç‡ï¼‰
    x_Zr = np.linspace(0, 1, 500)

    # ã‚­ãƒ¥ãƒªãƒ¼æ¸©åº¦ã®çµ„æˆä¾å­˜æ€§ï¼ˆç°¡ç•¥ãƒ¢ãƒ‡ãƒ«ï¼‰
    T_c = 490 - 200 * x_Zr + 150 * x_Zr**2  # Â°C

    # åœ§é›»å®šæ•°ã®çµ„æˆä¾å­˜æ€§ï¼ˆMPBä»˜è¿‘ã§æœ€å¤§ï¼‰
    # MPBçµ„æˆ: x â‰ˆ 0.52
    x_MPB = 0.52
    d_33 = 200 + 400 * np.exp(-((x_Zr - x_MPB) / 0.1)**2)

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å·¦å›³: ç›¸å›³
    ax1 = axes[0]

    # ç›¸å¢ƒç•Œã®å®šç¾©ï¼ˆç°¡ç•¥åŒ–ï¼‰
    x_rhomb = x_Zr[x_Zr > x_MPB]
    x_tetra = x_Zr[x_Zr <= x_MPB]
    T_c_rhomb = T_c[x_Zr > x_MPB]
    T_c_tetra = T_c[x_Zr <= x_MPB]

    # é ˜åŸŸã®å¡—ã‚Šåˆ†ã‘
    ax1.fill_between(x_rhomb, 0, T_c_rhomb, alpha=0.3, color='blue', label='Rhombohedral (FE_R)')
    ax1.fill_between(x_tetra, 0, T_c_tetra, alpha=0.3, color='red', label='Tetragonal (FE_T)')
    ax1.fill_between(x_Zr, T_c, 500, alpha=0.2, color='gray', label='Cubic (Paraelectric)')

    # MPBç·š
    ax1.axvline(x=x_MPB, color='green', linestyle='--', linewidth=2, label=f'MPB (x = {x_MPB})')
    ax1.plot(x_Zr, T_c, 'k-', linewidth=2, label='Curie Temperature')

    ax1.set_xlabel('Zr Content x in Pb(Zr_xTi_{1-x})Oâ‚ƒ', fontsize=12)
    ax1.set_ylabel('Temperature (Â°C)', fontsize=12)
    ax1.set_title('PZT Phase Diagram', fontsize=14, fontweight='bold')
    ax1.set_xlim(0, 1)
    ax1.set_ylim(0, 500)
    ax1.legend(loc='upper right')
    ax1.grid(True, alpha=0.3)

    # å³å›³: åœ§é›»å®šæ•°ã®çµ„æˆä¾å­˜æ€§
    ax2 = axes[1]
    ax2.plot(x_Zr, d_33, linewidth=2, color='navy')
    ax2.axvline(x=x_MPB, color='green', linestyle='--', linewidth=2, label=f'MPB (x = {x_MPB})')
    ax2.scatter([x_MPB], [np.max(d_33)], s=200, c='red', marker='*', edgecolors='black',
                linewidth=2, zorder=5, label=f'dâ‚ƒâ‚ƒ max = {np.max(d_33):.0f} pC/N')

    ax2.set_xlabel('Zr Content x in Pb(Zr_xTi_{1-x})Oâ‚ƒ', fontsize=12)
    ax2.set_ylabel('Piezoelectric Constant dâ‚ƒâ‚ƒ (pC/N)', fontsize=12)
    ax2.set_title('PZT Piezoelectric Constant vs Composition', fontsize=14, fontweight='bold')
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('pzt_phase_diagram.png', dpi=300, bbox_inches='tight')
    plt.show()

    # æ•°å€¤ä¾‹
    print("=== PZT Composition Effects ===")
    compositions = [0.3, 0.4, 0.52, 0.6, 0.7]
    for x in compositions:
        idx = np.argmin(np.abs(x_Zr - x))
        T_c_val = T_c[idx]
        d_33_val = d_33[idx]
        phase = 'Tetragonal' if x < x_MPB else 'Rhombohedral'
        print(f"x = {x:.2f} ({phase:15s}): T_c = {T_c_val:5.1f}Â°C, dâ‚ƒâ‚ƒ = {d_33_val:5.0f} pC/N")

# å®Ÿè¡Œ
pzt_phase_diagram()
</code></pre>

            <div class="warning-box">
                <strong>é‰›ãƒ•ãƒªãƒ¼åœ§é›»ææ–™ã®é–‹ç™º</strong>
                PZTã¯é«˜æ€§èƒ½ã§ã™ãŒã€é‰›ï¼ˆPbï¼‰ã®ç’°å¢ƒè² è·ãŒå•é¡Œã§ã™ã€‚è¿‘å¹´ã€(K,Na)NbOâ‚ƒï¼ˆKNNï¼‰ã€(Bi,Na)TiOâ‚ƒï¼ˆBNTï¼‰ãªã©ã®é‰›ãƒ•ãƒªãƒ¼ææ–™ãŒç ”ç©¶ã•ã‚Œã¦ã„ã¾ã™ãŒã€PZTã®æ€§èƒ½ï¼ˆdâ‚ƒâ‚ƒ â‰ˆ 600 pC/Nï¼‰ã«åˆ°é”ã™ã‚‹ã«ã¯è‡³ã£ã¦ã„ã¾ã›ã‚“ï¼ˆKNN: ~300 pC/Nï¼‰ã€‚
            </div>
        </section>

        <section id="ionic">
            <h2>4.4 ã‚¤ã‚ªãƒ³ä¼å°ä½“ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹</h2>

            <h3>4.4.1 ã‚¤ã‚ªãƒ³ä¼å°ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ </h3>

            <p>
                ã‚¤ã‚ªãƒ³ä¼å°ä½“ã§ã¯ã€ã‚¤ã‚ªãƒ³ï¼ˆOÂ²â», Liâº, Naâºãªã©ï¼‰ãŒçµæ™¶æ ¼å­ä¸­ã‚’ç§»å‹•ã—ã¾ã™ã€‚ä¼å°åº¦ \( \sigma \) ã¯ã€Arrheniuså¼ã§è¡¨ã•ã‚Œã¾ã™ï¼š
            </p>

            <p>
                \[
                \sigma = \sigma_0 \exp\left(-\frac{E_a}{k_B T}\right)
                \]
            </p>

            <p>
                ã“ã“ã§ã€\( \sigma_0 \) ã¯å‰æŒ‡æ•°å› å­ã€\( E_a \) ã¯æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€\( k_B \) ã¯ãƒœãƒ«ãƒ„ãƒãƒ³å®šæ•°ã€\( T \) ã¯æ¸©åº¦ã§ã™ã€‚
            </p>

            <h3>4.4.2 YSZï¼ˆã‚¤ãƒƒãƒˆãƒªã‚¢å®‰å®šåŒ–ã‚¸ãƒ«ã‚³ãƒ‹ã‚¢ï¼‰</h3>

            <p>
                YSZï¼ˆ(Yâ‚‚Oâ‚ƒ)<sub>x</sub>(ZrOâ‚‚)<sub>1-x</sub>ï¼‰ã¯ã€SOFCï¼ˆå›ºä½“é…¸åŒ–ç‰©å½¢ç‡ƒæ–™é›»æ± ï¼‰ã®é›»è§£è³ªã¨ã—ã¦ä½¿ã‚ã‚Œã¾ã™ã€‚YÂ³âºãƒ‰ãƒ¼ãƒ—ã«ã‚ˆã‚Šé…¸ç´ ç©ºå­”ãŒç”Ÿæˆã•ã‚Œã€OÂ²â»ã‚¤ã‚ªãƒ³ãŒä¼å°ã—ã¾ã™ã€‚
            </p>

            <table>
                <thead>
                    <tr>
                        <th>ææ–™</th>
                        <th>ä¼å°ã‚¤ã‚ªãƒ³</th>
                        <th>Ïƒ (S/cm) @ 800Â°C</th>
                        <th>E<sub>a</sub> (eV)</th>
                        <th>ç”¨é€”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>YSZ (8mol% Yâ‚‚Oâ‚ƒ)</td>
                        <td>OÂ²â»</td>
                        <td>0.1</td>
                        <td>1.0</td>
                        <td>SOFCé›»è§£è³ª</td>
                    </tr>
                    <tr>
                        <td>LLZO (Liâ‚‡Laâ‚ƒZrâ‚‚Oâ‚â‚‚)</td>
                        <td>Liâº</td>
                        <td>0.05 (å®¤æ¸©)</td>
                        <td>0.3</td>
                        <td>å…¨å›ºä½“é›»æ± </td>
                    </tr>
                    <tr>
                        <td>Î²-Alâ‚‚Oâ‚ƒ</td>
                        <td>Naâº</td>
                        <td>0.2 (300Â°C)</td>
                        <td>0.16</td>
                        <td>Na-Sé›»æ± </td>
                    </tr>
                    <tr>
                        <td>GDC (Ceâ‚€.â‚‰Gdâ‚€.â‚Oâ‚.â‚‰â‚…)</td>
                        <td>OÂ²â»</td>
                        <td>0.02</td>
                        <td>0.7</td>
                        <td>ä½æ¸©SOFC</td>
                    </tr>
                </tbody>
            </table>

            <h4>Pythonå®Ÿè£…: Arrheniusä¼å°åº¦ã¨æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼</h4>

            <pre><code class="language-python"># ===================================
# Example 5: Arrheniusä¼å°åº¦è¨ˆç®—
# ===================================

import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def ionic_conductivity(T, sigma_0, E_a, k_B=8.617e-5):
    """
    Arrheniuså¼ã«ã‚ˆã‚‹ã‚¤ã‚ªãƒ³ä¼å°åº¦ã®è¨ˆç®—

    Parameters:
    -----------
    T : float or array
        æ¸©åº¦ [K]
    sigma_0 : float
        å‰æŒ‡æ•°å› å­ [S/cm]
    E_a : float
        æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]
    k_B : float
        ãƒœãƒ«ãƒ„ãƒãƒ³å®šæ•° [eV/K]

    Returns:
    --------
    sigma : float or array
        ã‚¤ã‚ªãƒ³ä¼å°åº¦ [S/cm]
    """
    sigma = sigma_0 * np.exp(-E_a / (k_B * T))
    return sigma


def fit_arrhenius_data(T_data, sigma_data):
    """
    å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰Arrhenius ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°

    Parameters:
    -----------
    T_data : array
        æ¸©åº¦ãƒ‡ãƒ¼ã‚¿ [K]
    sigma_data : array
        ä¼å°åº¦ãƒ‡ãƒ¼ã‚¿ [S/cm]

    Returns:
    --------
    sigma_0 : float
        å‰æŒ‡æ•°å› å­ [S/cm]
    E_a : float
        æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]
    """
    # å¯¾æ•°å¤‰æ›: ln(Ïƒ) = ln(Ïƒâ‚€) - E_a/(k_BÂ·T)
    # y = ln(Ïƒ), x = 1/T, slope = -E_a/k_B, intercept = ln(Ïƒâ‚€)

    x = 1 / T_data
    y = np.log(sigma_data)

    # ç·šå½¢å›å¸°
    coeffs = np.polyfit(x, y, 1)
    slope = coeffs[0]
    intercept = coeffs[1]

    E_a = -slope * 8.617e-5  # eV
    sigma_0 = np.exp(intercept)

    return sigma_0, E_a


def plot_ionic_conductivity():
    """
    ã‚¤ã‚ªãƒ³ä¼å°åº¦ã®Arrhenius plotã¨ææ–™æ¯”è¼ƒ
    """
    # å„ææ–™ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    materials_ionic = {
        'YSZ (8YSZ)': {'sigma_0': 2.5e4, 'E_a': 1.0, 'color': 'navy'},
        'GDC': {'sigma_0': 1.0e4, 'E_a': 0.7, 'color': 'green'},
        'LLZO': {'sigma_0': 1.0e2, 'E_a': 0.3, 'color': 'red'},
        'Î²-Alâ‚‚Oâ‚ƒ': {'sigma_0': 5.0e2, 'E_a': 0.16, 'color': 'purple'}
    }

    # æ¸©åº¦ç¯„å›²
    T_range = np.linspace(300, 1200, 500)  # K

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å·¦å›³: Arrhenius plot
    ax1 = axes[0]

    for name, params in materials_ionic.items():
        sigma = ionic_conductivity(T_range, params['sigma_0'], params['E_a'])
        ax1.semilogy(1e4 / T_range, sigma, linewidth=2, label=name, color=params['color'])

    ax1.set_xlabel('10^4 / T (K^-1)', fontsize=12)
    ax1.set_ylabel('Ionic Conductivity Ïƒ (S/cm)', fontsize=12)
    ax1.set_title('Arrhenius Plot for Ionic Conductors', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3, which='both')

    # å³å›³: å®Ÿæ¸©åº¦ã§ã®ä¼å°åº¦æ¯”è¼ƒ
    ax2 = axes[1]

    temperatures_celsius = [400, 600, 800, 1000]
    x_pos = np.arange(len(temperatures_celsius))
    width = 0.2

    for i, (name, params) in enumerate(materials_ionic.items()):
        sigma_values = [ionic_conductivity(T + 273.15, params['sigma_0'], params['E_a'])
                       for T in temperatures_celsius]
        ax2.bar(x_pos + i * width, sigma_values, width, label=name, color=params['color'], edgecolor='black')

    ax2.set_xlabel('Temperature (Â°C)', fontsize=12)
    ax2.set_ylabel('Ionic Conductivity Ïƒ (S/cm)', fontsize=12)
    ax2.set_title('Conductivity Comparison at Different Temperatures', fontsize=14, fontweight='bold')
    ax2.set_xticks(x_pos + width * 1.5)
    ax2.set_xticklabels(temperatures_celsius)
    ax2.set_yscale('log')
    ax2.legend()
    ax2.grid(True, alpha=0.3, which='both')

    plt.tight_layout()
    plt.savefig('ionic_conductivity.png', dpi=300, bbox_inches='tight')
    plt.show()

    # æ•°å€¤ä¾‹
    print("=== Ionic Conductivity at SOFC Operating Temperature (800Â°C) ===")
    T_SOFC = 800 + 273.15
    for name, params in materials_ionic.items():
        sigma = ionic_conductivity(T_SOFC, params['sigma_0'], params['E_a'])
        print(f"{name:15s}: Ïƒ = {sigma:.4f} S/cm, E_a = {params['E_a']:.2f} eV")

# å®Ÿè¡Œ
plot_ionic_conductivity()
</code></pre>

            <h4>Pythonå®Ÿè£…: YSZã‚¤ã‚ªãƒ³ä¼å°åº¦ã®æ¸©åº¦ä¾å­˜æ€§</h4>

            <pre><code class="language-python"># ===================================
# Example 6: YSZä¼å°åº¦ã®è©³ç´°è§£æ
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def ysz_conductivity_vs_doping():
    """
    YSZã®Yâ‚‚Oâ‚ƒãƒ‰ãƒ¼ãƒ—é‡ã¨ä¼å°åº¦ã®é–¢ä¿‚
    """
    # Yâ‚‚Oâ‚ƒãƒ‰ãƒ¼ãƒ—é‡ï¼ˆmol%ï¼‰
    doping_levels = np.array([3, 5, 8, 10, 12, 15])

    # 800Â°Cã§ã®ä¼å°åº¦ï¼ˆå®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãï¼‰
    sigma_800C = np.array([0.02, 0.06, 0.10, 0.08, 0.05, 0.03])

    # æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼
    E_a_values = np.array([1.1, 1.05, 1.0, 1.05, 1.15, 1.2])

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å·¦å›³: ãƒ‰ãƒ¼ãƒ—é‡ã¨ä¼å°åº¦
    ax1 = axes[0]
    ax1.plot(doping_levels, sigma_800C, 'o-', linewidth=2, markersize=10, color='navy')
    ax1.axvline(x=8, color='red', linestyle='--', linewidth=2, label='Optimal: 8 mol%')

    ax1.set_xlabel('Yâ‚‚Oâ‚ƒ Content (mol%)', fontsize=12)
    ax1.set_ylabel('Ionic Conductivity Ïƒ (S/cm) @ 800Â°C', fontsize=12)
    ax1.set_title('YSZ Conductivity vs Doping Level', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # å³å›³: æ¸©åº¦ä¾å­˜æ€§ï¼ˆå„ãƒ‰ãƒ¼ãƒ—é‡ï¼‰
    ax2 = axes[1]
    T_range = np.linspace(600, 1200, 100) + 273.15

    for i, doping in enumerate([5, 8, 10]):
        idx = np.where(doping_levels == doping)[0][0]
        sigma_0_calc = sigma_800C[idx] / np.exp(-E_a_values[idx] / (8.617e-5 * (800 + 273.15)))
        sigma_T = ionic_conductivity(T_range, sigma_0_calc, E_a_values[idx])

        ax2.semilogy(T_range - 273.15, sigma_T, linewidth=2, label=f'{doping} mol% Yâ‚‚Oâ‚ƒ')

    ax2.set_xlabel('Temperature (Â°C)', fontsize=12)
    ax2.set_ylabel('Ionic Conductivity Ïƒ (S/cm)', fontsize=12)
    ax2.set_title('YSZ Conductivity vs Temperature', fontsize=14, fontweight='bold')
    ax2.legend()
    ax2.grid(True, alpha=0.3, which='both')

    plt.tight_layout()
    plt.savefig('ysz_conductivity_analysis.png', dpi=300, bbox_inches='tight')
    plt.show()

    # æ•°å€¤ä¾‹
    print("=== YSZ Doping Level Effects ===")
    for i, doping in enumerate(doping_levels):
        print(f"{doping:2d} mol% Yâ‚‚Oâ‚ƒ: Ïƒ(800Â°C) = {sigma_800C[i]:.3f} S/cm, E_a = {E_a_values[i]:.2f} eV")

# å®Ÿè¡Œ
ysz_conductivity_vs_doping()
</code></pre>

            <div class="info-box">
                <strong>SOFCã®å‹•ä½œåŸç†ã¨YSZã®å½¹å‰²</strong>
                SOFCï¼ˆå›ºä½“é…¸åŒ–ç‰©å½¢ç‡ƒæ–™é›»æ± ï¼‰ã§ã¯ã€YSZé›»è§£è³ªã‚’ä»‹ã—ã¦OÂ²â»ã‚¤ã‚ªãƒ³ãŒé™°æ¥µã‹ã‚‰é™½æ¥µã¸ç§»å‹•ã—ã€æ°´ç´ ã¨åå¿œã—ã¦æ°´ã‚’ç”Ÿæˆã—ã¾ã™ã€‚800-1000Â°Cã®é«˜æ¸©å‹•ä½œã«ã‚ˆã‚Šã€0.1 S/cmä»¥ä¸Šã®ä¼å°åº¦ãŒå¾—ã‚‰ã‚Œã€é«˜åŠ¹ç‡ç™ºé›»ï¼ˆ45-60%ï¼‰ã‚’å®Ÿç¾ã—ã¾ã™ã€‚
            </div>
        </section>

        <section id="luminescence">
            <h2>4.5 ç™ºå…‰ææ–™ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹</h2>

            <h3>4.5.1 è›å…‰ä½“ã®ç™ºå…‰ãƒ¡ã‚«ãƒ‹ã‚ºãƒ </h3>

            <p>
                è›å…‰ä½“ã¯ã€åŠ±èµ·ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆé›»å­ç·šã€UVã€é’è‰²LEDï¼‰ã‚’å¸åã—ã€å¯è¦–å…‰ã‚’æ”¾å‡ºã—ã¾ã™ã€‚ç™ºå…‰ä¸­å¿ƒã¨ãªã‚‹å¸ŒåœŸé¡ã‚¤ã‚ªãƒ³ï¼ˆCeÂ³âº, EuÂ²âº, EuÂ³âºãªã©ï¼‰ãŒã€æ¯ä½“çµæ™¶ï¼ˆYAG, CaS, SrSiOâ‚…ãªã©ï¼‰ä¸­ã«ãƒ‰ãƒ¼ãƒ—ã•ã‚Œã¾ã™ã€‚
            </p>

            <p>
                ç™ºå…‰åŠ¹ç‡ï¼ˆé‡å­åŠ¹ç‡ï¼‰ã¯ï¼š
            </p>

            <p>
                \[
                \eta = \frac{\text{æ”¾å‡ºå…‰å­æ•°}}{\text{å¸åå…‰å­æ•°}} \times 100\%
                \]
            </p>

            <h3>4.5.2 ç™½è‰²LEDç”¨YAG:Ceè›å…‰ä½“</h3>

            <p>
                YAG:Ceï¼ˆYâ‚ƒAlâ‚…Oâ‚â‚‚:CeÂ³âºï¼‰ã¯ã€é’è‰²LEDï¼ˆ450-470 nmï¼‰ã§åŠ±èµ·ã•ã‚Œã€é»„è‰²å…‰ï¼ˆ500-650 nmï¼‰ã‚’æ”¾å‡ºã—ã¾ã™ã€‚é’è‰²å…‰ã¨ã®æ··è‰²ã«ã‚ˆã‚Šã€ç™½è‰²å…‰ã‚’å®Ÿç¾ã—ã¾ã™ã€‚
            </p>

            <h4>Pythonå®Ÿè£…: CIEè‰²åº¦åº§æ¨™ã®è¨ˆç®—</h4>

            <pre><code class="language-python"># ===================================
# Example 7: CIEè‰²åº¦åº§æ¨™è¨ˆç®—
# ===================================

import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import simpson

def gaussian_emission_spectrum(wavelength, peak, fwhm, intensity=1.0):
    """
    ã‚¬ã‚¦ã‚¹å‹ç™ºå…‰ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ç”Ÿæˆ

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· [nm]
    peak : float
        ãƒ”ãƒ¼ã‚¯æ³¢é•· [nm]
    fwhm : float
        åŠå€¤å…¨å¹… (FWHM) [nm]
    intensity : float
        å¼·åº¦ï¼ˆä»»æ„å˜ä½ï¼‰

    Returns:
    --------
    spectrum : array
        ç™ºå…‰å¼·åº¦
    """
    sigma = fwhm / (2 * np.sqrt(2 * np.log(2)))
    spectrum = intensity * np.exp(-((wavelength - peak)**2) / (2 * sigma**2))
    return spectrum


def cie_xyz_from_spectrum(wavelength, spectrum):
    """
    ç™ºå…‰ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰CIE XYZå€¤ã‚’è¨ˆç®—ï¼ˆç°¡ç•¥ç‰ˆï¼‰

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· [nm]
    spectrum : array
        ç™ºå…‰å¼·åº¦

    Returns:
    --------
    X, Y, Z : float
        CIEä¸‰åˆºæ¿€å€¤
    """
    # CIE 1931æ¨™æº–è¦³æ¸¬è€…ã®ç°¡ç•¥ãƒ¢ãƒ‡ãƒ«ï¼ˆå®Ÿéš›ã¯æ¨™æº–ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰
    # ã“ã“ã§ã¯ç°¡å˜ã®ãŸã‚ã‚¬ã‚¦ã‚¹è¿‘ä¼¼

    # xÌ„(Î»): èµ¤éŒä½“æ„Ÿåº¦ï¼ˆãƒ”ãƒ¼ã‚¯ 600 nmï¼‰
    x_bar = gaussian_emission_spectrum(wavelength, 600, 50, 1.0)

    # È³(Î»): ç·‘éŒä½“æ„Ÿåº¦ï¼ˆãƒ”ãƒ¼ã‚¯ 550 nmï¼‰
    y_bar = gaussian_emission_spectrum(wavelength, 550, 50, 1.0)

    # zÌ„(Î»): é’éŒä½“æ„Ÿåº¦ï¼ˆãƒ”ãƒ¼ã‚¯ 450 nmï¼‰
    z_bar = gaussian_emission_spectrum(wavelength, 450, 50, 1.0)

    # ç©åˆ†
    X = simpson(spectrum * x_bar, wavelength)
    Y = simpson(spectrum * y_bar, wavelength)
    Z = simpson(spectrum * z_bar, wavelength)

    return X, Y, Z


def plot_yag_ce_emission():
    """
    YAG:Ceç™ºå…‰ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨CIEè‰²åº¦åº§æ¨™
    """
    # æ³¢é•·ç¯„å›²
    wavelength = np.linspace(380, 780, 400)

    # é’è‰²LEDï¼ˆåŠ±èµ·å…‰ï¼‰
    blue_led = gaussian_emission_spectrum(wavelength, 460, 20, 1.0)

    # YAG:Ceç™ºå…‰ï¼ˆé»„è‰²ï¼‰
    yag_ce_emission = gaussian_emission_spectrum(wavelength, 560, 100, 0.8)

    # åˆæˆã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆç™½è‰²å…‰ï¼‰
    white_light = blue_led + yag_ce_emission

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å·¦å›³: ç™ºå…‰ã‚¹ãƒšã‚¯ãƒˆãƒ«
    ax1 = axes[0]
    ax1.fill_between(wavelength, 0, blue_led, alpha=0.5, color='blue', label='Blue LED (460 nm)')
    ax1.fill_between(wavelength, 0, yag_ce_emission, alpha=0.5, color='yellow', label='YAG:Ce (560 nm)')
    ax1.plot(wavelength, white_light, 'k-', linewidth=2, label='White Light (combined)')

    ax1.set_xlabel('Wavelength (nm)', fontsize=12)
    ax1.set_ylabel('Intensity (a.u.)', fontsize=12)
    ax1.set_title('YAG:Ce White LED Emission Spectrum', fontsize=14, fontweight='bold')
    ax1.set_xlim(380, 780)
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # å³å›³: CIE 1931è‰²åº¦å›³ï¼ˆç°¡ç•¥ç‰ˆï¼‰
    ax2 = axes[1]

    # CIEè‰²åº¦åº§æ¨™ã®è¨ˆç®—
    X_blue, Y_blue, Z_blue = cie_xyz_from_spectrum(wavelength, blue_led)
    x_blue = X_blue / (X_blue + Y_blue + Z_blue)
    y_blue = Y_blue / (X_blue + Y_blue + Z_blue)

    X_yellow, Y_yellow, Z_yellow = cie_xyz_from_spectrum(wavelength, yag_ce_emission)
    x_yellow = X_yellow / (X_yellow + Y_yellow + Z_yellow)
    y_yellow = Y_yellow / (X_yellow + Y_yellow + Z_yellow)

    X_white, Y_white, Z_white = cie_xyz_from_spectrum(wavelength, white_light)
    x_white = X_white / (X_white + Y_white + Z_white)
    y_white = Y_white / (X_white + Y_white + Z_white)

    # ãƒ—ãƒ­ãƒƒãƒˆ
    ax2.scatter(x_blue, y_blue, s=200, c='blue', marker='o', edgecolors='black', linewidth=2, label='Blue LED')
    ax2.scatter(x_yellow, y_yellow, s=200, c='yellow', marker='s', edgecolors='black', linewidth=2, label='YAG:Ce')
    ax2.scatter(x_white, y_white, s=250, c='white', marker='*', edgecolors='black', linewidth=2, label='White Light', zorder=5)

    # è‰²æ¸©åº¦ç·šï¼ˆç°¡ç•¥ï¼‰
    blackbody_x = np.array([0.45, 0.40, 0.35, 0.31])
    blackbody_y = np.array([0.41, 0.40, 0.38, 0.33])
    ax2.plot(blackbody_x, blackbody_y, 'k--', linewidth=1, alpha=0.5, label='Blackbody Locus')

    ax2.set_xlabel('CIE x', fontsize=12)
    ax2.set_ylabel('CIE y', fontsize=12)
    ax2.set_title('CIE 1931 Chromaticity Diagram', fontsize=14, fontweight='bold')
    ax2.set_xlim(0, 0.8)
    ax2.set_ylim(0, 0.9)
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('yag_ce_emission.png', dpi=300, bbox_inches='tight')
    plt.show()

    # æ•°å€¤çµæœ
    print("=== CIE Chromaticity Coordinates ===")
    print(f"Blue LED:  (x, y) = ({x_blue:.3f}, {y_blue:.3f})")
    print(f"YAG:Ce:    (x, y) = ({x_yellow:.3f}, {y_yellow:.3f})")
    print(f"White Light: (x, y) = ({x_white:.3f}, {y_white:.3f})")
    print(f"\nColor Temperature: ~5000-6000 K (cool white)")

# å®Ÿè¡Œ
plot_yag_ce_emission()
</code></pre>

            <div class="info-box">
                <strong>ç™½è‰²LEDè›å…‰ä½“ã®è¨­è¨ˆ</strong>
                ç†æƒ³çš„ãªç™½è‰²å…‰ï¼ˆè‰²æ¸©åº¦5000 Kã€æ¼”è‰²æ€§Ra > 80ï¼‰ã«ã¯ã€YAG:Ceå˜ç‹¬ã§ã¯ä¸ååˆ†ã§ã™ã€‚èµ¤è‰²æˆåˆ†ã‚’è£œã†ãŸã‚ã€CaAlSiNâ‚ƒ:EuÂ²âºï¼ˆçª’åŒ–ç‰©èµ¤è‰²è›å…‰ä½“ï¼‰ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€æ¼”è‰²æ€§Ra > 90ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚
            </div>
        </section>

        <section id="magnetic">
            <h2>4.6 ç£æ€§ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹</h2>

            <h3>4.6.1 ãƒ•ã‚§ãƒ©ã‚¤ãƒˆã®ç£æ€§</h3>

            <p>
                ãƒ•ã‚§ãƒ©ã‚¤ãƒˆã¯ã€ä¸€èˆ¬å¼ MFeâ‚‚Oâ‚„ï¼ˆM = Mn, Ni, Zn, Coï¼‰ã§è¡¨ã•ã‚Œã‚‹é…¸åŒ–ç‰©ç£æ€§ä½“ã§ã™ã€‚ã‚¹ãƒ”ãƒãƒ«æ§‹é€ ã‚’æŒã¡ã€ãƒ•ã‚§ãƒªç£æ€§ã‚’ç¤ºã—ã¾ã™ã€‚é›»æ°—æŠµæŠ—ãŒé«˜ã„ãŸã‚ï¼ˆ>10â¶ Î©Â·cmï¼‰ã€é«˜å‘¨æ³¢ç”¨é€”ã«é©ã—ã¦ã„ã¾ã™ã€‚
            </p>

            <h3>4.6.2 ä¸»è¦ç‰¹æ€§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿</h3>

            <ul>
                <li><strong>é£½å’Œç£åŒ– M<sub>s</sub></strong>: æœ€å¤§ç£åŒ–ï¼ˆT = ãƒ†ã‚¹ãƒ©ï¼‰</li>
                <li><strong>ä¿ç£åŠ› H<sub>c</sub></strong>: ç£åŒ–ã‚’åè»¢ã•ã›ã‚‹ç£å ´ï¼ˆA/mï¼‰</li>
                <li><strong>é€ç£ç‡ Î¼<sub>r</sub></strong>: ç£æ°—é€éç‡ï¼ˆç„¡æ¬¡å…ƒï¼‰</li>
                <li><strong>ã‚­ãƒ¥ãƒªãƒ¼æ¸©åº¦ T<sub>c</sub></strong>: å¼·ç£æ€§â†’å¸¸ç£æ€§è»¢ç§»æ¸©åº¦ï¼ˆÂ°Cï¼‰</li>
            </ul>

            <table>
                <thead>
                    <tr>
                        <th>ææ–™</th>
                        <th>M<sub>s</sub> (T)</th>
                        <th>H<sub>c</sub> (A/m)</th>
                        <th>Î¼<sub>r</sub></th>
                        <th>ç”¨é€”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>MnZn-ferrite</td>
                        <td>0.35</td>
                        <td>10-20</td>
                        <td>2000-5000</td>
                        <td>ãƒˆãƒ©ãƒ³ã‚¹ã‚³ã‚¢</td>
                    </tr>
                    <tr>
                        <td>NiZn-ferrite</td>
                        <td>0.30</td>
                        <td>15-30</td>
                        <td>100-1000</td>
                        <td>é«˜å‘¨æ³¢ã‚³ã‚¢</td>
                    </tr>
                    <tr>
                        <td>BaFeâ‚â‚‚Oâ‚â‚‰ (M-type)</td>
                        <td>0.48</td>
                        <td>200k-400k</td>
                        <td>1.1</td>
                        <td>æ°¸ä¹…ç£çŸ³</td>
                    </tr>
                    <tr>
                        <td>CoFeâ‚‚Oâ‚„</td>
                        <td>0.53</td>
                        <td>5k-10k</td>
                        <td>10-50</td>
                        <td>ç£æ°—è¨˜éŒ²</td>
                    </tr>
                </tbody>
            </table>

            <h4>Pythonå®Ÿè£…: ãƒ•ã‚§ãƒ©ã‚¤ãƒˆç£åŒ–ç‰¹æ€§ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>

            <pre><code class="language-python"># ===================================
# Example 8: ãƒ•ã‚§ãƒ©ã‚¤ãƒˆç£åŒ–æ›²ç·š
# ===================================

import numpy as np
import matplotlib.pyplot as plt

def langevin_function(x):
    """
    Langeviné–¢æ•°ï¼ˆå¸¸ç£æ€§ã®ç£åŒ–ï¼‰

    Parameters:
    -----------
    x : float or array
        å¼•æ•° (Î¼H/kT)

    Returns:
    --------
    L(x) : float or array
        Langeviné–¢æ•°ã®å€¤
    """
    # å°ã•ã„xã§ç™ºæ•£ã‚’é¿ã‘ã‚‹
    with np.errstate(divide='ignore', invalid='ignore'):
        L = np.where(np.abs(x) < 1e-3, x / 3, 1 / np.tanh(x) - 1 / x)
    return L


def ferrite_magnetization_curve(H, M_s=0.35, H_c=15, a=1000):
    """
    ãƒ•ã‚§ãƒ©ã‚¤ãƒˆã®ç£åŒ–æ›²ç·šï¼ˆç°¡ç•¥ãƒ¢ãƒ‡ãƒ«ï¼‰

    Parameters:
    -----------
    H : array
        ç£å ´ [A/m]
    M_s : float
        é£½å’Œç£åŒ– [T]
    H_c : float
        ä¿ç£åŠ› [A/m]
    a : float
        å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

    Returns:
    --------
    M : array
        ç£åŒ– [T]
    """
    # tanhãƒ™ãƒ¼ã‚¹ã®ç°¡ç•¥ãƒ¢ãƒ‡ãƒ«
    M = M_s * np.tanh((H - H_c) / a) if isinstance(H, (int, float)) else \
        M_s * np.tanh((H - H_c) / a)
    return M


def plot_ferrite_properties():
    """
    ãƒ•ã‚§ãƒ©ã‚¤ãƒˆã®ç£æ°—ç‰¹æ€§ã‚’å¯è¦–åŒ–
    """
    # ç£å ´ç¯„å›²
    H_range = np.linspace(-5000, 5000, 1000)

    fig, axes = plt.subplots(1, 2, figsize=(14, 5))

    # å·¦å›³: è»Ÿç£æ€§ãƒ•ã‚§ãƒ©ã‚¤ãƒˆï¼ˆMnZnï¼‰
    ax1 = axes[0]

    M_s_soft = 0.35
    H_c_soft = 15
    M_soft = M_s_soft * np.tanh(H_range / 500)

    ax1.plot(H_range, M_soft, linewidth=2, color='navy')
    ax1.axhline(y=M_s_soft, color='red', linestyle='--', linewidth=1, alpha=0.5, label=f'M_s = {M_s_soft} T')
    ax1.axhline(y=-M_s_soft, color='red', linestyle='--', linewidth=1, alpha=0.5)
    ax1.axvline(x=0, color='black', linestyle='-', linewidth=0.5)
    ax1.axhline(y=0, color='black', linestyle='-', linewidth=0.5)

    ax1.set_xlabel('Magnetic Field H (A/m)', fontsize=12)
    ax1.set_ylabel('Magnetization M (T)', fontsize=12)
    ax1.set_title('Soft Ferrite (MnZn) M-H Curve', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # å³å›³: ç¡¬ç£æ€§ãƒ•ã‚§ãƒ©ã‚¤ãƒˆï¼ˆBaFeâ‚â‚‚Oâ‚â‚‰ï¼‰
    ax2 = axes[1]

    M_s_hard = 0.48
    H_c_hard = 250000  # 250 kA/m
    H_hard = np.linspace(-400000, 400000, 1000)
    M_hard = M_s_hard * np.tanh((H_hard - H_c_hard) / 50000)

    # ãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹ãƒ«ãƒ¼ãƒ—ã®è¿‘ä¼¼
    M_hard_up = M_s_hard * np.tanh((H_hard + H_c_hard) / 50000)
    M_hard_down = M_s_hard * np.tanh((H_hard - H_c_hard) / 50000)

    ax2.plot(H_hard / 1000, M_hard_up, linewidth=2, color='blue', label='Ascending')
    ax2.plot(H_hard / 1000, M_hard_down, linewidth=2, color='red', label='Descending')
    ax2.axvline(x=H_c_hard / 1000, color='green', linestyle='--', linewidth=2, label=f'H_c = {H_c_hard/1000:.0f} kA/m')
    ax2.axvline(x=-H_c_hard / 1000, color='green', linestyle='--', linewidth=2)

    ax2.set_xlabel('Magnetic Field H (kA/m)', fontsize=12)
    ax2.set_ylabel('Magnetization M (T)', fontsize=12)
    ax2.set_title('Hard Ferrite (BaFeâ‚â‚‚Oâ‚â‚‰) Hysteresis Loop', fontsize=14, fontweight='bold')
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('ferrite_magnetization.png', dpi=300, bbox_inches='tight')
    plt.show()

    # æ•°å€¤ä¾‹
    print("=== Ferrite Magnetic Properties ===")
    print("\nSoft Ferrite (MnZn):")
    print(f"  M_s = {M_s_soft} T, H_c = {H_c_soft} A/m")
    print(f"  Application: High permeability (Î¼_r ~ 2000-5000), transformer cores")

    print("\nHard Ferrite (BaFeâ‚â‚‚Oâ‚â‚‰):")
    print(f"  M_s = {M_s_hard} T, H_c = {H_c_hard/1000} kA/m")
    print(f"  Application: Permanent magnets, motors, speakers")

# å®Ÿè¡Œ
plot_ferrite_properties()
</code></pre>

            <div class="warning-box">
                <strong>ã‚½ãƒ•ãƒˆç£æ€§ã¨ãƒãƒ¼ãƒ‰ç£æ€§ã®ç”¨é€”åˆ†é›¢</strong>
                ã‚½ãƒ•ãƒˆãƒ•ã‚§ãƒ©ã‚¤ãƒˆï¼ˆä½H<sub>c</sub>ã€é«˜Î¼<sub>r</sub>ï¼‰ã¯ã€ç£åŒ–ãŒå®¹æ˜“ã«åè»¢ã™ã‚‹ãŸã‚ã€ãƒˆãƒ©ãƒ³ã‚¹ã‚„ã‚¤ãƒ³ãƒ€ã‚¯ã‚¿ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ä¸€æ–¹ã€ãƒãƒ¼ãƒ‰ãƒ•ã‚§ãƒ©ã‚¤ãƒˆï¼ˆé«˜H<sub>c</sub>ï¼‰ã¯ã€ç£åŒ–ãŒå®‰å®šã§æ°¸ä¹…ç£çŸ³ã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚ä¸¡è€…ã¯çµ„æˆï¼ˆMn/Zn vs Ba/Srï¼‰ã¨ç„¼çµæ¡ä»¶ã§åˆ¶å¾¡ã•ã‚Œã¾ã™ã€‚
            </div>
        </section>

        <section id="exercises">
            <h2>æ¼”ç¿’å•é¡Œ</h2>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-1: Clausius-Mossottiå¼ã®å¿œç”¨<span class="difficulty easy">æ˜“</span></h4>
                <p>
                    TiOâ‚‚ã®åˆ†æ¥µç‡Î± = 2.5Ã—10â»â´â° CÂ·mÂ²/Vã€ã‚¤ã‚ªãƒ³å¯†åº¦N = 5Ã—10Â²â¸ mâ»Â³ã®ã¨ãã€æ¯”èª˜é›»ç‡Îµ<sub>r</sub>ã‚’è¨ˆç®—ã—ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">alpha = 2.5e-40
N = 5e28
epsilon_r = clausius_mossotti_permittivity(alpha, N)
print(f"Îµáµ£ = {epsilon_r:.1f}")
# å‡ºåŠ›: Îµáµ£ â‰ˆ 80
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-2: MLCCå®¹é‡è¨­è¨ˆ<span class="difficulty easy">æ˜“</span></h4>
                <p>
                    1 Î¼Fã®MLCCã‚’è¨­è¨ˆã—ã¾ã™ã€‚Îµ<sub>r</sub>=3000ã€é›»æ¥µé¢ç©1 mmÂ²ã€å±¤åšã¿5 Î¼mã®ã¨ãã€å¿…è¦ãªç©å±¤æ•°nã‚’è¨ˆç®—ã—ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">C_target = 1e-6  # 1 Î¼F
epsilon_r = 3000
A = (1e-3)**2
d = 5e-6
epsilon_0 = 8.854e-12

n = (C_target * d) / (epsilon_0 * epsilon_r * A)
print(f"å¿…è¦ãªç©å±¤æ•° n = {n:.0f}")
# å‡ºåŠ›: n â‰ˆ 377å±¤
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-3: åœ§é›»å¤‰ä½ã®è¨ˆç®—<span class="difficulty easy">æ˜“</span></h4>
                <p>
                    PZT-5Hï¼ˆdâ‚ƒâ‚ƒ = 593 pC/Nï¼‰ã«é›»å ´1 MV/mã‚’å°åŠ ã—ãŸã¨ãã€1 mmåšã®è©¦é¨“ç‰‡ã®å¤‰ä½ã‚’è¨ˆç®—ã—ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">d_33 = 593e-12
E = 1e6
thickness = 1e-3

strain = piezoelectric_strain(d_33, E)
displacement = strain * thickness
print(f"å¤‰ä½ = {displacement*1e9:.1f} nm")
# å‡ºåŠ›: å¤‰ä½ â‰ˆ 593 nm
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-4: Arrheniusæ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®æ¨å®š<span class="difficulty medium">ä¸­</span></h4>
                <p>
                    YSZã®ä¼å°åº¦ãŒã€700Â°Cã§0.05 S/cmã€900Â°Cã§0.15 S/cmã§ã—ãŸã€‚æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼E<sub>a</sub>ã‚’æ±‚ã‚ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">T1 = 700 + 273.15
T2 = 900 + 273.15
sigma1 = 0.05
sigma2 = 0.15
k_B = 8.617e-5

# ln(Ïƒâ‚‚/Ïƒâ‚) = -E_a/k_B Ã— (1/Tâ‚‚ - 1/Tâ‚)
E_a = -k_B * np.log(sigma2 / sigma1) / (1/T2 - 1/T1)
print(f"E_a = {E_a:.2f} eV")
# å‡ºåŠ›: E_a â‰ˆ 0.95 eV
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-5: ç™½è‰²LEDè‰²æ¸©åº¦ã®èª¿æ•´<span class="difficulty medium">ä¸­</span></h4>
                <p>
                    é’è‰²LEDï¼ˆ460 nmï¼‰ã¨YAG:Ceï¼ˆ560 nmï¼‰ã®å¼·åº¦æ¯”ã‚’å¤‰ãˆã¦ã€è‰²æ¸©åº¦ã‚’4000 Kï¼ˆæ¸©ç™½è‰²ï¼‰ã‹ã‚‰6500 Kï¼ˆæ˜¼ç™½è‰²ï¼‰ã«èª¿æ•´ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python"># è‰²æ¸©åº¦ã‚’ä¸Šã’ã‚‹ï¼ˆæ˜¼ç™½è‰²ï¼‰ã«ã¯ã€é’è‰²æˆåˆ†ã‚’å¢—ã‚„ã™
# YAG:Ceç™ºå…‰å¼·åº¦ã‚’æ¸›ã‚‰ã™ã‹ã€YAG:Ceå±¤ã‚’è–„ãã™ã‚‹

# 4000 K: é’/é»„ = 1.0
# 6500 K: é’/é»„ = 1.5

print("è‰²æ¸©åº¦ã‚’ä¸Šã’ã‚‹ã«ã¯:")
print("1. YAG:Ceè›å…‰ä½“å±¤ã‚’è–„ãã™ã‚‹ï¼ˆé»„è‰²æ¸›å°‘ï¼‰")
print("2. YAG:Ceæ¿ƒåº¦ã‚’ä¸‹ã’ã‚‹")
print("3. é’è‰²LEDå‡ºåŠ›ã‚’ä¸Šã’ã‚‹")
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-6: PZTçµ„æˆæœ€é©åŒ–<span class="difficulty medium">ä¸­</span></h4>
                <p>
                    PZTã®Zr/Tiæ¯”ã‚’å¤‰ãˆã¦ã€dâ‚ƒâ‚ƒãŒæœ€å¤§ã¨ãªã‚‹çµ„æˆï¼ˆMPBï¼‰ã‚’è¦‹ã¤ã‘ã‚‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">x_Zr = np.linspace(0, 1, 100)
x_MPB = 0.52
d_33 = 200 + 400 * np.exp(-((x_Zr - x_MPB) / 0.1)**2)

max_idx = np.argmax(d_33)
print(f"æœ€é©çµ„æˆ: x_Zr = {x_Zr[max_idx]:.2f}")
print(f"æœ€å¤§dâ‚ƒâ‚ƒ = {d_33[max_idx]:.0f} pC/N")
# å‡ºåŠ›: x_Zr = 0.52, dâ‚ƒâ‚ƒ â‰ˆ 600 pC/N
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-7: ãƒ•ã‚§ãƒ©ã‚¤ãƒˆé€ç£ç‡ã®å‘¨æ³¢æ•°ä¾å­˜æ€§<span class="difficulty medium">ä¸­</span></h4>
                <p>
                    MnZnãƒ•ã‚§ãƒ©ã‚¤ãƒˆã®é€ç£ç‡ãŒã€1 kHzã§3000ã€1 MHzã§500ã«ä½ä¸‹ã—ã¾ã™ã€‚ã“ã®å‘¨æ³¢æ•°ä¾å­˜æ€§ã®åŸå› ã‚’èª¬æ˜ã—ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">print("å‘¨æ³¢æ•°ä¾å­˜æ€§ã®åŸå› :")
print("1. æ¸¦é›»æµæå¤±ï¼ˆä½æŠµæŠ—ç‡ï¼‰")
print("2. ç£å£ç§»å‹•ã®é…å»¶ï¼ˆé«˜å‘¨æ³¢ã§ç£å£ãŒè¿½å¾“ã§ããªã„ï¼‰")
print("3. ã‚¹ãƒ”ãƒ³å›è»¢ã®å…±é³´ï¼ˆãƒ•ã‚§ãƒªç£æ€§å…±é³´å‘¨æ³¢æ•°ï¼‰")
print("\nå¯¾ç­–: NiZnãƒ•ã‚§ãƒ©ã‚¤ãƒˆï¼ˆé«˜æŠµæŠ—ï¼‰ã¸ã®å¤‰æ›´")
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-8: SOFCé›»è§£è³ªã®åšã¿æœ€é©åŒ–<span class="difficulty hard">é›£</span></h4>
                <p>
                    YSZé›»è§£è³ªã®æŠµæŠ—Rã¯ã€R = Ï Ã— L / Aï¼ˆÏ: æŠµæŠ—ç‡ã€L: åšã¿ã€A: é¢ç©ï¼‰ã§ã™ã€‚800Â°Cã§0.1 S/cmã®ä¼å°åº¦ã€10 cmÂ²ã®é¢ç©ã®ã¨ãã€æŠµæŠ—ã‚’0.1 Î©ä»¥ä¸‹ã«ã™ã‚‹æœ€å¤§åšã¿ã‚’æ±‚ã‚ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">sigma = 0.1  # S/cm = 10 S/m
rho = 1 / sigma  # Î©Â·m
A = 10e-4  # mÂ²
R_target = 0.1  # Î©

L_max = R_target * A / rho
print(f"æœ€å¤§åšã¿ L = {L_max*1e6:.0f} Î¼m")
# å‡ºåŠ›: L â‰ˆ 100 Î¼m
# å®Ÿéš›ã®SOFCã§ã¯10-50 Î¼mãŒä¸€èˆ¬çš„
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-9: åœ§é›»ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒãƒ¼ãƒ™ã‚¹ãƒ†ã‚£ãƒ³ã‚°<span class="difficulty hard">é›£</span></h4>
                <p>
                    PZTç´ å­ï¼ˆdâ‚ƒâ‚ƒ = 300 pC/Nã€é¢ç©10 cmÂ²ï¼‰ã«100 Nã®è·é‡ã‚’å‘¨æœŸçš„ï¼ˆ10 Hzï¼‰ã«å°åŠ ã—ã¾ã™ã€‚ç™ºç”Ÿé›»åŠ›ã‚’æ¨å®šã—ãªã•ã„ï¼ˆç°¡ç•¥è¨ˆç®—ï¼‰ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">d_33 = 300e-12
F = 100  # N
A = 10e-4  # mÂ²
f = 10  # Hz
epsilon_r = 1300
epsilon_0 = 8.854e-12

# ç™ºç”Ÿé›»è· Q = dâ‚ƒâ‚ƒ Ã— F
Q = d_33 * F
print(f"ç™ºç”Ÿé›»è· Q = {Q*1e9:.1f} nC")

# å®¹é‡ C = Îµâ‚€Îµáµ£A/dï¼ˆåšã¿1 mmã¨ä»®å®šï¼‰
d = 1e-3
C = epsilon_0 * epsilon_r * A / d
V = Q / C
print(f"é›»åœ§ V = {V:.1f} V")

# é›»åŠ› P = 0.5 Ã— C Ã— VÂ² Ã— f
P = 0.5 * C * V**2 * f
print(f"é›»åŠ› P = {P*1e6:.1f} Î¼W")
# å‡ºåŠ›ä¾‹: ~10-100 Î¼Wï¼ˆå®Ÿç”¨ãƒ¬ãƒ™ãƒ«ã¯ mWå¿…è¦ï¼‰
</code></pre>
                </details>
            </div>

            <div class="exercise-box">
                <h4>æ¼”ç¿’ 4-10: å¤šå±¤æ§‹é€ è›å…‰ä½“ã®è¨­è¨ˆ<span class="difficulty hard">é›£</span></h4>
                <p>
                    é«˜æ¼”è‰²æ€§ç™½è‰²LEDï¼ˆRa > 90ï¼‰ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã€YAG:Ceï¼ˆé»„ï¼‰ã¨CaAlSiNâ‚ƒ:Euï¼ˆèµ¤ï¼‰ã®2å±¤è›å…‰ä½“ã‚’è¨­è¨ˆã—ã¾ã™ã€‚å„å±¤ã®åšã¿æ¯”ã¨ç™ºå…‰å¼·åº¦æ¯”ã‚’æœ€é©åŒ–ã™ã‚‹æ–¹é‡ã‚’è¿°ã¹ãªã•ã„ã€‚
                </p>
                <details>
                    <summary>è§£ç­”ä¾‹</summary>
                    <pre><code class="language-python">print("è¨­è¨ˆæ–¹é‡:")
print("1. YAG:Ceå±¤ï¼ˆé»„ï¼‰: é’è‰²LEDåŠ±èµ·ã§550 nmç™ºå…‰")
print("2. CaAlSiNâ‚ƒ:Euå±¤ï¼ˆèµ¤ï¼‰: é’è‰²åŠ±èµ·ã§630 nmç™ºå…‰")
print("3. åšã¿æ¯”: YAG:Ce = 80%, èµ¤è›å…‰ä½“ = 20%")
print("4. ç™ºå…‰å¼·åº¦æ¯”: é’:é»„:èµ¤ = 30:50:20")
print("5. CIEè‰²åº¦åº§æ¨™ã‚’(0.33, 0.33)ã«èª¿æ•´")
print("6. æ¼”è‰²è©•ä¾¡æ•°Ra > 90ã‚’ç¢ºèªï¼ˆR9èµ¤æˆåˆ†ãŒé‡è¦ï¼‰")
print("\næœ€é©åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ :")
print("- åšã¿ã¨æ¿ƒåº¦ã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ãŸãƒ¢ãƒ³ãƒ†ã‚«ãƒ«ãƒ­æœ€é©åŒ–")
print("- ç›®çš„é–¢æ•°: Raæœ€å¤§åŒ– & è‰²æ¸©åº¦5000-6500Kåˆ¶ç´„")
</code></pre>
                </details>
            </div>
        </section>

        <section id="references">
            <h2>å‚è€ƒæ–‡çŒ®</h2>
            <ol>
                <li>Moulson, A.J., Herbert, J.M. (2003). <em>Electroceramics: Materials, Properties, Applications</em>. Wiley, pp. 1-85, 155-210, 340-395.</li>
                <li>Jaffe, B., Cook, W.R., Jaffe, H. (1971). <em>Piezoelectric Ceramics</em>. Academic Press, pp. 50-135.</li>
                <li>Tuller, H.L. (2000). Ionic conduction in nanocrystalline materials. <em>Solid State Ionics</em>, 131, 15-68.</li>
                <li>Ronda, C.R. (2008). <em>Luminescence: From Theory to Applications</em>. Wiley-VCH, pp. 120-180.</li>
                <li>Blasse, G., Grabmaier, B.C. (1994). <em>Luminescent Materials</em>. Springer, pp. 1-65.</li>
                <li>Goldman, A. (2006). <em>Modern Ferrite Technology</em>. Springer, pp. 30-95.</li>
                <li>Setter, N. (2002). <em>Piezoelectric Materials in Devices</em>. EPFL Swiss Federal Institute of Technology, pp. 1-50, 200-250.</li>
            </ol>
        </section>
    <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

</main>

    <footer>
        <p>&copy; 2025 MS Dojo - Materials Science Education</p>
        <p><a href="index.html">ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ææ–™å…¥é–€ãƒˆãƒƒãƒ—ã¸æˆ»ã‚‹</a> | <a href="../../MS/">MSåˆ†é‡ãƒˆãƒƒãƒ—</a></p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'base' });
    </script>
</body>
</html>
