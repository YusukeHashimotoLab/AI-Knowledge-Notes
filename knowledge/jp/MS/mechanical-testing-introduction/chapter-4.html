<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« ï¼šPythonå®Ÿè·µï¼šè©¦é¨“ãƒ‡ãƒ¼ã‚¿è§£æãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ - å®Ÿãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹å®Œå…¨è‡ªå‹•åŒ– - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.3rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-sm);
            line-height: 1.8;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        li {
            margin-bottom: var(--spacing-xs);
            line-height: 1.7;
        }

        .info-box, .warning-box, .note-box {
            padding: var(--spacing-md);
            margin: var(--spacing-md) 0;
            border-radius: var(--border-radius);
            border-left: 4px solid;
        }

        .info-box {
            background-color: #e3f2fd;
            border-color: #2196f3;
        }

        .warning-box {
            background-color: #fff3e0;
            border-color: #ff9800;
        }

        .note-box {
            background-color: #f3e5f5;
            border-color: #9c27b0;
        }

        pre {
            background-color: var(--color-code-bg);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            overflow-x: auto;
            margin: var(--spacing-md) 0;
            border: 1px solid var(--color-border);
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .exercise-box {
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            margin: var(--spacing-md) 0;
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
        }

        .exercise-box h3 {
            margin-top: 0;
            color: var(--color-accent);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: var(--spacing-md) 0;
            background-color: var(--color-bg);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        th, td {
            padding: var(--spacing-sm);
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            background-color: var(--color-primary);
            color: white;
            font-weight: 600;
        }

        @media (hover: hover) and (pointer: fine) {
            tr:hover {
                background-color: var(--color-bg-alt);
            }
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            display: inline-block;
            padding: var(--spacing-sm) var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 500;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(240, 147, 251, 0.4);
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            color: var(--color-text-light);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.6rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .navigation {
                flex-direction: column;
                gap: var(--spacing-sm);
            }

            .nav-button {
                text-align: center;
            }
        }
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>
</head>
<body>
        <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/wp/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/wp/knowledge/jp/MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="/wp/knowledge/jp/MS/mechanical-testing-introduction/index.html">Mechanical Testing</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 4</span>
        </div>
    </nav>

    <header>
        <div class="header-content">
            <h1>ç¬¬4ç« ï¼šPythonå®Ÿè·µï¼šè©¦é¨“ãƒ‡ãƒ¼ã‚¿è§£æãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h1>
            <p class="subtitle">ãƒ‡ãƒ¼ã‚¿èª­è¾¼ãƒ»å‰å‡¦ç†ãƒ»è‡ªå‹•è§£æãƒ»ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆã®å®Œå…¨è‡ªå‹•åŒ–</p>
            <div class="meta">
                <span class="meta-item">ğŸ“š ã‚·ãƒªãƒ¼ã‚º: æ©Ÿæ¢°è©¦é¨“å…¥é–€</span>
                <span class="meta-item">â±ï¸ 90åˆ†</span>
                <span class="meta-item">ğŸ¯ ãƒ¬ãƒ™ãƒ«: ä¸­ç´šã€œä¸Šç´š</span>
                <span class="meta-item">ğŸ“Š å®Ÿä¾‹: Python 7ä¾‹</span>
            </div>
        </div>
    </header>

    <main class="container">
        <h2>å­¦ç¿’ç›®æ¨™</h2>
        <div class="info-box">
            <h4>åˆç´šç›®æ¨™ï¼ˆç†è§£ï¼‰</h4>
            <ul>
                <li>CSV/Excelå½¢å¼ã®è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‚’Pandasã§èª­ã¿è¾¼ã¿ã€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’ç†è§£ã§ãã‚‹</li>
                <li>ãƒã‚¤ã‚ºé™¤å»ãƒ»å¤–ã‚Œå€¤æ¤œå‡ºã®åŸºæœ¬çš„ãªå‰å‡¦ç†æ‰‹æ³•ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>å¿œåŠ›-ã²ãšã¿æ›²ç·šã‹ã‚‰æ©Ÿæ¢°çš„ç‰¹æ€§ã‚’è¦–è¦šçš„ã«æŠ½å‡ºã§ãã‚‹</li>
            </ul>

            <h4>ä¸­ç´šç›®æ¨™ï¼ˆé©ç”¨ï¼‰</h4>
            <ul>
                <li>å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰è‡ªå‹•ã§Youngç‡ãƒ»è€åŠ›ãƒ»å¼•å¼µå¼·åº¦ãƒ»ç ´æ–­ä¼¸ã³ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>ç¡¬ã•è©¦é¨“ãƒ»ç–²åŠ´è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‚’ãƒãƒƒãƒå‡¦ç†ã—ã€çµ±è¨ˆè§£æã‚’å®Ÿè¡Œã§ãã‚‹</li>
                <li>Matplotlibã¨Seabornã‚’ç”¨ã„ã¦å‡ºç‰ˆå“è³ªã®å›³ã‚’ä½œæˆã§ãã‚‹</li>
            </ul>

            <h4>ä¸Šç´šç›®æ¨™ï¼ˆåˆ†æãƒ»è©•ä¾¡ï¼‰</h4>
            <ul>
                <li>å®Ÿæ©Ÿææ–™ã®å¤šæ§˜ãªãƒ‡ãƒ¼ã‚¿ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¯¾å¿œã—ãŸãƒ­ãƒã‚¹ãƒˆãªè§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
                <li>è¤‡æ•°ææ–™ã®è©¦é¨“çµæœã‚’çµ±åˆã—ã€ææ–™é¸å®šã®ãŸã‚ã®æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆã‚’è‡ªå‹•ç”Ÿæˆã§ãã‚‹</li>
                <li>ç•°å¸¸ãƒ‡ãƒ¼ã‚¿æ¤œå‡ºãƒ»å“è³ªç®¡ç†æŒ‡æ¨™ã®è¨ˆç®—ãƒ»ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ç®¡ç†ã‚’å®Ÿè£…ã§ãã‚‹</li>
            </ul>
        </div>

        <h2>1. é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</h2>

        <h3>1.1 å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª</h3>
        <p>æœ¬ç« ã§ä½¿ç”¨ã™ã‚‹ä¸»è¦Pythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ãã®å½¹å‰²ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚</p>

        <table>
            <thead>
                <tr>
                    <th>ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</th>
                    <th>ç”¨é€”</th>
                    <th>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>NumPy</strong></td>
                    <td>æ•°å€¤è¨ˆç®—ãƒ»é…åˆ—æ“ä½œ</td>
                    <td>â‰¥ 1.21</td>
                </tr>
                <tr>
                    <td><strong>Pandas</strong></td>
                    <td>ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ æ“ä½œãƒ»CSV/Excelèª­è¾¼</td>
                    <td>â‰¥ 1.3</td>
                </tr>
                <tr>
                    <td><strong>Matplotlib</strong></td>
                    <td>åŸºæœ¬çš„ãªãƒ—ãƒ­ãƒƒãƒˆä½œæˆ</td>
                    <td>â‰¥ 3.5</td>
                </tr>
                <tr>
                    <td><strong>Seaborn</strong></td>
                    <td>çµ±è¨ˆçš„å¯è¦–åŒ–</td>
                    <td>â‰¥ 0.11</td>
                </tr>
                <tr>
                    <td><strong>SciPy</strong></td>
                    <td>ç§‘å­¦æŠ€è¡“è¨ˆç®—ãƒ»æ›²ç·šãƒ•ã‚£ãƒƒãƒˆ</td>
                    <td>â‰¥ 1.7</td>
                </tr>
                <tr>
                    <td><strong>scikit-learn</strong></td>
                    <td>ç•°å¸¸å€¤æ¤œå‡ºãƒ»å‰å‡¦ç†</td>
                    <td>â‰¥ 1.0</td>
                </tr>
                <tr>
                    <td><strong>openpyxl</strong></td>
                    <td>Excelãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿æ›¸ã</td>
                    <td>â‰¥ 3.0</td>
                </tr>
            </tbody>
        </table>

        <h3>1.2 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚³ãƒãƒ³ãƒ‰</h3>
        <pre><code># ä»®æƒ³ç’°å¢ƒã®ä½œæˆï¼ˆæ¨å¥¨ï¼‰
python -m venv mechanical_test_env
source mechanical_test_env/bin/activate  # Windows: mechanical_test_env\Scripts\activate

# å¿…è¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install numpy pandas matplotlib seaborn scipy scikit-learn openpyxl

# Jupyter Notebookç’°å¢ƒï¼ˆæ¨å¥¨ï¼‰
pip install jupyter notebook ipywidgets

# èµ·å‹•
jupyter notebook</code></pre>

        <h3>1.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ </h3>
        <pre><code>mechanical_testing_project/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ raw/                    # ç”Ÿãƒ‡ãƒ¼ã‚¿
â”‚   â”‚   â”œâ”€â”€ tensile/
â”‚   â”‚   â”œâ”€â”€ hardness/
â”‚   â”‚   â””â”€â”€ fatigue/
â”‚   â””â”€â”€ processed/              # å‰å‡¦ç†æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ data_loader.py          # ãƒ‡ãƒ¼ã‚¿èª­è¾¼
â”‚   â”œâ”€â”€ preprocessing.py        # å‰å‡¦ç†
â”‚   â”œâ”€â”€ analysis.py             # è§£æé–¢æ•°
â”‚   â””â”€â”€ visualization.py        # å¯è¦–åŒ–
â”œâ”€â”€ results/
â”‚   â”œâ”€â”€ figures/                # ç”Ÿæˆå›³
â”‚   â””â”€â”€ reports/                # ãƒ¬ãƒãƒ¼ãƒˆ
â””â”€â”€ notebooks/
    â”œâ”€â”€ 01_data_exploration.ipynb
    â”œâ”€â”€ 02_tensile_analysis.ipynb
    â””â”€â”€ 03_batch_processing.ipynb</code></pre>

        <h2>2. ãƒ‡ãƒ¼ã‚¿èª­è¾¼ã¨å‰å‡¦ç†</h2>

        <h3>2.1 æ±ç”¨ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ã®å®Ÿè£…</h3>
        <pre><code>import pandas as pd
import numpy as np
from pathlib import Path
from typing import Dict, List, Optional

class MechanicalTestDataLoader:
    """
    æ©Ÿæ¢°è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®æ±ç”¨ãƒ­ãƒ¼ãƒ€ãƒ¼
    """

    def __init__(self, data_dir: str = 'data/raw'):
        self.data_dir = Path(data_dir)

    def load_csv(self, filepath: str, encoding: str = 'utf-8',
                 skiprows: int = 0, delimiter: str = ',') -> pd.DataFrame:
        """
        CSVå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­è¾¼

        Parameters:
            filepath: ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹
            encoding: æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆ'utf-8', 'shift-jis'ç­‰ï¼‰
            skiprows: ã‚¹ã‚­ãƒƒãƒ—ã™ã‚‹è¡Œæ•°ï¼ˆãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±ãªã©ï¼‰
            delimiter: åŒºåˆ‡ã‚Šæ–‡å­—

        Returns:
            df: ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ 
        """
        try:
            df = pd.read_csv(filepath, encoding=encoding,
                           skiprows=skiprows, delimiter=delimiter)
            print(f"âœ“ ãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼æˆåŠŸ: {filepath}")
            print(f"  ãƒ‡ãƒ¼ã‚¿å½¢çŠ¶: {df.shape}")
            print(f"  åˆ—å: {list(df.columns)}")
            return df
        except UnicodeDecodeError:
            # ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¨ãƒ©ãƒ¼æ™‚ã®è‡ªå‹•ãƒªãƒˆãƒ©ã‚¤
            print(f"âš  UTF-8ã§èª­è¾¼å¤±æ•—ã€‚Shift-JISã§å†è©¦è¡Œ...")
            df = pd.read_csv(filepath, encoding='shift-jis',
                           skiprows=skiprows, delimiter=delimiter)
            return df
        except Exception as e:
            print(f"âœ— ã‚¨ãƒ©ãƒ¼: {e}")
            return None

    def load_excel(self, filepath: str, sheet_name: str = 0,
                   skiprows: int = 0) -> pd.DataFrame:
        """
        Excelå½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­è¾¼
        """
        df = pd.read_excel(filepath, sheet_name=sheet_name, skiprows=skiprows)
        print(f"âœ“ Excelãƒ•ã‚¡ã‚¤ãƒ«èª­è¾¼æˆåŠŸ: {filepath}")
        print(f"  ã‚·ãƒ¼ãƒˆ: {sheet_name}, ãƒ‡ãƒ¼ã‚¿å½¢çŠ¶: {df.shape}")
        return df

    def detect_columns(self, df: pd.DataFrame, test_type: str) -> Dict[str, str]:
        """
        åˆ—åã®è‡ªå‹•æ¤œå‡ºï¼ˆå¤šæ§˜ãªå‘½åè¦å‰‡ã«å¯¾å¿œï¼‰

        Parameters:
            df: ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ 
            test_type: è©¦é¨“ç¨®é¡ï¼ˆ'tensile', 'hardness', 'fatigue'ï¼‰

        Returns:
            column_map: æ¨™æº–åâ†’å®Ÿéš›ã®åˆ—åã®ãƒãƒƒãƒ”ãƒ³ã‚°
        """
        column_map = {}

        if test_type == 'tensile':
            # å¼•å¼µè©¦é¨“ã®åˆ—åå€™è£œ
            candidates = {
                'load': ['Load', 'Force', 'è·é‡', 'P [N]', 'P(N)'],
                'displacement': ['Displacement', 'Extension', 'ä¼¸ã³', 'Ext [mm]', 'Î´(mm)'],
                'stress': ['Stress', 'å¿œåŠ›', 'Ïƒ [MPa]', 'Stress(MPa)'],
                'strain': ['Strain', 'ã²ãšã¿', 'Îµ [-]', 'Strain(-)']
            }
        elif test_type == 'hardness':
            candidates = {
                'indentation_no': ['No', 'Test No', 'æ¸¬å®šNo', '#'],
                'hardness': ['HV', 'HB', 'HRC', 'ç¡¬åº¦', 'Hardness']
            }
        elif test_type == 'fatigue':
            candidates = {
                'stress_amplitude': ['Stress Amp', 'Ïƒ_a', 'å¿œåŠ›æŒ¯å¹…', 'S [MPa]'],
                'cycles': ['Cycles', 'N_f', 'ç¹°è¿”ã—æ•°', 'Cycles to Failure']
            }

        for standard_name, candidate_names in candidates.items():
            for col in df.columns:
                if any(cand in str(col) for cand in candidate_names):
                    column_map[standard_name] = col
                    break

        print(f"âœ“ åˆ—åæ¤œå‡ºçµæœ: {column_map}")
        return column_map

# ä½¿ç”¨ä¾‹
loader = MechanicalTestDataLoader()

# å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®èª­è¾¼
tensile_df = loader.load_csv('data/raw/tensile/steel_A_specimen1.csv', skiprows=5)
column_map = loader.detect_columns(tensile_df, test_type='tensile')

# æ¨™æº–åã§ã‚¢ã‚¯ã‚»ã‚¹
load_col = column_map['load']
disp_col = column_map['displacement']
print(f"\nè·é‡åˆ—: {load_col}, ä¼¸ã³åˆ—: {disp_col}")</code></pre>

        <h3>2.2 ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³</h3>
        <pre><code>import numpy as np
from scipy.signal import savgol_filter
from sklearn.preprocessing import StandardScaler

class DataPreprocessor:
    """
    æ©Ÿæ¢°è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†
    """

    @staticmethod
    def remove_outliers(data: np.ndarray, threshold: float = 3.0) -> np.ndarray:
        """
        Zã‚¹ã‚³ã‚¢æ³•ã«ã‚ˆã‚‹å¤–ã‚Œå€¤é™¤å»

        Parameters:
            data: å…¥åŠ›ãƒ‡ãƒ¼ã‚¿
            threshold: Zã‚¹ã‚³ã‚¢é–¾å€¤ï¼ˆä¸€èˆ¬ã«2.5-3.0ï¼‰

        Returns:
            cleaned_data: å¤–ã‚Œå€¤é™¤å»å¾Œã®ãƒ‡ãƒ¼ã‚¿
        """
        z_scores = np.abs((data - np.mean(data)) / np.std(data))
        mask = z_scores < threshold
        cleaned_data = data[mask]

        removed_count = len(data) - len(cleaned_data)
        print(f"âœ“ å¤–ã‚Œå€¤é™¤å»: {removed_count}ç‚¹ ({removed_count/len(data)*100:.1f}%)")

        return cleaned_data

    @staticmethod
    def smooth_data(data: np.ndarray, window_length: int = 11,
                    polyorder: int = 3) -> np.ndarray:
        """
        Savitzky-Golay ãƒ•ã‚£ãƒ«ã‚¿ã«ã‚ˆã‚‹å¹³æ»‘åŒ–

        Parameters:
            data: å…¥åŠ›ãƒ‡ãƒ¼ã‚¿
            window_length: ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºï¼ˆå¥‡æ•°ï¼‰
            polyorder: å¤šé …å¼æ¬¡æ•°

        Returns:
            smoothed_data: å¹³æ»‘åŒ–ãƒ‡ãƒ¼ã‚¿
        """
        if len(data) < window_length:
            print(f"âš  ãƒ‡ãƒ¼ã‚¿ç‚¹æ•°ä¸è¶³ã€‚å¹³æ»‘åŒ–ã‚’ã‚¹ã‚­ãƒƒãƒ—ã€‚")
            return data

        smoothed_data = savgol_filter(data, window_length, polyorder)
        print(f"âœ“ å¹³æ»‘åŒ–å®Œäº†: window={window_length}, order={polyorder}")

        return smoothed_data

    @staticmethod
    def remove_preload(load: np.ndarray, displacement: np.ndarray,
                       preload_threshold: float = 50) -> tuple:
        """
        äºˆè·é‡é ˜åŸŸã®é™¤å»

        Parameters:
            load: è·é‡ãƒ‡ãƒ¼ã‚¿ [N]
            displacement: å¤‰ä½ãƒ‡ãƒ¼ã‚¿ [mm]
            preload_threshold: äºˆè·é‡é–¾å€¤ [N]

        Returns:
            load_trimmed, displacement_trimmed: ãƒˆãƒªãƒŸãƒ³ã‚°å¾Œã®ãƒ‡ãƒ¼ã‚¿
        """
        start_idx = np.where(load > preload_threshold)[0][0]

        load_trimmed = load[start_idx:] - load[start_idx]
        displacement_trimmed = displacement[start_idx:] - displacement[start_idx]

        print(f"âœ“ äºˆè·é‡é™¤å»: {start_idx}ç‚¹ã‚’ãƒˆãƒªãƒŸãƒ³ã‚°")

        return load_trimmed, displacement_trimmed

    @staticmethod
    def resample_data(x: np.ndarray, y: np.ndarray,
                      n_points: int = 1000) -> tuple:
        """
        ãƒ‡ãƒ¼ã‚¿ã®ç­‰é–“éš”ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
        """
        x_resampled = np.linspace(x.min(), x.max(), n_points)
        y_resampled = np.interp(x_resampled, x, y)

        print(f"âœ“ ãƒªã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°: {len(x)}ç‚¹ â†’ {n_points}ç‚¹")

        return x_resampled, y_resampled

# ä½¿ç”¨ä¾‹: å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†
preprocessor = DataPreprocessor()

# ä»®ã®ãƒ‡ãƒ¼ã‚¿
load_raw = np.concatenate([np.linspace(0, 20, 100),    # äºˆè·é‡
                           np.linspace(20, 15000, 900)])  # æœ¬è·é‡
displacement_raw = np.concatenate([np.linspace(0, 0.02, 100),
                                   np.linspace(0.02, 5.0, 900)])

# ãƒã‚¤ã‚ºä»˜åŠ ï¼ˆå®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿ã‚’æƒ³å®šï¼‰
load_raw += np.random.normal(0, 50, len(load_raw))

# å‰å‡¦ç†ã®å®Ÿè¡Œ
load_clean = preprocessor.remove_outliers(load_raw)
load_smooth = preprocessor.smooth_data(load_clean, window_length=15)

print(f"\nå…ƒãƒ‡ãƒ¼ã‚¿ç‚¹æ•°: {len(load_raw)}")
print(f"å‰å‡¦ç†å¾Œç‚¹æ•°: {len(load_smooth)}")</code></pre>

        <h2>3. å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•è§£æ</h2>

        <h3>3.1 æ©Ÿæ¢°çš„ç‰¹æ€§ã®è‡ªå‹•æŠ½å‡º</h3>
        <pre><code>import numpy as np
from scipy.optimize import curve_fit
from scipy.signal import find_peaks

class TensileAnalyzer:
    """
    å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•è§£æ
    """

    def __init__(self, initial_length: float, initial_diameter: float):
        """
        Parameters:
            initial_length: æ¨™ç‚¹é–“è·é›¢ [mm]
            initial_diameter: åˆæœŸç›´å¾„ [mm]
        """
        self.L0 = initial_length
        self.d0 = initial_diameter
        self.A0 = np.pi * (initial_diameter / 2)**2  # åˆæœŸæ–­é¢ç© [mmÂ²]

    def calculate_stress_strain(self, load: np.ndarray,
                                 displacement: np.ndarray) -> tuple:
        """
        å·¥å­¦å¿œåŠ›ãƒ»å·¥å­¦ã²ãšã¿ã®è¨ˆç®—
        """
        stress = load / self.A0  # MPa
        strain = displacement / self.L0  # -

        return stress, strain

    def find_youngs_modulus(self, strain: np.ndarray, stress: np.ndarray,
                            elastic_limit: float = 0.002) -> float:
        """
        Youngç‡ã®è‡ªå‹•ç®—å‡ºï¼ˆå¼¾æ€§åŸŸã®ç·šå½¢å›å¸°ï¼‰

        Parameters:
            strain: ã²ãšã¿ãƒ‡ãƒ¼ã‚¿
            stress: å¿œåŠ›ãƒ‡ãƒ¼ã‚¿
            elastic_limit: å¼¾æ€§åŸŸã®ä¸Šé™ã²ãšã¿

        Returns:
            E: Youngç‡ [GPa]
        """
        # å¼¾æ€§åŸŸã®ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
        elastic_mask = strain < elastic_limit
        strain_elastic = strain[elastic_mask]
        stress_elastic = stress[elastic_mask]

        # ç·šå½¢å›å¸°ï¼ˆåŸç‚¹ã‚’é€šã‚‹ç›´ç·šï¼‰
        E_MPa = np.polyfit(strain_elastic, stress_elastic, 1)[0]
        E_GPa = E_MPa / 1000

        # æ±ºå®šä¿‚æ•°RÂ²ã®è¨ˆç®—
        stress_pred = E_MPa * strain_elastic
        ss_res = np.sum((stress_elastic - stress_pred)**2)
        ss_tot = np.sum((stress_elastic - np.mean(stress_elastic))**2)
        R2 = 1 - ss_res / ss_tot

        print(f"âœ“ Youngç‡: E = {E_GPa:.1f} GPa (RÂ² = {R2:.4f})")

        return E_GPa

    def find_yield_strength(self, strain: np.ndarray, stress: np.ndarray,
                           E_GPa: float, offset: float = 0.002) -> tuple:
        """
        0.2%è€åŠ›ã®ç®—å‡º

        Returns:
            sigma_02: 0.2%è€åŠ› [MPa]
            strain_02: 0.2%è€åŠ›æ™‚ã®ã²ãšã¿
        """
        E_MPa = E_GPa * 1000

        # 0.2%ã‚ªãƒ•ã‚»ãƒƒãƒˆç·šï¼ˆå‚¾ãEã€åˆ‡ç‰‡-0.002Eï¼‰
        offset_line = E_MPa * (strain - offset)

        # å¿œåŠ›-ã²ãšã¿æ›²ç·šã¨ã®äº¤ç‚¹ã‚’æ¢ç´¢
        diff = stress - offset_line

        # ç¬¦å·å¤‰åŒ–ç‚¹ã‚’æ¤œå‡º
        sign_changes = np.where(np.diff(np.sign(diff)))[0]

        if len(sign_changes) == 0:
            print("âš  0.2%è€åŠ›ãŒæ¤œå‡ºã§ãã¾ã›ã‚“ã§ã—ãŸ")
            return None, None

        idx_02 = sign_changes[0]
        sigma_02 = stress[idx_02]
        strain_02 = strain[idx_02]

        print(f"âœ“ 0.2%è€åŠ›: Ïƒ_0.2 = {sigma_02:.1f} MPa (Îµ = {strain_02:.4f})")

        return sigma_02, strain_02

    def find_tensile_strength(self, stress: np.ndarray) -> tuple:
        """
        å¼•å¼µå¼·åº¦ï¼ˆæœ€å¤§å¿œåŠ›ï¼‰ã®æ¤œå‡º
        """
        idx_max = np.argmax(stress)
        sigma_B = stress[idx_max]

        print(f"âœ“ å¼•å¼µå¼·åº¦: Ïƒ_B = {sigma_B:.1f} MPa")

        return sigma_B, idx_max

    def find_elongation_at_fracture(self, strain: np.ndarray,
                                     stress: np.ndarray) -> float:
        """
        ç ´æ–­ä¼¸ã³ï¼ˆå…¨ä¼¸ã³ï¼‰ã®è¨ˆç®—
        """
        # ç ´æ–­ç‚¹ = å¿œåŠ›ãŒæ€¥æ¿€ã«ä½ä¸‹ã™ã‚‹ç‚¹
        stress_gradient = np.gradient(stress)
        fracture_idx = np.where(stress_gradient < -50)[0]  # é–¾å€¤ã¯èª¿æ•´å¯èƒ½

        if len(fracture_idx) == 0:
            # æœ€çµ‚ç‚¹ã‚’ç ´æ–­ç‚¹ã¨ã¿ãªã™
            fracture_idx = len(strain) - 1
        else:
            fracture_idx = fracture_idx[0]

        elongation = strain[fracture_idx] * 100  # %

        print(f"âœ“ ç ´æ–­ä¼¸ã³: Î´ = {elongation:.1f} %")

        return elongation

    def analyze(self, load: np.ndarray, displacement: np.ndarray) -> dict:
        """
        å®Œå…¨è‡ªå‹•è§£æã®å®Ÿè¡Œ

        Returns:
            results: è§£æçµæœã®è¾æ›¸
        """
        print("=" * 50)
        print("å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿è‡ªå‹•è§£æ")
        print("=" * 50)

        # å¿œåŠ›-ã²ãšã¿å¤‰æ›
        stress, strain = self.calculate_stress_strain(load, displacement)

        # å„ç‰¹æ€§å€¤ã®è¨ˆç®—
        E = self.find_youngs_modulus(strain, stress)
        sigma_02, strain_02 = self.find_yield_strength(strain, stress, E)
        sigma_B, idx_max = self.find_tensile_strength(stress)
        elongation = self.find_elongation_at_fracture(strain, stress)

        results = {
            'youngs_modulus_GPa': E,
            'yield_strength_02_MPa': sigma_02,
            'tensile_strength_MPa': sigma_B,
            'elongation_percent': elongation,
            'stress': stress,
            'strain': strain
        }

        print("=" * 50)
        print("è§£æå®Œäº†")
        print("=" * 50)

        return results

# ä½¿ç”¨ä¾‹: å®Ÿãƒ‡ãƒ¼ã‚¿è§£æ
np.random.seed(42)

# æ¨¡æ“¬å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆé‹¼æï¼‰
L0 = 50  # mm
d0 = 6   # mm

# è·é‡-å¤‰ä½ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿæ¸¬å€¤ã‚’æ¨¡æ“¬ï¼‰
displacement = np.linspace(0, 10, 500)  # mm
load = np.zeros_like(displacement)

# å¼¾æ€§åŸŸ
elastic_region = displacement < 0.1
load[elastic_region] = 200000 * displacement[elastic_region]  # E=200 GPaç›¸å½“

# å¡‘æ€§åŸŸï¼ˆåŠ å·¥ç¡¬åŒ–ï¼‰
plastic_region = (displacement >= 0.1) & (displacement < 8)
load[plastic_region] = 18000 + 2000 * (displacement[plastic_region] - 0.1)**0.5

# ãƒãƒƒã‚­ãƒ³ã‚°ï¼ˆè·é‡æ¸›å°‘ï¼‰
necking_region = displacement >= 8
load[necking_region] = 22000 - 1000 * (displacement[necking_region] - 8)

# ãƒã‚¤ã‚ºä»˜åŠ 
load += np.random.normal(0, 100, len(load))

# è§£æå®Ÿè¡Œ
analyzer = TensileAnalyzer(initial_length=L0, initial_diameter=d0)
results = analyzer.analyze(load, displacement)

# çµæœã®è¡¨ç¤º
print("\nã€è§£æçµæœã‚µãƒãƒªãƒ¼ã€‘")
for key, value in results.items():
    if key not in ['stress', 'strain']:
        print(f"  {key}: {value}")</code></pre>

        <h3>3.2 é«˜åº¦ãªå¯è¦–åŒ–</h3>
        <pre><code>import matplotlib.pyplot as plt
import seaborn as sns

def plot_tensile_analysis(results: dict, specimen_name: str = 'Sample'):
    """
    å¼•å¼µè©¦é¨“çµæœã®åŒ…æ‹¬çš„å¯è¦–åŒ–
    """
    stress = results['stress']
    strain = results['strain']
    E = results['youngs_modulus_GPa']
    sigma_02 = results['yield_strength_02_MPa']
    sigma_B = results['tensile_strength_MPa']

    # ã‚¹ã‚¿ã‚¤ãƒ«è¨­å®š
    sns.set_style('whitegrid')

    fig, axes = plt.subplots(2, 2, figsize=(14, 10))

    # (1) å¿œåŠ›-ã²ãšã¿æ›²ç·šï¼ˆå…¨ä½“ï¼‰
    ax1 = axes[0, 0]
    ax1.plot(strain * 100, stress, linewidth=2, color='#2c3e50', label='å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿')

    # Youngç‡ã®ç›´ç·š
    elastic_strain = np.linspace(0, 0.002, 100)
    elastic_stress = E * 1000 * elastic_strain
    ax1.plot(elastic_strain * 100, elastic_stress, '--', linewidth=2,
             color='#e74c3c', label=f'Youngç‡ {E:.0f} GPa')

    # 0.2%ã‚ªãƒ•ã‚»ãƒƒãƒˆç·š
    offset_strain = np.linspace(0.002, 0.005, 100)
    offset_stress = E * 1000 * (offset_strain - 0.002)
    ax1.plot(offset_strain * 100, offset_stress, '--', linewidth=2,
             color='#f39c12', label='0.2% offsetç·š')

    # é‡è¦ç‚¹ã®ãƒãƒ¼ã‚¯
    if sigma_02 is not None:
        ax1.plot(0.2, sigma_02, 'o', markersize=10, color='#f39c12', label=f'Ïƒ_0.2 = {sigma_02:.0f} MPa')
    ax1.plot(strain[np.argmax(stress)] * 100, sigma_B, 's', markersize=10,
             color='#27ae60', label=f'Ïƒ_B = {sigma_B:.0f} MPa')

    ax1.set_xlabel('ã²ãšã¿ [%]', fontsize=12)
    ax1.set_ylabel('å¿œåŠ› [MPa]', fontsize=12)
    ax1.set_title(f'å¿œåŠ›-ã²ãšã¿æ›²ç·š: {specimen_name}', fontsize=13, fontweight='bold')
    ax1.legend(fontsize=9)
    ax1.grid(True, alpha=0.3)

    # (2) å¼¾æ€§åŸŸã®æ‹¡å¤§å›³
    ax2 = axes[0, 1]
    elastic_mask = strain < 0.005
    ax2.plot(strain[elastic_mask] * 100, stress[elastic_mask], 'o-', markersize=4, linewidth=1.5)
    ax2.plot(elastic_strain * 100, elastic_stress, '--', linewidth=2, color='red', label=f'E = {E:.0f} GPa')
    ax2.set_xlabel('ã²ãšã¿ [%]', fontsize=12)
    ax2.set_ylabel('å¿œåŠ› [MPa]', fontsize=12)
    ax2.set_title('å¼¾æ€§åŸŸã®è©³ç´°', fontsize=13, fontweight='bold')
    ax2.legend()
    ax2.grid(True, alpha=0.3)

    # (3) åŠ å·¥ç¡¬åŒ–æ›²ç·šï¼ˆå¡‘æ€§åŸŸï¼‰
    ax3 = axes[1, 0]
    plastic_mask = (strain > 0.002) & (strain < strain[np.argmax(stress)])
    strain_plastic = strain[plastic_mask]
    stress_plastic = stress[plastic_mask]

    # å¯¾æ•°ãƒ—ãƒ­ãƒƒãƒˆï¼ˆHollomonå¼ã®ãƒã‚§ãƒƒã‚¯ï¼‰
    if len(strain_plastic) > 10:
        log_strain = np.log(strain_plastic)
        log_stress = np.log(stress_plastic)

        # ç·šå½¢å›å¸°
        coeffs = np.polyfit(log_strain, log_stress, 1)
        n = coeffs[0]  # åŠ å·¥ç¡¬åŒ–æŒ‡æ•°
        K = np.exp(coeffs[1])  # å¼·åº¦ä¿‚æ•°

        ax3.loglog(strain_plastic, stress_plastic, 'o', markersize=4, label='å®Ÿæ¸¬')
        ax3.loglog(strain_plastic, K * strain_plastic**n, '--', linewidth=2,
                   color='red', label=f'Ïƒ = {K:.0f}Îµ^{n:.2f}')
        ax3.set_xlabel('çœŸã²ãšã¿ (å¯¾æ•°)', fontsize=12)
        ax3.set_ylabel('çœŸå¿œåŠ› (å¯¾æ•°) [MPa]', fontsize=12)
        ax3.set_title(f'åŠ å·¥ç¡¬åŒ–æ›²ç·šï¼ˆn = {n:.2f}ï¼‰', fontsize=13, fontweight='bold')
        ax3.legend()
        ax3.grid(True, alpha=0.3, which='both')

    # (4) æ©Ÿæ¢°çš„ç‰¹æ€§ã®ã‚µãƒãƒªãƒ¼
    ax4 = axes[1, 1]
    ax4.axis('off')

    summary_text = f"""
    ã€è©¦é¨“ç‰‡æƒ…å ±ã€‘
    è©¦é¨“ç‰‡å: {specimen_name}

    ã€æ©Ÿæ¢°çš„ç‰¹æ€§ã€‘
    Youngç‡:        E = {E:.1f} GPa
    0.2%è€åŠ›:    Ïƒ_0.2 = {sigma_02:.1f} MPa
    å¼•å¼µå¼·åº¦:      Ïƒ_B = {sigma_B:.1f} MPa
    ç ´æ–­ä¼¸ã³:        Î´ = {results['elongation_percent']:.1f} %

    ã€è©•ä¾¡ã€‘
    å¼·åº¦ãƒ¬ãƒ™ãƒ«: {'é«˜å¼·åº¦' if sigma_B > 800 else 'ä¸­å¼·åº¦' if sigma_B > 400 else 'ä½å¼·åº¦'}
    å»¶æ€§: {'è‰¯å¥½' if results['elongation_percent'] > 15 else 'è¦æ³¨æ„' if results['elongation_percent'] > 10 else 'è„†æ€§çš„'}
    """

    ax4.text(0.1, 0.5, summary_text, fontsize=11, verticalalignment='center',
             family='monospace', bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.3))

    plt.tight_layout()
    plt.savefig(f'results/figures/{specimen_name}_analysis.png', dpi=300, bbox_inches='tight')
    plt.show()

# å®Ÿè¡Œä¾‹
plot_tensile_analysis(results, specimen_name='Steel_A_Specimen1')</code></pre>

        <h2>4. ãƒãƒƒãƒå‡¦ç†ã¨çµ±è¨ˆè§£æ</h2>

        <h3>4.1 è¤‡æ•°è©¦é¨“ç‰‡ã®ä¸€æ‹¬è§£æ</h3>
        <pre><code>from pathlib import Path
import pandas as pd

class BatchProcessor:
    """
    è¤‡æ•°è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®ãƒãƒƒãƒå‡¦ç†
    """

    def __init__(self, data_dir: str, specimen_info: pd.DataFrame):
        """
        Parameters:
            data_dir: ãƒ‡ãƒ¼ã‚¿ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª
            specimen_info: è©¦é¨“ç‰‡æƒ…å ±ï¼ˆL0, d0ãªã©ï¼‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ 
        """
        self.data_dir = Path(data_dir)
        self.specimen_info = specimen_info
        self.results = []

    def process_all(self, file_pattern: str = '*.csv') -> pd.DataFrame:
        """
        æŒ‡å®šãƒ‘ã‚¿ãƒ¼ãƒ³ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†
        """
        files = list(self.data_dir.glob(file_pattern))
        print(f"å‡¦ç†å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«æ•°: {len(files)}")

        for filepath in files:
            print(f"\n--- {filepath.name} ---")

            try:
                # è©¦é¨“ç‰‡æƒ…å ±ã®å–å¾—
                specimen_id = filepath.stem
                spec_info = self.specimen_info[
                    self.specimen_info['specimen_id'] == specimen_id
                ].iloc[0]

                # ãƒ‡ãƒ¼ã‚¿èª­è¾¼
                loader = MechanicalTestDataLoader()
                df = loader.load_csv(str(filepath), skiprows=5)

                # åˆ—åãƒãƒƒãƒ”ãƒ³ã‚°
                col_map = loader.detect_columns(df, 'tensile')
                load = df[col_map['load']].values
                displacement = df[col_map['displacement']].values

                # å‰å‡¦ç†
                preprocessor = DataPreprocessor()
                load, displacement = preprocessor.remove_preload(load, displacement)

                # è§£æ
                analyzer = TensileAnalyzer(
                    initial_length=spec_info['L0'],
                    initial_diameter=spec_info['d0']
                )
                result = analyzer.analyze(load, displacement)

                # çµæœã®ä¿å­˜
                result_summary = {
                    'specimen_id': specimen_id,
                    'material': spec_info['material'],
                    'E_GPa': result['youngs_modulus_GPa'],
                    'sigma_02_MPa': result['yield_strength_02_MPa'],
                    'sigma_B_MPa': result['tensile_strength_MPa'],
                    'elongation_percent': result['elongation_percent']
                }
                self.results.append(result_summary)

            except Exception as e:
                print(f"âœ— ã‚¨ãƒ©ãƒ¼: {e}")
                continue

        # çµæœã‚’DataFrameã«å¤‰æ›
        results_df = pd.DataFrame(self.results)
        return results_df

    def statistical_summary(self, results_df: pd.DataFrame) -> pd.DataFrame:
        """
        çµ±è¨ˆè§£æï¼ˆææ–™åˆ¥é›†è¨ˆï¼‰
        """
        summary = results_df.groupby('material').agg({
            'E_GPa': ['mean', 'std', 'min', 'max'],
            'sigma_02_MPa': ['mean', 'std', 'min', 'max'],
            'sigma_B_MPa': ['mean', 'std', 'min', 'max'],
            'elongation_percent': ['mean', 'std', 'min', 'max']
        }).round(2)

        return summary

# ä½¿ç”¨ä¾‹
# è©¦é¨“ç‰‡æƒ…å ±ã®æº–å‚™
specimen_info = pd.DataFrame({
    'specimen_id': ['steel_A_01', 'steel_A_02', 'steel_A_03',
                    'aluminum_B_01', 'aluminum_B_02'],
    'material': ['Steel A', 'Steel A', 'Steel A', 'Aluminum B', 'Aluminum B'],
    'L0': [50, 50, 50, 50, 50],
    'd0': [6, 6, 6, 8, 8]
})

# ãƒãƒƒãƒå‡¦ç†ã®å®Ÿè¡Œ
processor = BatchProcessor('data/raw/tensile', specimen_info)
results_df = processor.process_all('*.csv')

# çµ±è¨ˆã‚µãƒãƒªãƒ¼
summary = processor.statistical_summary(results_df)
print("\n" + "=" * 80)
print("ã€ææ–™åˆ¥çµ±è¨ˆã‚µãƒãƒªãƒ¼ã€‘")
print("=" * 80)
print(summary)</code></pre>

        <h3>4.2 ææ–™æ¯”è¼ƒã®å¯è¦–åŒ–</h3>
        <pre><code>import seaborn as sns
import matplotlib.pyplot as plt

def plot_material_comparison(results_df: pd.DataFrame):
    """
    ææ–™é–“ã®æ©Ÿæ¢°çš„ç‰¹æ€§æ¯”è¼ƒ
    """
    fig, axes = plt.subplots(2, 2, figsize=(14, 10))

    # ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ
    palette = sns.color_palette("Set2")

    # (1) Youngç‡ã®æ¯”è¼ƒ
    ax1 = axes[0, 0]
    sns.boxplot(data=results_df, x='material', y='E_GPa', ax=ax1, palette=palette)
    sns.swarmplot(data=results_df, x='material', y='E_GPa', ax=ax1,
                  color='black', alpha=0.5, size=6)
    ax1.set_ylabel('Youngç‡ [GPa]', fontsize=12)
    ax1.set_xlabel('')
    ax1.set_title('Youngç‡ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
    ax1.grid(axis='y', alpha=0.3)

    # (2) å¼·åº¦ã®æ¯”è¼ƒ
    ax2 = axes[0, 1]
    strength_df = results_df.melt(id_vars='material',
                                   value_vars=['sigma_02_MPa', 'sigma_B_MPa'],
                                   var_name='strength_type', value_name='strength_MPa')
    sns.barplot(data=strength_df, x='material', y='strength_MPa',
                hue='strength_type', ax=ax2, palette=['#3498db', '#e74c3c'])
    ax2.set_ylabel('å¼·åº¦ [MPa]', fontsize=12)
    ax2.set_xlabel('')
    ax2.set_title('è€åŠ›ãƒ»å¼•å¼µå¼·åº¦ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
    ax2.legend(title='', labels=['0.2%è€åŠ›', 'å¼•å¼µå¼·åº¦'], fontsize=10)
    ax2.grid(axis='y', alpha=0.3)

    # (3) ç ´æ–­ä¼¸ã³ã®æ¯”è¼ƒ
    ax3 = axes[1, 0]
    sns.violinplot(data=results_df, x='material', y='elongation_percent',
                   ax=ax3, palette=palette, inner='box')
    ax3.set_ylabel('ç ´æ–­ä¼¸ã³ [%]', fontsize=12)
    ax3.set_xlabel('')
    ax3.set_title('å»¶æ€§ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
    ax3.grid(axis='y', alpha=0.3)

    # (4) å¼·åº¦-å»¶æ€§ãƒãƒ©ãƒ³ã‚¹
    ax4 = axes[1, 1]
    for material in results_df['material'].unique():
        material_data = results_df[results_df['material'] == material]
        ax4.scatter(material_data['sigma_B_MPa'],
                   material_data['elongation_percent'],
                   s=100, alpha=0.7, label=material)

    ax4.set_xlabel('å¼•å¼µå¼·åº¦ [MPa]', fontsize=12)
    ax4.set_ylabel('ç ´æ–­ä¼¸ã³ [%]', fontsize=12)
    ax4.set_title('å¼·åº¦-å»¶æ€§ãƒãƒ©ãƒ³ã‚¹', fontsize=13, fontweight='bold')
    ax4.legend(fontsize=10)
    ax4.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('results/figures/material_comparison.png', dpi=300, bbox_inches='tight')
    plt.show()

# å®Ÿè¡Œ
plot_material_comparison(results_df)</code></pre>

        <h2>5. è‡ªå‹•ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</h2>

        <h3>5.1 PDFãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</h3>
        <pre><code>from datetime import datetime
from matplotlib.backends.backend_pdf import PdfPages

class ReportGenerator:
    """
    æ©Ÿæ¢°è©¦é¨“çµæœã®è‡ªå‹•ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
    """

    def __init__(self, output_dir: str = 'results/reports'):
        self.output_dir = Path(output_dir)
        self.output_dir.mkdir(parents=True, exist_ok=True)

    def generate_pdf_report(self, results_df: pd.DataFrame,
                           specimen_name: str,
                           test_conditions: dict):
        """
        åŒ…æ‹¬çš„PDFãƒ¬ãƒãƒ¼ãƒˆã®ç”Ÿæˆ
        """
        timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
        filename = f"{specimen_name}_report_{timestamp}.pdf"
        filepath = self.output_dir / filename

        with PdfPages(filepath) as pdf:
            # Page 1: è¡¨ç´™
            fig = plt.figure(figsize=(8.5, 11))
            fig.text(0.5, 0.7, 'æ©Ÿæ¢°è©¦é¨“è§£æãƒ¬ãƒãƒ¼ãƒˆ',
                    ha='center', fontsize=24, fontweight='bold')
            fig.text(0.5, 0.6, f'è©¦é¨“ç‰‡: {specimen_name}',
                    ha='center', fontsize=16)
            fig.text(0.5, 0.5, f'ä½œæˆæ—¥æ™‚: {datetime.now().strftime("%Yå¹´%mæœˆ%dæ—¥ %H:%M")}',
                    ha='center', fontsize=12)

            # è©¦é¨“æ¡ä»¶
            conditions_text = "\nã€è©¦é¨“æ¡ä»¶ã€‘\n"
            for key, value in test_conditions.items():
                conditions_text += f"{key}: {value}\n"
            fig.text(0.5, 0.3, conditions_text, ha='center', fontsize=11, family='monospace')

            plt.axis('off')
            pdf.savefig(fig, bbox_inches='tight')
            plt.close()

            # Page 2: è§£æçµæœã‚°ãƒ©ãƒ•
            plot_tensile_analysis(results_df.iloc[0].to_dict(), specimen_name)
            pdf.savefig(bbox_inches='tight')
            plt.close()

            # Page 3: çµ±è¨ˆè§£æ
            if len(results_df) > 1:
                plot_material_comparison(results_df)
                pdf.savefig(bbox_inches='tight')
                plt.close()

        print(f"âœ“ PDFãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†: {filepath}")
        return filepath

# ä½¿ç”¨ä¾‹
test_conditions = {
    'è©¦é¨“è¦æ ¼': 'JIS Z 2241',
    'è©¦é¨“æ¸©åº¦': 'å®¤æ¸©ï¼ˆ23Â±2Â°Cï¼‰',
    'å¼•å¼µé€Ÿåº¦': '5 mm/min',
    'è©¦é¨“æ©Ÿ': 'Instron 5985',
    'æ¨™ç‚¹é–“è·é›¢': '50 mm',
    'è©¦é¨“ç‰‡å½¢çŠ¶': 'JIS 14A'
}

generator = ReportGenerator()
report_path = generator.generate_pdf_report(results_df, 'Steel_A_Series', test_conditions)</code></pre>

        <h2>6. ç•°å¸¸å€¤æ¤œå‡ºã¨QCç®¡ç†</h2>

        <h3>6.1 å“è³ªç®¡ç†ãƒãƒ£ãƒ¼ãƒˆ</h3>
        <pre><code>class QualityControl:
    """
    è©¦é¨“çµæœã®å“è³ªç®¡ç†
    """

    @staticmethod
    def calculate_control_limits(data: np.ndarray,
                                 sigma_level: float = 3.0) -> dict:
        """
        ç®¡ç†é™ç•Œã®è¨ˆç®—ï¼ˆå¹³å‡Â±3Ïƒæ³•ï¼‰
        """
        mean = np.mean(data)
        std = np.std(data, ddof=1)

        ucl = mean + sigma_level * std  # ä¸Šæ–¹ç®¡ç†é™ç•Œ
        lcl = mean - sigma_level * std  # ä¸‹æ–¹ç®¡ç†é™ç•Œ

        return {
            'mean': mean,
            'std': std,
            'ucl': ucl,
            'lcl': lcl
        }

    @staticmethod
    def detect_outliers(data: np.ndarray, limits: dict) -> np.ndarray:
        """
        ç®¡ç†é™ç•Œå¤–ãƒ‡ãƒ¼ã‚¿ã®æ¤œå‡º
        """
        outliers_mask = (data > limits['ucl']) | (data < limits['lcl'])
        return outliers_mask

    @staticmethod
    def plot_control_chart(results_df: pd.DataFrame,
                          property_name: str,
                          material: str = None):
        """
        ç®¡ç†å›³ã®ä½œæˆ
        """
        if material:
            data = results_df[results_df['material'] == material]
        else:
            data = results_df

        values = data[property_name].values
        limits = QualityControl.calculate_control_limits(values)
        outliers = QualityControl.detect_outliers(values, limits)

        fig, ax = plt.subplots(figsize=(12, 6))

        # ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ­ãƒƒãƒˆ
        x = np.arange(len(values))
        ax.plot(x, values, 'o-', linewidth=2, markersize=8, label='æ¸¬å®šå€¤')

        # ç®¡ç†é™ç•Œç·š
        ax.axhline(y=limits['mean'], color='green', linestyle='-',
                  linewidth=2, label=f"å¹³å‡å€¤ {limits['mean']:.1f}")
        ax.axhline(y=limits['ucl'], color='red', linestyle='--',
                  linewidth=1.5, label=f"UCL {limits['ucl']:.1f}")
        ax.axhline(y=limits['lcl'], color='red', linestyle='--',
                  linewidth=1.5, label=f"LCL {limits['lcl']:.1f}")

        # ç®¡ç†é™ç•Œå¤–ãƒ‡ãƒ¼ã‚¿ã‚’å¼·èª¿
        if np.any(outliers):
            ax.plot(x[outliers], values[outliers], 'rx', markersize=15,
                   markeredgewidth=3, label='ç•°å¸¸å€¤')

        ax.set_xlabel('è©¦é¨“ç‰‡ç•ªå·', fontsize=12)
        ax.set_ylabel(f'{property_name}', fontsize=12)
        ax.set_title(f'å“è³ªç®¡ç†å›³: {property_name} ({material if material else "å…¨ææ–™"})',
                    fontsize=14, fontweight='bold')
        ax.legend(fontsize=10)
        ax.grid(True, alpha=0.3)

        plt.tight_layout()
        plt.savefig(f'results/figures/QC_{property_name}.png', dpi=300)
        plt.show()

        # ç•°å¸¸å€¤ã®ãƒ¬ãƒãƒ¼ãƒˆ
        if np.any(outliers):
            print(f"âš  ç•°å¸¸å€¤æ¤œå‡º: {np.sum(outliers)}ä»¶")
            print(data[outliers][['specimen_id', property_name]])

# ä½¿ç”¨ä¾‹
qc = QualityControl()
qc.plot_control_chart(results_df, 'sigma_B_MPa', material='Steel A')</code></pre>

        <h2>æ¼”ç¿’å•é¡Œ</h2>

        <div class="exercise-box">
            <h3>æ¼”ç¿’1: ãƒ‡ãƒ¼ã‚¿ãƒ­ãƒ¼ãƒ€ãƒ¼ã®æ‹¡å¼µï¼ˆåˆç´šï¼‰</h3>
            <p>MechanicalTestDataLoaderã‚¯ãƒ©ã‚¹ã«ã€ã‚¿ãƒ–åŒºåˆ‡ã‚Šï¼ˆTSVï¼‰å½¢å¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’2: å‰å‡¦ç†ã®æ”¹è‰¯ï¼ˆä¸­ç´šï¼‰</h3>
            <p>DataPreprocessorã‚¯ãƒ©ã‚¹ã«ã€ç§»å‹•å¹³å‡ãƒ•ã‚£ãƒ«ã‚¿ã«ã‚ˆã‚‹å¹³æ»‘åŒ–é–¢æ•°ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚µã‚¤ã‚ºã‚’ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æŒ‡å®šã§ãã‚‹ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’3: çœŸå¿œåŠ›-çœŸã²ãšã¿å¤‰æ›ï¼ˆä¸­ç´šï¼‰</h3>
            <p>TensileAnalyzerã‚¯ãƒ©ã‚¹ã«ã€å·¥å­¦å¿œåŠ›-å·¥å­¦ã²ãšã¿ã‹ã‚‰çœŸå¿œåŠ›-çœŸã²ãšã¿ã¸ã®å¤‰æ›é–¢æ•°ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚</p>
            <p><strong>å…¬å¼</strong>: Ïƒ<sub>true</sub> = Ïƒ<sub>eng</sub>(1 + Îµ<sub>eng</sub>), Îµ<sub>true</sub> = ln(1 + Îµ<sub>eng</sub>)</p>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’4: ç¡¬ã•è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®è§£æï¼ˆä¸­ç´šï¼‰</h3>
            <p>ãƒ“ãƒƒã‚«ãƒ¼ã‚¹ç¡¬ã•è©¦é¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆ10ç‚¹æ¸¬å®šï¼‰ã‹ã‚‰ã€å¹³å‡å€¤ãƒ»æ¨™æº–åå·®ãƒ»95%ä¿¡é ¼åŒºé–“ã‚’è¨ˆç®—ã™ã‚‹Pythoné–¢æ•°ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’5: S-Næ›²ç·šã®è‡ªå‹•ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼ˆä¸Šç´šï¼‰</h3>
            <p>ç–²åŠ´è©¦é¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆå¿œåŠ›æŒ¯å¹…ã€ç ´æ–­ç¹°è¿”ã—æ•°ï¼‰ã‹ã‚‰Basquinå¼ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è‡ªå‹•ç®—å‡ºã—ã€ç–²åŠ´é™åº¦ã‚’æ¨å®šã™ã‚‹é–¢æ•°ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’6: ãƒãƒƒãƒå‡¦ç†ã®ä¸¦åˆ—åŒ–ï¼ˆä¸Šç´šï¼‰</h3>
            <p>BatchProcessorã‚¯ãƒ©ã‚¹ã‚’æ‹¡å¼µã—ã€multiprocessingã‚’ç”¨ã„ã¦è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸¦åˆ—å‡¦ç†ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’7: ç•°å¸¸ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•æ¤œå‡ºï¼ˆä¸Šç´šï¼‰</h3>
            <p>å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®ç•°å¸¸ã‚’è‡ªå‹•æ¤œå‡ºã™ã‚‹ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³é–¢æ•°ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
            <ul>
                <li>Youngç‡ãŒææ–™ã®ç¯„å›²å¤–ï¼ˆé‰„é‹¼: 180-220 GPaï¼‰</li>
                <li>ç ´æ–­ä¼¸ã³ãŒè² ã®å€¤</li>
                <li>é™ä¼å¼·åº¦ãŒå¼•å¼µå¼·åº¦ã‚ˆã‚Šå¤§ãã„</li>
            </ul>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’8: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºï¼ˆå¿œç”¨ï¼‰</h3>
            <p>è§£æçµæœã‚’SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã—ã€ææ–™åãƒ»è©¦é¨“æ—¥ãƒ»è©¦é¨“è€…ã§æ¤œç´¢ã§ãã‚‹ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’9: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆå¿œç”¨ï¼‰</h3>
            <p>Streamlitã‚’ä½¿ç”¨ã—ã€è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦è‡ªå‹•è§£æçµæœã‚’è¡¨ç¤ºã™ã‚‹Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div class="exercise-box">
            <h3>æ¼”ç¿’10: ç·åˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆå¿œç”¨ï¼‰</h3>
            <p>ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æŒã¤å®Œå…¨ãªæ©Ÿæ¢°è©¦é¨“ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¦ãã ã•ã„ã€‚</p>
            <ul>
                <li>è¤‡æ•°è©¦é¨“ç¨®é¡ï¼ˆå¼•å¼µãƒ»ç¡¬ã•ãƒ»ç–²åŠ´ï¼‰ã®çµ±åˆç®¡ç†</li>
                <li>ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã®é€£æº</li>
                <li>è‡ªå‹•ç•°å¸¸æ¤œå‡ºã¨ã‚¢ãƒ©ãƒ¼ãƒˆæ©Ÿèƒ½</li>
                <li>çµ±è¨ˆè§£æã¨ææ–™æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</li>
                <li>Webãƒ™ãƒ¼ã‚¹ã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</li>
            </ul>
        </div>

        <h2>å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Wes McKinney, "Python for Data Analysis", 3rd Edition, O'Reilly Media (2022), pp. 89-145, 267-312</li>
            <li>Jake VanderPlas, "Python Data Science Handbook", 2nd Edition, O'Reilly Media (2023), pp. 78-134, 189-245</li>
            <li>Pandas Development Team, "pandas: powerful Python data analysis toolkit", https://pandas.pydata.org/docs/ (2024)</li>
            <li>Matplotlib Development Team, "Matplotlib Documentation", https://matplotlib.org/ (2024)</li>
            <li>SciPy Developers, "SciPy Documentation", https://docs.scipy.org/ (2024)</li>
            <li>G. E. Dieter, D. J. Bacon, "Mechanical Metallurgy", SI Metric Edition, McGraw-Hill Education (2013), pp. 487-534 (Testingç« )</li>
            <li>JIS Z 2241:2011, "é‡‘å±ææ–™å¼•å¼µè©¦é¨“æ–¹æ³•", æ—¥æœ¬è¦æ ¼å”ä¼š (2011)</li>
        </ol>

        <div class="navigation">
            <a href="chapter-3.html" class="nav-button">â† ç¬¬3ç« ï¼šç ´å£Šé­æ€§ã¨ç–²åŠ´è©¦é¨“</a>
            <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡ã«æˆ»ã‚‹</a>
        </div>
    </main>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: MS Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-28</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>