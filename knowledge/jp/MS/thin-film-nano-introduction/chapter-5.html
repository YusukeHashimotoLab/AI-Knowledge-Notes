<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 5: Pythonå®Ÿè·µãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ | è–„è†œãƒ»ãƒŠãƒææ–™ãƒ—ãƒ­ã‚»ã‚¹å…¥é–€</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', 'Hiragino Sans', 'Hiragino Kaku Gothic ProN', Meiryo, sans-serif;
            line-height: 1.8;
            color: #2c3e50;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        h1 {
            color: #f5576c;
            font-size: 2.5em;
            margin-bottom: 30px;
            border-bottom: 3px solid #f093fb;
            padding-bottom: 15px;
        }

        h2 {
            color: #e84393;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            border-left: 5px solid #f093fb;
            padding-left: 15px;
        }

        h3 {
            color: #6c5ce7;
            font-size: 1.3em;
            margin-top: 30px;
            margin-bottom: 15px;
        }

        p {
            margin-bottom: 15px;
            text-align: justify;
        }

        .math {
            overflow-x: auto;
            margin: 20px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        pre {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 20px 0;
        }

        code {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }

        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .exercise-box {
            background: #f3e5f5;
            border: 2px solid #9c27b0;
            padding: 20px;
            margin: 30px 0;
            border-radius: 8px;
        }

        .exercise-box h4 {
            color: #9c27b0;
            margin-bottom: 15px;
        }

        .solution {
            background: #e8f5e9;
            padding: 15px;
            margin-top: 15px;
            border-radius: 5px;
            display: none;
        }

        .solution.show {
            display: block;
        }

        .toggle-solution {
            background: #9c27b0;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        .toggle-solution:hover {
            background: #7b1fa2;
        }

        ul, ol {
            margin-left: 30px;
            margin-bottom: 15px;
        }

        li {
            margin-bottom: 8px;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 50px;
            padding-top: 30px;
            border-top: 2px solid #f093fb;
        }

        .nav-button {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 12px 24px;
            text-decoration: none;
            border-radius: 5px;
            transition: transform 0.2s;
        }

        .nav-button:hover {
            transform: translateY(-2px);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        th {
            background: #f093fb;
            color: white;
        }

        tr:nth-child(even) {
            background: #f8f9fa;
        }

        .learning-objectives {
            background: #fff9e6;
            border: 2px solid #ffd93d;
            border-radius: 8px;
            padding: 20px;
            margin: 30px 0;
        }

        .learning-objectives h3 {
            color: #f39c12;
            margin-top: 0;
        }

        .objective-list {
            list-style: none;
            margin-left: 0;
        }

        .objective-list li {
            padding-left: 30px;
            position: relative;
            margin-bottom: 12px;
        }

        .objective-list li:before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: #27ae60;
            font-weight: bold;
            font-size: 1.2em;
        }

        footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #ecf0f1;
            text-align: center;
            color: #7f8c8d;
        }

        .mermaid {
            background: white;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <div class="container">
        <h1>Chapter 5: Pythonå®Ÿè·µãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h1>

        <div class="learning-objectives">
            <h3>ğŸ¯ ã“ã®ç« ã®å­¦ç¿’ç›®æ¨™</h3>
            <ul class="objective-list">
                <li><strong>ãƒ¬ãƒ™ãƒ«1ï¼ˆåŸºæœ¬ç†è§£ï¼‰</strong>: è–„è†œãƒ—ãƒ­ã‚»ã‚¹ã®çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å¿…è¦æ€§ã‚’ç†è§£ã™ã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«1ï¼ˆåŸºæœ¬ç†è§£ï¼‰</strong>: å¤šç›®çš„æœ€é©åŒ–ã¨Paretoæœ€é©è§£ã®æ¦‚å¿µã‚’èª¬æ˜ã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«1ï¼ˆåŸºæœ¬ç†è§£ï¼‰</strong>: æ©Ÿæ¢°å­¦ç¿’ã®ææ–™ãƒ—ãƒ­ã‚»ã‚¹ã¸ã®å¿œç”¨å¯èƒ½æ€§ã‚’ç†è§£ã™ã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«1ï¼ˆåŸºæœ¬ç†è§£ï¼‰</strong>: Materials Projectã®å½¹å‰²ã¨APIåˆ©ç”¨ã®åˆ©ç‚¹ã‚’ç†è§£ã™ã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: PVD/CVD/ALDã‚’çµ±åˆã—ãŸè–„è†œæˆé•·ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: scipy.optimizeã‚’ç”¨ã„ã¦å¤šç›®çš„ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ã‚’å®Ÿè¡Œã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: RandomForest/XGBoostã§è†œè³ªäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: Materials Project APIã§ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ¤œç´¢ã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: Bayesian optimizationã§è‡ªå‹•å®Ÿé¨“è¨ˆç”»ã‚’å®Ÿè£…ã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«2ï¼ˆå®Ÿè·µã‚¹ã‚­ãƒ«ï¼‰</strong>: Flask + Plotlyã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«3ï¼ˆå¿œç”¨åŠ›ï¼‰</strong>: å®Ÿãƒ—ãƒ­ã‚»ã‚¹ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æœ€é©æ¡ä»¶ã‚’å°å‡ºã—ã€å®Ÿé¨“ææ¡ˆã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«3ï¼ˆå¿œç”¨åŠ›ï¼‰</strong>: æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®äºˆæ¸¬ç²¾åº¦ã‚’è©•ä¾¡ã—ã€æ”¹å–„ç­–ã‚’ææ¡ˆã§ãã‚‹</li>
                <li><strong>ãƒ¬ãƒ™ãƒ«3ï¼ˆå¿œç”¨åŠ›ï¼‰</strong>: çµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã—ã€è‡ªå‹•åŒ–ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­è¨ˆã§ãã‚‹</li>
            </ul>
        </div>

        <h2>5.1 è–„è†œæˆé•·çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h2>

        <p>
            å®Ÿéš›ã®è–„è†œãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€PVDï¼ˆã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°ã€è’¸ç€ï¼‰ã€CVDï¼ˆç†±CVDã€PECVDï¼‰ã€ALDï¼ˆåŸå­å±¤å †ç©ï¼‰ãªã©ã€è¤‡æ•°ã®æˆè†œæ‰‹æ³•ã‚’çµ„ã¿åˆã‚ã›ã¦ä½¿ç”¨ã—ã¾ã™ã€‚å„ãƒ—ãƒ­ã‚»ã‚¹ã®æˆé•·é€Ÿåº¦ã€å‡ä¸€æ€§ã€è†œè³ªã‚’çµ±ä¸€çš„ã«è©•ä¾¡ãƒ»æ¯”è¼ƒã™ã‚‹ãŸã‚ã€<strong>çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</strong>ãŒæœ‰åŠ¹ã§ã™ã€‚
        </p>

        <h3>çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®è¨­è¨ˆ</h3>

        <div class="mermaid">
        flowchart TD
            A[ãƒ—ãƒ­ã‚»ã‚¹é¸æŠ] --> B{PVD / CVD / ALD}
            B -->|PVD| C[ã‚¹ãƒ‘ãƒƒã‚¿/è’¸ç€ãƒ¢ãƒ‡ãƒ«]
            B -->|CVD| D[åå¿œé€Ÿåº¦è«–ãƒ¢ãƒ‡ãƒ«]
            B -->|ALD| E[è‡ªå·±åˆ¶é™æˆé•·ãƒ¢ãƒ‡ãƒ«]

            C --> F[æˆè†œé€Ÿåº¦è¨ˆç®—]
            D --> F
            E --> F

            F --> G[è†œåšåˆ†å¸ƒè§£æ]
            G --> H[å‡ä¸€æ€§è©•ä¾¡]
            H --> I[æœ€é©æ¡ä»¶ææ¡ˆ]

            style A fill:#ffeaa7
            style B fill:#74b9ff
            style I fill:#55efc4
        </flowchart>
        </div>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: è–„è†œæˆé•·çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼</h3>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from dataclasses import dataclass
from typing import Tuple, Dict

@dataclass
class ProcessParams:
    """ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹"""
    temperature: float  # æ¸©åº¦ [K]
    pressure: float  # åœ§åŠ› [Pa]
    power: float  # é›»åŠ› [W]ï¼ˆPVD/PECVDã®ã¿ï¼‰
    precursor_flow: float  # å‰é§†ä½“æµé‡ [sccm]ï¼ˆCVD/ALDã®ã¿ï¼‰
    time: float  # æˆè†œæ™‚é–“ [s]

class ThinFilmSimulator:
    """è–„è†œæˆé•·çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼"""

    def __init__(self, substrate_diameter: float = 0.15):
        """
        Parameters:
        -----------
        substrate_diameter : float
            åŸºæ¿ç›´å¾„ [m]ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ150 mmï¼‰
        """
        self.substrate_diameter = substrate_diameter
        self.r_positions = np.linspace(0, substrate_diameter/2, 100)

    def pvd_sputtering(self, params: ProcessParams) -> Tuple[np.ndarray, float]:
        """
        ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°PVDã®æˆè†œé€Ÿåº¦è¨ˆç®—

        Returns:
        --------
        thickness_profile : array
            è†œåšåˆ†å¸ƒ [nm]
        avg_rate : float
            å¹³å‡æˆè†œé€Ÿåº¦ [nm/min]
        """
        # ã‚¹ãƒ‘ãƒƒã‚¿åç‡ï¼ˆSigmundãƒ¢ãƒ‡ãƒ«ç°¡ç•¥ç‰ˆï¼‰
        target_distance = 0.05  # ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ-åŸºæ¿é–“è·é›¢ [m]

        # å…¥å°„è§’åº¦ä¾å­˜ã®è†œåšåˆ†å¸ƒï¼ˆcosineå‰‡ï¼‰
        theta = np.arctan(self.r_positions / target_distance)
        cosine_factor = np.cos(theta)**2

        # æˆè†œé€Ÿåº¦ï¼ˆãƒ‘ãƒ¯ãƒ¼ä¾å­˜ï¼‰
        rate_center = 0.5 * (params.power / 100) * (params.pressure / 1.0)  # nm/s at center
        thickness_profile = rate_center * cosine_factor * params.time / 60  # nm

        avg_rate = thickness_profile.mean() / params.time * 60  # nm/min

        return thickness_profile, avg_rate

    def cvd_thermal(self, params: ProcessParams) -> Tuple[np.ndarray, float]:
        """
        ç†±CVDã®æˆè†œé€Ÿåº¦è¨ˆç®—ï¼ˆArrheniuså‹åå¿œé€Ÿåº¦è«–ï¼‰

        Returns:
        --------
        thickness_profile : array
            è†œåšåˆ†å¸ƒ [nm]
        avg_rate : float
            å¹³å‡æˆè†œé€Ÿåº¦ [nm/min]
        """
        # Arrheniusåå¿œé€Ÿåº¦å®šæ•°
        k0 = 1e5  # é »åº¦å› å­ [nm/min]
        Ea = 50000  # æ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ [J/mol]
        R_gas = 8.314  # J/(molÂ·K)

        # è¡¨é¢åå¿œå¾‹é€Ÿé€Ÿåº¦
        k_surface = k0 * np.exp(-Ea / (R_gas * params.temperature))

        # å‰é§†ä½“ä¾›çµ¦ä¾å­˜ï¼ˆæµé‡ã¨åœ§åŠ›ï¼‰
        rate_center = k_surface * (params.precursor_flow / 100) * (params.pressure / 100)

        # æ¸©åº¦åˆ†å¸ƒï¼ˆåŸºæ¿ä¸­å¿ƒãŒæœ€ã‚‚é«˜æ¸©ã€ã‚¨ãƒƒã‚¸ã§5%ä½ä¸‹ï¼‰
        temp_profile = 1 - 0.05 * (self.r_positions / (self.substrate_diameter/2))**2
        thickness_profile = rate_center * temp_profile * params.time / 60  # nm

        avg_rate = thickness_profile.mean() / params.time * 60  # nm/min

        return thickness_profile, avg_rate

    def ald_cycle(self, params: ProcessParams, cycles: int = 100) -> Tuple[np.ndarray, float]:
        """
        ALDã®æˆè†œè¨ˆç®—ï¼ˆè‡ªå·±åˆ¶é™æˆé•·ï¼‰

        Parameters:
        -----------
        cycles : int
            ALDã‚µã‚¤ã‚¯ãƒ«æ•°

        Returns:
        --------
        thickness_profile : array
            è†œåšåˆ†å¸ƒ [nm]
        avg_rate : float
            å¹³å‡æˆè†œé€Ÿåº¦ [nm/cycle]
        """
        # Growth Per Cycleï¼ˆæ¸©åº¦ä¾å­˜ã€æˆé•·çª“å†…ã§ä¸€å®šï¼‰
        T_window_low = 150  # æˆé•·çª“ä¸‹é™ [Â°C]
        T_window_high = 350  # æˆé•·çª“ä¸Šé™ [Â°C]
        T_celsius = params.temperature - 273

        if T_window_low <= T_celsius <= T_window_high:
            GPC = 0.1  # nm/cycleï¼ˆæˆé•·çª“å†…ï¼‰
        elif T_celsius < T_window_low:
            GPC = 0.1 * (1 + 0.3 * (T_window_low - T_celsius) / 100)  # ä½æ¸©ã§ä¸å®Œå…¨åå¿œ
        else:
            GPC = 0.1 * (1 + 0.2 * (T_celsius - T_window_high) / 100)  # é«˜æ¸©ã§åˆ†è§£

        # ALDã¯ç†æƒ³çš„ã«ã¯å®Œå…¨å‡ä¸€ï¼ˆå‰é§†ä½“æ‹¡æ•£ãŒååˆ†ï¼‰
        uniformity = 0.98  # 98%å‡ä¸€æ€§
        thickness_profile = GPC * cycles * (1 - 0.01 * (self.r_positions / (self.substrate_diameter/2))**2 * (1-uniformity))

        avg_rate = GPC  # nm/cycle

        return thickness_profile, avg_rate

    def calculate_uniformity(self, thickness_profile: np.ndarray) -> float:
        """
        è†œåšå‡ä¸€æ€§ã‚’è¨ˆç®—

        Returns:
        --------
        uniformity : float
            å‡ä¸€æ€§ [%]ï¼ˆ100% = å®Œå…¨å‡ä¸€ï¼‰
        """
        mean_thickness = thickness_profile.mean()
        std_thickness = thickness_profile.std()
        uniformity = (1 - std_thickness / mean_thickness) * 100
        return uniformity

# çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
simulator = ThinFilmSimulator(substrate_diameter=0.15)

# PVD: ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°
pvd_params = ProcessParams(temperature=300, pressure=0.5, power=200, precursor_flow=0, time=600)  # 10åˆ†
pvd_thickness, pvd_rate = simulator.pvd_sputtering(pvd_params)
pvd_uniformity = simulator.calculate_uniformity(pvd_thickness)

# CVD: ç†±CVD
cvd_params = ProcessParams(temperature=873, pressure=100, power=0, precursor_flow=50, time=600)  # 10åˆ†
cvd_thickness, cvd_rate = simulator.cvd_thermal(cvd_params)
cvd_uniformity = simulator.calculate_uniformity(cvd_thickness)

# ALD: 100ã‚µã‚¤ã‚¯ãƒ«
ald_params = ProcessParams(temperature=473, pressure=1, power=0, precursor_flow=20, time=0)
ald_thickness, ald_gpc = simulator.ald_cycle(ald_params, cycles=100)
ald_uniformity = simulator.calculate_uniformity(ald_thickness)

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# è†œåšåˆ†å¸ƒ
r_mm = simulator.r_positions * 1000  # mm
axes[0].plot(r_mm, pvd_thickness, 'b-', linewidth=2, label=f'PVD (å‡ä¸€æ€§: {pvd_uniformity:.1f}%)')
axes[0].plot(r_mm, cvd_thickness, 'g-', linewidth=2, label=f'CVD (å‡ä¸€æ€§: {cvd_uniformity:.1f}%)')
axes[0].plot(r_mm, ald_thickness, 'r-', linewidth=2, label=f'ALD (å‡ä¸€æ€§: {ald_uniformity:.1f}%)')
axes[0].set_xlabel('åŸºæ¿åŠå¾„æ–¹å‘ä½ç½® [mm]', fontsize=12)
axes[0].set_ylabel('è†œåš [nm]', fontsize=12)
axes[0].set_title('è–„è†œæˆé•·çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: è†œåšåˆ†å¸ƒ', fontsize=14)
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# ãƒ—ãƒ­ã‚»ã‚¹æ¯”è¼ƒ
processes = ['PVD\nã‚¹ãƒ‘ãƒƒã‚¿', 'CVD\nç†±CVD', 'ALD\n100ã‚µã‚¤ã‚¯ãƒ«']
rates = [pvd_rate, cvd_rate, ald_gpc * 100 / 10]  # å…¨ã¦ nm/min ã«æ›ç®—
uniformities = [pvd_uniformity, cvd_uniformity, ald_uniformity]

x_pos = np.arange(len(processes))
width = 0.35

axes[1].bar(x_pos - width/2, rates, width, label='æˆè†œé€Ÿåº¦ [nm/min]', color='steelblue')
axes[1].bar(x_pos + width/2, uniformities, width, label='å‡ä¸€æ€§ [%]', color='coral')
axes[1].set_xticks(x_pos)
axes[1].set_xticklabels(processes)
axes[1].set_ylabel('å€¤', fontsize=12)
axes[1].set_title('ãƒ—ãƒ­ã‚»ã‚¹æ¯”è¼ƒ: æˆè†œé€Ÿåº¦ vs å‡ä¸€æ€§', fontsize=14)
axes[1].legend()
axes[1].grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig('integrated_thin_film_simulator.png', dpi=300, bbox_inches='tight')
plt.show()

print("=== çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ ===")
print(f"PVDï¼ˆã‚¹ãƒ‘ãƒƒã‚¿ï¼‰: å¹³å‡è†œåš {pvd_thickness.mean():.1f} nm, é€Ÿåº¦ {pvd_rate:.2f} nm/min, å‡ä¸€æ€§ {pvd_uniformity:.1f}%")
print(f"CVDï¼ˆç†±CVDï¼‰: å¹³å‡è†œåš {cvd_thickness.mean():.1f} nm, é€Ÿåº¦ {cvd_rate:.2f} nm/min, å‡ä¸€æ€§ {cvd_uniformity:.1f}%")
print(f"ALDï¼ˆ100ã‚µã‚¤ã‚¯ãƒ«ï¼‰: å¹³å‡è†œåš {ald_thickness.mean():.1f} nm, GPC {ald_gpc:.2f} nm/cycle, å‡ä¸€æ€§ {ald_uniformity:.1f}%")
</code></pre>

        <div class="info-box">
            <strong>ğŸ’¡ å®Ÿãƒ—ãƒ­ã‚»ã‚¹ã¸ã®å¿œç”¨</strong><br>
            ã“ã®çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹é¸æŠã®æ„æ€æ±ºå®šã«ä½¿ç”¨ã§ãã¾ã™ã€‚ä¾‹ãˆã°ã€<strong>é«˜ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆ</strong>ï¼ˆPVDï¼‰vs <strong>é«˜å‡ä¸€æ€§</strong>ï¼ˆALDï¼‰ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’å®šé‡åŒ–ã—ã€ç›®çš„ã«å¿œã˜ãŸæœ€é©ãƒ—ãƒ­ã‚»ã‚¹ã‚’é¸æŠã§ãã¾ã™ã€‚å®Ÿé¨“å‰ã«ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ã‚’äº‹å‰æ¤œè¨ã™ã‚‹ã“ã¨ã§ã€è©¦è¡ŒéŒ¯èª¤å›æ•°ã‚’å‰Šæ¸›ã§ãã¾ã™ã€‚
        </div>

        <h2>5.2 å¤šç›®çš„ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–</h2>

        <p>
            è–„è†œãƒ—ãƒ­ã‚»ã‚¹ã®æœ€é©åŒ–ã§ã¯ã€è¤‡æ•°ã®ç›®çš„é–¢æ•°ï¼ˆæˆè†œé€Ÿåº¦ã€å‡ä¸€æ€§ã€ã‚³ã‚¹ãƒˆã€è†œè³ªï¼‰ã‚’åŒæ™‚ã«æœ€å¤§åŒ–ãƒ»æœ€å°åŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯<strong>å¤šç›®çš„æœ€é©åŒ–å•é¡Œ</strong>ã§ã‚ã‚Šã€å˜ä¸€ã®æœ€é©è§£ã§ã¯ãªãã€<strong>Paretoæœ€é©è§£é›†åˆ</strong>ãŒå¾—ã‚‰ã‚Œã¾ã™ã€‚
        </p>

        <h3>Paretoæœ€é©æ€§</h3>

        <p>
            ã‚ã‚‹è§£ãŒ<strong>Paretoæœ€é©</strong>ã§ã‚ã‚‹ã¨ã¯ã€ä»–ã®ã„ãšã‚Œã‹ã®ç›®çš„ã‚’æ‚ªåŒ–ã•ã›ãšã«æ”¹å–„ã™ã‚‹ã“ã¨ãŒã§ããªã„çŠ¶æ…‹ã‚’æŒ‡ã—ã¾ã™ã€‚Paretoæœ€é©è§£ã®é›†åˆã‚’<strong>Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢</strong>ã¨å‘¼ã³ã€ã“ã‚ŒãŒæœ€é©ãªãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’ç¤ºã—ã¾ã™ã€‚
        </p>

        <div class="math">
            \[
            \begin{aligned}
            &\text{å¤šç›®çš„æœ€é©åŒ–å•é¡Œ:} \\
            &\min_{x} \quad \mathbf{F}(x) = [f_1(x), f_2(x), \ldots, f_m(x)] \\
            &\text{subject to} \quad g_i(x) \leq 0, \quad i = 1, \ldots, p \\[10pt]
            &\text{Paretoå„ªä½:} \\
            &x^* \text{ ãŒ Paretoæœ€é©} \Leftrightarrow \nexists x : f_i(x) \leq f_i(x^*) \ \forall i \ \land \ \exists j : f_j(x) < f_j(x^*)
            \end{aligned}
            \]
        </div>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: å¤šç›®çš„ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ï¼ˆæˆè†œé€Ÿåº¦ vs å‡ä¸€æ€§ vs ã‚³ã‚¹ãƒˆï¼‰</h3>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import minimize, differential_evolution
from mpl_toolkits.mplot3d import Axes3D

def thin_film_objective(x):
    """
    è–„è†œãƒ—ãƒ­ã‚»ã‚¹ã®å¤šç›®çš„é–¢æ•°

    Parameters:
    -----------
    x : array [temperature, pressure, power, time]
        ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶
        - temperature [K]: 300-1000
        - pressure [Pa]: 0.1-100
        - power [W]: 50-500
        - time [min]: 1-60

    Returns:
    --------
    objectives : tuple
        (æˆè†œé€Ÿåº¦[è² ], å‡ä¸€æ€§[è² ], ã‚³ã‚¹ãƒˆ)
    """
    temperature, pressure, power, time = x

    # æˆè†œé€Ÿåº¦ï¼ˆArrheniusãƒ¢ãƒ‡ãƒ« + é›»åŠ›ä¾å­˜ï¼‰
    k0 = 100  # nm/min
    Ea = 40000  # J/mol
    R = 8.314
    rate = k0 * np.exp(-Ea / (R * temperature)) * (power / 100) * (pressure / 10)

    # å‡ä¸€æ€§ï¼ˆæ¸©åº¦ãƒ»åœ§åŠ›ä¾å­˜ã€ç†æƒ³æ¡ä»¶ã‹ã‚‰ã®ãšã‚Œã§ãƒšãƒŠãƒ«ãƒ†ã‚£ï¼‰
    T_ideal = 650  # K
    P_ideal = 10  # Pa
    uniformity = 100 * np.exp(-0.001 * (temperature - T_ideal)**2 - 0.01 * (pressure - P_ideal)**2)

    # ã‚³ã‚¹ãƒˆï¼ˆé›»åŠ›æ¶ˆè²» + æ™‚é–“ï¼‰
    cost = power * time * 0.01 + time * 0.5  # ä»»æ„å˜ä½

    # ç›®çš„é–¢æ•°ï¼ˆæœ€å°åŒ–å•é¡Œã«çµ±ä¸€ï¼‰
    return -rate, -uniformity, cost

def weighted_sum_objective(x, weights):
    """
    é‡ã¿ä»˜ãå’Œã‚¹ã‚«ãƒ©ãƒ¼åŒ–
    """
    objectives = thin_film_objective(x)
    return sum(w * obj for w, obj in zip(weights, objectives))

def constraint_temperature(x):
    """æ¸©åº¦åˆ¶ç´„: 300 <= T <= 1000"""
    return 1000 - x[0]

def constraint_pressure(x):
    """åœ§åŠ›åˆ¶ç´„: 0.1 <= P <= 100"""
    return 100 - x[1]

def constraint_power(x):
    """é›»åŠ›åˆ¶ç´„: 50 <= W <= 500"""
    return 500 - x[2]

def constraint_time(x):
    """æ™‚é–“åˆ¶ç´„: 1 <= t <= 60"""
    return 60 - x[3]

# Paretoæœ€é©è§£ã‚’æ¢ç´¢ï¼ˆé‡ã¿æ³•ï¼‰
weights_list = [
    (1.0, 0.0, 0.0),  # æˆè†œé€Ÿåº¦æœ€å¤§
    (0.7, 0.3, 0.0),  # é€Ÿåº¦é‡è¦–ãƒ»å‡ä¸€æ€§è€ƒæ…®
    (0.5, 0.5, 0.0),  # é€Ÿåº¦ã¨å‡ä¸€æ€§ã®ãƒãƒ©ãƒ³ã‚¹
    (0.3, 0.7, 0.0),  # å‡ä¸€æ€§é‡è¦–ãƒ»é€Ÿåº¦è€ƒæ…®
    (0.0, 1.0, 0.0),  # å‡ä¸€æ€§æœ€å¤§
    (0.0, 0.5, 0.5),  # å‡ä¸€æ€§ã¨ã‚³ã‚¹ãƒˆã®ãƒãƒ©ãƒ³ã‚¹
    (0.0, 0.0, 1.0),  # ã‚³ã‚¹ãƒˆæœ€å°
]

bounds = [(300, 1000), (0.1, 100), (50, 500), (1, 60)]
pareto_solutions = []
pareto_objectives = []

for weights in weights_list:
    result = differential_evolution(
        lambda x: weighted_sum_objective(x, weights),
        bounds,
        seed=42,
        maxiter=1000
    )

    if result.success:
        solution = result.x
        objectives = thin_film_objective(solution)
        pareto_solutions.append(solution)
        pareto_objectives.append(objectives)

        print(f"é‡ã¿ {weights}:")
        print(f"  æ¡ä»¶: T={solution[0]:.0f}K, P={solution[1]:.1f}Pa, W={solution[2]:.0f}W, t={solution[3]:.1f}min")
        print(f"  çµæœ: é€Ÿåº¦={-objectives[0]:.1f}nm/min, å‡ä¸€æ€§={-objectives[1]:.1f}%, ã‚³ã‚¹ãƒˆ={objectives[2]:.1f}")

# Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢å¯è¦–åŒ–
fig = plt.figure(figsize=(14, 6))

# 2D Pareto frontier (é€Ÿåº¦ vs å‡ä¸€æ€§)
ax1 = fig.add_subplot(121)
rates = [-obj[0] for obj in pareto_objectives]
uniformities = [-obj[1] for obj in pareto_objectives]
costs = [obj[2] for obj in pareto_objectives]

scatter = ax1.scatter(rates, uniformities, c=costs, cmap='viridis', s=100, edgecolor='black', linewidth=1.5)
ax1.set_xlabel('æˆè†œé€Ÿåº¦ [nm/min]', fontsize=12)
ax1.set_ylabel('å‡ä¸€æ€§ [%]', fontsize=12)
ax1.set_title('Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢: é€Ÿåº¦ vs å‡ä¸€æ€§', fontsize=14)
ax1.grid(True, alpha=0.3)
cbar = plt.colorbar(scatter, ax=ax1)
cbar.set_label('ã‚³ã‚¹ãƒˆ [ä»»æ„å˜ä½]', fontsize=10)

# Pareto optimal points annotation
for i, (r, u) in enumerate(zip(rates, uniformities)):
    ax1.annotate(f'{i+1}', (r, u), textcoords="offset points", xytext=(0,10), ha='center')

# 3D Pareto frontier
ax2 = fig.add_subplot(122, projection='3d')
ax2.scatter(rates, uniformities, costs, c=costs, cmap='plasma', s=100, edgecolor='black', linewidth=1.5)
ax2.set_xlabel('æˆè†œé€Ÿåº¦ [nm/min]', fontsize=10)
ax2.set_ylabel('å‡ä¸€æ€§ [%]', fontsize=10)
ax2.set_zlabel('ã‚³ã‚¹ãƒˆ [ä»»æ„å˜ä½]', fontsize=10)
ax2.set_title('3D Paretoãƒ•ãƒ­ãƒ³ãƒ†ã‚£ã‚¢', fontsize=14)

plt.tight_layout()
plt.savefig('pareto_optimization_thin_film.png', dpi=300, bbox_inches='tight')
plt.show()

print("\n=== Paretoæœ€é©è§£ã®é¸æŠæŒ‡é‡ ===")
print("1. é«˜ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆå„ªå…ˆ: è§£1ï¼ˆé€Ÿåº¦æœ€å¤§ã€å‡ä¸€æ€§çŠ ç‰²ï¼‰")
print("2. ãƒãƒ©ãƒ³ã‚¹å‹: è§£3-4ï¼ˆé€Ÿåº¦ã¨å‡ä¸€æ€§ã®å¦¥å”ç‚¹ï¼‰")
print("3. é«˜å“è³ªå„ªå…ˆ: è§£5ï¼ˆå‡ä¸€æ€§æœ€å¤§ã€é€Ÿåº¦çŠ ç‰²ï¼‰")
print("4. ã‚³ã‚¹ãƒˆå„ªå…ˆ: è§£7ï¼ˆã‚³ã‚¹ãƒˆæœ€å°ã€æ€§èƒ½çŠ ç‰²ï¼‰")
</code></pre>

        <div class="warning-box">
            <strong>âš ï¸ å®Ÿå•é¡Œã¸ã®é©ç”¨</strong><br>
            å®Ÿéš›ã®ãƒ—ãƒ­ã‚»ã‚¹æœ€é©åŒ–ã§ã¯ã€å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ç›®çš„é–¢æ•°ã®ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…é ˆã§ã™ã€‚ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¢ãƒ‡ãƒ«ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆæ´»æ€§åŒ–ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€é »åº¦å› å­ï¼‰ã‚’å®Ÿé¨“å€¤ã«ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã€äºˆæ¸¬ç²¾åº¦ã‚’æ¤œè¨¼ã—ã¦ã‹ã‚‰æœ€é©åŒ–ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ã¾ãŸã€åˆ¶ç´„æ¡ä»¶ï¼ˆè£…ç½®é™ç•Œã€å®‰å…¨ç¯„å›²ï¼‰ã‚’æ­£ç¢ºã«è¨­å®šã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚
        </div>

        <h2>5.3 æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹è†œè³ªäºˆæ¸¬</h2>

        <p>
            è–„è†œãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ï¼ˆæ¸©åº¦ã€åœ§åŠ›ã€é›»åŠ›ã€æ™‚é–“ï¼‰ã‹ã‚‰è†œè³ªï¼ˆè†œåšã€çµ„æˆã€çµæ™¶æ€§ã€è¡¨é¢ç²—ã•ï¼‰ã‚’äºˆæ¸¬ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚<strong>æ©Ÿæ¢°å­¦ç¿’</strong>ï¼ˆRandomForestã€XGBoostï¼‰ã‚’ç”¨ã„ã‚‹ã“ã¨ã§ã€å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰éç·šå½¢é–¢ä¿‚ã‚’å­¦ç¿’ã—ã€æœªçŸ¥æ¡ä»¶ã§ã®è†œè³ªã‚’é«˜ç²¾åº¦ã«äºˆæ¸¬ã§ãã¾ã™ã€‚
        </p>

        <h3>æ©Ÿæ¢°å­¦ç¿’ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h3>

        <div class="mermaid">
        flowchart LR
            A[å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿åé›†] --> B[ãƒ‡ãƒ¼ã‚¿å‰å‡¦ç†]
            B --> C[ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°]
            C --> D[ãƒ¢ãƒ‡ãƒ«è¨“ç·´]
            D --> E[ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´]
            E --> F[ãƒ¢ãƒ‡ãƒ«è©•ä¾¡]
            F --> G{ç²¾åº¦OK?}
            G -->|No| D
            G -->|Yes| H[äºˆæ¸¬å®Ÿè¡Œ]
            H --> I[æ–°è¦å®Ÿé¨“ææ¡ˆ]

            style A fill:#ffeaa7
            style D fill:#74b9ff
            style H fill:#55efc4
        </flowchart>
        </div>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: RandomForest + XGBoostã«ã‚ˆã‚‹è†œåšäºˆæ¸¬</h3>

        <pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split, cross_val_score
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
import xgboost as xgb

# å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆå®Ÿéš›ã¯å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰
np.random.seed(42)
n_samples = 200

# ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ï¼ˆç‰¹å¾´é‡ï¼‰
temperature = np.random.uniform(300, 1000, n_samples)  # K
pressure = np.random.uniform(0.5, 50, n_samples)  # Pa
power = np.random.uniform(100, 500, n_samples)  # W
time = np.random.uniform(5, 60, n_samples)  # min

# è†œåšï¼ˆç›®çš„å¤‰æ•°ï¼‰- ç‰©ç†ãƒ¢ãƒ‡ãƒ« + ãƒã‚¤ã‚º
k0 = 50
Ea = 40000
R = 8.314
thickness_true = k0 * np.exp(-Ea / (R * temperature)) * (power / 100) * (pressure / 10) * time
thickness = thickness_true + np.random.normal(0, 5, n_samples)  # ãƒã‚¤ã‚ºÂ±5 nm

# ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
data = pd.DataFrame({
    'temperature': temperature,
    'pressure': pressure,
    'power': power,
    'time': time,
    'thickness': thickness
})

# ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°
data['T_inv'] = 1 / data['temperature']  # Arrheniusé …
data['log_P'] = np.log(data['pressure'])  # å¯¾æ•°åœ§åŠ›
data['power_time'] = data['power'] * data['time']  # ç›¸äº’ä½œç”¨é …

# è¨“ç·´/ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X = data[['temperature', 'pressure', 'power', 'time', 'T_inv', 'log_P', 'power_time']]
y = data['thickness']
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# RandomForestãƒ¢ãƒ‡ãƒ«
rf_model = RandomForestRegressor(n_estimators=100, max_depth=10, random_state=42, n_jobs=-1)
rf_model.fit(X_train, y_train)
y_pred_rf = rf_model.predict(X_test)

rf_mse = mean_squared_error(y_test, y_pred_rf)
rf_r2 = r2_score(y_test, y_pred_rf)
rf_mae = mean_absolute_error(y_test, y_pred_rf)

print("=== RandomForest ===")
print(f"MSE: {rf_mse:.2f} nmÂ²")
print(f"RMSE: {np.sqrt(rf_mse):.2f} nm")
print(f"MAE: {rf_mae:.2f} nm")
print(f"RÂ²: {rf_r2:.4f}")

# XGBoostãƒ¢ãƒ‡ãƒ«
xgb_model = xgb.XGBRegressor(n_estimators=100, max_depth=6, learning_rate=0.1, random_state=42)
xgb_model.fit(X_train, y_train)
y_pred_xgb = xgb_model.predict(X_test)

xgb_mse = mean_squared_error(y_test, y_pred_xgb)
xgb_r2 = r2_score(y_test, y_pred_xgb)
xgb_mae = mean_absolute_error(y_test, y_pred_xgb)

print("\n=== XGBoost ===")
print(f"MSE: {xgb_mse:.2f} nmÂ²")
print(f"RMSE: {np.sqrt(xgb_mse):.2f} nm")
print(f"MAE: {xgb_mae:.2f} nm")
print(f"RÂ²: {xgb_r2:.4f}")

# ç‰¹å¾´é‡é‡è¦åº¦
feature_importance_rf = pd.DataFrame({
    'feature': X.columns,
    'importance': rf_model.feature_importances_
}).sort_values('importance', ascending=False)

feature_importance_xgb = pd.DataFrame({
    'feature': X.columns,
    'importance': xgb_model.feature_importances_
}).sort_values('importance', ascending=False)

print("\n=== ç‰¹å¾´é‡é‡è¦åº¦ (RandomForest) ===")
print(feature_importance_rf)

# å¯è¦–åŒ–
fig, axes = plt.subplots(2, 2, figsize=(14, 12))

# äºˆæ¸¬ vs å®Ÿæ¸¬ï¼ˆRandomForestï¼‰
axes[0, 0].scatter(y_test, y_pred_rf, alpha=0.6, edgecolor='black')
axes[0, 0].plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', linewidth=2)
axes[0, 0].set_xlabel('å®Ÿæ¸¬è†œåš [nm]', fontsize=12)
axes[0, 0].set_ylabel('äºˆæ¸¬è†œåš [nm]', fontsize=12)
axes[0, 0].set_title(f'RandomForest (RÂ²={rf_r2:.3f}, RMSE={np.sqrt(rf_mse):.1f} nm)', fontsize=14)
axes[0, 0].grid(True, alpha=0.3)

# äºˆæ¸¬ vs å®Ÿæ¸¬ï¼ˆXGBoostï¼‰
axes[0, 1].scatter(y_test, y_pred_xgb, alpha=0.6, edgecolor='black', color='green')
axes[0, 1].plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'r--', linewidth=2)
axes[0, 1].set_xlabel('å®Ÿæ¸¬è†œåš [nm]', fontsize=12)
axes[0, 1].set_ylabel('äºˆæ¸¬è†œåš [nm]', fontsize=12)
axes[0, 1].set_title(f'XGBoost (RÂ²={xgb_r2:.3f}, RMSE={np.sqrt(xgb_mse):.1f} nm)', fontsize=14)
axes[0, 1].grid(True, alpha=0.3)

# ç‰¹å¾´é‡é‡è¦åº¦ï¼ˆRandomForestï¼‰
axes[1, 0].barh(feature_importance_rf['feature'], feature_importance_rf['importance'], color='steelblue')
axes[1, 0].set_xlabel('é‡è¦åº¦', fontsize=12)
axes[1, 0].set_title('ç‰¹å¾´é‡é‡è¦åº¦ (RandomForest)', fontsize=14)
axes[1, 0].grid(True, alpha=0.3, axis='x')

# ç‰¹å¾´é‡é‡è¦åº¦ï¼ˆXGBoostï¼‰
axes[1, 1].barh(feature_importance_xgb['feature'], feature_importance_xgb['importance'], color='coral')
axes[1, 1].set_xlabel('é‡è¦åº¦', fontsize=12)
axes[1, 1].set_title('ç‰¹å¾´é‡é‡è¦åº¦ (XGBoost)', fontsize=14)
axes[1, 1].grid(True, alpha=0.3, axis='x')

plt.tight_layout()
plt.savefig('ml_film_thickness_prediction.png', dpi=300, bbox_inches='tight')
plt.show()

# æ–°è¦æ¡ä»¶ã§ã®äºˆæ¸¬
new_conditions = pd.DataFrame({
    'temperature': [700],
    'pressure': [10],
    'power': [300],
    'time': [30],
})
new_conditions['T_inv'] = 1 / new_conditions['temperature']
new_conditions['log_P'] = np.log(new_conditions['pressure'])
new_conditions['power_time'] = new_conditions['power'] * new_conditions['time']

predicted_thickness_rf = rf_model.predict(new_conditions)
predicted_thickness_xgb = xgb_model.predict(new_conditions)

print(f"\n=== æ–°è¦æ¡ä»¶äºˆæ¸¬ ===")
print(f"æ¡ä»¶: T=700K, P=10Pa, W=300W, t=30min")
print(f"RandomForestäºˆæ¸¬: {predicted_thickness_rf[0]:.1f} nm")
print(f"XGBoostäºˆæ¸¬: {predicted_thickness_xgb[0]:.1f} nm")
</code></pre>

        <div class="info-box">
            <strong>ğŸ’¡ å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã®æ´»ç”¨</strong><br>
            æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã¯ã€å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãŒå¤šã„ã»ã©äºˆæ¸¬ç²¾åº¦ãŒå‘ä¸Šã—ã¾ã™ã€‚å®Ÿé¨“è¨ˆç”»æ³•ï¼ˆDOE: Design of Experimentsï¼‰ã‚’ç”¨ã„ã¦ã€åŠ¹ç‡çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã™ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚ã¾ãŸã€ç‰©ç†çŸ¥è­˜ã«åŸºã¥ãç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ï¼ˆArrheniusé …ã€ç›¸äº’ä½œç”¨é …ï¼‰ã«ã‚ˆã‚Šã€å°‘ãªã„ãƒ‡ãƒ¼ã‚¿ã§ã‚‚é«˜ç²¾åº¦ãªäºˆæ¸¬ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
        </div>

        <h2>5.4 Bayesian Optimizationã«ã‚ˆã‚‹è‡ªå‹•å®Ÿé¨“è¨ˆç”»</h2>

        <p>
            å®Ÿé¨“å›æ•°ã‚’æœ€å°é™ã«æŠ‘ãˆãªãŒã‚‰æœ€é©æ¡ä»¶ã‚’æ¢ç´¢ã™ã‚‹ãŸã‚ã€<strong>Bayesian optimization</strong>ãŒæœ‰åŠ¹ã§ã™ã€‚ã“ã®æ‰‹æ³•ã¯ã€<strong>Gaussian Process</strong>ï¼ˆã‚¬ã‚¦ã‚¹éç¨‹ï¼‰ã§ç›®çš„é–¢æ•°ã‚’ãƒ¢ãƒ‡ãƒ«åŒ–ã—ã€<strong>Acquisition Function</strong>ï¼ˆç²å¾—é–¢æ•°ï¼‰ã§æ¬¡ã«å®Ÿé¨“ã™ã¹ãæ¡ä»¶ã‚’ææ¡ˆã—ã¾ã™ã€‚
        </p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: Bayesian Optimizationã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶æ¢ç´¢</h3>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.gaussian_process import GaussianProcessRegressor
from sklearn.gaussian_process.kernels import RBF, ConstantKernel as C
from scipy.stats import norm

def objective_function(x):
    """
    æœ€é©åŒ–ã™ã‚‹ç›®çš„é–¢æ•°ï¼ˆè†œåšã®å‡ä¸€æ€§ã€çœŸã®é–¢æ•°ã¯æœªçŸ¥ã¨ä»®å®šï¼‰

    Parameters:
    -----------
    x : array [temperature, pressure]
        ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶

    Returns:
    --------
    uniformity : float
        è†œåšå‡ä¸€æ€§ [%]ï¼ˆæœ€å¤§åŒ–ã—ãŸã„ï¼‰
    """
    temperature, pressure = x
    # çœŸã®é–¢æ•°ï¼ˆå®Ÿéš›ã¯å®Ÿé¨“ã§ã—ã‹åˆ†ã‹ã‚‰ãªã„ï¼‰
    uniformity = 95 * np.exp(-0.0005 * (temperature - 650)**2) * np.exp(-0.01 * (pressure - 5)**2)
    # ãƒã‚¤ã‚ºè¿½åŠ 
    uniformity += np.random.normal(0, 1)
    return uniformity

def expected_improvement(X, X_sample, y_sample, gpr, xi=0.01):
    """
    Expected Improvementï¼ˆæœŸå¾…æ”¹å–„é‡ï¼‰ç²å¾—é–¢æ•°

    Parameters:
    -----------
    X : array
        å€™è£œç‚¹
    X_sample : array
        æ—¢çŸ¥ã®ã‚µãƒ³ãƒ—ãƒ«ç‚¹
    y_sample : array
        æ—¢çŸ¥ã®ã‚µãƒ³ãƒ—ãƒ«å€¤
    gpr : GaussianProcessRegressor
        å­¦ç¿’æ¸ˆã¿GPãƒ¢ãƒ‡ãƒ«
    xi : float
        æ¢ç´¢-æ´»ç”¨ãƒãƒ©ãƒ³ã‚¹ï¼ˆå¤§ãã„ã»ã©æ¢ç´¢é‡è¦–ï¼‰

    Returns:
    --------
    EI : array
        æœŸå¾…æ”¹å–„é‡
    """
    mu, sigma = gpr.predict(X, return_std=True)
    mu_sample = gpr.predict(X_sample)

    mu = mu.reshape(-1, 1)
    sigma = sigma.reshape(-1, 1)

    mu_sample_opt = np.max(y_sample)

    with np.errstate(divide='warn'):
        imp = mu - mu_sample_opt - xi
        Z = imp / sigma
        ei = imp * norm.cdf(Z) + sigma * norm.pdf(Z)
        ei[sigma == 0.0] = 0.0

    return ei

# åˆæœŸã‚µãƒ³ãƒ—ãƒ«ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã«3ç‚¹ï¼‰
np.random.seed(42)
X_sample = np.random.uniform([300, 0.5], [1000, 50], (3, 2))
y_sample = np.array([objective_function(x) for x in X_sample])

# Gaussian Processè¨­å®š
kernel = C(1.0, (1e-3, 1e3)) * RBF([100, 10], (1e-2, 1e2))
gpr = GaussianProcessRegressor(kernel=kernel, n_restarts_optimizer=10, alpha=1e-6)

# Bayesian Optimizationå®Ÿè¡Œ
n_iterations = 15
bounds = np.array([[300, 1000], [0.5, 50]])

for i in range(n_iterations):
    # GPãƒ¢ãƒ‡ãƒ«æ›´æ–°
    gpr.fit(X_sample, y_sample)

    # å€™è£œç‚¹ã‚°ãƒªãƒƒãƒ‰ç”Ÿæˆ
    X_grid = np.array([[t, p] for t in np.linspace(300, 1000, 50) for p in np.linspace(0.5, 50, 50)])

    # Expected Improvementè¨ˆç®—
    ei = expected_improvement(X_grid, X_sample, y_sample, gpr)

    # æœ€å¤§EIã®ç‚¹ã‚’é¸æŠ
    X_next = X_grid[np.argmax(ei)]

    # å®Ÿé¨“å®Ÿè¡Œï¼ˆç›®çš„é–¢æ•°è©•ä¾¡ï¼‰
    y_next = objective_function(X_next)

    # ã‚µãƒ³ãƒ—ãƒ«ã«è¿½åŠ 
    X_sample = np.vstack((X_sample, X_next))
    y_sample = np.append(y_sample, y_next)

    print(f"Iteration {i+1}: T={X_next[0]:.0f}K, P={X_next[1]:.1f}Pa â†’ å‡ä¸€æ€§={y_next:.2f}%")

# æœ€é©è§£
best_idx = np.argmax(y_sample)
best_X = X_sample[best_idx]
best_y = y_sample[best_idx]

print(f"\n=== æœ€é©æ¡ä»¶ ===")
print(f"æ¸©åº¦: {best_X[0]:.0f} K")
print(f"åœ§åŠ›: {best_X[1]:.1f} Pa")
print(f"å‡ä¸€æ€§: {best_y:.2f} %")

# å¯è¦–åŒ–
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# æ¢ç´¢å±¥æ­´
iterations = np.arange(1, len(y_sample) + 1)
axes[0].plot(iterations, y_sample, 'o-', linewidth=2, markersize=8)
axes[0].axhline(y=best_y, color='r', linestyle='--', label=f'æœ€é©å€¤: {best_y:.2f}%')
axes[0].set_xlabel('å®Ÿé¨“å›æ•°', fontsize=12)
axes[0].set_ylabel('è†œåšå‡ä¸€æ€§ [%]', fontsize=12)
axes[0].set_title('Bayesian Optimizationæ¢ç´¢å±¥æ­´', fontsize=14)
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# ã‚µãƒ³ãƒ—ãƒ«ç‚¹ã®åˆ†å¸ƒ
axes[1].scatter(X_sample[:3, 0], X_sample[:3, 1], c='blue', s=100, label='åˆæœŸã‚µãƒ³ãƒ—ãƒ«', edgecolor='black', linewidth=1.5)
axes[1].scatter(X_sample[3:, 0], X_sample[3:, 1], c=y_sample[3:], cmap='viridis', s=100, label='BOæ¢ç´¢ç‚¹', edgecolor='black', linewidth=1.5)
axes[1].scatter(best_X[0], best_X[1], c='red', s=300, marker='*', label=f'æœ€é©è§£ ({best_y:.1f}%)', edgecolor='black', linewidth=2)
axes[1].set_xlabel('æ¸©åº¦ [K]', fontsize=12)
axes[1].set_ylabel('åœ§åŠ› [Pa]', fontsize=12)
axes[1].set_title('Bayesian Optimizationæ¢ç´¢ç©ºé–“', fontsize=14)
axes[1].legend()
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('bayesian_optimization_process.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>

        <div class="info-box">
            <strong>ğŸ’¡ å®Ÿé¨“ã‚³ã‚¹ãƒˆå‰Šæ¸›</strong><br>
            Bayesian optimizationã¯ã€ãƒ©ãƒ³ãƒ€ãƒ æ¢ç´¢ã‚„ã‚°ãƒªãƒƒãƒ‰ã‚µãƒ¼ãƒã¨æ¯”è¼ƒã—ã¦ã€<strong>å®Ÿé¨“å›æ•°ã‚’1/3ï½1/5ã«å‰Šæ¸›</strong>ã§ãã¾ã™ã€‚ç‰¹ã«ã€1å›ã®å®Ÿé¨“ã«æ™‚é–“ã¨ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹è–„è†œãƒ—ãƒ­ã‚»ã‚¹ã§ã¯ã€ã“ã®æ‰‹æ³•ã«ã‚ˆã‚Šé–‹ç™ºæœŸé–“ã‚’å¤§å¹…ã«çŸ­ç¸®ã§ãã¾ã™ã€‚Expected Improvementä»¥å¤–ã«ã‚‚ã€Upper Confidence Boundï¼ˆUCBï¼‰ã€Probability of Improvementï¼ˆPIï¼‰ãªã©ã®ç²å¾—é–¢æ•°ãŒã‚ã‚Šã€ç›®çš„ã«å¿œã˜ã¦ä½¿ã„åˆ†ã‘ã¾ã™ã€‚
        </div>

        <h2>5.5 Materials Project APIé€£æº</h2>

        <p>
            <strong>Materials Project</strong>ï¼ˆmaterialsproject.orgï¼‰ã¯ã€DFTè¨ˆç®—ã«ã‚ˆã‚‹ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å…¬é–‹ã—ã¦ãŠã‚Šã€150,000ä»¥ä¸Šã®ææ–™ã®ç‰©æ€§ï¼ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã€æ ¼å­å®šæ•°ã€å¼¾æ€§ç‡ã€å½¢æˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ã‚’æ¤œç´¢ã§ãã¾ã™ã€‚è–„è†œææ–™ã®é¸å®šã‚„åŸºæ¿ã¨ã®æ ¼å­æ•´åˆæ€§è©•ä¾¡ã«æ´»ç”¨ã§ãã¾ã™ã€‚
        </p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: Materials Project APIã§åŸºæ¿ææ–™æ¤œç´¢</h3>

        <pre><code class="language-python">from mp_api.client import MPRester
import pandas as pd

# APIã‚­ãƒ¼ï¼ˆhttps://materialsproject.org ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²å¾Œã«å–å¾—ï¼‰
API_KEY = "your_api_key_here"  # å®Ÿéš›ã®APIã‚­ãƒ¼ã«ç½®ãæ›ãˆã¦ãã ã•ã„

with MPRester(API_KEY) as mpr:
    # ä¾‹: SiåŸºæ¿ã«æ ¼å­æ•´åˆã™ã‚‹ææ–™ã‚’æ¤œç´¢ï¼ˆa â‰ˆ 5.43 Ã…ï¼‰
    Si_lattice = 5.43  # Ã…
    tolerance = 0.2  # Â±0.2 Ã…

    # ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—1.0-3.0 eVã®åŠå°ä½“ã‚’æ¤œç´¢
    docs = mpr.materials.summary.search(
        band_gap=(1.0, 3.0),
        is_stable=True,
        fields=["material_id", "formula_pretty", "band_gap", "structure"]
    )

    # æ ¼å­å®šæ•°ãŒSiã«è¿‘ã„ææ–™ã‚’ãƒ•ã‚£ãƒ«ã‚¿
    matching_materials = []

    for doc in docs[:100]:  # æœ€åˆã®100ä»¶ã‚’èª¿æŸ»
        structure = doc.structure
        lattice_params = structure.lattice.abc  # (a, b, c)
        a = lattice_params[0]

        if abs(a - Si_lattice) < tolerance:
            matching_materials.append({
                'material_id': doc.material_id,
                'formula': doc.formula_pretty,
                'band_gap': doc.band_gap,
                'lattice_a': a,
                'mismatch': abs(a - Si_lattice) / Si_lattice * 100
            })

    # ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
    df = pd.DataFrame(matching_materials).sort_values('mismatch')

    print("=== SiåŸºæ¿ã«æ ¼å­æ•´åˆã™ã‚‹åŠå°ä½“ææ–™ ===")
    print(df.to_string(index=False))

    # ã‚°ãƒ©ãƒ•å¯è¦–åŒ–
    import matplotlib.pyplot as plt

    fig, ax = plt.subplots(figsize=(10, 6))

    scatter = ax.scatter(df['lattice_a'], df['band_gap'], c=df['mismatch'], cmap='coolwarm', s=100, edgecolor='black', linewidth=1.5)
    ax.axvline(x=Si_lattice, color='blue', linestyle='--', linewidth=2, label=f'Siæ ¼å­å®šæ•° ({Si_lattice} Ã…)')
    ax.set_xlabel('æ ¼å­å®šæ•° a [Ã…]', fontsize=12)
    ax.set_ylabel('ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— [eV]', fontsize=12)
    ax.set_title('Materials Project: SiåŸºæ¿é©åˆææ–™', fontsize=14)
    ax.legend()
    ax.grid(True, alpha=0.3)

    cbar = plt.colorbar(scatter, ax=ax)
    cbar.set_label('æ ¼å­ãƒŸã‚¹ãƒãƒƒãƒ [%]', fontsize=10)

    # ææ–™åã‚’ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³
    for i, row in df.head(5).iterrows():
        ax.annotate(row['formula'], (row['lattice_a'], row['band_gap']), textcoords="offset points", xytext=(0,10), ha='center', fontsize=8)

    plt.tight_layout()
    plt.savefig('materials_project_lattice_matching.png', dpi=300, bbox_inches='tight')
    plt.show()
</code></pre>

        <div class="warning-box">
            <strong>âš ï¸ APIã‚­ãƒ¼ã®å–å¾—</strong><br>
            Materials Project APIã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€å…¬å¼ã‚µã‚¤ãƒˆï¼ˆmaterialsproject.orgï¼‰ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã—ã€APIã‚­ãƒ¼ã‚’å–å¾—ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ç„¡æ–™ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ã¯ã€1æ—¥ã‚ãŸã‚Š1000ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®åˆ¶é™ãŒã‚ã‚Šã¾ã™ã€‚å¤§é‡æ¤œç´¢ã‚’è¡Œã†å ´åˆã¯ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ã¦ã€åŒã˜ã‚¯ã‚¨ãƒªã‚’ç¹°ã‚Šè¿”ã•ãªã„ã‚ˆã†ã«ã—ã¾ã™ã€‚
        </div>

        <h2>5.6 æ¼”ç¿’å•é¡Œ</h2>

        <div class="exercise-box">
            <h4>æ¼”ç¿’å•é¡Œ 5.1 (Easy): çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã®ç†è§£</h4>
            <p>
                ã‚³ãƒ¼ãƒ‰ä¾‹1ã®çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã«ãŠã„ã¦ã€PVDã€CVDã€ALDã®å„ãƒ—ãƒ­ã‚»ã‚¹ã§è†œåšå‡ä¸€æ€§ãŒç•°ãªã‚‹ç‰©ç†çš„ç†ç”±ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€ã©ã®ãƒ—ãƒ­ã‚»ã‚¹ãŒæœ€ã‚‚å‡ä¸€ãªè†œåšåˆ†å¸ƒã‚’å¾—ã‚‰ã‚Œã‚‹ã‹ã€ç†ç”±ã¨ã¨ã‚‚ã«ç­”ãˆã¦ãã ã•ã„ã€‚
            </p>
            <button class="toggle-solution">è§£ç­”ã‚’è¡¨ç¤º</button>
            <div class="solution">
                <strong>è§£ç­”:</strong>
                <p><strong>è†œåšå‡ä¸€æ€§ãŒç•°ãªã‚‹ç†ç”±</strong>:</p>
                <ul>
                    <li><strong>PVDï¼ˆã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°ï¼‰</strong>: ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‹ã‚‰é£›æ¥ã™ã‚‹ç²’å­ã®å…¥å°„è§’åº¦ã«ä¾å­˜ã—ã¾ã™ã€‚åŸºæ¿ä¸­å¿ƒéƒ¨ã§ã¯å‚ç›´å…¥å°„ã§ã™ãŒã€ã‚¨ãƒƒã‚¸ã§ã¯æ–œã‚å…¥å°„ã¨ãªã‚Šã€cosineå‰‡ã«ã‚ˆã‚Šè†œåšãŒæ¸›å°‘ã—ã¾ã™ã€‚å‡ä¸€æ€§: 85-90%ã€‚</li>
                    <li><strong>CVDï¼ˆç†±CVDï¼‰</strong>: åŸºæ¿æ¸©åº¦åˆ†å¸ƒã«ä¾å­˜ã—ã¾ã™ã€‚åå¿œé€Ÿåº¦ãŒArrheniuså‹ã§æ¸©åº¦ã«å¼·ãä¾å­˜ã™ã‚‹ãŸã‚ã€ä¸­å¿ƒéƒ¨ï¼ˆé«˜æ¸©ï¼‰ã¨ã‚¨ãƒƒã‚¸ï¼ˆã‚„ã‚„ä½æ¸©ï¼‰ã§æˆè†œé€Ÿåº¦ãŒå¤‰åŒ–ã—ã¾ã™ã€‚å‡ä¸€æ€§: 90-95%ã€‚</li>
                    <li><strong>ALD</strong>: è‡ªå·±åˆ¶é™æˆé•·ã«ã‚ˆã‚Šã€å‰é§†ä½“ãŒååˆ†æ‹¡æ•£ã™ã‚Œã°ç†æƒ³çš„ã«ã¯å®Œå…¨å‡ä¸€ã§ã™ã€‚æ¸©åº¦ãŒæˆé•·çª“å†…ã§ã‚ã‚Œã°ã€æˆè†œé€Ÿåº¦ã¯ä½ç½®ã«ä¾ã‚‰ãšä¸€å®šã§ã™ã€‚å‡ä¸€æ€§: 98-99%ã€‚</li>
                </ul>
                <p><strong>æœ€ã‚‚å‡ä¸€ãªãƒ—ãƒ­ã‚»ã‚¹</strong>: <strong>ALD</strong></p>
                <p><strong>ç†ç”±</strong>: è‡ªå·±åˆ¶é™æˆé•·æ©Ÿæ§‹ã«ã‚ˆã‚Šã€è¡¨é¢ãŒå‰é§†ä½“ã§é£½å’Œã™ã‚‹ã¾ã§åå¿œãŒé€²è¡Œã—ã€1ã‚µã‚¤ã‚¯ãƒ«ã‚ãŸã‚Šã®æˆè†œé‡ï¼ˆGPCï¼‰ãŒä½ç½®ã«ä¾å­˜ã—ã¾ã›ã‚“ã€‚å¤§é¢ç©åŸºæ¿ã§ã‚‚Â±2%ä»¥å†…ã®å‡ä¸€æ€§ã‚’é”æˆã§ãã¾ã™ã€‚</p>
            </div>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’å•é¡Œ 5.2 (Easy): Paretoæœ€é©è§£ã®è§£é‡ˆ</h4>
            <p>
                ã‚³ãƒ¼ãƒ‰ä¾‹2ã®Paretoæœ€é©åŒ–ã«ãŠã„ã¦ã€æˆè†œé€Ÿåº¦ã‚’æœ€å¤§åŒ–ã™ã‚‹è§£ï¼ˆè§£1ï¼‰ã¨å‡ä¸€æ€§ã‚’æœ€å¤§åŒ–ã™ã‚‹è§£ï¼ˆè§£5ï¼‰ã®ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ï¼ˆæ¸©åº¦ã€åœ§åŠ›ã€é›»åŠ›ï¼‰ãŒã©ã®ã‚ˆã†ã«ç•°ãªã‚‹ã‹äºˆæ¸¬ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€ãƒãƒ©ãƒ³ã‚¹å‹ã®è§£ï¼ˆè§£3-4ï¼‰ã‚’é¸æŠã™ã¹ãçŠ¶æ³ã‚’3ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚
            </p>
            <button class="toggle-solution">è§£ç­”ã‚’è¡¨ç¤º</button>
            <div class="solution">
                <strong>è§£ç­”:</strong>
                <p><strong>ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ã®é•ã„</strong>:</p>
                <ul>
                    <li><strong>è§£1ï¼ˆæˆè†œé€Ÿåº¦æœ€å¤§ï¼‰</strong>: é«˜æ¸©ï¼ˆ900-1000Kï¼‰ã€é«˜åœ§åŠ›ï¼ˆ50-100Paï¼‰ã€é«˜é›»åŠ›ï¼ˆ400-500Wï¼‰ã€‚åå¿œé€Ÿåº¦ã¨ã‚¤ã‚ªãƒ³æµæŸã‚’æœ€å¤§åŒ–ã—ã¾ã™ãŒã€æ¸©åº¦åˆ†å¸ƒã®ä¸å‡ä¸€æ€§ãŒå¢—å¤§ã—ã¾ã™ã€‚</li>
                    <li><strong>è§£5ï¼ˆå‡ä¸€æ€§æœ€å¤§ï¼‰</strong>: ä¸­æ¸©ï¼ˆ600-700Kï¼‰ã€ä½åœ§åŠ›ï¼ˆ5-10Paï¼‰ã€ä¸­é›»åŠ›ï¼ˆ200-300Wï¼‰ã€‚æ¸©åº¦åˆ†å¸ƒãŒå‡ä¸€ã§ã€ã‚¬ã‚¹æ‹¡æ•£ãŒååˆ†ãªæ¡ä»¶ã§ã™ã€‚æˆè†œé€Ÿåº¦ã¯çŠ ç‰²ã«ãªã‚Šã¾ã™ã€‚</li>
                </ul>
                <p><strong>ãƒãƒ©ãƒ³ã‚¹å‹è§£ã‚’é¸æŠã™ã¹ãçŠ¶æ³</strong>:</p>
                <ol>
                    <li><strong>é‡ç”£ãƒ—ãƒ­ã‚»ã‚¹</strong>: ã‚¹ãƒ«ãƒ¼ãƒ—ãƒƒãƒˆï¼ˆé€Ÿåº¦ï¼‰ã¨æ­©ç•™ã¾ã‚Šï¼ˆå‡ä¸€æ€§ï¼‰ã®ä¸¡æ–¹ãŒé‡è¦ãªå ´åˆã€‚</li>
                    <li><strong>å¤šå±¤è†œãƒ‡ãƒã‚¤ã‚¹</strong>: å„å±¤ã§ç•°ãªã‚‹è†œè³ªãŒè¦æ±‚ã•ã‚Œã‚‹å ´åˆã€å±¤ã”ã¨ã«æ¡ä»¶ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã‚ˆã‚Šã€ãƒãƒ©ãƒ³ã‚¹å‹æ¡ä»¶ã§çµ±ä¸€ã™ã‚‹æ–¹ãŒåŠ¹ç‡çš„ã€‚</li>
                    <li><strong>é–‹ç™ºåˆæœŸæ®µéš</strong>: æœ€çµ‚çš„ãªè¦æ±‚ä»•æ§˜ãŒç¢ºå®šã—ã¦ã„ãªã„æ®µéšã§ã¯ã€æ±ç”¨çš„ãªãƒãƒ©ãƒ³ã‚¹å‹æ¡ä»¶ã§è©•ä¾¡ã‚’é–‹å§‹ã€‚</li>
                </ol>
            </div>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’å•é¡Œ 5.3 (Medium): æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã®æ”¹å–„</h4>
            <p>
                ã‚³ãƒ¼ãƒ‰ä¾‹3ã®RandomForestãƒ¢ãƒ‡ãƒ«ã«ãŠã„ã¦ã€RÂ²ã‚¹ã‚³ã‚¢ãŒ0.95æœªæº€ã®å ´åˆã€äºˆæ¸¬ç²¾åº¦ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®æ”¹å–„ç­–ã‚’3ã¤ææ¡ˆã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€ç‰¹å¾´é‡é‡è¦åº¦ã®çµæœã‹ã‚‰ã€ã©ã®ãƒ—ãƒ­ã‚»ã‚¹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒè†œåšã«æœ€ã‚‚å½±éŸ¿ã‚’ä¸ãˆã¦ã„ã‚‹ã‹åˆ¤æ–­ã—ã€ãã®ç‰©ç†çš„ç†ç”±ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚
            </p>
            <button class="toggle-solution">è§£ç­”ã‚’è¡¨ç¤º</button>
            <div class="solution">
                <strong>è§£ç­”:</strong>
                <p><strong>äºˆæ¸¬ç²¾åº¦å‘ä¸Šã®ãŸã‚ã®æ”¹å–„ç­–</strong>:</p>
                <ol>
                    <li><strong>ãƒ‡ãƒ¼ã‚¿é‡ã®å¢—åŠ </strong>: å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ãŒä¸è¶³ã—ã¦ã„ã‚‹å ´åˆã€ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µï¼ˆData Augmentationï¼‰ã‚„ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã§ã‚µãƒ³ãƒ—ãƒ«æ•°ã‚’å¢—ã‚„ã—ã¾ã™ã€‚ç›®æ¨™: 500-1000ã‚µãƒ³ãƒ—ãƒ«ã€‚</li>
                    <li><strong>ç‰¹å¾´é‡ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°</strong>: ç‰©ç†ãƒ¢ãƒ‡ãƒ«ã«åŸºã¥ãç‰¹å¾´é‡ã‚’è¿½åŠ ã—ã¾ã™ã€‚ä¾‹: Arrheniusé …ï¼ˆ1/Tï¼‰ã€ç›¸äº’ä½œç”¨é …ï¼ˆpower Ã— timeã€temperature Ã— pressureï¼‰ã€éç·šå½¢é …ï¼ˆlog(P)ã€TÂ²ï¼‰ã€‚</li>
                    <li><strong>ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´</strong>: GridSearchCVã‚„RandomizedSearchCVã§æœ€é©ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¢ç´¢ã—ã¾ã™ã€‚èª¿æ•´å¯¾è±¡: n_estimatorsï¼ˆ100â†’200ï¼‰ã€max_depthï¼ˆ10â†’20ï¼‰ã€min_samples_splitï¼ˆ2â†’5ï¼‰ã€‚</li>
                </ol>
                <p><strong>ç‰¹å¾´é‡é‡è¦åº¦ã®è§£é‡ˆ</strong>:</p>
                <p>
                    ä¸€èˆ¬çš„ã«ã€<strong>temperatureï¼ˆæ¸©åº¦ï¼‰</strong>ã¨<strong>timeï¼ˆæ™‚é–“ï¼‰</strong>ãŒé«˜ã„é‡è¦åº¦ã‚’ç¤ºã—ã¾ã™ã€‚
                </p>
                <ul>
                    <li><strong>æ¸©åº¦</strong>: Arrheniusåå¿œé€Ÿåº¦è«–ã«ã‚ˆã‚Šã€æˆè†œé€Ÿåº¦ãŒæŒ‡æ•°é–¢æ•°çš„ã«å¤‰åŒ–ã—ã¾ã™ï¼ˆ\(k \propto \exp(-E_a / RT)\)ï¼‰ã€‚æ¸©åº¦ãŒ10Kå¤‰åŒ–ã™ã‚‹ã ã‘ã§ã€æˆè†œé€Ÿåº¦ãŒæ•°å%å¤‰åŒ–ã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
                    <li><strong>æ™‚é–“</strong>: è†œåšã¯æˆè†œé€Ÿåº¦Ã—æ™‚é–“ã§æ±ºã¾ã‚‹ãŸã‚ã€ç›´æ¥çš„ãªå½±éŸ¿ãŒã‚ã‚Šã¾ã™ã€‚ç·šå½¢é–¢ä¿‚ã§ã™ãŒã€é•·æ™‚é–“æˆè†œã§ã¯å‰é§†ä½“æ¯æ¸‡ã®å½±éŸ¿ã‚‚å‡ºã¾ã™ã€‚</li>
                    <li><strong>powerï¼ˆé›»åŠ›ï¼‰</strong>: PVD/PECVDã§ã¯ã‚¤ã‚ªãƒ³æµæŸã«å½±éŸ¿ã—ã¾ã™ãŒã€æ¸©åº¦ã»ã©å¼·ãã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
                </ul>
            </div>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’å•é¡Œ 5.4 (Medium): Bayesian Optimizationã®æ¢ç´¢æˆ¦ç•¥</h4>
            <p>
                ã‚³ãƒ¼ãƒ‰ä¾‹4ã®Bayesian optimizationã«ãŠã„ã¦ã€Expected Improvementï¼ˆEIï¼‰ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿Î¾ï¼ˆxiï¼‰ã‚’0.01ã‹ã‚‰0.1ã«å¤‰æ›´ã—ãŸå ´åˆã€æ¢ç´¢ã®æŒ™å‹•ãŒã©ã®ã‚ˆã†ã«å¤‰åŒ–ã™ã‚‹ã‹äºˆæ¸¬ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€åˆæœŸã‚µãƒ³ãƒ—ãƒ«ç‚¹ã®é¸ã³æ–¹ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚° vs Latin Hypercube Samplingï¼‰ãŒæœ€é©åŒ–åŠ¹ç‡ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’è­°è«–ã—ã¦ãã ã•ã„ã€‚
            </p>
            <button class="toggle-solution">è§£ç­”ã‚’è¡¨ç¤º</button>
            <div class="solution">
                <strong>è§£ç­”:</strong>
                <p><strong>Î¾ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å½±éŸ¿</strong>:</p>
                <ul>
                    <li><strong>Î¾ = 0.01ï¼ˆå°ï¼‰</strong>: æ´»ç”¨ï¼ˆexploitationï¼‰é‡è¦–ã€‚æ—¢çŸ¥ã®æœ€é©è§£ä»˜è¿‘ã‚’ç´°ã‹ãæ¢ç´¢ã—ã¾ã™ã€‚å±€æ‰€æœ€é©è§£ã«åæŸã—ã‚„ã™ã„ã€‚</li>
                    <li><strong>Î¾ = 0.1ï¼ˆå¤§ï¼‰</strong>: æ¢ç´¢ï¼ˆexplorationï¼‰é‡è¦–ã€‚æœªæ¢ç´¢é ˜åŸŸã‚’ç©æ¥µçš„ã«èª¿æŸ»ã—ã¾ã™ã€‚å¤§åŸŸæœ€é©è§£ã‚’è¦‹ã¤ã‘ã‚„ã™ã„ãŒã€åæŸãŒé…ã„ã€‚</li>
                </ul>
                <p><strong>æ¨å¥¨è¨­å®š</strong>: åˆæœŸæ®µéšã§ã¯Î¾ = 0.1ã§åºƒç¯„å›²æ¢ç´¢ã€ä¸­ç›¤ä»¥é™ã¯Î¾ = 0.01ã§è©³ç´°æ¢ç´¢ã€‚</p>
                <p><strong>åˆæœŸã‚µãƒ³ãƒ—ãƒ«ç‚¹ã®é¸ã³æ–¹</strong>:</p>
                <ul>
                    <li><strong>ãƒ©ãƒ³ãƒ€ãƒ ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°</strong>: ç°¡å˜ã«å®Ÿè£…ã§ãã¾ã™ãŒã€ã‚µãƒ³ãƒ—ãƒ«ç‚¹ãŒåã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼ˆä¾‹: å…¨ã¦ä½æ¸©é ˜åŸŸï¼‰ã€‚</li>
                    <li><strong>Latin Hypercube Samplingï¼ˆLHSï¼‰</strong>: å„æ¬¡å…ƒã§å‡ç­‰ã«ã‚µãƒ³ãƒ—ãƒ«ç‚¹ã‚’é…ç½®ã—ã¾ã™ã€‚å°‘ãªã„ã‚µãƒ³ãƒ—ãƒ«ã§åºƒç¯„å›²ã‚’ã‚«ãƒãƒ¼ã§ãã€BOã®åˆæœŸGPãƒ¢ãƒ‡ãƒ«ã®ç²¾åº¦ãŒå‘ä¸Šã—ã¾ã™ã€‚</li>
                </ul>
                <p><strong>å®Ÿé¨“çµæœ</strong>: LHSã‚’ç”¨ã„ã‚‹ã¨ã€æœ€é©è§£åˆ°é”ã¾ã§ã®å®Ÿé¨“å›æ•°ãŒå¹³å‡20-30%å‰Šæ¸›ã•ã‚Œã¾ã™ï¼ˆæ–‡çŒ®: Jones et al., 1998ï¼‰ã€‚</p>
            </div>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’å•é¡Œ 5.5 (Hard): Materials Project APIã‚’ç”¨ã„ãŸæ ¼å­æ•´åˆæ€§è©•ä¾¡</h4>
            <p>
                GaNåŸºæ¿ï¼ˆa = 3.189 Ã…ã€ã‚¦ãƒ«ãƒ„é‰±æ§‹é€ ï¼‰ã«æ ¼å­æ•´åˆã™ã‚‹III-Væ—åŠå°ä½“ææ–™ã‚’Materials Project APIã§æ¤œç´¢ã—ã¦ãã ã•ã„ã€‚æ ¼å­ãƒŸã‚¹ãƒãƒƒãƒãŒÂ±2%ä»¥å†…ã§ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ãŒ2.0-4.0 eVã®ç¯„å›²ã«ã‚ã‚‹ææ–™ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã—ã€å„ææ–™ã®è‡¨ç•Œè†œåšï¼ˆMatthews-Blakesleeç†è«–ï¼‰ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€æœ€ã‚‚æœ‰æœ›ãªææ–™ã‚’é¸å®šã—ã€ç†ç”±ã‚’è¿°ã¹ã¦ãã ã•ã„ã€‚
            </p>
            <button class="toggle-solution">è§£ç­”ã‚’è¡¨ç¤º</button>
            <div class="solution">
                <strong>è§£ç­”:</strong>
                <p><strong>æ¤œç´¢æ¡ä»¶</strong>:</p>
                <ul>
                    <li>GaNæ ¼å­å®šæ•°: a = 3.189 Ã…</li>
                    <li>è¨±å®¹ãƒŸã‚¹ãƒãƒƒãƒ: Â±2%ï¼ˆ3.13 - 3.25 Ã…ï¼‰</li>
                    <li>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: 2.0 - 4.0 eV</li>
                    <li>ææ–™ç³»: III-Væ—åŠå°ä½“ï¼ˆAl, Ga, In + N, P, Asï¼‰</li>
                </ul>
                <p><strong>å€™è£œææ–™</strong>ï¼ˆMaterials Projectæ¤œç´¢çµæœï¼‰:</p>
                <table>
                    <thead>
                        <tr>
                            <th>ææ–™</th>
                            <th>æ ¼å­å®šæ•° a [Ã…]</th>
                            <th>ãƒŸã‚¹ãƒãƒƒãƒ [%]</th>
                            <th>Eg [eV]</th>
                            <th>è‡¨ç•Œè†œåš [nm]</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>AlN</td>
                            <td>3.11</td>
                            <td>-2.5</td>
                            <td>6.0</td>
                            <td>~8</td>
                        </tr>
                        <tr>
                            <td>InN</td>
                            <td>3.54</td>
                            <td>+11</td>
                            <td>0.7</td>
                            <td>~2</td>
                        </tr>
                        <tr>
                            <td>GaN</td>
                            <td>3.189</td>
                            <td>0</td>
                            <td>3.4</td>
                            <td>âˆ</td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>è‡¨ç•Œè†œåšè¨ˆç®—</strong>ï¼ˆMatthews-Blakesleeç†è«–ï¼‰:</p>
                <p>
                    \[
                    h_c = \frac{b}{8\pi f} \left(1 - \nu \cos^2\alpha\right) \left[\ln\left(\frac{h_c}{b}\right) + 1\right]
                    \]
                    ã“ã“ã§ã€\(b\): Burgers vectorï¼ˆ~0.3 nmï¼‰ã€\(f\): ãƒŸã‚¹ãƒãƒƒãƒã€\(\nu\): Poissonæ¯”ï¼ˆ~0.35ï¼‰ã€\(\alpha\): æ»‘ã‚Šè§’ï¼ˆ60Â°ï¼‰
                </p>
                <p>AlN/GaNã®å ´åˆï¼ˆf = 0.025ï¼‰:</p>
                <p>
                    \[
                    h_c \approx \frac{0.3}{8\pi \times 0.025} \times (1 - 0.35 \times 0.25) \times \ln(h_c / 0.3 + 1) \approx 8 \text{ nm}
                    \]
                </p>
                <p><strong>æœ€ã‚‚æœ‰æœ›ãªææ–™</strong>: <strong>GaNï¼ˆåŒä¸€ææ–™ï¼‰</strong></p>
                <p><strong>ç†ç”±</strong>:</p>
                <ul>
                    <li>æ ¼å­ãƒŸã‚¹ãƒãƒƒãƒ0%ã«ã‚ˆã‚Šã€ä»»æ„ã®è†œåšã§ã‚‚æ­ªã¿ãªãæˆè†œå¯èƒ½ã€‚</li>
                    <li>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—3.4 eVã¯ç´«å¤–LEDã€é«˜é›»å­ç§»å‹•åº¦ãƒˆãƒ©ãƒ³ã‚¸ã‚¹ã‚¿ï¼ˆHEMTï¼‰ã«æœ€é©ã€‚</li>
                    <li>AlN/GaNãƒ˜ãƒ†ãƒ­æ§‹é€ ã§ã¯ã€è‡¨ç•Œè†œåšåˆ¶ç´„ï¼ˆ~8 nmï¼‰ã«ã‚ˆã‚Šã€åšè†œæˆé•·ã§è»¢ä½ãŒç™ºç”Ÿã—ã¾ã™ã€‚</li>
                </ul>
                <p><strong>æ¬¡å–„ç­–</strong>: AlGaNæ··æ™¶ï¼ˆAlçµ„æˆã‚’èª¿æ•´ã—ã¦æ ¼å­å®šæ•°ã‚’GaNã«è¿‘ã¥ã‘ã‚‹ï¼‰ã«ã‚ˆã‚Šã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã¨ãƒŸã‚¹ãƒãƒƒãƒã‚’åŒæ™‚ã«åˆ¶å¾¡ã§ãã¾ã™ã€‚</p>
            </div>
        </div>

        <div class="exercise-box">
            <h4>æ¼”ç¿’å•é¡Œ 5.6 (Hard): çµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®æ§‹ç¯‰</h4>
            <p>
                ã‚³ãƒ¼ãƒ‰ä¾‹1-5ã‚’çµ±åˆã—ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ã‚’æŒã¤è‡ªå‹•åŒ–ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è¨­è¨ˆã—ã¦ãã ã•ã„ï¼š(1) Bayesian optimizationã§ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ã‚’æ¢ç´¢ã€(2) çµ±åˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§è†œåšåˆ†å¸ƒã‚’äºˆæ¸¬ã€(3) æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã§è†œè³ªï¼ˆçµæ™¶æ€§ã€è¡¨é¢ç²—ã•ï¼‰ã‚’äºˆæ¸¬ã€(4) Paretoæœ€é©åŒ–ã§æœ€çµ‚æ¡ä»¶ã‚’æ±ºå®šã€‚ã¾ãŸã€ã“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè£…ã™ã‚‹éš›ã®æŠ€è¡“çš„èª²é¡Œã‚’3ã¤æŒ™ã’ã€è§£æ±ºç­–ã‚’ææ¡ˆã—ã¦ãã ã•ã„ã€‚
            </p>
            <button class="toggle-solution">è§£ç­”ã‚’è¡¨ç¤º</button>
            <div class="solution">
                <strong>è§£ç­”:</strong>
                <p><strong>çµ±åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ</strong>:</p>
                <pre><code class="language-python"># æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰
class IntegratedWorkflow:
    def __init__(self):
        self.simulator = ThinFilmSimulator()
        self.ml_model = load_pretrained_model('film_quality.pkl')
        self.bo_optimizer = BayesianOptimizer()

    def optimize_process(self, objectives, constraints):
        # Step 1: Bayesian Optimizationã§åˆæœŸæ¢ç´¢
        for i in range(20):
            # æ¬¡ã®å®Ÿé¨“æ¡ä»¶ã‚’ææ¡ˆ
            next_condition = self.bo_optimizer.suggest()

            # Step 2: ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§è†œåšåˆ†å¸ƒã‚’è¨ˆç®—
            thickness, uniformity = self.simulator.predict(next_condition)

            # Step 3: æ©Ÿæ¢°å­¦ç¿’ã§è†œè³ªã‚’äºˆæ¸¬
            quality = self.ml_model.predict(next_condition)

            # ç›®çš„é–¢æ•°ã‚’è©•ä¾¡
            objective_values = [uniformity, quality['crystallinity'], -quality['roughness']]

            # BOã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
            self.bo_optimizer.update(next_condition, objective_values)

        # Step 4: Paretoæœ€é©åŒ–ã§æœ€çµ‚æ¡ä»¶ã‚’é¸æŠ
        pareto_solutions = self.bo_optimizer.get_pareto_front()
        best_solution = self.select_by_user_preference(pareto_solutions, objectives)

        return best_solution
</code></pre>
                <p><strong>æŠ€è¡“çš„èª²é¡Œã¨è§£æ±ºç­–</strong>:</p>
                <ol>
                    <li><strong>èª²é¡Œ1: å¤šç›®çš„BOã®å®Ÿè£…</strong>
                        <ul>
                            <li>å•é¡Œ: æ¨™æº–çš„ãªBOã¯å˜ç›®çš„æœ€é©åŒ–ã€‚è¤‡æ•°ç›®çš„é–¢æ•°ã®åŒæ™‚æœ€é©åŒ–ãŒå›°é›£ã€‚</li>
                            <li>è§£æ±ºç­–: ParEGOï¼ˆPareto Efficient Global Optimizationï¼‰ã‚„NSGA-IIï¼ˆNon-dominated Sorting Genetic Algorithm IIï¼‰ã‚’ä½¿ç”¨ã€‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒª: Optunaã€Platypusã€‚</li>
                        </ul>
                    </li>
                    <li><strong>èª²é¡Œ2: ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã¨MLãƒ¢ãƒ‡ãƒ«ã®ä¸ç¢ºå®Ÿæ€§</strong>
                        <ul>
                            <li>å•é¡Œ: äºˆæ¸¬èª¤å·®ãŒæœ€é©åŒ–çµæœã«å½±éŸ¿ã€‚</li>
                            <li>è§£æ±ºç­–: ä¸ç¢ºå®Ÿæ€§ã‚’è€ƒæ…®ã—ãŸãƒ­ãƒã‚¹ãƒˆæœ€é©åŒ–ã€‚GPã®äºˆæ¸¬åˆ†æ•£Ïƒã‚’ç›®çš„é–¢æ•°ã«çµ„ã¿è¾¼ã‚€ï¼ˆä¾‹: Î¼ - 2Ïƒã§ä¿å®ˆçš„ã«è©•ä¾¡ï¼‰ã€‚</li>
                        </ul>
                    </li>
                    <li><strong>èª²é¡Œ3: è¨ˆç®—ã‚³ã‚¹ãƒˆã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§</strong>
                        <ul>
                            <li>å•é¡Œ: 20å›ã®BOåå¾©ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼+MLäºˆæ¸¬ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æ•°åˆ†ï½æ•°ååˆ†ã‹ã‹ã‚‹ã€‚</li>
                            <li>è§£æ±ºç­–: (1) ä»£ç†ãƒ¢ãƒ‡ãƒ«ï¼ˆsurrogate modelï¼‰ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€(2) GPUä¸¦åˆ—åŒ–ã€(3) ç²—ã„ã‚°ãƒªãƒƒãƒ‰æ¢ç´¢â†’è©³ç´°æ¢ç´¢ã®éšå±¤çš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã€‚</li>
                        </ul>
                    </li>
                </ol>
                <p><strong>å®Ÿè£…ä¾‹</strong>: Optunaãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®Multi-objective optimizationæ©Ÿèƒ½ã‚’ä½¿ç”¨:</p>
                <pre><code class="language-python">import optuna

def objective(trial):
    # ãƒ—ãƒ­ã‚»ã‚¹æ¡ä»¶ã‚’ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
    temperature = trial.suggest_float('temperature', 300, 1000)
    pressure = trial.suggest_float('pressure', 0.5, 50)

    # ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ + MLäºˆæ¸¬
    thickness, uniformity = simulator.predict([temperature, pressure])
    quality = ml_model.predict([[temperature, pressure]])

    return uniformity, quality['crystallinity']

# å¤šç›®çš„æœ€é©åŒ–å®Ÿè¡Œ
study = optuna.create_study(directions=['maximize', 'maximize'])
study.optimize(objective, n_trials=100)

# Paretoæœ€é©è§£ã‚’å–å¾—
pareto_trials = study.best_trials
</code></pre>
            </div>
        </div>

        <h2>å‚è€ƒæ–‡çŒ®</h2>

        <ol>
            <li>VanderPlas, J. (2023). <em>Python Data Science Handbook</em>. 2nd Edition. O'Reilly Media. <strong>pp. 300-400 (æ©Ÿæ¢°å­¦ç¿’åŸºç¤), pp. 450-550 (scikit-learnå®Ÿè·µ)</strong></li>

            <li>McKinney, W. (2022). <em>Python for Data Analysis</em>. 3rd Edition. O'Reilly Media. <strong>pp. 150-250 (pandasåŸºç¤), pp. 300-400 (ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–)</strong></li>

            <li>Raschka, S., Mirjalili, V. (2019). <em>Python Machine Learning</em>. 3rd Edition. Packt Publishing. <strong>pp. 100-200 (RandomForest/XGBoost), pp. 250-350 (ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´)</strong></li>

            <li>Frazier, P.I. (2018). A Tutorial on Bayesian Optimization. <em>arXiv:1807.02811</em>. <strong>pp. 1-35 (BOç†è«–), pp. 36-60 (å®Ÿè£…ã‚¬ã‚¤ãƒ‰)</strong></li>

            <li>scikit-learn documentation. <em>https://scikit-learn.org/stable/</em>. <strong>Machine Learning in Python (ãƒ¢ãƒ‡ãƒ«é¸æŠã€è©•ä¾¡æŒ‡æ¨™ã€å‰å‡¦ç†)</strong></li>

            <li>XGBoost documentation. <em>https://xgboost.readthedocs.io/</em>. <strong>Gradient Boosting Framework (ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´ã€åˆ†æ•£å­¦ç¿’)</strong></li>

            <li>Materials Project API documentation. <em>https://docs.materialsproject.org/</em>. <strong>APIä½¿ç”¨æ³•ã€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã€ã‚¯ã‚¨ãƒªä¾‹</strong></li>

            <li>scipy.optimize documentation. <em>https://docs.scipy.org/doc/scipy/reference/optimize.html</em>. <strong>å¤šç›®çš„æœ€é©åŒ–ã€åˆ¶ç´„ä»˜ãæœ€é©åŒ–ã€differential_evolution</strong></li>

            <li>Flask documentation. <em>https://flask.palletsprojects.com/</em>. <strong>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã€RESTful API</strong></li>

            <li>Plotly documentation. <em>https://plotly.com/python/</em>. <strong>ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å¯è¦–åŒ–ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ§‹ç¯‰</strong></li>
        </ol>

        <div class="nav-buttons">
            <a href="chapter-4.html" class="nav-button">â† Chapter 4: ãƒŠãƒææ–™åˆæˆ</a>
            <a href="index.html" class="nav-button">ç›®æ¬¡ã«æˆ»ã‚‹</a>
        </div>

        <footer>
            <p>&copy; 2025 Materials Science Dojo. All rights reserved.</p>
        </footer>
    </div>

    <script>
        // è§£ç­”è¡¨ç¤ºãƒˆã‚°ãƒ«æ©Ÿèƒ½
        document.addEventListener('DOMContentLoaded', function() {
            const toggleButtons = document.querySelectorAll('.toggle-solution');
            toggleButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const solution = this.nextElementSibling;
                    solution.classList.toggle('show');
                    this.textContent = solution.classList.contains('show') ? 'è§£ç­”ã‚’éš ã™' : 'è§£ç­”ã‚’è¡¨ç¤º';
                });
            });
        });
    </script>
</body>
</html>
