<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬5ç« ï¼šPythonã§å­¦ã¶çµæ™¶æ§‹é€ å¯è¦–åŒ– - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .breadcrumb {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .breadcrumb a {
            color: var(--color-link);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .warning-box {
            background: linear-gradient(135deg, #fff7ed 0%, #fed7aa 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid #f59e0b;
            margin: var(--spacing-md) 0;
        }

        .warning-box h4 {
            margin-top: 0;
            color: #d97706;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬5ç« ï¼šPythonã§å­¦ã¶çµæ™¶æ§‹é€ å¯è¦–åŒ–</h1>
            <p class="subtitle">pymatgenãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨Materials Projectã®æ´»ç”¨</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 40-45åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´šã€œä¸Šç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 6å€‹</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">ææ–™ç§‘å­¦å…¥é–€</a> &gt;
        ç¬¬5ç« 
    </div>

    <main class="container">
        <p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); border-left: 4px solid #f093fb; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">
            pymatgenã¯ã€ææ–™ç§‘å­¦ã®ãŸã‚ã®å¼·åŠ›ãªPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚çµæ™¶æ§‹é€ ã®ä½œæˆãƒ»æ“ä½œãƒ»è§£æãƒ»å¯è¦–åŒ–ã‚’ç°¡å˜ã«è¡Œãˆã¾ã™ã€‚ã“ã®ç« ã§ã¯ã€pymatgenã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‹ã‚‰ã€Materials Projectãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ´»ç”¨ã—ãŸå®Ÿè·µçš„ãªææ–™è§£æã¾ã§å­¦ã³ã¾ã™ã€‚
        </p>

        <div class="learning-objectives">
            <h2>å­¦ç¿’ç›®æ¨™</h2>
            <p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
            <ul>
                <li>âœ… pymatgenã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’ç†è§£ã™ã‚‹</li>
                <li>âœ… Structureã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã€çµæ™¶æ§‹é€ ã‚’æ“ä½œã§ãã‚‹</li>
                <li>âœ… CIFãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰çµæ™¶æ§‹é€ ã‚’èª­ã¿è¾¼ã¿ã€æƒ…å ±ã‚’æŠ½å‡ºã§ãã‚‹</li>
                <li>âœ… Materials Project APIã‚’ä½¿ã£ã¦ææ–™ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã§ãã‚‹</li>
                <li>âœ… ä»£è¡¨çš„ãªææ–™ï¼ˆSi, Fe, Alâ‚‚Oâ‚ƒï¼‰ã®çµæ™¶æ§‹é€ ã‚’è§£æã§ãã‚‹</li>
                <li>âœ… æ§‹é€ å¯è¦–åŒ–ã‹ã‚‰ç‰¹æ€§äºˆæ¸¬ã¾ã§ã®ç·åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã§ãã‚‹</li>
            </ul>
        </div>

        <hr>

        <h2>5.1 pymatgenå…¥é–€</h2>

        <h3>pymatgenã¨ã¯</h3>

        <p><strong>pymatgen (Python Materials Genomics)</strong>ã¯ã€ææ–™ç§‘å­¦ã®ãŸã‚ã®åŒ…æ‹¬çš„ãªPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚</p>

        <p><strong>ä¸»ãªæ©Ÿèƒ½</strong>ï¼š</p>
        <ul>
            <li>çµæ™¶æ§‹é€ ã®ä½œæˆãƒ»æ“ä½œãƒ»è§£æ</li>
            <li>CIF, POSCAR, XYZãªã©å¤šæ§˜ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®I/O</li>
            <li>çµæ™¶å¯¾ç§°æ€§ã®è§£æ</li>
            <li>çŠ¶æ…‹å›³ï¼ˆPhase Diagramï¼‰ã®ä½œæˆ</li>
            <li>Materials Projectãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹</li>
            <li>é›»å­æ§‹é€ è¨ˆç®—ï¼ˆVASP, Quantum Espressoãªã©ï¼‰ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—</li>
        </ul>

        <h3>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h3>

        <p>pipã‚’ä½¿ã£ã¦ç°¡å˜ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ï¼š</p>

        <pre><code class="language-bash"># åŸºæœ¬ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install pymatgen

# å¯è¦–åŒ–æ©Ÿèƒ½ã‚’å«ã‚€å®Œå…¨ç‰ˆ
pip install pymatgen[all]

# ã¾ãŸã¯ã€condaã‚’ä½¿ç”¨ã™ã‚‹å ´åˆ
conda install -c conda-forge pymatgen
</code></pre>

        <div class="warning-box">
            <h4>âš ï¸ æ³¨æ„äº‹é …</h4>
            <p>pymatgenã¯ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒå¤šã„ãŸã‚ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä»®æƒ³ç’°å¢ƒã§ã®ä½¿ç”¨ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</p>
            <pre><code class="language-bash"># ä»®æƒ³ç’°å¢ƒã®ä½œæˆï¼ˆæ¨å¥¨ï¼‰
python -m venv pymatgen_env
source pymatgen_env/bin/activate  # Windowsã®å ´åˆ: pymatgen_env\Scripts\activate
pip install pymatgen
</code></pre>
        </div>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: pymatgenã§å˜ç´”ç«‹æ–¹æ ¼å­ã‚’ä½œæˆ</h3>

        <p>pymatgenã®åŸºæœ¬æ“ä½œã¨ã—ã¦ã€å˜ç´”ç«‹æ–¹æ ¼å­ï¼ˆSimple Cubicï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">from pymatgen.core import Structure, Lattice
import numpy as np

# å˜ç´”ç«‹æ–¹æ ¼å­ã®ä½œæˆ
# Latticeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ: æ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã‚’å®šç¾©
a = 3.0  # æ ¼å­å®šæ•°ï¼ˆÃ…ï¼‰

# æ–¹æ³•1: æ ¼å­å®šæ•°ã‹ã‚‰ç«‹æ–¹æ™¶ã‚’ä½œæˆï¼ˆæœ€ã‚‚ç°¡å˜ï¼‰
lattice = Lattice.cubic(a)

print("="*70)
print("å˜ç´”ç«‹æ–¹æ ¼å­ã®ä½œæˆï¼ˆpymatgenï¼‰")
print("="*70)

print(f"\nã€æ ¼å­æƒ…å ±ã€‘")
print(f"æ ¼å­å®šæ•° a = {a} Ã…")
print(f"\næ ¼å­ãƒ™ã‚¯ãƒˆãƒ«:")
print(lattice.matrix)
print(f"\næ ¼å­ä½“ç©: {lattice.volume:.4f} Ã…Â³")

# Structureã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ: æ ¼å­ + åŸå­ä½ç½®
# åŸå­ç¨®ã¨åˆ†æ•°åº§æ¨™ï¼ˆfractional coordinatesï¼‰ã‚’æŒ‡å®š
species = ["Po"]  # ãƒãƒ­ãƒ‹ã‚¦ãƒ ï¼ˆå˜ç´”ç«‹æ–¹ã®ä¾‹ï¼‰
coords = [[0, 0, 0]]  # æ ¼å­ã®åŸç‚¹ã«1å€‹ã®åŸå­

structure = Structure(lattice, species, coords)

print(f"\nã€çµæ™¶æ§‹é€ æƒ…å ±ã€‘")
print(f"çµ„æˆå¼: {structure.composition.reduced_formula}")
print(f"åŸå­æ•°: {structure.num_sites}")
print(f"å¯†åº¦: {structure.density:.4f} g/cmÂ³")

# åŸå­ä½ç½®ã®è¡¨ç¤º
print(f"\nã€åŸå­ä½ç½®ã€‘")
for i, site in enumerate(structure.sites):
    print(f"åŸå­ {i+1}: {site.specie} @ {site.frac_coords} (åˆ†æ•°åº§æ¨™)")
    print(f"        {site.specie} @ {site.coords} Ã… (ãƒ‡ã‚«ãƒ«ãƒˆåº§æ¨™)")

# æ–¹æ³•2: ã‚ˆã‚Šè¤‡é›‘ãªæ ¼å­ï¼ˆFCCï¼‰ã‚’ä½œæˆ
print("\n" + "="*70)
print("é¢å¿ƒç«‹æ–¹æ ¼å­ï¼ˆFCCï¼‰ã®ä½œæˆ")
print("="*70)

# FCCæ ¼å­: é ‚ç‚¹ + é¢å¿ƒã«åŸå­
a_fcc = 3.615  # éŠ…ã®æ ¼å­å®šæ•°ï¼ˆÃ…ï¼‰
lattice_fcc = Lattice.cubic(a_fcc)

# FCCæ§‹é€ ã®åŸå­ä½ç½®ï¼ˆåˆ†æ•°åº§æ¨™ï¼‰
# é ‚ç‚¹1å€‹ + é¢å¿ƒ3å€‹ = å˜ä½æ ¼å­ã‚ãŸã‚Š4åŸå­
species_fcc = ["Cu"] * 4
coords_fcc = [
    [0.0, 0.0, 0.0],  # é ‚ç‚¹
    [0.5, 0.5, 0.0],  # xyé¢ã®é¢å¿ƒ
    [0.5, 0.0, 0.5],  # xzé¢ã®é¢å¿ƒ
    [0.0, 0.5, 0.5],  # yzé¢ã®é¢å¿ƒ
]

structure_fcc = Structure(lattice_fcc, species_fcc, coords_fcc)

print(f"\nã€FCCæ§‹é€ æƒ…å ±ï¼ˆéŠ…ï¼‰ã€‘")
print(f"çµ„æˆå¼: {structure_fcc.composition.reduced_formula}")
print(f"åŸå­æ•°: {structure_fcc.num_sites}")
print(f"å¯†åº¦: {structure_fcc.density:.4f} g/cmÂ³ï¼ˆå®Ÿæ¸¬å€¤: 8.96 g/cmÂ³ï¼‰")
print(f"æ ¼å­ä½“ç©: {structure_fcc.volume:.4f} Ã…Â³")

# æœ€è¿‘æ¥è·é›¢ã®è¨ˆç®—
print(f"\nã€æœ€è¿‘æ¥åŸå­é–“è·é›¢ã€‘")
# ã™ã¹ã¦ã®åŸå­ãƒšã‚¢ã®è·é›¢ã‚’è¨ˆç®—
distances = []
for i in range(len(structure_fcc)):
    for j in range(i+1, len(structure_fcc)):
        dist = structure_fcc.get_distance(i, j)
        distances.append(dist)

min_distance = min(distances)
print(f"æœ€è¿‘æ¥è·é›¢: {min_distance:.4f} Ã…")
print(f"ç†è«–å€¤: {a_fcc / np.sqrt(2):.4f} Ã…ï¼ˆé¢å¯¾è§’ç·š/2ï¼‰")

# é…ä½æ•°ã®è¨ˆç®—ï¼ˆç‰¹å®šã®åŸå­ã®å‘¨ã‚Šã®è¿‘æ¥åŸå­æ•°ï¼‰
neighbors = structure_fcc.get_neighbors(structure_fcc[0], r=min_distance * 1.1)
print(f"é…ä½æ•°: {len(neighbors)}ï¼ˆFCCã®ç†è«–å€¤: 12ï¼‰")

print("\n" + "="*70)
print("pymatgenã®åˆ©ç‚¹:")
print("- æ•°è¡Œã§è¤‡é›‘ãªçµæ™¶æ§‹é€ ã‚’ä½œæˆå¯èƒ½")
print("- å¯¾ç§°æ€§ã‚’è‡ªå‹•ã§å‡¦ç†")
print("- æ ¼å­ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨åŸå­ä½ç½®ã‹ã‚‰å¯†åº¦ãªã©ã‚’è‡ªå‹•è¨ˆç®—")
print("- è·é›¢ãƒ»è§’åº¦ãƒ»é…ä½æ•°ãªã©ã®å¹¾ä½•å­¦çš„æƒ…å ±ã‚’ç°¡å˜ã«å–å¾—")
</code></pre>

        <p><strong>è§£èª¬</strong>: pymatgenã§ã¯ã€<code>Lattice</code>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§æ ¼å­ã‚’å®šç¾©ã—ã€<code>Structure</code>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§åŸå­ä½ç½®ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€çµæ™¶æ§‹é€ ã‚’ä½œæˆã—ã¾ã™ã€‚åˆ†æ•°åº§æ¨™ï¼ˆæ ¼å­ãƒ™ã‚¯ãƒˆãƒ«ã®ç·šå½¢çµåˆï¼‰ã‚’ä½¿ã†ãŸã‚ã€å¯¾ç§°æ€§ã‚’ä¿ã¡ãªãŒã‚‰æ“ä½œã§ãã¾ã™ã€‚</p>

        <hr>

        <h2>5.2 çµæ™¶æ§‹é€ ã®èª­ã¿è¾¼ã¿ã¨è¡¨ç¤º</h2>

        <h3>CIFãƒ•ã‚¡ã‚¤ãƒ«ã¨ã¯</h3>

        <p><strong>CIF (Crystallographic Information File)</strong>ã¯ã€çµæ™¶æ§‹é€ ãƒ‡ãƒ¼ã‚¿ã®æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚</p>

        <p><strong>CIFãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹</strong>ï¼š</p>
        <ul>
            <li>æ ¼å­å®šæ•°ï¼ˆa, b, c, Î±, Î², Î³ï¼‰</li>
            <li>ç©ºé–“ç¾¤ï¼ˆSpace Groupï¼‰</li>
            <li>åŸå­ç¨®ã¨åº§æ¨™</li>
            <li>å¯¾ç§°æ“ä½œ</li>
            <li>ãã®ä»–ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿</li>
        </ul>

        <p>CIFãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€<a href="https://www.crystallography.net/cod/" target="_blank">Crystallography Open Database (COD)</a>ã‚„<a href="https://materialsproject.org/" target="_blank">Materials Project</a>ã‹ã‚‰ç„¡æ–™ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚</p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: CIFãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¨æ§‹é€ æƒ…å ±ã®è¡¨ç¤º</h3>

        <p>CIFãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰çµæ™¶æ§‹é€ ã‚’èª­ã¿è¾¼ã¿ã€è©³ç´°ãªæƒ…å ±ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">from pymatgen.core import Structure
from pymatgen.symmetry.analyzer import SpacegroupAnalyzer
import numpy as np

# CIFãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’æ–‡å­—åˆ—ã¨ã—ã¦å®šç¾©ï¼ˆå®Ÿéš›ã«ã¯ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã‚€ï¼‰
# ä¾‹: ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰ã®CIFãƒ‡ãƒ¼ã‚¿
cif_data_si = """
data_Si
_cell_length_a    5.4310
_cell_length_b    5.4310
_cell_length_c    5.4310
_cell_angle_alpha 90.0
_cell_angle_beta  90.0
_cell_angle_gamma 90.0
_space_group_name_H-M_alt 'F d -3 m'
_space_group_IT_number    227
loop_
_atom_site_label
_atom_site_type_symbol
_atom_site_fract_x
_atom_site_fract_y
_atom_site_fract_z
Si1 Si 0.000 0.000 0.000
Si2 Si 0.250 0.250 0.250
"""

# CIFæ–‡å­—åˆ—ã‹ã‚‰æ§‹é€ ã‚’èª­ã¿è¾¼ã‚€
# å®Ÿéš›ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã‚€å ´åˆ: Structure.from_file("structure.cif")
from io import StringIO
structure_si = Structure.from_str(cif_data_si, fmt="cif")

print("="*70)
print("CIFãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰èª­ã¿è¾¼ã‚“ã çµæ™¶æ§‹é€ ï¼ˆã‚·ãƒªã‚³ãƒ³ï¼‰")
print("="*70)

# åŸºæœ¬æƒ…å ±
print(f"\nã€åŸºæœ¬æƒ…å ±ã€‘")
print(f"çµ„æˆå¼: {structure_si.composition.reduced_formula}")
print(f"åŒ–å­¦å¼ï¼ˆHillè¡¨è¨˜ï¼‰: {structure_si.composition.hill_formula}")
print(f"å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: {structure_si.num_sites}")
print(f"å¯†åº¦: {structure_si.density:.4f} g/cmÂ³ï¼ˆå®Ÿæ¸¬å€¤: 2.33 g/cmÂ³ï¼‰")

# æ ¼å­æƒ…å ±
lattice = structure_si.lattice
print(f"\nã€æ ¼å­æƒ…å ±ã€‘")
print(f"çµæ™¶ç³»: ç«‹æ–¹æ™¶ç³»ï¼ˆCubicï¼‰")
print(f"æ ¼å­å®šæ•°:")
print(f"  a = {lattice.a:.4f} Ã…")
print(f"  b = {lattice.b:.4f} Ã…")
print(f"  c = {lattice.c:.4f} Ã…")
print(f"æ ¼å­è§’:")
print(f"  Î± = {lattice.alpha:.2f}Â°")
print(f"  Î² = {lattice.beta:.2f}Â°")
print(f"  Î³ = {lattice.gamma:.2f}Â°")
print(f"æ ¼å­ä½“ç©: {lattice.volume:.4f} Ã…Â³")

# å¯¾ç§°æ€§è§£æ
sga = SpacegroupAnalyzer(structure_si)
print(f"\nã€å¯¾ç§°æ€§æƒ…å ±ã€‘")
print(f"ç©ºé–“ç¾¤è¨˜å·ï¼ˆHermann-Mauguinï¼‰: {sga.get_space_group_symbol()}")
print(f"ç©ºé–“ç¾¤ç•ªå·: {sga.get_space_group_number()}")
print(f"ç‚¹ç¾¤: {sga.get_point_group_symbol()}")
print(f"çµæ™¶ç³»: {sga.get_crystal_system()}")

# åŸå­ä½ç½®ã®è¡¨ç¤º
print(f"\nã€åŸå­ä½ç½®ï¼ˆå˜ä½æ ¼å­å†…ï¼‰ã€‘")
for i, site in enumerate(structure_si.sites):
    print(f"\nåŸå­ {i+1}:")
    print(f"  å…ƒç´ : {site.specie}")
    print(f"  åˆ†æ•°åº§æ¨™: {site.frac_coords}")
    print(f"  ãƒ‡ã‚«ãƒ«ãƒˆåº§æ¨™: {site.coords} Ã…")

# åŸå§‹æ ¼å­ï¼ˆPrimitive Cellï¼‰ã¸ã®å¤‰æ›
primitive = structure_si.get_primitive_structure()
print(f"\nã€åŸå§‹æ ¼å­ã¸ã®å¤‰æ›ã€‘")
print(f"å…ƒã®å˜ä½æ ¼å­ã®åŸå­æ•°: {structure_si.num_sites}")
print(f"åŸå§‹æ ¼å­ã®åŸå­æ•°: {primitive.num_sites}")
print(f"åŸå§‹æ ¼å­ã®ä½“ç©: {primitive.volume:.4f} Ã…Â³")

# å¾“æ¥æ ¼å­ï¼ˆConventional Cellï¼‰ã®å–å¾—
conventional = sga.get_conventional_standard_structure()
print(f"\nå¾“æ¥æ ¼å­ã®åŸå­æ•°: {conventional.num_sites}")
print(f"å¾“æ¥æ ¼å­ã®ä½“ç©: {conventional.volume:.4f} Ã…Â³")

# æœ€è¿‘æ¥è·é›¢ã®è¨ˆç®—
print(f"\nã€æœ€è¿‘æ¥åŸå­é–“è·é›¢ã€‘")
all_distances = []
for i in range(len(structure_si)):
    for j in range(i+1, len(structure_si)):
        dist = structure_si.get_distance(i, j)
        all_distances.append(dist)

if all_distances:
    min_dist = min(all_distances)
    print(f"æœ€è¿‘æ¥è·é›¢: {min_dist:.4f} Ã…")
    print(f"ç†è«–å€¤ï¼ˆãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼‰: {lattice.a * np.sqrt(3) / 4:.4f} Ã…")

# é…ä½æ•°
neighbors = structure_si.get_neighbors(structure_si[0], r=min_dist * 1.1)
print(f"é…ä½æ•°: {len(neighbors)}ï¼ˆãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ã®ç†è«–å€¤: 4ï¼‰")

print("\n" + "="*70)
print("CIFãƒ•ã‚¡ã‚¤ãƒ«ã®åˆ©ç‚¹:")
print("- æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§çµæ™¶æ§‹é€ ã‚’ä¿å­˜ãƒ»å…±æœ‰")
print("- æ ¼å­å®šæ•°ãƒ»ç©ºé–“ç¾¤ãƒ»åŸå­ä½ç½®ã‚’å«ã‚€å®Œå…¨ãªæƒ…å ±")
print("- pymatgenã§ç°¡å˜ã«èª­ã¿è¾¼ã¿ãƒ»è§£æå¯èƒ½")
print("- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆCOD, Materials Projectãªã©ï¼‰ã‹ã‚‰å…¥æ‰‹å¯èƒ½")
</code></pre>

        <p><strong>è§£èª¬</strong>: CIFãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯çµæ™¶æ§‹é€ ã®å®Œå…¨ãªæƒ…å ±ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚pymatgenã‚’ä½¿ãˆã°ã€CIFãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æ§‹é€ ã‚’èª­ã¿è¾¼ã¿ã€æ ¼å­å®šæ•°ã€ç©ºé–“ç¾¤ã€åŸå­ä½ç½®ãªã©ã®æƒ…å ±ã‚’ç°¡å˜ã«æŠ½å‡ºã§ãã¾ã™ã€‚<code>SpacegroupAnalyzer</code>ã‚’ä½¿ã†ã¨å¯¾ç§°æ€§ã®è©³ç´°ãªè§£æã‚‚å¯èƒ½ã§ã™ã€‚</p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: çµæ™¶æ§‹é€ ã®3Då¯è¦–åŒ–ï¼ˆpymatgen + matplotlibï¼‰</h3>

        <p>pymatgenã§ä½œæˆã—ãŸçµæ™¶æ§‹é€ ã‚’3Dã§å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">from pymatgen.core import Structure, Lattice
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
import numpy as np

def visualize_structure_3d(structure, supercell=(1, 1, 1), show_bonds=True, bond_cutoff=3.0):
    """
    pymatgenæ§‹é€ ã‚’3Dã§å¯è¦–åŒ–

    Parameters:
    structure: pymatgen Structure object
    supercell: ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ã®ã‚µã‚¤ã‚ºï¼ˆã‚¿ãƒ—ãƒ«ï¼‰
    show_bonds: çµåˆã‚’è¡¨ç¤ºã™ã‚‹ã‹
    bond_cutoff: çµåˆã¨ã¿ãªã™è·é›¢ã®é–¾å€¤ï¼ˆÃ…ï¼‰
    """
    # ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ã‚’ä½œæˆï¼ˆã‚ˆã‚Šå¤§ããªé ˜åŸŸã‚’å¯è¦–åŒ–ï¼‰
    structure_super = structure * supercell

    # å›³ã®ä½œæˆ
    fig = plt.figure(figsize=(12, 10))
    ax = fig.add_subplot(111, projection='3d')

    # åŸå­ç¨®ã”ã¨ã«è‰²ã‚’å®šç¾©
    element_colors = {
        'Si': '#b8b8d0',  # è–„ç´«
        'Fe': '#e06633',  # ã‚ªãƒ¬ãƒ³ã‚¸
        'Al': '#a8a8a8',  # ç°è‰²
        'O': '#ff0d0d',   # èµ¤
        'Cu': '#ffa500',  # ã‚ªãƒ¬ãƒ³ã‚¸
    }

    # åŸå­ç¨®ã”ã¨ã®ã‚µã‚¤ã‚º
    element_sizes = {
        'Si': 200,
        'Fe': 200,
        'Al': 150,
        'O': 100,
        'Cu': 180,
    }

    # åŸå­ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
    for site in structure_super.sites:
        element = str(site.specie)
        color = element_colors.get(element, '#808080')  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ç°è‰²
        size = element_sizes.get(element, 150)

        x, y, z = site.coords
        ax.scatter(x, y, z, c=color, s=size, edgecolors='black',
                  linewidth=1.5, alpha=0.8, depthshade=True, label=element)

    # çµåˆã‚’æç”»
    if show_bonds:
        drawn_bonds = set()  # é‡è¤‡ã‚’é¿ã‘ã‚‹ãŸã‚
        for i, site1 in enumerate(structure_super.sites):
            neighbors = structure_super.get_neighbors(site1, r=bond_cutoff)
            for neighbor in neighbors:
                # ãƒšã‚¢ã‚’è­˜åˆ¥å­ã¨ã—ã¦ç™»éŒ²ï¼ˆé †åºä¸åŒï¼‰
                pair = tuple(sorted([i, structure_super.sites.index(neighbor.site)]))
                if pair not in drawn_bonds:
                    drawn_bonds.add(pair)
                    x_vals = [site1.coords[0], neighbor.coords[0]]
                    y_vals = [site1.coords[1], neighbor.coords[1]]
                    z_vals = [site1.coords[2], neighbor.coords[2]]
                    ax.plot(x_vals, y_vals, z_vals, 'k-', linewidth=0.8, alpha=0.3)

    # å˜ä½æ ¼å­ã®æ ã‚’æç”»
    lattice_vecs = structure.lattice.matrix
    origin = np.array([0, 0, 0])

    # ç«‹æ–¹ä½“ã®è¾º
    vertices = [
        origin,
        lattice_vecs[0],
        lattice_vecs[0] + lattice_vecs[1],
        lattice_vecs[1],
        lattice_vecs[2],
        lattice_vecs[2] + lattice_vecs[0],
        lattice_vecs[2] + lattice_vecs[0] + lattice_vecs[1],
        lattice_vecs[2] + lattice_vecs[1]
    ]

    # åº•é¢ã®è¾º
    edges = [
        (0, 1), (1, 2), (2, 3), (3, 0),  # åº•é¢
        (4, 5), (5, 6), (6, 7), (7, 4),  # ä¸Šé¢
        (0, 4), (1, 5), (2, 6), (3, 7)   # ç¸¦ã®è¾º
    ]

    for edge in edges:
        v1, v2 = vertices[edge[0]], vertices[edge[1]]
        ax.plot([v1[0], v2[0]], [v1[1], v2[1]], [v1[2], v2[2]],
               'b-', linewidth=2, alpha=0.6)

    # è»¸ãƒ©ãƒ™ãƒ«
    ax.set_xlabel('X (Ã…)', fontsize=12, fontweight='bold')
    ax.set_ylabel('Y (Ã…)', fontsize=12, fontweight='bold')
    ax.set_zlabel('Z (Ã…)', fontsize=12, fontweight='bold')

    # ã‚¿ã‚¤ãƒˆãƒ«
    formula = structure.composition.reduced_formula
    ax.set_title(f'{formula} çµæ™¶æ§‹é€ ï¼ˆ{supercell[0]}Ã—{supercell[1]}Ã—{supercell[2]} ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ï¼‰',
                fontsize=14, fontweight='bold', pad=20)

    # å‡¡ä¾‹ï¼ˆé‡è¤‡ã‚’å‰Šé™¤ï¼‰
    handles, labels = ax.get_legend_handles_labels()
    by_label = dict(zip(labels, handles))
    ax.legend(by_label.values(), by_label.keys(), fontsize=11, loc='upper right')

    # è¦–ç‚¹ã®èª¿æ•´
    ax.view_init(elev=20, azim=45)
    ax.set_box_aspect([1, 1, 1])

    plt.tight_layout()
    plt.show()

# ã‚·ãƒªã‚³ãƒ³ã®ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ã‚’ä½œæˆ
a_si = 5.431  # Ã…
lattice_si = Lattice.cubic(a_si)

# ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ã®åŸå­ä½ç½®ï¼ˆFCC + å†…éƒ¨åŸå­ï¼‰
species_si = ["Si"] * 8
coords_si = [
    [0.00, 0.00, 0.00],  # FCCé ‚ç‚¹
    [0.50, 0.50, 0.00],  # FCCé¢å¿ƒ
    [0.50, 0.00, 0.50],
    [0.00, 0.50, 0.50],
    [0.25, 0.25, 0.25],  # ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰å†…éƒ¨
    [0.75, 0.75, 0.25],
    [0.75, 0.25, 0.75],
    [0.25, 0.75, 0.75],
]

structure_si = Structure(lattice_si, species_si, coords_si)

print("="*70)
print("ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰ã®ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ã‚’3Då¯è¦–åŒ–")
print("="*70)
print(f"çµ„æˆå¼: {structure_si.composition.reduced_formula}")
print(f"æ ¼å­å®šæ•° a = {a_si} Ã…")
print(f"å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: {structure_si.num_sites}")
print(f"çµæ™¶æ§‹é€ : ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰å‹ï¼ˆFCC + å†…éƒ¨åŸå­ï¼‰")
print("\n3Dãƒ—ãƒ­ãƒƒãƒˆã‚’è¡¨ç¤ºä¸­...")

# å¯è¦–åŒ–ï¼ˆ2x2x2ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ã§è¦‹ã‚„ã™ãï¼‰
visualize_structure_3d(structure_si, supercell=(2, 2, 2), show_bonds=True, bond_cutoff=2.5)

print("\n" + "="*70)
print("å¯è¦–åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ:")
print("- åŸå­ã‚’çƒã§è¡¨ç¾")
print("- çµåˆã‚’ç·šã§è¡¨ç¾ï¼ˆè·é›¢ãŒé–¾å€¤ä»¥ä¸‹ã®ãƒšã‚¢ï¼‰")
print("- å˜ä½æ ¼å­ã®æ ã‚’é’ç·šã§è¡¨ç¤º")
print("- ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ã§å‘¨æœŸæ§‹é€ ã‚’ç†è§£ã—ã‚„ã™ã")
</code></pre>

        <p><strong>è§£èª¬</strong>: pymatgenã®Structureã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰åŸå­åº§æ¨™ã‚’å–å¾—ã—ã€matplotlibã§3Då¯è¦–åŒ–ã§ãã¾ã™ã€‚ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ï¼ˆå˜ä½æ ¼å­ã‚’ç¹°ã‚Šè¿”ã—ãŸæ§‹é€ ï¼‰ã‚’ä½œæˆã™ã‚‹ã“ã¨ã§ã€çµæ™¶ã®å‘¨æœŸæ€§ãŒåˆ†ã‹ã‚Šã‚„ã™ããªã‚Šã¾ã™ã€‚çµåˆã®è¡¨ç¤ºã«ã‚ˆã‚Šã€é…ä½æ§‹é€ ã‚‚ç†è§£ã§ãã¾ã™ã€‚</p>

        <hr>

        <h2>5.3 Materials Projectãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ´»ç”¨</h2>

        <h3>Materials Projectã¨ã¯</h3>

        <p><strong>Materials Project</strong>ã¯ã€ç¬¬ä¸€åŸç†è¨ˆç®—ã«åŸºã¥ãææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã§ã™ã€‚</p>

        <p><strong>ä¸»ãªç‰¹å¾´</strong>ï¼š</p>
        <ul>
            <li>140,000ç¨®é¡ä»¥ä¸Šã®ææ–™ãƒ‡ãƒ¼ã‚¿</li>
            <li>çµæ™¶æ§‹é€ ã€é›»å­æ§‹é€ ã€ç†±åŠ›å­¦çš„æ€§è³ª</li>
            <li>APIçµŒç”±ã§ç„¡æ–™ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½</li>
            <li>pymatgenã§ç°¡å˜ã«åˆ©ç”¨ã§ãã‚‹</li>
        </ul>

        <p><strong>å«ã¾ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿</strong>ï¼š</p>
        <ul>
            <li>çµæ™¶æ§‹é€ ï¼ˆCIFï¼‰</li>
            <li>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—</li>
            <li>ç”Ÿæˆã‚¨ãƒãƒ«ã‚®ãƒ¼</li>
            <li>å¼¾æ€§å®šæ•°</li>
            <li>é›»å­çŠ¶æ…‹å¯†åº¦ï¼ˆDOSï¼‰</li>
            <li>ãƒãƒ³ãƒ‰æ§‹é€ </li>
        </ul>

        <h3>APIã‚­ãƒ¼ã®å–å¾—ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</h3>

        <p>Materials Project APIã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€<a href="https://materialsproject.org/" target="_blank">Materials Project</a>ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆã—ã€APIã‚­ãƒ¼ã‚’å–å¾—ã—ã¾ã™ï¼ˆç„¡æ–™ï¼‰ã€‚</p>

        <ol>
            <li><a href="https://materialsproject.org/" target="_blank">https://materialsproject.org/</a> ã«ã‚¢ã‚¯ã‚»ã‚¹</li>
            <li>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²ï¼ˆSign Upï¼‰</li>
            <li>Dashboard â†’ API â†’ Generate API Keyã§ã‚­ãƒ¼ã‚’å–å¾—</li>
        </ol>

        <div class="warning-box">
            <h4>âš ï¸ APIã‚­ãƒ¼ãªã—ã§ã‚‚ä½¿ãˆã‚‹æ–¹æ³•</h4>
            <p>ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã§ã¯ã€APIã‚­ãƒ¼ãŒãªã„å ´åˆã§ã‚‚å‹•ä½œã™ã‚‹ã‚ˆã†ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§æ§‹é€ ã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã‚‚ç¤ºã—ã¾ã™ã€‚å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€APIã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šå¤šãã®ææ–™ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚</p>
        </div>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: Materials Project APIã§ææ–™ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—</h3>

        <p>Materials Project APIã‚’ä½¿ã£ã¦ææ–™ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ï¼ˆAPIã‚­ãƒ¼ã‚ã‚Šãƒ»ãªã—ä¸¡æ–¹ã®ä¾‹ï¼‰ã€‚</p>

        <pre><code class="language-python">from pymatgen.core import Structure
from pymatgen.ext.matproj import MPRester
import warnings
warnings.filterwarnings('ignore')

# Materials Project APIã‚’ä½¿ã£ãŸææ–™ãƒ‡ãƒ¼ã‚¿å–å¾—
def get_material_from_mp(formula, api_key=None):
    """
    Materials Projectã‹ã‚‰ææ–™ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—

    Parameters:
    formula: åŒ–å­¦å¼ï¼ˆä¾‹: "Si", "Fe", "Al2O3"ï¼‰
    api_key: Materials Project APIã‚­ãƒ¼ï¼ˆNoneã®å ´åˆã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰

    Returns:
    structure: pymatgen Structure object
    properties: ææ–™ç‰¹æ€§ã®è¾æ›¸
    """
    if api_key is not None:
        # APIã‚­ãƒ¼ãŒã‚ã‚‹å ´åˆ: Materials Projectã‹ã‚‰å–å¾—
        try:
            with MPRester(api_key) as mpr:
                # åŒ–å­¦å¼ã§æ¤œç´¢
                entries = mpr.get_entries(formula)

                if not entries:
                    print(f"è­¦å‘Š: {formula}ã®ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ")
                    return None, None

                # æœ€ã‚‚å®‰å®šãªæ§‹é€ ï¼ˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæœ€ã‚‚ä½ã„ï¼‰ã‚’é¸æŠ
                entry = min(entries, key=lambda e: e.energy_per_atom)
                structure = entry.structure

                # ææ–™IDã‚’å–å¾—
                material_id = entry.entry_id

                # è¿½åŠ æƒ…å ±ã‚’å–å¾—
                material_data = mpr.get_doc(material_id)

                properties = {
                    'formula': structure.composition.reduced_formula,
                    'material_id': material_id,
                    'energy_per_atom': entry.energy_per_atom,
                    'band_gap': material_data.get('band_gap', 'N/A'),
                    'density': structure.density,
                    'space_group': material_data.get('space_group', 'N/A'),
                }

                return structure, properties

        except Exception as e:
            print(f"APIå–å¾—ã‚¨ãƒ©ãƒ¼: {e}")
            print("ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¾ã™")

    # APIã‚­ãƒ¼ãŒãªã„å ´åˆã€ã¾ãŸã¯ã‚¨ãƒ©ãƒ¼ã®å ´åˆ: ãƒ­ãƒ¼ã‚«ãƒ«ã§æ§‹é€ ã‚’ä½œæˆ
    print(f"ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã§{formula}ã®æ§‹é€ ã‚’ä½œæˆã—ã¾ã™")

    if formula == "Si":
        # ã‚·ãƒªã‚³ãƒ³ï¼ˆãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼‰
        a = 5.431
        lattice = Lattice.cubic(a)
        species = ["Si"] * 8
        coords = [
            [0.00, 0.00, 0.00], [0.50, 0.50, 0.00],
            [0.50, 0.00, 0.50], [0.00, 0.50, 0.50],
            [0.25, 0.25, 0.25], [0.75, 0.75, 0.25],
            [0.75, 0.25, 0.75], [0.25, 0.75, 0.75],
        ]
        structure = Structure(lattice, species, coords)
        properties = {
            'formula': 'Si',
            'material_id': 'local',
            'energy_per_atom': 'N/A',
            'band_gap': 1.12,  # eVï¼ˆå®Ÿæ¸¬å€¤ï¼‰
            'density': structure.density,
            'space_group': 'Fd-3m (227)',
        }

    elif formula == "Fe":
        # é‰„ï¼ˆBCCæ§‹é€ ï¼‰
        a = 2.866
        lattice = Lattice.cubic(a)
        species = ["Fe"] * 2
        coords = [[0, 0, 0], [0.5, 0.5, 0.5]]
        structure = Structure(lattice, species, coords)
        properties = {
            'formula': 'Fe',
            'material_id': 'local',
            'energy_per_atom': 'N/A',
            'band_gap': 0.0,  # é‡‘å±
            'density': structure.density,
            'space_group': 'Im-3m (229)',
        }

    elif formula == "Al2O3":
        # ã‚¢ãƒ«ãƒŸãƒŠï¼ˆã‚³ãƒ©ãƒ³ãƒ€ãƒ æ§‹é€ ã€ç°¡ç•¥åŒ–ï¼‰
        a = 4.759
        c = 12.991
        lattice = Lattice.hexagonal(a, c)
        # ç°¡ç•¥åŒ–ã®ãŸã‚ã€åŸºæœ¬çš„ãªåŸå­ä½ç½®ã®ã¿
        species = ["Al", "Al", "O", "O", "O"]
        coords = [
            [0.0, 0.0, 0.352],
            [0.0, 0.0, 0.148],
            [0.306, 0.0, 0.25],
            [0.0, 0.306, 0.25],
            [0.694, 0.694, 0.25],
        ]
        structure = Structure(lattice, species, coords)
        properties = {
            'formula': 'Al2O3',
            'material_id': 'local',
            'energy_per_atom': 'N/A',
            'band_gap': 8.8,  # eVï¼ˆå®Ÿæ¸¬å€¤ï¼‰
            'density': structure.density,
            'space_group': 'R-3c (167)',
        }

    else:
        print(f"ã‚¨ãƒ©ãƒ¼: {formula}ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‡ãƒ¼ã‚¿ã«ã‚ã‚Šã¾ã›ã‚“")
        return None, None

    return structure, properties


# ä½¿ç”¨ä¾‹
print("="*70)
print("Materials Projectã‹ã‚‰ææ–™ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—")
print("="*70)

# APIã‚­ãƒ¼ã‚’è¨­å®šï¼ˆæŒã£ã¦ã„ã‚‹å ´åˆï¼‰
# API_KEY = "your_api_key_here"  # è‡ªåˆ†ã®APIã‚­ãƒ¼ã«ç½®ãæ›ãˆ
API_KEY = None  # APIã‚­ãƒ¼ãŒãªã„å ´åˆ

# è¤‡æ•°ã®ææ–™ã‚’å–å¾—
materials = ["Si", "Fe", "Al2O3"]

for formula in materials:
    print(f"\n{'='*70}")
    print(f"ã€{formula}ã€‘")
    print('='*70)

    structure, props = get_material_from_mp(formula, api_key=API_KEY)

    if structure is None:
        continue

    # æ§‹é€ æƒ…å ±ã‚’è¡¨ç¤º
    print(f"\nçµ„æˆå¼: {props['formula']}")
    print(f"Material ID: {props['material_id']}")
    print(f"ç©ºé–“ç¾¤: {props['space_group']}")
    print(f"ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: {props['band_gap']} eV")
    print(f"å¯†åº¦: {props['density']:.4f} g/cmÂ³")

    if props['energy_per_atom'] != 'N/A':
        print(f"åŸå­ã‚ãŸã‚Šã®ã‚¨ãƒãƒ«ã‚®ãƒ¼: {props['energy_per_atom']:.4f} eV/atom")

    # æ ¼å­æƒ…å ±
    lattice = structure.lattice
    print(f"\næ ¼å­å®šæ•°:")
    print(f"  a = {lattice.a:.4f} Ã…")
    print(f"  b = {lattice.b:.4f} Ã…")
    print(f"  c = {lattice.c:.4f} Ã…")
    print(f"æ ¼å­ä½“ç©: {lattice.volume:.4f} Ã…Â³")

    # åŸå­æ•°
    print(f"\nå˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: {structure.num_sites}")

    # åŸå­ã®å†…è¨³
    composition = structure.composition
    print(f"åŸå­çµ„æˆ:")
    for element, count in composition.items():
        print(f"  {element}: {count}")

print("\n" + "="*70)
print("Materials Projectã®æ´»ç”¨:")
print("- 140,000ä»¥ä¸Šã®ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹")
print("- ç¬¬ä¸€åŸç†è¨ˆç®—ã«åŸºã¥ãé«˜ç²¾åº¦ãƒ‡ãƒ¼ã‚¿")
print("- ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã€ç”Ÿæˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãªã©ã®ç‰©æ€§å€¤")
print("- pymatgenã§ç°¡å˜ã«ãƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»è§£æ")
print("\nAPIã‚­ãƒ¼å–å¾—: https://materialsproject.org/")
</code></pre>

        <p><strong>è§£èª¬</strong>: Materials Project APIã‚’ä½¿ã†ã¨ã€è†¨å¤§ãªææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å¿…è¦ãªææ–™ã®çµæ™¶æ§‹é€ ã‚„ç‰©æ€§å€¤ã‚’å–å¾—ã§ãã¾ã™ã€‚APIã‚­ãƒ¼ãŒãªã„å ´åˆã§ã‚‚ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ä¸»è¦ãªææ–™ã®æ§‹é€ ã‚’ä½œæˆã§ãã¾ã™ã€‚å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€APIã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§åŠ¹ç‡çš„ã«ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã§ãã¾ã™ã€‚</p>

        <hr>

        <h2>5.4 ã‚±ãƒ¼ã‚¹ã‚¹ã‚¿ãƒ‡ã‚£ï¼šä»£è¡¨çš„ææ–™ã®æ§‹é€ è§£æ</h2>

        <h3>è§£æå¯¾è±¡ææ–™</h3>

        <p>3ã¤ã®é‡è¦ãªææ–™ã®çµæ™¶æ§‹é€ ã‚’è©³ç´°ã«è§£æã—ã¾ã™ï¼š</p>
        <ul>
            <li><strong>ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰</strong>: åŠå°ä½“ææ–™ã®ä»£è¡¨</li>
            <li><strong>é‰„ï¼ˆFeï¼‰</strong>: æ§‹é€ ææ–™ã®åŸºæœ¬</li>
            <li><strong>ã‚¢ãƒ«ãƒŸãƒŠï¼ˆAlâ‚‚Oâ‚ƒï¼‰</strong>: ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ææ–™ã®ä»£è¡¨</li>
        </ul>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: è¤‡æ•°ææ–™ã®çµæ™¶æ§‹é€ æ¯”è¼ƒï¼ˆSi, Fe, Alâ‚‚Oâ‚ƒï¼‰</h3>

        <p>3ã¤ã®ææ–™ã®çµæ™¶æ§‹é€ ã‚’ä½œæˆã—ã€ç‰¹æ€§ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">from pymatgen.core import Structure, Lattice
from pymatgen.symmetry.analyzer import SpacegroupAnalyzer
import matplotlib.pyplot as plt
import numpy as np

def create_material_structures():
    """
    Si, Fe, Al2O3ã®æ§‹é€ ã‚’ä½œæˆã—ã€ç‰¹æ€§ã‚’æ¯”è¼ƒ
    """
    structures = {}

    # 1. ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰- ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ 
    a_si = 5.431  # Ã…
    lattice_si = Lattice.cubic(a_si)
    species_si = ["Si"] * 8
    coords_si = [
        [0.00, 0.00, 0.00], [0.50, 0.50, 0.00],
        [0.50, 0.00, 0.50], [0.00, 0.50, 0.50],
        [0.25, 0.25, 0.25], [0.75, 0.75, 0.25],
        [0.75, 0.25, 0.75], [0.25, 0.75, 0.75],
    ]
    structure_si = Structure(lattice_si, species_si, coords_si)

    # 2. é‰„ï¼ˆFeï¼‰- BCCæ§‹é€ 
    a_fe = 2.866  # Ã…
    lattice_fe = Lattice.cubic(a_fe)
    species_fe = ["Fe"] * 2
    coords_fe = [[0, 0, 0], [0.5, 0.5, 0.5]]
    structure_fe = Structure(lattice_fe, species_fe, coords_fe)

    # 3. ã‚¢ãƒ«ãƒŸãƒŠï¼ˆAl2O3ï¼‰- ã‚³ãƒ©ãƒ³ãƒ€ãƒ æ§‹é€ ï¼ˆå…­æ–¹æ™¶ç³»ï¼‰
    a_al2o3 = 4.759  # Ã…
    c_al2o3 = 12.991  # Ã…
    lattice_al2o3 = Lattice.hexagonal(a_al2o3, c_al2o3)

    # ã‚³ãƒ©ãƒ³ãƒ€ãƒ æ§‹é€ ã®åŸå­ä½ç½®ï¼ˆç°¡ç•¥ç‰ˆï¼‰
    species_al2o3 = ["Al"] * 4 + ["O"] * 6
    coords_al2o3 = [
        # AlåŸå­
        [0.0, 0.0, 0.352],
        [0.667, 0.333, 0.019],
        [0.333, 0.667, 0.685],
        [0.0, 0.0, 0.148],
        # OåŸå­
        [0.306, 0.0, 0.25],
        [0.0, 0.306, 0.25],
        [0.694, 0.694, 0.25],
        [0.973, 0.639, 0.917],
        [0.361, 0.333, 0.917],
        [0.639, 0.0, 0.583],
    ]
    structure_al2o3 = Structure(lattice_al2o3, species_al2o3, coords_al2o3)

    structures = {
        'Si': structure_si,
        'Fe': structure_fe,
        'Al2O3': structure_al2o3
    }

    return structures


def analyze_structure(name, structure):
    """
    çµæ™¶æ§‹é€ ã®è©³ç´°ãªè§£æ
    """
    print(f"\n{'='*70}")
    print(f"ã€{name}ã®çµæ™¶æ§‹é€ è§£æã€‘")
    print('='*70)

    # åŸºæœ¬æƒ…å ±
    print(f"\nçµ„æˆå¼: {structure.composition.reduced_formula}")
    print(f"åŒ–å­¦å¼ï¼ˆHillè¡¨è¨˜ï¼‰: {structure.composition.hill_formula}")
    print(f"å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: {structure.num_sites}")
    print(f"å¯†åº¦: {structure.density:.4f} g/cmÂ³")

    # æ ¼å­æƒ…å ±
    lattice = structure.lattice
    print(f"\nã€æ ¼å­æƒ…å ±ã€‘")
    print(f"æ ¼å­å®šæ•°:")
    print(f"  a = {lattice.a:.4f} Ã…")
    print(f"  b = {lattice.b:.4f} Ã…")
    print(f"  c = {lattice.c:.4f} Ã…")
    print(f"æ ¼å­è§’:")
    print(f"  Î± = {lattice.alpha:.2f}Â°")
    print(f"  Î² = {lattice.beta:.2f}Â°")
    print(f"  Î³ = {lattice.gamma:.2f}Â°")
    print(f"æ ¼å­ä½“ç©: {lattice.volume:.4f} Ã…Â³")

    # å¯¾ç§°æ€§è§£æ
    try:
        sga = SpacegroupAnalyzer(structure)
        print(f"\nã€å¯¾ç§°æ€§æƒ…å ±ã€‘")
        print(f"ç©ºé–“ç¾¤è¨˜å·: {sga.get_space_group_symbol()}")
        print(f"ç©ºé–“ç¾¤ç•ªå·: {sga.get_space_group_number()}")
        print(f"ç‚¹ç¾¤: {sga.get_point_group_symbol()}")
        print(f"çµæ™¶ç³»: {sga.get_crystal_system()}")
    except:
        print("\nå¯¾ç§°æ€§è§£æã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")

    # æœ€è¿‘æ¥è·é›¢ã¨é…ä½æ•°
    print(f"\nã€å¹¾ä½•å­¦çš„æƒ…å ±ã€‘")

    # ã™ã¹ã¦ã®åŸå­ãƒšã‚¢ã®è·é›¢ã‚’è¨ˆç®—
    all_distances = []
    for i in range(len(structure)):
        for j in range(i+1, len(structure)):
            dist = structure.get_distance(i, j)
            all_distances.append(dist)

    if all_distances:
        min_dist = min(all_distances)
        print(f"æœ€è¿‘æ¥åŸå­é–“è·é›¢: {min_dist:.4f} Ã…")

        # é…ä½æ•°ï¼ˆæœ€åˆã®åŸå­ã«ã¤ã„ã¦ï¼‰
        neighbors = structure.get_neighbors(structure[0], r=min_dist * 1.2)
        print(f"é…ä½æ•°ï¼ˆä»£è¡¨ä¾‹ï¼‰: {len(neighbors)}")

    # åŸå­çµ„æˆã®å†…è¨³
    print(f"\nã€åŸå­çµ„æˆã€‘")
    composition = structure.composition
    for element, count in composition.items():
        atomic_percent = (count / structure.num_sites) * 100
        print(f"  {element}: {count} åŸå­ï¼ˆ{atomic_percent:.1f}%ï¼‰")

    # å……å¡«ç‡ã®æ¨å®šï¼ˆç°¡æ˜“ç‰ˆï¼‰
    print(f"\nã€å……å¡«ç‡ã®æ¨å®šã€‘")
    # åŸå­åŠå¾„ã®æ¨å®šå€¤ï¼ˆÃ…ï¼‰
    atomic_radii = {
        'Si': 1.17,
        'Fe': 1.26,
        'Al': 1.43,
        'O': 0.66
    }

    total_atomic_volume = 0
    for element, count in composition.items():
        if str(element) in atomic_radii:
            r = atomic_radii[str(element)]
            atomic_vol = (4/3) * np.pi * r**3
            total_atomic_volume += atomic_vol * count

    cell_volume = lattice.volume
    packing_fraction = total_atomic_volume / cell_volume

    print(f"åŸå­ã®ç·ä½“ç©: {total_atomic_volume:.4f} Å²")
    print(f"å˜ä½æ ¼å­ä½“ç©: {cell_volume:.4f} Å²")
    print(f"æ¨å®šå……å¡«ç‡: {packing_fraction:.4f} ({packing_fraction*100:.2f}%)")

    return {
        'density': structure.density,
        'volume': lattice.volume,
        'num_atoms': structure.num_sites,
        'packing_fraction': packing_fraction,
        'min_distance': min_dist if all_distances else 0,
    }


# æ§‹é€ ã‚’ä½œæˆ
structures = create_material_structures()

# å„ææ–™ã‚’è§£æ
analysis_results = {}
for name, structure in structures.items():
    results = analyze_structure(name, structure)
    analysis_results[name] = results

# æ¯”è¼ƒãƒ—ãƒ­ãƒƒãƒˆ
print("\n" + "="*70)
print("ææ–™ç‰¹æ€§ã®æ¯”è¼ƒã‚°ãƒ©ãƒ•ã‚’ä½œæˆä¸­...")
print("="*70)

materials = list(analysis_results.keys())
densities = [analysis_results[m]['density'] for m in materials]
volumes = [analysis_results[m]['volume'] for m in materials]
num_atoms = [analysis_results[m]['num_atoms'] for m in materials]
packing_fractions = [analysis_results[m]['packing_fraction'] for m in materials]

fig, axes = plt.subplots(2, 2, figsize=(14, 10))

colors = ['#b8b8d0', '#e06633', '#808080']

# å¯†åº¦ã®æ¯”è¼ƒ
ax1 = axes[0, 0]
bars1 = ax1.bar(materials, densities, color=colors, edgecolor='black', linewidth=1.5, alpha=0.7)
ax1.set_ylabel('å¯†åº¦ (g/cmÂ³)', fontsize=12, fontweight='bold')
ax1.set_title('å¯†åº¦ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
ax1.grid(axis='y', alpha=0.3)
for bar, val in zip(bars1, densities):
    ax1.text(bar.get_x() + bar.get_width()/2, val + 0.2,
            f'{val:.2f}', ha='center', fontsize=11, fontweight='bold')

# å˜ä½æ ¼å­ä½“ç©ã®æ¯”è¼ƒ
ax2 = axes[0, 1]
bars2 = ax2.bar(materials, volumes, color=colors, edgecolor='black', linewidth=1.5, alpha=0.7)
ax2.set_ylabel('å˜ä½æ ¼å­ä½“ç© (Å³)', fontsize=12, fontweight='bold')
ax2.set_title('å˜ä½æ ¼å­ä½“ç©ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
ax2.grid(axis='y', alpha=0.3)
for bar, val in zip(bars2, volumes):
    ax2.text(bar.get_x() + bar.get_width()/2, val + 5,
            f'{val:.1f}', ha='center', fontsize=11, fontweight='bold')

# å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°
ax3 = axes[1, 0]
bars3 = ax3.bar(materials, num_atoms, color=colors, edgecolor='black', linewidth=1.5, alpha=0.7)
ax3.set_ylabel('åŸå­æ•°', fontsize=12, fontweight='bold')
ax3.set_title('å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°', fontsize=13, fontweight='bold')
ax3.grid(axis='y', alpha=0.3)
for bar, val in zip(bars3, num_atoms):
    ax3.text(bar.get_x() + bar.get_width()/2, val + 0.2,
            f'{val}', ha='center', fontsize=11, fontweight='bold')

# å……å¡«ç‡
ax4 = axes[1, 1]
bars4 = ax4.bar(materials, [pf*100 for pf in packing_fractions],
               color=colors, edgecolor='black', linewidth=1.5, alpha=0.7)
ax4.set_ylabel('å……å¡«ç‡ (%)', fontsize=12, fontweight='bold')
ax4.set_title('æ¨å®šå……å¡«ç‡ã®æ¯”è¼ƒ', fontsize=13, fontweight='bold')
ax4.grid(axis='y', alpha=0.3)
for bar, val in zip(bars4, packing_fractions):
    ax4.text(bar.get_x() + bar.get_width()/2, val*100 + 1,
            f'{val*100:.1f}%', ha='center', fontsize=11, fontweight='bold')

plt.suptitle('ä»£è¡¨çš„ææ–™ã®çµæ™¶æ§‹é€ æ¯”è¼ƒï¼ˆSi, Fe, Alâ‚‚Oâ‚ƒï¼‰',
            fontsize=15, fontweight='bold', y=0.995)
plt.tight_layout()
plt.show()

print("\n" + "="*70)
print("æ¯”è¼ƒã®ã¾ã¨ã‚:")
print("="*70)
print("\nã€ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰ã€‘")
print("- ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼ˆç«‹æ–¹æ™¶ç³»ï¼‰")
print("- åŠå°ä½“ææ–™ï¼ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— 1.12 eVï¼‰")
print("- é…ä½æ•°4ï¼ˆå…±æœ‰çµåˆæ€§ï¼‰")
print("- é›†ç©å›è·¯ã€å¤ªé™½é›»æ± ã«ä½¿ç”¨")

print("\nã€é‰„ï¼ˆFeï¼‰ã€‘")
print("- BCCæ§‹é€ ï¼ˆç«‹æ–¹æ™¶ç³»ï¼‰")
print("- é‡‘å±ï¼ˆå°ä½“ï¼‰")
print("- é…ä½æ•°8")
print("- æ§‹é€ ææ–™ã®åŸºæœ¬ï¼ˆé‹¼ã®ä¸»æˆåˆ†ï¼‰")

print("\nã€ã‚¢ãƒ«ãƒŸãƒŠï¼ˆAlâ‚‚Oâ‚ƒï¼‰ã€‘")
print("- ã‚³ãƒ©ãƒ³ãƒ€ãƒ æ§‹é€ ï¼ˆå…­æ–¹æ™¶ç³»ï¼‰")
print("- çµ¶ç¸ä½“ï¼ˆãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— 8.8 eVï¼‰")
print("- é«˜ç¡¬åº¦ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹")
print("- è€æ‘©è€—ææ–™ã€ç ”ç£¨æã€çµ¶ç¸æã«ä½¿ç”¨")
</code></pre>

        <p><strong>è§£èª¬</strong>: pymatgenã‚’ä½¿ã†ã¨ã€ç•°ãªã‚‹çµæ™¶ç³»ï¼ˆç«‹æ–¹æ™¶ã€å…­æ–¹æ™¶ï¼‰ã®ææ–™ã‚’çµ±ä¸€çš„ã«æ‰±ãˆã¾ã™ã€‚å¯†åº¦ã€æ ¼å­ä½“ç©ã€å……å¡«ç‡ãªã©ã‚’è¨ˆç®—ãƒ»æ¯”è¼ƒã™ã‚‹ã“ã¨ã§ã€ææ–™ç‰¹æ€§ã®é•ã„ãŒå®šé‡çš„ã«ç†è§£ã§ãã¾ã™ã€‚</p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: ç·åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆæ§‹é€ èª­ã¿è¾¼ã¿â†’è§£æâ†’å¯è¦–åŒ–â†’ç‰¹æ€§äºˆæ¸¬ï¼‰</h3>

        <p>pymatgenã‚’ä½¿ã£ãŸææ–™è§£æã®ç·åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">from pymatgen.core import Structure, Lattice
from pymatgen.symmetry.analyzer import SpacegroupAnalyzer
from pymatgen.analysis.structure_matcher import StructureMatcher
import matplotlib.pyplot as plt
import numpy as np

class MaterialAnalysisPipeline:
    """
    ææ–™è§£æã®ç·åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè¡Œã™ã‚‹ã‚¯ãƒ©ã‚¹
    """

    def __init__(self, structure, material_name="Unknown"):
        """
        Parameters:
        structure: pymatgen Structure object
        material_name: ææ–™å
        """
        self.structure = structure
        self.material_name = material_name
        self.analysis_results = {}

    def step1_basic_info(self):
        """
        ã‚¹ãƒ†ãƒƒãƒ—1: åŸºæœ¬æƒ…å ±ã®æŠ½å‡º
        """
        print(f"\n{'='*70}")
        print(f"ã‚¹ãƒ†ãƒƒãƒ—1: åŸºæœ¬æƒ…å ±ã®æŠ½å‡ºã€{self.material_name}ã€‘")
        print('='*70)

        s = self.structure
        lattice = s.lattice

        self.analysis_results['basic'] = {
            'formula': s.composition.reduced_formula,
            'num_sites': s.num_sites,
            'density': s.density,
            'volume': lattice.volume,
            'lattice_a': lattice.a,
            'lattice_b': lattice.b,
            'lattice_c': lattice.c,
        }

        print(f"çµ„æˆå¼: {self.analysis_results['basic']['formula']}")
        print(f"åŸå­æ•°: {self.analysis_results['basic']['num_sites']}")
        print(f"å¯†åº¦: {self.analysis_results['basic']['density']:.4f} g/cmÂ³")
        print(f"æ ¼å­ä½“ç©: {self.analysis_results['basic']['volume']:.4f} Å³")

        return self.analysis_results['basic']

    def step2_symmetry_analysis(self):
        """
        ã‚¹ãƒ†ãƒƒãƒ—2: å¯¾ç§°æ€§ã®è§£æ
        """
        print(f"\n{'='*70}")
        print(f"ã‚¹ãƒ†ãƒƒãƒ—2: å¯¾ç§°æ€§ã®è§£æ")
        print('='*70)

        try:
            sga = SpacegroupAnalyzer(self.structure)

            self.analysis_results['symmetry'] = {
                'space_group_symbol': sga.get_space_group_symbol(),
                'space_group_number': sga.get_space_group_number(),
                'point_group': sga.get_point_group_symbol(),
                'crystal_system': sga.get_crystal_system(),
            }

            print(f"ç©ºé–“ç¾¤: {self.analysis_results['symmetry']['space_group_symbol']} "
                  f"(No. {self.analysis_results['symmetry']['space_group_number']})")
            print(f"ç‚¹ç¾¤: {self.analysis_results['symmetry']['point_group']}")
            print(f"çµæ™¶ç³»: {self.analysis_results['symmetry']['crystal_system']}")

        except Exception as e:
            print(f"å¯¾ç§°æ€§è§£æã§ã‚¨ãƒ©ãƒ¼: {e}")
            self.analysis_results['symmetry'] = None

        return self.analysis_results['symmetry']

    def step3_geometric_analysis(self):
        """
        ã‚¹ãƒ†ãƒƒãƒ—3: å¹¾ä½•å­¦çš„è§£æï¼ˆè·é›¢ã€é…ä½æ•°ï¼‰
        """
        print(f"\n{'='*70}")
        print(f"ã‚¹ãƒ†ãƒƒãƒ—3: å¹¾ä½•å­¦çš„è§£æ")
        print('='*70)

        # æœ€è¿‘æ¥è·é›¢ã®è¨ˆç®—
        all_distances = []
        for i in range(len(self.structure)):
            for j in range(i+1, len(self.structure)):
                dist = self.structure.get_distance(i, j)
                all_distances.append(dist)

        if all_distances:
            min_dist = min(all_distances)
            avg_dist = np.mean(all_distances)

            # é…ä½æ•°ï¼ˆæœ€åˆã®åŸå­ã«ã¤ã„ã¦ï¼‰
            neighbors = self.structure.get_neighbors(self.structure[0], r=min_dist * 1.2)
            coordination_number = len(neighbors)

            self.analysis_results['geometry'] = {
                'min_distance': min_dist,
                'avg_distance': avg_dist,
                'coordination_number': coordination_number,
            }

            print(f"æœ€è¿‘æ¥åŸå­é–“è·é›¢: {min_dist:.4f} Ã…")
            print(f"å¹³å‡åŸå­é–“è·é›¢: {avg_dist:.4f} Ã…")
            print(f"é…ä½æ•°ï¼ˆä»£è¡¨ä¾‹ï¼‰: {coordination_number}")

        else:
            self.analysis_results['geometry'] = None

        return self.analysis_results['geometry']

    def step4_predict_properties(self):
        """
        ã‚¹ãƒ†ãƒƒãƒ—4: ææ–™ç‰¹æ€§ã®äºˆæ¸¬ï¼ˆçµŒé¨“å‰‡ãƒ™ãƒ¼ã‚¹ï¼‰
        """
        print(f"\n{'='*70}")
        print(f"ã‚¹ãƒ†ãƒƒãƒ—4: ææ–™ç‰¹æ€§ã®äºˆæ¸¬")
        print('='*70)

        predictions = {}

        # å¯†åº¦ã‹ã‚‰æ©Ÿæ¢°çš„æ€§è³ªã‚’æ¨å®šï¼ˆè¶…ç°¡æ˜“ç‰ˆï¼‰
        density = self.analysis_results['basic']['density']

        if density < 3.0:
            material_class = "è»½é‡ææ–™"
            strength_estimate = "ä½ã€œä¸­ç¨‹åº¦"
        elif density < 6.0:
            material_class = "ä¸­é‡é‡ææ–™"
            strength_estimate = "ä¸­ã€œé«˜"
        else:
            material_class = "é‡é‡ææ–™"
            strength_estimate = "é«˜"

        predictions['material_class'] = material_class
        predictions['strength_estimate'] = strength_estimate

        # é…ä½æ•°ã‹ã‚‰çµåˆã®æ€§è³ªã‚’æ¨å®š
        if self.analysis_results['geometry']:
            cn = self.analysis_results['geometry']['coordination_number']

            if cn == 4:
                bonding_type = "å…±æœ‰çµåˆæ€§ï¼ˆãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰å‹ï¼‰"
                expected_properties = "åŠå°ä½“ã€ç¡¬ã„ã€è„†ã„"
            elif cn == 6:
                bonding_type = "ã‚¤ã‚ªãƒ³çµåˆæ€§ã¾ãŸã¯å…«é¢ä½“é…ä½"
                expected_properties = "ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã€ç¡¬ã„ã€çµ¶ç¸ä½“"
            elif cn in [8, 12]:
                bonding_type = "é‡‘å±çµåˆï¼ˆé«˜é…ä½æ•°ï¼‰"
                expected_properties = "é‡‘å±ã€å»¶æ€§ã€å°é›»æ€§"
            else:
                bonding_type = "ä¸æ˜"
                expected_properties = "è©³ç´°è§£æãŒå¿…è¦"

            predictions['bonding_type'] = bonding_type
            predictions['expected_properties'] = expected_properties

        print(f"ææ–™åˆ†é¡: {predictions['material_class']}")
        print(f"æ¨å®šå¼·åº¦: {predictions['strength_estimate']}")

        if 'bonding_type' in predictions:
            print(f"çµåˆã®æ€§è³ª: {predictions['bonding_type']}")
            print(f"æœŸå¾…ã•ã‚Œã‚‹ç‰¹æ€§: {predictions['expected_properties']}")

        self.analysis_results['predictions'] = predictions
        return predictions

    def step5_visualize_summary(self):
        """
        ã‚¹ãƒ†ãƒƒãƒ—5: è§£æçµæœã®å¯è¦–åŒ–
        """
        print(f"\n{'='*70}")
        print(f"ã‚¹ãƒ†ãƒƒãƒ—5: è§£æçµæœã®å¯è¦–åŒ–")
        print('='*70)

        # ã‚µãƒãƒªãƒ¼ãƒ—ãƒ­ãƒƒãƒˆ
        fig, axes = plt.subplots(2, 2, figsize=(12, 10))

        # æ ¼å­ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        ax1 = axes[0, 0]
        lattice_params = [
            self.analysis_results['basic']['lattice_a'],
            self.analysis_results['basic']['lattice_b'],
            self.analysis_results['basic']['lattice_c']
        ]
        ax1.bar(['a', 'b', 'c'], lattice_params, color=['#1f77b4', '#ff7f0e', '#2ca02c'],
               edgecolor='black', linewidth=1.5, alpha=0.7)
        ax1.set_ylabel('æ ¼å­å®šæ•° (Ã…)', fontsize=11, fontweight='bold')
        ax1.set_title('æ ¼å­å®šæ•°', fontsize=12, fontweight='bold')
        ax1.grid(axis='y', alpha=0.3)

        # åŸºæœ¬ç‰¹æ€§
        ax2 = axes[0, 1]
        properties = ['åŸå­æ•°', 'å¯†åº¦\n(g/cmÂ³)', 'ä½“ç©\n(Å³)']
        values = [
            self.analysis_results['basic']['num_sites'],
            self.analysis_results['basic']['density'],
            self.analysis_results['basic']['volume']
        ]
        ax2.bar(properties, values, color=['#d62728', '#9467bd', '#8c564b'],
               edgecolor='black', linewidth=1.5, alpha=0.7)
        ax2.set_ylabel('å€¤', fontsize=11, fontweight='bold')
        ax2.set_title('åŸºæœ¬ç‰¹æ€§', fontsize=12, fontweight='bold')
        ax2.grid(axis='y', alpha=0.3)

        # å¹¾ä½•å­¦çš„æƒ…å ±
        ax3 = axes[1, 0]
        if self.analysis_results['geometry']:
            geom_labels = ['æœ€è¿‘æ¥è·é›¢\n(Ã…)', 'å¹³å‡è·é›¢\n(Ã…)', 'é…ä½æ•°']
            geom_values = [
                self.analysis_results['geometry']['min_distance'],
                self.analysis_results['geometry']['avg_distance'],
                self.analysis_results['geometry']['coordination_number']
            ]
            ax3.bar(geom_labels, geom_values, color=['#e377c2', '#7f7f7f', '#bcbd22'],
                   edgecolor='black', linewidth=1.5, alpha=0.7)
            ax3.set_ylabel('å€¤', fontsize=11, fontweight='bold')
            ax3.set_title('å¹¾ä½•å­¦çš„æƒ…å ±', fontsize=12, fontweight='bold')
            ax3.grid(axis='y', alpha=0.3)

        # ã‚µãƒãƒªãƒ¼ãƒ†ã‚­ã‚¹ãƒˆ
        ax4 = axes[1, 1]
        ax4.axis('off')

        summary_text = f"ã€{self.material_name} è§£æã‚µãƒãƒªãƒ¼ã€‘\n\n"
        summary_text += f"çµ„æˆå¼: {self.analysis_results['basic']['formula']}\n"

        if self.analysis_results['symmetry']:
            summary_text += f"ç©ºé–“ç¾¤: {self.analysis_results['symmetry']['space_group_symbol']}\n"
            summary_text += f"çµæ™¶ç³»: {self.analysis_results['symmetry']['crystal_system']}\n"

        summary_text += f"\nå¯†åº¦: {self.analysis_results['basic']['density']:.4f} g/cmÂ³\n"
        summary_text += f"å˜ä½æ ¼å­ä½“ç©: {self.analysis_results['basic']['volume']:.2f} Å³\n"

        if self.analysis_results['geometry']:
            summary_text += f"\né…ä½æ•°: {self.analysis_results['geometry']['coordination_number']}\n"

        if self.analysis_results['predictions']:
            summary_text += f"\nã€äºˆæ¸¬ã•ã‚Œã‚‹ç‰¹æ€§ã€‘\n"
            summary_text += f"{self.analysis_results['predictions']['material_class']}\n"
            if 'expected_properties' in self.analysis_results['predictions']:
                summary_text += f"{self.analysis_results['predictions']['expected_properties']}\n"

        ax4.text(0.1, 0.9, summary_text, fontsize=11, verticalalignment='top',
                fontfamily='monospace',
                bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.3))

        plt.suptitle(f'{self.material_name} æ§‹é€ è§£æçµæœ',
                    fontsize=14, fontweight='bold')
        plt.tight_layout()
        plt.show()

    def run_full_pipeline(self):
        """
        å…¨ã‚¹ãƒ†ãƒƒãƒ—ã‚’å®Ÿè¡Œ
        """
        print(f"\n{'#'*70}")
        print(f"#  ææ–™è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³é–‹å§‹: {self.material_name}")
        print(f"{'#'*70}")

        self.step1_basic_info()
        self.step2_symmetry_analysis()
        self.step3_geometric_analysis()
        self.step4_predict_properties()
        self.step5_visualize_summary()

        print(f"\n{'#'*70}")
        print(f"#  è§£æå®Œäº†: {self.material_name}")
        print(f"{'#'*70}\n")

        return self.analysis_results


# ä½¿ç”¨ä¾‹: ã‚·ãƒªã‚³ãƒ³ã®è§£æ
a_si = 5.431
lattice_si = Lattice.cubic(a_si)
species_si = ["Si"] * 8
coords_si = [
    [0.00, 0.00, 0.00], [0.50, 0.50, 0.00],
    [0.50, 0.00, 0.50], [0.00, 0.50, 0.50],
    [0.25, 0.25, 0.25], [0.75, 0.75, 0.25],
    [0.75, 0.25, 0.75], [0.25, 0.75, 0.75],
]
structure_si = Structure(lattice_si, species_si, coords_si)

# ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å®Ÿè¡Œ
pipeline = MaterialAnalysisPipeline(structure_si, material_name="ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰")
results = pipeline.run_full_pipeline()

print("\n" + "="*70)
print("ç·åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®åˆ©ç‚¹:")
print("="*70)
print("- ç³»çµ±çš„ãªè§£æï¼ˆåŸºæœ¬â†’å¯¾ç§°æ€§â†’å¹¾ä½•å­¦â†’äºˆæ¸¬â†’å¯è¦–åŒ–ï¼‰")
print("- å†ç¾å¯èƒ½ãªæ‰‹é †")
print("- è¤‡æ•°ã®ææ–™ã«åŒã˜æ‰‹æ³•ã‚’é©ç”¨å¯èƒ½")
print("- çµæœã‚’è‡ªå‹•çš„ã«å¯è¦–åŒ–")
print("- çµŒé¨“å‰‡ã«åŸºã¥ãç‰¹æ€§äºˆæ¸¬")
</code></pre>

        <p><strong>è§£èª¬</strong>: ç·åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ã§ã€ææ–™è§£æã‚’ç³»çµ±çš„ã‹ã¤åŠ¹ç‡çš„ã«å®Ÿè¡Œã§ãã¾ã™ã€‚åŸºæœ¬æƒ…å ±ã®æŠ½å‡ºã‹ã‚‰å¯¾ç§°æ€§è§£æã€å¹¾ä½•å­¦çš„è§£æã€ç‰¹æ€§äºˆæ¸¬ã€å¯è¦–åŒ–ã¾ã§ã€ä¸€é€£ã®æµã‚Œã‚’è‡ªå‹•åŒ–ã§ãã¾ã™ã€‚ã“ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€æ–°ã—ã„ææ–™ã«å¯¾ã—ã¦ã‚‚åŒæ§˜ã«é©ç”¨ã§ãã¾ã™ã€‚</p>

        <hr>

        <h2>5.5 ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2>

        <h3>ã‚ˆãã‚ã‚‹ã‚¨ãƒ©ãƒ¼ã¨è§£æ±ºæ³•</h3>

        <div class="warning-box">
            <h4>âš ï¸ ImportError: No module named 'pymatgen'</h4>
            <p><strong>åŸå› </strong>: pymatgenãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ãªã„</p>
            <p><strong>è§£æ±ºæ³•</strong>:</p>
            <pre><code class="language-bash">pip install pymatgen</code></pre>
        </div>

        <div class="warning-box">
            <h4>âš ï¸ ValueError: The reduced_formula could not be parsed</h4>
            <p><strong>åŸå› </strong>: åŒ–å­¦å¼ã®è¡¨è¨˜ãŒä¸æ­£</p>
            <p><strong>è§£æ±ºæ³•</strong>: åŒ–å­¦å¼ã¯æ­£ã—ã„è¡¨è¨˜ï¼ˆä¾‹: "Al2O3"ã€"SiO2"ï¼‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„</p>
        </div>

        <div class="warning-box">
            <h4>âš ï¸ MPRestError: API key is not set</h4>
            <p><strong>åŸå› </strong>: Materials Project APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„</p>
            <p><strong>è§£æ±ºæ³•</strong>:</p>
            <ol>
                <li><a href="https://materialsproject.org/" target="_blank">Materials Project</a>ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ</li>
                <li>APIã‚­ãƒ¼ã‚’å–å¾—</li>
                <li>ã‚³ãƒ¼ãƒ‰ã§è¨­å®š: <code>MPRester("your_api_key")</code></li>
            </ol>
        </div>

        <div class="warning-box">
            <h4>âš ï¸ å¯è¦–åŒ–ãŒè¡¨ç¤ºã•ã‚Œãªã„</h4>
            <p><strong>åŸå› </strong>: matplotlibã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰è¨­å®š</p>
            <p><strong>è§£æ±ºæ³•</strong>:</p>
            <pre><code class="language-python">import matplotlib
matplotlib.use('TkAgg')  # ã¾ãŸã¯Qt5Agg
import matplotlib.pyplot as plt</code></pre>
        </div>

        <hr>

        <h2>5.6 æœ¬ç« ã®ã¾ã¨ã‚</h2>

        <h3>å­¦ã‚“ã ã“ã¨</h3>

        <ol>
            <li><strong>pymatgenã®åŸºç¤</strong>
                <ul>
                    <li>Latticeã¨Structureã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ</li>
                    <li>åˆ†æ•°åº§æ¨™ã¨ãƒ‡ã‚«ãƒ«ãƒˆåº§æ¨™ã®æ‰±ã„</li>
                    <li>å¯†åº¦ã€è·é›¢ã€é…ä½æ•°ãªã©ã®è‡ªå‹•è¨ˆç®—</li>
                </ul>
            </li>
            <li><strong>CIFãƒ•ã‚¡ã‚¤ãƒ«ã®æ´»ç”¨</strong>
                <ul>
                    <li>æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã®æ§‹é€ ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿æ›¸ã</li>
                    <li>æ ¼å­å®šæ•°ã€ç©ºé–“ç¾¤ã€åŸå­ä½ç½®ã®æŠ½å‡º</li>
                    <li>å¯¾ç§°æ€§è§£æï¼ˆSpacegroupAnalyzerï¼‰</li>
                </ul>
            </li>
            <li><strong>3Då¯è¦–åŒ–</strong>
                <ul>
                    <li>matplotlibã«ã‚ˆã‚‹çµæ™¶æ§‹é€ ã®3Dãƒ—ãƒ­ãƒƒãƒˆ</li>
                    <li>ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ã§ã®å‘¨æœŸæ§‹é€ ã®è¡¨ç¤º</li>
                    <li>åŸå­ã¨çµåˆã®å¯è¦–åŒ–</li>
                </ul>
            </li>
            <li><strong>Materials Projectã®æ´»ç”¨</strong>
                <ul>
                    <li>140,000ä»¥ä¸Šã®ææ–™ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹</li>
                    <li>APIçµŒç”±ã§ã®ææ–™ãƒ‡ãƒ¼ã‚¿å–å¾—</li>
                    <li>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã€ç”Ÿæˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãªã©ã®ç‰©æ€§å€¤</li>
                </ul>
            </li>
            <li><strong>å®Ÿè·µçš„ãªææ–™è§£æ</strong>
                <ul>
                    <li>Si, Fe, Alâ‚‚Oâ‚ƒã®æ§‹é€ æ¯”è¼ƒ</li>
                    <li>ç·åˆãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆæ§‹é€ â†’è§£æâ†’å¯è¦–åŒ–â†’äºˆæ¸¬ï¼‰</li>
                    <li>çµŒé¨“å‰‡ã«åŸºã¥ãç‰¹æ€§äºˆæ¸¬</li>
                </ul>
            </li>
        </ol>

        <h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

        <ul>
            <li>pymatgenã¯ææ–™ç§‘å­¦ã®ãŸã‚ã®<strong>åŒ…æ‹¬çš„ãªPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒª</strong></li>
            <li>çµæ™¶æ§‹é€ ã®ä½œæˆãƒ»æ“ä½œãƒ»è§£æãŒæ•°è¡Œã§å¯èƒ½</li>
            <li>CIFãƒ•ã‚¡ã‚¤ãƒ«ã¯çµæ™¶æ§‹é€ ã®æ¨™æº–ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ</li>
            <li>Materials Projectã¯ç¬¬ä¸€åŸç†è¨ˆç®—ã«åŸºã¥ãé«˜ç²¾åº¦ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</li>
            <li>ç³»çµ±çš„ãªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§åŠ¹ç‡çš„ãªææ–™è§£æãŒå¯èƒ½</li>
        </ul>

        <h3>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>

        <p>ã“ã®ææ–™ç§‘å­¦å…¥é–€ã‚·ãƒªãƒ¼ã‚ºã‚’å®Œäº†ã—ã¾ã—ãŸã€‚ä»Šå¾Œã®å­¦ç¿’ã¨ã—ã¦ï¼š</p>
        <ul>
            <li><strong>é›»å­æ§‹é€ è¨ˆç®—</strong>: VASP, Quantum Espressoãªã©ã®ç¬¬ä¸€åŸç†è¨ˆç®—ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢</li>
            <li><strong>æ©Ÿæ¢°å­¦ç¿’ã¨ã®èåˆ</strong>: Materials Informaticsã«ã‚ˆã‚‹ææ–™æ¢ç´¢</li>
            <li><strong>çŠ¶æ…‹å›³ã®ä½œæˆ</strong>: pymatgenã®Phase Diagramæ©Ÿèƒ½</li>
            <li><strong>æ¬ é™¥è§£æ</strong>: ç‚¹æ¬ é™¥ã€è»¢ä½ã€ç²’ç•Œã®ãƒ¢ãƒ‡ãƒªãƒ³ã‚°</li>
            <li><strong>è¡¨é¢ç§‘å­¦</strong>: è¡¨é¢æ§‹é€ ã¨ã‚¹ãƒ©ãƒ–ãƒ¢ãƒ‡ãƒ«</li>
        </ul>

        <h3>å‚è€ƒè³‡æ–™</h3>

        <ul>
            <li><a href="https://pymatgen.org/" target="_blank">pymatgenå…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ</a></li>
            <li><a href="https://materialsproject.org/" target="_blank">Materials Project</a></li>
            <li><a href="https://www.crystallography.net/cod/" target="_blank">Crystallography Open Database (COD)</a></li>
            <li><a href="https://wiki.materialsproject.org/Getting_Started" target="_blank">Materials Project Wiki</a></li>
        </ul>

        <div class="navigation">
            <a href="chapter-4.html" class="nav-button">â† å‰ã®ç« ï¼šææ–™ã®æ€§è³ªã¨æ§‹é€ ã®é–¢ä¿‚</a>
            <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a>
            <a href="../index.html" class="nav-button">MSçŸ¥è­˜ãƒ™ãƒ¼ã‚¹ãƒˆãƒƒãƒ— â†’</a>
        </div>
    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: MS Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-25</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
