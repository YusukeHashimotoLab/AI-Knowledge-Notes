<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« ï¼šçµæ™¶æ§‹é€ ã®åŸºç¤ - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .breadcrumb {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .breadcrumb a {
            color: var(--color-link);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬3ç« ï¼šçµæ™¶æ§‹é€ ã®åŸºç¤</h1>
            <p class="subtitle">åŸå­ã®è¦å‰‡çš„é…åˆ—ã¨ææ–™ç‰¹æ€§ã®é–¢ä¿‚</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 30-35åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 7å€‹</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">ææ–™ç§‘å­¦å…¥é–€</a> &gt;
        ç¬¬3ç« 
    </div>

    <main class="container">
        <p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); border-left: 4px solid #f093fb; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">
            ææ–™ã®æ€§è³ªã¯ã€åŸå­ãŒã©ã®ã‚ˆã†ã«é…åˆ—ã—ã¦ã„ã‚‹ã‹ã«å¤§ããä¾å­˜ã—ã¾ã™ã€‚ã“ã®ç« ã§ã¯ã€çµæ™¶æ§‹é€ ã®åŸºç¤æ¦‚å¿µã€ä¸»è¦ãªçµæ™¶ç³»ã€ãã—ã¦ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã«ã¤ã„ã¦å­¦ã³ã€Pythonã§çµæ™¶æ§‹é€ ã‚’å¯è¦–åŒ–ã—ã¾ã™ã€‚
        </p>

        <div class="learning-objectives">
            <h2>å­¦ç¿’ç›®æ¨™</h2>
            <p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
            <ul>
                <li>âœ… çµæ™¶ã¨éæ™¶è³ªã®é•ã„ã‚’ç†è§£ã—ã€Xç·šå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‹ã‚‰åˆ¤åˆ¥ã§ãã‚‹</li>
                <li>âœ… å˜ä½æ ¼å­ã¨æ ¼å­å®šæ•°ã®æ¦‚å¿µã‚’ç†è§£ã™ã‚‹</li>
                <li>âœ… ä¸»è¦ãªçµæ™¶æ§‹é€ ï¼ˆFCC, BCC, HCPï¼‰ã®ç‰¹å¾´ã¨ä»£è¡¨ææ–™ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã‚’ä½¿ã£ã¦çµæ™¶é¢ã¨æ–¹å‘ã‚’è¡¨è¨˜ã§ãã‚‹</li>
                <li>âœ… å……å¡«ç‡ã¨é…ä½æ•°ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>âœ… Pythonã§3Dçµæ™¶æ§‹é€ ã‚’å¯è¦–åŒ–ã§ãã‚‹</li>
            </ul>
        </div>

        <hr>

        <h2>3.1 çµæ™¶ã¨éæ™¶è³ª</h2>

        <h3>çµæ™¶æ§‹é€ ã¨ã¯</h3>

        <p><strong>çµæ™¶ï¼ˆCrystalï¼‰</strong>ã¨ã¯ã€åŸå­ãŒ3æ¬¡å…ƒç©ºé–“ã«è¦å‰‡çš„ã‹ã¤å‘¨æœŸçš„ã«é…åˆ—ã—ãŸå›ºä½“ã§ã™ã€‚ä¸€æ–¹ã€<strong>éæ™¶è³ªï¼ˆAmorphousï¼‰</strong>ã¯ã€åŸå­é…åˆ—ã«é•·è·é›¢ç§©åºãŒãªã„å›ºä½“ã§ã™ã€‚</p>

        <table>
            <thead>
                <tr>
                    <th>ç‰¹æ€§</th>
                    <th>çµæ™¶</th>
                    <th>éæ™¶è³ª</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>åŸå­é…åˆ—</strong></td>
                    <td>é•·è·é›¢ç§©åºã‚ã‚Šï¼ˆå‘¨æœŸçš„ï¼‰</td>
                    <td>çŸ­è·é›¢ç§©åºã®ã¿ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>èç‚¹</strong></td>
                    <td>æ˜ç¢ºãªèç‚¹ã‚ã‚Š</td>
                    <td>ã‚¬ãƒ©ã‚¹è»¢ç§»æ¸©åº¦ï¼ˆå¾ã€…ã«è»ŸåŒ–ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>Xç·šå›æŠ˜</strong></td>
                    <td>é‹­ã„ãƒ”ãƒ¼ã‚¯ï¼ˆãƒ–ãƒ©ãƒƒã‚°åå°„ï¼‰</td>
                    <td>ãƒ–ãƒ­ãƒ¼ãƒ‰ãªãƒãƒ­ãƒ¼</td>
                </tr>
                <tr>
                    <td><strong>ç•°æ–¹æ€§</strong></td>
                    <td>æ–¹å‘ã«ã‚ˆã‚Šæ€§è³ªãŒç•°ãªã‚‹</td>
                    <td>ç­‰æ–¹æ€§ï¼ˆå…¨æ–¹å‘ã§åŒã˜ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>ä»£è¡¨ä¾‹</strong></td>
                    <td>é‡‘å±ã€Siã€NaClã€ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰</td>
                    <td>ã‚¬ãƒ©ã‚¹ã€é«˜åˆ†å­ã€ã‚¢ãƒ¢ãƒ«ãƒ•ã‚¡ã‚¹Si</td>
                </tr>
            </tbody>
        </table>

        <h3>Xç·šå›æŠ˜ã«ã‚ˆã‚‹çµæ™¶æ€§ã®è©•ä¾¡</h3>

        <p><strong>Xç·šå›æŠ˜ï¼ˆXRD: X-ray Diffractionï¼‰</strong>ã¯ã€çµæ™¶æ§‹é€ ã‚’è§£æã™ã‚‹æœ€ã‚‚é‡è¦ãªæ‰‹æ³•ã§ã™ã€‚Xç·šãŒçµæ™¶ã«å…¥å°„ã™ã‚‹ã¨ã€åŸå­é…åˆ—ã«ã‚ˆã‚Šç‰¹å®šã®è§’åº¦ã§<strong>ãƒ–ãƒ©ãƒƒã‚°åå°„</strong>ãŒèµ·ã“ã‚Šã¾ã™ã€‚</p>

        <p><strong>ãƒ–ãƒ©ãƒƒã‚°ã®æ³•å‰‡</strong>:</p>

        <p>$$n\lambda = 2d\sin\theta$$</p>

        <p>ã“ã“ã§ã€</p>
        <ul>
            <li>$n$: åå°„æ¬¡æ•°ï¼ˆæ•´æ•°ï¼‰</li>
            <li>$\lambda$: Xç·šã®æ³¢é•·</li>
            <li>$d$: çµæ™¶é¢é–“éš”</li>
            <li>$\theta$: å…¥å°„è§’ï¼ˆãƒ–ãƒ©ãƒƒã‚°è§’ï¼‰</li>
        </ul>

        <p>çµæ™¶æ€§ææ–™ã§ã¯ç‰¹å®šã®è§’åº¦ï¼ˆ$2\theta$ï¼‰ã§å¼·ã„å›æŠ˜ãƒ”ãƒ¼ã‚¯ãŒç¾ã‚Œã€éæ™¶è³ªææ–™ã§ã¯ãƒ–ãƒ­ãƒ¼ãƒ‰ãªãƒãƒ­ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒè¦³å¯Ÿã•ã‚Œã¾ã™ã€‚</p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹1: çµæ™¶ã¨éæ™¶è³ªã®Xç·šå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h3>

        <p>çµæ™¶æ€§ææ–™ã¨éæ™¶è³ªææ–™ã®Xç·šå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®é•ã„ã‚’å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# Xç·šå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
def simulate_crystalline_xrd():
    """
    çµæ™¶æ€§ææ–™ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
    é‹­ã„ãƒ–ãƒ©ãƒƒã‚°ãƒ”ãƒ¼ã‚¯ãŒç‰¹å®šã®è§’åº¦ã«å‡ºç¾
    """
    # 2Î¸ç¯„å›²ï¼ˆåº¦ï¼‰
    two_theta = np.linspace(10, 80, 1000)
    intensity = np.zeros_like(two_theta)

    # ä¸»è¦ãªçµæ™¶é¢ã‹ã‚‰ã®ãƒ–ãƒ©ãƒƒã‚°åå°„ãƒ”ãƒ¼ã‚¯
    # (111), (200), (220), (311)é¢ã‹ã‚‰ã®å›æŠ˜
    peaks = [28.4, 33.0, 47.5, 56.1]  # 2Î¸ä½ç½®ï¼ˆä¾‹ï¼šFCCæ§‹é€ ï¼‰
    peak_intensities = [100, 50, 80, 40]  # ç›¸å¯¾å¼·åº¦
    peak_width = 0.3  # ãƒ”ãƒ¼ã‚¯å¹…ï¼ˆåº¦ï¼‰

    # ã‚¬ã‚¦ã‚·ã‚¢ãƒ³ãƒ”ãƒ¼ã‚¯ã‚’è¿½åŠ 
    for peak_pos, peak_int in zip(peaks, peak_intensities):
        intensity += peak_int * np.exp(-((two_theta - peak_pos) / peak_width)**2)

    # ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãƒã‚¤ã‚º
    intensity += np.random.normal(2, 0.5, len(two_theta))

    return two_theta, intensity


def simulate_amorphous_xrd():
    """
    éæ™¶è³ªææ–™ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
    ãƒ–ãƒ­ãƒ¼ãƒ‰ãªãƒãƒ­ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³
    """
    two_theta = np.linspace(10, 80, 1000)

    # ãƒ–ãƒ­ãƒ¼ãƒ‰ãªãƒãƒ­ãƒ¼ï¼ˆçŸ­è·é›¢ç§©åºã«ã‚ˆã‚‹ï¼‰
    halo_center = 25  # ãƒãƒ­ãƒ¼ã®ä¸­å¿ƒä½ç½®
    halo_width = 15   # ãƒãƒ­ãƒ¼ã®å¹…
    intensity = 30 * np.exp(-((two_theta - halo_center) / halo_width)**2)

    # è¿½åŠ ã®ãƒ–ãƒ­ãƒ¼ãƒ‰ãªãƒ”ãƒ¼ã‚¯
    intensity += 15 * np.exp(-((two_theta - 45) / 20)**2)

    # ãƒã‚¤ã‚º
    intensity += np.random.normal(2, 0.5, len(two_theta))

    return two_theta, intensity


# ãƒ—ãƒ­ãƒƒãƒˆä½œæˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# çµæ™¶æ€§ææ–™ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³
two_theta_cryst, intensity_cryst = simulate_crystalline_xrd()
ax1.plot(two_theta_cryst, intensity_cryst, linewidth=1.5, color='#1f77b4')
ax1.set_xlabel('2Î¸ (åº¦)', fontsize=12, fontweight='bold')
ax1.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12, fontweight='bold')
ax1.set_title('çµæ™¶æ€§ææ–™ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³\nï¼ˆé‹­ã„ãƒ–ãƒ©ãƒƒã‚°ãƒ”ãƒ¼ã‚¯ï¼‰', fontsize=13, fontweight='bold')
ax1.grid(alpha=0.3)
ax1.set_ylim(0, 110)

# ãƒ”ãƒ¼ã‚¯ä½ç½®ã«æ³¨é‡ˆ
peaks_labels = ['(111)', '(200)', '(220)', '(311)']
peaks_pos = [28.4, 33.0, 47.5, 56.1]
for label, pos in zip(peaks_labels, peaks_pos):
    ax1.annotate(label, xy=(pos, 105), ha='center', fontsize=10,
                 bbox=dict(boxstyle='round,pad=0.3', facecolor='yellow', alpha=0.5))

# éæ™¶è³ªææ–™ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³
two_theta_amor, intensity_amor = simulate_amorphous_xrd()
ax2.plot(two_theta_amor, intensity_amor, linewidth=1.5, color='#ff7f0e')
ax2.set_xlabel('2Î¸ (åº¦)', fontsize=12, fontweight='bold')
ax2.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12, fontweight='bold')
ax2.set_title('éæ™¶è³ªææ–™ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³\nï¼ˆãƒ–ãƒ­ãƒ¼ãƒ‰ãªãƒãƒ­ãƒ¼ï¼‰', fontsize=13, fontweight='bold')
ax2.grid(alpha=0.3)
ax2.set_ylim(0, 35)

plt.tight_layout()
plt.show()

print("XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã®è§£é‡ˆ:")
print("\nã€çµæ™¶æ€§ææ–™ã€‘")
print("- é‹­ã„ãƒ”ãƒ¼ã‚¯ãŒæ˜ç¢ºãªè§’åº¦ã«å‡ºç¾")
print("- ãƒ”ãƒ¼ã‚¯ä½ç½®ã‹ã‚‰æ ¼å­å®šæ•°ã¨çµæ™¶æ§‹é€ ã‚’æ±ºå®š")
print("- ãƒ”ãƒ¼ã‚¯å¼·åº¦ã‹ã‚‰åŸå­é…åˆ—ã®æƒ…å ±ã‚’å–å¾—")
print("- ä¾‹ï¼šé‡‘å±ã€ã‚»ãƒ©ãƒŸãƒƒã‚¯ã‚¹ã€ã‚·ãƒªã‚³ãƒ³å˜çµæ™¶")

print("\nã€éæ™¶è³ªææ–™ã€‘")
print("- ãƒ–ãƒ­ãƒ¼ãƒ‰ãªãƒãƒ­ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³")
print("- çŸ­è·é›¢ç§©åºã¯å­˜åœ¨ã™ã‚‹ãŒã€é•·è·é›¢ç§©åºãªã—")
print("- ãƒãƒ­ãƒ¼ã®ä½ç½®ã‹ã‚‰å¹³å‡åŸå­é–“è·é›¢ã‚’æ¨å®š")
print("- ä¾‹ï¼šã‚¬ãƒ©ã‚¹ã€ã‚¢ãƒ¢ãƒ«ãƒ•ã‚¡ã‚¹ã‚·ãƒªã‚³ãƒ³ã€ä¸€éƒ¨ã®é«˜åˆ†å­")
</code></pre>

        <p><strong>è§£èª¬</strong>: Xç·šå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯çµæ™¶æ€§ã®æœ‰ç„¡ã‚’æ˜ç¢ºã«ç¤ºã—ã¾ã™ã€‚çµæ™¶æ€§ææ–™ã¯ç‰¹å®šã®è§’åº¦ã§é‹­ã„ãƒ”ãƒ¼ã‚¯ã‚’ç¤ºã—ã€ã“ã‚Œã«ã‚ˆã‚Šçµæ™¶æ§‹é€ ã‚’åŒå®šã§ãã¾ã™ã€‚éæ™¶è³ªææ–™ã¯ãƒ–ãƒ­ãƒ¼ãƒ‰ãªãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç¤ºã—ã€é•·è·é›¢ç§©åºãŒãªã„ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚</p>

        <hr>

        <h2>3.2 å˜ä½æ ¼å­ã¨æ ¼å­å®šæ•°</h2>

        <h3>å˜ä½æ ¼å­ï¼ˆUnit Cellï¼‰</h3>

        <p><strong>å˜ä½æ ¼å­</strong>ã¯ã€çµæ™¶æ§‹é€ ã®æœ€å°ã®ç¹°ã‚Šè¿”ã—å˜ä½ã§ã™ã€‚3æ¬¡å…ƒç©ºé–“ã«å˜ä½æ ¼å­ã‚’ä¸¦ã¹ã‚‹ã“ã¨ã§ã€çµæ™¶å…¨ä½“ã‚’æ§‹æˆã§ãã¾ã™ã€‚</p>

        <p><strong>æ ¼å­å®šæ•°ï¼ˆLattice Parametersï¼‰</strong>:</p>
        <ul>
            <li>$a, b, c$: å˜ä½æ ¼å­ã®è¾ºã®é•·ã•ï¼ˆÃ…å˜ä½ï¼‰</li>
            <li>$\alpha, \beta, \gamma$: è¾ºã®é–“ã®è§’åº¦ï¼ˆåº¦ã¾ãŸã¯ãƒ©ã‚¸ã‚¢ãƒ³ï¼‰</li>
        </ul>

        <h3>7ã¤ã®çµæ™¶ç³»</h3>

        <p>å˜ä½æ ¼å­ã®å½¢çŠ¶ã«ã‚ˆã‚Šã€çµæ™¶ã¯7ã¤ã®çµæ™¶ç³»ã«åˆ†é¡ã•ã‚Œã¾ã™ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>çµæ™¶ç³»</th>
                    <th>æ ¼å­å®šæ•°ã®é–¢ä¿‚</th>
                    <th>è§’åº¦ã®é–¢ä¿‚</th>
                    <th>ä»£è¡¨ä¾‹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>ç«‹æ–¹æ™¶ç³»</strong></td>
                    <td>a = b = c</td>
                    <td>Î± = Î² = Î³ = 90Â°</td>
                    <td>NaCl, Cu, Fe, Si</td>
                </tr>
                <tr>
                    <td><strong>æ­£æ–¹æ™¶ç³»</strong></td>
                    <td>a = b â‰  c</td>
                    <td>Î± = Î² = Î³ = 90Â°</td>
                    <td>TiOâ‚‚, SnOâ‚‚</td>
                </tr>
                <tr>
                    <td><strong>æ–œæ–¹æ™¶ç³»</strong></td>
                    <td>a â‰  b â‰  c</td>
                    <td>Î± = Î² = Î³ = 90Â°</td>
                    <td>Î±-S, BaSOâ‚„</td>
                </tr>
                <tr>
                    <td><strong>å…­æ–¹æ™¶ç³»</strong></td>
                    <td>a = b â‰  c</td>
                    <td>Î± = Î² = 90Â°, Î³ = 120Â°</td>
                    <td>Mg, Zn, ã‚°ãƒ©ãƒ•ã‚¡ã‚¤ãƒˆ</td>
                </tr>
                <tr>
                    <td><strong>ä¸‰æ–¹æ™¶ç³»</strong></td>
                    <td>a = b = c</td>
                    <td>Î± = Î² = Î³ â‰  90Â°</td>
                    <td>çŸ³è‹±, CaCOâ‚ƒ</td>
                </tr>
                <tr>
                    <td><strong>å˜æ–œæ™¶ç³»</strong></td>
                    <td>a â‰  b â‰  c</td>
                    <td>Î± = Î³ = 90Â° â‰  Î²</td>
                    <td>Î²-S, CaSOâ‚„Â·2Hâ‚‚O</td>
                </tr>
                <tr>
                    <td><strong>ä¸‰æ–œæ™¶ç³»</strong></td>
                    <td>a â‰  b â‰  c</td>
                    <td>Î± â‰  Î² â‰  Î³ â‰  90Â°</td>
                    <td>CuSOâ‚„Â·5Hâ‚‚O</td>
                </tr>
            </tbody>
        </table>

        <p>ææ–™ç§‘å­¦ã§æœ€ã‚‚é‡è¦ãªã®ã¯<strong>ç«‹æ–¹æ™¶ç³»</strong>ã§ã™ã€‚é‡‘å±ã®å¤šãã¯ç«‹æ–¹æ™¶ç³»ã«å±ã—ã¾ã™ã€‚</p>

        <h3>ãƒŸãƒ©ãƒ¼æŒ‡æ•°ï¼ˆMiller Indicesï¼‰</h3>

        <p><strong>ãƒŸãƒ©ãƒ¼æŒ‡æ•°</strong>ã¯ã€çµæ™¶ä¸­ã®é¢ã‚„æ–¹å‘ã‚’è¡¨è¨˜ã™ã‚‹æ–¹æ³•ã§ã™ã€‚</p>

        <p><strong>çµæ™¶é¢ã®è¡¨è¨˜</strong>: $(hkl)$</p>
        <p><strong>çµæ™¶æ–¹å‘ã®è¡¨è¨˜</strong>: $[uvw]$</p>

        <p><strong>ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®æ±ºå®šæ–¹æ³•</strong>ï¼ˆçµæ™¶é¢ã®å ´åˆï¼‰:</p>
        <ol>
            <li>é¢ãŒa, b, cè»¸ã¨äº¤ã‚ã‚‹ç‚¹ã®åº§æ¨™ã‚’æ±‚ã‚ã‚‹ï¼ˆåˆ‡ç‰‡ï¼‰</li>
            <li>å„åˆ‡ç‰‡ã®é€†æ•°ã‚’å–ã‚‹</li>
            <li>æ•´æ•°æ¯”ã«ãªã‚‹ã‚ˆã†ã«é€šåˆ†ã™ã‚‹</li>
            <li>$(hkl)$ã¨è¡¨è¨˜ã™ã‚‹</li>
        </ol>

        <p><strong>ä¾‹</strong>:</p>
        <ul>
            <li>$(100)$é¢: aè»¸ã«å‚ç›´ãªé¢</li>
            <li>$(110)$é¢: aè»¸ã¨bè»¸ã«å¯¾ã—ã¦45Â°å‚¾ã„ãŸé¢</li>
            <li>$(111)$é¢: a, b, cè»¸ã«å¯¾ã—ã¦ç­‰ã—ãå‚¾ã„ãŸé¢</li>
        </ul>

        <h3>é¢é–“éš”ã®è¨ˆç®—</h3>

        <p>ç«‹æ–¹æ™¶ç³»ã®å ´åˆã€$(hkl)$é¢ã®é¢é–“éš”$d_{hkl}$ã¯ä»¥ä¸‹ã®å¼ã§è¨ˆç®—ã•ã‚Œã¾ã™ï¼š</p>

        <p>$$d_{hkl} = \frac{a}{\sqrt{h^2 + k^2 + l^2}}$$</p>

        <p>ã“ã“ã§ã€$a$ã¯æ ¼å­å®šæ•°ã§ã™ã€‚</p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹2: å˜ä½æ ¼å­ä½“ç©ã¨é¢é–“éš”ã®è¨ˆç®—æ©Ÿ</h3>

        <p>æ ¼å­å®šæ•°ã‹ã‚‰å˜ä½æ ¼å­ã®ä½“ç©ã¨ã€ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã§æŒ‡å®šã•ã‚ŒãŸé¢ã®é¢é–“éš”ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">import numpy as np

class CrystalCalculator:
    """
    çµæ™¶æ§‹é€ ã®å„ç¨®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨ˆç®—ã™ã‚‹ã‚¯ãƒ©ã‚¹
    """

    def __init__(self, a, b=None, c=None, alpha=90, beta=90, gamma=90):
        """
        æ ¼å­å®šæ•°ã‚’è¨­å®š

        Parameters:
        a, b, c: æ ¼å­å®šæ•° (Ã…)
        alpha, beta, gamma: è§’åº¦ (åº¦)
        """
        self.a = a
        self.b = b if b is not None else a
        self.c = c if c is not None else a
        self.alpha = np.radians(alpha)
        self.beta = np.radians(beta)
        self.gamma = np.radians(gamma)

    def unit_cell_volume(self):
        """
        å˜ä½æ ¼å­ã®ä½“ç©ã‚’è¨ˆç®— (Ã…Â³)
        """
        # ä¸€èˆ¬å¼ï¼ˆå…¨ã¦ã®çµæ™¶ç³»ã«å¯¾å¿œï¼‰
        cos_alpha = np.cos(self.alpha)
        cos_beta = np.cos(self.beta)
        cos_gamma = np.cos(self.gamma)

        volume = self.a * self.b * self.c * np.sqrt(
            1 - cos_alpha**2 - cos_beta**2 - cos_gamma**2
            + 2*cos_alpha*cos_beta*cos_gamma
        )
        return volume

    def d_spacing_cubic(self, h, k, l):
        """
        ç«‹æ–¹æ™¶ç³»ã®é¢é–“éš”ã‚’è¨ˆç®—ï¼ˆç°¡æ˜“ç‰ˆï¼‰

        Parameters:
        h, k, l: ãƒŸãƒ©ãƒ¼æŒ‡æ•°

        Returns:
        d: é¢é–“éš” (Ã…)
        """
        if h == 0 and k == 0 and l == 0:
            raise ValueError("ãƒŸãƒ©ãƒ¼æŒ‡æ•°ãŒå…¨ã¦0ã«ãªã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“")

        d = self.a / np.sqrt(h**2 + k**2 + l**2)
        return d

    def print_crystal_info(self, crystal_name):
        """
        çµæ™¶æƒ…å ±ã‚’è¦‹ã‚„ã™ãè¡¨ç¤º
        """
        print(f"\n{'='*60}")
        print(f"ã€{crystal_name}ã®çµæ™¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘")
        print(f"{'='*60}")
        print(f"æ ¼å­å®šæ•° a = {self.a:.4f} Ã…")
        if self.b != self.a or self.c != self.a:
            print(f"æ ¼å­å®šæ•° b = {self.b:.4f} Ã…")
            print(f"æ ¼å­å®šæ•° c = {self.c:.4f} Ã…")

        volume = self.unit_cell_volume()
        print(f"å˜ä½æ ¼å­ä½“ç© V = {volume:.4f} Ã…Â³")

        # ä¸»è¦ãªçµæ™¶é¢ã®é¢é–“éš”ã‚’è¨ˆç®—ï¼ˆç«‹æ–¹æ™¶ç³»ã®å ´åˆï¼‰
        if self.a == self.b == self.c and \
           self.alpha == self.beta == self.gamma == np.radians(90):
            print(f"\nä¸»è¦çµæ™¶é¢ã®é¢é–“éš”:")
            planes = [(1,0,0), (1,1,0), (1,1,1), (2,0,0), (2,2,0)]
            for h, k, l in planes:
                d = self.d_spacing_cubic(h, k, l)
                print(f"  ({h}{k}{l})é¢: d = {d:.4f} Ã…")


# ä»£è¡¨çš„ãªææ–™ã®çµæ™¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
print("ä»£è¡¨çš„ãªææ–™ã®çµæ™¶æ§‹é€ è¨ˆç®—")

# éŠ…ï¼ˆFCCï¼‰
cu = CrystalCalculator(a=3.615)  # Ã…
cu.print_crystal_info("éŠ…ï¼ˆCu, FCCï¼‰")

# é‰„ï¼ˆBCCï¼‰
fe = CrystalCalculator(a=2.866)  # Ã…
fe.print_crystal_info("é‰„ï¼ˆFe, BCCï¼‰")

# ã‚·ãƒªã‚³ãƒ³ï¼ˆãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰æ§‹é€ ï¼‰
si = CrystalCalculator(a=5.431)  # Ã…
si.print_crystal_info("ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰")

# ã‚¢ãƒ«ãƒŸãƒŠï¼ˆå…­æ–¹æ™¶ç³»ï¼‰
al2o3 = CrystalCalculator(a=4.759, c=12.991, gamma=120)  # Ã…
print(f"\n{'='*60}")
print(f"ã€ã‚¢ãƒ«ãƒŸãƒŠï¼ˆAlâ‚‚Oâ‚ƒ, HCPï¼‰ã®çµæ™¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘")
print(f"{'='*60}")
print(f"æ ¼å­å®šæ•° a = {al2o3.a:.4f} Ã…")
print(f"æ ¼å­å®šæ•° c = {al2o3.c:.4f} Ã…")
print(f"c/aæ¯” = {al2o3.c/al2o3.a:.4f}")
volume = al2o3.unit_cell_volume()
print(f"å˜ä½æ ¼å­ä½“ç© V = {volume:.4f} Ã…Â³")

print("\n" + "="*60)
print("é¢é–“éš”ã®å¿œç”¨:")
print("- Xç·šå›æŠ˜ã®ãƒ”ãƒ¼ã‚¯ä½ç½®äºˆæ¸¬")
print("- åŸå­é¢ã®å¯†åº¦è¨ˆç®—")
print("- ã™ã¹ã‚Šç³»ã®è§£æï¼ˆå¡‘æ€§å¤‰å½¢ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ï¼‰")
</code></pre>

        <p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
        <pre><code>ä»£è¡¨çš„ãªææ–™ã®çµæ™¶æ§‹é€ è¨ˆç®—
============================================================
ã€éŠ…ï¼ˆCu, FCCï¼‰ã®çµæ™¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã€‘
============================================================
æ ¼å­å®šæ•° a = 3.6150 Ã…
å˜ä½æ ¼å­ä½“ç© V = 47.2418 Ã…Â³

ä¸»è¦çµæ™¶é¢ã®é¢é–“éš”:
  (100)é¢: d = 3.6150 Ã…
  (110)é¢: d = 2.5557 Ã…
  (111)é¢: d = 2.0871 Ã…
  (200)é¢: d = 1.8075 Ã…
  (220)é¢: d = 1.2779 Ã…</code></pre>

        <p><strong>è§£èª¬</strong>: æ ¼å­å®šæ•°ã‹ã‚‰å˜ä½æ ¼å­ä½“ç©ã¨é¢é–“éš”ã‚’è¨ˆç®—ã§ãã¾ã™ã€‚é¢é–“éš”ã¯Xç·šå›æŠ˜ã®ãƒ”ãƒ¼ã‚¯ä½ç½®ã®äºˆæ¸¬ã‚„ã€åŸå­é¢ã®å¯†åº¦è¨ˆç®—ã«ä½¿ã‚ã‚Œã¾ã™ã€‚</p>

        <hr>

        <h2>3.3 ä¸»è¦ãªçµæ™¶æ§‹é€ </h2>

        <p>é‡‘å±ææ–™ã®å¤šãã¯ã€ä»¥ä¸‹ã®3ã¤ã®çµæ™¶æ§‹é€ ã®ã„ãšã‚Œã‹ã‚’æŒã¡ã¾ã™ï¼š</p>

        <h3>1. é¢å¿ƒç«‹æ–¹æ ¼å­ï¼ˆFCC: Face-Centered Cubicï¼‰</h3>

        <p><strong>ç‰¹å¾´</strong>:</p>
        <ul>
            <li>ç«‹æ–¹ä½“ã®å„é¢ã®ä¸­å¿ƒã«åŸå­ãŒé…ç½®</li>
            <li>å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: 4å€‹ï¼ˆé ‚ç‚¹8Ã—1/8 + é¢å¿ƒ6Ã—1/2 = 4ï¼‰</li>
            <li>é…ä½æ•°: 12ï¼ˆæœ€ã‚‚è¿‘ã„åŸå­ã®æ•°ï¼‰</li>
            <li>å……å¡«ç‡ï¼ˆAPF: Atomic Packing Fractionï¼‰: 74%</li>
            <li>æœ€å¯†å……å¡«æ§‹é€ </li>
        </ul>

        <p><strong>ä»£è¡¨ææ–™</strong>:</p>
        <ul>
            <li>éŠ…ï¼ˆCuï¼‰: a = 3.615 Ã…</li>
            <li>ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ï¼ˆAlï¼‰: a = 4.049 Ã…</li>
            <li>é‡‘ï¼ˆAuï¼‰: a = 4.078 Ã…</li>
            <li>éŠ€ï¼ˆAgï¼‰: a = 4.086 Ã…</li>
            <li>ãƒ‹ãƒƒã‚±ãƒ«ï¼ˆNiï¼‰: a = 3.524 Ã…</li>
        </ul>

        <p><strong>æ€§è³ª</strong>: å»¶æ€§ã«å„ªã‚Œã‚‹ï¼ˆå¤šãã®ã™ã¹ã‚Šç³»ï¼‰ã€æ¯”è¼ƒçš„æŸ”ã‚‰ã‹ã„</p>

        <h3>2. ä½“å¿ƒç«‹æ–¹æ ¼å­ï¼ˆBCC: Body-Centered Cubicï¼‰</h3>

        <p><strong>ç‰¹å¾´</strong>:</p>
        <ul>
            <li>ç«‹æ–¹ä½“ã®ä¸­å¿ƒã«åŸå­ãŒé…ç½®</li>
            <li>å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: 2å€‹ï¼ˆé ‚ç‚¹8Ã—1/8 + ä½“å¿ƒ1 = 2ï¼‰</li>
            <li>é…ä½æ•°: 8</li>
            <li>å……å¡«ç‡ï¼ˆAPFï¼‰: 68%</li>
        </ul>

        <p><strong>ä»£è¡¨ææ–™</strong>:</p>
        <ul>
            <li>é‰„ï¼ˆFe, Î±-é‰„ï¼‰: a = 2.866 Ã…</li>
            <li>ã‚¯ãƒ­ãƒ ï¼ˆCrï¼‰: a = 2.885 Ã…</li>
            <li>ã‚¿ãƒ³ã‚°ã‚¹ãƒ†ãƒ³ï¼ˆWï¼‰: a = 3.165 Ã…</li>
            <li>ãƒ¢ãƒªãƒ–ãƒ‡ãƒ³ï¼ˆMoï¼‰: a = 3.147 Ã…</li>
            <li>ãƒãƒŠã‚¸ã‚¦ãƒ ï¼ˆVï¼‰: a = 3.024 Ã…</li>
        </ul>

        <p><strong>æ€§è³ª</strong>: å¼·åº¦ãŒé«˜ã„ã€ä½æ¸©ã§è„†æ€§ç ´å£Šã—ã‚„ã™ã„</p>

        <h3>3. å…­æ–¹æœ€å¯†å……å¡«ï¼ˆHCP: Hexagonal Close-Packedï¼‰</h3>

        <p><strong>ç‰¹å¾´</strong>:</p>
        <ul>
            <li>å…­æ–¹æ™¶ç³»ã®æœ€å¯†å……å¡«æ§‹é€ </li>
            <li>å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: 6å€‹</li>
            <li>é…ä½æ•°: 12</li>
            <li>å……å¡«ç‡ï¼ˆAPFï¼‰: 74%ï¼ˆFCCã¨åŒã˜ï¼‰</li>
            <li>ç†æƒ³çš„ãªc/aæ¯”: 1.633</li>
        </ul>

        <p><strong>ä»£è¡¨ææ–™</strong>:</p>
        <ul>
            <li>ãƒã‚°ãƒã‚·ã‚¦ãƒ ï¼ˆMgï¼‰: a = 3.209 Ã…, c/a = 1.624</li>
            <li>äºœé‰›ï¼ˆZnï¼‰: a = 2.665 Ã…, c/a = 1.856</li>
            <li>ãƒã‚¿ãƒ³ï¼ˆTiï¼‰: a = 2.951 Ã…, c/a = 1.588</li>
            <li>ã‚³ãƒãƒ«ãƒˆï¼ˆCoï¼‰: a = 2.507 Ã…, c/a = 1.623</li>
        </ul>

        <p><strong>æ€§è³ª</strong>: ã™ã¹ã‚Šç³»ãŒå°‘ãªãã€å»¶æ€§ãŒä½ã„ï¼ˆç•°æ–¹æ€§ãŒå¼·ã„ï¼‰</p>

        <h3>çµæ™¶æ§‹é€ ã®æ¯”è¼ƒè¡¨</h3>

        <table>
            <thead>
                <tr>
                    <th>é …ç›®</th>
                    <th>FCC</th>
                    <th>BCC</th>
                    <th>HCP</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>åŸå­æ•°/å˜ä½æ ¼å­</strong></td>
                    <td>4</td>
                    <td>2</td>
                    <td>6</td>
                </tr>
                <tr>
                    <td><strong>é…ä½æ•°</strong></td>
                    <td>12</td>
                    <td>8</td>
                    <td>12</td>
                </tr>
                <tr>
                    <td><strong>å……å¡«ç‡ï¼ˆAPFï¼‰</strong></td>
                    <td>74%</td>
                    <td>68%</td>
                    <td>74%</td>
                </tr>
                <tr>
                    <td><strong>ã™ã¹ã‚Šç³»ã®æ•°</strong></td>
                    <td>12</td>
                    <td>48ï¼ˆä½æ¸©ã§åˆ¶é™ï¼‰</td>
                    <td>3ï¼ˆå°‘ãªã„ï¼‰</td>
                </tr>
                <tr>
                    <td><strong>å»¶æ€§</strong></td>
                    <td>é«˜</td>
                    <td>ä¸­ã€œé«˜</td>
                    <td>ä½</td>
                </tr>
                <tr>
                    <td><strong>ä»£è¡¨é‡‘å±</strong></td>
                    <td>Cu, Al, Au, Ag</td>
                    <td>Fe, Cr, W, Mo</td>
                    <td>Mg, Zn, Ti, Co</td>
                </tr>
            </tbody>
        </table>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹3: å……å¡«ç‡ï¼ˆAPFï¼‰ã®è¨ˆç®—</h3>

        <p>FCC, BCC, HCPæ§‹é€ ã®åŸå­å……å¡«ç‡ã‚’è¨ˆç®—ã—ã€æ¯”è¼ƒã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">import numpy as np

def calculate_apf_fcc(a, r=None):
    """
    FCCæ§‹é€ ã®å……å¡«ç‡ï¼ˆAPFï¼‰ã‚’è¨ˆç®—

    Parameters:
    a: æ ¼å­å®šæ•° (Ã…)
    r: åŸå­åŠå¾„ (Ã…)ã€‚Noneã®å ´åˆã€æ ¼å­å®šæ•°ã‹ã‚‰è¨ˆç®—

    Returns:
    apf: å……å¡«ç‡
    """
    # FCCæ§‹é€ ã§ã¯ã€é¢å¯¾è§’ç·šã«æ²¿ã£ã¦åŸå­ãŒæ¥è§¦
    # é¢å¯¾è§’ç·š = 4r = aâˆš2 ã‚ˆã‚Šã€r = aâˆš2/4
    if r is None:
        r = a * np.sqrt(2) / 4

    # å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°
    n_atoms = 4

    # åŸå­ã®ä½“ç©
    v_atoms = n_atoms * (4/3) * np.pi * r**3

    # å˜ä½æ ¼å­ã®ä½“ç©
    v_cell = a**3

    # å……å¡«ç‡
    apf = v_atoms / v_cell

    return apf, r


def calculate_apf_bcc(a, r=None):
    """
    BCCæ§‹é€ ã®å……å¡«ç‡ï¼ˆAPFï¼‰ã‚’è¨ˆç®—

    Parameters:
    a: æ ¼å­å®šæ•° (Ã…)
    r: åŸå­åŠå¾„ (Ã…)ã€‚Noneã®å ´åˆã€æ ¼å­å®šæ•°ã‹ã‚‰è¨ˆç®—

    Returns:
    apf: å……å¡«ç‡
    """
    # BCCæ§‹é€ ã§ã¯ã€ä½“å¯¾è§’ç·šã«æ²¿ã£ã¦åŸå­ãŒæ¥è§¦
    # ä½“å¯¾è§’ç·š = 4r = aâˆš3 ã‚ˆã‚Šã€r = aâˆš3/4
    if r is None:
        r = a * np.sqrt(3) / 4

    # å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°
    n_atoms = 2

    # åŸå­ã®ä½“ç©
    v_atoms = n_atoms * (4/3) * np.pi * r**3

    # å˜ä½æ ¼å­ã®ä½“ç©
    v_cell = a**3

    # å……å¡«ç‡
    apf = v_atoms / v_cell

    return apf, r


def calculate_apf_hcp(a, c, r=None):
    """
    HCPæ§‹é€ ã®å……å¡«ç‡ï¼ˆAPFï¼‰ã‚’è¨ˆç®—

    Parameters:
    a: åŸºåº•é¢ã®æ ¼å­å®šæ•° (Ã…)
    c: cè»¸æ–¹å‘ã®æ ¼å­å®šæ•° (Ã…)
    r: åŸå­åŠå¾„ (Ã…)ã€‚Noneã®å ´åˆã€a/2ã¨ä»®å®š

    Returns:
    apf: å……å¡«ç‡
    """
    # HCPæ§‹é€ ã§ã¯ã€åŸºåº•é¢å†…ã§åŸå­ãŒæ¥è§¦
    # a = 2r
    if r is None:
        r = a / 2

    # å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°
    n_atoms = 6

    # åŸå­ã®ä½“ç©
    v_atoms = n_atoms * (4/3) * np.pi * r**3

    # å˜ä½æ ¼å­ã®ä½“ç©ï¼ˆå…­æ–¹æ™¶ï¼‰
    # V = (âˆš3/2) * aÂ² * c
    v_cell = (np.sqrt(3) / 2) * a**2 * c

    # å……å¡«ç‡
    apf = v_atoms / v_cell

    return apf, r


# å……å¡«ç‡ã®è¨ˆç®—ã¨æ¯”è¼ƒ
print("="*70)
print("ä¸»è¦ãªçµæ™¶æ§‹é€ ã®å……å¡«ç‡ï¼ˆAPFï¼‰è¨ˆç®—")
print("="*70)

# FCCï¼ˆéŠ…ã‚’ä¾‹ï¼‰
a_fcc = 3.615  # Ã…
apf_fcc, r_fcc = calculate_apf_fcc(a_fcc)
print(f"\nã€FCCæ§‹é€ ï¼ˆä¾‹ï¼šéŠ…ï¼‰ã€‘")
print(f"æ ¼å­å®šæ•° a = {a_fcc} Ã…")
print(f"åŸå­åŠå¾„ r = {r_fcc:.4f} Ã…")
print(f"å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•° = 4")
print(f"å……å¡«ç‡ APF = {apf_fcc:.4f} ({apf_fcc*100:.2f}%)")
print(f"ç†è«–å€¤: 0.7405 (74.05%)")

# BCCï¼ˆé‰„ã‚’ä¾‹ï¼‰
a_bcc = 2.866  # Ã…
apf_bcc, r_bcc = calculate_apf_bcc(a_bcc)
print(f"\nã€BCCæ§‹é€ ï¼ˆä¾‹ï¼šé‰„ï¼‰ã€‘")
print(f"æ ¼å­å®šæ•° a = {a_bcc} Ã…")
print(f"åŸå­åŠå¾„ r = {r_bcc:.4f} Ã…")
print(f"å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•° = 2")
print(f"å……å¡«ç‡ APF = {apf_bcc:.4f} ({apf_bcc*100:.2f}%)")
print(f"ç†è«–å€¤: 0.6802 (68.02%)")

# HCPï¼ˆãƒã‚°ãƒã‚·ã‚¦ãƒ ã‚’ä¾‹ã€ç†æƒ³çš„ãªc/aæ¯”ï¼‰
a_hcp = 3.209  # Ã…
c_hcp = a_hcp * np.sqrt(8/3)  # ç†æƒ³çš„ãªc/a = 1.633
apf_hcp, r_hcp = calculate_apf_hcp(a_hcp, c_hcp)
print(f"\nã€HCPæ§‹é€ ï¼ˆä¾‹ï¼šãƒã‚°ãƒã‚·ã‚¦ãƒ ï¼‰ã€‘")
print(f"æ ¼å­å®šæ•° a = {a_hcp} Ã…")
print(f"æ ¼å­å®šæ•° c = {c_hcp:.4f} Ã… (ç†æƒ³å€¤)")
print(f"c/aæ¯” = {c_hcp/a_hcp:.4f}")
print(f"åŸå­åŠå¾„ r = {r_hcp:.4f} Ã…")
print(f"å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•° = 6")
print(f"å……å¡«ç‡ APF = {apf_hcp:.4f} ({apf_hcp*100:.2f}%)")
print(f"ç†è«–å€¤: 0.7405 (74.05%)")

# æ¯”è¼ƒ
print("\n" + "="*70)
print("å……å¡«ç‡ã®æ¯”è¼ƒ:")
print("="*70)
print(f"FCC: {apf_fcc*100:.2f}% - æœ€å¯†å……å¡«ã€å»¶æ€§ã«å„ªã‚Œã‚‹")
print(f"BCC: {apf_bcc*100:.2f}% - ã‚„ã‚„ç–ã€å¼·åº¦ãŒé«˜ã„")
print(f"HCP: {apf_hcp*100:.2f}% - æœ€å¯†å……å¡«ã€å»¶æ€§ãŒä½ã„")

print("\nå……å¡«ç‡ã¨ææ–™ç‰¹æ€§ã®é–¢ä¿‚:")
print("- é«˜å……å¡«ç‡ â†’ å¯†åº¦ãŒé«˜ã„ã€å»¶æ€§ã«å„ªã‚Œã‚‹å‚¾å‘")
print("- ä½å……å¡«ç‡ â†’ ã™ãé–“ãŒå¤šã„ã€åŸå­ã®ç§»å‹•ãŒã—ã‚„ã™ã„")
print("- é…ä½æ•°ãŒå¤šã„ â†’ ã‚ˆã‚Šå¤šãã®çµåˆã€å®‰å®šæ€§ãŒé«˜ã„")
</code></pre>

        <p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
        <pre><code>======================================================================
ä¸»è¦ãªçµæ™¶æ§‹é€ ã®å……å¡«ç‡ï¼ˆAPFï¼‰è¨ˆç®—
======================================================================

ã€FCCæ§‹é€ ï¼ˆä¾‹ï¼šéŠ…ï¼‰ã€‘
æ ¼å­å®šæ•° a = 3.615 Ã…
åŸå­åŠå¾„ r = 1.2780 Ã…
å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•° = 4
å……å¡«ç‡ APF = 0.7405 (74.05%)
ç†è«–å€¤: 0.7405 (74.05%)

ã€BCCæ§‹é€ ï¼ˆä¾‹ï¼šé‰„ï¼‰ã€‘
æ ¼å­å®šæ•° a = 2.866 Ã…
åŸå­åŠå¾„ r = 1.2410 Ã…
å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•° = 2
å……å¡«ç‡ APF = 0.6802 (68.02%)
ç†è«–å€¤: 0.6802 (68.02%)</code></pre>

        <p><strong>è§£èª¬</strong>: å……å¡«ç‡ï¼ˆAPFï¼‰ã¯ã€å˜ä½æ ¼å­ã®ä½“ç©ã«å¯¾ã™ã‚‹åŸå­ãŒå ã‚ã‚‹ä½“ç©ã®å‰²åˆã§ã™ã€‚FCCã¨HCPã¯74%ã§æœ€å¯†å……å¡«æ§‹é€ ã€BCCã¯68%ã§ã‚„ã‚„ç–ãªæ§‹é€ ã§ã™ã€‚å……å¡«ç‡ã¯ææ–™ã®å¯†åº¦ã‚„æ©Ÿæ¢°çš„æ€§è³ªã«å½±éŸ¿ã—ã¾ã™ã€‚</p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹4: é…ä½æ•°ã¨æœ€è¿‘æ¥åŸå­é–“è·é›¢ã®å¯è¦–åŒ–</h3>

        <p>FCC, BCCæ§‹é€ ã®é…ä½æ•°ï¼ˆæœ€è¿‘æ¥åŸå­ã®æ•°ï¼‰ã¨åŸå­é–“è·é›¢ã‚’å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

def plot_coordination_fcc():
    """
    FCCæ§‹é€ ã®é…ä½æ•°ã‚’3Dãƒ—ãƒ­ãƒƒãƒˆã§å¯è¦–åŒ–
    ä¸­å¿ƒåŸå­ï¼ˆé¢å¿ƒï¼‰ã¨ãã®å‘¨å›²ã®12å€‹ã®æœ€è¿‘æ¥åŸå­
    """
    fig = plt.figure(figsize=(10, 8))
    ax = fig.add_subplot(111, projection='3d')

    # æ ¼å­å®šæ•°ï¼ˆè¦æ ¼åŒ–: a=1ï¼‰
    a = 1.0

    # ä¸­å¿ƒåŸå­ã®ä½ç½®ï¼ˆä¾‹ï¼š(0.5, 0.5, 0)é¢å¿ƒï¼‰
    center = np.array([0.5, 0.5, 0])

    # FCCæ§‹é€ ã®æœ€è¿‘æ¥åŸå­ã®ç›¸å¯¾ä½ç½®ï¼ˆä¸­å¿ƒåŸå­ã‹ã‚‰ã®å¤‰ä½ï¼‰
    # é…ä½æ•°12: 4ã¤ã®ç•°ãªã‚‹ã‚¿ã‚¤ãƒ—ã®é¢å¿ƒã¨ã®è·é›¢
    nearest_neighbors = [
        # åŒä¸€é¢å†…ã®4å€‹
        np.array([0.5, 0, 0]), np.array([-0.5, 0, 0]),
        np.array([0, 0.5, 0]), np.array([0, -0.5, 0]),
        # ä¸Šé¢ã®4å€‹
        np.array([0.5, 0, 1]), np.array([-0.5, 0, 1]),
        np.array([0, 0.5, 1]), np.array([0, -0.5, 1]),
        # ä¸‹é¢ã®4å€‹
        np.array([0.5, 0, -1]), np.array([-0.5, 0, -1]),
        np.array([0, 0.5, -1]), np.array([0, -0.5, -1]),
    ]

    # ç°¡ç•¥åŒ–: å®Ÿéš›ã®ä½ç½®ã‚’è¨ˆç®—
    # æ³¨ï¼šä¸Šè¨˜ã¯æ¦‚å¿µçš„ãªèª¬æ˜ç”¨ã€‚å®Ÿéš›ã«ã¯å˜ä½æ ¼å­å†…ã®ä½ç½®ã‚’æ­£ç¢ºã«è¨ˆç®—

    # ã‚ˆã‚Šæ­£ç¢ºãªæœ€è¿‘æ¥åŸå­ã®ä½ç½®ï¼ˆé¢å¿ƒã‚’ä¸­å¿ƒã¨ã—ã¦ï¼‰
    # FCC: é¢å¿ƒã‹ã‚‰æœ€ã‚‚è¿‘ã„åŸå­ã¯é ‚ç‚¹ã¨ä»–ã®é¢å¿ƒ
    neighbors_accurate = []
    for i in [-1, 1]:
        for j in [-1, 1]:
            neighbors_accurate.append(center + np.array([i*0.5, j*0.5, 0]))
            neighbors_accurate.append(center + np.array([i*0.5, 0, j*0.5]))
            neighbors_accurate.append(center + np.array([0, i*0.5, j*0.5]))

    # é‡è¤‡é™¤å»
    neighbors_unique = []
    for n in neighbors_accurate:
        is_duplicate = False
        for nu in neighbors_unique:
            if np.allclose(n, nu):
                is_duplicate = True
                break
        if not is_duplicate:
            neighbors_unique.append(n)

    # ä¸­å¿ƒåŸå­ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
    ax.scatter(*center, s=500, c='red', marker='o',
               edgecolors='black', linewidth=2, label='ä¸­å¿ƒåŸå­', alpha=0.8)

    # æœ€è¿‘æ¥åŸå­ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
    neighbors_array = np.array(neighbors_unique)
    ax.scatter(neighbors_array[:, 0], neighbors_array[:, 1], neighbors_array[:, 2],
               s=200, c='blue', marker='o', edgecolors='black', linewidth=1.5,
               label='æœ€è¿‘æ¥åŸå­', alpha=0.6)

    # çµåˆç·šã‚’æç”»
    for neighbor in neighbors_unique:
        ax.plot([center[0], neighbor[0]],
                [center[1], neighbor[1]],
                [center[2], neighbor[2]],
                'k--', linewidth=1, alpha=0.3)

    ax.set_xlabel('X', fontsize=12, fontweight='bold')
    ax.set_ylabel('Y', fontsize=12, fontweight='bold')
    ax.set_zlabel('Z', fontsize=12, fontweight='bold')
    ax.set_title('FCCæ§‹é€ ã®é…ä½æ•°ï¼ˆ12ï¼‰', fontsize=14, fontweight='bold')
    ax.legend(fontsize=11)
    ax.set_box_aspect([1,1,1])

    return fig


def calculate_nearest_neighbor_distances():
    """
    FCC, BCC, HCPæ§‹é€ ã®æœ€è¿‘æ¥åŸå­é–“è·é›¢ã‚’è¨ˆç®—
    """
    print("="*70)
    print("æœ€è¿‘æ¥åŸå­é–“è·é›¢ã®è¨ˆç®—")
    print("="*70)

    # FCC
    a_fcc = 3.615  # éŠ…ã®æ ¼å­å®šæ•°ï¼ˆÃ…ï¼‰
    # FCC: é¢å¯¾è§’ç·š = 4r = aâˆš2 â†’ æœ€è¿‘æ¥è·é›¢ = 2r = a/âˆš2
    d_fcc = a_fcc / np.sqrt(2)
    print(f"\nã€FCCï¼ˆéŠ…ï¼‰ã€‘")
    print(f"æ ¼å­å®šæ•° a = {a_fcc} Ã…")
    print(f"æœ€è¿‘æ¥åŸå­é–“è·é›¢ = {d_fcc:.4f} Ã…")
    print(f"é…ä½æ•° = 12")

    # BCC
    a_bcc = 2.866  # é‰„ã®æ ¼å­å®šæ•°ï¼ˆÃ…ï¼‰
    # BCC: ä½“å¯¾è§’ç·š = 4r = aâˆš3 â†’ æœ€è¿‘æ¥è·é›¢ = 2r = aâˆš3/2
    d_bcc = a_bcc * np.sqrt(3) / 2
    print(f"\nã€BCCï¼ˆé‰„ï¼‰ã€‘")
    print(f"æ ¼å­å®šæ•° a = {a_bcc} Ã…")
    print(f"æœ€è¿‘æ¥åŸå­é–“è·é›¢ = {d_bcc:.4f} Ã…")
    print(f"é…ä½æ•° = 8")

    # HCP
    a_hcp = 3.209  # ãƒã‚°ãƒã‚·ã‚¦ãƒ ã®æ ¼å­å®šæ•°ï¼ˆÃ…ï¼‰
    # HCP: åŸºåº•é¢å†… = a = 2r â†’ æœ€è¿‘æ¥è·é›¢ = a
    d_hcp = a_hcp
    print(f"\nã€HCPï¼ˆãƒã‚°ãƒã‚·ã‚¦ãƒ ï¼‰ã€‘")
    print(f"æ ¼å­å®šæ•° a = {a_hcp} Ã…")
    print(f"æœ€è¿‘æ¥åŸå­é–“è·é›¢ = {d_hcp:.4f} Ã…")
    print(f"é…ä½æ•° = 12")

    # æ¯”è¼ƒã‚°ãƒ©ãƒ•
    structures = ['FCC\n(Cu)', 'BCC\n(Fe)', 'HCP\n(Mg)']
    distances = [d_fcc, d_bcc, d_hcp]
    coordination_numbers = [12, 8, 12]

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # æœ€è¿‘æ¥è·é›¢ã®æ¯”è¼ƒ
    colors = ['#1f77b4', '#ff7f0e', '#2ca02c']
    ax1.bar(structures, distances, color=colors, edgecolor='black', linewidth=1.5, alpha=0.7)
    ax1.set_ylabel('æœ€è¿‘æ¥åŸå­é–“è·é›¢ (Ã…)', fontsize=12, fontweight='bold')
    ax1.set_title('çµæ™¶æ§‹é€ åˆ¥ã®æœ€è¿‘æ¥åŸå­é–“è·é›¢', fontsize=13, fontweight='bold')
    ax1.grid(axis='y', alpha=0.3)

    # å€¤ã‚’ãƒãƒ¼ã®ä¸Šã«è¡¨ç¤º
    for i, (s, d) in enumerate(zip(structures, distances)):
        ax1.text(i, d + 0.05, f'{d:.3f} Ã…', ha='center', fontsize=11, fontweight='bold')

    # é…ä½æ•°ã®æ¯”è¼ƒ
    ax2.bar(structures, coordination_numbers, color=colors, edgecolor='black', linewidth=1.5, alpha=0.7)
    ax2.set_ylabel('é…ä½æ•°', fontsize=12, fontweight='bold')
    ax2.set_title('çµæ™¶æ§‹é€ åˆ¥ã®é…ä½æ•°', fontsize=13, fontweight='bold')
    ax2.set_ylim(0, 14)
    ax2.grid(axis='y', alpha=0.3)

    # å€¤ã‚’ãƒãƒ¼ã®ä¸Šã«è¡¨ç¤º
    for i, (s, cn) in enumerate(zip(structures, coordination_numbers)):
        ax2.text(i, cn + 0.3, f'{cn}', ha='center', fontsize=12, fontweight='bold')

    plt.tight_layout()
    plt.show()

    print("\n" + "="*70)
    print("é…ä½æ•°ã¨ææ–™ç‰¹æ€§ã®é–¢ä¿‚:")
    print("- é…ä½æ•°ãŒå¤šã„ â†’ çµåˆãŒå¤šã„ â†’ å®‰å®šã€å¯†ã«è©°ã¾ã£ã¦ã„ã‚‹")
    print("- FCC, HCP: é…ä½æ•°12 â†’ æœ€å¯†å……å¡«ã€å»¶æ€§ã«å„ªã‚Œã‚‹")
    print("- BCC: é…ä½æ•°8 â†’ ã‚„ã‚„ç–ã€å¼·åº¦ãŒé«˜ã„ãŒä½æ¸©ã§è„†ã„")


# å®Ÿè¡Œ
calculate_nearest_neighbor_distances()
# plot_coordination_fcc()  # 3Dãƒ—ãƒ­ãƒƒãƒˆãŒå¿…è¦ãªå ´åˆã¯ã‚³ãƒ¡ãƒ³ãƒˆè§£é™¤
plt.show()
</code></pre>

        <p><strong>è§£èª¬</strong>: é…ä½æ•°ã¯ã€ã‚ã‚‹åŸå­ã®å‘¨ã‚Šã«æœ€ã‚‚è¿‘æ¥ã—ã¦é…ç½®ã•ã‚Œã¦ã„ã‚‹åŸå­ã®æ•°ã§ã™ã€‚é…ä½æ•°ãŒå¤šã„ã»ã©ã€åŸå­é–“ã®çµåˆãŒå¤šãã€ææ–™ã¯å®‰å®šã§å¯†ã«è©°ã¾ã£ã¦ã„ã¾ã™ã€‚FCCã¨HCPã¯é…ä½æ•°12ã§æœ€å¯†å……å¡«ã€BCCã¯é…ä½æ•°8ã§ã‚„ã‚„ç–ãªæ§‹é€ ã§ã™ã€‚</p>

        <hr>

        <h2>3.4 çµæ™¶æ§‹é€ ã¨ææ–™ç‰¹æ€§</h2>

        <h3>å¯†åº¦ã®è¨ˆç®—</h3>

        <p>çµæ™¶æ§‹é€ ã‹ã‚‰ææ–™ã®ç†è«–å¯†åº¦ã‚’è¨ˆç®—ã§ãã¾ã™ï¼š</p>

        <p>$$\rho = \frac{n \cdot M}{V_{cell} \cdot N_A}$$</p>

        <p>ã“ã“ã§ã€</p>
        <ul>
            <li>$\rho$: å¯†åº¦ï¼ˆg/cmÂ³ï¼‰</li>
            <li>$n$: å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°</li>
            <li>$M$: åŸå­é‡ï¼ˆg/molï¼‰</li>
            <li>$V_{cell}$: å˜ä½æ ¼å­ã®ä½“ç©ï¼ˆcmÂ³ï¼‰</li>
            <li>$N_A$: ã‚¢ãƒœã‚¬ãƒ‰ãƒ­æ•°ï¼ˆ6.022Ã—10Â²Â³ molâ»Â¹ï¼‰</li>
        </ul>

        <h3>ã™ã¹ã‚Šç³»ã¨å»¶æ€§</h3>

        <p><strong>ã™ã¹ã‚Šç³»ï¼ˆSlip Systemï¼‰</strong>ã¯ã€å¡‘æ€§å¤‰å½¢æ™‚ã«åŸå­é¢ãŒã™ã¹ã‚‹é¢ã¨æ–¹å‘ã®çµ„ã¿åˆã‚ã›ã§ã™ã€‚ã™ã¹ã‚Šç³»ãŒå¤šã„ã»ã©ã€ææ–™ã¯å»¶æ€§ã«å„ªã‚Œã¾ã™ã€‚</p>

        <p><strong>ä¸»è¦ãªçµæ™¶æ§‹é€ ã®ã™ã¹ã‚Šç³»</strong>:</p>
        <ul>
            <li><strong>FCC</strong>: {111}âŸ¨110âŸ© â†’ 4é¢ Ã— 3æ–¹å‘ = 12ã™ã¹ã‚Šç³» â†’ å»¶æ€§å¤§</li>
            <li><strong>BCC</strong>: {110}âŸ¨111âŸ©, {112}âŸ¨111âŸ©, {123}âŸ¨111âŸ© â†’ 48ã™ã¹ã‚Šç³»ï¼ˆç†è«–ä¸Šï¼‰â†’ å»¶æ€§ä¸­</li>
            <li><strong>HCP</strong>: {0001}âŸ¨11Ì„20âŸ© â†’ 1é¢ Ã— 3æ–¹å‘ = 3ã™ã¹ã‚Šç³» â†’ å»¶æ€§å°</li>
        </ul>

        <p><strong>çµæ™¶æ§‹é€ ã¨æ©Ÿæ¢°çš„æ€§è³ªã®é–¢ä¿‚</strong>:</p>
        <ul>
            <li>FCCé‡‘å±ï¼ˆCu, Al, Auï¼‰: å¤šãã®ã™ã¹ã‚Šç³» â†’ å»¶æ€§å¤§ã€åŠ å·¥æ€§è‰¯å¥½</li>
            <li>BCCé‡‘å±ï¼ˆFe, Cr, Wï¼‰: æ¸©åº¦ä¾å­˜æ€§å¤§ â†’ ä½æ¸©ã§è„†æ€§ã€é«˜æ¸©ã§å»¶æ€§</li>
            <li>HCPé‡‘å±ï¼ˆMg, Zn, Tiï¼‰: ã™ã¹ã‚Šç³»å°‘ â†’ å»¶æ€§å°ã€åŠ å·¥å›°é›£</li>
        </ul>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹5: å¯†åº¦è¨ˆç®—ãƒ„ãƒ¼ãƒ«</h3>

        <p>çµæ™¶æ§‹é€ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ææ–™ã®ç†è«–å¯†åº¦ã‚’è¨ˆç®—ã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">import numpy as np

# ã‚¢ãƒœã‚¬ãƒ‰ãƒ­æ•°
NA = 6.022e23  # mol^-1

def calculate_density(n_atoms, atomic_mass, a, b=None, c=None,
                     alpha=90, beta=90, gamma=90):
    """
    çµæ™¶æ§‹é€ ã‹ã‚‰ç†è«–å¯†åº¦ã‚’è¨ˆç®—

    Parameters:
    n_atoms: å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°
    atomic_mass: åŸå­é‡ (g/mol)
    a, b, c: æ ¼å­å®šæ•° (Ã…)
    alpha, beta, gamma: è§’åº¦ (åº¦)

    Returns:
    density: å¯†åº¦ (g/cmÂ³)
    """
    # æ ¼å­å®šæ•°ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤è¨­å®š
    if b is None:
        b = a
    if c is None:
        c = a

    # è§’åº¦ã‚’ãƒ©ã‚¸ã‚¢ãƒ³ã«å¤‰æ›
    alpha_rad = np.radians(alpha)
    beta_rad = np.radians(beta)
    gamma_rad = np.radians(gamma)

    # å˜ä½æ ¼å­ä½“ç©ã®è¨ˆç®—ï¼ˆÃ…Â³ï¼‰
    cos_alpha = np.cos(alpha_rad)
    cos_beta = np.cos(beta_rad)
    cos_gamma = np.cos(gamma_rad)

    V_cell = a * b * c * np.sqrt(
        1 - cos_alpha**2 - cos_beta**2 - cos_gamma**2
        + 2*cos_alpha*cos_beta*cos_gamma
    )

    # Ã…Â³ â†’ cmÂ³ã«å¤‰æ›ï¼ˆ1 Ã… = 10^-8 cmï¼‰
    V_cell_cm3 = V_cell * 1e-24

    # å¯†åº¦è¨ˆç®—
    density = (n_atoms * atomic_mass) / (V_cell_cm3 * NA)

    return density


# ä»£è¡¨çš„ãªææ–™ã®ç†è«–å¯†åº¦ã‚’è¨ˆç®—
print("="*70)
print("çµæ™¶æ§‹é€ ã‹ã‚‰è¨ˆç®—ã—ãŸç†è«–å¯†åº¦")
print("="*70)

materials = [
    {
        'name': 'éŠ…ï¼ˆCu, FCCï¼‰',
        'n_atoms': 4,
        'atomic_mass': 63.546,  # g/mol
        'a': 3.615,  # Ã…
        'structure': 'FCC'
    },
    {
        'name': 'é‰„ï¼ˆFe, BCCï¼‰',
        'n_atoms': 2,
        'atomic_mass': 55.845,
        'a': 2.866,
        'structure': 'BCC'
    },
    {
        'name': 'ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ï¼ˆAl, FCCï¼‰',
        'n_atoms': 4,
        'atomic_mass': 26.982,
        'a': 4.049,
        'structure': 'FCC'
    },
    {
        'name': 'ã‚¿ãƒ³ã‚°ã‚¹ãƒ†ãƒ³ï¼ˆW, BCCï¼‰',
        'n_atoms': 2,
        'atomic_mass': 183.84,
        'a': 3.165,
        'structure': 'BCC'
    },
    {
        'name': 'ãƒã‚°ãƒã‚·ã‚¦ãƒ ï¼ˆMg, HCPï¼‰',
        'n_atoms': 6,
        'atomic_mass': 24.305,
        'a': 3.209,
        'c': 5.211,
        'gamma': 120,
        'structure': 'HCP'
    },
    {
        'name': 'é‡‘ï¼ˆAu, FCCï¼‰',
        'n_atoms': 4,
        'atomic_mass': 196.967,
        'a': 4.078,
        'structure': 'FCC'
    }
]

# å¯†åº¦è¨ˆç®—ã¨è¡¨ç¤º
calculated_densities = []
experimental_densities = [8.96, 7.87, 2.70, 19.25, 1.74, 19.32]  # g/cmÂ³ï¼ˆå®Ÿæ¸¬å€¤ï¼‰

for i, mat in enumerate(materials):
    if 'c' in mat:
        density = calculate_density(mat['n_atoms'], mat['atomic_mass'],
                                   mat['a'], c=mat['c'], gamma=mat.get('gamma', 90))
    else:
        density = calculate_density(mat['n_atoms'], mat['atomic_mass'], mat['a'])

    calculated_densities.append(density)

    print(f"\nã€{mat['name']}ã€‘")
    print(f"çµæ™¶æ§‹é€ : {mat['structure']}")
    print(f"å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: {mat['n_atoms']}")
    print(f"åŸå­é‡: {mat['atomic_mass']} g/mol")
    print(f"æ ¼å­å®šæ•° a = {mat['a']} Ã…" + (f", c = {mat['c']} Ã…" if 'c' in mat else ""))
    print(f"è¨ˆç®—å¯†åº¦: {density:.3f} g/cmÂ³")
    print(f"å®Ÿæ¸¬å¯†åº¦: {experimental_densities[i]:.3f} g/cmÂ³")
    print(f"èª¤å·®: {abs(density - experimental_densities[i]) / experimental_densities[i] * 100:.2f}%")

# æ¯”è¼ƒã‚°ãƒ©ãƒ•
import matplotlib.pyplot as plt

fig, ax = plt.subplots(figsize=(12, 6))

x = np.arange(len(materials))
width = 0.35

rects1 = ax.bar(x - width/2, calculated_densities, width, label='è¨ˆç®—å¯†åº¦',
                color='#1f77b4', edgecolor='black', linewidth=1.5, alpha=0.7)
rects2 = ax.bar(x + width/2, experimental_densities, width, label='å®Ÿæ¸¬å¯†åº¦',
                color='#ff7f0e', edgecolor='black', linewidth=1.5, alpha=0.7)

ax.set_ylabel('å¯†åº¦ (g/cmÂ³)', fontsize=13, fontweight='bold')
ax.set_title('çµæ™¶æ§‹é€ ã‹ã‚‰è¨ˆç®—ã—ãŸå¯†åº¦ã¨å®Ÿæ¸¬å€¤ã®æ¯”è¼ƒ', fontsize=14, fontweight='bold')
ax.set_xticks(x)
ax.set_xticklabels([m['name'].split('ï¼ˆ')[0] for m in materials], rotation=15, ha='right')
ax.legend(fontsize=11)
ax.grid(axis='y', alpha=0.3)

# å€¤ã‚’ãƒãƒ¼ã®ä¸Šã«è¡¨ç¤º
for rect1, rect2 in zip(rects1, rects2):
    height1 = rect1.get_height()
    height2 = rect2.get_height()
    ax.text(rect1.get_x() + rect1.get_width()/2., height1,
            f'{height1:.2f}', ha='center', va='bottom', fontsize=8)
    ax.text(rect2.get_x() + rect2.get_width()/2., height2,
            f'{height2:.2f}', ha='center', va='bottom', fontsize=8)

plt.tight_layout()
plt.show()

print("\n" + "="*70)
print("å¯†åº¦è¨ˆç®—ã®å¿œç”¨:")
print("- ææ–™ã®åŒå®šï¼ˆXRDãƒ‘ã‚¿ãƒ¼ãƒ³ã¨å¯†åº¦ã‹ã‚‰çµæ™¶æ§‹é€ ã‚’æ±ºå®šï¼‰")
print("- æ¬ é™¥ã‚„ä¸ç´”ç‰©ã®è©•ä¾¡ï¼ˆå®Ÿæ¸¬å¯†åº¦ã¨ç†è«–å¯†åº¦ã®å·®ã‹ã‚‰ç©ºå­”æ¿ƒåº¦ã‚’æ¨å®šï¼‰")
print("- è»½é‡åŒ–è¨­è¨ˆï¼ˆå¯†åº¦ã¨å¼·åº¦ã®ãƒãƒ©ãƒ³ã‚¹æœ€é©åŒ–ï¼‰")
</code></pre>

        <p><strong>å‡ºåŠ›ä¾‹</strong>:</p>
        <pre><code>======================================================================
çµæ™¶æ§‹é€ ã‹ã‚‰è¨ˆç®—ã—ãŸç†è«–å¯†åº¦
======================================================================

ã€éŠ…ï¼ˆCu, FCCï¼‰ã€‘
çµæ™¶æ§‹é€ : FCC
å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: 4
åŸå­é‡: 63.546 g/mol
æ ¼å­å®šæ•° a = 3.615 Ã…
è¨ˆç®—å¯†åº¦: 8.933 g/cmÂ³
å®Ÿæ¸¬å¯†åº¦: 8.960 g/cmÂ³
èª¤å·®: 0.30%

ã€é‰„ï¼ˆFe, BCCï¼‰ã€‘
çµæ™¶æ§‹é€ : BCC
å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: 2
åŸå­é‡: 55.845 g/mol
æ ¼å­å®šæ•° a = 2.866 Ã…
è¨ˆç®—å¯†åº¦: 7.879 g/cmÂ³
å®Ÿæ¸¬å¯†åº¦: 7.870 g/cmÂ³
èª¤å·®: 0.11%</code></pre>

        <p><strong>è§£èª¬</strong>: çµæ™¶æ§‹é€ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‹ã‚‰ç†è«–å¯†åº¦ã‚’é«˜ç²¾åº¦ã§è¨ˆç®—ã§ãã¾ã™ã€‚è¨ˆç®—å€¤ã¨å®Ÿæ¸¬å€¤ã®å·®ã‹ã‚‰ã€ç©ºå­”ãªã©ã®æ¬ é™¥æ¿ƒåº¦ã‚’æ¨å®šã§ãã¾ã™ã€‚</p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹6: ã™ã¹ã‚Šç³»ã®å¯è¦–åŒ–</h3>

        <p>FCCæ§‹é€ ã®ä¸»è¦ãªã™ã¹ã‚Šç³»{111}âŸ¨110âŸ©ã‚’2Dã§å¯è¦–åŒ–ã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Polygon, FancyArrowPatch

def visualize_slip_systems_fcc():
    """
    FCCæ§‹é€ ã®ã™ã¹ã‚Šç³»ã‚’2DæŠ•å½±ã§å¯è¦–åŒ–
    {111}<110>ã™ã¹ã‚Šç³»
    """
    fig, axes = plt.subplots(1, 3, figsize=(16, 5))

    # (111)é¢ã®æŠ•å½±ã‚’æç”»
    # FCCæ§‹é€ ã®å˜ä½æ ¼å­ï¼ˆç°¡ç•¥åŒ–ã—ãŸ2Dè¡¨ç¾ï¼‰

    # ã™ã¹ã‚Šé¢ã¨ã™ã¹ã‚Šæ–¹å‘ã®ä¾‹
    slip_systems = [
        {
            'plane': '(111)',
            'direction': '[1Ì„10]',
            'description': 'æœ€ã‚‚æ´»å‹•çš„ãªã™ã¹ã‚Šç³»'
        },
        {
            'plane': '(1Ì„11)',
            'direction': '[110]',
            'description': 'å¯¾ç§°çš„ãªã™ã¹ã‚Šç³»'
        },
        {
            'plane': '(11Ì„1)',
            'direction': '[101]',
            'description': 'è¿½åŠ ã®ã™ã¹ã‚Šç³»'
        }
    ]

    for idx, (ax, slip_sys) in enumerate(zip(axes, slip_systems)):
        # åŸå­ä½ç½®ï¼ˆç°¡ç•¥åŒ–ã—ãŸ2Dé…åˆ—ï¼‰
        atoms_x = [0, 1, 2, 0.5, 1.5, 1]
        atoms_y = [0, 0, 0, 0.866, 0.866, 1.732]

        # åŸå­ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
        ax.scatter(atoms_x, atoms_y, s=300, c='lightblue',
                  edgecolors='black', linewidth=2, zorder=3)

        # ã™ã¹ã‚Šé¢ã‚’è¡¨ç¤ºï¼ˆç°è‰²ã®å¸¯ï¼‰
        slip_plane = Polygon([(0, 0), (2, 0), (2.5, 0.866), (0.5, 0.866)],
                            alpha=0.2, facecolor='gray', edgecolor='black',
                            linewidth=1.5, linestyle='--', zorder=1)
        ax.add_patch(slip_plane)

        # ã™ã¹ã‚Šæ–¹å‘ã‚’çŸ¢å°ã§è¡¨ç¤º
        arrow = FancyArrowPatch((0.5, 0.4), (1.8, 0.4),
                               arrowstyle='->', mutation_scale=30,
                               linewidth=3, color='red', zorder=2)
        ax.add_patch(arrow)

        ax.set_xlim(-0.5, 3)
        ax.set_ylim(-0.5, 2.5)
        ax.set_aspect('equal')
        ax.set_title(f'{slip_sys["plane"]} é¢\n{slip_sys["direction"]} æ–¹å‘\n({slip_sys["description"]})',
                    fontsize=11, fontweight='bold')
        ax.axis('off')

        # å‡¡ä¾‹
        ax.text(0.1, 2.2, 'â— åŸå­', fontsize=9)
        ax.text(0.1, 2.0, '   ã™ã¹ã‚Šé¢', fontsize=9, color='gray')
        ax.text(0.1, 1.8, 'â†’ ã™ã¹ã‚Šæ–¹å‘', fontsize=9, color='red')

    plt.suptitle('FCCæ§‹é€ ã®ã™ã¹ã‚Šç³» {111}âŸ¨110âŸ©ï¼ˆåˆè¨ˆ12ç³»ï¼‰',
                fontsize=14, fontweight='bold', y=0.98)
    plt.tight_layout()
    plt.show()

    # ã™ã¹ã‚Šç³»ã®æ•°ã¨å»¶æ€§ã®é–¢ä¿‚ã‚’èª¬æ˜
    print("="*70)
    print("ã™ã¹ã‚Šç³»ã¨ææ–™ã®å»¶æ€§")
    print("="*70)

    print("\nã€FCCæ§‹é€ ã€‘")
    print("- ã™ã¹ã‚Šé¢: {111}ï¼ˆ4é¢ï¼‰")
    print("- ã™ã¹ã‚Šæ–¹å‘: âŸ¨110âŸ©ï¼ˆå„é¢ã«3æ–¹å‘ï¼‰")
    print("- åˆè¨ˆã™ã¹ã‚Šç³»: 4 Ã— 3 = 12")
    print("- å»¶æ€§: éå¸¸ã«é«˜ã„ï¼ˆå¤šãã®ã™ã¹ã‚Šç³»ï¼‰")
    print("- ä»£è¡¨ä¾‹: Cu, Al, Au, Ag â†’ å®¹æ˜“ã«å¡‘æ€§å¤‰å½¢")

    print("\nã€BCCæ§‹é€ ã€‘")
    print("- ã™ã¹ã‚Šé¢: {110}, {112}, {123}ï¼ˆè¤‡æ•°ï¼‰")
    print("- ã™ã¹ã‚Šæ–¹å‘: âŸ¨111âŸ©")
    print("- åˆè¨ˆã™ã¹ã‚Šç³»: 48ï¼ˆç†è«–ä¸Šï¼‰")
    print("- å»¶æ€§: æ¸©åº¦ä¾å­˜æ€§å¤§ï¼ˆä½æ¸©ã§åˆ¶é™ã•ã‚Œã‚‹ï¼‰")
    print("- ä»£è¡¨ä¾‹: Fe, Cr, W â†’ ä½æ¸©ã§è„†æ€§ç ´å£Šã—ã‚„ã™ã„")

    print("\nã€HCPæ§‹é€ ã€‘")
    print("- ã™ã¹ã‚Šé¢: {0001}ï¼ˆ1é¢ã€åŸºåº•é¢ï¼‰")
    print("- ã™ã¹ã‚Šæ–¹å‘: âŸ¨112Ì„0âŸ©ï¼ˆ3æ–¹å‘ï¼‰")
    print("- åˆè¨ˆã™ã¹ã‚Šç³»: 1 Ã— 3 = 3ï¼ˆéå¸¸ã«å°‘ãªã„ï¼‰")
    print("- å»¶æ€§: ä½ã„ï¼ˆã™ã¹ã‚Šç³»ãŒé™å®šçš„ï¼‰")
    print("- ä»£è¡¨ä¾‹: Mg, Zn, Ti â†’ å¸¸æ¸©åŠ å·¥å›°é›£")

    print("\n" + "="*70)
    print("ã™ã¹ã‚Šç³»ã®å¤šã•ã¨åŠ å·¥æ€§:")
    print("- ã™ã¹ã‚Šç³»ãŒå¤šã„ â†’ å¡‘æ€§å¤‰å½¢ã—ã‚„ã™ã„ â†’ å»¶æ€§å¤§ã€åŠ å·¥æ€§è‰¯")
    print("- ã™ã¹ã‚Šç³»ãŒå°‘ãªã„ â†’ å¡‘æ€§å¤‰å½¢å›°é›£ â†’ å»¶æ€§å°ã€è„†æ€§ç ´å£Šã—ã‚„ã™ã„")
    print("- ææ–™é¸æŠ: åŠ å·¥ãŒå¿…è¦ãªç”¨é€”ã§ã¯FCCé‡‘å±ãŒæœ‰åˆ©")


# å®Ÿè¡Œ
visualize_slip_systems_fcc()
</code></pre>

        <p><strong>è§£èª¬</strong>: ã™ã¹ã‚Šç³»ã¯ã€å¡‘æ€§å¤‰å½¢æ™‚ã«åŸå­é¢ãŒã™ã¹ã‚‹é¢ã¨æ–¹å‘ã®çµ„ã¿åˆã‚ã›ã§ã™ã€‚ã™ã¹ã‚Šç³»ãŒå¤šã„ã»ã©ã€ææ–™ã¯æ§˜ã€…ãªæ–¹å‘ã‹ã‚‰åŠ›ã‚’å—ã‘ã¦ã‚‚å¡‘æ€§å¤‰å½¢ã§ãã€å»¶æ€§ã«å„ªã‚Œã¾ã™ã€‚FCCã¯12ã™ã¹ã‚Šç³»ã§å»¶æ€§å¤§ã€HCPã¯3ã™ã¹ã‚Šç³»ã§å»¶æ€§å°ã§ã™ã€‚</p>

        <h3>ã‚³ãƒ¼ãƒ‰ä¾‹7: 3Dçµæ™¶æ§‹é€ ã®å¯è¦–åŒ–ï¼ˆFCC, BCC, HCPï¼‰</h3>

        <p>ä¸»è¦ãª3ã¤ã®çµæ™¶æ§‹é€ ã‚’3Dã§å¯è¦–åŒ–ã—ã€æ§‹é€ ã®é•ã„ã‚’ç†è§£ã—ã¾ã™ã€‚</p>

        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

def plot_crystal_structure_3d(structure_type='FCC'):
    """
    çµæ™¶æ§‹é€ ã‚’3Dã§å¯è¦–åŒ–

    Parameters:
    structure_type: 'FCC', 'BCC', 'HCP'ã®ã„ãšã‚Œã‹
    """
    fig = plt.figure(figsize=(10, 8))
    ax = fig.add_subplot(111, projection='3d')

    # æ ¼å­å®šæ•°ï¼ˆè¦æ ¼åŒ–: a=1ï¼‰
    a = 1.0

    if structure_type == 'FCC':
        # FCCæ§‹é€ ã®åŸå­ä½ç½®
        positions = [
            # é ‚ç‚¹ã®8å€‹ï¼ˆå„1/8ï¼‰
            [0, 0, 0], [a, 0, 0], [a, a, 0], [0, a, 0],
            [0, 0, a], [a, 0, a], [a, a, a], [0, a, a],
            # é¢å¿ƒã®6å€‹ï¼ˆå„1/2ï¼‰
            [a/2, a/2, 0], [a/2, 0, a/2], [0, a/2, a/2],
            [a/2, a/2, a], [a/2, a, a/2], [a, a/2, a/2]
        ]
        title = 'FCCï¼ˆé¢å¿ƒç«‹æ–¹æ ¼å­ï¼‰'
        description = 'å˜ä½æ ¼å­ã‚ãŸã‚Š4åŸå­\né…ä½æ•°12ã€å……å¡«ç‡74%'

    elif structure_type == 'BCC':
        # BCCæ§‹é€ ã®åŸå­ä½ç½®
        positions = [
            # é ‚ç‚¹ã®8å€‹ï¼ˆå„1/8ï¼‰
            [0, 0, 0], [a, 0, 0], [a, a, 0], [0, a, 0],
            [0, 0, a], [a, 0, a], [a, a, a], [0, a, a],
            # ä½“å¿ƒã®1å€‹
            [a/2, a/2, a/2]
        ]
        title = 'BCCï¼ˆä½“å¿ƒç«‹æ–¹æ ¼å­ï¼‰'
        description = 'å˜ä½æ ¼å­ã‚ãŸã‚Š2åŸå­\né…ä½æ•°8ã€å……å¡«ç‡68%'

    elif structure_type == 'HCP':
        # HCPæ§‹é€ ã®åŸå­ä½ç½®ï¼ˆç°¡ç•¥åŒ–ã—ãŸè¡¨ç¾ï¼‰
        c_a_ratio = 1.633  # ç†æƒ³çš„ãªc/aæ¯”
        c = a * c_a_ratio

        # åŸºåº•é¢ã®3å€‹ + é ‚ç‚¹ã®3å€‹ + å†…éƒ¨ã®2å€‹
        positions = [
            # ä¸‹å±¤åŸºåº•é¢ï¼ˆ3å€‹ã®è§’ï¼‰
            [0, 0, 0], [a, 0, 0], [a/2, a*np.sqrt(3)/2, 0],
            # ä¸Šå±¤åŸºåº•é¢
            [0, 0, c], [a, 0, c], [a/2, a*np.sqrt(3)/2, c],
            # å†…éƒ¨ï¼ˆ2å€‹ï¼‰
            [a/2, a/(2*np.sqrt(3)), c/2], [a/2, a*np.sqrt(3)/6, c/2]
        ]
        title = 'HCPï¼ˆå…­æ–¹æœ€å¯†å……å¡«ï¼‰'
        description = 'å˜ä½æ ¼å­ã‚ãŸã‚Š6åŸå­\né…ä½æ•°12ã€å……å¡«ç‡74%'
    else:
        raise ValueError("structure_typeã¯'FCC', 'BCC', 'HCP'ã®ã„ãšã‚Œã‹")

    # åŸå­ä½ç½®ã‚’é…åˆ—ã«å¤‰æ›
    positions = np.array(positions)

    # åŸå­ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
    ax.scatter(positions[:, 0], positions[:, 1], positions[:, 2],
              s=300, c='lightblue', edgecolors='darkblue', linewidth=2,
              alpha=0.8, depthshade=True)

    # å˜ä½æ ¼å­ã®æ ã‚’æç”»
    # ç«‹æ–¹ä½“ã®è¾º
    edges = [
        # åº•é¢
        [[0, 0, 0], [a, 0, 0]], [[a, 0, 0], [a, a, 0]],
        [[a, a, 0], [0, a, 0]], [[0, a, 0], [0, 0, 0]],
        # ä¸Šé¢
        [[0, 0, a], [a, 0, a]], [[a, 0, a], [a, a, a]],
        [[a, a, a], [0, a, a]], [[0, a, a], [0, 0, a]],
        # ç¸¦ã®è¾º
        [[0, 0, 0], [0, 0, a]], [[a, 0, 0], [a, 0, a]],
        [[a, a, 0], [a, a, a]], [[0, a, 0], [0, a, a]]
    ]

    if structure_type != 'HCP':
        for edge in edges:
            edge = np.array(edge)
            ax.plot3D(edge[:, 0], edge[:, 1], edge[:, 2],
                     'k-', linewidth=1.5, alpha=0.6)
    else:
        # HCPã®å ´åˆã¯å…­è§’æŸ±ã®æ 
        # ç°¡ç•¥åŒ–ã®ãŸã‚çœç•¥ï¼ˆå®Ÿè£…ã¯è¤‡é›‘ï¼‰
        pass

    # è»¸ãƒ©ãƒ™ãƒ«
    ax.set_xlabel('X', fontsize=12, fontweight='bold')
    ax.set_ylabel('Y', fontsize=12, fontweight='bold')
    ax.set_zlabel('Z', fontsize=12, fontweight='bold')
    ax.set_title(f'{title}\n{description}', fontsize=13, fontweight='bold', pad=20)

    # è¦–ç‚¹ã®èª¿æ•´
    ax.view_init(elev=20, azim=45)
    ax.set_box_aspect([1,1,1])

    # ã‚°ãƒªãƒƒãƒ‰ã‚’ã‚ªãƒ•
    ax.grid(False)

    return fig, ax


# 3ã¤ã®çµæ™¶æ§‹é€ ã‚’ä¸¦ã¹ã¦è¡¨ç¤º
fig = plt.figure(figsize=(18, 6))

for i, structure in enumerate(['FCC', 'BCC', 'HCP'], 1):
    ax = fig.add_subplot(1, 3, i, projection='3d')

    # æ ¼å­å®šæ•°
    a = 1.0

    if structure == 'FCC':
        positions = np.array([
            [0, 0, 0], [a, 0, 0], [a, a, 0], [0, a, 0],
            [0, 0, a], [a, 0, a], [a, a, a], [0, a, a],
            [a/2, a/2, 0], [a/2, 0, a/2], [0, a/2, a/2],
            [a/2, a/2, a], [a/2, a, a/2], [a, a/2, a/2]
        ])
        title = 'FCC'
        info = 'åŸå­æ•°: 4\né…ä½æ•°: 12\nAPF: 74%'

    elif structure == 'BCC':
        positions = np.array([
            [0, 0, 0], [a, 0, 0], [a, a, 0], [0, a, 0],
            [0, 0, a], [a, 0, a], [a, a, a], [0, a, a],
            [a/2, a/2, a/2]
        ])
        title = 'BCC'
        info = 'åŸå­æ•°: 2\né…ä½æ•°: 8\nAPF: 68%'

    else:  # HCP
        c = a * 1.633
        positions = np.array([
            [0, 0, 0], [a, 0, 0], [a/2, a*np.sqrt(3)/2, 0],
            [0, 0, c], [a, 0, c], [a/2, a*np.sqrt(3)/2, c],
            [a/2, a/(2*np.sqrt(3)), c/2]
        ])
        title = 'HCP'
        info = 'åŸå­æ•°: 6\né…ä½æ•°: 12\nAPF: 74%'

    # åŸå­ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
    ax.scatter(positions[:, 0], positions[:, 1], positions[:, 2],
              s=250, c='lightblue', edgecolors='darkblue', linewidth=2,
              alpha=0.8, depthshade=True)

    # å˜ä½æ ¼å­ã®æ 
    if structure != 'HCP':
        edges = [
            [[0, 0, 0], [a, 0, 0]], [[a, 0, 0], [a, a, 0]],
            [[a, a, 0], [0, a, 0]], [[0, a, 0], [0, 0, 0]],
            [[0, 0, a], [a, 0, a]], [[a, 0, a], [a, a, a]],
            [[a, a, a], [0, a, a]], [[0, a, a], [0, 0, a]],
            [[0, 0, 0], [0, 0, a]], [[a, 0, 0], [a, 0, a]],
            [[a, a, 0], [a, a, a]], [[0, a, 0], [0, a, a]]
        ]
        for edge in edges:
            edge = np.array(edge)
            ax.plot3D(edge[:, 0], edge[:, 1], edge[:, 2],
                     'k-', linewidth=1.5, alpha=0.5)

    ax.set_xlabel('X', fontsize=10)
    ax.set_ylabel('Y', fontsize=10)
    ax.set_zlabel('Z', fontsize=10)
    ax.set_title(f'{title}\n{info}', fontsize=12, fontweight='bold')
    ax.view_init(elev=20, azim=45)
    ax.set_box_aspect([1,1,1])
    ax.grid(False)

plt.suptitle('ä¸»è¦ãªçµæ™¶æ§‹é€ ã®3Då¯è¦–åŒ–', fontsize=15, fontweight='bold', y=0.98)
plt.tight_layout()
plt.show()

print("="*70)
print("çµæ™¶æ§‹é€ å¯è¦–åŒ–ã®æ„ç¾©:")
print("="*70)
print("\n3Då¯è¦–åŒ–ã«ã‚ˆã‚Šä»¥ä¸‹ã‚’ç†è§£:")
print("- åŸå­ã®ç©ºé–“é…ç½®ï¼ˆã©ã“ã«åŸå­ãŒä½ç½®ã™ã‚‹ã‹ï¼‰")
print("- å……å¡«ã®ã•ã‚Œæ–¹ï¼ˆå¯†ã«è©°ã¾ã£ã¦ã„ã‚‹ã‹ã€ã™ãé–“ãŒã‚ã‚‹ã‹ï¼‰")
print("- å¯¾ç§°æ€§ï¼ˆæ§‹é€ ã®ç¾ã—ã•ã¨ç‰©æ€§ã®é–¢ä¿‚ï¼‰")
print("- ã™ã¹ã‚Šé¢ã®äºˆæ¸¬ï¼ˆã©ã®é¢ãŒã™ã¹ã‚Šã‚„ã™ã„ã‹ï¼‰")

print("\nå®Ÿéš›ã®ææ–™é–‹ç™ºã§ã®æ´»ç”¨:")
print("- æ–°ææ–™ã®çµæ™¶æ§‹é€ äºˆæ¸¬")
print("- ç›¸å¤‰æ…‹ã®ç†è§£ï¼ˆFCCâ†’BCCãªã©ï¼‰")
print("- ææ–™ç‰¹æ€§ã®äºˆæ¸¬ï¼ˆæ§‹é€ ã‹ã‚‰æ€§è³ªã‚’æ¨å®šï¼‰")
</code></pre>

        <p><strong>è§£èª¬</strong>: 3Då¯è¦–åŒ–ã«ã‚ˆã‚Šã€FCC, BCC, HCPã®åŸå­é…ç½®ã®é•ã„ãŒæ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚FCCã¨BCCã¯ç«‹æ–¹æ™¶ç³»ã€HCPã¯å…­æ–¹æ™¶ç³»ã§ã‚ã‚Šã€åŸå­ã®è©°ã¾ã‚Šæ–¹ï¼ˆå……å¡«ç‡ï¼‰ã‚„é…ä½æ•°ãŒç•°ãªã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®é•ã„ãŒææ–™ã®æ©Ÿæ¢°çš„æ€§è³ªã«å¤§ããå½±éŸ¿ã—ã¾ã™ã€‚</p>

        <hr>

        <h2>3.5 æœ¬ç« ã®ã¾ã¨ã‚</h2>

        <h3>å­¦ã‚“ã ã“ã¨</h3>

        <ol>
            <li><strong>çµæ™¶ã¨éæ™¶è³ªã®é•ã„</strong>
                <ul>
                    <li>çµæ™¶: é•·è·é›¢ç§©åºã‚ã‚Šã€æ˜ç¢ºãªèç‚¹ã€é‹­ã„XRDãƒ”ãƒ¼ã‚¯</li>
                    <li>éæ™¶è³ª: çŸ­è·é›¢ç§©åºã®ã¿ã€ã‚¬ãƒ©ã‚¹è»¢ç§»ã€ãƒ–ãƒ­ãƒ¼ãƒ‰ãªXRDãƒ‘ã‚¿ãƒ¼ãƒ³</li>
                </ul>
            </li>
            <li><strong>å˜ä½æ ¼å­ã¨æ ¼å­å®šæ•°</strong>
                <ul>
                    <li>å˜ä½æ ¼å­: çµæ™¶ã®æœ€å°ç¹°ã‚Šè¿”ã—å˜ä½</li>
                    <li>7ã¤ã®çµæ™¶ç³»: ç«‹æ–¹ã€æ­£æ–¹ã€æ–œæ–¹ã€å…­æ–¹ã€ä¸‰æ–¹ã€å˜æ–œã€ä¸‰æ–œ</li>
                    <li>ãƒŸãƒ©ãƒ¼æŒ‡æ•°: (hkl)ã§çµæ™¶é¢ã€[uvw]ã§æ–¹å‘ã‚’è¡¨è¨˜</li>
                </ul>
            </li>
            <li><strong>ä¸»è¦ãªçµæ™¶æ§‹é€ </strong>
                <ul>
                    <li>FCC: åŸå­æ•°4ã€é…ä½æ•°12ã€APF 74%ã€å»¶æ€§å¤§ï¼ˆCu, Al, Auï¼‰</li>
                    <li>BCC: åŸå­æ•°2ã€é…ä½æ•°8ã€APF 68%ã€å¼·åº¦é«˜ï¼ˆFe, Cr, Wï¼‰</li>
                    <li>HCP: åŸå­æ•°6ã€é…ä½æ•°12ã€APF 74%ã€å»¶æ€§å°ï¼ˆMg, Zn, Tiï¼‰</li>
                </ul>
            </li>
            <li><strong>çµæ™¶æ§‹é€ ã¨ææ–™ç‰¹æ€§</strong>
                <ul>
                    <li>å¯†åº¦ã¯çµæ™¶æ§‹é€ ã‹ã‚‰è¨ˆç®—å¯èƒ½</li>
                    <li>ã™ã¹ã‚Šç³»ã®å¤šã•ãŒå»¶æ€§ã‚’æ±ºå®š</li>
                    <li>FCC: 12ã™ã¹ã‚Šç³» â†’ å»¶æ€§å¤§</li>
                    <li>HCP: 3ã™ã¹ã‚Šç³» â†’ å»¶æ€§å°</li>
                </ul>
            </li>
            <li><strong>Pythonã«ã‚ˆã‚‹å¯è¦–åŒ–</strong>
                <ul>
                    <li>XRDãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</li>
                    <li>å……å¡«ç‡ã¨é…ä½æ•°ã®è¨ˆç®—</li>
                    <li>å¯†åº¦è¨ˆç®—ãƒ„ãƒ¼ãƒ«</li>
                    <li>3Dçµæ™¶æ§‹é€ ã®å¯è¦–åŒ–</li>
                </ul>
            </li>
        </ol>

        <h3>é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h3>

        <ul>
            <li>çµæ™¶æ§‹é€ ã¯<strong>ææ–™ã®æ©Ÿæ¢°çš„æ€§è³ªã‚’æ”¯é…ã™ã‚‹</strong>é‡è¦å› å­</li>
            <li>å……å¡«ç‡ãŒé«˜ã„ã»ã©ã€ä¸€èˆ¬ã«å¯†åº¦ãŒé«˜ãã€å»¶æ€§ã«å„ªã‚Œã‚‹</li>
            <li>ã™ã¹ã‚Šç³»ã®æ•°ãŒå»¶æ€§ã‚’æ±ºå®šï¼ˆå¤šã„ã»ã©å»¶æ€§å¤§ï¼‰</li>
            <li>XRDã¯çµæ™¶æ§‹é€ è§£æã®æœ€ã‚‚é‡è¦ãªæ‰‹æ³•</li>
            <li>ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¯çµæ™¶é¢ã¨æ–¹å‘ã‚’è¡¨è¨˜ã™ã‚‹æ¨™æº–çš„ãªæ–¹æ³•</li>
        </ul>

        <h3>æ¬¡ã®ç« ã¸</h3>

        <p>ç¬¬4ç« ã§ã¯ã€<strong>ææ–™ã®æ€§è³ªã¨æ§‹é€ ã®é–¢ä¿‚</strong>ã‚’å­¦ã³ã¾ã™ï¼š</p>
        <ul>
            <li>æ©Ÿæ¢°çš„æ€§è³ªï¼ˆå¿œåŠ›-ã²ãšã¿æ›²ç·šã€ç¡¬åº¦ï¼‰</li>
            <li>é›»æ°—çš„æ€§è³ªï¼ˆãƒãƒ³ãƒ‰æ§‹é€ ã€å°é›»æ€§ï¼‰</li>
            <li>ç†±çš„æ€§è³ªï¼ˆç†±ä¼å°ç‡ã€ç†±è†¨å¼µï¼‰</li>
            <li>å…‰å­¦çš„æ€§è³ªï¼ˆå¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã€è‰²ï¼‰</li>
            <li>Pythonã«ã‚ˆã‚‹ææ–™ç‰¹æ€§ã®è¨ˆç®—ã¨ãƒ—ãƒ­ãƒƒãƒˆ</li>
        </ul>

        <div class="navigation">
            <a href="chapter-2.html" class="nav-button">â† å‰ã®ç« ï¼šåŸå­æ§‹é€ ã¨åŒ–å­¦çµåˆ</a>
            <a href="index.html" class="nav-button">ã‚·ãƒªãƒ¼ã‚ºç›®æ¬¡</a>
            <a href="chapter-4.html" class="nav-button">æ¬¡ã®ç« ï¼šææ–™ã®æ€§è³ªã¨æ§‹é€ ã®é–¢ä¿‚ â†’</a>
        </div>
    </main>

    
    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

<footer>
        <p><strong>ä½œæˆè€…</strong>: MS Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-25</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
