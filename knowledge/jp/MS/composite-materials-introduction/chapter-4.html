<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç«  è¤‡åˆææ–™ã®è©•ä¾¡ - è¤‡åˆææ–™å…¥é–€</title>
    <meta name="description" content="æ©Ÿæ¢°çš„è©¦é¨“æ³•ã€éç ´å£Šæ¤œæŸ»ã€S-Næ›²ç·šã€ç–²åŠ´å¯¿å‘½äºˆæ¸¬ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚">
    <link rel="stylesheet" href="../../../en/assets/css/knowledge-base.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MS/composite-materials-introduction/chapter-4.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<div class="container">
        <nav class="sidebar">
            <h3>è¤‡åˆææ–™å…¥é–€</h3>
            <ul>
                <li><a href="index.html">ç›®æ¬¡</a></li>
                <li><a href="chapter-1.html">ç¬¬1ç«  è¤‡åˆææ–™ã®åŸºç¤</a></li>
                <li><a href="chapter-2.html">ç¬¬2ç«  ç¹Šç¶­å¼·åŒ–è¤‡åˆææ–™</a></li>
                <li><a href="chapter-3.html">ç¬¬3ç«  ç²’å­ãƒ»ç©å±¤è¤‡åˆææ–™</a></li>
                <li class="active"><a href="chapter-4.html">ç¬¬4ç«  è¤‡åˆææ–™ã®è©•ä¾¡</a></li>
                <li><a href="chapter-5.html">ç¬¬5ç«  Pythonå®Ÿè·µ</a></li>
            </ul>
            <div class="series-nav">
                <h4>Materials Science ã‚·ãƒªãƒ¼ã‚º</h4>
                <ul>
                    <li><a href="../polymer-materials-introduction/index.html">é«˜åˆ†å­ææ–™å…¥é–€</a></li>
                    <li><a href="../thin-film-nano-introduction/index.html">è–„è†œãƒ»ãƒŠãƒææ–™å…¥é–€</a></li>
                    <li class="current-series"><a href="index.html">è¤‡åˆææ–™å…¥é–€</a></li>
                </ul>
            </div>
        </nav>

        <main class="content">
            <article>
                <h1>ç¬¬4ç«  è¤‡åˆææ–™ã®è©•ä¾¡</h1>

                <div class="learning-objectives">
                    <h3>å­¦ç¿’ç›®æ¨™</h3>
                    <ul>
                        <li><strong>åŸºç¤ãƒ¬ãƒ™ãƒ«:</strong> å¼•å¼µãƒ»æ›²ã’ãƒ»ã›ã‚“æ–­è©¦é¨“ã®åŸç†ã‚’ç†è§£ã—ã€åŸºæœ¬çš„ãªæ©Ÿæ¢°çš„ç‰¹æ€§ã‚’æ¸¬å®šã§ãã‚‹</li>
                        <li><strong>å¿œç”¨ãƒ¬ãƒ™ãƒ«:</strong> S-Næ›²ç·šã‹ã‚‰ç–²åŠ´å¯¿å‘½ã‚’äºˆæ¸¬ã—ã€éç ´å£Šæ¤œæŸ»æ³•ã‚’é©åˆ‡ã«é¸å®šã§ãã‚‹</li>
                        <li><strong>ç™ºå±•ãƒ¬ãƒ™ãƒ«:</strong> è¤‡æ•°ã®è©•ä¾¡æ³•ã‚’çµ±åˆã—ã¦ææ–™ã®ä¿¡é ¼æ€§ã‚’ç·åˆè©•ä¾¡ã—ã€å“è³ªä¿è¨¼ä½“ç³»ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
                    </ul>
                </div>

                <section>
                    <h2>4.1 æ©Ÿæ¢°çš„è©¦é¨“æ³•</h2>

                    <h3>4.1.1 å¼•å¼µè©¦é¨“</h3>
                    <p>
                        è¤‡åˆææ–™ã®å¼•å¼µè©¦é¨“ã¯ã€ASTM D3039(ç¹Šç¶­å¼·åŒ–ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯)ã€
                        JIS K 7164(CFRP)ãªã©ã®è¦æ ¼ã«æº–æ‹ ã—ã¦å®Ÿæ–½ã—ã¾ã™ã€‚
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>é …ç›®</th>
                                <th>å†…å®¹</th>
                                <th>æ³¨æ„ç‚¹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>è©¦é¨“ç‰‡å½¢çŠ¶</td>
                                <td>ã‚¹ãƒˆãƒ¬ãƒ¼ãƒˆå‹ã€ãƒ€ãƒ³ãƒ™ãƒ«å‹</td>
                                <td>ã‚¿ãƒ–(ã¤ã‹ã¿éƒ¨è£œå¼·)ãŒå¿…è¦</td>
                            </tr>
                            <tr>
                                <td>å¯¸æ³•</td>
                                <td>é•·ã•250 mmã€å¹…25 mm</td>
                                <td>ç¹Šç¶­é…å‘ã«ã‚ˆã‚Šèª¿æ•´</td>
                            </tr>
                            <tr>
                                <td>ã²ãšã¿é€Ÿåº¦</td>
                                <td>1-2 mm/min</td>
                                <td>æº–é™çš„æ¡ä»¶</td>
                            </tr>
                            <tr>
                                <td>æ¸¬å®šé …ç›®</td>
                                <td>å¼¾æ€§ç‡ã€å¼•å¼µå¼·åº¦ã€ç ´æ–­ã²ãšã¿</td>
                                <td>ã²ãšã¿ã‚²ãƒ¼ã‚¸ã¾ãŸã¯ä¼¸ã³è¨ˆä½¿ç”¨</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mermaid">
                        flowchart TD
                            A[è¤‡åˆææ–™ã®æ©Ÿæ¢°çš„è©¦é¨“] --> B[é™çš„è©¦é¨“]
                            A --> C[å‹•çš„è©¦é¨“]

                            B --> D[å¼•å¼µè©¦é¨“<br/>E, Ïƒ_u, Îµ_f]
                            B --> E[åœ§ç¸®è©¦é¨“<br/>Ïƒ_c, åº§å±ˆ]
                            B --> F[æ›²ã’è©¦é¨“<br/>E_f, Ïƒ_f]
                            B --> G[å±¤é–“ã›ã‚“æ–­è©¦é¨“<br/>Ï„_ILS]

                            C --> H[ç–²åŠ´è©¦é¨“<br/>S-Næ›²ç·š]
                            C --> I[è¡æ’ƒè©¦é¨“<br/>Charpy, Izod]
                            C --> J[ã‚¯ãƒªãƒ¼ãƒ—è©¦é¨“<br/>æ™‚é–“ä¾å­˜å¤‰å½¢]

                            style A fill:#e1f5ff
                            style D fill:#ffe1e1
                            style E fill:#ffe1e1
                            style F fill:#ffe1e1
                            style G fill:#ffe1e1
                            style H fill:#c8e6c9
                            style I fill:#c8e6c9
                            style J fill:#c8e6c9
                    </div>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 4.1: å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®è§£æ</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

def analyze_tensile_test(strain, stress):
    """
    å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ©Ÿæ¢°çš„ç‰¹æ€§ã‚’æŠ½å‡º

    Parameters:
    -----------
    strain : array
        ã²ãšã¿ [-]
    stress : array
        å¿œåŠ› [MPa]

    Returns:
    --------
    properties : dict
        æ©Ÿæ¢°çš„ç‰¹æ€§
    """
    # å¼¾æ€§ç‡(ç·šå½¢é ˜åŸŸã®å‚¾ã)
    linear_region = (strain > 0.0005) & (strain < 0.003)
    slope, intercept, r_value, _, _ = stats.linregress(
        strain[linear_region], stress[linear_region])

    E = slope  # [MPa]

    # å¼•å¼µå¼·åº¦(æœ€å¤§å¿œåŠ›)
    sigma_u = np.max(stress)
    idx_max = np.argmax(stress)

    # ç ´æ–­ã²ãšã¿
    epsilon_f = strain[idx_max]

    # ç ´å£Šã‚¨ãƒãƒ«ã‚®ãƒ¼(å¿œåŠ›-ã²ãšã¿æ›²ç·šä¸‹ã®é¢ç©)
    U_f = np.trapz(stress[:idx_max+1], strain[:idx_max+1])

    properties = {
        'modulus': E,
        'ultimate_strength': sigma_u,
        'failure_strain': epsilon_f,
        'fracture_energy': U_f,
        'r_squared': r_value**2
    }

    return properties

# æ¨¡æ“¬ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ(CFRPä¸€æ–¹å‘æ)
np.random.seed(42)

# ã²ãšã¿ç¯„å›²
strain_max = 0.015
n_points = 200
strain = np.linspace(0, strain_max, n_points)

# ç·šå½¢å¼¾æ€§é ˜åŸŸ
E_true = 140000  # MPa
stress_elastic = E_true * strain

# éç·šå½¢æå‚·é ˜åŸŸ(ç°¡æ˜“ãƒ¢ãƒ‡ãƒ«)
damage_start = 0.008
damage_factor = np.where(
    strain > damage_start,
    1 - 0.3 * ((strain - damage_start) / (strain_max - damage_start))**2,
    1.0
)

stress = stress_elastic * damage_factor

# ãƒã‚¤ã‚ºè¿½åŠ 
noise = np.random.normal(0, 50, n_points)
stress += noise

# ç ´æ–­è¨­å®š
failure_idx = int(0.92 * n_points)
strain = strain[:failure_idx]
stress = stress[:failure_idx]

# ç‰¹æ€§æŠ½å‡º
props = analyze_tensile_test(strain, stress)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å¿œåŠ›-ã²ãšã¿æ›²ç·š
ax1.plot(strain * 100, stress, 'b-', linewidth=2, label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')

# ç·šå½¢å›å¸°ç·š
linear_region = (strain > 0.0005) & (strain < 0.003)
strain_fit = strain[linear_region]
stress_fit = props['modulus'] * strain_fit
ax1.plot(strain_fit * 100, stress_fit, 'r--', linewidth=2,
         label=f"E = {props['modulus']/1000:.1f} GPa (RÂ² = {props['r_squared']:.4f})")

# å¼•å¼µå¼·åº¦ãƒãƒ¼ã‚¯
ax1.plot(props['failure_strain'] * 100, props['ultimate_strength'],
         'ro', markersize=10, label=f"Ïƒ_u = {props['ultimate_strength']:.0f} MPa")

ax1.set_xlabel('ã²ãšã¿ [%]')
ax1.set_ylabel('å¿œåŠ› [MPa]')
ax1.set_title('CFRP ä¸€æ–¹å‘æã®å¼•å¼µè©¦é¨“')
ax1.grid(True, alpha=0.3)
ax1.legend()

# çµ±è¨ˆæƒ…å ±
info_text = f"""æ©Ÿæ¢°çš„ç‰¹æ€§:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ãƒ¤ãƒ³ã‚°ç‡:    {props['modulus']/1000:.1f} GPa
å¼•å¼µå¼·åº¦:    {props['ultimate_strength']:.0f} MPa
ç ´æ–­ã²ãšã¿:  {props['failure_strain']*100:.2f} %
ç ´å£Šã‚¨ãƒãƒ«ã‚®ãƒ¼: {props['fracture_energy']:.1f} J/mÂ³
æ±ºå®šä¿‚æ•°:    {props['r_squared']:.4f}
"""

ax2.text(0.1, 0.5, info_text, fontsize=12, family='monospace',
         verticalalignment='center', bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5))
ax2.axis('off')
ax2.set_title('æ¸¬å®šçµæœ', fontsize=14, weight='bold')

plt.tight_layout()
plt.savefig('tensile_test_analysis.png', dpi=300, bbox_inches='tight')
plt.close()

print(info_text)</code></pre>
                    </div>

                    <h3>4.1.2 æ›²ã’è©¦é¨“</h3>
                    <p>
                        3ç‚¹æ›²ã’è©¦é¨“ã¯ã€è¤‡åˆææ–™ã®æ›²ã’å‰›æ€§ã¨æ›²ã’å¼·åº¦ã‚’è©•ä¾¡ã—ã¾ã™ã€‚
                        ç‰¹ã«ç©å±¤æ¿ã®å±¤é–“å‰¥é›¢ã®åˆæœŸæ¤œå‡ºã«æœ‰åŠ¹ã§ã™ã€‚
                    </p>

                    <p>æ›²ã’å¼¾æ€§ç‡ã®è¨ˆç®—å¼(3ç‚¹æ›²ã’):</p>

                    <div class="formula">
                        $$E_f = \frac{L^3 m}{4bh^3}$$
                    </div>

                    <p>
                        \(L\): æ”¯ç‚¹é–“è·é›¢ã€\(m\): è·é‡-ãŸã‚ã¿æ›²ç·šã®å‚¾ãã€\(b\): è©¦é¨“ç‰‡å¹…ã€\(h\): è©¦é¨“ç‰‡åšã•
                    </p>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 4.2: 3ç‚¹æ›²ã’è©¦é¨“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def three_point_bending(L, b, h, E, P_max, n_points=100):
    """
    3ç‚¹æ›²ã’è©¦é¨“ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    L : float
        æ”¯ç‚¹é–“è·é›¢ [mm]
    b : float
        è©¦é¨“ç‰‡å¹… [mm]
    h : float
        è©¦é¨“ç‰‡åšã• [mm]
    E : float
        ãƒ¤ãƒ³ã‚°ç‡ [GPa]
    P_max : float
        æœ€å¤§è·é‡ [N]
    n_points : int
        ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒˆæ•°

    Returns:
    --------
    deflection, load : array
        ãŸã‚ã¿ [mm]ã€è·é‡ [N]
    """
    # æœ€å¤§ãŸã‚ã¿ã®è¨ˆç®—
    E_Pa = E * 1e9  # GPa â†’ Pa
    I = (b * h**3) / 12  # æ–­é¢äºŒæ¬¡ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ [mm^4] â†’ [m^4] å¤‰æ›å¿…è¦

    delta_max = (P_max * L**3) / (48 * E_Pa * I * 1e-12)  # [mm]

    # ç·šå½¢é ˜åŸŸ
    deflection = np.linspace(0, delta_max, n_points)
    load = (48 * E_Pa * I * 1e-12 * deflection) / L**3

    return deflection, load

def calculate_flexural_modulus(L, b, h, slope):
    """
    è·é‡-ãŸã‚ã¿æ›²ç·šã®å‚¾ãã‹ã‚‰æ›²ã’å¼¾æ€§ç‡ã‚’è¨ˆç®—

    Parameters:
    -----------
    slope : float
        è·é‡-ãŸã‚ã¿æ›²ç·šã®å‚¾ã [N/mm]

    Returns:
    --------
    E_f : float
        æ›²ã’å¼¾æ€§ç‡ [GPa]
    """
    E_f = (L**3 * slope) / (4 * b * h**3) / 1000  # MPa â†’ GPa
    return E_f

# CFRPç©å±¤æ¿ã®è¨­å®š
L = 80  # mm (æ”¯ç‚¹é–“è·é›¢)
b = 15  # mm (å¹…)
h = 2   # mm (åšã•)
E = 100 # GPa
P_max = 500  # N

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
deflection, load = three_point_bending(L, b, h, E, P_max)

# æ›²ã’å¼¾æ€§ç‡ã®è¨ˆç®—
slope = load[1] / deflection[1]  # åˆæœŸå‚¾ã [N/mm]
E_f_calculated = calculate_flexural_modulus(L, b, h, slope)

# æ›²ã’å¿œåŠ›ã®è¨ˆç®—(æœ€å¤§è·é‡æ™‚)
sigma_f_max = (3 * P_max * L) / (2 * b * h**2)  # [MPa]

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# è·é‡-ãŸã‚ã¿æ›²ç·š
ax1.plot(deflection, load, 'b-', linewidth=2)
ax1.plot(deflection[-1], load[-1], 'ro', markersize=10,
         label=f'æœ€å¤§è·é‡: {P_max} N\nãŸã‚ã¿: {deflection[-1]:.2f} mm')
ax1.set_xlabel('ãŸã‚ã¿ [mm]')
ax1.set_ylabel('è·é‡ [N]')
ax1.set_title('3ç‚¹æ›²ã’è©¦é¨“: è·é‡-ãŸã‚ã¿æ›²ç·š')
ax1.grid(True, alpha=0.3)
ax1.legend()

# å¿œåŠ›åˆ†å¸ƒ(æ–­é¢)
y = np.linspace(-h/2, h/2, 100)  # ä¸­ç«‹è»¸ã‹ã‚‰ã®è·é›¢
M_max = P_max * L / 4  # æœ€å¤§æ›²ã’ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ [NÂ·mm]
I = (b * h**3) / 12

sigma_bending = -(M_max * y * 1000) / I  # [MPa] (åœ§ç¸®å´ãŒè² )

ax2.plot(sigma_bending, y, 'r-', linewidth=2)
ax2.axhline(y=0, color='k', linestyle='--', linewidth=1, label='ä¸­ç«‹è»¸')
ax2.axvline(x=0, color='k', linestyle='-', linewidth=0.5)
ax2.fill_betweenx(y, 0, sigma_bending, where=(sigma_bending > 0),
                   alpha=0.3, color='red', label='å¼•å¼µå¿œåŠ›')
ax2.fill_betweenx(y, 0, sigma_bending, where=(sigma_bending < 0),
                   alpha=0.3, color='blue', label='åœ§ç¸®å¿œåŠ›')
ax2.set_xlabel('å¿œåŠ› [MPa]')
ax2.set_ylabel('æ¿åšæ–¹å‘ä½ç½® [mm]')
ax2.set_title('æ–­é¢ã®å¿œåŠ›åˆ†å¸ƒ')
ax2.grid(True, alpha=0.3)
ax2.legend()

plt.tight_layout()
plt.savefig('three_point_bending.png', dpi=300, bbox_inches='tight')
plt.close()

print("3ç‚¹æ›²ã’è©¦é¨“ã®è§£æçµæœ:")
print("="*60)
print(f"æ”¯ç‚¹é–“è·é›¢: {L} mm")
print(f"è©¦é¨“ç‰‡å¯¸æ³•: {b} Ã— {h} mm")
print(f"æœ€å¤§è·é‡: {P_max} N")
print(f"æœ€å¤§ãŸã‚ã¿: {deflection[-1]:.2f} mm")
print(f"æ›²ã’å¼¾æ€§ç‡(è¨ˆç®—): {E_f_calculated:.1f} GPa")
print(f"æ›²ã’å¼¾æ€§ç‡(å…¥åŠ›): {E:.1f} GPa")
print(f"æœ€å¤§æ›²ã’å¿œåŠ›: {sigma_f_max:.1f} MPa")</code></pre>
                    </div>

                    <h3>4.1.3 å±¤é–“ã›ã‚“æ–­è©¦é¨“ (ILSS)</h3>
                    <p>
                        Short Beam Shear (SBS)è©¦é¨“ã«ã‚ˆã‚Šã€ç©å±¤æ¿ã®å±¤é–“ã›ã‚“æ–­å¼·åº¦ã‚’è©•ä¾¡ã—ã¾ã™ã€‚
                        æ”¯ç‚¹é–“è·é›¢ã‚’æ¿åšã®5å€ç¨‹åº¦ã«è¨­å®šã—ã€å±¤é–“å‰¥é›¢ã‚’èª˜ç™ºã•ã›ã¾ã™ã€‚
                    </p>

                    <div class="formula">
                        $$\tau_{\text{ILSS}} = \frac{3P_{\max}}{4bh}$$
                    </div>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 4.3: å±¤é–“ã›ã‚“æ–­å¼·åº¦ã®çµ±è¨ˆè§£æ</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy import stats

# æ¨¡æ“¬å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿(10å€‹ã®è©¦é¨“ç‰‡)
np.random.seed(123)

# è©¦é¨“ç‰‡å¯¸æ³•
b = 10  # mm
h = 2   # mm

# æœ€å¤§è·é‡ãƒ‡ãƒ¼ã‚¿[N] (æ­£è¦åˆ†å¸ƒã§ã°ã‚‰ã¤ãã‚’æ¨¡æ“¬)
P_max_mean = 800
P_max_std = 40
n_specimens = 10

P_max_data = np.random.normal(P_max_mean, P_max_std, n_specimens)

# å±¤é–“ã›ã‚“æ–­å¼·åº¦ã®è¨ˆç®—
ILSS = (3 * P_max_data) / (4 * b * h)

# çµ±è¨ˆè§£æ
ILSS_mean = np.mean(ILSS)
ILSS_std = np.std(ILSS, ddof=1)
ILSS_cv = (ILSS_std / ILSS_mean) * 100  # å¤‰å‹•ä¿‚æ•° [%]

# 95%ä¿¡é ¼åŒºé–“
conf_interval = stats.t.interval(0.95, len(ILSS)-1, loc=ILSS_mean,
                                  scale=ILSS_std/np.sqrt(len(ILSS)))

# ãƒ¯ã‚¤ãƒ–ãƒ«åˆ†å¸ƒã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
shape, loc, scale = stats.weibull_min.fit(ILSS, floc=0)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ ã¨æ­£è¦åˆ†å¸ƒ
ax1.hist(ILSS, bins=6, density=True, alpha=0.7, color='skyblue',
         edgecolor='black', label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')

# æ­£è¦åˆ†å¸ƒãƒ•ã‚£ãƒƒãƒˆ
x_plot = np.linspace(ILSS.min(), ILSS.max(), 100)
normal_fit = stats.norm.pdf(x_plot, ILSS_mean, ILSS_std)
ax1.plot(x_plot, normal_fit, 'r-', linewidth=2, label='æ­£è¦åˆ†å¸ƒãƒ•ã‚£ãƒƒãƒˆ')

ax1.axvline(x=ILSS_mean, color='g', linestyle='--', linewidth=2,
            label=f'å¹³å‡å€¤: {ILSS_mean:.1f} MPa')
ax1.axvline(x=conf_interval[0], color='orange', linestyle=':',
            label=f'95%ä¿¡é ¼åŒºé–“')
ax1.axvline(x=conf_interval[1], color='orange', linestyle=':')

ax1.set_xlabel('å±¤é–“ã›ã‚“æ–­å¼·åº¦ [MPa]')
ax1.set_ylabel('ç¢ºç‡å¯†åº¦')
ax1.set_title('ILSS ã®åˆ†å¸ƒ')
ax1.legend()
ax1.grid(True, alpha=0.3)

# ãƒ¯ã‚¤ãƒ–ãƒ«ãƒ—ãƒ­ãƒƒãƒˆ
sorted_ILSS = np.sort(ILSS)
n = len(sorted_ILSS)
prob_failure = np.arange(1, n+1) / (n+1)

# ãƒ¯ã‚¤ãƒ–ãƒ«ç·šå½¢åŒ–: ln(ln(1/(1-P))) vs ln(ILSS)
y_weibull = np.log(-np.log(1 - prob_failure))
x_weibull = np.log(sorted_ILSS)

ax2.plot(x_weibull, y_weibull, 'bo', markersize=8, label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')

# ç·šå½¢å›å¸°
slope_w, intercept_w, r_w, _, _ = stats.linregress(x_weibull, y_weibull)
y_fit = slope_w * x_weibull + intercept_w
ax2.plot(x_weibull, y_fit, 'r-', linewidth=2,
         label=f'å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ m = {slope_w:.2f}\nRÂ² = {r_w**2:.4f}')

ax2.set_xlabel('ln(ILSS)')
ax2.set_ylabel('ln(ln(1/(1-P)))')
ax2.set_title('ãƒ¯ã‚¤ãƒ–ãƒ«ãƒ—ãƒ­ãƒƒãƒˆ')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('ilss_statistical_analysis.png', dpi=300, bbox_inches='tight')
plt.close()

# çµæœå‡ºåŠ›
print("å±¤é–“ã›ã‚“æ–­å¼·åº¦(ILSS)ã®çµ±è¨ˆè§£æ:")
print("="*60)
print(f"è©¦é¨“ç‰‡æ•°: {n_specimens}")
print(f"å¹³å‡å€¤: {ILSS_mean:.1f} MPa")
print(f"æ¨™æº–åå·®: {ILSS_std:.2f} MPa")
print(f"å¤‰å‹•ä¿‚æ•°: {ILSS_cv:.2f} %")
print(f"95%ä¿¡é ¼åŒºé–“: [{conf_interval[0]:.1f}, {conf_interval[1]:.1f}] MPa")
print(f"\nãƒ¯ã‚¤ãƒ–ãƒ«åˆ†å¸ƒãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿:")
print(f"å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ m: {shape:.2f}")
print(f"å°ºåº¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: {scale:.1f} MPa")
print(f"\nå€‹åˆ¥ãƒ‡ãƒ¼ã‚¿:")
for i, (P, ilss) in enumerate(zip(P_max_data, ILSS), 1):
    print(f"  è©¦é¨“ç‰‡{i}: P_max = {P:.1f} N â†’ ILSS = {ilss:.1f} MPa")</code></pre>
                    </div>
                </section>

                <section>
                    <h2>4.2 ç–²åŠ´è©¦é¨“ã¨å¯¿å‘½äºˆæ¸¬</h2>

                    <h3>4.2.1 S-N æ›²ç·š</h3>
                    <p>
                        å¿œåŠ›æŒ¯å¹…(Stress amplitude)ã¨ç ´å£Šç¹°è¿”ã—æ•°(Number of cycles to failure)ã®
                        é–¢ä¿‚ã‚’ç¤ºã™S-Næ›²ç·šã¯ã€ç–²åŠ´å¯¿å‘½è¨­è¨ˆã®åŸºç¤ãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚
                    </p>

                    <div class="formula">
                        $$\sigma_a = \sigma_f' (2N_f)^b$$
                    </div>

                    <p>
                        \(\sigma_a\): å¿œåŠ›æŒ¯å¹…ã€\(N_f\): ç ´å£Šç¹°è¿”ã—æ•°ã€\(\sigma_f'\): ç–²åŠ´å¼·åº¦ä¿‚æ•°ã€\(b\): ç–²åŠ´å¼·åº¦æŒ‡æ•°
                    </p>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 4.4: S-N æ›²ç·šã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit
from scipy import stats

def basquin_equation(N, sigma_f_prime, b):
    """
    Basquin ã®å¼: Ïƒ_a = Ïƒ_f' * (2N)^b

    Parameters:
    -----------
    N : array
        ç¹°è¿”ã—æ•°
    sigma_f_prime : float
        ç–²åŠ´å¼·åº¦ä¿‚æ•° [MPa]
    b : float
        ç–²åŠ´å¼·åº¦æŒ‡æ•° (è² ã®å€¤)

    Returns:
    --------
    sigma_a : array
        å¿œåŠ›æŒ¯å¹… [MPa]
    """
    return sigma_f_prime * (2 * N)**b

# æ¨¡æ“¬ç–²åŠ´è©¦é¨“ãƒ‡ãƒ¼ã‚¿(CFRP)
np.random.seed(456)

# å¿œåŠ›æŒ¯å¹…ãƒ¬ãƒ™ãƒ« [MPa]
stress_levels = np.array([700, 600, 500, 400, 300, 250])
n_specimens_per_level = 3

# çœŸã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
sigma_f_prime_true = 1200  # MPa
b_true = -0.10

# ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
stress_data = []
cycles_data = []

for sigma in stress_levels:
    # å„å¿œåŠ›ãƒ¬ãƒ™ãƒ«ã§ã®ç ´å£Šç¹°è¿”ã—æ•°ã‚’è¨ˆç®—
    N_mean = (sigma / sigma_f_prime_true)**(1/b_true) / 2

    # å¯¾æ•°æ­£è¦åˆ†å¸ƒã§ã°ã‚‰ã¤ãã‚’ä»˜ä¸
    log_std = 0.3
    for _ in range(n_specimens_per_level):
        N_f = np.random.lognormal(np.log(N_mean), log_std)
        stress_data.append(sigma)
        cycles_data.append(N_f)

stress_data = np.array(stress_data)
cycles_data = np.array(cycles_data)

# Basquinå¼ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
# å¯¾æ•°å¤‰æ›ã—ã¦ç·šå½¢å›å¸°
log_N = np.log10(2 * cycles_data)
log_sigma = np.log10(stress_data)

slope, intercept, r_value, p_value, std_err = stats.linregress(log_N, log_sigma)

b_fit = slope
sigma_f_prime_fit = 10**intercept

print("S-N æ›²ç·šã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ:")
print("="*60)
print(f"ç–²åŠ´å¼·åº¦ä¿‚æ•° Ïƒ_f': {sigma_f_prime_fit:.0f} MPa (çœŸå€¤: {sigma_f_prime_true})")
print(f"ç–²åŠ´å¼·åº¦æŒ‡æ•° b: {b_fit:.4f} (çœŸå€¤: {b_true})")
print(f"æ±ºå®šä¿‚æ•° RÂ²: {r_value**2:.4f}")

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# S-Næ›²ç·š(ç‰‡å¯¾æ•°)
N_plot = np.logspace(2, 7, 100)
sigma_fit = basquin_equation(N_plot, sigma_f_prime_fit, b_fit)

ax1.semilogx(cycles_data, stress_data, 'bo', markersize=8, alpha=0.6,
             label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')
ax1.semilogx(N_plot, sigma_fit, 'r-', linewidth=2,
             label=f'Basquinå¼: Ïƒ_a = {sigma_f_prime_fit:.0f} (2N)^{b_fit:.3f}')

# ç–²åŠ´é™åº¦(10^7ã‚µã‚¤ã‚¯ãƒ«)
sigma_endurance = basquin_equation(1e7, sigma_f_prime_fit, b_fit)
ax1.axhline(y=sigma_endurance, color='g', linestyle='--',
            label=f'ç–²åŠ´é™åº¦(10â·): {sigma_endurance:.0f} MPa')

ax1.set_xlabel('ç ´å£Šç¹°è¿”ã—æ•° N_f')
ax1.set_ylabel('å¿œåŠ›æŒ¯å¹… Ïƒ_a [MPa]')
ax1.set_title('S-N æ›²ç·š (CFRP)')
ax1.grid(True, alpha=0.3, which='both')
ax1.legend()

# æ®‹å·®ãƒ—ãƒ­ãƒƒãƒˆ
sigma_predicted = basquin_equation(cycles_data, sigma_f_prime_fit, b_fit)
residuals = stress_data - sigma_predicted

ax2.semilogx(cycles_data, residuals, 'bo', markersize=8, alpha=0.6)
ax2.axhline(y=0, color='r', linestyle='-', linewidth=2)
ax2.axhline(y=np.std(residuals), color='orange', linestyle='--',
            label=f'Â±1Ïƒ: Â±{np.std(residuals):.1f} MPa')
ax2.axhline(y=-np.std(residuals), color='orange', linestyle='--')
ax2.set_xlabel('ç ´å£Šç¹°è¿”ã—æ•° N_f')
ax2.set_ylabel('æ®‹å·® [MPa]')
ax2.set_title('ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°æ®‹å·®')
ax2.grid(True, alpha=0.3, which='both')
ax2.legend()

plt.tight_layout()
plt.savefig('sn_curve_analysis.png', dpi=300, bbox_inches='tight')
plt.close()

# å¯¿å‘½äºˆæ¸¬ä¾‹
stress_service = 350  # MPa (å®Ÿåƒå¿œåŠ›)
N_predicted = (stress_service / sigma_f_prime_fit)**(1/b_fit) / 2
safety_factor = 2.0
N_design = N_predicted / safety_factor

print(f"\nç–²åŠ´å¯¿å‘½äºˆæ¸¬:")
print(f"å®Ÿåƒå¿œåŠ›: {stress_service} MPa")
print(f"äºˆæ¸¬ç ´å£Šç¹°è¿”ã—æ•°: {N_predicted:.2e} ã‚µã‚¤ã‚¯ãƒ«")
print(f"è¨­è¨ˆç¹°è¿”ã—æ•°(SF={safety_factor}): {N_design:.2e} ã‚µã‚¤ã‚¯ãƒ«")</code></pre>
                    </div>

                    <h3>4.2.2 æå‚·ç´¯ç©å‰‡</h3>
                    <p>
                        å¤‰å‹•è·é‡ä¸‹ã§ã®ç–²åŠ´å¯¿å‘½äºˆæ¸¬ã«ã¯ã€Minerã®ç·šå½¢æå‚·ç´¯ç©å‰‡ã‚’ç”¨ã„ã¾ã™ï¼š
                    </p>

                    <div class="formula">
                        $$D = \sum_{i=1}^{k} \frac{n_i}{N_{f,i}} \quad (D = 1 ã§ç ´å£Š)$$
                    </div>

                    <p>\(n_i\): å¿œåŠ›ãƒ¬ãƒ™ãƒ« i ã®ç¹°è¿”ã—æ•°ã€\(N_{f,i}\): å¿œåŠ›ãƒ¬ãƒ™ãƒ« i ã§ã®ç ´å£Šç¹°è¿”ã—æ•°</p>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 4.5: Minerå‰‡ã«ã‚ˆã‚‹ç´¯ç©æå‚·è¨ˆç®—</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def miner_rule_damage(stress_levels, cycle_counts, sigma_f_prime, b):
    """
    Minerã®ç·šå½¢æå‚·ç´¯ç©å‰‡ã§æå‚·åº¦ã‚’è¨ˆç®—

    Parameters:
    -----------
    stress_levels : array
        å„è·é‡ãƒ–ãƒ­ãƒƒã‚¯ã®å¿œåŠ›ãƒ¬ãƒ™ãƒ« [MPa]
    cycle_counts : array
        å„è·é‡ãƒ–ãƒ­ãƒƒã‚¯ã®ç¹°è¿”ã—æ•°
    sigma_f_prime, b : float
        S-Næ›²ç·šã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

    Returns:
    --------
    damage : float
        ç´¯ç©æå‚·åº¦
    damage_per_block : array
        å„ãƒ–ãƒ­ãƒƒã‚¯ã®æå‚·åº¦
    """
    N_f = (stress_levels / sigma_f_prime)**(1/b) / 2
    damage_per_block = cycle_counts / N_f
    damage = np.sum(damage_per_block)

    return damage, damage_per_block

# CFRP ã®S-Næ›²ç·šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
sigma_f_prime = 1200
b = -0.10

# è·é‡ã‚¹ãƒšã‚¯ãƒˆãƒ«(3æ®µéš)
stress_levels = np.array([500, 400, 300])  # MPa
cycle_counts = np.array([1e4, 5e4, 1e5])   # ã‚µã‚¤ã‚¯ãƒ«

# æå‚·è¨ˆç®—
damage_total, damage_blocks = miner_rule_damage(
    stress_levels, cycle_counts, sigma_f_prime, b)

# ç ´å£Šã¾ã§ã®ç¹°è¿”ã—æ•°
N_f_individual = (stress_levels / sigma_f_prime)**(1/b) / 2

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# è·é‡ã‚¹ãƒšã‚¯ãƒˆãƒ«
x_pos = np.arange(len(stress_levels))
ax1.bar(x_pos, stress_levels, alpha=0.7, color=['red', 'orange', 'yellow'],
        edgecolor='black')
ax1.set_xlabel('è·é‡ãƒ–ãƒ­ãƒƒã‚¯')
ax1.set_ylabel('å¿œåŠ›æŒ¯å¹… [MPa]')
ax1.set_title('è·é‡ã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax1.set_xticks(x_pos)
ax1.set_xticklabels([f'Block {i+1}\n{n:.0e}' for i, n in enumerate(cycle_counts)])
ax1.grid(True, alpha=0.3, axis='y')

# å„ãƒ–ãƒ­ãƒƒã‚¯ã«N_fã‚’è¡¨ç¤º
for i, (stress, N_f) in enumerate(zip(stress_levels, N_f_individual)):
    ax1.text(i, stress + 20, f'N_f = {N_f:.1e}',
             ha='center', fontsize=9)

# ç´¯ç©æå‚·åº¦
damage_cumulative = np.cumsum(damage_blocks)

ax2.bar(x_pos, damage_blocks, alpha=0.7, color=['red', 'orange', 'yellow'],
        edgecolor='black', label='ãƒ–ãƒ­ãƒƒã‚¯æå‚·')
ax2.plot(x_pos, damage_cumulative, 'bo-', linewidth=2, markersize=10,
         label='ç´¯ç©æå‚·')
ax2.axhline(y=1.0, color='r', linestyle='--', linewidth=2, label='ç ´å£Šè¦æº–')
ax2.set_xlabel('è·é‡ãƒ–ãƒ­ãƒƒã‚¯')
ax2.set_ylabel('æå‚·åº¦')
ax2.set_title('Minerå‰‡ã«ã‚ˆã‚‹ç´¯ç©æå‚·')
ax2.set_xticks(x_pos)
ax2.set_xticklabels([f'Block {i+1}' for i in range(len(stress_levels))])
ax2.legend()
ax2.grid(True, alpha=0.3, axis='y')

plt.tight_layout()
plt.savefig('miner_rule_damage.png', dpi=300, bbox_inches='tight')
plt.close()

# çµæœå‡ºåŠ›
print("Minerå‰‡ã«ã‚ˆã‚‹ç´¯ç©æå‚·è§£æ:")
print("="*60)
for i, (stress, cycles, N_f, d) in enumerate(
    zip(stress_levels, cycle_counts, N_f_individual, damage_blocks), 1):
    print(f"Block {i}: Ïƒ = {stress} MPa, n = {cycles:.0e}")
    print(f"  ç ´å£Šç¹°è¿”ã—æ•° N_f = {N_f:.2e}")
    print(f"  æå‚·åº¦ d = {d:.4f}")
    print()

print(f"ç·ç´¯ç©æå‚·åº¦: {damage_total:.4f}")
if damage_total < 1.0:
    remaining_life = (1.0 - damage_total) / damage_total
    print(f"çŠ¶æ…‹: å®‰å…¨ (ç ´å£Šã¾ã§ {remaining_life:.2f} å€ã®å¯¿å‘½)")
elif damage_total >= 1.0:
    print(f"çŠ¶æ…‹: ç ´å£Šäºˆæ¸¬ (æå‚·åº¦ > 1.0)")</code></pre>
                    </div>
                </section>

                <section>
                    <h2>4.3 éç ´å£Šæ¤œæŸ» (NDE/NDT)</h2>

                    <h3>4.3.1 éç ´å£Šæ¤œæŸ»æ³•ã®åˆ†é¡</h3>
                    <p>
                        è¤‡åˆææ–™ã®å†…éƒ¨æ¬ é™¥(å‰¥é›¢ã€ãƒœã‚¤ãƒ‰ã€ç¹Šç¶­ç ´æ–­)ã‚’æ¤œå‡ºã™ã‚‹ä¸»ãªæ‰‹æ³•ï¼š
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>æ‰‹æ³•</th>
                                <th>åŸç†</th>
                                <th>æ¤œå‡ºå¯¾è±¡</th>
                                <th>åˆ©ç‚¹/æ¬ ç‚¹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>è¶…éŸ³æ³¢æ¢å‚·</td>
                                <td>è¶…éŸ³æ³¢ã®åå°„ãƒ»æ¸›è¡°</td>
                                <td>å‰¥é›¢ã€ãƒœã‚¤ãƒ‰ã€åšã•</td>
                                <td>é«˜ç²¾åº¦ / æ¥è§¦å¿…è¦</td>
                            </tr>
                            <tr>
                                <td>Xç·šCT</td>
                                <td>Xç·šé€éç‡ã®å·®</td>
                                <td>3Då†…éƒ¨æ§‹é€ ã€ç¹Šç¶­é…å‘</td>
                                <td>é«˜åˆ†è§£èƒ½ / é«˜ã‚³ã‚¹ãƒˆ</td>
                            </tr>
                            <tr>
                                <td>ã‚µãƒ¼ãƒ¢ã‚°ãƒ©ãƒ•ã‚£</td>
                                <td>ç†±ä¼å°ç‡ã®å·®</td>
                                <td>å‰¥é›¢ã€å«æµ¸ä¸è‰¯</td>
                                <td>éæ¥è§¦ãƒ»é«˜é€Ÿ / è¡¨é¢è¿‘å‚ã®ã¿</td>
                            </tr>
                            <tr>
                                <td>AEæ³•</td>
                                <td>ç ´å£Šæ™‚ã®å¼¾æ€§æ³¢</td>
                                <td>æå‚·é€²å±•ã€ä½ç½®æ¨™å®š</td>
                                <td>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ  / ãƒã‚¤ã‚ºå½±éŸ¿å¤§</td>
                            </tr>
                            <tr>
                                <td>æ¸¦é›»æµæ¢å‚·</td>
                                <td>å°é›»ç‡ã®å¤‰åŒ–</td>
                                <td>CFRP ã®ç¹Šç¶­ç ´æ–­</td>
                                <td>é«˜é€Ÿ / å°é›»æ€§ææ–™ã®ã¿</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>4.3.2 è¶…éŸ³æ³¢æ¢å‚·æ³•</h3>
                    <p>
                        è¶…éŸ³æ³¢Cã‚¹ã‚­ãƒ£ãƒ³ã«ã‚ˆã‚Šã€ç©å±¤æ¿ã®å‰¥é›¢ã‚’2æ¬¡å…ƒãƒãƒƒãƒ”ãƒ³ã‚°ã§ãã¾ã™ã€‚
                        å‘¨æ³¢æ•°: 5-10 MHzã€æ°´æµ¸æ³•ã¾ãŸã¯æ¥è§¦æ³•ã‚’ä½¿ç”¨ã€‚
                    </p>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 4.6: è¶…éŸ³æ³¢Cã‚¹ã‚­ãƒ£ãƒ³ãƒ‡ãƒ¼ã‚¿ã®è§£æ</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.ndimage import gaussian_filter

def simulate_c_scan(size_x, size_y, defects):
    """
    è¶…éŸ³æ³¢Cã‚¹ã‚­ãƒ£ãƒ³ãƒ‡ãƒ¼ã‚¿ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    size_x, size_y : int
        ã‚¹ã‚­ãƒ£ãƒ³é ˜åŸŸã®ã‚µã‚¤ã‚º [mm]
    defects : list of dict
        æ¬ é™¥æƒ…å ± [{'x': x, 'y': y, 'size': size, 'depth': depth}]

    Returns:
    --------
    c_scan : ndarray
        Cã‚¹ã‚­ãƒ£ãƒ³ç”»åƒ(æŒ¯å¹…å€¤)
    """
    resolution = 0.5  # mm
    nx = int(size_x / resolution)
    ny = int(size_y / resolution)

    # å¥å…¨éƒ¨ã®æŒ¯å¹…(100%)
    c_scan = np.ones((ny, nx)) * 100

    # ãƒã‚¤ã‚ºè¿½åŠ 
    noise = np.random.normal(0, 2, (ny, nx))
    c_scan += noise

    # æ¬ é™¥ã®è¿½åŠ 
    for defect in defects:
        x_center = int(defect['x'] / resolution)
        y_center = int(defect['y'] / resolution)
        size = int(defect['size'] / resolution)
        depth = defect['depth']

        # ã‚¬ã‚¦ã‚·ã‚¢ãƒ³å½¢çŠ¶ã®æŒ¯å¹…ä½ä¸‹
        y, x = np.ogrid[-y_center:ny-y_center, -x_center:nx-x_center]
        mask = x*x + y*y <= (size/2)**2

        # æ·±ã•ã«å¿œã˜ãŸæŒ¯å¹…ä½ä¸‹(æ·±ã„ã»ã©æ¤œå‡ºã—ã«ãã„)
        attenuation = 100 * (1 - 0.8 * np.exp(-depth / 2))
        c_scan[mask] = np.minimum(c_scan[mask], attenuation)

    # ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°
    c_scan = gaussian_filter(c_scan, sigma=1)

    return c_scan

# ã‚¹ã‚­ãƒ£ãƒ³è¨­å®š
size_x = 100  # mm
size_y = 100  # mm

# æ¬ é™¥ãƒ‡ãƒ¼ã‚¿(å‰¥é›¢ã‚’æ¨¡æ“¬)
defects = [
    {'x': 30, 'y': 30, 'size': 15, 'depth': 1.0},  # è¡¨é¢è¿‘ã
    {'x': 70, 'y': 40, 'size': 10, 'depth': 3.0},  # æ·±éƒ¨
    {'x': 50, 'y': 70, 'size': 20, 'depth': 0.5},  # å¤§ããªå‰¥é›¢
]

# Cã‚¹ã‚­ãƒ£ãƒ³ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
c_scan = simulate_c_scan(size_x, size_y, defects)

# æ¬ é™¥æ¤œå‡º(é–¾å€¤å‡¦ç†)
threshold = 80  # æŒ¯å¹…80%ä»¥ä¸‹ã‚’æ¬ é™¥ã¨åˆ¤å®š
defect_map = c_scan < threshold

# å¯è¦–åŒ–
fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(18, 5))

# Cã‚¹ã‚­ãƒ£ãƒ³ç”»åƒ
im1 = ax1.imshow(c_scan, cmap='jet', origin='lower', extent=[0, size_x, 0, size_y])
ax1.set_xlabel('X [mm]')
ax1.set_ylabel('Y [mm]')
ax1.set_title('è¶…éŸ³æ³¢ C ã‚¹ã‚­ãƒ£ãƒ³(æŒ¯å¹…)')
cbar1 = plt.colorbar(im1, ax=ax1)
cbar1.set_label('æŒ¯å¹… [%]')

# çœŸã®æ¬ é™¥ä½ç½®ã‚’é‡ã­ã‚‹
for defect in defects:
    circle = plt.Circle((defect['x'], defect['y']), defect['size']/2,
                        color='white', fill=False, linewidth=2, linestyle='--')
    ax1.add_patch(circle)

# æ¬ é™¥ãƒãƒƒãƒ—
im2 = ax2.imshow(defect_map, cmap='gray_r', origin='lower',
                 extent=[0, size_x, 0, size_y])
ax2.set_xlabel('X [mm]')
ax2.set_ylabel('Y [mm]')
ax2.set_title(f'æ¬ é™¥æ¤œå‡º(é–¾å€¤ < {threshold}%)')

# ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ 
ax3.hist(c_scan.flatten(), bins=50, alpha=0.7, color='blue',
         edgecolor='black')
ax3.axvline(x=threshold, color='r', linestyle='--', linewidth=2,
            label=f'é–¾å€¤: {threshold}%')
ax3.set_xlabel('æŒ¯å¹… [%]')
ax3.set_ylabel('ãƒ”ã‚¯ã‚»ãƒ«æ•°')
ax3.set_title('æŒ¯å¹…åˆ†å¸ƒ')
ax3.legend()
ax3.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('ultrasonic_c_scan.png', dpi=300, bbox_inches='tight')
plt.close()

# æ¬ é™¥é¢ç©ã®è¨ˆç®—
resolution = 0.5
pixel_area = resolution**2
defect_area = np.sum(defect_map) * pixel_area
total_area = size_x * size_y
defect_ratio = (defect_area / total_area) * 100

print("è¶…éŸ³æ³¢Cã‚¹ã‚­ãƒ£ãƒ³è§£æçµæœ:")
print("="*60)
print(f"ã‚¹ã‚­ãƒ£ãƒ³é ˜åŸŸ: {size_x} Ã— {size_y} mm")
print(f"åˆ†è§£èƒ½: {resolution} mm")
print(f"æ¤œå‡ºé–¾å€¤: {threshold}%")
print(f"æ¤œå‡ºæ¬ é™¥é¢ç©: {defect_area:.1f} mmÂ²")
print(f"æ¬ é™¥é¢ç©ç‡: {defect_ratio:.2f}%")
print(f"\nè¨­å®šæ¬ é™¥:")
for i, defect in enumerate(defects, 1):
    print(f"  æ¬ é™¥{i}: ä½ç½®({defect['x']}, {defect['y']}) mm, "
          f"ã‚µã‚¤ã‚º {defect['size']} mm, æ·±ã• {defect['depth']} mm")</code></pre>
                    </div>
                </section>

                <section>
                    <h2>4.4 ã¾ã¨ã‚</h2>
                    <p>æœ¬ç« ã§ã¯ã€è¤‡åˆææ–™ã®è©•ä¾¡æŠ€è¡“ã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸï¼š</p>
                    <ul>
                        <li>æ©Ÿæ¢°çš„è©¦é¨“æ³•(å¼•å¼µã€æ›²ã’ã€å±¤é–“ã›ã‚“æ–­)</li>
                        <li>S-Næ›²ç·šã«ã‚ˆã‚‹ç–²åŠ´å¯¿å‘½äºˆæ¸¬</li>
                        <li>Minerã®ç·šå½¢æå‚·ç´¯ç©å‰‡</li>
                        <li>éç ´å£Šæ¤œæŸ»æ³•(è¶…éŸ³æ³¢ã€Xç·šCTã€ã‚µãƒ¼ãƒ¢ã‚°ãƒ©ãƒ•ã‚£)</li>
                        <li>çµ±è¨ˆè§£æã¨ãƒ‡ãƒ¼ã‚¿å‡¦ç†æ‰‹æ³•</li>
                    </ul>

                    <p>
                        æ¬¡ç« ã§ã¯ã€Pythonã‚’ç”¨ã„ãŸå®Ÿè·µçš„ãªè¤‡åˆææ–™è§£æã¨ã—ã¦ã€
                        å¤å…¸ç©å±¤ç†è«–ã®å®Ÿè£…ã€æœ€é©ç©å±¤è¨­è¨ˆã€æœ‰é™è¦ç´ æ³•ã®å‰å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚
                    </p>
                </section>

                <section>
                    <h2>æ¼”ç¿’å•é¡Œ</h2>

                    <div class="exercise">
                        <h3>åŸºç¤ãƒ¬ãƒ™ãƒ«</h3>

                        <h4>å•é¡Œ 4.1: å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®è§£æ</h4>
                        <p>
                            ä»¥ä¸‹ã®å¼•å¼µè©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€ãƒ¤ãƒ³ã‚°ç‡ã¨å¼•å¼µå¼·åº¦ã‚’æ±‚ã‚ã‚ˆï¼š
                            <br>ã²ãšã¿ 0.002 ã§å¿œåŠ› 280 MPaã€æœ€å¤§å¿œåŠ› 1450 MPa (ã²ãšã¿ 0.012)
                        </p>

                        <h4>å•é¡Œ 4.2: æ›²ã’å¼¾æ€§ç‡ã®è¨ˆç®—</h4>
                        <p>
                            3ç‚¹æ›²ã’è©¦é¨“(L=80 mm, b=15 mm, h=2 mm)ã§ã€ãŸã‚ã¿ 3 mm æ™‚ã«è·é‡ 450 N ã‚’
                            æ¸¬å®šã—ãŸã€‚æ›²ã’å¼¾æ€§ç‡ã‚’æ±‚ã‚ã‚ˆã€‚
                        </p>

                        <h4>å•é¡Œ 4.3: ILSS ã®è¨ˆç®—</h4>
                        <p>
                            Short Beam Shearè©¦é¨“ã§æœ€å¤§è·é‡ 750 N (è©¦é¨“ç‰‡: å¹…10 mmã€åšã•2 mm)ã‚’è¨˜éŒ²ã—ãŸã€‚
                            å±¤é–“ã›ã‚“æ–­å¼·åº¦ã‚’æ±‚ã‚ã‚ˆã€‚
                        </p>
                    </div>

                    <div class="exercise">
                        <h3>å¿œç”¨ãƒ¬ãƒ™ãƒ«</h3>

                        <h4>å•é¡Œ 4.4: S-Næ›²ç·šã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h4>
                        <p>
                            ä»¥ä¸‹ã®ç–²åŠ´è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰Basquinå¼ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿(Ïƒ_f', b)ã‚’æ±‚ã‚ã‚ˆï¼š
                            <br>600 MPa: 5Ã—10Â³, 500 MPa: 3Ã—10â´, 400 MPa: 2Ã—10âµ, 300 MPa: 1Ã—10â¶ ã‚µã‚¤ã‚¯ãƒ«
                        </p>

                        <h4>å•é¡Œ 4.5: Minerå‰‡ã®é©ç”¨</h4>
                        <p>
                            2æ®µéšè·é‡(500 MPa ã§ 1Ã—10â´ã‚µã‚¤ã‚¯ãƒ«ã€300 MPa ã§ 5Ã—10â´ã‚µã‚¤ã‚¯ãƒ«)ã‚’å—ã‘ãŸ
                            CFRPç©å±¤æ¿ã®ç´¯ç©æå‚·åº¦ã‚’è¨ˆç®—ã›ã‚ˆã€‚(Ïƒ_f' = 1200 MPa, b = -0.10)
                        </p>

                        <h4>å•é¡Œ 4.6: çµ±è¨ˆè§£æ</h4>
                        <p>
                            å¼•å¼µå¼·åº¦ãƒ‡ãƒ¼ã‚¿[1420, 1450, 1380, 1460, 1410, 1440, 1400, 1430] MPa ã«ã¤ã„ã¦ã€
                            å¹³å‡å€¤ã€æ¨™æº–åå·®ã€95%ä¿¡é ¼åŒºé–“ã‚’æ±‚ã‚ã‚ˆã€‚
                        </p>

                        <h4>å•é¡Œ 4.7: ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°èª²é¡Œ</h4>
                        <p>
                            ç–²åŠ´è©¦é¨“ãƒ‡ãƒ¼ã‚¿ã®å¯è¦–åŒ–ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã›ã‚ˆï¼š
                        </p>
                        <ul>
                            <li>S-Næ›²ç·šã®ãƒ—ãƒ­ãƒƒãƒˆ(ç‰‡å¯¾æ•°)</li>
                            <li>Basquinå¼ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</li>
                            <li>95%ä¿¡é ¼åŒºé–“ã®è¡¨ç¤º</li>
                        </ul>
                    </div>

                    <div class="exercise">
                        <h3>ç™ºå±•ãƒ¬ãƒ™ãƒ«</h3>

                        <h4>å•é¡Œ 4.8: ç¢ºç‡è«–çš„ç–²åŠ´è§£æ</h4>
                        <p>
                            ç–²åŠ´å¯¿å‘½ãŒãƒ¯ã‚¤ãƒ–ãƒ«åˆ†å¸ƒã«å¾“ã†å ´åˆ(å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ m=3)ã€
                            ä¿¡é ¼æ€§90%ã‚’æº€ãŸã™è¨­è¨ˆç¹°è¿”ã—æ•°ã‚’æ±‚ã‚ã‚ˆã€‚
                            (å¹³å‡ç ´å£Šç¹°è¿”ã—æ•°: 1Ã—10â¶ ã‚µã‚¤ã‚¯ãƒ«)
                        </p>

                        <h4>å•é¡Œ 4.9: å¤šè»¸ç–²åŠ´</h4>
                        <p>
                            å¼•å¼µ-ã­ã˜ã‚Šè¤‡åˆè·é‡ä¸‹ã§ã®CFRPç©å±¤æ¿ã®ç–²åŠ´å¯¿å‘½ã‚’ã€
                            è‡¨ç•Œé¢æ³•(Critical Plane Approach)ã§äºˆæ¸¬ã›ã‚ˆã€‚
                        </p>

                        <h4>å•é¡Œ 4.10: NDEãƒ‡ãƒ¼ã‚¿å‡¦ç†</h4>
                        <p>
                            è¶…éŸ³æ³¢Cã‚¹ã‚­ãƒ£ãƒ³ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã€ä»¥ä¸‹ã®ç”»åƒå‡¦ç†ã‚’å®Ÿè£…ã›ã‚ˆï¼š
                        </p>
                        <ul>
                            <li>ãƒã‚¤ã‚ºé™¤å»(ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ³ãƒ•ã‚£ãƒ«ã‚¿)</li>
                            <li>ã‚¨ãƒƒã‚¸æ¤œå‡º(Sobel, Canny)</li>
                            <li>æ¬ é™¥é ˜åŸŸã®ã‚»ã‚°ãƒ¡ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³</li>
                            <li>æ¬ é™¥ã‚µã‚¤ã‚ºãƒ»å½¢çŠ¶ã®å®šé‡è©•ä¾¡</li>
                        </ul>
                    </div>
                </section>

                <section>
                    <h2>å‚è€ƒæ–‡çŒ®</h2>
                    <ol class="references">
                        <li>ASTM D3039, "Standard Test Method for Tensile Properties of Polymer Matrix Composite Materials", ASTM International, 2017</li>
                        <li>Talreja, R. and Singh, C. V., "Damage and Failure of Composite Materials", Cambridge University Press, 2012, pp. 156-234</li>
                        <li>Reifsnider, K. L., "Fatigue of Composite Materials", Elsevier, 1991, pp. 89-167</li>
                        <li>Harris, B., "Fatigue in Composites", Woodhead Publishing, 2003, pp. 234-312</li>
                        <li>Miner, M. A., "Cumulative Damage in Fatigue", Journal of Applied Mechanics, Vol. 12, 1945, pp. A159-A164</li>
                        <li>Gao, F., Handley, L., and Phillips, J., "Nondestructive Evaluation of Composite Materials", in ASM Handbook Vol. 17: Nondestructive Evaluation and Quality Control, 1989, pp. 778-812</li>
                        <li>Halmshaw, R., "Non-Destructive Testing", 2nd ed., Edward Arnold, 1991, pp. 145-223</li>
                        <li>Hellier, C. J., "Handbook of Nondestructive Evaluation", 2nd ed., McGraw-Hill, 2013, pp. 312-389, 456-523</li>
                    </ol>
                </section>

                <div class="navigation">
                    <a href="chapter-3.html" class="prev">â† ç¬¬3ç«  ç²’å­ãƒ»ç©å±¤è¤‡åˆææ–™</a>
                    <a href="chapter-5.html" class="next">ç¬¬5ç«  Pythonå®Ÿè·µ â†’</a>
                </div>
            </article>
        <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

</main>
    </div>

    <footer>
        <p>&copy; 2025 Materials Science Learning Series. All rights reserved.</p>
    </footer>

    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
</body>
</html>