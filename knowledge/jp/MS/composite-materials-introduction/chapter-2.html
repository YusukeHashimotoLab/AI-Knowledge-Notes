<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç«  ç¹Šç¶­å¼·åŒ–è¤‡åˆææ–™ - è¤‡åˆææ–™å…¥é–€</title>
    <meta name="description" content="CFRP/GFRPã®è£½é€ æ³•ã€å¤å…¸ç©å±¤ç†è«–(CLT)ã€A-B-Dè¡Œåˆ—ã€å¼·åº¦äºˆæ¸¬ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚">
    <link rel="stylesheet" href="../../../en/assets/css/knowledge-base.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
        <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MS/composite-materials-introduction/chapter-2.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/composite-materials-introduction/index.html">Composite Materials</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 2</span>
        </div>
    </nav>
<div class="container">
        <nav class="sidebar">
            <h3>è¤‡åˆææ–™å…¥é–€</h3>
            <ul>
                <li><a href="index.html">ç›®æ¬¡</a></li>
                <li><a href="chapter-1.html">ç¬¬1ç«  è¤‡åˆææ–™ã®åŸºç¤</a></li>
                <li class="active"><a href="chapter-2.html">ç¬¬2ç«  ç¹Šç¶­å¼·åŒ–è¤‡åˆææ–™</a></li>
                <li><a href="chapter-3.html">ç¬¬3ç«  ç²’å­ãƒ»ç©å±¤è¤‡åˆææ–™</a></li>
                <li><a href="chapter-4.html">ç¬¬4ç«  è¤‡åˆææ–™ã®è©•ä¾¡</a></li>
                <li><a href="chapter-5.html">ç¬¬5ç«  Pythonå®Ÿè·µ</a></li>
            </ul>
            <div class="series-nav">
                <h4>Materials Science ã‚·ãƒªãƒ¼ã‚º</h4>
                <ul>
                    <li><a href="../polymer-materials-introduction/index.html">é«˜åˆ†å­ææ–™å…¥é–€</a></li>
                    <li><a href="../thin-film-nano-introduction/index.html">è–„è†œãƒ»ãƒŠãƒææ–™å…¥é–€</a></li>
                    <li class="current-series"><a href="index.html">è¤‡åˆææ–™å…¥é–€</a></li>
                </ul>
            </div>
        </nav>

        <main class="content">
            <article>
                <h1>ç¬¬2ç«  ç¹Šç¶­å¼·åŒ–è¤‡åˆææ–™</h1>

                <div class="learning-objectives">
                    <h3>å­¦ç¿’ç›®æ¨™</h3>
                    <ul>
                        <li><strong>åŸºç¤ãƒ¬ãƒ™ãƒ«:</strong> CFRP/GFRPã®è£½é€ æ³•ã‚’ç†è§£ã—ã€å˜å±¤ã®å¿œåŠ›-ã²ãšã¿é–¢ä¿‚ã‚’è¨ˆç®—ã§ãã‚‹</li>
                        <li><strong>å¿œç”¨ãƒ¬ãƒ™ãƒ«:</strong> å¤å…¸ç©å±¤ç†è«–(CLT)ã‚’é©ç”¨ã—ã€A-B-Dè¡Œåˆ—ã‹ã‚‰ç©å±¤æ¿ã®å‰›æ€§ã‚’è©•ä¾¡ã§ãã‚‹</li>
                        <li><strong>ç™ºå±•ãƒ¬ãƒ™ãƒ«:</strong> Tsai-Wuç ´å£Šè¦æº–ã‚’ç”¨ã„ã¦å¤šè»¸å¿œåŠ›ä¸‹ã®å¼·åº¦ã‚’äºˆæ¸¬ã—ã€æœ€é©ç©å±¤æ§‹æˆã‚’è¨­è¨ˆã§ãã‚‹</li>
                    </ul>
                </div>

                <section>
                    <h2>2.1 ç¹Šç¶­å¼·åŒ–è¤‡åˆææ–™ã®ç¨®é¡</h2>

                    <h3>2.1.1 CFRP (ç‚­ç´ ç¹Šç¶­å¼·åŒ–ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯)</h3>
                    <p>
                        ç‚­ç´ ç¹Šç¶­(Carbon Fiber)ã‚’å¼·åŒ–æã¨ã™ã‚‹è¤‡åˆææ–™ã§ã€èˆªç©ºå®‡å®™ã€è‡ªå‹•è»Šã€ã‚¹ãƒãƒ¼ãƒ„ç”¨å“ã«åºƒãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>ç¹Šç¶­ç¨®é¡</th>
                                <th>å¼¾æ€§ç‡ [GPa]</th>
                                <th>å¼•å¼µå¼·åº¦ [MPa]</th>
                                <th>ç”¨é€”</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>é«˜å¼·åº¦(HS)</td>
                                <td>230-240</td>
                                <td>3500-4500</td>
                                <td>èˆªç©ºæ©Ÿä¸€æ¬¡æ§‹é€ æ</td>
                            </tr>
                            <tr>
                                <td>ä¸­å¼¾æ€§ç‡(IM)</td>
                                <td>280-300</td>
                                <td>4500-5500</td>
                                <td>ã‚¹ãƒãƒ¼ãƒ„ç”¨å“</td>
                            </tr>
                            <tr>
                                <td>é«˜å¼¾æ€§ç‡(HM)</td>
                                <td>350-500</td>
                                <td>2500-3500</td>
                                <td>è¡›æ˜Ÿæ§‹é€ æ</td>
                            </tr>
                            <tr>
                                <td>è¶…é«˜å¼¾æ€§ç‡(UHM)</td>
                                <td>500-700</td>
                                <td>2000-2500</td>
                                <td>ç²¾å¯†æ©Ÿå™¨</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>2.1.2 GFRP (ã‚¬ãƒ©ã‚¹ç¹Šç¶­å¼·åŒ–ãƒ—ãƒ©ã‚¹ãƒãƒƒã‚¯)</h3>
                    <p>
                        ã‚¬ãƒ©ã‚¹ç¹Šç¶­(Glass Fiber)ã‚’å¼·åŒ–æã¨ã™ã‚‹è¤‡åˆææ–™ã§ã€ã‚³ã‚¹ãƒˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã«å„ªã‚Œã¾ã™ã€‚
                    </p>

                    <table>
                        <thead>
                            <tr>
                                <th>ã‚¬ãƒ©ã‚¹ç¨®é¡</th>
                                <th>å¼¾æ€§ç‡ [GPa]</th>
                                <th>å¼•å¼µå¼·åº¦ [MPa]</th>
                                <th>ç‰¹å¾´</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Eã‚¬ãƒ©ã‚¹</td>
                                <td>72-73</td>
                                <td>3400-3800</td>
                                <td>æ±ç”¨ã€ä½ã‚³ã‚¹ãƒˆ</td>
                            </tr>
                            <tr>
                                <td>Sã‚¬ãƒ©ã‚¹</td>
                                <td>85-90</td>
                                <td>4500-4900</td>
                                <td>é«˜å¼·åº¦ã€é«˜ä¾¡</td>
                            </tr>
                            <tr>
                                <td>Rã‚¬ãƒ©ã‚¹</td>
                                <td>85-86</td>
                                <td>4400-4800</td>
                                <td>é«˜å¼·åº¦ã€è€ç–²åŠ´</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="mermaid">
                        flowchart TD
                            A[ç¹Šç¶­å¼·åŒ–è¤‡åˆææ–™] --> B[è£½é€ ãƒ—ãƒ­ã‚»ã‚¹]
                            B --> C[ãƒ—ãƒªãƒ—ãƒ¬ã‚°æ³•]
                            B --> D[RTMæ³•]
                            B --> E[ãƒãƒ³ãƒ‰ãƒ¬ã‚¤ã‚¢ãƒƒãƒ—]
                            B --> F[ãƒ•ã‚£ãƒ©ãƒ¡ãƒ³ãƒˆãƒ¯ã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°]

                            C --> G[ã‚ªãƒ¼ãƒˆã‚¯ãƒ¬ãƒ¼ãƒ–æˆå½¢<br/>é«˜å“è³ªãƒ»é«˜ã‚³ã‚¹ãƒˆ]
                            D --> H[æ¨¹è„‚æ³¨å…¥<br/>è¤‡é›‘å½¢çŠ¶å¯¾å¿œ]
                            E --> I[æ‰‹ä½œæ¥­<br/>ä½ã‚³ã‚¹ãƒˆãƒ»å°ãƒ­ãƒƒãƒˆ]
                            F --> J[å›è»¢ä½“<br/>åœ§åŠ›å®¹å™¨]

                            style A fill:#e1f5ff
                            style G fill:#c8e6c9
                            style H fill:#c8e6c9
                            style I fill:#fff9c4
                            style J fill:#c8e6c9
                    </div>
                </section>

                <section>
                    <h2>2.2 å˜å±¤(Lamina)ã®åŠ›å­¦</h2>

                    <h3>2.2.1 å¿œåŠ›-ã²ãšã¿é–¢ä¿‚</h3>
                    <p>
                        ä¸€æ–¹å‘ç¹Šç¶­å¼·åŒ–å˜å±¤ã®ä¸»è»¸åº§æ¨™ç³»(1-2ç³»ã€ç¹Šç¶­æ–¹å‘ã‚’1è»¸)ã«ãŠã‘ã‚‹
                        å¿œåŠ›-ã²ãšã¿é–¢ä¿‚ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™ï¼š
                    </p>

                    <div class="formula">
                        $$\begin{Bmatrix} \sigma_1 \\ \sigma_2 \\ \tau_{12} \end{Bmatrix} =
                        \begin{bmatrix} Q_{11} & Q_{12} & 0 \\ Q_{12} & Q_{22} & 0 \\ 0 & 0 & Q_{66} \end{bmatrix}
                        \begin{Bmatrix} \epsilon_1 \\ \epsilon_2 \\ \gamma_{12} \end{Bmatrix}$$
                    </div>

                    <p>ã“ã“ã§ã€ç¸®ç´„å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹ \([Q]\) ã®æˆåˆ†ã¯ï¼š</p>

                    <div class="formula">
                        $$Q_{11} = \frac{E_1}{1 - \nu_{12}\nu_{21}}, \quad
                          Q_{22} = \frac{E_2}{1 - \nu_{12}\nu_{21}}, \quad
                          Q_{12} = \frac{\nu_{12} E_2}{1 - \nu_{12}\nu_{21}}, \quad
                          Q_{66} = G_{12}$$
                    </div>

                    <p>
                        \(E_1, E_2\): ç¸¦ãƒ»æ¨ªå¼¾æ€§ç‡ã€\(\nu_{12}, \nu_{21}\): ãƒã‚¢ã‚½ãƒ³æ¯”ã€\(G_{12}\): ã›ã‚“æ–­å¼¾æ€§ç‡
                        <br>(ç›¸åå®šç†: \(\nu_{12}/E_1 = \nu_{21}/E_2\))
                    </p>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 2.1: å˜å±¤ã®å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹è¨ˆç®—</h4>
                        <pre><code class="language-python">import numpy as np

def lamina_stiffness_matrix(E1, E2, nu12, G12):
    """
    å˜å±¤ã®ç¸®ç´„å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹ [Q] ã‚’è¨ˆç®—

    Parameters:
    -----------
    E1 : float
        ç¸¦å¼¾æ€§ç‡ [GPa]
    E2 : float
        æ¨ªå¼¾æ€§ç‡ [GPa]
    nu12 : float
        ä¸»ãƒã‚¢ã‚½ãƒ³æ¯”
    G12 : float
        ã›ã‚“æ–­å¼¾æ€§ç‡ [GPa]

    Returns:
    --------
    Q : ndarray (3x3)
        ç¸®ç´„å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹ [GPa]
    """
    # ç›¸åå®šç†ã‹ã‚‰ nu21 ã‚’è¨ˆç®—
    nu21 = nu12 * E2 / E1

    # Q ãƒãƒˆãƒªã‚¯ã‚¹ã®æˆåˆ†
    denom = 1 - nu12 * nu21
    Q11 = E1 / denom
    Q22 = E2 / denom
    Q12 = nu12 * E2 / denom
    Q66 = G12

    Q = np.array([
        [Q11, Q12, 0],
        [Q12, Q22, 0],
        [0, 0, Q66]
    ])

    return Q

# CFRP/ã‚¨ãƒã‚­ã‚· å˜å±¤ã®ææ–™ç‰¹æ€§
E1 = 140.0   # GPa
E2 = 10.0    # GPa
nu12 = 0.30
G12 = 5.0    # GPa

Q = lamina_stiffness_matrix(E1, E2, nu12, G12)

print("ç¸®ç´„å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹ [Q] (GPa):")
print(Q)
print(f"\nQ11 = {Q[0,0]:.2f} GPa")
print(f"Q22 = {Q[1,1]:.2f} GPa")
print(f"Q12 = {Q[0,1]:.2f} GPa")
print(f"Q66 = {Q[2,2]:.2f} GPa")

# å¿œåŠ›è¨ˆç®—ä¾‹: Îµ1=0.005, Îµ2=0, Î³12=0
strain = np.array([0.005, 0, 0])
stress = Q @ strain

print(f"\nã²ãšã¿ [Îµ1, Îµ2, Î³12]: {strain}")
print(f"å¿œåŠ› [Ïƒ1, Ïƒ2, Ï„12] (MPa): {stress}")
print(f"ç¹Šç¶­æ–¹å‘å¿œåŠ› Ïƒ1: {stress[0]:.1f} MPa")</code></pre>
                    </div>

                    <h3>2.2.2 åº§æ¨™å¤‰æ›(Off-Axis Loading)</h3>
                    <p>
                        ç¹Šç¶­ãŒè·é‡æ–¹å‘ã¨è§’åº¦ \(\theta\) ã‚’ãªã™å ´åˆã€åº§æ¨™å¤‰æ›ãŒå¿…è¦ã§ã™ã€‚
                        å…¨ä½“åº§æ¨™ç³»(x-y)ã§ã®å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹ \([\bar{Q}]\) ã¯ï¼š
                    </p>

                    <div class="formula">
                        $$[\bar{Q}] = [T]^{-1} [Q] [T]^{-T}$$
                    </div>

                    <p>å¤‰æ›ãƒãƒˆãƒªã‚¯ã‚¹ \([T]\) ã¯ï¼š</p>

                    <div class="formula">
                        $$[T] = \begin{bmatrix}
                        c^2 & s^2 & 2sc \\
                        s^2 & c^2 & -2sc \\
                        -sc & sc & c^2 - s^2
                        \end{bmatrix}$$
                    </div>

                    <p>ã“ã“ã§ã€\(c = \cos\theta\)ã€\(s = \sin\theta\)</p>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 2.2: Off-Axis å‰›æ€§ã®è¨ˆç®—</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def transformation_matrix(theta_deg):
    """
    å¿œåŠ›ãƒ»ã²ãšã¿å¤‰æ›ãƒãƒˆãƒªã‚¯ã‚¹ [T]

    Parameters:
    -----------
    theta_deg : float
        ç¹Šç¶­é…å‘è§’åº¦ [åº¦]

    Returns:
    --------
    T : ndarray (3x3)
        å¤‰æ›ãƒãƒˆãƒªã‚¯ã‚¹
    """
    theta = np.radians(theta_deg)
    c = np.cos(theta)
    s = np.sin(theta)

    T = np.array([
        [c**2, s**2, 2*s*c],
        [s**2, c**2, -2*s*c],
        [-s*c, s*c, c**2 - s**2]
    ])

    return T

def offaxis_stiffness(Q, theta_deg):
    """
    Off-axis å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹ [QÌ„] ã‚’è¨ˆç®—

    Parameters:
    -----------
    Q : ndarray (3x3)
        ä¸»è»¸åº§æ¨™ç³»ã§ã®å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹
    theta_deg : float
        ç¹Šç¶­é…å‘è§’åº¦ [åº¦]

    Returns:
    --------
    Q_bar : ndarray (3x3)
        Off-axis å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹
    """
    T = transformation_matrix(theta_deg)
    T_inv = np.linalg.inv(T)

    Q_bar = T_inv @ Q @ T_inv.T

    return Q_bar

# CFRPææ–™ç‰¹æ€§
E1 = 140.0
E2 = 10.0
nu12 = 0.30
G12 = 5.0

Q = lamina_stiffness_matrix(E1, E2, nu12, G12)

# é…å‘è§’åº¦ã®ç¯„å›²
angles = np.arange(0, 91, 5)
Q_bar_11 = []
Q_bar_22 = []
Q_bar_66 = []
Q_bar_16 = []  # ã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°é …

for theta in angles:
    Q_bar = offaxis_stiffness(Q, theta)
    Q_bar_11.append(Q_bar[0, 0])
    Q_bar_22.append(Q_bar[1, 1])
    Q_bar_66.append(Q_bar[2, 2])
    Q_bar_16.append(Q_bar[0, 2])

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å‰›æ€§æˆåˆ†
ax1.plot(angles, Q_bar_11, 'b-', linewidth=2, label='QÌ„â‚â‚ (xæ–¹å‘)')
ax1.plot(angles, Q_bar_22, 'r-', linewidth=2, label='QÌ„â‚‚â‚‚ (yæ–¹å‘)')
ax1.plot(angles, Q_bar_66, 'g-', linewidth=2, label='QÌ„â‚†â‚† (ã›ã‚“æ–­)')
ax1.set_xlabel('ç¹Šç¶­é…å‘è§’åº¦ Î¸ [åº¦]')
ax1.set_ylabel('å‰›æ€§æˆåˆ† [GPa]')
ax1.set_title('Off-Axis å‰›æ€§ã®è§’åº¦ä¾å­˜æ€§')
ax1.grid(True, alpha=0.3)
ax1.legend()

# ã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°é …
ax2.plot(angles, Q_bar_16, 'm-', linewidth=2)
ax2.axhline(y=0, color='k', linestyle='--', alpha=0.3)
ax2.set_xlabel('ç¹Šç¶­é…å‘è§’åº¦ Î¸ [åº¦]')
ax2.set_ylabel('QÌ„â‚â‚† [GPa]')
ax2.set_title('ä¼¸å¼µ-ã›ã‚“æ–­ã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°')
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('offaxis_stiffness.png', dpi=300, bbox_inches='tight')
plt.close()

print(f"0åº¦ (ç¹Šç¶­æ–¹å‘): QÌ„11 = {Q_bar_11[0]:.1f} GPa")
print(f"45åº¦: QÌ„11 = {Q_bar_11[9]:.1f} GPa, QÌ„16 = {Q_bar_16[9]:.1f} GPa")
print(f"90åº¦ (ç¹Šç¶­å‚ç›´): QÌ„11 = {Q_bar_11[-1]:.1f} GPa")</code></pre>
                    </div>
                </section>

                <section>
                    <h2>2.3 å¤å…¸ç©å±¤ç†è«– (Classical Laminate Theory)</h2>

                    <h3>2.3.1 ç©å±¤æ¿ã®ä»®å®š</h3>
                    <p>å¤å…¸ç©å±¤ç†è«–(CLT)ã¯ä»¥ä¸‹ã®ä»®å®šã«åŸºã¥ãã¾ã™ï¼š</p>
                    <ul>
                        <li>å„å±¤ã¯å®Œå…¨ã«æ¥ç€ã•ã‚Œã¦ã„ã‚‹(å±¤é–“ã™ã¹ã‚Šãªã—)</li>
                        <li>æ¿åšæ–¹å‘ã®å‚ç›´å¿œåŠ›ã¯ç„¡è¦–ã§ãã‚‹(å¹³é¢å¿œåŠ›çŠ¶æ…‹)</li>
                        <li>Kirchhoff-Loveä»®å®š: æ¿åšæ–¹å‘ã®æ³•ç·šã¯å¤‰å½¢å¾Œã‚‚æ³•ç·šã®ã¾ã¾</li>
                    </ul>

                    <p>ã“ã‚Œã«ã‚ˆã‚Šã€ç©å±¤æ¿ã®ä¸­å¤®é¢ã‹ã‚‰ã®è·é›¢ \(z\) ã«ãŠã‘ã‚‹é¢å†…ã²ãšã¿ã¯ï¼š</p>

                    <div class="formula">
                        $$\begin{Bmatrix} \epsilon_x \\ \epsilon_y \\ \gamma_{xy} \end{Bmatrix} =
                        \begin{Bmatrix} \epsilon_x^0 \\ \epsilon_y^0 \\ \gamma_{xy}^0 \end{Bmatrix} + z
                        \begin{Bmatrix} \kappa_x \\ \kappa_y \\ \kappa_{xy} \end{Bmatrix}$$
                    </div>

                    <p>
                        \(\epsilon^0\): ä¸­å¤®é¢ã®ã²ãšã¿ã€\(\kappa\): æ›²ç‡
                    </p>

                    <h3>2.3.2 A-B-D ãƒãƒˆãƒªã‚¯ã‚¹</h3>
                    <p>
                        ç©å±¤æ¿ã®åˆå¿œåŠ›ãƒ»åˆãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¨ä¸­å¤®é¢ã²ãšã¿ãƒ»æ›²ç‡ã®é–¢ä¿‚ï¼š
                    </p>

                    <div class="formula">
                        $$\begin{Bmatrix} N \\ M \end{Bmatrix} =
                        \begin{bmatrix} [A] & [B] \\ [B] & [D] \end{bmatrix}
                        \begin{Bmatrix} \epsilon^0 \\ \kappa \end{Bmatrix}$$
                    </div>

                    <p>å„ãƒãƒˆãƒªã‚¯ã‚¹ã®ç‰©ç†çš„æ„å‘³ï¼š</p>
                    <ul>
                        <li><strong>[A]:</strong> ä¼¸å¼µå‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹ (Extensional stiffness)</li>
                        <li><strong>[B]:</strong> ä¼¸å¼µ-æ›²ã’ã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°ãƒãƒˆãƒªã‚¯ã‚¹ (Coupling stiffness)</li>
                        <li><strong>[D]:</strong> æ›²ã’å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹ (Bending stiffness)</li>
                    </ul>

                    <p>è¨ˆç®—å¼ï¼š</p>

                    <div class="formula">
                        $$A_{ij} = \sum_{k=1}^{n} (\bar{Q}_{ij})_k (z_k - z_{k-1})$$
                        $$B_{ij} = \frac{1}{2} \sum_{k=1}^{n} (\bar{Q}_{ij})_k (z_k^2 - z_{k-1}^2)$$
                        $$D_{ij} = \frac{1}{3} \sum_{k=1}^{n} (\bar{Q}_{ij})_k (z_k^3 - z_{k-1}^3)$$
                    </div>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 2.3: å¯¾ç§°ç©å±¤æ¿ã® A-B-D ãƒãƒˆãƒªã‚¯ã‚¹</h4>
                        <pre><code class="language-python">import numpy as np

class Laminate:
    """ç©å±¤æ¿ã®è§£æã‚¯ãƒ©ã‚¹"""

    def __init__(self, Q, layup, t_ply):
        """
        Parameters:
        -----------
        Q : ndarray (3x3)
            å˜å±¤ã®ä¸»è»¸å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹
        layup : list of float
            ç©å±¤æ§‹æˆ [Î¸1, Î¸2, ..., Î¸n] (åº¦)
        t_ply : float
            å˜å±¤åšã• [mm]
        """
        self.Q = Q
        self.layup = layup
        self.t_ply = t_ply
        self.n_plies = len(layup)
        self.total_thickness = self.n_plies * t_ply

        # zåº§æ¨™ã®è¨ˆç®—(ä¸­å¤®é¢ã‚’åŸºæº–)
        self.z = np.linspace(
            -self.total_thickness/2,
            self.total_thickness/2,
            self.n_plies + 1
        )

    def compute_ABD(self):
        """A-B-D ãƒãƒˆãƒªã‚¯ã‚¹ã‚’è¨ˆç®—"""
        A = np.zeros((3, 3))
        B = np.zeros((3, 3))
        D = np.zeros((3, 3))

        for k in range(self.n_plies):
            # å„å±¤ã® QÌ„ ãƒãƒˆãƒªã‚¯ã‚¹
            Q_bar = offaxis_stiffness(self.Q, self.layup[k])

            # å±¤ã®åšã•åº§æ¨™
            z_k = self.z[k]
            z_k1 = self.z[k + 1]

            # A, B, D ã®è¨ˆç®—
            A += Q_bar * (z_k1 - z_k)
            B += 0.5 * Q_bar * (z_k1**2 - z_k**2)
            D += (1/3) * Q_bar * (z_k1**3 - z_k**3)

        return A, B, D

    def is_symmetric(self):
        """ç©å±¤æ§‹æˆãŒå¯¾ç§°ã‹ã©ã†ã‹åˆ¤å®š"""
        n = len(self.layup)
        for i in range(n // 2):
            if self.layup[i] != self.layup[n - 1 - i]:
                return False
        return True

# CFRPææ–™ç‰¹æ€§
E1 = 140.0
E2 = 10.0
nu12 = 0.30
G12 = 5.0
Q = lamina_stiffness_matrix(E1, E2, nu12, G12)

# ç©å±¤æ§‹æˆã®ä¾‹
layup_symmetric = [0, 45, -45, 90, 90, -45, 45, 0]  # å¯¾ç§°ç©å±¤
layup_unsymmetric = [0, 45, -45, 90]                 # éå¯¾ç§°ç©å±¤

t_ply = 0.125  # mm

# å¯¾ç§°ç©å±¤æ¿
lam_sym = Laminate(Q, layup_symmetric, t_ply)
A_sym, B_sym, D_sym = lam_sym.compute_ABD()

print("=== å¯¾ç§°ç©å±¤æ¿ [0/45/-45/90]s ===")
print(f"ç©å±¤æ§‹æˆ: {layup_symmetric}")
print(f"ç·æ¿åš: {lam_sym.total_thickness} mm")
print(f"å¯¾ç§°æ€§: {lam_sym.is_symmetric()}")
print("\n[A] ãƒãƒˆãƒªã‚¯ã‚¹ (N/mm):")
print(A_sym)
print("\n[B] ãƒãƒˆãƒªã‚¯ã‚¹ (NÂ·mm):")
print(B_sym)
print(f"B ãƒãƒˆãƒªã‚¯ã‚¹ã®ãƒãƒ«ãƒ : {np.linalg.norm(B_sym):.2e} (å¯¾ç§°ç©å±¤ã§ã¯ â‰ˆ 0)")
print("\n[D] ãƒãƒˆãƒªã‚¯ã‚¹ (NÂ·mmÂ²):")
print(D_sym)

# éå¯¾ç§°ç©å±¤æ¿
lam_unsym = Laminate(Q, layup_unsymmetric, t_ply)
A_unsym, B_unsym, D_unsym = lam_unsym.compute_ABD()

print("\n\n=== éå¯¾ç§°ç©å±¤æ¿ [0/45/-45/90] ===")
print(f"ç©å±¤æ§‹æˆ: {layup_unsymmetric}")
print(f"å¯¾ç§°æ€§: {lam_unsym.is_symmetric()}")
print("\n[B] ãƒãƒˆãƒªã‚¯ã‚¹ (NÂ·mm):")
print(B_unsym)
print(f"B ãƒãƒˆãƒªã‚¯ã‚¹ã®ãƒãƒ«ãƒ : {np.linalg.norm(B_unsym):.2e} (ä¼¸å¼µ-æ›²ã’ã‚«ãƒƒãƒ—ãƒªãƒ³ã‚°æœ‰)")</code></pre>
                    </div>

                    <h3>2.3.3 æº–ç­‰æ–¹æ€§ç©å±¤æ¿</h3>
                    <p>
                        ç‰¹å®šã®ç©å±¤æ§‹æˆã«ã‚ˆã‚Šã€é¢å†…ã§ç­‰æ–¹çš„ãªç‰¹æ€§ã‚’æŒã¤ç©å±¤æ¿ã‚’è¨­è¨ˆã§ãã¾ã™ã€‚
                        æº–ç­‰æ–¹æ€§(Quasi-isotropic)ã®æ¡ä»¶ã¯ã€3å±¤ä»¥ä¸Šã§ \(180Â°/n\) ãšã¤è§’åº¦ãŒç•°ãªã‚‹é…å‘ï¼š
                    </p>
                    <ul>
                        <li>3å±¤: [0/60/-60] ã¾ãŸã¯ [0/60/120]</li>
                        <li>4å±¤: [0/45/-45/90] (æœ€ã‚‚ä¸€èˆ¬çš„)</li>
                    </ul>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 2.4: æº–ç­‰æ–¹æ€§ç©å±¤æ¿ã®æ¤œè¨¼</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def check_quasi_isotropic(A):
    """
    æº–ç­‰æ–¹æ€§ã‚’åˆ¤å®š

    æº–ç­‰æ–¹æ€§ã®æ¡ä»¶:
    - A11 = A22
    - A16 = A26 = 0
    - A66 = (A11 - A12) / 2
    """
    tol = 1e-6

    condition1 = np.abs(A[0,0] - A[1,1]) < tol
    condition2 = np.abs(A[0,2]) < tol and np.abs(A[1,2]) < tol
    condition3 = np.abs(A[2,2] - (A[0,0] - A[0,1])/2) < tol

    is_quasi_iso = condition1 and condition2 and condition3

    return is_quasi_iso, {
        'A11 = A22': condition1,
        'A16 = A26 = 0': condition2,
        'A66 = (A11-A12)/2': condition3
    }

# CFRPææ–™
E1 = 140.0
E2 = 10.0
nu12 = 0.30
G12 = 5.0
Q = lamina_stiffness_matrix(E1, E2, nu12, G12)

# æ§˜ã€…ãªç©å±¤æ§‹æˆã‚’ãƒ†ã‚¹ãƒˆ
layups = {
    '[0/45/-45/90]': [0, 45, -45, 90],
    '[0/60/-60]': [0, 60, -60],
    '[0/90]': [0, 90],
    '[45/-45]': [45, -45]
}

t_ply = 0.125

print("æº–ç­‰æ–¹æ€§ã®åˆ¤å®š:\n" + "="*60)
for name, layup in layups.items():
    lam = Laminate(Q, layup, t_ply)
    A, B, D = lam.compute_ABD()

    is_qi, conditions = check_quasi_isotropic(A)

    print(f"\nç©å±¤æ§‹æˆ: {name}")
    print(f"æº–ç­‰æ–¹æ€§: {is_qi}")
    for cond, result in conditions.items():
        status = "âœ“" if result else "âœ—"
        print(f"  {status} {cond}")

    if is_qi:
        # ç­‰ä¾¡ç­‰æ–¹æ€§ç‰¹æ€§ã‚’è¨ˆç®—
        E_eq = A[0,0] / lam.total_thickness
        nu_eq = A[0,1] / A[0,0]
        G_eq = A[2,2] / lam.total_thickness

        print(f"  ç­‰ä¾¡ãƒ¤ãƒ³ã‚°ç‡: {E_eq:.1f} GPa")
        print(f"  ç­‰ä¾¡ãƒã‚¢ã‚½ãƒ³æ¯”: {nu_eq:.3f}")
        print(f"  ç­‰ä¾¡ã›ã‚“æ–­å¼¾æ€§ç‡: {G_eq:.1f} GPa")</code></pre>
                    </div>
                </section>

                <section>
                    <h2>2.4 ç©å±¤æ¿ã®å¼·åº¦äºˆæ¸¬</h2>

                    <h3>2.4.1 æœ€å¤§å¿œåŠ›è¦æº–</h3>
                    <p>
                        å„å±¤ã®ä¸»è»¸åº§æ¨™ç³»ã§ã®å¿œåŠ›ãŒè¨±å®¹å€¤ã‚’è¶…ãˆãªã„ã“ã¨ï¼š
                    </p>

                    <div class="formula">
                        $$\sigma_1 \leq X_t \text{ (å¼•å¼µ)}, \quad \sigma_1 \geq -X_c \text{ (åœ§ç¸®)}$$
                        $$\sigma_2 \leq Y_t \text{ (å¼•å¼µ)}, \quad \sigma_2 \geq -Y_c \text{ (åœ§ç¸®)}$$
                        $$|\tau_{12}| \leq S$$
                    </div>

                    <h3>2.4.2 Tsai-Wu ç ´å£Šè¦æº–</h3>
                    <p>
                        å¤šè»¸å¿œåŠ›çŠ¶æ…‹ã«ãŠã‘ã‚‹ç ´å£Šã‚’äºˆæ¸¬ã™ã‚‹äºŒæ¬¡å½¢å¼ã®è¦æº–ï¼š
                    </p>

                    <div class="formula">
                        $$F_1\sigma_1 + F_2\sigma_2 + F_{11}\sigma_1^2 + F_{22}\sigma_2^2 + F_{66}\tau_{12}^2 + 2F_{12}\sigma_1\sigma_2 \leq 1$$
                    </div>

                    <p>ä¿‚æ•°ã®æ±ºå®šï¼š</p>
                    <div class="formula">
                        $$F_1 = \frac{1}{X_t} - \frac{1}{X_c}, \quad F_2 = \frac{1}{Y_t} - \frac{1}{Y_c}$$
                        $$F_{11} = \frac{1}{X_t X_c}, \quad F_{22} = \frac{1}{Y_t Y_c}, \quad F_{66} = \frac{1}{S^2}$$
                        $$F_{12} = -\frac{1}{2}\sqrt{F_{11} F_{22}}$$
                    </div>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 2.5: Tsai-Wu ç ´å£Šè¦æº–ã«ã‚ˆã‚‹å¼·åº¦äºˆæ¸¬</h4>
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

class TsaiWuCriterion:
    """Tsai-Wuç ´å£Šè¦æº–"""

    def __init__(self, X_t, X_c, Y_t, Y_c, S):
        """
        Parameters:
        -----------
        X_t, X_c : float
            ç¸¦æ–¹å‘å¼•å¼µãƒ»åœ§ç¸®å¼·åº¦ [MPa]
        Y_t, Y_c : float
            æ¨ªæ–¹å‘å¼•å¼µãƒ»åœ§ç¸®å¼·åº¦ [MPa]
        S : float
            ã›ã‚“æ–­å¼·åº¦ [MPa]
        """
        self.X_t = X_t
        self.X_c = X_c
        self.Y_t = Y_t
        self.Y_c = Y_c
        self.S = S

        # Tsai-Wu ä¿‚æ•°ã®è¨ˆç®—
        self.F1 = 1/X_t - 1/X_c
        self.F2 = 1/Y_t - 1/Y_c
        self.F11 = 1/(X_t * X_c)
        self.F22 = 1/(Y_t * Y_c)
        self.F66 = 1/S**2
        self.F12 = -0.5 * np.sqrt(self.F11 * self.F22)

    def failure_index(self, sigma1, sigma2, tau12):
        """
        ç ´å£ŠæŒ‡æ•°ã‚’è¨ˆç®—

        Returns:
        --------
        FI : float
            ç ´å£ŠæŒ‡æ•° (FI < 1: å®‰å…¨ã€FI = 1: ç ´å£Šã€FI > 1: ç ´æ)
        """
        FI = (self.F1 * sigma1 + self.F2 * sigma2 +
              self.F11 * sigma1**2 + self.F22 * sigma2**2 +
              self.F66 * tau12**2 + 2 * self.F12 * sigma1 * sigma2)

        return FI

    def safety_factor(self, sigma1, sigma2, tau12):
        """å®‰å…¨ç‡ã‚’è¨ˆç®—"""
        FI = self.failure_index(sigma1, sigma2, tau12)
        if FI <= 0:
            return np.inf
        return 1 / np.sqrt(FI)

# CFRP/ã‚¨ãƒã‚­ã‚·ã®å¼·åº¦ç‰¹æ€§
X_t = 1500  # MPa
X_c = 1200  # MPa
Y_t = 50    # MPa
Y_c = 200   # MPa
S = 70      # MPa

criterion = TsaiWuCriterion(X_t, X_c, Y_t, Y_c, S)

# ç ´å£ŠåŒ…çµ¡ç·šã®ä½œæˆ(Ïƒ1-Ïƒ2 å¹³é¢)
sigma1_range = np.linspace(-X_c, X_t, 200)
sigma2_range = np.linspace(-Y_c, Y_t, 200)

# ã‚°ãƒªãƒƒãƒ‰ä½œæˆ
S1, S2 = np.meshgrid(sigma1_range, sigma2_range)
FI_grid = np.zeros_like(S1)

for i in range(len(sigma2_range)):
    for j in range(len(sigma1_range)):
        FI_grid[i, j] = criterion.failure_index(S1[i, j], S2[i, j], 0)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# ç ´å£ŠåŒ…çµ¡ç·š(Ï„12 = 0)
contour = ax1.contour(S1, S2, FI_grid, levels=[1.0], colors='r', linewidths=2)
ax1.contourf(S1, S2, FI_grid, levels=[0, 1.0], colors=['lightgreen'], alpha=0.3)
ax1.set_xlabel('Ïƒâ‚ [MPa]')
ax1.set_ylabel('Ïƒâ‚‚ [MPa]')
ax1.set_title('Tsai-Wu ç ´å£ŠåŒ…çµ¡ç·š (Ï„â‚â‚‚ = 0)')
ax1.grid(True, alpha=0.3)
ax1.axhline(y=0, color='k', linewidth=0.5)
ax1.axvline(x=0, color='k', linewidth=0.5)

# ç‰¹å®šå¿œåŠ›çŠ¶æ…‹ã§ã®å®‰å…¨ç‡
test_cases = [
    (500, 20, 0, "å¼•å¼µ-å¼•å¼µ"),
    (500, -50, 0, "å¼•å¼µ-åœ§ç¸®"),
    (-400, -100, 0, "åœ§ç¸®-åœ§ç¸®"),
    (300, 0, 40, "å¼•å¼µ-ã›ã‚“æ–­")
]

results = []
for sigma1, sigma2, tau12, case_name in test_cases:
    FI = criterion.failure_index(sigma1, sigma2, tau12)
    SF = criterion.safety_factor(sigma1, sigma2, tau12)
    results.append((case_name, sigma1, sigma2, tau12, FI, SF))

    if tau12 == 0:  # Ï„12=0 ã®å ´åˆã®ã¿ãƒ—ãƒ­ãƒƒãƒˆ
        marker = 'o' if FI < 1 else 'x'
        color = 'blue' if FI < 1 else 'red'
        ax1.plot(sigma1, sigma2, marker, markersize=10, color=color,
                label=f"{case_name} (SF={SF:.2f})")

ax1.legend()

# çµæœãƒ†ãƒ¼ãƒ–ãƒ«
ax2.axis('off')
table_data = [["è·é‡çŠ¶æ…‹", "Ïƒâ‚", "Ïƒâ‚‚", "Ï„â‚â‚‚", "FI", "SF"]]
for case_name, s1, s2, t12, fi, sf in results:
    table_data.append([
        case_name,
        f"{s1:.0f}",
        f"{s2:.0f}",
        f"{t12:.0f}",
        f"{fi:.3f}",
        f"{sf:.2f}" if sf != np.inf else "âˆ"
    ])

table = ax2.table(cellText=table_data, cellLoc='center', loc='center',
                  colWidths=[0.25, 0.15, 0.15, 0.15, 0.15, 0.15])
table.auto_set_font_size(False)
table.set_fontsize(10)
table.scale(1, 2)

# ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®ã‚¹ã‚¿ã‚¤ãƒ«
for i in range(6):
    table[(0, i)].set_facecolor('#4CAF50')
    table[(0, i)].set_text_props(weight='bold', color='white')

# ãƒ‡ãƒ¼ã‚¿è¡Œã®è‰²åˆ†ã‘
for i in range(1, len(table_data)):
    fi_val = float(table_data[i][4])
    color = '#c8e6c9' if fi_val < 1 else '#ffcdd2'
    for j in range(6):
        table[(i, j)].set_facecolor(color)

ax2.set_title('ç ´å£ŠæŒ‡æ•°ã¨å®‰å…¨ç‡', fontsize=12, weight='bold', pad=20)

plt.tight_layout()
plt.savefig('tsai_wu_failure.png', dpi=300, bbox_inches='tight')
plt.close()

# ã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›
print("Tsai-Wu ç ´å£Šè¦æº–ã«ã‚ˆã‚‹å¼·åº¦è©•ä¾¡:")
print("="*70)
for case_name, s1, s2, t12, fi, sf in results:
    status = "å®‰å…¨" if fi < 1 else "ç ´æ"
    print(f"\n{case_name}: Ïƒ1={s1} MPa, Ïƒ2={s2} MPa, Ï„12={t12} MPa")
    print(f"  ç ´å£ŠæŒ‡æ•° FI = {fi:.3f} ({status})")
    print(f"  å®‰å…¨ç‡ SF = {sf:.2f}" if sf != np.inf else f"  å®‰å…¨ç‡ SF = âˆ")</code></pre>
                    </div>

                    <h3>2.4.3 First Ply Failure (FPF)</h3>
                    <p>
                        ç©å±¤æ¿ã®ç ´å£Šã¯ã€æœ€åˆã®å±¤ãŒç ´å£Šã™ã‚‹è·é‡(FPF)ã‹ã‚‰æœ€çµ‚ç ´å£Š(LPF)ã¾ã§
                        æ®µéšçš„ã«é€²è¡Œã—ã¾ã™ã€‚FPFè§£æã§ã¯å„å±¤ã®å¿œåŠ›ã‚’è¨ˆç®—ã—ã€æœ€ã‚‚æ—©ãç ´å£Šè¦æº–ã‚’
                        æº€ãŸã™å±¤ã‚’ç‰¹å®šã—ã¾ã™ã€‚
                    </p>

                    <div class="example">
                        <h4>ä¾‹é¡Œ 2.6: ç©å±¤æ¿ã® FPF è§£æ</h4>
                        <pre><code class="language-python">import numpy as np

def first_ply_failure_analysis(lam, applied_strain, criterion):
    """
    First Ply Failure è§£æ

    Parameters:
    -----------
    lam : Laminate
        ç©å±¤æ¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
    applied_strain : ndarray (3,)
        å°åŠ ã²ãšã¿ [Îµx, Îµy, Î³xy]
    criterion : TsaiWuCriterion
        ç ´å£Šè¦æº–ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ

    Returns:
    --------
    results : list of dict
        å„å±¤ã®å¿œåŠ›ã¨ç ´å£ŠæŒ‡æ•°
    """
    results = []

    for k in range(lam.n_plies):
        # å±¤ã®ä¸­å¤®ä½ç½®
        z_mid = (lam.z[k] + lam.z[k+1]) / 2

        # å…¨ä½“åº§æ¨™ç³»ã§ã®å¿œåŠ›è¨ˆç®—
        Q_bar = offaxis_stiffness(lam.Q, lam.layup[k])
        stress_global = Q_bar @ applied_strain

        # ä¸»è»¸åº§æ¨™ç³»ã¸å¤‰æ›
        T = transformation_matrix(lam.layup[k])
        stress_local = T @ stress_global

        sigma1, sigma2, tau12 = stress_local

        # ç ´å£ŠæŒ‡æ•°è¨ˆç®—
        FI = criterion.failure_index(sigma1, sigma2, tau12)
        SF = criterion.safety_factor(sigma1, sigma2, tau12)

        results.append({
            'ply': k + 1,
            'angle': lam.layup[k],
            'z': z_mid,
            'stress_global': stress_global,
            'stress_local': stress_local,
            'FI': FI,
            'SF': SF
        })

    return results

# ç©å±¤æ¿è¨­å®š
E1 = 140.0
E2 = 10.0
nu12 = 0.30
G12 = 5.0
Q = lamina_stiffness_matrix(E1, E2, nu12, G12)

layup = [0, 45, -45, 90]
t_ply = 0.125

lam = Laminate(Q, layup, t_ply)

# ç ´å£Šè¦æº–
X_t = 1500
X_c = 1200
Y_t = 50
Y_c = 200
S = 70
criterion = TsaiWuCriterion(X_t, X_c, Y_t, Y_c, S)

# å°åŠ ã²ãšã¿(xæ–¹å‘å¼•å¼µ)
applied_strain = np.array([0.005, 0, 0])

# FPFè§£æå®Ÿè¡Œ
results = first_ply_failure_analysis(lam, applied_strain, criterion)

# çµæœè¡¨ç¤º
print("First Ply Failure è§£æçµæœ:")
print("="*80)
print(f"ç©å±¤æ§‹æˆ: {layup}")
print(f"å°åŠ ã²ãšã¿: Îµx = {applied_strain[0]:.4f}, Îµy = {applied_strain[1]:.4f}, "
      f"Î³xy = {applied_strain[2]:.4f}")
print("\nå„å±¤ã®å¿œåŠ›çŠ¶æ…‹:")
print("-"*80)
print(f"{'å±¤':>3} {'è§’åº¦':>6} {'Ïƒ1':>10} {'Ïƒ2':>10} {'Ï„12':>10} {'FI':>8} {'SF':>8}")
print("-"*80)

fpf_ply = None
min_sf = np.inf

for r in results:
    print(f"{r['ply']:3d} {r['angle']:6.0f}Â° {r['stress_local'][0]:10.1f} "
          f"{r['stress_local'][1]:10.1f} {r['stress_local'][2]:10.1f} "
          f"{r['FI']:8.3f} {r['SF']:8.2f}")

    if r['SF'] < min_sf:
        min_sf = r['SF']
        fpf_ply = r['ply']

print("-"*80)
print(f"\nFirst Ply Failure: å±¤ {fpf_ply} (è§’åº¦ {layup[fpf_ply-1]}Â°)")
print(f"å®‰å…¨ç‡: {min_sf:.2f}")
print(f"ç ´å£Šã²ãšã¿: {applied_strain[0] * min_sf:.4f}")</code></pre>
                    </div>
                </section>

                <section>
                    <h2>2.5 ã¾ã¨ã‚</h2>
                    <p>æœ¬ç« ã§ã¯ã€ç¹Šç¶­å¼·åŒ–è¤‡åˆææ–™ã®åŠ›å­¦ã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸï¼š</p>
                    <ul>
                        <li>CFRP/GFRPã®ç¨®é¡ã¨è£½é€ æ³•</li>
                        <li>å˜å±¤ã®å¿œåŠ›-ã²ãšã¿é–¢ä¿‚ã¨åº§æ¨™å¤‰æ›</li>
                        <li>å¤å…¸ç©å±¤ç†è«–(CLT)ã¨A-B-Dè¡Œåˆ—</li>
                        <li>å¯¾ç§°ç©å±¤ã¨æº–ç­‰æ–¹æ€§ç©å±¤ã®è¨­è¨ˆ</li>
                        <li>Tsai-Wuç ´å£Šè¦æº–ã«ã‚ˆã‚‹å¼·åº¦äºˆæ¸¬</li>
                        <li>First Ply Failureè§£æ</li>
                    </ul>

                    <p>
                        æ¬¡ç« ã§ã¯ã€ç²’å­å¼·åŒ–è¤‡åˆææ–™(MMC, CMC)ã¨ç©å±¤è¤‡åˆææ–™ã«ã¤ã„ã¦å­¦ã³ã€
                        å¼·åŒ–ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨ç‰¹æ€§è©•ä¾¡æ³•ã‚’ç¿’å¾—ã—ã¾ã™ã€‚
                    </p>
                </section>

                <section>
                    <h2>æ¼”ç¿’å•é¡Œ</h2>

                    <div class="exercise">
                        <h3>åŸºç¤ãƒ¬ãƒ™ãƒ«</h3>

                        <h4>å•é¡Œ 2.1: å˜å±¤å‰›æ€§ã®è¨ˆç®—</h4>
                        <p>
                            GFRPå˜å±¤(Eâ‚=40 GPa, Eâ‚‚=8 GPa, Î½â‚â‚‚=0.25, Gâ‚â‚‚=4 GPa)ã®
                            ç¸®ç´„å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹[Q]ã‚’æ±‚ã‚ã‚ˆã€‚
                        </p>

                        <h4>å•é¡Œ 2.2: Off-Axis å¼¾æ€§ç‡</h4>
                        <p>
                            å•é¡Œ2.1ã®GFRPå˜å±¤ã‚’45Â°é…å‘ã•ã›ãŸå ´åˆã®å…¨ä½“åº§æ¨™ç³»ã§ã®
                            å‰›æ€§ãƒãƒˆãƒªã‚¯ã‚¹[QÌ„]ã‚’è¨ˆç®—ã›ã‚ˆã€‚
                        </p>

                        <h4>å•é¡Œ 2.3: å¯¾ç§°ç©å±¤ã®åˆ¤å®š</h4>
                        <p>
                            ä»¥ä¸‹ã®ç©å±¤æ§‹æˆã«ã¤ã„ã¦ã€å¯¾ç§°ç©å±¤ã‹ã©ã†ã‹åˆ¤å®šã›ã‚ˆï¼š
                            <br>(a) [0/90/90/0]
                            <br>(b) [0/45/-45/90]
                            <br>(c) [0/90/0]
                        </p>
                    </div>

                    <div class="exercise">
                        <h3>å¿œç”¨ãƒ¬ãƒ™ãƒ«</h3>

                        <h4>å•é¡Œ 2.4: A-B-D ãƒãƒˆãƒªã‚¯ã‚¹ã®è¨ˆç®—</h4>
                        <p>
                            [0/90]s ç©å±¤æ¿(å˜å±¤åšã• 0.125 mm, CFRP: Eâ‚=140 GPa, Eâ‚‚=10 GPa,
                            Î½â‚â‚‚=0.30, Gâ‚â‚‚=5 GPa)ã®A-B-D ãƒãƒˆãƒªã‚¯ã‚¹ã‚’è¨ˆç®—ã—ã€
                            Bãƒãƒˆãƒªã‚¯ã‚¹ãŒã‚¼ãƒ­ã«ãªã‚‹ã“ã¨ã‚’ç¢ºèªã›ã‚ˆã€‚
                        </p>

                        <h4>å•é¡Œ 2.5: æº–ç­‰æ–¹æ€§ç©å±¤ã®è¨­è¨ˆ</h4>
                        <p>
                            3å±¤æ§‹æˆã®æº–ç­‰æ–¹æ€§ç©å±¤æ¿ã‚’è¨­è¨ˆã—ã€Aãƒãƒˆãƒªã‚¯ã‚¹ãŒæº–ç­‰æ–¹æ€§æ¡ä»¶ã‚’
                            æº€ãŸã™ã“ã¨ã‚’ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã§æ¤œè¨¼ã›ã‚ˆã€‚
                        </p>

                        <h4>å•é¡Œ 2.6: Tsai-Wu è¦æº–ã®é©ç”¨</h4>
                        <p>
                            CFRPå˜å±¤(X_t=1500 MPa, X_c=1200 MPa, Y_t=50 MPa, Y_c=200 MPa, S=70 MPa)ã«
                            Ïƒâ‚=600 MPa, Ïƒâ‚‚=30 MPa, Ï„â‚â‚‚=0 MPa ãŒä½œç”¨ã™ã‚‹å ´åˆã®å®‰å…¨ç‡ã‚’è¨ˆç®—ã›ã‚ˆã€‚
                        </p>

                        <h4>å•é¡Œ 2.7: FPF è§£æãƒ—ãƒ­ã‚°ãƒ©ãƒ </h4>
                        <p>
                            [0/45/-45/90] ç©å±¤æ¿ã«ä¸€è»¸å¼•å¼µã²ãšã¿ã‚’å°åŠ ã—ãŸå ´åˆã®
                            First Ply Failure ã‚’äºˆæ¸¬ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã›ã‚ˆã€‚
                        </p>
                    </div>

                    <div class="exercise">
                        <h3>ç™ºå±•ãƒ¬ãƒ™ãƒ«</h3>

                        <h4>å•é¡Œ 2.8: ç©å±¤æ§‹æˆã®æœ€é©åŒ–</h4>
                        <p>
                            äºŒè»¸è·é‡(Nx, Ny)ã‚’å—ã‘ã‚‹ç©å±¤æ¿ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã‚’æº€ãŸã™
                            æœ€é©ç©å±¤æ§‹æˆ(è§’åº¦ã¨æšæ•°)ã‚’ scipy.optimize ã§æ±‚ã‚ã‚ˆï¼š
                        </p>
                        <ul>
                            <li>ç›®æ¨™: æ¿åšã‚’æœ€å°åŒ–</li>
                            <li>åˆ¶ç´„: First Ply Failure ãŒç™ºç”Ÿã—ãªã„</li>
                            <li>ä½¿ç”¨å¯èƒ½è§’åº¦: 0Â°, Â±45Â°, 90Â°</li>
                        </ul>

                        <h4>å•é¡Œ 2.9: ç†±æ®‹ç•™å¿œåŠ›ã®è©•ä¾¡</h4>
                        <p>
                            CFRPç©å±¤æ¿ã®ç¡¬åŒ–éç¨‹(180Â°C â†’ 25Â°C)ã§ç™ºç”Ÿã™ã‚‹ç†±æ®‹ç•™å¿œåŠ›ã‚’è¨ˆç®—ã›ã‚ˆã€‚
                            ç†±è†¨å¼µä¿‚æ•°ã‚’è€ƒæ…®ã—ãŸCLTã®æ‹¡å¼µãŒå¿…è¦ã€‚
                            (Î±â‚ = -0.5Ã—10â»â¶ /Â°C, Î±â‚‚ = 30Ã—10â»â¶ /Â°C)
                        </p>

                        <h4>å•é¡Œ 2.10: æå‚·é€²å±•ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
                        <p>
                            First Ply Failure å¾Œã®æå‚·é€²å±•ã‚’æ¨¡æ“¬ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè£…ã›ã‚ˆã€‚
                            ç ´æã—ãŸå±¤ã®å‰›æ€§ã‚’ä½ä¸‹ã•ã›(å‰›æ€§ä½ä¸‹ãƒ¢ãƒ‡ãƒ«)ã€
                            Last Ply Failure ã¾ã§ã®è·é‡-å¤‰ä½æ›²ç·šã‚’æ±‚ã‚ã‚ˆã€‚
                        </p>
                    </div>
                </section>

                <section>
                    <h2>å‚è€ƒæ–‡çŒ®</h2>
                    <ol class="references">
                        <li>Jones, R. M., "Mechanics of Composite Materials", 2nd ed., Taylor & Francis, 1999, pp. 190-267</li>
                        <li>Kaw, A. K., "Mechanics of Composite Materials", 2nd ed., CRC Press, 2005, pp. 145-223</li>
                        <li>Tsai, S. W. and Wu, E. M., "A General Theory of Strength for Anisotropic Materials", Journal of Composite Materials, Vol. 5, 1971, pp. 58-80</li>
                        <li>Hyer, M. W., "Stress Analysis of Fiber-Reinforced Composite Materials", DEStech Publications, 2009, pp. 312-389</li>
                        <li>Barbero, E. J., "Introduction to Composite Materials Design", 2nd ed., CRC Press, 2010, pp. 89-156</li>
                        <li>Reddy, J. N., "Mechanics of Laminated Composite Plates and Shells: Theory and Analysis", 2nd ed., CRC Press, 2003, pp. 234-301</li>
                        <li>Daniel, I. M. and Ishai, O., "Engineering Mechanics of Composite Materials", 2nd ed., Oxford University Press, 2006, pp. 147-218</li>
                        <li>Herakovich, C. T., "Mechanics of Fibrous Composites", Wiley, 1998, pp. 178-245</li>
                    </ol>
                </section>

                <div class="navigation">
                    <a href="chapter-1.html" class="prev">â† ç¬¬1ç«  è¤‡åˆææ–™ã®åŸºç¤</a>
                    <a href="chapter-3.html" class="next">ç¬¬3ç«  ç²’å­ãƒ»ç©å±¤è¤‡åˆææ–™ â†’</a>
                </div>
            </article>
        <section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

</main>
    </div>

    <footer>
        <p>&copy; 2025 Materials Science Learning Series. All rights reserved.</p>
    </footer>

    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
</body>
</html>