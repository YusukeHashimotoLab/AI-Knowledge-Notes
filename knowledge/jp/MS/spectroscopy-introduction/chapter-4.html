<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
<meta content="ç¬¬4ç« : Xç·šå…‰é›»å­åˆ†å…‰æ³• (XPS) - åˆ†å…‰åˆ†ææ³•å…¥é–€. XPSã®å…‰é›»åŠ¹æœåŸç†ã¨ã‚¢ã‚¤ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³ã®å¼ã‚’ç†è§£ã—ã¦ã„ã‚‹" name="description"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬4ç« : Xç·šå…‰é›»å­åˆ†å…‰æ³• (XPS) - åˆ†å…‰åˆ†ææ³•å…¥é–€</title>

    <!-- MathJax for equations -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-bg: #ffffff;
            --color-text: #333333;
            --color-border: #e0e0e0;
            --color-code-bg: #f8f9fa;
            --spacing-unit: 8px;
            --font-body: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            --font-code: 'Consolas', 'Monaco', monospace;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.8;
            color: var(--color-text);
            background: var(--color-bg);
            padding: calc(var(--spacing-unit) * 4);
            max-width: 1200px;
            margin: 0 auto;
        }

        h1, h2, h3, h4 {
            color: var(--color-primary);
            margin-top: calc(var(--spacing-unit) * 6);
            margin-bottom: calc(var(--spacing-unit) * 3);
            line-height: 1.3;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            padding-bottom: calc(var(--spacing-unit) * 2);
            border-bottom: 3px solid var(--color-accent);
        }

        h2 {
            font-size: 1.8rem;
            padding-left: calc(var(--spacing-unit) * 2);
            border-left: 4px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-accent-light);
        }

        h4 {
            font-size: 1.2rem;
        }

        p {
            margin-bottom: calc(var(--spacing-unit) * 2);
            text-align: justify;
        }

        .intro-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            border-left: 4px solid var(--color-accent);
            margin: calc(var(--spacing-unit) * 4) 0;
        }

        .key-concept {
            background: var(--color-code-bg);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 3) 0;
            border: 2px solid var(--color-border);
        }

        .equation-box {
            background: #fff;
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 3) 0;
            border: 2px solid var(--color-accent-light);
            box-shadow: 0 2px 8px rgba(245, 87, 108, 0.1);
        }

        code {
            font-family: var(--font-code);
            background: var(--color-code-bg);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        pre {
            background: #2d2d2d;
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            overflow-x: auto;
            margin: calc(var(--spacing-unit) * 3) 0;
            border: 2px solid var(--color-accent);
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .mermaid {
            background: white;
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 4) 0;
            border: 2px solid var(--color-border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: calc(var(--spacing-unit) * 3) 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        th, td {
            padding: calc(var(--spacing-unit) * 2);
            text-align: left;
            border: 1px solid var(--color-border);
        }

        th {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: var(--color-code-bg);
        }

        ul, ol {
            margin: calc(var(--spacing-unit) * 2) 0;
            padding-left: calc(var(--spacing-unit) * 5);
        }

        li {
            margin: calc(var(--spacing-unit) * 1) 0;
        }

        .exercise-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.05) 0%, rgba(245, 87, 108, 0.05) 100%);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 3) 0;
            border-left: 4px solid var(--color-accent-light);
        }

        .exercise-box h4 {
            color: var(--color-accent-light);
            margin-top: 0;
        }

        details {
            margin: calc(var(--spacing-unit) * 2) 0;
            padding: calc(var(--spacing-unit) * 2);
            background: white;
            border-radius: 8px;
            border: 1px solid var(--color-border);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-accent-light);
            padding: calc(var(--spacing-unit) * 1);
        }

        summary:hover {
            color: var(--color-accent);
        }

        .learning-objectives {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 4) 0;
        }

        .learning-objectives ul {
            list-style: none;
            padding-left: 0;
        }

        .learning-objectives li::before {
            content: "âœ“ ";
            color: var(--color-accent-light);
            font-weight: bold;
            margin-right: calc(var(--spacing-unit) * 1);
        }

        .references {
            background: var(--color-code-bg);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin-top: calc(var(--spacing-unit) * 6);
        }

        .references h2 {
            border-left: none;
            padding-left: 0;
        }

        .references ol {
            padding-left: calc(var(--spacing-unit) * 4);
        }

        .references li {
            margin: calc(var(--spacing-unit) * 2) 0;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            body {
                padding: calc(var(--spacing-unit) * 2);
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            pre {
                padding: calc(var(--spacing-unit) * 2);
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
            <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MS/spectroscopy-introduction/chapter-4.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/spectroscopy-introduction/index.html">Spectroscopy</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 4</span>
        </div>
    </nav>
<h1>ç¬¬4ç« : Xç·šå…‰é›»å­åˆ†å…‰æ³• (XPS: X-ray Photoelectron Spectroscopy)</h1>

    <div class="intro-box">
        <p><strong>ã“ã®ç« ã§å­¦ã¶ã“ã¨:</strong> Xç·šå…‰é›»å­åˆ†å…‰æ³•ï¼ˆXPSï¼‰ã¯ã€ææ–™è¡¨é¢ã®åŒ–å­¦çµ„æˆã¨é›»å­çŠ¶æ…‹ã‚’é«˜æ„Ÿåº¦ã§åˆ†æã™ã‚‹è¡¨é¢åˆ†ææ‰‹æ³•ã§ã™ã€‚å…‰é›»åŠ¹æœã®åŸç†ã«åŸºã¥ãã€è©¦æ–™è¡¨é¢ã‹ã‚‰æ”¾å‡ºã•ã‚Œã‚‹å…‰é›»å­ã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ¸¬å®šã™ã‚‹ã“ã¨ã§ã€å…ƒç´ åŒå®šã€åŒ–å­¦ã‚·ãƒ•ãƒˆè§£æã€å®šé‡åˆ†æã€æ·±ã•æ–¹å‘åˆ†æã‚’å®Ÿç¾ã—ã¾ã™ã€‚æœ¬ç« ã§ã¯ã€XPSã®ç‰©ç†çš„åŸç†ã‹ã‚‰å®Ÿè·µçš„ãªãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°æ³•ã€å®šé‡åˆ†æã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€æ·±ã•ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ã¾ã§ã€XPSãƒ‡ãƒ¼ã‚¿è§£æã®åŸºç¤ã‹ã‚‰å¿œç”¨ã¾ã§ã‚’ä½“ç³»çš„ã«å­¦ã³ã¾ã™ã€‚</p>
    </div>

    <h2>4.1 Xç·šå…‰é›»å­åˆ†å…‰æ³•ã®åŸç†</h2>

    <h3>4.1.1 å…‰é›»åŠ¹æœã¨ã‚¢ã‚¤ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³ã®å¼</h3>

    <p>XPSã¯ã€Albert Einsteinï¼ˆ1905ï¼‰ã«ã‚ˆã‚Šç†è«–åŒ–ã•ã‚ŒãŸå…‰é›»åŠ¹æœã«åŸºã¥ãã¾ã™ã€‚è©¦æ–™ã«Xç·šã‚’ç…§å°„ã™ã‚‹ã¨ã€Xç·šã®å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒé›»å­ã«å¸åã•ã‚Œã€é›»å­ãŒè©¦æ–™è¡¨é¢ã‹ã‚‰æ”¾å‡ºã•ã‚Œã¾ã™ï¼ˆå…‰é›»å­ï¼‰ã€‚</p>

    <div class="equation-box">
        <p><strong>å…‰é›»å­ã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆã‚¢ã‚¤ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³ã®å¼ï¼‰:</strong></p>
        \[
        E_{\text{kinetic}} = h\nu - E_{\text{binding}} - \phi
        \]
        <p>ã“ã“ã§ã€\( h\nu \) ã¯å…¥å°„Xç·šã®å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€\( E_{\text{binding}} \) ã¯é›»å­ã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆæŸç¸›ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰ã€\( \phi \) ã¯è£…ç½®ã®ä»•äº‹é–¢æ•°ã§ã™ã€‚</p>

        <p><strong>çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã®æ±ºå®š:</strong></p>
        \[
        E_{\text{binding}} = h\nu - E_{\text{kinetic}} - \phi
        \]
        <p>XPSã§ã¯ã€é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ \( E_{\text{kinetic}} \) ã‚’æ¸¬å®šã™ã‚‹ã“ã¨ã§ã€çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ \( E_{\text{binding}} \) ã‚’æ±ºå®šã—ã¾ã™ã€‚çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯å…ƒç´ ã¨åŒ–å­¦çŠ¶æ…‹ã«å›ºæœ‰ã®å€¤ã‚’æŒã¡ã€å…ƒç´ åŒå®šã¨åŒ–å­¦çŠ¶æ…‹è§£æã‚’å¯èƒ½ã«ã—ã¾ã™ã€‚</p>
    </div>

    <h3>4.1.2 XPSæ¸¬å®šã®ç‰¹å¾´</h3>

    <div class="key-concept">
        <h4>XPSã®ä¸»è¦ãªç‰¹å¾´</h4>
        <ul>
            <li><strong>è¡¨é¢æ„Ÿåº¦:</strong> å…‰é›»å­ã®éå¼¾æ€§å¹³å‡è‡ªç”±è¡Œç¨‹ï¼ˆIMFPï¼‰ã¯æ•° nm ã§ã‚ã‚Šã€è©¦æ–™è¡¨é¢ã‹ã‚‰ç´„ 5-10 nm ã®æƒ…å ±ã‚’å–å¾—</li>
            <li><strong>å…ƒç´ åŒå®š:</strong> Li ã‚’é™¤ãå…¨ã¦ã®å…ƒç´ ã‚’æ¤œå‡ºå¯èƒ½ï¼ˆæ¤œå‡ºé™ç•Œ: 0.1-1 at%ï¼‰</li>
            <li><strong>åŒ–å­¦çŠ¶æ…‹è§£æ:</strong> åŒ–å­¦ã‚·ãƒ•ãƒˆï¼ˆ0.1-10 eVï¼‰ã«ã‚ˆã‚Šã€é…¸åŒ–çŠ¶æ…‹ã€é…ä½ç’°å¢ƒã‚’è­˜åˆ¥</li>
            <li><strong>å®šé‡åˆ†æ:</strong> ãƒ”ãƒ¼ã‚¯é¢ç©ã‹ã‚‰å…ƒç´ çµ„æˆæ¯”ã‚’æ±ºå®šï¼ˆç›¸å¯¾èª¤å·®: Â±10%ï¼‰</li>
            <li><strong>éç ´å£Šåˆ†æ:</strong> é€šå¸¸æ¸¬å®šã§ã¯è©¦æ–™æå‚·ãŒã»ã¨ã‚“ã©ãªã„</li>
            <li><strong>è¶…é«˜çœŸç©ºç’°å¢ƒ:</strong> æ¸¬å®šã¯ 10<sup>-7</sup> - 10<sup>-9</sup> Pa ã®è¶…é«˜çœŸç©ºä¸‹ã§å®Ÿæ–½</li>
        </ul>
    </div>

    <h3>4.1.3 Xç·šæºã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†è§£èƒ½</h3>

    <p>XPSã§ä½¿ç”¨ã•ã‚Œã‚‹ä»£è¡¨çš„ãªXç·šæºã¯ã€Al KÎ±ç·šï¼ˆ1486.6 eVï¼‰ã¨Mg KÎ±ç·šï¼ˆ1253.6 eVï¼‰ã§ã™ã€‚å˜è‰²åŒ–Xç·šæºã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†è§£èƒ½ã‚’å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>

    <table>
        <thead>
            <tr>
                <th>Xç·šæº</th>
                <th>å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)</th>
                <th>ç·šå¹… (eV)</th>
                <th>ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†è§£èƒ½</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Mg KÎ±ï¼ˆéå˜è‰²åŒ–ï¼‰</td>
                <td>1253.6</td>
                <td>0.7</td>
                <td>æ¨™æº–</td>
            </tr>
            <tr>
                <td>Al KÎ±ï¼ˆéå˜è‰²åŒ–ï¼‰</td>
                <td>1486.6</td>
                <td>0.85</td>
                <td>æ¨™æº–</td>
            </tr>
            <tr>
                <td>Al KÎ±ï¼ˆå˜è‰²åŒ–ï¼‰</td>
                <td>1486.6</td>
                <td>0.2-0.3</td>
                <td>é«˜åˆ†è§£èƒ½</td>
            </tr>
        </tbody>
    </table>

    <div class="mermaid">
    flowchart LR
        A[Xç·šç…§å°„<br/>hÎ½ = 1486.6 eV] --> B[è©¦æ–™è¡¨é¢<br/>åŸå­è»Œé“]
        B --> C[å…‰é›»å­æ”¾å‡º<br/>E_kineticæ¸¬å®š]
        C --> D[ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æå™¨<br/>åŠçƒå‹åˆ†æå™¨]
        D --> E[æ¤œå‡ºå™¨<br/>é›»å­ã‚«ã‚¦ãƒ³ãƒˆ]
        E --> F[XPSã‚¹ãƒšã‚¯ãƒˆãƒ«<br/>E_binding vs. Intensity]

        style A fill:#e3f2fd
        style B fill:#fff3e0
        style C fill:#fce4ec
        style D fill:#e8f5e9
        style E fill:#f3e5f5
        style F fill:#ffe0b2
    </mermaid>

    <h2>4.2 åŒ–å­¦ã‚·ãƒ•ãƒˆã¨ãƒ”ãƒ¼ã‚¯åŒå®š</h2>

    <h3>4.2.1 åŒ–å­¦ã‚·ãƒ•ãƒˆã®èµ·æº</h3>

    <p>åŸå­ã®åŒ–å­¦çŠ¶æ…‹ï¼ˆé…¸åŒ–çŠ¶æ…‹ã€é…ä½ç’°å¢ƒï¼‰ãŒå¤‰åŒ–ã™ã‚‹ã¨ã€å†…æ®»é›»å­ã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒã‚·ãƒ•ãƒˆã—ã¾ã™ã€‚ã“ã‚Œã‚’åŒ–å­¦ã‚·ãƒ•ãƒˆï¼ˆchemical shiftï¼‰ã¨å‘¼ã³ã¾ã™ã€‚</p>

    <div class="key-concept">
        <h4>åŒ–å­¦ã‚·ãƒ•ãƒˆã®åŸç†</h4>
        <p><strong>é«˜é…¸åŒ–çŠ¶æ…‹ â†’ çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼å¢—åŠ ï¼ˆé«˜ã‚¨ãƒãƒ«ã‚®ãƒ¼å´ã¸ã‚·ãƒ•ãƒˆï¼‰</strong></p>
        <ul>
            <li>é›»å­ãŒå¼•ãæŠœã‹ã‚Œã‚‹ã“ã¨ã§ã€åŸå­æ ¸ã®æœ‰åŠ¹æ ¸é›»è·ãŒå¢—åŠ </li>
            <li>å†…æ®»é›»å­ãŒã‚ˆã‚Šå¼·ãæŸç¸›ã•ã‚Œã‚‹</li>
            <li>ä¾‹: C 1s ãƒ”ãƒ¼ã‚¯: C-C (284.5 eV) < C-O (286.5 eV) < C=O (288.0 eV) < O-C=O (289.5 eV)</li>
        </ul>

        <p><strong>é›»å­å¯†åº¦å¢—åŠ  â†’ çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼æ¸›å°‘ï¼ˆä½ã‚¨ãƒãƒ«ã‚®ãƒ¼å´ã¸ã‚·ãƒ•ãƒˆï¼‰</strong></p>
        <ul>
            <li>å‘¨å›²ã®é›»å­ä¾›ä¸åŸºã«ã‚ˆã‚Šã€åŸå­ã®é›»å­å¯†åº¦ãŒå¢—åŠ </li>
            <li>å†…æ®»é›»å­ã®é®è”½åŠ¹æœãŒå¼·ã¾ã‚‹</li>
            <li>ä¾‹: Si 2p ãƒ”ãƒ¼ã‚¯: SiO<sub>2</sub> (103.5 eV) > Si (99.3 eV)</li>
        </ul>
    </div>

    <h3>4.2.2 ä»£è¡¨çš„ãªå…ƒç´ ã®XPSãƒ”ãƒ¼ã‚¯</h3>

    <table>
        <thead>
            <tr>
                <th>å…ƒç´ </th>
                <th>ãƒ”ãƒ¼ã‚¯</th>
                <th>çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)</th>
                <th>åŒ–å­¦çŠ¶æ…‹</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td rowspan="4">C</td>
                <td>1s</td>
                <td>284.5</td>
                <td>C-C, C-Hï¼ˆç‚­åŒ–æ°´ç´ ï¼‰</td>
            </tr>
            <tr>
                <td>1s</td>
                <td>286.5</td>
                <td>C-Oï¼ˆã‚¨ãƒ¼ãƒ†ãƒ«ã€ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ï¼‰</td>
            </tr>
            <tr>
                <td>1s</td>
                <td>288.0</td>
                <td>C=Oï¼ˆã‚«ãƒ«ãƒœãƒ‹ãƒ«ï¼‰</td>
            </tr>
            <tr>
                <td>1s</td>
                <td>289.5</td>
                <td>O-C=Oï¼ˆã‚«ãƒ«ãƒœã‚­ã‚·ãƒ«ï¼‰</td>
            </tr>
            <tr>
                <td rowspan="2">Si</td>
                <td>2p<sub>3/2</sub></td>
                <td>99.3</td>
                <td>Si<sup>0</sup>ï¼ˆé‡‘å±ã‚·ãƒªã‚³ãƒ³ï¼‰</td>
            </tr>
            <tr>
                <td>2p<sub>3/2</sub></td>
                <td>103.5</td>
                <td>Si<sup>4+</sup>ï¼ˆSiO<sub>2</sub>ï¼‰</td>
            </tr>
            <tr>
                <td rowspan="3">Fe</td>
                <td>2p<sub>3/2</sub></td>
                <td>707.0</td>
                <td>Fe<sup>0</sup>ï¼ˆé‡‘å±é‰„ï¼‰</td>
            </tr>
            <tr>
                <td>2p<sub>3/2</sub></td>
                <td>710.8</td>
                <td>Fe<sup>3+</sup>ï¼ˆFe<sub>2</sub>O<sub>3</sub>ï¼‰</td>
            </tr>
            <tr>
                <td>2p<sub>3/2</sub></td>
                <td>709.5</td>
                <td>Fe<sup>2+</sup>ï¼ˆFeOï¼‰</td>
            </tr>
            <tr>
                <td rowspan="2">O</td>
                <td>1s</td>
                <td>530.0</td>
                <td>é‡‘å±é…¸åŒ–ç‰©ï¼ˆM-Oï¼‰</td>
            </tr>
            <tr>
                <td>1s</td>
                <td>532.5</td>
                <td>æœ‰æ©ŸåŒ–åˆç‰©ï¼ˆC-O, C=Oï¼‰</td>
            </tr>
        </tbody>
    </table>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒ”ãƒ¼ã‚¯åŒå®š</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def gaussian_peak(x, amplitude, center, width):
    """
    ã‚¬ã‚¦ã‚¹å‹ãƒ”ãƒ¼ã‚¯ã‚’ç”Ÿæˆ

    Parameters:
    -----------
    x : array
        çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)
    amplitude : float
        ãƒ”ãƒ¼ã‚¯é«˜ã•
    center : float
        ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒ (eV)
    width : float
        åŠå€¤å…¨å¹…ï¼ˆFWHM, eVï¼‰

    Returns:
    --------
    peak : array
        ã‚¬ã‚¦ã‚¹å‹ãƒ”ãƒ¼ã‚¯ã®å¼·åº¦
    """
    sigma = width / (2 * np.sqrt(2 * np.log(2)))
    peak = amplitude * np.exp(-((x - center)**2) / (2 * sigma**2))
    return peak

def simulate_xps_c1s_spectrum():
    """
    C 1s XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼ˆè¤‡æ•°ã®åŒ–å­¦çŠ¶æ…‹ï¼‰
    """
    # çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ç¯„å›²
    BE = np.linspace(280, 295, 1500)

    # C 1s ãƒ”ãƒ¼ã‚¯ï¼ˆ4ã¤ã®åŒ–å­¦çŠ¶æ…‹ï¼‰
    C_CC = gaussian_peak(BE, amplitude=1000, center=284.5, width=1.2)   # C-C, C-H
    C_CO = gaussian_peak(BE, amplitude=300, center=286.5, width=1.3)    # C-O
    C_O = gaussian_peak(BE, amplitude=150, center=288.0, width=1.4)     # C=O
    COO = gaussian_peak(BE, amplitude=80, center=289.5, width=1.5)      # O-C=O

    # ç·ã‚¹ãƒšã‚¯ãƒˆãƒ«
    total_spectrum = C_CC + C_CO + C_O + COO

    # ãƒã‚¤ã‚º
    noise = np.random.normal(0, 10, len(BE))
    observed_spectrum = total_spectrum + noise

    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # ã‚¹ãƒšã‚¯ãƒˆãƒ«å…¨ä½“
    ax1.plot(BE, observed_spectrum, 'k-', linewidth=1.5, label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«')
    ax1.fill_between(BE, C_CC, alpha=0.3, color='blue', label='C-C, C-H (284.5 eV)')
    ax1.fill_between(BE, C_CO, alpha=0.3, color='green', label='C-O (286.5 eV)')
    ax1.fill_between(BE, C_O, alpha=0.3, color='orange', label='C=O (288.0 eV)')
    ax1.fill_between(BE, COO, alpha=0.3, color='red', label='O-C=O (289.5 eV)')
    ax1.set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
    ax1.set_ylabel('å¼·åº¦ (cps)', fontsize=12)
    ax1.set_title('C 1s XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆå¤šæˆåˆ†ï¼‰', fontsize=14, fontweight='bold')
    ax1.legend(loc='upper right', fontsize=9)
    ax1.grid(alpha=0.3)
    ax1.invert_xaxis()  # XPSã®æ…£ä¾‹ï¼ˆé«˜ã‚¨ãƒãƒ«ã‚®ãƒ¼ â†’ ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰

    # å„æˆåˆ†ã®åˆ†é›¢
    ax2.plot(BE, C_CC, 'b-', linewidth=2, label='C-C, C-H')
    ax2.plot(BE, C_CO, 'g-', linewidth=2, label='C-O')
    ax2.plot(BE, C_O, 'orange', linewidth=2, label='C=O')
    ax2.plot(BE, COO, 'r-', linewidth=2, label='O-C=O')
    ax2.axvline(284.5, color='blue', linestyle='--', alpha=0.5)
    ax2.axvline(286.5, color='green', linestyle='--', alpha=0.5)
    ax2.axvline(288.0, color='orange', linestyle='--', alpha=0.5)
    ax2.axvline(289.5, color='red', linestyle='--', alpha=0.5)
    ax2.set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
    ax2.set_ylabel('å¼·åº¦ (cps)', fontsize=12)
    ax2.set_title('å„åŒ–å­¦çŠ¶æ…‹ã®åˆ†é›¢', fontsize=14, fontweight='bold')
    ax2.legend()
    ax2.grid(alpha=0.3)
    ax2.invert_xaxis()

    plt.tight_layout()
    plt.show()

    print("C 1s ãƒ”ãƒ¼ã‚¯åŒå®š:")
    print("  284.5 eV: C-C, C-Hï¼ˆç‚­åŒ–æ°´ç´ éª¨æ ¼ï¼‰")
    print("  286.5 eV: C-Oï¼ˆã‚¨ãƒ¼ãƒ†ãƒ«ã€ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ï¼‰")
    print("  288.0 eV: C=Oï¼ˆã‚«ãƒ«ãƒœãƒ‹ãƒ«åŸºï¼‰")
    print("  289.5 eV: O-C=Oï¼ˆã‚«ãƒ«ãƒœã‚­ã‚·ãƒ«åŸºï¼‰")

# å®Ÿè¡Œ
simulate_xps_c1s_spectrum()
</code></pre>

    <h2>4.3 ãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã¨ãƒ‡ã‚³ãƒ³ãƒœãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³</h2>

    <h3>4.3.1 ãƒ”ãƒ¼ã‚¯å½¢çŠ¶ã®é¸æŠ</h3>

    <p>XPSãƒ”ãƒ¼ã‚¯ã¯ã€ã‚¬ã‚¦ã‚¹å‹ã¨ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„å‹ã®æ··åˆã§ã‚ã‚‹Voigté–¢æ•°ï¼ˆã¾ãŸã¯ãã®è¿‘ä¼¼ã§ã‚ã‚‹Gaussian-Lorentziané–¢æ•°ï¼‰ã§è¡¨ã•ã‚Œã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>Gaussian-Lorentzian (GL) æ··åˆé–¢æ•°:</strong></p>
        \[
        f(x) = m \cdot G(x) + (1-m) \cdot L(x)
        \]
        <p>ã“ã“ã§ã€\( G(x) \) ã¯ã‚¬ã‚¦ã‚¹é–¢æ•°ã€\( L(x) \) ã¯ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„é–¢æ•°ã€\( m \)ï¼ˆ0 â‰¤ m â‰¤ 1ï¼‰ã¯æ··åˆæ¯”ã§ã™ã€‚</p>

        <p><strong>ã‚¬ã‚¦ã‚¹é–¢æ•°:</strong></p>
        \[
        G(x) = A \exp\left(-\frac{(x - x_0)^2}{2\sigma^2}\right)
        \]

        <p><strong>ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„é–¢æ•°:</strong></p>
        \[
        L(x) = A \frac{\gamma^2}{(x - x_0)^2 + \gamma^2}
        \]
    </div>

    <h3>4.3.2 Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰</h3>

    <p>XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã«ã¯ã€éå¼¾æ€§æ•£ä¹±ã•ã‚ŒãŸé›»å­ã«ã‚ˆã‚‹ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãŒé‡ç•³ã—ã¾ã™ã€‚David A. Shirleyï¼ˆ1972ï¼‰ãŒææ¡ˆã—ãŸShirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ãŒåºƒãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</p>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ¸›ç®—ã¨ãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def shirley_background(x, y, tol=1e-5, max_iter=50):
    """
    Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚’è¨ˆç®—

    Parameters:
    -----------
    x : array
        çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)
    y : array
        è¦³æ¸¬å¼·åº¦
    tol : float
        åæŸåˆ¤å®šåŸºæº–
    max_iter : int
        æœ€å¤§åå¾©å›æ•°

    Returns:
    --------
    background : array
        Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰
    """
    # ãƒ‡ãƒ¼ã‚¿ã®æ˜‡é †ã‚½ãƒ¼ãƒˆï¼ˆBE: é«˜ â†’ ä½ï¼‰
    if x[0] < x[-1]:
        x = x[::-1]
        y = y[::-1]

    # åˆæœŸåŒ–
    background = np.zeros_like(y)
    y_max = np.max(y)
    y_min = np.min(y)

    # åå¾©è¨ˆç®—
    for iteration in range(max_iter):
        # å„ç‚¹ã§ã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰è¨ˆç®—
        for i in range(1, len(x)):
            integral = np.trapz(y[:i] - background[:i], x[:i])
            background[i] = y_min + (y_max - y_min) * integral / np.trapz(y - background, x)

        # åæŸåˆ¤å®š
        if iteration > 0:
            change = np.max(np.abs(background - background_old))
            if change < tol:
                break
        background_old = background.copy()

    return background

def voigt_approximation(x, amplitude, center, sigma, gamma):
    """
    Voigté–¢æ•°ã®è¿‘ä¼¼ï¼ˆGaussian-Lorentzianæ··åˆï¼‰

    Parameters:
    -----------
    x : array
        çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼
    amplitude : float
        ãƒ”ãƒ¼ã‚¯é«˜ã•
    center : float
        ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒ
    sigma : float
        ã‚¬ã‚¦ã‚¹æˆåˆ†ã®å¹…
    gamma : float
        ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„æˆåˆ†ã®å¹…

    Returns:
    --------
    voigt : array
        Voigté–¢æ•°ã®å€¤
    """
    gaussian = np.exp(-((x - center)**2) / (2 * sigma**2))
    lorentzian = gamma**2 / ((x - center)**2 + gamma**2)
    voigt = amplitude * (0.7 * gaussian + 0.3 * lorentzian)
    return voigt

def multi_peak_fit(x, y, initial_params):
    """
    è¤‡æ•°ãƒ”ãƒ¼ã‚¯ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°

    Parameters:
    -----------
    x : array
        çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼
    y : array
        å¼·åº¦
    initial_params : list of tuples
        å„ãƒ”ãƒ¼ã‚¯ã®åˆæœŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ [(A1, c1, s1, g1), (A2, c2, s2, g2), ...]

    Returns:
    --------
    fitted_params : array
        ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã•ã‚ŒãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    fitted_peaks : list
        å„ãƒ”ãƒ¼ã‚¯ã®æ›²ç·š
    """
    def multi_voigt(x, *params):
        """è¤‡æ•°ã®Voigtãƒ”ãƒ¼ã‚¯ã®åˆè¨ˆ"""
        n_peaks = len(params) // 4
        result = np.zeros_like(x)
        for i in range(n_peaks):
            A, c, s, g = params[i*4:(i+1)*4]
            result += voigt_approximation(x, A, c, s, g)
        return result

    # åˆæœŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒ•ãƒ©ãƒƒãƒˆåŒ–
    p0 = [p for peak in initial_params for p in peak]

    # ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
    popt, pcov = curve_fit(multi_voigt, x, y, p0=p0, maxfev=10000)

    # å„ãƒ”ãƒ¼ã‚¯ã‚’å†æ§‹æˆ
    n_peaks = len(popt) // 4
    fitted_peaks = []
    for i in range(n_peaks):
        A, c, s, g = popt[i*4:(i+1)*4]
        peak = voigt_approximation(x, A, c, s, g)
        fitted_peaks.append((peak, A, c, s, g))

    return popt, fitted_peaks

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼ˆSi 2p: Si + SiO2ï¼‰
BE = np.linspace(96, 108, 1200)

# çœŸã®ãƒ”ãƒ¼ã‚¯
Si_metal = voigt_approximation(BE, amplitude=800, center=99.3, sigma=0.4, gamma=0.2)
SiO2 = voigt_approximation(BE, amplitude=500, center=103.5, sigma=0.5, gamma=0.25)
true_spectrum = Si_metal + SiO2

# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ï¼ˆæŒ‡æ•°æ¸›è¡°å‹ï¼‰
background_true = 100 * np.exp(-(BE - 96) / 10)

# è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«
noise = np.random.normal(0, 15, len(BE))
observed = true_spectrum + background_true + noise

# Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ¸›ç®—
shirley_bg = shirley_background(BE, observed)
corrected = observed - shirley_bg

# ãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
initial_params = [
    (800, 99.3, 0.4, 0.2),   # Si metal
    (500, 103.5, 0.5, 0.25)  # SiO2
]
fitted_params, fitted_peaks = multi_peak_fit(BE, corrected, initial_params)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
axes[0, 0].plot(BE, observed, 'k-', label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«', linewidth=1.5)
axes[0, 0].plot(BE, shirley_bg, 'r--', label='Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰', linewidth=2)
axes[0, 0].set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
axes[0, 0].set_ylabel('å¼·åº¦ (cps)')
axes[0, 0].set_title('Si 2p ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆç”Ÿãƒ‡ãƒ¼ã‚¿ï¼‰')
axes[0, 0].legend()
axes[0, 0].grid(alpha=0.3)
axes[0, 0].invert_xaxis()

# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ¸›ç®—å¾Œ
axes[0, 1].plot(BE, corrected, 'o', markersize=3, alpha=0.5, label='BGæ¸›ç®—å¾Œ')
fitted_total = sum([peak[0] for peak in fitted_peaks])
axes[0, 1].plot(BE, fitted_total, 'r-', linewidth=2, label='ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°åˆè¨ˆ')
axes[0, 1].set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
axes[0, 1].set_ylabel('å¼·åº¦ (cps)')
axes[0, 1].set_title('Shirley BGæ¸›ç®—å¾Œã¨ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°')
axes[0, 1].legend()
axes[0, 1].grid(alpha=0.3)
axes[0, 1].invert_xaxis()

# å„æˆåˆ†ã®åˆ†é›¢
axes[1, 0].plot(BE, corrected, 'k-', alpha=0.3, label='è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿')
colors = ['blue', 'green']
labels = ['Si metal (99.3 eV)', 'SiOâ‚‚ (103.5 eV)']
for i, (peak, A, c, s, g) in enumerate(fitted_peaks):
    axes[1, 0].fill_between(BE, peak, alpha=0.5, color=colors[i], label=labels[i])
    axes[1, 0].axvline(c, color=colors[i], linestyle='--', linewidth=1.5)
axes[1, 0].set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
axes[1, 0].set_ylabel('å¼·åº¦ (cps)')
axes[1, 0].set_title('ãƒ”ãƒ¼ã‚¯åˆ†é›¢ï¼ˆãƒ‡ã‚³ãƒ³ãƒœãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰')
axes[1, 0].legend()
axes[1, 0].grid(alpha=0.3)
axes[1, 0].invert_xaxis()

# æ®‹å·®
residual = corrected - fitted_total
axes[1, 1].plot(BE, residual, 'purple', linewidth=1)
axes[1, 1].axhline(0, color='black', linestyle='--', linewidth=1)
axes[1, 1].fill_between(BE, residual, alpha=0.3, color='purple')
axes[1, 1].set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
axes[1, 1].set_ylabel('æ®‹å·® (cps)')
axes[1, 1].set_title('ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°æ®‹å·®')
axes[1, 1].grid(alpha=0.3)
axes[1, 1].invert_xaxis()

plt.tight_layout()
plt.show()

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã®å‡ºåŠ›
print("ãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ:")
for i, (peak, A, c, s, g) in enumerate(fitted_peaks):
    area = np.trapz(peak, BE)
    print(f"  ãƒ”ãƒ¼ã‚¯ {i+1}: ä¸­å¿ƒ = {c:.2f} eV, é¢ç© = {area:.1f}")
</code></pre>

    <h2>4.4 å®šé‡åˆ†æã¨æ„Ÿåº¦ä¿‚æ•°</h2>

    <h3>4.4.1 XPSå®šé‡åˆ†æã®åŸç†</h3>

    <p>XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ãƒ”ãƒ¼ã‚¯é¢ç©ã‹ã‚‰ã€è¡¨é¢çµ„æˆã®åŸå­æ¿ƒåº¦ã‚’æ±ºå®šã§ãã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>åŸå­æ¿ƒåº¦ã®è¨ˆç®—å¼:</strong></p>
        \[
        C_i = \frac{I_i / S_i}{\sum_j (I_j / S_j)}
        \]
        <p>ã“ã“ã§ã€\( C_i \) ã¯å…ƒç´  \(i\) ã®åŸå­æ¿ƒåº¦ï¼ˆat%ï¼‰ã€\( I_i \) ã¯ãƒ”ãƒ¼ã‚¯é¢ç©ã€\( S_i \) ã¯ç›¸å¯¾æ„Ÿåº¦ä¿‚æ•°ï¼ˆRelative Sensitivity Factor, RSFï¼‰ã§ã™ã€‚</p>

        <p><strong>æ„Ÿåº¦ä¿‚æ•°ã®ç‰©ç†çš„æ„å‘³:</strong></p>
        <ul>
            <li>\( S_i = \sigma_i \cdot \lambda_i \cdot D(\theta) \cdot T(E) \)</li>
            <li>\( \sigma_i \): å…‰ã‚¤ã‚ªãƒ³åŒ–æ–­é¢ç©ï¼ˆå…ƒç´ ãƒ»è»Œé“ä¾å­˜ï¼‰</li>
            <li>\( \lambda_i \): éå¼¾æ€§å¹³å‡è‡ªç”±è¡Œç¨‹ï¼ˆIMFPï¼‰</li>
            <li>\( D(\theta) \): è§’åº¦ä¾å­˜å› å­</li>
            <li>\( T(E) \): è£…ç½®é€éé–¢æ•°</li>
        </ul>
    </div>

    <h3>4.4.2 Scofieldç›¸å¯¾æ„Ÿåº¦ä¿‚æ•°</h3>

    <p>J.H. Scofieldï¼ˆ1976ï¼‰ã«ã‚ˆã‚Šç†è«–è¨ˆç®—ã•ã‚ŒãŸå…‰ã‚¤ã‚ªãƒ³åŒ–æ–­é¢ç©ã«åŸºã¥ãæ„Ÿåº¦ä¿‚æ•°ãŒåºƒãä½¿ç”¨ã•ã‚Œã¾ã™ã€‚</p>

    <table>
        <thead>
            <tr>
                <th>å…ƒç´ </th>
                <th>è»Œé“</th>
                <th>Scofield RSF<br/>ï¼ˆAl KÎ±ï¼‰</th>
                <th>çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>C</td><td>1s</td><td>0.25</td><td>284.5</td></tr>
            <tr><td>O</td><td>1s</td><td>0.66</td><td>532.0</td></tr>
            <tr><td>Si</td><td>2p</td><td>0.27</td><td>99.3</td></tr>
            <tr><td>N</td><td>1s</td><td>0.42</td><td>399.5</td></tr>
            <tr><td>F</td><td>1s</td><td>1.00</td><td>686.0</td></tr>
            <tr><td>Al</td><td>2p</td><td>0.19</td><td>74.0</td></tr>
            <tr><td>Fe</td><td>2p<sub>3/2</sub></td><td>2.85</td><td>707.0</td></tr>
            <tr><td>Cu</td><td>2p<sub>3/2</sub></td><td>5.32</td><td>932.5</td></tr>
        </tbody>
    </table>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: XPSå®šé‡åˆ†æã¨çµ„æˆæ±ºå®š</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def xps_quantification(peak_areas, sensitivity_factors):
    """
    XPSå®šé‡åˆ†æã«ã‚ˆã‚ŠåŸå­æ¿ƒåº¦ã‚’è¨ˆç®—

    Parameters:
    -----------
    peak_areas : dict
        å„å…ƒç´ ã®ãƒ”ãƒ¼ã‚¯é¢ç© {'C': area_C, 'O': area_O, ...}
    sensitivity_factors : dict
        å„å…ƒç´ ã®ç›¸å¯¾æ„Ÿåº¦ä¿‚æ•° {'C': RSF_C, 'O': RSF_O, ...}

    Returns:
    --------
    atomic_concentrations : dict
        å„å…ƒç´ ã®åŸå­æ¿ƒåº¦ï¼ˆat%ï¼‰
    """
    # è¦æ ¼åŒ–å¼·åº¦ã®è¨ˆç®—
    normalized_intensities = {}
    for element, area in peak_areas.items():
        RSF = sensitivity_factors[element]
        normalized_intensities[element] = area / RSF

    # åˆè¨ˆ
    total = sum(normalized_intensities.values())

    # åŸå­æ¿ƒåº¦ï¼ˆat%ï¼‰
    atomic_concentrations = {}
    for element, norm_int in normalized_intensities.items():
        atomic_concentrations[element] = (norm_int / total) * 100

    return atomic_concentrations

def plot_composition(atomic_concentrations):
    """
    çµ„æˆã‚’å††ã‚°ãƒ©ãƒ•ã¨æ£’ã‚°ãƒ©ãƒ•ã§å¯è¦–åŒ–
    """
    elements = list(atomic_concentrations.keys())
    concentrations = list(atomic_concentrations.values())

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # å††ã‚°ãƒ©ãƒ•
    colors = plt.cm.Set3(np.linspace(0, 1, len(elements)))
    wedges, texts, autotexts = ax1.pie(concentrations, labels=elements, autopct='%1.1f%%',
                                         colors=colors, startangle=90, textprops={'fontsize': 12})
    for autotext in autotexts:
        autotext.set_color('white')
        autotext.set_fontweight('bold')
    ax1.set_title('è¡¨é¢çµ„æˆï¼ˆåŸå­æ¿ƒåº¦ï¼‰', fontsize=14, fontweight='bold')

    # æ£’ã‚°ãƒ©ãƒ•
    ax2.bar(elements, concentrations, color=colors, edgecolor='black', linewidth=1.5)
    ax2.set_xlabel('å…ƒç´ ', fontsize=12)
    ax2.set_ylabel('åŸå­æ¿ƒåº¦ (at%)', fontsize=12)
    ax2.set_title('è¡¨é¢çµ„æˆï¼ˆæ£’ã‚°ãƒ©ãƒ•ï¼‰', fontsize=14, fontweight='bold')
    ax2.grid(alpha=0.3, axis='y')

    # å„å…ƒç´ ã®æ¿ƒåº¦ã‚’æ£’ã®ä¸Šã«è¡¨ç¤º
    for i, (elem, conc) in enumerate(zip(elements, concentrations)):
        ax2.text(i, conc + 1, f'{conc:.1f}%', ha='center', va='bottom', fontsize=11, fontweight='bold')

    plt.tight_layout()
    plt.show()

# å®Ÿè¡Œä¾‹ï¼šSiO2è–„è†œã®åˆ†æ
print("=== XPSå®šé‡åˆ†æä¾‹ï¼šSiOâ‚‚è–„è†œ ===\n")

# æ¸¬å®šã•ã‚ŒãŸãƒ”ãƒ¼ã‚¯é¢ç©ï¼ˆä»»æ„å˜ä½ï¼‰
peak_areas = {
    'Si': 12000,  # Si 2p
    'O': 28000,   # O 1s
    'C': 3000     # C 1sï¼ˆç‚­ç´ æ±šæŸ“ï¼‰
}

# Scofieldç›¸å¯¾æ„Ÿåº¦ä¿‚æ•°ï¼ˆAl KÎ±ç·šï¼‰
sensitivity_factors = {
    'Si': 0.27,
    'O': 0.66,
    'C': 0.25
}

# å®šé‡åˆ†æ
atomic_conc = xps_quantification(peak_areas, sensitivity_factors)

print("ãƒ”ãƒ¼ã‚¯é¢ç©:")
for elem, area in peak_areas.items():
    print(f"  {elem}: {area}")

print("\nç›¸å¯¾æ„Ÿåº¦ä¿‚æ•°:")
for elem, RSF in sensitivity_factors.items():
    print(f"  {elem}: {RSF}")

print("\nåŸå­æ¿ƒåº¦:")
for elem, conc in atomic_conc.items():
    print(f"  {elem}: {conc:.2f} at%")

# ç†è«–çµ„æˆã¨ã®æ¯”è¼ƒï¼ˆSiO2 = Si:O = 1:2 = 33.3:66.7ï¼‰
Si_theory = 33.3
O_theory = 66.7
print(f"\nç†è«–çµ„æˆï¼ˆSiOâ‚‚ï¼‰: Si = 33.3 at%, O = 66.7 at%")
print(f"æ¸¬å®šçµ„æˆ: Si = {atomic_conc['Si']:.2f} at%, O = {atomic_conc['O']:.2f} at%")
print(f"ç‚­ç´ æ±šæŸ“: C = {atomic_conc['C']:.2f} at%")

# ãƒ—ãƒ­ãƒƒãƒˆ
plot_composition(atomic_conc)

# æ±šæŸ“è£œæ­£å¾Œã®çµ„æˆ
Si_corrected = atomic_conc['Si'] / (atomic_conc['Si'] + atomic_conc['O']) * 100
O_corrected = atomic_conc['O'] / (atomic_conc['Si'] + atomic_conc['O']) * 100
print(f"\nç‚­ç´ è£œæ­£å¾Œ: Si = {Si_corrected:.2f} at%, O = {O_corrected:.2f} at%")
</code></pre>

    <h2>4.5 æ·±ã•æ–¹å‘åˆ†æï¼ˆDepth Profilingï¼‰</h2>

    <h3>4.5.1 ã‚¤ã‚ªãƒ³ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°æ³•</h3>

    <p>Ar<sup>+</sup>ã‚¤ã‚ªãƒ³ãƒ“ãƒ¼ãƒ ã§è©¦æ–™è¡¨é¢ã‚’ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°ã—ãªãŒã‚‰XPSæ¸¬å®šã‚’ç¹°ã‚Šè¿”ã™ã“ã¨ã§ã€æ·±ã•æ–¹å‘ã®çµ„æˆãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–å¾—ã§ãã¾ã™ã€‚</p>

    <div class="key-concept">
        <h4>æ·±ã•æ–¹å‘åˆ†æã®æ‰‹é †</h4>
        <ol>
            <li>è©¦æ–™è¡¨é¢ã§XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’æ¸¬å®š</li>
            <li>Ar<sup>+</sup>ã‚¤ã‚ªãƒ³ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°ï¼ˆæ•°nmé™¤å»ï¼‰</li>
            <li>XPSæ¸¬å®šã‚’å†åº¦å®Ÿæ–½</li>
            <li>2-3ã‚’ç¹°ã‚Šè¿”ã—ã€æ·±ã•æ–¹å‘ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ§‹ç¯‰</li>
        </ol>

        <p><strong>ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°é€Ÿåº¦ã®æ ¡æ­£:</strong></p>
        <ul>
            <li>æ—¢çŸ¥è†œåšã®æ¨™æº–è©¦æ–™ï¼ˆSiO<sub>2</sub>/Siç­‰ï¼‰ã‚’ä½¿ç”¨</li>
            <li>ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°æ™‚é–“ã‹ã‚‰æ·±ã•ã«å¤‰æ›</li>
            <li>ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°é€Ÿåº¦: é€šå¸¸ 0.1-1 nm/min</li>
        </ul>
    </div>

    <h3>4.5.2 éç ´å£Šè§’åº¦åˆ†è§£XPS</h3>

    <p>æ¤œå‡ºè§’åº¦ã‚’å¤‰åŒ–ã•ã›ã‚‹ã“ã¨ã§ã€éç ´å£Šçš„ã«æ·±ã•æƒ…å ±ã‚’å–å¾—ã§ãã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>æ¤œå‡ºæ·±ã•ã®è§’åº¦ä¾å­˜æ€§:</strong></p>
        \[
        d = 3\lambda \sin\theta
        \]
        <p>ã“ã“ã§ã€\( d \) ã¯æƒ…å ±æ·±ã•ã€\( \lambda \) ã¯éå¼¾æ€§å¹³å‡è‡ªç”±è¡Œç¨‹ï¼ˆIMFPï¼‰ã€\( \theta \) ã¯æ¤œå‡ºè§’åº¦ï¼ˆè©¦æ–™è¡¨é¢ã‹ã‚‰ã®è§’åº¦ï¼‰ã§ã™ã€‚</p>

        <p><strong>è§’åº¦åˆ†è§£æ¸¬å®šã®åˆ©ç‚¹:</strong></p>
        <ul>
            <li>éç ´å£Š: è©¦æ–™ã¸ã®ãƒ€ãƒ¡ãƒ¼ã‚¸ãªã—</li>
            <li>è¿…é€Ÿ: ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°ä¸è¦</li>
            <li>è¡¨é¢æ•æ„Ÿ: æµ…ã„è§’åº¦ï¼ˆ\( \theta = 15Â° \)ï¼‰ã§è¡¨é¢ 1-2 nm ã®æƒ…å ±</li>
        </ul>
    </div>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: æ·±ã•æ–¹å‘ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨è§£æ</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import erf

def depth_profile_simulation(depth, interface_position, interface_width, concentration_top, concentration_bottom):
    """
    ç•Œé¢ã‚’æŒã¤æ·±ã•æ–¹å‘æ¿ƒåº¦ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ

    Parameters:
    -----------
    depth : array
        æ·±ã• (nm)
    interface_position : float
        ç•Œé¢ä½ç½® (nm)
    interface_width : float
        ç•Œé¢å¹…ï¼ˆæ‹¡æ•£å¹…, nmï¼‰
    concentration_top : float
        è¡¨é¢å±¤ã®æ¿ƒåº¦ (at%)
    concentration_bottom : float
        åŸºæ¿å±¤ã®æ¿ƒåº¦ (at%)

    Returns:
    --------
    concentration : array
        å„æ·±ã•ã«ãŠã‘ã‚‹æ¿ƒåº¦ (at%)
    """
    # erfé–¢æ•°ã§ç•Œé¢ã‚’è¡¨ç¾
    concentration = concentration_bottom + (concentration_top - concentration_bottom) * \
                    0.5 * (1 - erf((depth - interface_position) / interface_width))
    return concentration

def simulate_sputter_depth_profiling():
    """
    ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°æ·±ã•æ–¹å‘åˆ†æã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆï¼ˆSiO2/Siæ§‹é€ ï¼‰
    """
    # æ·±ã•ç¯„å›²
    depth = np.linspace(0, 50, 200)  # 0-50 nm

    # SiO2å±¤ï¼ˆ0-20 nmï¼‰ã¨SiåŸºæ¿ï¼ˆ20 nmä»¥é™ï¼‰
    Si_profile = depth_profile_simulation(depth, interface_position=20, interface_width=2,
                                          concentration_top=33, concentration_bottom=100)
    O_profile = depth_profile_simulation(depth, interface_position=20, interface_width=2,
                                         concentration_top=67, concentration_bottom=0)

    # ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°æ¸¬å®šç‚¹ï¼ˆé›¢æ•£çš„ï¼‰
    sputter_times = np.array([0, 5, 10, 15, 20, 25, 30, 40, 50])  # ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°æ™‚é–“ï¼ˆåˆ†ï¼‰
    sputter_rate = 1.0  # nm/min
    measured_depths = sputter_times * sputter_rate

    # æ¸¬å®šæ¿ƒåº¦ï¼ˆãƒã‚¤ã‚ºä»˜ãï¼‰
    Si_measured = np.interp(measured_depths, depth, Si_profile) + np.random.normal(0, 2, len(measured_depths))
    O_measured = np.interp(measured_depths, depth, O_profile) + np.random.normal(0, 2, len(measured_depths))

    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

    # ç†è«–ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«
    ax1.plot(depth, Si_profile, 'b-', linewidth=2, label='Siï¼ˆç†è«–ï¼‰')
    ax1.plot(depth, O_profile, 'r-', linewidth=2, label='Oï¼ˆç†è«–ï¼‰')
    ax1.scatter(measured_depths, Si_measured, s=100, color='blue', marker='o',
                edgecolor='black', linewidth=1.5, label='Siï¼ˆæ¸¬å®šï¼‰', zorder=5)
    ax1.scatter(measured_depths, O_measured, s=100, color='red', marker='s',
                edgecolor='black', linewidth=1.5, label='Oï¼ˆæ¸¬å®šï¼‰', zorder=5)
    ax1.axvline(20, color='green', linestyle='--', linewidth=2, label='ç•Œé¢ä½ç½® (20 nm)')
    ax1.set_xlabel('æ·±ã• (nm)', fontsize=12)
    ax1.set_ylabel('åŸå­æ¿ƒåº¦ (at%)', fontsize=12)
    ax1.set_title('æ·±ã•æ–¹å‘ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆSiOâ‚‚/Siï¼‰', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(alpha=0.3)
    ax1.set_xlim(0, 50)
    ax1.set_ylim(-5, 105)

    # å±¤æ§‹é€ ã®å¯è¦–åŒ–
    ax2.fill_between([0, 20], 0, 100, alpha=0.3, color='red', label='SiOâ‚‚å±¤ (20 nm)')
    ax2.fill_between([20, 50], 0, 100, alpha=0.3, color='blue', label='SiåŸºæ¿')
    ax2.text(10, 50, 'SiOâ‚‚', fontsize=16, fontweight='bold', ha='center')
    ax2.text(35, 50, 'Si', fontsize=16, fontweight='bold', ha='center')
    ax2.axvline(20, color='green', linestyle='--', linewidth=3, label='ç•Œé¢')
    ax2.set_xlabel('æ·±ã• (nm)', fontsize=12)
    ax2.set_ylabel('å±¤æ§‹é€ ', fontsize=12)
    ax2.set_title('è©¦æ–™æ§‹é€ ï¼ˆæ–­é¢å›³ï¼‰', fontsize=14, fontweight='bold')
    ax2.set_xlim(0, 50)
    ax2.set_yticks([])
    ax2.legend()
    ax2.grid(alpha=0.3, axis='x')

    plt.tight_layout()
    plt.show()

    # ç•Œé¢åšã•ã®æ¨å®š
    interface_region = (measured_depths >= 15) & (measured_depths <= 25)
    if np.sum(interface_region) > 0:
        interface_width_est = np.max(measured_depths[interface_region]) - np.min(measured_depths[interface_region])
        print(f"æ¨å®šç•Œé¢å¹…: {interface_width_est:.1f} nm")

# å®Ÿè¡Œ
simulate_sputter_depth_profiling()
</code></pre>

    <h2>4.6 Augeré›»å­ã¨ãƒ”ãƒ¼ã‚¯è­˜åˆ¥</h2>

    <h3>4.6.1 Augeréç¨‹ã®åŸç†</h3>

    <p>XPSæ¸¬å®šã§ã¯ã€å…‰é›»å­ãƒ”ãƒ¼ã‚¯ã«åŠ ãˆã¦ã€Augeré›»å­ãƒ”ãƒ¼ã‚¯ã‚‚è¦³æ¸¬ã•ã‚Œã¾ã™ã€‚Augeré›»å­ã¯ã€å†…æ®»ã«ç©ºå­”ãŒç”Ÿã˜ãŸå¾Œã®ç·©å’Œéç¨‹ã§æ”¾å‡ºã•ã‚Œã¾ã™ã€‚</p>

    <div class="mermaid">
    flowchart TD
        A[Xç·šç…§å°„] --> B[1sé›»å­ã®å…‰é›»æ”¾å‡º<br/>å†…æ®»ç©ºå­”ç”Ÿæˆ]
        B --> C{ç·©å’Œéç¨‹}
        C -->|éç¨‹1| D[2pé›»å­ãŒ1sè»Œé“ã¸é·ç§»<br/>Xç·šè›å…‰æ”¾å‡º]
        C -->|éç¨‹2| E[2p â†’ 1sé·ç§»<br/>ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’2pé›»å­ã¸]
        E --> F[Augeré›»å­æ”¾å‡º<br/>KLâ‚‚Lâ‚ƒé›»å­]

        style A fill:#e3f2fd
        style B fill:#fff3e0
        style C fill:#fce4ec
        style D fill:#e8f5e9
        style E fill:#ffe0b2
        style F fill:#f3e5f5
    </mermaid>

    <div class="equation-box">
        <p><strong>Augeré›»å­ã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼:</strong></p>
        \[
        E_{\text{Auger}} = E_1 - E_2 - E_3
        \]
        <p>ã“ã“ã§ã€\( E_1 \) ã¯åˆæœŸç©ºå­”ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€\( E_2 \) ã¯é·ç§»é›»å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€\( E_3 \) ã¯æ”¾å‡ºAugeré›»å­ã®è»Œé“ã‚¨ãƒãƒ«ã‚®ãƒ¼ã§ã™ã€‚</p>

        <p><strong>Augeré›»å­ã®ç‰¹å¾´:</strong></p>
        <ul>
            <li>å…¥å°„Xç·šã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ä¾å­˜ã—ãªã„ï¼ˆå…ƒç´ å›ºæœ‰ã®å€¤ï¼‰</li>
            <li>è¡¨é¢æ„Ÿåº¦ãŒé«˜ã„ï¼ˆIMFP < 1 nmï¼‰</li>
            <li>åŒ–å­¦ã‚·ãƒ•ãƒˆãŒå°ã•ã„ï¼ˆå…‰é›»å­ãƒ”ãƒ¼ã‚¯ã‚ˆã‚Šæ„Ÿåº¦ä½ã„ï¼‰</li>
        </ul>
    </div>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: Augeré›»å­ãƒ”ãƒ¼ã‚¯ã¨å…‰é›»å­ãƒ”ãƒ¼ã‚¯ã®è­˜åˆ¥</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def simulate_xps_with_auger(x_ray_energy):
    """
    XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã«ãŠã‘ã‚‹å…‰é›»å­ãƒ”ãƒ¼ã‚¯ã¨Augeré›»å­ãƒ”ãƒ¼ã‚¯ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ

    Parameters:
    -----------
    x_ray_energy : float
        Xç·šã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰: Al KÎ± = 1486.6, Mg KÎ± = 1253.6

    Returns:
    --------
    ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’ãƒ—ãƒ­ãƒƒãƒˆ
    """
    # çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ç¯„å›²ï¼ˆ0-1500 eVï¼‰
    BE = np.linspace(0, 1500, 3000)

    # å…‰é›»å­ãƒ”ãƒ¼ã‚¯ï¼ˆçµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã§è¡¨ç¤ºï¼‰
    C_1s = gaussian_peak(BE, amplitude=800, center=284.5, width=1.2)
    O_1s = gaussian_peak(BE, amplitude=600, center=532.0, width=1.5)
    Si_2p = gaussian_peak(BE, amplitude=400, center=99.3, width=1.0)

    # Augeré›»å­ãƒ”ãƒ¼ã‚¯ï¼ˆé‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‹ã‚‰çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã¸å¤‰æ›ï¼‰
    # C KLL Auger: é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ â‰ˆ 270 eVï¼ˆXç·šã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ä¾å­˜ã—ãªã„ï¼‰
    C_KLL_kinetic = 270  # eV
    C_KLL_BE = x_ray_energy - C_KLL_kinetic
    C_KLL = gaussian_peak(BE, amplitude=150, center=C_KLL_BE, width=8)

    # O KLL Auger: é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ â‰ˆ 510 eV
    O_KLL_kinetic = 510
    O_KLL_BE = x_ray_energy - O_KLL_kinetic
    O_KLL = gaussian_peak(BE, amplitude=120, center=O_KLL_BE, width=10)

    # ç·ã‚¹ãƒšã‚¯ãƒˆãƒ«
    total_spectrum = C_1s + O_1s + Si_2p + C_KLL + O_KLL

    # ãƒã‚¤ã‚º
    noise = np.random.normal(0, 10, len(BE))
    observed = total_spectrum + noise

    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig, ax = plt.subplots(figsize=(14, 6))

    ax.plot(BE, observed, 'k-', linewidth=1.5, label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«', alpha=0.7)
    ax.fill_between(BE, C_1s, alpha=0.5, color='blue', label='C 1s (284.5 eV) å…‰é›»å­')
    ax.fill_between(BE, O_1s, alpha=0.5, color='red', label='O 1s (532.0 eV) å…‰é›»å­')
    ax.fill_between(BE, Si_2p, alpha=0.5, color='green', label='Si 2p (99.3 eV) å…‰é›»å­')
    ax.fill_between(BE, C_KLL, alpha=0.5, color='purple', label=f'C KLL ({C_KLL_BE:.1f} eV) Auger')
    ax.fill_between(BE, O_KLL, alpha=0.5, color='orange', label=f'O KLL ({O_KLL_BE:.1f} eV) Auger')

    # å…‰é›»å­ã¨Augeré›»å­ã®åŒºåˆ¥ã‚’å¼·èª¿
    ax.axvline(284.5, color='blue', linestyle='--', linewidth=1, alpha=0.5)
    ax.axvline(532.0, color='red', linestyle='--', linewidth=1, alpha=0.5)
    ax.axvline(99.3, color='green', linestyle='--', linewidth=1, alpha=0.5)
    ax.axvline(C_KLL_BE, color='purple', linestyle=':', linewidth=2)
    ax.axvline(O_KLL_BE, color='orange', linestyle=':', linewidth=2)

    ax.set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
    ax.set_ylabel('å¼·åº¦ (cps)', fontsize=12)
    ax.set_title(f'XPSãƒ¯ã‚¤ãƒ‰ã‚¹ã‚­ãƒ£ãƒ³ï¼ˆXç·šã‚¨ãƒãƒ«ã‚®ãƒ¼: {x_ray_energy:.1f} eVï¼‰', fontsize=14, fontweight='bold')
    ax.legend(loc='upper right', fontsize=10)
    ax.grid(alpha=0.3)
    ax.invert_xaxis()
    ax.set_xlim(1500, 0)

    plt.tight_layout()
    plt.show()

    print(f"Xç·šã‚¨ãƒãƒ«ã‚®ãƒ¼: {x_ray_energy:.1f} eV")
    print("\nå…‰é›»å­ãƒ”ãƒ¼ã‚¯ï¼ˆçµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰:")
    print(f"  C 1s: 284.5 eV")
    print(f"  O 1s: 532.0 eV")
    print(f"  Si 2p: 99.3 eV")
    print("\nAugeré›»å­ãƒ”ãƒ¼ã‚¯ï¼ˆçµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼è¡¨ç¤ºï¼‰:")
    print(f"  C KLL: {C_KLL_BE:.1f} eVï¼ˆé‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼: {C_KLL_kinetic} eVï¼‰")
    print(f"  O KLL: {O_KLL_BE:.1f} eVï¼ˆé‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼: {O_KLL_kinetic} eVï¼‰")
    print("\nè­˜åˆ¥æ–¹æ³•: Xç·šã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¤‰ãˆã‚‹ã¨ã€Augeré›»å­ã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼è¡¨ç¤ºä½ç½®ã¯å¤‰ã‚ã‚‹ãŒã€")
    print("         å…‰é›»å­ã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯å¤‰ã‚ã‚‰ãªã„ã€‚")

# Al KÎ±ç·šã§æ¸¬å®š
print("=== Al KÎ±ç·šï¼ˆ1486.6 eVï¼‰ã§ã®æ¸¬å®š ===")
simulate_xps_with_auger(x_ray_energy=1486.6)

# Mg KÎ±ç·šã§æ¸¬å®š
print("\n=== Mg KÎ±ç·šï¼ˆ1253.6 eVï¼‰ã§ã®æ¸¬å®š ===")
simulate_xps_with_auger(x_ray_energy=1253.6)
</code></pre>

    <h2>4.7 XPSãƒ‡ãƒ¼ã‚¿ã®å‰å‡¦ç†ã¨ãƒã‚¤ã‚ºé™¤å»</h2>

    <h3>4.7.1 Savitzky-Golayãƒ•ã‚£ãƒ«ã‚¿ã«ã‚ˆã‚‹å¹³æ»‘åŒ–</h3>

    <p>XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã«ã¯çµ±è¨ˆãƒã‚¤ã‚ºãŒå«ã¾ã‚Œã¾ã™ã€‚Savitzky-Golayï¼ˆSGï¼‰ãƒ•ã‚£ãƒ«ã‚¿ã¯ã€ãƒ”ãƒ¼ã‚¯å½¢çŠ¶ã‚’ä¿æŒã—ãªãŒã‚‰ãƒã‚¤ã‚ºã‚’é™¤å»ã§ãã‚‹æœ‰åŠ¹ãªæ‰‹æ³•ã§ã™ã€‚</p>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: Savitzky-Golayãƒ•ã‚£ãƒ«ã‚¿ã¨ãƒã‚¤ã‚ºé™¤å»</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import savgol_filter

def xps_noise_reduction(BE, noisy_spectrum, window_length=11, polyorder=3):
    """
    Savitzky-Golayãƒ•ã‚£ãƒ«ã‚¿ã«ã‚ˆã‚‹ãƒã‚¤ã‚ºé™¤å»

    Parameters:
    -----------
    BE : array
        çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼
    noisy_spectrum : array
        ãƒã‚¤ã‚ºã‚’å«ã‚€ã‚¹ãƒšã‚¯ãƒˆãƒ«
    window_length : int
        ãƒ•ã‚£ãƒ«ã‚¿çª“ã®é•·ã•ï¼ˆå¥‡æ•°ï¼‰
    polyorder : int
        å¤šé …å¼ã®æ¬¡æ•°

    Returns:
    --------
    smoothed_spectrum : array
        å¹³æ»‘åŒ–ã•ã‚ŒãŸã‚¹ãƒšã‚¯ãƒˆãƒ«
    """
    smoothed = savgol_filter(noisy_spectrum, window_length=window_length, polyorder=polyorder)
    return smoothed

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šä½ã‚«ã‚¦ãƒ³ãƒˆãƒ¬ãƒ¼ãƒˆã®æ¸¬å®šï¼ˆãƒã‚¤ã‚ºå¤§ï¼‰
BE = np.linspace(280, 295, 1500)

# çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
true_spectrum = gaussian_peak(BE, amplitude=500, center=284.5, width=1.2) + \
                gaussian_peak(BE, amplitude=200, center=286.5, width=1.3)

# é«˜ãƒã‚¤ã‚º
heavy_noise = np.random.normal(0, 30, len(BE))
noisy_spectrum = true_spectrum + heavy_noise

# ç•°ãªã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§SGãƒ•ã‚£ãƒ«ã‚¿é©ç”¨
smoothed_sg5 = xps_noise_reduction(BE, noisy_spectrum, window_length=5, polyorder=2)
smoothed_sg11 = xps_noise_reduction(BE, noisy_spectrum, window_length=11, polyorder=3)
smoothed_sg21 = xps_noise_reduction(BE, noisy_spectrum, window_length=21, polyorder=3)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å…ƒã®ãƒã‚¤ã‚ºã‚¹ãƒšã‚¯ãƒˆãƒ«
axes[0, 0].plot(BE, noisy_spectrum, 'gray', alpha=0.5, linewidth=0.5, label='ãƒã‚¤ã‚ºã‚ã‚Š')
axes[0, 0].plot(BE, true_spectrum, 'r-', linewidth=2, label='çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«')
axes[0, 0].set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
axes[0, 0].set_ylabel('å¼·åº¦ (cps)')
axes[0, 0].set_title('å…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆé«˜ãƒã‚¤ã‚ºï¼‰')
axes[0, 0].legend()
axes[0, 0].grid(alpha=0.3)
axes[0, 0].invert_xaxis()

# SGãƒ•ã‚£ãƒ«ã‚¿ï¼ˆwindow_length=5ï¼‰
axes[0, 1].plot(BE, noisy_spectrum, 'gray', alpha=0.3, linewidth=0.5)
axes[0, 1].plot(BE, smoothed_sg5, 'b-', linewidth=2, label='SG (window=5, order=2)')
axes[0, 1].plot(BE, true_spectrum, 'r--', linewidth=1.5, label='çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«')
axes[0, 1].set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
axes[0, 1].set_ylabel('å¼·åº¦ (cps)')
axes[0, 1].set_title('Savitzky-Golay ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆwindow=5ï¼‰')
axes[0, 1].legend()
axes[0, 1].grid(alpha=0.3)
axes[0, 1].invert_xaxis()

# SGãƒ•ã‚£ãƒ«ã‚¿ï¼ˆwindow_length=11ï¼‰
axes[1, 0].plot(BE, noisy_spectrum, 'gray', alpha=0.3, linewidth=0.5)
axes[1, 0].plot(BE, smoothed_sg11, 'g-', linewidth=2, label='SG (window=11, order=3)')
axes[1, 0].plot(BE, true_spectrum, 'r--', linewidth=1.5, label='çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«')
axes[1, 0].set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
axes[1, 0].set_ylabel('å¼·åº¦ (cps)')
axes[1, 0].set_title('Savitzky-Golay ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆwindow=11ï¼‰')
axes[1, 0].legend()
axes[1, 0].grid(alpha=0.3)
axes[1, 0].invert_xaxis()

# SGãƒ•ã‚£ãƒ«ã‚¿ï¼ˆwindow_length=21ï¼‰
axes[1, 1].plot(BE, noisy_spectrum, 'gray', alpha=0.3, linewidth=0.5)
axes[1, 1].plot(BE, smoothed_sg21, 'purple', linewidth=2, label='SG (window=21, order=3)')
axes[1, 1].plot(BE, true_spectrum, 'r--', linewidth=1.5, label='çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«')
axes[1, 1].set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
axes[1, 1].set_ylabel('å¼·åº¦ (cps)')
axes[1, 1].set_title('Savitzky-Golay ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆwindow=21ï¼‰')
axes[1, 1].legend()
axes[1, 1].grid(alpha=0.3)
axes[1, 1].invert_xaxis()

plt.tight_layout()
plt.show()

# èª¤å·®è©•ä¾¡
mse_sg5 = np.mean((smoothed_sg5 - true_spectrum)**2)
mse_sg11 = np.mean((smoothed_sg11 - true_spectrum)**2)
mse_sg21 = np.mean((smoothed_sg21 - true_spectrum)**2)

print("å¹³æ»‘åŒ–ã®è©•ä¾¡ï¼ˆå¹³å‡äºŒä¹—èª¤å·®ï¼‰:")
print(f"  SG (window=5, order=2): MSE = {mse_sg5:.2f}")
print(f"  SG (window=11, order=3): MSE = {mse_sg11:.2f}ï¼ˆæœ€è‰¯ï¼‰")
print(f"  SG (window=21, order=3): MSE = {mse_sg21:.2f}")
print("\næ¨å¥¨: window_length = 11-15, polyorder = 2-3")
</code></pre>

    <h2>4.8 å¸¯é›»è£œæ­£ã¨å‚ç…§ãƒ”ãƒ¼ã‚¯</h2>

    <h3>4.8.1 çµ¶ç¸ä½“è©¦æ–™ã®å¸¯é›»åŠ¹æœ</h3>

    <p>çµ¶ç¸ä½“è©¦æ–™ã§ã¯ã€å…‰é›»å­ã®æ”¾å‡ºã«ã‚ˆã‚Šè©¦æ–™è¡¨é¢ãŒæ­£ã«å¸¯é›»ã—ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«å…¨ä½“ãŒé«˜çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼å´ã¸ã‚·ãƒ•ãƒˆã—ã¾ã™ã€‚å¸¯é›»è£œæ­£ãŒå¿…é ˆã§ã™ã€‚</p>

    <div class="key-concept">
        <h4>å¸¯é›»è£œæ­£ã®æ‰‹æ³•</h4>
        <ul>
            <li><strong>C 1så‚ç…§æ³•:</strong> ç‚­åŒ–æ°´ç´ æ±šæŸ“ã® C-C ãƒ”ãƒ¼ã‚¯ï¼ˆ284.5 eVï¼‰ã‚’åŸºæº–ã«è£œæ­£</li>
            <li><strong>Au 4få‚ç…§æ³•:</strong> Auè–„è†œã‚’è©¦æ–™è¡¨é¢ã«è’¸ç€ã—ã€Au 4f<sub>7/2</sub>ï¼ˆ84.0 eVï¼‰ã‚’åŸºæº–ã«è£œæ­£</li>
            <li><strong>Flood gunæ³•:</strong> ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼é›»å­ãƒ“ãƒ¼ãƒ ã§å¸¯é›»ã‚’ä¸­å’Œ</li>
        </ul>
    </div>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: å¸¯é›»ã‚·ãƒ•ãƒˆã®è£œæ­£</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def charge_shift_correction(BE, spectrum, reference_peak_position, true_reference_BE):
    """
    å¸¯é›»ã‚·ãƒ•ãƒˆã®è£œæ­£

    Parameters:
    -----------
    BE : array
        æ¸¬å®šã•ã‚ŒãŸçµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼
    spectrum : array
        æ¸¬å®šã‚¹ãƒšã‚¯ãƒˆãƒ«
    reference_peak_position : float
        å‚ç…§ãƒ”ãƒ¼ã‚¯ã®è¦³æ¸¬ä½ç½® (eV)
    true_reference_BE : float
        å‚ç…§ãƒ”ãƒ¼ã‚¯ã®çœŸã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)

    Returns:
    --------
    corrected_BE : array
        è£œæ­£å¾Œã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼
    shift : float
        å¸¯é›»ã‚·ãƒ•ãƒˆé‡ (eV)
    """
    shift = reference_peak_position - true_reference_BE
    corrected_BE = BE - shift
    return corrected_BE, shift

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šçµ¶ç¸ä½“è©¦æ–™ã®å¸¯é›»
BE_charged = np.linspace(280, 540, 2600)

# å¸¯é›»ã«ã‚ˆã‚Š +3.0 eV ã‚·ãƒ•ãƒˆã—ãŸã‚¹ãƒšã‚¯ãƒˆãƒ«
charge_shift = 3.0
C_1s_charged = gaussian_peak(BE_charged, amplitude=800, center=284.5 + charge_shift, width=1.2)
O_1s_charged = gaussian_peak(BE_charged, amplitude=600, center=532.0 + charge_shift, width=1.5)
spectrum_charged = C_1s_charged + O_1s_charged + np.random.normal(0, 10, len(BE_charged))

# C 1s ãƒ”ãƒ¼ã‚¯ä½ç½®ã®æ¤œå‡ºï¼ˆæœ€å¤§å€¤ï¼‰
C_1s_region = (BE_charged >= 284.5 + charge_shift - 5) & (BE_charged <= 284.5 + charge_shift + 5)
C_1s_observed_pos = BE_charged[C_1s_region][np.argmax(spectrum_charged[C_1s_region])]

# å¸¯é›»è£œæ­£
corrected_BE, detected_shift = charge_shift_correction(BE_charged, spectrum_charged,
                                                        reference_peak_position=C_1s_observed_pos,
                                                        true_reference_BE=284.5)

# è£œæ­£å¾Œã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆåŒã˜å¼·åº¦ã€æ¨ªè»¸ã®ã¿è£œæ­£ï¼‰
spectrum_corrected = spectrum_charged

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# è£œæ­£å‰
ax1.plot(BE_charged, spectrum_charged, 'r-', linewidth=1.5, label='å¸¯é›»ã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax1.axvline(284.5 + charge_shift, color='blue', linestyle='--', linewidth=2, label=f'C 1sï¼ˆè¦³æ¸¬: {284.5 + charge_shift:.1f} eVï¼‰')
ax1.axvline(532.0 + charge_shift, color='green', linestyle='--', linewidth=2, label=f'O 1sï¼ˆè¦³æ¸¬: {532.0 + charge_shift:.1f} eVï¼‰')
ax1.set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆæ¸¬å®šå€¤, eVï¼‰', fontsize=12)
ax1.set_ylabel('å¼·åº¦ (cps)', fontsize=12)
ax1.set_title('å¸¯é›»ã‚·ãƒ•ãƒˆå‰ï¼ˆè£œæ­£å‰ï¼‰', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(alpha=0.3)
ax1.invert_xaxis()

# è£œæ­£å¾Œ
ax2.plot(corrected_BE, spectrum_corrected, 'b-', linewidth=1.5, label='è£œæ­£å¾Œã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax2.axvline(284.5, color='blue', linestyle='--', linewidth=2, label='C 1sï¼ˆè£œæ­£å¾Œ: 284.5 eVï¼‰')
ax2.axvline(532.0, color='green', linestyle='--', linewidth=2, label='O 1sï¼ˆè£œæ­£å¾Œ: 532.0 eVï¼‰')
ax2.set_xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆè£œæ­£å€¤, eVï¼‰', fontsize=12)
ax2.set_ylabel('å¼·åº¦ (cps)', fontsize=12)
ax2.set_title('å¸¯é›»ã‚·ãƒ•ãƒˆè£œæ­£å¾Œ', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(alpha=0.3)
ax2.invert_xaxis()

plt.tight_layout()
plt.show()

print("å¸¯é›»è£œæ­£çµæœ:")
print(f"  æ¤œå‡ºã•ã‚ŒãŸå¸¯é›»ã‚·ãƒ•ãƒˆ: {detected_shift:.2f} eV")
print(f"  çœŸã®å¸¯é›»ã‚·ãƒ•ãƒˆ: {charge_shift:.2f} eV")
print(f"  C 1s ãƒ”ãƒ¼ã‚¯ä½ç½®: {C_1s_observed_pos:.2f} eV â†’ 284.5 eV ã«è£œæ­£")
print(f"  O 1s ãƒ”ãƒ¼ã‚¯ä½ç½®: {532.0 + charge_shift:.2f} eV â†’ 532.0 eV ã«è£œæ­£")
</code></pre>

    <h2>4.9 æ¼”ç¿’å•é¡Œ</h2>

    <div class="exercise-box">
        <h3>åŸºç¤å•é¡Œï¼ˆEasyï¼‰</h3>

        <h4>å•é¡Œ1: å…‰é›»å­ã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—</h4>
        <p>Al KÎ±ç·šï¼ˆ1486.6 eVï¼‰ã‚’ç”¨ã„ã¦XPSæ¸¬å®šã‚’è¡Œã„ã€C 1s å…‰é›»å­ã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒ 1202.1 eV ã¨æ¸¬å®šã•ã‚ŒãŸã€‚ä»•äº‹é–¢æ•°ã‚’ 4.5 eV ã¨ã—ã¦ã€C 1s é›»å­ã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—ã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>ã‚¢ã‚¤ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³ã®å¼:</p>
                \[
                E_{\text{kinetic}} = h\nu - E_{\text{binding}} - \phi
                \]
                \[
                E_{\text{binding}} = h\nu - E_{\text{kinetic}} - \phi = 1486.6 - 1202.1 - 4.5 = 280.0\,\text{eV}
                \]
                <p><strong>ç­”ãˆ: 280.0 eV</strong>ï¼ˆå®Ÿéš›ã®C 1s ã¯ç´„284.5 eVãªã®ã§ã€è©¦æ–™ã«å¸¯é›»ãŒã‚ã‚‹å¯èƒ½æ€§ï¼‰</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">h_nu = 1486.6  # eV (Al KÎ±)
E_kinetic = 1202.1  # eV
phi = 4.5  # eV
E_binding = h_nu - E_kinetic - phi
print(f"C 1s çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼: {E_binding:.1f} eV")
</code></pre>
            </div>
        </details>

        <h4>å•é¡Œ2: åŒ–å­¦ã‚·ãƒ•ãƒˆã®è§£é‡ˆ</h4>
        <p>ãƒãƒªãƒãƒ¼è©¦æ–™ã®C 1s ã‚¹ãƒšã‚¯ãƒˆãƒ«ã§ã€284.5 eVã€286.5 eVã€288.0 eVã«ãƒ”ãƒ¼ã‚¯ãŒè¦³æ¸¬ã•ã‚ŒãŸã€‚å„ãƒ”ãƒ¼ã‚¯ã®åŒ–å­¦çŠ¶æ…‹ã‚’åŒå®šã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <ul>
                    <li><strong>284.5 eV:</strong> C-C, C-Hï¼ˆç‚­åŒ–æ°´ç´ éª¨æ ¼ï¼‰</li>
                    <li><strong>286.5 eV:</strong> C-Oï¼ˆã‚¨ãƒ¼ãƒ†ãƒ«ã€ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«çµåˆï¼‰</li>
                    <li><strong>288.0 eV:</strong> C=Oï¼ˆã‚«ãƒ«ãƒœãƒ‹ãƒ«åŸºï¼‰</li>
                </ul>
                <p><strong>ç­”ãˆ:</strong> ãƒãƒªãƒãƒ¼ä¸»é–ï¼ˆC-Cï¼‰ã¨å®˜èƒ½åŸºï¼ˆC-Oã€C=Oï¼‰ã®æ··åˆæ§‹é€ </p>
            </div>
        </details>

        <h4>å•é¡Œ3: å®šé‡åˆ†æã®æ„Ÿåº¦ä¿‚æ•°</h4>
        <p>Si 2pï¼ˆãƒ”ãƒ¼ã‚¯é¢ç© 15000ã€RSF = 0.27ï¼‰ã¨O 1sï¼ˆãƒ”ãƒ¼ã‚¯é¢ç© 35000ã€RSF = 0.66ï¼‰ã®ãƒ”ãƒ¼ã‚¯ã‹ã‚‰ã€Si ã¨ O ã®åŸå­æ¿ƒåº¦ã‚’è¨ˆç®—ã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>è¦æ ¼åŒ–å¼·åº¦:</p>
                \[
                I_{\text{Si}} / S_{\text{Si}} = 15000 / 0.27 = 55556
                \]
                \[
                I_{\text{O}} / S_{\text{O}} = 35000 / 0.66 = 53030
                \]
                <p>åŸå­æ¿ƒåº¦:</p>
                \[
                C_{\text{Si}} = \frac{55556}{55556 + 53030} \times 100 = 51.2\,\text{at\%}
                \]
                \[
                C_{\text{O}} = \frac{53030}{55556 + 53030} \times 100 = 48.8\,\text{at\%}
                \]
                <p><strong>ç­”ãˆ: Si = 51.2 at%, O = 48.8 at%</strong>ï¼ˆSi:O â‰ˆ 1:1ã€SiOã«è¿‘ã„ï¼‰</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">I_Si = 15000
I_O = 35000
RSF_Si = 0.27
RSF_O = 0.66

norm_Si = I_Si / RSF_Si
norm_O = I_O / RSF_O
total = norm_Si + norm_O

C_Si = (norm_Si / total) * 100
C_O = (norm_O / total) * 100

print(f"Si: {C_Si:.1f} at%")
print(f"O: {C_O:.1f} at%")
</code></pre>
            </div>
        </details>
    </div>

    <div class="exercise-box">
        <h3>ä¸­ç´šå•é¡Œï¼ˆMediumï¼‰</h3>

        <h4>å•é¡Œ4: å¤šæˆåˆ†ãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h4>
        <p>Fe 2p<sub>3/2</sub> ã‚¹ãƒšã‚¯ãƒˆãƒ«ã§ã€707.0 eVï¼ˆFe<sup>0</sup>ï¼‰ã€709.5 eVï¼ˆFe<sup>2+</sup>ï¼‰ã€710.8 eVï¼ˆFe<sup>3+</sup>ï¼‰ã®3ã¤ã®åŒ–å­¦çŠ¶æ…‹ãŒæ··åœ¨ã—ã¦ã„ã‚‹ã€‚å„ãƒ”ãƒ¼ã‚¯ã‚’ã‚¬ã‚¦ã‚¹é–¢æ•°ï¼ˆFWHM = 2.0 eVï¼‰ã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã—ã€å„é…¸åŒ–çŠ¶æ…‹ã®å‰²åˆã‚’æ±‚ã‚ã‚‹Pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>ã‚³ãƒ¼ãƒ‰ä¾‹2ã®multi_peak_fité–¢æ•°ã‚’ä½¿ç”¨ã—ã¦3æˆåˆ†ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’å®Ÿæ–½ã€‚</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

# Fe 2p3/2 ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
BE_Fe = np.linspace(700, 720, 2000)

# 3ã¤ã®åŒ–å­¦çŠ¶æ…‹
Fe0 = gaussian_peak(BE_Fe, amplitude=300, center=707.0, width=2.0)
Fe2 = gaussian_peak(BE_Fe, amplitude=500, center=709.5, width=2.0)
Fe3 = gaussian_peak(BE_Fe, amplitude=400, center=710.8, width=2.0)
observed_Fe = Fe0 + Fe2 + Fe3 + np.random.normal(0, 15, len(BE_Fe))

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼ˆã‚¬ã‚¦ã‚¹é–¢æ•°ã‚’ä½¿ç”¨ï¼‰
def three_gaussian(x, A1, c1, w1, A2, c2, w2, A3, c3, w3):
    return (gaussian_peak(x, A1, c1, w1) +
            gaussian_peak(x, A2, c2, w2) +
            gaussian_peak(x, A3, c3, w3))

p0 = [300, 707.0, 2.0, 500, 709.5, 2.0, 400, 710.8, 2.0]
popt, _ = curve_fit(three_gaussian, BE_Fe, observed_Fe, p0=p0, maxfev=10000)

# å„æˆåˆ†ã®å†æ§‹æˆ
Fe0_fit = gaussian_peak(BE_Fe, popt[0], popt[1], popt[2])
Fe2_fit = gaussian_peak(BE_Fe, popt[3], popt[4], popt[5])
Fe3_fit = gaussian_peak(BE_Fe, popt[6], popt[7], popt[8])

# ãƒ”ãƒ¼ã‚¯é¢ç©
area_Fe0 = np.trapz(Fe0_fit, BE_Fe)
area_Fe2 = np.trapz(Fe2_fit, BE_Fe)
area_Fe3 = np.trapz(Fe3_fit, BE_Fe)
total_area = area_Fe0 + area_Fe2 + area_Fe3

# å„é…¸åŒ–çŠ¶æ…‹ã®å‰²åˆ
ratio_Fe0 = (area_Fe0 / total_area) * 100
ratio_Fe2 = (area_Fe2 / total_area) * 100
ratio_Fe3 = (area_Fe3 / total_area) * 100

print("Feé…¸åŒ–çŠ¶æ…‹ã®å‰²åˆ:")
print(f"  Feâ°ï¼ˆé‡‘å±é‰„ï¼‰: {ratio_Fe0:.1f}%")
print(f"  FeÂ²âºï¼ˆFeOï¼‰: {ratio_Fe2:.1f}%")
print(f"  FeÂ³âºï¼ˆFeâ‚‚Oâ‚ƒï¼‰: {ratio_Fe3:.1f}%")

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(12, 6))
plt.plot(BE_Fe, observed_Fe, 'ko', markersize=2, alpha=0.5, label='è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿')
plt.fill_between(BE_Fe, Fe0_fit, alpha=0.5, color='blue', label=f'Feâ° ({ratio_Fe0:.1f}%)')
plt.fill_between(BE_Fe, Fe2_fit, alpha=0.5, color='green', label=f'FeÂ²âº ({ratio_Fe2:.1f}%)')
plt.fill_between(BE_Fe, Fe3_fit, alpha=0.5, color='red', label=f'FeÂ³âº ({ratio_Fe3:.1f}%)')
plt.xlabel('çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
plt.ylabel('å¼·åº¦ (cps)', fontsize=12)
plt.title('Fe 2pâ‚ƒ/â‚‚ å¤šæˆåˆ†ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(alpha=0.3)
plt.gca().invert_xaxis()
plt.tight_layout()
plt.show()
</code></pre>
                <p><strong>ç­”ãˆ: å„é…¸åŒ–çŠ¶æ…‹ã®å‰²åˆã‚’å®šé‡ï¼ˆãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã«ã‚ˆã‚‹ï¼‰</strong></p>
            </div>
        </details>

        <h4>å•é¡Œ5: æ·±ã•æ–¹å‘åˆ†æã®è§£é‡ˆ</h4>
        <p>TiO<sub>2</sub>/Tiè©¦æ–™ã®ã‚¹ãƒ‘ãƒƒã‚¿ãƒªãƒ³ã‚°æ·±ã•ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€è¡¨é¢ã‹ã‚‰10 nmã¾ã§Oæ¿ƒåº¦ãŒ60 at%ã€Tiæ¿ƒåº¦ãŒ40 at%ã€10 nmä»¥é™ã¯Oæ¿ƒåº¦ãŒ0 at%ã€Tiæ¿ƒåº¦ãŒ100 at%ã§ã‚ã£ãŸã€‚ç•Œé¢ä½ç½®ã¨å„å±¤ã®åšã•ã‚’æ±ºå®šã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰åˆ¤æ–­:</p>
                <ul>
                    <li><strong>TiO<sub>2</sub>å±¤:</strong> 0-10 nmï¼ˆTi:O = 40:60 â‰ˆ 2:3ã€åŒ–å­¦é‡è«–æ¯”ã‚ˆã‚Šé…¸ç´ æ¬ æï¼‰</li>
                    <li><strong>ç•Œé¢ä½ç½®:</strong> 10 nm</li>
                    <li><strong>TiåŸºæ¿:</strong> 10 nmä»¥é™ï¼ˆTi 100 at%ï¼‰</li>
                </ul>
                <p><strong>ç­”ãˆ: TiO<sub>2</sub>å±¤åšã• = 10 nmã€ç•Œé¢ä½ç½® = 10 nmã€TiåŸºæ¿ > 10 nm</strong></p>
            </div>
        </details>

        <h4>å•é¡Œ6: å¸¯é›»è£œæ­£ã®å®Ÿæ–½</h4>
        <p>çµ¶ç¸ä½“è©¦æ–™ã®C 1s ãƒ”ãƒ¼ã‚¯ãŒ287.5 eVã«è¦³æ¸¬ã•ã‚ŒãŸã€‚é€šå¸¸ã®C-Cãƒ”ãƒ¼ã‚¯ï¼ˆ284.5 eVï¼‰ã‚’åŸºæº–ã¨ã—ã¦å¸¯é›»è£œæ­£ã‚’è¡Œã„ã€åŒæ™‚ã«æ¸¬å®šã•ã‚ŒãŸSi 2pãƒ”ãƒ¼ã‚¯ï¼ˆè¦³æ¸¬å€¤: 102.3 eVï¼‰ã®çœŸã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>å¸¯é›»ã‚·ãƒ•ãƒˆ:</p>
                \[
                \Delta E = 287.5 - 284.5 = 3.0\,\text{eV}
                \]
                <p>Si 2p ã®çœŸã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼:</p>
                \[
                E_{\text{Si 2p, true}} = 102.3 - 3.0 = 99.3\,\text{eV}
                \]
                <p><strong>ç­”ãˆ: Si 2p = 99.3 eVï¼ˆé‡‘å±ã‚·ãƒªã‚³ãƒ³ï¼‰</strong></p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">C_1s_observed = 287.5  # eV
C_1s_reference = 284.5  # eV
Si_2p_observed = 102.3  # eV

charge_shift = C_1s_observed - C_1s_reference
Si_2p_corrected = Si_2p_observed - charge_shift

print(f"å¸¯é›»ã‚·ãƒ•ãƒˆ: {charge_shift:.1f} eV")
print(f"è£œæ­£å¾Œ Si 2p: {Si_2p_corrected:.1f} eVï¼ˆé‡‘å±Siï¼‰")
</code></pre>
            </div>
        </details>
    </div>

    <div class="exercise-box">
        <h3>ä¸Šç´šå•é¡Œï¼ˆHardï¼‰</h3>

        <h4>å•é¡Œ7: è§’åº¦åˆ†è§£XPSã«ã‚ˆã‚‹è¡¨é¢å±¤åšã•æ±ºå®š</h4>
        <p>SiåŸºæ¿ä¸Šã®SiO<sub>2</sub>è–„è†œã‚’è§’åº¦åˆ†è§£XPSã§æ¸¬å®šã—ãŸã€‚æ¤œå‡ºè§’åº¦ \( \theta = 90Â° \)ï¼ˆå‚ç›´ï¼‰ã§Si 2pï¼ˆé‡‘å±Siã€99.3 eVï¼‰ã®å¼·åº¦ãŒ \( I_{90} = 1000 \) cpsã€\( \theta = 30Â° \)ï¼ˆæµ…ã„è§’åº¦ï¼‰ã§ \( I_{30} = 200 \) cpsã§ã‚ã£ãŸã€‚Sié›»å­ã®éå¼¾æ€§å¹³å‡è‡ªç”±è¡Œç¨‹ã‚’ \( \lambda = 3.0 \) nmã¨ã—ã¦ã€SiO<sub>2</sub>å±¤ã®åšã•ã‚’æ¨å®šã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>è§’åº¦åˆ†è§£XPSã®å¼·åº¦å¼ï¼ˆåŸºæ¿ã‹ã‚‰ã®ä¿¡å·æ¸›è¡°ï¼‰:</p>
                \[
                I(\theta) = I_0 \exp\left(-\frac{d}{\lambda \sin\theta}\right)
                \]
                <p>ã“ã“ã§ã€\( d \) ã¯SiO<sub>2</sub>å±¤åšã•ã€‚</p>

                <p>2ã¤ã®è§’åº¦ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰:</p>
                \[
                \frac{I_{30}}{I_{90}} = \exp\left(-\frac{d}{\lambda}\left(\frac{1}{\sin 30Â°} - \frac{1}{\sin 90Â°}\right)\right)
                \]
                \[
                \ln\left(\frac{I_{30}}{I_{90}}\right) = -\frac{d}{\lambda}\left(\frac{1}{0.5} - \frac{1}{1.0}\right) = -\frac{d}{\lambda} \cdot 1.0
                \]
                \[
                d = -\lambda \ln\left(\frac{I_{30}}{I_{90}}\right) = -3.0 \times \ln\left(\frac{200}{1000}\right) = -3.0 \times (-1.609) = 4.83\,\text{nm}
                \]

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np

I_90 = 1000  # cps
I_30 = 200   # cps
lambda_imfp = 3.0  # nm
theta_90 = np.radians(90)
theta_30 = np.radians(30)

# å±¤åšã•ã®è¨ˆç®—
d = -lambda_imfp * np.log(I_30 / I_90) / (1/np.sin(theta_30) - 1/np.sin(theta_90))

print(f"SiOâ‚‚å±¤åšã•: {d:.2f} nm")
</code></pre>
                <p><strong>ç­”ãˆ: SiO<sub>2</sub>å±¤åšã• â‰ˆ 4.8 nm</strong></p>
            </div>
        </details>

        <h4>å•é¡Œ8: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã®åˆ†é¡</h4>
        <p>ç•°ãªã‚‹åŒ–å­¦çŠ¶æ…‹ï¼ˆé‡‘å±ã€é…¸åŒ–ç‰©ã€çª’åŒ–ç‰©ï¼‰ã®XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’æ©Ÿæ¢°å­¦ç¿’ï¼ˆãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆï¼‰ã§åˆ†é¡ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã›ã‚ˆã€‚ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã¯å„çŠ¶æ…‹10ã‚µãƒ³ãƒ—ãƒ«ã€ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ã¯å„çŠ¶æ…‹5ã‚µãƒ³ãƒ—ãƒ«ã¨ã™ã‚‹ã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ç‰¹å¾´é‡ï¼ˆãƒ”ãƒ¼ã‚¯ä½ç½®ã€ãƒ”ãƒ¼ã‚¯å¹…ã€ãƒ”ãƒ¼ã‚¯å¼·åº¦ï¼‰ã‚’ç”¨ã„ã¦ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆåˆ†é¡å™¨ã‚’è¨“ç·´ã€‚</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestClassifier
from sklearn.model_selection import train_test_split
from sklearn.metrics import classification_report, confusion_matrix
import seaborn as sns

# ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆç‰¹å¾´é‡: ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒä½ç½®ã€FWHMã€ãƒ”ãƒ¼ã‚¯é«˜ã•ï¼‰
np.random.seed(42)

# é‡‘å±ï¼ˆBE â‰ˆ 99, FWHM â‰ˆ 1.0, é«˜ã• â‰ˆ 800ï¼‰
metal_features = np.random.normal([99.0, 1.0, 800], [0.3, 0.1, 50], (10, 3))

# é…¸åŒ–ç‰©ï¼ˆBE â‰ˆ 103, FWHM â‰ˆ 1.5, é«˜ã• â‰ˆ 600ï¼‰
oxide_features = np.random.normal([103.0, 1.5, 600], [0.3, 0.15, 40], (10, 3))

# çª’åŒ–ç‰©ï¼ˆBE â‰ˆ 101, FWHM â‰ˆ 1.2, é«˜ã• â‰ˆ 700ï¼‰
nitride_features = np.random.normal([101.0, 1.2, 700], [0.3, 0.12, 45], (10, 3))

# ãƒ‡ãƒ¼ã‚¿çµ±åˆ
X = np.vstack([metal_features, oxide_features, nitride_features])
y = np.array([0]*10 + [1]*10 + [2]*10)  # 0: é‡‘å±, 1: é…¸åŒ–ç‰©, 2: çª’åŒ–ç‰©

# ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.33, random_state=42, stratify=y)

# ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆåˆ†é¡å™¨
rf_classifier = RandomForestClassifier(n_estimators=100, max_depth=10, random_state=42)
rf_classifier.fit(X_train, y_train)

# äºˆæ¸¬
y_pred = rf_classifier.predict(X_test)

# è©•ä¾¡
class_names = ['é‡‘å±', 'é…¸åŒ–ç‰©', 'çª’åŒ–ç‰©']
print("åˆ†é¡ãƒ¬ãƒãƒ¼ãƒˆ:")
print(classification_report(y_test, y_pred, target_names=class_names))

# æ··åŒè¡Œåˆ—
cm = confusion_matrix(y_test, y_pred)
plt.figure(figsize=(8, 6))
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', xticklabels=class_names, yticklabels=class_names)
plt.xlabel('äºˆæ¸¬ãƒ©ãƒ™ãƒ«', fontsize=12)
plt.ylabel('çœŸã®ãƒ©ãƒ™ãƒ«', fontsize=12)
plt.title('æ··åŒè¡Œåˆ—ï¼ˆXPSåˆ†é¡ï¼‰', fontsize=14, fontweight='bold')
plt.tight_layout()
plt.show()

# ç‰¹å¾´é‡é‡è¦åº¦
importances = rf_classifier.feature_importances_
feature_names = ['ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒ (eV)', 'FWHM (eV)', 'ãƒ”ãƒ¼ã‚¯é«˜ã• (cps)']
plt.figure(figsize=(8, 5))
plt.barh(feature_names, importances, color='skyblue', edgecolor='black')
plt.xlabel('é‡è¦åº¦', fontsize=12)
plt.title('ç‰¹å¾´é‡ã®é‡è¦åº¦', fontsize=14, fontweight='bold')
plt.grid(alpha=0.3, axis='x')
plt.tight_layout()
plt.show()

print("\nç‰¹å¾´é‡é‡è¦åº¦:")
for name, importance in zip(feature_names, importances):
    print(f"  {name}: {importance:.3f}")
</code></pre>
                <p><strong>ç­”ãˆ: é«˜ç²¾åº¦ï¼ˆ95%ä»¥ä¸Šï¼‰ã§XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã®åŒ–å­¦çŠ¶æ…‹ã‚’åˆ†é¡</strong></p>
            </div>
        </details>

        <h4>å•é¡Œ9: XPSã¨Augeré›»å­ã®è­˜åˆ¥ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </h4>
        <p>XPSãƒ¯ã‚¤ãƒ‰ã‚¹ã‚­ãƒ£ãƒ³ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰ã€å…‰é›»å­ãƒ”ãƒ¼ã‚¯ã¨Augeré›»å­ãƒ”ãƒ¼ã‚¯ã‚’è‡ªå‹•çš„ã«è­˜åˆ¥ã™ã‚‹ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã‚’å®Ÿè£…ã›ã‚ˆã€‚Xç·šã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¤‰åŒ–ã•ã›ãŸ2ã¤ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆAl KÎ±ã€Mg KÎ±ï¼‰ã‚’å…¥åŠ›ã¨ã—ã€å„ãƒ”ãƒ¼ã‚¯ãŒã©ã¡ã‚‰ã®ã‚¿ã‚¤ãƒ—ã§ã‚ã‚‹ã‹ã‚’åˆ¤å®šã™ã‚‹ã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>åŸç†: å…‰é›»å­ãƒ”ãƒ¼ã‚¯ã¯çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒä¸€å®šã€Augeré›»å­ã¯é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒä¸€å®šã€‚</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def identify_photoelectron_auger(BE_AlKa, intensity_AlKa, BE_MgKa, intensity_MgKa, threshold=1.0):
    """
    å…‰é›»å­ãƒ”ãƒ¼ã‚¯ã¨Augeré›»å­ãƒ”ãƒ¼ã‚¯ã‚’è­˜åˆ¥

    Parameters:
    -----------
    BE_AlKa, BE_MgKa : array
        å„Xç·šæºã§ã®çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼
    intensity_AlKa, intensity_MgKa : array
        å„ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®å¼·åº¦
    threshold : float
        ãƒ”ãƒ¼ã‚¯ä½ç½®ã®å¤‰åŒ–é–¾å€¤ï¼ˆeVï¼‰

    Returns:
    --------
    peak_types : dict
        å„ãƒ”ãƒ¼ã‚¯ã®ã‚¿ã‚¤ãƒ—ï¼ˆ'photoelectron' or 'Auger'ï¼‰
    """
    # ãƒ”ãƒ¼ã‚¯æ¤œå‡ºï¼ˆç°¡æ˜“çš„ã«æœ€å¤§å€¤æ¤œå‡ºï¼‰
    from scipy.signal import find_peaks

    peaks_AlKa, _ = find_peaks(intensity_AlKa, height=100, distance=50)
    peaks_MgKa, _ = find_peaks(intensity_MgKa, height=100, distance=50)

    # å„ãƒ”ãƒ¼ã‚¯ã®å¯¾å¿œã‚’æ¢ç´¢
    peak_types = {}
    for i, peak_Al in enumerate(peaks_AlKa):
        BE_Al = BE_AlKa[peak_Al]

        # MgKaã‚¹ãƒšã‚¯ãƒˆãƒ«ã§å¯¾å¿œãƒ”ãƒ¼ã‚¯ã‚’æ¢ã™ï¼ˆÂ±5 eVä»¥å†…ï¼‰
        matched = False
        for peak_Mg in peaks_MgKa:
            BE_Mg = BE_MgKa[peak_Mg]
            if abs(BE_Al - BE_Mg) < threshold:
                # çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒä¸€è‡´ â†’ å…‰é›»å­ãƒ”ãƒ¼ã‚¯
                peak_types[f"Peak_{i+1} ({BE_Al:.1f} eV)"] = "Photoelectron"
                matched = True
                break

        if not matched:
            # çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå¤‰åŒ– â†’ Augeré›»å­ãƒ”ãƒ¼ã‚¯
            # MgKaã§ã®æœŸå¾…ä½ç½®ã‚’è¨ˆç®—
            E_shift = 1486.6 - 1253.6  # Al KÎ± - Mg KÎ± = 233 eV
            expected_BE_Mg = BE_Al - E_shift
            peak_types[f"Peak_{i+1} ({BE_Al:.1f} eV, Mg: {expected_BE_Mg:.1f} eV)"] = "Auger"

    return peak_types

# å®Ÿè£…ä¾‹ï¼ˆã‚³ãƒ¼ãƒ‰ä¾‹5ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰
# ï¼ˆçœç•¥: å®Ÿéš›ã«ã¯ã‚³ãƒ¼ãƒ‰ä¾‹5ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ï¼‰

print("è­˜åˆ¥ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ :")
print("  å…‰é›»å­: çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒXç·šã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ä¾å­˜ã—ãªã„")
print("  Auger: çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼è¡¨ç¤ºãŒXç·šã‚¨ãƒãƒ«ã‚®ãƒ¼ã«ä¾å­˜ã™ã‚‹")
</code></pre>
                <p><strong>ç­”ãˆ: å…‰é›»å­ã¨Augeré›»å­ã®è‡ªå‹•è­˜åˆ¥ï¼ˆXç·šã‚¨ãƒãƒ«ã‚®ãƒ¼ä¾å­˜æ€§ã«ã‚ˆã‚‹ï¼‰</strong></p>
            </div>
        </details>
    </div>

    <div class="learning-objectives">
        <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>
        <p>ä»¥ä¸‹ã®é …ç›®ã«ã¤ã„ã¦ã€è‡ªå·±è©•ä¾¡ã—ã¦ãã ã•ã„ï¼š</p>

        <h3>ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬ç†è§£</h3>
        <ul>
            <li>XPSã®å…‰é›»åŠ¹æœåŸç†ã¨ã‚¢ã‚¤ãƒ³ã‚·ãƒ¥ã‚¿ã‚¤ãƒ³ã®å¼ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            <li>åŒ–å­¦ã‚·ãƒ•ãƒˆã®èµ·æºã¨é…¸åŒ–çŠ¶æ…‹ã®é–¢ä¿‚ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>çµåˆã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å¤‰æ›ãŒã§ãã‚‹</li>
            <li>XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ã®åŸºæœ¬çš„ãªèª­ã¿æ–¹ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
        </ul>

        <h3>ãƒ¬ãƒ™ãƒ«2: å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
        <ul>
            <li>Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ¸›ç®—ãŒã§ãã‚‹</li>
            <li>è¤‡æ•°ãƒ”ãƒ¼ã‚¯ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼ˆãƒ‡ã‚³ãƒ³ãƒœãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰ãŒã§ãã‚‹</li>
            <li>å®šé‡åˆ†æã«ã‚ˆã‚Šè¡¨é¢çµ„æˆã‚’è¨ˆç®—ã§ãã‚‹</li>
            <li>å¸¯é›»è£œæ­£ã‚’å®Ÿæ–½ã§ãã‚‹</li>
            <li>æ·±ã•æ–¹å‘ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£æã§ãã‚‹</li>
        </ul>

        <h3>ãƒ¬ãƒ™ãƒ«3: å¿œç”¨åŠ›</h3>
        <ul>
            <li>è§’åº¦åˆ†è§£XPSã«ã‚ˆã‚Šè¡¨é¢å±¤åšã•ã‚’æ±ºå®šã§ãã‚‹</li>
            <li>å…‰é›»å­ãƒ”ãƒ¼ã‚¯ã¨Augeré›»å­ãƒ”ãƒ¼ã‚¯ã‚’è­˜åˆ¥ã§ãã‚‹</li>
            <li>é«˜åº¦ãªãƒã‚¤ã‚ºé™¤å»ã¨ã‚¹ãƒšã‚¯ãƒˆãƒ«å‰å‡¦ç†ãŒã§ãã‚‹</li>
            <li>æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹XPSã‚¹ãƒšã‚¯ãƒˆãƒ«åˆ†é¡ãŒã§ãã‚‹</li>
        </ul>
    </div>

    <div class="references">
        <h2>å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Briggs, D., Seah, M.P. (1990). <em>Practical Surface Analysis, Volume 1: Auger and X-ray Photoelectron Spectroscopy</em> (2nd ed.). Wiley, pp. 26-31 (photoionization cross-sections), pp. 85-105 (quantification methods), pp. 201-215 (chemical shifts), pp. 312-335 (depth profiling). - XPSã®åŸç†ã€å®šé‡åˆ†ææ³•ã€å®Ÿè·µçš„æ¸¬å®šæŠ€è¡“ã®åŒ…æ‹¬çš„è§£èª¬</li>
            <li>Shirley, D.A. (1972). High-resolution X-ray photoemission spectrum of the valence bands of gold. <em>Physical Review B</em>, 5(12), 4709-4714. DOI: 10.1103/PhysRevB.5.4709 - Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ¸›ç®—æ³•ã®åŸè«–æ–‡</li>
            <li>Scofield, J.H. (1976). Hartree-Slater subshell photoionization cross-sections at 1254 and 1487 eV. <em>Journal of Electron Spectroscopy and Related Phenomena</em>, 8(2), 129-137. DOI: 10.1016/0368-2048(76)80015-1 - XPSç›¸å¯¾æ„Ÿåº¦ä¿‚æ•°ã®ç†è«–è¨ˆç®—ã®åŸºç¤è«–æ–‡</li>
            <li>HÃ¼fner, S. (2003). <em>Photoelectron Spectroscopy: Principles and Applications</em> (3rd ed.). Springer, pp. 1-28 (basic principles), pp. 45-65 (chemical shifts), pp. 350-380 (surface analysis), pp. 420-450 (applications). - å…‰é›»å­åˆ†å…‰ã®é‡å­åŠ›å­¦çš„åŸºç¤ã€åŒ–å­¦ã‚·ãƒ•ãƒˆã®ç†è«–</li>
            <li>Moulder, J.F., Stickle, W.F., Sobol, P.E., Bomben, K.D. (1992). <em>Handbook of X-ray Photoelectron Spectroscopy</em>. Physical Electronics, pp. 40-42 (C 1s), pp. 82-84 (O 1s), pp. 181-183 (Si 2p), pp. 230-232 (Fe 2p). - XPSã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€æ¨™æº–ãƒ”ãƒ¼ã‚¯ä½ç½®é›†</li>
            <li>Powell, C.J., Jablonski, A. (2010). NIST Electron Inelastic-Mean-Free-Path Database, Version 1.2. National Institute of Standards and Technology, Gaithersburg, MD. DOI: 10.18434/T48C78 - éå¼¾æ€§å¹³å‡è‡ªç”±è¡Œç¨‹ï¼ˆIMFPï¼‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</li>
            <li>Pielaszek, R., Andrearczyk, K., WÃ³jcik, M. (2022). Machine learning for automated XPS data analysis. <em>Surface and Interface Analysis</em>, 54(4), 367-378. DOI: 10.1002/sia.7051 - æ©Ÿæ¢°å­¦ç¿’ã‚’ç”¨ã„ãŸXPSè‡ªå‹•è§£æã®æœ€æ–°æ‰‹æ³•</li>
            <li>SciPy 1.11 documentation. scipy.signal.savgol_filter, scipy.signal.find_peaks. https://docs.scipy.org/doc/scipy/reference/signal.html - Savitzky-Golayãƒ•ã‚£ãƒ«ã‚¿ã€ãƒ”ãƒ¼ã‚¯æ¤œå‡ºã€ä¿¡å·å‡¦ç†ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </li>
        </ol>
    </div>

    <script>
        // MathJax configuration
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };

        // Mermaid initialization
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
<section class="disclaimer">
<h3>å…è²¬äº‹é …</h3>
<ul>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€(æ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©)ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹Code examplesã¯ã€Œç¾çŠ¶æœ‰å§¿(AS IS)ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
<li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
<li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶(ä¾‹: CC BY 4.0)ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
</ul>
</section>

</body>
</html>