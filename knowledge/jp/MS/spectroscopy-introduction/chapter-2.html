<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬2ç« :èµ¤å¤–ãƒ»ãƒ©ãƒãƒ³åˆ†å…‰æ³• - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-sm);
            line-height: 1.8;
        }

        ul, ol {
            margin-bottom: var(--spacing-sm);
            padding-left: var(--spacing-lg);
        }

        li {
            margin-bottom: 0.5rem;
            line-height: 1.7;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            border-left: 4px solid var(--color-accent);
            padding: var(--spacing-md);
            margin: var(--spacing-md) 0;
            border-radius: var(--border-radius);
        }

        .info-box strong {
            color: var(--color-accent-light);
        }

        .mermaid {
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            margin: var(--spacing-md) 0;
            text-align: center;
        }

        pre {
            background-color: var(--color-code-bg);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            overflow-x: auto;
            margin: var(--spacing-md) 0;
            border: 1px solid var(--color-border);
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        .code-example {
            margin: var(--spacing-md) 0;
        }

        .code-example h4 {
            color: var(--color-primary);
            margin-bottom: var(--spacing-sm);
            font-size: 1.1rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: var(--spacing-md) 0;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.2) 0%, rgba(245, 87, 108, 0.2) 100%);
            font-weight: 600;
        }

        details {
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            margin: var(--spacing-md) 0;
            border: 1px solid var(--color-border);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-sm);
            margin: calc(-1 * var(--spacing-md));
            margin-bottom: var(--spacing-md);
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.15) 0%, rgba(245, 87, 108, 0.15) 100%);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }

        summary:hover {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.25) 0%, rgba(245, 87, 108, 0.25) 100%);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
            gap: var(--spacing-md);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            text-decoration: none;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg);
            background-color: var(--color-bg-alt);
            text-align: center;
            border-top: 1px solid var(--color-border);
        }

        footer p {
            margin-bottom: var(--spacing-sm);
            color: var(--color-text-light);
        }

        footer a {
            color: var(--color-link);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.6rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.9em;
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#f093fb',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#f5576c',
                lineColor: '#f5576c',
                secondaryColor: '#f7fafc',
                tertiaryColor: '#ffffff'
            }
        });
    </script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/spectroscopy-introduction/index.html">Spectroscopy</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 2</span>
        </div>
    </nav>

        <header>
        <div class="header-content">
            <h1>ç¬¬2ç« ï¼šèµ¤å¤–ãƒ»ãƒ©ãƒãƒ³åˆ†å…‰æ³•</h1>
            <p class="subtitle">æŒ¯å‹•åˆ†å…‰ã§æ¢ã‚‹åˆ†å­æ§‹é€ ã¨åŒ–å­¦çµåˆ</p>
            <div class="meta">
                <span class="meta-item">ğŸ“š ã‚·ãƒªãƒ¼ã‚º: åˆ†å…‰åˆ†æå…¥é–€</span>
                <span class="meta-item">â±ï¸ å­¦ç¿’æ™‚é–“: 100åˆ†</span>
                <span class="meta-item">ğŸ¯ é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
            </div>
        </div>
    </header>

    <main class="container">
        <h2>ã‚¤ãƒ³ãƒˆãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³</h2>

        <p>èµ¤å¤–åˆ†å…‰ï¼ˆInfrared Spectroscopy, IRï¼‰ã¨ãƒ©ãƒãƒ³åˆ†å…‰ï¼ˆRaman Spectroscopyï¼‰ã¯ã€åˆ†å­ã®æŒ¯å‹•æƒ…å ±ã‚’é€šã˜ã¦åŒ–å­¦çµåˆã€å®˜èƒ½åŸºã€çµæ™¶æ§‹é€ ã‚’è§£æ˜ã™ã‚‹ç›¸è£œçš„ãªæ‰‹æ³•ã§ã™ã€‚IRã¯èµ¤å¤–å…‰ã®å¸åã‚’æ¸¬å®šã—ã€Ramanã¯æ•£ä¹±å…‰ã®å‘¨æ³¢æ•°ã‚·ãƒ•ãƒˆã‚’è¦³æ¸¬ã—ã¾ã™ã€‚ä¸¡è€…ã¯ç•°ãªã‚‹é¸æŠå‰‡ã«å¾“ã†ãŸã‚ã€IRã§æ´»æ€§ãªæŒ¯å‹•ãŒRamanã§ä¸æ´»æ€§ã€ã¾ãŸã¯ãã®é€†ã¨ã„ã†ç›¸è£œæ€§ã‚’æŒã¡ã¾ã™ã€‚</p>

        <div class="info-box">
            <strong>IRã¨Ramanã®ä½¿ã„åˆ†ã‘</strong><br>
            <ul>
                <li><strong>IR</strong>: æ¥µæ€§åŸºï¼ˆC=O, O-H, N-Hï¼‰ã®æ¤œå‡ºã€æœ‰æ©Ÿç‰©ã®å®˜èƒ½åŸºåŒå®šã€å›ºä½“ãƒ»æ¶²ä½“ãƒ»æ°—ä½“ã™ã¹ã¦ã«é©ç”¨å¯èƒ½</li>
                <li><strong>Raman</strong>: å¯¾ç§°æŒ¯å‹•ï¼ˆC=C, S-Sï¼‰ã®æ¤œå‡ºã€æ°´æº¶æ¶²è©¦æ–™ã€çµæ™¶æ€§è©•ä¾¡ï¼ˆä½æ³¢æ•°é ˜åŸŸï¼‰ã€éç ´å£Šãƒ»éæ¥è§¦æ¸¬å®š</li>
            </ul>
        </div>

        <h2>1. åˆ†å­æŒ¯å‹•ã®åŸºç¤</h2>

        <h3>1.1 èª¿å’ŒæŒ¯å‹•å­ãƒ¢ãƒ‡ãƒ«</h3>

        <p>2åŸå­åˆ†å­ã®æŒ¯å‹•ã¯èª¿å’ŒæŒ¯å‹•å­ã§è¿‘ä¼¼ã§ãã¾ã™ã€‚ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯Hookeã®æ³•å‰‡ã«å¾“ã„ã¾ã™ï¼š</p>

        <p>$$V(r) = \frac{1}{2}k(r - r_e)^2$$</p>

        <p>ã“ã“ã§ã€$k$ ã¯åŠ›ã®å®šæ•°ï¼ˆN/mï¼‰ã€$r_e$ ã¯å¹³è¡¡æ ¸é–“è·é›¢ã§ã™ã€‚æŒ¯å‹•å‘¨æ³¢æ•° $\nu$ ã¯ä»¥ä¸‹ã§ä¸ãˆã‚‰ã‚Œã¾ã™ï¼š</p>

        <p>$$\nu = \frac{1}{2\pi}\sqrt{\frac{k}{\mu}}$$</p>

        <p>$\mu = \frac{m_1 m_2}{m_1 + m_2}$ ã¯æ›ç®—è³ªé‡ã§ã™ã€‚æŒ¯å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ã¯é‡å­åŒ–ã•ã‚Œã€</p>

        <p>$$E_v = h\nu \left(v + \frac{1}{2}\right), \quad v = 0, 1, 2, \ldots$$</p>

        <p>èª¿å’ŒæŒ¯å‹•å­è¿‘ä¼¼ã§ã¯ã€é¸æŠå‰‡ã¯ $\Delta v = \pm 1$ ã§ã™ï¼ˆåŸºæœ¬æŒ¯å‹•ã®ã¿è¨±å®¹ï¼‰ã€‚å®Ÿéš›ã®åˆ†å­ã§ã¯éèª¿å’Œæ€§ã«ã‚ˆã‚Š $\Delta v = \pm 2, \pm 3, \ldots$ï¼ˆå€éŸ³ï¼‰ã‚‚å¼±ãè¦³æ¸¬ã•ã‚Œã¾ã™ã€‚</p>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: èª¿å’ŒæŒ¯å‹•å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ã¨æŒ¯å‹•å‘¨æ³¢æ•°è¨ˆç®—</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ç‰©ç†å®šæ•°
h = 6.62607015e-34  # JÂ·s
c = 2.99792458e8    # m/s
u = 1.66053906660e-27  # kg (atomic mass unit)

def vibrational_frequency(k, m1, m2):
    """
    2åŸå­åˆ†å­ã®æŒ¯å‹•å‘¨æ³¢æ•°ï¼ˆHzï¼‰ã¨æ³¢æ•°ï¼ˆcm^-1ï¼‰ã‚’è¨ˆç®—

    Parameters:
    -----------
    k : float
        åŠ›ã®å®šæ•°ï¼ˆN/mï¼‰
    m1, m2 : float
        åŸå­ã®è³ªé‡ï¼ˆamuï¼‰

    Returns:
    --------
    freq_Hz : float
        æŒ¯å‹•å‘¨æ³¢æ•°ï¼ˆHzï¼‰
    wavenumber : float
        æ³¢æ•°ï¼ˆcm^-1ï¼‰
    """
    # æ›ç®—è³ªé‡
    mu = (m1 * m2) / (m1 + m2) * u  # kg

    # æŒ¯å‹•å‘¨æ³¢æ•°
    freq_Hz = (1 / (2 * np.pi)) * np.sqrt(k / mu)

    # æ³¢æ•°ã«å¤‰æ›
    wavenumber = freq_Hz / (c * 100)  # cm^-1

    return freq_Hz, wavenumber

def energy_levels(v_max, freq_Hz):
    """
    èª¿å’ŒæŒ¯å‹•å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½

    Parameters:
    -----------
    v_max : int
        æœ€å¤§æŒ¯å‹•é‡å­æ•°
    freq_Hz : float
        æŒ¯å‹•å‘¨æ³¢æ•°ï¼ˆHzï¼‰

    Returns:
    --------
    v : array
        æŒ¯å‹•é‡å­æ•°
    E : array
        ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰
    """
    v = np.arange(0, v_max + 1)
    E_J = h * freq_Hz * (v + 0.5)
    E_eV = E_J / 1.602176634e-19
    return v, E_eV

# å…¸å‹çš„ãªåŒ–å­¦çµåˆã®è¨ˆç®—
bonds = {
    'C-H': {'k': 500, 'm1': 12, 'm2': 1},
    'C=O': {'k': 1200, 'm1': 12, 'm2': 16},
    'C-C': {'k': 400, 'm1': 12, 'm2': 12},
    'O-H': {'k': 750, 'm1': 16, 'm2': 1}
}

print("=" * 70)
print("å…¸å‹çš„ãªåŒ–å­¦çµåˆã®æŒ¯å‹•å‘¨æ³¢æ•°")
print("=" * 70)
print(f"{'çµåˆ':<8} {'åŠ›ã®å®šæ•° (N/m)':<18} {'å‘¨æ³¢æ•° (Hz)':<18} {'æ³¢æ•° (cmâ»Â¹)':<15}")
print("-" * 70)

for bond, params in bonds.items():
    freq_Hz, wavenumber = vibrational_frequency(params['k'], params['m1'], params['m2'])
    print(f"{bond:<8} {params['k']:<18} {freq_Hz:.3e} {wavenumber:<15.1f}")

# C=Oä¼¸ç¸®æŒ¯å‹•ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½å›³
freq_Hz_CO, wn_CO = vibrational_frequency(1200, 12, 16)
v, E = energy_levels(5, freq_Hz_CO)

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½å›³
ax1.hlines(E, 0, 1, colors='#f093fb', linewidths=3)
for i, (vi, Ei) in enumerate(zip(v, E)):
    ax1.text(1.1, Ei, f'v={vi}', fontsize=11, va='center')
    if i < len(v) - 1:
        # é·ç§»ã®çŸ¢å°
        ax1.annotate('', xy=(0.5, E[i+1]), xytext=(0.5, E[i]),
                    arrowprops=dict(arrowstyle='->', color='red', lw=2))

ax1.set_xlim(-0.2, 1.5)
ax1.set_ylim(E[0] - 0.05, E[-1] + 0.1)
ax1.set_ylabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
ax1.set_title('C=Oä¼¸ç¸®æŒ¯å‹•ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½', fontsize=14, fontweight='bold')
ax1.set_xticks([])
ax1.grid(axis='y', alpha=0.3)

# åŒä½ä½“åŠ¹æœ
masses_C = np.array([12, 13, 14])
wavenumbers = []
for m_C in masses_C:
    _, wn = vibrational_frequency(1200, m_C, 16)
    wavenumbers.append(wn)

ax2.bar([f'$^{{{int(m)}}}$C=O' for m in masses_C], wavenumbers,
        color=['#f093fb', '#f5576c', '#4ecdc4'], alpha=0.7, edgecolor='black')
ax2.set_ylabel('æ³¢æ•° (cmâ»Â¹)', fontsize=12)
ax2.set_title('åŒä½ä½“åŠ¹æœï¼šC=Oä¼¸ç¸®æŒ¯å‹•', fontsize=14, fontweight='bold')
ax2.grid(axis='y', alpha=0.3)

for i, (m, wn) in enumerate(zip(masses_C, wavenumbers)):
    ax2.text(i, wn + 20, f'{wn:.0f}', ha='center', fontsize=11, fontweight='bold')

plt.tight_layout()
plt.savefig('vibrational_fundamentals.png', dpi=300, bbox_inches='tight')
plt.show()

print(f"\nC=Oä¼¸ç¸®æŒ¯å‹•ã®æ³¢æ•°: {wn_CO:.1f} cmâ»Â¹")
print(f"åŸºåº•çŠ¶æ…‹(v=0)ã®ã‚¼ãƒ­ç‚¹ã‚¨ãƒãƒ«ã‚®ãƒ¼: {E[0]:.4f} eV")
print(f"v=0 â†’ v=1 é·ç§»ã‚¨ãƒãƒ«ã‚®ãƒ¼: {E[1] - E[0]:.4f} eV")
</code></pre>
        </div>

        <h3>1.2 å¤šåŸå­åˆ†å­ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰</h3>

        <p>$N$ åŸå­ã‹ã‚‰ãªã‚‹åˆ†å­ã¯ $3N$ å€‹ã®è‡ªç”±åº¦ã‚’æŒã¡ã€ãã®ã†ã¡3ã¤ã¯ä¸¦é€²ã€ï¼ˆéç·šå½¢åˆ†å­ã§ã¯ï¼‰3ã¤ã¯å›è»¢ã€æ®‹ã‚Šã® $3N - 6$ï¼ˆç·šå½¢åˆ†å­ã§ã¯ $3N - 5$ï¼‰ãŒæŒ¯å‹•ã®è‡ªç”±åº¦ã§ã™ã€‚</p>

        <div class="mermaid">
        flowchart TD
            A[å…¨è‡ªç”±åº¦ 3N] --> B[ä¸¦é€² 3]
            A --> C[å›è»¢]
            A --> D[æŒ¯å‹•]

            C --> C1[éç·šå½¢åˆ†å­: 3]
            C --> C2[ç·šå½¢åˆ†å­: 2]

            D --> D1[éç·šå½¢: 3N-6]
            D --> D2[ç·šå½¢: 3N-5]

            D1 --> E[Hâ‚‚O: 3ãƒ¢ãƒ¼ãƒ‰<br/>COâ‚‚: 4ãƒ¢ãƒ¼ãƒ‰<br/>ãƒ™ãƒ³ã‚¼ãƒ³: 30ãƒ¢ãƒ¼ãƒ‰]

            style A fill:#f093fb,color:#fff
            style D fill:#f5576c,color:#fff
            style E fill:#a8e6cf,color:#000
        </flowchart>
        </div>

        <p>æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã¯<strong>ä¼¸ç¸®æŒ¯å‹•ï¼ˆstretchingï¼‰</strong>ã¨<strong>å¤‰è§’æŒ¯å‹•ï¼ˆbendingï¼‰</strong>ã«åˆ†é¡ã•ã‚Œã¾ã™ï¼š</p>

        <ul>
            <li><strong>ä¼¸ç¸®æŒ¯å‹•</strong>: å¯¾ç§°ä¼¸ç¸®ï¼ˆsymmetric stretch, Î½â‚›ï¼‰ã€éå¯¾ç§°ä¼¸ç¸®ï¼ˆasymmetric stretch, Î½â‚â‚›ï¼‰</li>
            <li><strong>å¤‰è§’æŒ¯å‹•</strong>: ã¯ã•ã¿æŒ¯å‹•ï¼ˆscissoring, Î´ï¼‰ã€æ¨ªæºã‚ŒæŒ¯å‹•ï¼ˆrocking, Ïï¼‰ã€ç¸¦æºã‚ŒæŒ¯å‹•ï¼ˆwagging, Ï‰ï¼‰ã€ã­ã˜ã‚ŒæŒ¯å‹•ï¼ˆtwisting, Ï„ï¼‰</li>
        </ul>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: Hâ‚‚Oåˆ†å­ã®3ã¤ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.animation import FuncAnimation
from IPython.display import HTML

def h2o_normal_modes():
    """
    H2Oåˆ†å­ã®3ã¤ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ï¼ˆå¯¾ç§°ä¼¸ç¸®ã€éå¯¾ç§°ä¼¸ç¸®ã€å¤‰è§’ï¼‰ã®å¯è¦–åŒ–

    Returns:
    --------
    fig : matplotlib figure
        æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®å›³
    """
    fig, axes = plt.subplots(1, 3, figsize=(15, 5))

    # å¹³è¡¡ä½ç½®ï¼ˆOåŸå­ã‚’åŸç‚¹ï¼‰
    O = np.array([0, 0])
    H1 = np.array([-0.76, 0.59])  # å·¦ã®H
    H2 = np.array([0.76, 0.59])   # å³ã®H

    modes = [
        {
            'name': 'å¯¾ç§°ä¼¸ç¸® (Î½â‚›)',
            'freq': '3657 cmâ»Â¹',
            'displacements': {
                'O': np.array([0, 0]),
                'H1': np.array([-0.1, 0.08]),
                'H2': np.array([0.1, 0.08])
            }
        },
        {
            'name': 'å¤‰è§’æŒ¯å‹• (Î´)',
            'freq': '1595 cmâ»Â¹',
            'displacements': {
                'O': np.array([0, 0]),
                'H1': np.array([-0.05, -0.1]),
                'H2': np.array([0.05, -0.1])
            }
        },
        {
            'name': 'éå¯¾ç§°ä¼¸ç¸® (Î½â‚â‚›)',
            'freq': '3756 cmâ»Â¹',
            'displacements': {
                'O': np.array([0, 0]),
                'H1': np.array([-0.1, 0.08]),
                'H2': np.array([0.1, -0.08])
            }
        }
    ]

    for ax, mode in zip(axes, modes):
        # å¹³è¡¡ä½ç½®
        ax.plot(*O, 'ro', markersize=15, label='O')
        ax.plot(*H1, 'bo', markersize=10, label='H')
        ax.plot(*H2, 'bo', markersize=10)
        ax.plot([O[0], H1[0]], [O[1], H1[1]], 'k-', linewidth=2)
        ax.plot([O[0], H2[0]], [O[1], H2[1]], 'k-', linewidth=2)

        # æŒ¯å‹•ã®å¤‰ä½ï¼ˆæ‹¡å¤§è¡¨ç¤ºï¼‰
        scale = 2
        O_disp = O + scale * mode['displacements']['O']
        H1_disp = H1 + scale * mode['displacements']['H1']
        H2_disp = H2 + scale * mode['displacements']['H2']

        ax.plot(*O_disp, 'ro', markersize=15, alpha=0.3)
        ax.plot(*H1_disp, 'bo', markersize=10, alpha=0.3)
        ax.plot(*H2_disp, 'bo', markersize=10, alpha=0.3)
        ax.plot([O_disp[0], H1_disp[0]], [O_disp[1], H1_disp[1]], 'k--', linewidth=2, alpha=0.3)
        ax.plot([O_disp[0], H2_disp[0]], [O_disp[1], H2_disp[1]], 'k--', linewidth=2, alpha=0.3)

        # å¤‰ä½ãƒ™ã‚¯ãƒˆãƒ«
        ax.arrow(*O, *mode['displacements']['O'], head_width=0.08, head_length=0.05, fc='red', ec='red')
        ax.arrow(*H1, *mode['displacements']['H1'], head_width=0.08, head_length=0.05, fc='blue', ec='blue')
        ax.arrow(*H2, *mode['displacements']['H2'], head_width=0.08, head_length=0.05, fc='blue', ec='blue')

        ax.set_xlim(-1.2, 1.2)
        ax.set_ylim(-0.5, 1)
        ax.set_aspect('equal')
        ax.set_title(f"{mode['name']}\n{mode['freq']}", fontsize=12, fontweight='bold')
        ax.axis('off')

    plt.tight_layout()
    plt.savefig('h2o_normal_modes.png', dpi=300, bbox_inches='tight')
    plt.show()

    return fig

# å®Ÿè¡Œ
fig = h2o_normal_modes()

# æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®ç‰¹å¾´
print("=" * 60)
print("Hâ‚‚Oåˆ†å­ã®3ã¤ã®åŸºæœ¬æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰")
print("=" * 60)
print("1. å¯¾ç§°ä¼¸ç¸® (Î½â‚›): 3657 cmâ»Â¹")
print("   - ä¸¡æ–¹ã®O-HçµåˆãŒåŒæ™‚ã«ä¼¸ç¸®")
print("   - IRã§å¼·ã„å¸åï¼ˆåŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆå¤‰åŒ–å¤§ï¼‰")
print("")
print("2. å¤‰è§’æŒ¯å‹• (Î´): 1595 cmâ»Â¹")
print("   - H-O-Hè§’ãŒå¤‰åŒ–")
print("   - æœ€ã‚‚ä½ã„æŒ¯å‹•æ•°ï¼ˆå¼±ã„åŠ›ã®å®šæ•°ï¼‰")
print("")
print("3. éå¯¾ç§°ä¼¸ç¸® (Î½â‚â‚›): 3756 cmâ»Â¹")
print("   - ä¸€æ–¹ã®O-HãŒä¼¸ã³ã‚‹ã¨ãã€ä»–æ–¹ã¯ç¸®ã‚€")
print("   - IRã§æœ€ã‚‚å¼·ã„å¸å")
</code></pre>
        </div>

        <h2>2. èµ¤å¤–åˆ†å…‰æ³•ï¼ˆIRï¼‰</h2>

        <h3>2.1 IRå¸åã®é¸æŠå‰‡</h3>

        <p>IRã§æŒ¯å‹•ãŒæ´»æ€§ï¼ˆIR activeï¼‰ã§ã‚ã‚‹ãŸã‚ã«ã¯ã€æŒ¯å‹•ã«ä¼´ã£ã¦<strong>åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ $\boldsymbol{\mu}$ ãŒå¤‰åŒ–</strong>ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š</p>

        <p>$$\left(\frac{\partial \boldsymbol{\mu}}{\partial Q}\right)_0 \neq 0$$</p>

        <p>ã“ã“ã§ã€$Q$ ã¯æŒ¯å‹•ã®è¦æº–åº§æ¨™ã§ã™ã€‚å¯¾ç§°åˆ†å­ï¼ˆCOâ‚‚ãªã©ï¼‰ã®å¯¾ç§°ä¼¸ç¸®æŒ¯å‹•ã¯IRä¸æ´»æ€§ã§ã™ãŒã€éå¯¾ç§°ä¼¸ç¸®ã‚„å¤‰è§’æŒ¯å‹•ã¯IRæ´»æ€§ã§ã™ã€‚</p>

        <h3>2.2 å®˜èƒ½åŸºã¨ç‰¹æ€§å¸å</h3>

        <p>æœ‰æ©ŸåŒ–åˆç‰©ã®å®˜èƒ½åŸºã¯ç‰¹å®šã®æ³¢æ•°é ˜åŸŸã«ç‰¹æ€§å¸åã‚’ç¤ºã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€IRã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰åˆ†å­æ§‹é€ ã‚’æ¨å®šã§ãã¾ã™ã€‚</p>

        <table>
            <tr>
                <th>å®˜èƒ½åŸº</th>
                <th>æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰</th>
                <th>æ³¢æ•°ï¼ˆcmâ»Â¹ï¼‰</th>
                <th>å¼·åº¦</th>
            </tr>
            <tr>
                <td>O-Hï¼ˆã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ï¼‰</td>
                <td>ä¼¸ç¸®</td>
                <td>3200-3600</td>
                <td>å¼·ã€å¹…åºƒ</td>
            </tr>
            <tr>
                <td>N-H</td>
                <td>ä¼¸ç¸®</td>
                <td>3300-3500</td>
                <td>ä¸­</td>
            </tr>
            <tr>
                <td>C-Hï¼ˆè„‚è‚ªæ—ï¼‰</td>
                <td>ä¼¸ç¸®</td>
                <td>2850-2960</td>
                <td>å¼·</td>
            </tr>
            <tr>
                <td>Câ‰¡N</td>
                <td>ä¼¸ç¸®</td>
                <td>2210-2260</td>
                <td>ä¸­</td>
            </tr>
            <tr>
                <td>C=Oï¼ˆã‚«ãƒ«ãƒœãƒ‹ãƒ«ï¼‰</td>
                <td>ä¼¸ç¸®</td>
                <td>1650-1750</td>
                <td>éå¸¸ã«å¼·</td>
            </tr>
            <tr>
                <td>C=C</td>
                <td>ä¼¸ç¸®</td>
                <td>1620-1680</td>
                <td>å¼±ã€œä¸­</td>
            </tr>
            <tr>
                <td>C-O</td>
                <td>ä¼¸ç¸®</td>
                <td>1000-1300</td>
                <td>å¼·</td>
            </tr>
            <tr>
                <td>èŠ³é¦™ç’°</td>
                <td>é¢å¤–å¤‰è§’</td>
                <td>690-900</td>
                <td>å¼·</td>
            </tr>
        </table>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: IRã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã‚¨ã‚¿ãƒãƒ¼ãƒ«ï¼‰</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def lorentzian_peak(x, center, intensity, width):
    """Lorentzianç·šå½¢é–¢æ•°"""
    return intensity * (width**2 / ((x - center)**2 + width**2))

def simulate_ir_spectrum(peaks, x_range=(4000, 400)):
    """
    IRã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    peaks : list of dict
        å„ãƒ”ãƒ¼ã‚¯ã®æƒ…å ± [{'center': cm-1, 'intensity': 0-1, 'width': cm-1, 'label': str}, ...]
    x_range : tuple
        æ³¢æ•°ç¯„å›²ï¼ˆcmâ»Â¹ï¼‰

    Returns:
    --------
    wavenumbers : array
        æ³¢æ•°è»¸
    transmittance : array
        é€éç‡ï¼ˆ%ï¼‰
    """
    wavenumbers = np.linspace(x_range[0], x_range[1], 2000)
    absorbance = np.zeros_like(wavenumbers)

    for peak in peaks:
        absorbance += lorentzian_peak(wavenumbers, peak['center'],
                                       peak['intensity'], peak['width'])

    transmittance = 100 * np.exp(-absorbance)
    return wavenumbers, transmittance, peaks

# ã‚¨ã‚¿ãƒãƒ¼ãƒ« (CHâ‚ƒCHâ‚‚OH) ã®IRã‚¹ãƒšã‚¯ãƒˆãƒ«
ethanol_peaks = [
    {'center': 3350, 'intensity': 1.5, 'width': 100, 'label': 'O-Hä¼¸ç¸®'},
    {'center': 2970, 'intensity': 0.8, 'width': 20, 'label': 'C-Hä¼¸ç¸®ï¼ˆCHâ‚ƒï¼‰'},
    {'center': 2930, 'intensity': 0.7, 'width': 20, 'label': 'C-Hä¼¸ç¸®ï¼ˆCHâ‚‚ï¼‰'},
    {'center': 1450, 'intensity': 0.4, 'width': 30, 'label': 'C-Hå¤‰è§’'},
    {'center': 1380, 'intensity': 0.3, 'width': 20, 'label': 'C-Hå¤‰è§’'},
    {'center': 1050, 'intensity': 1.0, 'width': 40, 'label': 'C-Oä¼¸ç¸®'},
    {'center': 880, 'intensity': 0.5, 'width': 25, 'label': 'C-Cä¼¸ç¸®'},
]

wavenumbers, transmittance, peaks = simulate_ir_spectrum(ethanol_peaks)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, ax = plt.subplots(figsize=(12, 6))

ax.plot(wavenumbers, transmittance, linewidth=1.5, color='#f093fb')
ax.fill_between(wavenumbers, transmittance, 100, alpha=0.2, color='#f5576c')

# ãƒ”ãƒ¼ã‚¯ã®ãƒ©ãƒ™ãƒ«
for peak in peaks:
    idx = np.argmin(np.abs(wavenumbers - peak['center']))
    y_pos = transmittance[idx]
    if y_pos < 50:
        ax.annotate(peak['label'], xy=(peak['center'], y_pos),
                   xytext=(peak['center'], y_pos - 15),
                   fontsize=9, ha='center', rotation=90,
                   arrowprops=dict(arrowstyle='->', color='black', lw=0.8))

ax.set_xlabel('æ³¢æ•° (cmâ»Â¹)', fontsize=12)
ax.set_ylabel('é€éç‡ (%)', fontsize=12)
ax.set_title('ã‚¨ã‚¿ãƒãƒ¼ãƒ« (CHâ‚ƒCHâ‚‚OH) ã®IRã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰',
             fontsize=14, fontweight='bold')
ax.set_xlim(4000, 400)
ax.set_ylim(0, 105)
ax.invert_xaxis()  # IRã‚¹ãƒšã‚¯ãƒˆãƒ«ã¯é€šå¸¸é«˜æ³¢æ•°å´ãŒå·¦
ax.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('ethanol_ir_spectrum.png', dpi=300, bbox_inches='tight')
plt.show()

# ãƒ”ãƒ¼ã‚¯å¸°å±è¡¨
print("=" * 70)
print("ã‚¨ã‚¿ãƒãƒ¼ãƒ«ã®IRã‚¹ãƒšã‚¯ãƒˆãƒ«å¸°å±")
print("=" * 70)
print(f"{'æ³¢æ•° (cmâ»Â¹)':<15} {'å¼·åº¦':<10} {'å¸°å±':<30}")
print("-" * 70)
for peak in sorted(peaks, key=lambda x: x['center'], reverse=True):
    intensity_str = 'å¼·' if peak['intensity'] > 1.0 else ('ä¸­' if peak['intensity'] > 0.5 else 'å¼±')
    print(f"{peak['center']:<15} {intensity_str:<10} {peak['label']:<30}")
</code></pre>
        </div>

        <h3>2.3 FTIRï¼ˆãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›èµ¤å¤–åˆ†å…‰æ³•ï¼‰</h3>

        <p>ç¾ä»£ã®IRåˆ†å…‰è¨ˆã¯ãƒã‚¤ã‚±ãƒ«ã‚½ãƒ³å¹²æ¸‰è¨ˆã‚’ç”¨ã„ãŸFTIRï¼ˆFourier Transform Infrared Spectroscopyï¼‰ãŒä¸»æµã§ã™ã€‚å¹²æ¸‰è¨ˆã§å¾—ã‚‰ã‚ŒãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ï¼ˆæ™‚é–“é ˜åŸŸä¿¡å·ï¼‰ã‚’ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã—ã¦å‘¨æ³¢æ•°é ˜åŸŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’å¾—ã¾ã™ã€‚</p>

        <div class="info-box">
            <strong>FTIRã®åˆ©ç‚¹</strong>
            <ul>
                <li><strong>é«˜é€Ÿæ¸¬å®š</strong>: å…¨æ³¢æ•°ã‚’åŒæ™‚æ¸¬å®šï¼ˆFellgettã®åˆ©ç‚¹ï¼‰</li>
                <li><strong>é«˜æ„Ÿåº¦</strong>: å…‰ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®åˆ©ç”¨åŠ¹ç‡ãŒé«˜ã„ï¼ˆJacquinotã®åˆ©ç‚¹ï¼‰</li>
                <li><strong>é«˜æ³¢æ•°ç²¾åº¦</strong>: He-Neãƒ¬ãƒ¼ã‚¶ãƒ¼ã«ã‚ˆã‚‹å†…éƒ¨æ ¡æ­£</li>
                <li><strong>å¤šæ•°å›ç©ç®—</strong>: S/Næ¯”å‘ä¸Š</li>
            </ul>
        </div>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: FTIRã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ã¨ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.fft import fft, fftfreq

def generate_interferogram(wavenumbers_cm, intensities, mirror_displacement_max=0.05):
    """
    IRã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ã‚’ç”Ÿæˆï¼ˆç°¡ç•¥åŒ–ç‰ˆï¼‰

    Parameters:
    -----------
    wavenumbers_cm : array
        æ³¢æ•°ï¼ˆcmâ»Â¹ï¼‰
    intensities : array
        å„æ³¢æ•°ã®å¼·åº¦
    mirror_displacement_max : float
        ãƒŸãƒ©ãƒ¼ç§»å‹•è·é›¢ã®æœ€å¤§å€¤ï¼ˆcmï¼‰

    Returns:
    --------
    displacement : array
        ãƒŸãƒ©ãƒ¼å¤‰ä½
    interferogram : array
        ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ 
    """
    # ãƒŸãƒ©ãƒ¼å¤‰ä½
    n_points = 2048
    displacement = np.linspace(-mirror_displacement_max, mirror_displacement_max, n_points)

    # ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ï¼ˆå„æ³¢æ•°æˆåˆ†ã®å¹²æ¸‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã®å’Œï¼‰
    interferogram = np.zeros_like(displacement)
    for wn, intensity in zip(wavenumbers_cm, intensities):
        # æ³¢æ•°ã‚’cm^-1ã‹ã‚‰cmå˜ä½ã®æ³¢é•·ã«å¤‰æ›
        # cos(2Ï€ * wavenumber * displacement)
        interferogram += intensity * np.cos(2 * np.pi * wn * displacement)

    # DCæˆåˆ†è¿½åŠ 
    interferogram += np.sum(intensities)

    return displacement, interferogram

def fourier_transform_spectrum(displacement, interferogram):
    """
    ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ã‚’ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã—ã¦ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’å¾©å…ƒ

    Parameters:
    -----------
    displacement : array
        ãƒŸãƒ©ãƒ¼å¤‰ä½ï¼ˆcmï¼‰
    interferogram : array
        ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ 

    Returns:
    --------
    wavenumbers : array
        æ³¢æ•°ï¼ˆcmâ»Â¹ï¼‰
    spectrum : array
        å¾©å…ƒã•ã‚ŒãŸã‚¹ãƒšã‚¯ãƒˆãƒ«
    """
    # ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›
    N = len(interferogram)
    spectrum_complex = fft(interferogram)
    spectrum = np.abs(spectrum_complex[:N//2])

    # æ³¢æ•°è»¸ï¼ˆcmâ»Â¹ï¼‰
    delta_x = displacement[1] - displacement[0]
    wavenumbers = fftfreq(N, delta_x)[:N//2]

    return wavenumbers, spectrum

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼š3ã¤ã®IRãƒ”ãƒ¼ã‚¯
true_wavenumbers = np.array([1000, 1700, 2900])  # cm^-1
true_intensities = np.array([0.5, 1.0, 0.7])

# ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ç”Ÿæˆ
displacement, interferogram = generate_interferogram(true_wavenumbers, true_intensities)

# ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§ã‚¹ãƒšã‚¯ãƒˆãƒ«å¾©å…ƒ
wavenumbers_ft, spectrum_ft = fourier_transform_spectrum(displacement, interferogram)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

# ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ 
ax1.plot(displacement, interferogram, linewidth=1.5, color='#f093fb')
ax1.set_xlabel('ãƒŸãƒ©ãƒ¼å¤‰ä½ (cm)', fontsize=12)
ax1.set_ylabel('ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ å¼·åº¦', fontsize=12)
ax1.set_title('FTIRã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ï¼ˆæ™‚é–“é ˜åŸŸï¼‰', fontsize=14, fontweight='bold')
ax1.grid(True, alpha=0.3)
ax1.axvline(x=0, color='red', linestyle='--', linewidth=2, alpha=0.5, label='Zero Path Difference')
ax1.legend()

# ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›å¾Œã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
ax2.plot(wavenumbers_ft, spectrum_ft, linewidth=1.5, color='#f5576c')
ax2.set_xlabel('æ³¢æ•° (cmâ»Â¹)', fontsize=12)
ax2.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax2.set_title('ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›å¾Œã®IRã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆå‘¨æ³¢æ•°é ˜åŸŸï¼‰', fontsize=14, fontweight='bold')
ax2.set_xlim(0, 4000)
ax2.grid(True, alpha=0.3)

# çœŸã®ãƒ”ãƒ¼ã‚¯ä½ç½®ã‚’ãƒãƒ¼ã‚¯
for wn, intensity in zip(true_wavenumbers, true_intensities):
    ax2.axvline(x=wn, color='green', linestyle='--', alpha=0.7, linewidth=1.5)
    ax2.text(wn, max(spectrum_ft) * 0.9, f'{wn} cmâ»Â¹',
            rotation=90, va='bottom', fontsize=10, color='green')

plt.tight_layout()
plt.savefig('ftir_interferogram.png', dpi=300, bbox_inches='tight')
plt.show()

print("=" * 60)
print("FTIRæ¸¬å®šã®åŸç†")
print("=" * 60)
print("1. ãƒã‚¤ã‚±ãƒ«ã‚½ãƒ³å¹²æ¸‰è¨ˆã§ãƒŸãƒ©ãƒ¼ã‚’ç§»å‹•")
print("2. å¹²æ¸‰ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ï¼‰ã‚’è¨˜éŒ²")
print("3. ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§å‘¨æ³¢æ•°é ˜åŸŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’å¾©å…ƒ")
print("")
print("çœŸã®ãƒ”ãƒ¼ã‚¯ä½ç½®: ", true_wavenumbers, " cmâ»Â¹")
print("å¾©å…ƒã•ã‚ŒãŸãƒ”ãƒ¼ã‚¯: ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›å¾Œã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã§ç¢ºèª")
</code></pre>
        </div>

        <h2>3. ãƒ©ãƒãƒ³åˆ†å…‰æ³•</h2>

        <h3>3.1 Ramanæ•£ä¹±ã®åŸç†</h3>

        <p>Ramanæ•£ä¹±ã¯ã€å…‰ã¨åˆ†å­ã®ç›¸äº’ä½œç”¨ã«ã‚ˆã‚Šã€å…¥å°„å…‰ï¼ˆå‘¨æ³¢æ•° $\nu_0$ï¼‰ãŒåˆ†å­ã®æŒ¯å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆå‘¨æ³¢æ•° $\nu_m$ï¼‰ã ã‘ã‚·ãƒ•ãƒˆã—ãŸæ•£ä¹±å…‰ã¨ã—ã¦è¦³æ¸¬ã•ã‚Œã‚‹ç¾è±¡ã§ã™ï¼š</p>

        <ul>
            <li><strong>Rayleighæ•£ä¹±</strong>ï¼ˆå¼¾æ€§æ•£ä¹±ï¼‰: $\nu_{\text{scatter}} = \nu_0$ï¼ˆå¤§å¤šæ•°ã€10<sup>6</sup>å€å¼·ã„ï¼‰</li>
            <li><strong>Stokes Ramanæ•£ä¹±</strong>: $\nu_{\text{scatter}} = \nu_0 - \nu_m$ï¼ˆåˆ†å­ãŒåŠ±èµ·ï¼‰</li>
            <li><strong>Anti-Stokes Ramanæ•£ä¹±</strong>: $\nu_{\text{scatter}} = \nu_0 + \nu_m$ï¼ˆæ—¢ã«åŠ±èµ·çŠ¶æ…‹ã«ã‚ã‚‹åˆ†å­ãŒåŸºåº•çŠ¶æ…‹ã¸ã€å¼±ã„ï¼‰</li>
        </ul>

        <p>Ramanæ•£ä¹±ã®é¸æŠå‰‡ã¯ã€æŒ¯å‹•ã«ä¼´ã£ã¦<strong>åˆ†æ¥µç‡ $\alpha$ ãŒå¤‰åŒ–</strong>ã™ã‚‹ã“ã¨ã§ã™ï¼š</p>

        <p>$$\left(\frac{\partial \alpha}{\partial Q}\right)_0 \neq 0$$</p>

        <p>ã“ã®é¸æŠå‰‡ã¯IRã¨ã¯ç•°ãªã‚Šã€å¯¾ç§°æŒ¯å‹•ãŒRamanæ´»æ€§ã€éå¯¾ç§°æŒ¯å‹•ãŒRamanä¸æ´»æ€§ã¨ãªã‚‹å ´åˆãŒå¤šã„ã§ã™ï¼ˆç›¸è£œå‰‡ï¼‰ã€‚</p>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨Stokes/Anti-Stokesã®æ¯”</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def boltzmann_population(E_vib_cm, T=300):
    """
    Boltzmannåˆ†å¸ƒã«ã‚ˆã‚‹æŒ¯å‹•åŠ±èµ·çŠ¶æ…‹ã®å æœ‰ç‡

    Parameters:
    -----------
    E_vib_cm : float
        æŒ¯å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆcmâ»Â¹ï¼‰
    T : float
        æ¸©åº¦ï¼ˆKï¼‰

    Returns:
    --------
    ratio : float
        v=1ã¨v=0ã®å æœ‰ç‡æ¯” nâ‚/nâ‚€
    """
    k_B = 1.380649e-23  # J/K
    h = 6.62607015e-34  # JÂ·s
    c = 2.99792458e8    # m/s

    E_J = h * c * E_vib_cm * 100  # cm^-1 to J
    ratio = np.exp(-E_J / (k_B * T))
    return ratio

def raman_spectrum_simulation(laser_wavelength=532):
    """
    Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆStokes/Anti-Stokesï¼‰ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    laser_wavelength : float
        åŠ±èµ·ãƒ¬ãƒ¼ã‚¶ãƒ¼æ³¢é•·ï¼ˆnmï¼‰

    Returns:
    --------
    fig : matplotlib figure
    """
    # æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰
    vibrations = [
        {'mode': 'C-Cä¼¸ç¸®', 'shift': 1000, 'intensity': 0.8},
        {'mode': 'C=Oä¼¸ç¸®', 'shift': 1700, 'intensity': 1.0},
        {'mode': 'C-Hä¼¸ç¸®', 'shift': 2900, 'intensity': 0.6}
    ]

    # ãƒ¬ãƒ¼ã‚¶ãƒ¼å‘¨æ³¢æ•°
    laser_freq = 1e7 / laser_wavelength  # cm^-1

    # Raman shiftè»¸ï¼ˆé€šå¸¸ã¯-3500 ~ +3500 cm^-1ï¼‰
    raman_shift = np.linspace(-3500, 3500, 3000)

    # ã‚¹ãƒšã‚¯ãƒˆãƒ«åˆæœŸåŒ–
    spectrum = np.zeros_like(raman_shift)

    # å„æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®ãƒ”ãƒ¼ã‚¯
    for vib in vibrations:
        shift = vib['shift']
        intensity = vib['intensity']

        # Stokesãƒ”ãƒ¼ã‚¯ï¼ˆæ­£ã®ã‚·ãƒ•ãƒˆï¼‰
        stokes = intensity * np.exp(-(raman_shift - shift)**2 / (2 * 30**2))
        spectrum += stokes

        # Anti-Stokesãƒ”ãƒ¼ã‚¯ï¼ˆè² ã®ã‚·ãƒ•ãƒˆï¼‰
        # Boltzmannå› å­ã§å¼·åº¦ãŒæ¸›å°‘
        boltzmann_ratio = boltzmann_population(shift, T=300)
        anti_stokes = intensity * boltzmann_ratio * np.exp(-(raman_shift + shift)**2 / (2 * 30**2))
        spectrum += anti_stokes

    # Rayleighæ•£ä¹±ï¼ˆä¸­å¿ƒã€éå¸¸ã«å¼·ã„ï¼‰
    rayleigh = 100 * np.exp(-(raman_shift)**2 / (2 * 20**2))

    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

    # å…¨ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆRayleighå«ã‚€ï¼‰
    ax1.plot(raman_shift, spectrum + rayleigh, linewidth=1.5, color='#f093fb')
    ax1.fill_between(raman_shift, spectrum + rayleigh, alpha=0.3, color='#f5576c')
    ax1.axvline(x=0, color='red', linestyle='--', linewidth=2, label='Rayleighæ•£ä¹±')
    ax1.set_xlabel('Raman Shift (cmâ»Â¹)', fontsize=12)
    ax1.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
    ax1.set_title(f'Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«å…¨ä½“ï¼ˆãƒ¬ãƒ¼ã‚¶ãƒ¼: {laser_wavelength} nmï¼‰',
                 fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(True, alpha=0.3)
    ax1.set_yscale('log')
    ax1.set_ylim(0.01, 150)

    # Stokesé ˜åŸŸã®æ‹¡å¤§ï¼ˆå®Ÿç”¨çš„ãªæ¸¬å®šç¯„å›²ï¼‰
    ax2.plot(raman_shift, spectrum, linewidth=1.5, color='#f5576c')
    ax2.fill_between(raman_shift, spectrum, alpha=0.3, color='#f093fb')
    ax2.set_xlabel('Raman Shift (cmâ»Â¹)', fontsize=12)
    ax2.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
    ax2.set_title('Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆRayleighé™¤å»å¾Œï¼‰', fontsize=14, fontweight='bold')
    ax2.axvline(x=0, color='gray', linestyle='--', alpha=0.5)
    ax2.grid(True, alpha=0.3)

    # ãƒ”ãƒ¼ã‚¯å¸°å±
    for vib in vibrations:
        shift = vib['shift']
        ax2.text(shift, vib['intensity'] * 1.1, vib['mode'],
                ha='center', fontsize=10, rotation=45)
        ax2.text(-shift, vib['intensity'] * boltzmann_population(shift) * 1.1,
                vib['mode'] + '\n(Anti-Stokes)',
                ha='center', fontsize=9, rotation=45, alpha=0.7)

    plt.tight_layout()
    plt.savefig('raman_spectrum_stokes_antistokes.png', dpi=300, bbox_inches='tight')
    plt.show()

    # Boltzmannæ¯”ã®æ¸©åº¦ä¾å­˜æ€§
    print("=" * 70)
    print("Stokes/Anti-Stokeså¼·åº¦æ¯”ã®æ¸©åº¦ä¾å­˜æ€§")
    print("=" * 70)
    print(f"{'æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰':<20} {'Raman shift (cmâ»Â¹)':<25} {'I(Anti-Stokes)/I(Stokes) at 300K':<30}")
    print("-" * 70)
    for vib in vibrations:
        ratio = boltzmann_population(vib['shift'], T=300)
        print(f"{vib['mode']:<20} {vib['shift']:<25} {ratio:<30.4f}")

    return fig

# å®Ÿè¡Œ
fig = raman_spectrum_simulation(laser_wavelength=532)

# æ¸©åº¦ä¾å­˜æ€§ã®è¨ˆç®—
temperatures = np.linspace(100, 800, 50)
raman_shift_1000 = 1000  # cm^-1

ratios = [boltzmann_population(raman_shift_1000, T) for T in temperatures]

plt.figure(figsize=(10, 6))
plt.plot(temperatures, ratios, linewidth=2, color='#f093fb')
plt.xlabel('æ¸©åº¦ (K)', fontsize=12)
plt.ylabel('I(Anti-Stokes) / I(Stokes)', fontsize=12)
plt.title('Ramanå¼·åº¦æ¯”ã®æ¸©åº¦ä¾å­˜æ€§ï¼ˆ1000 cmâ»Â¹ãƒ¢ãƒ¼ãƒ‰ï¼‰', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.axhline(y=boltzmann_population(1000, 300), color='red', linestyle='--',
           label='å®¤æ¸© (300 K)')
plt.legend()
plt.tight_layout()
plt.savefig('raman_temperature_dependence.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>
        </div>

        <h3>3.2 IRã¨Ramanã®ç›¸è£œå‰‡</h3>

        <p>ä¸­å¿ƒå¯¾ç§°åˆ†å­ï¼ˆä¾‹: COâ‚‚ã€ãƒ™ãƒ³ã‚¼ãƒ³ï¼‰ã§ã¯ã€IRã¨Ramanã®é¸æŠå‰‡ãŒç›¸è£œçš„ã§ã™ï¼š</p>

        <div class="info-box">
            <strong>ç›¸äº’æ’ä»–å‰‡ï¼ˆMutual Exclusion Ruleï¼‰</strong><br>
            ä¸­å¿ƒå¯¾ç§°åˆ†å­ã«ãŠã„ã¦ã€IRæ´»æ€§ãªæŒ¯å‹•ã¯Ramanä¸æ´»æ€§ã€Ramanæ´»æ€§ãªæŒ¯å‹•ã¯IRä¸æ´»æ€§ã¨ãªã‚Šã¾ã™ã€‚ã“ã‚Œã¯å¯¾ç§°æ€§ã«ã‚ˆã‚‹é¸æŠå‰‡ã®é•ã„ã‹ã‚‰ç”Ÿã˜ã¾ã™ã€‚
        </div>

        <table>
            <tr>
                <th>æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰</th>
                <th>å¯¾ç§°æ€§</th>
                <th>IRæ´»æ€§</th>
                <th>Ramanæ´»æ€§</th>
            </tr>
            <tr>
                <td>COâ‚‚å¯¾ç§°ä¼¸ç¸®</td>
                <td>Î£<sub>g</sub>âº</td>
                <td>ä¸æ´»æ€§</td>
                <td>æ´»æ€§</td>
            </tr>
            <tr>
                <td>COâ‚‚éå¯¾ç§°ä¼¸ç¸®</td>
                <td>Î£<sub>u</sub>âº</td>
                <td>æ´»æ€§</td>
                <td>ä¸æ´»æ€§</td>
            </tr>
            <tr>
                <td>COâ‚‚å¤‰è§’æŒ¯å‹•</td>
                <td>Î <sub>u</sub></td>
                <td>æ´»æ€§</td>
                <td>ä¸æ´»æ€§</td>
            </tr>
        </table>

        <h3>3.3 Ramanåˆ†å…‰ã®å¿œç”¨</h3>

        <ul>
            <li><strong>çµæ™¶æ€§è©•ä¾¡</strong>: ä½æ³¢æ•°é ˜åŸŸï¼ˆ<200 cmâ»Â¹ï¼‰ã®æ ¼å­æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã‹ã‚‰çµæ™¶åŒ–åº¦ã‚’è©•ä¾¡</li>
            <li><strong>æ°´æº¶æ¶²è©¦æ–™</strong>: æ°´ã®IRå¸åãŒå¼·ã„ãŒã€Ramanã§ã¯æ°´ã®å½±éŸ¿ãŒå°‘ãªã„</li>
            <li><strong>éæ¥è§¦ãƒ»éç ´å£Šæ¸¬å®š</strong>: ãƒ¬ãƒ¼ã‚¶ãƒ¼ã‚’é›†å…‰ã—ã¦å¾®å°é ˜åŸŸæ¸¬å®šï¼ˆãƒ©ãƒãƒ³é¡•å¾®é¡ï¼‰</li>
            <li><strong>è¡¨é¢å¢—å¼·Ramanï¼ˆSERSï¼‰</strong>: é‡‘å±ãƒŠãƒç²’å­è¡¨é¢ã§10<sup>6</sup>ã€œ10<sup>14</sup>å€ã®å¢—å¼·</li>
        </ul>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: çµæ™¶æ€§è©•ä¾¡ã®ãŸã‚ã®Ramanãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def crystallinity_analysis(raman_shift, intensity):
    """
    Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰çµæ™¶åŒ–åº¦ã‚’è©•ä¾¡ï¼ˆãƒãƒªãƒãƒ¼ã®ä¾‹ï¼‰

    Parameters:
    -----------
    raman_shift : array
        Raman shiftï¼ˆcmâ»Â¹ï¼‰
    intensity : array
        Ramanå¼·åº¦

    Returns:
    --------
    crystallinity : float
        çµæ™¶åŒ–åº¦ï¼ˆ%ï¼‰
    fit_params : dict
        ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    """
    def two_peak_model(x, A1, c1, w1, A2, c2, w2):
        """çµæ™¶ãƒ”ãƒ¼ã‚¯ã¨éæ™¶ãƒ”ãƒ¼ã‚¯ã®2æˆåˆ†ãƒ¢ãƒ‡ãƒ«"""
        peak1 = A1 * np.exp(-(x - c1)**2 / (2 * w1**2))  # çµæ™¶ãƒ”ãƒ¼ã‚¯
        peak2 = A2 * np.exp(-(x - c2)**2 / (2 * w2**2))  # éæ™¶ãƒ”ãƒ¼ã‚¯
        return peak1 + peak2

    # åˆæœŸæ¨å®šå€¤
    p0 = [100, 1095, 10, 80, 1080, 15]

    # ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
    popt, pcov = curve_fit(two_peak_model, raman_shift, intensity, p0=p0)

    # å€‹åˆ¥ãƒ”ãƒ¼ã‚¯
    crystal_peak = popt[0] * np.exp(-(raman_shift - popt[1])**2 / (2 * popt[2]**2))
    amorphous_peak = popt[3] * np.exp(-(raman_shift - popt[4])**2 / (2 * popt[5]**2))

    # çµæ™¶åŒ–åº¦ï¼ˆãƒ”ãƒ¼ã‚¯é¢ç©æ¯”ï¼‰
    crystal_area = popt[0] * popt[2] * np.sqrt(2 * np.pi)
    amorphous_area = popt[3] * popt[5] * np.sqrt(2 * np.pi)
    crystallinity = crystal_area / (crystal_area + amorphous_area) * 100

    fit_params = {
        'crystal_center': popt[1],
        'crystal_width': popt[2],
        'amorphous_center': popt[4],
        'amorphous_width': popt[5],
        'crystal_peak': crystal_peak,
        'amorphous_peak': amorphous_peak,
        'fitted_curve': two_peak_model(raman_shift, *popt)
    }

    return crystallinity, fit_params

# åˆæˆãƒ‡ãƒ¼ã‚¿ï¼ˆåŠçµæ™¶æ€§ãƒãƒªãƒãƒ¼ã®C-Cä¼¸ç¸®é ˜åŸŸï¼‰
raman_shift = np.linspace(1050, 1130, 300)
crystal_peak_true = 70 * np.exp(-(raman_shift - 1095)**2 / (2 * 8**2))
amorphous_peak_true = 50 * np.exp(-(raman_shift - 1080)**2 / (2 * 12**2))
intensity = crystal_peak_true + amorphous_peak_true + np.random.normal(0, 2, len(raman_shift))

# çµæ™¶åŒ–åº¦è§£æ
crystallinity, fit_params = crystallinity_analysis(raman_shift, intensity)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# ãƒ”ãƒ¼ã‚¯åˆ†é›¢
ax1.plot(raman_shift, intensity, 'k.', markersize=4, alpha=0.5, label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')
ax1.plot(raman_shift, fit_params['fitted_curve'], 'r-', linewidth=2, label='ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°')
ax1.plot(raman_shift, fit_params['crystal_peak'], 'b--', linewidth=2, label='çµæ™¶æˆåˆ†')
ax1.plot(raman_shift, fit_params['amorphous_peak'], 'g--', linewidth=2, label='éæ™¶æˆåˆ†')
ax1.fill_between(raman_shift, fit_params['crystal_peak'], alpha=0.3, color='blue')
ax1.fill_between(raman_shift, fit_params['amorphous_peak'], alpha=0.3, color='green')
ax1.set_xlabel('Raman Shift (cmâ»Â¹)', fontsize=12)
ax1.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax1.set_title('ãƒ”ãƒ¼ã‚¯åˆ†é›¢ã«ã‚ˆã‚‹çµæ™¶åŒ–åº¦è§£æ', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)

# çµæ™¶åŒ–åº¦ã®è¡¨ç¤º
ax2.bar(['çµæ™¶æˆåˆ†', 'éæ™¶æˆåˆ†'],
       [crystallinity, 100 - crystallinity],
       color=['#4ecdc4', '#ffe66d'], edgecolor='black', linewidth=2)
ax2.set_ylabel('å‰²åˆ (%)', fontsize=12)
ax2.set_title(f'çµæ™¶åŒ–åº¦: {crystallinity:.1f}%', fontsize=14, fontweight='bold')
ax2.set_ylim(0, 100)
ax2.grid(axis='y', alpha=0.3)

for i, (label, value) in enumerate(zip(['çµæ™¶æˆåˆ†', 'éæ™¶æˆåˆ†'],
                                        [crystallinity, 100 - crystallinity])):
    ax2.text(i, value + 3, f'{value:.1f}%', ha='center', fontsize=12, fontweight='bold')

plt.tight_layout()
plt.savefig('raman_crystallinity_analysis.png', dpi=300, bbox_inches='tight')
plt.show()

# çµæœã®å‡ºåŠ›
print("=" * 60)
print("Ramançµæ™¶åŒ–åº¦è§£æçµæœ")
print("=" * 60)
print(f"çµæ™¶ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒ: {fit_params['crystal_center']:.1f} cmâ»Â¹")
print(f"çµæ™¶ãƒ”ãƒ¼ã‚¯å¹…ï¼ˆFWHMï¼‰: {2.355 * fit_params['crystal_width']:.1f} cmâ»Â¹")
print(f"éæ™¶ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒ: {fit_params['amorphous_center']:.1f} cmâ»Â¹")
print(f"éæ™¶ãƒ”ãƒ¼ã‚¯å¹…ï¼ˆFWHMï¼‰: {2.355 * fit_params['amorphous_width']:.1f} cmâ»Â¹")
print(f"\nçµæ™¶åŒ–åº¦: {crystallinity:.1f}%")
print(f"éæ™¶åŒ–åº¦: {100 - crystallinity:.1f}%")
</code></pre>
        </div>

        <h2>4. ç¾¤è«–ã¨æŒ¯å‹•é¸æŠå‰‡</h2>

        <h3>4.1 åˆ†å­ã®å¯¾ç§°æ€§ã¨æ—¢ç´„è¡¨ç¾</h3>

        <p>åˆ†å­ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã¯ã€åˆ†å­ã®å¯¾ç§°æ€§ï¼ˆç‚¹ç¾¤ï¼‰ã«ã‚ˆã£ã¦åˆ†é¡ã•ã‚Œã¾ã™ã€‚å„æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã¯ç‚¹ç¾¤ã®æ—¢ç´„è¡¨ç¾ã«å¯¾å¿œã—ã€ãã®å¯¾ç§°æ€§ã‹ã‚‰é¸æŠå‰‡ï¼ˆIRæ´»æ€§ã€Ramanæ´»æ€§ï¼‰ãŒæ±ºã¾ã‚Šã¾ã™ã€‚</p>

        <div class="info-box">
            <strong>ä¸»è¦ãªç‚¹ç¾¤ã¨æ—¢ç´„è¡¨ç¾ã®ä¾‹</strong><br>
            <ul>
                <li><strong>C<sub>2v</sub></strong>ï¼ˆHâ‚‚Oï¼‰: Aâ‚, Aâ‚‚, Bâ‚, Bâ‚‚</li>
                <li><strong>D<sub>6h</sub></strong>ï¼ˆãƒ™ãƒ³ã‚¼ãƒ³ï¼‰: A<sub>1g</sub>, A<sub>2g</sub>, B<sub>1g</sub>, B<sub>2g</sub>, E<sub>1g</sub>, E<sub>2g</sub>, A<sub>1u</sub>, A<sub>2u</sub>, B<sub>1u</sub>, B<sub>2u</sub>, E<sub>1u</sub>, E<sub>2u</sub></li>
                <li><strong>T<sub>d</sub></strong>ï¼ˆCHâ‚„ï¼‰: Aâ‚, Aâ‚‚, E, Tâ‚, Tâ‚‚</li>
            </ul>
        </div>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: Hâ‚‚Oåˆ†å­ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã¨å¯¾ç§°æ€§</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def h2o_symmetry_analysis():
    """
    Hâ‚‚Oåˆ†å­ï¼ˆC2vç‚¹ç¾¤ï¼‰ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã¨é¸æŠå‰‡

    Returns:
    --------
    table : dict
        æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®æƒ…å ±
    """
    # H2Oåˆ†å­ã®3ã¤ã®åŸºæœ¬æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰
    modes = {
        'mode1': {
            'name': 'å¯¾ç§°ä¼¸ç¸®',
            'symmetry': 'Aâ‚',
            'wavenumber': 3657,
            'IR_active': True,
            'Raman_active': True,
            'description': 'ä¸¡O-HçµåˆãŒåŒæ™‚ã«ä¼¸ç¸®ã€å¯¾ç§°'
        },
        'mode2': {
            'name': 'å¤‰è§’æŒ¯å‹•',
            'symmetry': 'Aâ‚',
            'wavenumber': 1595,
            'IR_active': True,
            'Raman_active': True,
            'description': 'H-O-Hè§’ãŒå¤‰åŒ–'
        },
        'mode3': {
            'name': 'éå¯¾ç§°ä¼¸ç¸®',
            'symmetry': 'Bâ‚',
            'wavenumber': 3756,
            'IR_active': True,
            'Raman_active': True,
            'description': 'ä¸€æ–¹ã®O-HãŒä¼¸ã³ã‚‹æ™‚ã€ä»–æ–¹ãŒç¸®ã‚€'
        }
    }

    # è¡¨å½¢å¼ã§è¡¨ç¤º
    print("=" * 80)
    print("Hâ‚‚Oåˆ†å­ï¼ˆCâ‚‚vç‚¹ç¾¤ï¼‰ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã¨é¸æŠå‰‡")
    print("=" * 80)
    print(f"{'ãƒ¢ãƒ¼ãƒ‰':<12} {'å¯¾ç§°æ€§':<10} {'æ³¢æ•° (cmâ»Â¹)':<15} {'IRæ´»æ€§':<10} {'Ramanæ´»æ€§':<12} {'èª¬æ˜':<30}")
    print("-" * 80)

    for mode_id, mode in modes.items():
        ir_str = 'â—‹' if mode['IR_active'] else 'Ã—'
        raman_str = 'â—‹' if mode['Raman_active'] else 'Ã—'
        print(f"{mode['name']:<12} {mode['symmetry']:<10} {mode['wavenumber']:<15} "
              f"{ir_str:<10} {raman_str:<12} {mode['description']:<30}")

    print("\n" + "=" * 80)
    print("Câ‚‚vç‚¹ç¾¤ã®æŒ‡æ¨™è¡¨ï¼ˆCharacter Tableï¼‰")
    print("=" * 80)
    print("  Câ‚‚v | E   Câ‚‚  Ïƒv  Ïƒv' | åŸºåº•é–¢æ•°")
    print("-" * 80)
    print("  Aâ‚  | 1   1   1   1   | z, xÂ², yÂ², zÂ²")
    print("  Aâ‚‚  | 1   1  -1  -1   | Rz")
    print("  Bâ‚  | 1  -1   1  -1   | x, Ry")
    print("  Bâ‚‚  | 1  -1  -1   1   | y, Rx")
    print("\né¸æŠå‰‡:")
    print("  IRæ´»æ€§: Î¼x, Î¼y, Î¼zï¼ˆåŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼‰ãŒåŸºåº•ã«å«ã¾ã‚Œã‚‹")
    print("  Ramanæ´»æ€§: Î±xx, Î±yy, Î±zz, Î±xy, Î±xz, Î±yzï¼ˆåˆ†æ¥µç‡ãƒ†ãƒ³ã‚½ãƒ«ï¼‰ãŒåŸºåº•ã«å«ã¾ã‚Œã‚‹")
    print("\nHâ‚‚Oã®å ´åˆã€Aâ‚ã¨Bâ‚ã¯ã„ãšã‚Œã‚‚IRã¨Ramanä¸¡æ–¹ã§æ´»æ€§")

    # å¯è¦–åŒ–ï¼šã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ¬ãƒ™ãƒ«å›³
    fig, ax = plt.subplots(figsize=(10, 8))

    # åŸºåº•çŠ¶æ…‹ã¨åŠ±èµ·çŠ¶æ…‹
    y_ground = 0
    modes_sorted = sorted(modes.items(), key=lambda x: x[1]['wavenumber'])

    colors = ['#f093fb', '#f5576c', '#4ecdc4']

    for i, (mode_id, mode) in enumerate(modes_sorted):
        y_excited = mode['wavenumber'] / 100  # ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
        ax.hlines(y_excited, i*0.5, i*0.5 + 0.4, colors=colors[i], linewidths=5,
                 label=f"{mode['name']} ({mode['symmetry']})")
        ax.text(i*0.5 + 0.45, y_excited, f"{mode['wavenumber']} cmâ»Â¹",
               va='center', fontsize=10)

        # é·ç§»çŸ¢å°
        ax.annotate('', xy=(i*0.5 + 0.2, y_excited), xytext=(i*0.5 + 0.2, y_ground),
                   arrowprops=dict(arrowstyle='->', color=colors[i], lw=2))

    ax.hlines(y_ground, -0.2, 1.5, colors='black', linewidths=3, label='åŸºåº•çŠ¶æ…‹ (v=0)')
    ax.set_xlim(-0.3, 1.6)
    ax.set_ylim(-2, 40)
    ax.set_ylabel('ç›¸å¯¾ã‚¨ãƒãƒ«ã‚®ãƒ¼ (cmâ»Â¹ / 100)', fontsize=12)
    ax.set_title('Hâ‚‚Oåˆ†å­ã®æŒ¯å‹•åŠ±èµ·ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½', fontsize=14, fontweight='bold')
    ax.set_xticks([])
    ax.legend(loc='upper left', fontsize=10)
    ax.grid(axis='y', alpha=0.3)

    plt.tight_layout()
    plt.savefig('h2o_symmetry_modes.png', dpi=300, bbox_inches='tight')
    plt.show()

    return modes

# å®Ÿè¡Œ
modes = h2o_symmetry_analysis()
</code></pre>
        </div>

        <h3>4.2 é¸æŠå‰‡ã®æ±ºå®š</h3>

        <p>æ—¢ç´„è¡¨ç¾ã«å¯¾å¿œã™ã‚‹æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ãŒIRæ´»æ€§ã¾ãŸã¯Ramanæ´»æ€§ã§ã‚ã‚‹ã‹ã¯ã€ä»¥ä¸‹ã®è¦å‰‡ã§åˆ¤å®šã•ã‚Œã¾ã™ï¼š</p>

        <ul>
            <li><strong>IRæ´»æ€§</strong>: æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®æ—¢ç´„è¡¨ç¾ãŒã€åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆæˆåˆ†ï¼ˆx, y, zï¼‰ã®ã„ãšã‚Œã‹ã¨åŒã˜å¯¾ç§°æ€§ã‚’æŒã¤</li>
            <li><strong>Ramanæ´»æ€§</strong>: æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®æ—¢ç´„è¡¨ç¾ãŒã€åˆ†æ¥µç‡ãƒ†ãƒ³ã‚½ãƒ«æˆåˆ†ï¼ˆxÂ², yÂ², zÂ², xy, xz, yzï¼‰ã®ã„ãšã‚Œã‹ã¨åŒã˜å¯¾ç§°æ€§ã‚’æŒã¤</li>
        </ul>

        <h2>5. å®Ÿè·µçš„ãªã‚¹ãƒšã‚¯ãƒˆãƒ«è§£æ</h2>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹8: IRã¨Ramanã®çµ±åˆè§£æãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import find_peaks

class VibrationalSpectroscopyAnalyzer:
    """IRãƒ»Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«ã®çµ±åˆè§£æã‚¯ãƒ©ã‚¹"""

    def __init__(self):
        # å®˜èƒ½åŸºãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        self.functional_groups = {
            'O-H': {'IR': (3200, 3600), 'Raman': (3200, 3600), 'intensity_IR': 'strong'},
            'N-H': {'IR': (3300, 3500), 'Raman': (3300, 3500), 'intensity_IR': 'medium'},
            'C-H': {'IR': (2850, 3000), 'Raman': (2850, 3000), 'intensity_IR': 'strong'},
            'C=O': {'IR': (1650, 1750), 'Raman': (1650, 1750), 'intensity_IR': 'very strong'},
            'C=C': {'IR': (1620, 1680), 'Raman': (1620, 1680), 'intensity_Raman': 'strong'},
            'C-C': {'IR': (800, 1200), 'Raman': (800, 1200), 'intensity_Raman': 'medium'},
        }

    def identify_functional_groups(self, wavenumbers, intensity, threshold=0.3):
        """
        ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰å®˜èƒ½åŸºã‚’åŒå®š

        Parameters:
        -----------
        wavenumbers : array
            æ³¢æ•°ï¼ˆcmâ»Â¹ï¼‰
        intensity : array
            å¼·åº¦
        threshold : float
            ãƒ”ãƒ¼ã‚¯æ¤œå‡ºã®é–¾å€¤ï¼ˆæœ€å¤§å€¤ã«å¯¾ã™ã‚‹ç›¸å¯¾å€¤ï¼‰

        Returns:
        --------
        identified_groups : list
            åŒå®šã•ã‚ŒãŸå®˜èƒ½åŸºã®ãƒªã‚¹ãƒˆ
        """
        # ãƒ”ãƒ¼ã‚¯æ¤œå‡º
        peaks, properties = find_peaks(intensity, prominence=threshold * np.max(intensity))

        identified_groups = []

        for peak in peaks:
            peak_wn = wavenumbers[peak]

            # å®˜èƒ½åŸºãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ç…§åˆ
            for group, ranges in self.functional_groups.items():
                ir_range = ranges['IR']
                if ir_range[0] <= peak_wn <= ir_range[1]:
                    identified_groups.append({
                        'functional_group': group,
                        'wavenumber': peak_wn,
                        'intensity': intensity[peak]
                    })

        return identified_groups

    def complementary_analysis(self, ir_spectrum, raman_spectrum):
        """
        IRã¨Ramanã®ç›¸è£œçš„è§£æ

        Parameters:
        -----------
        ir_spectrum : dict
            {'wavenumbers': array, 'intensity': array}
        raman_spectrum : dict
            {'wavenumbers': array, 'intensity': array}

        Returns:
        --------
        analysis_result : dict
            çµ±åˆè§£æçµæœ
        """
        # IRã§æ¤œå‡ºã•ã‚ŒãŸå®˜èƒ½åŸº
        ir_groups = self.identify_functional_groups(ir_spectrum['wavenumbers'],
                                                     ir_spectrum['intensity'])

        # Ramanã§æ¤œå‡ºã•ã‚ŒãŸå®˜èƒ½åŸº
        raman_groups = self.identify_functional_groups(raman_spectrum['wavenumbers'],
                                                        raman_spectrum['intensity'])

        # çµ±åˆ
        all_groups = set([g['functional_group'] for g in ir_groups] +
                        [g['functional_group'] for g in raman_groups])

        analysis_result = {
            'IR_only': [g for g in ir_groups if g['functional_group'] not in
                       [rg['functional_group'] for rg in raman_groups]],
            'Raman_only': [g for g in raman_groups if g['functional_group'] not in
                          [ig['functional_group'] for ig in ir_groups]],
            'Both': list(all_groups.intersection(set([g['functional_group'] for g in ir_groups]),
                                                 set([g['functional_group'] for g in raman_groups])))
        }

        return analysis_result

# å®Ÿè¡Œä¾‹ï¼šã‚¢ã‚»ãƒˆãƒ³ï¼ˆCHâ‚ƒCOCHâ‚ƒï¼‰ã®IRãƒ»Ramançµ±åˆè§£æ
analyzer = VibrationalSpectroscopyAnalyzer()

# åˆæˆIRã‚¹ãƒšã‚¯ãƒˆãƒ«
wn_ir = np.linspace(4000, 400, 2000)
ir_intensity = (
    1.5 * np.exp(-(wn_ir - 2970)**2 / (2 * 20**2)) +  # C-Hä¼¸ç¸®
    2.0 * np.exp(-(wn_ir - 1715)**2 / (2 * 30**2)) +  # C=Oä¼¸ç¸®
    0.5 * np.exp(-(wn_ir - 1360)**2 / (2 * 25**2)) +  # C-Hå¤‰è§’
    0.3 * np.random.random(len(wn_ir))  # ãƒã‚¤ã‚º
)

# åˆæˆRamanã‚¹ãƒšã‚¯ãƒˆãƒ«
wn_raman = np.linspace(3500, 100, 2000)
raman_intensity = (
    0.8 * np.exp(-(wn_raman - 2970)**2 / (2 * 20**2)) +  # C-Hä¼¸ç¸®
    1.2 * np.exp(-(wn_raman - 1715)**2 / (2 * 30**2)) +  # C=Oä¼¸ç¸®
    1.5 * np.exp(-(wn_raman - 900)**2 / (2 * 25**2)) +   # C-Cä¼¸ç¸®
    0.2 * np.random.random(len(wn_raman))  # ãƒã‚¤ã‚º
)

# çµ±åˆè§£æ
ir_spec = {'wavenumbers': wn_ir, 'intensity': ir_intensity}
raman_spec = {'wavenumbers': wn_raman, 'intensity': raman_intensity}

result = analyzer.complementary_analysis(ir_spec, raman_spec)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

# IRã‚¹ãƒšã‚¯ãƒˆãƒ«
ax1.plot(wn_ir, ir_intensity, linewidth=1.5, color='#f093fb', label='IRã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax1.fill_between(wn_ir, ir_intensity, alpha=0.3, color='#f5576c')
ax1.set_xlabel('æ³¢æ•° (cmâ»Â¹)', fontsize=12)
ax1.set_ylabel('å¸å…‰åº¦ (a.u.)', fontsize=12)
ax1.set_title('ã‚¢ã‚»ãƒˆãƒ³ã®IRã‚¹ãƒšã‚¯ãƒˆãƒ«', fontsize=14, fontweight='bold')
ax1.invert_xaxis()
ax1.legend()
ax1.grid(True, alpha=0.3)

# Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«
ax2.plot(wn_raman, raman_intensity, linewidth=1.5, color='#4ecdc4', label='Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax2.fill_between(wn_raman, raman_intensity, alpha=0.3, color='#ffe66d')
ax2.set_xlabel('Raman Shift (cmâ»Â¹)', fontsize=12)
ax2.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax2.set_title('ã‚¢ã‚»ãƒˆãƒ³ã®Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('acetone_ir_raman_complementary.png', dpi=300, bbox_inches='tight')
plt.show()

# è§£æçµæœã®è¡¨ç¤º
print("=" * 70)
print("IRã¨Ramanã®çµ±åˆè§£æçµæœï¼ˆã‚¢ã‚»ãƒˆãƒ³ï¼‰")
print("=" * 70)
print("\nIRã®ã¿ã§æ¤œå‡º:")
for group in result['IR_only']:
    print(f"  {group['functional_group']}: {group['wavenumber']:.0f} cmâ»Â¹")

print("\nRamanã®ã¿ã§æ¤œå‡º:")
for group in result['Raman_only']:
    print(f"  {group['functional_group']}: {group['wavenumber']:.0f} cmâ»Â¹")

print("\nä¸¡æ–¹ã§æ¤œå‡º:")
for group in result['Both']:
    print(f"  {group}")

print("\nçµè«–:")
print("  - C=Oä¼¸ç¸®: IRã§éå¸¸ã«å¼·ã„ã€Ramanã§ã‚‚è¦³æ¸¬")
print("  - C-Hä¼¸ç¸®: IRãƒ»Ramanä¸¡æ–¹ã§å¼·ã„")
print("  - C-Cä¼¸ç¸®: Ramanã§å¼·ãè¦³æ¸¬ï¼ˆIRã§ã¯å¼±ã„ï¼‰")
print("  â†’ IRã¨Ramanã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ã§ã€åˆ†å­æ§‹é€ ã®å…¨ä½“åƒã‚’æŠŠæ¡")
</code></pre>
        </div>

        <h2>æ¼”ç¿’å•é¡Œ</h2>

        <details>
            <summary><strong>æ¼”ç¿’å•é¡Œï¼ˆã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ï¼‰</strong></summary>

            <h3>Easy ãƒ¬ãƒ™ãƒ«ï¼ˆåŸºæœ¬è¨ˆç®—ï¼‰</h3>

            <p><strong>å•é¡Œ1</strong>: C-Oçµåˆï¼ˆåŠ›ã®å®šæ•° $k = 1000$ N/mï¼‰ã®æŒ¯å‹•å‘¨æ³¢æ•°ï¼ˆcmâ»Â¹ï¼‰ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚ç‚­ç´ ã®è³ªé‡ã¯12 amuã€é…¸ç´ ã®è³ªé‡ã¯16 amuã§ã™ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python"># ã‚³ãƒ¼ãƒ‰ä¾‹1ã®é–¢æ•°ã‚’ä½¿ç”¨
freq_Hz, wavenumber = vibrational_frequency(k=1000, m1=12, m2=16)
print(f"C-Oä¼¸ç¸®æŒ¯å‹•ã®æ³¢æ•°: {wavenumber:.1f} cmâ»Â¹")
# å‡ºåŠ›: ç´„1270 cmâ»Â¹
</code></pre>
            </details>

            <p><strong>å•é¡Œ2</strong>: Hâ‚‚Oåˆ†å­ï¼ˆéç·šå½¢ã€3åŸå­ï¼‰ã®æŒ¯å‹•è‡ªç”±åº¦ã®æ•°ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <p>$$3N - 6 = 3 \times 3 - 6 = 3$$</p>
                <p>Hâ‚‚Oã¯3ã¤ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ï¼ˆå¯¾ç§°ä¼¸ç¸®ã€å¤‰è§’æŒ¯å‹•ã€éå¯¾ç§°ä¼¸ç¸®ï¼‰ã‚’æŒã¡ã¾ã™ã€‚</p>
            </details>

            <p><strong>å•é¡Œ3</strong>: IRã‚¹ãƒšã‚¯ãƒˆãƒ«ã§1715 cmâ»Â¹ã«å¼·ã„ãƒ”ãƒ¼ã‚¯ãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸã€‚ã“ã®å®˜èƒ½åŸºã¯ä½•ã§ã™ã‹ï¼Ÿ</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>: ã‚«ãƒ«ãƒœãƒ‹ãƒ«åŸºï¼ˆC=Oï¼‰ã®ä¼¸ç¸®æŒ¯å‹•ã€‚1650-1750 cmâ»Â¹ã®é ˜åŸŸã¯C=Oã®ç‰¹æ€§å¸åã§ã™ã€‚</p>
            </details>

            <h3>Medium ãƒ¬ãƒ™ãƒ«ï¼ˆå®Ÿè·µçš„è¨ˆç®—ï¼‰</h3>

            <p><strong>å•é¡Œ4</strong>: åŒä½ä½“åŠ¹æœã‚’è€ƒæ…®ã—ã€Â¹Â²C=O ã¨ Â¹Â³C=O ã®æŒ¯å‹•å‘¨æ³¢æ•°ã®æ¯”ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ï¼ˆåŠ›ã®å®šæ•°ã¯åŒã˜ã¨ä»®å®šï¼‰ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">_, wn_12C = vibrational_frequency(1200, 12, 16)
_, wn_13C = vibrational_frequency(1200, 13, 16)

ratio = wn_12C / wn_13C
print(f"Â¹Â²C=Oæ³¢æ•°: {wn_12C:.1f} cmâ»Â¹")
print(f"Â¹Â³C=Oæ³¢æ•°: {wn_13C:.1f} cmâ»Â¹")
print(f"æ¯”ç‡: {ratio:.4f}")
# å‡ºåŠ›: æ¯”ç‡ â‰ˆ 1.017ï¼ˆç´„1.7%ã®ã‚·ãƒ•ãƒˆï¼‰
</code></pre>
            </details>

            <p><strong>å•é¡Œ5</strong>: Ramanæ•£ä¹±ã«ãŠã„ã¦ã€å®¤æ¸©ï¼ˆ300 Kï¼‰ã§Stokesç·šã¨Anti-Stokesç·šã®å¼·åº¦æ¯”ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã¯1500 cmâ»Â¹ã¨ã—ã¾ã™ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python"># ã‚³ãƒ¼ãƒ‰ä¾‹5ã®boltzmann_populationé–¢æ•°ã‚’ä½¿ç”¨
ratio = boltzmann_population(1500, T=300)
print(f"I(Anti-Stokes) / I(Stokes) = {ratio:.4f}")
# å‡ºåŠ›: ç´„0.023ï¼ˆAnti-Stokesã¯Stokesã®ç´„2.3%ï¼‰
</code></pre>
            </details>

            <p><strong>å•é¡Œ6</strong>: COâ‚‚åˆ†å­ï¼ˆç·šå½¢ã€3åŸå­ï¼‰ã®æŒ¯å‹•è‡ªç”±åº¦ã‚’æ±‚ã‚ã€å„æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®å¯¾ç§°æ€§ï¼ˆÎ£<sub>g</sub>âº, Î£<sub>u</sub>âº, Î <sub>u</sub>ï¼‰ã¨IR/Ramanæ´»æ€§ã‚’ç­”ãˆã¦ãã ã•ã„ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <p>$$3N - 5 = 3 \times 3 - 5 = 4$$</p>
                <table border="1" style="border-collapse: collapse; margin: 1em 0;">
                    <tr><th>ãƒ¢ãƒ¼ãƒ‰</th><th>å¯¾ç§°æ€§</th><th>æ³¢æ•°ï¼ˆcmâ»Â¹ï¼‰</th><th>IRæ´»æ€§</th><th>Ramanæ´»æ€§</th></tr>
                    <tr><td>å¯¾ç§°ä¼¸ç¸®</td><td>Î£<sub>g</sub>âº</td><td>1340</td><td>ä¸æ´»æ€§</td><td>æ´»æ€§</td></tr>
                    <tr><td>éå¯¾ç§°ä¼¸ç¸®</td><td>Î£<sub>u</sub>âº</td><td>2349</td><td>æ´»æ€§</td><td>ä¸æ´»æ€§</td></tr>
                    <tr><td>å¤‰è§’æŒ¯å‹•ï¼ˆ2é‡ç¸®é€€ï¼‰</td><td>Î <sub>u</sub></td><td>667</td><td>æ´»æ€§</td><td>ä¸æ´»æ€§</td></tr>
                </table>
                <p>COâ‚‚ã¯ä¸­å¿ƒå¯¾ç§°åˆ†å­ãªã®ã§ã€ç›¸äº’æ’ä»–å‰‡ãŒæˆç«‹ã—ã¾ã™ã€‚</p>
            </details>

            <h3>Hard ãƒ¬ãƒ™ãƒ«ï¼ˆé«˜åº¦ãªè§£æï¼‰</h3>

            <p><strong>å•é¡Œ7</strong>: ä¸‹è¨˜ã®å®Ÿæ¸¬IRã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€FTIRã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ã‚’é€†ç®—ã—ã¦ãã ã•ã„ã€‚ãã®å¾Œã€ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§å…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ãŒå¾©å…ƒã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹ï¼ˆå®Œå…¨ãªã‚³ãƒ¼ãƒ‰ï¼‰</summary>
                <pre><code class="language-python"># ã‚³ãƒ¼ãƒ‰ä¾‹4ã®é–¢æ•°ã‚’åˆ©ç”¨
true_wavenumbers = np.array([1000, 1500, 2000, 2900])
true_intensities = np.array([0.6, 1.0, 0.8, 0.7])

# ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ç”Ÿæˆ
displacement, interferogram = generate_interferogram(true_wavenumbers, true_intensities,
                                                     mirror_displacement_max=0.1)

# ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§ã‚¹ãƒšã‚¯ãƒˆãƒ«å¾©å…ƒ
wavenumbers_ft, spectrum_ft = fourier_transform_spectrum(displacement, interferogram)

# æ¤œè¨¼ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

ax1.plot(displacement, interferogram, linewidth=1.5, color='#f093fb')
ax1.set_xlabel('ãƒŸãƒ©ãƒ¼å¤‰ä½ (cm)', fontsize=12)
ax1.set_ylabel('å¹²æ¸‰å¼·åº¦', fontsize=12)
ax1.set_title('å®Ÿæ¸¬IRã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰é€†ç®—ã—ãŸã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ', fontsize=14, fontweight='bold')
ax1.grid(True, alpha=0.3)

ax2.plot(wavenumbers_ft, spectrum_ft, linewidth=1.5, color='#f5576c')
for wn in true_wavenumbers:
    ax2.axvline(x=wn, color='green', linestyle='--', alpha=0.7)
ax2.set_xlabel('æ³¢æ•° (cmâ»Â¹)', fontsize=12)
ax2.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax2.set_title('ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã§å¾©å…ƒã•ã‚ŒãŸã‚¹ãƒšã‚¯ãƒˆãƒ«', fontsize=14, fontweight='bold')
ax2.set_xlim(0, 4000)
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

print("çœŸã®ãƒ”ãƒ¼ã‚¯ä½ç½®:", true_wavenumbers)
print("å¾©å…ƒæˆåŠŸ: ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ã«ã‚ˆã‚Šå…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ãŒå†ç¾ã•ã‚Œã¾ã—ãŸ")
</code></pre>
            </details>

            <p><strong>å•é¡Œ8</strong>: ãƒ™ãƒ³ã‚¼ãƒ³ï¼ˆD<sub>6h</sub>ç‚¹ç¾¤ï¼‰ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ï¼ˆ30å€‹ï¼‰ã®ã†ã¡ã€IRæ´»æ€§ãªãƒ¢ãƒ¼ãƒ‰ã¨Ramanæ´»æ€§ãªãƒ¢ãƒ¼ãƒ‰ã®æ•°ã‚’æ¨å®šã—ã¦ãã ã•ã„ã€‚å¯¾ç§°æ€§ã«åŸºã¥ã„ã¦è€ƒå¯Ÿã—ã¦ãã ã•ã„ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <p>ãƒ™ãƒ³ã‚¼ãƒ³ã¯ä¸­å¿ƒå¯¾ç§°åˆ†å­ï¼ˆD<sub>6h</sub>ï¼‰ãªã®ã§ã€ç›¸äº’æ’ä»–å‰‡ãŒæˆç«‹ã—ã¾ã™ã€‚30å€‹ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®ã†ã¡ï¼š</p>
                <ul>
                    <li><strong>IRæ´»æ€§</strong>: uï¼ˆungeradeï¼‰å¯¾ç§°æ€§ã®ãƒ¢ãƒ¼ãƒ‰ â†’ ç´„4å€‹ã®E<sub>1u</sub>ãƒ¢ãƒ¼ãƒ‰</li>
                    <li><strong>Ramanæ´»æ€§</strong>: gï¼ˆgeradeï¼‰å¯¾ç§°æ€§ã®ãƒ¢ãƒ¼ãƒ‰ â†’ ç´„7å€‹ã®A<sub>1g</sub>, E<sub>1g</sub>, E<sub>2g</sub>ãƒ¢ãƒ¼ãƒ‰</li>
                    <li>æ®‹ã‚Šã®ãƒ¢ãƒ¼ãƒ‰ã¯ä¸æ´»æ€§ï¼ˆA<sub>2g</sub>, A<sub>2u</sub>, B<sub>1u</sub>, B<sub>2u</sub>ãªã©ï¼‰</li>
                </ul>
                <p>è©³ç´°ãªæŒ‡æ¨™è¡¨ã«ã‚ˆã‚‹è§£æãŒå¿…è¦ã§ã™ãŒã€IRæ´»æ€§ãƒ¢ãƒ¼ãƒ‰ã¨Ramanæ´»æ€§ãƒ¢ãƒ¼ãƒ‰ã¯äº’ã„ã«æ’ä»–çš„ã§ã™ã€‚</p>
            </details>

            <p><strong>å•é¡Œ9</strong>: ãƒãƒªã‚¨ãƒãƒ¬ãƒ³ã®çµæ™¶åŒ–åº¦ã‚’Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰è©•ä¾¡ã™ã‚‹éš›ã€çµæ™¶ãƒ”ãƒ¼ã‚¯ï¼ˆ1130 cmâ»Â¹ï¼‰ã¨éæ™¶ãƒ”ãƒ¼ã‚¯ï¼ˆ1080 cmâ»Â¹ï¼‰ã®å¼·åº¦æ¯”ãŒ2:1ã§ã—ãŸã€‚ãƒ”ãƒ¼ã‚¯é¢ç©æ¯”ã‹ã‚‰çµæ™¶åŒ–åº¦ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ï¼ˆãƒ”ãƒ¼ã‚¯å¹…ã¯ãã‚Œãã‚Œ10 cmâ»Â¹ã€15 cmâ»Â¹ã¨ã—ã¾ã™ï¼‰ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python"># Gaussianè¿‘ä¼¼ã§ãƒ”ãƒ¼ã‚¯é¢ç©ã‚’è¨ˆç®—
I_crystal = 2.0  # å¼·åº¦æ¯”
I_amorphous = 1.0
width_crystal = 10  # cm^-1
width_amorphous = 15  # cm^-1

# é¢ç© = å¼·åº¦ Ã— å¹… Ã— sqrt(2Ï€)ï¼ˆGaussianè¿‘ä¼¼ï¼‰
area_crystal = I_crystal * width_crystal * np.sqrt(2 * np.pi)
area_amorphous = I_amorphous * width_amorphous * np.sqrt(2 * np.pi)

crystallinity = area_crystal / (area_crystal + area_amorphous) * 100
print(f"çµæ™¶ãƒ”ãƒ¼ã‚¯é¢ç©: {area_crystal:.1f}")
print(f"éæ™¶ãƒ”ãƒ¼ã‚¯é¢ç©: {area_amorphous:.1f}")
print(f"çµæ™¶åŒ–åº¦: {crystallinity:.1f}%")
# å‡ºåŠ›: ç´„51.3%
</code></pre>
            </details>

            <p><strong>å•é¡Œ10</strong>: Hâ‚‚Oåˆ†å­ã®C<sub>2v</sub>ç‚¹ç¾¤ã«ãŠã‘ã‚‹3ã¤ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ï¼ˆAâ‚, Aâ‚, Bâ‚ï¼‰ãŒã€ãªãœã™ã¹ã¦IRã¨Ramanä¸¡æ–¹ã§æ´»æ€§ãªã®ã‹ã‚’ã€æŒ‡æ¨™è¡¨ã‚’ç”¨ã„ã¦èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <p>C<sub>2v</sub>ç‚¹ç¾¤ã®æŒ‡æ¨™è¡¨ã‚ˆã‚Šï¼š</p>
                <ul>
                    <li><strong>Aâ‚å¯¾ç§°æ€§</strong>: åŸºåº•é–¢æ•°ã«zï¼ˆåŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼‰ã¨xÂ², yÂ², zÂ²ï¼ˆåˆ†æ¥µç‡ãƒ†ãƒ³ã‚½ãƒ«ï¼‰ãŒå«ã¾ã‚Œã‚‹ â†’ IRæ´»æ€§ã‹ã¤Ramanæ´»æ€§</li>
                    <li><strong>Bâ‚å¯¾ç§°æ€§</strong>: åŸºåº•é–¢æ•°ã«xï¼ˆåŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼‰ã¨xzï¼ˆåˆ†æ¥µç‡ãƒ†ãƒ³ã‚½ãƒ«ï¼‰ãŒå«ã¾ã‚Œã‚‹ â†’ IRæ´»æ€§ã‹ã¤Ramanæ´»æ€§</li>
                </ul>
                <p>ã—ãŸãŒã£ã¦ã€Hâ‚‚Oã®3ã¤ã®æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ï¼ˆå¯¾ç§°ä¼¸ç¸®Aâ‚ã€å¤‰è§’Aâ‚ã€éå¯¾ç§°ä¼¸ç¸®Bâ‚ï¼‰ã¯ã™ã¹ã¦IRã¨Ramanä¸¡æ–¹ã§è¦³æ¸¬ã•ã‚Œã¾ã™ã€‚ä¸­å¿ƒå¯¾ç§°åˆ†å­ã§ã¯ãªã„ãŸã‚ã€ç›¸äº’æ’ä»–å‰‡ã¯é©ç”¨ã•ã‚Œã¾ã›ã‚“ã€‚</p>
            </details>

        </details>

        <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

        <p>ã“ã®ç« ã§å­¦ã‚“ã å†…å®¹ã‚’æŒ¯ã‚Šè¿”ã‚Šã€ä»¥ä¸‹ã®é …ç›®ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>

        <h3>åŸºæœ¬ç†è§£</h3>
        <ul>
            <li>âœ… èª¿å’ŒæŒ¯å‹•å­ãƒ¢ãƒ‡ãƒ«ã¨æŒ¯å‹•å‘¨æ³¢æ•°ã®è³ªé‡ãƒ»åŠ›ã®å®šæ•°ä¾å­˜æ€§ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>âœ… IRã¨Ramanã®é¸æŠå‰‡ã®é•ã„ï¼ˆåŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆå¤‰åŒ– vs åˆ†æ¥µç‡å¤‰åŒ–ï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            <li>âœ… ä¸»è¦ãªå®˜èƒ½åŸºã®ç‰¹æ€§å¸åæ³¢æ•°ã‚’æš—è¨˜ã—ã¦ã„ã‚‹ï¼ˆC=O: 1700 cmâ»Â¹ã€O-H: 3400 cmâ»Â¹ãªã©ï¼‰</li>
            <li>âœ… ä¸­å¿ƒå¯¾ç§°åˆ†å­ã«ãŠã‘ã‚‹ç›¸äº’æ’ä»–å‰‡ã‚’èª¬æ˜ã§ãã‚‹</li>
        </ul>

        <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
        <ul>
            <li>âœ… æŒ¯å‹•å‘¨æ³¢æ•°ã®è¨ˆç®—ã¨åŒä½ä½“åŠ¹æœã®è©•ä¾¡ãŒã§ãã‚‹</li>
            <li>âœ… IRã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰å®˜èƒ½åŸºã‚’åŒå®šã§ãã‚‹</li>
            <li>âœ… Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰Stokes/Anti-Stokeså¼·åº¦æ¯”ã‚’ç”¨ã„ã¦æ¸©åº¦æ¨å®šãŒã§ãã‚‹</li>
            <li>âœ… çµæ™¶åŒ–åº¦è©•ä¾¡ã®ãŸã‚ã®ãƒ”ãƒ¼ã‚¯åˆ†é›¢ãŒã§ãã‚‹</li>
        </ul>

        <h3>å¿œç”¨åŠ›</h3>
        <ul>
            <li>âœ… IRã¨Ramanã®ç›¸è£œçš„æƒ…å ±ã‚’çµ„ã¿åˆã‚ã›ã¦åˆ†å­æ§‹é€ ã‚’æ±ºå®šã§ãã‚‹</li>
            <li>âœ… ç¾¤è«–ã‚’ç”¨ã„ã¦æŒ¯å‹•ãƒ¢ãƒ¼ãƒ‰ã®å¯¾ç§°æ€§ã¨IR/Ramanæ´»æ€§ã‚’åˆ¤å®šã§ãã‚‹</li>
            <li>âœ… FTIRã®åŸç†ï¼ˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ­ã‚°ãƒ©ãƒ ã¨ãƒ•ãƒ¼ãƒªã‚¨å¤‰æ›ï¼‰ã‚’ç†è§£ã—ã€å®Ÿè£…ã§ãã‚‹</li>
        </ul>

        <h2>å‚è€ƒæ–‡çŒ®</h2>

        <ol>
            <li>Raman, C. V., Krishnan, K. S. (1928). A new type of secondary radiation. <em>Nature</em>, 121(3048), 501-502. DOI: 10.1038/121501c0 - Ramanæ•£ä¹±åŠ¹æœã®ç™ºè¦‹ã‚’å ±å‘Šã—ãŸæ­´å²çš„åŸè‘—è«–æ–‡</li>
            <li>Nakamoto, K. (2008). <em>Infrared and Raman Spectra of Inorganic and Coordination Compounds</em> (6th ed.). Wiley, pp. 25-31 (IR theory), pp. 78-95 (Raman theory), pp. 115-140 (group theory applications). - IRãƒ»Ramanã‚¹ãƒšã‚¯ãƒˆãƒ«ã®åŒ…æ‹¬çš„æ•™ç§‘æ›¸ã¨å®˜èƒ½åŸºå¸°å±è¡¨</li>
            <li>Long, D. A. (2002). <em>The Raman Effect: A Unified Treatment of the Theory of Raman Scattering by Molecules</em>. Wiley, pp. 50-68 (classical theory), pp. 95-115 (quantum theory), pp. 145-160 (selection rules). - Ramanæ•£ä¹±ã®é‡å­åŠ›å­¦çš„ç†è«–ã¨é¸æŠå‰‡</li>
            <li>Wilson, E. B., Decius, J. C., Cross, P. C. (1980). <em>Molecular Vibrations: The Theory of Infrared and Raman Vibrational Spectra</em>. Dover Publications, pp. 25-42 (normal modes), pp. 65-85 (group theory), pp. 95-110 (selection rules). - åˆ†å­æŒ¯å‹•ã®å¤å…¸çš„åè‘—ã€ç¾¤è«–ã¨é¸æŠå‰‡</li>
            <li>Colthup, N. B., Daly, L. H., Wiberley, S. E. (1990). <em>Introduction to Infrared and Raman Spectroscopy</em> (3rd ed.). Academic Press, pp. 100-125 (functional group frequencies), pp. 180-210 (spectral interpretation), pp. 220-240 (peak assignment). - å®Ÿè·µçš„ãªã‚¹ãƒšã‚¯ãƒˆãƒ«è§£é‡ˆã¨ãƒ”ãƒ¼ã‚¯å¸°å±</li>
            <li>Savitzky, A., Golay, M. J. E. (1964). Smoothing and differentiation of data by simplified least squares procedures. <em>Analytical Chemistry</em>, 36(8), 1627-1639. DOI: 10.1021/ac60214a047 - Savitzky-Golayå¹³æ»‘åŒ–ãƒ•ã‚£ãƒ«ã‚¿ã®åŸè‘—è«–æ–‡ï¼ˆã‚³ãƒ¼ãƒ‰ä¾‹ã§ä½¿ç”¨ï¼‰</li>
            <li>SciPy 1.11 Signal Processing Documentation. <em>scipy.signal.find_peaks, scipy.signal.savgol_filter</em>. Available at: https://docs.scipy.org/doc/scipy/reference/signal.html - Pythonã«ã‚ˆã‚‹ã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿å‡¦ç†</li>
            <li>Smith, E., Dent, G. (2019). <em>Modern Raman Spectroscopy: A Practical Approach</em> (2nd ed.). Wiley, pp. 15-28 (instrumentation), pp. 45-65 (sampling techniques), pp. 72-80 (data processing). - ç¾ä»£Ramanåˆ†å…‰æ³•ã®å®Ÿè·µçš„æŠ€è¡“</li>
            <li>Cotton, F. A. (1990). <em>Chemical Applications of Group Theory</em> (3rd ed.). Wiley, pp. 250-275 (point groups), pp. 285-305 (vibrational modes), pp. 310-320 (selection rules). - ç¾¤è«–ã®åŒ–å­¦å¿œç”¨ã¨æŒ¯å‹•ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®å¯¾ç§°æ€§è§£æ</li>
        </ol>

        <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>

        <p>ç¬¬2ç« ã§ã¯ã€èµ¤å¤–ãƒ»ãƒ©ãƒãƒ³åˆ†å…‰æ³•ã®åŸç†ã€é¸æŠå‰‡ã€å®˜èƒ½åŸºåŒå®šã€ç¾¤è«–ã«ã‚ˆã‚‹å¯¾ç§°æ€§è§£æã‚’å­¦ã³ã¾ã—ãŸã€‚èª¿å’ŒæŒ¯å‹•å­ãƒ¢ãƒ‡ãƒ«ã€FTIRã®åŸç†ã€Stokes/Anti-Stokesæ•£ä¹±ã€çµæ™¶åŒ–åº¦è©•ä¾¡ãªã©ã€å®Ÿè·µçš„ãªãƒ‡ãƒ¼ã‚¿è§£æã‚¹ã‚­ãƒ«ã‚‚ç¿’å¾—ã—ã¾ã—ãŸã€‚</p>

        <p><strong>ç¬¬3ç« </strong>ã§ã¯ã€UV-Visï¼ˆç´«å¤–å¯è¦–ï¼‰åˆ†å…‰æ³•ã‚’å­¦ã³ã¾ã™ã€‚é›»å­é·ç§»ã€Lambert-Beerå‰‡ã®å¿œç”¨ã€Tauc plotã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¸¬å®šã€é…ä½å­å ´ç†è«–ã€Pythonå®Ÿè·µã«ã‚ˆã‚‹å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«è§£æãªã©ã€åŠå°ä½“ãƒ»æœ‰æ©Ÿææ–™ã®é›»å­çŠ¶æ…‹è§£æã®å…¨ã¦ã‚’ã‚«ãƒãƒ¼ã—ã¾ã™ã€‚</p>

        <div class="navigation">
            <a href="./chapter-1.html" class="nav-button">â† ç¬¬1ç« : åˆ†å…‰åˆ†æã®åŸºç¤</a>
            <a href="./chapter-3.html" class="nav-button">ç¬¬3ç« : UV-Visåˆ†å…‰æ³• â†’</a>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 MS Terakoya - Materials Science Learning Platform</p>
        <p><a href="../../index.html">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a></p>
    </footer>
</body>
</html>