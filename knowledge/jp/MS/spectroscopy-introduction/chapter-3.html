<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« : ç´«å¤–å¯è¦–åˆ†å…‰æ³• (UV-Vis Spectroscopy) - åˆ†å…‰åˆ†ææ³•å…¥é–€</title>

    <!-- MathJax for equations -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Mermaid for diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <!-- Prism.js for code highlighting -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-bg: #ffffff;
            --color-text: #333333;
            --color-border: #e0e0e0;
            --color-code-bg: #f8f9fa;
            --spacing-unit: 8px;
            --font-body: 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            --font-code: 'Consolas', 'Monaco', monospace;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.8;
            color: var(--color-text);
            background: var(--color-bg);
            padding: calc(var(--spacing-unit) * 4);
            max-width: 1200px;
            margin: 0 auto;
        }

        h1, h2, h3, h4 {
            color: var(--color-primary);
            margin-top: calc(var(--spacing-unit) * 6);
            margin-bottom: calc(var(--spacing-unit) * 3);
            line-height: 1.3;
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            padding-bottom: calc(var(--spacing-unit) * 2);
            border-bottom: 3px solid var(--color-accent);
        }

        h2 {
            font-size: 1.8rem;
            padding-left: calc(var(--spacing-unit) * 2);
            border-left: 4px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-accent-light);
        }

        h4 {
            font-size: 1.2rem;
        }

        p {
            margin-bottom: calc(var(--spacing-unit) * 2);
            text-align: justify;
        }

        .intro-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            border-left: 4px solid var(--color-accent);
            margin: calc(var(--spacing-unit) * 4) 0;
        }

        .key-concept {
            background: var(--color-code-bg);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 3) 0;
            border: 2px solid var(--color-border);
        }

        .equation-box {
            background: #fff;
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 3) 0;
            border: 2px solid var(--color-accent-light);
            box-shadow: 0 2px 8px rgba(245, 87, 108, 0.1);
        }

        code {
            font-family: var(--font-code);
            background: var(--color-code-bg);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        pre {
            background: #2d2d2d;
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            overflow-x: auto;
            margin: calc(var(--spacing-unit) * 3) 0;
            border: 2px solid var(--color-accent);
        }

        pre code {
            background: none;
            color: #f8f8f2;
            padding: 0;
        }

        .mermaid {
            background: white;
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 4) 0;
            border: 2px solid var(--color-border);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: calc(var(--spacing-unit) * 3) 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        th, td {
            padding: calc(var(--spacing-unit) * 2);
            text-align: left;
            border: 1px solid var(--color-border);
        }

        th {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            font-weight: 600;
        }

        tr:nth-child(even) {
            background: var(--color-code-bg);
        }

        ul, ol {
            margin: calc(var(--spacing-unit) * 2) 0;
            padding-left: calc(var(--spacing-unit) * 5);
        }

        li {
            margin: calc(var(--spacing-unit) * 1) 0;
        }

        .exercise-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.05) 0%, rgba(245, 87, 108, 0.05) 100%);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 3) 0;
            border-left: 4px solid var(--color-accent-light);
        }

        .exercise-box h4 {
            color: var(--color-accent-light);
            margin-top: 0;
        }

        details {
            margin: calc(var(--spacing-unit) * 2) 0;
            padding: calc(var(--spacing-unit) * 2);
            background: white;
            border-radius: 8px;
            border: 1px solid var(--color-border);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-accent-light);
            padding: calc(var(--spacing-unit) * 1);
        }

        summary:hover {
            color: var(--color-accent);
        }

        .learning-objectives {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin: calc(var(--spacing-unit) * 4) 0;
        }

        .learning-objectives ul {
            list-style: none;
            padding-left: 0;
        }

        .learning-objectives li::before {
            content: "âœ“ ";
            color: var(--color-accent-light);
            font-weight: bold;
            margin-right: calc(var(--spacing-unit) * 1);
        }

        .references {
            background: var(--color-code-bg);
            padding: calc(var(--spacing-unit) * 3);
            border-radius: 8px;
            margin-top: calc(var(--spacing-unit) * 6);
        }

        .references h2 {
            border-left: none;
            padding-left: 0;
        }

        .references ol {
            padding-left: calc(var(--spacing-unit) * 4);
        }

        .references li {
            margin: calc(var(--spacing-unit) * 2) 0;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            body {
                padding: calc(var(--spacing-unit) * 2);
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            pre {
                padding: calc(var(--spacing-unit) * 2);
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
            <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MS/spectroscopy-introduction/chapter-3.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="../../MS/spectroscopy-introduction/index.html">Spectroscopy</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 3</span>
        </div>
    </nav>
<h1>ç¬¬3ç« : ç´«å¤–å¯è¦–åˆ†å…‰æ³• (UV-Vis Spectroscopy)</h1>

    <div class="intro-box">
        <p><strong>ã“ã®ç« ã§å­¦ã¶ã“ã¨:</strong> ç´«å¤–å¯è¦–åˆ†å…‰æ³•ï¼ˆUV-Vis Spectroscopyï¼‰ã¯ã€ç‰©è³ªã®é›»å­é·ç§»ã‚’è¦³æ¸¬ã™ã‚‹åˆ†å…‰æ³•ã§ã‚ã‚Šã€ææ–™ç§‘å­¦ã«ãŠã‘ã‚‹å…‰å­¦ç‰¹æ€§è©•ä¾¡ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¸¬å®šã€é…ä½åŒ–åˆç‰©ã®é›»å­çŠ¶æ…‹è§£æã«ä¸å¯æ¬ ãªæ‰‹æ³•ã§ã™ã€‚æœ¬ç« ã§ã¯ã€é›»å­é·ç§»ã®ç†è«–çš„åŸºç¤ã‹ã‚‰ã€Lambert-Beerå‰‡ã®å®Ÿè·µçš„å¿œç”¨ã€Taucãƒ—ãƒ­ãƒƒãƒˆæ³•ã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ±ºå®šæ³•ã€é…ä½å­å ´ç†è«–ã«ã‚ˆã‚‹é·ç§»é‡‘å±éŒ¯ä½“ã®è§£é‡ˆã¾ã§ã€UV-Visåˆ†å…‰æ³•ã®åŸºç¤ã‹ã‚‰å®Ÿè·µã¾ã§ã‚’ä½“ç³»çš„ã«å­¦ã³ã¾ã™ã€‚</p>
    </div>

    <h2>3.1 é›»å­é·ç§»ã¨UV-Visåˆ†å…‰æ³•ã®åŸç†</h2>

    <h3>3.1.1 é›»å­é·ç§»ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼</h3>

    <p>UV-Visåˆ†å…‰æ³•ã§ã¯ã€ç´«å¤–ç·šï¼ˆ10-400 nmï¼‰ã‹ã‚‰å¯è¦–å…‰ï¼ˆ400-800 nmï¼‰ã®é ˜åŸŸã«ãŠã‘ã‚‹å…‰å¸åã‚’æ¸¬å®šã—ã¾ã™ã€‚ã“ã®æ³¢é•·é ˜åŸŸã¯ã€åˆ†å­ã®é›»å­é·ç§»ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆç´„1.5-6 eVï¼‰ã«å¯¾å¿œã—ã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>é›»å­é·ç§»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨æ³¢é•·ã®é–¢ä¿‚:</strong></p>
        \[
        E = h\nu = \frac{hc}{\lambda}
        \]
        <p>ã“ã“ã§ã€\( h = 6.626 \times 10^{-34} \) JÂ·s (Planckå®šæ•°)ã€\( c = 3.0 \times 10^8 \) m/s (å…‰é€Ÿ)ã€\( \lambda \)ã¯æ³¢é•·ã§ã™ã€‚</p>
        <p>æ³¢é•·ï¼ˆnmï¼‰ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰ã®å¤‰æ›å¼:</p>
        \[
        E\,(\text{eV}) = \frac{1239.8}{\lambda\,(\text{nm})}
        \]
    </div>

    <h3>3.1.2 é›»å­é·ç§»ã®ç¨®é¡</h3>

    <div class="key-concept">
        <h4>ä¸»è¦ãªé›»å­é·ç§»</h4>
        <ul>
            <li><strong>Ïƒ â†’ Ïƒ* é·ç§»:</strong> å˜çµåˆã®Ïƒè»Œé“ã‹ã‚‰åçµåˆæ€§Ïƒ*è»Œé“ã¸ã®é·ç§»ï¼ˆé ç´«å¤–åŸŸã€Î» < 200 nmï¼‰</li>
            <li><strong>n â†’ Ïƒ* é·ç§»:</strong> éå…±æœ‰é›»å­å¯¾ã‹ã‚‰åçµåˆæ€§Ïƒ*è»Œé“ã¸ã®é·ç§»ï¼ˆ150-250 nmï¼‰</li>
            <li><strong>Ï€ â†’ Ï€* é·ç§»:</strong> äºŒé‡çµåˆã®Ï€è»Œé“ã‹ã‚‰Ï€*è»Œé“ã¸ã®é·ç§»ï¼ˆ200-400 nmã€UV-Visã®ä¸»è¦é ˜åŸŸï¼‰</li>
            <li><strong>n â†’ Ï€* é·ç§»:</strong> éå…±æœ‰é›»å­å¯¾ã‹ã‚‰Ï€*è»Œé“ã¸ã®é·ç§»ï¼ˆ250-350 nmã€å¼±ã„å¸åï¼‰</li>
            <li><strong>d â†’ d é·ç§»:</strong> é·ç§»é‡‘å±éŒ¯ä½“ã®dè»Œé“é–“ã®é·ç§»ï¼ˆå¯è¦–åŸŸã€é…ä½å­å ´ç†è«–ã§èª¬æ˜ï¼‰</li>
            <li><strong>é›»è·ç§»å‹•é·ç§» (CT):</strong> é‡‘å±ã‹ã‚‰é…ä½å­ï¼ˆMLCTï¼‰ã€é…ä½å­ã‹ã‚‰é‡‘å±ï¼ˆLMCTï¼‰ã¸ã®é›»è·ç§»å‹•ï¼ˆå¼·ã„å¸åï¼‰</li>
        </ul>
    </div>

    <h3>3.1.3 HOMO-LUMOé·ç§»ã¨ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—</h3>

    <p>æœ‰æ©Ÿåˆ†å­ã‚„åŠå°ä½“ææ–™ã«ãŠã„ã¦ã€æœ€ã‚‚ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®é›»å­é·ç§»ã¯æœ€é«˜è¢«å è»Œé“ï¼ˆHOMOï¼‰ã‹ã‚‰æœ€ä½ç©ºè»Œé“ï¼ˆLUMOï¼‰ã¸ã®é·ç§»ã§ã™ã€‚ã“ã®é·ç§»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ã€åŠå°ä½“ã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— \( E_g \) ã«ç›¸å½“ã—ã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã¨UV-Viså¸åç«¯ã®é–¢ä¿‚:</strong></p>
        \[
        E_g = h\nu_{\text{onset}} = \frac{1239.8}{\lambda_{\text{onset}}\,(\text{nm})}
        \]
        <p>ã“ã“ã§ã€\( \lambda_{\text{onset}} \)ã¯å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ç«‹ã¡ä¸ŠãŒã‚Šæ³¢é•·ï¼ˆabsorption onsetï¼‰ã§ã™ã€‚</p>
    </div>

    <div class="mermaid">
    flowchart TD
        A[åŸºåº•çŠ¶æ…‹<br/>HOMOé›»å­é…ç½®] -->|å…‰å¸å hÎ½| B[åŠ±èµ·çŠ¶æ…‹<br/>LUMOé›»å­é…ç½®]
        B -->|è›å…‰ç™ºå…‰| C[åŸºåº•çŠ¶æ…‹<br/>ã‚¨ãƒãƒ«ã‚®ãƒ¼æ”¾å‡º]
        B -->|ç„¡æ”¾å°„å¤±æ´»| D[åŸºåº•çŠ¶æ…‹<br/>ç†±ã‚¨ãƒãƒ«ã‚®ãƒ¼]

        style A fill:#e3f2fd
        style B fill:#fff3e0
        style C fill:#e8f5e9
        style D fill:#fce4ec
    </mermaid>

    <h2>3.2 Lambert-Beerå‰‡ã®ç†è«–ã¨å¿œç”¨</h2>

    <h3>3.2.1 Lambert-Beerå‰‡ã®æ•°å­¦çš„è¡¨ç¾</h3>

    <p>Lambert-Beerå‰‡ã¯ã€æº¶æ¶²ã®å…‰å¸åã¨æ¿ƒåº¦ã®é–¢ä¿‚ã‚’è¨˜è¿°ã™ã‚‹åŸºæœ¬æ³•å‰‡ã§ã™ã€‚ç¬¬1ç« ã§å°å…¥ã—ãŸå¼ã‚’ã€UV-Visåˆ†å…‰æ³•ã®æ–‡è„ˆã§å†è€ƒã—ã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>å¸å…‰åº¦ã®å®šç¾©:</strong></p>
        \[
        A = \log_{10}\left(\frac{I_0}{I}\right) = \epsilon c l
        \]
        <p>ã“ã“ã§ã€\( A \)ã¯å¸å…‰åº¦ã€\( I_0 \)ã¯å…¥å°„å…‰å¼·åº¦ã€\( I \)ã¯é€éå…‰å¼·åº¦ã€\( \epsilon \)ã¯ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ï¼ˆL mol<sup>-1</sup> cm<sup>-1</sup>ï¼‰ã€\( c \)ã¯æ¿ƒåº¦ï¼ˆmol/Lï¼‰ã€\( l \)ã¯å…‰è·¯é•·ï¼ˆcmï¼‰ã§ã™ã€‚</p>

        <p><strong>é€éç‡ã¨ã®é–¢ä¿‚:</strong></p>
        \[
        T = \frac{I}{I_0} = 10^{-A}
        \]
        \[
        A = -\log_{10} T = 2 - \log_{10}(\%T)
        \]
    </div>

    <h3>3.2.2 ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ã®ç‰©ç†çš„æ„å‘³</h3>

    <p>ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° \( \epsilon \) ã¯ã€ç‰¹å®šæ³¢é•·ã«ãŠã‘ã‚‹ç‰©è³ªã®å…‰å¸åèƒ½åŠ›ã‚’è¡¨ã™å›ºæœ‰ã®ç‰©æ€§å€¤ã§ã™ã€‚å¤§ããª \( \epsilon \) å€¤ï¼ˆ\( \epsilon > 10^4 \) L mol<sup>-1</sup> cm<sup>-1</sup>ï¼‰ã¯è¨±å®¹é·ç§»ï¼ˆallowed transitionï¼‰ã‚’ç¤ºã—ã€å°ã•ãª \( \epsilon \) å€¤ï¼ˆ\( \epsilon < 10^3 \)ï¼‰ã¯ç¦åˆ¶é·ç§»ï¼ˆforbidden transitionï¼‰ã‚’ç¤ºã—ã¾ã™ã€‚</p>

    <table>
        <thead>
            <tr>
                <th>é·ç§»ã‚¿ã‚¤ãƒ—</th>
                <th>ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° Îµ (L mol<sup>-1</sup> cm<sup>-1</sup>)</th>
                <th>ä¾‹</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Ï€ â†’ Ï€* (å…±å½¹ç³»)</td>
                <td>10,000 - 100,000</td>
                <td>ãƒ™ãƒ³ã‚¼ãƒ³ã€ã‚¢ãƒ³ãƒˆãƒ©ã‚»ãƒ³</td>
            </tr>
            <tr>
                <td>n â†’ Ï€*</td>
                <td>10 - 1,000</td>
                <td>ã‚«ãƒ«ãƒœãƒ‹ãƒ«åŒ–åˆç‰©</td>
            </tr>
            <tr>
                <td>d â†’ d (é·ç§»é‡‘å±)</td>
                <td>1 - 100</td>
                <td>Cu<sup>2+</sup>, Ni<sup>2+</sup>éŒ¯ä½“</td>
            </tr>
            <tr>
                <td>é›»è·ç§»å‹• (CT)</td>
                <td>1,000 - 50,000</td>
                <td>MnO<sub>4</sub><sup>-</sup>, Fe-ãƒ•ã‚§ãƒŠãƒ³ãƒˆãƒ­ãƒªãƒ³</td>
            </tr>
        </tbody>
    </table>

    <h3>3.2.3 æ¤œé‡ç·šæ³•ã«ã‚ˆã‚‹å®šé‡åˆ†æ</h3>

    <p>Lambert-Beerå‰‡ã®ç·šå½¢æ€§ã‚’åˆ©ç”¨ã—ã¦ã€æœªçŸ¥è©¦æ–™ã®æ¿ƒåº¦ã‚’æ±ºå®šã§ãã¾ã™ã€‚æ—¢çŸ¥æ¿ƒåº¦ã®æ¨™æº–æº¶æ¶²ç³»åˆ—ã‚’æ¸¬å®šã—ã€å¸å…‰åº¦ \( A \) vs. æ¿ƒåº¦ \( c \) ã®æ¤œé‡ç·šï¼ˆcalibration curveï¼‰ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: Lambert-Beerå‰‡ã«ã‚ˆã‚‹æ¤œé‡ç·šã®ä½œæˆã¨å®šé‡åˆ†æ</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

def create_calibration_curve(concentrations, absorbances):
    """
    æ¤œé‡ç·šã‚’ä½œæˆã—ã€ç·šå½¢å›å¸°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¿”ã™

    Parameters:
    -----------
    concentrations : array-like
        æ¨™æº–æº¶æ¶²ã®æ¿ƒåº¦ (mol/L)
    absorbances : array-like
        å„æ¿ƒåº¦ã«ãŠã‘ã‚‹å¸å…‰åº¦

    Returns:
    --------
    slope : float
        æ¤œé‡ç·šã®å‚¾ãï¼ˆãƒ¢ãƒ«å¸å…‰ä¿‚æ•° Ã— å…‰è·¯é•·ï¼‰
    intercept : float
        åˆ‡ç‰‡ï¼ˆã‚¼ãƒ­ã§ã‚ã‚‹ã¹ãï¼‰
    r_value : float
        ç›¸é–¢ä¿‚æ•°
    """
    # ç·šå½¢å›å¸°
    slope, intercept, r_value, p_value, std_err = linregress(concentrations, absorbances)

    # ãƒ—ãƒ­ãƒƒãƒˆ
    plt.figure(figsize=(10, 6))
    plt.scatter(concentrations, absorbances, s=100, alpha=0.7, label='å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿')

    # å›å¸°ç›´ç·š
    conc_fit = np.linspace(0, max(concentrations)*1.1, 100)
    abs_fit = slope * conc_fit + intercept
    plt.plot(conc_fit, abs_fit, 'r--', linewidth=2,
             label=f'å›å¸°ç›´ç·š: A = {slope:.3f}c + {intercept:.4f}\nRÂ² = {r_value**2:.4f}')

    plt.xlabel('æ¿ƒåº¦ (mol/L)', fontsize=12)
    plt.ylabel('å¸å…‰åº¦', fontsize=12)
    plt.title('Lambert-Beerå‰‡ã«ã‚ˆã‚‹æ¤œé‡ç·š', fontsize=14, fontweight='bold')
    plt.legend()
    plt.grid(alpha=0.3)
    plt.tight_layout()
    plt.show()

    return slope, intercept, r_value

def determine_concentration(absorbance_sample, slope, intercept):
    """
    æ¤œé‡ç·šã‹ã‚‰æœªçŸ¥è©¦æ–™ã®æ¿ƒåº¦ã‚’æ±ºå®š

    Parameters:
    -----------
    absorbance_sample : float
        æœªçŸ¥è©¦æ–™ã®å¸å…‰åº¦
    slope : float
        æ¤œé‡ç·šã®å‚¾ã
    intercept : float
        æ¤œé‡ç·šã®åˆ‡ç‰‡

    Returns:
    --------
    concentration : float
        æœªçŸ¥è©¦æ–™ã®æ¿ƒåº¦ (mol/L)
    """
    concentration = (absorbance_sample - intercept) / slope
    return concentration

# å®Ÿè¡Œä¾‹ï¼šãƒ¡ãƒãƒ¬ãƒ³ãƒ–ãƒ«ãƒ¼ã®å®šé‡åˆ†æ
concentrations = np.array([0.5, 1.0, 2.0, 3.0, 4.0, 5.0]) * 1e-5  # mol/L
absorbances = np.array([0.12, 0.24, 0.48, 0.72, 0.96, 1.20])

slope, intercept, r_value = create_calibration_curve(concentrations, absorbances)

# å…‰è·¯é•· 1 cm ã®å ´åˆã€ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ã‚’è¨ˆç®—
epsilon = slope  # L mol^-1 cm^-1
print(f"ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° Îµ = {epsilon:.2e} L molâ»Â¹ cmâ»Â¹")

# æœªçŸ¥è©¦æ–™ã®æ¿ƒåº¦æ±ºå®š
A_unknown = 0.60
c_unknown = determine_concentration(A_unknown, slope, intercept)
print(f"æœªçŸ¥è©¦æ–™ã®æ¿ƒåº¦: {c_unknown:.2e} mol/L")
print(f"æ¤œé‡ç·šã®ç›¸é–¢ä¿‚æ•° RÂ² = {r_value**2:.4f}")
</code></pre>

    <h2>3.3 Taucãƒ—ãƒ­ãƒƒãƒˆæ³•ã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¸¬å®š</h2>

    <h3>3.3.1 Taucå‰‡ã®ç†è«–çš„èƒŒæ™¯</h3>

    <p>åŠå°ä½“ã‚„çµ¶ç¸ä½“ææ–™ã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’ç²¾å¯†ã«æ±ºå®šã™ã‚‹ãŸã‚ã€Jan Taucï¼ˆ1968ï¼‰ãŒææ¡ˆã—ãŸè§£ææ³•ãŒåºƒãç”¨ã„ã‚‰ã‚Œã¾ã™ã€‚Taucå‰‡ã¯ã€å¸åä¿‚æ•° \( \alpha \) ã¨å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ \( h\nu \) ã®é–¢ä¿‚ã‚’è¨˜è¿°ã—ã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>Taucå‰‡ï¼ˆç›´æ¥é·ç§»ï¼‰:</strong></p>
        \[
        (\alpha h\nu)^2 = B(h\nu - E_g)
        \]
        <p>ã“ã“ã§ã€\( B \)ã¯ææ–™å®šæ•°ã€\( E_g \)ã¯ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã§ã™ã€‚</p>

        <p><strong>Taucå‰‡ï¼ˆé–“æ¥é·ç§»ï¼‰:</strong></p>
        \[
        (\alpha h\nu)^{1/2} = B(h\nu - E_g)
        \]

        <p><strong>å¸åä¿‚æ•°ã®è¨ˆç®—:</strong></p>
        \[
        \alpha = \frac{2.303 \cdot A}{l}
        \]
        <p>ã“ã“ã§ã€\( A \)ã¯å¸å…‰åº¦ã€\( l \)ã¯è©¦æ–™åšã•ï¼ˆcmï¼‰ã§ã™ã€‚</p>
    </div>

    <h3>3.3.2 Taucãƒ—ãƒ­ãƒƒãƒˆã®ä½œæˆæ‰‹é †</h3>

    <ol>
        <li>UV-Viså¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’æ¸¬å®šã—ã€æ³¢é•· \( \lambda \) ã¨å¸å…‰åº¦ \( A \) ã‚’å–å¾—</li>
        <li>æ³¢é•·ã‚’å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ \( h\nu = 1239.8/\lambda \) (eV) ã«å¤‰æ›</li>
        <li>å¸å…‰åº¦ã‹ã‚‰å¸åä¿‚æ•° \( \alpha = 2.303 \cdot A/l \) ã‚’è¨ˆç®—</li>
        <li>ç›´æ¥é·ç§»ã®å ´åˆ: \( (\alpha h\nu)^2 \) vs. \( h\nu \) ã‚’ãƒ—ãƒ­ãƒƒãƒˆ</li>
        <li>é–“æ¥é·ç§»ã®å ´åˆ: \( (\alpha h\nu)^{1/2} \) vs. \( h\nu \) ã‚’ãƒ—ãƒ­ãƒƒãƒˆ</li>
        <li>å¸åç«¯ã®ç·šå½¢é ˜åŸŸã‚’å¤–æŒ¿ã—ã€æ¨ªè»¸ã¨ã®äº¤ç‚¹ã‹ã‚‰ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— \( E_g \) ã‚’æ±ºå®š</li>
    </ol>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: Taucãƒ—ãƒ­ãƒƒãƒˆæ³•ã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¸¬å®š</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def tauc_plot_direct(wavelength, absorbance, thickness_cm, plot_range=(2.0, 4.0)):
    """
    ç›´æ¥é·ç§»ææ–™ã®Taucãƒ—ãƒ­ãƒƒãƒˆã‚’ä½œæˆã—ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’æ±ºå®š

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· (nm)
    absorbance : array
        å¸å…‰åº¦
    thickness_cm : float
        è©¦æ–™åšã• (cm)
    plot_range : tuple
        ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã«ä½¿ç”¨ã™ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ç¯„å›² (eV)

    Returns:
    --------
    Eg : float
        ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— (eV)
    """
    # æ³¢é•·ã‚’å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«å¤‰æ›
    photon_energy = 1239.8 / wavelength  # eV

    # å¸åä¿‚æ•°ã‚’è¨ˆç®—
    alpha = 2.303 * absorbance / thickness_cm  # cm^-1

    # Taucãƒ—ãƒ­ãƒƒãƒˆ: (Î±hÎ½)^2
    tauc_y = (alpha * photon_energy)**2

    # ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ç¯„å›²ã®é¸æŠ
    mask = (photon_energy >= plot_range[0]) & (photon_energy <= plot_range[1])
    E_fit = photon_energy[mask]
    tauc_fit = tauc_y[mask]

    # ç·šå½¢ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
    def linear(x, B, Eg):
        return B * (x - Eg)

    popt, pcov = curve_fit(linear, E_fit, tauc_fit, p0=[1e10, 3.0])
    B, Eg = popt

    # ãƒ—ãƒ­ãƒƒãƒˆ
    plt.figure(figsize=(10, 6))
    plt.plot(photon_energy, tauc_y, 'o-', label='å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿', alpha=0.7)

    # ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ç›´ç·š
    E_extended = np.linspace(Eg - 0.5, plot_range[1], 100)
    tauc_extended = linear(E_extended, B, Eg)
    plt.plot(E_extended, tauc_extended, 'r--', linewidth=2,
             label=f'ç·šå½¢ãƒ•ã‚£ãƒƒãƒˆ\nEg = {Eg:.3f} eV')

    # ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ä½ç½®ã‚’å¼·èª¿
    plt.axvline(Eg, color='green', linestyle=':', linewidth=2, label=f'Bandgap: {Eg:.3f} eV')
    plt.axhline(0, color='black', linestyle='-', linewidth=0.5)

    plt.xlabel('å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
    plt.ylabel('(Î±hÎ½)Â² (eVÂ² cmâ»Â²)', fontsize=12)
    plt.title('Taucãƒ—ãƒ­ãƒƒãƒˆï¼ˆç›´æ¥é·ç§»ï¼‰', fontsize=14, fontweight='bold')
    plt.legend()
    plt.grid(alpha=0.3)
    plt.xlim(photon_energy.min(), photon_energy.max())
    plt.tight_layout()
    plt.show()

    print(f"æ±ºå®šã•ã‚ŒãŸãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: Eg = {Eg:.3f} eV")
    print(f"å¯¾å¿œã™ã‚‹æ³¢é•·: Î» = {1239.8/Eg:.1f} nm")

    return Eg

def tauc_plot_indirect(wavelength, absorbance, thickness_cm, plot_range=(1.5, 3.0)):
    """
    é–“æ¥é·ç§»ææ–™ã®Taucãƒ—ãƒ­ãƒƒãƒˆã‚’ä½œæˆã—ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’æ±ºå®š

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· (nm)
    absorbance : array
        å¸å…‰åº¦
    thickness_cm : float
        è©¦æ–™åšã• (cm)
    plot_range : tuple
        ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã«ä½¿ç”¨ã™ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ç¯„å›² (eV)

    Returns:
    --------
    Eg : float
        ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— (eV)
    """
    # æ³¢é•·ã‚’å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«å¤‰æ›
    photon_energy = 1239.8 / wavelength  # eV

    # å¸åä¿‚æ•°ã‚’è¨ˆç®—
    alpha = 2.303 * absorbance / thickness_cm  # cm^-1

    # Taucãƒ—ãƒ­ãƒƒãƒˆ: (Î±hÎ½)^(1/2)
    tauc_y = np.sqrt(alpha * photon_energy)

    # ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ç¯„å›²ã®é¸æŠ
    mask = (photon_energy >= plot_range[0]) & (photon_energy <= plot_range[1])
    E_fit = photon_energy[mask]
    tauc_fit = tauc_y[mask]

    # ç·šå½¢ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
    def linear(x, B, Eg):
        return B * (x - Eg)

    popt, pcov = curve_fit(linear, E_fit, tauc_fit, p0=[100, 2.0])
    B, Eg = popt

    # ãƒ—ãƒ­ãƒƒãƒˆ
    plt.figure(figsize=(10, 6))
    plt.plot(photon_energy, tauc_y, 'o-', label='å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿', alpha=0.7)

    # ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ç›´ç·š
    E_extended = np.linspace(Eg - 0.3, plot_range[1], 100)
    tauc_extended = linear(E_extended, B, Eg)
    plt.plot(E_extended, tauc_extended, 'r--', linewidth=2,
             label=f'ç·šå½¢ãƒ•ã‚£ãƒƒãƒˆ\nEg = {Eg:.3f} eV')

    # ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ä½ç½®ã‚’å¼·èª¿
    plt.axvline(Eg, color='green', linestyle=':', linewidth=2, label=f'Bandgap: {Eg:.3f} eV')
    plt.axhline(0, color='black', linestyle='-', linewidth=0.5)

    plt.xlabel('å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
    plt.ylabel('(Î±hÎ½)^(1/2) (eV^(1/2) cm^(-1/2))', fontsize=12)
    plt.title('Taucãƒ—ãƒ­ãƒƒãƒˆï¼ˆé–“æ¥é·ç§»ï¼‰', fontsize=14, fontweight='bold')
    plt.legend()
    plt.grid(alpha=0.3)
    plt.xlim(photon_energy.min(), photon_energy.max())
    plt.tight_layout()
    plt.show()

    print(f"æ±ºå®šã•ã‚ŒãŸãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: Eg = {Eg:.3f} eV")
    print(f"å¯¾å¿œã™ã‚‹æ³¢é•·: Î» = {1239.8/Eg:.1f} nm")

    return Eg

# å®Ÿè¡Œä¾‹ï¼šTiOâ‚‚ãƒŠãƒç²’å­ï¼ˆç›´æ¥é·ç§»ã€Eg â‰ˆ 3.2 eVï¼‰
wavelength_nm = np.linspace(300, 500, 200)
# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã«ã¯åˆ†å…‰å…‰åº¦è¨ˆã‹ã‚‰å–å¾—ï¼‰
Eg_true = 3.2  # eV
alpha_true = 1e4 * np.maximum(0, (1239.8/wavelength_nm - Eg_true))**2
absorbance_sim = alpha_true * 0.01 / 2.303  # è©¦æ–™åšã• 0.01 cm

Eg_measured = tauc_plot_direct(wavelength_nm, absorbance_sim, thickness_cm=0.01)
</code></pre>

    <h2>3.4 é…ä½å­å ´ç†è«–ã¨d-dé·ç§»</h2>

    <h3>3.4.1 é…ä½å­å ´åˆ†è£‚ã‚¨ãƒãƒ«ã‚®ãƒ¼</h3>

    <p>é·ç§»é‡‘å±éŒ¯ä½“ï¼ˆCu<sup>2+</sup>, Ni<sup>2+</sup>, Co<sup>2+</sup>ãªã©ï¼‰ã¯ã€å¯è¦–åŸŸã«ç‰¹å¾´çš„ãªè‰²ã‚’ç¤ºã—ã¾ã™ã€‚ã“ã‚Œã¯ã€é…ä½å­ã«ã‚ˆã‚‹é™é›»å ´ã®å½±éŸ¿ã§dè»Œé“ãŒåˆ†è£‚ã—ã€d-dé·ç§»ãŒå¯è¦–å…‰ã®å¸åã‚’å¼•ãèµ·ã“ã™ãŸã‚ã§ã™ã€‚</p>

    <div class="key-concept">
        <h4>å…«é¢ä½“é…ä½å­å ´ï¼ˆO<sub>h</sub>å¯¾ç§°æ€§ï¼‰ã®dè»Œé“åˆ†è£‚</h4>
        <ul>
            <li><strong>e<sub>g</sub>è»Œé“ï¼ˆé«˜ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰:</strong> d<sub>zÂ²</sub>, d<sub>xÂ²-yÂ²</sub> ï¼ˆé…ä½å­ã¨ç›´æ¥å¯¾å‘ã€åç™ºå¤§ï¼‰</li>
            <li><strong>t<sub>2g</sub>è»Œé“ï¼ˆä½ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰:</strong> d<sub>xy</sub>, d<sub>xz</sub>, d<sub>yz</sub> ï¼ˆé…ä½å­ã¨ã®åç™ºå°ï¼‰</li>
        </ul>
        <p>åˆ†è£‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ \( \Delta_o \)ï¼ˆ10Dqï¼‰ã¯ã€éŒ¯ä½“ã®è‰²ã¨ç›´æ¥é–¢ä¿‚ã—ã¾ã™ï¼š</p>
        \[
        \Delta_o = h\nu = \frac{hc}{\lambda}
        \]
    </div>

    <div class="mermaid">
    flowchart TB
        A[è‡ªç”±ã‚¤ã‚ªãƒ³<br/>5ã¤ã®dè»Œé“ç¸®é€€] -->|å…«é¢ä½“é…ä½å­å ´| B[e_gè»Œé“<br/>é«˜ã‚¨ãƒãƒ«ã‚®ãƒ¼]
        A -->|å…«é¢ä½“é…ä½å­å ´| C[t_2gè»Œé“<br/>ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼]

        B -.->|d-dé·ç§»<br/>å…‰å¸å| C

        D[dé›»å­é…ç½®<br/>åŸºåº•çŠ¶æ…‹] -->|å¯è¦–å…‰å¸å| E[dé›»å­é…ç½®<br/>åŠ±èµ·çŠ¶æ…‹]

        style A fill:#e3f2fd
        style B fill:#ffebee
        style C fill:#e8f5e9
        style D fill:#fff3e0
        style E fill:#fce4ec
    </mermaid>

    <h3>3.4.2 åˆ†å…‰åŒ–å­¦ç³»åˆ—</h3>

    <p>é…ä½å­ã®ç¨®é¡ã«ã‚ˆã£ã¦ã€åˆ†è£‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ \( \Delta_o \) ã®å¤§ãã•ãŒå¤‰åŒ–ã—ã¾ã™ã€‚ã“ã‚Œã‚’åˆ†å…‰åŒ–å­¦ç³»åˆ—ï¼ˆspectrochemical seriesï¼‰ã¨å‘¼ã³ã¾ã™ï¼š</p>

    <div class="equation-box">
        <p><strong>åˆ†å…‰åŒ–å­¦ç³»åˆ—ï¼ˆé…ä½å­ã®å¼·åº¦é †ï¼‰:</strong></p>
        \[
        \text{I}^- < \text{Br}^- < \text{Cl}^- < \text{F}^- < \text{OH}^- < \text{H}_2\text{O} < \text{NH}_3 < \text{en} < \text{NO}_2^- < \text{CN}^- < \text{CO}
        \]
        <p>å¼±å ´é…ä½å­ï¼ˆå·¦å´ï¼‰â†’ å°ã•ã„ \( \Delta_o \)ã€é•·æ³¢é•·å¸åï¼ˆèµ¤è‰²ãƒ»é»„è‰²ï¼‰</p>
        <p>å¼·å ´é…ä½å­ï¼ˆå³å´ï¼‰â†’ å¤§ãã„ \( \Delta_o \)ã€çŸ­æ³¢é•·å¸åï¼ˆé’è‰²ãƒ»ç´«è‰²ï¼‰</p>
    </div>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: é…ä½å­å ´ç†è«–ã«ã‚ˆã‚‹é·ç§»é‡‘å±éŒ¯ä½“ã®è‰²äºˆæ¸¬</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import Rectangle

def predict_complex_color(delta_o_cm, d_electron_count, geometry='octahedral'):
    """
    é…ä½å­å ´åˆ†è£‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‹ã‚‰d-dé·ç§»æ³¢é•·ã¨éŒ¯ä½“ã®è‰²ã‚’äºˆæ¸¬

    Parameters:
    -----------
    delta_o_cm : float
        é…ä½å­å ´åˆ†è£‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ (cm^-1)
    d_electron_count : int
        dé›»å­æ•°ï¼ˆ1-10ï¼‰
    geometry : str
        é…ä½æ§‹é€ ï¼ˆ'octahedral' or 'tetrahedral'ï¼‰

    Returns:
    --------
    wavelength_nm : float
        d-dé·ç§»ã®æ³¢é•· (nm)
    observed_color : str
        è¦³æ¸¬ã•ã‚Œã‚‹éŒ¯ä½“ã®è‰²ï¼ˆè£œè‰²ï¼‰
    """
    # æ³¢é•·ã«å¤‰æ›
    wavelength_nm = 1e7 / delta_o_cm  # nm

    # å¸åã•ã‚Œã‚‹å…‰ã®è‰²
    if wavelength_nm < 450:
        absorbed_color = 'ç´«'
        observed_color = 'é»„ç·‘'
    elif wavelength_nm < 495:
        absorbed_color = 'é’'
        observed_color = 'é»„è‰²'
    elif wavelength_nm < 570:
        absorbed_color = 'ç·‘'
        observed_color = 'èµ¤ç´«'
    elif wavelength_nm < 590:
        absorbed_color = 'é»„'
        observed_color = 'é’ç´«'
    elif wavelength_nm < 620:
        absorbed_color = 'æ©™'
        observed_color = 'é’'
    elif wavelength_nm < 750:
        absorbed_color = 'èµ¤'
        observed_color = 'ç·‘'
    else:
        absorbed_color = 'èµ¤å¤–'
        observed_color = 'ç„¡è‰²ï¼ˆèµ¤å¤–å¸åï¼‰'

    print(f"é…ä½å­å ´åˆ†è£‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ Î”o = {delta_o_cm:.0f} cmâ»Â¹")
    print(f"d-dé·ç§»æ³¢é•·: Î» = {wavelength_nm:.1f} nm")
    print(f"å¸åã•ã‚Œã‚‹å…‰: {absorbed_color}ï¼ˆ{wavelength_nm:.1f} nmï¼‰")
    print(f"è¦³æ¸¬ã•ã‚Œã‚‹éŒ¯ä½“ã®è‰²: {observed_color}ï¼ˆè£œè‰²ï¼‰")
    print(f"dé›»å­æ•°: d^{d_electron_count}ï¼ˆ{geometry}é…ä½ï¼‰")

    return wavelength_nm, observed_color

def plot_spectrochemical_series():
    """
    ä»£è¡¨çš„ãªé·ç§»é‡‘å±éŒ¯ä½“ã®åˆ†å…‰åŒ–å­¦ç³»åˆ—ã‚’å¯è¦–åŒ–
    """
    # ä»£è¡¨çš„ãªéŒ¯ä½“ã®Î”oãƒ‡ãƒ¼ã‚¿ï¼ˆcm^-1ï¼‰
    complexes = [
        '[Ti(H2O)6]3+',
        '[V(H2O)6]3+',
        '[Cr(H2O)6]3+',
        '[Mn(H2O)6]2+',
        '[Fe(H2O)6]2+',
        '[Co(H2O)6]2+',
        '[Ni(H2O)6]2+',
        '[Cu(H2O)6]2+',
        '[Co(NH3)6]3+',
        '[Cr(CN)6]3-'
    ]

    delta_o_values = np.array([20300, 18900, 17400, 21000, 10400, 9300, 8500, 12600, 22900, 26600])
    wavelengths = 1e7 / delta_o_values  # nm

    fig, ax = plt.subplots(figsize=(12, 8))

    # å„éŒ¯ä½“ã®å¸åæ³¢é•·ã‚’è‰²ä»˜ããƒãƒ¼ã§è¡¨ç¤º
    colors_map = {
        (380, 450): ('#8B00FF', 'é»„ç·‘'),
        (450, 495): ('#0000FF', 'é»„è‰²'),
        (495, 570): ('#00FF00', 'èµ¤ç´«'),
        (570, 590): ('#FFFF00', 'é’ç´«'),
        (590, 620): ('#FFA500', 'é’'),
        (620, 750): ('#FF0000', 'ç·‘')
    }

    for i, (name, wl) in enumerate(zip(complexes, wavelengths)):
        # å¸åæ³¢é•·ã«å¯¾å¿œã™ã‚‹è‰²
        color = '#808080'  # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚°ãƒ¬ãƒ¼
        observed = 'ä¸æ˜'
        for (wl_min, wl_max), (c, obs) in colors_map.items():
            if wl_min <= wl < wl_max:
                color = c
                observed = obs
                break

        ax.barh(i, wl, color=color, alpha=0.7, edgecolor='black', linewidth=1.5)
        ax.text(wl + 20, i, f'{wl:.1f} nm\nè¦³æ¸¬è‰²: {observed}',
                va='center', fontsize=9, fontweight='bold')

    ax.set_yticks(range(len(complexes)))
    ax.set_yticklabels(complexes, fontsize=11)
    ax.set_xlabel('d-dé·ç§»æ³¢é•· (nm)', fontsize=12)
    ax.set_title('é·ç§»é‡‘å±éŒ¯ä½“ã®åˆ†å…‰åŒ–å­¦ç³»åˆ—ã¨d-dé·ç§»æ³¢é•·', fontsize=14, fontweight='bold')
    ax.set_xlim(0, 800)
    ax.grid(axis='x', alpha=0.3)

    # å¯è¦–å…‰é ˜åŸŸã‚’å¼·èª¿
    ax.axvspan(380, 750, alpha=0.1, color='yellow', label='å¯è¦–å…‰é ˜åŸŸ')
    ax.legend()

    plt.tight_layout()
    plt.show()

# å®Ÿè¡Œä¾‹1: [Cu(H2O)6]2+ã®è‰²äºˆæ¸¬ï¼ˆd^9é›»å­é…ç½®ï¼‰
delta_o_cu = 12600  # cm^-1
wavelength, color = predict_complex_color(delta_o_cu, d_electron_count=9)

print("\n" + "="*50)
# å®Ÿè¡Œä¾‹2: [Cr(NH3)6]3+ã®è‰²äºˆæ¸¬ï¼ˆd^3é›»å­é…ç½®ã€å¼·å ´é…ä½å­ï¼‰
delta_o_cr = 21500  # cm^-1
wavelength2, color2 = predict_complex_color(delta_o_cr, d_electron_count=3)

# åˆ†å…‰åŒ–å­¦ç³»åˆ—ã®ãƒ—ãƒ­ãƒƒãƒˆ
plot_spectrochemical_series()
</code></pre>

    <h2>3.5 é›»è·ç§»å‹•é·ç§»ï¼ˆCharge Transfer Transitionï¼‰</h2>

    <h3>3.5.1 LMCTé·ç§»ã¨MLCTé·ç§»</h3>

    <p>é›»è·ç§»å‹•é·ç§»ã¯ã€d-dé·ç§»ã‚ˆã‚Šã‚‚å¤§ããªãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ï¼ˆ\( \epsilon > 10^4 \)ï¼‰ã‚’æŒã¡ã€å¼·ã„è‰²ã‚’ç¤ºã—ã¾ã™ã€‚</p>

    <div class="key-concept">
        <h4>é›»è·ç§»å‹•é·ç§»ã®åˆ†é¡</h4>
        <ul>
            <li><strong>LMCTï¼ˆLigand-to-Metal Charge Transferï¼‰:</strong> é…ä½å­ã®é›»å­ãŒé‡‘å±ã‚¤ã‚ªãƒ³ã¸ç§»å‹•ã™ã‚‹é·ç§»ã€‚ä¾‹ï¼šMnO<sub>4</sub><sup>-</sup>ï¼ˆç´«è‰²ï¼‰ã€CrO<sub>4</sub><sup>2-</sup>ï¼ˆé»„è‰²ï¼‰</li>
            <li><strong>MLCTï¼ˆMetal-to-Ligand Charge Transferï¼‰:</strong> é‡‘å±ã‚¤ã‚ªãƒ³ã®é›»å­ãŒé…ä½å­ã¸ç§»å‹•ã™ã‚‹é·ç§»ã€‚ä¾‹ï¼šFe(II)-ãƒ•ã‚§ãƒŠãƒ³ãƒˆãƒ­ãƒªãƒ³éŒ¯ä½“ï¼ˆèµ¤è‰²ï¼‰ã€Ru(bpy)<sub>3</sub><sup>2+</sup>ï¼ˆæ©™è‰²ï¼‰</li>
        </ul>
    </div>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: éãƒãƒ³ã‚¬ãƒ³é…¸ã‚¤ã‚ªãƒ³ã®LMCTé·ç§»è§£æ</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def simulate_lmct_spectrum(wavelength, lambda_max, epsilon_max, bandwidth):
    """
    LMCTé·ç§»ã®UV-Visã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’ã‚¬ã‚¦ã‚¹é–¢æ•°ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· (nm)
    lambda_max : float
        å¸åæ¥µå¤§æ³¢é•· (nm)
    epsilon_max : float
        æœ€å¤§ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° (L mol^-1 cm^-1)
    bandwidth : float
        å¸åãƒãƒ³ãƒ‰ã®å¹…ï¼ˆåŠå€¤å…¨å¹…, nmï¼‰

    Returns:
    --------
    epsilon : array
        å„æ³¢é•·ã«ãŠã‘ã‚‹ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°
    """
    sigma = bandwidth / (2 * np.sqrt(2 * np.log(2)))
    epsilon = epsilon_max * np.exp(-((wavelength - lambda_max)**2) / (2 * sigma**2))
    return epsilon

# MnO4^- ã®LMCTé·ç§»ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
wavelength = np.linspace(400, 700, 300)

# MnO4^- ã¯526 nmï¼ˆç·‘è‰²ï¼‰ã«å¼·ã„å¸å â†’ ç´«è‰²ã«è¦‹ãˆã‚‹
epsilon_mno4 = simulate_lmct_spectrum(wavelength, lambda_max=526, epsilon_max=2300, bandwidth=80)

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ—ãƒ­ãƒƒãƒˆ
ax1.plot(wavelength, epsilon_mno4, linewidth=2, color='purple', label='MnOâ‚„â» LMCTé·ç§»')
ax1.axvline(526, color='green', linestyle='--', linewidth=1.5, label='å¸åæ¥µå¤§ (526 nm)')
ax1.fill_between(wavelength, epsilon_mno4, alpha=0.3, color='purple')
ax1.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax1.set_ylabel('ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° Îµ (L molâ»Â¹ cmâ»Â¹)', fontsize=12)
ax1.set_title('MnOâ‚„â» ã® LMCTé·ç§»ã‚¹ãƒšã‚¯ãƒˆãƒ«', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(alpha=0.3)

# å¯è¦–å…‰ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨è¦³æ¸¬è‰²
visible_colors = [
    (380, 450, '#8B00FF'),
    (450, 495, '#0000FF'),
    (495, 570, '#00FF00'),
    (570, 590, '#FFFF00'),
    (590, 620, '#FFA500'),
    (620, 750, '#FF0000')
]

for wl_min, wl_max, color in visible_colors:
    ax2.axvspan(wl_min, wl_max, color=color, alpha=0.7)

ax2.axvline(526, color='black', linestyle='--', linewidth=2, label='MnOâ‚„â» å¸å (526 nm)')
ax2.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax2.set_title('å¯è¦–å…‰ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨MnOâ‚„â»ã®å¸å', fontsize=14, fontweight='bold')
ax2.set_xlim(380, 750)
ax2.set_yticks([])
ax2.legend()

plt.tight_layout()
plt.show()

print("MnOâ‚„â» ã‚¤ã‚ªãƒ³:")
print("- å¸åæ¥µå¤§: 526 nmï¼ˆç·‘è‰²ï¼‰")
print("- è¦³æ¸¬è‰²: ç´«è‰²ï¼ˆç·‘ã®è£œè‰²ï¼‰")
print("- é·ç§»ã‚¿ã‚¤ãƒ—: LMCTï¼ˆé…ä½å­OÂ²â» â†’ Mnâ·âºï¼‰")
print("- ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°: Îµ â‰ˆ 2300 L molâ»Â¹ cmâ»Â¹ï¼ˆå¼·ã„å¸åï¼‰")
</code></pre>

    <h2>3.6 æº¶åª’åŠ¹æœã¨æº¶åª’ã‚·ãƒ•ãƒˆ</h2>

    <h3>3.6.1 æº¶åª’æ¥µæ€§ã«ã‚ˆã‚‹å¸åæ³¢é•·å¤‰åŒ–</h3>

    <p>æº¶åª’ã®æ¥µæ€§ã¯ã€æº¶è³ªåˆ†å­ã®é›»å­çŠ¶æ…‹ã‚’å®‰å®šåŒ–ã¾ãŸã¯ä¸å®‰å®šåŒ–ã—ã€å¸åæ³¢é•·ã‚’ã‚·ãƒ•ãƒˆã•ã›ã¾ã™ã€‚</p>

    <div class="key-concept">
        <h4>æº¶åª’ã‚·ãƒ•ãƒˆã®åˆ†é¡</h4>
        <ul>
            <li><strong>Red shiftï¼ˆbathochromic shiftï¼‰:</strong> é•·æ³¢é•·å´ã¸ã®ã‚·ãƒ•ãƒˆã€‚æ¥µæ€§æº¶åª’ãŒåŠ±èµ·çŠ¶æ…‹ã‚’ã‚ˆã‚Šå®‰å®šåŒ–ã™ã‚‹å ´åˆã€‚</li>
            <li><strong>Blue shiftï¼ˆhypsochromic shiftï¼‰:</strong> çŸ­æ³¢é•·å´ã¸ã®ã‚·ãƒ•ãƒˆã€‚æ¥µæ€§æº¶åª’ãŒåŸºåº•çŠ¶æ…‹ã‚’ã‚ˆã‚Šå®‰å®šåŒ–ã™ã‚‹å ´åˆã€‚</li>
        </ul>
    </div>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: æº¶åª’æ¥µæ€§ã«ã‚ˆã‚‹å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚·ãƒ•ãƒˆã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def simulate_solvent_shift(wavelength, lambda_max_nonpolar, shift_per_polarity_unit):
    """
    æº¶åª’æ¥µæ€§ã«ã‚ˆã‚‹å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ã‚·ãƒ•ãƒˆã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· (nm)
    lambda_max_nonpolar : float
        éæ¥µæ€§æº¶åª’ä¸­ã®å¸åæ¥µå¤§æ³¢é•· (nm)
    shift_per_polarity_unit : float
        æº¶åª’æ¥µæ€§1å˜ä½ã‚ãŸã‚Šã®ã‚·ãƒ•ãƒˆé‡ (nm)

    Returns:
    --------
    spectra : dict
        å„æº¶åª’ã«ãŠã‘ã‚‹ã‚¹ãƒšã‚¯ãƒˆãƒ«
    """
    solvents = {
        'ãƒ˜ã‚­ã‚µãƒ³': 0.0,
        'ã‚¨ã‚¿ãƒãƒ¼ãƒ«': 5.2,
        'ãƒ¡ã‚¿ãƒãƒ¼ãƒ«': 6.6,
        'æ°´': 9.0,
        'DMSO': 7.2
    }

    fig, ax = plt.subplots(figsize=(12, 7))

    colors = ['blue', 'green', 'orange', 'red', 'purple']

    for (solvent, polarity), color in zip(solvents.items(), colors):
        lambda_max = lambda_max_nonpolar + shift_per_polarity_unit * polarity

        # ã‚¬ã‚¦ã‚¹å‹å¸åãƒãƒ³ãƒ‰
        sigma = 30
        absorbance = np.exp(-((wavelength - lambda_max)**2) / (2 * sigma**2))

        ax.plot(wavelength, absorbance, linewidth=2, label=f'{solvent} (Î»max = {lambda_max:.1f} nm)', color=color)
        ax.axvline(lambda_max, linestyle='--', linewidth=1, color=color, alpha=0.5)

    ax.set_xlabel('æ³¢é•· (nm)', fontsize=12)
    ax.set_ylabel('è¦æ ¼åŒ–å¸å…‰åº¦', fontsize=12)
    ax.set_title('æº¶åª’æ¥µæ€§ã«ã‚ˆã‚‹å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã®Red Shift', fontsize=14, fontweight='bold')
    ax.legend(fontsize=10)
    ax.grid(alpha=0.3)
    plt.tight_layout()
    plt.show()

# Ï€ â†’ Ï€* é·ç§»åˆ†å­ã®solvatochromismï¼ˆæº¶åª’ç™ºè‰²ï¼‰
wavelength = np.linspace(300, 500, 200)
simulate_solvent_shift(wavelength, lambda_max_nonpolar=350, shift_per_polarity_unit=3.0)

print("æº¶åª’æ¥µæ€§ã«ã‚ˆã‚‹å¸åæ³¢é•·ã‚·ãƒ•ãƒˆ:")
print("- æ¥µæ€§æº¶åª’ â†’ åŠ±èµ·çŠ¶æ…‹å®‰å®šåŒ– â†’ Red shiftï¼ˆé•·æ³¢é•·ã‚·ãƒ•ãƒˆï¼‰")
print("- éæ¥µæ€§æº¶åª’ â†’ ã‚·ãƒ•ãƒˆãªã—")
print("- Ï€ â†’ Ï€* é·ç§»ï¼ˆæ¥µæ€§å¤§ï¼‰ã¯Red shiftã—ã‚„ã™ã„")
print("- n â†’ Ï€* é·ç§»ï¼ˆæ¥µæ€§å°ï¼‰ã¯Blue shiftã™ã‚‹ã“ã¨ã‚‚ã‚ã‚‹")
</code></pre>

    <h2>3.7 ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ã¨ã‚¹ãƒšã‚¯ãƒˆãƒ«å‰å‡¦ç†</h2>

    <h3>3.7.1 æ•£ä¹±å…‰è£œæ­£</h3>

    <p>å›ºä½“è©¦æ–™ã‚„æ‡¸æ¿æ¶²ã®æ¸¬å®šã§ã¯ã€æ•£ä¹±å…‰ãŒãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ã‚’æ­ªã‚ã¾ã™ã€‚é©åˆ‡ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ãŒå¿…è¦ã§ã™ã€‚</p>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ã¨æ•£ä¹±å…‰é™¤å»</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import savgol_filter
from scipy.interpolate import UnivariateSpline

def baseline_correction_polynomial(wavelength, absorbance, baseline_region, poly_order=2):
    """
    å¤šé …å¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· (nm)
    absorbance : array
        ç”Ÿã®å¸å…‰åº¦ãƒ‡ãƒ¼ã‚¿
    baseline_region : tuple
        ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³é ˜åŸŸã®æ³¢é•·ç¯„å›² (nm)
    poly_order : int
        å¤šé …å¼ã®æ¬¡æ•°

    Returns:
    --------
    corrected_absorbance : array
        è£œæ­£å¾Œã®å¸å…‰åº¦
    """
    # ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³é ˜åŸŸã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
    mask = (wavelength >= baseline_region[0]) & (wavelength <= baseline_region[1])
    wl_base = wavelength[mask]
    abs_base = absorbance[mask]

    # å¤šé …å¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
    poly_coef = np.polyfit(wl_base, abs_base, poly_order)
    baseline = np.polyval(poly_coef, wavelength)

    # ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ¸›ç®—
    corrected_absorbance = absorbance - baseline

    return corrected_absorbance, baseline

def baseline_correction_spline(wavelength, absorbance, baseline_points):
    """
    ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“ã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· (nm)
    absorbance : array
        ç”Ÿã®å¸å…‰åº¦ãƒ‡ãƒ¼ã‚¿
    baseline_points : list of tuples
        ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãƒã‚¤ãƒ³ãƒˆ [(wl1, abs1), (wl2, abs2), ...]

    Returns:
    --------
    corrected_absorbance : array
        è£œæ­£å¾Œã®å¸å…‰åº¦
    """
    wl_base = np.array([p[0] for p in baseline_points])
    abs_base = np.array([p[1] for p in baseline_points])

    # ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“
    spline = UnivariateSpline(wl_base, abs_base, s=0, k=3)
    baseline = spline(wavelength)

    # ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ¸›ç®—
    corrected_absorbance = absorbance - baseline

    return corrected_absorbance, baseline

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ï¼šæ•£ä¹±å…‰ã‚’å«ã‚€ã‚¹ãƒšã‚¯ãƒˆãƒ«
wavelength = np.linspace(300, 700, 400)

# çœŸã®å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆã‚¬ã‚¦ã‚¹å‹ãƒ”ãƒ¼ã‚¯ï¼‰
true_abs = 0.8 * np.exp(-((wavelength - 450)**2) / (2 * 50**2))

# æ•£ä¹±å…‰ã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼ˆæ³¢é•·ã®é€†ã¹ãä¹—ã«æ¯”ä¾‹ï¼‰
scattering_baseline = 0.3 * (wavelength / 300)**(-4)

# ãƒã‚¤ã‚º
noise = np.random.normal(0, 0.01, len(wavelength))

# è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«
observed_abs = true_abs + scattering_baseline + noise

# ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ï¼ˆå¤šé …å¼ï¼‰
corrected_abs_poly, baseline_poly = baseline_correction_polynomial(
    wavelength, observed_abs, baseline_region=(600, 700), poly_order=3
)

# ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ï¼ˆã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ï¼‰
baseline_points = [(300, observed_abs[0]), (380, observed_abs[80]),
                   (600, observed_abs[300]), (700, observed_abs[-1])]
corrected_abs_spline, baseline_spline = baseline_correction_spline(
    wavelength, observed_abs, baseline_points
)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
axes[0, 0].plot(wavelength, observed_abs, label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆæ•£ä¹±å…‰å«ã‚€ï¼‰', color='blue')
axes[0, 0].plot(wavelength, true_abs, '--', label='çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«', color='red', linewidth=2)
axes[0, 0].plot(wavelength, scattering_baseline, ':', label='æ•£ä¹±ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³', color='green', linewidth=2)
axes[0, 0].set_xlabel('æ³¢é•· (nm)')
axes[0, 0].set_ylabel('å¸å…‰åº¦')
axes[0, 0].set_title('æ•£ä¹±å…‰ã‚’å«ã‚€è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«')
axes[0, 0].legend()
axes[0, 0].grid(alpha=0.3)

# å¤šé …å¼ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£
axes[0, 1].plot(wavelength, observed_abs, label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«', color='blue', alpha=0.5)
axes[0, 1].plot(wavelength, baseline_poly, '--', label='å¤šé …å¼ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³', color='orange', linewidth=2)
axes[0, 1].set_xlabel('æ³¢é•· (nm)')
axes[0, 1].set_ylabel('å¸å…‰åº¦')
axes[0, 1].set_title('å¤šé …å¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°')
axes[0, 1].legend()
axes[0, 1].grid(alpha=0.3)

# ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£
axes[1, 0].plot(wavelength, observed_abs, label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«', color='blue', alpha=0.5)
axes[1, 0].plot(wavelength, baseline_spline, '--', label='ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³', color='purple', linewidth=2)
for wl, abs_val in baseline_points:
    axes[1, 0].plot(wl, abs_val, 'ro', markersize=8)
axes[1, 0].set_xlabel('æ³¢é•· (nm)')
axes[1, 0].set_ylabel('å¸å…‰åº¦')
axes[1, 0].set_title('ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“')
axes[1, 0].legend()
axes[1, 0].grid(alpha=0.3)

# è£œæ­£çµæœæ¯”è¼ƒ
axes[1, 1].plot(wavelength, true_abs, '--', label='çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«', color='red', linewidth=2)
axes[1, 1].plot(wavelength, corrected_abs_poly, label='å¤šé …å¼è£œæ­£', color='orange', alpha=0.7)
axes[1, 1].plot(wavelength, corrected_abs_spline, label='ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œæ­£', color='purple', alpha=0.7)
axes[1, 1].set_xlabel('æ³¢é•· (nm)')
axes[1, 1].set_ylabel('å¸å…‰åº¦')
axes[1, 1].set_title('ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£çµæœ')
axes[1, 1].legend()
axes[1, 1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ã®è©•ä¾¡:")
poly_error = np.mean((corrected_abs_poly - true_abs)**2)
spline_error = np.mean((corrected_abs_spline - true_abs)**2)
print(f"å¤šé …å¼è£œæ­£ã®å¹³å‡äºŒä¹—èª¤å·®: {poly_error:.6f}")
print(f"ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œæ­£ã®å¹³å‡äºŒä¹—èª¤å·®: {spline_error:.6f}")
</code></pre>

    <h2>3.8 å¤šæ³¢é•·è§£æã¨å¤šæˆåˆ†å®šé‡</h2>

    <h3>3.8.1 å¸ååŠ ç®—æ€§ã®åŸç†</h3>

    <p>è¤‡æ•°ã®å¸åç¨®ãŒå…±å­˜ã™ã‚‹æ··åˆæº¶æ¶²ã§ã¯ã€Lambert-Beerå‰‡ã®åŠ ç®—æ€§ã«ã‚ˆã‚Šã€å„æˆåˆ†ã®å¯„ä¸ã‚’åˆ†é›¢ã§ãã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>å¤šæˆåˆ†ç³»ã®Lambert-Beerå‰‡:</strong></p>
        \[
        A(\lambda) = \sum_{i=1}^{n} \epsilon_i(\lambda) \cdot c_i \cdot l
        \]
        <p>è¡Œåˆ—è¡¨è¨˜ï¼ˆ\( m \)æ³¢é•·ã€\( n \)æˆåˆ†ï¼‰:</p>
        \[
        \mathbf{A} = \mathbf{E} \mathbf{c} l
        \]
        <p>ã“ã“ã§ã€\( \mathbf{A} \)ã¯å¸å…‰åº¦ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆ\( m \times 1 \)ï¼‰ã€\( \mathbf{E} \)ã¯ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°è¡Œåˆ—ï¼ˆ\( m \times n \)ï¼‰ã€\( \mathbf{c} \)ã¯æ¿ƒåº¦ãƒ™ã‚¯ãƒˆãƒ«ï¼ˆ\( n \times 1 \)ï¼‰ã§ã™ã€‚</p>
    </div>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: å¤šæ³¢é•·è§£æã«ã‚ˆã‚‹2æˆåˆ†æ··åˆç‰©ã®å®šé‡</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import nnls  # Non-Negative Least Squares

def multiwavelength_analysis(wavelength, absorbance_mixture, epsilon_matrix, path_length=1.0):
    """
    å¤šæ³¢é•·è§£æã«ã‚ˆã‚Šæ··åˆæº¶æ¶²ä¸­ã®å„æˆåˆ†æ¿ƒåº¦ã‚’æ±ºå®š

    Parameters:
    -----------
    wavelength : array
        æ¸¬å®šæ³¢é•· (nm)
    absorbance_mixture : array
        æ··åˆæº¶æ¶²ã®å¸å…‰åº¦ã‚¹ãƒšã‚¯ãƒˆãƒ«
    epsilon_matrix : 2D array
        å„æˆåˆ†ã®ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ã‚¹ãƒšã‚¯ãƒˆãƒ« (shape: n_wavelengths Ã— n_components)
    path_length : float
        å…‰è·¯é•· (cm)

    Returns:
    --------
    concentrations : array
        æ±ºå®šã•ã‚ŒãŸå„æˆåˆ†ã®æ¿ƒåº¦ (mol/L)
    """
    # éè² æœ€å°äºŒä¹—æ³•ã§æ¿ƒåº¦ã‚’æ±ºå®šï¼ˆè² ã®æ¿ƒåº¦ã‚’ç¦æ­¢ï¼‰
    concentrations, residual = nnls(epsilon_matrix * path_length, absorbance_mixture)

    # å†æ§‹æˆã‚¹ãƒšã‚¯ãƒˆãƒ«
    absorbance_reconstructed = epsilon_matrix @ concentrations * path_length

    return concentrations, absorbance_reconstructed, residual

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šãƒ¡ãƒãƒ¬ãƒ³ãƒ–ãƒ«ãƒ¼ï¼ˆMBï¼‰ã¨ãƒ¡ãƒãƒ«ã‚ªãƒ¬ãƒ³ã‚¸ï¼ˆMOï¼‰ã®æ··åˆæº¶æ¶²
wavelength = np.linspace(400, 700, 300)

# æˆåˆ†1: ãƒ¡ãƒãƒ¬ãƒ³ãƒ–ãƒ«ãƒ¼ï¼ˆÎ»max = 664 nmï¼‰
epsilon_MB = 8e4 * np.exp(-((wavelength - 664)**2) / (2 * 40**2))

# æˆåˆ†2: ãƒ¡ãƒãƒ«ã‚ªãƒ¬ãƒ³ã‚¸ï¼ˆÎ»max = 464 nmï¼‰
epsilon_MO = 2.7e4 * np.exp(-((wavelength - 464)**2) / (2 * 35**2))

# ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°è¡Œåˆ—
epsilon_matrix = np.column_stack([epsilon_MB, epsilon_MO])

# çœŸã®æ¿ƒåº¦ï¼ˆmol/Lï¼‰
c_MB_true = 1.5e-5
c_MO_true = 3.0e-5

# æ··åˆæº¶æ¶²ã®å¸å…‰åº¦ï¼ˆå…‰è·¯é•· 1 cmï¼‰
absorbance_mixture = epsilon_MB * c_MB_true + epsilon_MO * c_MO_true
absorbance_mixture += np.random.normal(0, 0.005, len(wavelength))  # ãƒã‚¤ã‚º

# å¤šæ³¢é•·è§£æ
concentrations, absorbance_recon, residual = multiwavelength_analysis(
    wavelength, absorbance_mixture, epsilon_matrix, path_length=1.0
)

c_MB_calc, c_MO_calc = concentrations

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å„æˆåˆ†ã®ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ã‚¹ãƒšã‚¯ãƒˆãƒ«
axes[0, 0].plot(wavelength, epsilon_MB, label='ãƒ¡ãƒãƒ¬ãƒ³ãƒ–ãƒ«ãƒ¼ï¼ˆMBï¼‰', color='blue', linewidth=2)
axes[0, 0].plot(wavelength, epsilon_MO, label='ãƒ¡ãƒãƒ«ã‚ªãƒ¬ãƒ³ã‚¸ï¼ˆMOï¼‰', color='orange', linewidth=2)
axes[0, 0].set_xlabel('æ³¢é•· (nm)')
axes[0, 0].set_ylabel('ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° (L molâ»Â¹ cmâ»Â¹)')
axes[0, 0].set_title('å„æˆåˆ†ã®ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ã‚¹ãƒšã‚¯ãƒˆãƒ«')
axes[0, 0].legend()
axes[0, 0].grid(alpha=0.3)

# æ··åˆæº¶æ¶²ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
axes[0, 1].plot(wavelength, absorbance_mixture, 'o-', label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«',
                color='purple', alpha=0.6, markersize=2)
axes[0, 1].plot(wavelength, absorbance_recon, '--', label='å†æ§‹æˆã‚¹ãƒšã‚¯ãƒˆãƒ«',
                color='red', linewidth=2)
axes[0, 1].set_xlabel('æ³¢é•· (nm)')
axes[0, 1].set_ylabel('å¸å…‰åº¦')
axes[0, 1].set_title('æ··åˆæº¶æ¶²ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°')
axes[0, 1].legend()
axes[0, 1].grid(alpha=0.3)

# å„æˆåˆ†ã®å¯„ä¸
abs_MB_contrib = epsilon_MB * c_MB_calc
abs_MO_contrib = epsilon_MO * c_MO_calc
axes[1, 0].plot(wavelength, absorbance_mixture, label='ç·å¸å…‰åº¦', color='black', linewidth=2)
axes[1, 0].fill_between(wavelength, 0, abs_MB_contrib, alpha=0.5, color='blue', label='MBå¯„ä¸')
axes[1, 0].fill_between(wavelength, abs_MB_contrib, abs_MB_contrib + abs_MO_contrib,
                        alpha=0.5, color='orange', label='MOå¯„ä¸')
axes[1, 0].set_xlabel('æ³¢é•· (nm)')
axes[1, 0].set_ylabel('å¸å…‰åº¦')
axes[1, 0].set_title('å„æˆåˆ†ã®å¸å…‰åº¦å¯„ä¸')
axes[1, 0].legend()
axes[1, 0].grid(alpha=0.3)

# æ¿ƒåº¦æ±ºå®šçµæœ
components = ['ãƒ¡ãƒãƒ¬ãƒ³ãƒ–ãƒ«ãƒ¼', 'ãƒ¡ãƒãƒ«ã‚ªãƒ¬ãƒ³ã‚¸']
concentrations_true = [c_MB_true, c_MO_true]
concentrations_calc = [c_MB_calc, c_MO_calc]

x = np.arange(len(components))
width = 0.35

axes[1, 1].bar(x - width/2, np.array(concentrations_true)*1e5, width, label='çœŸã®æ¿ƒåº¦', color='green', alpha=0.7)
axes[1, 1].bar(x + width/2, np.array(concentrations_calc)*1e5, width, label='è¨ˆç®—æ¿ƒåº¦', color='red', alpha=0.7)
axes[1, 1].set_xlabel('æˆåˆ†')
axes[1, 1].set_ylabel('æ¿ƒåº¦ (Ã—10â»âµ mol/L)')
axes[1, 1].set_title('æ¿ƒåº¦æ±ºå®šçµæœ')
axes[1, 1].set_xticks(x)
axes[1, 1].set_xticklabels(components)
axes[1, 1].legend()
axes[1, 1].grid(alpha=0.3, axis='y')

plt.tight_layout()
plt.show()

print("å¤šæ³¢é•·è§£æçµæœ:")
print(f"ãƒ¡ãƒãƒ¬ãƒ³ãƒ–ãƒ«ãƒ¼: çœŸã®æ¿ƒåº¦ = {c_MB_true:.2e} mol/L, è¨ˆç®—æ¿ƒåº¦ = {c_MB_calc:.2e} mol/L")
print(f"ãƒ¡ãƒãƒ«ã‚ªãƒ¬ãƒ³ã‚¸: çœŸã®æ¿ƒåº¦ = {c_MO_true:.2e} mol/L, è¨ˆç®—æ¿ƒåº¦ = {c_MO_calc:.2e} mol/L")
print(f"ç›¸å¯¾èª¤å·®ï¼ˆMBï¼‰: {abs(c_MB_calc - c_MB_true)/c_MB_true * 100:.2f}%")
print(f"ç›¸å¯¾èª¤å·®ï¼ˆMOï¼‰: {abs(c_MO_calc - c_MO_true)/c_MO_true * 100:.2f}%")
print(f"æ®‹å·®: {residual:.6f}")
</code></pre>

    <h2>3.9 æ™‚é–“åˆ†è§£UV-Visåˆ†å…‰æ³•</h2>

    <h3>3.9.1 åå¿œé€Ÿåº¦è«–çš„è§£æ</h3>

    <p>UV-Visåˆ†å…‰æ³•ã¯ã€åŒ–å­¦åå¿œã®é€²è¡Œã‚’ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¿½è·¡ã§ãã¾ã™ã€‚å¸å…‰åº¦ã®æ™‚é–“å¤‰åŒ–ã‹ã‚‰åå¿œé€Ÿåº¦å®šæ•°ã‚’æ±ºå®šã§ãã¾ã™ã€‚</p>

    <div class="equation-box">
        <p><strong>1æ¬¡åå¿œã®é€Ÿåº¦å¼:</strong></p>
        \[
        \frac{d[A]}{dt} = -k[A]
        \]
        <p>ç©åˆ†å½¢:</p>
        \[
        [A]_t = [A]_0 e^{-kt}
        \]
        <p>å¸å…‰åº¦ã§ã®è¡¨ç¾ï¼ˆ\( A_t = \epsilon [A]_t l \)ï¼‰:</p>
        \[
        A_t = A_0 e^{-kt}
        \]
        \[
        \ln A_t = \ln A_0 - kt
        \]
    </div>

    <h4>ã‚³ãƒ¼ãƒ‰ä¾‹8: æ™‚é–“åˆ†è§£UV-Visåˆ†å…‰æ³•ã«ã‚ˆã‚‹1æ¬¡åå¿œé€Ÿåº¦å®šæ•°ã®æ±ºå®š</h4>

<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def first_order_kinetics(time, A0, k):
    """
    1æ¬¡åå¿œã®å¸å…‰åº¦æ™‚é–“å¤‰åŒ–

    Parameters:
    -----------
    time : array
        æ™‚é–“ (s)
    A0 : float
        åˆæœŸå¸å…‰åº¦
    k : float
        é€Ÿåº¦å®šæ•° (s^-1)

    Returns:
    --------
    absorbance : array
        æ™‚é–“ã«ãŠã‘ã‚‹å¸å…‰åº¦
    """
    return A0 * np.exp(-k * time)

def determine_rate_constant(time, absorbance):
    """
    æ™‚é–“åˆ†è§£UV-Visãƒ‡ãƒ¼ã‚¿ã‹ã‚‰1æ¬¡åå¿œé€Ÿåº¦å®šæ•°ã‚’æ±ºå®š

    Parameters:
    -----------
    time : array
        æ™‚é–“ (s)
    absorbance : array
        å„æ™‚é–“ã«ãŠã‘ã‚‹å¸å…‰åº¦

    Returns:
    --------
    k : float
        é€Ÿåº¦å®šæ•° (s^-1)
    half_life : float
        åŠæ¸›æœŸ (s)
    """
    # éç·šå½¢ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
    popt, pcov = curve_fit(first_order_kinetics, time, absorbance, p0=[absorbance[0], 0.01])
    A0_fit, k_fit = popt

    # åŠæ¸›æœŸ
    half_life = np.log(2) / k_fit

    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

    # å¸å…‰åº¦ vs æ™‚é–“ï¼ˆæŒ‡æ•°ãƒ—ãƒ­ãƒƒãƒˆï¼‰
    ax1.plot(time, absorbance, 'o', label='å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿', markersize=8, alpha=0.7)
    time_fit = np.linspace(0, time.max(), 200)
    abs_fit = first_order_kinetics(time_fit, A0_fit, k_fit)
    ax1.plot(time_fit, abs_fit, 'r--', linewidth=2,
             label=f'ãƒ•ã‚£ãƒƒãƒˆ: A = {A0_fit:.3f} exp(-{k_fit:.4f}t)\nk = {k_fit:.4f} sâ»Â¹\ntâ‚/â‚‚ = {half_life:.1f} s')
    ax1.set_xlabel('æ™‚é–“ (s)', fontsize=12)
    ax1.set_ylabel('å¸å…‰åº¦', fontsize=12)
    ax1.set_title('1æ¬¡åå¿œã®æ™‚é–“å¤‰åŒ–', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.grid(alpha=0.3)

    # ln(A) vs æ™‚é–“ï¼ˆç·šå½¢ãƒ—ãƒ­ãƒƒãƒˆï¼‰
    ln_abs = np.log(absorbance)
    ax2.plot(time, ln_abs, 'o', label='å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿', markersize=8, alpha=0.7)
    ln_abs_fit = np.log(A0_fit) - k_fit * time_fit
    ax2.plot(time_fit, ln_abs_fit, 'r--', linewidth=2,
             label=f'ç·šå½¢ãƒ•ã‚£ãƒƒãƒˆ\nå‚¾ã = -{k_fit:.4f} sâ»Â¹')
    ax2.set_xlabel('æ™‚é–“ (s)', fontsize=12)
    ax2.set_ylabel('ln(å¸å…‰åº¦)', fontsize=12)
    ax2.set_title('1æ¬¡ãƒ—ãƒ­ãƒƒãƒˆï¼ˆå¯¾æ•°ï¼‰', fontsize=14, fontweight='bold')
    ax2.legend()
    ax2.grid(alpha=0.3)

    plt.tight_layout()
    plt.show()

    return k_fit, half_life, A0_fit

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼šã‚¯ãƒªã‚¹ã‚¿ãƒ«ãƒã‚¤ã‚ªãƒ¬ãƒƒãƒˆã®å¡©åŸºåŠ æ°´åˆ†è§£åå¿œ
time_data = np.linspace(0, 300, 30)  # 0-300ç§’ã€30ç‚¹æ¸¬å®š
k_true = 0.012  # s^-1
A0_true = 1.2
absorbance_data = first_order_kinetics(time_data, A0_true, k_true)
absorbance_data += np.random.normal(0, 0.02, len(time_data))  # ãƒã‚¤ã‚º

# é€Ÿåº¦å®šæ•°æ±ºå®š
k_calc, t_half, A0_calc = determine_rate_constant(time_data, absorbance_data)

print("åå¿œé€Ÿåº¦è«–çš„è§£æçµæœ:")
print(f"é€Ÿåº¦å®šæ•° k = {k_calc:.4f} sâ»Â¹ï¼ˆçœŸå€¤: {k_true:.4f} sâ»Â¹ï¼‰")
print(f"åŠæ¸›æœŸ tâ‚/â‚‚ = {t_half:.1f} s")
print(f"åˆæœŸå¸å…‰åº¦ Aâ‚€ = {A0_calc:.3f}")
print(f"ç›¸å¯¾èª¤å·®: {abs(k_calc - k_true)/k_true * 100:.2f}%")
</code></pre>

    <h2>3.10 æ¼”ç¿’å•é¡Œ</h2>

    <div class="exercise-box">
        <h3>åŸºç¤å•é¡Œï¼ˆEasyï¼‰</h3>

        <h4>å•é¡Œ1: æ³¢é•·ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å¤‰æ›</h4>
        <p>UV-Visåˆ†å…‰æ³•ã§è¦³æ¸¬ã•ã‚ŒãŸå¸åæ¥µå¤§æ³¢é•·ãŒ450 nmã®åŒ–åˆç‰©ãŒã‚ã‚‹ã€‚ã“ã®å¸åã«å¯¾å¿œã™ã‚‹å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ eV å˜ä½ã§è¨ˆç®—ã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>æ³¢é•·ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å¤‰æ›å¼ã‚’ä½¿ç”¨ï¼š</p>
                \[
                E\,(\text{eV}) = \frac{1239.8}{\lambda\,(\text{nm})} = \frac{1239.8}{450} = 2.755\,\text{eV}
                \]
                <p><strong>ç­”ãˆ: 2.76 eV</strong></p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">lambda_nm = 450
E_eV = 1239.8 / lambda_nm
print(f"å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼: {E_eV:.3f} eV")
</code></pre>
            </div>
        </details>

        <h4>å•é¡Œ2: Lambert-Beerå‰‡ã«ã‚ˆã‚‹æ¿ƒåº¦è¨ˆç®—</h4>
        <p>ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° \( \epsilon = 1.5 \times 10^4 \) L mol<sup>-1</sup> cm<sup>-1</sup> ã®åŒ–åˆç‰©ã®æº¶æ¶²ï¼ˆå…‰è·¯é•· 1 cmï¼‰ã®å¸å…‰åº¦ãŒ 0.75 ã§ã‚ã£ãŸã€‚ã“ã®æº¶æ¶²ã®æ¿ƒåº¦ï¼ˆmol/Lï¼‰ã‚’æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>Lambert-Beerå‰‡: \( A = \epsilon c l \) ã‚ˆã‚Šã€</p>
                \[
                c = \frac{A}{\epsilon l} = \frac{0.75}{1.5 \times 10^4 \times 1} = 5.0 \times 10^{-5}\,\text{mol/L}
                \]
                <p><strong>ç­”ãˆ: 5.0 Ã— 10<sup>-5</sup> mol/L</strong></p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">A = 0.75
epsilon = 1.5e4  # L mol^-1 cm^-1
l = 1.0  # cm
c = A / (epsilon * l)
print(f"æ¿ƒåº¦: {c:.2e} mol/L")
</code></pre>
            </div>
        </details>

        <h4>å•é¡Œ3: é€éç‡ã¨å¸å…‰åº¦ã®å¤‰æ›</h4>
        <p>æº¶æ¶²ã®é€éç‡ãŒ 40% ã§ã‚ã£ãŸã€‚ã“ã®æº¶æ¶²ã®å¸å…‰åº¦ã‚’è¨ˆç®—ã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>å¸å…‰åº¦ã¨é€éç‡ã®é–¢ä¿‚å¼: \( A = -\log_{10} T = 2 - \log_{10}(\%T) \)</p>
                \[
                A = 2 - \log_{10}(40) = 2 - 1.602 = 0.398
                \]
                <p><strong>ç­”ãˆ: 0.398</strong></p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np
T_percent = 40
A = 2 - np.log10(T_percent)
print(f"å¸å…‰åº¦: {A:.3f}")
</code></pre>
            </div>
        </details>
    </div>

    <div class="exercise-box">
        <h3>ä¸­ç´šå•é¡Œï¼ˆMediumï¼‰</h3>

        <h4>å•é¡Œ4: Taucãƒ—ãƒ­ãƒƒãƒˆã«ã‚ˆã‚‹ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ±ºå®š</h4>
        <p>ã‚ã‚‹åŠå°ä½“ææ–™ã®UV-Visã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰ã€ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ãŒå¾—ã‚‰ã‚ŒãŸã€‚Taucãƒ—ãƒ­ãƒƒãƒˆï¼ˆç›´æ¥é·ç§»ï¼‰ã‚’ä½œæˆã—ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’æ±ºå®šã›ã‚ˆã€‚è©¦æ–™åšã•: 0.01 cm</p>
        <table>
            <tr><th>æ³¢é•· (nm)</th><td>400</td><td>420</td><td>440</td><td>460</td><td>480</td><td>500</td></tr>
            <tr><th>å¸å…‰åº¦</th><td>1.20</td><td>1.05</td><td>0.85</td><td>0.60</td><td>0.35</td><td>0.15</td></tr>
        </table>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>1. æ³¢é•·ã‚’å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã«å¤‰æ›: \( E = 1239.8 / \lambda \)</p>
                <p>2. å¸åä¿‚æ•°ã‚’è¨ˆç®—: \( \alpha = 2.303 \cdot A / l \)</p>
                <p>3. Taucãƒ—ãƒ­ãƒƒãƒˆ: \( (\alpha h\nu)^2 \) vs. \( h\nu \) ã®ç·šå½¢é ˜åŸŸã‚’å¤–æŒ¿</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

wavelength = np.array([400, 420, 440, 460, 480, 500])
absorbance = np.array([1.20, 1.05, 0.85, 0.60, 0.35, 0.15])
thickness = 0.01  # cm

# å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼
E = 1239.8 / wavelength  # eV

# å¸åä¿‚æ•°
alpha = 2.303 * absorbance / thickness  # cm^-1

# Taucãƒ—ãƒ­ãƒƒãƒˆ
tauc_y = (alpha * E)**2

# ç·šå½¢é ˜åŸŸã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼ˆE > 2.7 eVï¼‰
mask = E > 2.7
slope, intercept, r_value, _, _ = linregress(E[mask], tauc_y[mask])

# ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ï¼ˆæ¨ªè»¸åˆ‡ç‰‡ï¼‰
Eg = -intercept / slope

plt.figure(figsize=(10, 6))
plt.plot(E, tauc_y, 'o', markersize=10, label='å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿')
E_fit = np.linspace(Eg, E.max(), 100)
tauc_fit = slope * E_fit + intercept
plt.plot(E_fit, tauc_fit, 'r--', linewidth=2, label=f'Eg = {Eg:.3f} eV')
plt.axvline(Eg, color='green', linestyle=':', linewidth=2)
plt.xlabel('å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
plt.ylabel('(Î±hÎ½)Â² (eVÂ² cmâ»Â²)', fontsize=12)
plt.title('Taucãƒ—ãƒ­ãƒƒãƒˆ', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(alpha=0.3)
plt.show()

print(f"ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— Eg = {Eg:.3f} eV")
print(f"å¯¾å¿œæ³¢é•·: Î» = {1239.8/Eg:.1f} nm")
</code></pre>
                <p><strong>ç­”ãˆ: Eg â‰ˆ 2.6-2.7 eVï¼ˆå®Ÿéš›ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã«ã‚ˆã‚‹ï¼‰</strong></p>
            </div>
        </details>

        <h4>å•é¡Œ5: é…ä½å­å ´ç†è«–ã«ã‚ˆã‚‹éŒ¯ä½“ã®è‰²äºˆæ¸¬</h4>
        <p>[Co(H<sub>2</sub>O)<sub>6</sub>]<sup>2+</sup> ã®é…ä½å­å ´åˆ†è£‚ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒ \( \Delta_o = 9300 \) cm<sup>-1</sup> ã§ã‚ã‚‹ã€‚ã“ã®éŒ¯ä½“ãŒå¸åã™ã‚‹å…‰ã®æ³¢é•·ã¨ã€è¦³æ¸¬ã•ã‚Œã‚‹éŒ¯ä½“ã®è‰²ã‚’äºˆæ¸¬ã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>1. å¸åæ³¢é•·ã‚’è¨ˆç®—:</p>
                \[
                \lambda = \frac{1}{\Delta_o\,(\text{cm}^{-1})} \times 10^7\,(\text{nm}) = \frac{10^7}{9300} = 1075\,\text{nm}
                \]
                <p>2. 1075 nm ã¯è¿‘èµ¤å¤–åŸŸï¼ˆå¯è¦–åŸŸå¤–ï¼‰ã€‚ã—ã‹ã—ã€Co<sup>2+</sup> (d<sup>7</sup>) ã¯è¤‡æ•°ã®d-dé·ç§»ã‚’æŒã¡ã€å®Ÿéš›ã«ã¯å¯è¦–åŸŸã«ã‚‚å¸åãŒã‚ã‚‹ã€‚</p>
                <p>3. [Co(H<sub>2</sub>O)<sub>6</sub>]<sup>2+</sup> ã¯ç´„ 510 nmï¼ˆç·‘è‰²ï¼‰ã«å¼·ã„å¸åã‚’æŒã¡ã€<strong>ãƒ”ãƒ³ã‚¯è‰²</strong>ï¼ˆç·‘ã®è£œè‰²ï¼‰ã«è¦‹ãˆã‚‹ã€‚</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">delta_o_cm = 9300
wavelength_nm = 1e7 / delta_o_cm
print(f"Î”oå¯¾å¿œæ³¢é•·: {wavelength_nm:.1f} nmï¼ˆè¿‘èµ¤å¤–ï¼‰")
print("å®Ÿéš›ã®[Co(H2O)6]2+éŒ¯ä½“:")
print("- ä¸»å¸å: 510 nmï¼ˆç·‘è‰²ï¼‰")
print("- è¦³æ¸¬è‰²: ãƒ”ãƒ³ã‚¯è‰²ï¼ˆç·‘ã®è£œè‰²ï¼‰")
</code></pre>
                <p><strong>ç­”ãˆ: éŒ¯ä½“ã®è‰²ã¯ãƒ”ãƒ³ã‚¯è‰²</strong></p>
            </div>
        </details>

        <h4>å•é¡Œ6: å¤šæ³¢é•·è§£æã«ã‚ˆã‚‹2æˆåˆ†å®šé‡</h4>
        <p>ãƒ¡ãƒãƒ¬ãƒ³ãƒ–ãƒ«ãƒ¼ï¼ˆMBã€\( \epsilon_{664} = 8 \times 10^4 \) L mol<sup>-1</sup> cm<sup>-1</sup>ï¼‰ã¨ãƒ¡ãƒãƒ«ã‚ªãƒ¬ãƒ³ã‚¸ï¼ˆMOã€\( \epsilon_{464} = 2.7 \times 10^4 \)ï¼‰ã®æ··åˆæº¶æ¶²ã‚’ 1 cm ã‚»ãƒ«ã§æ¸¬å®šã—ãŸçµæœã€A<sub>664</sub> = 0.40ã€A<sub>464</sub> = 0.54 ã§ã‚ã£ãŸã€‚å„æˆåˆ†ã®æ¿ƒåº¦ã‚’æ±‚ã‚ã‚ˆã€‚ãŸã ã—ã€664 nm ã§ã¯ MO ã¯å¸åã›ãšã€464 nm ã§ã¯ MB ã®å¸åã¯ç„¡è¦–ã§ãã‚‹ã¨ã™ã‚‹ã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>664 nmï¼ˆMB ã®ã¿å¸åï¼‰:</p>
                \[
                c_{\text{MB}} = \frac{A_{664}}{\epsilon_{\text{MB},664} \cdot l} = \frac{0.40}{8 \times 10^4 \times 1} = 5.0 \times 10^{-6}\,\text{mol/L}
                \]

                <p>464 nmï¼ˆMO ã®ã¿å¸åï¼‰:</p>
                \[
                c_{\text{MO}} = \frac{A_{464}}{\epsilon_{\text{MO},464} \cdot l} = \frac{0.54}{2.7 \times 10^4 \times 1} = 2.0 \times 10^{-5}\,\text{mol/L}
                \]

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">A_664 = 0.40
A_464 = 0.54
epsilon_MB_664 = 8e4  # L mol^-1 cm^-1
epsilon_MO_464 = 2.7e4
l = 1.0  # cm

c_MB = A_664 / (epsilon_MB_664 * l)
c_MO = A_464 / (epsilon_MO_464 * l)

print(f"ãƒ¡ãƒãƒ¬ãƒ³ãƒ–ãƒ«ãƒ¼æ¿ƒåº¦: {c_MB:.2e} mol/L")
print(f"ãƒ¡ãƒãƒ«ã‚ªãƒ¬ãƒ³ã‚¸æ¿ƒåº¦: {c_MO:.2e} mol/L")
</code></pre>
                <p><strong>ç­”ãˆ: MB = 5.0 Ã— 10<sup>-6</sup> mol/L, MO = 2.0 Ã— 10<sup>-5</sup> mol/L</strong></p>
            </div>
        </details>
    </div>

    <div class="exercise-box">
        <h3>ä¸Šç´šå•é¡Œï¼ˆHardï¼‰</h3>

        <h4>å•é¡Œ7: æ¸©åº¦ä¾å­˜æ€§UV-Visã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰ã®ç†±åŠ›å­¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ±ºå®š</h4>
        <p>ã‚ã‚‹å¹³è¡¡ç³» A â‡Œ B ã®å¹³è¡¡å®šæ•° \( K \) ã‚’ã€ç•°ãªã‚‹æ¸©åº¦ã§ UV-Vis åˆ†å…‰æ³•ã«ã‚ˆã‚Šæ±ºå®šã—ãŸã€‚ä»¥ä¸‹ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰ã€van't Hoff ãƒ—ãƒ­ãƒƒãƒˆã‚’ä½œæˆã—ã€åå¿œã®ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼å¤‰åŒ– \( \Delta H^\circ \) ã¨ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¤‰åŒ– \( \Delta S^\circ \) ã‚’æ±‚ã‚ã‚ˆã€‚</p>
        <table>
            <tr><th>æ¸©åº¦ (K)</th><td>298</td><td>308</td><td>318</td><td>328</td><td>338</td></tr>
            <tr><th>å¹³è¡¡å®šæ•° K</th><td>0.50</td><td>0.80</td><td>1.20</td><td>1.75</td><td>2.40</td></tr>
        </table>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>van't Hoff å¼:</p>
                \[
                \ln K = -\frac{\Delta H^\circ}{R} \cdot \frac{1}{T} + \frac{\Delta S^\circ}{R}
                \]
                <p>\( \ln K \) vs. \( 1/T \) ã®ãƒ—ãƒ­ãƒƒãƒˆã®å‚¾ãã‹ã‚‰ \( \Delta H^\circ \)ã€åˆ‡ç‰‡ã‹ã‚‰ \( \Delta S^\circ \) ã‚’æ±ºå®šã€‚</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

T = np.array([298, 308, 318, 328, 338])  # K
K = np.array([0.50, 0.80, 1.20, 1.75, 2.40])

# van't Hoffãƒ—ãƒ­ãƒƒãƒˆ
inv_T = 1 / T  # K^-1
ln_K = np.log(K)

# ç·šå½¢å›å¸°
slope, intercept, r_value, _, _ = linregress(inv_T, ln_K)

# ç†±åŠ›å­¦ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
R = 8.314  # J mol^-1 K^-1
Delta_H = -slope * R  # J/mol
Delta_S = intercept * R  # J/(mol K)

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(10, 6))
plt.plot(inv_T * 1000, ln_K, 'o', markersize=10, label='å®Ÿæ¸¬ãƒ‡ãƒ¼ã‚¿')
inv_T_fit = np.linspace(inv_T.min(), inv_T.max(), 100)
ln_K_fit = slope * inv_T_fit + intercept
plt.plot(inv_T_fit * 1000, ln_K_fit, 'r--', linewidth=2,
         label=f'Î”HÂ° = {Delta_H/1000:.2f} kJ/mol\nÎ”SÂ° = {Delta_S:.2f} J/(molÂ·K)\nRÂ² = {r_value**2:.4f}')
plt.xlabel('1000/T (Kâ»Â¹)', fontsize=12)
plt.ylabel('ln K', fontsize=12)
plt.title("van't Hoffãƒ—ãƒ­ãƒƒãƒˆ", fontsize=14, fontweight='bold')
plt.legend()
plt.grid(alpha=0.3)
plt.show()

print(f"ã‚¨ãƒ³ã‚¿ãƒ«ãƒ”ãƒ¼å¤‰åŒ–: Î”HÂ° = {Delta_H/1000:.2f} kJ/mol")
print(f"ã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼å¤‰åŒ–: Î”SÂ° = {Delta_S:.2f} J/(molÂ·K)")
print(f"ç›¸é–¢ä¿‚æ•°: RÂ² = {r_value**2:.4f}")
</code></pre>
                <p><strong>ç­”ãˆ: Î”HÂ° â‰ˆ 35-40 kJ/mol, Î”SÂ° â‰ˆ 90-100 J/(molÂ·K)ï¼ˆå®Ÿãƒ‡ãƒ¼ã‚¿ã«ã‚ˆã‚‹ï¼‰</strong></p>
            </div>
        </details>

        <h4>å•é¡Œ8: æ•£ä¹±å…‰ã‚’å«ã‚€ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®é«˜åº¦ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£</h4>
        <p>ãƒŠãƒç²’å­æ‡¸æ¿æ¶²ã® UV-Vis ã‚¹ãƒšã‚¯ãƒˆãƒ«ã«ã¯ã€Rayleigh æ•£ä¹±ï¼ˆ\( \propto \lambda^{-4} \)ï¼‰ã¨ Mie æ•£ä¹±ï¼ˆ\( \propto \lambda^{-n}, n < 4 \)ï¼‰ãŒé‡ç•³ã™ã‚‹ã€‚ä»¥ä¸‹ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰ã€çœŸã®å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’æŠ½å‡ºã—ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’æ±ºå®šã™ã‚‹ Python ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£æˆ¦ç•¥:</p>
                <ol>
                    <li>å¸åç«¯ã‚ˆã‚Šé•·æ³¢é•·å´ã®ãƒ‡ãƒ¼ã‚¿ã‹ã‚‰æ•£ä¹±æˆåˆ†ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</li>
                    <li>\( A_{\text{scattering}} = C \lambda^{-n} \) ã®å½¢å¼ã§ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</li>
                    <li>å…¨æ³¢é•·ç¯„å›²ã§æ•£ä¹±æˆåˆ†ã‚’æ¸›ç®—</li>
                    <li>è£œæ­£å¾Œã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰ Tauc ãƒ—ãƒ­ãƒƒãƒˆã§ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ±ºå®š</li>
                </ol>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def scattering_baseline(wavelength, C, n):
    """æ•£ä¹±ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼ˆã¹ãä¹—å‰‡ï¼‰"""
    return C * wavelength**(-n)

def advanced_baseline_correction(wavelength, absorbance, scattering_region):
    """
    æ•£ä¹±å…‰ã‚’å«ã‚€ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®é«˜åº¦ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£

    Parameters:
    -----------
    wavelength : array
        æ³¢é•· (nm)
    absorbance : array
        è¦³æ¸¬å¸å…‰åº¦
    scattering_region : tuple
        æ•£ä¹±ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°é ˜åŸŸ (nm)

    Returns:
    --------
    corrected_absorbance : array
        è£œæ­£å¾Œã®å¸å…‰åº¦
    """
    # æ•£ä¹±é ˜åŸŸã®ãƒ‡ãƒ¼ã‚¿
    mask = (wavelength >= scattering_region[0]) & (wavelength <= scattering_region[1])
    wl_scatter = wavelength[mask]
    abs_scatter = absorbance[mask]

    # ã¹ãä¹—å‰‡ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
    popt, _ = curve_fit(scattering_baseline, wl_scatter, abs_scatter, p0=[1e7, 4.0], maxfev=5000)
    C, n = popt

    # å…¨æ³¢é•·ç¯„å›²ã§æ•£ä¹±æˆåˆ†ã‚’è¨ˆç®—
    baseline = scattering_baseline(wavelength, C, n)

    # ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æ¸›ç®—
    corrected = absorbance - baseline
    corrected = np.maximum(corrected, 0)  # è² ã®å€¤ã‚’0ã«ã‚¯ãƒªãƒƒãƒ—

    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig, axes = plt.subplots(2, 2, figsize=(14, 10))

    # å…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
    axes[0, 0].plot(wavelength, absorbance, label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«', color='blue')
    axes[0, 0].plot(wavelength, baseline, '--', label=f'æ•£ä¹±ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³\n(Î»^-{n:.2f})', color='red', linewidth=2)
    axes[0, 0].set_xlabel('æ³¢é•· (nm)')
    axes[0, 0].set_ylabel('å¸å…‰åº¦')
    axes[0, 0].set_title('æ•£ä¹±å…‰ã‚’å«ã‚€ã‚¹ãƒšã‚¯ãƒˆãƒ«')
    axes[0, 0].legend()
    axes[0, 0].grid(alpha=0.3)

    # è£œæ­£ã‚¹ãƒšã‚¯ãƒˆãƒ«
    axes[0, 1].plot(wavelength, corrected, label='è£œæ­£å¾Œã‚¹ãƒšã‚¯ãƒˆãƒ«', color='green', linewidth=2)
    axes[0, 1].set_xlabel('æ³¢é•· (nm)')
    axes[0, 1].set_ylabel('å¸å…‰åº¦')
    axes[0, 1].set_title('ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£å¾Œ')
    axes[0, 1].legend()
    axes[0, 1].grid(alpha=0.3)

    # Taucãƒ—ãƒ­ãƒƒãƒˆ
    E = 1239.8 / wavelength
    alpha = 2.303 * corrected / 0.01  # ä»®å®š: è©¦æ–™åšã• 0.01 cm
    tauc_y = (alpha * E)**2

    # ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ±ºå®š
    mask_tauc = (E > 2.5) & (E < 3.5)
    if np.sum(mask_tauc) > 5:
        from scipy.stats import linregress
        slope_t, intercept_t, _, _, _ = linregress(E[mask_tauc], tauc_y[mask_tauc])
        Eg = -intercept_t / slope_t if slope_t > 0 else np.nan
    else:
        Eg = np.nan

    axes[1, 0].plot(E, tauc_y, 'o-', label='Taucãƒ—ãƒ­ãƒƒãƒˆ')
    if not np.isnan(Eg):
        E_fit = np.linspace(Eg, E[mask_tauc].max(), 100)
        tauc_fit = slope_t * E_fit + intercept_t
        axes[1, 0].plot(E_fit, tauc_fit, 'r--', linewidth=2, label=f'Eg = {Eg:.3f} eV')
        axes[1, 0].axvline(Eg, color='green', linestyle=':', linewidth=2)
    axes[1, 0].set_xlabel('å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)')
    axes[1, 0].set_ylabel('(Î±hÎ½)Â² (eVÂ² cmâ»Â²)')
    axes[1, 0].set_title('Taucãƒ—ãƒ­ãƒƒãƒˆï¼ˆè£œæ­£å¾Œï¼‰')
    axes[1, 0].legend()
    axes[1, 0].grid(alpha=0.3)

    # æ•£ä¹±æŒ‡æ•°ã®è©•ä¾¡
    axes[1, 1].text(0.5, 0.5, f'æ•£ä¹±è§£æçµæœ:\n\næ•£ä¹±æŒ‡æ•° n = {n:.2f}\n\nRayleighæ•£ä¹± (n=4): å°ç²’å­\nMieæ•£ä¹± (n<4): å¤§ç²’å­\n\nãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ— Eg = {Eg:.3f} eV',
                   transform=axes[1, 1].transAxes, fontsize=14, verticalalignment='center', horizontalalignment='center',
                   bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.5))
    axes[1, 1].axis('off')

    plt.tight_layout()
    plt.show()

    return corrected, baseline, Eg

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿
wavelength = np.linspace(300, 800, 500)
# çœŸã®å¸åï¼ˆTiO2, Eg=3.2 eVï¼‰
Eg_true = 3.2
alpha_true = 1e4 * np.maximum(0, (1239.8/wavelength - Eg_true))**2
true_abs = alpha_true * 0.01 / 2.303

# æ•£ä¹±æˆåˆ†ï¼ˆRayleigh + Mieï¼‰
scattering = 0.5 * (wavelength / 300)**(-3.5)

# è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«
observed = true_abs + scattering + np.random.normal(0, 0.01, len(wavelength))

# é«˜åº¦ãªãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£
corrected, baseline, Eg_calc = advanced_baseline_correction(
    wavelength, observed, scattering_region=(600, 800)
)

print(f"æ±ºå®šã•ã‚ŒãŸãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: Eg = {Eg_calc:.3f} eV")
print(f"çœŸã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—: Eg = {Eg_true:.3f} eV")
print(f"èª¤å·®: {abs(Eg_calc - Eg_true):.3f} eV")
</code></pre>
                <p><strong>ç­”ãˆ: Egã®ç²¾å¯†æ±ºå®šï¼ˆ0.1 eVä»¥å†…ã®èª¤å·®ï¼‰</strong></p>
            </div>
        </details>

        <h4>å•é¡Œ9: æ©Ÿæ¢°å­¦ç¿’ã«ã‚ˆã‚‹UV-Visã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰ã®æ§‹é€ äºˆæ¸¬</h4>
        <p>åŒ–åˆç‰©ã® UV-Vis ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‹ã‚‰ã€ãã®åˆ†å­æ§‹é€ ï¼ˆå…±å½¹ç³»ã®é•·ã•ã€å®˜èƒ½åŸºã®ç¨®é¡ï¼‰ã‚’äºˆæ¸¬ã™ã‚‹æ©Ÿæ¢°å­¦ç¿’ãƒ¢ãƒ‡ãƒ«ã‚’æ§‹ç¯‰ã›ã‚ˆã€‚scikit-learn ã®ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆå›å¸°ã‚’ç”¨ã„ã¦ã€å¸åæ¥µå¤§æ³¢é•·ã‹ã‚‰å…±å½¹äºŒé‡çµåˆã®æ•°ã‚’äºˆæ¸¬ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã›ã‚ˆã€‚</p>

        <details>
            <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
            <div style="padding: 10px; background: #f0f0f0; border-radius: 5px; margin-top: 10px;">
                <p><strong>è§£ç­”:</strong></p>
                <p>å…±å½¹ç³»ã®é•·ã•ã¨å¸åæ³¢é•·ã®é–¢ä¿‚ï¼ˆWoodward-Fieserå‰‡ã«åŸºã¥ãï¼‰:</p>
                \[
                \lambda_{\max} = \lambda_{\text{base}} + \Delta \lambda \times n
                \]
                <p>ã“ã“ã§ã€\( n \) ã¯å…±å½¹äºŒé‡çµåˆã®æ•°ã€‚</p>

                <p><strong>Pythonã‚³ãƒ¼ãƒ‰:</strong></p>
<pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from sklearn.ensemble import RandomForestRegressor
from sklearn.model_selection import train_test_split
from sklearn.metrics import r2_score, mean_absolute_error

# ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ï¼ˆå…±å½¹ãƒãƒªã‚¨ãƒ³ã®å¸åæ³¢é•·ãƒ‡ãƒ¼ã‚¿ï¼‰
# n: å…±å½¹äºŒé‡çµåˆã®æ•°, lambda_max: å¸åæ¥µå¤§æ³¢é•· (nm)
n_conjugated = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
lambda_max = np.array([165, 217, 258, 290, 315, 334, 349, 364, 377, 390])

# ç‰¹å¾´é‡ï¼ˆå¸åæ³¢é•·ã€ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ã€å¸åãƒãƒ³ãƒ‰å¹…ãªã©ã‚’å«ã‚€ã“ã¨ã‚‚å¯èƒ½ï¼‰
X = lambda_max.reshape(-1, 1)
y = n_conjugated

# ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿åˆ†å‰²
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆå›å¸°ãƒ¢ãƒ‡ãƒ«
rf_model = RandomForestRegressor(n_estimators=100, max_depth=5, random_state=42)
rf_model.fit(X_train, y_train)

# äºˆæ¸¬
y_pred_train = rf_model.predict(X_train)
y_pred_test = rf_model.predict(X_test)

# è©•ä¾¡
r2_train = r2_score(y_train, y_pred_train)
r2_test = r2_score(y_test, y_pred_test)
mae_test = mean_absolute_error(y_test, y_pred_test)

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(12, 5))

# è¨“ç·´ãƒ‡ãƒ¼ã‚¿ã¨ãƒ¢ãƒ‡ãƒ«
plt.subplot(1, 2, 1)
lambda_range = np.linspace(150, 400, 200).reshape(-1, 1)
n_predicted = rf_model.predict(lambda_range)
plt.plot(lambda_range, n_predicted, 'r-', linewidth=2, label='RFäºˆæ¸¬ãƒ¢ãƒ‡ãƒ«')
plt.scatter(X_train, y_train, s=100, alpha=0.7, label='è¨“ç·´ãƒ‡ãƒ¼ã‚¿', color='blue')
plt.scatter(X_test, y_test, s=100, alpha=0.7, label='ãƒ†ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿', color='green')
plt.xlabel('å¸åæ¥µå¤§æ³¢é•· (nm)', fontsize=12)
plt.ylabel('å…±å½¹äºŒé‡çµåˆã®æ•°', fontsize=12)
plt.title(f'ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆå›å¸°\nRÂ²(train) = {r2_train:.3f}, RÂ²(test) = {r2_test:.3f}',
          fontsize=13, fontweight='bold')
plt.legend()
plt.grid(alpha=0.3)

# äºˆæ¸¬ç²¾åº¦
plt.subplot(1, 2, 2)
plt.scatter(y_test, y_pred_test, s=100, alpha=0.7, color='purple')
plt.plot([y_test.min(), y_test.max()], [y_test.min(), y_test.max()], 'k--', linewidth=2, label='ç†æƒ³ç›´ç·š')
plt.xlabel('çœŸã®å…±å½¹äºŒé‡çµåˆæ•°', fontsize=12)
plt.ylabel('äºˆæ¸¬å…±å½¹äºŒé‡çµåˆæ•°', fontsize=12)
plt.title(f'äºˆæ¸¬ç²¾åº¦\nMAE = {mae_test:.2f}', fontsize=13, fontweight='bold')
plt.legend()
plt.grid(alpha=0.3)

plt.tight_layout()
plt.show()

# æœªçŸ¥è©¦æ–™ã®äºˆæ¸¬
unknown_lambda = np.array([[280], [350], [400]])
predicted_n = rf_model.predict(unknown_lambda)
print("æœªçŸ¥è©¦æ–™ã®æ§‹é€ äºˆæ¸¬:")
for lam, n_pred in zip(unknown_lambda.flatten(), predicted_n):
    print(f"  Î»max = {lam:.0f} nm â†’ äºˆæ¸¬å…±å½¹æ•°: {n_pred:.1f}")
</code></pre>
                <p><strong>ç­”ãˆ: RÂ² > 0.95 ã®é«˜ç²¾åº¦äºˆæ¸¬ãƒ¢ãƒ‡ãƒ«æ§‹ç¯‰</strong></p>
            </div>
        </details>
    </div>

    <div class="learning-objectives">
        <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>
        <p>ä»¥ä¸‹ã®é …ç›®ã«ã¤ã„ã¦ã€è‡ªå·±è©•ä¾¡ã—ã¦ãã ã•ã„ï¼š</p>

        <h3>ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬ç†è§£</h3>
        <ul>
            <li>UV-Visåˆ†å…‰æ³•ã®åŸç†ã¨é›»å­é·ç§»ã®ç¨®é¡ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>Lambert-Beerå‰‡ã‚’ç”¨ã„ãŸæ¿ƒåº¦è¨ˆç®—ãŒã§ãã‚‹</li>
            <li>æ³¢é•·ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®å¤‰æ›ãŒã§ãã‚‹</li>
            <li>å¸å…‰åº¦ã¨é€éç‡ã®é–¢ä¿‚ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
        </ul>

        <h3>ãƒ¬ãƒ™ãƒ«2: å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
        <ul>
            <li>Taucãƒ—ãƒ­ãƒƒãƒˆæ³•ã§ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—ã‚’æ±ºå®šã§ãã‚‹</li>
            <li>æ¤œé‡ç·šæ³•ã«ã‚ˆã‚‹å®šé‡åˆ†æã‚’å®Ÿæ–½ã§ãã‚‹</li>
            <li>é…ä½å­å ´ç†è«–ã‚’ç”¨ã„ã¦é·ç§»é‡‘å±éŒ¯ä½“ã®è‰²ã‚’äºˆæ¸¬ã§ãã‚‹</li>
            <li>ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ã¨ã‚¹ãƒšã‚¯ãƒˆãƒ«å‰å‡¦ç†ãŒã§ãã‚‹</li>
            <li>å¤šæ³¢é•·è§£æã«ã‚ˆã‚‹å¤šæˆåˆ†å®šé‡ãŒã§ãã‚‹</li>
        </ul>

        <h3>ãƒ¬ãƒ™ãƒ«3: å¿œç”¨åŠ›</h3>
        <ul>
            <li>æ•£ä¹±å…‰ã‚’å«ã‚€è¤‡é›‘ãªã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’è£œæ­£ã§ãã‚‹</li>
            <li>æ™‚é–“åˆ†è§£UV-Visåˆ†å…‰æ³•ã§åå¿œé€Ÿåº¦å®šæ•°ã‚’æ±ºå®šã§ãã‚‹</li>
            <li>æº¶åª’åŠ¹æœã‚’è€ƒæ…®ã—ãŸã‚¹ãƒšã‚¯ãƒˆãƒ«è§£æãŒã§ãã‚‹</li>
            <li>æ©Ÿæ¢°å­¦ç¿’ã‚’ç”¨ã„ãŸã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿è§£æãŒã§ãã‚‹</li>
        </ul>
    </div>

    <div class="references">
        <h2>å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Atkins, P., de Paula, J. (2010). <em>Physical Chemistry</em> (9th ed.). Oxford University Press, pp. 465-468 (Beer-Lambert law), pp. 495-502 (electronic transitions), pp. 510-518 (ligand field theory). - UV-Visåˆ†å…‰æ³•ã®é‡å­åŠ›å­¦çš„åŸºç¤ã€é›»å­é·ç§»ã®é¸æŠå‰‡ã€é…ä½å­å ´ç†è«–ã®è©³ç´°ãªè§£èª¬</li>
            <li>Figgis, B.N., Hitchman, M.A. (2000). <em>Ligand Field Theory and Its Applications</em>. Wiley-VCH, pp. 85-105 (d-orbital splitting), pp. 120-135 (spectrochemical series), pp. 140-150 (electronic spectra of complexes). - é…ä½å­å ´ç†è«–ã®ä½“ç³»çš„è§£èª¬ã€d-dé·ç§»ã¨éŒ¯ä½“ã®è‰²ã€åˆ†å…‰åŒ–å­¦ç³»åˆ—ã®ç†è«–çš„èƒŒæ™¯</li>
            <li>Tauc, J., Grigorovici, R., Vancu, A. (1966). Optical properties and electronic structure of amorphous germanium. <em>Physica Status Solidi (b)</em>, 15(2), 627-637. DOI: 10.1002/pssb.19660150224 - Taucãƒ—ãƒ­ãƒƒãƒˆæ³•ã®åŸè«–æ–‡ã€åŠå°ä½“ã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ±ºå®šæ³•ã®ç¢ºç«‹</li>
            <li>Perkampus, H.-H. (1992). <em>UV-VIS Spectroscopy and Its Applications</em>. Springer, pp. 1-18 (principles), pp. 32-48 (quantitative analysis), pp. 120-145 (solvent effects), pp. 165-180 (practical applications). - UV-Visåˆ†å…‰æ³•ã®å®Ÿè·µçš„å¿œç”¨ã€å®šé‡åˆ†ææ³•ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«è§£é‡ˆã®å®Ÿä¾‹é›†</li>
            <li>Casida, M. E. (1995). Time-dependent density functional response theory for molecules. In <em>Recent Advances in Density Functional Methods (Part I)</em>, pp. 155-192. World Scientific, Singapore. - TDDFTæ³•ã«ã‚ˆã‚‹UV-Visã‚¹ãƒšã‚¯ãƒˆãƒ«è¨ˆç®—ã®ç†è«–çš„åŸºç¤</li>
            <li>SciPy 1.11 documentation. scipy.optimize.curve_fit, scipy.optimize.nnls. https://docs.scipy.org/doc/scipy/reference/optimize.html - éç·šå½¢æœ€å°äºŒä¹—ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã€éè² æœ€å°äºŒä¹—æ³•ã€ã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã¸ã®å¿œç”¨</li>
            <li>MakuÅ‚a, P., Pacia, M., Macyk, W. (2018). How to correctly determine the band gap energy of modified semiconductor photocatalysts based on UVâ€“Vis spectra. <em>Journal of Physical Chemistry Letters</em>, 9(23), 6814-6817. DOI: 10.1021/acs.jpclett.8b02892 - Taucãƒ—ãƒ­ãƒƒãƒˆæ³•ã®æ­£ç¢ºãªé©ç”¨æ³•ã€ã‚ˆãã‚ã‚‹èª¤ã‚Šã¨ãã®å›é¿æ³•</li>
            <li>scikit-learn 1.3 documentation. Ensemble methods (RandomForestRegressor). https://scikit-learn.org/stable/modules/ensemble.html#forest - ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ¬ã‚¹ãƒˆå›å¸°ã€UV-Visã‚¹ãƒšã‚¯ãƒˆãƒ«ã®æ©Ÿæ¢°å­¦ç¿’è§£æã¸ã®å¿œç”¨</li>
        </ol>
    </div>

    <script>
        // MathJax configuration
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };

        // Mermaid initialization
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>