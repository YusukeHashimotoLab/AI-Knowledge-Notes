<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« :åˆ†å…‰åˆ†æã®åŸºç¤ - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-sm);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-sm);
            line-height: 1.8;
        }

        ul, ol {
            margin-bottom: var(--spacing-sm);
            padding-left: var(--spacing-lg);
        }

        li {
            margin-bottom: 0.5rem;
            line-height: 1.7;
        }

        .info-box {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            border-left: 4px solid var(--color-accent);
            padding: var(--spacing-md);
            margin: var(--spacing-md) 0;
            border-radius: var(--border-radius);
        }

        .info-box strong {
            color: var(--color-accent-light);
        }

        .mermaid {
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            margin: var(--spacing-md) 0;
            text-align: center;
        }

        pre {
            background-color: var(--color-code-bg);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            overflow-x: auto;
            margin: var(--spacing-md) 0;
            border: 1px solid var(--color-border);
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        .code-example {
            margin: var(--spacing-md) 0;
        }

        .code-example h4 {
            color: var(--color-primary);
            margin-bottom: var(--spacing-sm);
            font-size: 1.1rem;
        }

        details {
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
            margin: var(--spacing-md) 0;
            border: 1px solid var(--color-border);
        }

        summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--color-primary);
            user-select: none;
            padding: var(--spacing-sm);
            margin: calc(-1 * var(--spacing-md));
            margin-bottom: var(--spacing-md);
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.15) 0%, rgba(245, 87, 108, 0.15) 100%);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }

        summary:hover {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.25) 0%, rgba(245, 87, 108, 0.25) 100%);
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
            gap: var(--spacing-md);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            text-decoration: none;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg);
            background-color: var(--color-bg-alt);
            text-align: center;
            border-top: 1px solid var(--color-border);
        }

        footer p {
            margin-bottom: var(--spacing-sm);
            color: var(--color-text-light);
        }

        footer a {
            color: var(--color-link);
            text-decoration: none;
        }

        footer a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.6rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .navigation {
                flex-direction: column;
            }
        }
    
        
    
        /* Breadcrumb styles */
        .breadcrumb {
            background: #f7fafc;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid #e2e8f0;
            font-size: 0.9rem;
        }

        .breadcrumb-content {
            max-width: 900px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .breadcrumb a {
            color: #667eea;
            text-decoration: none;
            transition: color 0.2s;
        }

        .breadcrumb a:hover {
            color: #764ba2;
            text-decoration: underline;
        }

        .breadcrumb-separator {
            color: #a0aec0;
            margin: 0 0.25rem;
        }

        .breadcrumb-current {
            color: #4a5568;
            font-weight: 500;
        }
    </style>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#f093fb',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#f5576c',
                lineColor: '#f5576c',
                secondaryColor: '#f7fafc',
                tertiaryColor: '#ffffff'
            }
        });
    </script>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
</head>
<body>
            <nav class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="/AI-Knowledge-Notes/knowledge/jp/index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/MS/index.html">ææ–™ç§‘å­¦</a><span class="breadcrumb-separator">â€º</span><a href="/AI-Knowledge-Notes/knowledge/jp/MS/spectroscopy-introduction/index.html">Spectroscopy</a><span class="breadcrumb-separator">â€º</span><span class="breadcrumb-current">Chapter 1</span>
        </div>
    </nav>

        <header>
        <div class="header-content">
            <h1>ç¬¬1ç« ï¼šåˆ†å…‰åˆ†æã®åŸºç¤</h1>
            <p class="subtitle">å…‰ã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨ã‹ã‚‰èª­ã¿è§£ãææ–™ã®æœ¬è³ª</p>
            <div class="meta">
                <span class="meta-item">ğŸ“š ã‚·ãƒªãƒ¼ã‚º: åˆ†å…‰åˆ†æå…¥é–€</span>
                <span class="meta-item">â±ï¸ å­¦ç¿’æ™‚é–“: 90åˆ†</span>
                <span class="meta-item">ğŸ¯ é›£æ˜“åº¦: åˆç´š</span>
            </div>
        </div>
    </header>

    <main class="container">
        <h2>ã‚¤ãƒ³ãƒˆãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³</h2>

        <p>åˆ†å…‰åˆ†æï¼ˆSpectroscopyï¼‰ã¯ã€å…‰ã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨ã‚’åˆ©ç”¨ã—ã¦ã€ææ–™ã®é›»å­çŠ¶æ…‹ã€åŒ–å­¦çµåˆã€æ§‹é€ ã€çµ„æˆã‚’è§£æ˜ã™ã‚‹å¼·åŠ›ãªåˆ†ææ‰‹æ³•ã§ã™ã€‚ã“ã®ç« ã§ã¯ã€ã‚ã‚‰ã‚†ã‚‹åˆ†å…‰æ³•ã®åŸºç›¤ã¨ãªã‚‹é‡å­åŠ›å­¦çš„åŸç†ã‚’å­¦ã³ã€Beer-Lambertå‰‡ã€é·ç§»ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã€é¸æŠå‰‡ãªã©ã€å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ã‚’è§£é‡ˆã™ã‚‹ãŸã‚ã®ç†è«–çš„åŸºç¤ã‚’ç¿’å¾—ã—ã¾ã™ã€‚</p>

        <div class="info-box">
            <strong>ãªãœåˆ†å…‰åˆ†æãŒé‡è¦ãªã®ã‹ï¼Ÿ</strong><br>
            åˆ†å…‰åˆ†æã¯éç ´å£Šçš„ã§ã€å¾®é‡è©¦æ–™ã«é©ç”¨ã§ãã€å¤šæ§˜ãªã‚¨ãƒãƒ«ã‚®ãƒ¼é ˜åŸŸï¼ˆXç·šã‹ã‚‰ãƒã‚¤ã‚¯ãƒ­æ³¢ã¾ã§ï¼‰ã§ææ–™ã®ç•°ãªã‚‹æ€§è³ªã‚’æ¢ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚åŠå°ä½“ã®ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—æ¸¬å®šã€æœ‰æ©Ÿåˆ†å­ã®å®˜èƒ½åŸºåŒå®šã€è§¦åª’è¡¨é¢ã®åŒ–å­¦çŠ¶æ…‹è§£æãªã©ã€Materials Informaticsã«ãŠã‘ã‚‹ææ–™æ¢ç´¢ãƒ»è¨­è¨ˆã®åŸºç›¤æŠ€è¡“ã§ã™ã€‚
        </div>

        <h2>1. å…‰ã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨ã®åŸºç¤</h2>

        <h3>1.1 é›»ç£æ³¢ã®æ€§è³ª</h3>

        <p>å…‰ã¯é›»ç£æ³¢ã¨ã—ã¦æ³¢å‹•æ€§ã¨ç²’å­æ€§ã®äºŒé‡æ€§ã‚’æŒã¡ã¾ã™ã€‚æ³¢å‹•ã¨ã—ã¦ã®å…‰ã¯æ³¢é•· $\lambda$ï¼ˆnmï¼‰ã‚„æ³¢æ•° $\tilde{\nu}$ï¼ˆcm<sup>-1</sup>ï¼‰ã§è¡¨ç¾ã•ã‚Œã€ç²’å­ã¨ã—ã¦ã®å…‰å­ã¯ä»¥ä¸‹ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã¡ã¾ã™ï¼š</p>

        <p>$$E = h\nu = \frac{hc}{\lambda} = hc\tilde{\nu}$$</p>

        <p>ã“ã“ã§ã€$h = 6.626 \times 10^{-34}$ JÂ·sï¼ˆãƒ—ãƒ©ãƒ³ã‚¯å®šæ•°ï¼‰ã€$c = 2.998 \times 10^8$ m/sï¼ˆå…‰é€Ÿï¼‰ã§ã™ã€‚</p>

        <div class="info-box">
            <strong>ã‚¨ãƒãƒ«ã‚®ãƒ¼é ˜åŸŸã¨å¯¾å¿œã™ã‚‹é·ç§»</strong><br>
            <ul>
                <li><strong>Xç·šï¼ˆ0.01-10 nmï¼‰</strong>: å†…æ®»é›»å­åŠ±èµ·ï¼ˆXPS, XRFï¼‰</li>
                <li><strong>UV-Visï¼ˆ200-800 nmï¼‰</strong>: ä¾¡é›»å­åŠ±èµ·ã€HOMO-LUMOé·ç§»</li>
                <li><strong>èµ¤å¤–ï¼ˆ2.5-25 Î¼mï¼‰</strong>: åˆ†å­æŒ¯å‹•</li>
                <li><strong>ãƒã‚¤ã‚¯ãƒ­æ³¢ï¼ˆ0.1-10 cmï¼‰</strong>: åˆ†å­å›è»¢</li>
            </ul>
        </div>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: Plancké–¢æ•°ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ãƒ—ãƒ©ãƒ³ã‚¯å®šæ•°ã¨å…‰é€Ÿ
h = 6.62607015e-34  # JÂ·s
c = 2.99792458e8    # m/s
eV = 1.602176634e-19  # J (1 eV)

def wavelength_to_energy(wavelength_nm):
    """
    æ³¢é•·ï¼ˆnmï¼‰ã‹ã‚‰å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰ã‚’è¨ˆç®—

    Parameters:
    -----------
    wavelength_nm : float or array
        æ³¢é•·ï¼ˆnanometerï¼‰

    Returns:
    --------
    energy_eV : float or array
        å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆelectron voltï¼‰
    """
    wavelength_m = wavelength_nm * 1e-9
    energy_J = h * c / wavelength_m
    energy_eV = energy_J / eV
    return energy_eV

def wavenumber_to_energy(wavenumber_cm):
    """
    æ³¢æ•°ï¼ˆcm^-1ï¼‰ã‹ã‚‰å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰ã‚’è¨ˆç®—

    Parameters:
    -----------
    wavenumber_cm : float or array
        æ³¢æ•°ï¼ˆcm^-1ï¼‰

    Returns:
    --------
    energy_eV : float or array
        å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰
    """
    energy_J = h * c * wavenumber_cm * 100  # cm^-1 to m^-1
    energy_eV = energy_J / eV
    return energy_eV

# å¯è¦–å…‰é ˜åŸŸï¼ˆ380-780 nmï¼‰ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼è¨ˆç®—
wavelengths = np.linspace(380, 780, 100)
energies = wavelength_to_energy(wavelengths)

# å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
plt.plot(wavelengths, energies, linewidth=2, color='#f093fb')
plt.fill_between(wavelengths, energies, alpha=0.3, color='#f5576c')
plt.xlabel('æ³¢é•· (nm)', fontsize=12)
plt.ylabel('å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
plt.title('å¯è¦–å…‰é ˜åŸŸã®æ³¢é•·-ã‚¨ãƒãƒ«ã‚®ãƒ¼é–¢ä¿‚', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('wavelength_energy.png', dpi=300, bbox_inches='tight')
plt.show()

# å…·ä½“ä¾‹
print(f"èµ¤è‰²å…‰ï¼ˆ650 nmï¼‰ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼: {wavelength_to_energy(650):.3f} eV")
print(f"é’è‰²å…‰ï¼ˆ450 nmï¼‰ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼: {wavelength_to_energy(450):.3f} eV")
print(f"IRæŒ¯å‹•ï¼ˆ1000 cm^-1ï¼‰ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼: {wavenumber_to_energy(1000):.4f} eV")
</code></pre>
        </div>

        <h3>1.2 å¸åãƒ»ç™ºå…‰ãƒ»æ•£ä¹±ã®åŸºæœ¬éç¨‹</h3>

        <p>å…‰ã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨ã¯ä¸»ã«3ã¤ã®éç¨‹ã«åˆ†é¡ã•ã‚Œã¾ã™ï¼š</p>

        <div class="mermaid">
        flowchart TD
            A[å…¥å°„å…‰] --> B{ç‰©è³ªã¨ã®ç›¸äº’ä½œç”¨}
            B -->|å¸å| C[åŠ±èµ·çŠ¶æ…‹ã¸é·ç§»<br/>E = Eâ‚‚ - Eâ‚]
            B -->|ç™ºå…‰| D[åŸºåº•çŠ¶æ…‹ã¸é·ç§»<br/>è›å…‰ãƒ»ç‡å…‰]
            B -->|æ•£ä¹±| E[Rayleighæ•£ä¹±<br/>å¼¾æ€§æ•£ä¹±]
            B -->|æ•£ä¹±| F[Ramanæ•£ä¹±<br/>éå¼¾æ€§æ•£ä¹±]

            style A fill:#f093fb,color:#fff
            style C fill:#f5576c,color:#fff
            style D fill:#f5576c,color:#fff
            style E fill:#a8e6cf,color:#000
            style F fill:#a8e6cf,color:#000
        </div>

        <ul>
            <li><strong>å¸åï¼ˆAbsorptionï¼‰</strong>: å…‰å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒç‰©è³ªã®2ã¤ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ã®å·® $\Delta E = E_2 - E_1$ ã¨ä¸€è‡´ã™ã‚‹ã¨ãã€å…‰å­ãŒå¸åã•ã‚Œã€ç‰©è³ªã¯åŠ±èµ·çŠ¶æ…‹ã¸é·ç§»ã—ã¾ã™ã€‚</li>
            <li><strong>ç™ºå…‰ï¼ˆEmissionï¼‰</strong>: åŠ±èµ·çŠ¶æ…‹ã‹ã‚‰åŸºåº•çŠ¶æ…‹ã¸é·ç§»ã™ã‚‹éš›ã«å…‰å­ã‚’æ”¾å‡ºã—ã¾ã™ã€‚è›å…‰ï¼ˆFluorescenceï¼‰ã€ç‡å…‰ï¼ˆPhosphorescenceï¼‰ã€åŒ–å­¦ç™ºå…‰ãªã©ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li><strong>æ•£ä¹±ï¼ˆScatteringï¼‰</strong>: Rayleighæ•£ä¹±ï¼ˆå¼¾æ€§ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰åŒ–ãªã—ï¼‰ã¨Ramanæ•£ä¹±ï¼ˆéå¼¾æ€§ã€æŒ¯å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰åŒ–ï¼‰ã«åˆ†é¡ã•ã‚Œã¾ã™ã€‚</li>
        </ul>

        <h3>1.3 Beer-Lambertå‰‡</h3>

        <p>å¸ååˆ†å…‰æ³•ã®åŸºæœ¬æ³•å‰‡ã§ã‚ã‚‹Beer-Lambertå‰‡ï¼ˆLambert-Beerå‰‡ã¨ã‚‚å‘¼ã°ã‚Œã‚‹ï¼‰ã¯ã€å¸å…‰åº¦ $A$ ã¨è©¦æ–™ã®æ¿ƒåº¦ $c$ã€å…‰è·¯é•· $l$ ã®é–¢ä¿‚ã‚’è¨˜è¿°ã—ã¾ã™ï¼š</p>

        <p>$$A = \log_{10}\left(\frac{I_0}{I}\right) = \varepsilon c l$$</p>

        <p>ã“ã“ã§ã€$I_0$ ã¯å…¥å°„å…‰å¼·åº¦ã€$I$ ã¯é€éå…‰å¼·åº¦ã€$\varepsilon$ ã¯ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ï¼ˆL mol<sup>-1</sup> cm<sup>-1</sup>ï¼‰ã§ã™ã€‚é€éç‡ $T$ ã¯ $T = I/I_0$ ã§å®šç¾©ã•ã‚Œã€$A = -\log_{10}(T)$ ã®é–¢ä¿‚ãŒã‚ã‚Šã¾ã™ã€‚</p>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: Beer-Lambertå‰‡ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def beer_lambert(I0, epsilon, concentration, path_length):
    """
    Beer-Lambertå‰‡ã«ã‚ˆã‚‹é€éå…‰å¼·åº¦è¨ˆç®—

    Parameters:
    -----------
    I0 : float
        å…¥å°„å…‰å¼·åº¦
    epsilon : float
        ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° (L mol^-1 cm^-1)
    concentration : float or array
        æ¿ƒåº¦ (mol/L)
    path_length : float
        å…‰è·¯é•· (cm)

    Returns:
    --------
    I : float or array
        é€éå…‰å¼·åº¦
    A : float or array
        å¸å…‰åº¦
    T : float or array
        é€éç‡
    """
    A = epsilon * concentration * path_length
    T = 10**(-A)
    I = I0 * T
    return I, A, T

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
I0 = 1.0  # å…¥å°„å…‰å¼·åº¦ï¼ˆè¦æ ¼åŒ–ï¼‰
epsilon = 1000  # ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°ï¼ˆå…¸å‹çš„ãªæœ‰æ©Ÿè‰²ç´ ï¼‰
path_length = 1.0  # å…‰è·¯é•· 1 cm
concentrations = np.linspace(0, 1e-4, 100)  # æ¿ƒåº¦ç¯„å›²ï¼ˆmol/Lï¼‰

# è¨ˆç®—
I, A, T = beer_lambert(I0, epsilon, concentrations, path_length)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å¸å…‰åº¦ vs æ¿ƒåº¦
ax1.plot(concentrations * 1e6, A, linewidth=2, color='#f093fb', label='å¸å…‰åº¦')
ax1.set_xlabel('æ¿ƒåº¦ (Î¼mol/L)', fontsize=12)
ax1.set_ylabel('å¸å…‰åº¦', fontsize=12)
ax1.set_title('Beer-Lambertå‰‡ï¼šæ¿ƒåº¦ä¾å­˜æ€§', fontsize=14, fontweight='bold')
ax1.grid(True, alpha=0.3)
ax1.legend()

# é€éç‡ vs æ¿ƒåº¦
ax2.plot(concentrations * 1e6, T * 100, linewidth=2, color='#f5576c', label='é€éç‡')
ax2.set_xlabel('æ¿ƒåº¦ (Î¼mol/L)', fontsize=12)
ax2.set_ylabel('é€éç‡ (%)', fontsize=12)
ax2.set_title('é€éç‡ã®æ¿ƒåº¦ä¾å­˜æ€§', fontsize=14, fontweight='bold')
ax2.grid(True, alpha=0.3)
ax2.legend()

plt.tight_layout()
plt.savefig('beer_lambert.png', dpi=300, bbox_inches='tight')
plt.show()

# å®šé‡åˆ†æä¾‹ï¼šå¸å…‰åº¦ã‹ã‚‰æ¿ƒåº¦ã‚’é€†ç®—
measured_A = 0.5
calculated_c = measured_A / (epsilon * path_length)
print(f"æ¸¬å®šå¸å…‰åº¦: {measured_A}")
print(f"é€†ç®—ã•ã‚ŒãŸæ¿ƒåº¦: {calculated_c * 1e6:.2f} Î¼mol/L")
</code></pre>
        </div>

        <h2>2. é‡å­åŠ›å­¦çš„åŸºç¤</h2>

        <h3>2.1 é›»å­çŠ¶æ…‹ã¨æŒ¯å‹•çŠ¶æ…‹</h3>

        <p>åˆ†å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ã¯ã€é›»å­çŠ¶æ…‹ã€æŒ¯å‹•çŠ¶æ…‹ã€å›è»¢çŠ¶æ…‹ã®3ã¤ã®è‡ªç”±åº¦ã«åˆ†é›¢ã§ãã¾ã™ï¼ˆBorn-Oppenheimerè¿‘ä¼¼ï¼‰ï¼š</p>

        <p>$$E_{\text{total}} = E_{\text{electronic}} + E_{\text{vibrational}} + E_{\text{rotational}}$$</p>

        <p>å…¸å‹çš„ãªã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚¹ã‚±ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š</p>

        <ul>
            <li>$E_{\text{electronic}} \sim 1-10$ eVï¼ˆUV-Visé ˜åŸŸï¼‰</li>
            <li>$E_{\text{vibrational}} \sim 0.05-0.5$ eVï¼ˆèµ¤å¤–é ˜åŸŸï¼‰</li>
            <li>$E_{\text{rotational}} \sim 10^{-4}-10^{-3}$ eVï¼ˆãƒã‚¤ã‚¯ãƒ­æ³¢é ˜åŸŸï¼‰</li>
        </ul>

        <h3>2.2 é·ç§»ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¨Fermiã®é»„é‡‘å‰‡</h3>

        <p>å…‰å¸åã«ã‚ˆã‚‹çŠ¶æ…‹ $\left|\psi_i\right\rangle$ ã‹ã‚‰ $\left|\psi_f\right\rangle$ ã¸ã®é·ç§»ç¢ºç‡ã¯ã€Fermiã®é»„é‡‘å‰‡ã§ä¸ãˆã‚‰ã‚Œã¾ã™ï¼š</p>

        <p>$$W_{i \to f} = \frac{2\pi}{\hbar} \left| \left\langle \psi_f \right| \hat{H}_{\text{int}} \left| \psi_i \right\rangle \right|^2 \rho(E_f)$$</p>

        <p>ã“ã“ã§ã€$\hat{H}_{\text{int}}$ ã¯å…‰ã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨ãƒãƒŸãƒ«ãƒˆãƒ‹ã‚¢ãƒ³ã€$\rho(E_f)$ ã¯çµ‚çŠ¶æ…‹ã®çŠ¶æ…‹å¯†åº¦ã§ã™ã€‚é›»æ°—åŒæ¥µå­è¿‘ä¼¼ã§ã¯ã€é·ç§»åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ $\boldsymbol{\mu}_{fi}$ ãŒé‡è¦ã«ãªã‚Šã¾ã™ï¼š</p>

        <p>$$\boldsymbol{\mu}_{fi} = \left\langle \psi_f \right| \hat{\boldsymbol{\mu}} \left| \psi_i \right\rangle = \int \psi_f^* \hat{\boldsymbol{\mu}} \psi_i \, d\tau$$</p>

        <p>é·ç§»åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãŒ0ã§ãªã„ï¼ˆ$\boldsymbol{\mu}_{fi} \neq 0$ï¼‰ã¨ãã€ãã®é·ç§»ã¯ã€Œè¨±å®¹é·ç§»ï¼ˆallowed transitionï¼‰ã€ã€0ã®ã¨ãã€Œç¦åˆ¶é·ç§»ï¼ˆforbidden transitionï¼‰ã€ã¨å‘¼ã°ã‚Œã¾ã™ã€‚</p>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: Fermiã®é»„é‡‘å‰‡ã«ã‚ˆã‚‹é·ç§»ç¢ºç‡è¨ˆç®—</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ç‰©ç†å®šæ•°
hbar = 1.054571817e-34  # JÂ·s
eV = 1.602176634e-19    # J

def transition_probability(transition_dipole_moment, state_density, energy_eV):
    """
    Fermiã®é»„é‡‘å‰‡ã«ã‚ˆã‚‹é·ç§»ç¢ºç‡è¨ˆç®—ï¼ˆç°¡ç•¥åŒ–ç‰ˆï¼‰

    Parameters:
    -----------
    transition_dipole_moment : float
        é·ç§»åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆï¼ˆDebyeï¼‰
    state_density : float
        çŠ¶æ…‹å¯†åº¦ï¼ˆeV^-1ï¼‰
    energy_eV : float
        é·ç§»ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰

    Returns:
    --------
    W : float
        é·ç§»ç¢ºç‡ï¼ˆs^-1ï¼‰
    """
    # Debye to CÂ·må¤‰æ›ï¼ˆ1 D â‰ˆ 3.336e-30 CÂ·mï¼‰
    mu = transition_dipole_moment * 3.336e-30

    # ç°¡ç•¥åŒ–ã•ã‚ŒãŸé·ç§»ç¢ºç‡ï¼ˆé›»æ°—åŒæ¥µå­è¿‘ä¼¼ï¼‰
    # å®Ÿéš›ã®è¨ˆç®—ã§ã¯é›»å ´ã®å¼·åº¦ã‚‚è€ƒæ…®
    W = (2 * np.pi / hbar) * (mu**2) * state_density * eV
    return W

def franck_condon_factor(n_initial, n_final, displacement):
    """
    Franck-Condonå› å­ã®è¿‘ä¼¼è¨ˆç®—ï¼ˆèª¿å’ŒæŒ¯å‹•å­è¿‘ä¼¼ï¼‰

    Parameters:
    -----------
    n_initial : int
        åˆæœŸæŒ¯å‹•é‡å­æ•°
    n_final : int
        çµ‚æŒ¯å‹•é‡å­æ•°
    displacement : float
        å¹³è¡¡ä½ç½®ã®ãšã‚Œï¼ˆç„¡æ¬¡å…ƒï¼‰

    Returns:
    --------
    fc_factor : float
        Franck-Condonå› å­
    """
    # ç°¡ç•¥åŒ–ï¼šGaussianè¿‘ä¼¼
    delta_n = n_final - n_initial
    fc_factor = np.exp(-displacement**2 / 2) * (displacement**delta_n / np.math.factorial(abs(delta_n)))
    return abs(fc_factor)**2

# é·ç§»åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¨é·ç§»ç¢ºç‡ã®é–¢ä¿‚
dipole_moments = np.linspace(0.1, 5.0, 50)  # Debye
state_density = 1e15  # eV^-1ï¼ˆå…¸å‹çš„ãªå›ºä½“ã®å€¤ï¼‰
energy = 2.0  # eV

transition_probs = [transition_probability(mu, state_density, energy) for mu in dipole_moments]

# Franck-Condonå› å­ã®è¨ˆç®—ï¼ˆv=0 â†’ v'é·ç§»ï¼‰
displacements = np.linspace(0, 3, 4)
vibrational_levels = np.arange(0, 8)

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# é·ç§»åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¨é·ç§»ç¢ºç‡
ax1.plot(dipole_moments, np.array(transition_probs) * 1e-15, linewidth=2, color='#f093fb')
ax1.set_xlabel('é·ç§»åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ (Debye)', fontsize=12)
ax1.set_ylabel('é·ç§»ç¢ºç‡ (Ã—10Â¹âµ sâ»Â¹)', fontsize=12)
ax1.set_title('é·ç§»åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¨é·ç§»ç¢ºç‡', fontsize=14, fontweight='bold')
ax1.grid(True, alpha=0.3)

# Franck-Condonå› å­
for d in displacements:
    fc_factors = [franck_condon_factor(0, v, d) for v in vibrational_levels]
    ax2.plot(vibrational_levels, fc_factors, marker='o', linewidth=2, label=f'Î”q = {d:.1f}')

ax2.set_xlabel("çµ‚æŒ¯å‹•é‡å­æ•° v'", fontsize=12)
ax2.set_ylabel('Franck-Condonå› å­', fontsize=12)
ax2.set_title('Franck-Condonå› å­ã®è¨ˆç®—', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('transition_probability.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>
        </div>

        <h3>2.3 é¸æŠå‰‡</h3>

        <p>é¸æŠå‰‡ï¼ˆSelection Rulesï¼‰ã¯ã€ã©ã®é·ç§»ãŒè¨±å®¹ã•ã‚Œã€ã©ã®é·ç§»ãŒç¦åˆ¶ã•ã‚Œã‚‹ã‹ã‚’æ±ºå®šã™ã‚‹é‡å­åŠ›å­¦çš„è¦å‰‡ã§ã™ã€‚ä¸»è¦ãªé¸æŠå‰‡ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ï¼š</p>

        <div class="info-box">
            <strong>ä¸»è¦ãªé¸æŠå‰‡</strong>
            <ul>
                <li><strong>é›»æ°—åŒæ¥µå­é·ç§»ï¼ˆUV-Vis, IRï¼‰</strong>: $\Delta l = \pm 1$ï¼ˆè»Œé“è§’é‹å‹•é‡é‡å­æ•°ï¼‰ã€$\Delta S = 0$ï¼ˆã‚¹ãƒ”ãƒ³ï¼‰ã€$\Delta v = \pm 1$ï¼ˆæŒ¯å‹•é‡å­æ•°ã€èª¿å’ŒæŒ¯å‹•å­è¿‘ä¼¼ï¼‰</li>
                <li><strong>Laporteå‰‡ï¼ˆä¸­å¿ƒå¯¾ç§°åˆ†å­ï¼‰</strong>: $g \leftrightarrow u$ ã®ã¿è¨±å®¹ï¼ˆ$g \leftrightarrow g$ ã‚„ $u \leftrightarrow u$ ã¯ç¦åˆ¶ï¼‰</li>
                <li><strong>ã‚¹ãƒ”ãƒ³é¸æŠå‰‡</strong>: ä¸€é‡é …-ä¸€é‡é …ã€ä¸‰é‡é …-ä¸‰é‡é …é·ç§»ã¯è¨±å®¹ã€ä¸€é‡é …-ä¸‰é‡é …é·ç§»ã¯ç¦åˆ¶ï¼ˆãŸã ã—ã‚¹ãƒ”ãƒ³è»Œé“ç›¸äº’ä½œç”¨ã§ç·©å’Œï¼‰</li>
                <li><strong>Ramanæ•£ä¹±</strong>: åˆ†æ¥µç‡ã®å¤‰åŒ– $\partial \alpha / \partial Q \neq 0$ï¼ˆIRå¸åã¨ã¯ç›¸è£œçš„ï¼‰</li>
            </ul>
        </div>

        <h3>2.4 Franck-CondonåŸç†</h3>

        <p>Franck-CondonåŸç†ã¯ã€é›»å­é·ç§»ãŒæŒ¯å‹•ã®æ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆ~10<sup>-13</sup> sï¼‰ã«æ¯”ã¹ã¦éå¸¸ã«é«˜é€Ÿï¼ˆ~10<sup>-15</sup> sï¼‰ã§ã‚ã‚‹ãŸã‚ã€é›»å­é·ç§»ä¸­ã«åŸå­æ ¸ã®ä½ç½®ãŒã»ã¨ã‚“ã©å¤‰åŒ–ã—ãªã„ã“ã¨ã‚’è¿°ã¹ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¸åãƒ»ç™ºå…‰ã‚¹ãƒšã‚¯ãƒˆãƒ«ã«æŒ¯å‹•æ§‹é€ ãŒç¾ã‚Œã¾ã™ã€‚</p>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: Franck-CondonåŸç†ã«ã‚ˆã‚‹å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import factorial

def harmonic_oscillator_wavefunction(x, n, omega=1.0, m=1.0, hbar=1.0):
    """
    èª¿å’ŒæŒ¯å‹•å­ã®æ³¢å‹•é–¢æ•°

    Parameters:
    -----------
    x : array
        åº§æ¨™
    n : int
        é‡å­æ•°
    omega : float
        è§’æŒ¯å‹•æ•°
    m : float
        è³ªé‡
    hbar : float
        æ›ç®—ãƒ—ãƒ©ãƒ³ã‚¯å®šæ•°

    Returns:
    --------
    psi : array
        æ³¢å‹•é–¢æ•°
    """
    alpha = np.sqrt(m * omega / hbar)
    norm = (alpha / np.pi)**0.25 / np.sqrt(2**n * factorial(n))
    hermite = np.polynomial.hermite.hermval(alpha * x, [0]*n + [1])
    psi = norm * hermite * np.exp(-alpha**2 * x**2 / 2)
    return psi

def franck_condon_spectrum(displacement=1.5, n_levels=6):
    """
    Franck-CondonåŸç†ã«åŸºã¥ãå¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

    Parameters:
    -----------
    displacement : float
        åŠ±èµ·çŠ¶æ…‹ã¨åŸºåº•çŠ¶æ…‹ã®å¹³è¡¡ä½ç½®ã®ãšã‚Œ
    n_levels : int
        è€ƒæ…®ã™ã‚‹æŒ¯å‹•æº–ä½ã®æ•°

    Returns:
    --------
    energies : array
        é·ç§»ã‚¨ãƒãƒ«ã‚®ãƒ¼
    intensities : array
        ç›¸å¯¾å¼·åº¦
    """
    # åº§æ¨™ã‚°ãƒªãƒƒãƒ‰
    x = np.linspace(-6, 6, 1000)

    # åŸºåº•çŠ¶æ…‹ v=0 ã®æ³¢å‹•é–¢æ•°
    psi_ground = harmonic_oscillator_wavefunction(x, 0)

    energies = []
    intensities = []

    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

    # ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã‚¨ãƒãƒ«ã‚®ãƒ¼æ›²ç·š
    V_ground = 0.5 * x**2
    V_excited = 0.5 * (x - displacement)**2 + 3.0  # åŠ±èµ·çŠ¶æ…‹ï¼ˆä¸Šæ–¹ã‚·ãƒ•ãƒˆï¼‰

    ax1.plot(x, V_ground, 'b-', linewidth=2, label='åŸºåº•çŠ¶æ…‹')
    ax1.plot(x, V_excited, 'r-', linewidth=2, label='åŠ±èµ·çŠ¶æ…‹')

    # å„æŒ¯å‹•æº–ä½ã¸ã®é·ç§»
    for n in range(n_levels):
        # åŠ±èµ·çŠ¶æ…‹ v=n ã®æ³¢å‹•é–¢æ•°ï¼ˆå¹³è¡¡ä½ç½®ãŒdisplacementã ã‘ãšã‚Œã¦ã„ã‚‹ï¼‰
        psi_excited = harmonic_oscillator_wavefunction(x - displacement, n)

        # Franck-Condonç©åˆ†ï¼ˆé‡ãªã‚Šç©åˆ†ï¼‰
        fc_integral = np.trapz(psi_ground * psi_excited, x)
        fc_factor = fc_integral**2

        # é·ç§»ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆé›»å­é·ç§» + æŒ¯å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼‰
        E_transition = 3.0 + n * 0.2  # eVå˜ä½

        energies.append(E_transition)
        intensities.append(fc_factor)

        # ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«æ›²ç·šä¸Šã«æŒ¯å‹•æº–ä½ã‚’æç”»
        E_vib_ground = 0.5
        E_vib_excited = 3.0 + n * 0.2
        ax1.axhline(y=E_vib_excited, xmin=0.5, xmax=0.9, color='red', alpha=0.3, linewidth=1)

        # é·ç§»ã®çŸ¢å°
        if n < 4:
            ax1.annotate('', xy=(displacement, E_vib_excited), xytext=(0, E_vib_ground),
                        arrowprops=dict(arrowstyle='->', color='green', alpha=0.5, lw=1.5))

    ax1.set_xlabel('æ ¸é–“åº§æ¨™ (a.u.)', fontsize=12)
    ax1.set_ylabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
    ax1.set_title('Franck-CondonåŸç†', fontsize=14, fontweight='bold')
    ax1.legend()
    ax1.set_ylim(0, 5)
    ax1.grid(True, alpha=0.3)

    # å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«
    energies = np.array(energies)
    intensities = np.array(intensities)

    # Gaussian broadening
    E_range = np.linspace(2.8, 4.5, 500)
    spectrum = np.zeros_like(E_range)
    broadening = 0.05  # eV

    for E, I in zip(energies, intensities):
        spectrum += I * np.exp(-(E_range - E)**2 / (2 * broadening**2))

    ax2.plot(E_range, spectrum, linewidth=2, color='#f093fb')
    ax2.fill_between(E_range, spectrum, alpha=0.3, color='#f5576c')
    ax2.set_xlabel('å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
    ax2.set_ylabel('å¸åå¼·åº¦ (a.u.)', fontsize=12)
    ax2.set_title('ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸå¸åã‚¹ãƒšã‚¯ãƒˆãƒ«', fontsize=14, fontweight='bold')
    ax2.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('franck_condon_spectrum.png', dpi=300, bbox_inches='tight')
    plt.show()

    return energies, intensities

# å®Ÿè¡Œ
energies, intensities = franck_condon_spectrum(displacement=1.5)
print("é·ç§»ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV):", energies)
print("Franck-Condonå› å­:", intensities)
</code></pre>
        </div>

        <h2>3. åˆ†å…‰æ³•ã®åˆ†é¡</h2>

        <h3>3.1 ã‚¨ãƒãƒ«ã‚®ãƒ¼é ˜åŸŸåˆ¥åˆ†é¡</h3>

        <div class="mermaid">
        flowchart LR
            A[é›»ç£æ³¢ã‚¹ãƒšã‚¯ãƒˆãƒ«] --> B[Xç·š<br/>0.01-10 nm]
            A --> C[UV-Vis<br/>200-800 nm]
            A --> D[èµ¤å¤–<br/>2.5-25 Î¼m]
            A --> E[ãƒã‚¤ã‚¯ãƒ­æ³¢<br/>0.1-10 cm]

            B --> B1[XPS<br/>åŒ–å­¦çŠ¶æ…‹]
            B --> B2[XRF<br/>å…ƒç´ åˆ†æ]

            C --> C1[UV-Vis<br/>é›»å­é·ç§»]
            C --> C2[PL<br/>ç™ºå…‰]

            D --> D1[FTIR<br/>æŒ¯å‹•]
            D --> D2[Raman<br/>æŒ¯å‹•]

            E --> E1[ESR<br/>ç£æ°—å…±é³´]
            E --> E2[NMR<br/>æ ¸ã‚¹ãƒ”ãƒ³]

            style A fill:#f093fb,color:#fff
            style B fill:#ff6b6b,color:#fff
            style C fill:#4ecdc4,color:#fff
            style D fill:#ffe66d,color:#000
            style E fill:#a8e6cf,color:#000
        </flowchart>
        </div>

        <h3>3.2 æ¸¬å®šåŸç†åˆ¥åˆ†é¡</h3>

        <ul>
            <li><strong>å¸ååˆ†å…‰æ³•ï¼ˆAbsorption Spectroscopyï¼‰</strong>: UV-Vis, FTIR, åŸå­å¸å…‰ï¼ˆAASï¼‰</li>
            <li><strong>ç™ºå…‰åˆ†å…‰æ³•ï¼ˆEmission Spectroscopyï¼‰</strong>: è›å…‰ï¼ˆPLï¼‰, ç‡å…‰ã€åŒ–å­¦ç™ºå…‰</li>
            <li><strong>æ•£ä¹±åˆ†å…‰æ³•ï¼ˆScattering Spectroscopyï¼‰</strong>: Raman, Brillouinæ•£ä¹±</li>
            <li><strong>å…±é³´åˆ†å…‰æ³•ï¼ˆResonance Spectroscopyï¼‰</strong>: NMR, ESR</li>
        </ul>

        <h2>4. ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®èª­ã¿æ–¹</h2>

        <h3>4.1 æ¨ªè»¸ã¨ç¸¦è»¸ã®å¤‰æ›</h3>

        <p>åˆ†å…‰ãƒ‡ãƒ¼ã‚¿ã¯æ§˜ã€…ãªå˜ä½ç³»ã§è¡¨ç¾ã•ã‚Œã¾ã™ï¼š</p>

        <ul>
            <li><strong>æ¨ªè»¸</strong>: æ³¢é•· $\lambda$ (nm), æ³¢æ•° $\tilde{\nu}$ (cm<sup>-1</sup>), ã‚¨ãƒãƒ«ã‚®ãƒ¼ $E$ (eV), å‘¨æ³¢æ•° $\nu$ (Hz)</li>
            <li><strong>ç¸¦è»¸</strong>: é€éç‡ $T$ (%), å¸å…‰åº¦ $A$, å¼·åº¦ $I$ (a.u.), ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° $\varepsilon$</li>
        </ul>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: æ³¢é•·ãƒ»æ³¢æ•°ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼å¤‰æ›è¨ˆç®—æ©Ÿ</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

class SpectroscopyUnitConverter:
    """åˆ†å…‰åˆ†æã®å˜ä½å¤‰æ›ã‚¯ãƒ©ã‚¹"""

    def __init__(self):
        self.h = 6.62607015e-34  # JÂ·s
        self.c = 2.99792458e8    # m/s
        self.eV = 1.602176634e-19  # J

    def wavelength_to_wavenumber(self, wavelength_nm):
        """æ³¢é•·ï¼ˆnmï¼‰â†’ æ³¢æ•°ï¼ˆcm^-1ï¼‰"""
        wavelength_cm = wavelength_nm * 1e-7
        return 1 / wavelength_cm

    def wavenumber_to_wavelength(self, wavenumber_cm):
        """æ³¢æ•°ï¼ˆcm^-1ï¼‰â†’ æ³¢é•·ï¼ˆnmï¼‰"""
        wavelength_cm = 1 / wavenumber_cm
        return wavelength_cm * 1e7

    def wavelength_to_energy_eV(self, wavelength_nm):
        """æ³¢é•·ï¼ˆnmï¼‰â†’ ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰"""
        wavelength_m = wavelength_nm * 1e-9
        energy_J = self.h * self.c / wavelength_m
        return energy_J / self.eV

    def energy_eV_to_wavelength(self, energy_eV):
        """ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰â†’ æ³¢é•·ï¼ˆnmï¼‰"""
        energy_J = energy_eV * self.eV
        wavelength_m = self.h * self.c / energy_J
        return wavelength_m * 1e9

    def wavelength_to_frequency(self, wavelength_nm):
        """æ³¢é•·ï¼ˆnmï¼‰â†’ å‘¨æ³¢æ•°ï¼ˆHzï¼‰"""
        wavelength_m = wavelength_nm * 1e-9
        return self.c / wavelength_m

    def transmittance_to_absorbance(self, T):
        """é€éç‡ï¼ˆ%ï¼‰â†’ å¸å…‰åº¦"""
        T_fraction = T / 100
        return -np.log10(T_fraction)

    def absorbance_to_transmittance(self, A):
        """å¸å…‰åº¦ â†’ é€éç‡ï¼ˆ%ï¼‰"""
        return 10**(-A) * 100

# å¤‰æ›å™¨ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–
converter = SpectroscopyUnitConverter()

# UV-Visé ˜åŸŸã®å¤‰æ›è¡¨
wavelengths_nm = np.array([200, 250, 300, 400, 500, 600, 700, 800])
wavenumbers_cm = converter.wavelength_to_wavenumber(wavelengths_nm)
energies_eV = converter.wavelength_to_energy_eV(wavelengths_nm)
frequencies_THz = converter.wavelength_to_frequency(wavelengths_nm) / 1e12

print("=" * 70)
print("UV-Visé ˜åŸŸã®å˜ä½å¤‰æ›è¡¨")
print("=" * 70)
print(f"{'æ³¢é•· (nm)':<12} {'æ³¢æ•° (cmâ»Â¹)':<15} {'ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)':<15} {'å‘¨æ³¢æ•° (THz)':<12}")
print("-" * 70)
for wl, wn, E, f in zip(wavelengths_nm, wavenumbers_cm, energies_eV, frequencies_THz):
    print(f"{wl:<12.0f} {wn:<15.0f} {E:<15.2f} {f:<12.1f}")

# IRé ˜åŸŸã®å¤‰æ›è¡¨
print("\n" + "=" * 70)
print("èµ¤å¤–é ˜åŸŸã®å˜ä½å¤‰æ›è¡¨")
print("=" * 70)
wavenumbers_IR = np.array([4000, 3000, 2000, 1500, 1000, 500])
wavelengths_IR = converter.wavenumber_to_wavelength(wavenumbers_IR)
energies_IR_eV = converter.wavelength_to_energy_eV(wavelengths_IR)

print(f"{'æ³¢æ•° (cmâ»Â¹)':<15} {'æ³¢é•· (Î¼m)':<15} {'ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)':<15}")
print("-" * 70)
for wn, wl, E in zip(wavenumbers_IR, wavelengths_IR / 1000, energies_IR_eV):
    print(f"{wn:<15.0f} {wl:<15.2f} {E:<15.4f}")

# é€éç‡ã¨å¸å…‰åº¦ã®é–¢ä¿‚
transmittances = np.linspace(1, 100, 100)
absorbances = converter.transmittance_to_absorbance(transmittances)

plt.figure(figsize=(10, 6))
plt.plot(transmittances, absorbances, linewidth=2, color='#f093fb')
plt.xlabel('é€éç‡ (%)', fontsize=12)
plt.ylabel('å¸å…‰åº¦', fontsize=12)
plt.title('é€éç‡ã¨å¸å…‰åº¦ã®é–¢ä¿‚', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('transmittance_absorbance.png', dpi=300, bbox_inches='tight')
plt.show()
</code></pre>
        </div>

        <h3>4.2 ãƒ”ãƒ¼ã‚¯ä½ç½®ã€å¼·åº¦ã€å¹…ã®è§£é‡ˆ</h3>

        <p>ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ãƒ”ãƒ¼ã‚¯ã‹ã‚‰ä»¥ä¸‹ã®æƒ…å ±ãŒå¾—ã‚‰ã‚Œã¾ã™ï¼š</p>

        <ul>
            <li><strong>ãƒ”ãƒ¼ã‚¯ä½ç½®</strong>: ã‚¨ãƒãƒ«ã‚®ãƒ¼æº–ä½ã®å·® $\Delta E$ã€åŒ–å­¦çµåˆã®ç¨®é¡ã€ãƒãƒ³ãƒ‰ã‚®ãƒ£ãƒƒãƒ—</li>
            <li><strong>ãƒ”ãƒ¼ã‚¯å¼·åº¦</strong>: é·ç§»ç¢ºç‡ã€æ¿ƒåº¦ã€ãƒ¢ãƒ«å¸å…‰ä¿‚æ•°</li>
            <li><strong>ãƒ”ãƒ¼ã‚¯å¹…ï¼ˆåŠå€¤å…¨å¹…, FWHMï¼‰</strong>: ä¸å‡ä¸€åºƒãŒã‚Šï¼ˆçµæ™¶æ€§ã€æ¬ é™¥ï¼‰ã€å‡ä¸€åºƒãŒã‚Šï¼ˆå¯¿å‘½ï¼‰</li>
        </ul>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: ã‚¬ã‚¦ã‚¹ãƒ»ãƒ­ãƒ¼ãƒ¬ãƒ³ãƒ„ç·šå½¢ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def gaussian(x, amplitude, center, width):
    """
    Gaussianç·šå½¢é–¢æ•°

    Parameters:
    -----------
    x : array
        æ¨ªè»¸ï¼ˆæ³¢é•·ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ãªã©ï¼‰
    amplitude : float
        ãƒ”ãƒ¼ã‚¯é«˜ã•
    center : float
        ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒä½ç½®
    width : float
        æ¨™æº–åå·®ï¼ˆFWHM = 2.355 * widthï¼‰

    Returns:
    --------
    y : array
        Gaussianæ›²ç·š
    """
    return amplitude * np.exp(-(x - center)**2 / (2 * width**2))

def lorentzian(x, amplitude, center, width):
    """
    Lorentzianç·šå½¢é–¢æ•°

    Parameters:
    -----------
    x : array
        æ¨ªè»¸
    amplitude : float
        ãƒ”ãƒ¼ã‚¯é«˜ã•
    center : float
        ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒä½ç½®
    width : float
        åŠå€¤åŠå¹…ï¼ˆHWHMï¼‰

    Returns:
    --------
    y : array
        Lorentzianæ›²ç·š
    """
    return amplitude * (width**2 / ((x - center)**2 + width**2))

def voigt(x, amplitude, center, width_g, width_l):
    """
    Voigtç·šå½¢é–¢æ•°ï¼ˆGaussianã¨Lorentzianã®ç•³ã¿è¾¼ã¿ï¼‰
    ç°¡ç•¥åŒ–ç‰ˆï¼špseudo-Voigt

    Parameters:
    -----------
    x : array
        æ¨ªè»¸
    amplitude : float
        ãƒ”ãƒ¼ã‚¯é«˜ã•
    center : float
        ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒä½ç½®
    width_g : float
        Gaussianæˆåˆ†ã®å¹…
    width_l : float
        Lorentzianæˆåˆ†ã®å¹…

    Returns:
    --------
    y : array
        Voigtæ›²ç·š
    """
    # pseudo-Voigt: Gaussianã¨Lorentzianã®ç·šå½¢çµåˆ
    eta = 0.5  # mixing parameter
    g = gaussian(x, amplitude, center, width_g)
    l = lorentzian(x, amplitude, center, width_l)
    return eta * l + (1 - eta) * g

# åˆæˆã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ç”Ÿæˆï¼ˆãƒã‚¤ã‚ºã‚ã‚Šï¼‰
x_data = np.linspace(400, 700, 300)  # æ³¢é•·ï¼ˆnmï¼‰
true_params = {
    'amplitude': 1.0,
    'center': 550,
    'width': 30
}

# Gaussian + ãƒã‚¤ã‚º
y_data = gaussian(x_data, **true_params) + np.random.normal(0, 0.02, len(x_data))

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
initial_guess = [0.8, 540, 25]

popt_gauss, _ = curve_fit(gaussian, x_data, y_data, p0=initial_guess)
popt_lorentz, _ = curve_fit(lorentzian, x_data, y_data, p0=initial_guess)

# çµæœã®å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ
ax1.scatter(x_data, y_data, s=10, alpha=0.5, color='gray', label='å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿')
ax1.plot(x_data, gaussian(x_data, *popt_gauss), 'r-', linewidth=2, label='Gaussianãƒ•ã‚£ãƒƒãƒˆ')
ax1.plot(x_data, lorentzian(x_data, *popt_lorentz), 'b--', linewidth=2, label='Lorentzianãƒ•ã‚£ãƒƒãƒˆ')
ax1.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax1.set_ylabel('å¸å…‰åº¦ (a.u.)', fontsize=12)
ax1.set_title('ãƒ”ãƒ¼ã‚¯å½¢çŠ¶ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)

# ç·šå½¢é–¢æ•°ã®æ¯”è¼ƒ
x_comparison = np.linspace(-100, 100, 500)
y_gauss = gaussian(x_comparison, 1.0, 0, 20)
y_lorentz = lorentzian(x_comparison, 1.0, 0, 20)
y_voigt = voigt(x_comparison, 1.0, 0, 20, 10)

ax2.plot(x_comparison, y_gauss, 'r-', linewidth=2, label='Gaussian')
ax2.plot(x_comparison, y_lorentz, 'b-', linewidth=2, label='Lorentzian')
ax2.plot(x_comparison, y_voigt, 'g-', linewidth=2, label='Voigt (pseudo)')
ax2.set_xlabel('ç›¸å¯¾ä½ç½®', fontsize=12)
ax2.set_ylabel('è¦æ ¼åŒ–å¼·åº¦', fontsize=12)
ax2.set_title('ç·šå½¢é–¢æ•°ã®æ¯”è¼ƒ', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)
ax2.set_yscale('log')
ax2.set_ylim(1e-4, 2)

plt.tight_layout()
plt.savefig('peak_fitting.png', dpi=300, bbox_inches='tight')
plt.show()

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‡ºåŠ›
print("Gaussianãƒ•ã‚£ãƒƒãƒˆçµæœ:")
print(f"  æŒ¯å¹…: {popt_gauss[0]:.3f}")
print(f"  ä¸­å¿ƒ: {popt_gauss[1]:.1f} nm")
print(f"  FWHM: {2.355 * popt_gauss[2]:.1f} nm")

print("\nLorentzianãƒ•ã‚£ãƒƒãƒˆçµæœ:")
print(f"  æŒ¯å¹…: {popt_lorentz[0]:.3f}")
print(f"  ä¸­å¿ƒ: {popt_lorentz[1]:.1f} nm")
print(f"  FWHM: {2 * popt_lorentz[2]:.1f} nm")
</code></pre>
        </div>

        <h3>4.3 ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³å‡¦ç†ã®é‡è¦æ€§</h3>

        <p>å®Ÿæ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«ã«ã¯ã€è©¦æ–™ãƒ›ãƒ«ãƒ€ãƒ¼ã®å¸åã€æ•£ä¹±ã€è£…ç½®ã®ãƒ‰ãƒªãƒ•ãƒˆãªã©ã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ãŒå«ã¾ã‚Œã¾ã™ã€‚æ­£ç¢ºãªå®šé‡åˆ†æã«ã¯ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ãŒä¸å¯æ¬ ã§ã™ã€‚</p>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ï¼ˆå¤šé …å¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼‰</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import find_peaks

def polynomial_baseline(x, y, degree=2, exclude_peaks=True):
    """
    å¤šé …å¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã«ã‚ˆã‚‹ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£

    Parameters:
    -----------
    x : array
        æ¨ªè»¸ãƒ‡ãƒ¼ã‚¿
    y : array
        ç¸¦è»¸ãƒ‡ãƒ¼ã‚¿ï¼ˆã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼‰
    degree : int
        å¤šé …å¼ã®æ¬¡æ•°
    exclude_peaks : bool
        ãƒ”ãƒ¼ã‚¯é ˜åŸŸã‚’é™¤å¤–ã—ã¦ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°

    Returns:
    --------
    baseline : array
        æ¨å®šã•ã‚ŒãŸãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³
    corrected : array
        ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£å¾Œã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
    """
    if exclude_peaks:
        # ãƒ”ãƒ¼ã‚¯æ¤œå‡º
        peaks, _ = find_peaks(y, prominence=0.1 * np.max(y))

        # ãƒ”ãƒ¼ã‚¯å‘¨è¾ºã‚’é™¤å¤–ã—ãŸãƒã‚¹ã‚¯
        mask = np.ones(len(y), dtype=bool)
        window = int(len(y) * 0.05)  # ãƒ”ãƒ¼ã‚¯å‘¨è¾º5%ã‚’é™¤å¤–
        for peak in peaks:
            start = max(0, peak - window)
            end = min(len(y), peak + window)
            mask[start:end] = False

        # ãƒã‚¹ã‚¯ã•ã‚ŒãŸé ˜åŸŸã§å¤šé …å¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
        coeffs = np.polyfit(x[mask], y[mask], degree)
    else:
        coeffs = np.polyfit(x, y, degree)

    baseline = np.polyval(coeffs, x)
    corrected = y - baseline

    return baseline, corrected

# åˆæˆã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ä»˜ãï¼‰
x = np.linspace(400, 700, 500)

# çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ï¼ˆ2ã¤ã®ãƒ”ãƒ¼ã‚¯ï¼‰
true_spectrum = gaussian(x, 0.8, 500, 25) + gaussian(x, 0.5, 600, 20)

# ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ï¼ˆ2æ¬¡å¤šé …å¼ï¼‰
baseline_true = 0.1 + 0.0005 * (x - 550) + 0.000001 * (x - 550)**2

# è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ« = çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ« + ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³ + ãƒã‚¤ã‚º
observed_spectrum = true_spectrum + baseline_true + np.random.normal(0, 0.01, len(x))

# ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£
baseline_estimated, corrected_spectrum = polynomial_baseline(x, observed_spectrum, degree=2, exclude_peaks=True)

# å¯è¦–åŒ–
fig, (ax1, ax2, ax3) = plt.subplots(3, 1, figsize=(10, 12))

# è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«
ax1.plot(x, observed_spectrum, 'k-', linewidth=1.5, label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax1.plot(x, baseline_true, 'r--', linewidth=2, label='çœŸã®ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³')
ax1.plot(x, baseline_estimated, 'b--', linewidth=2, label='æ¨å®šãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³')
ax1.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax1.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax1.set_title('ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ï¼šè¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)

# è£œæ­£å¾Œã®ã‚¹ãƒšã‚¯ãƒˆãƒ«
ax2.plot(x, corrected_spectrum, 'g-', linewidth=2, label='è£œæ­£å¾Œã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax2.plot(x, true_spectrum, 'r--', linewidth=2, alpha=0.7, label='çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax2.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax2.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax2.set_title('ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£å¾Œ', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

# æ®‹å·®è§£æ
residual = corrected_spectrum - true_spectrum
ax3.plot(x, residual, 'purple', linewidth=1)
ax3.axhline(y=0, color='k', linestyle='--', linewidth=1)
ax3.fill_between(x, residual, alpha=0.3, color='purple')
ax3.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax3.set_ylabel('æ®‹å·® (a.u.)', fontsize=12)
ax3.set_title('è£œæ­£ã®æ®‹å·®', fontsize=14, fontweight='bold')
ax3.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('baseline_correction.png', dpi=300, bbox_inches='tight')
plt.show()

# çµ±è¨ˆé‡
print(f"ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£å‰ã®RMSèª¤å·®: {np.sqrt(np.mean((observed_spectrum - true_spectrum)**2)):.4f}")
print(f"ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£å¾Œã®RMSèª¤å·®: {np.sqrt(np.mean(residual**2)):.4f}")
</code></pre>
        </div>

        <h2>5. å¤šãƒ”ãƒ¼ã‚¯ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®è§£æ</h2>

        <div class="code-example">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹8: è¤‡æ•°ãƒ”ãƒ¼ã‚¯ã®è‡ªå‹•æ¤œå‡ºã¨ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h4>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import find_peaks
from scipy.optimize import curve_fit

def multi_gaussian(x, *params):
    """
    è¤‡æ•°ã®Gaussiané–¢æ•°ã®å’Œ

    Parameters:
    -----------
    x : array
        æ¨ªè»¸
    params : tuple
        (amplitude1, center1, width1, amplitude2, center2, width2, ...)

    Returns:
    --------
    y : array
        è¤‡æ•°Gaussianã®å’Œ
    """
    y = np.zeros_like(x)
    for i in range(0, len(params), 3):
        amplitude = params[i]
        center = params[i+1]
        width = params[i+2]
        y += gaussian(x, amplitude, center, width)
    return y

def auto_peak_fitting(x, y, min_prominence=0.1):
    """
    è‡ªå‹•ãƒ”ãƒ¼ã‚¯æ¤œå‡ºã¨ãƒãƒ«ãƒGaussianãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°

    Parameters:
    -----------
    x : array
        æ¨ªè»¸ãƒ‡ãƒ¼ã‚¿
    y : array
        ç¸¦è»¸ãƒ‡ãƒ¼ã‚¿
    min_prominence : float
        ãƒ”ãƒ¼ã‚¯æ¤œå‡ºã®æœ€å°ãƒ—ãƒ­ãƒŸãƒãƒ³ã‚¹ï¼ˆæœ€å¤§å€¤ã«å¯¾ã™ã‚‹ç›¸å¯¾å€¤ï¼‰

    Returns:
    --------
    params : array
        ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    fitted : array
        ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°æ›²ç·š
    individual_peaks : list of arrays
        å€‹åˆ¥ã®ãƒ”ãƒ¼ã‚¯æˆåˆ†
    """
    # ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£
    baseline, y_corrected = polynomial_baseline(x, y, degree=1, exclude_peaks=True)

    # ãƒ”ãƒ¼ã‚¯æ¤œå‡º
    peaks, properties = find_peaks(y_corrected, prominence=min_prominence * np.max(y_corrected))

    print(f"æ¤œå‡ºã•ã‚ŒãŸãƒ”ãƒ¼ã‚¯æ•°: {len(peaks)}")

    # åˆæœŸæ¨å®šå€¤
    initial_params = []
    for peak in peaks:
        amplitude = y_corrected[peak]
        center = x[peak]
        width = 20  # åˆæœŸå¹…ã®æ¨å®š
        initial_params.extend([amplitude, center, width])

    # ãƒãƒ«ãƒGaussianãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
    try:
        popt, _ = curve_fit(multi_gaussian, x, y_corrected, p0=initial_params, maxfev=10000)
        fitted = multi_gaussian(x, *popt)

        # å€‹åˆ¥ãƒ”ãƒ¼ã‚¯æˆåˆ†
        individual_peaks = []
        for i in range(0, len(popt), 3):
            peak_component = gaussian(x, popt[i], popt[i+1], popt[i+2])
            individual_peaks.append(peak_component)

        return popt, fitted, individual_peaks, baseline

    except RuntimeError:
        print("ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°å¤±æ•—ï¼šåæŸã—ã¾ã›ã‚“ã§ã—ãŸ")
        return None, None, None, baseline

# è¤‡é›‘ãªã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ç”Ÿæˆï¼ˆ4ã¤ã®ãƒ”ãƒ¼ã‚¯ï¼‰
x_data = np.linspace(400, 700, 600)
true_components = [
    gaussian(x_data, 0.7, 450, 20),
    gaussian(x_data, 1.0, 520, 25),
    gaussian(x_data, 0.6, 580, 18),
    gaussian(x_data, 0.4, 650, 22)
]
true_spectrum = sum(true_components)
baseline = 0.05 + 0.0001 * x_data
observed = true_spectrum + baseline + np.random.normal(0, 0.02, len(x_data))

# è‡ªå‹•ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
params, fitted, individual, baseline_est = auto_peak_fitting(x_data, observed, min_prominence=0.15)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ
ax1.plot(x_data, observed, 'k.', markersize=2, alpha=0.5, label='è¦³æ¸¬ãƒ‡ãƒ¼ã‚¿')
if fitted is not None:
    ax1.plot(x_data, fitted + baseline_est, 'r-', linewidth=2, label='ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°æ›²ç·š')
    for i, peak in enumerate(individual):
        ax1.plot(x_data, peak + baseline_est, '--', linewidth=1.5, alpha=0.7, label=f'ãƒ”ãƒ¼ã‚¯ {i+1}')
ax1.plot(x_data, baseline_est, 'g--', linewidth=2, label='ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³')
ax1.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax1.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax1.set_title('å¤šãƒ”ãƒ¼ã‚¯ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®è‡ªå‹•ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°', fontsize=14, fontweight='bold')
ax1.legend(loc='best', fontsize=9)
ax1.grid(True, alpha=0.3)

# åˆ†é›¢ã•ã‚ŒãŸãƒ”ãƒ¼ã‚¯æˆåˆ†
if individual is not None:
    for i, peak in enumerate(individual):
        ax2.plot(x_data, peak, linewidth=2, label=f'ãƒ”ãƒ¼ã‚¯ {i+1}')
        ax2.fill_between(x_data, peak, alpha=0.3)
ax2.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax2.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax2.set_title('åˆ†é›¢ã•ã‚ŒãŸãƒ”ãƒ¼ã‚¯æˆåˆ†', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('multi_peak_fitting.png', dpi=300, bbox_inches='tight')
plt.show()

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœã®è©³ç´°
if params is not None:
    print("\n" + "=" * 60)
    print("ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ")
    print("=" * 60)
    for i in range(0, len(params), 3):
        peak_num = i // 3 + 1
        amplitude = params[i]
        center = params[i+1]
        width = params[i+2]
        fwhm = 2.355 * width
        area = amplitude * width * np.sqrt(2 * np.pi)
        print(f"\nãƒ”ãƒ¼ã‚¯ {peak_num}:")
        print(f"  ä¸­å¿ƒä½ç½®: {center:.1f} nm")
        print(f"  æŒ¯å¹…: {amplitude:.3f}")
        print(f"  FWHM: {fwhm:.1f} nm")
        print(f"  é¢ç©: {area:.3f}")
</code></pre>
        </div>

        <h2>æ¼”ç¿’å•é¡Œ</h2>

        <details>
            <summary><strong>æ¼”ç¿’å•é¡Œï¼ˆã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ï¼‰</strong></summary>

            <h3>Easy ãƒ¬ãƒ™ãƒ«ï¼ˆåŸºæœ¬è¨ˆç®—ï¼‰</h3>

            <p><strong>å•é¡Œ1</strong>: æ³¢é•·500 nmã®å…‰ã®å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’eVå˜ä½ã§è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚ã¾ãŸã€ã“ã®å…‰ã¯å¯è¦–å…‰ã®ã©ã®è‰²ã«å¯¾å¿œã—ã¾ã™ã‹ï¼Ÿ</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">h = 6.626e-34  # JÂ·s
c = 2.998e8    # m/s
eV = 1.602e-19  # J

wavelength = 500e-9  # m
E = h * c / wavelength / eV
print(f"å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼: {E:.2f} eV")
# å‡ºåŠ›: å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼: 2.48 eV
# 500 nmã¯ç·‘è‰²ã®å…‰ã«å¯¾å¿œ
</code></pre>
            </details>

            <p><strong>å•é¡Œ2</strong>: Beer-Lambertå‰‡ã«ãŠã„ã¦ã€ãƒ¢ãƒ«å¸å…‰ä¿‚æ•° $\varepsilon = 50000$ L mol<sup>-1</sup> cm<sup>-1</sup>ã€å…‰è·¯é•· $l = 1$ cmã€å¸å…‰åº¦ $A = 0.8$ ã®ã¨ãã€è©¦æ–™ã®æ¿ƒåº¦ï¼ˆmol/Lï¼‰ã‚’æ±‚ã‚ã¦ãã ã•ã„ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">epsilon = 50000  # L mol^-1 cm^-1
l = 1.0  # cm
A = 0.8

c = A / (epsilon * l)
print(f"æ¿ƒåº¦: {c:.2e} mol/L = {c * 1e6:.2f} Î¼mol/L")
# å‡ºåŠ›: æ¿ƒåº¦: 1.60e-05 mol/L = 16.00 Î¼mol/L
</code></pre>
            </details>

            <p><strong>å•é¡Œ3</strong>: èµ¤å¤–åˆ†å…‰ã«ãŠã„ã¦ã€æ³¢æ•° 1650 cm<sup>-1</sup> ã®ãƒ”ãƒ¼ã‚¯ãŒè¦³æ¸¬ã•ã‚Œã¾ã—ãŸã€‚ã“ã®æ³¢æ•°ã«å¯¾å¿œã™ã‚‹æ³¢é•·ï¼ˆÎ¼mï¼‰ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆeVï¼‰ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">wavenumber = 1650  # cm^-1

# æ³¢æ•°ã‹ã‚‰æ³¢é•·
wavelength_cm = 1 / wavenumber
wavelength_um = wavelength_cm * 1e4
print(f"æ³¢é•·: {wavelength_um:.2f} Î¼m")

# ã‚¨ãƒãƒ«ã‚®ãƒ¼
h = 6.626e-34
c = 2.998e8
eV = 1.602e-19
energy_J = h * c * wavenumber * 100  # cm^-1 to m^-1
energy_eV = energy_J / eV
print(f"ã‚¨ãƒãƒ«ã‚®ãƒ¼: {energy_eV:.4f} eV")
# å‡ºåŠ›: æ³¢é•·: 6.06 Î¼m, ã‚¨ãƒãƒ«ã‚®ãƒ¼: 0.2045 eV
</code></pre>
            </details>

            <h3>Medium ãƒ¬ãƒ™ãƒ«ï¼ˆå®Ÿè·µçš„è¨ˆç®—ï¼‰</h3>

            <p><strong>å•é¡Œ4</strong>: ä¸‹è¨˜ã®ãƒ‡ãƒ¼ã‚¿ã¯æº¶æ¶²ã®æ¿ƒåº¦ã¨å¸å…‰åº¦ã®æ¸¬å®šçµæœã§ã™ã€‚Beer-Lambertå‰‡ã‚’ç”¨ã„ã¦æ¤œé‡ç·šã‚’ä½œæˆã—ã€æœªçŸ¥è©¦æ–™ï¼ˆå¸å…‰åº¦ 0.65ï¼‰ã®æ¿ƒåº¦ã‚’æ¨å®šã—ã¦ãã ã•ã„ã€‚</p>

            <table border="1" style="border-collapse: collapse; margin: 1em 0;">
                <tr><th>æ¿ƒåº¦ (Î¼mol/L)</th><td>10</td><td>20</td><td>30</td><td>40</td><td>50</td></tr>
                <tr><th>å¸å…‰åº¦</th><td>0.18</td><td>0.35</td><td>0.53</td><td>0.71</td><td>0.88</td></tr>
            </table>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.stats import linregress

# ãƒ‡ãƒ¼ã‚¿
concentrations = np.array([10, 20, 30, 40, 50])  # Î¼mol/L
absorbances = np.array([0.18, 0.35, 0.53, 0.71, 0.88])

# ç·šå½¢å›å¸°
slope, intercept, r_value, p_value, std_err = linregress(concentrations, absorbances)

print(f"æ¤œé‡ç·š: A = {slope:.4f} * C + {intercept:.4f}")
print(f"ç›¸é–¢ä¿‚æ•° RÂ²: {r_value**2:.4f}")

# æœªçŸ¥è©¦æ–™ã®æ¿ƒåº¦æ¨å®š
unknown_A = 0.65
unknown_C = (unknown_A - intercept) / slope
print(f"æœªçŸ¥è©¦æ–™ã®æ¿ƒåº¦: {unknown_C:.1f} Î¼mol/L")

# å¯è¦–åŒ–
plt.figure(figsize=(8, 6))
plt.scatter(concentrations, absorbances, s=100, color='#f093fb', label='æ¸¬å®šãƒ‡ãƒ¼ã‚¿')
plt.plot(concentrations, slope * concentrations + intercept, 'r-', linewidth=2, label=f'æ¤œé‡ç·š (RÂ²={r_value**2:.3f})')
plt.scatter([unknown_C], [unknown_A], s=150, color='#f5576c', marker='*', label='æœªçŸ¥è©¦æ–™', zorder=5)
plt.xlabel('æ¿ƒåº¦ (Î¼mol/L)', fontsize=12)
plt.ylabel('å¸å…‰åº¦', fontsize=12)
plt.title('æ¤œé‡ç·šã®ä½œæˆ', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()

# å‡ºåŠ›: æœªçŸ¥è©¦æ–™ã®æ¿ƒåº¦: 36.4 Î¼mol/L
</code></pre>
            </details>

            <p><strong>å•é¡Œ5</strong>: å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ãŒä»¥ä¸‹ã®Gaussiané–¢æ•°ã§è¿‘ä¼¼ã§ãã‚‹ã¨ã—ã¾ã™ã€‚ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒã€FWHMã€ç©åˆ†å¼·åº¦ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>

            <p>$$I(\lambda) = 0.8 \exp\left(-\frac{(\lambda - 520)^2}{2 \times 25^2}\right)$$</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">import numpy as np
from scipy.integrate import quad

# Gaussiané–¢æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
amplitude = 0.8
center = 520  # nm
sigma = 25  # nm

# FWHMè¨ˆç®—
fwhm = 2.355 * sigma
print(f"ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒ: {center} nm")
print(f"FWHM: {fwhm:.1f} nm")

# ç©åˆ†å¼·åº¦ï¼ˆè§£æè§£ï¼‰
integral_analytical = amplitude * sigma * np.sqrt(2 * np.pi)
print(f"ç©åˆ†å¼·åº¦ï¼ˆè§£æè§£ï¼‰: {integral_analytical:.2f}")

# æ•°å€¤ç©åˆ†ã«ã‚ˆã‚‹æ¤œè¨¼
def gaussian_func(x):
    return amplitude * np.exp(-(x - center)**2 / (2 * sigma**2))

integral_numerical, error = quad(gaussian_func, 0, 1000)
print(f"ç©åˆ†å¼·åº¦ï¼ˆæ•°å€¤ç©åˆ†ï¼‰: {integral_numerical:.2f}")

# å‡ºåŠ›: ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒ: 520 nm, FWHM: 58.9 nm, ç©åˆ†å¼·åº¦: 50.13
</code></pre>
            </details>

            <p><strong>å•é¡Œ6</strong>: Franck-CondonåŸç†ã«åŸºã¥ãã€åŸºåº•çŠ¶æ…‹ï¼ˆv=0ï¼‰ã‹ã‚‰åŠ±èµ·çŠ¶æ…‹ã®ç•°ãªã‚‹æŒ¯å‹•æº–ä½ï¼ˆv'=0, 1, 2, 3ï¼‰ã¸ã®é·ç§»å¼·åº¦ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚åŠ±èµ·çŠ¶æ…‹ã®å¹³è¡¡ä½ç½®ãŒåŸºåº•çŠ¶æ…‹ã‹ã‚‰ç„¡æ¬¡å…ƒåº§æ¨™ã§1.2ã ã‘ãšã‚Œã¦ã„ã‚‹ã¨ã—ã¾ã™ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">import numpy as np

def franck_condon_factor_harmonic(n_i, n_f, displacement):
    """
    Franck-Condonå› å­ï¼ˆèª¿å’ŒæŒ¯å‹•å­è¿‘ä¼¼ï¼‰
    Simplified formula for n_i = 0
    """
    from scipy.special import factorial

    if n_i == 0:
        S = displacement**2 / 2  # Huang-Rhys factor
        fc = np.exp(-S) * (S**n_f) / factorial(n_f)
    return fc

displacement = 1.2
vibrational_levels = [0, 1, 2, 3]

print("Franck-Condonå› å­ï¼ˆv=0 â†’ v'é·ç§»ï¼‰:")
print("=" * 40)
for v_f in vibrational_levels:
    fc = franck_condon_factor_harmonic(0, v_f, displacement)
    print(f"v=0 â†’ v'={v_f}: {fc:.4f}")

# æ­£è¦åŒ–ã•ã‚ŒãŸç›¸å¯¾å¼·åº¦
fc_values = [franck_condon_factor_harmonic(0, v, displacement) for v in vibrational_levels]
fc_normalized = np.array(fc_values) / np.max(fc_values)
print("\nç›¸å¯¾å¼·åº¦ï¼ˆæœ€å¤§å€¤ã§æ­£è¦åŒ–ï¼‰:")
for v, intensity in zip(vibrational_levels, fc_normalized):
    print(f"v'={v}: {intensity:.2f}")
</code></pre>
            </details>

            <h3>Hard ãƒ¬ãƒ™ãƒ«ï¼ˆé«˜åº¦ãªè§£æï¼‰</h3>

            <p><strong>å•é¡Œ7</strong>: 2ã¤ã®Gaussianãƒ”ãƒ¼ã‚¯ï¼ˆä¸­å¿ƒ: 500 nm, 550 nmã€å¹…: 20 nmã€æŒ¯å¹…æ¯” 2:1ï¼‰ã‹ã‚‰ãªã‚‹åˆæˆã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’ç”Ÿæˆã—ã€ãƒã‚¤ã‚ºï¼ˆæ¨™æº–åå·®0.05ï¼‰ã‚’ä»˜åŠ ã—ã¦ãã ã•ã„ã€‚ãã®å¾Œã€scipy.optimize.curve_fitã‚’ç”¨ã„ã¦2æˆåˆ†ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã‚’è¡Œã„ã€å…ƒã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å¾©å…ƒã—ã¦ãã ã•ã„ã€‚</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.optimize import curve_fit

def two_gaussian(x, A1, c1, w1, A2, c2, w2):
    """2ã¤ã®Gaussianã®å’Œ"""
    g1 = A1 * np.exp(-(x - c1)**2 / (2 * w1**2))
    g2 = A2 * np.exp(-(x - c2)**2 / (2 * w2**2))
    return g1 + g2

# çœŸã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
true_params = [1.0, 500, 20, 0.5, 550, 20]

# åˆæˆã‚¹ãƒšã‚¯ãƒˆãƒ«
x = np.linspace(400, 650, 300)
y_true = two_gaussian(x, *true_params)
y_noisy = y_true + np.random.normal(0, 0.05, len(x))

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼ˆåˆæœŸæ¨å®šå€¤ï¼‰
initial_guess = [0.8, 495, 18, 0.4, 545, 22]
popt, pcov = curve_fit(two_gaussian, x, y_noisy, p0=initial_guess)

# çµæœã®å¯è¦–åŒ–
plt.figure(figsize=(10, 6))
plt.plot(x, y_noisy, 'k.', markersize=3, alpha=0.5, label='ãƒã‚¤ã‚ºä»˜ããƒ‡ãƒ¼ã‚¿')
plt.plot(x, y_true, 'g--', linewidth=2, label='çœŸã®ã‚¹ãƒšã‚¯ãƒˆãƒ«')
plt.plot(x, two_gaussian(x, *popt), 'r-', linewidth=2, label='ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ')

# å€‹åˆ¥æˆåˆ†
plt.plot(x, popt[0] * np.exp(-(x - popt[1])**2 / (2 * popt[2]**2)), 'b--', alpha=0.7, label='ãƒ”ãƒ¼ã‚¯1')
plt.plot(x, popt[3] * np.exp(-(x - popt[4])**2 / (2 * popt[5]**2)), 'm--', alpha=0.7, label='ãƒ”ãƒ¼ã‚¯2')

plt.xlabel('æ³¢é•· (nm)', fontsize=12)
plt.ylabel('å¼·åº¦ (a.u.)', fontsize=12)
plt.title('2æˆåˆ†Gaussianãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°', fontsize=14, fontweight='bold')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ¯”è¼ƒ
print("ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¾©å…ƒçµæœ:")
print("=" * 60)
labels = ['æŒ¯å¹…1', 'ä¸­å¿ƒ1', 'å¹…1', 'æŒ¯å¹…2', 'ä¸­å¿ƒ2', 'å¹…2']
for label, true, fitted in zip(labels, true_params, popt):
    error = abs(fitted - true) / true * 100
    print(f"{label:8s}: çœŸå€¤={true:6.2f}, ãƒ•ã‚£ãƒƒãƒˆ={fitted:6.2f}, èª¤å·®={error:5.2f}%")
</code></pre>
            </details>

            <p><strong>å•é¡Œ8</strong>: é¸æŠå‰‡ã«åŸºã¥ãã€ä»¥ä¸‹ã®é·ç§»ãŒè¨±å®¹ã‹ç¦åˆ¶ã‹ã‚’åˆ¤å®šã—ã¦ãã ã•ã„ã€‚</p>

            <ul>
                <li>(a) æ°´ç´ åŸå­ã®1s â†’ 2pé·ç§»</li>
                <li>(b) æ°´ç´ åŸå­ã®1s â†’ 2sé·ç§»</li>
                <li>(c) ãƒ™ãƒ³ã‚¼ãƒ³ã® Ï€ â†’ Ï€* é·ç§»ï¼ˆD<sub>6h</sub> å¯¾ç§°æ€§ï¼‰</li>
                <li>(d) ã‚ªã‚¯ã‚¿ãƒ˜ãƒ‰ãƒ©ãƒ«éŒ¯ä½“ã®d-dé·ç§»ï¼ˆO<sub>h</sub> å¯¾ç§°æ€§ï¼‰</li>
            </ul>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <p>(a) <strong>è¨±å®¹</strong>: $\Delta l = +1$ (s â†’ p)ã€é›»æ°—åŒæ¥µå­é·ç§»ã®é¸æŠå‰‡ã‚’æº€ãŸã™ã€‚</p>
                <p>(b) <strong>ç¦åˆ¶</strong>: $\Delta l = 0$ (s â†’ s)ã€é›»æ°—åŒæ¥µå­é·ç§»ã§ã¯ $\Delta l = \pm 1$ ãŒå¿…è¦ã€‚</p>
                <p>(c) <strong>è¨±å®¹</strong>: Ï€è»Œé“ï¼ˆÏ€<sub>u</sub>ï¼‰ã‹ã‚‰ Ï€*è»Œé“ï¼ˆÏ€<sub>g</sub>*ï¼‰ã¸ã®é·ç§»ã¯Laporteå‰‡ï¼ˆg â†” uï¼‰ã‚’æº€ãŸã™ã€‚</p>
                <p>(d) <strong>ç¦åˆ¶</strong>ï¼ˆLaporteç¦åˆ¶ï¼‰: ä¸¡æ–¹ã¨ã‚‚dè»Œé“ï¼ˆgå¯¾ç§°æ€§ï¼‰ãªã®ã§ g â†” g é·ç§»ã€‚ãŸã ã—ã€æŒ¯å‹•ã«ã‚ˆã‚‹å¯¾ç§°æ€§ã®å´©ã‚Œã‚„é…ä½å­ã®åŠ¹æœã§å®Ÿéš›ã«ã¯å¼±ã„å¸åãŒè¦³æ¸¬ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚</p>
            </details>

            <p><strong>å•é¡Œ9</strong>: å®Ÿæ¸¬ã®å¸åã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿ãŒä¸ãˆã‚‰ã‚ŒãŸå ´åˆã€ä»¥ä¸‹ã®æ‰‹é †ã§è§£æã—ã¦ãã ã•ã„ï¼š</p>

            <ol>
                <li>ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ï¼ˆ2æ¬¡å¤šé …å¼ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼‰</li>
                <li>ãƒ”ãƒ¼ã‚¯è‡ªå‹•æ¤œå‡º</li>
                <li>å„ãƒ”ãƒ¼ã‚¯ã®Gaussianãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</li>
                <li>ãƒ”ãƒ¼ã‚¯ä¸­å¿ƒã€FWHMã€ç©åˆ†å¼·åº¦ã®ç®—å‡º</li>
            </ol>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹ï¼ˆå®Œå…¨ãªè§£æã‚³ãƒ¼ãƒ‰ï¼‰</summary>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.signal import find_peaks
from scipy.optimize import curve_fit
from scipy.integrate import simps

# ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆå®Ÿæ¸¬ã‚’æ¨¡æ“¬ï¼‰
x_data = np.linspace(400, 700, 500)
true_spectrum = (gaussian(x_data, 0.6, 480, 22) +
                 gaussian(x_data, 0.9, 540, 28) +
                 gaussian(x_data, 0.5, 620, 25))
baseline = 0.08 + 0.0002 * x_data
observed = true_spectrum + baseline + np.random.normal(0, 0.03, len(x_data))

# ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£
baseline_fit, _ = polynomial_baseline(x_data, observed, degree=2, exclude_peaks=True)
corrected = observed - baseline_fit

# ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ”ãƒ¼ã‚¯æ¤œå‡º
peaks, properties = find_peaks(corrected, prominence=0.15)
print(f"æ¤œå‡ºã•ã‚ŒãŸãƒ”ãƒ¼ã‚¯æ•°: {len(peaks)}")

# ã‚¹ãƒ†ãƒƒãƒ—3: å„ãƒ”ãƒ¼ã‚¯ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
results = []
for i, peak_idx in enumerate(peaks):
    # ãƒ”ãƒ¼ã‚¯å‘¨è¾ºã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡º
    window = 80
    start = max(0, peak_idx - window)
    end = min(len(x_data), peak_idx + window)

    x_region = x_data[start:end]
    y_region = corrected[start:end]

    # åˆæœŸæ¨å®š
    p0 = [corrected[peak_idx], x_data[peak_idx], 20]

    try:
        popt, _ = curve_fit(gaussian, x_region, y_region, p0=p0)

        # ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æŠ½å‡º
        amplitude, center, sigma = popt
        fwhm = 2.355 * sigma

        # ç©åˆ†å¼·åº¦ï¼ˆGaussianã®è§£æè§£ï¼‰
        area = amplitude * sigma * np.sqrt(2 * np.pi)

        results.append({
            'peak_number': i + 1,
            'center': center,
            'amplitude': amplitude,
            'fwhm': fwhm,
            'area': area,
            'params': popt
        })

    except RuntimeError:
        print(f"ãƒ”ãƒ¼ã‚¯ {i+1} ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°å¤±æ•—")

# ã‚¹ãƒ†ãƒƒãƒ—4: çµæœã®å¯è¦–åŒ–ã¨å‡ºåŠ›
fig, (ax1, ax2) = plt.subplots(2, 1, figsize=(12, 10))

# å…ƒã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã¨ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³
ax1.plot(x_data, observed, 'k-', linewidth=1, alpha=0.5, label='è¦³æ¸¬ã‚¹ãƒšã‚¯ãƒˆãƒ«')
ax1.plot(x_data, baseline_fit, 'g--', linewidth=2, label='ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³')
ax1.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax1.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax1.set_title('ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)

# è£œæ­£å¾Œã¨ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ
ax2.plot(x_data, corrected, 'k-', linewidth=1, alpha=0.5, label='è£œæ­£å¾Œã‚¹ãƒšã‚¯ãƒˆãƒ«')

colors = ['#f093fb', '#f5576c', '#4ecdc4']
for i, result in enumerate(results):
    fitted_peak = gaussian(x_data, *result['params'])
    ax2.plot(x_data, fitted_peak, '--', linewidth=2, color=colors[i % len(colors)],
             label=f"ãƒ”ãƒ¼ã‚¯{result['peak_number']} ({result['center']:.1f} nm)")
    ax2.fill_between(x_data, fitted_peak, alpha=0.2, color=colors[i % len(colors)])

ax2.set_xlabel('æ³¢é•· (nm)', fontsize=12)
ax2.set_ylabel('å¼·åº¦ (a.u.)', fontsize=12)
ax2.set_title('ã‚¹ãƒ†ãƒƒãƒ—2-3: ãƒ”ãƒ¼ã‚¯æ¤œå‡ºã¨ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°', fontsize=14, fontweight='bold')
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('full_spectrum_analysis.png', dpi=300, bbox_inches='tight')
plt.show()

# è§£æçµæœã®è¡¨
print("\n" + "=" * 80)
print("ã‚¹ãƒšã‚¯ãƒˆãƒ«è§£æçµæœ")
print("=" * 80)
print(f"{'ãƒ”ãƒ¼ã‚¯':<8} {'ä¸­å¿ƒ (nm)':<12} {'æŒ¯å¹…':<10} {'FWHM (nm)':<12} {'ç©åˆ†å¼·åº¦':<12}")
print("-" * 80)
for result in results:
    print(f"{result['peak_number']:<8} {result['center']:<12.1f} {result['amplitude']:<10.3f} "
          f"{result['fwhm']:<12.1f} {result['area']:<12.2f}")
</code></pre>
            </details>

            <p><strong>å•é¡Œ10</strong>: Voigtç·šå½¢ï¼ˆGaussianã¨Lorentzianã®ç•³ã¿è¾¼ã¿ï¼‰ã‚’å®Ÿè£…ã—ã€ç´”ç²‹ãªGaussianã€ç´”ç²‹ãªLorentzianã€Voigtç·šå½¢ã®3ã¤ã‚’ãƒ—ãƒ­ãƒƒãƒˆã—ã¦æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚Voigtç·šå½¢ã¯ä»¥ä¸‹ã®ç©åˆ†ã§å®šç¾©ã•ã‚Œã¾ã™ï¼š</p>

            <p>$$V(x; \sigma, \gamma) = \int_{-\infty}^{\infty} G(x'; \sigma) L(x - x'; \gamma) \, dx'$$</p>

            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>è§£ç­”</strong>:</p>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.special import wofz

def voigt_profile(x, amplitude, center, sigma, gamma):
    """
    Voigtç·šå½¢ï¼ˆFaddeevaé–¢æ•°ã‚’ä½¿ç”¨ï¼‰

    Parameters:
    -----------
    x : array
        æ¨ªè»¸
    amplitude : float
        ãƒ”ãƒ¼ã‚¯é«˜ã•
    center : float
        ä¸­å¿ƒä½ç½®
    sigma : float
        Gaussianæˆåˆ†ã®å¹…
    gamma : float
        Lorentzianæˆåˆ†ã®å¹…ï¼ˆHWHMï¼‰

    Returns:
    --------
    voigt : array
        Voigtç·šå½¢
    """
    z = ((x - center) + 1j * gamma) / (sigma * np.sqrt(2))
    voigt = amplitude * np.real(wofz(z)) / (sigma * np.sqrt(2 * np.pi))
    return voigt

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¨­å®š
x = np.linspace(-100, 100, 1000)
amplitude = 1.0
center = 0.0
sigma = 15.0  # Gaussianå¹…
gamma = 10.0  # Lorentzian HWHM

# 3ã¤ã®ç·šå½¢ã®è¨ˆç®—
y_gauss = gaussian(x, amplitude, center, sigma)
y_lorentz = lorentzian(x, amplitude, center, gamma)
y_voigt = voigt_profile(x, amplitude, center, sigma, gamma)

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# ç·šå½¢ã‚¹ã‚±ãƒ¼ãƒ«
ax1.plot(x, y_gauss, 'b-', linewidth=2, label=f'Gaussian (Ïƒ={sigma})')
ax1.plot(x, y_lorentz, 'r-', linewidth=2, label=f'Lorentzian (Î³={gamma})')
ax1.plot(x, y_voigt, 'g-', linewidth=2, label='Voigt (ç•³ã¿è¾¼ã¿)')
ax1.set_xlabel('ç›¸å¯¾ä½ç½®', fontsize=12)
ax1.set_ylabel('è¦æ ¼åŒ–å¼·åº¦', fontsize=12)
ax1.set_title('Voigtç·šå½¢ã®æ¯”è¼ƒï¼ˆç·šå½¢ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰', fontsize=14, fontweight='bold')
ax1.legend()
ax1.grid(True, alpha=0.3)

# å¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ï¼ˆè£¾ã®é•ã„ã‚’å¼·èª¿ï¼‰
ax2.semilogy(x, y_gauss, 'b-', linewidth=2, label='Gaussian')
ax2.semilogy(x, y_lorentz, 'r-', linewidth=2, label='Lorentzian')
ax2.semilogy(x, y_voigt, 'g-', linewidth=2, label='Voigt')
ax2.set_xlabel('ç›¸å¯¾ä½ç½®', fontsize=12)
ax2.set_ylabel('è¦æ ¼åŒ–å¼·åº¦ï¼ˆå¯¾æ•°ï¼‰', fontsize=12)
ax2.set_title('Voigtç·šå½¢ã®æ¯”è¼ƒï¼ˆå¯¾æ•°ã‚¹ã‚±ãƒ¼ãƒ«ï¼‰', fontsize=14, fontweight='bold')
ax2.set_ylim(1e-6, 2)
ax2.legend()
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.savefig('voigt_profile.png', dpi=300, bbox_inches='tight')
plt.show()

# è£¾ã®é•ã„ã‚’å®šé‡åŒ–
print("x = 50 ã§ã®å¼·åº¦æ¯”ï¼ˆä¸­å¿ƒã‹ã‚‰ã®è·é›¢ï¼‰:")
idx = np.argmin(np.abs(x - 50))
print(f"  Gaussian: {y_gauss[idx]:.2e}")
print(f"  Lorentzian: {y_lorentz[idx]:.2e}")
print(f"  Voigt: {y_voigt[idx]:.2e}")
print(f"\nLorentzianã¯Gaussianã® {y_lorentz[idx] / y_gauss[idx]:.1f} å€ã®è£¾ã‚’æŒã¤")
</code></pre>
            </details>

        </details>

        <h2>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h2>

        <p>ã“ã®ç« ã§å­¦ã‚“ã å†…å®¹ã‚’æŒ¯ã‚Šè¿”ã‚Šã€ä»¥ä¸‹ã®é …ç›®ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚</p>

        <h3>åŸºæœ¬ç†è§£</h3>
        <ul>
            <li>âœ… å…‰å­ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨æ³¢é•·ã®é–¢ä¿‚ï¼ˆPlancké–¢ä¿‚å¼ï¼‰ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>âœ… å¸åãƒ»ç™ºå…‰ãƒ»æ•£ä¹±ã®é•ã„ã¨ç‰©ç†çš„æ©Ÿæ§‹ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            <li>âœ… Beer-Lambertå‰‡ã®ç‰©ç†çš„æ„å‘³ã¨é©ç”¨æ¡ä»¶ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>âœ… é¸æŠå‰‡ã®æ¦‚å¿µã¨ä¸»è¦ãªé¸æŠå‰‡ï¼ˆ$\Delta l = \pm 1$ã€Laporteå‰‡ãªã©ï¼‰ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
        </ul>

        <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
        <ul>
            <li>âœ… æ³¢é•·ãƒ»æ³¢æ•°ãƒ»ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’ç›¸äº’å¤‰æ›ã§ãã‚‹</li>
            <li>âœ… Beer-Lambertå‰‡ã‚’ç”¨ã„ã¦æ¿ƒåº¦è¨ˆç®—ã‚„æ¤œé‡ç·šä½œæˆãŒã§ãã‚‹</li>
            <li>âœ… ã‚¹ãƒšã‚¯ãƒˆãƒ«ã®ãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼ˆGaussian/Lorentzianï¼‰ãŒã§ãã‚‹</li>
            <li>âœ… ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ã‚’é©åˆ‡ã«å®Ÿæ–½ã§ãã‚‹</li>
        </ul>

        <h3>å¿œç”¨åŠ›</h3>
        <ul>
            <li>âœ… Fermiã®é»„é‡‘å‰‡ã‹ã‚‰é·ç§»ç¢ºç‡ã‚’è¨ˆç®—ã§ãã‚‹</li>
            <li>âœ… Franck-CondonåŸç†ã«åŸºã¥ã„ã¦æŒ¯å‹•æ§‹é€ ã‚’è§£é‡ˆã§ãã‚‹</li>
            <li>âœ… è¤‡æ•°ãƒ”ãƒ¼ã‚¯ã®ã‚¹ãƒšã‚¯ãƒˆãƒ«ã‚’æˆåˆ†åˆ†é›¢ãƒ»å®šé‡ã§ãã‚‹</li>
        </ul>

        <h2>å‚è€ƒæ–‡çŒ®</h2>

        <ol>
            <li>Atkins, P., de Paula, J. (2010). <em>Physical Chemistry</em> (9th ed.). Oxford University Press, pp. 465-468 (Beer-Lambert law), pp. 485-490 (transition dipole moments), pp. 501-506 (selection rules). - åˆ†å…‰å­¦ã®é‡å­åŠ›å­¦çš„åŸºç¤ã¨é·ç§»ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã®è©³ç´°ãªè§£èª¬</li>
            <li>Banwell, C. N., McCash, E. M. (1994). <em>Fundamentals of Molecular Spectroscopy</em> (4th ed.). McGraw-Hill, pp. 8-15 (electromagnetic radiation), pp. 28-35 (Beer-Lambert law applications). - åˆ†å…‰åˆ†æã®åŸºæœ¬åŸç†ã¨Beer-Lambertå‰‡ã®å¿œç”¨</li>
            <li>Hollas, J. M. (2004). <em>Modern Spectroscopy</em> (4th ed.). Wiley, pp. 15-23 (selection rules), pp. 45-52 (Franck-Condon principle), pp. 78-85 (transition probabilities). - é¸æŠå‰‡ã¨Franck-CondonåŸç†ã®åŒ…æ‹¬çš„è§£èª¬</li>
            <li>Beer, A. (1852). Bestimmung der Absorption des rothen Lichts in farbigen FlÃ¼ssigkeiten. <em>Annalen der Physik und Chemie</em>, 86, 78-88. DOI: 10.1002/andp.18521620505 - Beer-Lambertå‰‡ã®ã‚ªãƒªã‚¸ãƒŠãƒ«è«–æ–‡ï¼ˆæ­´å²çš„æ–‡çŒ®ï¼‰</li>
            <li>Shirley, D. A. (1972). High-resolution X-ray photoemission spectrum of the valence bands of gold. <em>Physical Review B</em>, 5(12), 4709-4714. DOI: 10.1103/PhysRevB.5.4709 - Shirleyãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰è£œæ­£ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®åŸè‘—è«–æ–‡</li>
            <li>NumPy 1.24 and SciPy 1.11 Documentation. <em>Signal Processing (scipy.signal) and Optimization (scipy.optimize)</em>. Available at: https://docs.scipy.org/doc/scipy/reference/signal.html - Pythonã«ã‚ˆã‚‹ã‚¹ãƒšã‚¯ãƒˆãƒ«ãƒ‡ãƒ¼ã‚¿è§£æã®å®Ÿè·µçš„æ‰‹æ³•</li>
            <li>Turrell, G., Corset, J. (Eds.). (1996). <em>Raman Microscopy: Developments and Applications</em>. Academic Press, pp. 25-34 (classical scattering theory), pp. 58-67 (selection rules for Raman). - æ•£ä¹±åˆ†å…‰æ³•ã®ç†è«–ã¨é¸æŠå‰‡ã®è©³ç´°</li>
            <li>Levine, I. N. (2013). <em>Quantum Chemistry</em> (7th ed.). Pearson, pp. 580-595 (time-dependent perturbation theory), pp. 620-635 (transition dipole moments). - é·ç§»åŒæ¥µå­ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã¨é‡å­åŠ›å­¦çš„è¨ˆç®—æ‰‹æ³•</li>
        </ol>

        <h2>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h2>

        <p>ç¬¬1ç« ã§ã¯ã€åˆ†å…‰åˆ†æã®åŸºç¤ã¨ãªã‚‹å…‰ã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨ã€Beer-Lambertå‰‡ã€é‡å­åŠ›å­¦çš„åŸç†ã€é¸æŠå‰‡ã‚’å­¦ã³ã¾ã—ãŸã€‚Pythonã«ã‚ˆã‚‹å®Ÿè·µçš„ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼ˆå˜ä½å¤‰æ›ã€ãƒ”ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã€ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³è£œæ­£ï¼‰ã®ã‚¹ã‚­ãƒ«ã‚‚ç¿’å¾—ã—ã¾ã—ãŸã€‚</p>

        <p><strong>ç¬¬2ç« </strong>ã§ã¯ã€ã“ã‚Œã‚‰ã®åŸºç¤çŸ¥è­˜ã‚’å¿œç”¨ã—ã¦ã€èµ¤å¤–ãƒ»ãƒ©ãƒãƒ³åˆ†å…‰æ³•ã®åŸç†ã¨å®Ÿè·µã‚’å­¦ã³ã¾ã™ã€‚æŒ¯å‹•åˆ†å…‰ã«ã‚ˆã‚‹å®˜èƒ½åŸºåŒå®šã€çµæ™¶æ€§è©•ä¾¡ã€IRã¨Ramanã®ç›¸è£œçš„é–¢ä¿‚ã€ç¾¤è«–ã«ã‚ˆã‚‹é¸æŠå‰‡ã®è©³ç´°ãªã©ã€ææ–™ç§‘å­¦ã§é »ç¹ã«ä½¿ç”¨ã•ã‚Œã‚‹æŒ¯å‹•åˆ†å…‰ã®å…¨ã¦ã‚’ã‚«ãƒãƒ¼ã—ã¾ã™ã€‚</p>

        <div class="navigation">
            <a href="./index.html" class="nav-button">â† ã‚·ãƒªãƒ¼ã‚ºæ¦‚è¦ã«æˆ»ã‚‹</a>
            <a href="./chapter-2.html" class="nav-button">ç¬¬2ç« : èµ¤å¤–ãƒ»ãƒ©ãƒãƒ³åˆ†å…‰æ³• â†’</a>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 MS Terakoya - Materials Science Learning Platform</p>
        <p><a href="../../index.html">ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹</a></p>
    </footer>
</body>
</html>