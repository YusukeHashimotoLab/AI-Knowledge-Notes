<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« ï¼šç£æ°—æ¸¬å®š - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .breadcrumb {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .breadcrumb a {
            color: var(--color-link);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        details {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        summary {
            font-weight: 600;
            cursor: pointer;
            color: var(--color-primary);
        }

        summary:hover {
            color: var(--color-accent);
        }

        .exercise-label {
            display: inline-block;
            padding: 0.2rem 0.6rem;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .easy {
            background-color: #d4edda;
            color: #155724;
        }

        .medium {
            background-color: #fff3cd;
            color: #856404;
        }

        .hard {
            background-color: #f8d7da;
            color: #721c24;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MS/electrical-magnetic-testing-introduction/chapter-3.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
        <div class="header-content">
            <h1>ç¬¬3ç« : ç£æ°—æ¸¬å®š</h1>
            <p class="subtitle">VSMãƒ»SQUIDã«ã‚ˆã‚‹ç£åŒ–æ¸¬å®šã€M-Hæ›²ç·šè§£æã€ç£æ°—ç•°æ–¹æ€§è©•ä¾¡ã€PPMSçµ±åˆæ¸¬å®š</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 50-60åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: ä¸­ç´šã€œä¸Šç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 7å€‹</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">é›»æ°—ãƒ»ç£æ°—æ¸¬å®šå…¥é–€</a> &gt;
        ç¬¬3ç« 
    </div>

    <main class="container">
        <p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); border-left: 4px solid #f093fb; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">
            ç£æ°—æ¸¬å®šã¯ã€ææ–™ã®ç£æ°—çš„æ€§è³ªï¼ˆç£åŒ–ã€ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã€ç£æ°—ç•°æ–¹æ€§ï¼‰ã‚’å®šé‡çš„ã«è©•ä¾¡ã™ã‚‹æŠ€è¡“ã§ã™ã€‚ã“ã®ç« ã§ã¯ã€VSMï¼ˆVibrating Sample Magnetometerï¼‰ã¨SQUIDï¼ˆè¶…ä¼å°é‡å­å¹²æ¸‰è¨ˆï¼‰ã®åŸç†ã€M-Hæ›²ç·šã®è§£æï¼ˆé£½å’Œç£åŒ–ã€ä¿ç£åŠ›ã€æ®‹ç•™ç£åŒ–ï¼‰ã€Curie-Weisså‰‡ã‚„Langeviné–¢æ•°ã«ã‚ˆã‚‹ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã€æ¸©åº¦ä¾å­˜æ€§æ¸¬å®šï¼ˆFC/ZFCï¼‰ã€PPMSï¼ˆPhysical Property Measurement Systemï¼‰ã«ã‚ˆã‚‹çµ±åˆæ¸¬å®šæŠ€è¡“ã‚’å­¦ã³ã€Pythonã§å®Ÿè·µçš„ãªç£æ°—ãƒ‡ãƒ¼ã‚¿è§£æã‚’è¡Œã„ã¾ã™ã€‚
        </p>

        <div class="learning-objectives">
            <h2>å­¦ç¿’ç›®æ¨™</h2>
            <p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
            <ul>
                <li>âœ… åç£æ€§ãƒ»å¸¸ç£æ€§ãƒ»å¼·ç£æ€§ã®åŸºæœ¬åŸç†ã‚’ç†è§£ã§ãã‚‹</li>
                <li>âœ… VSMã¨SQUIDã®æ¸¬å®šåŸç†ã¨ç‰¹å¾´ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… M-Hæ›²ç·šã‹ã‚‰é£½å’Œç£åŒ–ã€ä¿ç£åŠ›ã€æ®‹ç•™ç£åŒ–ã‚’æŠ½å‡ºã§ãã‚‹</li>
                <li>âœ… Curie-Weisså‰‡ï¼ˆÏ‡ = C/(T - Î¸)ï¼‰ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã§ãã‚‹</li>
                <li>âœ… Langeviné–¢æ•°ã§å¸¸ç£æ€§ã‚’è§£æã§ãã‚‹</li>
                <li>âœ… ç£æ°—ç•°æ–¹æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>âœ… Pythonã§å®Œå…¨ãªVSM/SQUIDãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹ç¯‰ã§ãã‚‹</li>
            </ul>
        </div>

        <h2>3.1 ç£æ€§ã®åŸºç¤</h2>

        <h3>3.1.1 ç£åŒ–ã¨ç£å ´ã®é–¢ä¿‚</h3>
        <p><strong>ç£åŒ–</strong> $M$ ã¯ã€å˜ä½ä½“ç©ã‚ãŸã‚Šã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã§ã™ï¼š</p>

        $$
        M = \frac{\sum \mu_i}{V}
        $$

        <p>ã“ã“ã§ã€$\mu_i$ ã¯å€‹ã€…ã®åŸå­ãƒ»åˆ†å­ã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã€$V$ ã¯ä½“ç©ã§ã™ã€‚</p>

        <p><strong>ç£åŒ–ç‡</strong> $\chi$ ã¯ã€ç£å ´ $H$ ã«å¯¾ã™ã‚‹ç£åŒ–ã®å¿œç­”ï¼š</p>

        $$
        M = \chi H
        $$

        <p><strong>ç£å ´ã®ç¨®é¡</strong>ï¼š</p>
        <ul>
            <li><strong>ç£å ´ $H$</strong>ï¼ˆmagnetic field strengthï¼‰ï¼šå˜ä½ A/m ã¾ãŸã¯ Oeï¼ˆã‚¨ãƒ«ã‚¹ãƒ†ãƒƒãƒ‰ï¼‰</li>
            <li><strong>ç£æŸå¯†åº¦ $B$</strong>ï¼ˆmagnetic flux densityï¼‰ï¼šå˜ä½ Tï¼ˆãƒ†ã‚¹ãƒ©ï¼‰</li>
            <li>é–¢ä¿‚å¼ï¼š$B = \mu_0(H + M)$ï¼ˆSIå˜ä½ç³»ï¼‰ã€$\mu_0 = 4\pi \times 10^{-7}$ H/m</li>
        </ul>

        <h3>3.1.2 ç£æ€§ã®åˆ†é¡</h3>
        <table>
            <thead>
                <tr>
                    <th>ç£æ€§</th>
                    <th>ç£åŒ–ç‡ $\chi$</th>
                    <th>æ¸©åº¦ä¾å­˜æ€§</th>
                    <th>ç‰¹å¾´</th>
                    <th>ææ–™ä¾‹</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>åç£æ€§</strong><br/>ï¼ˆDiamagnetismï¼‰</td>
                    <td>$\chi < 0$<br/>ï¼ˆã€œ$-10^{-5}$ï¼‰</td>
                    <td>ã»ã¼ç„¡ã—</td>
                    <td>å¤–éƒ¨ç£å ´ã«é€†ã‚‰ã†<br/>å¾®å¼±ãªç£åŒ–</td>
                    <td>Cu, Au, Hâ‚‚O<br/>è¶…ä¼å°ä½“</td>
                </tr>
                <tr>
                    <td><strong>å¸¸ç£æ€§</strong><br/>ï¼ˆParamagnetismï¼‰</td>
                    <td>$\chi > 0$<br/>ï¼ˆã€œ$10^{-5}$-$10^{-3}$ï¼‰</td>
                    <td>$\chi \propto 1/T$<br/>ï¼ˆCurieå‰‡ï¼‰</td>
                    <td>ç£å ´æ–¹å‘ã«<br/>å¾®å¼±ã«ç£åŒ–</td>
                    <td>Al, Pt, Oâ‚‚<br/>å¸ŒåœŸé¡ã‚¤ã‚ªãƒ³</td>
                </tr>
                <tr>
                    <td><strong>å¼·ç£æ€§</strong><br/>ï¼ˆFerromagnetismï¼‰</td>
                    <td>$\chi \gg 1$<br/>ï¼ˆã€œ$10^2$-$10^5$ï¼‰</td>
                    <td>T < T$_C$ ã§å¤§<br/>T > T$_C$ ã§å¸¸ç£æ€§</td>
                    <td>è‡ªç™ºç£åŒ–<br/>ãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹</td>
                    <td>Fe, Co, Ni<br/>NdFeB, SmCo</td>
                </tr>
                <tr>
                    <td><strong>åå¼·ç£æ€§</strong><br/>ï¼ˆAntiferromagnetismï¼‰</td>
                    <td>$\chi > 0$<br/>ï¼ˆå°ï¼‰</td>
                    <td>T = T$_N$ ã§ãƒ”ãƒ¼ã‚¯</td>
                    <td>éš£æ¥ã‚¹ãƒ”ãƒ³ãŒ<br/>åå¹³è¡Œ</td>
                    <td>MnO, Cr, FeO</td>
                </tr>
                <tr>
                    <td><strong>ãƒ•ã‚§ãƒªç£æ€§</strong><br/>ï¼ˆFerrimagnetismï¼‰</td>
                    <td>$\chi \gg 1$</td>
                    <td>å¼·ç£æ€§ã¨é¡ä¼¼</td>
                    <td>ä¸ç­‰ãªåå¹³è¡Œ<br/>ã‚¹ãƒ”ãƒ³é…åˆ—</td>
                    <td>Feâ‚ƒOâ‚„ï¼ˆãƒã‚°ãƒã‚¿ã‚¤ãƒˆï¼‰<br/>ãƒ•ã‚§ãƒ©ã‚¤ãƒˆ</td>
                </tr>
            </tbody>
        </table>

        <div class="mermaid">
flowchart TD
    A[å¤–éƒ¨ç£å ´ H] --> B{ææ–™ã®ç£æ°—å¿œç­”}
    B --> C[åç£æ€§<br/>M â†“ H]
    B --> D[å¸¸ç£æ€§<br/>M â†‘ H<br/>M âˆ H/T]
    B --> E[å¼·ç£æ€§<br/>è‡ªç™ºç£åŒ–<br/>M >> H]
    
    E --> F[é£½å’Œç£åŒ– M_s]
    E --> G[ä¿ç£åŠ› H_c]
    E --> H[æ®‹ç•™ç£åŒ– M_r]

    style A fill:#99ccff,stroke:#0066cc,stroke-width:2px
    style C fill:#ffeb99,stroke:#ffa500,stroke-width:2px
    style D fill:#99ff99,stroke:#00cc00,stroke-width:2px
    style E fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
        </div>

        <h2>3.2 VSMï¼ˆVibrating Sample Magnetometerï¼‰</h2>

        <h3>3.2.1 VSMæ¸¬å®šåŸç†</h3>
        <p><strong>VSM</strong>ï¼ˆ1956å¹´ã€Simon Foneré–‹ç™ºï¼‰ã¯ã€è©¦æ–™ã‚’æŒ¯å‹•ã•ã›ã€ãã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã«ã‚ˆã£ã¦æ¤œå‡ºã‚³ã‚¤ãƒ«ã«èª˜èµ·ã•ã‚Œã‚‹é›»åœ§ã‚’æ¸¬å®šã™ã‚‹æ‰‹æ³•ã§ã™ã€‚</p>

        <p><strong>æ¸¬å®šåŸç†</strong>ï¼š</p>
        <ol>
            <li>è©¦æ–™ã‚’å‡ä¸€ç£å ´ä¸­ã«è¨­ç½®ã—ã€å‘¨æ³¢æ•° $f$ï¼ˆå…¸å‹çš„ã«ã¯ 10-100 Hzï¼‰ã§ä¸Šä¸‹ã«æŒ¯å‹•ã•ã›ã‚‹</li>
            <li>è©¦æ–™ã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ $\mu$ ãŒæŒ¯å‹•ã™ã‚‹ã¨ã€å‘¨å›²ã®æ¤œå‡ºã‚³ã‚¤ãƒ«ã«æ™‚é–“å¤‰åŒ–ã™ã‚‹ç£æŸ $\Phi(t)$ ãŒç”Ÿã˜ã‚‹</li>
            <li>Faradayã®é›»ç£èª˜å°å‰‡ã«ã‚ˆã‚Šã€ã‚³ã‚¤ãƒ«ã«èª˜èµ·é›»åœ§ $V(t)$ ãŒç™ºç”Ÿï¼š
                $$
                V(t) = -\frac{d\Phi}{dt} \propto \mu \cdot f
                $$
            </li>
            <li>ãƒ­ãƒƒã‚¯ã‚¤ãƒ³æ¤œå‡ºã«ã‚ˆã‚Šã€æŒ¯å‹•å‘¨æ³¢æ•° $f$ ã®æˆåˆ†ã‚’æŠ½å‡ºã—ã€ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã‚’å®šé‡</li>
        </ol>

        <p><strong>VSMã®ç‰¹å¾´</strong>ï¼š</p>
        <ul>
            <li><strong>æ„Ÿåº¦</strong>ï¼š$10^{-6}$ - $10^{-8}$ emuï¼ˆelectromagnetic unitï¼‰</li>
            <li><strong>ç£å ´ç¯„å›²</strong>ï¼š0 - 3 Tï¼ˆå…¸å‹çš„ãªé›»ç£çŸ³ï¼‰</li>
            <li><strong>æ¸©åº¦ç¯„å›²</strong>ï¼š4 K - 1000 Kï¼ˆæ¶²ä½“Heã‚¯ãƒ©ã‚¤ã‚ªã‚¹ã‚¿ãƒƒãƒˆä½¿ç”¨æ™‚ï¼‰</li>
            <li><strong>æ¸¬å®šæ™‚é–“</strong>ï¼š1ç‚¹ã‚ãŸã‚Š 0.1 - 1ç§’ï¼ˆæ¯”è¼ƒçš„é«˜é€Ÿï¼‰</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3-1: Curie-Weisså‰‡ã®ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from lmfit import Model

def curie_weiss(T, C, theta):
    """
    Curie-Weisså‰‡: Ï‡ = C / (T - Î¸)
    
    Parameters
    ----------
    T : array-like
        æ¸©åº¦ [K]
    C : float
        Curieå®šæ•°
    theta : float
        Curie-Weissæ¸©åº¦ï¼ˆWeisså®šæ•°ï¼‰[K]
    
    Returns
    -------
    chi : array-like
        ç£åŒ–ç‡
    """
    return C / (T - theta)

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆå¸¸ç£æ€§ææ–™ï¼‰
T_range = np.linspace(100, 400, 30)  # [K]
C_true = 1.5  # Curieå®šæ•°
theta_true = -10  # Curie-Weissæ¸©åº¦ [K]ï¼ˆè²  â†’ åå¼·ç£æ€§çš„ç›¸äº’ä½œç”¨ï¼‰

chi_data = curie_weiss(T_range, C_true, theta_true)
chi_data_noise = chi_data * (1 + 0.05 * np.random.randn(len(T_range)))  # 5%ãƒã‚¤ã‚º

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
model = Model(curie_weiss)
params = model.make_params(C=1.0, theta=0)
result = model.fit(chi_data_noise, params, T=T_range)

print("Curie-Weisså‰‡ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ:")
print(result.fit_report())

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å›³ï¼šÏ‡ vs T
ax1.scatter(T_range, chi_data_noise, s=80, alpha=0.7, edgecolors='black', linewidths=1.5, label='Measured data', color='#f093fb')
ax1.plot(T_range, result.best_fit, linewidth=2.5, label=f'Fit: C={result.params["C"].value:.2f}, Î¸={result.params["theta"].value:.1f} K', color='#f5576c')
ax1.set_xlabel('Temperature T [K]', fontsize=12)
ax1.set_ylabel('Magnetic Susceptibility Ï‡', fontsize=12)
ax1.set_title('Curie-Weiss Law: Ï‡ vs T', fontsize=14, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(alpha=0.3)

# å³å›³ï¼š1/Ï‡ vs Tï¼ˆCurie-Weissãƒ—ãƒ­ãƒƒãƒˆï¼‰
ax2.scatter(T_range, 1/chi_data_noise, s=80, alpha=0.7, edgecolors='black', linewidths=1.5, label='Data (1/Ï‡)', color='#ffa500')
T_fit_extended = np.linspace(0, 450, 100)
chi_fit_extended = curie_weiss(T_fit_extended, result.params['C'].value, result.params['theta'].value)
ax2.plot(T_fit_extended, 1/chi_fit_extended, linewidth=2.5, label='Linear fit (extended)', color='#f5576c')

# Î¸ ã‚’å¼·èª¿è¡¨ç¤º
theta_fit = result.params['theta'].value
ax2.axvline(theta_fit, color='red', linestyle='--', linewidth=2, label=f'Î¸ = {theta_fit:.1f} K')
ax2.scatter([theta_fit], [0], s=200, c='red', edgecolors='black', linewidth=2, marker='X', zorder=5)

ax2.set_xlabel('Temperature T [K]', fontsize=12)
ax2.set_ylabel('1/Ï‡', fontsize=12)
ax2.set_title('Curie-Weiss Plot: 1/Ï‡ vs T', fontsize=14, fontweight='bold')
ax2.legend(fontsize=11)
ax2.grid(alpha=0.3)
ax2.set_xlim(0, 450)
ax2.set_ylim(bottom=0)

plt.tight_layout()
plt.show()

print(f"\nç‰©ç†çš„è§£é‡ˆ:")
print(f"  Curieå®šæ•° C = {result.params['C'].value:.2f}")
print(f"  Curie-Weissæ¸©åº¦ Î¸ = {result.params['theta'].value:.1f} K")
if result.params['theta'].value < 0:
    print(f"  Î¸ < 0 â†’ åå¼·ç£æ€§çš„ç›¸äº’ä½œç”¨ãŒæ”¯é…çš„")
elif result.params['theta'].value > 0:
    print(f"  Î¸ > 0 â†’ å¼·ç£æ€§çš„ç›¸äº’ä½œç”¨ãŒæ”¯é…çš„")
else:
    print(f"  Î¸ â‰ˆ 0 â†’ ç†æƒ³çš„ãªå¸¸ç£æ€§ï¼ˆç›¸äº’ä½œç”¨ãªã—ï¼‰")
</code></pre>

        <h2>3.3 SQUIDï¼ˆè¶…ä¼å°é‡å­å¹²æ¸‰è¨ˆï¼‰</h2>

        <h3>3.3.1 SQUIDæ¸¬å®šåŸç†</h3>
        <p><strong>SQUID</strong>ï¼ˆSuperconducting Quantum Interference Deviceï¼‰ã¯ã€è¶…ä¼å°ãƒªãƒ³ã‚°ã¨Josephsonæ¥åˆã‚’åˆ©ç”¨ã—ãŸè¶…é«˜æ„Ÿåº¦ç£æ°—ã‚»ãƒ³ã‚µãƒ¼ã§ã™ã€‚</p>

        <p><strong>æ¸¬å®šåŸç†</strong>ï¼š</p>
        <ol>
            <li>è¶…ä¼å°ãƒªãƒ³ã‚°ã«ç£æŸ $\Phi$ ãŒè²«é€šã™ã‚‹ã¨ã€é‡å­åŒ–ã•ã‚ŒãŸè¶…ä¼å°é›»æµãŒæµã‚Œã‚‹</li>
            <li>Josephsonæ¥åˆã‚’é€šã‚‹è‡¨ç•Œé›»æµãŒã€ç£æŸã«å¯¾ã—ã¦å‘¨æœŸçš„ã«å¤‰åŒ–ï¼š
                $$
                I_c(\Phi) = I_0 \left|\cos\left(\frac{\pi\Phi}{\Phi_0}\right)\right|
                $$
                ã“ã“ã§ã€$\Phi_0 = h/(2e) \approx 2.07 \times 10^{-15}$ Wb ã¯ç£æŸé‡å­
            </li>
            <li>ç£æŸã®å¾®å°å¤‰åŒ–ã‚’ã€è‡¨ç•Œé›»æµã®å¤‰åŒ–ã¨ã—ã¦æ¥µã‚ã¦é«˜æ„Ÿåº¦ã«æ¤œå‡º</li>
        </ol>

        <p><strong>SQUIDã®ç‰¹å¾´</strong>ï¼š</p>
        <ul>
            <li><strong>æ„Ÿåº¦</strong>ï¼š$10^{-10}$ - $10^{-12}$ emuï¼ˆVSMã®1000å€ä»¥ä¸Šï¼‰</li>
            <li><strong>ç£å ´ç¯„å›²</strong>ï¼š0 - 7 Tï¼ˆè¶…ä¼å°ãƒã‚°ãƒãƒƒãƒˆï¼‰</li>
            <li><strong>æ¸©åº¦ç¯„å›²</strong>ï¼š1.8 K - 400 Kï¼ˆHeã‚¬ã‚¹ä½¿ç”¨æ™‚ï¼‰</li>
            <li><strong>æ¸¬å®šæ™‚é–“</strong>ï¼š1ç‚¹ã‚ãŸã‚Š 1 - 10ç§’ï¼ˆVSMã‚ˆã‚Šé…ã„ãŒã€é«˜ç²¾åº¦ï¼‰</li>
            <li><strong>ãƒã‚¤ã‚ºãƒ¬ãƒ™ãƒ«</strong>ï¼š$10^{-14}$ T/âˆšHzï¼ˆä¸–ç•Œæœ€é«˜æ„Ÿåº¦ã®ç£æ°—ã‚»ãƒ³ã‚µãƒ¼ï¼‰</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3-2: Langeviné–¢æ•°ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ï¼ˆå¸¸ç£æ€§ï¼‰</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from lmfit import Model

def langevin(H, M_s, T, mu):
    """
    Langeviné–¢æ•°ï¼ˆå¤å…¸å¸¸ç£æ€§ï¼‰
    
    Parameters
    ----------
    H : array-like
        ç£å ´ [A/m ã¾ãŸã¯ Oe]
    M_s : float
        é£½å’Œç£åŒ– [emu/g ã¾ãŸã¯ Am^2/kg]
    T : float
        æ¸©åº¦ [K]
    mu : float
        ç²’å­ã‚ãŸã‚Šã®ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ [Bohr magnetonå˜ä½]
    
    Returns
    -------
    M : array-like
        ç£åŒ– [emu/g]
    """
    mu_B = 9.274e-24  # Bohr magneton [J/T]
    mu_0 = 4 * np.pi * 1e-7  # çœŸç©ºã®é€ç£ç‡ [H/m]
    k_B = 1.38065e-23  # Boltzmannå®šæ•° [J/K]
    
    # ç£å ´ã‚’ SIå˜ä½ã«å¤‰æ›ï¼ˆOe â†’ Tï¼‰
    H_T = H * 1e-4  # 1 Oe = 10^-4 T
    
    # Langevinãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
    xi = mu * mu_B * H_T / (k_B * T)
    
    # Langeviné–¢æ•°: L(Î¾) = coth(Î¾) - 1/Î¾
    L = np.where(np.abs(xi) < 1e-3, xi/3, 1/np.tanh(xi) - 1/xi)  # å°ã•ã„Î¾ã§ã®ç™ºæ•£ã‚’å›é¿
    
    M = M_s * L
    return M

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆè¶…å¸¸ç£æ€§ãƒŠãƒç²’å­ï¼‰
H_range = np.linspace(-10000, 10000, 100)  # [Oe]
M_s_true = 50  # é£½å’Œç£åŒ– [emu/g]
T_true = 300  # æ¸©åº¦ [K]
mu_true = 5000  # ç²’å­ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ [Î¼_B]

M_data = langevin(H_range, M_s_true, T_true, mu_true)
M_data_noise = M_data + 0.5 * np.random.randn(len(H_range))  # ãƒã‚¤ã‚ºè¿½åŠ 

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
model = Model(langevin)
params = model.make_params(M_s=40, T=300, mu=3000)
params['T'].vary = False  # æ¸©åº¦ã¯å›ºå®š

result = model.fit(M_data_noise, params, H=H_range)

print("Langeviné–¢æ•°ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ:")
print(result.fit_report())

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å›³ï¼šM vs H
ax1.scatter(H_range, M_data_noise, s=50, alpha=0.6, edgecolors='black', linewidths=1, label='Data (with noise)', color='#f093fb')
ax1.plot(H_range, result.best_fit, linewidth=2.5, label=f'Fit: M_s={result.params["M_s"].value:.1f} emu/g, Î¼={result.params["mu"].value:.0f} Î¼_B', color='#f5576c')
ax1.axhline(M_s_true, color='green', linestyle='--', linewidth=1.5, label=f'True M_s = {M_s_true} emu/g')
ax1.axhline(-M_s_true, color='green', linestyle='--', linewidth=1.5)
ax1.set_xlabel('Magnetic Field H [Oe]', fontsize=12)
ax1.set_ylabel('Magnetization M [emu/g]', fontsize=12)
ax1.set_title('Langevin Function Fit (Paramagnetism)', fontsize=14, fontweight='bold')
ax1.legend(fontsize=10)
ax1.grid(alpha=0.3)

# å³å›³ï¼šæ¸©åº¦ä¾å­˜æ€§ï¼ˆç•°ãªã‚‹æ¸©åº¦ã§ã®Langevinæ›²ç·šï¼‰
T_list = [50, 100, 200, 300, 400]
colors = plt.cm.plasma(np.linspace(0, 0.9, len(T_list)))

for T, color in zip(T_list, colors):
    M_T = langevin(H_range, result.params['M_s'].value, T, result.params['mu'].value)
    ax2.plot(H_range, M_T, linewidth=2.5, label=f'T = {T} K', color=color)

ax2.set_xlabel('Magnetic Field H [Oe]', fontsize=12)
ax2.set_ylabel('Magnetization M [emu/g]', fontsize=12)
ax2.set_title('Temperature Dependence of Langevin Curve', fontsize=14, fontweight='bold')
ax2.legend(fontsize=10, loc='lower right')
ax2.grid(alpha=0.3)

plt.tight_layout()
plt.show()

print(f"\nç‰©ç†çš„è§£é‡ˆ:")
print(f"  é£½å’Œç£åŒ– M_s = {result.params['M_s'].value:.1f} emu/g")
print(f"  ç²’å­ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ Î¼ = {result.params['mu'].value:.0f} Î¼_B")
print(f"  æ¸©åº¦ãŒä½ã„ã»ã©ã€ä½ç£å ´ã§é£½å’Œã«è¿‘ã¥ãï¼ˆç†±æºã‚‰ãæ¸›å°‘ï¼‰")
</code></pre>

        <h2>3.4 M-Hæ›²ç·šè§£æ</h2>

        <h3>3.4.1 M-Hæ›²ç·šã®ç‰¹å¾´é‡</h3>
        <p><strong>å¼·ç£æ€§ææ–™ã®M-Hæ›²ç·š</strong>ï¼ˆç£åŒ–æ›²ç·šã€ãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹ãƒ«ãƒ¼ãƒ—ï¼‰ã‹ã‚‰ã€ä»¥ä¸‹ã®ç‰¹æ€§å€¤ã‚’æŠ½å‡ºã—ã¾ã™ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>ç‰¹æ€§å€¤</th>
                    <th>è¨˜å·</th>
                    <th>å®šç¾©</th>
                    <th>ç‰©ç†çš„æ„å‘³</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>é£½å’Œç£åŒ–</strong></td>
                    <td>$M_s$</td>
                    <td>é«˜ç£å ´ã§ã®ç£åŒ–</td>
                    <td>å…¨ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãŒ<br/>ç£å ´æ–¹å‘ã«æ•´åˆ—</td>
                </tr>
                <tr>
                    <td><strong>æ®‹ç•™ç£åŒ–</strong></td>
                    <td>$M_r$</td>
                    <td>H = 0 ã§ã®ç£åŒ–</td>
                    <td>ç£å ´é™¤å»å¾Œã«<br/>æ®‹ã‚‹ç£åŒ–</td>
                </tr>
                <tr>
                    <td><strong>ä¿ç£åŠ›</strong></td>
                    <td>$H_c$</td>
                    <td>M = 0 ã¨ãªã‚‹ç£å ´</td>
                    <td>ç£åŒ–ã‚’åè»¢ã•ã›ã‚‹<br/>å¿…è¦ãªç£å ´</td>
                </tr>
                <tr>
                    <td><strong>è§’å½¢æ¯”</strong></td>
                    <td>$S = M_r/M_s$</td>
                    <td>æ®‹ç•™ç£åŒ–ã¨<br/>é£½å’Œç£åŒ–ã®æ¯”</td>
                    <td>S â‰ˆ 1ï¼šè§’å½¢æ€§è‰¯å¥½<br/>ï¼ˆæ°¸ä¹…ç£çŸ³å‘ãï¼‰</td>
                </tr>
            </tbody>
        </table>

        <div class="mermaid">
flowchart LR
    A[M-Hæ›²ç·šæ¸¬å®š] --> B[ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰<br/>æ¸›ç®—]
    B --> C[é£½å’Œç£åŒ– M_s<br/>é«˜ç£å ´å¤–æŒ¿]
    B --> D[ä¿ç£åŠ› H_c<br/>M=0 äº¤ç‚¹]
    B --> E[æ®‹ç•™ç£åŒ– M_r<br/>H=0 ã§ã® M]
    
    C --> F[ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ<br/>Î¼ = M_s Ã— è³ªé‡]
    D --> G[ç£æ°—ç•°æ–¹æ€§<br/>K âˆ H_c Ã— M_s]
    E --> H[è§’å½¢æ¯”<br/>S = M_r / M_s]

    style A fill:#99ccff,stroke:#0066cc,stroke-width:2px
    style C fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style D fill:#ffa500,stroke:#ff8c00,stroke-width:2px
    style E fill:#99ff99,stroke:#00cc00,stroke-width:2px
        </div>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3-3: M-Hæ›²ç·šã®å‡¦ç†ã¨ç‰¹æ€§å€¤æŠ½å‡º</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy.interpolate import interp1d
from scipy.optimize import brentq

def generate_mh_curve(H, M_s, H_c, M_r, slope_high_field=0):
    """
    ç†æƒ³çš„ãªå¼·ç£æ€§M-Hæ›²ç·šã‚’ç”Ÿæˆï¼ˆç°¡ç•¥åŒ–ãƒ¢ãƒ‡ãƒ«ï¼‰
    """
    # åˆç£åŒ–æ›²ç·šï¼ˆç°¡ç•¥åŒ–tanhé–¢æ•°ï¼‰
    M_init = M_s * np.tanh(H / (0.3 * H_c))
    
    # ãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹ï¼ˆå®Ÿéš›ã¯è¤‡é›‘ã ãŒã€ç°¡æ˜“çš„ã«ã‚·ãƒ•ãƒˆï¼‰
    M_up = M_s * np.tanh((H - H_c) / (0.3 * H_c)) + M_r
    M_down = -M_s * np.tanh((-H - H_c) / (0.3 * H_c)) - M_r
    
    # é«˜ç£å ´ã§ã®ç·šå½¢ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ï¼ˆå¸¸ç£æ€§æˆåˆ†ï¼‰
    M_total = np.where(H > 0, M_up, M_down) + slope_high_field * H
    
    return M_total

def extract_mh_parameters(H, M):
    """
    M-Hæ›²ç·šã‹ã‚‰ç‰¹æ€§å€¤ã‚’æŠ½å‡º
    
    Parameters
    ----------
    H : array-like
        ç£å ´ [Oe]
    M : array-like
        ç£åŒ– [emu/g]
    
    Returns
    -------
    params : dict
        M_s, H_c, M_r, Sï¼ˆè§’å½¢æ¯”ï¼‰
    """
    # é£½å’Œç£åŒ–ï¼šé«˜ç£å ´ã§ã®å¹³å‡å€¤
    M_s = np.mean(M[H > 0.8 * np.max(H)])
    
    # ä¿ç£åŠ›ï¼šM = 0 ã®äº¤ç‚¹
    interp_func = interp1d(H, M, kind='linear')
    H_c = brentq(interp_func, np.min(H[H < 0]), np.max(H[H > 0]))
    
    # æ®‹ç•™ç£åŒ–ï¼šH = 0 ã§ã®å€¤
    M_r = interp_func(0)
    
    # è§’å½¢æ¯”
    S = M_r / M_s if M_s != 0 else 0
    
    params = {
        'M_s': M_s,
        'H_c': H_c,
        'M_r': M_r,
        'S': S
    }
    
    return params

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
H_range = np.linspace(-5000, 5000, 200)  # [Oe]
M_s_true = 100  # [emu/g]
H_c_true = 500  # [Oe]
M_r_true = 80  # [emu/g]
slope_bg = 1e-3  # é«˜ç£å ´ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰

M_data = generate_mh_curve(H_range, M_s_true, H_c_true, M_r_true, slope_bg)
M_data_noise = M_data + 1.0 * np.random.randn(len(H_range))

# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ¸›ç®—ï¼ˆé«˜ç£å ´ã®ç·šå½¢æˆåˆ†ï¼‰
H_high = H_range[H_range > 3000]
M_high = M_data_noise[H_range > 3000]
slope_fit = np.polyfit(H_high, M_high, 1)[0]
M_corrected = M_data_noise - slope_fit * H_range

# ç‰¹æ€§å€¤æŠ½å‡º
params = extract_mh_parameters(H_range, M_corrected)

print("M-Hæ›²ç·šè§£æçµæœ:")
print("=" * 60)
print(f"é£½å’Œç£åŒ– M_s = {params['M_s']:.2f} emu/g")
print(f"ä¿ç£åŠ› H_c = {params['H_c']:.2f} Oe = {params['H_c'] / 79.5775:.2f} kA/m")
print(f"æ®‹ç•™ç£åŒ– M_r = {params['M_r']:.2f} emu/g")
print(f"è§’å½¢æ¯” S = M_r/M_s = {params['S']:.3f}")
print(f"\nææ–™è©•ä¾¡:")
if params['H_c'] < 100:
    print("  è»Ÿç£æ€§ææ–™ï¼ˆãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒãƒ¼ã€ã‚¤ãƒ³ãƒ€ã‚¯ã‚¿å‘ãï¼‰")
elif params['H_c'] > 1000:
    print("  ç¡¬ç£æ€§ææ–™ï¼ˆæ°¸ä¹…ç£çŸ³å‘ãï¼‰")
else:
    print("  ä¸­ç¨‹åº¦ã®ä¿ç£åŠ›ï¼ˆè¨˜éŒ²åª’ä½“å‘ãï¼‰")

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å›³ï¼šå®Œå…¨ãªM-Hæ›²ç·š
ax1.plot(H_range, M_corrected, linewidth=2.5, color='#f093fb', label='M-H curve (background subtracted)')
ax1.axhline(params['M_s'], color='green', linestyle='--', linewidth=1.5, label=f'M_s = {params["M_s"]:.1f} emu/g')
ax1.axhline(params['M_r'], color='orange', linestyle='--', linewidth=1.5, label=f'M_r = {params["M_r"]:.1f} emu/g')
ax1.axvline(params['H_c'], color='red', linestyle='--', linewidth=1.5, label=f'H_c = {params["H_c"]:.0f} Oe')
ax1.axhline(0, color='black', linestyle='-', linewidth=1)
ax1.axvline(0, color='black', linestyle='-', linewidth=1)
ax1.scatter([params['H_c']], [0], s=150, c='red', edgecolors='black', linewidth=2, marker='o', zorder=5)
ax1.scatter([0], [params['M_r']], s=150, c='orange', edgecolors='black', linewidth=2, marker='s', zorder=5)
ax1.set_xlabel('Magnetic Field H [Oe]', fontsize=12)
ax1.set_ylabel('Magnetization M [emu/g]', fontsize=12)
ax1.set_title('M-H Hysteresis Loop', fontsize=14, fontweight='bold')
ax1.legend(fontsize=10, loc='lower right')
ax1.grid(alpha=0.3)

# å³å›³ï¼šãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹ãƒ«ãƒ¼ãƒ—ã®ã‚ºãƒ¼ãƒ ï¼ˆä½ç£å ´é ˜åŸŸï¼‰
H_zoom = H_range[np.abs(H_range) < 1500]
M_zoom = M_corrected[np.abs(H_range) < 1500]

ax2.plot(H_zoom, M_zoom, linewidth=2.5, color='#f5576c')
ax2.axhline(0, color='black', linestyle='-', linewidth=1)
ax2.axvline(0, color='black', linestyle='-', linewidth=1)
ax2.axvline(params['H_c'], color='red', linestyle='--', linewidth=2, label=f'H_c = {params["H_c"]:.0f} Oe')
ax2.axvline(-params['H_c'], color='red', linestyle='--', linewidth=2)
ax2.scatter([params['H_c']], [0], s=150, c='red', edgecolors='black', linewidth=2, marker='o', zorder=5)
ax2.scatter([0], [params['M_r']], s=150, c='orange', edgecolors='black', linewidth=2, marker='s', zorder=5, label=f'M_r = {params["M_r"]:.1f} emu/g')
ax2.set_xlabel('Magnetic Field H [Oe]', fontsize=12)
ax2.set_ylabel('Magnetization M [emu/g]', fontsize=12)
ax2.set_title('Hysteresis Loop (Zoom)', fontsize=14, fontweight='bold')
ax2.legend(fontsize=11)
ax2.grid(alpha=0.3)

plt.tight_layout()
plt.show()
</code></pre>

        <h2>3.5 ç£æ°—ç•°æ–¹æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼</h2>

        <h3>3.5.1 ç£æ°—ç•°æ–¹æ€§ã®èµ·æº</h3>
        <p><strong>ç£æ°—ç•°æ–¹æ€§</strong>ã¯ã€ç£åŒ–ãŒç‰¹å®šã®çµæ™¶æ–¹ä½ã«å‘ãã‚„ã™ã„æ€§è³ªã§ã™ã€‚ä¿ç£åŠ›ã®ä¸»è¦å› ã®ä¸€ã¤ã§ã™ã€‚</p>

        <p><strong>ç£æ°—ç•°æ–¹æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong> $K$ ã¯ã€å˜è»¸ç•°æ–¹æ€§ã®å ´åˆï¼š</p>

        $$
        E = K \sin^2\theta
        $$

        <p>ã“ã“ã§ã€$\theta$ ã¯ç£åŒ–ã¨ç•°æ–¹æ€§è»¸ï¼ˆeasy axisï¼‰ã®ãªã™è§’åº¦ã§ã™ã€‚</p>

        <p><strong>ä¿ç£åŠ›ã¨ã®é–¢ä¿‚</strong>ï¼ˆStoner-Wohlfarthç†è«–ã€å˜ç£åŒºç²’å­ï¼‰ï¼š</p>

        $$
        H_c = \frac{2K}{M_s}
        $$

        <p><strong>ç•°æ–¹æ€§ã®ç¨®é¡</strong>ï¼š</p>
        <ul>
            <li><strong>çµæ™¶ç•°æ–¹æ€§</strong>ï¼šçµæ™¶æ§‹é€ ã«èµ·å› ï¼ˆç«‹æ–¹æ™¶ã€å…­æ–¹æ™¶ãªã©ï¼‰</li>
            <li><strong>å½¢çŠ¶ç•°æ–¹æ€§</strong>ï¼šè©¦æ–™å½¢çŠ¶ã«ã‚ˆã‚‹åç£å ´åŠ¹æœ</li>
            <li><strong>èª˜å°ç•°æ–¹æ€§</strong>ï¼šç£å ´ä¸­ã§ã®ç†±å‡¦ç†ã§èª˜èµ·</li>
            <li><strong>è¡¨é¢ãƒ»ç•Œé¢ç•°æ–¹æ€§</strong>ï¼šãƒŠãƒææ–™ã§é‡è¦</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3-4: ç£æ°—ç•°æ–¹æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®è¨ˆç®—</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def calculate_anisotropy_constant(H_c, M_s):
    """
    ä¿ç£åŠ›ã‹ã‚‰ç£æ°—ç•°æ–¹æ€§å®šæ•°ã‚’è¨ˆç®—
    
    Parameters
    ----------
    H_c : float
        ä¿ç£åŠ› [Oe]
    M_s : float
        é£½å’Œç£åŒ– [emu/g] ã¾ãŸã¯ [emu/cm^3]
    
    Returns
    -------
    K : float
        ç£æ°—ç•°æ–¹æ€§å®šæ•° [erg/cm^3]ï¼ˆCGSå˜ä½ï¼‰
        ã¾ãŸã¯ [J/m^3]ï¼ˆSIå˜ä½ï¼‰ã«å¤‰æ›å¯èƒ½ï¼ˆÃ— 10^3ï¼‰
    """
    # Stoner-Wohlfarthç†è«–: H_c = 2K / M_s
    K = H_c * M_s / 2
    return K

# ææ–™ä¾‹
materials = {
    'Soft magnetic (Fe-Si)': {'H_c': 5, 'M_s': 1700},  # [Oe], [emu/cm^3]
    'Recording media (CoCrPt)': {'H_c': 3000, 'M_s': 400},
    'Hard magnet (NdFeB)': {'H_c': 12000, 'M_s': 1280},
    'Nanoparticle (Fe3O4)': {'H_c': 300, 'M_s': 480}
}

print("ç£æ°—ç•°æ–¹æ€§å®šæ•°ã®è¨ˆç®—:")
print("=" * 80)
print(f"{'Material':<30} {'H_c [Oe]':<12} {'M_s [emu/cmÂ³]':<18} {'K [10â¶ erg/cmÂ³]':<20}")
print("-" * 80)

K_values = {}
for name, props in materials.items():
    K = calculate_anisotropy_constant(props['H_c'], props['M_s'])
    K_values[name] = K
    print(f"{name:<30} {props['H_c']:<12.0f} {props['M_s']:<18.0f} {K / 1e6:<20.2f}")

# å¯è¦–åŒ–
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å›³ï¼šç•°æ–¹æ€§ã‚¨ãƒãƒ«ã‚®ãƒ¼æ›²ç·š
theta = np.linspace(0, 180, 100)  # [deg]
theta_rad = np.deg2rad(theta)

# ç•°ãªã‚‹Kã§ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æ›²ç·š
K_list = [1e5, 5e5, 1e6, 5e6]  # [erg/cm^3]
colors = plt.cm.plasma(np.linspace(0, 0.9, len(K_list)))

for K, color in zip(K_list, colors):
    E = K * np.sin(theta_rad)**2
    ax1.plot(theta, E / 1e6, linewidth=2.5, label=f'K = {K / 1e6:.1f} Ã— 10â¶ erg/cmÂ³', color=color)

ax1.set_xlabel('Angle Î¸ [deg]', fontsize=12)
ax1.set_ylabel('Anisotropy Energy E [10â¶ erg/cmÂ³]', fontsize=12)
ax1.set_title('Uniaxial Anisotropy Energy: E = K sinÂ²Î¸', fontsize=14, fontweight='bold')
ax1.legend(fontsize=10)
ax1.grid(alpha=0.3)
ax1.set_xlim(0, 180)

# å³å›³ï¼šææ–™æ¯”è¼ƒï¼ˆK vs H_cï¼‰
names = list(K_values.keys())
K_vals = [K_values[n] / 1e6 for n in names]
H_c_vals = [materials[n]['H_c'] for n in names]

ax2.scatter(H_c_vals, K_vals, s=200, edgecolors='black', linewidths=2, c=range(len(names)), cmap='plasma', zorder=5)
for i, name in enumerate(names):
    ax2.annotate(name.split('(')[1].replace(')', ''), (H_c_vals[i], K_vals[i]), 
                 xytext=(10, 10), textcoords='offset points', fontsize=10, fontweight='bold')

ax2.set_xlabel('Coercivity H$_c$ [Oe]', fontsize=12)
ax2.set_ylabel('Anisotropy Constant K [10â¶ erg/cmÂ³]', fontsize=12)
ax2.set_title('Material Comparison: K vs H$_c$', fontsize=14, fontweight='bold')
ax2.set_xscale('log')
ax2.set_yscale('log')
ax2.grid(alpha=0.3, which='both')

plt.tight_layout()
plt.show()

print(f"\nç‰©ç†çš„è§£é‡ˆ:")
print(f"  è»Ÿç£æ€§ææ–™ï¼ˆFe-Siï¼‰: K â‰ˆ 10â´ erg/cmÂ³ï¼ˆä½ç•°æ–¹æ€§ â†’ ä½ä¿ç£åŠ›ï¼‰")
print(f"  ç¡¬ç£æ€§ææ–™ï¼ˆNdFeBï¼‰: K â‰ˆ 10â· erg/cmÂ³ï¼ˆé«˜ç•°æ–¹æ€§ â†’ é«˜ä¿ç£åŠ›ï¼‰")
print(f"  K ãŒå¤§ãã„ã»ã©ã€ç£åŒ–ã‚’åè»¢ã•ã›ã‚‹ã®ã«å¤§ããªã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒå¿…è¦")
</code></pre>

        <h2>3.6 æ¸©åº¦ä¾å­˜æ€§ç£æ°—æ¸¬å®šï¼ˆFC/ZFCï¼‰</h2>

        <h3>3.6.1 FC/ZFCæ¸¬å®šæ³•</h3>
        <p><strong>FCï¼ˆField-Cooledï¼‰/ ZFCï¼ˆZero-Field-Cooledï¼‰æ¸¬å®š</strong>ã¯ã€è¶…å¸¸ç£æ€§è»¢ç§»ã‚„ç£æ°—ç›¸è»¢ç§»ã‚’èª¿ã¹ã‚‹æ¨™æº–çš„ãªæ‰‹æ³•ã§ã™ã€‚</p>

        <p><strong>æ¸¬å®šæ‰‹é †</strong>ï¼š</p>
        <ol>
            <li><strong>ZFCï¼ˆã‚¼ãƒ­ç£å ´å†·å´ï¼‰</strong>ï¼š
                <ul>
                    <li>ç£å ´ H = 0 ã§é«˜æ¸©ã‹ã‚‰ä½æ¸©ï¼ˆä¾‹ï¼š5 Kï¼‰ã¾ã§å†·å´</li>
                    <li>ä½æ¸©ã§å°ã•ãªç£å ´ï¼ˆä¾‹ï¼š100 Oeï¼‰ã‚’å°åŠ </li>
                    <li>æ¸©åº¦ã‚’ä¸Šã’ãªãŒã‚‰ç£åŒ– $M_{\text{ZFC}}(T)$ ã‚’æ¸¬å®š</li>
                </ul>
            </li>
            <li><strong>FCï¼ˆç£å ´ä¸­å†·å´ï¼‰</strong>ï¼š
                <ul>
                    <li>æ¸¬å®šç£å ´ï¼ˆ100 Oeï¼‰ã‚’å°åŠ ã—ãŸã¾ã¾é«˜æ¸©ã‹ã‚‰ä½æ¸©ã¾ã§å†·å´</li>
                    <li>æ¸©åº¦ã‚’ä¸Šã’ãªãŒã‚‰ç£åŒ– $M_{\text{FC}}(T)$ ã‚’æ¸¬å®š</li>
                </ul>
            </li>
        </ol>

        <p><strong>å…¸å‹çš„ãªFC/ZFCãƒ‘ã‚¿ãƒ¼ãƒ³</strong>ï¼š</p>
        <ul>
            <li><strong>è¶…å¸¸ç£æ€§ãƒŠãƒç²’å­</strong>ï¼šZFCã¯T$_B$ï¼ˆãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ï¼‰ã§ãƒ”ãƒ¼ã‚¯ã€FCã¯å˜èª¿æ¸›å°‘</li>
            <li><strong>ã‚¹ãƒ”ãƒ³ã‚°ãƒ©ã‚¹</strong>ï¼šZFC/FCãŒåˆ†å²ã—ã€T$_f$ï¼ˆå‡çµæ¸©åº¦ï¼‰ä»¥ä¸‹ã§ä¸å¯é€†</li>
            <li><strong>å¼·ç£æ€§è»¢ç§»</strong>ï¼šT$_C$ï¼ˆCurieæ¸©åº¦ï¼‰ã§æ€¥æ¿€ãªæ¸›å°‘</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3-5: FC/ZFCæ›²ç·šã®è§£æï¼ˆãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ï¼‰</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def generate_fc_zfc(T, T_B, M_high, tau_0=1e-9, K=1e5, V=1e-24):
    """
    è¶…å¸¸ç£æ€§ãƒŠãƒç²’å­ã®FC/ZFCæ›²ç·šã‚’ç”Ÿæˆ
    
    Parameters
    ----------
    T : array-like
        æ¸©åº¦ [K]
    T_B : float
        ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ [K]
    M_high : float
        é«˜æ¸©ã§ã®ç£åŒ– [emu/g]
    tau_0 : float
        æ¸¬å®šæ™‚é–“ã‚¹ã‚±ãƒ¼ãƒ« [s]
    K : float
        ç•°æ–¹æ€§å®šæ•° [erg/cm^3]
    V : float
        ç²’å­ä½“ç© [cm^3]
    
    Returns
    -------
    M_FC, M_ZFC : array-like
        FC/ZFCç£åŒ–æ›²ç·š
    """
    k_B = 1.38065e-16  # Boltzmannå®šæ•° [erg/K]
    
    # NÃ©elç·©å’Œæ™‚é–“: Ï„ = Ï„â‚€ exp(KV / k_B T)
    # ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦: T_B â‰ˆ KV / (25 k_B) for Ï„_measure = 100 s
    
    # ZFC: T < T_B ã§ãƒ–ãƒ­ãƒƒã‚¯ï¼ˆç£åŒ–å°ï¼‰ã€T > T_B ã§è¶…å¸¸ç£æ€§ï¼ˆç£åŒ–å¢—åŠ ï¼‰
    M_ZFC = M_high * (1 - np.exp(-(T / T_B)**3))
    
    # FC: ä½æ¸©ã§ã‚‚ç£åŒ–ã¯ä¿æŒï¼ˆç£å ´ä¸­ã§å†·å´ï¼‰
    M_FC = M_high * (1 - 0.3 * np.exp(-(T / (1.5 * T_B))**2))
    
    return M_FC, M_ZFC

# ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
T_range = np.linspace(5, 300, 100)  # [K]
T_B_true = 50  # ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ [K]
M_high_true = 20  # é«˜æ¸©ç£åŒ– [emu/g]

M_FC, M_ZFC = generate_fc_zfc(T_range, T_B_true, M_high_true)
M_FC_noise = M_FC + 0.3 * np.random.randn(len(T_range))
M_ZFC_noise = M_ZFC + 0.3 * np.random.randn(len(T_range))

# ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦æŠ½å‡ºï¼ˆZFCãƒ”ãƒ¼ã‚¯ï¼‰
T_B_measured = T_range[np.argmax(M_ZFC_noise)]

print("FC/ZFCæ¸¬å®šè§£æ:")
print("=" * 60)
print(f"ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ T_B = {T_B_measured:.1f} Kï¼ˆZFCãƒ”ãƒ¼ã‚¯ä½ç½®ï¼‰")
print(f"çœŸã®å€¤ T_B = {T_B_true} K")
print(f"\nç‰©ç†çš„è§£é‡ˆ:")
print(f"  T < T_B: ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãŒãƒ–ãƒ­ãƒƒã‚¯çŠ¶æ…‹ï¼ˆæ¸¬å®šæ™‚é–“å†…ã§åè»¢ã—ãªã„ï¼‰")
print(f"  T > T_B: è¶…å¸¸ç£æ€§çŠ¶æ…‹ï¼ˆç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆãŒç†±æºã‚‰ãã§åè»¢ï¼‰")
print(f"  FC/ZFCã®åˆ†å² â†’ ç£æ°—ç›¸äº’ä½œç”¨ã®å­˜åœ¨ã‚’ç¤ºå”†")

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å·¦å›³ï¼šFC/ZFCæ›²ç·š
ax1.plot(T_range, M_FC_noise, 'o-', linewidth=2.5, markersize=5, label='FC (Field-Cooled)', color='#f5576c')
ax1.plot(T_range, M_ZFC_noise, 's-', linewidth=2.5, markersize=5, label='ZFC (Zero-Field-Cooled)', color='#99ccff')
ax1.axvline(T_B_measured, color='red', linestyle='--', linewidth=2, label=f'T_B = {T_B_measured:.1f} K')
ax1.scatter([T_B_measured], [np.max(M_ZFC_noise)], s=200, c='red', edgecolors='black', linewidth=2, marker='X', zorder=5)
ax1.set_xlabel('Temperature T [K]', fontsize=12)
ax1.set_ylabel('Magnetization M [emu/g]', fontsize=12)
ax1.set_title('FC/ZFC Magnetization (Superparamagnetic Nanoparticles)', fontsize=14, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(alpha=0.3)

# å³å›³ï¼šFC-ZFCå·®ï¼ˆä¸å¯é€†æ€§ï¼‰
Delta_M = M_FC_noise - M_ZFC_noise
ax2.plot(T_range, Delta_M, linewidth=2.5, color='#ffa500')
ax2.axhline(0, color='black', linestyle='-', linewidth=1)
ax2.axvline(T_B_measured, color='red', linestyle='--', linewidth=2, label=f'T_B = {T_B_measured:.1f} K')
ax2.fill_between(T_range, 0, Delta_M, where=(Delta_M > 0), alpha=0.3, color='#ffa500', label='Irreversibility region')
ax2.set_xlabel('Temperature T [K]', fontsize=12)
ax2.set_ylabel('Î”M = M$_{FC}$ - M$_{ZFC}$ [emu/g]', fontsize=12)
ax2.set_title('FC-ZFC Irreversibility', fontsize=14, fontweight='bold')
ax2.legend(fontsize=11)
ax2.grid(alpha=0.3)

plt.tight_layout()
plt.show()
</code></pre>

        <h2>3.7 PPMSï¼ˆPhysical Property Measurement Systemï¼‰</h2>

        <h3>3.7.1 PPMSã®æ¦‚è¦</h3>
        <p><strong>PPMS</strong>ï¼ˆQuantum Designç¤¾ï¼‰ã¯ã€ç£æ°—ãƒ»é›»æ°—ãƒ»ç†±ç‰©æ€§ã‚’çµ±åˆæ¸¬å®šã§ãã‚‹æ±ç”¨ã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚</p>

        <p><strong>æ¸¬å®šå¯èƒ½ãªç‰©æ€§</strong>ï¼š</p>
        <ul>
            <li>ç£åŒ–ï¼ˆVSMãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã€æ„Ÿåº¦ $10^{-6}$ emuï¼‰</li>
            <li>é›»æ°—ä¼å°ç‡ãƒ»HallåŠ¹æœï¼ˆACãƒˆãƒ©ãƒ³ã‚¹ãƒãƒ¼ãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰</li>
            <li>ç†±å®¹é‡ï¼ˆç†±ç·©å’Œæ³•ï¼‰</li>
            <li>æ¯”ç†±ï¼ˆSemi-adiabaticæ³•ï¼‰</li>
            <li>ç†±é›»æ€§èƒ½ï¼ˆSeebeckä¿‚æ•°ã€ç†±ä¼å°ç‡ï¼‰</li>
        </ul>

        <p><strong>æ¸¬å®šç¯„å›²</strong>ï¼š</p>
        <ul>
            <li><strong>æ¸©åº¦</strong>ï¼š1.8 K - 400 Kï¼ˆ$^3$Heå†·å‡æ©Ÿã§ 0.4 K ã¾ã§æ‹¡å¼µå¯ï¼‰</li>
            <li><strong>ç£å ´</strong>ï¼šÂ±9 Tï¼ˆã¾ãŸã¯ Â±14 Tï¼‰</li>
            <li><strong>è‡ªå‹•åˆ¶å¾¡</strong>ï¼šæ¸©åº¦ãƒ»ç£å ´ãƒ»æ¸¬å®šã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’å®Œå…¨è‡ªå‹•åŒ–</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3-6: å®Œå…¨ãªç£æ°—ãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ï¼ˆVSM/SQUIDï¼‰</h4>
        <pre><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from scipy.interpolate import interp1d
from scipy.optimize import brentq

class MagneticDataProcessor:
    """VSM/SQUIDãƒ‡ãƒ¼ã‚¿ã®å®Œå…¨å‡¦ç†ã‚¯ãƒ©ã‚¹"""

    def __init__(self, sample_mass, sample_volume=None):
        """
        Parameters
        ----------
        sample_mass : float
            è©¦æ–™è³ªé‡ [g]
        sample_volume : float or None
            è©¦æ–™ä½“ç© [cm^3]ï¼ˆè³ªé‡ç£åŒ–ã‚’ä½“ç©ç£åŒ–ã«å¤‰æ›ã™ã‚‹å ´åˆï¼‰
        """
        self.mass = sample_mass
        self.volume = sample_volume
        self.data = {}

    def load_data(self, filename=None, mock_data=True):
        """æ¸¬å®šãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿"""
        if mock_data:
            # ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆï¼ˆM-Hæ›²ç·šï¼‰
            H = np.linspace(-5000, 5000, 100)  # [Oe]
            M_s = 50  # [emu/g]
            H_c = 300
            M_r = 40
            
            M_raw = M_s * np.tanh(H / (0.3 * H_c))
            M = np.where(H > 0, 
                         M_s * np.tanh((H - H_c) / (0.3 * H_c)) + M_r,
                         -M_s * np.tanh((-H - H_c) / (0.3 * H_c)) - M_r)
            M += 0.002 * H  # å¸¸ç£æ€§ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰
            M += 0.5 * np.random.randn(len(H))  # ãƒã‚¤ã‚º

            self.data = pd.DataFrame({'H': H, 'M_raw': M})
        else:
            # å®Ÿãƒ‡ãƒ¼ã‚¿ã‚’CSVã‹ã‚‰èª­ã¿è¾¼ã¿
            self.data = pd.read_csv(filename)

        return self.data

    def subtract_background(self, H_min=3000):
        """é«˜ç£å ´ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã®æ¸›ç®—"""
        H_high = self.data['H'][self.data['H'] > H_min]
        M_high = self.data['M_raw'][self.data['H'] > H_min]
        
        # ç·šå½¢ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
        slope = np.polyfit(H_high, M_high, 1)[0]
        self.data['M'] = self.data['M_raw'] - slope * self.data['H']
        
        print(f"Background subtracted: slope = {slope:.2e}")

    def extract_parameters(self):
        """M-Hæ›²ç·šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æŠ½å‡º"""
        H = self.data['H'].values
        M = self.data['M'].values

        # é£½å’Œç£åŒ–
        self.M_s = np.mean(M[H > 0.8 * np.max(H)])

        # ä¿ç£åŠ›
        interp_func = interp1d(H, M, kind='linear')
        self.H_c = brentq(interp_func, np.min(H[H < 0]), np.max(H[H > 0]))

        # æ®‹ç•™ç£åŒ–
        self.M_r = interp_func(0)

        # è§’å½¢æ¯”
        self.S = self.M_r / self.M_s if self.M_s != 0 else 0

        # ç£æ°—ç•°æ–¹æ€§å®šæ•°
        self.K = self.H_c * self.M_s / 2  # [erg/cm^3]ï¼ˆCGSï¼‰

        results = {
            'M_s': self.M_s,
            'H_c': self.H_c,
            'M_r': self.M_r,
            'S': self.S,
            'K': self.K
        }

        return results

    def plot_mh_curve(self):
        """M-Hæ›²ç·šã®å¯è¦–åŒ–"""
        fig, ax = plt.subplots(figsize=(10, 7))

        ax.plot(self.data['H'], self.data['M'], linewidth=2.5, color='#f093fb', label='M-H curve')
        ax.axhline(self.M_s, color='green', linestyle='--', linewidth=1.5, label=f'M_s = {self.M_s:.1f} emu/g')
        ax.axhline(self.M_r, color='orange', linestyle='--', linewidth=1.5, label=f'M_r = {self.M_r:.1f} emu/g')
        ax.axvline(self.H_c, color='red', linestyle='--', linewidth=1.5, label=f'H_c = {self.H_c:.0f} Oe')
        ax.axhline(0, color='black', linestyle='-', linewidth=1)
        ax.axvline(0, color='black', linestyle='-', linewidth=1)

        ax.scatter([self.H_c], [0], s=150, c='red', edgecolors='black', linewidth=2, marker='o', zorder=5)
        ax.scatter([0], [self.M_r], s=150, c='orange', edgecolors='black', linewidth=2, marker='s', zorder=5)

        ax.set_xlabel('Magnetic Field H [Oe]', fontsize=12)
        ax.set_ylabel('Magnetization M [emu/g]', fontsize=12)
        ax.set_title('M-H Hysteresis Loop Analysis', fontsize=14, fontweight='bold')
        ax.legend(fontsize=11)
        ax.grid(alpha=0.3)

        plt.tight_layout()
        plt.show()

    def save_results(self, filename='magnetic_results.csv'):
        """çµæœã‚’CSVã«ä¿å­˜"""
        self.data.to_csv(filename, index=False)
        print(f"Results saved to {filename}")

# ä½¿ç”¨ä¾‹
processor = MagneticDataProcessor(sample_mass=0.005)  # 5 mg
processor.load_data(mock_data=True)
processor.subtract_background(H_min=3000)
results = processor.extract_parameters()

print("\nç£æ°—æ¸¬å®šè§£æçµæœ:")
print("=" * 60)
print(f"é£½å’Œç£åŒ– M_s = {results['M_s']:.2f} emu/g")
print(f"ä¿ç£åŠ› H_c = {results['H_c']:.2f} Oe = {results['H_c'] / 79.5775:.2f} kA/m")
print(f"æ®‹ç•™ç£åŒ– M_r = {results['M_r']:.2f} emu/g")
print(f"è§’å½¢æ¯” S = {results['S']:.3f}")
print(f"ç£æ°—ç•°æ–¹æ€§å®šæ•° K = {results['K']:.2e} erg/cmÂ³ = {results['K'] * 1e3:.2e} J/mÂ³")

processor.plot_mh_curve()
processor.save_results('vsm_analysis_output.csv')
</code></pre>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3-7: å¤šæ¸©åº¦M-Hæ›²ç·šã®ä¸€æ‹¬è§£æ</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def analyze_multi_temperature_mh(T_list, H_range):
    """
    è¤‡æ•°æ¸©åº¦ã§ã®M-Hæ›²ç·šã‚’ç”Ÿæˆãƒ»è§£æ
    
    Parameters
    ----------
    T_list : list
        æ¸©åº¦ãƒªã‚¹ãƒˆ [K]
    H_range : array-like
        ç£å ´ç¯„å›² [Oe]
    
    Returns
    -------
    results : dict
        å„æ¸©åº¦ã§ã® M_s, H_c, M_r
    """
    results = {'T': T_list, 'M_s': [], 'H_c': [], 'M_r': []}

    for T in T_list:
        # æ¸©åº¦ä¾å­˜æ€§ã‚’å«ã‚€M-Hæ›²ç·šç”Ÿæˆ
        M_s_T = 100 * (1 - (T / 400)**2)  # é£½å’Œç£åŒ–ã®æ¸©åº¦ä¾å­˜æ€§
        H_c_T = 500 * (1 - (T / 400)**1.5)  # ä¿ç£åŠ›ã®æ¸©åº¦ä¾å­˜æ€§
        M_r_T = 0.8 * M_s_T  # æ®‹ç•™ç£åŒ–

        # ç°¡æ˜“M-Hæ›²ç·š
        M = np.where(H_range > 0,
                     M_s_T * np.tanh((H_range - H_c_T) / (0.3 * H_c_T)) + M_r_T,
                     -M_s_T * np.tanh((-H_range - H_c_T) / (0.3 * H_c_T)) - M_r_T)

        results['M_s'].append(M_s_T)
        results['H_c'].append(H_c_T)
        results['M_r'].append(M_r_T)

    return results

# æ¸©åº¦ç¯„å›²
T_list = [50, 100, 150, 200, 250, 300]  # [K]
H_range = np.linspace(-5000, 5000, 200)

# è§£æå®Ÿè¡Œ
results = analyze_multi_temperature_mh(T_list, H_range)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# å·¦ä¸Šï¼šM_s vs T
axes[0, 0].plot(results['T'], results['M_s'], 'o-', linewidth=2.5, markersize=8, color='#f093fb')
axes[0, 0].set_xlabel('Temperature T [K]', fontsize=12)
axes[0, 0].set_ylabel('Saturation Magnetization M$_s$ [emu/g]', fontsize=12)
axes[0, 0].set_title('M$_s$ vs Temperature', fontsize=13, fontweight='bold')
axes[0, 0].grid(alpha=0.3)

# å³ä¸Šï¼šH_c vs T
axes[0, 1].plot(results['T'], results['H_c'], 's-', linewidth=2.5, markersize=8, color='#f5576c')
axes[0, 1].set_xlabel('Temperature T [K]', fontsize=12)
axes[0, 1].set_ylabel('Coercivity H$_c$ [Oe]', fontsize=12)
axes[0, 1].set_title('H$_c$ vs Temperature', fontsize=13, fontweight='bold')
axes[0, 1].grid(alpha=0.3)

# å·¦ä¸‹ï¼šM_r vs T
axes[1, 0].plot(results['T'], results['M_r'], '^-', linewidth=2.5, markersize=8, color='#ffa500')
axes[1, 0].set_xlabel('Temperature T [K]', fontsize=12)
axes[1, 0].set_ylabel('Remanence M$_r$ [emu/g]', fontsize=12)
axes[1, 0].set_title('M$_r$ vs Temperature', fontsize=13, fontweight='bold')
axes[1, 0].grid(alpha=0.3)

# å³ä¸‹ï¼šè§’å½¢æ¯” S vs T
S = np.array(results['M_r']) / np.array(results['M_s'])
axes[1, 1].plot(results['T'], S, 'd-', linewidth=2.5, markersize=8, color='#99ccff')
axes[1, 1].set_xlabel('Temperature T [K]', fontsize=12)
axes[1, 1].set_ylabel('Squareness S = M$_r$ / M$_s$', fontsize=12)
axes[1, 1].set_title('Squareness vs Temperature', fontsize=13, fontweight='bold')
axes[1, 1].set_ylim(0, 1.1)
axes[1, 1].grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("æ¸©åº¦ä¾å­˜æ€§è§£æçµæœ:")
print("=" * 80)
print(f"{'T [K]':<10} {'M_s [emu/g]':<15} {'H_c [Oe]':<15} {'M_r [emu/g]':<15} {'S':<10}")
print("-" * 80)
for i, T in enumerate(results['T']):
    print(f"{T:<10.0f} {results['M_s'][i]:<15.1f} {results['H_c'][i]:<15.1f} {results['M_r'][i]:<15.1f} {S[i]:<10.3f}")

print(f"\nå‚¾å‘:")
print(f"  æ¸©åº¦ä¸Šæ˜‡ â†’ M_s æ¸›å°‘ï¼ˆç†±æºã‚‰ãå¢—åŠ ï¼‰")
print(f"  æ¸©åº¦ä¸Šæ˜‡ â†’ H_c æ¸›å°‘ï¼ˆç†±æ´»æ€§åŒ–ã«ã‚ˆã‚‹ç£åŒ–åè»¢ä¿ƒé€²ï¼‰")
print(f"  Curieæ¸©åº¦ã«è¿‘ã¥ãã¨æ€¥æ¿€ã«æ¸›å°‘")
</code></pre>

        <h2>3.8 æ¼”ç¿’å•é¡Œ</h2>

        <h3>æ¼”ç¿’3-1: Curieå®šæ•°ã®è¨ˆç®—ï¼ˆEasyï¼‰</h3>
        <p><span class="exercise-label easy">Easy</span> <strong>å•é¡Œ</strong>ï¼šç£åŒ–ç‡ãŒ T = 200 K ã§ Ï‡ = 0.01ã€300 K ã§ Ï‡ = 0.0067 ã§ã‚ã£ãŸã€‚Curieå‰‡ $\chi = C/T$ ã‚’ä»®å®šã—ã€Curieå®šæ•° C ã‚’æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np

T1, chi1 = 200, 0.01
T2, chi2 = 300, 0.0067

# C = Ï‡ Ã— T
C1 = chi1 * T1
C2 = chi2 * T2

print(f"T = {T1} K: C = {C1:.2f}")
print(f"T = {T2} K: C = {C2:.2f}")
print(f"å¹³å‡ C = {(C1 + C2) / 2:.2f}")
</code></pre>
            <p><strong>è§£ç­”</strong>ï¼šC â‰ˆ 2.0ï¼ˆã»ã¼ä¸€è‡´ â†’ Curieå‰‡ãŒæˆç«‹ï¼‰</p>
        </details>

        <h3>æ¼”ç¿’3-2: é£½å’Œç£åŒ–ã®è¨ˆç®—ï¼ˆEasyï¼‰</h3>
        <p><span class="exercise-label easy">Easy</span> <strong>å•é¡Œ</strong>ï¼šFeã®é£½å’Œç£åŒ–ãŒ 220 emu/gã€è©¦æ–™è³ªé‡ãŒ 5 mg ã®ã¨ãã€è©¦æ–™ã®ç·ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆã‚’ emu å˜ä½ã§æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">M_s = 220  # [emu/g]
mass = 0.005  # [g] = 5 mg

total_moment = M_s * mass
print(f"ç·ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ = {total_moment:.3f} emu")
</code></pre>
            <p><strong>è§£ç­”</strong>ï¼š1.100 emu</p>
        </details>

        <h3>æ¼”ç¿’3-3: Langeviné–¢æ•°ã®è©•ä¾¡ï¼ˆEasyï¼‰</h3>
        <p><span class="exercise-label easy">Easy</span> <strong>å•é¡Œ</strong>ï¼šç£å ´ H = 5000 Oeã€æ¸©åº¦ T = 300 Kã€ç²’å­ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ Î¼ = 10,000 Î¼$_B$ ã®ã¨ãã€Langevinãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î¾ = Î¼BH/(k$_B$T) ã‚’è¨ˆç®—ã›ã‚ˆï¼ˆÎ¼$_B$ = 9.274 Ã— 10$^{-24}$ J/Tï¼‰ã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">mu_B = 9.274e-24  # [J/T]
k_B = 1.38065e-23  # [J/K]
H = 5000 * 1e-4  # [Oe] â†’ [T]
T = 300  # [K]
mu = 10000  # [Î¼_B]

xi = mu * mu_B * H / (k_B * T)
print(f"Langevinãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ Î¾ = {xi:.3f}")
print(f"Î¾ < 1 â†’ ç·šå½¢é ˜åŸŸï¼ˆM â‰ˆ Ï‡Hï¼‰")
print(f"Î¾ >> 1 â†’ é£½å’Œé ˜åŸŸï¼ˆM â‰ˆ M_sï¼‰")
</code></pre>
            <p><strong>è§£ç­”</strong>ï¼šÎ¾ â‰ˆ 1.12ï¼ˆç·šå½¢ã‹ã‚‰é£½å’Œã¸ã®é·ç§»é ˜åŸŸï¼‰</p>
        </details>

        <h3>æ¼”ç¿’3-4: ä¿ç£åŠ›ã‹ã‚‰ç•°æ–¹æ€§å®šæ•°ã‚’è¨ˆç®—ï¼ˆMediumï¼‰</h3>
        <p><span class="exercise-label medium">Medium</span> <strong>å•é¡Œ</strong>ï¼šä¿ç£åŠ› H$_c$ = 2000 Oeã€é£½å’Œç£åŒ– M$_s$ = 800 emu/cm$^3$ ã®ææ–™ã®ç£æ°—ç•°æ–¹æ€§å®šæ•° K ã‚’è¨ˆç®—ã›ã‚ˆï¼ˆå˜ä½ï¼šerg/cm$^3$ ã¨ J/m$^3$ï¼‰ã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">H_c = 2000  # [Oe]
M_s = 800  # [emu/cm^3]

# K = H_c * M_s / 2ï¼ˆCGSå˜ä½ï¼‰
K_cgs = H_c * M_s / 2
print(f"ç£æ°—ç•°æ–¹æ€§å®šæ•° K = {K_cgs:.2e} erg/cmÂ³")

# SIå˜ä½ã«å¤‰æ›ï¼š1 erg/cmÂ³ = 10^-1 J/mÂ³
K_si = K_cgs * 1e-1
print(f"                  = {K_si:.2e} J/mÂ³")
</code></pre>
            <p><strong>è§£ç­”</strong>ï¼šK = 8.0 Ã— 10$^5$ erg/cm$^3$ = 8.0 Ã— 10$^4$ J/m$^3$</p>
        </details>

        <h3>æ¼”ç¿’3-5: FC/ZFCæ›²ç·šã‹ã‚‰ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ã‚’æŠ½å‡ºï¼ˆMediumï¼‰</h3>
        <p><span class="exercise-label medium">Medium</span> <strong>å•é¡Œ</strong>ï¼šZFCæ›²ç·šãŒ T = 10, 20, 30, 40, 50, 60, 70 K ã§ M = 5, 10, 15, 18, 16, 12, 8 emu/g ã¨æ¸¬å®šã•ã‚ŒãŸã€‚ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ T$_B$ ã‚’æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

T = np.array([10, 20, 30, 40, 50, 60, 70])  # [K]
M_ZFC = np.array([5, 10, 15, 18, 16, 12, 8])  # [emu/g]

# ãƒ”ãƒ¼ã‚¯æ¸©åº¦
T_B = T[np.argmax(M_ZFC)]
M_peak = np.max(M_ZFC)

print(f"ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ T_B = {T_B} K")
print(f"ãƒ”ãƒ¼ã‚¯ç£åŒ– M_peak = {M_peak} emu/g")

# ãƒ—ãƒ­ãƒƒãƒˆ
plt.figure(figsize=(8, 6))
plt.plot(T, M_ZFC, 'o-', linewidth=2.5, markersize=8, color='#99ccff', label='ZFC')
plt.axvline(T_B, color='red', linestyle='--', linewidth=2, label=f'T_B = {T_B} K')
plt.scatter([T_B], [M_peak], s=200, c='red', edgecolors='black', linewidth=2, marker='X', zorder=5)
plt.xlabel('Temperature T [K]', fontsize=12)
plt.ylabel('Magnetization M [emu/g]', fontsize=12)
plt.title('ZFC Curve: Blocking Temperature', fontsize=14, fontweight='bold')
plt.legend(fontsize=11)
plt.grid(alpha=0.3)
plt.show()
</code></pre>
            <p><strong>è§£ç­”</strong>ï¼šT$_B$ = 40 K</p>
        </details>

        <h3>æ¼”ç¿’3-6: M-Hæ›²ç·šã‹ã‚‰ã‚¨ãƒãƒ«ã‚®ãƒ¼ç©ã‚’è¨ˆç®—ï¼ˆMediumï¼‰</h3>
        <p><span class="exercise-label medium">Medium</span> <strong>å•é¡Œ</strong>ï¼šæ°¸ä¹…ç£çŸ³ã®M-Hæ›²ç·šã‹ã‚‰ã€æœ€å¤§ã‚¨ãƒãƒ«ã‚®ãƒ¼ç© (BH)$_{\text{max}}$ ã‚’æ¨å®šã›ã‚ˆï¼ˆM$_r$ = 12 kGã€H$_c$ = 10 kOe ã¨ä»®å®šï¼‰ã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">M_r = 12000  # [G] = 12 kG
H_c = 10000  # [Oe] = 10 kOe

# ç°¡æ˜“çš„ãªæ¨å®šï¼š(BH)_max â‰ˆ (B_r Ã— H_c) / 4
# B_r â‰ˆ M_rï¼ˆCGSå˜ä½ï¼‰
BH_max = (M_r * H_c) / 4 / 1e6  # MGOeå˜ä½

print(f"æœ€å¤§ã‚¨ãƒãƒ«ã‚®ãƒ¼ç© (BH)_max â‰ˆ {BH_max:.1f} MGOe")
print(f"\nå®Ÿç”¨ç£çŸ³ã®æ¯”è¼ƒ:")
print(f"  Ferrite: ~3-5 MGOe")
print(f"  SmCo: ~20-30 MGOe")
print(f"  NdFeB: ~40-50 MGOe")
</code></pre>
            <p><strong>è§£ç­”</strong>ï¼š(BH)$_{\text{max}}$ â‰ˆ 30 MGOeï¼ˆSmCoç´šã®æ€§èƒ½ï¼‰</p>
        </details>

        <h3>æ¼”ç¿’3-7: å¤šæ¸©åº¦ãƒ‡ãƒ¼ã‚¿ã®Curieæ¸©åº¦æ¨å®šï¼ˆHardï¼‰</h3>
        <p><span class="exercise-label hard">Hard</span> <strong>å•é¡Œ</strong>ï¼šM$_s$(T) ãŒ T = 100, 200, 300, 400, 500 K ã§ 95, 85, 70, 45, 10 emu/g ã¨æ¸¬å®šã•ã‚ŒãŸã€‚Curieæ¸©åº¦ T$_C$ ã‚’æ¨å®šã›ã‚ˆï¼ˆãƒ’ãƒ³ãƒˆï¼šM$_s$(T) âˆ (T$_C$ - T)$^Î²$ã€Î² â‰ˆ 0.5ï¼‰ã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np
from scipy.optimize import curve_fit
import matplotlib.pyplot as plt

T = np.array([100, 200, 300, 400, 500])  # [K]
M_s = np.array([95, 85, 70, 45, 10])  # [emu/g]

# ãƒ¢ãƒ‡ãƒ«ï¼šM_s(T) = M_0 * (1 - T/T_C)^Î²
def curie_temperature_model(T, M_0, T_C, beta):
    return M_0 * np.maximum(1 - T / T_C, 0)**beta

# ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°
params, _ = curve_fit(curie_temperature_model, T, M_s, p0=[100, 600, 0.5])
M_0, T_C, beta = params

print(f"ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°çµæœ:")
print(f"  M_0 = {M_0:.1f} emu/g")
print(f"  Curieæ¸©åº¦ T_C = {T_C:.1f} K")
print(f"  è‡¨ç•ŒæŒ‡æ•° Î² = {beta:.2f}")

# ãƒ—ãƒ­ãƒƒãƒˆ
T_fit = np.linspace(0, 600, 100)
M_fit = curie_temperature_model(T_fit, M_0, T_C, beta)

plt.figure(figsize=(10, 6))
plt.scatter(T, M_s, s=100, edgecolors='black', linewidths=2, label='Measured data', color='#f093fb', zorder=5)
plt.plot(T_fit, M_fit, linewidth=2.5, label=f'Fit: T_C = {T_C:.1f} K, Î² = {beta:.2f}', color='#f5576c')
plt.axvline(T_C, color='red', linestyle='--', linewidth=2, label=f'T_C = {T_C:.1f} K')
plt.xlabel('Temperature T [K]', fontsize=12)
plt.ylabel('Saturation Magnetization M$_s$ [emu/g]', fontsize=12)
plt.title('Curie Temperature Estimation', fontsize=14, fontweight='bold')
plt.legend(fontsize=11)
plt.grid(alpha=0.3)
plt.xlim(0, 650)
plt.ylim(0, 110)
plt.show()
</code></pre>
            <p><strong>è§£ç­”</strong>ï¼šT$_C$ â‰ˆ 550-570 Kï¼ˆãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã«ä¾å­˜ï¼‰ã€Î² â‰ˆ 0.4-0.5ï¼ˆç†è«–å€¤ 0.5 ã«è¿‘ã„ï¼‰</p>
        </details>

        <h3>æ¼”ç¿’3-8: SQUIDã¨VSMã®æ„Ÿåº¦æ¯”è¼ƒï¼ˆHardï¼‰</h3>
        <p><span class="exercise-label hard">Hard</span> <strong>å•é¡Œ</strong>ï¼šè©¦æ–™è³ªé‡ 1 mgã€é£½å’Œç£åŒ– 10 emu/g ã®ææ–™ã‚’æ¸¬å®šã™ã‚‹ã€‚VSMï¼ˆæ„Ÿåº¦ $10^{-6}$ emuï¼‰ã¨SQUIDï¼ˆæ„Ÿåº¦ $10^{-8}$ emuï¼‰ã§ã€S/Næ¯”ãŒä½•å€ç•°ãªã‚‹ã‹è©•ä¾¡ã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">mass = 0.001  # [g] = 1 mg
M_s = 10  # [emu/g]

# è©¦æ–™ã®ç·ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ
moment = M_s * mass
print(f"è©¦æ–™ã®ç·ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ = {moment:.2e} emu")

# VSM
sensitivity_VSM = 1e-6  # [emu]
SNR_VSM = moment / sensitivity_VSM
print(f"\nVSM:")
print(f"  æ„Ÿåº¦: {sensitivity_VSM:.0e} emu")
print(f"  S/Næ¯”: {SNR_VSM:.1f}")

# SQUID
sensitivity_SQUID = 1e-8  # [emu]
SNR_SQUID = moment / sensitivity_SQUID
print(f"\nSQUID:")
print(f"  æ„Ÿåº¦: {sensitivity_SQUID:.0e} emu")
print(f"  S/Næ¯”: {SNR_SQUID:.1f}")

# æ¯”è¼ƒ
ratio = SNR_SQUID / SNR_VSM
print(f"\nSQUIDã®S/Næ¯”ã¯VSMã® {ratio:.0f}å€")
print(f"â†’ SQUIDã¯å¾®é‡è©¦æ–™ã‚„å¾®å¼±ç£æ€§ã®æ¸¬å®šã«æœ‰åˆ©")
</code></pre>
            <p><strong>è§£ç­”</strong>ï¼šS/Næ¯”ã¯SQUIDãŒVSMã®100å€ï¼ˆæ„Ÿåº¦ã®æ¯”ã«å¯¾å¿œï¼‰</p>
        </details>

        <h3>æ¼”ç¿’3-9: å®Ÿé¨“è¨ˆç”»ï¼ˆHardï¼‰</h3>
        <p><span class="exercise-label hard">Hard</span> <strong>å•é¡Œ</strong>ï¼šæœªçŸ¥ã®ç£æ€§ãƒŠãƒç²’å­ï¼ˆè³ªé‡ 2 mgï¼‰ã®ç£æ°—ç‰¹æ€§ã‚’å®Œå…¨ã«è©•ä¾¡ã™ã‚‹å®Ÿé¨“è¨ˆç”»ã‚’ç«‹æ¡ˆã›ã‚ˆã€‚VSM/SQUIDæ¸¬å®šã€æ¸©åº¦ç¯„å›²ã€ç£å ´ç¯„å›²ã€ãƒ‡ãƒ¼ã‚¿è§£ææ‰‹æ³•ã‚’å…·ä½“çš„ã«èª¬æ˜ã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <p><strong>å®Ÿé¨“è¨ˆç”»</strong>ï¼š</p>
            <ol>
                <li><strong>æ¸¬å®šè£…ç½®é¸å®š</strong>ï¼š
                    <ul>
                        <li>è³ªé‡ 2 mg â†’ ç·ç£æ°—ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ $\sim 10^{-3}$ - $10^{-2}$ emuï¼ˆäºˆæƒ³ï¼‰</li>
                        <li>VSMï¼ˆæ„Ÿåº¦ $10^{-6}$ emuï¼‰ã§ååˆ†ã ãŒã€è¶…å¸¸ç£æ€§ã®å¯èƒ½æ€§ã‚’è€ƒæ…®ã—ã¦SQUIDæ¨å¥¨</li>
                    </ul>
                </li>
                <li><strong>å®¤æ¸©M-Hæ›²ç·šæ¸¬å®š</strong>ï¼ˆT = 300 Kï¼‰ï¼š
                    <ul>
                        <li>ç£å ´ç¯„å›²ï¼š-2 T ã€œ +2 Tï¼ˆÂ±20 kOeï¼‰ã€ã‚¹ãƒ†ãƒƒãƒ— 100 Oe</li>
                        <li>ç›®çš„ï¼šM$_s$ã€H$_c$ã€M$_r$ã€ç£æ€§ã®ç¨®é¡ï¼ˆå¸¸ç£æ€§/å¼·ç£æ€§ï¼‰ã‚’åˆ¤å®š</li>
                    </ul>
                </li>
                <li><strong>FC/ZFCæ¸¬å®š</strong>ï¼ˆè¶…å¸¸ç£æ€§è©•ä¾¡ï¼‰ï¼š
                    <ul>
                        <li>æ¸©åº¦ç¯„å›²ï¼š5 K - 350 Kã€æ¸¬å®šç£å ´ 100 Oe</li>
                        <li>ZFCãƒ”ãƒ¼ã‚¯ã‹ã‚‰ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ T$_B$ ã‚’æ±ºå®š</li>
                        <li>FC/ZFCåˆ†å² â†’ ç²’å­é–“ç›¸äº’ä½œç”¨ã®è©•ä¾¡</li>
                    </ul>
                </li>
                <li><strong>æ¸©åº¦ä¾å­˜æ€§M-Hæ›²ç·š</strong>ï¼š
                    <ul>
                        <li>æ¸©åº¦ï¼š10 K, 50 K, 100 K, 200 K, 300 K</li>
                        <li>å„æ¸©åº¦ã§å®Œå…¨ãªãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹ãƒ«ãƒ¼ãƒ—æ¸¬å®š</li>
                        <li>H$_c$(T)ã€M$_s$(T) ã®æ¸©åº¦ä¾å­˜æ€§ã‹ã‚‰ç£æ°—ç•°æ–¹æ€§ã¨Curieæ¸©åº¦ã‚’è©•ä¾¡</li>
                    </ul>
                </li>
                <li><strong>ãƒ‡ãƒ¼ã‚¿è§£æ</strong>ï¼š
                    <ul>
                        <li>M-Hæ›²ç·šï¼šãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ¸›ç®—ã€ç‰¹æ€§å€¤æŠ½å‡ºï¼ˆM$_s$ã€H$_c$ã€M$_r$ã€Sï¼‰</li>
                        <li>å¸¸ç£æ€§ã®å ´åˆï¼šLangeviné–¢æ•°ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚° â†’ ç²’å­ã‚µã‚¤ã‚ºæ¨å®š</li>
                        <li>å¼·ç£æ€§ã®å ´åˆï¼šç£æ°—ç•°æ–¹æ€§å®šæ•° K è¨ˆç®—ã€Curieæ¸©åº¦æ¨å®š</li>
                        <li>FC/ZFCè§£æï¼šT$_B$ æ±ºå®šã€NÃ©elç·©å’Œæ™‚é–“ Ï„ ã®æ¨å®š</li>
                    </ul>
                </li>
            </ol>
            <p><strong>æœŸå¾…ã•ã‚Œã‚‹çµæœ</strong>ï¼š</p>
            <ul>
                <li><strong>è¶…å¸¸ç£æ€§ãƒŠãƒç²’å­</strong>ï¼šH$_c$ â‰ˆ 0ï¼ˆå®¤æ¸©ï¼‰ã€ZFCãƒ”ãƒ¼ã‚¯æœ‰ã‚Šã€T$_B$ < 300 K</li>
                <li><strong>å¼·ç£æ€§ãƒŠãƒç²’å­</strong>ï¼šH$_c$ > 100 Oeã€è§’å½¢æ€§ã‚ã‚Šã€T$_B$ > 300 K</li>
                <li><strong>å¸¸ç£æ€§ãƒŠãƒç²’å­</strong>ï¼šç·šå½¢M-Hã€ãƒ’ã‚¹ãƒ†ãƒªã‚·ã‚¹ãªã—</li>
            </ul>
        </details>

        <h2>3.9 å­¦ç¿’ã®ç¢ºèª</h2>
        <p>ä»¥ä¸‹ã®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã§ç†è§£åº¦ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>

        <h3>åŸºæœ¬ç†è§£</h3>
        <ul>
            <li>åç£æ€§ãƒ»å¸¸ç£æ€§ãƒ»å¼·ç£æ€§ã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹</li>
            <li>VSMã¨SQUIDã®æ¸¬å®šåŸç†ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            <li>M-Hæ›²ç·šã‹ã‚‰é£½å’Œç£åŒ–ã€ä¿ç£åŠ›ã€æ®‹ç•™ç£åŒ–ã‚’æŠ½å‡ºã§ãã‚‹</li>
            <li>Curie-Weisså‰‡ã¨Langeviné–¢æ•°ã®ç‰©ç†çš„æ„å‘³ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
            <li>FC/ZFCæ¸¬å®šã®ç›®çš„ã¨è§£é‡ˆã‚’èª¬æ˜ã§ãã‚‹</li>
        </ul>

        <h3>å®Ÿè·µã‚¹ã‚­ãƒ«</h3>
        <ul>
            <li>M-Hæ›²ç·šã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰æ¸›ç®—ãŒã§ãã‚‹</li>
            <li>Curie-Weisså‰‡ã¨Langeviné–¢æ•°ã‚’ãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°ã§ãã‚‹</li>
            <li>ç£æ°—ç•°æ–¹æ€§å®šæ•°ã‚’è¨ˆç®—ã§ãã‚‹</li>
            <li>Pythonã§å®Œå…¨ãªVSM/SQUIDãƒ‡ãƒ¼ã‚¿å‡¦ç†ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’å®Ÿè£…ã§ãã‚‹</li>
            <li>ãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°æ¸©åº¦ã‚’FC/ZFCæ›²ç·šã‹ã‚‰æŠ½å‡ºã§ãã‚‹</li>
        </ul>

        <h3>å¿œç”¨åŠ›</h3>
        <ul>
            <li>ææ–™ã®ç£æ€§ã®ç¨®é¡ã‚’åˆ¤å®šã§ãã‚‹ï¼ˆè»Ÿç£æ€§/ç¡¬ç£æ€§/è¶…å¸¸ç£æ€§ï¼‰</li>
            <li>æ¸©åº¦ä¾å­˜æ€§ã‹ã‚‰Curieæ¸©åº¦ã‚’æ¨å®šã§ãã‚‹</li>
            <li>å®Ÿé¨“è¨ˆç”»ã‚’ç«‹æ¡ˆã—ã€é©åˆ‡ãªæ¸¬å®šæ¡ä»¶ã‚’æ±ºå®šã§ãã‚‹</li>
            <li>æ¸¬å®šã®é™ç•Œï¼ˆæ„Ÿåº¦ã€ãƒã‚¤ã‚ºï¼‰ã‚’è©•ä¾¡ã—ã€å¯¾ç­–ã‚’ææ¡ˆã§ãã‚‹</li>
        </ul>

        <h2>3.10 å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Foner, S. (1959). <em>Versatile and Sensitive Vibrating-Sample Magnetometer</em>. Review of Scientific Instruments, 30(7), 548-557. - VSMã®åŸè«–æ–‡</li>
            <li>Clarke, J., & Braginski, A. I. (Eds.). (2004). <em>The SQUID Handbook</em>. Wiley-VCH. - SQUIDæŠ€è¡“ã®åŒ…æ‹¬çš„è§£èª¬</li>
            <li>Cullity, B. D., & Graham, C. D. (2009). <em>Introduction to Magnetic Materials</em> (2nd ed.). Wiley-IEEE Press. - ç£æ€§ææ–™ã®æ¨™æº–æ•™ç§‘æ›¸</li>
            <li>Jiles, D. (2015). <em>Introduction to Magnetism and Magnetic Materials</em> (3rd ed.). CRC Press. - ç£æ€§ç‰©ç†å­¦ã®è©³ç´°</li>
            <li>NÃ©el, L. (1949). <em>ThÃ©orie du traÃ®nage magnÃ©tique des ferromagnÃ©tiques en grains fins avec applications aux terres cuites</em>. Annales de GÃ©ophysique, 5, 99-136. - è¶…å¸¸ç£æ€§ç†è«–ã®åŸè«–æ–‡</li>
            <li>Stoner, E. C., & Wohlfarth, E. P. (1948). <em>A Mechanism of Magnetic Hysteresis in Heterogeneous Alloys</em>. Philosophical Transactions of the Royal Society A, 240(826), 599-642. - Stoner-Wohlfarthç†è«–</li>
            <li>Quantum Design. <em>PPMS DynaCool User's Manual</em>. - PPMSæ¸¬å®šæŠ€è¡“ã®å®Ÿè·µçš„ã‚¬ã‚¤ãƒ‰</li>
        </ol>

        <h2>3.11 æ¬¡ç« ã¸</h2>
        <p>æ¬¡ç« ã§ã¯ã€<strong>Pythonã«ã‚ˆã‚‹é›»ç£æ°—ãƒ‡ãƒ¼ã‚¿è§£æã®å®Ÿè·µãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼</strong>ã‚’å­¦ã³ã¾ã™ã€‚å®Ÿéš›ã®æ¸¬å®šè£…ç½®ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã€å‰å‡¦ç†ã€é«˜åº¦ãªãƒ•ã‚£ãƒƒãƒ†ã‚£ãƒ³ã‚°æŠ€è¡“ã€æ©Ÿæ¢°å­¦ç¿’ã‚’ç”¨ã„ãŸç•°å¸¸æ¤œå‡ºã€ãƒ¬ãƒãƒ¼ãƒˆè‡ªå‹•ç”Ÿæˆã¾ã§ã®çµ±åˆçš„ãªãƒ‡ãƒ¼ã‚¿è§£æãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚</p>

        <div class="navigation">
            <a href="chapter-2.html" class="nav-button">â† ç¬¬2ç« ï¼šHallåŠ¹æœæ¸¬å®š</a>
            <a href="index.html" class="nav-button">ç›®æ¬¡ã«æˆ»ã‚‹</a>
            <a href="chapter-4.html" class="nav-button">ç¬¬4ç« ï¼šå®Ÿè·µãƒ‡ãƒ¼ã‚¿è§£æ â†’</a>
        </div>
    </main>

    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€ï¼ˆæ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©ï¼‰ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿ï¼ˆAS ISï¼‰ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶ï¼ˆä¾‹: CC BY 4.0ï¼‰ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: MS Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-28</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
