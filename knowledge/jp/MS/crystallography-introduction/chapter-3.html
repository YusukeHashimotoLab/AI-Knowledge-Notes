<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬3ç« ï¼šãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¨çµæ™¶é¢ãƒ»æ–¹å‘ - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-size: 0.9rem;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        .info-box {
            background-color: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .info-box h3,
        .info-box h4 {
            color: #1976d2;
            margin-top: 0;
        }

        .warning-box {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .warning-box h3,
        .warning-box h4 {
            color: #f57c00;
            margin-top: 0;
        }

        .success-box {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .success-box h3,
        .success-box h4 {
            color: #388e3c;
            margin-top: 0;
        }

        .example-box {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
        }

        .example-box h4 {
            color: var(--color-primary);
            margin-top: 0;
            margin-bottom: var(--spacing-sm);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            overflow-x: auto;
            display: block;
        }

        thead {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        tbody {
            display: table;
            width: 100%;
            table-layout: fixed;
        }

        th, td {
            padding: var(--spacing-sm);
            text-align: left;
            border-bottom: 1px solid var(--color-border);
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        tr:hover {
            background-color: var(--color-bg-alt);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #f093fb15 0%, #f5576c15 100%);
            border-radius: var(--border-radius);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-xl);
            border: 2px solid var(--color-accent);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .breadcrumb {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .breadcrumb a {
            color: var(--color-link);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-xl);
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
            gap: var(--spacing-md);
        }

        .nav-button {
            display: inline-flex;
            align-items: center;
            padding: var(--spacing-sm) var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-decoration: none;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: 500;
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(240, 147, 251, 0.4);
            text-decoration: none;
        }

        .nav-button.prev::before {
            content: "â† ";
            margin-right: 0.5rem;
        }

        .nav-button.next::after {
            content: " â†’";
            margin-left: 0.5rem;
        }

        .exercise {
            background-color: #fce4ec;
            border-left: 4px solid #e91e63;
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .exercise h3,
        .exercise h4 {
            color: #c2185b;
            margin-top: 0;
        }

        .mermaid {
            background-color: white;
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-md);
            text-align: center;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            .nav-button {
                width: 100%;
                justify-content: center;
            }

            table {
                font-size: 0.9rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }

        .mjx-chtml {
            font-size: 1.1em !important;
        }

        .formula-block {
            background-color: var(--color-bg-alt);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            margin: var(--spacing-md) 0;
            text-align: center;
            overflow-x: auto;
        }
    </style>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MS/crystallography-introduction/chapter-3.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<header>
        <div class="header-content">
            <h1>ç¬¬3ç« ï¼šãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¨çµæ™¶é¢ãƒ»æ–¹å‘</h1>
            <p class="subtitle">çµæ™¶æ§‹é€ ã‚’è¨˜è¿°ã™ã‚‹æ™®éçš„ãªè¨˜æ³•ã‚’å­¦ã¶</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– æ¨å®šå­¦ç¿’æ™‚é–“: 28åˆ†</span>
                <span class="meta-item">ğŸ¯ é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 8å€‹</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">çµæ™¶å­¦å…¥é–€</a> &gt;
        ç¬¬3ç« 
    </div>

    <div class="container">
        <div class="learning-objectives">
            <h2>å­¦ç¿’ç›®æ¨™</h2>
            <p>ã“ã®ç« ã‚’å­¦ã¶ã“ã¨ã§ã€ä»¥ä¸‹ã®çŸ¥è­˜ã¨ã‚¹ã‚­ãƒ«ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
            <ul>
                <li><strong>ãƒŸãƒ©ãƒ¼æŒ‡æ•° (hkl) ã®å®šç¾©</strong>ã‚’ç†è§£ã—ã€çµæ™¶é¢ã‚’æ­£ç¢ºã«è¡¨è¨˜ã§ãã‚‹</li>
                <li><strong>çµæ™¶æ–¹å‘ [uvw] ã®è¡¨è¨˜æ³•</strong>ã‚’ç†è§£ã—ã€çµæ™¶å†…ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’è¨˜è¿°ã§ãã‚‹</li>
                <li><strong>é¢é–“éš” d<sub>hkl</sub> ã®è¨ˆç®—</strong>ã‚’å„çµæ™¶ç³»ã§å®Ÿè¡Œã§ãã‚‹</li>
                <li><strong>å¯¾ç§°æ€§ã«ã‚ˆã‚‹ç­‰ä¾¡ãªé¢ãƒ»æ–¹å‘</strong>ã‚’è­˜åˆ¥ã§ãã‚‹</li>
                <li><strong>å®Ÿææ–™ã§ã®å¿œç”¨ä¾‹</strong>ã‚’é€šã˜ã¦å®Ÿè·µçš„ç†è§£ã‚’æ·±ã‚ã‚‹</li>
            </ul>
        </div>

        <h2>1. ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¨ã¯ä½•ã‹</h2>

        <p>
            çµæ™¶å­¦ã«ãŠã„ã¦ã€<strong>ãƒŸãƒ©ãƒ¼æŒ‡æ•°ï¼ˆMiller indicesï¼‰</strong>ã¯çµæ™¶å†…ã®<strong>é¢ã‚„æ–¹å‘ã‚’è¡¨ã™æ¨™æº–çš„ãªè¨˜æ³•</strong>ã§ã™ã€‚
            1839å¹´ã«ã‚¤ã‚®ãƒªã‚¹ã®é‰±ç‰©å­¦è€…ã‚¦ã‚£ãƒªã‚¢ãƒ ãƒ»ãƒãƒ­ã‚¦ã‚ºãƒ»ãƒŸãƒ©ãƒ¼ï¼ˆWilliam Hallowes Millerï¼‰ã«ã‚ˆã£ã¦ææ¡ˆã•ã‚Œã¾ã—ãŸã€‚
        </p>

        <h3>1.1 ãªãœãƒŸãƒ©ãƒ¼æŒ‡æ•°ãŒå¿…è¦ã‹</h3>

        <p>çµæ™¶ä¸­ã«ã¯ç„¡é™ã®å¹³é¢ã¨æ–¹å‘ãŒå­˜åœ¨ã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã‚’ä¸€æ„ã«ã€ã‹ã¤ç°¡æ½”ã«è¡¨ç¾ã™ã‚‹æ–¹æ³•ãŒå¿…è¦ã§ã™ï¼š</p>

        <ul>
            <li><strong>æ™®éæ€§</strong>ï¼šã©ã®çµæ™¶ç³»ã§ã‚‚å…±é€šã®è¨˜æ³•ã§æ‰±ãˆã‚‹</li>
            <li><strong>ç°¡æ½”æ€§</strong>ï¼š3ã¤ã®æ•´æ•° (h, k, l) ã§é¢ã‚’æŒ‡å®šã§ãã‚‹</li>
            <li><strong>å¯¾ç§°æ€§ã®è¡¨ç¾</strong>ï¼šçµæ™¶ã®å¯¾ç§°æ€§ã‚’åæ˜ ã—ãŸç­‰ä¾¡ãªé¢ã‚’è­˜åˆ¥ã§ãã‚‹</li>
            <li><strong>Xç·šå›æŠ˜ã¨ã®å¯¾å¿œ</strong>ï¼šå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ”ãƒ¼ã‚¯ã¨ç›´æ¥å¯¾å¿œã™ã‚‹</li>
        </ul>

        <div class="info-box">
            <h4>è¨˜æ³•ã®ç´„æŸ</h4>
            <ul>
                <li><strong>(hkl)</strong>ï¼šç‰¹å®šã®1ã¤ã®çµæ™¶é¢ã‚’è¡¨ã™</li>
                <li><strong>{hkl}</strong>ï¼šå¯¾ç§°æ€§ã«ã‚ˆã‚Šç­‰ä¾¡ãªã™ã¹ã¦ã®é¢ã®é›†åˆ</li>
                <li><strong>[uvw]</strong>ï¼šç‰¹å®šã®1ã¤ã®çµæ™¶æ–¹å‘ã‚’è¡¨ã™</li>
                <li><strong>&lt;uvw&gt;</strong>ï¼šå¯¾ç§°æ€§ã«ã‚ˆã‚Šç­‰ä¾¡ãªã™ã¹ã¦ã®æ–¹å‘ã®é›†åˆ</li>
                <li><strong>è² ã®å€¤</strong>ï¼šæ•°å­—ã®ä¸Šã«ãƒãƒ¼ã‚’å¼•ãï¼ˆä¾‹ï¼š\(\bar{1}\) ã¯ -1ï¼‰</li>
            </ul>
        </div>

        <h3>1.2 ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®å®šç¾©</h3>

        <p>ãƒŸãƒ©ãƒ¼æŒ‡æ•° (hkl) ã¯ä»¥ä¸‹ã®æ‰‹é †ã§æ±‚ã‚ã‚‰ã‚Œã¾ã™ï¼š</p>

        <div class="mermaid">
            flowchart TD
                A[çµæ™¶é¢ã¨3ã¤ã®çµæ™¶è»¸ã®äº¤ç‚¹ã‚’æ±‚ã‚ã‚‹] --> B[å„è»¸ã§ã®åˆ‡ç‰‡ã‚’æ ¼å­å®šæ•°ã§å‰²ã‚‹]
                B --> C[å„å€¤ã®é€†æ•°ã‚’ã¨ã‚‹]
                C --> D[æœ€å°å…¬å€æ•°ã‚’æ›ã‘ã¦æ•´æ•°åŒ–]
                D --> E[ãƒŸãƒ©ãƒ¼æŒ‡æ•° hkl ã‚’å¾—ã‚‹]

                style A fill:#e3f2fd
                style B fill:#e3f2fd
                style C fill:#fff3e0
                style D fill:#fff3e0
                style E fill:#e8f5e9
        </div>

        <div class="example-box">
            <h4>ä¾‹ï¼š(111)é¢ã®æ±‚ã‚æ–¹</h4>
            <ol>
                <li><strong>åˆ‡ç‰‡</strong>ï¼šaè»¸ã€bè»¸ã€cè»¸ã™ã¹ã¦ã§åˆ‡ç‰‡ãŒ1æ ¼å­å®šæ•°</li>
                <li><strong>æ ¼å­å®šæ•°ã§å‰²ã‚‹</strong>ï¼š1/a, 1/b, 1/c = 1, 1, 1</li>
                <li><strong>é€†æ•°</strong>ï¼š1/1, 1/1, 1/1 = 1, 1, 1</li>
                <li><strong>æ•´æ•°åŒ–</strong>ï¼šã™ã§ã«æ•´æ•°ãªã®ã§ãã®ã¾ã¾</li>
                <li><strong>çµæœ</strong>ï¼šãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¯ <strong>(111)</strong></li>
            </ol>
        </div>

        <div class="example-box">
            <h4>ä¾‹ï¼š(200)é¢ã®æ±‚ã‚æ–¹</h4>
            <ol>
                <li><strong>åˆ‡ç‰‡</strong>ï¼šaè»¸ã§1/2ã€bè»¸ã¨cè»¸ã§ç„¡é™é ï¼ˆå¹³è¡Œï¼‰</li>
                <li><strong>æ ¼å­å®šæ•°ã§å‰²ã‚‹</strong>ï¼š1/2, âˆ, âˆ</li>
                <li><strong>é€†æ•°</strong>ï¼š2, 0, 0</li>
                <li><strong>çµæœ</strong>ï¼šãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¯ <strong>(200)</strong></li>
            </ol>
            <p>ã“ã‚Œã¯(100)é¢ã®2å€ã®å¯†åº¦ã§ä¸¦ã¶å¹³é¢ã§ã‚ã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚</p>
        </div>

        <h2>2. Pythonã§ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã‚’è¨ˆç®—ã™ã‚‹</h2>

        <h3>2.1 åˆ‡ç‰‡ã‹ã‚‰ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã‚’æ±‚ã‚ã‚‹</h3>

        <div class="example-box">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1ï¼šãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®è¨ˆç®—</h4>
            <p>çµæ™¶è»¸ã¨ã®åˆ‡ç‰‡ã‹ã‚‰ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã‚’è‡ªå‹•è¨ˆç®—ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼š</p>
        </div>

        <pre class="line-numbers"><code class="language-python">import numpy as np
from fractions import Fraction

def calculate_miller_indices(intercepts):
    """
    åˆ‡ç‰‡ã‹ã‚‰ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã‚’è¨ˆç®—ã™ã‚‹

    Parameters:
    -----------
    intercepts : tuple of float
        (aè»¸åˆ‡ç‰‡, bè»¸åˆ‡ç‰‡, cè»¸åˆ‡ç‰‡)
        ç„¡é™å¤§ã®å ´åˆã¯ np.inf ã‚’ä½¿ç”¨

    Returns:
    --------
    tuple : ãƒŸãƒ©ãƒ¼æŒ‡æ•° (h, k, l)
    """
    # é€†æ•°ã‚’è¨ˆç®—ï¼ˆç„¡é™å¤§ã®é€†æ•°ã¯0ï¼‰
    reciprocals = []
    for intercept in intercepts:
        if np.isinf(intercept):
            reciprocals.append(0)
        else:
            reciprocals.append(1 / intercept)

    # åˆ†æ•°ã¨ã—ã¦æ‰±ã„ã€æœ€å°å…¬å€æ•°ã‚’è¦‹ã¤ã‘ã‚‹
    fractions = [Fraction(r).limit_denominator(100) for r in reciprocals]

    # åˆ†æ¯ã®æœ€å°å…¬å€æ•°ã‚’è¨ˆç®—
    denominators = [f.denominator for f in fractions]
    lcm = np.lcm.reduce(denominators)

    # æ•´æ•°åŒ–
    h, k, l = [int(f * lcm) for f in fractions]

    # æœ€å¤§å…¬ç´„æ•°ã§ç°¡ç´„åŒ–
    gcd = np.gcd.reduce([abs(h), abs(k), abs(l)])
    if gcd > 0:
        h, k, l = h // gcd, k // gcd, l // gcd

    return (h, k, l)

# ãƒ†ã‚¹ãƒˆä¾‹
print("=== ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®è¨ˆç®— ===\n")

# (111)é¢ï¼šã™ã¹ã¦ã®è»¸ã§åˆ‡ç‰‡ãŒ1
intercepts_111 = (1, 1, 1)
hkl = calculate_miller_indices(intercepts_111)
print(f"åˆ‡ç‰‡ {intercepts_111} â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° {hkl}")

# (100)é¢ï¼šaè»¸ã®ã¿ã§åˆ‡ç‰‡ã€ä»–ã¯å¹³è¡Œ
intercepts_100 = (1, np.inf, np.inf)
hkl = calculate_miller_indices(intercepts_100)
print(f"åˆ‡ç‰‡ {intercepts_100} â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° {hkl}")

# (110)é¢ï¼šaè»¸ã¨bè»¸ã§åˆ‡ç‰‡ã€cè»¸ã«å¹³è¡Œ
intercepts_110 = (1, 1, np.inf)
hkl = calculate_miller_indices(intercepts_110)
print(f"åˆ‡ç‰‡ {intercepts_110} â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° {hkl}")

# (210)é¢ï¼šaè»¸ã§1/2ã€bè»¸ã§1ã®åˆ‡ç‰‡
intercepts_210 = (0.5, 1, np.inf)
hkl = calculate_miller_indices(intercepts_210)
print(f"åˆ‡ç‰‡ {intercepts_210} â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° {hkl}")

# (123)é¢ï¼šç•°ãªã‚‹åˆ‡ç‰‡
intercepts_123 = (1, 0.5, 0.333333)
hkl = calculate_miller_indices(intercepts_123)
print(f"åˆ‡ç‰‡ {intercepts_123} â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° {hkl}")
</code></pre>

        <div class="success-box">
            <h4>å®Ÿè¡Œçµæœ</h4>
            <pre><code>=== ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®è¨ˆç®— ===

åˆ‡ç‰‡ (1, 1, 1) â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° (1, 1, 1)
åˆ‡ç‰‡ (1, inf, inf) â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° (1, 0, 0)
åˆ‡ç‰‡ (1, 1, inf) â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° (1, 1, 0)
åˆ‡ç‰‡ (0.5, 1, inf) â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° (2, 1, 0)
åˆ‡ç‰‡ (1, 0.5, 0.333333) â†’ ãƒŸãƒ©ãƒ¼æŒ‡æ•° (1, 2, 3)</code></pre>
        </div>

        <h3>2.2 ä¸»è¦ãªä½æŒ‡æ•°é¢ã®å¯è¦–åŒ–</h3>

        <div class="example-box">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2ï¼šç«‹æ–¹æ™¶ã®ä¸»è¦é¢ã‚’3Dè¡¨ç¤º</h4>
            <p>ä»£è¡¨çš„ãªçµæ™¶é¢ã‚’å¯è¦–åŒ–ã—ã¦ã€ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®æ„å‘³ã‚’ç†è§£ã—ã¾ã™ï¼š</p>
        </div>

        <pre class="line-numbers"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from mpl_toolkits.mplot3d.art3d import Poly3DCollection

def plot_lattice_plane(hkl, ax, color='cyan', alpha=0.6):
    """
    ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã§æŒ‡å®šã•ã‚ŒãŸçµæ™¶é¢ã‚’æç”»

    Parameters:
    -----------
    hkl : tuple
        ãƒŸãƒ©ãƒ¼æŒ‡æ•° (h, k, l)
    ax : Axes3D
        matplotlib ã®3Dè»¸
    color : str
        é¢ã®è‰²
    alpha : float
        é€æ˜åº¦
    """
    h, k, l = hkl

    # åˆ‡ç‰‡ã‚’è¨ˆç®—ï¼ˆ0ã®å ´åˆã¯å¤§ããªå€¤ã«è¨­å®šï¼‰
    intercepts = []
    for index in [h, k, l]:
        if index == 0:
            intercepts.append(10)  # ç„¡é™å¤§ã®ä»£ã‚ã‚Šã«å¤§ããªå€¤
        else:
            intercepts.append(1 / index)

    # é¢ã‚’æ§‹æˆã™ã‚‹é ‚ç‚¹ã‚’è¨ˆç®—
    vertices = []

    # ã‚±ãƒ¼ã‚¹ã”ã¨ã«é ‚ç‚¹ã‚’è¨­å®š
    if h != 0 and k != 0 and l != 0:
        # (111)ã‚¿ã‚¤ãƒ—ï¼š3ã¤ã®åˆ‡ç‰‡ã‚’æŒã¤
        vertices = [
            [intercepts[0], 0, 0],
            [0, intercepts[1], 0],
            [0, 0, intercepts[2]]
        ]
    elif h != 0 and k != 0 and l == 0:
        # (110)ã‚¿ã‚¤ãƒ—ï¼š2ã¤ã®åˆ‡ç‰‡ã€cè»¸ã«å¹³è¡Œ
        vertices = [
            [intercepts[0], 0, 0],
            [intercepts[0], 0, 2],
            [0, intercepts[1], 2],
            [0, intercepts[1], 0]
        ]
    elif h != 0 and k == 0 and l == 0:
        # (100)ã‚¿ã‚¤ãƒ—ï¼š1ã¤ã®åˆ‡ç‰‡ã€ä»–ã®è»¸ã«å¹³è¡Œ
        vertices = [
            [intercepts[0], 0, 0],
            [intercepts[0], 2, 0],
            [intercepts[0], 2, 2],
            [intercepts[0], 0, 2]
        ]

    # é¢ã‚’æç”»
    if len(vertices) > 0:
        poly = Poly3DCollection([vertices], alpha=alpha, facecolor=color, edgecolor='black', linewidth=2)
        ax.add_collection3d(poly)

def plot_crystal_axes():
    """ç«‹æ–¹æ™¶ã®çµæ™¶è»¸ã¨ä¸»è¦é¢ã‚’è¡¨ç¤º"""
    fig = plt.figure(figsize=(15, 5))

    planes = [
        ((1, 0, 0), 'cyan', '(100)é¢'),
        ((1, 1, 0), 'yellow', '(110)é¢'),
        ((1, 1, 1), 'magenta', '(111)é¢')
    ]

    for idx, (hkl, color, title) in enumerate(planes):
        ax = fig.add_subplot(1, 3, idx + 1, projection='3d')

        # çµæ™¶è»¸ã‚’æç”»
        ax.quiver(0, 0, 0, 1.5, 0, 0, color='red', arrow_length_ratio=0.1, linewidth=2, label='aè»¸')
        ax.quiver(0, 0, 0, 0, 1.5, 0, color='green', arrow_length_ratio=0.1, linewidth=2, label='bè»¸')
        ax.quiver(0, 0, 0, 0, 0, 1.5, color='blue', arrow_length_ratio=0.1, linewidth=2, label='cè»¸')

        # çµæ™¶é¢ã‚’æç”»
        plot_lattice_plane(hkl, ax, color=color, alpha=0.6)

        # è»¸ãƒ©ãƒ™ãƒ«
        ax.set_xlabel('a', fontsize=12, fontweight='bold')
        ax.set_ylabel('b', fontsize=12, fontweight='bold')
        ax.set_zlabel('c', fontsize=12, fontweight='bold')

        ax.set_xlim([0, 1.5])
        ax.set_ylim([0, 1.5])
        ax.set_zlim([0, 1.5])

        ax.set_title(title, fontsize=14, fontweight='bold')
        ax.legend(loc='upper left', fontsize=8)

        # ã‚°ãƒªãƒƒãƒ‰ã‚’è¿½åŠ 
        ax.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('miller_indices_planes.png', dpi=150, bbox_inches='tight')
    plt.show()
    print("ä¸»è¦ãªçµæ™¶é¢ã®å¯è¦–åŒ–ã‚’ä¿å­˜ã—ã¾ã—ãŸ: miller_indices_planes.png")

# å®Ÿè¡Œ
plot_crystal_axes()
</code></pre>

        <h2>3. é¢é–“éš” d<sub>hkl</sub> ã®è¨ˆç®—</h2>

        <p>
            ãƒŸãƒ©ãƒ¼æŒ‡æ•° (hkl) ã§æŒ‡å®šã•ã‚Œã‚‹çµæ™¶é¢ã®<strong>é¢é–“éš” d<sub>hkl</sub></strong>ã¯ã€
            Xç·šå›æŠ˜å®Ÿé¨“ã§è¦³æ¸¬ã•ã‚Œã‚‹ãƒ–ãƒ©ãƒƒã‚°ãƒ”ãƒ¼ã‚¯ã®ä½ç½®ã‚’æ±ºå®šã™ã‚‹é‡è¦ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§ã™ã€‚
        </p>

        <h3>3.1 ç«‹æ–¹æ™¶ç³»ã§ã®é¢é–“éš”</h3>

        <p>ç«‹æ–¹æ™¶ï¼ˆa = b = cã€Î± = Î² = Î³ = 90Â°ï¼‰ã§ã¯ã€é¢é–“éš”ã¯éå¸¸ã«ç°¡æ½”ãªå¼ã§è¡¨ã•ã‚Œã¾ã™ï¼š</p>

        <div class="formula-block">
            $$
            d_{hkl} = \frac{a}{\sqrt{h^2 + k^2 + l^2}}
            $$
        </div>

        <p>ã“ã“ã§ã€aã¯æ ¼å­å®šæ•°ã€h, k, lã¯ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã§ã™ã€‚</p>

        <div class="example-box">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3ï¼šç«‹æ–¹æ™¶ã®é¢é–“éš”è¨ˆç®—</h4>
        </div>

        <pre class="line-numbers"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def cubic_d_spacing(a, h, k, l):
    """
    ç«‹æ–¹æ™¶ç³»ã®é¢é–“éš”ã‚’è¨ˆç®—

    Parameters:
    -----------
    a : float
        æ ¼å­å®šæ•° (Ã…)
    h, k, l : int
        ãƒŸãƒ©ãƒ¼æŒ‡æ•°

    Returns:
    --------
    float : é¢é–“éš” d_hkl (Ã…)
    """
    return a / np.sqrt(h**2 + k**2 + l**2)

# ã‚·ãƒªã‚³ãƒ³ï¼ˆç«‹æ–¹æ™¶ã€a = 5.431 Ã…ï¼‰ã§ã®è¨ˆç®—
a_Si = 5.431

print("=== ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰ã®é¢é–“éš” ===")
print(f"æ ¼å­å®šæ•° a = {a_Si} Ã…\n")

# ä¸»è¦ãªé¢ã®é¢é–“éš”ã‚’è¨ˆç®—
planes = [
    (1, 0, 0), (1, 1, 0), (1, 1, 1),
    (2, 0, 0), (2, 2, 0), (3, 1, 1),
    (2, 2, 2), (4, 0, 0), (3, 3, 1)
]

results = []
for hkl in planes:
    h, k, l = hkl
    d = cubic_d_spacing(a_Si, h, k, l)
    results.append((hkl, d))
    print(f"({h}{k}{l})é¢: d = {d:.4f} Ã…")

# ã‚°ãƒ©ãƒ•ã§å¯è¦–åŒ–
fig, ax = plt.subplots(figsize=(12, 6))

hkl_labels = [f"({h}{k}{l})" for (h, k, l), d in results]
d_values = [d for hkl, d in results]

bars = ax.bar(range(len(results)), d_values, color='skyblue', edgecolor='navy', linewidth=1.5)
ax.set_xticks(range(len(results)))
ax.set_xticklabels(hkl_labels, rotation=45, ha='right')
ax.set_ylabel('é¢é–“éš” d (Ã…)', fontsize=12, fontweight='bold')
ax.set_xlabel('ãƒŸãƒ©ãƒ¼æŒ‡æ•°', fontsize=12, fontweight='bold')
ax.set_title('ã‚·ãƒªã‚³ãƒ³ï¼ˆSiï¼‰ã®çµæ™¶é¢ã”ã¨ã®é¢é–“éš”', fontsize=14, fontweight='bold')
ax.grid(axis='y', alpha=0.3)

# å€¤ã‚’ãƒãƒ¼ã®ä¸Šã«è¡¨ç¤º
for i, (bar, d) in enumerate(zip(bars, d_values)):
    ax.text(bar.get_x() + bar.get_width()/2, bar.get_height() + 0.05,
            f'{d:.3f}', ha='center', va='bottom', fontsize=9)

plt.tight_layout()
plt.savefig('si_d_spacing.png', dpi=150, bbox_inches='tight')
plt.show()
print("\nã‚°ãƒ©ãƒ•ã‚’ä¿å­˜ã—ã¾ã—ãŸ: si_d_spacing.png")
</code></pre>

        <h3>3.2 æ­£æ–¹æ™¶ç³»ã§ã®é¢é–“éš”</h3>

        <p>æ­£æ–¹æ™¶ï¼ˆa = b â‰  cã€Î± = Î² = Î³ = 90Â°ï¼‰ã§ã¯ã€cè»¸æ–¹å‘ã®æ ¼å­å®šæ•°ãŒç•°ãªã‚‹ãŸã‚å¼ãŒå¤‰ã‚ã‚Šã¾ã™ï¼š</p>

        <div class="formula-block">
            $$
            d_{hkl} = \frac{1}{\sqrt{\frac{h^2 + k^2}{a^2} + \frac{l^2}{c^2}}}
            $$
        </div>

        <div class="example-box">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹4ï¼šæ­£æ–¹æ™¶ã®é¢é–“éš”è¨ˆç®—</h4>
        </div>

        <pre class="line-numbers"><code class="language-python">def tetragonal_d_spacing(a, c, h, k, l):
    """
    æ­£æ–¹æ™¶ç³»ã®é¢é–“éš”ã‚’è¨ˆç®—

    Parameters:
    -----------
    a : float
        aè»¸ï¼ˆ= bè»¸ï¼‰ã®æ ¼å­å®šæ•° (Ã…)
    c : float
        cè»¸ã®æ ¼å­å®šæ•° (Ã…)
    h, k, l : int
        ãƒŸãƒ©ãƒ¼æŒ‡æ•°

    Returns:
    --------
    float : é¢é–“éš” d_hkl (Ã…)
    """
    return 1 / np.sqrt((h**2 + k**2) / a**2 + l**2 / c**2)

# TiO2 ãƒ«ãƒãƒ«ï¼ˆæ­£æ–¹æ™¶ã€a = 4.594 Ã…, c = 2.958 Ã…ï¼‰
a_TiO2 = 4.594
c_TiO2 = 2.958

print("=== TiO2ï¼ˆãƒ«ãƒãƒ«ï¼‰ã®é¢é–“éš” ===")
print(f"æ ¼å­å®šæ•° a = {a_TiO2} Ã…, c = {c_TiO2} Ã…")
print(f"c/a æ¯” = {c_TiO2/a_TiO2:.3f}\n")

planes_tetragonal = [
    (1, 0, 0), (0, 0, 1), (1, 1, 0),
    (1, 0, 1), (1, 1, 1), (2, 0, 0),
    (2, 1, 0), (2, 1, 1), (2, 2, 0)
]

# æ¯”è¼ƒï¼šç«‹æ–¹æ™¶ã¨ä»®å®šã—ãŸå ´åˆï¼ˆèª¤ã£ãŸè¨ˆç®—ï¼‰
print("æ­£æ–¹æ™¶ã¨ã—ã¦æ­£ã—ãè¨ˆç®—ã—ãŸå ´åˆ vs ç«‹æ–¹æ™¶ã¨èª¤ã£ã¦ä»®å®šã—ãŸå ´åˆ:\n")
for hkl in planes_tetragonal[:5]:
    h, k, l = hkl
    d_correct = tetragonal_d_spacing(a_TiO2, c_TiO2, h, k, l)
    d_wrong = cubic_d_spacing(a_TiO2, h, k, l)  # èª¤ã£ãŸä»®å®š
    error = abs(d_correct - d_wrong) / d_correct * 100

    print(f"({h}{k}{l})é¢:")
    print(f"  æ­£ã—ã„ d = {d_correct:.4f} Ã…")
    print(f"  èª¤ã£ãŸ d = {d_wrong:.4f} Ã… (èª¤å·®: {error:.2f}%)\n")
</code></pre>

        <div class="warning-box">
            <h4>é‡è¦ãªæ³¨æ„ç‚¹</h4>
            <p>
                çµæ™¶ç³»ã‚’èª¤ã£ã¦ä»®å®šã™ã‚‹ã¨ã€é¢é–“éš”ã®è¨ˆç®—ãŒå¤§ããé–“é•ã„ã¾ã™ã€‚
                ç‰¹ã«cè»¸ãŒå¤§ããç•°ãªã‚‹æ­£æ–¹æ™¶ã‚’ç«‹æ–¹æ™¶ã¨æ‰±ã†ã¨ã€(001)é¢ãªã©ã®cè»¸ã«é–¢ã‚ã‚‹é¢ã§é¡•è‘—ãªèª¤å·®ãŒç”Ÿã˜ã¾ã™ã€‚
            </p>
        </div>

        <h3>3.3 å…­æ–¹æ™¶ç³»ã§ã®é¢é–“éš”</h3>

        <p>
            å…­æ–¹æ™¶ï¼ˆa = b â‰  cã€Î± = Î² = 90Â°ã€Î³ = 120Â°ï¼‰ã¯ã€ã—ã°ã—ã°<strong>4è»¸æŒ‡æ•° (hkil)</strong>ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
            ã“ã“ã§ã€i = -(h+k) ã¨ã„ã†é–¢ä¿‚ãŒã‚ã‚Šã¾ã™ã€‚
        </p>

        <div class="formula-block">
            $$
            d_{hkl} = \frac{1}{\sqrt{\frac{4}{3}\frac{h^2 + hk + k^2}{a^2} + \frac{l^2}{c^2}}}
            $$
        </div>

        <div class="example-box">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹5ï¼šå…­æ–¹æ™¶ã®é¢é–“éš”è¨ˆç®—</h4>
        </div>

        <pre class="line-numbers"><code class="language-python">def hexagonal_d_spacing(a, c, h, k, l):
    """
    å…­æ–¹æ™¶ç³»ã®é¢é–“éš”ã‚’è¨ˆç®—

    Parameters:
    -----------
    a : float
        aè»¸ï¼ˆ= bè»¸ï¼‰ã®æ ¼å­å®šæ•° (Ã…)
    c : float
        cè»¸ã®æ ¼å­å®šæ•° (Ã…)
    h, k, l : int
        ãƒŸãƒ©ãƒ¼æŒ‡æ•°ï¼ˆ3è»¸è¡¨è¨˜ï¼‰

    Returns:
    --------
    float : é¢é–“éš” d_hkl (Ã…)
    """
    return 1 / np.sqrt((4/3) * (h**2 + h*k + k**2) / a**2 + l**2 / c**2)

def miller_to_miller_bravais(h, k, l):
    """
    3è»¸ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã‚’4è»¸ãƒŸãƒ©ãƒ¼ãƒ»ãƒ–ãƒ©ãƒ™ãƒ¼æŒ‡æ•°ã«å¤‰æ›

    Parameters:
    -----------
    h, k, l : int
        3è»¸ãƒŸãƒ©ãƒ¼æŒ‡æ•°

    Returns:
    --------
    tuple : 4è»¸æŒ‡æ•° (h, k, i, l) ãŸã ã— i = -(h+k)
    """
    i = -(h + k)
    return (h, k, i, l)

# Î±-Al2O3ï¼ˆã‚³ãƒ©ãƒ³ãƒ€ãƒ ã€å…­æ–¹æ™¶ã€a = 4.759 Ã…, c = 12.991 Ã…ï¼‰
a_Al2O3 = 4.759
c_Al2O3 = 12.991

print("=== Î±-Al2O3ï¼ˆã‚³ãƒ©ãƒ³ãƒ€ãƒ ï¼‰ã®é¢é–“éš” ===")
print(f"æ ¼å­å®šæ•° a = {a_Al2O3} Ã…, c = {c_Al2O3} Ã…")
print(f"c/a æ¯” = {c_Al2O3/a_Al2O3:.3f}\n")

planes_hexagonal = [
    (1, 0, 0), (0, 0, 1), (1, 1, 0),
    (1, 0, 1), (1, 1, 2), (2, 0, 0),
    (1, 0, 4), (2, 1, 0), (0, 0, 6)
]

print(f"{'3è»¸ (hkl)':<15} {'4è»¸ (hkil)':<20} {'d (Ã…)':<10}")
print("-" * 50)

for hkl in planes_hexagonal:
    h, k, l = hkl
    d = hexagonal_d_spacing(a_Al2O3, c_Al2O3, h, k, l)
    hkil = miller_to_miller_bravais(h, k, l)

    # è² ã®å€¤ã‚’è¡¨ç¤º
    hkil_str = "("
    for idx in hkil:
        if idx < 0:
            hkil_str += f"{idx}"
        else:
            hkil_str += f"{idx}"
    hkil_str += ")"

    print(f"({h}{k}{l}){'':<12} {hkil_str:<20} {d:.4f}")
</code></pre>

        <div class="info-box">
            <h4>4è»¸æŒ‡æ•°ã®åˆ©ç‚¹</h4>
            <p>
                å…­æ–¹æ™¶ã§ã¯4è»¸æŒ‡æ•° (hkil) ã‚’ä½¿ã†ã¨ã€çµæ™¶ã®6å›å¯¾ç§°æ€§ãŒè¨˜æ³•ã«åæ˜ ã•ã‚Œã¾ã™ã€‚
                ä¾‹ãˆã°ã€{10\(\bar{1}\)0}ã¯6ã¤ã®ç­‰ä¾¡ãªé¢ã‚’è¡¨ã—ã€ã“ã‚ŒãŒ4è»¸è¡¨è¨˜ã§æ˜ç¢ºã«ãªã‚Šã¾ã™ã€‚
            </p>
        </div>

        <h2>4. ç­‰ä¾¡ãªé¢ã¨æ–¹å‘ï¼ˆå¯¾ç§°æ€§ï¼‰</h2>

        <p>
            çµæ™¶ã®å¯¾ç§°æ€§ã«ã‚ˆã‚Šã€çµæ™¶å­¦çš„ã«<strong>ç­‰ä¾¡ãªé¢ã‚„æ–¹å‘</strong>ãŒå­˜åœ¨ã—ã¾ã™ã€‚
            ã“ã‚Œã‚‰ã‚’ã¾ã¨ã‚ã¦è¡¨è¨˜ã™ã‚‹ãŸã‚ã«ã€æ³¢æ‹¬å¼§ {hkl} ã‚„å±±æ‹¬å¼§ &lt;uvw&gt; ã‚’ä½¿ã„ã¾ã™ã€‚
        </p>

        <h3>4.1 ç«‹æ–¹æ™¶ã®ç­‰ä¾¡ãªé¢</h3>

        <p>ç«‹æ–¹æ™¶ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªç­‰ä¾¡é–¢ä¿‚ãŒã‚ã‚Šã¾ã™ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>è¡¨è¨˜</th>
                    <th>æ„å‘³</th>
                    <th>ä¾‹ï¼š{100}ã®ç­‰ä¾¡ãªé¢</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>{100}</strong></td>
                    <td>ç­‰ä¾¡ãªé¢ã®é›†åˆ</td>
                    <td>(100), (010), (001), (\(\bar{1}\)00), (0\(\bar{1}\)0), (00\(\bar{1}\))</td>
                </tr>
                <tr>
                    <td><strong>{110}</strong></td>
                    <td>ç­‰ä¾¡ãªé¢ã®é›†åˆ</td>
                    <td>(110), (101), (011), (\(\bar{1}\)10), (\(\bar{1}\)0\(\bar{1}\)), ãªã©12é¢</td>
                </tr>
                <tr>
                    <td><strong>{111}</strong></td>
                    <td>ç­‰ä¾¡ãªé¢ã®é›†åˆ</td>
                    <td>(111), (\(\bar{1}\)11), (1\(\bar{1}\)1), ãªã©8é¢</td>
                </tr>
            </tbody>
        </table>

        <div class="example-box">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹6ï¼šç­‰ä¾¡ãªé¢ã®ç”Ÿæˆ</h4>
        </div>

        <pre class="line-numbers"><code class="language-python">from itertools import permutations, product

def generate_equivalent_planes(h, k, l, crystal_system='cubic'):
    """
    å¯¾ç§°æ€§ã‚’è€ƒæ…®ã—ã¦ç­‰ä¾¡ãªé¢ã‚’ã™ã¹ã¦ç”Ÿæˆ

    Parameters:
    -----------
    h, k, l : int
        åŸºæº–ã¨ãªã‚‹ãƒŸãƒ©ãƒ¼æŒ‡æ•°
    crystal_system : str
        çµæ™¶ç³» ('cubic', 'tetragonal', 'hexagonal')

    Returns:
    --------
    set : ç­‰ä¾¡ãªé¢ã®é›†åˆ
    """
    planes = set()

    if crystal_system == 'cubic':
        # ç«‹æ–¹æ™¶ï¼šç¬¦å·ã¨ç½®æ›ã®å…¨çµ„ã¿åˆã‚ã›
        for perm in permutations([abs(h), abs(k), abs(l)]):
            for signs in product([1, -1], repeat=3):
                plane = tuple(s * p for s, p in zip(signs, perm))
                if plane != (0, 0, 0):  # (000)ã¯é™¤å¤–
                    planes.add(plane)

    elif crystal_system == 'tetragonal':
        # æ­£æ–¹æ™¶ï¼ša, bè»¸ã¯ç­‰ä¾¡ã€cè»¸ã¯ç‹¬ç«‹
        # h, k ã®ç½®æ›ã¨ç¬¦å·å¤‰æ›´ã®ã¿
        for h_sign, k_sign, l_sign in product([1, -1], repeat=3):
            planes.add((h_sign * h, k_sign * k, l_sign * l))
            planes.add((k_sign * k, h_sign * h, l_sign * l))  # h, k ã®ç½®æ›

    elif crystal_system == 'hexagonal':
        # å…­æ–¹æ™¶ï¼šã‚ˆã‚Šè¤‡é›‘ãªå¯¾ç§°æ€§ï¼ˆç°¡ç•¥ç‰ˆï¼‰
        # 6å›å›è»¢å¯¾ç§°æ€§ã‚’è€ƒæ…®
        for l_sign in [1, -1]:
            planes.add((h, k, l_sign * l))
            planes.add((k, -(h+k), l_sign * l))
            planes.add((-(h+k), h, l_sign * l))

    return sorted(planes)

# ç«‹æ–¹æ™¶ã§ã®ç­‰ä¾¡ãªé¢
print("=== ç«‹æ–¹æ™¶ã®ç­‰ä¾¡ãªé¢ ===\n")

for base_plane in [(1, 0, 0), (1, 1, 0), (1, 1, 1)]:
    h, k, l = base_plane
    equiv = generate_equivalent_planes(h, k, l, 'cubic')
    print(f"{{{h}{k}{l}}} ã®ç­‰ä¾¡ãªé¢ ({len(equiv)} å€‹):")

    # è¦‹ã‚„ã™ãæ•´å½¢ã—ã¦è¡¨ç¤º
    for i in range(0, len(equiv), 6):
        planes_str = ', '.join([f"({p[0]:2}{p[1]:2}{p[2]:2})" for p in equiv[i:i+6]])
        print(f"  {planes_str}")
    print()

# æ­£æ–¹æ™¶ã§ã®ç­‰ä¾¡ãªé¢
print("=== æ­£æ–¹æ™¶ã®ç­‰ä¾¡ãªé¢ ===\n")
base_plane = (1, 1, 0)
equiv_tetra = generate_equivalent_planes(*base_plane, 'tetragonal')
print(f"{{{base_plane[0]}{base_plane[1]}{base_plane[2]}}} ã®ç­‰ä¾¡ãªé¢ï¼ˆæ­£æ–¹æ™¶ï¼‰({len(equiv_tetra)} å€‹):")
for plane in equiv_tetra:
    print(f"  ({plane[0]:2}{plane[1]:2}{plane[2]:2})")
</code></pre>

        <h3>4.2 çµæ™¶æ–¹å‘ [uvw] ã®è¡¨è¨˜</h3>

        <p>
            çµæ™¶æ–¹å‘ã¯<strong>[uvw]</strong>ã§è¡¨ã•ã‚Œã€åŸç‚¹ã‹ã‚‰åº§æ¨™ (uÂ·a, vÂ·b, wÂ·c) ã¸ã®<strong>ãƒ™ã‚¯ãƒˆãƒ«</strong>ã‚’æ„å‘³ã—ã¾ã™ã€‚
        </p>

        <ul>
            <li><strong>[100]</strong>ï¼šaè»¸æ–¹å‘</li>
            <li><strong>[110]</strong>ï¼šaè»¸ã¨bè»¸ã®å¯¾è§’ç·šæ–¹å‘</li>
            <li><strong>[111]</strong>ï¼šä½“å¯¾è§’ç·šæ–¹å‘</li>
            <li><strong>&lt;100&gt;</strong>ï¼šç­‰ä¾¡ãªæ–¹å‘ã™ã¹ã¦ï¼ˆ[100], [010], [001], ãªã©ï¼‰</li>
        </ul>

        <div class="info-box">
            <h4>é¢ã¨æ–¹å‘ã®é–¢ä¿‚</h4>
            <p>
                <strong>ç«‹æ–¹æ™¶</strong>ã§ã¯ã€(hkl)é¢ã«å‚ç›´ãªæ–¹å‘ã¯[hkl]ã«ãªã‚Šã¾ã™ã€‚
                ãŸã ã—ã€ã“ã‚Œã¯ç«‹æ–¹æ™¶ç‰¹æœ‰ã®æ€§è³ªã§ã€ä»–ã®çµæ™¶ç³»ã§ã¯ä¸€èˆ¬ã«æˆã‚Šç«‹ã¡ã¾ã›ã‚“ã€‚
            </p>
        </div>

        <div class="example-box">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹7ï¼šçµæ™¶æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«ã®å¯è¦–åŒ–</h4>
        </div>

        <pre class="line-numbers"><code class="language-python">def plot_crystal_directions():
    """ç«‹æ–¹æ™¶ã®ä¸»è¦ãªçµæ™¶æ–¹å‘ã‚’å¯è¦–åŒ–"""
    fig = plt.figure(figsize=(15, 5))

    directions = [
        ([1, 0, 0], 'red', '[100]'),
        ([1, 1, 0], 'green', '[110]'),
        ([1, 1, 1], 'blue', '[111]')
    ]

    for idx, (uvw, color, title) in enumerate(directions):
        ax = fig.add_subplot(1, 3, idx + 1, projection='3d')

        # ç«‹æ–¹ä½“ã®æ ã‚’æç”»
        r = [0, 1]
        for s, e in combinations(np.array(list(product(r, r, r))), 2):
            if np.sum(np.abs(s - e)) == 1:
                ax.plot3D(*zip(s, e), color='gray', alpha=0.3, linewidth=1)

        # æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«ã‚’æç”»
        ax.quiver(0, 0, 0, uvw[0], uvw[1], uvw[2],
                 color=color, arrow_length_ratio=0.15, linewidth=3,
                 label=f'{title} æ–¹å‘')

        # è»¸ãƒ©ãƒ™ãƒ«
        ax.set_xlabel('a', fontsize=12, fontweight='bold')
        ax.set_ylabel('b', fontsize=12, fontweight='bold')
        ax.set_zlabel('c', fontsize=12, fontweight='bold')

        ax.set_xlim([0, 1.5])
        ax.set_ylim([0, 1.5])
        ax.set_zlim([0, 1.5])

        ax.set_title(title + ' çµæ™¶æ–¹å‘', fontsize=14, fontweight='bold')
        ax.legend(loc='upper left')
        ax.grid(True, alpha=0.3)

    plt.tight_layout()
    plt.savefig('crystal_directions.png', dpi=150, bbox_inches='tight')
    plt.show()
    print("çµæ™¶æ–¹å‘ã®å¯è¦–åŒ–ã‚’ä¿å­˜ã—ã¾ã—ãŸ: crystal_directions.png")

from itertools import combinations, product

# å®Ÿè¡Œ
plot_crystal_directions()
</code></pre>

        <h2>5. å®Ÿææ–™ã§ã®å¿œç”¨</h2>

        <p>
            ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¯ææ–™ç§‘å­¦ã®ã‚ã‚‰ã‚†ã‚‹åˆ†é‡ã§ä½¿ã‚ã‚Œã¾ã™ã€‚
            ã“ã“ã§ã¯ã€å®Ÿéš›ã®ææ–™ã‚’ä¾‹ã«é¢é–“éš”ã®è¨ˆç®—ã¨å¿œç”¨ã‚’å­¦ã³ã¾ã™ã€‚
        </p>

        <h3>5.1 Xç·šå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è§£é‡ˆ</h3>

        <p>
            Xç·šå›æŠ˜ï¼ˆXRDï¼‰ã§ã¯ã€ãƒ–ãƒ©ãƒƒã‚°ã®æ³•å‰‡ã«ã‚ˆã‚Šç‰¹å®šã®è§’åº¦ã§ãƒ”ãƒ¼ã‚¯ãŒè¦³æ¸¬ã•ã‚Œã¾ã™ï¼š
        </p>

        <div class="formula-block">
            $$
            n\lambda = 2d_{hkl}\sin\theta
            $$
        </div>

        <p>
            ã“ã“ã§ã€Î»ã¯Xç·šã®æ³¢é•·ã€Î¸ã¯ãƒ–ãƒ©ãƒƒã‚°è§’ã€nã¯åå°„ã®æ¬¡æ•°ï¼ˆé€šå¸¸1ï¼‰ã§ã™ã€‚
            é¢é–“éš” d<sub>hkl</sub> ã‚’çŸ¥ã‚‹ã“ã¨ã§ã€è¦³æ¸¬ã•ã‚ŒãŸãƒ”ãƒ¼ã‚¯ãŒã©ã®çµæ™¶é¢ã‹ã‚‰ã®åå°„ã‹ã‚’ç‰¹å®šã§ãã¾ã™ã€‚
        </p>

        <div class="example-box">
            <h4>ã‚³ãƒ¼ãƒ‰ä¾‹8ï¼šå®Ÿææ–™ã§ã®XRDãƒ”ãƒ¼ã‚¯äºˆæ¸¬</h4>
        </div>

        <pre class="line-numbers"><code class="language-python">def bragg_angle(d_hkl, wavelength, n=1):
    """
    ãƒ–ãƒ©ãƒƒã‚°ã®æ³•å‰‡ã‹ã‚‰å›æŠ˜è§’ã‚’è¨ˆç®—

    Parameters:
    -----------
    d_hkl : float
        é¢é–“éš” (Ã…)
    wavelength : float
        Xç·šæ³¢é•· (Ã…)
    n : int
        åå°„ã®æ¬¡æ•°ï¼ˆé€šå¸¸1ï¼‰

    Returns:
    --------
    float : ãƒ–ãƒ©ãƒƒã‚°è§’ Î¸ (åº¦)ã€Noneã®å ´åˆã¯å›æŠ˜ä¸å¯
    """
    sin_theta = n * wavelength / (2 * d_hkl)
    if abs(sin_theta) > 1:
        return None  # å›æŠ˜æ¡ä»¶ã‚’æº€ãŸã•ãªã„
    return np.degrees(np.arcsin(sin_theta))

def predict_xrd_pattern(material_name, a, c=None, crystal_system='cubic',
                       wavelength=1.5406, max_hkl=3):
    """
    ææ–™ã®XRDå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’äºˆæ¸¬

    Parameters:
    -----------
    material_name : str
        ææ–™å
    a : float
        æ ¼å­å®šæ•° a (Ã…)
    c : float, optional
        æ ¼å­å®šæ•° c (Ã…)ï¼ˆæ­£æ–¹æ™¶ãƒ»å…­æ–¹æ™¶ã®å ´åˆï¼‰
    crystal_system : str
        çµæ™¶ç³»
    wavelength : float
        Xç·šæ³¢é•· (Ã…)ã€Cu KÎ±ç·šãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
    max_hkl : int
        è¨ˆç®—ã™ã‚‹æœ€å¤§ã®ãƒŸãƒ©ãƒ¼æŒ‡æ•°
    """
    print(f"\n=== {material_name} ã®XRDå›æŠ˜ãƒ‘ã‚¿ãƒ¼ãƒ³äºˆæ¸¬ ===")
    print(f"çµæ™¶ç³»: {crystal_system}")
    print(f"æ ¼å­å®šæ•°: a = {a:.4f} Ã…" + (f", c = {c:.4f} Ã…" if c else ""))
    print(f"Xç·šæ³¢é•·: {wavelength:.4f} Ã… (Cu KÎ±)\n")

    print(f"{'(hkl)':<10} {'d (Ã…)':<12} {'2Î¸ (åº¦)':<12} {'å¼·åº¦ç›®å®‰':<10}")
    print("-" * 55)

    results = []

    # ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®çµ„ã¿åˆã‚ã›ã‚’ç”Ÿæˆ
    for h in range(max_hkl + 1):
        for k in range(h, max_hkl + 1):
            for l in range(k, max_hkl + 1):
                if h == 0 and k == 0 and l == 0:
                    continue

                # é¢é–“éš”ã‚’è¨ˆç®—
                if crystal_system == 'cubic':
                    d = cubic_d_spacing(a, h, k, l)
                elif crystal_system == 'tetragonal':
                    d = tetragonal_d_spacing(a, c, h, k, l)
                elif crystal_system == 'hexagonal':
                    d = hexagonal_d_spacing(a, c, h, k, l)

                # ãƒ–ãƒ©ãƒƒã‚°è§’ã‚’è¨ˆç®—
                theta = bragg_angle(d, wavelength)

                if theta is not None and theta < 90:
                    # å¤šé‡åº¦ï¼ˆç­‰ä¾¡ãªé¢ã®æ•°ï¼‰ã‚’è€ƒæ…®ã—ãŸç›¸å¯¾å¼·åº¦ã®ç°¡æ˜“æ¨å®š
                    multiplicity = len(generate_equivalent_planes(h, k, l, crystal_system))
                    intensity = multiplicity / (h**2 + k**2 + l**2)  # ç°¡æ˜“çš„ãªæ§‹é€ å› å­

                    results.append(((h, k, l), d, 2 * theta, intensity))

    # 2Î¸ ã®å°ã•ã„é †ã«ã‚½ãƒ¼ãƒˆ
    results.sort(key=lambda x: x[2])

    # ä¸Šä½10ãƒ”ãƒ¼ã‚¯ã‚’è¡¨ç¤º
    for i, ((h, k, l), d, two_theta, intensity) in enumerate(results[:10]):
        # å¼·åº¦ã‚’è¦–è¦šåŒ–
        intensity_bar = 'â–ˆ' * int(intensity * 10)
        print(f"({h}{k}{l}){'':<8} {d:8.4f}    {two_theta:8.2f}    {intensity_bar}")

# å®Ÿè¡Œï¼šä»£è¡¨çš„ãªææ–™ã®XRDãƒ‘ã‚¿ãƒ¼ãƒ³äºˆæ¸¬

# 1. ã‚·ãƒªã‚³ãƒ³ï¼ˆSiã€ç«‹æ–¹æ™¶ï¼‰
predict_xrd_pattern('Silicon (Si)', a=5.4310, crystal_system='cubic', max_hkl=3)

# 2. é‡‘ï¼ˆAuã€ç«‹æ–¹æ™¶ï¼‰
predict_xrd_pattern('Gold (Au)', a=4.0782, crystal_system='cubic', max_hkl=2)

# 3. TiO2 ãƒ«ãƒãƒ«ï¼ˆæ­£æ–¹æ™¶ï¼‰
predict_xrd_pattern('TiO2 (Rutile)', a=4.594, c=2.958,
                   crystal_system='tetragonal', max_hkl=2)

# 4. Î±-Al2O3ï¼ˆå…­æ–¹æ™¶ï¼‰
predict_xrd_pattern('Î±-Al2O3 (Corundum)', a=4.759, c=12.991,
                   crystal_system='hexagonal', max_hkl=2)
</code></pre>

        <div class="success-box">
            <h4>XRDè§£æã¸ã®å¿œç”¨</h4>
            <p>
                ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯ã€å®Ÿé¨“ã§å¾—ã‚‰ã‚ŒãŸXRDãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ç†è«–è¨ˆç®—ã‚’æ¯”è¼ƒã™ã‚‹ãŸã‚ã®åŸºç¤ãƒ„ãƒ¼ãƒ«ã§ã™ã€‚
                å®Ÿéš›ã®è§£æã§ã¯ã€åŸå­ã®é…ç½®ã«ã‚ˆã‚‹æ§‹é€ å› å­ã‚„æ¸©åº¦å› å­ã‚‚è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€
                ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¨é¢é–“éš”ã®ç†è§£ã¯å…¨ã¦ã®åŸºç¤ã¨ãªã‚Šã¾ã™ã€‚
            </p>
        </div>

        <h3>5.2 ææ–™ã®ç•°æ–¹æ€§ã¨çµæ™¶é¢</h3>

        <p>
            ææ–™ã®ç‰©æ€§ã¯çµæ™¶é¢ã«ã‚ˆã‚Šå¤§ããç•°ãªã‚Šã¾ã™ã€‚ä¾‹ãˆã°ï¼š
        </p>

        <ul>
            <li><strong>è¡¨é¢ã‚¨ãƒãƒ«ã‚®ãƒ¼</strong>ï¼š{111}é¢ã¯{100}é¢ã‚ˆã‚Šã‚‚ä½ã„è¡¨é¢ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã¤ï¼ˆfccé‡‘å±ï¼‰</li>
            <li><strong>æˆé•·é€Ÿåº¦</strong>ï¼šç‰¹å®šã®é¢ãŒå„ªå…ˆçš„ã«æˆé•·ã—ã€çµæ™¶å½¢çŠ¶ã‚’æ±ºå®š</li>
            <li><strong>è§¦åª’æ´»æ€§</strong>ï¼šç‰¹å®šã®é¢ãŒé«˜ã„åå¿œæ€§ã‚’ç¤ºã™</li>
            <li><strong>æ©Ÿæ¢°çš„æ€§è³ª</strong>ï¼šã™ã¹ã‚Šç³»ã¯ç‰¹å®šã®é¢ã¨æ–¹å‘ã®çµ„ã¿åˆã‚ã›ã§æ±ºã¾ã‚‹</li>
        </ul>

        <h2>6. æ¼”ç¿’å•é¡Œ</h2>

        <div class="exercise">
            <h3>æ¼”ç¿’1ï¼šãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®æ±ºå®š</h3>
            <p>
                ç«‹æ–¹æ™¶ã®çµæ™¶ã§ã€ä»¥ä¸‹ã®åˆ‡ç‰‡ã‚’æŒã¤çµæ™¶é¢ã®ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã‚’æ±‚ã‚ãªã•ã„ï¼š
            </p>
            <ol>
                <li>aè»¸ã§2ã€bè»¸ã§1ã€cè»¸ã§ç„¡é™é ï¼ˆå¹³è¡Œï¼‰</li>
                <li>aè»¸ã§1ã€bè»¸ã§1ã€cè»¸ã§2</li>
                <li>aè»¸ã§-1ã€bè»¸ã§1ã€cè»¸ã§1</li>
            </ol>
            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <ol>
                    <li>åˆ‡ç‰‡ (2, 1, âˆ) â†’ é€†æ•° (1/2, 1, 0) â†’ æ•´æ•°åŒ– (1, 2, 0) â†’ <strong>(120)</strong></li>
                    <li>åˆ‡ç‰‡ (1, 1, 2) â†’ é€†æ•° (1, 1, 1/2) â†’ æ•´æ•°åŒ– (2, 2, 1) â†’ <strong>(221)</strong></li>
                    <li>åˆ‡ç‰‡ (-1, 1, 1) â†’ é€†æ•° (-1, 1, 1) â†’ <strong>(\(\bar{1}\)11)</strong></li>
                </ol>
            </details>
        </div>

        <div class="exercise">
            <h3>æ¼”ç¿’2ï¼šé¢é–“éš”ã®è¨ˆç®—</h3>
            <p>
                éŠ…ï¼ˆCuï¼‰ã¯é¢å¿ƒç«‹æ–¹æ§‹é€ ï¼ˆfccï¼‰ã§ã€æ ¼å­å®šæ•° a = 3.615 Ã… ã§ã™ã€‚
                ä»¥ä¸‹ã®é¢ã®é¢é–“éš”ã‚’è¨ˆç®—ã—ãªã•ã„ï¼š
            </p>
            <ol>
                <li>(111)é¢</li>
                <li>(200)é¢</li>
                <li>(220)é¢</li>
            </ol>
            <p>
                ã¾ãŸã€Cu KÎ±ç·šï¼ˆÎ» = 1.5406 Ã…ï¼‰ã‚’ç”¨ã„ãŸXRDæ¸¬å®šã§ã€ã“ã‚Œã‚‰ã®é¢ã‹ã‚‰ã®å›æŠ˜ãƒ”ãƒ¼ã‚¯ã¯
                ä½•åº¦ï¼ˆ2Î¸ï¼‰ã«ç¾ã‚Œã‚‹ã‹è¨ˆç®—ã—ãªã•ã„ã€‚
            </p>
            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>é¢é–“éš”ï¼š</strong></p>
                <ol>
                    <li>d<sub>111</sub> = 3.615 / âˆš3 = 2.087 Ã…</li>
                    <li>d<sub>200</sub> = 3.615 / âˆš4 = 1.808 Ã…</li>
                    <li>d<sub>220</sub> = 3.615 / âˆš8 = 1.278 Ã…</li>
                </ol>
                <p><strong>ãƒ–ãƒ©ãƒƒã‚°è§’ï¼š</strong>ï¼ˆÎ» = 2d sinÎ¸ ã‚ˆã‚Šï¼‰</p>
                <ol>
                    <li>2Î¸<sub>111</sub> = 2 Ã— arcsin(1.5406/(2Ã—2.087)) â‰ˆ 43.3Â°</li>
                    <li>2Î¸<sub>200</sub> = 2 Ã— arcsin(1.5406/(2Ã—1.808)) â‰ˆ 50.4Â°</li>
                    <li>2Î¸<sub>220</sub> = 2 Ã— arcsin(1.5406/(2Ã—1.278)) â‰ˆ 74.1Â°</li>
                </ol>
            </details>
        </div>

        <div class="exercise">
            <h3>æ¼”ç¿’3ï¼šç­‰ä¾¡ãªé¢ã®ç†è§£</h3>
            <p>
                ç«‹æ–¹æ™¶ã«ãŠã„ã¦ã€{110} ã«å«ã¾ã‚Œã‚‹ç­‰ä¾¡ãªé¢ã‚’ã™ã¹ã¦åˆ—æŒ™ã—ãªã•ã„ã€‚
                ã¾ãŸã€ã“ã‚Œã‚‰ã®é¢ãŒä½•å€‹ã‚ã‚‹ã‹ç­”ãˆãªã•ã„ã€‚
            </p>
            <details>
                <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                <p><strong>ç­”ãˆï¼š12å€‹</strong></p>
                <p>ç­‰ä¾¡ãªé¢ï¼š</p>
                <ul>
                    <li>(110), (101), (011)</li>
                    <li>(\(\bar{1}\)10), (\(\bar{1}\)0\(\bar{1}\)), (0\(\bar{1}\)\(\bar{1}\))</li>
                    <li>(1\(\bar{1}\)0), (10\(\bar{1}\)), (01\(\bar{1}\))</li>
                    <li>(\(\bar{1}\)\(\bar{1}\)0), (\(\bar{1}\)0\(\bar{1}\)), (0\(\bar{1}\)1)</li>
                </ul>
                <p>
                    ã“ã‚Œã‚‰ã¯ç«‹æ–¹æ™¶ã®å¯¾ç§°æ€§ï¼ˆ24å€‹ã®å¯¾ç§°æ“ä½œï¼‰ã«ã‚ˆã‚Šç­‰ä¾¡ã¨ãªã‚Šã€
                    åŒã˜ç‰©ç†çš„æ€§è³ªã‚’æŒã¡ã¾ã™ã€‚
                </p>
            </details>
        </div>

        <div class="exercise">
            <h3>æ¼”ç¿’4ï¼šãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°èª²é¡Œ</h3>
            <p>
                æ­£æ–¹æ™¶ã®ææ–™ï¼ˆä¾‹ï¼šZrO2ã€a = 3.64 Ã…ã€c = 5.27 Ã…ï¼‰ã«ã¤ã„ã¦ã€
                ä»¥ä¸‹ã‚’å®Ÿè¡Œã™ã‚‹Pythonãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ãªã•ã„ï¼š
            </p>
            <ol>
                <li>(100)ã‹ã‚‰(333)ã¾ã§ã®ã™ã¹ã¦ã®é¢ã®é¢é–“éš”ã‚’è¨ˆç®—ã™ã‚‹</li>
                <li>é¢é–“éš”ãŒ2.0 Ã…ä»¥ä¸Šã®é¢ã®ã¿ã‚’æŠ½å‡ºã™ã‚‹</li>
                <li>çµæœã‚’é¢é–“éš”ã®é™é †ã§ã‚½ãƒ¼ãƒˆã—ã¦è¡¨ç¤ºã™ã‚‹</li>
            </ol>
            <details>
                <summary>ãƒ’ãƒ³ãƒˆ</summary>
                <p>
                    ã‚³ãƒ¼ãƒ‰ä¾‹4ã®<code>tetragonal_d_spacing</code>é–¢æ•°ã‚’ä½¿ç”¨ã—ã€
                    3é‡ãƒ«ãƒ¼ãƒ—ã§h, k, lã‚’1ã‹ã‚‰3ã¾ã§å¤‰åŒ–ã•ã›ã¦è¨ˆç®—ã—ã¾ã™ã€‚
                    çµæœã¯ãƒªã‚¹ãƒˆã«ä¿å­˜ã—ã€<code>sorted()</code>é–¢æ•°ã§ã‚½ãƒ¼ãƒˆã§ãã¾ã™ã€‚
                </p>
            </details>
        </div>

        <h2>ã¾ã¨ã‚</h2>

        <p>ã“ã®ç« ã§ã¯ã€çµæ™¶å­¦ã«ãŠã‘ã‚‹æœ€ã‚‚é‡è¦ãªè¨˜æ³•ã§ã‚ã‚‹<strong>ãƒŸãƒ©ãƒ¼æŒ‡æ•°</strong>ã«ã¤ã„ã¦å­¦ã³ã¾ã—ãŸï¼š</p>

        <div class="success-box">
            <h4>é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h4>
            <ul>
                <li><strong>ãƒŸãƒ©ãƒ¼æŒ‡æ•° (hkl)</strong>ã¯çµæ™¶é¢ã‚’3ã¤ã®æ•´æ•°ã§è¡¨ã™æ¨™æº–è¨˜æ³•</li>
                <li><strong>é¢é–“éš” d<sub>hkl</sub></strong>ã¯çµæ™¶ç³»ã”ã¨ã«ç•°ãªã‚‹å¼ã§è¨ˆç®—ã•ã‚Œã‚‹</li>
                <li><strong>ç«‹æ–¹æ™¶</strong>ï¼šd = a / âˆš(hÂ² + kÂ² + lÂ²)</li>
                <li><strong>æ­£æ–¹æ™¶ãƒ»å…­æ–¹æ™¶</strong>ï¼šcè»¸ã®å¯„ä¸ã‚’åˆ¥é€”è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹</li>
                <li><strong>çµæ™¶æ–¹å‘ [uvw]</strong>ã¯é¢ã¨ã¯ç•°ãªã‚‹è¨˜æ³•ã§è¡¨ç¾ã•ã‚Œã‚‹</li>
                <li><strong>å¯¾ç§°æ€§</strong>ã«ã‚ˆã‚Šå¤šæ•°ã®ç­‰ä¾¡ãªé¢ãƒ»æ–¹å‘ãŒå­˜åœ¨ã™ã‚‹</li>
                <li><strong>Xç·šå›æŠ˜</strong>ã§ã®å¿œç”¨ãŒææ–™åŒå®šã¨æ§‹é€ è§£æã®åŸºç¤ã¨ãªã‚‹</li>
            </ul>
        </div>

        <p>
            æ¬¡ç« ã§ã¯ã€<strong>Xç·šå›æŠ˜ã®åŸç†ã¨ãƒ–ãƒ©ãƒƒã‚°ã®æ³•å‰‡</strong>ã‚’è©³ã—ãå­¦ã³ã€
            ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¨é¢é–“éš”ã®çŸ¥è­˜ã‚’å®Ÿéš›ã®æ§‹é€ è§£æã«å¿œç”¨ã—ã¾ã™ã€‚
        </p>

        <div class="navigation">
            <a href="chapter-2.html" class="nav-button prev">ç¬¬2ç« ï¼šãƒ–ãƒ©ãƒ™ãƒ¼æ ¼å­ã¨ç©ºé–“ç¾¤</a>
            <a href="chapter-4.html" class="nav-button next">ç¬¬4ç« ï¼šXç·šå›æŠ˜ã¨ãƒ–ãƒ©ãƒƒã‚°ã®æ³•å‰‡</a>
        </div>
    </div>

    <footer style="background-color: var(--color-bg-alt); padding: var(--spacing-lg); text-align: center; margin-top: var(--spacing-xl); border-top: 2px solid var(--color-border);">
        <p style="margin-bottom: var(--spacing-sm); color: var(--color-text-light);">
            &copy; 2025 AIå¯ºå­å±‹ MS Dojo - çµæ™¶å­¦å…¥é–€
        </p>
        <p style="font-size: 0.9rem; color: var(--color-text-light);">
            <a href="../../index.html" style="color: var(--color-link);">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—ã¸</a> |
            <a href="../index.html" style="color: var(--color-link);">MS Dojoã¸</a> |
            <a href="index.html" style="color: var(--color-link);">çµæ™¶å­¦å…¥é–€ãƒˆãƒƒãƒ—ã¸</a>
        </p>
    </footer>
</body>
</html>
