<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 1: é‡‘å±çµåˆã¨çµæ™¶æ§‹é€  - é‡‘å±ææ–™å…¥é–€ | MS Dojo</title>
    <meta name="description" content="é‡‘å±çµåˆã®é›»å­è«–ã€FCC/BCC/HCPçµæ™¶æ§‹é€ ã€ãƒ–ãƒ©ãƒ™ãƒ¼æ ¼å­ã€ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚Pythonã§çµæ™¶æ§‹é€ ã®å¯è¦–åŒ–ã¨è¨ˆç®—ã‚’å®Ÿè·µã—ã¾ã™ã€‚">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../../../assets/css/variables.css">
    <link rel="stylesheet" href="../../../assets/css/reset.css">
    <link rel="stylesheet" href="../../../assets/css/base.css">
    <link rel="stylesheet" href="../../../assets/css/components.css">
    <link rel="stylesheet" href="../../../assets/css/layout.css">
    <link rel="stylesheet" href="../../../assets/css/responsive.css">

    <!-- MathJax 3.x -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>

    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'neutral',
            themeVariables: {
                primaryColor: '#f093fb',
                primaryTextColor: '#1a252f',
                primaryBorderColor: '#f5576c',
                lineColor: '#f5576c',
                secondaryColor: '#fbc2eb',
                tertiaryColor: '#fff'
            }
        });
    </script>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

    <style>
        :root {
            --ms-gradient-start: #f093fb;
            --ms-gradient-end: #f5576c;
        }

        .chapter-header {
            background: linear-gradient(135deg, var(--ms-gradient-start) 0%, var(--ms-gradient-end) 100%);
            color: white;
            padding: 3rem 2rem;
            margin-bottom: 2rem;
            border-radius: 8px;
        }

        .chapter-header h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            font-weight: 700;
        }

        .chapter-header .subtitle {
            font-size: 1.2rem;
            opacity: 0.95;
        }

        .section {
            margin-bottom: 3rem;
        }

        .section h2 {
            color: var(--ms-gradient-end);
            font-size: 2rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 3px solid var(--ms-gradient-start);
        }

        .section h3 {
            color: var(--ms-gradient-start);
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }

        .equation-block {
            background: #f8f9fa;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--ms-gradient-start);
            border-radius: 4px;
            overflow-x: auto;
        }

        .code-example {
            margin: 2rem 0;
        }

        .code-example h4 {
            color: var(--ms-gradient-end);
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }

        .code-example pre {
            background: #2d2d2d;
            border-radius: 8px;
            padding: 1.5rem;
            overflow-x: auto;
        }

        .code-example code {
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .exercise-section {
            background: linear-gradient(135deg, rgba(240, 147, 251, 0.1) 0%, rgba(245, 87, 108, 0.1) 100%);
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 8px;
            border: 2px solid var(--ms-gradient-start);
        }

        .exercise-section h3 {
            color: var(--ms-gradient-end);
            margin-top: 0;
        }

        .exercise {
            background: white;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-radius: 6px;
            border-left: 4px solid var(--ms-gradient-start);
        }

        .exercise-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .difficulty {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .difficulty.easy {
            background: #d4edda;
            color: #155724;
        }

        .difficulty.medium {
            background: #fff3cd;
            color: #856404;
        }

        .difficulty.hard {
            background: #f8d7da;
            color: #721c24;
        }

        details {
            margin-top: 1rem;
        }

        summary {
            cursor: pointer;
            color: var(--ms-gradient-end);
            font-weight: 600;
            padding: 0.5rem;
            background: #f8f9fa;
            border-radius: 4px;
            user-select: none;
        }

        summary:hover {
            background: #e9ecef;
        }

        .learning-objectives {
            background: #f8f9fa;
            padding: 2rem;
            margin: 2rem 0;
            border-radius: 8px;
            border: 2px solid var(--ms-gradient-start);
        }

        .learning-objectives h3 {
            color: var(--ms-gradient-end);
            margin-top: 0;
        }

        .objective-level {
            margin: 1.5rem 0;
        }

        .objective-level h4 {
            color: var(--ms-gradient-start);
            margin-bottom: 0.75rem;
        }

        .objective-level ul {
            list-style: none;
            padding-left: 0;
        }

        .objective-level li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }

        .objective-level li::before {
            content: "âœ“";
            position: absolute;
            left: 0;
            color: var(--ms-gradient-end);
            font-weight: bold;
        }

        .references {
            margin-top: 3rem;
            padding: 2rem;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .references h2 {
            color: var(--ms-gradient-end);
            margin-top: 0;
        }

        .references ol {
            padding-left: 1.5rem;
        }

        .references li {
            margin: 1rem 0;
            line-height: 1.6;
        }

        .mermaid {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            margin: 2rem 0;
        }

        @media (max-width: 768px) {
            .chapter-header h1 {
                font-size: 1.8rem;
            }

            .chapter-header {
                padding: 2rem 1rem;
            }

            .section h2 {
                font-size: 1.5rem;
            }
        }
    </style>

    <style>
        /* Locale Switcher Styles */
        .locale-switcher {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 6px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .current-locale {
            font-weight: 600;
            color: #7b2cbf;
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .locale-separator {
            color: #adb5bd;
            font-weight: 300;
        }

        .locale-link {
            color: #f093fb;
            text-decoration: none;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
        }

        .locale-link:hover {
            background: rgba(240, 147, 251, 0.1);
            color: #d07be8;
            transform: translateY(-1px);
        }

        .locale-meta {
            color: #868e96;
            font-size: 0.85rem;
            font-style: italic;
            margin-left: auto;
        }

        @media (max-width: 768px) {
            .locale-switcher {
                font-size: 0.85rem;
                padding: 0.4rem 0.8rem;
            }
            .locale-meta {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="locale-switcher">
<span class="current-locale">ğŸŒ JP</span>
<span class="locale-separator">|</span>
<a href="../../../en/MS/metallic-materials-introduction/chapter-1.html" class="locale-link">ğŸ‡¬ğŸ‡§ EN</a>
<span class="locale-separator">|</span>
<span class="locale-meta">Last sync: 2025-11-16</span>
</div>
<nav class="breadcrumb" aria-label="ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆ">
        <a href="../../../index.html">ãƒ›ãƒ¼ãƒ </a> &gt;
        <a href="../../../jp/knowledge/index.html">çŸ¥è­˜ãƒ™ãƒ¼ã‚¹</a> &gt;
        <a href="../../index.html">ææ–™ç§‘å­¦ (MS)</a> &gt;
        <a href="./index.html">é‡‘å±ææ–™å…¥é–€</a> &gt;
        <span>Chapter 1</span>
    </nav>

    <main class="container">
        <div class="chapter-header">
            <h1>Chapter 1: é‡‘å±çµåˆã¨çµæ™¶æ§‹é€ </h1>
            <p class="subtitle">é‡‘å±ã®è‡ªç”±é›»å­ãƒ¢ãƒ‡ãƒ«ã€FCC/BCC/HCPçµæ™¶æ§‹é€ ã€ãƒ–ãƒ©ãƒ™ãƒ¼æ ¼å­ã€ãƒŸãƒ©ãƒ¼æŒ‡æ•°</p>
        </div>

        <section class="section">
            <h2>1.1 é‡‘å±çµåˆã®é›»å­è«–</h2>

            <p>é‡‘å±ã®ç‰¹æ€§ã‚’ç†è§£ã™ã‚‹ã«ã¯ã€é‡‘å±çµåˆã®æœ¬è³ªã‚’çŸ¥ã‚‹ã“ã¨ãŒé‡è¦ã§ã™ã€‚é‡‘å±çµåˆã¯ã€ã‚¤ã‚ªãƒ³åŒ–ã—ãŸé‡‘å±åŸå­ï¼ˆé™½ã‚¤ã‚ªãƒ³ï¼‰ãŒã€è‡ªç”±ã«å‹•ãå›ã‚‹é›»å­ï¼ˆè‡ªç”±é›»å­ï¼‰ã«ã‚ˆã£ã¦çµã³ã¤ã„ã¦ã„ã‚‹çŠ¶æ…‹ã§ã™ã€‚ã“ã®è‡ªç”±é›»å­ãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã£ã¦ã€é‡‘å±ã®é›»æ°—ä¼å°æ€§ã€ç†±ä¼å°æ€§ã€å…‰æ²¢ãªã©ã®ç‰¹æ€§ã‚’èª¬æ˜ã§ãã¾ã™ã€‚</p>

            <h3>1.1.1 Drudeãƒ¢ãƒ‡ãƒ«</h3>

            <p>Drudeãƒ¢ãƒ‡ãƒ«ã¯ã€é‡‘å±ä¸­ã®è‡ªç”±é›»å­ã‚’å¤å…¸çš„ãªæ°—ä½“åˆ†å­ã¨ã—ã¦æ‰±ã†ãƒ¢ãƒ‡ãƒ«ã§ã™ã€‚ã“ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€é›»å­ã¯é‡‘å±ã‚¤ã‚ªãƒ³ã®é–“ã‚’è‡ªç”±ã«å‹•ãå›ã‚Šã€ã‚¤ã‚ªãƒ³ã‚„ä»–ã®é›»å­ã¨è¡çªã™ã‚‹ã“ã¨ã§æ•£ä¹±ã•ã‚Œã¾ã™ã€‚</p>

            <div class="equation-block">
                <p><strong>é›»æ°—ä¼å°åº¦ã®å¼ï¼š</strong></p>
                $$\sigma = \frac{ne^2\tau}{m}$$
                <p>ã“ã“ã§ã€$n$ã¯é›»å­å¯†åº¦ã€$e$ã¯é›»å­ã®é›»è·ã€$\tau$ã¯ç·©å’Œæ™‚é–“ã€$m$ã¯é›»å­ã®è³ªé‡ã§ã™ã€‚</p>
            </div>

            <p>ã“ã®å¼ã‹ã‚‰ã€é›»æ°—ä¼å°åº¦ã¯é›»å­å¯†åº¦ã¨ç·©å’Œæ™‚é–“ã«æ¯”ä¾‹ã™ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚é‡‘å±ã®é›»æ°—æŠµæŠ—ã¯æ¸©åº¦ä¸Šæ˜‡ã¨ã¨ã‚‚ã«å¢—åŠ ã—ã¾ã™ãŒã€ã“ã‚Œã¯æ ¼å­æŒ¯å‹•ï¼ˆãƒ•ã‚©ãƒãƒ³ï¼‰ã«ã‚ˆã‚‹é›»å­ã®æ•£ä¹±ãŒå¢—ãˆã‚‹ãŸã‚ã§ã™ã€‚</p>

            <h3>1.1.2 ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒ</h3>

            <p>é‡å­åŠ›å­¦çš„ã«ã¯ã€é›»å­ã¯ãƒ•ã‚§ãƒ«ãƒŸç²’å­ã§ã‚ã‚Šã€ãƒ‘ã‚¦ãƒªã®æ’ä»–åŸç†ã«å¾“ã„ã¾ã™ã€‚æ¸©åº¦$T$ã«ãŠã‘ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼$E$ã®çŠ¶æ…‹ã®å æœ‰ç¢ºç‡ã¯ã€ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒé–¢æ•°ã§è¡¨ã•ã‚Œã¾ã™ï¼š</p>

            <div class="equation-block">
                $$f(E) = \frac{1}{1 + \exp\left(\frac{E - E_F}{k_BT}\right)}$$
                <p>ã“ã“ã§ã€$E_F$ã¯ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã€$k_B$ã¯ãƒœãƒ«ãƒ„ãƒãƒ³å®šæ•°ã§ã™ã€‚</p>
            </div>

            <p>çµ¶å¯¾é›¶åº¦ï¼ˆ$T = 0$ Kï¼‰ã§ã¯ã€ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ä»¥ä¸‹ã®ã™ã¹ã¦ã®çŠ¶æ…‹ãŒå æœ‰ã•ã‚Œã€ãã‚Œã‚ˆã‚Šä¸Šã®çŠ¶æ…‹ã¯ç©ºã«ãªã‚Šã¾ã™ã€‚å®¤æ¸©ã§ã‚‚ã€é‡‘å±ã®ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆæ•°eVï¼‰ã¯ç†±ã‚¨ãƒãƒ«ã‚®ãƒ¼$k_BT$ï¼ˆç´„0.025 eVï¼‰ã‚ˆã‚Šã¯ã‚‹ã‹ã«å¤§ãã„ãŸã‚ã€ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒã¯ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°ã«è¿‘ã„å½¢ã‚’ã—ã¦ã„ã¾ã™ã€‚</p>

            <h3>1.1.3 çŠ¶æ…‹å¯†åº¦</h3>

            <p>é‡‘å±ä¸­ã®é›»å­ã®çŠ¶æ…‹å¯†åº¦$D(E)$ã¯ã€å˜ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼å½“ãŸã‚Šã®çŠ¶æ…‹æ•°ã‚’è¡¨ã—ã¾ã™ã€‚è‡ªç”±é›»å­ãƒ¢ãƒ‡ãƒ«ã§ã¯ã€3æ¬¡å…ƒã®çŠ¶æ…‹å¯†åº¦ã¯æ¬¡ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™ï¼š</p>

            <div class="equation-block">
                $$D(E) = \frac{2\pi V}{h^3}(2m)^{3/2}E^{1/2}$$
                <p>ã“ã“ã§ã€$V$ã¯ä½“ç©ã€$h$ã¯ãƒ—ãƒ©ãƒ³ã‚¯å®šæ•°ã€$m$ã¯é›»å­ã®è³ªé‡ã§ã™ã€‚</p>
            </div>

            <div class="code-example">
                <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1: Drudeãƒ¢ãƒ‡ãƒ«ã«ã‚ˆã‚‹é›»æ°—ä¼å°åº¦è¨ˆç®—</h4>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# ç‰©ç†å®šæ•°
e = 1.602e-19  # é›»å­ã®é›»è· (C)
m_e = 9.109e-31  # é›»å­ã®è³ªé‡ (kg)

def calculate_conductivity(n, tau):
    """
    Drudeãƒ¢ãƒ‡ãƒ«ã§é›»æ°—ä¼å°åº¦ã‚’è¨ˆç®—

    Parameters:
    -----------
    n : float
        é›»å­å¯†åº¦ (m^-3)
    tau : float
        ç·©å’Œæ™‚é–“ (s)

    Returns:
    --------
    sigma : float
        é›»æ°—ä¼å°åº¦ (S/m)
    """
    sigma = (n * e**2 * tau) / m_e
    return sigma

# ä»£è¡¨çš„ãªé‡‘å±ã®é›»å­å¯†åº¦ (m^-3)
metals = {
    'Cu': 8.45e28,   # éŠ…
    'Ag': 5.85e28,   # éŠ€
    'Al': 18.1e28,   # ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ 
    'Fe': 17.0e28,   # é‰„
    'Au': 5.90e28    # é‡‘
}

# ç·©å’Œæ™‚é–“ï¼ˆå…¸å‹çš„ãªå€¤ï¼‰
tau = 2.5e-14  # s

# å„é‡‘å±ã®é›»æ°—ä¼å°åº¦ã‚’è¨ˆç®—
print("é‡‘å±ã®é›»æ°—ä¼å°åº¦ (Drudeãƒ¢ãƒ‡ãƒ«):")
print("-" * 50)
for metal, n in metals.items():
    sigma = calculate_conductivity(n, tau)
    resistivity = 1 / sigma
    print(f"{metal:4s}: Ïƒ = {sigma:.2e} S/m, Ï = {resistivity*1e8:.2f} Î¼Î©Â·cm")

# æ¸©åº¦ä¾å­˜æ€§ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆéŠ…ï¼‰
temperatures = np.linspace(100, 500, 100)  # K
# ç·©å’Œæ™‚é–“ã¯æ¸©åº¦ã«åæ¯”ä¾‹ã™ã‚‹ã¨ä»®å®š
tau_T = tau * 300 / temperatures  # 300Kã§è¦æ ¼åŒ–

conductivity_T = np.array([calculate_conductivity(metals['Cu'], t) for t in tau_T])
resistivity_T = 1 / conductivity_T

# ã‚°ãƒ©ãƒ•æç”»
plt.figure(figsize=(10, 6))
plt.plot(temperatures, resistivity_T * 1e8, 'b-', linewidth=2)
plt.xlabel('æ¸©åº¦ (K)', fontsize=12)
plt.ylabel('é›»æ°—æŠµæŠ—ç‡ (Î¼Î©Â·cm)', fontsize=12)
plt.title('éŠ…ã®é›»æ°—æŠµæŠ—ç‡ã®æ¸©åº¦ä¾å­˜æ€§ (Drudeãƒ¢ãƒ‡ãƒ«)', fontsize=14, fontweight='bold')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.savefig('cu_resistivity_vs_temperature.png', dpi=300, bbox_inches='tight')
plt.show()

print("\nâœ“ ã‚°ãƒ©ãƒ•ã‚’ 'cu_resistivity_vs_temperature.png' ã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ")
</code></pre>
            </div>

            <div class="code-example">
                <h4>ã‚³ãƒ¼ãƒ‰ä¾‹2: ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨çŠ¶æ…‹å¯†åº¦ã®è¨ˆç®—</h4>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy import constants

# ç‰©ç†å®šæ•°
h = constants.h  # ãƒ—ãƒ©ãƒ³ã‚¯å®šæ•°
hbar = constants.hbar  # ãƒ‡ã‚£ãƒ©ãƒƒã‚¯å®šæ•°
m_e = constants.m_e  # é›»å­ã®è³ªé‡
k_B = constants.k  # ãƒœãƒ«ãƒ„ãƒãƒ³å®šæ•°
e = constants.e  # é›»å­ã®é›»è·

def fermi_energy(n):
    """
    ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’è¨ˆç®—

    Parameters:
    -----------
    n : float
        é›»å­å¯†åº¦ (m^-3)

    Returns:
    --------
    E_F : float
        ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ (J)
    """
    E_F = (hbar**2 / (2 * m_e)) * (3 * np.pi**2 * n)**(2/3)
    return E_F

def fermi_dirac(E, E_F, T):
    """
    ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒé–¢æ•°

    Parameters:
    -----------
    E : array-like
        ã‚¨ãƒãƒ«ã‚®ãƒ¼ (J)
    E_F : float
        ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ (J)
    T : float
        æ¸©åº¦ (K)

    Returns:
    --------
    f : array-like
        å æœ‰ç¢ºç‡
    """
    if T == 0:
        return np.where(E <= E_F, 1.0, 0.0)
    else:
        return 1 / (1 + np.exp((E - E_F) / (k_B * T)))

def density_of_states(E):
    """
    è‡ªç”±é›»å­ã®çŠ¶æ…‹å¯†åº¦ï¼ˆ3æ¬¡å…ƒï¼‰

    Parameters:
    -----------
    E : array-like
        ã‚¨ãƒãƒ«ã‚®ãƒ¼ (J)

    Returns:
    --------
    D : array-like
        çŠ¶æ…‹å¯†åº¦ (J^-1 m^-3)
    """
    # å˜ä½ä½“ç©ã‚ãŸã‚Š
    D = (1 / (2 * np.pi**2)) * (2 * m_e / hbar**2)**(3/2) * np.sqrt(E)
    return D

# éŠ…ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
n_Cu = 8.45e28  # é›»å­å¯†åº¦ (m^-3)
E_F_Cu = fermi_energy(n_Cu)
E_F_eV = E_F_Cu / e  # eVå˜ä½

print(f"éŠ…ã®ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼: {E_F_eV:.2f} eV")
print(f"ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦: {np.sqrt(2 * E_F_Cu / m_e) / 1e6:.2f} Ã— 10^6 m/s")

# ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒã®ãƒ—ãƒ­ãƒƒãƒˆ
E_range = np.linspace(0, 2 * E_F_Cu, 1000)
E_range_eV = E_range / e

fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³: ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒ
temperatures = [0, 300, 1000, 3000]
for T in temperatures:
    f = fermi_dirac(E_range, E_F_Cu, T)
    label = f'{T} K' if T > 0 else '0 K'
    axes[0].plot(E_range_eV, f, linewidth=2, label=label)

axes[0].axvline(E_F_eV, color='red', linestyle='--', linewidth=1.5, label=f'$E_F$ = {E_F_eV:.2f} eV')
axes[0].set_xlabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
axes[0].set_ylabel('å æœ‰ç¢ºç‡ f(E)', fontsize=12)
axes[0].set_title('ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒ', fontsize=14, fontweight='bold')
axes[0].legend(fontsize=10)
axes[0].grid(True, alpha=0.3)
axes[0].set_xlim(0, 2 * E_F_eV)
axes[0].set_ylim(-0.05, 1.05)

# å³å›³: çŠ¶æ…‹å¯†åº¦
D = density_of_states(E_range[E_range > 0])
E_positive_eV = E_range_eV[E_range > 0]

axes[1].plot(E_positive_eV, D / 1e47, 'b-', linewidth=2)
axes[1].axvline(E_F_eV, color='red', linestyle='--', linewidth=1.5, label=f'$E_F$ = {E_F_eV:.2f} eV')
axes[1].set_xlabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12)
axes[1].set_ylabel('çŠ¶æ…‹å¯†åº¦ (10^47 states/(JÂ·mÂ³))', fontsize=12)
axes[1].set_title('è‡ªç”±é›»å­ã®çŠ¶æ…‹å¯†åº¦', fontsize=14, fontweight='bold')
axes[1].legend(fontsize=10)
axes[1].grid(True, alpha=0.3)
axes[1].set_xlim(0, 2 * E_F_eV)

plt.tight_layout()
plt.savefig('fermi_dirac_and_dos.png', dpi=300, bbox_inches='tight')
plt.show()

print("\nâœ“ ã‚°ãƒ©ãƒ•ã‚’ 'fermi_dirac_and_dos.png' ã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ")
</code></pre>
            </div>
        </section>

        <section class="section">
            <h2>1.2 çµæ™¶æ§‹é€ ã®åŸºç¤</h2>

            <p>é‡‘å±ã®å¤šãã¯çµæ™¶æ§‹é€ ã‚’æŒã¡ã€åŸå­ãŒè¦å‰‡æ­£ã—ãé…åˆ—ã—ã¦ã„ã¾ã™ã€‚é‡‘å±ã®æ©Ÿæ¢°çš„æ€§è³ªã€é›»æ°—çš„æ€§è³ªã€ç†±çš„æ€§è³ªã¯ã€ã“ã®çµæ™¶æ§‹é€ ã«å¤§ããä¾å­˜ã—ã¾ã™ã€‚ä»£è¡¨çš„ãªé‡‘å±çµæ™¶æ§‹é€ ã¨ã—ã¦ã€é¢å¿ƒç«‹æ–¹æ ¼å­ï¼ˆFCCï¼‰ã€ä½“å¿ƒç«‹æ–¹æ ¼å­ï¼ˆBCCï¼‰ã€å…­æ–¹æœ€å¯†å……å¡«æ§‹é€ ï¼ˆHCPï¼‰ãŒã‚ã‚Šã¾ã™ã€‚</p>

            <h3>1.2.1 é¢å¿ƒç«‹æ–¹æ ¼å­ï¼ˆFCC: Face-Centered Cubicï¼‰</h3>

            <p>FCCæ§‹é€ ã¯ã€ç«‹æ–¹ä½“ã®å„é ‚ç‚¹ã¨å„é¢ã®ä¸­å¿ƒã«åŸå­ãŒé…ç½®ã•ã‚ŒãŸæ§‹é€ ã§ã™ã€‚ä»£è¡¨çš„ãªFCCé‡‘å±ã«ã¯ã€éŠ…ï¼ˆCuï¼‰ã€ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ï¼ˆAlï¼‰ã€é‡‘ï¼ˆAuï¼‰ã€éŠ€ï¼ˆAgï¼‰ã€ãƒ‹ãƒƒã‚±ãƒ«ï¼ˆNiï¼‰ãªã©ãŒã‚ã‚Šã¾ã™ã€‚</p>

            <ul>
                <li><strong>æ ¼å­å®šæ•°ï¼š</strong> ç«‹æ–¹ä½“ã®ä¸€è¾ºã®é•·ã• $a$</li>
                <li><strong>åŸå­æ•°ï¼š</strong> å˜ä½æ ¼å­ã‚ãŸã‚Š 4 å€‹ï¼ˆé ‚ç‚¹ $8 \times 1/8 = 1$ã€é¢å¿ƒ $6 \times 1/2 = 3$ï¼‰</li>
                <li><strong>é…ä½æ•°ï¼š</strong> 12ï¼ˆæœ€è¿‘æ¥åŸå­æ•°ï¼‰</li>
                <li><strong>åŸå­åŠå¾„ï¼š</strong> $r = \frac{a}{2\sqrt{2}}$</li>
                <li><strong>å……å¡«ç‡ï¼š</strong> $\frac{\pi}{3\sqrt{2}} \approx 0.74$ (74%)</li>
            </ul>

            <div class="mermaid">
flowchart TD
    A[FCCæ§‹é€ ] --> B[æœ€å¯†å……å¡«æ§‹é€ ]
    B --> C[å……å¡«ç‡ 74%]
    B --> D[é…ä½æ•° 12]
    A --> E[ã™ã¹ã‚Šç³»ãŒå¤šã„]
    E --> F[å»¶æ€§ãŒé«˜ã„]
    F --> G[åŠ å·¥ã—ã‚„ã™ã„]
    A --> H[ä»£è¡¨çš„ãªé‡‘å±]
    H --> I[Cu, Al, Au, Ag, Ni]
</mermaid>

            <h3>1.2.2 ä½“å¿ƒç«‹æ–¹æ ¼å­ï¼ˆBCC: Body-Centered Cubicï¼‰</h3>

            <p>BCCæ§‹é€ ã¯ã€ç«‹æ–¹ä½“ã®å„é ‚ç‚¹ã¨ä¸­å¿ƒã«åŸå­ãŒé…ç½®ã•ã‚ŒãŸæ§‹é€ ã§ã™ã€‚ä»£è¡¨çš„ãªBCCé‡‘å±ã«ã¯ã€é‰„ï¼ˆFeã€å¸¸æ¸©ï¼‰ã€ã‚¯ãƒ­ãƒ ï¼ˆCrï¼‰ã€ã‚¿ãƒ³ã‚°ã‚¹ãƒ†ãƒ³ï¼ˆWï¼‰ã€ãƒ¢ãƒªãƒ–ãƒ‡ãƒ³ï¼ˆMoï¼‰ãªã©ãŒã‚ã‚Šã¾ã™ã€‚</p>

            <ul>
                <li><strong>æ ¼å­å®šæ•°ï¼š</strong> ç«‹æ–¹ä½“ã®ä¸€è¾ºã®é•·ã• $a$</li>
                <li><strong>åŸå­æ•°ï¼š</strong> å˜ä½æ ¼å­ã‚ãŸã‚Š 2 å€‹ï¼ˆé ‚ç‚¹ $8 \times 1/8 = 1$ã€ä½“å¿ƒ $1$ï¼‰</li>
                <li><strong>é…ä½æ•°ï¼š</strong> 8</li>
                <li><strong>åŸå­åŠå¾„ï¼š</strong> $r = \frac{\sqrt{3}a}{4}$</li>
                <li><strong>å……å¡«ç‡ï¼š</strong> $\frac{\sqrt{3}\pi}{8} \approx 0.68$ (68%)</li>
            </ul>

            <h3>1.2.3 å…­æ–¹æœ€å¯†å……å¡«æ§‹é€ ï¼ˆHCP: Hexagonal Close-Packedï¼‰</h3>

            <p>HCPæ§‹é€ ã¯ã€å…­æ–¹æ™¶ç³»ã®æœ€å¯†å……å¡«æ§‹é€ ã§ã™ã€‚ä»£è¡¨çš„ãªHCPé‡‘å±ã«ã¯ã€ãƒã‚°ãƒã‚·ã‚¦ãƒ ï¼ˆMgï¼‰ã€ãƒã‚¿ãƒ³ï¼ˆTiï¼‰ã€äºœé‰›ï¼ˆZnï¼‰ã€ã‚³ãƒãƒ«ãƒˆï¼ˆCoï¼‰ãªã©ãŒã‚ã‚Šã¾ã™ã€‚</p>

            <ul>
                <li><strong>æ ¼å­å®šæ•°ï¼š</strong> åº•é¢ã®è¾ºã®é•·ã• $a$ã€é«˜ã• $c$</li>
                <li><strong>åŸå­æ•°ï¼š</strong> å˜ä½æ ¼å­ã‚ãŸã‚Š 6 å€‹</li>
                <li><strong>é…ä½æ•°ï¼š</strong> 12</li>
                <li><strong>ç†æƒ³çš„ãªè»¸æ¯”ï¼š</strong> $c/a = \sqrt{8/3} \approx 1.633$</li>
                <li><strong>å……å¡«ç‡ï¼š</strong> $\frac{\pi}{3\sqrt{2}} \approx 0.74$ (74%ã€FCCã¨åŒã˜)</li>
            </ul>

            <div class="code-example">
                <h4>ã‚³ãƒ¼ãƒ‰ä¾‹3: çµæ™¶æ§‹é€ ã®3Då¯è¦–åŒ–ï¼ˆFCC/BCC/HCPï¼‰</h4>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

def create_fcc_structure(a=1.0):
    """
    FCCæ§‹é€ ã®åŸå­åº§æ¨™ã‚’ç”Ÿæˆ

    Parameters:
    -----------
    a : float
        æ ¼å­å®šæ•°

    Returns:
    --------
    positions : ndarray
        åŸå­åº§æ¨™ (N, 3)
    """
    positions = []

    # é ‚ç‚¹ã®åŸå­ï¼ˆå˜ä½æ ¼å­å†…ã®åŸå­ã®ã¿ï¼‰
    corners = [
        [0, 0, 0], [a, 0, 0], [0, a, 0], [0, 0, a],
        [a, a, 0], [a, 0, a], [0, a, a], [a, a, a]
    ]

    # é¢å¿ƒã®åŸå­
    face_centers = [
        [a/2, a/2, 0], [a/2, 0, a/2], [0, a/2, a/2],
        [a/2, a/2, a], [a/2, a, a/2], [a, a/2, a/2]
    ]

    positions.extend(corners)
    positions.extend(face_centers)

    return np.array(positions)

def create_bcc_structure(a=1.0):
    """
    BCCæ§‹é€ ã®åŸå­åº§æ¨™ã‚’ç”Ÿæˆ

    Parameters:
    -----------
    a : float
        æ ¼å­å®šæ•°

    Returns:
    --------
    positions : ndarray
        åŸå­åº§æ¨™ (N, 3)
    """
    positions = []

    # é ‚ç‚¹ã®åŸå­
    corners = [
        [0, 0, 0], [a, 0, 0], [0, a, 0], [0, 0, a],
        [a, a, 0], [a, 0, a], [0, a, a], [a, a, a]
    ]

    # ä½“å¿ƒã®åŸå­
    body_center = [[a/2, a/2, a/2]]

    positions.extend(corners)
    positions.extend(body_center)

    return np.array(positions)

def create_hcp_structure(a=1.0, c_over_a=1.633):
    """
    HCPæ§‹é€ ã®åŸå­åº§æ¨™ã‚’ç”Ÿæˆï¼ˆç°¡æ˜“ç‰ˆï¼‰

    Parameters:
    -----------
    a : float
        æ ¼å­å®šæ•°ï¼ˆåº•é¢ï¼‰
    c_over_a : float
        è»¸æ¯” c/a

    Returns:
    --------
    positions : ndarray
        åŸå­åº§æ¨™ (N, 3)
    """
    c = a * c_over_a
    positions = []

    # åº•é¢ã®åŸå­ï¼ˆAå±¤ï¼‰
    positions.append([0, 0, 0])
    positions.append([a, 0, 0])
    positions.append([a/2, a*np.sqrt(3)/2, 0])

    # ä¸­é–“å±¤ã®åŸå­ï¼ˆBå±¤ï¼‰
    positions.append([a/2, a*np.sqrt(3)/6, c/2])

    # ä¸Šé¢ã®åŸå­ï¼ˆAå±¤ï¼‰
    positions.append([0, 0, c])
    positions.append([a, 0, c])
    positions.append([a/2, a*np.sqrt(3)/2, c])

    return np.array(positions)

def plot_crystal_structure(positions, title, ax, color='blue', atom_size=300):
    """
    çµæ™¶æ§‹é€ ã‚’3Dãƒ—ãƒ­ãƒƒãƒˆ
    """
    ax.scatter(positions[:, 0], positions[:, 1], positions[:, 2],
               c=color, s=atom_size, alpha=0.7, edgecolors='black', linewidth=1.5)

    ax.set_xlabel('X', fontsize=10, fontweight='bold')
    ax.set_ylabel('Y', fontsize=10, fontweight='bold')
    ax.set_zlabel('Z', fontsize=10, fontweight='bold')
    ax.set_title(title, fontsize=12, fontweight='bold', pad=10)

    # è»¸ã®ç¯„å›²ã‚’è¨­å®š
    max_coord = np.max(positions)
    ax.set_xlim([-0.2, max_coord + 0.2])
    ax.set_ylim([-0.2, max_coord + 0.2])
    ax.set_zlim([-0.2, max_coord + 0.2])

    ax.set_box_aspect([1, 1, 1])

# 3ã¤ã®çµæ™¶æ§‹é€ ã‚’ç”Ÿæˆ
a = 1.0
fcc_pos = create_fcc_structure(a)
bcc_pos = create_bcc_structure(a)
hcp_pos = create_hcp_structure(a)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig = plt.figure(figsize=(16, 5))

ax1 = fig.add_subplot(131, projection='3d')
plot_crystal_structure(fcc_pos, 'FCCæ§‹é€ \n(Cu, Al, Au, Ag)', ax1, color='#FF6B6B')

ax2 = fig.add_subplot(132, projection='3d')
plot_crystal_structure(bcc_pos, 'BCCæ§‹é€ \n(Fe, Cr, W, Mo)', ax2, color='#4ECDC4')

ax3 = fig.add_subplot(133, projection='3d')
plot_crystal_structure(hcp_pos, 'HCPæ§‹é€ \n(Mg, Ti, Zn, Co)', ax3, color='#95E1D3')

plt.tight_layout()
plt.savefig('crystal_structures_3d.png', dpi=300, bbox_inches='tight')
plt.show()

# å……å¡«ç‡ã¨é…ä½æ•°ã®è¨ˆç®—
print("çµæ™¶æ§‹é€ ã®æ¯”è¼ƒ:")
print("=" * 60)
print(f"{'æ§‹é€ ':<8} {'å……å¡«ç‡':<15} {'é…ä½æ•°':<10} {'ä»£è¡¨çš„ãªé‡‘å±'}")
print("-" * 60)
print(f"{'FCC':<8} {np.pi/(3*np.sqrt(2)):.4f} (74%)    {12:<10} Cu, Al, Au, Ag, Ni")
print(f"{'BCC':<8} {np.sqrt(3)*np.pi/8:.4f} (68%)    {8:<10} Fe, Cr, W, Mo")
print(f"{'HCP':<8} {np.pi/(3*np.sqrt(2)):.4f} (74%)    {12:<10} Mg, Ti, Zn, Co")
print("=" * 60)

print("\nâœ“ ã‚°ãƒ©ãƒ•ã‚’ 'crystal_structures_3d.png' ã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ")
</code></pre>
            </div>

            <div class="code-example">
                <h4>ã‚³ãƒ¼ãƒ‰ä¾‹4: å……å¡«ç‡ã¨é…ä½æ•°ã®è©³ç´°è¨ˆç®—</h4>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def calculate_fcc_properties(a):
    """FCCæ§‹é€ ã®ç‰©æ€§ã‚’è¨ˆç®—"""
    # åŸå­åŠå¾„
    r = a / (2 * np.sqrt(2))

    # åŸå­æ•°ï¼ˆå˜ä½æ ¼å­ã‚ãŸã‚Šï¼‰
    n_atoms = 4

    # å˜ä½æ ¼å­ã®ä½“ç©
    V_cell = a**3

    # åŸå­ã®ä½“ç©
    V_atom = (4/3) * np.pi * r**3

    # å……å¡«ç‡
    packing_fraction = (n_atoms * V_atom) / V_cell

    # é…ä½æ•°
    coordination_number = 12

    # æœ€è¿‘æ¥åŸå­é–“è·é›¢
    nearest_neighbor = 2 * r

    return {
        'structure': 'FCC',
        'lattice_constant': a,
        'atomic_radius': r,
        'atoms_per_cell': n_atoms,
        'packing_fraction': packing_fraction,
        'coordination_number': coordination_number,
        'nearest_neighbor': nearest_neighbor
    }

def calculate_bcc_properties(a):
    """BCCæ§‹é€ ã®ç‰©æ€§ã‚’è¨ˆç®—"""
    # åŸå­åŠå¾„
    r = (np.sqrt(3) * a) / 4

    # åŸå­æ•°
    n_atoms = 2

    # å˜ä½æ ¼å­ã®ä½“ç©
    V_cell = a**3

    # åŸå­ã®ä½“ç©
    V_atom = (4/3) * np.pi * r**3

    # å……å¡«ç‡
    packing_fraction = (n_atoms * V_atom) / V_cell

    # é…ä½æ•°
    coordination_number = 8

    # æœ€è¿‘æ¥åŸå­é–“è·é›¢
    nearest_neighbor = 2 * r

    return {
        'structure': 'BCC',
        'lattice_constant': a,
        'atomic_radius': r,
        'atoms_per_cell': n_atoms,
        'packing_fraction': packing_fraction,
        'coordination_number': coordination_number,
        'nearest_neighbor': nearest_neighbor
    }

def calculate_hcp_properties(a, c_over_a=1.633):
    """HCPæ§‹é€ ã®ç‰©æ€§ã‚’è¨ˆç®—"""
    c = a * c_over_a

    # åŸå­åŠå¾„ï¼ˆæœ€è¿‘æ¥åŸå­é–“è·é›¢ã®åŠåˆ†ï¼‰
    r = a / 2

    # åŸå­æ•°
    n_atoms = 6

    # å˜ä½æ ¼å­ã®ä½“ç©ï¼ˆå…­è§’æŸ±ï¼‰
    V_cell = (3 * np.sqrt(3) / 2) * a**2 * c

    # åŸå­ã®ä½“ç©
    V_atom = (4/3) * np.pi * r**3

    # å……å¡«ç‡
    packing_fraction = (n_atoms * V_atom) / V_cell

    # é…ä½æ•°
    coordination_number = 12

    # æœ€è¿‘æ¥åŸå­é–“è·é›¢
    nearest_neighbor = 2 * r

    return {
        'structure': 'HCP',
        'lattice_constant_a': a,
        'lattice_constant_c': c,
        'c_over_a': c_over_a,
        'atomic_radius': r,
        'atoms_per_cell': n_atoms,
        'packing_fraction': packing_fraction,
        'coordination_number': coordination_number,
        'nearest_neighbor': nearest_neighbor
    }

# æ ¼å­å®šæ•°ï¼ˆä»»æ„ã®å˜ä½ï¼‰
a = 1.0

# å„æ§‹é€ ã®ç‰©æ€§ã‚’è¨ˆç®—
fcc_props = calculate_fcc_properties(a)
bcc_props = calculate_bcc_properties(a)
hcp_props = calculate_hcp_properties(a)

# çµæœã‚’è¡¨ç¤º
print("\nçµæ™¶æ§‹é€ ã®è©³ç´°ç‰©æ€§æ¯”è¼ƒ")
print("=" * 80)

for props in [fcc_props, bcc_props, hcp_props]:
    print(f"\nã€{props['structure']}æ§‹é€ ã€‘")
    print("-" * 80)
    if props['structure'] == 'HCP':
        print(f"  æ ¼å­å®šæ•° a:           {props['lattice_constant_a']:.4f}")
        print(f"  æ ¼å­å®šæ•° c:           {props['lattice_constant_c']:.4f}")
        print(f"  è»¸æ¯” c/a:             {props['c_over_a']:.4f}")
    else:
        print(f"  æ ¼å­å®šæ•°:             {props['lattice_constant']:.4f}")
    print(f"  åŸå­åŠå¾„:             {props['atomic_radius']:.4f}")
    print(f"  å˜ä½æ ¼å­ã‚ãŸã‚ŠåŸå­æ•°: {props['atoms_per_cell']}")
    print(f"  å……å¡«ç‡:               {props['packing_fraction']:.4f} ({props['packing_fraction']*100:.1f}%)")
    print(f"  é…ä½æ•°:               {props['coordination_number']}")
    print(f"  æœ€è¿‘æ¥åŸå­é–“è·é›¢:     {props['nearest_neighbor']:.4f}")

# è¦–è¦šåŒ–
structures = ['FCC', 'BCC', 'HCP']
packing_fractions = [fcc_props['packing_fraction'],
                     bcc_props['packing_fraction'],
                     hcp_props['packing_fraction']]
coordination_numbers = [fcc_props['coordination_number'],
                        bcc_props['coordination_number'],
                        hcp_props['coordination_number']]

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 6))

# å……å¡«ç‡ã®æ¯”è¼ƒ
colors = ['#FF6B6B', '#4ECDC4', '#95E1D3']
bars1 = ax1.bar(structures, [pf * 100 for pf in packing_fractions], color=colors, alpha=0.8, edgecolor='black', linewidth=2)
ax1.set_ylabel('å……å¡«ç‡ (%)', fontsize=12, fontweight='bold')
ax1.set_title('çµæ™¶æ§‹é€ ã®å……å¡«ç‡æ¯”è¼ƒ', fontsize=14, fontweight='bold')
ax1.set_ylim(0, 80)
ax1.grid(axis='y', alpha=0.3)

# ãƒãƒ¼ã«æ•°å€¤ã‚’è¡¨ç¤º
for bar in bars1:
    height = bar.get_height()
    ax1.text(bar.get_x() + bar.get_width()/2., height + 1,
             f'{height:.1f}%', ha='center', va='bottom', fontsize=11, fontweight='bold')

# é…ä½æ•°ã®æ¯”è¼ƒ
bars2 = ax2.bar(structures, coordination_numbers, color=colors, alpha=0.8, edgecolor='black', linewidth=2)
ax2.set_ylabel('é…ä½æ•°', fontsize=12, fontweight='bold')
ax2.set_title('çµæ™¶æ§‹é€ ã®é…ä½æ•°æ¯”è¼ƒ', fontsize=14, fontweight='bold')
ax2.set_ylim(0, 14)
ax2.grid(axis='y', alpha=0.3)

# ãƒãƒ¼ã«æ•°å€¤ã‚’è¡¨ç¤º
for bar in bars2:
    height = bar.get_height()
    ax2.text(bar.get_x() + bar.get_width()/2., height + 0.3,
             f'{int(height)}', ha='center', va='bottom', fontsize=11, fontweight='bold')

plt.tight_layout()
plt.savefig('crystal_properties_comparison.png', dpi=300, bbox_inches='tight')
plt.show()

print("\n" + "=" * 80)
print("âœ“ ã‚°ãƒ©ãƒ•ã‚’ 'crystal_properties_comparison.png' ã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ")
</code></pre>
            </div>
        </section>

        <section class="section">
            <h2>1.3 ãƒŸãƒ©ãƒ¼æŒ‡æ•°</h2>

            <p>çµæ™¶ä¸­ã®é¢ã‚„æ–¹ä½ã‚’è¡¨è¨˜ã™ã‚‹ãŸã‚ã«ã€ãƒŸãƒ©ãƒ¼æŒ‡æ•°ãŒç”¨ã„ã‚‰ã‚Œã¾ã™ã€‚ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¯ã€çµæ™¶æ§‹é€ ã®å¯¾ç§°æ€§ã‚’ç†è§£ã—ã€Xç·šå›æŠ˜ãƒ‡ãƒ¼ã‚¿ã‚’è§£æã™ã‚‹ä¸Šã§ä¸å¯æ¬ ã§ã™ã€‚</p>

            <h3>1.3.1 çµæ™¶é¢ã®è¡¨è¨˜ (hkl)</h3>

            <p>çµæ™¶é¢ã¯ã€3ã¤ã®æ•´æ•° $(h, k, l)$ ã§è¡¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã‚‰ã¯ã€ãã®é¢ãŒçµæ™¶è»¸ $a, b, c$ ã‚’åˆ‡ã‚‹ç‚¹ã®é€†æ•°ã®æ¯”ã‚’æœ€å°ã®æ•´æ•°ã§è¡¨ã—ãŸã‚‚ã®ã§ã™ã€‚</p>

            <div class="equation-block">
                <p><strong>ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®æ±‚ã‚æ–¹ï¼š</strong></p>
                <ol>
                    <li>é¢ãŒå„çµæ™¶è»¸ã‚’åˆ‡ã‚‹ç‚¹ã®åº§æ¨™ã‚’æ±‚ã‚ã‚‹ï¼ˆä¾‹ï¼š$x=2, y=3, z=6$ï¼‰</li>
                    <li>ãã®é€†æ•°ã‚’å–ã‚‹ï¼ˆä¾‹ï¼š$1/2, 1/3, 1/6$ï¼‰</li>
                    <li>æœ€å°å…¬å€æ•°ã‚’æ›ã‘ã¦æ•´æ•°ã«ã™ã‚‹ï¼ˆä¾‹ï¼š$\times 6$ ã§ $3, 2, 1$ï¼‰</li>
                    <li>$(hkl) = (321)$ ã¨è¡¨è¨˜</li>
                </ol>
            </div>

            <p>ä»£è¡¨çš„ãªé¢ï¼š</p>
            <ul>
                <li>$(100)$: $a$ è»¸ã«å‚ç›´ãªé¢</li>
                <li>$(110)$: $a$ è»¸ã¨ $b$ è»¸ã®ä¸¡æ–¹ã«æ–œã‚ã®é¢</li>
                <li>$(111)$: 3ã¤ã®è»¸ã™ã¹ã¦ã«ç­‰ã—ãå‚¾ã„ãŸé¢ï¼ˆFCC ã®æœ€å¯†å……å¡«é¢ï¼‰</li>
            </ul>

            <h3>1.3.2 çµæ™¶æ–¹ä½ã®è¡¨è¨˜ [uvw]</h3>

            <p>çµæ™¶æ–¹ä½ï¼ˆæ–¹å‘ï¼‰ã¯ã€è§’æ‹¬å¼§ $[uvw]$ ã§è¡¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã¯ã€åŸç‚¹ã‹ã‚‰ $(u, v, w)$ ã®ç‚¹ã¸å‘ã‹ã†ãƒ™ã‚¯ãƒˆãƒ«ã®æ–¹å‘ã‚’ç¤ºã—ã¾ã™ã€‚</p>

            <h3>1.3.3 é¢é–“éš”ã®è¨ˆç®—</h3>

            <p>ç«‹æ–¹æ™¶ç³»ã«ãŠã„ã¦ã€$(hkl)$ é¢ã®é¢é–“éš” $d_{hkl}$ ã¯æ¬¡ã®å¼ã§è¨ˆç®—ã•ã‚Œã¾ã™ï¼š</p>

            <div class="equation-block">
                $$d_{hkl} = \frac{a}{\sqrt{h^2 + k^2 + l^2}}$$
                <p>ã“ã“ã§ã€$a$ ã¯æ ¼å­å®šæ•°ã§ã™ã€‚</p>
            </div>

            <div class="code-example">
                <h4>ã‚³ãƒ¼ãƒ‰ä¾‹5: ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã¨é¢é–“éš”ã®è¨ˆç®—</h4>
                <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D
from mpl_toolkits.mplot3d.art3d import Poly3DCollection

def calculate_d_spacing(a, h, k, l, crystal_system='cubic'):
    """
    é¢é–“éš”ã‚’è¨ˆç®—

    Parameters:
    -----------
    a : float
        æ ¼å­å®šæ•°
    h, k, l : int
        ãƒŸãƒ©ãƒ¼æŒ‡æ•°
    crystal_system : str
        çµæ™¶ç³»ï¼ˆ'cubic', 'tetragonal', 'hexagonal'ãªã©ï¼‰

    Returns:
    --------
    d : float
        é¢é–“éš”
    """
    if crystal_system == 'cubic':
        d = a / np.sqrt(h**2 + k**2 + l**2)
    else:
        raise NotImplementedError(f"{crystal_system}ç³»ã¯æœªå®Ÿè£…ã§ã™")

    return d

def plot_plane(h, k, l, a=1.0, ax=None):
    """
    (hkl)é¢ã‚’å¯è¦–åŒ–

    Parameters:
    -----------
    h, k, l : int
        ãƒŸãƒ©ãƒ¼æŒ‡æ•°
    a : float
        æ ¼å­å®šæ•°
    ax : matplotlib axis
        ãƒ—ãƒ­ãƒƒãƒˆç”¨ã®è»¸
    """
    if ax is None:
        fig = plt.figure(figsize=(8, 8))
        ax = fig.add_subplot(111, projection='3d')

    # é¢ãŒè»¸ã‚’åˆ‡ã‚‹ç‚¹ã‚’è¨ˆç®—
    # h, k, l ãŒã‚¼ãƒ­ã®å ´åˆã¯ç„¡é™é ï¼ˆå®Ÿéš›ã«ã¯å¤§ããªå€¤ï¼‰
    intercepts = []
    for index in [h, k, l]:
        if index != 0:
            intercepts.append(a / index)
        else:
            intercepts.append(10 * a)  # å¤§ããªå€¤

    # é¢ã‚’æç”»ï¼ˆä¸‰è§’å½¢ã¨ã—ã¦è¿‘ä¼¼ï¼‰
    points = [
        [intercepts[0], 0, 0],
        [0, intercepts[1], 0],
        [0, 0, intercepts[2]]
    ]

    # é¢ã®å¤šè§’å½¢
    poly = [[points[0], points[1], points[2]]]
    ax.add_collection3d(Poly3DCollection(poly, alpha=0.5, facecolor='cyan', edgecolor='blue', linewidth=2))

    # åº§æ¨™è»¸ã‚’æç”»
    ax.plot([0, a], [0, 0], [0, 0], 'r-', linewidth=2, label='aè»¸')
    ax.plot([0, 0], [0, a], [0, 0], 'g-', linewidth=2, label='bè»¸')
    ax.plot([0, 0], [0, 0], [0, a], 'b-', linewidth=2, label='cè»¸')

    # åˆ‡ç‰‡ã«ãƒãƒ¼ã‚«ãƒ¼
    if h != 0:
        ax.scatter([intercepts[0]], [0], [0], c='red', s=100, marker='o')
    if k != 0:
        ax.scatter([0], [intercepts[1]], [0], c='green', s=100, marker='o')
    if l != 0:
        ax.scatter([0], [0], [intercepts[2]], c='blue', s=100, marker='o')

    ax.set_xlabel('X (aè»¸)', fontsize=11, fontweight='bold')
    ax.set_ylabel('Y (bè»¸)', fontsize=11, fontweight='bold')
    ax.set_zlabel('Z (cè»¸)', fontsize=11, fontweight='bold')
    ax.set_title(f'({h}{k}{l}) é¢', fontsize=13, fontweight='bold')

    max_val = max(intercepts) * 0.6
    ax.set_xlim([0, max_val])
    ax.set_ylim([0, max_val])
    ax.set_zlim([0, max_val])

    ax.legend(fontsize=9)

    return ax

# ä»£è¡¨çš„ãªé¢ã®å¯è¦–åŒ–
fig = plt.figure(figsize=(16, 5))

planes = [(1, 0, 0), (1, 1, 0), (1, 1, 1)]
a = 1.0

for i, (h, k, l) in enumerate(planes):
    ax = fig.add_subplot(1, 3, i+1, projection='3d')
    plot_plane(h, k, l, a, ax)

    # é¢é–“éš”ã‚’è¨ˆç®—ã—ã¦è¡¨ç¤º
    d = calculate_d_spacing(a, h, k, l)
    ax.text2D(0.05, 0.95, f'd = {d:.3f}a', transform=ax.transAxes, fontsize=11,
              verticalalignment='top', bbox=dict(boxstyle='round', facecolor='wheat', alpha=0.8))

plt.tight_layout()
plt.savefig('miller_indices_planes.png', dpi=300, bbox_inches='tight')
plt.show()

# ä¸»è¦ãªé¢ã®é¢é–“éš”ã‚’è¨ˆç®—
print("\nç«‹æ–¹æ™¶ç³»ã«ãŠã‘ã‚‹ä¸»è¦ãªé¢ã®é¢é–“éš”")
print("=" * 60)
print(f"{'é¢':<10} {'é¢é–“éš” (å˜ä½: a)':<20} {'ç›¸å¯¾å¼·åº¦'}")
print("-" * 60)

important_planes = [
    (1, 0, 0), (1, 1, 0), (1, 1, 1),
    (2, 0, 0), (2, 1, 0), (2, 1, 1),
    (2, 2, 0), (3, 1, 0), (2, 2, 2)
]

for h, k, l in important_planes:
    d = calculate_d_spacing(a, h, k, l)
    # æ§‹é€ å› å­ã«ã‚ˆã‚‹ç›¸å¯¾å¼·åº¦ï¼ˆç°¡æ˜“ç‰ˆã€FCC ã‚’ä»®å®šï¼‰
    if (h % 2 == 0 and k % 2 == 0 and l % 2 == 0) or \
       (h % 2 == 1 and k % 2 == 1 and l % 2 == 1):
        intensity = "å¼·"
    else:
        intensity = "æ¶ˆæ»… (FCC)"

    print(f"({h}{k}{l}){'':<7} {d:.4f} a{'':<15} {intensity}")

print("=" * 60)
print("\næ³¨ï¼šFCCæ§‹é€ ã§ã¯ã€ã™ã¹ã¦å¶æ•°ã¾ãŸã¯ã™ã¹ã¦å¥‡æ•°ã®(hkl)é¢ã®ã¿ãŒå›æŠ˜ã‚’ç¤ºã—ã¾ã™")
print("âœ“ ã‚°ãƒ©ãƒ•ã‚’ 'miller_indices_planes.png' ã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ")
</code></pre>
            </div>
        </section>

        <section class="section">
            <h2>1.4 Pythonå®Ÿè·µï¼šASE/pymatgenã«ã‚ˆã‚‹çµæ™¶æ§‹é€ ã®ç”Ÿæˆã¨è§£æ</h2>

            <p>å®Ÿéš›ã®ææ–™ç§‘å­¦ç ”ç©¶ã§ã¯ã€<code>pymatgen</code> ã‚„ <code>ASE</code>ï¼ˆAtomic Simulation Environmentï¼‰ã¨ã„ã£ãŸPythonãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ç”¨ã„ã¦çµæ™¶æ§‹é€ ã‚’ç”Ÿæˆãƒ»æ“ä½œã—ã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã¯ã€å¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰è¨ˆç®—ã¨ã®é€£æºã‚„ã€Materials Project ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚‚å¯èƒ½ã§ã™ã€‚</p>

            <div class="code-example">
                <h4>ã‚³ãƒ¼ãƒ‰ä¾‹6: ASEã«ã‚ˆã‚‹çµæ™¶æ§‹é€ ç”Ÿæˆã¨å¯è¦–åŒ–</h4>
                <pre><code class="language-python">"""
ASE (Atomic Simulation Environment) ã‚’ä½¿ç”¨ã—ãŸçµæ™¶æ§‹é€ ã®ç”Ÿæˆã¨è§£æ

æ³¨: ASEã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™: pip install ase
"""

try:
    from ase import Atoms
    from ase.build import bulk
    from ase.visualize import view
    import matplotlib.pyplot as plt
    from mpl_toolkits.mplot3d import Axes3D
    import numpy as np

    # å„ç¨®é‡‘å±ã®çµæ™¶æ§‹é€ ã‚’ç”Ÿæˆ
    structures = {}

    # éŠ…ï¼ˆFCCï¼‰
    cu = bulk('Cu', 'fcc', a=3.615)  # a = 3.615 Ã…
    structures['Cu (FCC)'] = cu

    # é‰„ï¼ˆBCCï¼‰
    fe = bulk('Fe', 'bcc', a=2.866)  # a = 2.866 Ã…
    structures['Fe (BCC)'] = fe

    # ãƒã‚°ãƒã‚·ã‚¦ãƒ ï¼ˆHCPï¼‰
    mg = bulk('Mg', 'hcp', a=3.209, c=5.211)  # a = 3.209 Ã…, c = 5.211 Ã…
    structures['Mg (HCP)'] = mg

    # ã‚¢ãƒ«ãƒŸãƒ‹ã‚¦ãƒ ï¼ˆFCCï¼‰
    al = bulk('Al', 'fcc', a=4.046)  # a = 4.046 Ã…
    structures['Al (FCC)'] = al

    # å„æ§‹é€ ã®æƒ…å ±ã‚’è¡¨ç¤º
    print("ASEã«ã‚ˆã‚‹é‡‘å±çµæ™¶æ§‹é€ ã®ç”Ÿæˆ")
    print("=" * 80)

    for name, atoms in structures.items():
        print(f"\nã€{name}ã€‘")
        print("-" * 80)
        print(f"  åŒ–å­¦å¼:         {atoms.get_chemical_formula()}")
        print(f"  åŸå­æ•°:         {len(atoms)}")
        print(f"  æ ¼å­å®šæ•° (Ã…):   a = {atoms.cell.cellpar()[0]:.3f}, "
              f"b = {atoms.cell.cellpar()[1]:.3f}, c = {atoms.cell.cellpar()[2]:.3f}")
        print(f"  ã‚»ãƒ«è§’åº¦ (deg): Î± = {atoms.cell.cellpar()[3]:.1f}, "
              f"Î² = {atoms.cell.cellpar()[4]:.1f}, Î³ = {atoms.cell.cellpar()[5]:.1f}")
        print(f"  ä½“ç© (Å²):      {atoms.get_volume():.3f}")
        print(f"  å¯†åº¦ (g/cmÂ³):   è¨ˆç®—å€¤ = {atoms.get_masses().sum() / atoms.get_volume() * 1.66054:.3f}")

    # ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ«ã®ä½œæˆï¼ˆCu ã® 2x2x2ï¼‰
    cu_supercell = cu.repeat((2, 2, 2))
    print(f"\n\nã€Cu ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚»ãƒ« (2Ã—2Ã—2)ã€‘")
    print("-" * 80)
    print(f"  åŸå­æ•°:         {len(cu_supercell)}")
    print(f"  ä½“ç© (Å²):      {cu_supercell.get_volume():.3f}")

    # 3Då¯è¦–åŒ–ç”¨ã®é–¢æ•°
    def plot_ase_structure(atoms, title, ax):
        """ASE Atomsã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’3Dãƒ—ãƒ­ãƒƒãƒˆ"""
        positions = atoms.get_positions()

        ax.scatter(positions[:, 0], positions[:, 1], positions[:, 2],
                   c='#FF6B6B', s=300, alpha=0.7, edgecolors='black', linewidth=1.5)

        # ã‚»ãƒ«ã®å¢ƒç•Œã‚’æç”»
        cell = atoms.cell

        # ã‚»ãƒ«ã®é ‚ç‚¹
        origin = np.array([0, 0, 0])
        vertices = [
            origin,
            cell[0],
            cell[1],
            cell[2],
            cell[0] + cell[1],
            cell[0] + cell[2],
            cell[1] + cell[2],
            cell[0] + cell[1] + cell[2]
        ]

        # ã‚»ãƒ«ã®ã‚¨ãƒƒã‚¸
        edges = [
            (0, 1), (0, 2), (0, 3),
            (1, 4), (1, 5), (2, 4),
            (2, 6), (3, 5), (3, 6),
            (4, 7), (5, 7), (6, 7)
        ]

        for i, j in edges:
            edge = np.array([vertices[i], vertices[j]])
            ax.plot3D(edge[:, 0], edge[:, 1], edge[:, 2], 'k-', linewidth=1, alpha=0.6)

        ax.set_xlabel('X (Ã…)', fontsize=10, fontweight='bold')
        ax.set_ylabel('Y (Ã…)', fontsize=10, fontweight='bold')
        ax.set_zlabel('Z (Ã…)', fontsize=10, fontweight='bold')
        ax.set_title(title, fontsize=12, fontweight='bold', pad=10)
        ax.set_box_aspect([1, 1, 1])

    # ãƒ—ãƒ­ãƒƒãƒˆ
    fig = plt.figure(figsize=(16, 5))

    plot_structures = [(cu, 'Cu (FCC)'), (fe, 'Fe (BCC)'), (mg, 'Mg (HCP)')]

    for i, (atoms, name) in enumerate(plot_structures):
        ax = fig.add_subplot(1, 3, i+1, projection='3d')
        plot_ase_structure(atoms, name, ax)

    plt.tight_layout()
    plt.savefig('ase_crystal_structures.png', dpi=300, bbox_inches='tight')
    plt.show()

    print("\n" + "=" * 80)
    print("âœ“ ã‚°ãƒ©ãƒ•ã‚’ 'ase_crystal_structures.png' ã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ")
    print("\nâ€» ASEã§ã¯ atoms.edit() ã¾ãŸã¯ from ase.visualize import view; view(atoms) ã§")
    print("  ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãª3Då¯è¦–åŒ–ãŒå¯èƒ½ã§ã™ï¼ˆGUIç’°å¢ƒãŒå¿…è¦ï¼‰")

except ImportError:
    print("ã‚¨ãƒ©ãƒ¼: ASEãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“")
    print("ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•: pip install ase")
    print("\nä»£æ›¿ã¨ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ‰‹å‹•ã§çµæ™¶æ§‹é€ ã‚’å®šç¾©ã§ãã¾ã™ï¼š")
    print("""
import numpy as np

# FCCæ§‹é€ ã®æ‰‹å‹•å®šç¾©
a = 3.615  # éŠ…ã®æ ¼å­å®šæ•° (Ã…)
fcc_positions = np.array([
    [0.0, 0.0, 0.0],
    [0.5*a, 0.5*a, 0.0],
    [0.5*a, 0.0, 0.5*a],
    [0.0, 0.5*a, 0.5*a]
])
print("FCCåŸå­åº§æ¨™ (Ã…):")
print(fcc_positions)
""")
</code></pre>
            </div>

            <div class="code-example">
                <h4>ã‚³ãƒ¼ãƒ‰ä¾‹7: pymatgenã«ã‚ˆã‚‹çµæ™¶æ§‹é€ ã®é«˜åº¦ãªè§£æ</h4>
                <pre><code class="language-python">"""
pymatgen ã‚’ä½¿ç”¨ã—ãŸçµæ™¶æ§‹é€ ã®é«˜åº¦ãªè§£æ

æ³¨: pymatgenã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦ã§ã™: pip install pymatgen
"""

try:
    from pymatgen.core import Structure, Lattice
    from pymatgen.analysis.structure_analyzer import SpacegroupAnalyzer
    from pymatgen.symmetry.analyzer import SpacegroupAnalyzer as SGA
    import numpy as np

    # éŠ…ï¼ˆFCCï¼‰ã®æ§‹é€ ã‚’ç”Ÿæˆ
    lattice_cu = Lattice.cubic(3.615)  # a = 3.615 Ã…
    species_cu = ['Cu'] * 4
    coords_cu = [
        [0.0, 0.0, 0.0],
        [0.5, 0.5, 0.0],
        [0.5, 0.0, 0.5],
        [0.0, 0.5, 0.5]
    ]
    cu_structure = Structure(lattice_cu, species_cu, coords_cu)

    # é‰„ï¼ˆBCCï¼‰ã®æ§‹é€ ã‚’ç”Ÿæˆ
    lattice_fe = Lattice.cubic(2.866)  # a = 2.866 Ã…
    species_fe = ['Fe'] * 2
    coords_fe = [
        [0.0, 0.0, 0.0],
        [0.5, 0.5, 0.5]
    ]
    fe_structure = Structure(lattice_fe, species_fe, coords_fe)

    # ãƒã‚°ãƒã‚·ã‚¦ãƒ ï¼ˆHCPï¼‰ã®æ§‹é€ ã‚’ç”Ÿæˆ
    a_mg = 3.209
    c_mg = 5.211
    lattice_mg = Lattice.hexagonal(a_mg, c_mg)
    species_mg = ['Mg'] * 2
    coords_mg = [
        [1/3, 2/3, 1/4],
        [2/3, 1/3, 3/4]
    ]
    mg_structure = Structure(lattice_mg, species_mg, coords_mg)

    structures = {
        'Cu (FCC)': cu_structure,
        'Fe (BCC)': fe_structure,
        'Mg (HCP)': mg_structure
    }

    print("pymatgenã«ã‚ˆã‚‹çµæ™¶æ§‹é€ ã®è©³ç´°è§£æ")
    print("=" * 80)

    for name, structure in structures.items():
        print(f"\nã€{name}ã€‘")
        print("-" * 80)

        # åŸºæœ¬æƒ…å ±
        print(f"  åŒ–å­¦å¼:           {structure.composition.reduced_formula}")
        print(f"  ç©ºé–“ç¾¤:           ", end="")

        try:
            sga = SpacegroupAnalyzer(structure)
            spacegroup = sga.get_space_group_symbol()
            spacegroup_number = sga.get_space_group_number()
            print(f"{spacegroup} (No. {spacegroup_number})")

            # å¯¾ç§°æ“ä½œã®æ•°
            print(f"  å¯¾ç§°æ“ä½œã®æ•°:     {len(sga.get_symmetry_operations())}")

            # ç‚¹ç¾¤
            print(f"  ç‚¹ç¾¤:             {sga.get_point_group_symbol()}")

        except Exception as e:
            print(f"è§£æã‚¨ãƒ©ãƒ¼: {e}")

        # æ ¼å­æƒ…å ±
        abc = structure.lattice.abc
        angles = structure.lattice.angles
        print(f"  æ ¼å­å®šæ•° (Ã…):     a = {abc[0]:.3f}, b = {abc[1]:.3f}, c = {abc[2]:.3f}")
        print(f"  æ ¼å­è§’åº¦ (deg):   Î± = {angles[0]:.1f}, Î² = {angles[1]:.1f}, Î³ = {angles[2]:.1f}")
        print(f"  ä½“ç© (Å²):        {structure.volume:.3f}")
        print(f"  å¯†åº¦ (g/cmÂ³):     {structure.density:.3f}")

        # æœ€è¿‘æ¥åŸå­é–“è·é›¢
        print(f"\n  æœ€è¿‘æ¥åŸå­é–“è·é›¢:")
        all_nn_distances = []
        for i, site in enumerate(structure):
            neighbors = structure.get_neighbors(site, 4.0)  # 4 Ã…ä»¥å†…
            if neighbors:
                nn_dist = min([neighbor[1] for neighbor in neighbors])
                all_nn_distances.append(nn_dist)

        if all_nn_distances:
            avg_nn = np.mean(all_nn_distances)
            print(f"    å¹³å‡: {avg_nn:.3f} Ã…")
            print(f"    ç¯„å›²: {min(all_nn_distances):.3f} - {max(all_nn_distances):.3f} Ã…")

    # æ§‹é€ ã®æ¯”è¼ƒ
    print("\n\nã€æ§‹é€ æ¯”è¼ƒã€‘")
    print("=" * 80)
    print(f"{'æ§‹é€ ':<15} {'ç©ºé–“ç¾¤':<15} {'å¯†åº¦ (g/cmÂ³)':<15} {'æœ€è¿‘æ¥è·é›¢ (Ã…)'}")
    print("-" * 80)

    for name, structure in structures.items():
        try:
            sga = SpacegroupAnalyzer(structure)
            sg = sga.get_space_group_symbol()
        except:
            sg = "N/A"

        neighbors = structure.get_neighbors(structure[0], 4.0)
        if neighbors:
            nn_dist = min([neighbor[1] for neighbor in neighbors])
        else:
            nn_dist = 0.0

        print(f"{name:<15} {sg:<15} {structure.density:<15.3f} {nn_dist:.3f}")

    print("=" * 80)
    print("\nâœ“ pymatgenã«ã‚ˆã‚‹è§£æãŒå®Œäº†ã—ã¾ã—ãŸ")

    # CIFå½¢å¼ã§ä¿å­˜
    print("\næ§‹é€ ã‚’CIFå½¢å¼ã§ä¿å­˜:")
    for name, structure in structures.items():
        filename = name.replace(' ', '_').replace('(', '').replace(')', '') + '.cif'
        structure.to(filename=filename, fmt='cif')
        print(f"  âœ“ {filename}")

except ImportError:
    print("ã‚¨ãƒ©ãƒ¼: pymatgenãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã¾ã›ã‚“")
    print("ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•: pip install pymatgen")
    print("\npymatgenã¯ææ–™ç§‘å­¦ç ”ç©¶ã§åºƒãä½¿ã‚ã‚Œã¦ã„ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã€ä»¥ä¸‹ã®æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ï¼š")
    print("  - çµæ™¶æ§‹é€ ã®ç”Ÿæˆãƒ»æ“ä½œãƒ»è§£æ")
    print("  - ç©ºé–“ç¾¤ãƒ»ç‚¹ç¾¤ã®è‡ªå‹•åˆ¤å®š")
    print("  - Materials Projectãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹")
    print("  - å¯†åº¦æ±é–¢æ•°ç†è«–ï¼ˆDFTï¼‰è¨ˆç®—ã¨ã®é€£æº")
    print("  - ç›¸å›³ãƒ»çŠ¶æ…‹å›³ã®è¨ˆç®—")
</code></pre>
            </div>
        </section>

        <section class="exercise-section">
            <h3>æ¼”ç¿’å•é¡Œ</h3>

            <div class="exercise">
                <div class="exercise-header">
                    <h4>æ¼”ç¿’ 1.1</h4>
                    <span class="difficulty easy">Easy</span>
                </div>
                <p><strong>å•é¡Œï¼š</strong>éŠ…ï¼ˆCuï¼‰ã®é›»å­å¯†åº¦ã¯ $n = 8.45 \times 10^{28}$ mâ»Â³ã€ç·©å’Œæ™‚é–“ã¯ $\tau = 2.5 \times 10^{-14}$ s ã§ã™ã€‚Drudeãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦éŠ…ã®é›»æ°—ä¼å°åº¦ $\sigma$ ã¨é›»æ°—æŠµæŠ—ç‡ $\rho$ ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¡¨ç¤º</summary>
                    <div class="solution">
                        <pre><code class="language-python">import numpy as np

# ç‰©ç†å®šæ•°
e = 1.602e-19  # é›»å­ã®é›»è· (C)
m_e = 9.109e-31  # é›»å­ã®è³ªé‡ (kg)

# éŠ…ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
n = 8.45e28  # é›»å­å¯†åº¦ (m^-3)
tau = 2.5e-14  # ç·©å’Œæ™‚é–“ (s)

# é›»æ°—ä¼å°åº¦ã®è¨ˆç®—
sigma = (n * e**2 * tau) / m_e

# é›»æ°—æŠµæŠ—ç‡ã®è¨ˆç®—
rho = 1 / sigma

print("=" * 60)
print("éŠ…ã®é›»æ°—ä¼å°åº¦ã¨é›»æ°—æŠµæŠ—ç‡ï¼ˆDrudeãƒ¢ãƒ‡ãƒ«ï¼‰")
print("=" * 60)
print(f"\nä¸ãˆã‚‰ã‚ŒãŸå€¤:")
print(f"  é›»å­å¯†åº¦ n:    {n:.2e} m^-3")
print(f"  ç·©å’Œæ™‚é–“ Ï„:    {tau:.2e} s")
print(f"\nè¨ˆç®—çµæœ:")
print(f"  é›»æ°—ä¼å°åº¦ Ïƒ:  {sigma:.3e} S/m")
print(f"  é›»æ°—æŠµæŠ—ç‡ Ï:  {rho:.3e} Î©Â·m")
print(f"                 {rho * 1e8:.2f} Î¼Î©Â·cm")
print(f"\nå‚è€ƒ: å®Ÿæ¸¬å€¤ã¯ç´„ 1.68 Î¼Î©Â·cmï¼ˆå®¤æ¸©ï¼‰")
print("=" * 60)

# èª¬æ˜
print("\nã€è¨ˆç®—ã®èª¬æ˜ã€‘")
print("-" * 60)
print("Drudeãƒ¢ãƒ‡ãƒ«ã®é›»æ°—ä¼å°åº¦ã®å¼:")
print("  Ïƒ = (n Ã— eÂ² Ã— Ï„) / m")
print("\nã“ã“ã§ã€")
print("  n  : é›»å­å¯†åº¦")
print("  e  : é›»å­ã®é›»è· (1.602 Ã— 10â»Â¹â¹ C)")
print("  Ï„  : ç·©å’Œæ™‚é–“ï¼ˆé›»å­ãŒæ•£ä¹±ã•ã‚Œã‚‹ã¾ã§ã®å¹³å‡æ™‚é–“ï¼‰")
print("  m  : é›»å­ã®è³ªé‡ (9.109 Ã— 10â»Â³Â¹ kg)")
print("\né›»æ°—æŠµæŠ—ç‡ã¯é›»æ°—ä¼å°åº¦ã®é€†æ•°:")
print("  Ï = 1 / Ïƒ")
print("-" * 60)

# æ¤œè¨¼
print("\nã€çµæœã®æ¤œè¨¼ã€‘")
print("-" * 60)
theoretical = rho * 1e8
experimental = 1.68
error = abs(theoretical - experimental) / experimental * 100
print(f"ç†è«–å€¤ï¼ˆDrudeãƒ¢ãƒ‡ãƒ«ï¼‰: {theoretical:.2f} Î¼Î©Â·cm")
print(f"å®Ÿæ¸¬å€¤ï¼ˆå®¤æ¸©ï¼‰:         {experimental:.2f} Î¼Î©Â·cm")
print(f"èª¤å·®:                   {error:.1f}%")
print("\nDrudeãƒ¢ãƒ‡ãƒ«ã¯å¤å…¸çš„ãªè¿‘ä¼¼ã§ã™ãŒã€")
print("ã‚ªãƒ¼ãƒ€ãƒ¼ã¯åˆã£ã¦ãŠã‚Šã€é‡‘å±ã®é›»æ°—ä¼å°æ€§ã‚’")
print("å®šæ€§çš„ã«èª¬æ˜ã§ãã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚")
print("=" * 60)
</code></pre>
                    </div>
                </details>
            </div>

            <div class="exercise">
                <div class="exercise-header">
                    <h4>æ¼”ç¿’ 1.2</h4>
                    <span class="difficulty easy">Easy</span>
                </div>
                <p><strong>å•é¡Œï¼š</strong>FCCæ§‹é€ ã«ãŠã„ã¦ã€æ ¼å­å®šæ•° $a = 4.05$ Ã…ã®ã¨ãã€ä»¥ä¸‹ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ï¼š</p>
                <ol>
                    <li>åŸå­åŠå¾„ $r$</li>
                    <li>å……å¡«ç‡</li>
                    <li>å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°</li>
                </ol>

                <details>
                    <summary>è§£ç­”ã‚’è¡¨ç¤º</summary>
                    <div class="solution">
                        <pre><code class="language-python">import numpy as np

# æ ¼å­å®šæ•°
a = 4.05  # Ã…

print("=" * 70)
print("FCCæ§‹é€ ã®è¨ˆç®—å•é¡Œ")
print("=" * 70)
print(f"\nä¸ãˆã‚‰ã‚ŒãŸå€¤:")
print(f"  æ ¼å­å®šæ•° a = {a} Ã…")

# (1) åŸå­åŠå¾„ã®è¨ˆç®—
# FCC ã§ã¯ã€é¢å¯¾è§’ç·šä¸Šã«åŸå­ãŒæ¥è§¦ã—ã¦ã„ã‚‹
# é¢å¯¾è§’ç·šã®é•·ã• = 4r = aâˆš2
r = a / (2 * np.sqrt(2))

print(f"\n(1) åŸå­åŠå¾„ã®è¨ˆç®—:")
print(f"    FCCæ§‹é€ ã§ã¯ã€é¢å¯¾è§’ç·šä¸Šã«åŸå­ãŒæ¥è§¦ã—ã¦ã„ã¾ã™ã€‚")
print(f"    é¢å¯¾è§’ç·šã®é•·ã• = 4r = aâˆš2")
print(f"    ã—ãŸãŒã£ã¦ã€r = a / (2âˆš2)")
print(f"    ")
print(f"    è¨ˆç®—: r = {a} / (2âˆš2)")
print(f"           = {a} / {2 * np.sqrt(2):.4f}")
print(f"           = {r:.4f} Ã…")

# (2) å……å¡«ç‡ã®è¨ˆç®—
# å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°
n_atoms = 4

# å˜ä½æ ¼å­ã®ä½“ç©
V_cell = a**3

# åŸå­ã®ä½“ç©ï¼ˆçƒã¨ã—ã¦ï¼‰
V_atom = (4/3) * np.pi * r**3

# å……å¡«ç‡
packing_fraction = (n_atoms * V_atom) / V_cell

print(f"\n(2) å……å¡«ç‡ã®è¨ˆç®—:")
print(f"    å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°: n = {n_atoms}")
print(f"    å˜ä½æ ¼å­ã®ä½“ç©: V_cell = aÂ³ = {a}Â³ = {V_cell:.3f} Å³")
print(f"    åŸå­1å€‹ã®ä½“ç©: V_atom = (4/3)Ï€rÂ³ = {V_atom:.3f} Å³")
print(f"    ")
print(f"    å……å¡«ç‡ = (n Ã— V_atom) / V_cell")
print(f"           = ({n_atoms} Ã— {V_atom:.3f}) / {V_cell:.3f}")
print(f"           = {packing_fraction:.4f}")
print(f"           = {packing_fraction * 100:.2f}%")

# ç†è«–å€¤ã¨ã®æ¯”è¼ƒ
theoretical_packing = np.pi / (3 * np.sqrt(2))
print(f"    ")
print(f"    ç†è«–å€¤: Ï€ / (3âˆš2) = {theoretical_packing:.4f} = {theoretical_packing * 100:.2f}%")

# (3) å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°
print(f"\n(3) å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°:")
print(f"    é ‚ç‚¹ã®åŸå­: 8å€‹ã®é ‚ç‚¹ Ã— 1/8 = 1å€‹")
print(f"    é¢å¿ƒã®åŸå­: 6å€‹ã®é¢ Ã— 1/2 = 3å€‹")
print(f"    åˆè¨ˆ:       1 + 3 = {n_atoms}å€‹")

# ã¾ã¨ã‚
print("\n" + "=" * 70)
print("ã€è§£ç­”ã¾ã¨ã‚ã€‘")
print("=" * 70)
print(f"(1) åŸå­åŠå¾„ r:              {r:.4f} Ã… = {r * 100:.2f} pm")
print(f"(2) å……å¡«ç‡:                  {packing_fraction:.4f} = {packing_fraction * 100:.2f}%")
print(f"(3) å˜ä½æ ¼å­ã‚ãŸã‚Šã®åŸå­æ•°:  {n_atoms}å€‹")
print("=" * 70)

# è£œè¶³æƒ…å ±
print("\nã€è£œè¶³ã€‘")
print("-" * 70)
print("FCCæ§‹é€ ã®ç‰¹å¾´:")
print("  - æœ€å¯†å……å¡«æ§‹é€ ã®ä¸€ã¤ï¼ˆå……å¡«ç‡ 74%ï¼‰")
print("  - é…ä½æ•°: 12")
print("  - ã™ã¹ã‚Šç³»ãŒå¤šãã€å»¶æ€§ãŒé«˜ã„")
print("  - ä»£è¡¨çš„ãªé‡‘å±: Cu, Al, Au, Ag, Ni, Pb")
print("-" * 70)
</code></pre>
                    </div>
                </details>
            </div>

            <div class="exercise">
                <div class="exercise-header">
                    <h4>æ¼”ç¿’ 1.3</h4>
                    <span class="difficulty medium">Medium</span>
                </div>
                <p><strong>å•é¡Œï¼š</strong>ç«‹æ–¹æ™¶ç³»ã®çµæ™¶ã«ãŠã„ã¦ã€æ ¼å­å®šæ•° $a = 3.5$ Ã… ã®ã¨ãã€ä»¥ä¸‹ã®é¢ã®é¢é–“éš”ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ï¼š$(100)$, $(110)$, $(111)$, $(200)$, $(220)$</p>

                <details>
                    <summary>è§£ç­”ã‚’è¡¨ç¤º</summary>
                    <div class="solution">
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def calculate_d_spacing(a, h, k, l):
    """
    ç«‹æ–¹æ™¶ç³»ã®é¢é–“éš”ã‚’è¨ˆç®—

    Parameters:
    -----------
    a : float
        æ ¼å­å®šæ•° (Ã…)
    h, k, l : int
        ãƒŸãƒ©ãƒ¼æŒ‡æ•°

    Returns:
    --------
    d : float
        é¢é–“éš” (Ã…)
    """
    d = a / np.sqrt(h**2 + k**2 + l**2)
    return d

# æ ¼å­å®šæ•°
a = 3.5  # Ã…

# è¨ˆç®—ã™ã‚‹é¢
planes = [
    (1, 0, 0),
    (1, 1, 0),
    (1, 1, 1),
    (2, 0, 0),
    (2, 2, 0)
]

print("=" * 80)
print("ç«‹æ–¹æ™¶ç³»ã«ãŠã‘ã‚‹é¢é–“éš”ã®è¨ˆç®—")
print("=" * 80)
print(f"\nä¸ãˆã‚‰ã‚ŒãŸå€¤:")
print(f"  æ ¼å­å®šæ•° a = {a} Ã…")
print(f"\nç«‹æ–¹æ™¶ç³»ã®é¢é–“éš”ã®å…¬å¼:")
print(f"  d_hkl = a / âˆš(hÂ² + kÂ² + lÂ²)")

print(f"\nè¨ˆç®—çµæœ:")
print("=" * 80)
print(f"{'(hkl)':<8} {'hÂ²+kÂ²+lÂ²':<12} {'âˆš(hÂ²+kÂ²+lÂ²)':<18} {'d_hkl (Ã…)':<15}")
print("-" * 80)

d_values = []
plane_labels = []

for h, k, l in planes:
    sum_squares = h**2 + k**2 + l**2
    sqrt_sum = np.sqrt(sum_squares)
    d = calculate_d_spacing(a, h, k, l)
    d_values.append(d)
    plane_labels.append(f"({h}{k}{l})")

    print(f"({h}{k}{l}){'':<5} {sum_squares:<12} {sqrt_sum:<18.4f} {d:.4f}")

print("=" * 80)

# é¢é–“éš”ã®å¯è¦–åŒ–
fig, ax = plt.subplots(figsize=(12, 7))

colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#FFA07A', '#98D8C8']
bars = ax.bar(plane_labels, d_values, color=colors, alpha=0.8, edgecolor='black', linewidth=2)

ax.set_ylabel('é¢é–“éš” d (Ã…)', fontsize=13, fontweight='bold')
ax.set_xlabel('ãƒŸãƒ©ãƒ¼æŒ‡æ•° (hkl)', fontsize=13, fontweight='bold')
ax.set_title(f'ç«‹æ–¹æ™¶ç³»ã®é¢é–“éš”ï¼ˆa = {a} Ã…ï¼‰', fontsize=15, fontweight='bold', pad=15)
ax.grid(axis='y', alpha=0.3, linestyle='--')

# ãƒãƒ¼ã«æ•°å€¤ã‚’è¡¨ç¤º
for bar, d in zip(bars, d_values):
    height = bar.get_height()
    ax.text(bar.get_x() + bar.get_width()/2., height + 0.05,
            f'{d:.3f} Ã…', ha='center', va='bottom', fontsize=11, fontweight='bold')

plt.tight_layout()
plt.savefig('d_spacing_comparison.png', dpi=300, bbox_inches='tight')
plt.show()

print("\nâœ“ ã‚°ãƒ©ãƒ•ã‚’ 'd_spacing_comparison.png' ã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ")

# Xç·šå›æŠ˜ã¸ã®å¿œç”¨
print("\nã€Xç·šå›æŠ˜ã¸ã®å¿œç”¨ã€‘")
print("=" * 80)
print("Braggã®æ³•å‰‡: 2d sinÎ¸ = nÎ»")
print(f"\nCu KÎ±ç·šï¼ˆÎ» = 1.5418 Ã…ï¼‰ã‚’ä½¿ã£ãŸå ´åˆã®å›æŠ˜è§’ 2Î¸:")
print("-" * 80)

lambda_cu = 1.5418  # Ã…

for (h, k, l), d in zip(planes, d_values):
    if d > lambda_cu / 2:  # Braggæ¡ä»¶ã‚’æº€ãŸã™å ´åˆã®ã¿
        sin_theta = lambda_cu / (2 * d)
        theta = np.arcsin(sin_theta) * 180 / np.pi
        two_theta = 2 * theta
        print(f"({h}{k}{l}):  d = {d:.4f} Ã…  â†’  2Î¸ = {two_theta:.2f}Â°")
    else:
        print(f"({h}{k}{l}):  d = {d:.4f} Ã…  â†’  å›æŠ˜ãªã—ï¼ˆÎ»/2 ã‚ˆã‚Šå°ã•ã„ï¼‰")

print("=" * 80)

# é¢é–“éš”ã®é †åº
print("\nã€é¢é–“éš”ã®é †åºã€‘")
print("-" * 80)
sorted_indices = np.argsort(d_values)[::-1]  # é™é †
print("é¢é–“éš”ã®å¤§ãã„é †:")
for i, idx in enumerate(sorted_indices):
    h, k, l = planes[idx]
    print(f"  {i+1}. ({h}{k}{l}): {d_values[idx]:.4f} Ã…")
print("-" * 80)
</code></pre>
                    </div>
                </details>
            </div>

            <div class="exercise">
                <div class="exercise-header">
                    <h4>æ¼”ç¿’ 1.4</h4>
                    <span class="difficulty medium">Medium</span>
                </div>
                <p><strong>å•é¡Œï¼š</strong>éŠ…ï¼ˆCuï¼‰ã®ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ 7.05 eV ã§ã™ã€‚ä»¥ä¸‹ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„ï¼š</p>
                <ol>
                    <li>çµ¶å¯¾é›¶åº¦ï¼ˆ0 Kï¼‰ã¨å®¤æ¸©ï¼ˆ300 Kï¼‰ã«ãŠã‘ã‚‹ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒã‚’è¨ˆç®—ã—ã€ã‚°ãƒ©ãƒ•ã§æ¯”è¼ƒã—ã¦ãã ã•ã„</li>
                    <li>ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦ï¼ˆãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã«å¯¾å¿œã™ã‚‹é›»å­ã®é€Ÿåº¦ï¼‰ã‚’è¨ˆç®—ã—ã¦ãã ã•ã„</li>
                </ol>

                <details>
                    <summary>è§£ç­”ã‚’è¡¨ç¤º</summary>
                    <div class="solution">
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from scipy import constants

# ç‰©ç†å®šæ•°
k_B = constants.k  # ãƒœãƒ«ãƒ„ãƒãƒ³å®šæ•° (J/K)
e = constants.e  # é›»å­ã®é›»è· (C)
m_e = constants.m_e  # é›»å­ã®è³ªé‡ (kg)

# éŠ…ã®ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼
E_F_eV = 7.05  # eV
E_F = E_F_eV * e  # J ã«å¤‰æ›

print("=" * 80)
print("éŠ…ã®ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒã¨ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦ã®è¨ˆç®—")
print("=" * 80)
print(f"\nä¸ãˆã‚‰ã‚ŒãŸå€¤:")
print(f"  ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ E_F = {E_F_eV} eV = {E_F:.3e} J")

# (1) ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒã®è¨ˆç®—
def fermi_dirac(E, E_F, T):
    """
    ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒé–¢æ•°

    Parameters:
    -----------
    E : array-like
        ã‚¨ãƒãƒ«ã‚®ãƒ¼ (J)
    E_F : float
        ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ (J)
    T : float
        æ¸©åº¦ (K)

    Returns:
    --------
    f : array-like
        å æœ‰ç¢ºç‡
    """
    if T == 0:
        return np.where(E <= E_F, 1.0, 0.0)
    else:
        # ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼å¯¾ç­–
        x = (E - E_F) / (k_B * T)
        x = np.clip(x, -100, 100)
        return 1 / (1 + np.exp(x))

# ã‚¨ãƒãƒ«ã‚®ãƒ¼ç¯„å›²ï¼ˆeVå˜ä½ã§è¨­å®šï¼‰
E_range_eV = np.linspace(0, 15, 1000)
E_range = E_range_eV * e  # J ã«å¤‰æ›

# 0 K ã¨ 300 K ã§ã®åˆ†å¸ƒ
f_0K = fermi_dirac(E_range, E_F, 0)
f_300K = fermi_dirac(E_range, E_F, 300)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³: åˆ†å¸ƒé–¢æ•°ã®æ¯”è¼ƒ
ax1.plot(E_range_eV, f_0K, 'b-', linewidth=2.5, label='T = 0 K')
ax1.plot(E_range_eV, f_300K, 'r-', linewidth=2.5, label='T = 300 K')
ax1.axvline(E_F_eV, color='green', linestyle='--', linewidth=2, label=f'$E_F$ = {E_F_eV} eV')
ax1.fill_between(E_range_eV, 0, f_300K, alpha=0.2, color='red')
ax1.set_xlabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12, fontweight='bold')
ax1.set_ylabel('å æœ‰ç¢ºç‡ f(E)', fontsize=12, fontweight='bold')
ax1.set_title('ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒã®æ¸©åº¦ä¾å­˜æ€§', fontsize=13, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(True, alpha=0.3)
ax1.set_xlim(0, 15)
ax1.set_ylim(-0.05, 1.05)

# å³å›³: ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ä»˜è¿‘ã®æ‹¡å¤§å›³
E_zoom_eV = np.linspace(E_F_eV - 1, E_F_eV + 1, 500)
E_zoom = E_zoom_eV * e
f_zoom_0K = fermi_dirac(E_zoom, E_F, 0)
f_zoom_300K = fermi_dirac(E_zoom, E_F, 300)

ax2.plot(E_zoom_eV, f_zoom_0K, 'b-', linewidth=2.5, label='T = 0 K')
ax2.plot(E_zoom_eV, f_zoom_300K, 'r-', linewidth=2.5, label='T = 300 K')
ax2.axvline(E_F_eV, color='green', linestyle='--', linewidth=2, label=f'$E_F$ = {E_F_eV} eV')
ax2.axhline(0.5, color='gray', linestyle=':', linewidth=1.5, alpha=0.7)
ax2.set_xlabel('ã‚¨ãƒãƒ«ã‚®ãƒ¼ (eV)', fontsize=12, fontweight='bold')
ax2.set_ylabel('å æœ‰ç¢ºç‡ f(E)', fontsize=12, fontweight='bold')
ax2.set_title('ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ä»˜è¿‘ã®æ‹¡å¤§å›³', fontsize=13, fontweight='bold')
ax2.legend(fontsize=11)
ax2.grid(True, alpha=0.3)
ax2.set_xlim(E_F_eV - 1, E_F_eV + 1)
ax2.set_ylim(-0.05, 1.05)

plt.tight_layout()
plt.savefig('fermi_dirac_temperature_comparison.png', dpi=300, bbox_inches='tight')
plt.show()

print("\n(1) ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒ:")
print("-" * 80)
print(f"  0 K:   E < E_F ã§ã¯ã™ã¹ã¦ã®çŠ¶æ…‹ãŒå æœ‰ (f = 1)")
print(f"         E > E_F ã§ã¯ã™ã¹ã¦ã®çŠ¶æ…‹ãŒç©º (f = 0)")
print(f"         ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°ã¨ã—ã¦æŒ¯ã‚‹èˆã†")
print(f"  ")
print(f"  300 K: E = E_F ã§ f = 0.5")
print(f"         ç†±ã‚¨ãƒãƒ«ã‚®ãƒ¼ k_B T = {k_B * 300 / e * 1000:.2f} meV ç¨‹åº¦ã®å¹…ã§")
print(f"         åˆ†å¸ƒãŒã€Œã¼ã‘ã‚‹ã€")
print(f"         ã—ã‹ã—ã€E_F = {E_F_eV} eV >> k_B T ãªã®ã§ã€")
print(f"         ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°ã«è¿‘ã„å½¢ã‚’ä¿ã¤")

# (2) ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦ã®è¨ˆç®—
# E_F = (1/2) m v_F^2 ã‚ˆã‚Š v_F = âˆš(2 E_F / m)
v_F = np.sqrt(2 * E_F / m_e)

print(f"\n(2) ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦ã®è¨ˆç®—:")
print("-" * 80)
print(f"  ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨é›»å­ã®é‹å‹•ã‚¨ãƒãƒ«ã‚®ãƒ¼ã®é–¢ä¿‚:")
print(f"    E_F = (1/2) m v_FÂ²")
print(f"  ")
print(f"  ã—ãŸãŒã£ã¦ã€ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦ã¯:")
print(f"    v_F = âˆš(2 E_F / m)")
print(f"  ")
print(f"  è¨ˆç®—:")
print(f"    v_F = âˆš(2 Ã— {E_F:.3e} J / {m_e:.3e} kg)")
print(f"        = {v_F:.3e} m/s")
print(f"        = {v_F / 1e6:.3f} Ã— 10â¶ m/s")
print(f"  ")
print(f"  å…‰é€Ÿ c = {constants.c:.3e} m/s ã¨ã®æ¯”:")
print(f"    v_F / c = {v_F / constants.c:.4f} = {v_F / constants.c * 100:.2f}%")
print("-" * 80)

print("\n" + "=" * 80)
print("ã€è§£ç­”ã¾ã¨ã‚ã€‘")
print("=" * 80)
print(f"(1) ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒ:")
print(f"    - 0 K ã§ã¯ã‚¹ãƒ†ãƒƒãƒ—é–¢æ•°")
print(f"    - 300 K ã§ã¯ E_F ä»˜è¿‘ã§ k_B T ç¨‹åº¦ã®å¹…ã§ã¼ã‘ã‚‹")
print(f"    - ã‚°ãƒ©ãƒ•ã‚’ 'fermi_dirac_temperature_comparison.png' ã«ä¿å­˜")
print(f"")
print(f"(2) ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦:")
print(f"    v_F = {v_F / 1e6:.3f} Ã— 10â¶ m/s ï¼ˆå…‰é€Ÿã®ç´„ {v_F / constants.c * 100:.1f}%ï¼‰")
print("=" * 80)

print("\nã€ç‰©ç†çš„æ„ç¾©ã€‘")
print("-" * 80)
print("ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦ã¯ã€çµ¶å¯¾é›¶åº¦ã«ãŠã„ã¦ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æŒã¤")
print("é›»å­ã®é€Ÿåº¦ã§ã™ã€‚ã“ã®é€Ÿåº¦ã¯éå¸¸ã«å¤§ããï¼ˆç´„ 10â¶ m/sï¼‰ã€")
print("é‡‘å±ä¸­ã®é›»å­ãŒé«˜é€Ÿã§é‹å‹•ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚")
print("ã“ã‚ŒãŒé‡‘å±ã®é«˜ã„é›»æ°—ä¼å°æ€§ã¨ç†±ä¼å°æ€§ã®åŸå› ã§ã™ã€‚")
print("-" * 80)
</code></pre>
                    </div>
                </details>
            </div>

            <div class="exercise">
                <div class="exercise-header">
                    <h4>æ¼”ç¿’ 1.5</h4>
                    <span class="difficulty hard">Hard</span>
                </div>
                <p><strong>å•é¡Œï¼š</strong>FCCæ§‹é€ ã®é‡‘å±ã«ãŠã„ã¦ã€$(111)$ é¢ã¨ $(100)$ é¢ã®ã™ã¹ã‚Šç³»ï¼ˆã™ã¹ã‚Šé¢ã¨ã™ã¹ã‚Šæ–¹å‘ã®çµ„ã¿åˆã‚ã›ï¼‰ã‚’ç‰¹å®šã—ã€ãã‚Œãã‚Œã®é¢ã§ã®åŸå­é…åˆ—å¯†åº¦ã‚’æ¯”è¼ƒã—ã¦ãã ã•ã„ã€‚ã©ã¡ã‚‰ã®é¢ãŒã™ã¹ã‚Šã‚„ã™ã„ã‹ã€ç†ç”±ã¨ã¨ã‚‚ã«èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</p>

                <details>
                    <summary>è§£ç­”ã‚’è¡¨ç¤º</summary>
                    <div class="solution">
                        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D

print("=" * 80)
print("FCCé‡‘å±ã®ã™ã¹ã‚Šç³»è§£æï¼š(111)é¢ vs (100)é¢")
print("=" * 80)

# FCCæ§‹é€ ã®ã™ã¹ã‚Šç³»
print("\nã€FCCæ§‹é€ ã®ã™ã¹ã‚Šç³»ã€‘")
print("-" * 80)
print("FCCé‡‘å±ï¼ˆCu, Al, Au, Ag, Niãªã©ï¼‰ã®ä¸»è¦ãªã™ã¹ã‚Šç³»:")
print("  ã™ã¹ã‚Šé¢: {111} é¢ï¼ˆæœ€å¯†å……å¡«é¢ï¼‰")
print("  ã™ã¹ã‚Šæ–¹å‘: <110> æ–¹å‘ï¼ˆæœ€å¯†å……å¡«æ–¹å‘ï¼‰")
print("  ")
print("(111)é¢ã®ã™ã¹ã‚Šç³»: 4ã¤ã®{111}é¢ Ã— 3ã¤ã®<110>æ–¹å‘ = 12å€‹")
print("(100)é¢ã®ã™ã¹ã‚Šç³»: é€šå¸¸ã¯ã™ã¹ã‚‰ãªã„ãŒã€é«˜æ¸©ã§ã¯æ´»æ€§åŒ–")

# (111)é¢ã¨(100)é¢ã®åŸå­é…åˆ—å¯†åº¦ã®è¨ˆç®—
print("\nã€åŸå­é…åˆ—å¯†åº¦ã®æ¯”è¼ƒã€‘")
print("-" * 80)

# æ ¼å­å®šæ•°
a = 1.0  # ä»»æ„å˜ä½

# (111)é¢ã®åŸå­é…åˆ—å¯†åº¦
# (111)é¢ã¯æ­£ä¸‰è§’å½¢ã®æ ¼å­
# ä¸‰è§’å½¢ã®é¢ç© = (âˆš3/2) Ã— (a/âˆš2)Â² = (âˆš3/4) Ã— aÂ²
area_111_triangle = (np.sqrt(3) / 4) * a**2

# (111)é¢ã®å˜ä½ä¸‰è§’å½¢ã«ã¯1å€‹ã®åŸå­ãŒå«ã¾ã‚Œã‚‹
# ï¼ˆé ‚ç‚¹ã®3å€‹ Ã— 1/3 = 1å€‹ï¼‰
atoms_per_triangle_111 = 1

# åŸå­é…åˆ—å¯†åº¦ = åŸå­æ•° / é¢ç©
density_111 = atoms_per_triangle_111 / area_111_triangle

print(f"\n(111)é¢ã®è§£æ:")
print(f"  æ ¼å­æ§‹é€ : æ­£ä¸‰è§’å½¢æ ¼å­ï¼ˆæœ€å¯†å……å¡«ï¼‰")
print(f"  å˜ä½ä¸‰è§’å½¢ã®é¢ç©: (âˆš3/4) Ã— aÂ² = {area_111_triangle:.4f} aÂ²")
print(f"  å˜ä½ä¸‰è§’å½¢ã‚ãŸã‚Šã®åŸå­æ•°: {atoms_per_triangle_111}")
print(f"  åŸå­é…åˆ—å¯†åº¦: {density_111:.4f} / aÂ²")
print(f"                = {density_111:.4f} Ã— (1/aÂ²)")

# (100)é¢ã®åŸå­é…åˆ—å¯†åº¦
# (100)é¢ã¯æ­£æ–¹æ ¼å­
# æ­£æ–¹å½¢ã®é¢ç© = (a/âˆš2)Â² = aÂ²/2
area_100_square = a**2 / 2

# (100)é¢ã®å˜ä½æ­£æ–¹å½¢ã«ã¯1å€‹ã®åŸå­ãŒå«ã¾ã‚Œã‚‹
# ï¼ˆé ‚ç‚¹ã®4å€‹ Ã— 1/4 = 1å€‹ï¼‰
atoms_per_square_100 = 1

# åŸå­é…åˆ—å¯†åº¦
density_100 = atoms_per_square_100 / area_100_square

print(f"\n(100)é¢ã®è§£æ:")
print(f"  æ ¼å­æ§‹é€ : æ­£æ–¹æ ¼å­")
print(f"  å˜ä½æ­£æ–¹å½¢ã®é¢ç©: aÂ²/2 = {area_100_square:.4f} aÂ²")
print(f"  å˜ä½æ­£æ–¹å½¢ã‚ãŸã‚Šã®åŸå­æ•°: {atoms_per_square_100}")
print(f"  åŸå­é…åˆ—å¯†åº¦: {density_100:.4f} / aÂ²")
print(f"                = {density_100:.4f} Ã— (1/aÂ²)")

# æ¯”è¼ƒ
ratio = density_111 / density_100
print(f"\nåŸå­é…åˆ—å¯†åº¦ã®æ¯”:")
print(f"  (111)é¢ / (100)é¢ = {ratio:.4f}")
print(f"  (111)é¢ã¯(100)é¢ã® {ratio:.2f}å€ å¯†ã«åŸå­ãŒé…åˆ—")

# ã™ã¹ã‚Šã‚„ã™ã•ã®è©•ä¾¡
print("\n" + "=" * 80)
print("ã€ã™ã¹ã‚Šã‚„ã™ã•ã®è©•ä¾¡ã€‘")
print("=" * 80)

print("\n(111)é¢ãŒä¸»è¦ãªã™ã¹ã‚Šé¢ã§ã‚ã‚‹ç†ç”±:")
print("-" * 80)
print(f"1. æœ€å¯†å……å¡«é¢ã§ã‚ã‚‹")
print(f"   â†’ åŸå­é…åˆ—å¯†åº¦ãŒæœ€ã‚‚é«˜ã„ ({density_111:.4f} / aÂ²)")
print(f"   â†’ åŸå­é–“çµåˆãŒå¼·ãã€é¢å…¨ä½“ã¨ã—ã¦å®‰å®š")
print(f"")
print(f"2. é¢é–“éš”ãŒæœ€ã‚‚å¤§ãã„")
print(f"   â†’ d_111 = a / âˆš3 = {a / np.sqrt(3):.4f} a")
print(f"   â†’ d_100 = a / âˆš1 = {a / np.sqrt(1):.4f} a")
print(f"   â†’ é¢é–“éš”ãŒå¤§ãã„ã»ã©ã€ã™ã¹ã‚Šã«å¿…è¦ãªã›ã‚“æ–­å¿œåŠ›ãŒå°ã•ã„")
print(f"")
print(f"3. ã™ã¹ã‚Šæ–¹å‘ <110> ãŒæœ€å¯†å……å¡«æ–¹å‘")
print(f"   â†’ åŸå­é–“è·é›¢ãŒæœ€çŸ­ (a/âˆš2 = {a / np.sqrt(2):.4f} a)")
print(f"   â†’ ã™ã¹ã‚Šã®éš›ã®åŸå­ã®ç§»å‹•è·é›¢ãŒæœ€å°")
print(f"")
print(f"4. ã™ã¹ã‚Šç³»ã®æ•°ãŒå¤šã„")
print(f"   â†’ {111} é¢: 4é¢ Ã— 3æ–¹å‘ = 12å€‹ã®ã™ã¹ã‚Šç³»")
print(f"   â†’ å¤šæ§˜ãªå¿œåŠ›æ–¹å‘ã«å¯¾å¿œå¯èƒ½ â†’ å»¶æ€§ãŒé«˜ã„")

print("\n(100)é¢ãŒã™ã¹ã‚Šã«ãã„ç†ç”±:")
print("-" * 80)
print(f"1. åŸå­é…åˆ—å¯†åº¦ãŒä½ã„ ({density_100:.4f} / aÂ²)")
print(f"   â†’ (111)é¢ã® {1/ratio:.2f}å€")
print(f"   â†’ é¢å…¨ä½“ã¨ã—ã¦ã®çµåˆãŒå¼±ã„")
print(f"")
print(f"2. é¢é–“éš”ãŒå°ã•ã„")
print(f"   â†’ d_100 = {a / np.sqrt(1):.4f} a ï¼ˆ(111)é¢ã® {np.sqrt(3):.2f}å€å¯†ï¼‰")
print(f"   â†’ ã™ã¹ã‚Šã«å¿…è¦ãªã›ã‚“æ–­å¿œåŠ›ãŒå¤§ãã„")
print(f"")
print(f"3. å¸¸æ¸©ã§ã¯æ´»æ€§åŒ–ã—ãªã„")
print(f"   â†’ é«˜æ¸©ï¼ˆ>0.5T_mï¼‰ã§åˆã‚ã¦æ´»æ€§åŒ–")

# è‡¨ç•Œåˆ†è§£ã›ã‚“æ–­å¿œåŠ›ï¼ˆCRSSï¼‰ã®æ¦‚å¿µ
print("\n" + "=" * 80)
print("ã€è‡¨ç•Œåˆ†è§£ã›ã‚“æ–­å¿œåŠ›ï¼ˆCRSSï¼‰ã€‘")
print("=" * 80)

print("\nSchmidã®æ³•å‰‡:")
print("  Ï„_R = Ïƒ cos Ï† cos Î»")
print("  ")
print("  ã“ã“ã§ã€")
print("  Ï„_R : åˆ†è§£ã›ã‚“æ–­å¿œåŠ›")
print("  Ïƒ  : å¼•å¼µå¿œåŠ›")
print("  Ï†  : å¿œåŠ›è»¸ã¨ã™ã¹ã‚Šé¢æ³•ç·šã®ãªã™è§’")
print("  Î»  : å¿œåŠ›è»¸ã¨ã™ã¹ã‚Šæ–¹å‘ã®ãªã™è§’")
print("  ")
print("ã™ã¹ã‚ŠãŒé–‹å§‹ã™ã‚‹æ¡ä»¶:")
print("  Ï„_R â‰¥ Ï„_CRSS")
print("  ")
print("FCCé‡‘å±ã®å…¸å‹çš„ãªCRSSå€¤ï¼ˆå®¤æ¸©ï¼‰:")
print("  Cu:  ç´„ 0.5 - 1.0 MPa")
print("  Al:  ç´„ 0.2 - 0.5 MPa")
print("  Au:  ç´„ 0.3 - 0.8 MPa")

# å¯è¦–åŒ–ï¼šã™ã¹ã‚Šç³»ã®æ¨¡å¼å›³
fig = plt.figure(figsize=(14, 6))

# å·¦å›³: (111)é¢ã®ã™ã¹ã‚Šç³»
ax1 = fig.add_subplot(121, projection='3d')
ax1.set_title('(111)é¢ã®ã™ã¹ã‚Šç³»\nï¼ˆæœ€å¯†å……å¡«é¢ã€12å€‹ã®ã™ã¹ã‚Šç³»ï¼‰',
              fontsize=12, fontweight='bold', pad=15)

# (111)é¢ã‚’æç”»ï¼ˆç°¡ç•¥åŒ–ï¼‰
plane_vertices_111 = np.array([
    [0, 0, 1],
    [1, 0, 0],
    [0, 1, 0]
])

# é¢ã‚’æç”»
from mpl_toolkits.mplot3d.art3d import Poly3DCollection
poly_111 = Poly3DCollection([plane_vertices_111], alpha=0.5,
                             facecolor='cyan', edgecolor='blue', linewidth=2)
ax1.add_collection3d(poly_111)

# ã™ã¹ã‚Šæ–¹å‘ã®ãƒ™ã‚¯ãƒˆãƒ«ã‚’æç”»
slip_directions_111 = [
    ([0, 0, 1], [1, 0, 0]),
    ([1, 0, 0], [0, 1, 0]),
    ([0, 1, 0], [0, 0, 1])
]

for start, end in slip_directions_111:
    start = np.array(start)
    end = np.array(end)
    ax1.quiver(start[0], start[1], start[2],
               end[0] - start[0], end[1] - start[1], end[2] - start[2],
               color='red', arrow_length_ratio=0.2, linewidth=2)

ax1.set_xlabel('X', fontsize=10, fontweight='bold')
ax1.set_ylabel('Y', fontsize=10, fontweight='bold')
ax1.set_zlabel('Z', fontsize=10, fontweight='bold')
ax1.set_xlim([0, 1])
ax1.set_ylim([0, 1])
ax1.set_zlim([0, 1])

# å³å›³: (100)é¢ã®ã™ã¹ã‚Šç³»
ax2 = fig.add_subplot(122, projection='3d')
ax2.set_title('(100)é¢ã®ã™ã¹ã‚Šç³»\nï¼ˆéæœ€å¯†å……å¡«é¢ã€å¸¸æ¸©ã§ã¯ä¸æ´»æ€§ï¼‰',
              fontsize=12, fontweight='bold', pad=15)

# (100)é¢ã‚’æç”»
plane_vertices_100 = np.array([
    [1, 0, 0],
    [1, 1, 0],
    [1, 1, 1],
    [1, 0, 1]
])

poly_100 = Poly3DCollection([plane_vertices_100], alpha=0.5,
                             facecolor='lightcoral', edgecolor='red', linewidth=2)
ax2.add_collection3d(poly_100)

ax2.set_xlabel('X', fontsize=10, fontweight='bold')
ax2.set_ylabel('Y', fontsize=10, fontweight='bold')
ax2.set_zlabel('Z', fontsize=10, fontweight='bold')
ax2.set_xlim([0, 1])
ax2.set_ylim([0, 1])
ax2.set_zlim([0, 1])

plt.tight_layout()
plt.savefig('fcc_slip_systems_comparison.png', dpi=300, bbox_inches='tight')
plt.show()

print("\n" + "=" * 80)
print("ã€çµè«–ã€‘")
print("=" * 80)
print("(111)é¢ãŒ(100)é¢ã‚ˆã‚Šã™ã¹ã‚Šã‚„ã™ã„ç†ç”±:")
print("  1. æœ€å¯†å……å¡«é¢ã§ã‚ã‚Šã€åŸå­é…åˆ—å¯†åº¦ãŒé«˜ã„")
print(f"     â†’ (111): {density_111:.4f} / aÂ²")
print(f"     â†’ (100): {density_100:.4f} / aÂ² ï¼ˆ{ratio:.2f}å€ã®å·®ï¼‰")
print("  2. é¢é–“éš”ãŒå¤§ããã€ã™ã¹ã‚Šã«å¿…è¦ãªã›ã‚“æ–­å¿œåŠ›ãŒå°ã•ã„")
print("  3. ã™ã¹ã‚Šç³»ãŒ12å€‹ã¨å¤šãã€å¤šæ§˜ãªå¿œåŠ›ã«å¯¾å¿œå¯èƒ½")
print("  4. FCCé‡‘å±ã®é«˜ã„å»¶æ€§ã®ä¸»è¦å› ")
print("=" * 80)

print("\nâœ“ ã‚°ãƒ©ãƒ•ã‚’ 'fcc_slip_systems_comparison.png' ã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ")
</code></pre>
                    </div>
                </details>
            </div>
        </section>

        <section class="learning-objectives">
            <h3>å­¦ç¿’ç›®æ¨™ã®ç¢ºèª</h3>

            <div class="objective-level">
                <h4>ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬ç†è§£ï¼ˆçŸ¥è­˜ã®ç¿’å¾—ï¼‰</h4>
                <ul>
                    <li>é‡‘å±çµåˆã®è‡ªç”±é›»å­ãƒ¢ãƒ‡ãƒ«ã¨Drudeãƒ¢ãƒ‡ãƒ«ã‚’èª¬æ˜ã§ãã‚‹</li>
                    <li>FCCã€BCCã€HCPçµæ™¶æ§‹é€ ã®é•ã„ã‚’èª¬æ˜ã§ãã‚‹</li>
                    <li>å……å¡«ç‡ã¨é…ä½æ•°ã®æ„å‘³ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                    <li>ãƒ•ã‚§ãƒ«ãƒŸ-ãƒ‡ã‚£ãƒ©ãƒƒã‚¯åˆ†å¸ƒã®æ¦‚å¿µã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                    <li>ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã®è¡¨è¨˜æ–¹æ³•ã‚’ç†è§£ã—ã¦ã„ã‚‹</li>
                </ul>
            </div>

            <div class="objective-level">
                <h4>ãƒ¬ãƒ™ãƒ«2: å®Ÿè·µã‚¹ã‚­ãƒ«ï¼ˆè¨ˆç®—ã¨å¿œç”¨ï¼‰</h4>
                <ul>
                    <li>Drudeãƒ¢ãƒ‡ãƒ«ã§é›»æ°—ä¼å°åº¦ã‚’è¨ˆç®—ã§ãã‚‹</li>
                    <li>FCCã€BCCã€HCPæ§‹é€ ã®å……å¡«ç‡ã‚’è¨ˆç®—ã§ãã‚‹</li>
                    <li>ãƒŸãƒ©ãƒ¼æŒ‡æ•°ã‹ã‚‰é¢é–“éš”ã‚’è¨ˆç®—ã§ãã‚‹</li>
                    <li>ãƒ•ã‚§ãƒ«ãƒŸã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨ãƒ•ã‚§ãƒ«ãƒŸé€Ÿåº¦ã‚’è¨ˆç®—ã§ãã‚‹</li>
                    <li>Pythonã§çµæ™¶æ§‹é€ ã‚’å¯è¦–åŒ–ã§ãã‚‹</li>
                    <li>ASEã‚„pymatgenã‚’ä½¿ã£ã¦çµæ™¶æ§‹é€ ã‚’ç”Ÿæˆãƒ»æ“ä½œã§ãã‚‹</li>
                </ul>
            </div>

            <div class="objective-level">
                <h4>ãƒ¬ãƒ™ãƒ«3: å¿œç”¨åŠ›ï¼ˆå•é¡Œè§£æ±ºã¨æœ€é©åŒ–ï¼‰</h4>
                <ul>
                    <li>çµæ™¶æ§‹é€ ã‹ã‚‰ææ–™ã®æ©Ÿæ¢°çš„æ€§è³ªã‚’äºˆæ¸¬ã§ãã‚‹</li>
                    <li>ã™ã¹ã‚Šç³»ã‚’è§£æã—ã€ææ–™ã®å»¶æ€§ã‚’è©•ä¾¡ã§ãã‚‹</li>
                    <li>å®Ÿé¨“ãƒ‡ãƒ¼ã‚¿ï¼ˆXRDã€é›»æ°—æŠµæŠ—ç‡ãªã©ï¼‰ã‚’çµæ™¶æ§‹é€ ã¨é–¢é€£ä»˜ã‘ã¦è§£é‡ˆã§ãã‚‹</li>
                    <li>pymatgenã‚„ASEã‚’ä½¿ã£ã¦ææ–™è¨­è¨ˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã‚‹</li>
                    <li>Materials Projectãªã©ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ´»ç”¨ã—ã¦ææ–™æ¢ç´¢ãŒã§ãã‚‹</li>
                </ul>
            </div>
        </section>

        <section class="references">
            <h2>å‚è€ƒæ–‡çŒ®</h2>
            <ol>
                <li>Kittel, C. (2018). <em>Introduction to Solid State Physics</em>, 9th ed. Wiley, pp. 145-189, 223-267.</li>
                <li>Ashcroft, N.W., Mermin, N.D. (1976). <em>Solid State Physics</em>. Brooks Cole, pp. 1-48, 123-167.</li>
                <li>Callister, W.D., Jr., Rethwisch, D.G. (2020). <em>Materials Science and Engineering: An Introduction</em>, 10th ed. Wiley, pp. 45-89, 112-145.</li>
                <li>Porter, D.A., Easterling, K.E., Sherif, M.Y. (2009). <em>Phase Transformations in Metals and Alloys</em>, 3rd ed. CRC Press, pp. 1-35.</li>
                <li>Cottrell, A.H. (1953). <em>Dislocations and Plastic Flow in Crystals</em>. Oxford University Press, pp. 8-34.</li>
                <li>Hosford, W.F. (2010). <em>Mechanical Behavior of Materials</em>, 2nd ed. Cambridge University Press, pp. 67-102.</li>
                <li>pymatgen documentation: Structure module. <a href="https://pymatgen.org/pymatgen.core.structure.html" target="_blank">https://pymatgen.org/pymatgen.core.structure.html</a></li>
                <li>ASE (Atomic Simulation Environment) documentation: Atoms and lattice objects. <a href="https://wiki.fysik.dtu.dk/ase/" target="_blank">https://wiki.fysik.dtu.dk/ase/</a></li>
            </ol>
        </section>

        <nav class="chapter-nav">
            <a href="./index.html" class="btn-secondary">â† ç›®æ¬¡ã«æˆ»ã‚‹</a>
            <a href="./chapter-2.html" class="btn-primary">Chapter 2: åˆé‡‘ã®çŠ¶æ…‹å›³ã¨ç›¸å¤‰æ…‹ â†’</a>
        </nav>
    </main>

    <footer>
        <p>&copy; 2025 MS Dojo. All rights reserved.</p>
    </footer>
</body>
</html>