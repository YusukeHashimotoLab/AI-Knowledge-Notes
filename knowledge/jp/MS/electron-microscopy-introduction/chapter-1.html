<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬1ç« ï¼šé›»å­é¡•å¾®é¡ã®åŸºç¤ - MS Terakoya</title>

    <style>
        :root {
            --color-primary: #2c3e50;
            --color-primary-dark: #1a252f;
            --color-accent: #f093fb;
            --color-accent-light: #f5576c;
            --color-text: #2d3748;
            --color-text-light: #4a5568;
            --color-bg: #ffffff;
            --color-bg-alt: #f7fafc;
            --color-border: #e2e8f0;
            --color-code-bg: #f8f9fa;
            --color-link: #f093fb;
            --color-link-hover: #d07be8;

            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            --font-body: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            --font-mono: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, monospace;

            --border-radius: 8px;
            --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-body);
            line-height: 1.7;
            color: var(--color-text);
            background-color: var(--color-bg);
            font-size: 16px;
        }

        header {
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            padding: var(--spacing-xl) var(--spacing-md);
            margin-bottom: var(--spacing-xl);
            box-shadow: var(--box-shadow);
        }

        .header-content {
            max-width: 900px;
            margin: 0 auto;
        }

        h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: var(--spacing-sm);
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            font-weight: 400;
            margin-bottom: var(--spacing-md);
        }

        .meta {
            display: flex;
            flex-wrap: wrap;
            gap: var(--spacing-md);
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 0 var(--spacing-md) var(--spacing-xl);
        }

        h2 {
            font-size: 1.75rem;
            color: var(--color-primary);
            margin-top: var(--spacing-xl);
            margin-bottom: var(--spacing-md);
            padding-bottom: var(--spacing-xs);
            border-bottom: 3px solid var(--color-accent);
        }

        h3 {
            font-size: 1.4rem;
            color: var(--color-primary);
            margin-top: var(--spacing-lg);
            margin-bottom: var(--spacing-sm);
        }

        h4 {
            font-size: 1.1rem;
            color: var(--color-primary-dark);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
        }

        p {
            margin-bottom: var(--spacing-md);
            color: var(--color-text);
        }

        a {
            color: var(--color-link);
            text-decoration: none;
            transition: color 0.2s;
        }

        a:hover {
            color: var(--color-link-hover);
            text-decoration: underline;
        }

        ul, ol {
            margin-left: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
        }

        li {
            margin-bottom: var(--spacing-xs);
            color: var(--color-text);
        }

        pre {
            background-color: var(--color-code-bg);
            border: 1px solid var(--color-border);
            border-radius: var(--border-radius);
            padding: var(--spacing-md);
            overflow-x: auto;
            margin-bottom: var(--spacing-md);
            font-family: var(--font-mono);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        code {
            font-family: var(--font-mono);
            font-size: 0.9em;
            background-color: var(--color-code-bg);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        pre code {
            background-color: transparent;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: var(--spacing-md);
            font-size: 0.95rem;
        }

        th, td {
            border: 1px solid var(--color-border);
            padding: var(--spacing-sm);
            text-align: left;
        }

        th {
            background-color: var(--color-bg-alt);
            font-weight: 600;
            color: var(--color-primary);
        }

        blockquote {
            border-left: 4px solid var(--color-accent);
            padding-left: var(--spacing-md);
            margin: var(--spacing-md) 0;
            color: var(--color-text-light);
            font-style: italic;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .mermaid {
            text-align: center;
            margin: var(--spacing-lg) 0;
            background-color: var(--color-bg-alt);
            padding: var(--spacing-md);
            border-radius: var(--border-radius);
        }

        .learning-objectives {
            background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%);
            padding: var(--spacing-lg);
            border-radius: var(--border-radius);
            border-left: 4px solid var(--color-accent);
            margin-bottom: var(--spacing-xl);
        }

        .learning-objectives h2 {
            margin-top: 0;
            border-bottom: none;
        }

        .breadcrumb {
            max-width: 900px;
            margin: 0 auto;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: 0.9rem;
            color: var(--color-text-light);
        }

        .breadcrumb a {
            color: var(--color-link);
            text-decoration: none;
        }

        .breadcrumb a:hover {
            text-decoration: underline;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            gap: var(--spacing-md);
            margin: var(--spacing-xl) 0;
            padding-top: var(--spacing-lg);
            border-top: 2px solid var(--color-border);
        }

        .nav-button {
            flex: 1;
            padding: var(--spacing-md);
            background: linear-gradient(135deg, var(--color-accent) 0%, var(--color-accent-light) 100%);
            color: white;
            border-radius: var(--border-radius);
            text-align: center;
            font-weight: 600;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: var(--box-shadow);
        }

        .nav-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            text-decoration: none;
        }

        footer {
            margin-top: var(--spacing-xl);
            padding: var(--spacing-lg) var(--spacing-md);
            background-color: var(--color-bg-alt);
            border-top: 1px solid var(--color-border);
            text-align: center;
            font-size: 0.9rem;
            color: var(--color-text-light);
        }
        .disclaimer {
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: #f8f9fa;
            border-left: 4px solid #6c757d;
            border-radius: 4px;
        }

        .disclaimer h3 {
            color: #495057;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        .disclaimer ul {
            list-style: none;
            padding-left: 0;
        }

        .disclaimer li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.6;
        }

        .disclaimer li::before {
            content: "âš ï¸";
            position: absolute;
            left: 0;
        }


        @media (max-width: 768px) {
            h1 {
                font-size: 1.5rem;
            }

            h2 {
                font-size: 1.4rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            .meta {
                font-size: 0.85rem;
            }

            .navigation {
                flex-direction: column;
            }

            table {
                font-size: 0.85rem;
            }

            th, td {
                padding: var(--spacing-xs);
            }
        }
    </style>

    <!-- Prism.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default', securityLevel: 'strict' });
    </script>

    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'mermaid'
            }
        };
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" id="MathJax-script" async></script>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>ç¬¬1ç« :é›»å­é¡•å¾®é¡ã®åŸºç¤</h1>
            <p class="subtitle">é›»å­ç·šã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨ã€åˆ†è§£èƒ½ã®ç†è«–ã€é›»å­é¡•å¾®é¡ã®åŸç†</p>
            <div class="meta">
                <span class="meta-item">ğŸ“– èª­äº†æ™‚é–“: 20-30åˆ†</span>
                <span class="meta-item">ğŸ“Š é›£æ˜“åº¦: åˆç´šã€œä¸­ç´š</span>
                <span class="meta-item">ğŸ’» ã‚³ãƒ¼ãƒ‰ä¾‹: 7å€‹</span>
            </div>
        </div>
    </header>

    <div class="breadcrumb">
        <a href="../../index.html">AIå¯ºå­å±‹ãƒˆãƒƒãƒ—</a> &gt;
        <a href="../index.html">MS Dojo</a> &gt;
        <a href="index.html">é›»å­é¡•å¾®é¡å…¥é–€</a> &gt;
        ç¬¬1ç« 
    </div>

    <main class="container">
        <p class="chapter-description" style="margin: 1.5rem 0; padding: 1rem; background: linear-gradient(135deg, #fce7f3 0%, #fbcfe8 100%); border-left: 4px solid #f093fb; border-radius: 8px; font-size: 1.05rem; line-height: 1.8; color: #2d3748;">
            é›»å­é¡•å¾®é¡ã¯ã€å…‰å­¦é¡•å¾®é¡ã®åˆ†è§£èƒ½é™ç•Œã‚’è¶…ãˆã¦ã€åŸå­ãƒ»åˆ†å­ãƒ¬ãƒ™ãƒ«ã®æ§‹é€ ã‚’è¦³å¯Ÿã§ãã‚‹å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚ã“ã®ç« ã§ã¯ã€é›»å­ç·šã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨ã€é›»å­æ³¢ã®æ³¢é•·ã¨åˆ†è§£èƒ½ã®é–¢ä¿‚ã€é›»å­é¡•å¾®é¡ã®åŸºæœ¬åŸç†ã‚’å­¦ã³ã€Pythonã§é›»å­æ³¢é•·è¨ˆç®—ã€åˆ†è§£èƒ½ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã€æ•£ä¹±æ–­é¢ç©è¨ˆç®—ã‚’å®Ÿè·µã—ã¾ã™ã€‚
        </p>

        <div class="learning-objectives">
            <h2>å­¦ç¿’ç›®æ¨™</h2>
            <p>ã“ã®ç« ã‚’èª­ã‚€ã“ã¨ã§ã€ä»¥ä¸‹ã‚’ç¿’å¾—ã§ãã¾ã™ï¼š</p>
            <ul>
                <li>âœ… é›»å­æ³¢ã®æ³¢å‹•æ€§ã¨ç²’å­æ€§ã‚’ç†è§£ã—ã€ãƒ‰ãƒ»ãƒ–ãƒ­ã‚¤æ³¢é•·ã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>âœ… ãƒ¬ã‚¤ãƒªãƒ¼åŸºæº–ã«ã‚ˆã‚‹åˆ†è§£èƒ½ã®å®šç¾©ã¨ã€é›»å­é¡•å¾®é¡ã®åˆ†è§£èƒ½å‘ä¸ŠåŸç†ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… å¼¾æ€§æ•£ä¹±ã¨éå¼¾æ€§æ•£ä¹±ã®é•ã„ã¨ã€å„æ•£ä¹±ä¿¡å·ã®åˆ©ç”¨æ³•ã‚’ç†è§£ã™ã‚‹</li>
                <li>âœ… åŠ é€Ÿé›»åœ§ãŒé›»å­æ³¢é•·ã¨åˆ†è§£èƒ½ã«ä¸ãˆã‚‹å½±éŸ¿ã‚’å®šé‡çš„ã«è©•ä¾¡ã§ãã‚‹</li>
                <li>âœ… é›»å­é¡•å¾®é¡ã®æ§‹æˆè¦ç´ ï¼ˆé›»å­éŠƒã€ãƒ¬ãƒ³ã‚ºã€æ¤œå‡ºå™¨ï¼‰ã®å½¹å‰²ã‚’èª¬æ˜ã§ãã‚‹</li>
                <li>âœ… Pythonã§æ•£ä¹±å¼·åº¦ã€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ã€ä¿¡å·å¼·åº¦åˆ†å¸ƒã‚’è¨ˆç®—ã§ãã‚‹</li>
                <li>âœ… å…‰å­¦é¡•å¾®é¡ã¨é›»å­é¡•å¾®é¡ã®æœ¬è³ªçš„ãªé•ã„ã‚’æ³¢é•·ã®è¦³ç‚¹ã‹ã‚‰èª¬æ˜ã§ãã‚‹</li>
            </ul>
        </div>

        <h2>1.1 é›»å­æ³¢ã®åŸºç¤</h2>

        <h3>1.1.1 æ³¢å‹•ã¨ç²’å­ã®äºŒé‡æ€§</h3>
        <p>é›»å­ã¯<strong>æ³¢å‹•æ€§</strong>ã¨<strong>ç²’å­æ€§</strong>ã®ä¸¡æ–¹ã‚’æŒã¤é‡å­åŠ›å­¦çš„ç²’å­ã§ã™ã€‚ãƒ«ã‚¤ãƒ»ãƒ‰ãƒ»ãƒ–ãƒ­ã‚¤ï¼ˆ1924å¹´ï¼‰ã¯ã€é‹å‹•é‡$p$ã‚’æŒã¤ç²’å­ãŒæ³¢é•·$\lambda$ã‚’æŒã¤ã“ã¨ã‚’æå”±ã—ã¾ã—ãŸï¼š</p>

        $$
        \lambda = \frac{h}{p}
        $$

        <p>ã“ã“ã§ã€$h = 6.626 \times 10^{-34}$ JÂ·sï¼ˆãƒ—ãƒ©ãƒ³ã‚¯å®šæ•°ï¼‰ã€$p = mv$ï¼ˆé‹å‹•é‡ï¼šè³ªé‡$m$ Ã— é€Ÿåº¦$v$ï¼‰ã§ã™ã€‚</p>

        <p><strong>ç›¸å¯¾è«–è£œæ­£</strong>ï¼šé›»å­ãŒé«˜é€Ÿã§åŠ é€Ÿã•ã‚Œã‚‹å ´åˆã€ç›¸å¯¾è«–åŠ¹æœã‚’è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚åŠ é€Ÿé›»åœ§$V$ã§åŠ é€Ÿã•ã‚ŒãŸé›»å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¯ï¼š</p>

        $$
        E = eV
        $$

        <p>ã“ã“ã§ã€$e = 1.602 \times 10^{-19}$ Cï¼ˆé›»è·ç´ é‡ï¼‰ã§ã™ã€‚ç›¸å¯¾è«–çš„ãªé‹å‹•é‡ã¯æ¬¡å¼ã§è¨ˆç®—ã•ã‚Œã¾ã™ï¼š</p>

        $$
        p = \sqrt{\frac{2m_0 eV}{c^2}\left(1 + \frac{eV}{2m_0 c^2}\right)}
        $$

        <p>$m_0 = 9.109 \times 10^{-31}$ kgï¼ˆé›»å­ã®é™æ­¢è³ªé‡ï¼‰ã€$c = 2.998 \times 10^8$ m/sï¼ˆå…‰é€Ÿï¼‰ã§ã™ã€‚</p>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1-1: é›»å­æ³¢é•·ã®è¨ˆç®—ï¼ˆç›¸å¯¾è«–è£œæ­£ã‚ã‚Šï¼‰</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def calculate_electron_wavelength(voltage_kV):
    """
    åŠ é€Ÿé›»åœ§ã‹ã‚‰é›»å­æ³¢é•·ã‚’è¨ˆç®—ï¼ˆç›¸å¯¾è«–è£œæ­£ã‚ã‚Šï¼‰

    Parameters
    ----------
    voltage_kV : float or array-like
        åŠ é€Ÿé›»åœ§ [kV]

    Returns
    -------
    wavelength_pm : float or array-like
        é›»å­æ³¢é•· [pm]
    """
    # ç‰©ç†å®šæ•°
    h = 6.62607e-34    # ãƒ—ãƒ©ãƒ³ã‚¯å®šæ•° [JÂ·s]
    m0 = 9.10938e-31   # é›»å­è³ªé‡ [kg]
    e = 1.60218e-19    # é›»è·ç´ é‡ [C]
    c = 2.99792e8      # å…‰é€Ÿ [m/s]

    # åŠ é€Ÿé›»åœ§ã‚’Jã«å¤‰æ›
    V = voltage_kV * 1000  # [V]
    E = e * V              # ã‚¨ãƒãƒ«ã‚®ãƒ¼ [J]

    # ç›¸å¯¾è«–çš„é‹å‹•é‡
    p = np.sqrt(2 * m0 * E * (1 + E / (2 * m0 * c**2)))

    # ãƒ‰ãƒ»ãƒ–ãƒ­ã‚¤æ³¢é•·
    wavelength_m = h / p
    wavelength_pm = wavelength_m * 1e12  # [pm]

    return wavelength_pm

# åŠ é€Ÿé›»åœ§ç¯„å›²
voltages = np.array([10, 50, 100, 200, 300, 500, 1000])  # [kV]
wavelengths = calculate_electron_wavelength(voltages)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# å·¦å›³ï¼šæ³¢é•· vs åŠ é€Ÿé›»åœ§
ax1.plot(voltages, wavelengths, 'o-', linewidth=2, markersize=8, color='#f093fb')
ax1.set_xlabel('Acceleration Voltage [kV]', fontsize=12)
ax1.set_ylabel('Electron Wavelength [pm]', fontsize=12)
ax1.set_title('Electron Wavelength vs Acceleration Voltage', fontsize=14, fontweight='bold')
ax1.grid(alpha=0.3)
ax1.set_xscale('log')
ax1.set_yscale('log')

# å…‰å­¦é¡•å¾®é¡ã®å¯è¦–å…‰æ³¢é•·ã‚’å‚è€ƒç·šã¨ã—ã¦è¿½åŠ 
ax1.axhline(y=500000, color='orange', linestyle='--', linewidth=2, label='Visible Light (~500 nm)')
ax1.legend(fontsize=10)

# å³å›³ï¼šä»£è¡¨çš„ãªåŠ é€Ÿé›»åœ§ã§ã®æ³¢é•·æ¯”è¼ƒ
selected_voltages = [100, 200, 300]
selected_wavelengths = calculate_electron_wavelength(selected_voltages)

ax2.bar([f'{v} kV' for v in selected_voltages], selected_wavelengths,
        color=['#f093fb', '#f5576c', '#d07be8'], alpha=0.8, edgecolor='black')
ax2.set_ylabel('Electron Wavelength [pm]', fontsize=12)
ax2.set_title('Typical Operating Voltages', fontsize=14, fontweight='bold')
ax2.grid(axis='y', alpha=0.3)

for i, (v, wl) in enumerate(zip(selected_voltages, selected_wavelengths)):
    ax2.text(i, wl + 0.1, f'{wl:.3f} pm', ha='center', fontsize=10, fontweight='bold')

plt.tight_layout()
plt.show()

# å…·ä½“çš„ãªæ•°å€¤ã‚’å‡ºåŠ›
print("åŠ é€Ÿé›»åœ§ã¨é›»å­æ³¢é•·ã®å¯¾å¿œ:")
for v, wl in zip(voltages, wavelengths):
    print(f"  {v:4.0f} kV â†’ Î» = {wl:.4f} pm = {wl/100:.4f} Ã…")
print(f"\nå¯è¦–å…‰ï¼ˆ550 nmï¼‰ã«å¯¾ã™ã‚‹200 kVã®é›»å­æ³¢ã®æ³¢é•·æ¯”: {550000 / wavelengths[3]:.0f}:1")
</code></pre>

        <p><strong>å‡ºåŠ›è§£é‡ˆ</strong>ï¼š</p>
        <ul>
            <li>100 kVã§ç´„3.7 pmã€200 kVã§ç´„2.5 pmã€300 kVã§ç´„2.0 pmã®æ³¢é•·</li>
            <li>å¯è¦–å…‰ï¼ˆ~500 nmï¼‰ã¨æ¯”è¼ƒã—ã¦<strong>ç´„20ä¸‡å€çŸ­ã„æ³¢é•·</strong></li>
            <li>åŠ é€Ÿé›»åœ§ãŒé«˜ã„ã»ã©æ³¢é•·ãŒçŸ­ããªã‚Šã€åˆ†è§£èƒ½ãŒå‘ä¸Š</li>
        </ul>

        <h3>1.1.2 åˆ†è§£èƒ½ã¨ãƒ¬ã‚¤ãƒªãƒ¼åŸºæº–</h3>
        <p>é¡•å¾®é¡ã®<strong>åˆ†è§£èƒ½ï¼ˆResolutionï¼‰</strong>ã¯ã€2ã¤ã®ç‚¹ã‚’è­˜åˆ¥ã§ãã‚‹æœ€å°è·é›¢ã¨ã—ã¦å®šç¾©ã•ã‚Œã¾ã™ã€‚ãƒ¬ã‚¤ãƒªãƒ¼åŸºæº–ã«ã‚ˆã‚Œã°ï¼š</p>

        $$
        d = \frac{0.61 \lambda}{n \sin\alpha}
        $$

        <p>ã“ã“ã§ï¼š</p>
        <ul>
            <li>$d$ï¼šåˆ†è§£èƒ½ï¼ˆè­˜åˆ¥å¯èƒ½ãªæœ€å°è·é›¢ï¼‰</li>
            <li>$\lambda$ï¼šæ³¢é•·</li>
            <li>$n \sin\alpha$ï¼šé–‹å£æ•°ï¼ˆNA: Numerical Apertureï¼‰</li>
            <li>$\alpha$ï¼šå¯¾ç‰©ãƒ¬ãƒ³ã‚ºã®åŠé–‹ãè§’</li>
        </ul>

        <p><strong>å…‰å­¦é¡•å¾®é¡ vs é›»å­é¡•å¾®é¡</strong>ï¼š</p>
        <table>
            <thead>
                <tr>
                    <th>é …ç›®</th>
                    <th>å…‰å­¦é¡•å¾®é¡</th>
                    <th>é›»å­é¡•å¾®é¡ï¼ˆ200 kVï¼‰</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>æ³¢é•· $\lambda$</td>
                    <td>~500 nmï¼ˆå¯è¦–å…‰ï¼‰</td>
                    <td>~2.5 pmï¼ˆé›»å­æ³¢ï¼‰</td>
                </tr>
                <tr>
                    <td>åˆ†è§£èƒ½ $d$</td>
                    <td>~200 nmï¼ˆç†è«–é™ç•Œï¼‰</td>
                    <td>~0.05 nmï¼ˆåå·®è£œæ­£TEMï¼‰</td>
                </tr>
                <tr>
                    <td>å€ç‡</td>
                    <td>~2,000å€</td>
                    <td>~50,000,000å€</td>
                </tr>
            </tbody>
        </table>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1-2: åˆ†è§£èƒ½ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def resolution_rayleigh(wavelength_nm, alpha_deg, n=1.0):
    """
    ãƒ¬ã‚¤ãƒªãƒ¼åŸºæº–ã«ã‚ˆã‚‹åˆ†è§£èƒ½ã‚’è¨ˆç®—

    Parameters
    ----------
    wavelength_nm : float
        æ³¢é•· [nm]
    alpha_deg : float
        å¯¾ç‰©ãƒ¬ãƒ³ã‚ºåŠé–‹ãè§’ [degrees]
    n : float
        å±ˆæŠ˜ç‡ï¼ˆé›»å­é¡•å¾®é¡ã§ã¯çœŸç©ºä¸­ãªã®ã§1.0ï¼‰

    Returns
    -------
    d_nm : float
        åˆ†è§£èƒ½ [nm]
    """
    alpha_rad = np.deg2rad(alpha_deg)
    d_nm = 0.61 * wavelength_nm / (n * np.sin(alpha_rad))
    return d_nm

# å…‰å­¦é¡•å¾®é¡ã¨é›»å­é¡•å¾®é¡ã®æ¯”è¼ƒ
alpha_range = np.linspace(0.5, 30, 100)  # [degrees]

# å…‰å­¦é¡•å¾®é¡ï¼ˆå¯è¦–å…‰ï¼‰
optical_wavelength = 550  # [nm]
optical_resolution = resolution_rayleigh(optical_wavelength, alpha_range)

# é›»å­é¡•å¾®é¡ï¼ˆ100 kV â†’ 3.7 pm = 0.0037 nmï¼‰
em_100kV_wavelength = 0.0037  # [nm]
em_100kV_resolution = resolution_rayleigh(em_100kV_wavelength, alpha_range)

# é›»å­é¡•å¾®é¡ï¼ˆ200 kV â†’ 2.5 pm = 0.0025 nmï¼‰
em_200kV_wavelength = 0.0025  # [nm]
em_200kV_resolution = resolution_rayleigh(em_200kV_wavelength, alpha_range)

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, ax = plt.subplots(figsize=(12, 7))

ax.plot(alpha_range, optical_resolution, linewidth=2.5, label='Optical (550 nm)', color='orange')
ax.plot(alpha_range, em_100kV_resolution, linewidth=2.5, label='EM 100 kV (3.7 pm)', color='#f093fb')
ax.plot(alpha_range, em_200kV_resolution, linewidth=2.5, label='EM 200 kV (2.5 pm)', color='#f5576c')

# å…‰å­¦é¡•å¾®é¡ã®å®Ÿç”¨çš„ãªåˆ†è§£èƒ½é™ç•Œ
ax.axhline(y=200, color='orange', linestyle='--', linewidth=1.5, alpha=0.7, label='Optical Limit (~200 nm)')

# é›»å­é¡•å¾®é¡ã®å®Ÿç”¨çš„ãªåˆ†è§£èƒ½ï¼ˆçƒé¢åå·®ãªã©ã®å½±éŸ¿ï¼‰
ax.axhline(y=0.1, color='blue', linestyle='--', linewidth=1.5, alpha=0.7, label='Practical EM Limit (~0.1 nm)')

ax.set_xlabel('Objective Lens Half-Angle Î± [degrees]', fontsize=12)
ax.set_ylabel('Resolution d [nm]', fontsize=12)
ax.set_title('Resolution vs Lens Aperture (Rayleigh Criterion)', fontsize=14, fontweight='bold')
ax.set_yscale('log')
ax.set_ylim(1e-3, 1e3)
ax.legend(fontsize=11, loc='upper right')
ax.grid(alpha=0.3, which='both')

plt.tight_layout()
plt.show()

# å®Ÿç”¨çš„ãªå€¤ã‚’è¨ˆç®—
alpha_typical = 10  # [degrees]ï¼ˆå…¸å‹çš„ãªå¯¾ç‰©ãƒ¬ãƒ³ã‚ºåŠé–‹ãè§’ï¼‰
print(f"å¯¾ç‰©ãƒ¬ãƒ³ã‚ºåŠé–‹ãè§’ Î± = {alpha_typical}Â°ã§ã®åˆ†è§£èƒ½:")
print(f"  å…‰å­¦é¡•å¾®é¡: {resolution_rayleigh(optical_wavelength, alpha_typical):.1f} nm")
print(f"  é›»å­é¡•å¾®é¡ (100 kV): {resolution_rayleigh(em_100kV_wavelength, alpha_typical):.4f} nm")
print(f"  é›»å­é¡•å¾®é¡ (200 kV): {resolution_rayleigh(em_200kV_wavelength, alpha_typical):.4f} nm")
</code></pre>

        <h2>1.2 é›»å­ç·šã¨ç‰©è³ªã®ç›¸äº’ä½œç”¨</h2>

        <h3>1.2.1 æ•£ä¹±ã®ç¨®é¡</h3>
        <p>é›»å­ç·šãŒè©¦æ–™ã«å…¥å°„ã™ã‚‹ã¨ã€åŸå­æ ¸ã‚„é›»å­ã¨ã®ç›¸äº’ä½œç”¨ã«ã‚ˆã‚Šæ§˜ã€…ãª<strong>æ•£ä¹±ç¾è±¡</strong>ãŒç”Ÿã˜ã¾ã™ã€‚</p>

        <div class="mermaid">
flowchart TD
    A[å…¥å°„é›»å­ç·š] --> B{è©¦æ–™ä¸­ã®ç›¸äº’ä½œç”¨}
    B --> C[å¼¾æ€§æ•£ä¹±<br/>Elastic Scattering]
    B --> D[éå¼¾æ€§æ•£ä¹±<br/>Inelastic Scattering]

    C --> E[å¾Œæ–¹æ•£ä¹±é›»å­<br/>BSE]
    C --> F[é€éé›»å­<br/>TEMä¿¡å·]

    D --> G[äºŒæ¬¡é›»å­<br/>SE]
    D --> H[Xç·š<br/>EDS/WDS]
    D --> I[ã‚ªãƒ¼ã‚¸ã‚§é›»å­<br/>AES]
    D --> J[ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±é›»å­<br/>EELS]

    style A fill:#f093fb,stroke:#f5576c,stroke-width:2px,color:#fff
    style C fill:#99ccff,stroke:#0066cc,stroke-width:2px
    style D fill:#ffeb99,stroke:#ffa500,stroke-width:2px
</div>

        <p><strong>å¼¾æ€§æ•£ä¹±ï¼ˆElastic Scatteringï¼‰</strong>ï¼š</p>
        <ul>
            <li>é›»å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±ãŒã»ã¼ã‚¼ãƒ­ï¼ˆ$\Delta E \approx 0$ï¼‰</li>
            <li>åŸå­æ ¸ã®ã‚¯ãƒ¼ãƒ­ãƒ³ãƒãƒ†ãƒ³ã‚·ãƒ£ãƒ«ã«ã‚ˆã‚‹æ•£ä¹±</li>
            <li>æ•£ä¹±è§’ã¯åŸå­ç•ªå·$Z$ã«ä¾å­˜ï¼ˆé‡ã„å…ƒç´ ã»ã©å¤§è§’åº¦æ•£ä¹±ï¼‰</li>
            <li><strong>åˆ©ç”¨</strong>ï¼šTEMå›æŠ˜ã€HRTEMã€HAADF-STEMï¼ˆZ-contraståƒï¼‰</li>
        </ul>

        <p><strong>éå¼¾æ€§æ•£ä¹±ï¼ˆInelastic Scatteringï¼‰</strong>ï¼š</p>
        <ul>
            <li>é›»å­ãŒã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å¤±ã†ï¼ˆ$\Delta E > 0$ï¼‰</li>
            <li>å†…æ®»é›»å­åŠ±èµ·ã€ãƒ—ãƒ©ã‚ºãƒ¢ãƒ³åŠ±èµ·ã€ãƒ•ã‚©ãƒãƒ³åŠ±èµ·ãªã©</li>
            <li><strong>åˆ©ç”¨</strong>ï¼šEDSï¼ˆå…ƒç´ åˆ†æï¼‰ã€EELSï¼ˆé›»å­çŠ¶æ…‹åˆ†æï¼‰ã€SEï¼ˆè¡¨é¢å½¢æ…‹è¦³å¯Ÿï¼‰</li>
        </ul>

        <h3>1.2.2 æ•£ä¹±æ–­é¢ç©ã¨åŸå­ç•ªå·ä¾å­˜æ€§</h3>
        <p>æ•£ä¹±ã®å¼·åº¦ã¯<strong>æ•£ä¹±æ–­é¢ç©ï¼ˆScattering Cross Sectionï¼‰</strong>$\sigma$ã§è¡¨ã•ã‚Œã¾ã™ã€‚ãƒ©ã‚¶ãƒ•ã‚©ãƒ¼ãƒ‰æ•£ä¹±ã®è¿‘ä¼¼ã§ã¯ï¼š</p>

        $$
        \frac{d\sigma}{d\Omega} = \left(\frac{Ze^2}{4\pi\epsilon_0 E}\right)^2 \frac{1}{\sin^4(\theta/2)}
        $$

        <p>ã“ã“ã§ã€$Z$ã¯åŸå­ç•ªå·ã€$E$ã¯é›»å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã€$\theta$ã¯æ•£ä¹±è§’ã§ã™ã€‚</p>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1-3: æ•£ä¹±æ–­é¢ç©ã®åŸå­ç•ªå·ä¾å­˜æ€§</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def rutherford_scattering_cross_section(Z, E_keV, theta_deg):
    """
    ãƒ©ã‚¶ãƒ•ã‚©ãƒ¼ãƒ‰æ•£ä¹±æ–­é¢ç©ã‚’è¨ˆç®—

    Parameters
    ----------
    Z : int or array-like
        åŸå­ç•ªå·
    E_keV : float
        é›»å­ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ [keV]
    theta_deg : float
        æ•£ä¹±è§’ [degrees]

    Returns
    -------
    cross_section : float or array-like
        å¾®åˆ†æ•£ä¹±æ–­é¢ç© [nmÂ²/sr]
    """
    # å®šæ•°
    e = 1.60218e-19      # [C]
    epsilon_0 = 8.85419e-12  # [F/m]
    a0 = 0.0529          # ãƒœãƒ¼ã‚¢åŠå¾„ [nm]

    # ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’Jã«å¤‰æ›
    E_J = E_keV * 1000 * e

    # æ•£ä¹±è§’ã‚’ãƒ©ã‚¸ã‚¢ãƒ³ã«å¤‰æ›
    theta_rad = np.deg2rad(theta_deg)

    # ãƒ©ã‚¶ãƒ•ã‚©ãƒ¼ãƒ‰æ•£ä¹±æ–­é¢ç©ï¼ˆç°¡ç•¥å¼ï¼‰
    # dÏƒ/dÎ© âˆ ZÂ² / (EÂ² sinâ´(Î¸/2))
    Z = np.asarray(Z)
    cross_section = (Z / E_keV)**2 / (np.sin(theta_rad / 2)**4)

    # æ­£è¦åŒ–ä¿‚æ•°ï¼ˆä»»æ„å˜ä½ï¼‰
    cross_section = cross_section * 1e-3

    return cross_section

# ä»£è¡¨çš„ãªå…ƒç´ 
elements = {
    'C': 6, 'Al': 13, 'Si': 14, 'Ti': 22,
    'Fe': 26, 'Cu': 29, 'Mo': 42, 'W': 74, 'Pt': 78, 'Au': 79
}

E_keV = 200  # 200 kV
theta_range = np.linspace(1, 30, 100)  # [degrees]

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))

# å·¦å›³ï¼šæ•£ä¹±è§’ä¾å­˜æ€§
selected_elements = ['C', 'Si', 'Fe', 'Au']
colors = ['#d3d3d3', '#f093fb', '#ffa500', '#ffd700']

for elem, color in zip(selected_elements, colors):
    Z = elements[elem]
    cs = rutherford_scattering_cross_section(Z, E_keV, theta_range)
    ax1.plot(theta_range, cs, linewidth=2.5, label=f'{elem} (Z={Z})', color=color)

ax1.set_xlabel('Scattering Angle Î¸ [degrees]', fontsize=12)
ax1.set_ylabel('d$\sigma$/d$\Omega$ [arb. units]', fontsize=12)
ax1.set_title(f'Scattering Cross Section vs Angle\n(E = {E_keV} keV)', fontsize=14, fontweight='bold')
ax1.set_yscale('log')
ax1.set_ylim(1e-2, 1e4)
ax1.legend(fontsize=11)
ax1.grid(alpha=0.3, which='both')

# å³å›³ï¼šåŸå­ç•ªå·ä¾å­˜æ€§ï¼ˆå›ºå®šæ•£ä¹±è§’ï¼‰
Z_values = np.array(list(elements.values()))
element_names = list(elements.keys())
theta_fixed = 10  # [degrees]

cs_Z = rutherford_scattering_cross_section(Z_values, E_keV, theta_fixed)

ax2.scatter(Z_values, cs_Z, s=150, c=Z_values, cmap='plasma',
            edgecolors='black', linewidths=1.5, zorder=3)
ax2.plot(Z_values, cs_Z, 'k--', linewidth=1, alpha=0.5, zorder=1)

for i, (Z, cs, name) in enumerate(zip(Z_values, cs_Z, element_names)):
    ax2.text(Z, cs * 1.2, name, fontsize=9, ha='center', fontweight='bold')

ax2.set_xlabel('Atomic Number Z', fontsize=12)
ax2.set_ylabel('d$\sigma$/d$\Omega$ [arb. units]', fontsize=12)
ax2.set_title(f'Scattering Cross Section vs Z\n(Î¸ = {theta_fixed}Â°, E = {E_keV} keV)',
              fontsize=14, fontweight='bold')
ax2.set_yscale('log')
ax2.grid(alpha=0.3, which='both')

plt.tight_layout()
plt.show()

print(f"æ•£ä¹±æ–­é¢ç©ã®åŸå­ç•ªå·ä¾å­˜æ€§ï¼ˆÎ¸ = {theta_fixed}Â°ï¼‰:")
print(f"  C (Z=6):   {rutherford_scattering_cross_section(6, E_keV, theta_fixed):.3f}")
print(f"  Si (Z=14): {rutherford_scattering_cross_section(14, E_keV, theta_fixed):.3f}")
print(f"  Fe (Z=26): {rutherford_scattering_cross_section(26, E_keV, theta_fixed):.3f}")
print(f"  Au (Z=79): {rutherford_scattering_cross_section(79, E_keV, theta_fixed):.3f}")
print(f"\nAuã®æ•£ä¹±æ–­é¢ç©ã¯Cã®ç´„{(79/6)**2:.0f}å€ï¼ˆZÂ²ä¾å­˜æ€§ï¼‰")
</code></pre>

        <p><strong>é‡è¦ãªè¦³å¯Ÿ</strong>ï¼š</p>
        <ul>
            <li>æ•£ä¹±æ–­é¢ç©ã¯$Z^2$ã«æ¯”ä¾‹ â†’ é‡å…ƒç´ ã»ã©å¼·ãæ•£ä¹±</li>
            <li>å°è§’æ•£ä¹±ãŒæ”¯é…çš„ï¼ˆ$\sin^4(\theta/2)$ã®é€†æ•°ã«æ¯”ä¾‹ï¼‰</li>
            <li>HAADF-STEMï¼ˆé«˜è§’ç’°çŠ¶æš—è¦–é‡ï¼‰ã§ã¯ã€å¤§è§’åº¦æ•£ä¹±ã‚’æ¤œå‡ºã—ã¦Z-contraståƒã‚’å–å¾—</li>
        </ul>

        <h2>1.3 é›»å­é¡•å¾®é¡ã®æ§‹æˆè¦ç´ </h2>

        <h3>1.3.1 é›»å­éŠƒï¼ˆElectron Gunï¼‰</h3>
        <p>é›»å­éŠƒã¯ã€å®‰å®šã—ãŸé›»å­ç·šã‚’ç”Ÿæˆã™ã‚‹è£…ç½®ã§ã™ã€‚ä¸»ãªç¨®é¡ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>ç¨®é¡</th>
                    <th>åŸç†</th>
                    <th>è¼åº¦</th>
                    <th>ã‚¨ãƒãƒ«ã‚®ãƒ¼åºƒãŒã‚Š</th>
                    <th>ç”¨é€”</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>ã‚¿ãƒ³ã‚°ã‚¹ãƒ†ãƒ³ç†±é›»å­éŠƒ</strong></td>
                    <td>åŠ ç†±ã«ã‚ˆã‚‹ã‚¨ãƒŸãƒƒã‚·ãƒ§ãƒ³</td>
                    <td>ä½ï¼ˆ~10âµ A/cmÂ²Â·srï¼‰</td>
                    <td>~2-3 eV</td>
                    <td>æ±ç”¨SEMã€ä½ã‚³ã‚¹ãƒˆ</td>
                </tr>
                <tr>
                    <td><strong>LaBâ‚†ç†±é›»å­éŠƒ</strong></td>
                    <td>LaBâ‚†ãƒ•ã‚£ãƒ©ãƒ¡ãƒ³ãƒˆåŠ ç†±</td>
                    <td>ä¸­ï¼ˆ~10â¶ A/cmÂ²Â·srï¼‰</td>
                    <td>~1-2 eV</td>
                    <td>æ±ç”¨TEMã€ãƒãƒ©ãƒ³ã‚¹å‹</td>
                </tr>
                <tr>
                    <td><strong>é›»ç•Œæ”¾å‡ºéŠƒï¼ˆFEGï¼‰</strong></td>
                    <td>å¼·é›»ç•Œã«ã‚ˆã‚‹é‡å­ãƒˆãƒ³ãƒãƒ«åŠ¹æœ</td>
                    <td>é«˜ï¼ˆ~10â¸ A/cmÂ²Â·srï¼‰</td>
                    <td>~0.3-0.7 eV</td>
                    <td>é«˜åˆ†è§£èƒ½TEM/STEMã€EELS</td>
                </tr>
            </tbody>
        </table>

        <p><strong>é›»ç•Œæ”¾å‡ºéŠƒï¼ˆFEG: Field Emission Gunï¼‰ã®åˆ©ç‚¹</strong>ï¼š</p>
        <ul>
            <li>é«˜è¼åº¦ â†’ ç´°ã„ãƒ—ãƒ­ãƒ¼ãƒ–ï¼ˆ0.1 nmä»¥ä¸‹ï¼‰ãŒå¯èƒ½</li>
            <li>ç‹­ã„ã‚¨ãƒãƒ«ã‚®ãƒ¼åºƒãŒã‚Š â†’ EELSã®é«˜ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†è§£èƒ½</li>
            <li>é«˜ã„ã‚³ãƒ’ãƒ¼ãƒ¬ãƒ³ã‚¹ â†’ HRTEMã®é«˜åˆ†è§£èƒ½</li>
        </ul>

        <h3>1.3.2 é›»å­ãƒ¬ãƒ³ã‚ºã¨åå·®</h3>
        <p>é›»å­ãƒ¬ãƒ³ã‚ºã¯ã€ç£å ´ï¼ˆé›»ç£ãƒ¬ãƒ³ã‚ºï¼‰ã¾ãŸã¯é™é›»å ´ã«ã‚ˆã‚Šé›»å­ç·šã‚’é›†æŸã•ã›ã¾ã™ã€‚</p>

        <p><strong>ä¸»ãªåå·®</strong>ï¼š</p>
        <ul>
            <li><strong>çƒé¢åå·®ï¼ˆSpherical Aberration, $C_s$ï¼‰</strong>ï¼šãƒ¬ãƒ³ã‚ºã®ç«¯ã‚’é€šã‚‹é›»å­ç·šãŒç„¦ç‚¹ã‹ã‚‰å¤–ã‚Œã‚‹</li>
            <li><strong>è‰²åå·®ï¼ˆChromatic Aberration, $C_c$ï¼‰</strong>ï¼šã‚¨ãƒãƒ«ã‚®ãƒ¼åºƒãŒã‚Šã«ã‚ˆã‚‹ç„¦ç‚¹ã®ãšã‚Œ</li>
            <li><strong>éç‚¹åå·®ï¼ˆAstigmatismï¼‰</strong>ï¼šãƒ¬ãƒ³ã‚ºã®éå¯¾ç§°æ€§ã«ã‚ˆã‚‹åƒã®æ­ªã¿</li>
        </ul>

        <p>ç¾ä»£ã®TEMã§ã¯ã€<strong>åå·®è£œæ­£å™¨ï¼ˆCs-correctorï¼‰</strong>ã«ã‚ˆã‚Šçƒé¢åå·®ã‚’ã»ã¼ã‚¼ãƒ­ã«è£œæ­£ã—ã€0.05 nmä»¥ä¸‹ã®åˆ†è§£èƒ½ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚</p>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1-4: ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ï¼ˆCTFï¼‰ã®åŸºç¤</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def ctf_simple(k, wavelength_A, defocus_nm, Cs_mm):
    """
    ç°¡ç•¥åŒ–ã•ã‚ŒãŸã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆä¼é”é–¢æ•°ï¼ˆCTFï¼‰

    Parameters
    ----------
    k : array-like
        ç©ºé–“å‘¨æ³¢æ•° [1/Ã…]
    wavelength_A : float
        é›»å­æ³¢é•· [Ã…]
    defocus_nm : float
        ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ [nm]ï¼ˆè² å€¤ï¼šã‚¢ãƒ³ãƒ€ãƒ¼ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ï¼‰
    Cs_mm : float
        çƒé¢åå·®ä¿‚æ•° [mm]

    Returns
    -------
    ctf : array-like
        CTFå€¤
    """
    # å˜ä½å¤‰æ›
    defocus_A = defocus_nm * 10
    Cs_A = Cs_mm * 1e7

    # ä½ç›¸ã‚·ãƒ•ãƒˆ Ï‡(k)
    chi = (np.pi * wavelength_A / 2) * k**2 * (defocus_A + 0.5 * wavelength_A**2 * k**2 * Cs_A)

    # CTF = sin(Ï‡)
    ctf = np.sin(chi)

    return ctf

# ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
voltage_kV = 200
wavelength_pm = 2.508  # 200 kVã§ã®æ³¢é•·
wavelength_A = wavelength_pm / 100

k = np.linspace(0, 10, 500)  # ç©ºé–“å‘¨æ³¢æ•° [1/Ã…]

# ç•°ãªã‚‹ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã¨Cså€¤ã§ã®CTF
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))

# å·¦å›³ï¼šãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ä¾å­˜æ€§
Cs = 1.0  # [mm]
defocus_values = [-50, -100, -200]  # [nm]
colors = ['#f093fb', '#f5576c', '#d07be8']

for df, color in zip(defocus_values, colors):
    ctf = ctf_simple(k, wavelength_A, df, Cs)
    ax1.plot(k, ctf, linewidth=2, label=f'Î”f = {df} nm', color=color)

ax1.axhline(0, color='black', linestyle='--', linewidth=0.8)
ax1.set_xlabel('Spatial Frequency k [1/Ã…]', fontsize=12)
ax1.set_ylabel('CTF', fontsize=12)
ax1.set_title(f'CTF vs Defocus\n(200 kV, Cs = {Cs} mm)', fontsize=14, fontweight='bold')
ax1.legend(fontsize=11)
ax1.grid(alpha=0.3)
ax1.set_xlim(0, 10)
ax1.set_ylim(-1, 1)

# å³å›³ï¼šçƒé¢åå·®ä¿‚æ•°ä¾å­˜æ€§
defocus = -100  # [nm]
Cs_values = [0.5, 1.0, 2.0]  # [mm]
colors2 = ['#99ccff', '#ffa500', '#ff6347']

for Cs_val, color in zip(Cs_values, colors2):
    ctf = ctf_simple(k, wavelength_A, defocus, Cs_val)
    ax2.plot(k, ctf, linewidth=2, label=f'Cs = {Cs_val} mm', color=color)

ax2.axhline(0, color='black', linestyle='--', linewidth=0.8)
ax2.set_xlabel('Spatial Frequency k [1/Ã…]', fontsize=12)
ax2.set_ylabel('CTF', fontsize=12)
ax2.set_title(f'CTF vs Cs\n(200 kV, Î”f = {defocus} nm)', fontsize=14, fontweight='bold')
ax2.legend(fontsize=11)
ax2.grid(alpha=0.3)
ax2.set_xlim(0, 10)
ax2.set_ylim(-1, 1)

plt.tight_layout()
plt.show()

print("CTFã®è§£é‡ˆ:")
print("  - CTFãŒæ­£ã®é ˜åŸŸï¼šãã®ç©ºé–“å‘¨æ³¢æ•°æˆåˆ†ãŒåƒã«æ­£ã®ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã§å¯„ä¸")
print("  - CTFãŒè² ã®é ˜åŸŸï¼šã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒåè»¢")
print("  - CTFãŒã‚¼ãƒ­ï¼šãã®å‘¨æ³¢æ•°æˆåˆ†ãŒåƒã«å¯„ä¸ã—ãªã„ï¼ˆæƒ…å ±æå¤±ï¼‰")
</code></pre>

        <h3>1.3.3 æ¤œå‡ºå™¨</h3>
        <p>é›»å­é¡•å¾®é¡ã§ã¯ã€æ§˜ã€…ãªä¿¡å·ã‚’æ¤œå‡ºã™ã‚‹ãŸã‚ã€è¤‡æ•°ã®æ¤œå‡ºå™¨ãŒä½¿ç”¨ã•ã‚Œã¾ã™ï¼š</p>

        <ul>
            <li><strong>è›å…‰ã‚¹ã‚¯ãƒªãƒ¼ãƒ³</strong>ï¼šé›»å­ç·šã‚’å¯è¦–å…‰ã«å¤‰æ›ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ è¦³å¯Ÿï¼‰</li>
            <li><strong>CCDã‚«ãƒ¡ãƒ©</strong>ï¼šé«˜æ„Ÿåº¦ã€ãƒ‡ã‚¸ã‚¿ãƒ«ç”»åƒå–å¾—</li>
            <li><strong>ç›´æ¥é›»å­æ¤œå‡ºå™¨ï¼ˆDirect Electron Detector, DEDï¼‰</strong>ï¼šé›»å­ã‚’ç›´æ¥æ¤œå‡ºã€é«˜é€Ÿãƒ»é«˜æ„Ÿåº¦</li>
            <li><strong>ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ•£å‹Xç·šåˆ†æè£…ç½®ï¼ˆEDS/EDXï¼‰</strong>ï¼šå…ƒç´ åˆ†æ</li>
            <li><strong>é›»å­ã‚¨ãƒãƒ«ã‚®ãƒ¼æå¤±åˆ†å…‰å™¨ï¼ˆEELSï¼‰</strong>ï¼šé›»å­çŠ¶æ…‹åˆ†æ</li>
        </ul>

        <h2>1.4 ä¿¡å·å¼·åº¦ã¨çµ±è¨ˆ</h2>

        <h3>1.4.1 ä¿¡å·å¯¾é›‘éŸ³æ¯”ï¼ˆS/Næ¯”ï¼‰</h3>
        <p>é›»å­é¡•å¾®é¡åƒã®å“è³ªã¯ã€<strong>ä¿¡å·å¯¾é›‘éŸ³æ¯”ï¼ˆSignal-to-Noise Ratio, S/Nï¼‰</strong>ã§è©•ä¾¡ã•ã‚Œã¾ã™ï¼š</p>

        $$
        \text{S/N} = \frac{I_{\text{signal}}}{\sigma_{\text{noise}}}
        $$

        <p>é›»å­ç·šã¯ãƒã‚¢ã‚½ãƒ³çµ±è¨ˆã«å¾“ã†ãŸã‚ã€æ¤œå‡ºé›»å­æ•°$N$ã®å ´åˆã€é›‘éŸ³ã®æ¨™æº–åå·®ã¯$\sqrt{N}$ã§ã™ã€‚ã—ãŸãŒã£ã¦ï¼š</p>

        $$
        \text{S/N} = \sqrt{N}
        $$

        <p><strong>S/Næ¯”å‘ä¸Šã®æˆ¦ç•¥</strong>ï¼š</p>
        <ul>
            <li>é›»å­ç·šé‡ã‚’å¢—ã‚„ã™ï¼ˆ$N$ã‚’å¢—ã‚„ã™ï¼‰ â†’ S/N $\propto \sqrt{N}$</li>
            <li>è¤‡æ•°æšã®ç”»åƒã‚’å¹³å‡åŒ– â†’ S/N $\propto \sqrt{M}$ï¼ˆ$M$ï¼šç”»åƒæšæ•°ï¼‰</li>
            <li>ãŸã ã—ã€è©¦æ–™æå‚·ï¼ˆãƒ“ãƒ¼ãƒ ãƒ€ãƒ¡ãƒ¼ã‚¸ï¼‰ã«æ³¨æ„</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1-5: ãƒã‚¢ã‚½ãƒ³çµ±è¨ˆã¨ä¿¡å·å¯¾é›‘éŸ³æ¯”</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def simulate_electron_image(size=256, signal_level=100, noise_factor=1.0):
    """
    ãƒã‚¢ã‚½ãƒ³çµ±è¨ˆã«å¾“ã†é›»å­é¡•å¾®é¡åƒã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ

    Parameters
    ----------
    size : int
        ç”»åƒã‚µã‚¤ã‚º [pixels]
    signal_level : float
        å¹³å‡é›»å­æ•° [counts/pixel]
    noise_factor : float
        é›‘éŸ³ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ä¿‚æ•°

    Returns
    -------
    image : ndarray
        ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆã•ã‚ŒãŸç”»åƒ
    snr : float
        ä¿¡å·å¯¾é›‘éŸ³æ¯”
    """
    # ãƒã‚¢ã‚½ãƒ³åˆ†å¸ƒã«å¾“ã†é›»å­æ•°ç”Ÿæˆ
    image = np.random.poisson(signal_level, (size, size)).astype(float)

    # è¿½åŠ ã®ã‚¬ã‚¦ã‚¹é›‘éŸ³ï¼ˆèª­ã¿å‡ºã—é›‘éŸ³ãªã©ï¼‰
    image += np.random.normal(0, noise_factor * np.sqrt(signal_level), (size, size))

    # S/Næ¯”è¨ˆç®—
    signal = signal_level
    noise = np.sqrt(signal_level + noise_factor**2 * signal_level)
    snr = signal / noise

    return image, snr

# ç•°ãªã‚‹é›»å­ç·šé‡ã§ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
dose_levels = [10, 50, 200, 1000]  # [electrons/pixel]

fig, axes = plt.subplots(2, 4, figsize=(16, 8))

for i, dose in enumerate(dose_levels):
    image, snr = simulate_electron_image(size=128, signal_level=dose, noise_factor=0.5)

    # ç”»åƒè¡¨ç¤º
    axes[0, i].imshow(image, cmap='gray', vmin=0, vmax=1200)
    axes[0, i].set_title(f'Dose: {dose} eâ»/px\nS/N: {snr:.2f}', fontsize=11, fontweight='bold')
    axes[0, i].axis('off')

    # ãƒ’ã‚¹ãƒˆã‚°ãƒ©ãƒ 
    axes[1, i].hist(image.ravel(), bins=50, color='#f093fb', alpha=0.7, edgecolor='black')
    axes[1, i].set_xlabel('Intensity [counts]', fontsize=10)
    axes[1, i].set_ylabel('Frequency', fontsize=10)
    axes[1, i].set_title(f'Histogram (Ïƒ={np.std(image):.1f})', fontsize=10)
    axes[1, i].grid(alpha=0.3)

plt.tight_layout()
plt.show()

# S/Næ¯”ã®ç†è«–å€¤ã¨å®Ÿæ¸¬å€¤ã®æ¯”è¼ƒ
print("é›»å­ç·šé‡ã¨S/Næ¯”ã®é–¢ä¿‚:")
for dose in dose_levels:
    _, snr = simulate_electron_image(size=128, signal_level=dose, noise_factor=0.5)
    theoretical_snr = np.sqrt(dose)
    print(f"  ç·šé‡ {dose:4d} eâ»/px: ç†è«–S/N={theoretical_snr:.2f}, å®Ÿæ¸¬S/N={snr:.2f}")
</code></pre>

        <h2>1.5 åŠ é€Ÿé›»åœ§ã®é¸æŠã¨è©¦æ–™æå‚·</h2>

        <h3>1.5.1 åŠ é€Ÿé›»åœ§ã®åŠ¹æœ</h3>
        <p>åŠ é€Ÿé›»åœ§ã¯ã€é›»å­é¡•å¾®é¡ã®æ€§èƒ½ã¨è©¦æ–™ã¸ã®å½±éŸ¿ã«ç›´æ¥é–¢ã‚ã‚Šã¾ã™ï¼š</p>

        <table>
            <thead>
                <tr>
                    <th>åŠ é€Ÿé›»åœ§</th>
                    <th>æ³¢é•·</th>
                    <th>åˆ†è§£èƒ½</th>
                    <th>é€éèƒ½åŠ›</th>
                    <th>è©¦æ–™æå‚·</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>ä½é›»åœ§ï¼ˆ60-80 kVï¼‰</td>
                    <td>é•·ã„</td>
                    <td>ä½</td>
                    <td>ä½</td>
                    <td>å°</td>
                </tr>
                <tr>
                    <td>ä¸­é›»åœ§ï¼ˆ100-200 kVï¼‰</td>
                    <td>ä¸­</td>
                    <td>ä¸­</td>
                    <td>ä¸­</td>
                    <td>ä¸­</td>
                </tr>
                <tr>
                    <td>é«˜é›»åœ§ï¼ˆ300-1000 kVï¼‰</td>
                    <td>çŸ­ã„</td>
                    <td>é«˜</td>
                    <td>é«˜</td>
                    <td>å¤§</td>
                </tr>
            </tbody>
        </table>

        <p><strong>è©¦æ–™æå‚·ã®ãƒ¡ã‚«ãƒ‹ã‚ºãƒ </strong>ï¼š</p>
        <ul>
            <li><strong>ãƒãƒƒã‚¯ã‚ªãƒ³æå‚·</strong>ï¼šé«˜ã‚¨ãƒãƒ«ã‚®ãƒ¼é›»å­ãŒåŸå­ã‚’å¼¾ãé£›ã°ã™ï¼ˆé–¾å€¤ã‚¨ãƒãƒ«ã‚®ãƒ¼ä»¥ä¸Šï¼‰</li>
            <li><strong>ãƒ©ã‚¸ã‚ªãƒªã‚·ã‚¹ï¼ˆæ”¾å°„ç·šåˆ†è§£ï¼‰</strong>ï¼šé›»å­ç·šç…§å°„ã«ã‚ˆã‚‹åŒ–å­¦çµåˆã®åˆ‡æ–­</li>
            <li><strong>ç†±æå‚·</strong>ï¼šéå¼¾æ€§æ•£ä¹±ã«ã‚ˆã‚‹è©¦æ–™åŠ ç†±</li>
        </ul>

        <h4>ã‚³ãƒ¼ãƒ‰ä¾‹1-6: ãƒãƒƒã‚¯ã‚ªãƒ³æå‚·ã®é–¾å€¤ã‚¨ãƒãƒ«ã‚®ãƒ¼</h4>
        <pre><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

def knock_on_threshold_voltage(element_mass, displacement_energy_eV=25):
    """
    ãƒãƒƒã‚¯ã‚ªãƒ³æå‚·ã®é–¾å€¤åŠ é€Ÿé›»åœ§ã‚’è¨ˆç®—

    Parameters
    ----------
    element_mass : float
        å…ƒç´ ã®åŸå­é‡ [u]
    displacement_energy_eV : float
        åŸå­ã®å¤‰ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼ [eV]ï¼ˆå…¸å‹å€¤ï¼š25 eVï¼‰

    Returns
    -------
    V_threshold : float
        é–¾å€¤åŠ é€Ÿé›»åœ§ [kV]
    """
    # å®šæ•°
    m_e = 9.10938e-31   # é›»å­è³ªé‡ [kg]
    u = 1.66054e-27     # åŸå­è³ªé‡å˜ä½ [kg]
    e = 1.60218e-19     # é›»è·ç´ é‡ [C]
    c = 2.99792e8       # å…‰é€Ÿ [m/s]

    # åŸå­ã®è³ªé‡ [kg]
    M = element_mass * u

    # ãƒãƒƒã‚¯ã‚ªãƒ³é–¾å€¤ã‚¨ãƒãƒ«ã‚®ãƒ¼ï¼ˆç›¸å¯¾è«–çš„ï¼‰
    # E_threshold â‰ˆ (M + 2m_e) / (2M) * E_d * (1 + E_d / (2 M cÂ²))
    E_d = displacement_energy_eV * e  # [J]

    # ç°¡ç•¥å¼ï¼ˆéç›¸å¯¾è«–çš„è¿‘ä¼¼ï¼‰
    E_threshold_J = (M / (2 * m_e)) * E_d
    V_threshold_kV = E_threshold_J / (e * 1000)

    return V_threshold_kV

# ä»£è¡¨çš„ãªå…ƒç´ ã®ãƒãƒƒã‚¯ã‚ªãƒ³é–¾å€¤
elements = {
    'C': 12, 'Si': 28, 'Fe': 56, 'Cu': 64, 'Mo': 96, 'W': 184, 'Au': 197
}

element_names = list(elements.keys())
masses = list(elements.values())
thresholds = [knock_on_threshold_voltage(m) for m in masses]

# ãƒ—ãƒ­ãƒƒãƒˆ
fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(15, 6))

# å·¦å›³ï¼šå…ƒç´ ã”ã¨ã®é–¾å€¤
colors = plt.cm.plasma(np.linspace(0.2, 0.9, len(elements)))
bars = ax1.bar(element_names, thresholds, color=colors, alpha=0.8, edgecolor='black', linewidth=1.5)

# å…¸å‹çš„ãªåŠ é€Ÿé›»åœ§ã‚’å‚è€ƒç·šã¨ã—ã¦è¿½åŠ 
ax1.axhline(y=80, color='green', linestyle='--', linewidth=2, label='Low Voltage TEM (80 kV)')
ax1.axhline(y=200, color='orange', linestyle='--', linewidth=2, label='Standard TEM (200 kV)')
ax1.axhline(y=300, color='red', linestyle='--', linewidth=2, label='High Voltage TEM (300 kV)')

ax1.set_ylabel('Knock-on Threshold Voltage [kV]', fontsize=12)
ax1.set_title('Knock-on Damage Threshold for Elements', fontsize=14, fontweight='bold')
ax1.legend(fontsize=10, loc='upper left')
ax1.grid(axis='y', alpha=0.3)
ax1.set_ylim(0, 350)

# æ•°å€¤ãƒ©ãƒ™ãƒ«
for bar, threshold in zip(bars, thresholds):
    height = bar.get_height()
    ax1.text(bar.get_x() + bar.get_width()/2, height + 5, f'{threshold:.0f}',
             ha='center', fontsize=9, fontweight='bold')

# å³å›³ï¼šåŸå­é‡ vs é–¾å€¤
ax2.scatter(masses, thresholds, s=200, c=masses, cmap='plasma',
            edgecolors='black', linewidths=2, zorder=3)
ax2.plot(masses, thresholds, 'k--', linewidth=1.5, alpha=0.5, zorder=1)

for name, mass, threshold in zip(element_names, masses, thresholds):
    ax2.text(mass, threshold + 10, name, fontsize=10, ha='center', fontweight='bold')

ax2.set_xlabel('Atomic Mass [u]', fontsize=12)
ax2.set_ylabel('Knock-on Threshold Voltage [kV]', fontsize=12)
ax2.set_title('Threshold Voltage vs Atomic Mass', fontsize=14, fontweight='bold')
ax2.grid(alpha=0.3)

plt.tight_layout()
plt.show()

print("ãƒãƒƒã‚¯ã‚ªãƒ³æå‚·é–¾å€¤é›»åœ§:")
for name, mass, threshold in zip(element_names, masses, thresholds):
    print(f"  {name:2s} (M={mass:3.0f} u): {threshold:6.1f} kV")
print("\nç‚­ç´ ï¼ˆã‚°ãƒ©ãƒ•ã‚§ãƒ³ãªã©ï¼‰ã¯80 kVä»¥ä¸‹ã§è¦³å¯Ÿã™ã‚Œã°æå‚·ã‚’ä½æ¸›ã§ãã‚‹")
</code></pre>

        <h2>1.6 æ¼”ç¿’å•é¡Œ</h2>

        <h3>æ¼”ç¿’1-1: é›»å­æ³¢é•·ã®è¨ˆç®—ï¼ˆEasyï¼‰</h3>
        <p><strong>å•é¡Œ</strong>ï¼šåŠ é€Ÿé›»åœ§100 kVã€200 kVã€300 kVã§ã®é›»å­æ³¢é•·ã‚’è¨ˆç®—ã—ã€å¯è¦–å…‰ï¼ˆ550 nmï¼‰ã¨ã®æ³¢é•·æ¯”ã‚’æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np

def calc_wavelength(V_kV):
    h = 6.62607e-34
    m0 = 9.10938e-31
    e = 1.60218e-19
    c = 2.99792e8
    E = V_kV * 1000 * e
    p = np.sqrt(2 * m0 * E * (1 + E / (2 * m0 * c**2)))
    return (h / p) * 1e12  # [pm]

voltages = [100, 200, 300]
visible_light_nm = 550

print("é›»å­æ³¢é•·ã¨å¯è¦–å…‰ã¨ã®æ¯”è¼ƒ:")
for V in voltages:
    wl_pm = calc_wavelength(V)
    wl_nm = wl_pm / 1000
    ratio = visible_light_nm / wl_nm
    print(f"  {V} kV: Î» = {wl_pm:.3f} pm = {wl_nm:.6f} nm, æ¯”ç‡ = {ratio:.0f}:1")
</code></pre>
        </details>

        <h3>æ¼”ç¿’1-2: åˆ†è§£èƒ½ã®æ¯”è¼ƒï¼ˆMediumï¼‰</h3>
        <p><strong>å•é¡Œ</strong>ï¼šå…‰å­¦é¡•å¾®é¡ï¼ˆÎ»=550 nm, Î±=30Â°ï¼‰ã¨é›»å­é¡•å¾®é¡ï¼ˆ200 kV, Î±=10Â°ï¼‰ã®åˆ†è§£èƒ½ã‚’ãƒ¬ã‚¤ãƒªãƒ¼åŸºæº–ã§æ¯”è¼ƒã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np

def resolution(wavelength_nm, alpha_deg):
    alpha_rad = np.deg2rad(alpha_deg)
    return 0.61 * wavelength_nm / np.sin(alpha_rad)

# å…‰å­¦é¡•å¾®é¡
optical_res = resolution(550, 30)

# é›»å­é¡•å¾®é¡ï¼ˆ200 kV â†’ 2.508 pm = 0.002508 nmï¼‰
em_res = resolution(0.002508, 10)

print(f"å…‰å­¦é¡•å¾®é¡ã®åˆ†è§£èƒ½: {optical_res:.1f} nm")
print(f"é›»å­é¡•å¾®é¡ã®åˆ†è§£èƒ½: {em_res:.5f} nm = {em_res * 10:.3f} Ã…")
print(f"åˆ†è§£èƒ½å‘ä¸Š: {optical_res / em_res:.0f}å€")
</code></pre>
        </details>

        <h3>æ¼”ç¿’1-3: æ•£ä¹±æ–­é¢ç©ã®è¨ˆç®—ï¼ˆMediumï¼‰</h3>
        <p><strong>å•é¡Œ</strong>ï¼š200 kVã®é›»å­ç·šã«å¯¾ã—ã¦ã€Siï¼ˆZ=14ï¼‰ã¨Auï¼ˆZ=79ï¼‰ã®æ•£ä¹±è§’10Â°ã§ã®æ•£ä¹±æ–­é¢ç©æ¯”ã‚’æ±‚ã‚ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">Z_Si = 14
Z_Au = 79
E_keV = 200
theta = 10

# æ•£ä¹±æ–­é¢ç©ã¯ ZÂ² ã«æ¯”ä¾‹
ratio = (Z_Au / Z_Si)**2

print(f"Si (Z={Z_Si}) ã¨ Au (Z={Z_Au}) ã®æ•£ä¹±æ–­é¢ç©æ¯”:")
print(f"  Ïƒ_Au / Ïƒ_Si = ({Z_Au}/{Z_Si})Â² = {ratio:.1f}")
print(f"  Auã®æ•£ä¹±æ–­é¢ç©ã¯Siã®ç´„{ratio:.0f}å€")
</code></pre>
        </details>

        <h3>æ¼”ç¿’1-4: ä¿¡å·å¯¾é›‘éŸ³æ¯”ã®æ”¹å–„ï¼ˆHardï¼‰</h3>
        <p><strong>å•é¡Œ</strong>ï¼šç¾åœ¨ã®S/Næ¯”ãŒ10ã§ã‚ã‚‹é›»å­é¡•å¾®é¡åƒã‚’ã€S/Næ¯”100ã«ã™ã‚‹ã«ã¯ã€ä½•å€ã®é›»å­ç·šé‡ãŒå¿…è¦ã‹ï¼Ÿã¾ãŸã€10æšã®ç”»åƒã‚’å¹³å‡åŒ–ã—ãŸå ´åˆã®S/Næ¯”æ”¹å–„åŠ¹æœã‚’è¨ˆç®—ã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np

# S/N = âˆšN ã‚ˆã‚Šã€S/Næ¯”ã‚’10å€ã«ã™ã‚‹ã«ã¯ç·šé‡ã‚’100å€ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹
current_snr = 10
target_snr = 100
dose_increase = (target_snr / current_snr)**2

print(f"S/Næ¯”ã‚’{current_snr}ã‹ã‚‰{target_snr}ã«æ”¹å–„ã™ã‚‹ãŸã‚ã®ç·šé‡å¢—åŠ :")
print(f"  å¿…è¦ãªç·šé‡å¢—åŠ : {dose_increase}å€")

# 10æšå¹³å‡åŒ–ã®åŠ¹æœ
num_images = 10
snr_improvement = np.sqrt(num_images)
new_snr = current_snr * snr_improvement

print(f"\n10æšã®ç”»åƒã‚’å¹³å‡åŒ–ã—ãŸå ´åˆ:")
print(f"  S/Næ¯”æ”¹å–„ä¿‚æ•°: âˆš{num_images} = {snr_improvement:.2f}")
print(f"  æ–°ã—ã„S/Næ¯”: {current_snr} Ã— {snr_improvement:.2f} = {new_snr:.1f}")
</code></pre>
        </details>

        <h3>æ¼”ç¿’1-5: ãƒãƒƒã‚¯ã‚ªãƒ³æå‚·ã®è©•ä¾¡ï¼ˆHardï¼‰</h3>
        <p><strong>å•é¡Œ</strong>ï¼šã‚°ãƒ©ãƒ•ã‚§ãƒ³ï¼ˆç‚­ç´ ã€M=12ï¼‰ã‚’200 kVã®TEMã§è¦³å¯Ÿã™ã‚‹éš›ã€ãƒãƒƒã‚¯ã‚ªãƒ³æå‚·ãŒç™ºç”Ÿã™ã‚‹ã‹è©•ä¾¡ã›ã‚ˆã€‚ã¾ãŸã€æå‚·ã‚’é¿ã‘ã‚‹ãŸã‚ã®æœ€é©ãªåŠ é€Ÿé›»åœ§ã‚’ææ¡ˆã›ã‚ˆï¼ˆå¤‰ä½ã‚¨ãƒãƒ«ã‚®ãƒ¼25 eVï¼‰ã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np

def knock_on_threshold(M, E_d=25):
    m_e = 9.10938e-31
    u = 1.66054e-27
    e = 1.60218e-19
    M_kg = M * u
    E_d_J = E_d * e
    E_threshold = (M_kg / (2 * m_e)) * E_d_J
    return E_threshold / (e * 1000)  # [kV]

M_C = 12
threshold_kV = knock_on_threshold(M_C, E_d=25)
operating_voltage = 200

print(f"ã‚°ãƒ©ãƒ•ã‚§ãƒ³ï¼ˆç‚­ç´ ã€M={M_C}ï¼‰ã®ãƒãƒƒã‚¯ã‚ªãƒ³é–¾å€¤:")
print(f"  é–¾å€¤é›»åœ§: {threshold_kV:.1f} kV")
print(f"  è¦³å¯Ÿé›»åœ§: {operating_voltage} kV")

if operating_voltage > threshold_kV:
    print(f"  âš ï¸ {operating_voltage} kVã§ã®è¦³å¯Ÿã¯ãƒãƒƒã‚¯ã‚ªãƒ³æå‚·ãŒç™ºç”Ÿã™ã‚‹")
    print(f"  æ¨å¥¨é›»åœ§: {threshold_kV * 0.8:.0f} kVä»¥ä¸‹ï¼ˆå®‰å…¨ãƒãƒ¼ã‚¸ãƒ³20%ï¼‰")
else:
    print(f"  âœ… {operating_voltage} kVã§ã®è¦³å¯Ÿã¯å®‰å…¨")
</code></pre>
        </details>

        <h3>æ¼”ç¿’1-6: CTFã®ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ï¼ˆHardï¼‰</h3>
        <p><strong>å•é¡Œ</strong>ï¼š200 kVã®TEMï¼ˆCs=1.0 mmã€ãƒ‡ãƒ•ã‚©ãƒ¼ã‚«ã‚¹-100 nmï¼‰ã§ã€CTFã®ç¬¬1ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ã®ç©ºé–“å‘¨æ³¢æ•°ã‚’æ±‚ã‚ã‚ˆã€‚ã“ã‚Œã¯å®Ÿç©ºé–“ã®åˆ†è§£èƒ½ã«å¯¾å¿œã™ã‚‹ã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <pre><code class="language-python">import numpy as np
from scipy.optimize import fsolve

voltage_kV = 200
Cs_mm = 1.0
defocus_nm = -100

# é›»å­æ³¢é•·
wavelength_pm = 2.508
wavelength_A = wavelength_pm / 100

# å˜ä½å¤‰æ›
Cs_A = Cs_mm * 1e7
defocus_A = defocus_nm * 10

# CTFã®ä½ç›¸ã‚·ãƒ•ãƒˆ Ï‡(k) = 0ã¨ãªã‚‹æœ€åˆã®éè‡ªæ˜ãªè§£ã‚’æ¢ã™
def chi(k):
    return (np.pi * wavelength_A / 2) * k**2 * (defocus_A + 0.5 * wavelength_A**2 * k**2 * Cs_A)

# ç¬¬1ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹: sin(Ï‡) = 0 â†’ Ï‡ = Ï€
def equation(k):
    return chi(k) - np.pi

k_zero = fsolve(equation, 2.0)[0]  # åˆæœŸæ¨å®šå€¤2.0
resolution_A = 1 / k_zero

print(f"200 kV TEMï¼ˆCs={Cs_mm} mm, Î”f={defocus_nm} nmï¼‰:")
print(f"  ç¬¬1ã‚¼ãƒ­ã‚¯ãƒ­ã‚¹ç©ºé–“å‘¨æ³¢æ•°: {k_zero:.3f} 1/Ã…")
print(f"  å¯¾å¿œã™ã‚‹å®Ÿç©ºé–“åˆ†è§£èƒ½: {resolution_A:.3f} Ã… = {resolution_A/10:.3f} nm")
</code></pre>
        </details>

        <h3>æ¼”ç¿’1-7: åŠ é€Ÿé›»åœ§ã®æœ€é©åŒ–ï¼ˆHardï¼‰</h3>
        <p><strong>å•é¡Œ</strong>ï¼šåšã•100 nmã®Siè©¦æ–™ã‚’è¦³å¯Ÿã™ã‚‹éš›ã€80 kVã¨200 kVã®åŠ é€Ÿé›»åœ§ã§ã©ã¡ã‚‰ãŒã‚ˆã‚Šè‰¯ã„é€éåƒã‚’å¾—ã‚‰ã‚Œã‚‹ã‹ã€å¹³å‡è‡ªç”±è¡Œç¨‹ã‚’è€ƒæ…®ã—ã¦è­°è«–ã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <p><strong>è§£ç­”ã®ãƒã‚¤ãƒ³ãƒˆ</strong>ï¼š</p>
            <ul>
                <li>å¹³å‡è‡ªç”±è¡Œç¨‹$\lambda_{\text{mfp}}$ã¯åŠ é€Ÿé›»åœ§ãŒé«˜ã„ã»ã©é•·ããªã‚‹</li>
                <li>80 kVï¼š$\lambda_{\text{mfp}} \approx 50$ nm â†’ å¤šé‡æ•£ä¹±ãŒç™ºç”Ÿã€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã¯é«˜ã„ãŒåˆ†è§£èƒ½ã¯ä½ä¸‹</li>
                <li>200 kVï¼š$\lambda_{\text{mfp}} \approx 150$ nm â†’ å˜ä¸€æ•£ä¹±ã«è¿‘ãã€åˆ†è§£èƒ½ãŒé«˜ã„</li>
                <li><strong>çµè«–</strong>ï¼šé«˜åˆ†è§£èƒ½ãŒå¿…è¦ãªå ´åˆã¯200 kVã€ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆãŒå¿…è¦ãªå ´åˆã¯80 kVãŒæœ‰åˆ©</li>
            </ul>
        </details>

        <h3>æ¼”ç¿’1-8: å®Ÿé¨“è¨ˆç”»ï¼ˆHardï¼‰</h3>
        <p><strong>å•é¡Œ</strong>ï¼šæœªçŸ¥ã®é‡‘å±ãƒŠãƒç²’å­ï¼ˆç›´å¾„10 nmï¼‰ã‚’é›»å­é¡•å¾®é¡ã§è§£æã™ã‚‹å®Ÿé¨“è¨ˆç”»ã‚’ç«‹æ¡ˆã›ã‚ˆã€‚åŠ é€Ÿé›»åœ§ã€è¦³å¯Ÿãƒ¢ãƒ¼ãƒ‰ï¼ˆTEM/SEM/STEMï¼‰ã€åˆ†ææ‰‹æ³•ï¼ˆEDS/EELSï¼‰ã®é¸æŠç†ç”±ã‚’èª¬æ˜ã›ã‚ˆã€‚</p>

        <details>
            <summary><strong>è§£ç­”ä¾‹ã‚’è¡¨ç¤º</strong></summary>
            <p><strong>å®Ÿé¨“è¨ˆç”»</strong>ï¼š</p>
            <ol>
                <li><strong>SEMè¦³å¯Ÿï¼ˆä½å€ç‡ï¼‰</strong>ï¼šãƒŠãƒç²’å­ã®åˆ†æ•£çŠ¶æ…‹ã€å½¢æ…‹ã‚’ç¢ºèªï¼ˆåŠ é€Ÿé›»åœ§5-10 kVï¼‰</li>
                <li><strong>TEMè¦³å¯Ÿï¼ˆæ˜è¦–é‡åƒï¼‰</strong>ï¼šç²’å­ã‚µã‚¤ã‚ºåˆ†å¸ƒã€çµæ™¶æ€§ã®åˆ¤å®šï¼ˆåŠ é€Ÿé›»åœ§200 kVï¼‰</li>
                <li><strong>SAEDï¼ˆåˆ¶é™è¦–é‡é›»å­å›æŠ˜ï¼‰</strong>ï¼šçµæ™¶æ§‹é€ ã®åŒå®š</li>
                <li><strong>HRTEM</strong>ï¼šæ ¼å­åƒè¦³å¯Ÿã§é¢é–“éš”ã‚’æ¸¬å®šã€çµæ™¶æ–¹ä½ã‚’æ±ºå®š</li>
                <li><strong>EDSåˆ†æ</strong>ï¼šå…ƒç´ çµ„æˆã‚’å®šé‡ï¼ˆåŠ é€Ÿé›»åœ§200 kVã€ç‚­ç´ æ”¯æŒè†œä¸Šã§è¦³å¯Ÿï¼‰</li>
                <li><strong>EELSï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰</strong>ï¼šè¡¨é¢é…¸åŒ–å±¤ã®æœ‰ç„¡ã€ä¾¡æ•°çŠ¶æ…‹ã®ç¢ºèª</li>
            </ol>
            <p><strong>ç†ç”±</strong>ï¼š</p>
            <ul>
                <li>200 kVã¯ã€10 nmãƒŠãƒç²’å­ã«å¯¾ã—ã¦ååˆ†ãªåˆ†è§£èƒ½ã¨é€éèƒ½åŠ›ã‚’æŒã¤</li>
                <li>æ˜è¦–é‡åƒã§å½¢æ…‹ã€SAEDã§æ§‹é€ ã€HRTEMã§åŸå­é…åˆ—ã€EDSã§çµ„æˆã‚’ç·åˆçš„ã«è§£æ</li>
                <li>EELSã¯è¡¨é¢æ•æ„Ÿæ€§ãŒé«˜ãã€é…¸åŒ–å±¤ã®æ¤œå‡ºã«æœ‰åŠ¹</li>
            </ul>
        </details>

        <h2>1.7 å­¦ç¿’ãƒã‚§ãƒƒã‚¯</h2>
        <p>ä»¥ä¸‹ã®è³ªå•ã«ç­”ãˆã¦ã€ç†è§£åº¦ã‚’ç¢ºèªã—ã¾ã—ã‚‡ã†ï¼š</p>

        <ol>
            <li>ãƒ‰ãƒ»ãƒ–ãƒ­ã‚¤æ³¢é•·ã®å¼ã‚’å°å‡ºã—ã€åŠ é€Ÿé›»åœ§ã¨ã®é–¢ä¿‚ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>ãƒ¬ã‚¤ãƒªãƒ¼åŸºæº–ã«ã‚ˆã‚‹åˆ†è§£èƒ½ã®å®šç¾©ã‚’ç†è§£ã—ã€å…‰å­¦é¡•å¾®é¡ã¨é›»å­é¡•å¾®é¡ã®é•ã„ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>å¼¾æ€§æ•£ä¹±ã¨éå¼¾æ€§æ•£ä¹±ã®ç‰©ç†çš„ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã¨æ¤œå‡ºä¿¡å·ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>æ•£ä¹±æ–­é¢ç©ã®åŸå­ç•ªå·ä¾å­˜æ€§ï¼ˆ$Z^2$ï¼‰ã‚’ç†è§£ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</li>
            <li>é›»å­éŠƒã®ç¨®é¡ï¼ˆã‚¿ãƒ³ã‚°ã‚¹ãƒ†ãƒ³ã€LaBâ‚†ã€FEGï¼‰ã¨ãã®ç‰¹å¾´ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>çƒé¢åå·®ã¨è‰²åå·®ãŒåƒã«ä¸ãˆã‚‹å½±éŸ¿ã‚’ç†è§£ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</li>
            <li>ä¿¡å·å¯¾é›‘éŸ³æ¯”ã¨ãƒã‚¢ã‚½ãƒ³çµ±è¨ˆã®é–¢ä¿‚ã‚’èª¬æ˜ã§ãã¾ã™ã‹ï¼Ÿ</li>
            <li>ãƒãƒƒã‚¯ã‚ªãƒ³æå‚·ã®é–¾å€¤ã‚¨ãƒãƒ«ã‚®ãƒ¼ã¨è©¦æ–™æå‚·ä½æ¸›ã®æˆ¦ç•¥ã‚’ç†è§£ã—ã¦ã„ã¾ã™ã‹ï¼Ÿ</li>
        </ol>

        <h2>1.8 å‚è€ƒæ–‡çŒ®</h2>
        <ol>
            <li>Williams, D. B., & Carter, C. B. (2009). <em>Transmission Electron Microscopy: A Textbook for Materials Science</em> (2nd ed.). Springer. - é›»å­é¡•å¾®é¡å­¦ã®åŒ…æ‹¬çš„æ•™ç§‘æ›¸</li>
            <li>Reimer, L., & Kohl, H. (2008). <em>Transmission Electron Microscopy: Physics of Image Formation</em> (5th ed.). Springer. - çµåƒç†è«–ã®è©³ç´°</li>
            <li>Goldstein, J. I., et al. (2017). <em>Scanning Electron Microscopy and X-Ray Microanalysis</em> (4th ed.). Springer. - SEMã¨EDSåˆ†æã®æ¨™æº–ãƒ†ã‚­ã‚¹ãƒˆ</li>
            <li>Egerton, R. F. (2011). <em>Electron Energy-Loss Spectroscopy in the Electron Microscope</em> (3rd ed.). Springer. - EELSæŠ€è¡“ã®è©³ç´°</li>
            <li>Spence, J. C. H. (2013). <em>High-Resolution Electron Microscopy</em> (4th ed.). Oxford University Press. - HRTEMç†è«–</li>
            <li>Kirkland, E. J. (2020). <em>Advanced Computing in Electron Microscopy</em> (3rd ed.). Springer. - åƒã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</li>
            <li>De Graef, M. (2003). <em>Introduction to Conventional Transmission Electron Microscopy</em>. Cambridge University Press. - TEMå…¥é–€æ›¸</li>
        </ol>

        <h2>1.9 æ¬¡ç« ã¸</h2>
        <p>æ¬¡ç« ã§ã¯ã€èµ°æŸ»å‹é›»å­é¡•å¾®é¡ï¼ˆSEMï¼‰ã®åŸç†ã€äºŒæ¬¡é›»å­åƒï¼ˆSEï¼‰ã¨å¾Œæ–¹æ•£ä¹±é›»å­åƒï¼ˆBSEï¼‰ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼åˆ†æ•£å‹Xç·šåˆ†æï¼ˆEDSï¼‰ã€ç”»åƒè§£æã®åŸºç¤ã‚’å­¦ã³ã¾ã™ã€‚SEMã¯ã€è©¦æ–™è¡¨é¢ã®å½¢æ…‹è¦³å¯Ÿã¨å…ƒç´ åˆ†æã‚’é«˜ã„ç©ºé–“åˆ†è§£èƒ½ã§è¡Œãˆã‚‹æ±ç”¨æ€§ã®é«˜ã„æ‰‹æ³•ã§ã™ã€‚</p>

        <div class="navigation">
            <a href="index.html" class="nav-button">â† ç›®æ¬¡ã«æˆ»ã‚‹</a>
            <a href="index.html" class="nav-button">ç›®æ¬¡ã«æˆ»ã‚‹</a>
            <a href="chapter-2.html" class="nav-button">ç¬¬2ç« ï¼šSEMå…¥é–€ â†’</a>
        </div>
    </main>

    <section class="disclaimer">
        <h3>å…è²¬äº‹é …</h3>
        <ul>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¯æ•™è‚²ãƒ»ç ”ç©¶ãƒ»æƒ…å ±æä¾›ã®ã¿ã‚’ç›®çš„ã¨ã—ã¦ãŠã‚Šã€å°‚é–€çš„ãªåŠ©è¨€ï¼ˆæ³•å¾‹ãƒ»ä¼šè¨ˆãƒ»æŠ€è¡“çš„ä¿è¨¼ãªã©ï¼‰ã‚’æä¾›ã™ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŠã‚ˆã³ä»˜éšã™ã‚‹ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ã€Œç¾çŠ¶æœ‰å§¿ï¼ˆAS ISï¼‰ã€ã§æä¾›ã•ã‚Œã€æ˜ç¤ºã¾ãŸã¯é»™ç¤ºã‚’å•ã‚ãšã€å•†å“æ€§ã€ç‰¹å®šç›®çš„é©åˆæ€§ã€æ¨©åˆ©éä¾µå®³ã€æ­£ç¢ºæ€§ãƒ»å®Œå…¨æ€§ã€å‹•ä½œãƒ»å®‰å…¨æ€§ç­‰ã„ã‹ãªã‚‹ä¿è¨¼ã‚‚ã—ã¾ã›ã‚“ã€‚</li>
            <li>å¤–éƒ¨ãƒªãƒ³ã‚¯ã€ç¬¬ä¸‰è€…ãŒæä¾›ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ»ãƒ„ãƒ¼ãƒ«ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªç­‰ã®å†…å®¹ãƒ»å¯ç”¨æ€§ãƒ»å®‰å…¨æ€§ã«ã¤ã„ã¦ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯ä¸€åˆ‡ã®è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ©ç”¨ãƒ»å®Ÿè¡Œãƒ»è§£é‡ˆã«ã‚ˆã‚Šç›´æ¥çš„ãƒ»é–“æ¥çš„ãƒ»ä»˜éšçš„ãƒ»ç‰¹åˆ¥ãƒ»çµæœçš„ãƒ»æ‡²ç½°çš„æå®³ãŒç”Ÿã˜ãŸå ´åˆã§ã‚‚ã€é©ç”¨æ³•ã§è¨±å®¹ã•ã‚Œã‚‹æœ€å¤§é™ã®ç¯„å›²ã§ã€ä½œæˆè€…ãŠã‚ˆã³æ±åŒ—å¤§å­¦ã¯è²¬ä»»ã‚’è² ã„ã¾ã›ã‚“ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å†…å®¹ã¯ã€äºˆå‘Šãªãå¤‰æ›´ãƒ»æ›´æ–°ãƒ»æä¾›åœæ­¢ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚</li>
            <li>æœ¬ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è‘—ä½œæ¨©ãƒ»ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯æ˜è¨˜ã•ã‚ŒãŸæ¡ä»¶ï¼ˆä¾‹: CC BY 4.0ï¼‰ã«å¾“ã„ã¾ã™ã€‚å½“è©²ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¯é€šå¸¸ã€ç„¡ä¿è¨¼æ¡é …ã‚’å«ã¿ã¾ã™ã€‚</li>
        </ul>
    </section>

    <footer>
        <p><strong>ä½œæˆè€…</strong>: MS Knowledge Hub Content Team</p>
        <p><strong>ãƒãƒ¼ã‚¸ãƒ§ãƒ³</strong>: 1.0 | <strong>ä½œæˆæ—¥</strong>: 2025-10-28</p>
        <p><strong>ãƒ©ã‚¤ã‚»ãƒ³ã‚¹</strong>: Creative Commons BY 4.0</p>
        <p>&copy; 2025 MS Terakoya. All rights reserved.</p>
    </footer>
</body>
</html>
