# 第3章：実装：材料強度のシミュレーション

**応力-ひずみ関係の理論から実装まで：弾性・塑性変形と結晶構造の計算力学**

---

## 3.1 応力-ひずみ曲線の理論

材料強度を理解する上で最も重要な概念が**応力-ひずみ曲線**です。この曲線は、材料に荷重を加えたときの変形挙動を示し、材料の機械的特性を包括的に表現します。

### 3.1.1 基本的な定義

**応力 (Stress, σ)**:
```
σ = F / A₀
```
- F: 加えられた荷重 [N]
- A₀: 元の断面積 [m²]
- 単位: Pa (Pascal) = N/m², 実用的にはMPa, GPa

**ひずみ (Strain, ε)**:
```
ε = ΔL / L₀
```
- ΔL: 伸び量 [m]
- L₀: 元の長さ [m]
- 無次元量（または%で表記）

### 3.1.2 応力-ひずみ曲線の領域

金属材料の典型的な応力-ひずみ曲線は、以下の領域に分けられます：

| 領域 | 特徴 | 変形メカニズム |
|------|------|--------------|
| **弾性域** | 除荷すると元に戻る | 原子間結合の伸縮 |
| **降伏点** | 塑性変形開始 | 転位の移動開始 |
| **塑性域** | 永久変形 | 転位の移動・増殖 |
| **加工硬化域** | 強度が上昇 | 転位の相互作用 |
| **ネッキング** | くびれ発生 | 局所的な塑性不安定 |

---

## 3.2 コード例1：弾性変形のシミュレーション

弾性変形は**Hooke's Law（フックの法則）**に従います。

### 3.2.1 Hooke's Lawの実装

```python
class ElasticMaterial:
    """
    弾性材料のクラス
    
    Hooke's Law: σ = E × ε
    """
    def __init__(self, name: str, youngs_modulus: float,
                 poisson_ratio: float, yield_strength: float):
        self.name = name
        self.E = youngs_modulus * 1000  # GPa → MPa
        self.nu = poisson_ratio
        self.sigma_y = yield_strength
    
    def calculate_stress(self, strain: np.ndarray) -> np.ndarray:
        """
        ひずみから応力を計算
        
        Args:
            strain: ひずみ配列
            
        Returns:
            応力配列 [MPa]
        """
        stress = self.E * strain
        stress = np.minimum(stress, self.sigma_y)  # 降伏強度で制限
        return stress
```

### 3.2.2 ヤング率 (Young's Modulus)

ヤング率Eは、材料の**硬さ（変形しにくさ）**を表す最も重要なパラメータです。

**代表的な金属のヤング率**:
- 鋼 (Steel): 210 GPa
- アルミニウム (Al): 70 GPa
- 銅 (Cu): 120 GPa
- チタン (Ti): 110 GPa

**実行結果**:
```
【降伏点情報】
Steel:
  降伏ひずみ: 0.119%
  降伏点でのひずみエネルギー: 0.148 MJ/m³
  
Titanium:
  降伏ひずみ: 0.800%
  降伏点でのひずみエネルギー: 3.520 MJ/m³
```

### 3.2.3 ひずみエネルギー

弾性変形によって材料内部に蓄えられるエネルギー密度：

```
U = (1/2) × σ × ε = (1/2) × E × ε²
```

このエネルギーは、除荷時に全て回復します（完全弾性体の場合）。

---

## 3.3 コード例2：塑性変形のモデリング

降伏点を超えると、材料は塑性変形を開始します。

### 3.3.1 Ludwik-Hollomon式

塑性域における応力-ひずみ関係は、**加工硬化**を考慮した式でモデル化されます：

```
σ = σ_y + K × ε_p^n
```

- σ_y: 降伏強度 [MPa]
- K: 強度係数 [MPa]
- ε_p: 塑性ひずみ
- n: 加工硬化指数（0 ≤ n ≤ 1）

### 3.3.2 加工硬化指数nの物理的意味

**n値が大きい（n = 0.3-0.5）**:
- 加工硬化が顕著
- 延性が高い（よく伸びる）
- ネッキングが遅れる
- 例: ステンレス鋼、銅

**n値が小さい（n = 0.1-0.2）**:
- 加工硬化が緩やか
- 早期にネッキング発生
- 延性が低い
- 例: 軟鋼、アルミニウム合金

### 3.3.3 真応力と公称応力

実際の引張試験では、試験片の断面積が減少するため、**真応力**と**公称応力**を区別する必要があります。

**変換式**:
```python
true_strain = np.log(1 + engineering_strain)
true_stress = engineering_stress * (1 + engineering_strain)
```

**実行結果**:
```
【材料の加工硬化特性】
Stainless Steel:
  ヤング率 E: 200 GPa
  降伏強度 σ_y: 300 MPa
  強度係数 K: 1000 MPa
  加工硬化指数 n: 0.35  ← 高延性
```

### 3.3.4 加工硬化のメカニズム

塑性変形中、材料内部では**転位**（結晶格子の欠陥）が移動・増殖します。転位密度が増加すると、転位同士が絡み合い、さらなる変形が困難になります。これが加工硬化の本質です。

**加工硬化率** (Work Hardening Rate):
```
dσ/dε = 変形抵抗の増加率
```

この値が大きいほど、加工硬化が顕著です。

---

## 3.4 コード例3：結晶構造とヤング率

材料の機械的性質は、原子レベルの結晶構造に起因します。

### 3.4.1 主要な金属結晶構造

**FCC (Face-Centered Cubic, 面心立方格子)**:
```python
positions_FCC = np.array([
    [0, 0, 0],      # 角
    [0.5, 0.5, 0],  # 面心
    [0.5, 0, 0.5],  # 面心
    [0, 0.5, 0.5]   # 面心
]) * lattice_constant
```
- 配位数: 12
- 充填率: 0.74
- 例: Al, Cu, Au, Ni
- 特徴: 高延性、多くのすべり系

**BCC (Body-Centered Cubic, 体心立方格子)**:
```python
positions_BCC = np.array([
    [0, 0, 0],      # 角
    [0.5, 0.5, 0.5] # 体心
]) * lattice_constant
```
- 配位数: 8
- 充填率: 0.68
- 例: Fe, Cr, W
- 特徴: 高強度、温度依存性大

**HCP (Hexagonal Close-Packed, 六方最密充填)**:
- 配位数: 12
- 充填率: 0.74
- 例: Ti, Mg, Zn
- 特徴: 異方性、すべり系限定

### 3.4.2 結晶構造と機械的性質の関係

**ヤング率と原子間結合**:

ヤング率は、原子間の結合力から推定できます（簡略化モデル）：

```
E ≈ (k × N) / a
```
- k: 原子間結合バネ定数 [N/m]
- N: 単位面積あたりの結合数
- a: 格子定数 [m]

**実行結果**:
```
【結晶構造データ】
Aluminum (Al):
  構造タイプ: FCC
  格子定数: 4.05 Å
  配位数: 12
  原子充填率: 0.740
  
Iron (Fe):
  構造タイプ: BCC
  格子定数: 2.87 Å
  配位数: 8
  原子充填率: 0.680
```

### 3.4.3 すべり系と延性

材料の延性は、**すべり系**（転位が移動できる結晶面と方向の組み合わせ）の数に依存します。

| 構造 | すべり系の数 | 延性 |
|------|------------|------|
| FCC | 12 | 非常に高い |
| BCC | 48（高温） | 温度依存 |
| HCP | 3-6 | 低い（異方性） |

---

## 3.5 実装のポイントと応用

### 3.5.1 数値計算の注意点

**1. 配列の効率的な処理**

NumPyのベクトル化演算を活用することで、計算速度が飛躍的に向上します：

```python
# ✅ 効率的（ベクトル化）
stress = E * strain  # 配列全体を一度に計算

# ❌ 非効率（ループ）
for i in range(len(strain)):
    stress[i] = E * strain[i]
```

**2. 降伏条件の実装**

降伏強度を超える応力を制限する処理：

```python
stress = np.minimum(stress, self.sigma_y)
```

この一行で、全ての要素に対して最小値演算を実行できます。

### 3.5.2 実用的な応用例

**材料選定シミュレーション**:

設計要求から最適な材料を選定する際、応力-ひずみシミュレーションが有用です。

```python
# 要求仕様
required_stiffness = 200  # GPa
max_allowable_strain = 0.002  # 0.2%

# 各材料の評価
for material in materials:
    max_stress = material.calculate_stress(max_allowable_strain)
    if material.E >= required_stiffness * 1000:
        print(f"{material.name}: 合格（最大応力 {max_stress:.1f} MPa）")
```

**破損予測**:

ひずみエネルギー密度から、材料の破損リスクを評価できます。

---

## 3.6 まとめ

本章では、金属材料の強度特性をシミュレーションする3つの実装例を学びました。

### 本章で学んだこと

✅ **基本理解**:
- 応力-ひずみ曲線の物理的意味
- 弾性域（Hooke's Law）と塑性域の違い
- ヤング率、降伏強度、加工硬化の概念
- 結晶構造（FCC, BCC, HCP）と機械的性質の関係

✅ **実践スキル**:
- Pythonによる弾性変形シミュレーション
- 塑性変形と加工硬化のモデル化（Ludwik-Hollomon式）
- 結晶構造の3D可視化
- ヤング率の理論的推定

✅ **応用力**:
- 材料選定への活用
- 真応力-真ひずみ変換
- 加工硬化率の計算と解釈
- 結晶構造から機械的性質を予測

### 重要な知見

**💡 材料設計の基本原理**:
1. **弾性変形**: 原子間結合の可逆的な伸縮（E値が重要）
2. **塑性変形**: 転位の移動による永久変形（加工硬化指数nが鍵）
3. **結晶構造**: すべり系の数が延性を決定

**🎯 シミュレーションの実用価値**:
- 実験前の材料挙動予測
- 設計パラメータの最適化
- 破損メカニズムの理解

### 参考文献

#### 学術論文
1. Ludwik, P. (1909). "Elemente der technologischen Mechanik." *Springer-Verlag*.
2. Hollomon, J. H. (1945). "Tensile deformation." *Transactions of the Metallurgical Society of AIME*, 162, 268-290.

#### 教科書
1. Callister, W. D., & Rethwisch, D. G. (2018). *Materials Science and Engineering: An Introduction*. Wiley.
2. Hosford, W. F. (2010). *Mechanical Behavior of Materials*. Cambridge University Press.

#### Pythonライブラリ
1. NumPy Documentation. (2024). https://numpy.org/doc/
2. Matplotlib Documentation. (2024). https://matplotlib.org/stable/contents.html

---

**完全なコード例は以下のファイルで利用可能です**:
- `example1_elastic_deformation.py` - 弾性変形シミュレーション
- `example2_plastic_deformation.py` - 塑性変形モデリング
- `example3_crystal_structure.py` - 結晶構造可視化
- `verification_log.txt` - コード実行検証ログ

---

*本章の内容についてご質問やフィードバックがありましたら、お気軽にお問い合わせください。*

## 3.7 発展的トピック

### 3.7.1 有限要素法への拡張

本章で学んだ構成則（Constitutive Equations）は、有限要素法（FEM）シミュレーションの基礎となります。実際の構造解析では、複雑な形状を小さな要素に分割し、各要素で応力-ひずみ関係を計算します。

**FEMとの接続**:
```python
def element_stiffness_matrix(E: float, A: float, L: float) -> np.ndarray:
    """
    1次元要素の剛性マトリクス
    
    Args:
        E: ヤング率 [Pa]
        A: 断面積 [m²]
        L: 要素長さ [m]
    
    Returns:
        剛性マトリクス [2x2]
    """
    k = (E * A) / L
    K = np.array([[k, -k],
                  [-k, k]])
    return K
```

### 3.7.2 異方性材料への対応

実際の金属材料は、結晶方位や加工履歴により**異方性**（方向依存性）を示します。

**Hill の降伏条件**:

等方性材料のMises降伏条件を拡張：

```
f = F(σ_yy - σ_zz)² + G(σ_zz - σ_xx)² + H(σ_xx - σ_yy)² 
    + 2Lτ_yz² + 2Mτ_zx² + 2Nτ_xy²
```

F, G, H, L, M, Nは異方性パラメータで、材料の方向性を表現します。

### 3.7.3 温度依存性

金属材料の機械的性質は温度に強く依存します。

**ヤング率の温度依存性**:
```
E(T) = E₀ × [1 - b(T - T₀)]
```

**降伏強度の温度依存性**:
```
σ_y(T) = σ_y0 × exp[-c(T - T₀)]
```

高温では材料が軟化し、低温では脆くなる傾向があります（BCC金属は特に顕著）。

### 3.7.4 ひずみ速度効果

塑性変形は、変形速度（ひずみ速度）にも依存します。

**Cowper-Symonds モデル**:
```
σ_d = σ_s × [1 + (ε̇/C)^(1/p)]
```
- σ_d: 動的応力
- σ_s: 静的応力
- ε̇: ひずみ速度
- C, p: 材料定数

高速変形（衝撃）では、材料がより硬く（強く）振る舞います。

---

## 3.8 工学的応用例

### 3.8.1 自動車ボディの衝突解析

自動車の衝突安全性評価では、塑性変形シミュレーションが不可欠です：

1. **材料モデル選定**: 加工硬化特性（n値）が重要
2. **エネルギー吸収**: 塑性仕事量が衝撃エネルギーを吸収
3. **変形パターン**: 結晶構造に応じた変形挙動を予測

**設計指針**:
- n値が高い材料（ステンレス鋼）: 大きな塑性変形で衝撃吸収
- n値が低い材料（高張力鋼）: 高強度で乗員スペース確保

### 3.8.2 航空機材料の選定

航空機構造では、**比強度**（強度/密度）が重要です。

```python
def specific_strength(yield_strength: float, density: float) -> float:
    """
    比強度を計算
    
    Args:
        yield_strength: 降伏強度 [MPa]
        density: 密度 [g/cm³]
    
    Returns:
        比強度 [kPa·m³/kg]
    """
    return (yield_strength * 1000) / (density * 1000)

# アルミニウム合金
specific_Al = specific_strength(500, 2.7)  # ≈ 185

# チタン合金
specific_Ti = specific_strength(900, 4.5)  # ≈ 200
```

チタン合金は、アルミニウムより重いですが、より高い比強度を実現できます。

### 3.8.3 金属加工プロセス設計

圧延、鍛造などの加工プロセスでは、加工硬化挙動の予測が重要です：

**加工限界の推定**:
```python
def estimate_forming_limit(material: PlasticMaterial) -> float:
    """
    成形限界ひずみを推定（簡易モデル）
    
    Returns:
        限界ひずみ [-]
    """
    # Considère条件: dσ/dε = σ
    # 簡略化: 限界ひずみ ≈ n（加工硬化指数）
    return material.n

# ステンレス鋼 (n=0.35) → 35%まで成形可能（理論値）
# アルミ合金 (n=0.15) → 15%が限界
```

---

## 3.9 計算精度と検証

シミュレーション結果の信頼性を確保するため、実験データとの比較検証が不可欠です。

### 3.9.1 検証項目

1. **ヤング率**: 初期勾配と比較（誤差 < 5%）
2. **降伏強度**: 0.2%耐力と比較（誤差 < 10%）
3. **加工硬化指数**: log-log プロットの傾きから決定
4. **引張強さ**: ネッキング発生応力と比較

### 3.9.2 モデルの適用範囲

**本章のモデルの前提条件**:
- 室温での準静的変形（ひずみ速度 < 10⁻³/s）
- 単軸応力状態
- 等方性材料
- 小変形理論（ひずみ < 20%）

これらの条件外では、より高度なモデルが必要です。

---

**最終更新**: 2025-10-21  
**バージョン**: 1.0
