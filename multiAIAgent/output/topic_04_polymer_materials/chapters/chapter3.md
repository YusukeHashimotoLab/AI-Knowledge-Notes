# 第3章：実装：高分子物性のモデリング

**理論から実装へ：分子量分布・粘弾性・ガラス転移温度**

---

## 3.1 高分子物性モデリングの基礎

高分子材料の物性を予測・設計するには、分子レベルの構造と巨視的な物性を結びつける数理モデルが不可欠です。本章では、高分子科学における3つの重要なモデリング手法を実装し、その適用方法を学びます。

### 3.1.1 なぜモデリングが重要か

高分子材料の開発において、計算による物性予測は以下の利点があります：

- **実験コストの削減**: 合成前に物性を推定し、候補材料を絞り込む
- **構造-物性相関の理解**: 分子構造がマクロ物性に与える影響を定量化
- **最適化の効率化**: パラメータ空間を系統的に探索し、最適組成を決定
- **品質管理**: 製造工程での分子量分布や物性のばらつきを予測

### 3.1.2 本章で扱うモデリング手法

| モデリング対象 | 手法 | 適用例 |
|--------------|------|-------|
| **分子量分布** | Schulz-Flory分布 | 逐次重合の分子量制御 |
| **粘弾性挙動** | Maxwell/Voigt模型 | ゴム・プラスチックの変形予測 |
| **ガラス転移温度** | Fox式、Gordon-Taylor式 | 共重合体・ブレンドの設計 |

---

## 3.2 コード例1：分子量分布の計算

### 3.2.1 Schulz-Flory分布とは

高分子合成では、完全に均一な分子量の製品を得ることは困難で、必ず分子量分布が生じます。**Schulz-Flory分布**は、逐次重合（step-growth polymerization）における理論的な分子量分布を記述します。

**数分率**（モル分率）:
```
N(n) = (1-p) × p^(n-1)
```

**重量分率**:
```
W(n) = n × (1-p)² × p^(n-1)
```

ここで、`n`は重合度、`p`は重合反応の進行度（0 < p < 1）です。

### 3.2.2 重要な統計量

**数平均重合度** `DPn` と**重量平均重合度** `DPw` は以下で計算されます：

```
DPn = 1 / (1 - p)
DPw = (1 + p) / (1 - p)
```

**多分散指数**（PDI）は分子量分布の広がりを示します：

```
PDI = Mw / Mn = DPw / DPn = 1 + p
```

逐次重合の理論的限界として、**PDI ≥ 2.0**（p → 1のとき）となります。一方、リビング重合では **PDI → 1.0** が可能です。

### 3.2.3 実装例の解説

`example1_molecular_weight_distribution.py`では、`SchulzFloryDistribution`クラスを実装しています。

**主な機能**:
- `number_fraction(n)`: 各重合度における数分率を計算
- `weight_fraction(n)`: 各重合度における重量分率を計算
- `calculate_statistics()`: 数平均・重量平均分子量、PDIを一括計算
- `plot_distribution()`: 数分率と重量分率の分布を可視化

**物理的解釈**:
- **p = 0.95**（高重合度）: DPn = 20, PDI = 1.95 → 広い分布
- **p = 0.80**（中重合度）: DPn = 5, PDI = 1.80 → やや狭い分布
- 数分率は低重合度側、重量分率は高重合度側にピークを持つ

---

## 3.3 コード例2：粘弾性モデル

### 3.3.1 粘弾性とは

高分子材料は、**弾性**（変形が瞬時に回復）と**粘性**（変形が時間依存）の両方の性質を示します。この性質を**粘弾性**（viscoelasticity）と呼びます。

### 3.3.2 Maxwell模型（応力緩和）

弾性要素（バネ、弾性率E）と粘性要素（ダッシュポット、粘性率η）を**直列**に接続した模型です。

**応力緩和関数**:
```
σ(t) = ε₀ × E × exp(-t/τ)
```

ここで、**緩和時間** `τ = η/E` は粘弾性挙動の特性時間です。

**物理的意味**:
- 一定ひずみを瞬時に与えると、応力は指数関数的に減少
- 長時間後、応力は完全にゼロになる（液体的挙動）
- 緩和時間が長いほど、応力はゆっくりと減衰

### 3.3.3 Voigt模型（クリープ）

弾性要素と粘性要素を**並列**に接続した模型です。

**クリープコンプライアンス**:
```
ε(t) = (σ₀/E) × (1 - exp(-t/τ))
```

ここで、**遅延時間** `τ = η/E` です。

**物理的意味**:
- 一定応力を与えると、ひずみは指数関数的に増加
- 長時間後、一定ひずみに収束（固体的挙動）
- Voigt模型単独では永久変形を示さない

### 3.3.4 動的粘弾性

周期的な応力・ひずみに対する応答を記述します。**複素弾性率** `E* = E' + iE"` で表現されます：

- **貯蔵弾性率** `E'`: 弾性成分（エネルギー貯蔵）
- **損失弾性率** `E"`: 粘性成分（エネルギー散逸）
- **損失正接** `tan(δ) = E"/E'`: 粘性の度合いを示す指標

Maxwell模型では：
```
E' = E × (ωτ)² / (1 + (ωτ)²)
E" = E × ωτ / (1 + (ωτ)²)
tan(δ) = 1 / (ωτ)
```

`ωτ = 1` 付近で `E' ≈ E"` となり、エネルギー散逸が最大になります。

### 3.3.5 実装例の解説

`example2_viscoelastic_models.py`では、`MaxwellModel`と`VoigtModel`クラスを実装しています。

**主な機能**:
- `stress_relaxation(t, ε₀)`: 応力緩和曲線の計算
- `creep_compliance(t, σ₀)`: クリープ曲線の計算
- `complex_modulus(ω)`: 複素弾性率の計算（動的粘弾性）
- 線形スケールと対数スケールでの可視化

**実用的応用**:
- ゴムの減衰特性評価（自動車用防振ゴム）
- プラスチックの長期変形予測（クリープ破壊の防止）
- 接着剤の硬化過程のモニタリング

---

## 3.4 コード例3：ガラス転移温度の予測

### 3.4.1 ガラス転移温度（Tg）の重要性

ガラス転移温度Tgは、高分子がガラス状態（硬く脆い）からゴム状態（柔軟）へ変化する温度です。材料の**使用温度範囲**を決定する最重要パラメータです。

### 3.4.2 Fox式

共重合体や高分子ブレンドのTgを、成分ポリマーのTgと組成から予測する最も簡便な式です：

```
1/Tg = w₁/Tg₁ + w₂/Tg₂
```

ここで、`w₁, w₂`は重量分率、`Tg₁, Tg₂`は各成分のガラス転移温度です。

**特徴**:
- 調和平均の形（簡潔で計算が容易）
- 理想混合を仮定（実測値とのずれが生じる場合がある）
- 第一近似として広く使用される

### 3.4.3 Gordon-Taylor式

体積変化を考慮したより精密な予測式です：

```
Tg = (w₁×Tg₁ + k×w₂×Tg₂) / (w₁ + k×w₂)
```

パラメータ`k`は、熱膨張係数の比に関連し、実験的に決定されます。

**特徴**:
- Fox式より高精度（適切なkパラメータを使用時）
- `k = 1`のとき、加重平均に相当
- 実験データからkを逆算し、全組成範囲を予測可能

### 3.4.4 実装例の解説

`example3_glass_transition_prediction.py`では、`GlassTransitionPredictor`クラスを実装しています。

**主な機能**:
- `fox_equation()`: Fox式による Tg 予測
- `gordon_taylor_equation()`: Gordon-Taylor式による Tg 予測
- `calculate_k_parameter()`: 実験値からkパラメータを逆算
- 組成-Tg曲線の可視化、予測精度の比較

**実用例**:
- **PS/PMMAブレンド**（Tg差が小さい系）: 両式ともに高精度
- **スチレン-ブタジエン共重合体**（Tg差が大きい系）: kパラメータの最適化が重要
- 実験点が1つあれば、kを決定して全組成を予測可能

---

## 3.5 モデリングの実践と精度向上

### 3.5.1 モデル選択の指針

適切なモデルを選択することで、計算の効率と精度のバランスを最適化できます。

| 物性 | 簡便な手法 | 高精度手法 | 使い分け |
|------|----------|----------|---------|
| 分子量分布 | Schulz-Flory | GPC実測+フィッティング | 理論予測 vs 実測分析 |
| 粘弾性 | Maxwell/Voigt | 一般化Maxwell模型 | 単一緩和 vs 複数緩和 |
| Tg予測 | Fox式 | Gordon-Taylor式 | 初期推定 vs 精密設計 |

**モデル選択の実践例**:

**プロジェクト初期段階**: Fox式で候補組成を5-10通りスクリーニング → 最も有望な2-3組成を選定

**詳細設計段階**: 選定した組成でGordon-Taylor式を適用 → 実験で数点測定してkパラメータを最適化 → 全組成範囲を高精度予測

**量産前検証**: GPCで分子量分布を測定 → Schulz-Flory分布と比較 → 重合条件（温度、時間、触媒量）を微調整

### 3.5.2 実験データとの連携

計算モデルは、実験データで検証・較正することで実用性が大幅に向上します。

**分子量分布の実験検証**:
- **GPC（ゲル浸透クロマトグラフィー）**: 実測の分子量分布曲線を取得
- Schulz-Flory分布と比較し、p値を逆算
- 目標分子量に到達するための重合条件（反応時間、温度）を予測
- 連鎖重合の場合は、Poisson分布やFlory分布を使用

**粘弾性の実験検証**:
- **DMA（動的機械分析）**: 温度・周波数を変えてE', E", tan(δ)を測定
- Maxwell模型のτ（緩和時間）を実験データからフィッティング
- 複数の緩和時間を持つ場合、一般化Maxwell模型（複数のMaxwell要素の並列）を使用
- **応力緩和試験**: 一定ひずみ下での応力減衰を測定し、モデルと比較

**Tg予測の実験検証**:
- **DSC（示差走査熱量測定）**: ガラス転移温度を精密測定（±1°C）
- 異なる組成で3-5点のTgを測定し、Gordon-Taylor式のkパラメータを決定
- フィッティングしたkを用いて、全組成範囲のTgを予測
- 相分離の有無をDSCまたはDMAで確認（2つのTgが現れる場合は非相溶）

### 3.5.3 パラメータの温度依存性

多くの高分子物性は温度に強く依存します。**時間-温度重ね合わせ原理**（WLF方程式）を用いると、異なる温度での粘弾性挙動を統一的に記述できます：

```
log(aT) = -C₁(T - Tref) / (C₂ + T - Tref)
```

ここで、`aT`はシフトファクター、`C₁, C₂`は材料固有の定数、`Tref`は基準温度です。

**実用的な応用**:
- 高温での短時間試験から、室温での長時間挙動を予測
- 周波数を変える代わりに温度を変えて、広い周波数範囲のデータを取得
- ゴム材料の温度補償設計（自動車用防振ゴム等）

### 3.5.4 計算精度の評価指標

モデルの予測精度は、以下の指標で定量評価します：

**平均絶対誤差（MAE）**:
```
MAE = (1/N) × Σ|予測値 - 実測値|
```

**二乗平均平方根誤差（RMSE）**:
```
RMSE = √[(1/N) × Σ(予測値 - 実測値)²]
```

**決定係数（R²）**:
```
R² = 1 - Σ(実測値 - 予測値)² / Σ(実測値 - 平均値)²
```

**実用的な精度基準**:
- Tg予測: MAE < 5°C で実用的、< 2°C で高精度
- 粘弾性: 緩和時間の対数誤差 < 0.5 で許容範囲
- 分子量: PDIの誤差 < 0.1 で良好

### 3.5.5 モデルの限界と発展

**本章のモデルの限界**:
- **Schulz-Flory**: 逐次重合のみ対象（連鎖重合には不適用、反応の不均一性を考慮できない）
- **Maxwell/Voigt**: 単一緩和時間のみ（実際の高分子は広い緩和時間分布を持つ）
- **Fox/Gordon-Taylor**: 相溶系のみ対象（相分離すると2つのTgが観測され、単純な式では記述できない）

**より高度な手法への発展**:

**分子量分布**:
- **Monte Carlo法**: 重合反応をシミュレートし、複雑な分子量分布を予測
- **集団収支モデル**: 工業重合プロセスでの分子量制御に使用

**粘弾性**:
- **一般化Maxwell模型**: 複数の緩和時間を考慮（Prony級数展開）
- **分子動力学シミュレーション**: 原子レベルから粘弾性を予測
- **Williams-Landel-Ferry（WLF）方程式**: 温度依存性を精密に記述

**ガラス転移温度**:
- **Flory-Huggins理論**: 高分子溶液の相図と混合ギブスエネルギーを計算
- **Bicerano法**: 分子構造からTgを定量的構造物性相関（QSPR）で予測
- **分子動力学**: 第一原理からTgを計算（計算コスト大、精度高）

### 3.5.6 産業応用の実例

**自動車産業**: タイヤゴムの配合最適化
- SBR（スチレン-ブタジエンゴム）のスチレン比率をTg予測で最適化
- 低温でのグリップ性能（Tgが低い）と耐摩耗性（分子量が大）のトレードオフ設計
- 粘弾性モデルで転がり抵抗を予測 → 燃費向上

**電子材料**: 封止樹脂の設計
- エポキシ樹脂のTgを120°C以上に設計（はんだリフロー温度に耐える）
- 硬化剤の種類と比率をGordon-Taylor式で最適化
- 熱サイクル試験での応力緩和をMaxwell模型で予測

**包装材料**: フィルムの力学特性制御
- ポリエチレン/ポリプロピレンブレンドの分子量分布を制御
- 延伸性（低分子量成分）と強度（高分子量成分）のバランス設計
- クリープ変形をVoigt模型で予測し、長期保存時の寸法安定性を保証

---

## 3.6 まとめ

本章では、高分子物性の3つの重要なモデリング手法を実装しました。

### 本章で学んだこと

✅ **分子量分布**:
- Schulz-Flory分布による逐次重合の理論的分布
- 数平均・重量平均分子量、多分散指数の計算
- PDI = 1 + p の関係と重合制御への応用

✅ **粘弾性モデル**:
- Maxwell模型による応力緩和の記述
- Voigt模型によるクリープの記述
- 動的粘弾性（複素弾性率、損失正接）の計算

✅ **ガラス転移温度予測**:
- Fox式による簡便な Tg 推定
- Gordon-Taylor式による高精度予測
- 組成-Tg曲線の作成と材料設計への応用

### 重要な洞察

**🎯 モデリングの価値**:
1. **予測能力**: 実験前に物性を推定し、材料開発を加速（試作回数を50%削減可能）
2. **理解の深化**: 数式を通じて物理現象の本質を把握し、問題の根本原因を特定
3. **最適化**: 多次元パラメータ空間を系統的に探索し、最適解を効率的に発見
4. **品質保証**: 製造バッチ間の物性ばらつきを予測し、不良品発生を未然に防止

**💡 実用的なポイント**:
- **分子量分布**: PDIが大きい（広い分布）と、機械的強度にばらつきが生じる。目標PDI < 2.0で均質な製品を実現
- **粘弾性**: 緩和時間が使用条件（温度、荷重時間）と一致すると、最大の減衰が得られる（防振材・制振材の設計指針）
- **ガラス転移温度**: Tgは使用温度範囲を決定。Tg - 20°C以下で硬くて脆い、Tg + 20°C以上で柔軟でゴム状
- **温度依存性**: 多くの物性は温度で急変するため、使用環境温度±20°Cでの物性評価が必須

### コード活用のベストプラクティス

**段階的アプローチ**:
1. **初期スクリーニング**: Fox式、Schulz-Flory分布で候補材料を10通り程度リストアップ（計算時間: 数分）
2. **詳細評価**: Maxwell/Voigt模型で力学特性をシミュレート（計算時間: 数十分）
3. **実験検証**: 有望な2-3候補を実際に合成し、GPC、DMA、DSCで測定
4. **パラメータ最適化**: 実験データでkパラメータ等をフィッティング
5. **最終設計**: 最適化したモデルで製造仕様を決定

**データ駆動型材料開発**:
- 実験データベースを構築し、機械学習で予測精度を向上
- 過去の開発事例からパラメータの初期値を推定
- モデルの予測誤差を統計的に評価し、信頼区間を提示

### 参考文献

#### 教科書
1. Flory, P. J. (1953). *Principles of Polymer Chemistry*. Cornell University Press.
2. Ferry, J. D. (1980). *Viscoelastic Properties of Polymers* (3rd ed.). Wiley.

#### 学術論文
3. Schulz, G. V. (1939). "Über die Kinetik der Kettenpolymerisationen." *Zeitschrift für Physikalische Chemie*, B43, 25-46.
4. Gordon, M., & Taylor, J. S. (1952). "Ideal copolymers and the second-order transitions of synthetic rubbers." *Journal of Applied Chemistry*, 2(9), 493-500.

---

**完全なコード例**:
- `example1_molecular_weight_distribution.py` - Schulz-Flory分布の実装
- `example2_viscoelastic_models.py` - Maxwell/Voigt模型の実装
- `example3_glass_transition_prediction.py` - Fox式・Gordon-Taylor式の実装
- `verification_log.txt` - 全コードの実行検証ログ
